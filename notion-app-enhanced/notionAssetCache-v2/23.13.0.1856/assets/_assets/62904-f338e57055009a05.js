"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[62904],{795126:(e,t,i)=>{i.d(t,{D:()=>Z});var o=i(667294),r=()=>i(219727),n=()=>i(142735),a=()=>i(496205),s=()=>i(788860),c=()=>i(696459),l=()=>i(367514),d=()=>i(333068),p=(i(267602),i(228244),()=>i(846550)),f=()=>i(816512),u=()=>i(501274),m=()=>i(707513),v=()=>i(352230),g=()=>i(90065),y=()=>i(155350),h=()=>i(696347),V=()=>i(518530),b=()=>i(421887),M=()=>i(998901),x=()=>i(827973),w=()=>i(198829),P=()=>i(255577),S=()=>i(470386),O=()=>i(388284),T=()=>i(654133),C=()=>i(67961),k=()=>i(799026);const R=(0,s().vU)({expirationProperty:{defaultMessage:"Expiration",id:"verificationHelpers.menuTitle.Expiration"},noExpiration:{defaultMessage:"None",id:"verificationHelpers.noExpiration"},verifierProperty:{defaultMessage:"Owner",id:"verificationHelpers.menuTitle.Owner"},noOwners:{defaultMessage:"No owners",id:"verificationHelpers.noOwners.placeholder"},removeVerificationProperty:{defaultMessage:"Remove verification",id:"verificationHelpers.removeVerification"},nonOwnerCannotRemoveVerification:{defaultMessage:"Only owners can remove verification",id:"verificationHelpers.nonOwnerCannotRemoveVerification"},nonOwnersCannotEditVerification:{defaultMessage:"Only owners can edit verification",id:"verificationHelpers.nonOwnersCannotEditVerification"},ownersAttribution:{defaultMessage:"{numOtherActors, plural, =0 {{actorName}} one {{actorName} and {numOtherActors} other} other {{actorName} and {numOtherActors} others}}",id:"verificationHelpers.displayPageOwners"},verificationMenuTitle:{defaultMessage:"Configure Verification",id:"verificationHelpers.verificationMenu.menuTitle.configureVerification"}});var B=i(785893);function j(e){const{parent:t,blockStore:i,setVerificationMenuDisplay:o}=e,a=(0,r().O7)(),c=(0,s().YB)(),l=a.device.isMobile,j=(0,n().VK)((()=>(0,g().T7)(i)),[i]),A="verified"===j.type,D=(0,n().VK)((()=>{const{verificationOwners:e}=(0,g().zV)({blockStore:i}),t=e.length;if(t<=0)return c.formatMessage(R.noOwners);const o=e[0],r=(0,f().Hl)({pointer:o,getRecordModel:i.getRecordModel}),n=null==r?void 0:r.asActor,a=null==n?void 0:n.getDisplayName(c);if(!a)return c.formatMessage(R.noOwners);const s=t-1;return c.formatMessage(R.ownersAttribution,{actorName:a,numOtherActors:s})}),[i,c]),U=(0,n().VK)((()=>i.canEdit()),[i]),H=(0,n().VK)((()=>{const{verificationOwners:e}=(0,g().zV)({blockStore:i}),t=a.currentUser.id;return e.some((e=>e.id===t))}),[i,a.currentUser]),E=(0,p().yK)((e=>({disabledButton:{opacity:.7},redStyling:{color:e.text.uiRedPrimary},iconStyle:{height:l?16:12,width:l?16:12},buttonRightContainer:{display:"flex",alignItems:"center",maxWidth:150,gap:2,color:e.icon.secondary},buttonRightText:{color:e.icon.secondary,fontSize:m().JB.UISmall.desktop},footer:{color:e.text.secondary,fontSize:m().JB.UISmall.desktop,borderTop:l?`1px solid ${e.regularDividerColor}`:void 0}})),[l]),I="none"!==j.type&&(0,B.jsx)("div",{style:E.footer,children:(0,B.jsx)(k().r,{lastVerifiedDate:A&&j.isIndefinite?j.startDateTime:j.dateTimeRange.start,getRecordModel:i.getRecordModel,actorPointer:j.actorPointer})});let Z;return Z=l?{menuType:v().o.Modal,title:c.formatMessage(R.verificationMenuTitle),right:(0,B.jsx)(S().DoneMenuText,{}),onClickRight:()=>t.close(),footer:I}:{menuType:v().o.Popup,width:320,footer:I},(0,B.jsx)(w().Z,{...Z,children:(0,B.jsx)(P().Z,{type:P().i.Vertical,initialFocus:0,sections:[{key:"Verification Configuration",render:e=>(0,B.jsx)(O().Z,{...e,hideTitle:l,title:c.formatMessage(R.verificationMenuTitle),disableMobilePadding:!0,disableMobileBorders:!0}),items:[{key:"Expiration",render:e=>{let t=c.formatMessage(R.noExpiration);"verified"!==j.type||j.isIndefinite?"expired"===j.type&&(t=u().mb({dateTime:j.dateTimeRange.end,intl:c,shortenDateAndRange:!0})):t=u().mb({dateTime:j.dateTimeRange.end,intl:c,shortenDateAndRange:!0});const i=!H,o=(0,B.jsxs)("div",{style:E.buttonRightContainer,children:[(0,B.jsx)(C().Z,{style:E.buttonRightText,showTooltipWhenTruncated:!0,children:t}),H&&(0,h().o)(E.iconStyle)]});return(0,B.jsx)(T().Z,{placement:M().Placement.Right,render:t=>(0,B.jsx)(x().Z,{...e,...t,title:c.formatMessage(R.expirationProperty),icon:(0,y().C)({...E.iconStyle}),right:o,disabled:i,buttonStyle:i?E.disabledButton:void 0}),renderTooltip:()=>c.formatMessage(R.nonOwnersCannotEditVerification),disableTooltip:!i})},action:()=>{o("expiration")}},{key:"Verifier",render:e=>(0,B.jsx)(x().Z,{...e,title:c.formatMessage(R.verifierProperty),icon:(0,b().f)({...E.iconStyle}),right:(0,B.jsxs)("div",{style:E.buttonRightContainer,children:[(0,B.jsx)(C().Z,{style:E.buttonRightText,showTooltipWhenTruncated:!0,children:D}),(0,h().o)(E.iconStyle)]}),disabled:!U}),action:()=>{o("owner")}},{key:"Remove",render:e=>{const t=!H;return(0,B.jsx)(T().Z,{placement:M().Placement.Right,render:i=>(0,B.jsx)(x().Z,{...e,...i,title:c.formatMessage(R.removeVerificationProperty),icon:(0,V().U)({...E.iconStyle}),style:E.redStyling,disabled:t,buttonStyle:t?E.disabledButton:void 0}),renderTooltip:()=>c.formatMessage(R.nonOwnerCannotRemoveVerification),disableTooltip:!t})},action:()=>{var e;e={value:void 0},d().O({environment:a,blockStore:i,verificationValue:e.value}),t.close()}}]}]})})}var A=()=>i(102182),D=()=>i(269299),U=()=>i(356321),H=()=>i(440633);function E(e){const{blockStore:t,parent:i}=e,o=(0,r().O7)(),a=(0,s().YB)(),l=o.device.isMobile,{verifierValue:d,isDefaultUnpersistedValue:p}=(0,n().VK)((()=>{const{verificationOwners:e,isCreatedByDefault:i}=(0,g().zV)({blockStore:t});return{verifierValue:e,isDefaultUnpersistedValue:Boolean(i)}}),[t]);return(0,B.jsx)(H().ZP,{value:d,format:U().C.Page,valueIsUnpersistedDefaultValue:p,propertySchema:{name:a.formatMessage(R.verifierProperty),type:"person",limit:void 0,default:"created_by"},schema:{},insertChar:void 0,disabled:!1,onChange:e=>{(e=>{const i=t.getPropertyStore(g().EI.Owner);"personPropertyMenuUpdateAddPerson"===e.type?D().createAndCommit({userAction:"PageVerificationBadge.addVerifier",environment:o,canUndo:!0,perform:t=>{for(const o of e.newValues)D().applyOperation({transaction:t,store:i,operation:{path:i.path,pointer:i.pointer,command:"addPersonAfter",args:{pointer:o}}})}}):"personPropertyMenuUpdateRemovePerson"===e.type?1===d.length?A().oV({label:(0,B.jsx)(s()._H,{id:"pageVerification.removeLastVerifier.error",defaultMessage:"At least one owner is required for verification."})}):D().createAndCommit({userAction:"PageVerificationBadge.removeVerifier",environment:o,canUndo:!0,perform:t=>{D().applyOperation({transaction:t,store:i,operation:{path:i.path,pointer:i.pointer,command:"removePerson",args:{pointer:e.removedValue}}})}}):"personPropertyMenuUpdateReplacePerson"===e.type?D().createAndCommit({userAction:"PageVerificationBadge.replaceVerifier",environment:o,canUndo:!0,perform:t=>{D().applyOperation({transaction:t,store:i,operation:{path:i.path,pointer:i.pointer,command:"addPersonAfter",args:{pointer:e.newValue}}})}}):(0,c().t1)(e)})(e)},onDismiss:()=>{l&&i.close()},parentStore:t,isTemplatePage:!1,formQuestionStore:void 0})}var I=()=>i(816563);function Z(e){const{parent:t,blockStore:i}=e,[r,n]=(0,o.useState)("mainVerificationMenu");return"mainVerificationMenu"===r?(0,B.jsx)(j,{parent:t,blockStore:i,setVerificationMenuDisplay:n}):"owner"===r?(0,B.jsx)(K,{blockStore:i,parent:t,setVerificationMenuDisplay:n}):"expiration"===r?(0,B.jsx)(N,{parent:t,blockStore:i,setVerificationMenuDisplay:n}):void(0,c().t1)(r)}function K(e){const{parent:t,blockStore:i,setVerificationMenuDisplay:o}=e,n=(0,r().O7)(),a=(0,s().YB)(),c=n.device.isMobile;return(0,B.jsxs)(B.Fragment,{children:[!c&&(0,B.jsx)(I().H,{label:z(a,"owner"),onClickBackButton:()=>o("mainVerificationMenu"),onClose:()=>t.close(),showBottomBorder:!0,width:350}),(0,B.jsx)(E,{blockStore:i,parent:t})]})}function N(e){const{parent:t,blockStore:i,setVerificationMenuDisplay:o}=e,c=(0,r().O7)(),p=(0,s().YB)(),f=c.device.isMobile,u=(0,n().VK)((()=>i.getPropertyStore(a().EI.Verification).getValue()),[i]);return(0,B.jsx)(l().O,{propertyName:"Verification Status",onChange:e=>{(e=>{d().O({environment:c,blockStore:i,verificationValue:e.value})})(e)},verificationValue:(0,a()._w)(u),getRecordModel:i.getRecordModel,blockId:i.id,onClose:()=>{t.close()},showTitle:f,showRemoveVerificationButton:f,showVerificationFooter:f,showCurrentStatusHeader:f,showCustomHeader:!f,customHeader:!f&&(0,B.jsx)(I().H,{label:z(p,"expiration"),onClickBackButton:()=>o("mainVerificationMenu"),onClose:()=>t.close(),showBottomBorder:!0,width:320})})}function z(e,t){return"expiration"===t?e.formatMessage(R.expirationProperty):"owner"===t?e.formatMessage(R.verifierProperty):"mainVerificationMenu"===t?null:void(0,c().t1)(t)}},333068:(e,t,i)=>{i.d(t,{O:()=>l,T:()=>c});var o=()=>i(532850),r=()=>i(989478),n=()=>i(970105),a=()=>i(269299),s=()=>i(90065);function c(e){const{environment:t,blockStore:i,verificationValue:c}=e,l=i.getPropertyStore(s().EI.Verification),d=(0,o().Tp)(c),p=i.getPropertyStore(s().EI.Owner),f=t.currentUser.id,u=f?{table:r().KJ,id:f}:void 0;a().createAndCommit({userAction:"PageAddVerificationButton.verifyPage",environment:t,canUndo:!0,perform:e=>{n().sO({environment:t,store:l,value:d,transaction:e}),u&&a().applyOperation({transaction:e,store:p,operation:{path:p.path,pointer:p.pointer,command:"addPersonAfter",args:{pointer:u}}})}})}function l(e){const{environment:t,blockStore:i,verificationValue:r}=e,c=i.getPropertyStore(s().EI.Verification),l=(0,o().Tp)(r);a().createAndCommit({userAction:"PageVerificationBadge.updatePageVerification",environment:t,canUndo:!0,perform:e=>{n().sO({environment:t,store:c,value:l,transaction:e})}})}}}]);