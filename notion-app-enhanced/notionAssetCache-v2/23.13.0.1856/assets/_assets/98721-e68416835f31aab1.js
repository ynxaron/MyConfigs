"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[98721],{298721:(e,t,r)=>{r.d(t,{cG:()=>U,po:()=>O,a7:()=>K,mH:()=>$,nD:()=>E,_O:()=>L,Q0:()=>j,cz:()=>A,bc:()=>P});r(821057),r(670560),r(122556),r(582845),r(250570),r(533019),r(721473),r(788208),r(22624),r(267602),r(470928),r(749411),r(241792);var n=()=>r(730120),i=()=>r(704923),o=()=>r(666908),a=()=>r(998411),s=()=>r(741633),c=()=>r(255933),p=()=>r(325490),l=()=>r(28070),u=()=>r(989478),d=()=>r(361929),m=()=>r(255393),y=()=>r(955620),f=()=>r(783190),b=()=>r(956898),h=()=>r(513670),g=()=>r(342792);const v=(0,r(830742).LS)("runInferenceTranscriptQueue");var x=()=>r(824462),k=()=>r(959137),w=()=>r(308186),q=()=>r(782646),_=()=>r(636340),I=()=>r(269299),S=()=>r(254940),T=()=>r(876822),C=()=>r(965014),M=()=>r(404791),N=()=>r(144628);function O(e){const{clientStore:t}=e;t.setState({showHistory:t.state.showHistory,showDebug:t.state.showDebug,config:t.state.config,inferences:[],acceptedInferenceKeys:[],inferenceKeysToAnnotations:{},inferenceKeysToMemories:{},abortController:void 0,model:t.state.model,loading:!1,stopInferencePromise:void 0,temporarySteps:[],tags:[],traceId:void 0})}function j(e){var t;const{threadStore:r,transaction:n,clientStore:i}=e;null===(t=i.state.abortController)||void 0===t||t.abort(),_().sW({store:r,data:{current_inference_id:null,current_inference_lease_expiration:null},transaction:n})}function A(e){const{environment:t,value:r,clientStore:i,spaceStore:o,userStore:s,config:c,additionalSteps:p,threadStore:l,threadId:u,workflowStore:d}=e,m=t.currentUser.id??(null==s?void 0:s.id);if(!m)throw new Error("No current user");const f=l?l.getTranscript():[],b=f.find((e=>"config"===e.type)),h=f.find((e=>"context"===e.type)),v=[...b?[]:[{id:(0,g().ZP)(),type:"config",value:c}],...h?[]:[{id:(0,g().ZP)(),type:"context",value:{timezone:(0,a().r)(),userName:null==s?void 0:s.getName(),spaceName:o.getName(),currentDatetime:n().ou.now().toISO()}}],...p,{id:(0,g().ZP)(),type:"user",value:(0,y().Aqt)(r),userId:m}];if(!l)return void E({environment:t,clientStore:i,threadStore:void 0,threadCommitResult:void 0,createThreadArgs:{threadId:u,transcript:v,workflowId:null==d?void 0:d.id}});const{serverCommitResult:x}=I().createAndCommit({userAction:"FullPageAI.handleSubmit",environment:t,canUndo:!0,perform:e=>{const r=l.getMessages()??[],n=D({environment:t,threadId:u,spaceStore:o,userId:m,transcript:v,transaction:e});_().sW({store:l,data:{messages:[...r,...n]},transaction:e})}});E({environment:t,clientStore:i,threadStore:l,threadCommitResult:x})}function D(e){const{environment:t,threadId:r,spaceStore:n,userId:i,transcript:o,transaction:a}=e;return o.map((e=>_().ae({environment:t,table:l().xu,value:{id:e.id.toString(),parent_id:r,parent_table:p().kL,space_id:n.id,step:e,created_by_id:i,created_by_table:u().KJ,created_time:Date.now()},transaction:a,inMemoryRecordCache:n.inMemoryRecordCache}).id))}function $(e){const{threadStore:t,stepIndex:r,transaction:n}=e;_().sW({store:t,data:{messages:t.getMessages().slice(0,r+1)},transaction:n})}function P(e){const{threadStore:t,stepIndex:r,transaction:n,newValue:i}=e,o=t.getStepStoreAt(r);o&&_().sW({store:o,data:{value:i},transaction:n})}function K(e){const{threadStore:t,stepIndex:r,transaction:n,stepKey:i}=e,o=t.getStepStoreAt(r),a=null==o?void 0:o.getValue();if(!o||"researcher-plan"!==(null==a?void 0:a.type))return;const s=new Set;s.add(i);for(const c in a.value){const e=a.value[c];for(const t of e.dependentKeys??[])s.has(t)&&s.add(e.key);if(s.has(e.key)){const t={key:e.key,agent:e.agent,question:e.question,additionalContextForAgent:e.additionalContextForAgent,dependentKeys:e.dependentKeys,status:"not-started",timestampStartMs:Date.now(),timestampEndMs:0};a.value[c]=t}}_().sW({store:o,data:{...a,type:"researcher-plan-replay-from-previous"},transaction:n}),$({threadStore:t,stepIndex:r,transaction:n})}async function E(e){var t,r;const{clientStore:n,environment:i,threadStore:a,createThreadArgs:m,threadCommitResult:y}=e,{model:f}=n.state,h=(null==a?void 0:a.getTranscript())??(null==m?void 0:m.transcript)??[];if(0===h.length)throw new Error("No transcript");const k=null===(t=T().default.state.currentSpaceStore)||void 0===t?void 0:t.id;if(!k)throw new Error("No space id");const S=(null==a?void 0:a.id)??(null==m?void 0:m.threadId);if(!S)throw new Error("No thread id");const{cachedInferences:C,annotationInferences:M}=(0,N().h)(n),O=new AbortController,j={};for(const o of C){if(!o.value.expected)throw new Error("No expected output for cached inference");j[o.key]=o.value.expected}const A={};for(const o of M)o.value.input.annotation&&(A[o.key]=o.value.input.annotation);const $=(0,g().ZP)();n.setState({...n.state,loading:!0,inferences:[],temporarySteps:(null==m?void 0:m.transcript)??[],abortController:O,traceId:$}),n.state.stopInferencePromise&&(await n.state.stopInferencePromise,n.setState({...n.state,stopInferencePromise:void 0}));const P=Boolean(null==a||null===(r=a.getData())||void 0===r?void 0:r.title),K=(0,o().Lo)(h),E={traceId:$,spaceId:k,transcript:h,threadId:S,workflowId:null==m?void 0:m.workflowId,createThread:void 0===a,debugOverrides:{cachedInferences:j,annotationInferences:A,model:f,emitInferences:n.state.showDebug},generateTitle:!P};try{K?await async function(e){var t;const{environment:r,abortController:n,clientStore:i,request:o,threadCommitResult:a}=e;a&&await a;o.createThread&&o.threadId&&await async function(e){const{environment:t,spaceStore:r,transcript:n,workflowId:i,threadId:o}=e,a=t.currentUser.id;if(!a)throw new Error("No current user");const s=i?{table:d().An,id:i,spaceId:r.id}:{table:c().bx,id:r.id,spaceId:r.id},{performResult:l,serverCommitResult:m}=I().createAndCommit({userAction:"inferenceTranscriptActions.createThread",environment:t,canUndo:!0,perform:e=>{const i=D({environment:t,threadId:o,spaceStore:r,userId:a,transcript:n,transaction:e});return _().ae({environment:t,table:p().kL,value:{id:o,parent_id:s.id,parent_table:s.table,space_id:s.spaceId,messages:i,created_time:Date.now(),created_by_id:a,created_by_table:u().KJ},transaction:e,inMemoryRecordCache:r.inMemoryRecordCache})}});return await m,l}({environment:r,threadId:o.threadId,spaceStore:T().default.state.currentSpaceStore,transcript:o.transcript,workflowId:o.workflowId});const s=(0,q().Lj)(r,v,{...o,createThread:!1,transcript:[]});if(null===(t=o.debugOverrides)||void 0===t||!t.emitInferences){const e=await s.next();if(e.value.error)throw e.value.error;return}(async()=>{try{for await(const e of s){if(e.error)throw e.error;const t=e.value.step;t&&Y(i,t)}}catch(e){if(R(n,e))return;throw e}})()}({environment:i,abortController:O,clientStore:n,request:E,threadCommitResult:y}):await async function(e){const{environment:t,abortController:r,clientStore:n,request:i}=e,o=await x().callStreamApi({eventName:"runInferenceTranscript",environment:t,data:i,abortSignal:r.signal,headers:(0,s().Bb)({spaceId:i.spaceId})});if("failed"===o.type)throw o.error;if(b().H1.is(o.data))for await(const a of o.data)Y(n,a)}({environment:i,abortController:O,clientStore:n,request:E})}catch(L){R(O,L)?function(e){const{environment:t,clientStore:r,threadId:n,spaceId:i}=e,{currentUserStore:o}=T().default.state;if(!o)throw new Error("No current user root store");I().createAndCommit({userAction:"inferenceTranscriptActions.handleAbort",environment:t,perform:e=>{for(const a of r.state.temporarySteps)_().ae({environment:t,table:l().xu,value:{id:a.id.toString(),parent_id:n,parent_table:p().kL,space_id:i,step:a,created_by_id:o.id,created_by_table:u().KJ,created_time:Date.now()},transaction:e,inMemoryRecordCache:o.inMemoryRecordCache})}})}({environment:i,clientStore:n,threadId:S,spaceId:k}):w().PV({message:L instanceof Error?L.message:"Unknown error"})}n.setState({...n.state,loading:!1,abortController:void 0})}function R(e,t){return t instanceof Error&&"AbortError"===t.name&&e.signal.aborted}function Y(e,t){if("inference"===t.type){const r={type:"inference",key:(0,f().o_)(t.value.input),index:t.index,value:t.value,isFinal:!1},n=h().MR([...e.state.inferences,r],(e=>e.index));e.setState({...e.state,inferences:n})}else if("final_inferences"===t.type){const r=new Set(t.inferenceKeys);e.setState({...e.state,inferences:e.state.inferences.map((e=>({...e,isFinal:r.has(e.key)})))})}else{const{temporarySteps:r}=e.state,n=(0,o().q3)(r,t);e.setState({...e.state,temporarySteps:n})}}async function L(e){var t;const{environment:r,onResponse:n,data:i,userId:o,tracking:a,abortSignal:c,upsellFrom:p}=e,l=()=>{(0,C().y)(r,{upsell:{type:"product",product:"ai",limit:{type:"none"}},from:p})},u=M().Z.state;if(!1===(null==u?void 0:u.isEligible))return l(),{error:new(m().vU)};const d=await x().callStreamApi({eventName:"runInferenceTranscript",environment:r,data:i,userId:o,tracking:a,abortSignal:c,headers:(0,s().Bb)({spaceId:i.spaceId})});if("success"!==d.type)return w().x2(d),{error:d.error};const y=[];if(b().H1.is(d.data))for await(const s of d.data){if("error"===s.type)return(0,m().lX)(s.errorCode)?(l(),{error:new(m().vU)}):{error:new Error(s.message)};null==n||n(s),y.push(s)}const f=null===(t=T().default.state.currentSpaceStore)||void 0===t?void 0:t.id;return f&&(0,S().maybeUpdateAiEligibility)(r,f),{value:y}}async function U(e){const{environment:t,step:r}=e;let n;if("markdown-chat"===r.type||"fast-researcher-chat"===r.type||"search-chat"===r.type)n=r.value;else{if("workflow-inference"!==r.type)throw new Error("Unsupported step type");n=(0,i().Ms)(r.value).flatMap((e=>"text"===e.type?[e.content]:[])).join("")}const o=await k().F.clipboardActions.load();await o.copyString({environment:t,stringValue:n,copiedMessage:o.clipboardMessages.copiedQnAMessageToClipboard})}},144628:(e,t,r)=>{r.d(t,{G:()=>a,h:()=>o});r(122556),r(582845),r(250570),r(533019),r(721473),r(788208),r(22624),r(267602),r(653476),r(470928),r(241792);var n=()=>r(513670),i=()=>r(696459);function o(e){const{inferences:t,inferenceKeysToAnnotations:r,acceptedInferenceKeys:i}=e.state,o=new Map;for(const n of t)o.set(n.key,n);return{cachedInferences:n().oA(i.map((e=>o.get(e)))),annotationInferences:n().oA(Object.entries(r).map((e=>{let[t,r]=e;const n=o.get(t);if(n)return{...n,value:{...n.value,input:{...n.value.input,annotation:r}}}})))}}function a(e){const{clientStore:t,threadStore:r}=e,n=((null==r?void 0:r.getMessageStores())??[]).map((e=>e.getStep())).filter(i().$K)??[],o=new Set(n.map((e=>e.id))),a=t.state.temporarySteps;return[...n.map((e=>a.find((t=>t.id===e.id))??e)),...a.filter((e=>!o.has(e.id)))].filter((e=>"title"!==e.type))}},704923:(e,t,r)=>{r.d(t,{De:()=>l,Kz:()=>p,Ms:()=>u,Th:()=>n});r(670560),r(241792);const n=12e3,i=["openai-gpt-4o","openai-chatgpt-4o-latest","openai-gpt-4o-mini","openai-o1","openai-o1-mini","openai-o3-mini"];const o=["anthropic-haiku","anthropic-haiku-3.5","anthropic-sonnet","anthropic-sonnet-latest","anthropic-opus"];const a=["vertex-gemini-1.5-pro","vertex-gemini-1.5-flash","vertex-gemini-2.0-flash"];const s=["groq-gemma2-9b-it","groq-gemma-7b-it","groq-llama-70b","groq-llama-8b","groq-mixtral"];const c=["fireworks-llama3.1-405b","fireworks-llama3.1-70b","fireworks-llama3.3-70b","fireworks-llama3.3-70b-dedicated","fireworks-llama3.1-8b","fireworks-llama3-70b","fireworks-mixtral-22b","fireworks-mixtral-7b","fireworks-ft-router-101","fireworks-ft-router-102","fireworks-deepseek-v3","fireworks-deepseek-r1"];const p=[...i,...o,...a,...s,...c,"default"];function l(e){const t=[];for(const r of e){const e=t[t.length-1];e?"text"===r.type&&"text"===e.type?t[t.length-1]={type:"text",content:e.content+r.content}:"tool_use"===r.type&&"tool_use"===e.type&&r.id===e.id?t[t.length-1]={type:"tool_use",id:r.id,name:r.name,content:e.content+r.content}:t.push({...r}):t.push({...r})}return t}function u(e){return"string"==typeof e?[{type:"text",content:e}]:e}},666908:(e,t,r)=>{r.d(t,{Lo:()=>l,V8:()=>s,eQ:()=>c,q3:()=>p});r(159867),r(93383),r(670560),r(267602),r(653476),r(470928),r(749411),r(228244);var n=()=>r(513670),i=()=>r(696459),o=()=>r(176233),a=()=>r(379079);const s="inference-saved-examples";function c(e){return"researcher"===e?"development-researcher":"development-workflow-editor"}function p(e,t){const r={};for(const n of e)"registered-tool-grouping"===n.type&&(r[n.toolCallId]=n);let s=[...e];if("config"===t.type||"user"===t.type||"error"===t.type||"context"===t.type||"workflow-run-context"===t.type||"workflow-error"===t.type||"title"===t.type||"retry"===t.type||"autocorrect"===t.type||"search-observation"===t.type||"researcher-plan-step-update"===t.type||"researcher-plan-update"===t.type||"researcher-next-steps"===t.type||"researcher-plan-replay-from-previous"===t.type||"researcher-text-observation"===t.type||"debug-inference"===t.type||"search-queries"===t.type||"search-results"===t.type||"fast-researcher-plan"===t.type||"fast-researcher-search-results"===t.type||"memory-agent"===t.type||"summarize-transcript"===t.type||"summarize-transcript-response"===t.type)s.push({...t});else if("workflow-inference"===t.type)s=[...s.filter((e=>e.id!==t.id)),{...t}];else if("workflow-function-call-results"===t.type){const e=s.findLastIndex((e=>e.id===t.id));if(-1!==e&&"workflow-function-call-results"===s[e].type){const r=s[e];s[e]={...r,value:[...r.value,...t.value]}}else s.push({...t})}else if("markdown-chat"===t.type){const e=s.findLastIndex((e=>e.id===t.id));if(-1!==e&&"markdown-chat"===s[e].type){const r=s[e];s[e]={...r,value:`${r.value}${t.value}`}}else s.push({...t})}else if("search-chat"===t.type){const e=s.findLastIndex((e=>e.id===t.id));if(-1!==e&&"search-chat"===s[e].type){const r=s[e];s[e]={...r,value:`${r.value}${t.value}`}}else s.push({...t})}else if("fast-researcher-chat"===t.type){const e=s.findLastIndex((e=>e.id===t.id));if(-1!==e&&"fast-researcher-chat"===s[e].type){const r=s[e];s[e]={...r,value:`${r.value}${t.value}`}}else s.push({...t})}else if("workflow"===t.type){const e=s.filter((e=>"workflow"===e.type));s=[...s.filter((e=>"workflow"!==e.type)),{...t,progressSteps:[...e.flatMap((e=>e.progressSteps||[])),...t.progressSteps||[]]}]}else if("setup"===t.type||"researcher-plan"===t.type)s=n().mN([...s,t].reverse(),(e=>e.id)).reverse();else if("researcher-report"===t.type){const e=s.findLastIndex((e=>e.id===t.id));if(-1!==e&&"researcher-report"===s[e].type){const r=s[e];s[e]={...r,value:`${r.value}${t.value}`,citationInfo:(0,a().ZO)(r.citationInfo,t.citationInfo)}}else s.push({...t})}else if("researcher-agent"===t.type){const e=s.findIndex((e=>e.id===t.id));-1!==e?n().TS(s[e],t):s.push({...t})}else if("registered-tool-call"===t.type||"registered-tool-output"===t.type||"registered-tool-error"===t.type){let e=r[t.toolCallId];e||(e={id:t.toolCallId,type:"registered-tool-grouping",toolName:t.toolName,toolCallId:t.toolCallId,steps:[]},r[t.toolCallId]=e,s.push(e));const n={...t};e.steps.push(n)}else if("registered-tool-grouping"===t.type)r[t.toolCallId]||(r[t.toolCallId]=t,s.push({...t}));else if("setup-operations"===t.type){const e=s.findLastIndex((e=>e.id===t.id)),r=s[e];(null==r?void 0:r.type)===t.type?s[e]={...r,operations:[...r.operations,...t.operations]}:s.push({...t})}else if((0,o().Xr)(t)||(0,o().qb)(t)||(0,o().Y)(t)||(0,o().NK)(t)||(0,o().SX)(t)||(0,o().zZ)(t)||(0,o().cz)(t))s.push({...t});else if((0,o().Zn)(t)){const e=s.findLast((e=>e.id===t.id));"assistant"===(null==e?void 0:e.type)?e.value=`${e.value}${t.value}`:s.push({...t})}else(0,i().t1)(t);return s}function l(e){const t=e.find((e=>"config"===e.type)),r=e[e.length-1];return"researcher"===(null==t?void 0:t.value.type)&&!0===t.value.runInQueue||!("workflow"!==(null==t?void 0:t.value.type)||"workflow-inference"!==r.type||"workflowAgent8"!==r.inferenceType||!r.updateWorkflow)}},379079:(e,t,r)=>{r.d(t,{FR:()=>n,ZO:()=>o,jH:()=>i});r(670560),r(122556),r(582845),r(250570),r(533019),r(721473),r(788208),r(22624),r(267602),r(653476),r(470928),r(241792),r(228244);function n(e){let t=1;return e.replace(/\[(.*?)\|(.*?)\]/g,((e,r,n)=>{const i=encodeURIComponent(r),o=encodeURIComponent(n);return`[**[${t++}]**](#citation:${i}|${o})`}))}function i(e){return e.replace(/(\s)?\[\*\*\[\d+\]\*\*\]\(#citation:[^)]+\)/g,"")}function o(e,t){const r={stepCitations:{...e.stepCitations}};for(const[n,i]of Object.entries(t.stepCitations)){if(!r.stepCitations[n]){r.stepCitations[n]={claims:[...i.claims],artifacts:[...i.artifacts]};continue}const e=new Set(r.stepCitations[n].claims.map((e=>e.id)));for(const o of i.claims)e.has(o.id)||r.stepCitations[n].claims.push(o);const t=new Set(r.stepCitations[n].artifacts.map((e=>e.id)));for(const o of i.artifacts)t.has(o.id)||r.stepCitations[n].artifacts.push(o)}return r}},176233:(e,t,r)=>{r.d(t,{Fh:()=>h,GS:()=>y,J4:()=>s,NK:()=>u,SX:()=>m,Xr:()=>b,Y:()=>d,Zn:()=>f,cz:()=>p,q_:()=>g,qb:()=>l,yt:()=>a,zZ:()=>c});r(821057),r(267602),r(470928),r(749411);var n=()=>r(696459),i=()=>r(175882),o=()=>r(815292);const a=(0,n().AO)((e=>"context"===e.type?{true:e}:{false:e})),s=(0,n().AO)((e=>"instructions"===e.type?{true:e}:{false:e})),c=(0,n().AO)((e=>"observation"===e.type&&"error"===e.observationType?{true:e}:{false:e})),p=(0,n().AO)((e=>"observation"===e.type&&"warning"===e.observationType?{true:e}:{false:e})),l=(0,n().AO)((e=>"observation"===e.type&&"page"===e.observationType?{true:e}:{false:e})),u=(0,n().AO)((e=>"observation"===e.type&&"search"===e.observationType?{true:e}:{false:e})),d=(0,n().AO)((e=>"observation"===e.type&&"database"===e.observationType?{true:e}:{false:e})),m=(0,n().AO)((e=>"observation"===e.type&&"queryDatabase"===e.observationType?{true:e}:{false:e}));(0,n().AO)((e=>"observation"===e.type&&"pagesFromQueryDatabase"===e.observationType?{true:e}:{false:e}));function y(e){const t=new Error(e.value);return e.stack&&(t.stack=e.stack),t}const f=(0,n().AO)((e=>"assistant"===e.type?{true:e}:{false:e})),b=(0,n().AO)((e=>"human"===e.type?{true:e}:{false:e}));function h(e){return"observation"===e.type&&"attachment"===e.observationType}function g(e){const t=(0,o().P5)(e.value.summary.value)[0];if(!t||"element"!==t.type)return"invalid summary node";const r=e.value.pages.flatMap((e=>(0,o().P5)(e.value))),n={...t,children:[...t.children??[],...r]};return(0,i().KT)(n)}},413880:(e,t,r)=>{r.d(t,{B5:()=>u,CC:()=>x,JV:()=>D,Lv:()=>P,RI:()=>$,S5:()=>N,ST:()=>L,Se:()=>_,WC:()=>f,Wf:()=>K,X_:()=>U,ZK:()=>m,_B:()=>j,c8:()=>h,dn:()=>c,eT:()=>s,hs:()=>E,mI:()=>Y,ou:()=>R,pX:()=>T,sj:()=>M,t:()=>d,v:()=>C,x:()=>z,xD:()=>O,yD:()=>p,yV:()=>A,zh:()=>l});r(241792);var n=r.n(r(467266)),i=()=>r(342792),o=()=>r(696459),a=()=>r(956057);(0,o().AO)((e=>"element"===e.type?{true:e}:{false:e}));const s={default:"default",gray:"gray",brown:"brown",orange:"orange",yellow:"yellow",teal:"green",blue:"blue",purple:"purple",pink:"pink",red:"red",default_background:"default-background",gray_background:"gray-background",brown_background:"brown-background",orange_background:"orange-background",yellow_background:"yellow-background",teal_background:"green-background",blue_background:"blue-background",purple_background:"purple-background",pink_background:"pink-background",red_background:"red-background"},c=Object.fromEntries(Object.entries(s).map((e=>{let[t,r]=e;return[r,t]}))),p=Object.values(s),l=["mention-page","mention-database","mention-person","mention-assistant","mention-date","mention-datetime","mention-date-range","mention-datetime-range","mention-link"],u=["b","i","code","s","u","a","h","e",...l],d={b:{attributes:{},inline:u,text:!0,isToken:!1},i:{attributes:{},inline:u,text:!0,isToken:!1},code:{attributes:{},inline:u,text:!0,isToken:!1},s:{attributes:{},inline:u,text:!0,isToken:!1},u:{attributes:{},inline:u,text:!0,isToken:!1},a:{attributes:{href:{required:!0,values:!0,description:"link URL. Do not link to any URLs that are not already in the current context.",mappingMode:"href_counter"},type:{required:!1,values:r(48826).Y,description:"universal source type"},"external-id":{required:!1,values:!0,description:"ID for loadable external resource",mappingMode:"external_id_counter"}},inline:u,text:!0,isToken:!1},h:{attributes:{color:{required:!0,values:p,description:"text color"}},inline:u,text:!0,isToken:!1},e:{attributes:{equation:{required:!0,values:!0,description:"LaTeX equation string"}},inline:[],text:!0,isToken:!0},"mention-page":{attributes:{"page-id":{required:!0,values:!0,description:"ID of page",mappingMode:"block_counter"}},inline:[],text:!0,isToken:!0},"mention-link":{attributes:{href:{required:!0,values:!0,description:"link URL. Do not link to any URLs that are not already in the current context."},title:{required:!1,values:!0,description:"Linked page title"},icon_url:{required:!1,values:!0,description:"Favicon. Do not edit this field."},description:{required:!1,values:!0,description:"Linked page description. Do not edit this field."}},inline:[],text:!0,isToken:!0},"mention-database":{attributes:{"database-id":{required:!0,values:!0,description:"ID of database",mappingMode:"collection_counter"}},inline:[],text:!0,isToken:!0},"mention-person":{attributes:{"person-id":{required:!0,values:!0,description:"ID of person",mappingMode:"person_counter"},"person-name":{required:!1,values:!0,description:"Name of person"}},inline:[],text:!0,isToken:!0},"find-person":{attributes:{name:{required:!0,values:!0,description:"Name of person"}},inline:[],text:!0,isToken:!0},"mention-assistant":{attributes:{},inline:[],text:!0,isToken:!0},"mention-date":{attributes:{date:{required:!0,values:!0,description:"Date in ISO 8601 (YYYY-MM-DD) format"}},inline:[],text:!1,isToken:!1},"mention-datetime":{attributes:{date:{required:!0,values:!0,description:"Date in ISO 8601 (YYYY-MM-DD) format"},time:{required:!0,values:!0,description:"Time in ISO 8601 (HH:MM) format"}},inline:[],text:!1,isToken:!1},"mention-date-range":{attributes:{"start-date":{required:!0,values:!0,description:"Start date in ISO 8601 (YYYY-MM-DD) format"},"end-date":{required:!0,values:!0,description:"End date in ISO 8601 (YYYY-MM-DD) format"}},inline:[],text:!1,isToken:!1},"mention-datetime-range":{attributes:{"start-date":{required:!0,values:!0,description:"Start date in ISO 8601 (YYYY-MM-DD) format"},"end-date":{required:!0,values:!0,description:"End date in ISO 8601 (YYYY-MM-DD) format"},"start-time":{required:!0,values:!0,description:"Start time in ISO 8601 (HH:MM) format"},"end-time":{required:!0,values:!0,description:"End time in ISO 8601 (HH:MM) format"}},inline:[],text:!1,isToken:!1},option:{attributes:{option:{values:!0,description:"Option name",required:!0}},inline:[],text:!1,isToken:!1},"option-category":{attributes:{category:{values:!0,description:"Status category",required:!0}},inline:[],text:!1,isToken:!1},"schema-option":{attributes:{option:{values:!0,description:"Option name",required:!0}},inline:[],text:!1,isToken:!1},"schema-option-category":{attributes:{category:{values:!0,description:"Status category",required:!0}},inline:["schema-option"],text:!1,isToken:!1}},m={"property-title":{text:!0,inline:l,attributes:{}},"property-text":{text:!0,inline:u,attributes:{}},"property-url":{text:!0,inline:[],attributes:{}},"property-email":{text:!0,inline:[],attributes:{}},"property-phone-number":{text:!0,inline:[],attributes:{}},"property-person":{text:!1,inline:["mention-person","find-person"],attributes:{}},"property-date":{text:!1,inline:["mention-date","mention-date-range","mention-datetime","mention-datetime-range"],attributes:{}},"property-created-time":{text:!1,inline:["mention-date","mention-datetime"],attributes:{}},"property-last-edited-time":{text:!1,inline:["mention-date","mention-datetime"],attributes:{}},"property-created-by":{text:!1,inline:["mention-person"],attributes:{}},"property-last-edited-by":{text:!1,inline:["mention-person"],attributes:{}},"property-checkbox":{text:!1,inline:[],attributes:{checked:{values:["true","false"],description:'checked state, either "true" or "false"',required:!0}}},"property-select":{text:!1,inline:["option"],attributes:{}},"property-multi-select":{text:!1,inline:["option"],attributes:{}},"property-relation":{text:!1,inline:["mention-page"],attributes:{"database-id":{values:!0,description:"The database ID the relation points to",required:!1,mappingMode:"collection_counter"}}},"property-status":{text:!1,inline:["option"],attributes:{}},"property-number":{text:!1,inline:[],attributes:{number:{values:!0,description:"value",required:!1}}}},y=(0,o().Yd)(m),f={"schema-property-title":{propertyTagName:"property-title",inline:[],attributes:{}},"schema-property-text":{propertyTagName:"property-text",inline:[],attributes:{}},"schema-property-url":{propertyTagName:"property-url",inline:[],attributes:{}},"schema-property-email":{propertyTagName:"property-email",inline:[],attributes:{}},"schema-property-phone-number":{propertyTagName:"property-phone-number",inline:[],attributes:{}},"schema-property-person":{propertyTagName:"property-person",inline:[],attributes:{limit:{values:["1","Infinity"],description:"The number of options that can be added",required:!0}}},"schema-property-date":{propertyTagName:"property-date",inline:[],attributes:{}},"schema-property-created-time":{propertyTagName:"property-created-time",inline:[],attributes:{}},"schema-property-last-edited-time":{propertyTagName:"property-last-edited-time",inline:[],attributes:{}},"schema-property-created-by":{propertyTagName:"property-created-by",inline:[],attributes:{}},"schema-property-last-edited-by":{propertyTagName:"property-last-edited-by",inline:[],attributes:{}},"schema-property-checkbox":{propertyTagName:"property-checkbox",inline:[],attributes:{}},"schema-property-select":{propertyTagName:"property-select",inline:["schema-option"],attributes:{}},"schema-property-multi-select":{propertyTagName:"property-multi-select",inline:["schema-option"],attributes:{}},"schema-property-relation":{propertyTagName:"property-relation",inline:["mention-page"],attributes:{limit:{values:["1","Infinity"],description:"The number of options that can be added",required:!0},"database-id":{values:!0,description:"The database ID the relation points to",required:!0,mappingMode:"collection_counter"},"synced-property-name":{required:!1,values:!0,description:"The symmetric relation property name in the database this relation points to"}}},"schema-property-status":{propertyTagName:"property-status",inline:["schema-option-category"],attributes:{}},"schema-property-number":{propertyTagName:"property-number",inline:[],attributes:{format:{values:!0,description:"Number format",required:!1}}}},b={is:{text:!1,inline:["mention-date"],attributes:{}},">":{text:!1,inline:["mention-date"],attributes:{}},"<":{text:!1,inline:["mention-date"],attributes:{}},"≥":{text:!1,inline:["mention-date"],attributes:{}},"≤":{text:!1,inline:["mention-date"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},h={"property-title":{is:{text:!0,inline:[],attributes:{}},contains:{text:!0,inline:[],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-text":{is:{text:!0,inline:[],attributes:{}},contains:{text:!0,inline:[],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-url":{is:{text:!0,inline:[],attributes:{}},contains:{text:!0,inline:[],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-email":{is:{text:!0,inline:[],attributes:{}},contains:{text:!0,inline:[],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-phone-number":{is:{text:!0,inline:[],attributes:{}},contains:{text:!0,inline:[],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-person":{contains:{text:!1,inline:["mention-person","find-person"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-date":b,"property-created-time":b,"property-last-edited-time":b,"property-created-by":{contains:{text:!1,inline:["mention-person"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-last-edited-by":{contains:{text:!1,inline:["mention-person"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-checkbox":{is:{text:!1,inline:[],attributes:{checked:{values:["true","false"],description:'checked state, either "true" or "false"',required:!0}}}},"property-select":{is:{text:!1,inline:["option"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-multi-select":{contains:{text:!1,inline:["option"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-relation":{contains:{text:!1,inline:["mention-page"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-status":{is:{text:!1,inline:["option","option-category"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-number":{is:{text:!1,inline:[],attributes:{number:{values:!0,description:"value",required:!0}}},">":{text:!1,inline:[],attributes:{number:{values:!0,description:"value",required:!0}}},"<":{text:!1,inline:[],attributes:{number:{values:!0,description:"value",required:!0}}},"≥":{text:!1,inline:[],attributes:{number:{values:!0,description:"value",required:!0}}},"≤":{text:!1,inline:[],attributes:{number:{values:!0,description:"value",required:!0}}},"is empty":{text:!1,inline:[],attributes:{}}}},g=["Count all"],v=["Count values","Count unique values","Count empty","Count not empty","Percent empty","Percent not empty","Show unique values"],x={"Count all":"count","Count values":"count_values","Count unique values":"unique","Count empty":"empty","Count not empty":"not_empty","Percent empty":"percent_empty","Percent not empty":"percent_not_empty","Show unique values":"show_unique","Count checked":"checked","Count unchecked":"unchecked","Percent checked":"percent_checked","Percent unchecked":"percent_unchecked","Count per group":"count_per_group","Percent per group":"percent_per_group",Sum:"sum",Average:"average",Median:"median",Min:"min",Max:"max",Range:"range","Earliest date":"earliest_date","Latest date":"latest_date","Date range":"date_range"},k={basic:[...g,...v],date:[...g,...v,"Earliest date","Latest date","Date range"],status:[...g,...v,"Count per group","Percent per group"],number:[...g,...v,"Sum","Average","Median","Min","Max","Range"],checkbox:[...g,"Count checked","Count unchecked","Percent checked","Percent unchecked"]};function w(e){return`the name of the ${e} property being aggregated`}function q(e){return`the method of aggregation for the ${e} property`}const _={"aggregation-property-title":{attributes:{name:{required:!0,values:!0,description:w("title")},aggregation:{values:k.basic,required:!0,description:q("title")}}},"aggregation-property-text":{attributes:{name:{required:!0,values:!0,description:w("text")},aggregation:{values:k.basic,required:!0,description:q("text")}}},"aggregation-property-url":{attributes:{name:{required:!0,values:!0,description:w("url")},aggregation:{values:k.basic,required:!0,description:q("url")}}},"aggregation-property-email":{attributes:{name:{required:!0,values:!0,description:w("email")},aggregation:{values:k.basic,required:!0,description:q("email")}}},"aggregation-property-phone-number":{attributes:{name:{required:!0,values:!0,description:w("phone_number")},aggregation:{values:k.basic,required:!0,description:q("phone_number")}}},"aggregation-property-date":{attributes:{name:{values:!0,required:!0,description:w("date")},aggregation:{values:k.date,required:!0,description:q("date")}}},"aggregation-property-created-time":{attributes:{name:{values:!0,required:!0,description:w("created-time")},aggregation:{values:k.date,required:!0,description:q("created-time")}}},"aggregation-property-last-edited-time":{attributes:{name:{values:!0,required:!0,description:w("last-edited-time")},aggregation:{values:k.date,required:!0,description:q("last-edited-time")}}},"aggregation-property-person":{attributes:{name:{values:!0,required:!0,description:w("person")},aggregation:{values:k.basic,required:!0,description:q("person")}}},"aggregation-property-created-by":{attributes:{name:{values:!0,required:!0,description:w("created-by")},aggregation:{values:k.basic,required:!0,description:q("created-by")}}},"aggregation-property-last-edited-by":{attributes:{name:{values:!0,required:!0,description:w("last-edited-by")},aggregation:{values:k.basic,required:!0,description:q("last-edited-by")}}},"aggregation-property-checkbox":{attributes:{name:{values:!0,required:!0,description:w("checkbox")},aggregation:{values:k.checkbox,required:!0,description:q("checkbox")}}},"aggregation-property-select":{attributes:{name:{values:!0,required:!0,description:w("select")},aggregation:{values:k.basic,required:!0,description:q("select")}}},"aggregation-property-multi-select":{attributes:{name:{values:!0,required:!0,description:w("multi-select")},aggregation:{values:k.basic,required:!0,description:q("multi-select")}}},"aggregation-property-relation":{attributes:{name:{values:!0,required:!0,description:w("relation")},aggregation:{values:k.basic,required:!0,description:q("relation")}}},"aggregation-property-number":{attributes:{name:{values:!0,required:!0,description:w("number")},aggregation:{values:k.number,required:!0,description:q("number")}}},"aggregation-property-status":{attributes:{name:{values:!0,required:!0,description:w("status")},aggregation:{values:k.status,required:!0,description:q("status")},group:{values:!0,required:!0,description:"then name of the status group being aggregated when aggregation is 'Count per group' or 'Percent per group'. For other aggregations, just provide any group name."}}}},I=["hr","h1","h2","h3","database","math-block","code-block","child-page","link-page","child-database","link-database","database-views","text","page","synced-block","synced-block-reference","uli","oli","toggle","quote","callout","todo","columns","table","unknown-block"],S={required:!1,values:p,description:"color for the block"},T={hr:{title:!1,content:[],attributes:{},properties:[],schemas:[]},h1:{title:!0,content:[],attributes:{color:S},properties:[],schemas:[]},h2:{title:!0,content:[],attributes:{color:S},properties:[],schemas:[]},h3:{title:!0,content:[],attributes:{color:S},properties:[],schemas:[]},database:{title:!1,content:[],attributes:{},properties:["property-title"],schemas:y},"math-block":{title:!0,content:[],attributes:{},properties:[],schemas:[]},"code-block":{title:!0,content:[],attributes:{language:{required:!1,values:r(716703).A$,description:"language of code"}},properties:[],schemas:[]},"child-page":{title:!1,content:[],attributes:{"page-id":{required:!0,values:!0,description:"ID of page, to be used in <load>",mappingMode:"block_counter"},"database-id":{required:!1,values:!0,description:"The ID of the database this page is within, if there is one",mappingMode:"collection_counter"},"has-content":{required:!1,values:["true","false"],description:'"true" if the page has content, "false" otherwise'}},properties:y,schemas:[]},"link-page":{title:!1,content:[],attributes:{"page-id":{required:!0,values:!0,description:"ID of page, to be used in <load>",mappingMode:"block_counter"},"database-id":{required:!1,values:!0,description:"The ID of the database this page is within, if there is one",mappingMode:"collection_counter"}},properties:y,schemas:[]},"child-database":{title:!1,content:[],attributes:{"database-id":{required:!0,values:!0,description:"ID of database. Make sure to use the value of this attribute as the id in query-database.",mappingMode:"block_counter"}},properties:["property-title"],schemas:y},"database-views":{title:!1,content:[],attributes:{},properties:["property-title"],schemas:y},"link-database":{title:!1,content:[],attributes:{"database-id":{required:!0,values:!0,description:"ID of database",mappingMode:"collection_counter"}},properties:["property-title"],schemas:y},text:{title:!0,content:I,attributes:{color:S},properties:[],schemas:[]},page:{title:!1,content:I,attributes:{"database-id":{required:!1,values:!0,description:"ID of the database this page belongs to. Use this to look up the schema for the page",mappingMode:"collection_counter"},"page-font":{required:!1,values:["default","serif","mono"],description:"Font used for the page"},"page-width":{required:!1,values:["default","full-width"],description:"Width of the page"},"page-font-size":{required:!1,values:["default","small"],description:"Font size for the page"}},properties:y,schemas:[]},uli:{title:!0,content:I,attributes:{color:S},properties:[],schemas:[]},oli:{title:!0,content:I,attributes:{color:S,index:{required:!1,values:!0,description:"Specify a custom index for the list item"}},properties:[],schemas:[]},toggle:{title:!0,content:I,attributes:{color:S,size:{required:!1,values:["h1","h2","h3"],description:"size of the toggle header, if the toggle is a header"}},properties:[],schemas:[]},quote:{title:!0,content:I,attributes:{color:S},properties:[],schemas:[]},todo:{title:!0,content:I,attributes:{checked:{required:!0,values:["true","false"],description:'checked state, either "true" or "false"'},color:S},properties:[],schemas:[]},callout:{title:!0,content:I,attributes:{color:S},properties:[],schemas:[]},"synced-block":{title:!1,content:I,attributes:{},properties:[],schemas:[]},"synced-block-reference":{title:!1,content:I,attributes:{"synced-block-id":{required:!0,values:!0,description:"The ID of the <synced-block> node that this references",mappingMode:"block_counter"}},properties:[],schemas:[]},columns:{title:!1,content:["column"],attributes:{},properties:[],schemas:[]},column:{title:!1,content:I,attributes:{},properties:[],schemas:[]},table:{title:!1,content:["tr"],attributes:{"header-row":{required:!1,values:["true","false"],description:'whether first <tr> is row header, either "true" or "false"'},"header-column":{required:!1,values:["true","false"],description:'whether first <td> in every <tr> is column header, either "true" or "false"'}},properties:[],schemas:["property-text"]},tr:{title:!1,content:[],attributes:{},properties:["property-text"],schemas:[]},"ai-block":{title:!0,content:I,attributes:{},properties:["property-text"],schemas:[]},transcript:{title:!0,content:I,attributes:{},properties:[],schemas:[]},"unknown-block":{title:!0,content:I,attributes:{type:{required:!1,values:Object.values(r(156642).Ti),description:"the type of the unknown block"}},properties:[],schemas:[]}},C=Object.freeze((0,o().Yd)({text:!0,toggle:!0,quote:!0,callout:!0,uli:!0,oli:!0,todo:!0,h1:!0,h2:!0,h3:!0}));function M(e){return e}function N(e){return e}function O(e){return e}function j(e){return e}function A(e){return e}function D(e){return e}function $(e){return e}function P(e){return e}function K(e){return e}function E(e){return e}function R(){return a().Il()}function Y(e){return(0,i().Ul)(n()(e))}const L=(0,o().AO)((e=>"collectionView"===e.type?{true:e}:{false:e})),U="search-notion-help",z=(0,o().AO)((e=>"synced-block-reference"===e||"ai-block"===e||"database-views"===e||"transcript"===e?{true:e}:{false:e}))},175882:(e,t,r)=>{r.d(t,{He:()=>m,KT:()=>d,dF:()=>a,p1:()=>u,vw:()=>s});r(821057),r(670560),r(267602),r(749411),r(30005),r(241792);var n=()=>r(513670),i=()=>r(696459),o=()=>r(413880);const a="\x3c!--<selection>--\x3e",s="\x3c!--</selection>--\x3e";function c(e){const{node:t,selection:r,path:u,onlyAllowPropertyTypes:d,namespace:m}=e;if(u.includes(t))throw new Error("Circular reference detected!");const y=[...u,t],f=[];if("text"===t.type)for(const n of t.value)f.push(n);else{let e="";e+=`<${t.tagName}`;for(const[r,n]of Object.entries(t.attributes||{}))void 0!==n&&(e+=` ${r}="${n}"`);const u=`</${t.tagName}>`;if("block"===t.type){const o="block"===t.type&&"block"===(null==r?void 0:r.type)&&r.blockIds[0]===t.attributes.id,b="block"===t.type&&"block"===(null==r?void 0:r.type)&&r.blockIds[r.blockIds.length-1]===t.attributes.id,h="block"===t.type&&"text"===(null==r?void 0:r.type)&&(r.start.blockId===t.attributes.id||r.end.blockId===t.attributes.id);o&&f.push(a);if(0===t.text.length&&0===Object.values(t.properties).length&&0===Object.values(t.schemas).length&&0===t.children.length&&!h)f.push(`${e}/>`);else{f.push(`${e}>`);const o=[];if(t.text)for(const e of t.text){const t=c({node:e,selection:r,path:y,onlyAllowPropertyTypes:d,namespace:m});for(const e of t)o.push(e)}let b,h;"text"===(null==r?void 0:r.type)&&r.start.blockId===t.attributes.id&&(b=r.start.index),"text"===(null==r?void 0:r.type)&&r.end.blockId===t.attributes.id&&(h=r.end.index);for(let e=0;e<o.length;e++){const t=o[e];let n="";(0,i().$K)(r)&&e===b&&(n+=a),(0,i().$K)(r)&&e===h&&(n+=s),n+=t,f.push(n)}if((0,i().$K)(r)&&b===o.length&&f.push(a),(0,i().$K)(r)&&h===o.length&&f.push(s),"end_to_end"!==m&&"tr"===t.tagName){n().MR(Object.values(t.properties),(e=>Number(e.attributes.name))).forEach(((e,n)=>{const i=t.parent&&"table"===t.parent.tagName?t.parent:void 0,o=i&&i.attributes["header-row"],a=i&&"table"===i.tagName&&i.attributes["header-column"],s=i&&0===i.children.indexOf(t),p=o&&0===n||a&&s?"th":"td";f.push(`<${p}>`),f.push(...e.children.flatMap((e=>c({node:e,selection:r,path:y,onlyAllowPropertyTypes:d,namespace:m})))),f.push(`</${p}>`)}))}else{const e=function(e){const{tagName:t,properties:r}=e;if("tr"===t)return r;const n=[];for(const i of r){const e=l(i),r="page"===t;("property-title"===i.tagName||!e||r&&n.length<p)&&n.push(i)}return n}({tagName:t.tagName,properties:Object.values(t.properties)});for(const t of e)d&&!d.includes(t.tagName)||f.push(...c({node:t,selection:r,path:y,onlyAllowPropertyTypes:d,namespace:m}))}for(const e of Object.values(t.schemas))f.push(...c({node:e,selection:r,path:y,onlyAllowPropertyTypes:d,namespace:m}));if(t.children)for(const e of t.children){const t=c({node:e,selection:r,path:y,onlyAllowPropertyTypes:d,namespace:m});for(const e of t)f.push(e)}f.push(u)}(0,i().$K)(r)&&b&&f.push(s)}else if("collection"===t.type){f.push(`${e}>`);for(const e of Object.values(t.properties))d&&!d.includes(e.tagName)||f.push(...c({node:e,selection:r,path:y,onlyAllowPropertyTypes:d,namespace:m}));for(const e of Object.values(t.schemas))f.push(...c({node:e,selection:r,path:y,onlyAllowPropertyTypes:d,namespace:m}));f.push(u)}else{const n=(0,i().AO)((e=>"collection"===e.type||"collectionView"===e.type?{true:e}:{false:e}));if(n(t)||0===t.children.length)f.push(`${e}/>`);else{const a=[];if(!n(t)&&t.children)for(const e of t.children){const t=c({node:e,selection:r,path:y,onlyAllowPropertyTypes:d,namespace:m});for(const e of t)a.push(e)}if(a.length<=1||(0,i().qg)(o().t,t.tagName)&&o().t[t.tagName].isToken)f.push(`${e}>${a.join("")}${u}`);else for(let t=0;t<a.length;t++){const r=a[t];0===t?f.push(`${e}>${r}`):t===a.length-1?f.push(r+u):f.push(r)}}}}return f}const p=20;function l(e){return"property-checkbox"!==e.tagName&&("property-number"===e.tagName?!e.attributes.number:0===e.children.length)}function u(e){const{node:t,selection:r,onlyAllowPropertyTypes:n,namespace:i}=e;return c({node:t,selection:r,path:[],onlyAllowPropertyTypes:n,namespace:i}).join("")}function d(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o="";if(t){o+="\n";for(let e=0;e<r;e++)o+="\t"}if("text"===e.type)o+=i?n().YU(e.value):e.value;else{o+=`<${e.tagName}`;for(const[t,r]of Object.entries(e.attributes||{}))o+=` ${t}="${r}"`;if(e.children&&e.children.length>0){o+=">";for(const n of e.children)o+=d(n,t,r+1,i);if(t){o+="\n";for(let e=0;e<r;e++)o+="\t"}o+=`</${e.tagName}>`}else o+="/>"}return o}function m(e){return e.map((e=>d(e))).join("")}},815292:(e,t,r)=>{r.d(t,{P5:()=>o});r(241792);var n=()=>r(790698),i=(n(),()=>r(513670));function o(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0;return(0,n().parse)(e,r).childNodes.map((e=>a(e,t)))}function a(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.nodeType===n().NodeType.TEXT_NODE?{type:"text",value:t?i().AK(e.textContent):e.textContent}:{type:"element",tagName:e.tagName.toLowerCase(),attributes:e.attributes||{},children:e.childNodes.map((e=>a(e,t)))||[]}}},48826:(e,t,r)=>{r.d(t,{RJ:()=>n,V:()=>o,WM:()=>c,Y:()=>i,aP:()=>a});r(267602),r(470928);const n=["slack","googleDrive","github","jira","microsoftTeams"],i=[...n,"web","githubCode"],o="7c57d10c-00cc-48bc-a552-fb3911dd7745",a="1031cb6c-4935-4cc1-9c08-c9a4ecaae323",s=[{regex:/https:\/\/(?<workspace>[\w-]+)\.slack\.com\/archives\/(?<channel>[^\/]+)\/p(?<timestamp>\d+)(\?thread_ts=(?<thread_ts>\d+\.\d+)&cid=(?<cid>[^\/]+))?/,type:"slack"},{regex:/https:\/\/docs\.google\.com\/(?<fileType>document|spreadsheets|presentation)\/d\/(?<fileId>[a-zA-Z0-9_-]+)(?:\/\S*)?/,type:"googleDrive"},{regex:/https:\/\/github\.com\/(?<orgName>[^\/]+)\/(?<repoName>[^\/]+)\/(?:blob|tree|blame)\/(?<branchName>[^\/]+)\/(?<codePath>[^#]+)(#(?<lineNumber>L\d+(?:C\d+)?(?:-L\d+)?))?/,type:"githubCode"},{regex:/https:\/\/github\.com\/(?<orgName>[^\/]+)\/(?<repoName>[^\/]+)\/pull\/(?<prNumber>\d+)(\/(files|commits|checks)?)?/,type:"github"},{regex:/https:\/\/app\.graphite\.dev\/github\/pr\/(?<orgName>[^\/]+)\/(?<repoName>[^\/]+)\/(?<prNumber>\d+)(?:\/\S*)?/,type:"github"},{regex:/https:\/\/(?:[^\.]+)\.sourcegraphcloud\.com\/github\.com\/(?<orgName>[^\/]+)\/(?<repoName>[^\/@]+)(?:@(?<branchName>[a-f0-9]+))?\/-\/blob\/(?<codePath>[^?]+)\?(?<lineNumbers>L\d+|l\d+)?/,type:"githubCode"}];function c(e){const t=s.find((t=>t.regex.test(e)));return(null==t?void 0:t.type)??"web"}},335696:(e,t,r)=>{r.d(t,{Fs:()=>p,Gw:()=>g,rl:()=>y,c1:()=>f,dw:()=>m,yr:()=>d});r(821057),r(670560),r(267602),r(653476),r(470928),r(749411),r(30005),r(241792);var n=()=>r(513670),i=()=>r(543172),o=()=>r(696459),a=()=>r(124199),s=()=>r(295617),c=()=>r(235484);const p={type:"database",config:{},authentication:void 0};function l(e){return"rollup"===e.type||"formula"===e.type||"created_by"===e.type||"location"===e.type||"last_edited_by"===e.type||"last_visited_time"===e.type||"button"===e.type||"auto_increment_id"===e.type||"verification"===e.type}function u(e,t){var r;if("relation"!==e.type)return;const n=(null===(r=e.collection_pointer)||void 0===r?void 0:r.id)||e.collection_id;return t.find((e=>{var t;return!!e.state&&(null===(t=e.state)||void 0===t||null===(t=t.pointer)||void 0===t?void 0:t.id)===n}))}function d(e){const{databaseKey:t,databaseKeyMap:r,workflowSchema:n,notionSchema:a,connectedRelationCollections:p,databaseModules:d}=e,m=r[t];if(!m)throw new Error(`Database ${t} not found`);const{propertyKeyToIdMap:y}=m,f=Object.fromEntries(Object.entries(n).flatMap((e=>{var t;let[n,l]=e;const u=y[n],d=function(e){const{key:t,workflowPropertySchema:r,notionPropertySchema:n,databaseKeyMap:a,connectedRelationCollections:p}=e;if(n&&r.type!==n.type)return;if("content"===r.type);else{if("title"===r.type)return{...n,type:"title",name:t};if("text"===r.type)return{...n,type:"text",name:t};if("url"===r.type)return{...n,type:"url",name:t};if("email"===r.type)return{...n,type:"email",name:t};if("phone_number"===r.type)return{...n,type:"phone_number",name:t};if("date"===r.type)return{...n,type:"date",name:t};if("created_time"===r.type)return{...n,type:"created_time",name:t};if("last_edited_time"===r.type)return{...n,type:"last_edited_time",name:t};if("number"===r.type)return{...n,type:"number",name:t};if("checkbox"===r.type)return{...n,type:"checkbox",name:t};if("select"===r.type){var l;const e={};if("select"===(null==n?void 0:n.type)&&n.options&&n.options.forEach((t=>{e[t.value]=t})),n&&"select"!==n.type)throw new Error(`Property ${t} is not a select property in Notion`);return{...n,type:"select",name:t,options:null===(l=r.options)||void 0===l?void 0:l.map((t=>({...e[t.value]??{id:(0,i().ZP)()},...t})))}}if("multi_select"===r.type){var u;const e={};if("multi_select"===(null==n?void 0:n.type)&&n.options&&n.options.forEach((t=>{e[t.value]=t})),n&&"multi_select"!==n.type)throw new Error(`Property ${t} is not a multi_select property in Notion`);return{...n,type:r.type,name:t,options:null===(u=r.options)||void 0===u?void 0:u.map((t=>({...e[t.value]??{id:(0,i().ZP)()},...t})))}}if("status"===r.type){const e={},o={};"status"===(null==n?void 0:n.type)&&(n.options&&n.options.forEach((t=>{e[t.value]=t})),n.groups&&n.groups.forEach((e=>{o[e.name]=e})));const a=Object.values(r.groups).flatMap((t=>t.map((t=>({...e[t.value]??{id:(0,i().ZP)()},...t}))))),c=Object.entries(r.groups).map((e=>{let[t,r]=e;const n="to_do"===t?s().G1:"in_progress"===t?s().Ho:s().RW;return{...o[n]||{id:(0,i().ZP)()},name:"to_do"===t?s().G1:"in_progress"===t?s().Ho:s().RW,optionIds:r.map((e=>{const t=a.find((t=>t.value===e.value));if(!t)throw new Error(`Option ${e} not found`);return t.id}))}}));return{...n,type:r.type,name:t,options:a,groups:c}}if("person"===r.type)return{...n,type:"person",name:t};if("file"===r.type)return{...n,type:"file",name:t};if("relation"===r.type){const e=a[r.databaseKey];if(!e)throw new Error(`Database ${r.databaseKey} not found`);const{collectionPointer:i,propertyKeyToIdMap:o}=e,s=r.propertyKey?o[r.propertyKey]:void 0;return{...n,type:"relation",name:t,collection_pointer:i,version:"v2",property:s}}if("external_relation"===r.type){if("slack.message"===r.object){const e=p[t],{collectionPointer:r,property:i}=e??{};return{...n,type:"relation",name:t,collection_pointer:r,version:"v2",property:i,connectedRelation:{integration_id:c().nO}}}(0,o().t1)(r.object)}else(0,o().t1)(r)}}({key:n,workflowPropertySchema:l,notionPropertySchema:u&&(null===(t=a[u])||void 0===t?void 0:t.type)===l.type?a[u]:void 0,databaseKeyMap:r,connectedRelationCollections:p});if(d){if(!u)throw new Error(`Property ${n} not found`);return[[u,{...d,description:l.description}]]}return[]}))),b=Object.fromEntries(Object.entries(a).filter((e=>{let[t]=e;return!f[t]})));return Object.entries(a).forEach((e=>{let[t,r]=e;if(r&&l(r)&&(f[t]=r),"relation"===(null==r?void 0:r.type)){!u(r,d)&&(f[t]=r)}})),{schema:f,deletedSchema:b}}function m(e){const{databaseKey:t,schema:r,databaseModules:n}=e,i=Object.fromEntries(Object.entries(r).flatMap((e=>{let[r,i]=e;if(!i)return[];const a=function(e){const{databaseKey:t,propertySchema:r,databaseModules:n}=e;if("title"===r.type)return{name:r.name,schema:{type:"title",description:r.description||""}};if("text"===r.type)return r.external_relation_object?{name:r.name,schema:{type:"external_relation",description:r.description||"",object:r.external_relation_object}}:{name:r.name,schema:{type:"text",description:r.description||""}};if("url"===r.type)return{name:r.name,schema:{type:"url",description:r.description||""}};if("email"===r.type)return{name:r.name,schema:{type:"email",description:r.description||""}};if("phone_number"===r.type)return{name:r.name,schema:{type:"phone_number",description:r.description||""}};if("checkbox"===r.type)return{name:r.name,schema:{type:"checkbox",description:r.description||""}};if("person"===r.type)return{name:r.name,schema:{type:"person",description:r.description||""}};if("file"===r.type)return{name:r.name,schema:{type:"file",description:r.description||""}};if("select"===r.type)return{name:r.name,schema:{type:"select",description:r.description||"",options:(r.options||[]).map((e=>({value:e.value,description:e.description||""})))}};if("multi_select"===r.type)return{name:r.name,schema:{type:"multi_select",description:r.description||"",options:(r.options||[]).map((e=>({value:e.value,description:e.description||""})))}};if("status"===r.type)return{name:r.name,schema:{type:"status",description:r.description||"",groups:{to_do:h({propertySchema:r,type:s().G1}),in_progress:h({propertySchema:r,type:s().Ho}),complete:h({propertySchema:r,type:s().RW})}}};if("date"===r.type)return{name:r.name,schema:{type:"date",description:r.description||""}};if("created_time"===r.type)return{name:r.name,schema:{type:"created_time",description:r.description||""}};if("last_edited_time"===r.type)return{name:r.name,schema:{type:"last_edited_time",description:r.description||""}};if("relation"===r.type){var i;const e=b(r);if(e)return{name:r.name,schema:{type:"external_relation",description:r.description||"",object:e}};const o=u(r,n);if(!o)return;const a=null===(i=Object.entries(o.state.schema).find((e=>{let[n,i]=e;return"relation"===i.type&&(i.propertyKey===r.name&&i.databaseKey===t)})))||void 0===i?void 0:i[0];return{name:r.name,schema:{type:"relation",databaseKey:o.key,propertyKey:a||r.name,description:r.description||""}}}if("number"===r.type)return{name:r.name,schema:{type:"number",description:r.description||""}};if(l(r))return;(0,o().t1)(r)}({databaseKey:t,propertySchema:i,databaseModules:n});return a?[[a.name,a.schema]]:[]}))),a=Object.fromEntries(Object.entries(r).map((e=>{let[t,r]=e;if(!r||l(r))return[];if("relation"===(null==r?void 0:r.type)){if(!u(r,n))return[]}return[r.name,t]})));return i.content||(i.content={type:"content",description:""}),{schema:i,propertyKeyToIdMap:a}}function y(e){return Object.fromEntries(n().oA(Object.entries(e).map((e=>{let[t,r]=e;if("external_relation"===r.type)return[t,r.object]}))))}function f(e){const{notionSchema:t,databaseKeyMap:r,databaseKey:i}=e,{propertyKeyToIdMap:o}=r[i],a=(s=t,Object.fromEntries(n().oA(Object.entries(s).map((e=>{let[t,r]=e;if("relation"!==(null==r?void 0:r.type)||!r.collection_pointer||!r.property)return;const n=b(r);return n?[t,{collectionPointer:r.collection_pointer,property:r.property,externalRelationType:n}]:void 0})))));var s;const c=n().U_(o);return Object.fromEntries(n().oA(Object.entries(a).map((e=>{let[t,r]=e;if(c[t])return[c[t],r]}))))}function b(e){var t;if((null===(t=e.connectedRelation)||void 0===t?void 0:t.integration_id)===c().nO)return"slack.message"}function h(e){var t;const{propertySchema:r,type:n}=e;return((null===(t=(r.groups||[]).find((e=>e.name===n)))||void 0===t?void 0:t.optionIds)||[]).flatMap((e=>{const t=(r.options||[]).find((t=>t.id===e));return t?[{value:t.value,description:t.description||""}]:[]}))}a().array(a().string());function g(e){let t=e.replace(/\s+/g,"").replace(/[^a-zA-Z0-9]/g,"").replace(/^(.)/,(e=>e.toLowerCase()));return/^[^a-z]/.test(t)&&(t=`_${t}`),t}},846940:(e,t,r)=>{r.d(t,{O:()=>q});r(241792);var n=()=>r(124199);const i=n().object({required:{id:n().string(),url:n().string(),type:n().literal("user"),userId:n().string(),message:n().string()},optional:{},exact:!0}),o=n().object({required:{type:n().literal("user"),message:n().string()},optional:{},exact:!0}),a=n().object({required:{type:n().literal("text"),text:n().string()},optional:{},exact:!0}),s=n().object({required:{type:n().literal("function_call"),functionKey:n().string(),functionCallId:n().string(),args:n().string()},optional:{},exact:!0}),c=n().union([a,s]),p=n().object({required:{id:n().string(),url:n().string(),type:n().literal("ai"),message:n().array(c)},optional:{},exact:!0}),l=n().object({required:{type:n().literal("ai"),message:n().array(c)},optional:{},exact:!0}),u=n().object({required:{id:n().string(),url:n().string(),type:n().literal("function_result"),functionKey:n().string(),functionCallId:n().string(),result:n().unknown()},optional:{},exact:!0}),d=n().object({required:{type:n().literal("function_result"),functionKey:n().string(),functionCallId:n().string(),result:n().unknown()},optional:{},exact:!0}),m=n().union([i,p,u]),y=(n().union([o,l,d]),n().object({required:{id:n().string(),url:n().string(),messages:n().array(m)},optional:{},exact:!0})),f=(n().object({required:{threads:n().array(y)},optional:{},exact:!0}),{type:"agent",config:{},authentication:void 0});const b={type:"ai",config:{},authentication:void 0};const h=n().object({required:{id:n().string(),from:n().union([n().object({required:{type:n().literal("user"),id:n().string()},optional:{},exact:!0}),n().object({required:{type:n().literal("bot")},optional:{}})]),text:n().string(),url:n().string(),timestamp:n().string()},optional:{fileIds:n().array(n().string())},exact:!0}),g=n().object({required:{id:n().string(),pageId:n().string(),comments:n().array(h),resolved:n().boolean()},optional:{},exact:!0}),v=(n().object({required:{discussions:n().array(g)},optional:{},exact:!0}),n().object({required:{id:n().string()},optional:{}}),n().object({required:{files:n().array(n().object({required:{id:n().string(),fileName:n().string(),content:n().string()},optional:{}}))},optional:{},exact:!0}),{type:"files",config:{},authentication:void 0});n().object({required:{type:n().literal("recurrence"),moduleKey:n().literal("recurrence"),frequency:n().literals("day","week","month","year"),interval:n().number(),timezone:n().string()},optional:{hour:n().number(),minute:n().number(),weekdays:n().array(n().literals("MO","TU","WE","TH","FR","SA","SU")),scheduleId:n().uuid()},exact:!0});const x={type:"search",config:{},authentication:void 0},k=n().object({required:{id:n().string(),email:n().string()},optional:{name:n().string()}}),w=(n().object({required:{users:n().array(k)},optional:{},exact:!0}),{type:"users",config:{},authentication:void 0}),q={database:r(335696).Fs,slack:{type:"slack",config:{scopes:["channels:history","channels:read","chat:write","chat:write.customize","im:history","groups:history","im:write","users:read"]},authentication:{type:"oauth2"}},users:w,files:v,ai:b,recurrence:{type:"recurrence",config:{}},search:x,discussions:{type:"discussions",config:{}},notionmail:{type:"notionmail",config:{}},zendesk:{type:"zendesk",config:{scopes:["read","write"]},authentication:{type:"oauth2"}},agent:f}},783190:(e,t,r)=>{r.d(t,{S1:()=>u,hi:()=>y,o_:()=>d,qq:()=>m});r(267602),r(653476),r(241792),r(398858),r(461318),r(33228);var n=r.n(r(467266)),i=()=>r(369448),o=()=>r(696459),a=()=>r(124199),s=()=>r(5234),c=()=>r(926161),p=()=>r(956057);const l="/workflows/oauth/connect";function u(e){const t=Object.fromEntries(Object.entries(e).filter((e=>{let[t,r]=e;return Boolean(r)})));return`${l}?${new URLSearchParams(t).toString()}`}a().object({required:{moduleType:a().literals(...Object.keys(r(846940).O)),workflowId:a().string(),moduleKey:a().string(),spaceId:a().string()},optional:{moduleSpecific:a().string()}});function d(e){const t={...e};delete t.examples,delete t.memories,delete t.annotation,"transcript"in e&&Array.isArray(e.transcript)&&(t.transcript=e.transcript.map((e=>({...e,id:void 0}))));const r=m((0,c().Z)((0,i().U)(t),"ignore-class-instances"));return(0,p().Ul)(r)}function m(e,t){return n()(e,t?{space:"  "}:void 0)}function y(e){return("info"===e.level?"":`${(0,s().Z)(e.level)}: `)+e.messages.map((e=>{switch(e.type){case"msg":return e.data;case"object":return JSON.stringify(e.data);case"undefined":return"undefined";case"error":return`${e.message||"Unknown error"}\n${e.stack||""}`;case"database":return`${e.database_key}`;default:return(0,o().t1)(e)}})).join(" ")}}}]);