"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[10553],{347558:(e,t,o)=>{o.d(t,{Pq:()=>se,oe:()=>ce,bU:()=>ae});o(670560),o(267602),o(653476),o(749411),o(241792);var n=o(667294),r=()=>o(219727),l=()=>o(846550),i=()=>o(455947),a=()=>o(788860),c=()=>o(513670),s=()=>o(696459),d=()=>o(491927),p=()=>o(250303),u=()=>o(788899),x=()=>o(576868),f=()=>o(32072),g=()=>o(352230),h=()=>o(742870),m=()=>o(615634),v=()=>o(314379),y=()=>o(802600),S=()=>o(424097),j=()=>o(521777),C=()=>o(739479),b=()=>o(998901),w=()=>o(104088),M=()=>o(529048),V=()=>o(292612),F=(o(228244),()=>o(142735)),_=()=>o(532850),T=()=>o(892981),Z=()=>o(527278),P=()=>o(164079),I=()=>o(827973),O=()=>o(397540),k=()=>o(654133),R=()=>o(67961),A=()=>o(960647),H=o(785893);function G(e){const{filter:t}=e,{isMobile:o}=(0,r().Fy)(),n=Z().Z.getIntl(),l={width:190,menuTitle:n.formatMessage({defaultMessage:"Date Options",id:"database.filterMenu.mobileDateFilterModeMenu.title"}),items:i().T,selectedItem:(0,i().TX)(t),getKey:e=>e,onSelect:o=>{const n={...t,use_end:(0,i().UG)(o)};e.onChange(n)},renderItem:e=>(0,H.jsx)(k().Z,{renderTooltip:()=>(0,f()._T)(e.value),render:t=>(0,H.jsx)(I().Z,{title:(0,f().IF)(e.value),...(0,P().Z)(e,t)}),placement:b().Placement.Right,textWrap:!0,style:{width:"260px"}}),renderOrigin:e=>(0,H.jsx)(A().Z,{...e,placeholder:n.formatMessage({defaultMessage:"Date Options",id:"database.filterMenu.dateFilterModeMenu.label"}),title:(0,H.jsx)(R().Z,{isMobile:o,children:(0,f().IF)((0,i().TX)(t))}),disableMargins:!0,desktopStyle:{width:"100px"}})};return(0,H.jsx)(O().Z,{...l,mobileActionSheet:!0},"date-filter-mode")}var B=()=>o(235819);const U=(0,a().XN)((function(e){const t=(0,r().O7)(),{filterValueType:o,filter:n,intl:l}=e,a=(0,i().xm)(o),c={width:190,menuTitle:l.formatMessage({defaultMessage:"Comparator",id:"database.filterMenu.mobileComparatorValueMenu.title"}),items:a,selectedItem:n.operator,getKey:e=>e,onSelect:r=>{const l=(0,f().li)(o,n,r,"combinator");e.onChange(l),e.collectionContextStore?p().wd({environment:t,collectionContextStore:e.collectionContextStore,action:"set_filter_comparator"}):d().wd(t,{view_type:e.collectionViewType,action:"set_filter_comparator"})},renderItem:e=>(0,H.jsx)(I().Z,{title:(0,f().WC)(e.value),...e}),renderOrigin:e=>(0,H.jsx)(A().Z,{...e,placeholder:l.formatMessage({defaultMessage:"Comparator",id:"database.filterMenu.comparatorMenuDropdownButton.label"}),title:(0,H.jsx)(R().Z,{isMobile:t.device.isMobile,children:(0,f().WC)(n.operator)}),disableMargins:!0})};return(0,H.jsx)(O().Z,{...c,mobileActionSheet:!0},"comparator")}));var $=()=>o(253368);const K=(0,a().vU)({setFilter:{defaultMessage:"Set filter",id:"database.filterMenu.rollupPropertyValue.mobileMenu.title"}});const W=(0,a().XN)((function(e){const t=(0,r().O7)();if((0,i().a_)(e.filter))return(0,H.jsx)(D,{intl:e.intl,onChange:e.onChange,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,property:e.property,schema:e.schema,parentStore:e.parentStore,collectionViewId:e.collectionViewId,filter:e.filter});const o=(0,i().fI)({schema:e.schema,property:e.property,getRecordModel:e.parentStore.getRecordModel});if(!(0,i().ZB)(o,e.filter)){const t=(0,f().rn)(o);return(0,H.jsxs)(n.Fragment,{children:[(0,H.jsx)(U,{filterValueType:o,filter:t,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,onChange:e.onChange}),(0,H.jsx)($().Z,{filterValueType:o,filter:t,schema:e.schema,property:e.property,parentStore:e.parentStore,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId,onChange:e.onChange})]})}const l=(0,H.jsx)(a()._H,{...f().xe[o],values:{property:(0,H.jsx)(a()._H,{id:"collectionFilterMenuFilter.property.name",defaultMessage:"Property"}),operator:(0,H.jsx)(U,{filterValueType:o,filter:e.filter,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,onChange:e.onChange}),operatorValue:(0,H.jsx)($().Z,{filterValueType:o,filter:e.filter,schema:e.schema,property:e.property,parentStore:e.parentStore,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId,onChange:e.onChange})}});return t.device.isMobile?l:(0,H.jsx)("div",{style:{alignItems:"center",display:"grid",gridAutoFlow:"column",gridAutoColumns:"1fr",gridColumnEnd:e.isArrayFilter?void 0:"span 2",gridColumnGap:`${u().l0}px`,gridTemplateRows:`${u().fg}px`,gridTemplateColumns:"[value-start] max-content auto [value-end operator-start] auto"},children:l})})),E=W;function D(e){let{filter:t,intl:o,onChange:l,collectionContextStore:a,collectionViewType:c,property:s,schema:x,parentStore:g,collectionViewId:h}=e;const m=(0,r().O7)(),v={menuTitle:o.formatMessage(K.setFilter),items:i().Rf,getKey:e=>e,selectedItem:t.operator,onSelect:e=>{const o={...t,operator:e};l(o),a?p().wd({environment:m,collectionContextStore:a,action:"set_rollup_set_filter"}):d().wd(m,{view_type:c,action:"set_rollup_set_filter"})},renderItem:e=>(0,H.jsx)(I().Z,{title:(0,f().SW)(e.value,o),...e}),renderOrigin:e=>(0,H.jsx)(A().Z,{...e,placeholder:o.formatMessage(K.setFilter),title:(0,f().SW)(t.operator,o),disableMargins:!0,desktopStyle:{minWidth:70}})},{targetProperty:y,targetCollectionSchema:S}=(0,F().VK)((()=>{var e;if("rollup"===(null==x||null===(e=x[s])||void 0===e?void 0:e.type)){const e=(0,B().gT)({schema:x,property:s,getRecordModel:g.getRecordModel});return{targetProperty:null==e?void 0:e.targetProperty,targetCollectionSchema:null==e?void 0:e.targetCollectionSchema}}return{targetProperty:s,targetCollectionSchema:x}}),[s,x,g]);if(!y||!S)return(0,H.jsx)("div",{style:{gridColumnEnd:"span 2"}});const j=(0,H.jsxs)(n.Fragment,{children:[(0,H.jsx)(O().Z,{...v,mobileActionSheet:!0},"set_filter"),(0,H.jsx)(W,{collectionViewId:h,filter:t.subfilter,schema:S,property:y,parentStore:g,collectionContextStore:a,collectionViewType:c,onChange:e=>{const o={...t,subfilter:e};l(o)},isArrayFilter:!0})]});return m.device.isMobile?j:(0,H.jsx)("div",{style:{display:"grid",gridAutoFlow:"column",gridAutoColumns:"1fr",gridColumnEnd:"span 2",gridColumnGap:`${u().l0}px`,gridTemplateColumns:"max-content",gridTemplateRows:`${u().fg}px`},children:j})}var Q=()=>o(448419);const z=function(e){let{schema:t,propertyFilter:l,parentStore:c,index:s,collectionContextStore:u,collectionViewType:x,onChange:g,filterOperator:h,collectionViewId:m}=e;const v=(0,r().O7)(),{device:y}=v,S=(0,_().Qm)({schema:t,property:l.property}),j=(0,F().VK)((()=>(0,i().J5)(t,l.property,l.filter,c.getRecordModel)),[c,l,t]);if(!S)return null;if(!j)return null;const C=(0,i().gE)(l.filter)&&(0,i().vR)(l.filter)&&(0,i().c3)(S),b=C?{width:"120px",marginRight:"4px"}:{},w=(0,H.jsxs)(n.Fragment,{children:[(0,H.jsx)(Q().ZP,{popupType:y.isMobile?Q().Z4.SlideUp:Q().Z4.Popup,renderOrigin:e=>(0,H.jsx)(o(697475).Z,{...e,propertySchema:S,disableMargins:!0,textWrapperStyle:{width:"100%",...b}}),render:e=>(0,H.jsx)(o(360197).Z,{isRelationProperty:!1,schema:t,onAccept:e=>function(e,t,o,n,r,l,a,c,s){const{property:u,filter:x}=n,g=o[u],h=o[e],m={property:e,filter:x},v=h&&(0,i().J5)(o,e,x,r.getRecordModel),y=h&&"relation"===h.type&&u!==e,S=g&&("created_by"===g.type||"last_edited_by"===g.type)&&h&&"person"===h.type,j=(0,i().Gb)(x)&&!(0,i().mv)(x)&&(0,i().R8)(x).some((e=>"exact"===e.type&&e.value&&"bot"===e.value.table));(!v||y||S&&j||!(0,T().dN)(m,o))&&(m.filter=(0,f().zZ)({schema:o,property:e,getRecordModel:r.getRecordModel}));null==s||s(l,m),a?p().wd({environment:t,collectionContextStore:a,action:"set_filter_property"}):d().wd(t,{view_type:c,action:"set_filter_property"})}(e,v,t,l,c,s,u,x,g),onClose:e.close,allowProperty:_().Kf})}),C&&(0,H.jsx)(G,{filter:l.filter,onChange:e=>{const t={...l,filter:e};null==g||g(s,t)}})]});return(0,H.jsxs)(n.Fragment,{children:[h,y.isMobile?w:(0,H.jsx)("div",{style:{display:"flex"},children:w}),(0,H.jsx)(a()._H,{id:"collectionFilterMenuRow.propertyConjunction.label",defaultMessage:" "}),(0,H.jsx)(E,{filter:l.filter,schema:t,property:l.property,parentStore:c,collectionViewId:m,collectionContextStore:u,collectionViewType:x,onChange:e=>{const t={...l,filter:e};null==g||g(s,t)},isArrayFilter:!1})]})};function L(){return(0,H.jsx)(a()._H,{defaultMessage:"Add filter rule",id:"database.filterMenu.addFilterRuleButtonTitle"})}const N=(0,a().vU)({operatorPlaceholder:{defaultMessage:"Operator",id:"database.filterMenu.operatorPlaceholder"}});const X=(0,a().XN)((function(e){const{intl:t,filterOperator:o,onChange:n,disableMargins:r}=e,l={width:"auto",menuTitle:t.formatMessage({defaultMessage:"Operator",id:"database.filterMenu.filterOperatorMenu.title"}),items:i().Uz,getKey:e=>e,selectedItem:o,onSelect:n,renderItem:e=>(0,H.jsx)(I().Z,{title:(0,f().KV)(e.value,t),caption:(0,f().Qz)(e.value,t),...e}),renderOrigin:e=>(0,H.jsx)(A().Z,{...e,title:o&&(0,f().KV)(o,t),placeholder:t.formatMessage(N.operatorPlaceholder),disableMargins:r})};return(0,H.jsx)(O().Z,{...l,mobileActionSheet:!0},"operator")}));var q=()=>o(882292),J=()=>o(384547),Y=()=>o(1910),ee=()=>o(198829),te=()=>o(255577),oe=()=>o(470386),ne=()=>o(388284);const re=60,le=120,ie=110,ae=170,ce=400;function se(e){const{combinatorFilter:t,index:o,level:l,schema:a,onChange:c,parentStore:s,collectionContextStore:d,collectionViewType:p,collectionViewId:x}=e,f=(0,r().Fy)(),g=(0,n.useRef)([]),h=(t.filters??[]).flatMap((e=>(0,i().Mm)(e)?[]:[e]));return(0,H.jsxs)(n.Fragment,{children:[Te(t,l)?void 0:(0,H.jsx)("div",{style:f.isMobile?void 0:{display:"grid",gridTemplateColumns:`\n             [boolean-start] ${re}px\n             [boolean-end property-start] minmax(min-content, ${le}px)\n             [property-end operator-start] ${ie}px\n             [operator-end value-start] auto\n             [value-end menu-start] ${u().fg}px\n             [menu-end]\n        `,gridAutoRows:`minmax(${u().fg}px, auto)`,gridColumnGap:u().l0,gridRowGap:u().cn,padding:`${u().cn}px ${u().l0}px 0 ${u().l0}px`,justifyItems:"stretch",alignItems:"start"},children:h.map(((o,n)=>(0,H.jsx)(de,{childFilter:o,newIndex:n,schema:a,level:l,combinatorFilter:t,onChange:c,index:e.index,collectionContextStore:d,collectionViewType:p,buttonPopupStores:g.current,parentStore:s,collectionViewId:x},n)))}),(0,H.jsx)(ge,{schema:a,level:l,combinatorFilter:t,onChange:c,index:o,buttonPopupStores:g.current,collectionContextStore:d,collectionViewType:p})]})}function de(e){const{childFilter:t,newIndex:o,...n}=e,l=(0,r().Fy)();return(0,i().vA)(t)?l.isMobile?(0,H.jsx)(fe,{childFilter:t,newIndex:o,...n}):(0,H.jsx)(xe,{childFilter:t,newIndex:o,...n}):(0,i().aN)(t)?l.isMobile?(0,H.jsx)(ue,{childFilter:t,newIndex:o,...n}):(0,H.jsx)(pe,{childFilter:t,newIndex:o,...n}):null}function pe(e){const{newIndex:t,childFilter:o}=e;return(0,H.jsxs)(n.Fragment,{children:[(0,H.jsx)(z,{index:t,propertyFilter:o,schema:e.schema,filterOperator:(0,H.jsx)(Re,{combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,newIndex:t}),parentStore:e.parentStore,onChange:(t,o)=>Oe(t,o,e.combinatorFilter,e.onChange,e.index),collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId},t),(0,H.jsx)(he,{filter:o,indexToChange:t,level:e.level,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,buttonPopupStores:e.buttonPopupStores})]},t)}function ue(e){const{childFilter:t,newIndex:o}=e;return(0,H.jsxs)(n.Fragment,{children:[(0,H.jsx)(Re,{combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,newIndex:o}),(0,H.jsxs)(ne().Z,{title:(0,H.jsx)(a()._H,{defaultMessage:"Filter {index}",id:"database.filterMenu.filterIndex",values:{index:o+1}}),children:[(0,H.jsx)(z,{index:o,propertyFilter:t,schema:e.schema,filterOperator:null,parentStore:e.parentStore,onChange:(t,o)=>Oe(t,o,e.combinatorFilter,e.onChange,e.index),collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId},o),(0,H.jsx)(he,{filter:t,indexToChange:o,level:e.level,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,buttonPopupStores:e.buttonPopupStores})]})]},o)}function xe(e){const{newIndex:t,childFilter:o}=e,r=(0,l().yK)((e=>({wrapperStyles:{gridColumn:"property-start / value-end",...Ie(e)}})),[]);return(0,H.jsxs)(n.Fragment,{children:[(0,H.jsx)(Re,{combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,newIndex:t}),(0,H.jsx)("div",{style:r.wrapperStyles,children:(0,H.jsx)(se,{index:t,level:e.level+1,combinatorFilter:o,onChange:(t,o)=>Oe(t,o,e.combinatorFilter,e.onChange,e.index),parentStore:e.parentStore,schema:e.schema,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId})}),(0,H.jsx)(he,{filter:o,indexToChange:t,level:e.level,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,buttonPopupStores:e.buttonPopupStores})]},t)}function fe(e){const{childFilter:t,newIndex:o}=e,r=(t.filters||[]).length,l=(0,H.jsx)(a()._H,{defaultMessage:"Filter Group {index}",id:"database.filterMenu.filterGroupIndex",values:{index:o+1}});return(0,H.jsxs)(n.Fragment,{children:[(0,H.jsx)(Re,{combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,newIndex:o}),(0,H.jsxs)(ne().Z,{title:l,children:[(0,H.jsx)(Q().ZP,{buttonPopupStore:je(o,e.buttonPopupStores),popupType:Q().Z4.SlideUp,renderOrigin:o=>(0,H.jsx)(I().Z,{focused:!1,...o,showExtensionArrow:!0,right:r.toString(),title:(0,f().qh)({filter:t,schema:e.schema})}),render:n=>(0,H.jsx)(ee().Z,{menuType:g().o.Modal,title:l,left:(0,H.jsx)(oe().BackMenuText,{}),onClickLeft:n.close,children:(0,H.jsx)(se,{index:o,level:e.level+1,combinatorFilter:t,onChange:(t,o)=>Oe(t,o,e.combinatorFilter,e.onChange,e.index),parentStore:e.parentStore,schema:e.schema,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId})})}),(0,H.jsx)(he,{filter:t,indexToChange:o,level:e.level,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,buttonPopupStores:e.buttonPopupStores})]})]},o)}function ge(e){const t=(0,r().O7)(),o=(0,r().Fy)(),{schema:n,level:i,combinatorFilter:a,onChange:c,index:s,buttonPopupStores:d,collectionContextStore:p,collectionViewType:x}=e,f=(0,l().yK)((()=>({buttonMenuItemStyles:{height:32},sectionMenuItemStyles:{padding:`${u().cn}px 0`}})),[]);return o.isMobile?(0,H.jsxs)(ne().Z,{topBorder:Te(a,i),children:[(0,H.jsx)(Ze,{props:{onClick:()=>ke(t,n,a,c,s,p,x)}}),Ve(e.level)&&(0,H.jsx)(Pe,{props:{onClick:()=>ye(t,n,a,c,s,p,x,d)}})]}):Ve(i)?(0,H.jsx)(ne().Z,{topBorder:Te(a,i),desktopStyle:f.sectionMenuItemStyles,children:(0,H.jsx)(Q().ZP,{alignmentToOrigin:b().Alignment.Start,popupType:w().k.Popup,renderOrigin:e=>(0,H.jsx)(J().i,{action:()=>e.onClick(),render:t=>{const{focused:o,...n}=t;return(0,H.jsx)(V().Z,{...e,...n,focused:o,isBlue:!1,style:f.buttonMenuItemStyles,title:(0,H.jsxs)("div",{children:[(0,H.jsx)(L,{}),(0,m().i)({width:10,marginLeft:6,display:"inline"})]})})}}),render:e=>(0,H.jsx)(te().Z,{type:te().i.Vertical,initialFocus:0,sections:[{key:"actions",render:e=>(0,H.jsx)(ne().Z,{...e}),items:[{key:"add_filter",render:e=>(0,H.jsx)(Ze,{props:e}),action:o=>{e.close(),ke(t,n,a,c,s,p,x)}},{key:"add_filter_group",render:e=>(0,H.jsx)(Pe,{props:e}),action:o=>{e.close(),ye(t,n,a,c,s,p,x,d)}}]}]})})}):(0,H.jsx)(ne().Z,{topBorder:Te(a,i),desktopStyle:f.sectionMenuItemStyles,children:(0,H.jsx)(J().i,{action:()=>ke(t,e.schema,e.combinatorFilter,e.onChange,e.index,e.collectionContextStore,e.collectionViewType),render:e=>{const{focused:o,...r}=e;return(0,H.jsx)(V().Z,{...r,focused:e.focused,isBlue:!1,style:f.buttonMenuItemStyles,onClick:()=>ke(t,n,a,c,s,p,x),title:(0,H.jsx)(L,{})})}})})}function he(e){const t=(0,r().Fy)(),o=(0,a().YB)();return t.isMobile?(0,H.jsx)(me,{filter:e.filter,indexToChange:e.indexToChange,level:e.level,parent:void 0,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,buttonPopupStores:e.buttonPopupStores,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType}):(0,H.jsx)(Q().ZP,{popupType:w().k.Popup,renderOrigin:e=>(0,H.jsx)(J().i,{action:()=>e.onClick(),render:e=>(0,H.jsx)(Y().Z,{...e,hovered:e.focused,style:{width:"100%",height:32},icon:v().o,ariaLabel:o.formatMessage({id:"collections.CollectionFilterCombinatorGrid.RowActions.threeDotActionMenu",defaultMessage:"Edit filter actions"})})}),render:t=>(0,H.jsx)(me,{filter:e.filter,indexToChange:e.indexToChange,level:e.level,parent:t,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,buttonPopupStores:e.buttonPopupStores,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType})})}function me(e){const{filter:t,indexToChange:o,parent:n}=e,l=(0,r().O7)(),s=(0,r().Fy)(),u=(0,i().vA)(t),x=u?(0,H.jsx)(a()._H,{defaultMessage:"Remove",id:"database.filterMenu.removeFilterGroupMenuTitle"}):(0,H.jsx)(a()._H,{defaultMessage:"Remove",id:"database.filterMenu.removeFilterMenuTitle"}),f=u?(0,H.jsx)(a()._H,{defaultMessage:"Duplicate",id:"database.filterMenu.duplicateFilterGroupMenuTitle"}):(0,H.jsx)(a()._H,{defaultMessage:"Duplicate",id:"database.filterMenu.duplicateFilterMenuTitle"}),g=[{key:"delete",action:()=>{var t,r,l,i,a;n&&n.close(),t=o,r=e.buttonPopupStores,l=e.combinatorFilter,i=e.onChange,a=e.index,_e((e=>e.splice(t,1)),l,i,a),je(t,r).reset(),r.splice(t,1)},render:e=>(0,H.jsx)(I().Z,{...e,icon:(0,H.jsx)(we,{icon:C().y}),isRedOnHover:!0,title:x})},{key:"duplicate",action:()=>{n&&n.close(),function(e,t,o,n,r,l,i){_e((t=>{const o=t[e];if(o){const n={...o};t.splice(e,0,n)}}),t,o,n),r?p().wd({environment:i,collectionContextStore:r,action:"add_filter_group"}):d().wd(i,{view_type:l,action:"duplicate_filter"})}(o,e.combinatorFilter,e.onChange,e.index,e.collectionContextStore,e.collectionViewType,l)},render:e=>(0,H.jsx)(I().Z,{...e,icon:(0,H.jsx)(we,{icon:y().a}),title:f})}];if((0,i().aN)(t)&&Ve(e.level)&&g.push({key:"turn_into_group",action:()=>{n&&n.close(),ve(l,o,t,e.combinatorFilter,e.onChange,e.index,e.buttonPopupStores,e.collectionContextStore,e.collectionViewType)},render:e=>(0,H.jsx)(I().Z,{...e,icon:(0,H.jsx)(we,{icon:S().z}),title:(0,H.jsx)(a()._H,{defaultMessage:"Turn into group",id:"database.filterMenu.turnIntoGroupMenuTitle"})})}),(0,i().vA)(t)&&t.filters&&1===t.filters.length){const r=(0,i().vA)(t.filters[0])?(0,H.jsx)(a()._H,{defaultMessage:"Unwrap group",id:"database.filterMenu.unwrapGroupMenuTitle"}):(0,H.jsx)(a()._H,{defaultMessage:"Turn into filter",id:"database.filterMenu.turnIntoFilterMenuTitle"});g.push({key:"turn_into_filter",action:()=>{n&&n.close(),function(e,t,o,n,r,l,a,s){const u=c().Ps(t.filters||[]);u&&!(0,i().Mm)(u)&&Oe(e,u,n,r,l);a?p().wd({environment:o,collectionContextStore:a,action:"turn_into_filter"}):d().wd(o,{view_type:s,action:"turn_into_filter"})}(o,t,l,e.combinatorFilter,e.onChange,e.index,e.collectionContextStore,e.collectionViewType)},render:e=>(0,H.jsx)(I().Z,{...e,icon:(0,H.jsx)(we,{icon:S().z}),title:r})})}const h=Ce(t);return(0,i().vA)(t)&&e.level+h+1<3&&g.push({key:"wrap_in_group",action:()=>{n&&n.close(),ve(l,o,t,e.combinatorFilter,e.onChange,e.index,e.buttonPopupStores,e.collectionContextStore,e.collectionViewType)},render:e=>(0,H.jsx)(I().Z,{...e,icon:(0,H.jsx)(we,{icon:S().z}),title:(0,H.jsx)(a()._H,{defaultMessage:"Wrap in group",id:"database.filterMenu.wrapInGroupMenuTitle"}),caption:(0,H.jsx)(a()._H,{defaultMessage:"Create a filter group around this",id:"database.filterMenu.wrapInGroupMenuCaption"})})}),(0,H.jsx)(te().Z,{initialFocus:s.isMobile?void 0:0,type:te().i.Vertical,sections:[{key:"actions",render:s.isMobile?e=>(0,H.jsx)("div",{...e}):e=>(0,H.jsx)(ne().Z,{...e}),items:g}]})}function ve(e,t,o,n,r,l,i,a,c){Oe(t,{operator:Me(n),filters:[o]},n,r,l),Se(t,i),a?p().wd({environment:e,collectionContextStore:a,action:"turn_into_filter_group"}):d().wd(e,{view_type:c,action:"turn_into_filter_group"})}function ye(e,t,o,n,r,l,i,a){const c=Fe(t,o),s={operator:Me(o),filters:[c]};Se(_e((e=>e.push(s)),o,n,r)-1,a),l?p().wd({environment:e,collectionContextStore:l,action:"add_filter_group"}):d().wd(e,{view_type:i,action:"add_filter_group"})}function Se(e,t){je(e,t).setState({open:!0})}function je(e,t){for(;t.length<e+1;){const e=new(M().Z);t.push(e)}return t[e]}function Ce(e){if((0,i().vA)(e)){const t=(e.filters||[]).filter(i().vA);return 1+(c().Fp(t.map(Ce))||0)}return 0}function be(e){const{operator:t,lowercase:o}=e;return"or"===t?o?(0,H.jsx)(a()._H,{id:"collectionFilterCombinatorGrid.filterOperator.or.lowercase",defaultMessage:"or"}):(0,H.jsx)(a()._H,{id:"collectionFilterCombinatorGrid.filterOperator.or",defaultMessage:"Or"}):"and"===t?o?(0,H.jsx)(a()._H,{id:"collectionFilterCombinatorGrid.filterOperator.and.lowercase",defaultMessage:"and"}):(0,H.jsx)(a()._H,{id:"collectionFilterCombinatorGrid.filterOperator.and",defaultMessage:"And"}):(0,s().t1)(t)}function we(e){let{icon:t,styles:o}=e;return(0,H.jsx)(q().Z,{icon:t,styles:o})}function Me(e){return"or"===e.operator?"and":"or"}function Ve(e){return e<2}function Fe(e,t){const o=(t.filters||[]).filter(i().aN),n=o[o.length-1];return n?c().Xh(n):(0,x().Me)(e)}function _e(e,t,o,n){const r=[...t.filters||[]],l=e(r);return o(n,{...t,filters:r}),l}function Te(e,t){return(0,i().$1)(e)&&0===t}function Ze(e){let{props:t}=e;const o=(0,H.jsx)(we,{icon:j().R});return(0,H.jsx)(I().Z,{focused:!1,...t,icon:o,title:(0,H.jsx)(L,{})})}function Pe(e){let{props:t}=e;const o=(0,H.jsx)(we,{icon:h().t});return(0,H.jsx)(I().Z,{focused:!1,...t,icon:o,title:(0,H.jsx)(a()._H,{defaultMessage:"Add filter group",id:"database.filterMenu.addFilterGroup2ButtonTitle"}),caption:(0,H.jsx)(a()._H,{defaultMessage:"A group to nest more filters",id:"database.filterMenu.addFilterGroupButtonCaption"})})}function Ie(e){return{background:e.filterGroupBackground,borderRadius:6,boxShadow:`0 0 0 1px ${e.filterGroupBorder}`,margin:1,alignSelf:"stretch"}}function Oe(e,t,o,n,r){_e((o=>o.splice(e,1,t)),o,n,r)}function ke(e,t,o,n,r,l,i){const a=Fe(t,o);_e((e=>e.push(a)),o,n,r),l?p().wd({environment:e,collectionContextStore:l,action:"add_filter"}):d().wd(e,{view_type:i,action:"add_filter"})}function Re(e){let{newIndex:t,combinatorFilter:o,onChange:n,index:l,collectionContextStore:i,collectionViewType:c}=e;const s=(0,r().O7)(),u=o.operator,{device:x}=s,f={justifySelf:"end"},g={...f,lineHeight:"32px",paddingRight:4};if(0===t)return x.isMobile?null:(0,H.jsx)(R().Z,{style:g,children:(0,H.jsx)(a()._H,{defaultMessage:"Where",id:"database.filterMenu.where"})});if(1===t){const e=(0,H.jsx)(X,{disableMargins:!0,filterOperator:u,onChange:e=>function(e,t,o,n,r,l,i){n(r,{...o,operator:e}),l?p().wd({environment:t,collectionContextStore:l,action:"set_filter_operator"}):d().wd(t,{view_type:i,action:"set_filter_operator"})}(e,s,o,n,l,i,c)});return s.device.isMobile?(0,H.jsx)(ne().Z,{children:e}):(0,H.jsx)("div",{style:f,children:e})}return x.isMobile?null:(0,H.jsx)(R().Z,{style:g,children:(0,H.jsx)(be,{operator:u})})}},253368:(e,t,o)=>{o.d(t,{Z:()=>z,$:()=>Q});o(267602),o(653476),o(241792);var n=o(667294),r=()=>o(219727),l=()=>o(142735),i=()=>o(846550),a=()=>o(816512),c=()=>o(455947),s=()=>o(226413),d=()=>o(532850),p=()=>o(38883),u=()=>o(803021),x=()=>o(995867),f=()=>o(605974),g=()=>o(788860),h=()=>o(696459),m=()=>o(707513),v=()=>o(491927),y=()=>o(250303),S=()=>o(788899),j=()=>o(32072),C=()=>o(129338),b=()=>o(826955),w=()=>o(347558),M=()=>o(780550),V=()=>o(893276),F=()=>o(527278),_=()=>o(384547),T=()=>o(573357),Z=()=>o(291198),P=()=>o(740046),I=o(785893);const O=(0,g().vU)({value:{defaultMessage:"Value",id:"database.filterAndSort.propertyValueInput.placeholder"}});function k(e){let{value:t,onChange:o}=e;const{device:l}=(0,r().O7)(),a=(0,n.useRef)(null),[c,s]=(0,n.useState)(!1),d=(0,n.useCallback)((()=>s(!0)),[s]),p=(0,n.useCallback)((()=>s(!1)),[s]),u=(0,n.useCallback)((e=>{o(e.target.value)}),[o]),x=(0,n.useCallback)((()=>{if(a.current){var e;(null===(e=window)||void 0===e?void 0:e.document.activeElement)===a.current&&a.current.blur(),p()}}),[p]),f=(0,i().yK)((e=>({focused:{background:e.buttonHoveredBackground},unfocused:{background:"transparent"}})),[]),h=t||"";return(0,I.jsx)("div",{style:{display:"flex",margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},onClick:d,children:l.isMobile?(0,I.jsx)(P().ZP,{value:h,onChange:u,placeholder:F().Z.formatMessage(O.value),onBlur:p,rightMobileEditLabel:(0,I.jsx)(g()._H,{defaultMessage:"Edit",id:"database.filterAndSort.mobileEditButton.label"})}):(0,I.jsx)(_().i,{action:d,render:e=>(0,I.jsx)("div",{ref:e.ref,onMouseEnter:e.onMouseEnter,style:{...e.focused&&!c?f.focused:f.unfocused,margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},children:(0,I.jsx)(T().Z,{capture:c,render:e=>(0,I.jsx)("div",{...e,style:{margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},children:(0,I.jsx)(Z().Z,{focus:c,ref:a,value:h,onChange:u,placeholder:F().Z.formatMessage(O.value),onBlur:p,onCancel:x,style:{marginRight:8,paddingLeft:6,paddingRight:0,width:80,height:30,...{margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},minWidth:w().bU}})})})})})})}var R=()=>o(827973),A=()=>o(448419),H=()=>o(715139),G=()=>o(397540),B=()=>o(864832),U=()=>o(308252),$=()=>o(960647),K=()=>o(328094),W=()=>o(783761),E=()=>o(246471);const D=(0,g().vU)({dateTitle:{defaultMessage:"Date",id:"database.filterMenu.mobileDateSelectMenu.title"},emptyPlaceholder:{defaultMessage:"Empty",id:"database.filterMenu.dateSelectMenu.emptyPlaceholder"}});function Q(e){return e?(0,I.jsx)(g()._H,{defaultMessage:"Select one person",id:"database.personPropertyValue.selectPerson.searchPlaceholderWithLimit"}):(0,I.jsx)(g()._H,{defaultMessage:"Select one or more people",id:"database.personPropertyValue.selectPerson.searchPlaceholder"})}const z=function(e){let{schema:t,property:n,parentStore:l,filter:i,collectionViewId:a,filterValueType:s,onChange:d,collectionContextStore:p,collectionViewType:u}=e;const x=(0,r().O7)(),f=(0,g().YB)(),m=(0,I.jsx)("span",{});if("date"===s)return(0,c().gE)(i)?(0,c().mv)(i)?m:(0,c().TQ)(i)?(0,I.jsx)(oe,{intl:f,parentStore:l,schema:t,collectionViewId:a,property:n,onChange:d,collectionContextStore:p,collectionViewType:u,filter:i}):(0,I.jsx)(te,{intl:f,collectionViewId:a,property:n,schema:t,parentStore:l,onChange:d,collectionContextStore:p,collectionViewType:u,filter:i}):m;if("text"===s){if(!(0,c().Ly)(i))return m;const e=i;if((0,c().mv)(e))return m;if("string_has_no_alphabet_prefix"===e.operator)return null;const t=e.value;return(0,I.jsx)(k,{value:t.value,onChange:t=>{const o={type:"exact",value:t},n={...e,value:o};d(n)}})}if("number"===s){if(!(0,c().h6)(i))return m;const e=i;if((0,c().mv)(e))return m;const t=e.value;return(0,I.jsx)(k,{value:void 0===t.value?"":t.value.toString(),onChange:t=>{const n={type:"exact",value:(0,o(946444).m)(t,f)},r={...e,value:n};d(r)}})}if("checkbox"===s){if(!(0,c().XA)(i)||!a)return m;const e=i,o=e.value;return(0,I.jsx)(A().ZP,{popupType:x.device.isMobile?A().Z4.SlideUp:A().Z4.Popup,renderOrigin:e=>(0,I.jsx)(X,{operatorValue:o,events:e}),render:o=>(0,I.jsx)(M().ZP,{collectionViewId:a,propertyFilter:{property:n,filter:e},schema:t,onChange:e=>{d(e)},onClose:o.close,parentStore:l,context:M().Qv.AdvancedFilter,allowRelativePersonFilter:!0})})}if("select"===s||"multi_select"===s||"status"===s){if(!((0,c().dx)(i)||(0,c().NU)(i)||(0,c().r2)(i))||!a)return m;const e=i;if((0,c().mv)(e))return m;const o=t[n];if(!o)return m;const r=(0,c().dx)(e)?(0,c().mg)(e):(0,c().NU)(e)?(0,c().qC)(e):(0,c().Js)(o,(0,c().wB)(e));return(0,I.jsx)(A().ZP,{popupType:x.device.isMobile?A().Z4.SlideUp:A().Z4.Popup,renderOrigin:e=>(0,I.jsx)(ee,{schema:t,property:n,operatorValues:r,events:e}),render:o=>(0,I.jsx)(M().ZP,{collectionViewId:a,propertyFilter:{property:n,filter:e},schema:t,onChange:e=>{d(e)},onClose:o.close,parentStore:l,context:M().Qv.AdvancedFilter,allowRelativePersonFilter:!0})})}if("location"===s){if(!(0,c().Mp)(i))return m;const e=i,o=(0,c().u0)(e);return(0,I.jsx)(A().ZP,{popupType:x.device.isMobile?A().Z4.SlideUp:A().Z4.Popup,renderOrigin:e=>(0,I.jsx)(J,{parentStore:l,operatorValues:o,events:e}),render:o=>(0,I.jsx)(M().ZP,{collectionViewId:a,propertyFilter:{property:n,filter:e},schema:t,onChange:e=>{d(e)},onClose:o.close,parentStore:l,context:M().Qv.AdvancedFilter,allowRelativePersonFilter:!0})})}if("relation"===s){if(!(0,c().e)(i)||!a)return m;const e=i;if((0,c().mv)(e))return m;const o=(0,c().YO)(e);return(0,I.jsx)(A().ZP,{popupType:x.device.isMobile?A().Z4.SlideUp:A().Z4.Popup,renderOrigin:e=>(0,I.jsx)(le,{parentStore:l,operatorValues:o,events:e,schema:t,property:n}),render:o=>(0,I.jsx)(M().ZP,{collectionViewId:a,propertyFilter:{property:n,filter:e},schema:t,onChange:e=>{d(e)},onClose:o.close,parentStore:l,context:M().Qv.AdvancedFilter,allowRelativePersonFilter:!0})})}if("person"===s){if(!(0,c().Gb)(i)||!a)return m;const e=i;if((0,c().mv)(e))return m;const o=(0,c().R8)(e);return(0,I.jsx)(A().ZP,{popupType:x.device.isMobile?A().Z4.SlideUp:A().Z4.Popup,renderOrigin:e=>(0,I.jsx)(re,{parentStore:l,operatorValues:o,events:e}),render:o=>(0,I.jsx)(M().ZP,{collectionViewId:a,propertyFilter:{property:n,filter:e},schema:t,onChange:e=>{d(e)},onClose:o.close,parentStore:l,context:M().Qv.AdvancedFilter,allowRelativePersonFilter:!0})})}if("file"===s){if(!(0,c().W6)(i))return m;const e=i;if((0,c().mv)(e))return m;(0,h().t1)(e)}if("verification"===s)return(0,c().Jw)(i)?(0,I.jsx)(A().ZP,{popupType:x.device.isMobile?A().Z4.SlideUp:A().Z4.Popup,renderOrigin:e=>(0,I.jsx)(q,{operatorValues:(0,c().fl)(i),events:e}),render:e=>(0,I.jsx)(M().ZP,{collectionViewId:a,propertyFilter:{property:n,filter:i},schema:t,onChange:e=>{d(e)},onClose:e.close,parentStore:l,context:M().Qv.AdvancedFilter,allowRelativePersonFilter:!1})}):m;(0,h().t1)(s)};function L(){return{maxWidth:w().oe}}function N(e){return{paddingTop:e?6:void 0,overflow:"hidden"}}function X(e){let{operatorValue:t,events:o}=e;const n=null==t?void 0:t.value;return(0,I.jsx)($().Z,{...o,disableMargins:!0,placeholder:(0,I.jsx)(g()._H,{defaultMessage:"Select a value",id:"database.filterOperatorValue.checkboxPlaceholder.title"}),title:"boolean"==typeof n&&(0,I.jsx)(H().Z,{checked:n,size:16,disabled:!0})})}function q(e){let{operatorValues:t,events:o}=e;const n=t.filter((e=>{let{value:t}=e;return Boolean(t)})).map(j().cq);return(0,I.jsx)($().Z,{...o,disableMargins:!0,placeholder:(0,I.jsx)(g()._H,{defaultMessage:"Select an option",id:"CollectionFilterMenuFilterOperatorValue.verificationFilterSelect.placeholder"}),title:n.length&&(0,I.jsx)("span",{children:(0,x().Z)(n,(e=>(0,I.jsx)("span",{style:{whiteSpace:"pre"},children:(0,I.jsx)(g()._H,{defaultMessage:", ",id:"CollectionFilterMenuFilterOperatorValue.verificationFilterSelect.commaSeparator"})},e)))})})}function J(e){let{operatorValues:t,events:o,parentStore:n}=e;return(0,I.jsx)($().Z,{...o,disableMargins:!0,desktopStyle:L(),innerStyle:N(t.length>0),placeholder:(0,I.jsx)(g()._H,{defaultMessage:"Select a location",id:"databaseLocationOperators.selectPlaceholder"}),title:t.length>0&&t.map((e=>e.value&&(0,I.jsx)("div",{style:{margin:"0 10px 6px 0"},children:(0,I.jsx)(V().Z,{collectionStore:b().NW.createChildStore(n,{table:"collection",id:e.value})})},e.value)))})}function Y(e){let{operatorValue:t,events:o,isRange:n,schema:r,property:l}=e;const i=r[l],a=i&&"date"===i.type?i.date_format:void 0;let c;if("exact"===t.type&&t.value)if((0,u().J_)(t.value))c=t.value;else if((0,u().gR)(t.value)){const e=(0,u().Gc)(t.value);e&&(c=e.value)}return(0,I.jsx)($().Z,{...o,placeholder:n?(0,I.jsx)(g()._H,{defaultMessage:"Select a range",id:"database.filterAndSort.dateRangePropertyValue.placeholder"}):(0,I.jsx)(g()._H,{defaultMessage:"Select a date",id:"database.filterAndSort.datePropertyValue.placeholder"}),desktopStyle:{minWidth:165},title:c&&(0,I.jsx)("span",{style:{...m().Yu},children:(0,I.jsx)(U().Z,{value:c,dateFormat:a||u().sF})}),disableMargins:!0})}function ee(e){let{operatorValues:t,events:o,schema:n,property:l}=e;const i=(0,r().O7)(),{device:a}=i,c=n[l],u=c&&((0,s().cu)(c)||"status"===c.type)&&c.options||[];return(0,I.jsx)($().Z,{...o,disableMargins:!0,desktopStyle:L(),innerStyle:N(t.length>0),placeholder:(0,I.jsx)(g()._H,{defaultMessage:"Select an option",id:"collections.operatorValueSelect.placeholder"}),title:t.length>0&&(0,I.jsx)(I.Fragment,{children:t.map((e=>{if(void 0===e.value)return null;const t=(0,d().i7)(u,e.value);return t?(0,I.jsx)(E().a,{format:a.isMobile?p().lo.Large:p().lo.Medium,isSingle:!1,value:t.value,color:t.color,showRemoveButton:!1},e.value):null}))})})}function te(e){let{filter:t,intl:o,collectionViewId:n,property:l,schema:i,parentStore:a,onChange:s,collectionContextStore:d,collectionViewType:p}=e;const u=(0,r().O7)();if(!n)return null;const x={menuTitle:o.formatMessage(D.dateTitle),items:c().tO,getKey:e=>"relative"===e.type?e.value:e.type,selectedItem:t.value,onSelect:e=>{const o={...t,value:e};s(o),d?y().wd({environment:u,collectionContextStore:d,action:"set_filter_value_type"}):v().wd(u,{view_type:p,action:"set_filter_value_type"})},renderItem:e=>(0,I.jsx)(R().Z,{title:(0,j().x)(e.value),...e}),renderOrigin:e=>(0,I.jsx)($().Z,{...e,disableMargins:!0,placeholder:o.formatMessage(D.emptyPlaceholder),title:(0,j().x)(t.value)})},f=t.value;if("exact"===f.type){const e=(0,I.jsx)(g()._H,{id:"collectionFilterMenuFilterOperatorValue.date.exact.order",defaultMessage:"{exact}{dateValue}",values:{exact:(0,I.jsx)(G().Z,{...x,mobileActionSheet:!0},"date-filter-value-type"),dateValue:(0,I.jsx)(A().ZP,{popupType:u.device.isMobile?A().Z4.SlideUp:A().Z4.Popup,renderOrigin:e=>(0,I.jsx)(Y,{schema:i,property:l,operatorValue:f,events:e,isRange:!1}),render:e=>(0,I.jsx)(M().ZP,{collectionViewId:n,propertyFilter:{property:l,filter:t},schema:i,onChange:e=>{s(e)},onClose:e.close,parentStore:a,context:M().Qv.AdvancedFilter,allowRelativePersonFilter:!0})})}}),o=u.device.isDesktop?{display:"grid",justifyContent:"stretch",gridTemplateColumns:"1fr 1fr",gridColumnGap:S().l0,width:"100%"}:void 0;return(0,I.jsx)("div",{style:o,children:e})}return(0,I.jsx)(G().Z,{...x,mobileActionSheet:!0},"date-filter-value-type")}function oe(e){let{filter:t,intl:o,parentStore:n,schema:l,collectionViewId:i,property:a,onChange:s,collectionContextStore:d,collectionViewType:p}=e;const u=(0,r().O7)();if(!i)return null;const x={menuTitle:o.formatMessage(D.dateTitle),items:(0,c().bS)(),getKey:e=>(0,c().eX)(e),selectedItem:t.value,onSelect:e=>{const o={...t,value:e};s(o),d?y().wd({environment:u,collectionContextStore:d,action:"set_filter_value_type"}):v().wd(u,{view_type:p,action:"set_filter_value_type"})},renderItem:e=>(0,I.jsx)(R().Z,{title:(0,j().ip)(e.value),...e}),renderOrigin:e=>(0,I.jsx)($().Z,{...e,disableMargins:!0,placeholder:o.formatMessage(D.emptyPlaceholder),title:(0,j().ip)(t.value)})},f=t.value;if("exact"===f.type){const e=(0,I.jsx)(g()._H,{id:"collectionFilterMenuFilterOperatorValue.dateRange.exact.order",defaultMessage:"{dateValue}",values:{exact:(0,I.jsx)(G().Z,{...x,mobileActionSheet:!0},"date-filter-value-type"),dateValue:(0,I.jsx)(A().ZP,{popupType:u.device.isMobile?A().Z4.SlideUp:A().Z4.Popup,renderOrigin:e=>(0,I.jsx)(Y,{schema:l,property:a,operatorValue:f,events:e,isRange:!0}),render:e=>(0,I.jsx)(M().ZP,{collectionViewId:i,propertyFilter:{property:a,filter:t},schema:l,onChange:e=>{s(e)},onClose:e.close,parentStore:n,context:M().Qv.AdvancedFilter,allowRelativePersonFilter:!0})})}}),o=u.device.isDesktop?{display:"grid",justifyContent:"stretch",gridTemplateColumns:"1fr 1fr",gridColumnGap:S().l0,width:"100%"}:void 0;return(0,I.jsx)("div",{style:o,children:e})}return"relative"!==f.type||"custom"!==f.value&&"surrounding"!==f.value?(0,I.jsx)(G().Z,{...x,mobileActionSheet:!0},"date-filter-value-type"):(0,I.jsx)(W().b,{renderAsQueryDropdown:u.device.isMobile,filter:f,onUpdate:e=>{const o={...t,value:e};s(o),d?y().wd({environment:u,collectionContextStore:d,action:"set_filter_value_type"}):v().wd(u,{view_type:p,action:"set_filter_value_type"})}})}function ne(e){var t;let{operatorValue:o,parentStore:n}=e;const i=(0,r().O7)(),{device:c}=i,s=(0,l().VK)((()=>!o.value||"relative"===o.type&&"me"===o.value?void 0:(0,a().Hl)({pointer:o.value,getRecordValue:n.getRecordValue})),[o,n]);return o.value?"relative"===o.type&&"me"===o.value?(0,I.jsx)("span",{style:{marginTop:1,marginRight:10,marginBottom:6},children:(0,I.jsx)(g()._H,{defaultMessage:"Me",id:"database.filterAndSort.firstPersonPropertyValue.title"},"relative")}):s?(0,I.jsx)(B().ZP,{actor:s,isSingle:!1,shouldShrink:!1,format:c.isMobile?B().vw.Format.Large:B().vw.Format.Medium,showRemoveButton:!1},null===(t=s.asActor)||void 0===t?void 0:t.id):null:null}function re(e){let{operatorValues:t,events:o,parentStore:n}=e;return(0,I.jsx)($().Z,{...o,placeholder:Q(void 0),disableMargins:!0,desktopStyle:L(),innerStyle:N(t.length>0),title:t.length>0&&t.map((e=>(0,I.jsx)(ne,{operatorValue:e,parentStore:n},`${e.type}__${e.value}`)))})}function le(e){let{operatorValues:t,events:o,parentStore:n,schema:a,property:c}=e;const d=(0,i().Fg)(),u=(0,r().O7)(),{device:x}=u,m=a[c],v=(0,l().VK)((()=>{if(m&&(0,s().p_)(m))return(0,C().ke)(m,n)}),[m,n]);return(0,I.jsx)($().Z,{...o,disableMargins:!0,desktopStyle:L(),innerStyle:N(t.length>0),placeholder:(0,I.jsx)(g()._H,{defaultMessage:"Select a page",id:"databaseRelationOperators.selectPlaceholder"}),title:t.length>0&&t.map(((e,t)=>{if(!e.value)return null;const o=e.type,r={isSingle:!1,shouldShrink:!1,format:x.isMobile?p().lo.Large:p().lo.Medium};if("exact"===o)return(0,I.jsx)(K().Z,{blockId:e.value,parentStore:n,relationPropertySchema:m&&(0,s().p_)(m)?m:void 0,...r},e.value);if("relative"===o){if("builtin"===e.value.type)return v?(0,I.jsx)(p().ZP,{value:(0,I.jsx)(g()._H,{...f().qB[v][e.value.variable].messageDescriptor}),backgroundColor:"transparent",theme:d,...r},t):null;if("current_page_in_related_collection"===e.value.type)return(0,I.jsx)(p().ZP,{value:(0,I.jsx)(g()._H,{defaultMessage:"This page",id:"database.filterAndSort.currentPagePropertyValue.title"}),backgroundColor:"transparent",theme:d,...r},t)}else(0,h().t1)(o)}))})}},742870:(e,t,o)=>{o.d(t,{t:()=>r});o(667294);var n=o(785893);const r=(0,o(827282).IU)("addFilterGroup",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M2.374 12.42h1.293v1.157c0 1.557.787 2.344 2.375 2.344h7.591c1.573 0 2.367-.787 2.367-2.344V5.924c0-1.557-.794-2.344-2.367-2.344h-1.3V2.423C12.333.866 11.539.08 9.966.08H2.374C.786.08 0 .866 0 2.423v7.653c0 1.557.786 2.344 2.374 2.344zm.015-1.218c-.756 0-1.172-.408-1.172-1.194V2.49c0-.786.416-1.194 1.172-1.194h7.554c.749 0 1.172.408 1.172 1.194v1.09H6.042c-1.588 0-2.375.778-2.375 2.343v5.278H2.39zm3.668 3.501c-.749 0-1.172-.408-1.172-1.194V5.991c0-.786.423-1.194 1.172-1.194h7.554c.748 0 1.172.408 1.172 1.194v7.516c0 .787-.424 1.195-1.172 1.195H6.057zm3.773-1.565c.4 0 .643-.272.643-.71v-2.042h2.17c.423 0 .718-.227.718-.628 0-.408-.272-.643-.718-.643h-2.17V6.938c0-.447-.242-.719-.643-.719-.4 0-.628.288-.628.719v2.177h-2.17c-.438 0-.718.235-.718.643 0 .4.295.628.718.628h2.17v2.041c0 .424.227.711.628.711z"})})}}]);