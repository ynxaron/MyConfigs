"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[50801],{725819:(e,t,r)=>{r.r(t),r.d(t,{LinkPreviewLab:()=>V,default:()=>$});r(241792);var i=r(667294),n=()=>r(219727),s=()=>r(142735),o=()=>r(846550),a=()=>r(198690),l=()=>r(705214),d=()=>r(36588),u=()=>r(955620),c=()=>r(830968),g=()=>r(788860),x=()=>r(696459),p=()=>r(707513),v=()=>r(957042),h=()=>r(631986),m=()=>r(859193),b=()=>r(352230),j=()=>r(615634),f=()=>r(488949),y=()=>r(876822),S=()=>r(529048),w=()=>r(138912),T=()=>r(632599),I=()=>r(154186),R=()=>r(827973),A=()=>r(448419),M=()=>r(291198),U=()=>r(198829),C=()=>r(255577),k=()=>r(661641),P=()=>r(661297),L=()=>r(388284),Z=()=>r(615912),B=()=>r(311598),E=()=>r(878517),_=()=>r(42557),H=()=>r(877289),z=r(785893);function $(e){const{integrationPointer:t}=e,r=(0,s().VK)((()=>y().default.state.currentUserStore),[]),i=(0,s().VK)((()=>{if(r)return r.getRecordValue(t)}),[r,t]),n=(0,a().V)({value:i,waitTimeInMs:5e3}),d=(0,o().yK)((()=>({header:{marginBottom:24}})),[]);return"pending"===n.status?(0,z.jsx)(T().Z,{}):"rejected"!==n.status&&(0,l().VM)(n.value)?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("div",{style:d.header,children:[(0,z.jsx)(k().q,{styleName:"UITitle-30px/Semibold",children:(0,z.jsx)(g()._H,{id:"developerIntegrationLab.title.label",defaultMessage:"Link Preview Lab"})}),(0,z.jsx)(k().q,{styleName:"Heading-17px/Regular",children:(0,z.jsx)(g()._H,{id:"developerIntegrationLab.subtitle.label",defaultMessage:"Plan out preview URL regex patterns and API responses."})})]}),(0,z.jsx)(V,{starterIntegration:n.value})]}):(0,z.jsx)(Z().Z,{})}function V(e){let{starterIntegration:t}=e;const[r,n]=i.useState(""),[s,o]=i.useState(m().Az),[a,l]=i.useState(m().SV),[d,u]=i.useState(m().VR()),[g,x]=i.useState(m().nZ),[p,v]=i.useState(m().e_),[h,b]=i.useState(m().P4),[j,f]=i.useState(t);return i.useEffect((()=>{const{original_url_domains:e,development_url_domains:r,original_url_patterns:i}=t.info,n=(null==e?void 0:e[0])||(null==r?void 0:r[0]);if(n&&x(n),null!=i&&i[0]){const{regex:e,attributes:t,sample_urls:r}=null==i?void 0:i[0];v(e);const n=t.map(c().Ah);b(n);const s=null==r?void 0:r[0];s&&o(s)}}),[t]),i.useEffect((()=>{f((e=>m().Hx({domain:g,regex:p,attributes:h,currentIntegration:e})))}),[g,p,h]),i.useEffect((()=>{w().default.setState({loaded:!0,loading:!1,userId:void 0,spaceId:m().C,integrations:[j],externalAuthentications:[],bots:[],completeSlackAuthentications:[],twoWaySyncExternalEntities:[]})}),[j]),(0,z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,z.jsx)(D,{style:{flex:1,marginRight:12},setErrorMessage:n,rootUrl:s,setRootUrl:o,relatedUrisToAttributes:d,setRelatedUrisToAttributes:u,domain:g,setDomain:x,regexPattern:p,setRegexPattern:v,regexAttributes:h,setRegexAttributes:b,rootAttributes:a,setRootAttributes:l}),(0,z.jsx)(O,{style:{flex:1},rootUrl:s,rootAttributes:a,relatedUrisToAttributes:d,integration:j,errorMessage:r})]})}function D(e){const{style:t,rootUrl:r,setRootUrl:i,domain:n,setDomain:o,regexPattern:a,setRegexPattern:l,regexAttributes:u,setRegexAttributes:c,rootAttributes:x,setRootAttributes:v,relatedUrisToAttributes:h,setRelatedUrisToAttributes:b,setErrorMessage:j}=e,f=(0,s().VK)((()=>m().TG(x)),[x]);return(0,z.jsxs)("div",{style:t,children:[(0,z.jsxs)("label",{children:[(0,z.jsx)("div",{style:{fontSize:15,fontWeight:p().Ue.medium},children:(0,z.jsx)(g()._H,{id:"developerIntegrationLab.rootUrl.label",defaultMessage:"Pasted URL to Preview"})}),(0,z.jsx)(M().Z,{value:r,onChange:e=>i(e.target.value)})]}),(0,z.jsxs)(N,{title:(0,z.jsx)(g()._H,{id:"developerIntegrationLab.regexConfiguration.label",defaultMessage:"Manage Regex Configuration"}),style:{marginTop:12},children:[(0,z.jsxs)("label",{style:{marginTop:12},children:[(0,z.jsx)("div",{style:{fontSize:15,fontWeight:p().Ue.medium},children:(0,z.jsx)(g()._H,{id:"developerIntegrationLab.domain.label",defaultMessage:"Domain"})}),(0,z.jsx)(M().Z,{value:n,onChange:e=>o(e.target.value)})]}),(0,z.jsx)(G,{regexPattern:a,setRegexPattern:l,setErrorMessage:j}),(0,z.jsxs)("label",{style:{marginTop:12},children:[(0,z.jsx)("div",{style:{fontSize:15,fontWeight:p().Ue.medium},children:(0,z.jsx)(g()._H,{id:"developerIntegrationLab.regexAttributes.label",defaultMessage:"Regex Attributes"})}),(0,z.jsx)(W,{value:u,onChange:c,validationType:d().$1,setErrorMessage:j})]})]}),(0,z.jsx)(N,{title:(0,z.jsx)(g()._H,{id:"developerIntegrationLab.rootAttributes.label",defaultMessage:"Unfurl response payload"}),style:{marginTop:12},children:(0,z.jsx)(W,{value:x,onChange:v,validationType:d().$1,setErrorMessage:j})}),(0,z.jsx)(N,{title:(0,z.jsx)(g()._H,{id:"developerIntegrationLab.relatedAttributes.label",defaultMessage:"Related unfurl response payloads"}),style:{marginTop:12},children:f.map((e=>{const t=h[e];return(0,z.jsx)(N,{title:e,style:{marginTop:12,marginLeft:12},children:t?(0,z.jsx)(W,{value:t,onChange:t=>{b({...h,[e]:t})},validationType:d().$1,setErrorMessage:j}):(0,z.jsx)(g()._H,{id:"developerIntegrationLab.relatedAttributes.empty",defaultMessage:"No related attributes found."})},e)}))})]})}const F=["preview","mention","hover"],K=["authenticate","error","update","loaded"];function O(e){const{style:t,rootUrl:r,rootAttributes:n,relatedUrisToAttributes:s,integration:o,errorMessage:a}=e,[l,d]=i.useState("preview"),[u,c]=i.useState("loaded");return(0,z.jsxs)("div",{style:t,children:[(0,z.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,z.jsx)("div",{style:{marginRight:12},children:"Preview type:"}),(0,z.jsx)(J,{title:l,options:F,onSelectOption:e=>d(e)}),(0,z.jsx)("div",{style:{marginLeft:12,marginRight:12},children:"Preview state:"}),(0,z.jsx)(J,{title:u,options:K,onSelectOption:e=>c(e)})]}),(0,z.jsx)("div",{style:{marginTop:12,maxWidth:600},children:(0,z.jsx)(q,{previewType:l,previewState:u,rootUrl:r,rootAttributes:n,relatedUrisToAttributes:s,integration:o,errorMessage:a})})]})}function N(e){const[t,r]=i.useState(!1);return(0,z.jsxs)("div",{style:e.style,children:[(0,z.jsxs)(I().Z,{onClick:()=>r(!t),style:{display:"flex",alignItems:"center"},children:[(0,f().L)({width:"0.6875em",height:"0.6875em",transition:"transform 200ms ease-out",transform:`rotateZ(${t?180:90}deg)`,marginRight:4}),e.title]}),t&&e.children]})}function W(e){const{value:t,onChange:r,validationType:n,setErrorMessage:s}=e,[o,a]=i.useState(JSON.stringify(t,null,2));return(0,z.jsx)(M().Z,{format:M().B.ExtraLarge,inputStyle:{fontSize:14,lineHeight:"18px",height:500},textarea:!0,value:o,onChange:e=>{const t=e.target.value;a(t);const i=h().Jv(t);if(void 0===i)s("Could not parse JSON object input.");else{const e=(0,v().Gu)(n,i);e?s(e.message):(s(""),r(i))}}})}function G(e){const{regexPattern:t,setRegexPattern:r,setErrorMessage:n}=e,[s,o]=i.useState(t);return(0,z.jsxs)("label",{style:{marginTop:12},children:[(0,z.jsx)("div",{style:{fontSize:15,fontWeight:p().Ue.medium},children:"Regex Pattern"}),(0,z.jsx)(M().Z,{value:s,onChange:e=>{const t=e.target.value;o(t);try{new RegExp(t);r(t),n("")}catch(i){n("Invalid Regex.")}}})]})}function J(e){const{title:t,options:r,onSelectOption:i}=e,[n,o,a]=(0,s().AF)(void 0,S().Z);return(0,z.jsx)(A().ZP,{popupType:A().Z4.Popup,buttonPopupStore:a,renderOrigin:()=>(0,z.jsxs)(P().Z,{onClick:()=>o({...n,open:!0}),children:[t,(0,j().i)({width:10,marginTop:4,marginLeft:4})]}),render:()=>(0,z.jsx)(U().Z,{menuType:b().o.Popup,children:(0,z.jsx)(C().Z,{type:C().i.Vertical,sections:[{key:t,items:r.map((e=>({key:e,action:()=>{i(e),o({...n,open:!1})},render:t=>(0,z.jsx)(R().Z,{...t,title:e})}))),render:e=>(0,z.jsx)(L().Z,{...e})}],initialFocus:void 0})})})}function q(e){const{previewType:t,previewState:r,rootUrl:s,rootAttributes:a,relatedUrisToAttributes:l,integration:d,errorMessage:u}=e,[c,g]=i.useState(""),x=(0,n().O7)(),[p,v]=i.useState();i.useEffect((()=>{const e=m().rn({environment:x,rootUrl:s,rootAttributes:a,relatedUrisToAttributes:l,integration:d});"error"in e?g(e.error):(g(""),v(e))}),[x,s,a,l,d]),i.useEffect((()=>{g(u)}),[u]);const h=(0,o().yK)((e=>({error:{marginTop:12,marginBottom:12,padding:"12px 24px",marginRight:"auto",backgroundColor:e.accentColors.red[100]}})),[]);return(0,z.jsxs)(z.Fragment,{children:[c&&(0,z.jsxs)("div",{style:h.error,children:[c," "]}),p&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(H().wd,{isInverted:!1,showInsets:!1,showSize:!1,children:(0,z.jsx)(X,{previewType:t,previewState:r,previewStores:p})}),(0,z.jsx)(H().wd,{isInverted:!0,showInsets:!1,showSize:!1,children:(0,z.jsx)(X,{previewType:t,previewState:r,previewStores:p})})]})]})}function Q(e){const{previewStores:t}=e,r=(0,o().yK)((e=>({container:{borderRadius:6,boxShadow:e.lightBoxShadow}})),[]),i=(0,s().VK)((()=>{const e=t.previewBlockStore.id;if(!e)return;return{annotation:(0,u().x36)(e),store:t.inlineBlockStore,token:void 0}}),[t.previewBlockStore,t.inlineBlockStore]);return i?(0,z.jsx)("div",{style:r.container,children:(0,z.jsx)(E().D5,{isHoveredTokenEditable:!0,state:i})}):null}function X(e){const{previewType:t,previewState:r,previewStores:i}=e;return"preview"===t?(0,z.jsx)(B().Z,{store:"authenticate"===r?i.emptyInstanceBlockStore:i.previewBlockStore,disabled:!1,forceActionForUIDoc:"loaded"===r?void 0:r}):"mention"===t?(0,z.jsx)(_().Z,{store:"authenticate"===r?i.emptyInlineBlockStore:i.inlineBlockStore,disabled:!1}):"hover"===t?(0,z.jsx)(Q,{...e}):void(0,x().t1)(t)}},877289:(e,t,r)=>{r.d(t,{wd:()=>h});r(267602),r(653476),r(241792);var i=r(667294),n=()=>r(206489),s=()=>r(219727),o=()=>r(846550),a=()=>r(435308),l=()=>r(200568),d=()=>r(523733),u=()=>r(568017),c=()=>r(707513),g=()=>r(998901),x=()=>r(654133),p=()=>r(67961),v=r(785893);(0,r(788860).vU)({copyColor:{defaultMessage:"Copied '{stringValue}'",id:"uidoc.colors.copied"}});function h(e){const[t,r]=(0,i.useState)(!1);return(0,v.jsx)("div",{onMouseEnter:()=>{r(!0)},onMouseLeave:()=>{r(!1)},children:(0,v.jsx)(m,{marginTopBottom:e.marginTopBottom,isInverted:e.isInverted,children:(0,v.jsx)(b,{showSize:e.showSize??t,showInsets:e.showInsets??t,insetSize:24,children:(0,v.jsx)(f,{isInverted:e.isInverted,children:e.children})})})})}function m(e){const{marginTopBottom:t}=e,r=(0,o().Fg)(),n=j(),s=e.isInverted?n:r,a=(0,i.useMemo)((()=>({borderRadius:4,overflow:"hidden",border:`1px solid ${s.regularDividerColor}`,backgroundColor:s.contentBackground,marginTop:t??12,marginBottom:t??12,color:s.regularTextColor})),[s,t]);return(0,v.jsx)("div",{style:a,children:e.children})}function b(e){const{showInsets:t,showSize:r,insetSize:n,children:s}=e,a=(0,i.useRef)(null),l=(0,o().yK)((e=>{const r=t?"rgba(255, 105, 180, 1)":"rgba(255, 105, 180, 0)",i=`1px dashed ${r}`,s=`${n}px`,o="all 0.1s ease-in-out",a={t:{borderBottom:i,transition:o},l:{borderRight:i,transition:o},r:{borderLeft:i,transition:o},b:{borderTop:i,transition:o,position:"relative"}};return{grid:{display:"grid",gridTemplateColumns:`${s} auto ${s}`,gridTemplateRows:`${s} auto ${s}`,...a.t,...a.l,...a.r,...a.b},...a,tl:{...a.t,...a.l},tr:{...a.t,...a.r},bl:{...a.b,...a.l},br:{...a.b,...a.r},c:{position:"relative"},insetText:{color:r,fontSize:10,paddingLeft:(n-10)/2,fontFamily:c().Gl.githubMono,lineHeight:s,maxHeight:n,transition:o,position:"absolute"}}}),[t,n]);return(0,v.jsxs)("div",{style:l.grid,children:[(0,v.jsx)("div",{style:l.tl}),(0,v.jsx)("div",{style:l.t}),(0,v.jsx)("div",{style:l.tr}),(0,v.jsx)("div",{style:l.l}),(0,v.jsx)("div",{style:l.c,ref:a,children:s}),(0,v.jsx)(x().Z,{forceVisibleState:r??t,renderTooltip:()=>{var e;return`${null===(e=a.current)||void 0===e?void 0:e.getBoundingClientRect().height}px`},placement:g().Placement.Right,render:()=>(0,v.jsx)("div",{style:l.r})}),(0,v.jsx)("div",{style:l.bl}),(0,v.jsx)(x().Z,{placement:g().Placement.Bottom,forceVisibleState:r??t,renderTooltip:()=>{var e;return`${null===(e=a.current)||void 0===e?void 0:e.getBoundingClientRect().width}px`},render:()=>(0,v.jsx)("div",{style:l.b,children:(0,v.jsx)(p().Z,{style:l.insetText,children:`${n}px inset`})})}),(0,v.jsx)("div",{style:l.br})]})}function j(){const{mode:e}=(0,o().Fg)();return(0,u().gh)({theme:"light"===e?"dark":"light"})}function f(e){let{children:t,isInverted:r}=e;const{mode:o}=j(),u=function(e){const t=(0,s().O7)();return(0,i.useMemo)((()=>{const r=new(l().Z);return r.setState({mode:e}),{...t,ThemeStore:r,ThemeModeStore:new(a().default)((()=>r.state.mode),{debugName:"UIDocComponents.ThemeModeStore"})}}),[t,e])}(o);return r?(0,v.jsx)(n().B,{value:u,children:t}):(0,d().jD)(t)}const y=(0,i.createContext)(!1);y.displayName="UIDocExpandAllCode"}}]);