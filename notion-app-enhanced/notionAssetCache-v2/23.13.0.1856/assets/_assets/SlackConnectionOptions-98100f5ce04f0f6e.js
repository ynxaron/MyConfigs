"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[16982],{945272:(e,n,t)=>{t.r(n),t.d(n,{SlackConnectionOptions:()=>T});t(670560),t(267602),t(653476),t(241792);var s=t(667294),a=()=>t(219727),i=()=>t(732811),c=()=>t(142735),o=()=>t(846550),l=()=>t(801812),r=()=>t(741633),d=()=>t(788860),u=()=>t(707513),p=()=>t(824462),v=()=>t(308186),g=()=>t(231077),k=()=>t(402269),h=()=>t(343353),m=()=>t(827973),f=()=>t(312578),_=()=>t(198829),y=()=>t(255577),w=()=>t(388284),S=()=>t(251932),x=()=>t(594546),M=()=>t(352230),j=()=>t(466970),b=()=>t(616433),C=()=>t(242909),I=()=>t(442219),A=()=>t(632518),H=()=>t(589515),O=()=>t(166104),U=()=>t(739479),Q=()=>t(876822),z=()=>t(749826),N=()=>t(993261),V=t(785893);const P=(0,d().vU)({userOverwritePopupTitle:{id:"slackConnectionOptions.overwriteEmail.title",defaultMessage:"User Authorization"}});function T(e){var n;let{parent:t,from:T}=e;const W=(0,a().O7)(),[L,E]=(0,s.useState)(),D=(0,j().E)("ingestion_mapped_child_spaces"),q=(0,b().J)(),Z=(0,o().yK)((e=>({icon:{width:16,height:16},caption:{color:e.lightTextColor,fontSize:12,textWrap:"wrap"},option:{paddingTop:4,paddingBottom:4},optionLabel:{fontSize:14,marginBottom:2},disabledOptionLabel:{color:e.lightTextColor,fontSize:14,marginBottom:2},iconWrapper:{paddingTop:4}})),[]),F=(0,c().VK)((()=>Q().default.state.currentSpaceStore),[]),Y=(0,c().VK)((()=>N().slackUniversalQnAConnectionStore.state.isPublicSync),[]),G=(0,c().VK)((()=>N().slackUniversalQnAConnectionStore.state.isPrivateSync),[]),J=(0,c().VK)((()=>N().slackUniversalQnAConnectionStore.state.isSyncCompleted),[]),R=(0,c().VK)((()=>N().slackUniversalQnAConnectionStore.state.sessionId),[]),[X,$]=s.useState(!0),[ee,ne]=s.useState(!1),[te,se]=s.useState([]),ae=(0,c().VK)((()=>{var e;return null===(e=Q().default.getState().currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),ie=(0,c().VK)((()=>N().slackUniversalQnAConnectionStore.state.isDisconnecting),[]),ce=(0,c().VK)((()=>N().slackUniversalQnAConnectionStore.state.analyticsFrom),[]),[oe,le]=(0,s.useState)(!0),re=(0,c().VK)((()=>N().slackUniversalQnAConnectionStore.state.isSlackGridAiConnectorEnabled),[]);(0,i().K)((async()=>{const e=null==F?void 0:F.id;if(!e)return;if(D){const n=await p().callApi({eventName:"getMappedParentSpace",environment:W,data:{spaceId:e}});if("success"!==n.type)return;if(n.data.isMapped)return E(n.data),void $(!1)}const n=await p().callApi({eventName:"getSlackBulkIngestionStatus",environment:W,data:{spaceId:e},headers:(0,r().Bb)({spaceId:e})});"success"===n.type&&N().slackUniversalQnAConnectionStore.setState({...N().slackUniversalQnAConnectionStore.state,...n.data});const t=await p().callApi({eventName:"getConnectedAppsForUniversalQna",environment:W,data:{spaceId:e},headers:(0,r().Bb)({spaceId:e})});"success"===t.type&&se(t.data.connectedApps);const s=await p().callApi({eventName:"canUserQuerySlack",environment:W,data:{spaceId:e}});"success"===s.type&&(le(s.data.canQuery),N().slackUniversalQnAConnectionStore.setState({...N().slackUniversalQnAConnectionStore.state,canQuery:s.data.canQuery})),$(!1)})),(0,l().r5)((async()=>{if(!ae)return;const e=await p().callApi({eventName:"allowPrivateSlackIngestion",environment:W,data:{spaceId:ae}});"success"===e.type&&ne(e.data.allow)}),[W,ae]);const de=(0,c().VK)((()=>te.includes("slack-admin")),[te]),ue=(0,c().VK)((()=>te.includes("slack")),[te]),pe=(0,c().VK)((()=>{const e=z().default.getConfigKey("ingestion","slack");return(null==e?void 0:e.userScopes.length)>0}),[]),ve=[{key:"slack-connection-section",render:e=>(0,V.jsx)(w().Z,{...e}),items:(null!=L&&L.isMapped?[{key:"inherited-space",label:(0,V.jsx)(d()._H,{id:"assistantOverflowMenu.slackIngestion.connectionDisabled",defaultMessage:"Disabled"}),caption:(0,V.jsx)(d()._H,{id:"assistantOverflowMenu.slackIngestion.disabledDescription",defaultMessage:"Cannot connect Slack to this space. Slack connection is inherited from {parentSpaceName}",values:{parentSpaceName:(0,V.jsx)("u",{children:null===(n=L.spaceDetails)||void 0===n?void 0:n.spaceName})}}),icon:(0,A().I)(Z.icon),disabled:!0,connected:!1,hidden:!1,action:()=>{}}]:[{key:"slack-ingestion-admin-auth",label:B(te,J,Y,re),caption:K(q,te,Y,ie,J),icon:(0,A().I)(Z.icon),disabled:!0,connected:de,hidden:!1,action:()=>{ae&&((0,h().navigateToSlackUniversalQnAOnboarding)({analyticsFrom:T||"chat_menu"}),(0,x().j)({environment:W,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connect_public_slack",integration_type:"slack",setup_session_id:R,from:T||ce}}}))}},{key:"slack-ingestion-user-auth",label:(0,V.jsx)(d()._H,{id:"assistantOverflowMenu.slackIngestion.userAuth",defaultMessage:"Private conversations"}),caption:G?(0,V.jsx)(d()._H,{id:"assistantOverflowMenu.slackIngestion.privateConnectionInProgress",defaultMessage:"Connecting. This can take up to 36 hours."}):ue?(0,V.jsx)(d()._H,{id:"assistantOverflowMenu.slackIngestion.connectedByYou",defaultMessage:"Connected by you"}):(0,V.jsx)(d()._H,{id:"assistantOverflowMenu.slackIngestion.userCaption",defaultMessage:"Connect to enhance your AI results"}),icon:(0,H().v)(Z.icon),disabled:!1,connected:ue,hidden:!!re||Boolean(!de||Boolean(te.includes("slack-admin")&&Y)||!ee||!pe||ie),action:async()=>{if(ae)if(ue){"success"===(await p().callApi({eventName:"disconnectSlackIngestion",environment:W,data:{spaceId:ae,disconnectForWorkspace:!1}})).type&&se((e=>e.filter((e=>"slack"!==e)))),(0,x().j)({environment:W,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_private_slack",integration_type:"slack",setup_session_id:R,from:T||ce}}})}else{const e=await p().callApi({eventName:"getSlackIngestionAuthorizeUrl",environment:W,data:{spaceId:ae,isAdminAuth:!1,isDesktopApp:W.device.isElectron}});"success"===e.type&&window.open(e.data.url,"_blank"),(0,x().j)({environment:W,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connect_private_slack",integration_type:"slack",setup_session_id:R,from:T||ce}}})}}},{key:"slack-overwrite-email",label:(0,V.jsx)(d()._H,{id:"assistantOverflowMenu.slackIngestion.overWriteEmail",defaultMessage:"Log in to Slack"}),caption:(0,V.jsx)(d()._H,{id:"assistantOverflowMenu.slackIngestion.overWriteEmailCaption",defaultMessage:"We couldn't verify your Slack e-mail. Click to authenticate."}),icon:(0,I().f)(Z.icon),disabled:!1,connected:ue,hidden:!!re||(!J||oe),action:async()=>{if(!ae)return;(0,x().j)({environment:W,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connect_slack_user_mapping",integration_type:"slack",setup_session_id:R,from:T||ce}}});const e=await p().callApi({eventName:"getSlackIngestionAuthorizeUrl",environment:W,data:{spaceId:ae,isAdminAuth:!1,isDesktopApp:W.device.isElectron,isUserMapping:!0,sessionId:R}});"success"===e.type&&(W.device.isElectron?g().openExternalUrl(e.data.url):await k().M(W,{width:800,height:600,url:e.data.url,titleMessage:P.userOverwritePopupTitle}))}},{key:"slack-overwrite-email-logout",label:(0,V.jsx)(d()._H,{id:"assistantOverflowMenu.slackIngestion.overWriteEmailLogout",defaultMessage:"Disconnect your account"}),caption:(0,V.jsx)(V.Fragment,{}),icon:(0,U().y)(Z.icon),disabled:!1,connected:!1,hidden:!!re||!te.includes("slack-user-mapping"),action:async()=>{if(!ae)return;null==t||t.close();const{accept:e}=await v().gt({message:(0,V.jsxs)(S().Ht,{gap:8,children:[(0,V.jsx)("div",{style:{fontWeight:u().Ue.semibold,fontSize:18},children:(0,V.jsx)(d()._H,{id:"universalQna.slackChannelSelection.disconnectOverwriteHeader",defaultMessage:"Are you sure?"})}),(0,V.jsx)("div",{style:{fontWeight:u().Ue.regular},children:(0,V.jsx)(d()._H,{id:"universalQna.slackChannelSelection.disconnectOverwriteNote1",defaultMessage:"Your Slack data will be permanently deleted from Notion."})}),(0,V.jsx)("div",{style:{fontWeight:u().Ue.regular},children:(0,V.jsx)(d()._H,{id:"universalQna.slackChannelSelection.disconnectOverwriteNote2",defaultMessage:"This process can take up to 3 hours, and you'll only be able to reconnect after disconnecting is complete."})})]}),acceptLabel:(0,V.jsx)(d()._H,{id:"universalQna.slackChannelSelection.disconnectButtonLabel",defaultMessage:"Disconnect Slack"})});e&&((0,x().j)({environment:W,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"slack_user_mapping_disconnect",integration_type:"slack",setup_session_id:R,from:T||ce}}}),await p().callApi({eventName:"disconnectSlackIngestion",environment:W,data:{spaceId:ae,disconnectUserMapping:!0}}))}}]).filter((e=>!e.hidden)).map((e=>{let{key:n,label:s,caption:a,icon:i,disabled:c,connected:o,action:l}=e;return{key:n,action:async()=>{await l(),null==t||t.close()},render:e=>(0,V.jsx)(m().Z,{...e,title:(0,V.jsxs)(S().gq,{gap:4,children:[(0,V.jsx)("div",{style:Z.iconWrapper,children:i}),(0,V.jsxs)("div",{style:Z.option,children:[(0,V.jsx)("div",{style:c?Z.disabledOptionLabel:Z.optionLabel,children:s}),(0,V.jsx)("div",{style:Z.caption,children:a})]})]}),right:o&&(0,C().U)({width:12,height:12}),disabled:c})}}))}];return L||!te.includes("slack-admin")||!q||Y||ie||ve.push({key:"slack-settings-section",render:e=>(0,V.jsx)(w().Z,{...e,topBorder:!0}),items:[{key:"slack-settings",action:()=>{ae&&(N().slackUniversalQnAConnectionStore.setState({...N().slackUniversalQnAConnectionStore.state,currentScreen:"settings"}),null==t||t.close())},render:e=>(0,V.jsx)(m().Z,{...e,title:(0,V.jsxs)(S().gq,{gap:4,children:[(0,V.jsx)("div",{style:Z.iconWrapper,children:(0,O().H)(Z.icon)}),(0,V.jsx)("div",{style:Z.option,children:(0,V.jsx)("div",{style:Z.optionLabel,children:(0,V.jsx)(d()._H,{id:"assistantOverflowMenu.slackIngestion.settings",defaultMessage:"Settings"})})})]})})}]}),(0,V.jsx)(_().Z,{menuType:M().o.Popup,width:230,children:X?(0,V.jsx)(S().gq,{style:{padding:8,justifyContent:"center"},children:(0,V.jsx)(f().Z,{})}):(0,V.jsx)(y().Z,{type:y().i.Vertical,sections:ve,initialFocus:void 0})})}function B(e,n,t,s){return t||n||!e.includes("slack-admin")?(0,V.jsx)(d()._H,{id:"assistantOverflowMenu.slackIngestion.adminAuth",defaultMessage:"Public conversations"}):s?(0,V.jsx)(d()._H,{id:"assistantOverflowMenu.slackIngestion.noWorkspacesSelected",defaultMessage:"No workspaces selected"}):(0,V.jsx)(d()._H,{id:"assistantOverflowMenu.slackIngestion.noChannelsSelected",defaultMessage:"No channels selected"})}function K(e,n,t,s,a){return e?s?(0,V.jsx)(d()._H,{id:"assistantOverflowMenu.slackIngestion.disconnectingPublicSlack",defaultMessage:"Disconnecting. This can take up to 3 hours."}):t?(0,V.jsx)(d()._H,{id:"assistantOverflowMenu.slackIngestion.connectingPublicSlack",defaultMessage:"Connecting. This can take up to 36 hours."}):n.includes("slack-admin")?a?(0,V.jsx)(d()._H,{id:"assistantOverflowMenu.slackIngestion.connectedByWorkspaceOwner",defaultMessage:"Connected by workspace owner"}):(0,V.jsx)(d()._H,{id:"assistantOverflowMenu.slackIngestion.selectChannels",defaultMessage:"Your workspace owner hasn't completed the setup."}):(0,V.jsx)(d()._H,{id:"assistantOverflowMenu.slackIngestion.connectSlackToEnhanceResults",defaultMessage:"Connect to enhance your AI results"}):n.includes("slack-admin")?a?(0,V.jsx)(d()._H,{id:"assistantOverflowMenu.slackIngestion.connectedByWorkspaceOwner",defaultMessage:"Connected by workspace owner"}):t?(0,V.jsx)(d()._H,{id:"assistantOverflowMenu.slackIngestion.connectingPublicSlack",defaultMessage:"Connecting. This can take up to 36 hours."}):(0,V.jsx)(d()._H,{id:"assistantOverflowMenu.slackIngestion.selectChannels",defaultMessage:"Your workspace owner hasn't completed the setup."}):(0,V.jsx)(d()._H,{id:"assistantOverflowMenu.slackIngestion.contactAdmin",defaultMessage:"Contact your workspace owner to connect"})}},242909:(e,n,t)=>{t.d(n,{U:()=>a});t(667294);var s=t(785893);const a=(0,t(827282).IU)("aiFixSpellingGrammar",{viewBox:"0 0 16 16",svg:(0,s.jsx)("path",{d:"M6.57812 14.1621C6.23633 14.1621 5.9834 14.0186 5.74414 13.7246L2.20312 9.29492C2.03223 9.08301 1.95703 8.88477 1.95703 8.67969C1.95703 8.20801 2.30566 7.86621 2.78418 7.86621C3.08496 7.86621 3.29004 7.97559 3.48828 8.24219L6.55078 12.1729L12.4912 2.73926C12.6963 2.41797 12.8945 2.30176 13.2295 2.30176C13.708 2.30176 14.0361 2.62988 14.0361 3.10156C14.0361 3.28613 13.9814 3.47754 13.8379 3.69629L7.41211 13.7178C7.21387 14.0117 6.94043 14.1621 6.57812 14.1621Z"})})},442219:(e,n,t)=>{t.d(n,{f:()=>a});t(667294);var s=t(785893);const a=(0,t(827282).IU)("key",{viewBox:"0 0 30 30",svg:(0,s.jsx)("path",{d:"M14.757 4A5.724 5.724 0 009 9.748c0 2.364 1.389 4.456 3.586 5.335V23.6c0 .255.079.483.272.676l1.53 1.477a.578.578 0 00.808-.009l2.769-2.768a.598.598 0 000-.87l-1.591-1.574 2.232-2.232a.602.602 0 00-.017-.861l-2.171-2.18c2.628-1.116 4.087-3.13 4.087-5.511A5.733 5.733 0 0014.757 4zm0 5.344a1.55 1.55 0 01-1.547-1.547c0-.861.685-1.547 1.547-1.547a1.55 1.55 0 011.547 1.547 1.55 1.55 0 01-1.547 1.547z"})})},632518:(e,n,t)=>{t.d(n,{I:()=>a});t(667294);var s=t(785893);const a=(0,t(827282).IU)("openTeamSearch",{viewBox:"0 0 16 14",svg:(0,s.jsx)("path",{d:"M9.506 13.342h4.447c.348 0 .621-.11.82-.328.2-.22.3-.516.3-.891V4.852c0-.375-.1-.67-.3-.885-.199-.219-.472-.328-.82-.328H9.922v1.136h3.709c.101 0 .178.026.228.077.051.05.076.127.076.228v6.815c0 .101-.025.177-.076.228-.05.05-.127.076-.228.076H9.506v1.143zm2.28-6.358h.925c.129 0 .193-.064.193-.193v-.896c0-.133-.064-.2-.193-.2h-.926c-.125 0-.187.067-.187.2v.896c0 .129.062.193.187.193zm0 2.168h.925c.129 0 .193-.066.193-.199v-.896c0-.133-.064-.2-.193-.2h-.926c-.125 0-.187.067-.187.2v.896c0 .133.062.2.187.2zm0 2.163h.925c.129 0 .193-.067.193-.2v-.896c0-.13-.064-.194-.193-.194h-.926c-.125 0-.187.065-.187.194v.896c0 .133.062.2.187.2zm-10.864.808c0 .375.1.672.299.89.199.22.474.329.826.329H9.44c.348 0 .621-.11.82-.328.204-.22.305-.516.305-.891V1.928c0-.38-.101-.676-.304-.89-.2-.22-.473-.329-.82-.329H2.046c-.352 0-.627.11-.826.328-.2.215-.3.512-.3.89v10.196zm1.142-.228V2.162c0-.105.026-.183.077-.234.05-.051.127-.076.228-.076h6.75c.102 0 .178.025.229.076.05.05.076.129.076.234v9.733c0 .101-.026.177-.076.228-.051.05-.127.076-.229.076H2.37c-.101 0-.178-.025-.228-.076-.051-.05-.077-.127-.077-.228zm1.588.85h.891v-1.946c0-.117.06-.176.182-.176h2.039c.12 0 .181.059.181.176v1.945h.89V10.5c0-.25-.058-.435-.175-.557-.117-.125-.295-.187-.533-.187H4.36c-.238 0-.416.062-.533.187-.117.122-.176.307-.176.557v2.244zm.17-8.362h1.12c.156 0 .234-.078.234-.235v-1.09c0-.156-.078-.234-.235-.234H3.822c-.148 0-.222.078-.222.235v1.09c0 .156.074.234.222.234zm2.719 0h1.12c.152 0 .228-.078.228-.235v-1.09c0-.156-.077-.234-.229-.234H6.541c-.152 0-.229.078-.229.235v1.09c0 .156.077.234.229.234zM3.822 6.627h1.12c.156 0 .234-.078.234-.234V5.309c0-.157-.078-.235-.235-.235H3.822c-.148 0-.222.078-.222.235v1.084c0 .156.074.234.222.234zm2.719 0h1.12c.152 0 .228-.078.228-.234V5.309c0-.157-.077-.235-.229-.235H6.541c-.152 0-.229.078-.229.235v1.084c0 .156.077.234.229.234zm-2.719 2.25h1.12c.156 0 .234-.08.234-.24V7.553c0-.157-.078-.235-.235-.235H3.822c-.148 0-.222.078-.222.235v1.084c0 .16.074.24.222.24zm2.719 0h1.12c.152 0 .228-.08.228-.24V7.553c0-.157-.077-.235-.229-.235H6.541c-.152 0-.229.078-.229.235v1.084c0 .16.077.24.229.24z"})})},589515:(e,n,t)=>{t.d(n,{v:()=>s().v});var s=()=>t(820717)}}]);