"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[64804],{264804:(e,t,o)=>{o.r(t);o(670560),o(267602),o(653476),o(30005),o(241792);var n=()=>o(100056),i=()=>o(542973),s=()=>o(955620),r=()=>o(513670),a=()=>o(636340),c=()=>o(269299),u=()=>o(876822),d=()=>o(826955),l=()=>o(539410);function g(e){const t=[],o=[e,...e.getContentStores()];for(;o.length>0;){const e=o.pop();for(const o of(null==e?void 0:e.getDiscussionStores())??[])"suggestion"===o.getType()&&t.push(o);if(null==e||!e.isNavigableBlock())for(const t of(null==e?void 0:e.getContentStores())??[])o.push(t)}return t}(0,n().exposeDebugEnvironmentValue)("getAllSuggestionsOnMainEditor",(e=>()=>{if(u().default.state.mainEditorCurrentBlockStore)return g(u().default.state.mainEditorCurrentBlockStore)})),(0,n().exposeDebugEnvironmentValue)("updateAllSuggestionContextsOnMainEditor",(e=>()=>{u().default.state.mainEditorCurrentBlockStore&&g(u().default.state.mainEditorCurrentBlockStore).forEach((t=>{t.isDefined()&&c().createAndCommit({userAction:"ConsoleHelpers.updateAllSuggestionContextsOnMainEditor",environment:e,canUndo:!0,perform:o=>{(0,l().vh)({environment:e,transaction:o,discussionStore:t})}})}))})),(0,n().exposeDebugEnvironmentValue)("updateSuggestionDiscussionSnapshot",(e=>(t,o)=>{if(!u().default.state.currentSpaceStore)return;const n=d().jQ.createChildStore(u().default.state.currentSpaceStore,{table:i().qF,id:t,spaceId:u().default.state.currentSpaceStore.id});c().createAndCommit({userAction:"ConsoleHelpers.updateSuggestionDiscussionSnapshot",environment:e,canUndo:!0,perform:t=>{(0,l().vh)({environment:e,transaction:t,discussionStore:n,addModifiedBlockIdsAfter:o})}})})),(0,n().exposeDebugEnvironmentValue)("forceReopenSuggestionDiscussion",(e=>(t,n)=>{if(!u().default.state.currentSpaceStore)return;const s=d().jQ.createChildStore(u().default.state.currentSpaceStore,{table:i().qF,id:t,spaceId:u().default.state.currentSpaceStore.id});s.isDefined()&&c().createAndCommit({userAction:"ConsoleHelpers.forceReopenSuggestionDiscussion",environment:e,canUndo:!0,perform:t=>{const i=(0,o(349220).TO)(s.getSuggestionRawContextStore());a().sW({store:s,data:{resolved:!1},transaction:t}),a().sO({store:i,value:{...i.getValue(),rejected:!1,resolvedBy:void 0},transaction:t}),(0,l().vh)({environment:e,transaction:t,discussionStore:s,addModifiedBlockIdsAfter:n})}})})),(0,n().exposeDebugEnvironmentValue)("fixBlockSuggestionDiscussionMismatch",(e=>t=>{if(!u().default.state.currentSpaceStore)return;const n=u().default.state.currentSpaceStore,a=d().G.createChildStore(n,{table:o(396136).iU,id:t}),g=a.getModel();if(!g||!a.isDefined())return;const f=r().jj([...g.getAllBlockSuggestions().map((e=>e.discussionId)),...(0,s().llS)(a.getTitleValue())]),S=g.getDiscussionPointers().map((e=>e.id));r().zu(f,...S).forEach((t=>c().createAndCommit({userAction:"ConsoleHelpers.fixBlockSuggestionDiscussionMismatch.addDiscussionToBlockStore",environment:e,canUndo:!0,perform:e=>{(0,o(126672).t)({transaction:e,blockStore:a,discussionId:t})}})));r().jj([...f,...S]).forEach((t=>{const o=d().jQ.createChildStore(n,{table:i().qF,id:t,spaceId:n.id});if(o.isDefined()){(o.getSuggestModifiedBlockIds()??[]).includes(a.id)||c().createAndCommit({userAction:"ConsoleHelpers.fixBlockSuggestionDiscussionMismatch.addDiscussionToBlockStore",environment:e,canUndo:!0,perform:t=>{(0,l().vh)({environment:e,transaction:t,discussionStore:o,addModifiedBlockIdsAfter:[a.id]})}})}}))})),(0,n().exposeDebugEnvironmentValue)("findAllBlocksInMainEditorWithDanglingSuggestions",(e=>()=>{const e=[];if(!u().default.state.mainEditorCurrentBlockStore)return;const t=u().default.state.mainEditorCurrentBlockStore;if(!t.isDefined())return;const o=u().default.state.currentSpaceStore;if(!o)return;const n=[t,...t.getContentStores()];for(;n.length>0;){const t=n.pop();if(!t||!t.isDefined())continue;if(t.isType("table")||t.isType("table_row"))continue;const a=r().jj([...t.getAllBlockSuggestions().map((e=>e.discussionId)),...(0,s().llS)(t.getTitleValue())]).map((e=>d().jQ.createChildStore(o,{table:i().qF,id:e,spaceId:o.id}))).filter((e=>e.isDefined()&&!(e.getSuggestModifiedBlockIds()??[]).includes(t.id)));if(a.length>0&&e.push({blockStore:t,discussionStores:a}),!t.isNavigableBlock())for(const e of t.getContentStores()??[])n.push(e)}return e})),(0,n().exposeDebugEnvironmentValue)("resetSuggestionTooltips",(e=>()=>{o(348141).g2({environment:e,dismissed:!1})}))}}]);