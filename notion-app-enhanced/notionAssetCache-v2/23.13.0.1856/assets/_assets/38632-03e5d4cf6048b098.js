"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[38632],{186923:(e,t,r)=>{r.d(t,{n:()=>y});var a=()=>r(219727),o=()=>r(142735),n=()=>r(801812),i=()=>r(139978),l=()=>r(255933),s=()=>r(228772),u=()=>r(658096);const d=new(r(168469).q)((e=>{let{spaceId:t,collectionViewId:r}=e;return`${t}|${r}`}),(async(e,t)=>{let{spaceId:a,collectionViewId:o}=t;if(!a||!o)return{canViewChart:!1,canViewChartError:"paywall_error"};const n=await Promise.resolve().then(r.bind(r,824462)),i=await n.callApi({eventName:"canViewChart",environment:e,data:{spaceId:a,collectionViewId:o}});return"success"!==i.type?{canViewChart:!1,canViewChartError:"paywall_error"}:{canViewChart:i.data.can_view_chart,canViewChartError:void 0}}));r(947115).exposeDebugValue("CollectionViewCanViewChartStore",d);const c=d;var p=()=>r(148882),g=()=>r(815277);function y(e){let{collectionContextStore:t}=e;const r=(0,a().O7)(),d=(0,s().r)(),y=r.currentUser.id,m=null==d?void 0:d.id,h=(0,o().VK)((()=>{var e;return(null==d?void 0:d.id)===l().N3||(null===(e=u().default.state.publicPageData)||void 0===e?void 0:e.spaceId)===l().N3}),[d]),{collectionViewStore:f,collectionViewBlockStore:v}=(0,o().VK)((()=>({collectionViewStore:t.collectionViewStore(),collectionViewBlockStore:t.collectionViewBlockStore()})),[t]),S=(0,o().VK)((()=>{const e=null==f?void 0:f.id,r=t.updateFreeChartsResultStore.state;if(e&&r&&r.has(e))return r.get(e)}),[t.updateFreeChartsResultStore,f]),b=(0,g().Rv)({name:"view_chart",spaceId:m,userId:y,amount:"unknown"}),[{value:x}]=(0,n().r5)((async()=>{const e=null==f?void 0:f.id,t=null==f?void 0:f.getSpaceId();if(!e||!t)return{canViewChart:!1,canViewChartError:"paywall_error"};if(b||h)return{canViewChart:!0,canViewChartError:void 0};if(await p().transactionQueue.awaitRecordTransaction({table:i().np,id:e}),null!=S&&S.isPending)return{canViewChart:void 0,canViewChartError:void 0};if(null==v?void 0:v.pathIsAccessibleAndAlive())return void 0!==(null==S?void 0:S.value)?{canViewChart:S.value,canViewChartError:void 0}:await c.awaitData(r,{spaceId:t,collectionViewId:e});{const a=await c.awaitData(r,{spaceId:t,collectionViewId:e});return await c.awaitData(r,{spaceId:t,collectionViewId:e},Boolean(a))}}),[f,v,r,b,S,h]),{canViewChart:_,canViewChartError:C}=x??{canViewChart:void 0,canViewChartError:void 0};return{canViewChart:_,canViewChartError:C}}},55406:(e,t,r)=>{r.d(t,{$I:()=>z,CI:()=>V,DN:()=>K,E4:()=>T,FV:()=>D,Hk:()=>k,N8:()=>A,NV:()=>G,OV:()=>_,c5:()=>F,h5:()=>w,iT:()=>R,kM:()=>H,li:()=>B,oq:()=>M,s8:()=>C,wh:()=>x,x7:()=>P,y6:()=>j});r(821057),r(670560);var a=()=>r(219727),o=()=>r(142735),n=()=>r(846550),i=()=>r(145112),l=()=>r(790300),s=()=>r(332143),u=()=>r(834458),d=()=>r(532850),c=()=>r(788860),p=()=>r(513670),g=()=>r(696459),y=()=>r(250303),m=()=>r(931756),h=()=>r(636340),f=()=>r(269299),v=()=>r(360240),S=()=>r(667247),b=()=>r(861026);const x=(0,c().vU)({chartType:{defaultMessage:"Chart type",id:"database.viewSettings.mainTab.chartType.title"},chartDevFeedbackLink:{defaultMessage:"Give dev feedback",id:"database.viewSettings.mainTab.chartDevFeedbackLink"},chartData:{defaultMessage:"Data",id:"database.viewSettings.mainTab.chartData.title"},chartStyle:{defaultMessage:"Style",id:"database.viewSettings.mainTab.chartStyle.title"},chartMoreStyle:{defaultMessage:"More style options",id:"database.viewSettings.mainTab.moreChartStyles.title"},chartXAxis:{defaultMessage:"X axis",id:"database.viewSettings.mainTab.axisChart.xAxis"},chartXAxisGroupByUnique:{defaultMessage:"Unique",id:"database.viewSettings.mainTab.axisChart.xAxis.groupBy.unique"},chartAggregateByValues:{defaultMessage:"Values",id:"database.viewSettings.mainTab.axisChart.aggregateByValues"},chartGroupBy:{defaultMessage:"Group by",id:"database.viewSettings.mainTab.axisChart.groupBy"},chartYAxisRange:{defaultMessage:"Range",id:"database.viewSettings.mainTab.axisChart.yAxisRange"},chartYAxisRangeMenu:{defaultMessage:"Set custom range",id:"database.viewSettings.mainTab.axisChart.yAxisRangeMenu"},chartYAxisRangeAuto:{defaultMessage:"Auto",id:"database.viewSettings.mainTab.axisChart.yAxisRangeAuto"},chartYAxisRangeCustom:{defaultMessage:"Custom",id:"database.viewSettings.mainTab.axisChart.yAxisRangeCustom"},chartYAxisRangeReset:{defaultMessage:"Reset",id:"database.viewSettings.mainTab.axisChart.yAxisRangeReset"},chartYAxisRangeMinPlaceholder:{defaultMessage:"Min",id:"database.viewSettings.mainTab.axisChart.yAxisRangeMinPlaceholder"},chartYAxisRangeMaxPlaceholder:{defaultMessage:"Max",id:"database.viewSettings.mainTab.axisChart.yAxisRangeMaxPlaceholder"},chartSortBy:{defaultMessage:"Sort by",id:"database.viewSettings.mainTab.axisChart.sortBy"},chartYAxis:{defaultMessage:"Y axis",id:"database.viewSettings.mainTab.axisChart.yAxis"},chartCumulative:{defaultMessage:"Cumulative",id:"database.viewSettings.mainTab.axisChart.cumulative"},chartHelp:{defaultMessage:"Learn about charts",id:"database.viewSettings.mainTab.charts.learnMoreButton"},chartDuplicate:{defaultMessage:"Duplicate chart",id:"database.viewSettings.mainTab.charts.duplicate"},chartReset:{defaultMessage:"Reset chart",id:"database.viewSettings.mainTab.charts.reset"},chartWhatToShow:{defaultMessage:"What to show",id:"database.viewSettings.mainTab.charts.whatToShow"},chartSliceDonutBy:{defaultMessage:"Slice donut by",id:"database.viewSettings.mainTab.charts.sliceDonutBy"},chartSliceDonutAggregation:{defaultMessage:"Each slice represents",id:"database.viewSettings.mainTab.charts.sliceDonutAggregation"},noneMenuItem:{defaultMessage:"None",id:"database.viewSettings.mainTab.charts.noneMenuItem"},noResultsMenuItem:{defaultMessage:"No results",id:"chartSettingsPropertySearchMenuItem.search.noResults.title"},chartIncludeSubitems:{defaultMessage:"Include sub-items",id:"database.viewSettings.mainTab.charts.includeSubitems"}}),_=(0,c().vU)({chartStyleTitle:{defaultMessage:"Style",id:"database.viewSettings.chartStyleTab.title"},chartColor:{defaultMessage:"Color",id:"database.viewSettings.chartStyleTab.chartColor"},chartHeight:{defaultMessage:"Height",id:"database.viewSettings.chartStyleTab.chartHeight"},chartSmoothLine:{defaultMessage:"Smooth line",id:"database.viewSettings.chartStyleTab.chartSmoothLine"},chartLineFillArea:{defaultMessage:"Gradient area",id:"database.viewSettings.chartStyleTab.chartLineFillArea"},chartWeightColorValue:{defaultMessage:"Color by value",id:"database.viewSettings.chartStyleTab.chartWeightColorValue"},chartGroupStyle:{defaultMessage:"Group style",id:"database.viewSettings.chartStyleTab.groupStyle"},chartGridLine:{defaultMessage:"Grid line",id:"database.viewSettings.chartStyleTab.chartGridLine"},chartAxisAvatarFormat:{defaultMessage:"Label style",id:"database.viewSettings.chartStyleTab.chartAxisAvatarFormat"},chartAxisName:{defaultMessage:"Axis name",id:"database.viewSettings.chartStyleTab.chartAxisName"},chartLegend:{defaultMessage:"Legend",id:"database.viewSettings.chartStyleTab.chartLegend"},chartCaption:{defaultMessage:"Caption",id:"database.viewSettings.chartStyleTab.chartCaption"},chartCaptionPlaceholder:{defaultMessage:"Caption",id:"database.viewSettings.chartStyleTab.chartCaptionPlaceholder"},chartHideEmptyGroups:{defaultMessage:"Omit zero values",id:"database.viewSettings.chartStyleTab.chartOmitZeroValues"},chartDataLabels:{defaultMessage:"Data labels",id:"database.viewSettings.chartStyleTab.chartDataLabels"},chartShowDonutValue:{defaultMessage:"Show value in center",id:"database.viewSettings.chartStyleTab.chartHideDonutValue"},chartValueLabelPlaceholder:{defaultMessage:"Value label",id:"database.viewSettings.chartStyleTab.chartValueLabelPlaceholder"}}),C=(0,c().vU)({none:{defaultMessage:"None",id:"database.viewSettings.chartStyleTab.gridOptions.none"},horizontal:{defaultMessage:"Horizontal",id:"database.viewSettings.chartStyleTab.gridOptions.horizontal"},vertical:{defaultMessage:"Vertical",id:"database.viewSettings.chartStyleTab.gridOptions.vertical"},both:{defaultMessage:"Both",id:"database.viewSettings.chartStyleTab.gridOptions.both"}}),w=(0,c().vU)({auto:{id:"database.viewSettings.chartStyleTab.colorTheme.auto",defaultMessage:"Auto"},colorful:{id:"database.viewSettings.chartStyleTab.colorTheme.colorful",defaultMessage:"Colorful"},gray:{id:"database.viewSettings.chartStyleTab.colorTheme.gray",defaultMessage:"Colorless"},blue:{id:"database.viewSettings.chartStyleTab.colorTheme.blue",defaultMessage:"Blue"},yellow:{id:"database.viewSettings.chartStyleTab.colorTheme.yellow",defaultMessage:"Yellow"},green:{id:"database.viewSettings.chartStyleTab.colorTheme.green",defaultMessage:"Green"},purple:{id:"database.viewSettings.chartStyleTab.colorTheme.purple",defaultMessage:"Purple"},teal:{id:"database.viewSettings.chartStyleTab.colorTheme.teal",defaultMessage:"Teal"},orange:{id:"database.viewSettings.chartStyleTab.colorTheme.orange",defaultMessage:"Orange"},pink:{id:"database.viewSettings.chartStyleTab.colorTheme.pink",defaultMessage:"Pink"},red:{id:"database.viewSettings.chartStyleTab.colorTheme.red",defaultMessage:"Red"}}),M=(0,c().vU)({avatar:{defaultMessage:"Avatar",id:"database.viewSettings.chartStyleTab.axisAvtarFormat.avatar"},avatar_name:{defaultMessage:"Avatar and name",id:"database.viewSettings.chartStyleTab.axisAvtarFormat.avatarName"},name:{defaultMessage:"Name",id:"database.viewSettings.chartStyleTab.axisAvtarFormat.name"}}),B=(0,c().vU)({none:{defaultMessage:"None",id:"database.viewSettings.chartStyleTab.axisLabelOptions.none"},x_axis:{defaultMessage:"X axis",id:"database.viewSettings.chartStyleTab.axisLabelOptions.xAxis"},y_axis:{defaultMessage:"Y axis",id:"database.viewSettings.chartStyleTab.axisLabelOptions.yAxis"},both:{defaultMessage:"Both",id:"database.viewSettings.chartStyleTab.axisLabelOptions.both"}}),T=(0,c().vU)({normal:{defaultMessage:"Stacked",id:"database.viewSettings.chartStyleTab.axisGroupStyleFormat.normal"},percent:{defaultMessage:"Percent",id:"database.viewSettings.chartStyleTab.axisGroupStyleFormat.percent"},side_by_side:{defaultMessage:"Not stacked",id:"database.viewSettings.chartStyleTab.axisGroupStyleFormat.side_by_side"}}),V=(0,c().vU)({small:{defaultMessage:"Small",id:"database.viewSettings.chartStyleTab.chartSettingsChartHeightFormat.small"},medium:{defaultMessage:"Medium",id:"database.viewSettings.chartStyleTab.chartSettingsChartHeightFormat.medium"},large:{defaultMessage:"Large",id:"database.viewSettings.chartStyleTab.chartSettingsChartHeightFormat.large"},extra_large:{defaultMessage:"Extra large",id:"database.viewSettings.chartStyleTab.chartSettingsChartHeightFormat.extra_large"}}),F=(0,c().vU)({none:{defaultMessage:"None",id:"database.viewSettings.chartStyleTab.donutDataLabels.none"},value:{defaultMessage:"Value (%)",id:"database.viewSettings.chartStyleTab.donutDataLabels.value"},name:{defaultMessage:"Name",id:"database.viewSettings.chartStyleTab.donutDataLabels.name"},name_and_value:{defaultMessage:"Name and value (%)",id:"database.viewSettings.chartStyleTab.donutDataLabels.nameAndValue"}}),G=(0,c().vU)({column:{id:"chartType.bar.vertical",defaultMessage:"Vertical bar"},bar:{id:"chartType.bar.horizontal",defaultMessage:"Horizontal bar"},line:{id:"chartType.line",defaultMessage:"Line"},donut:{id:"chartType.donut",defaultMessage:"Donut"}});function k(e){let{aggregation:t,databaseType:r,intl:a}=e;if((0,s().HK)(t)&&r){const e=(0,p().kC)((0,v().sN)(r));return a.formatMessage({id:"chartYAxis.aggregate.count",defaultMessage:"{value} count"},{value:e})}if((0,s().HK)(t))return a.formatMessage({id:"chartYAxis.aggregate.unTypedCount",defaultMessage:"Count"});if("unique"===t.aggregator)return a.formatMessage({id:"chartYAxis.aggregate.distinct",defaultMessage:"Distinct"});{const e=(0,s().OV)(t);return S().v6[e]}}function P(e){if("placeholder"!==e.type&&"groups_reducer"===e.dataConfig.type)return e.dataConfig.aggregationConfig.aggregation}function A(e,t,r,a,o,n){if("placeholder"===t.type||t.type===e)return;let s;if("donut"===e){if("donut"===t.type)return;(0,l().u)(t)?s=(0,i().GX)(t,n):(0,g().t1)(t)}else(0,l().F)(e)?(0,l().u)(t)?s=(0,i().dY)(t,e):"donut"===t.type?s=(0,i().R1)(t,e):(0,g().t1)(t):(0,g().t1)(e);f().createAndCommit({userAction:"chartSettings.setChartType",environment:r,canUndo:!0,perform:e=>{h().sW({store:a.getFormatStore().getKeyStore("chart_config"),data:s,transaction:e})}}),y().wd({environment:r,collectionContextStore:o,action:"charts_update_chart_type",charts_analytics_context:(0,b().aL)(o)})}function D(e){return{fill:e.accentColors.orange[400]}}function R(e){const t=e.type;if("formula"===t){const t=(0,u().getFormulaPropertySchemaResultType)(e);return"text"===t||"checkbox"===t||"person"===t}return"title"===t||"text"===t||"url"===t||"email"===t||"phone_number"===t||"checkbox"===t||"person"===t||"select"===t||"multi_select"===t||"status"===t||"relation"===t||"created_by"===t||"last_edited_by"===t}function j(e,t){const r=(0,o().VK)((()=>null==e?void 0:e.dataConfig),[e]);return(0,o().VK)((()=>{let e;if("groups_reducer"===(null==r?void 0:r.type)?e=r.groupBy.property:"results_reducer"===(null==r?void 0:r.type)&&(e=r.nameProperty),e&&t)return(0,d().Qm)({schema:t,property:e})}),[r,t],{useDeepEqual:!0})}function K(e,t){const r=(0,o().VK)((()=>null==e?void 0:e.dataConfig),[e]);return(0,o().VK)((()=>{let e;if("groups_reducer"===(null==r?void 0:r.type)?e=r.aggregationConfig.aggregation.property:"results_reducer"===(null==r?void 0:r.type)&&(e=r.valueProperty),e)return(0,d().Qm)({schema:t,property:e})}),[r,t],{useDeepEqual:!0})}function z(e){let{environment:t,collectionContextStore:r,chartConfig:a,sort:o}=e;const n=[];"results_reducer"===a.dataConfig.type&&("x-ascending"===o?n.push({property:a.dataConfig.nameProperty,direction:"ascending"}):"x-descending"===o&&n.push({property:a.dataConfig.nameProperty,direction:"descending"})),m().iU({environment:t,collectionContextStore:r,temporaryState:{...r.temporaryStateStore.state,sorts:{value:n}}})}function H(){const e=250,t=(0,a().Fy)();return(0,n().yK)((()=>({whatToShowRightText:{maxWidth:t.isMobile?e:125},sortByRightText:{maxWidth:t.isMobile?e:163},groupByRightText:{maxWidth:t.isMobile?e:151},donutSliceRightText:{maxWidth:t.isMobile?e:124},donutSliceValueRightText:{maxWidth:t.isMobile?e:95},avatarStyle:{maxWidth:t.isMobile?e:110},donutDataLabelsRightText:{maxWidth:t.isMobile?e:90}})),[t.isMobile])}},576447:(e,t,r)=>{r.d(t,{Z:()=>o});r(667294);var a=r(785893);const o=function(e){const{title:t,href:o,analyticsFrom:n}=e,i=(0,r(219727).O7)();return(0,a.jsx)(r(108714).Z,{href:o,onClick:()=>r(407391).Fs(i,{from:n}),external:!0,children:(0,a.jsx)(r(446955).Z,{icon:r(653457).m,title:t,isGray:!0})})}},508858:(e,t,r)=>{r.d(t,{Z:()=>p});r(267602),r(470928),r(241792);var a=r(667294),o=()=>r(142735),n=()=>r(513670),i=()=>r(448419),l=()=>r(255577),s=()=>r(967092),u=()=>r(388284),d=()=>r(352230),c=r(785893);const p=function(e){let{icon:t,iconStyle:p,title:g,selectedKey:y,onChange:m,onClick:h,popupStyle:f,menuItemOptionsStyle:v,menuStyle:S,disabled:b,collectionContextStore:x,openButtonPopup:_,hideCheck:C,children:w,disableParentClose:M,inputPlaceholder:B,...T}=e;const V=(0,r(219727).Fy)(),F="options"in T?T.options:n().xH(T.sections),G=F.find((e=>n().Xy(e.key,y))),k=(0,o().qz)(void 0,r(529048).Z),P=(0,o().Kw)(k);return(0,a.useEffect)((()=>{x&&_&&(k.setState({...k.state,open:_}),x.settingsStore.setState({...x.settingsStore.state,openButtonPopup:void 0})),G||r(799891).log({level:"error",from:"CollectionSettingsPickListMenuItem",type:"InvalidSelectedItem",error:(0,r(792409).Ui)("Selected key is invalid.")})})),(0,c.jsx)(i().ZP,{popupType:V.isMobile?s().kQ.SlideUp:s().kQ.Popup,alignmentToOrigin:i().vR.End,placementToOrigin:i().pO.Bottom,style:f,originGap:0,buttonPopupStore:k,disabled:b,onClick:h,renderOrigin:e=>(0,c.jsx)(r(446955).Z,{title:g,showChevron:!0,right:(0,c.jsx)("span",{style:r(707513).Yu,children:"input"===(null==G?void 0:G.type)?G.inputValue:null==G?void 0:G.title}),rotateChevron:P.open,disabled:b,icon:t,iconStyle:p,...(0,r(164079).Z)(e,T)}),render:e=>{let t;t=V.isMobile?{menuType:d().o.ActionSheet}:{menuType:d().o.Popup,width:250,...S};const a=(t,a)=>{if(t.hideOption)return null;let o;return o="input"===t.type?{key:a,render:a=>(0,c.jsx)(r(740046).ZP,{...a,style:{width:"100%",paddingTop:4,paddingBottom:4},value:t.inputValue??"",onChange:e=>{var r;null===(r=t.onChange)||void 0===r||r.call(t,e.target.value)},onSubmit:r=>{var a;null===(a=t.onSubmit)||void 0===a||a.call(t,t.key,e,t.inputValue),e.close()},placeholder:B,checkState:!C&&n().Xy(t.key,y)}),action:()=>{}}:{key:a,render:e=>(0,c.jsx)(r(827973).Z,{...e,disabled:!1,title:t.title,icon:t.icon,caption:t.caption,captionStyle:t.captionStyle,inline:t.captionInline,spacerStyle:t.inlineSpacerStyle,body:t.body,style:v,checkState:!C&&n().Xy(t.key,y)}),action:()=>{m(t.key,e),M||e.close()}},o},o="sections"in T?T.sections.map(((e,t)=>({key:t,render:e=>(0,c.jsx)(u().Z,{enableActionSheetTitle:!0,topBorder:t>0,...e}),items:n().oA(e.map(a))}))):[{key:0,render:e=>(0,c.jsx)(u().Z,{enableActionSheetTitle:!0,...e}),items:n().oA(F.map(a))}];return(0,c.jsxs)(r(198829).Z,{...t,children:[(0,c.jsx)(l().Z,{type:l().i.Vertical,sections:o,initialFocus:0,resetFocusOnMouseOut:!0}),w||null]})}})}},221362:(e,t,r)=>{r.d(t,{q:()=>y});var a=r(667294),o=()=>r(219727),n=()=>r(142735),i=()=>r(608352),l=()=>r(788860),s=()=>r(421654),u=()=>r(269299),d=()=>r(125659),c=()=>r(471654),p=()=>r(508858),g=r(785893);function y(e){let{groupBy:t}=e;const r=(0,o().O7)(),y=(0,d().Y$)(),{viewType:m,startWeekOn:h}=(0,n().VK)((()=>{const e=y.normalizedFormatStore.state;return{viewType:y.getViewType(),startWeekOn:(null==e?void 0:e.start_week_on)??0}}),[y]),f=(0,a.useCallback)((e=>{u().createAndCommit({userAction:"CollectionSettingsViewGroup.handleStartWeekOnChange",environment:r,canUndo:!0,perform:t=>{const r=y.collectionViewStore();r&&s().FH({stores:[r],update:{start_week_on:e},transaction:t})}})}),[r,y]);if(!(0,i().ib)(t)&&"formula"!==t.type)return null;if((0,i().ib)(t)&&"week"!==t.groupBy)return null;if("formula"===t.type){const e=t.groupBy;if(!(0,i().ib)(e))return null;if("week"!==e.groupBy)return null}return(0,g.jsx)(p().Z,{title:(0,g.jsx)(l()._H,{id:"database.viewSettings.groupTab.startWeekOn",defaultMessage:"Start week on"}),popupStyle:{minWidth:190},selectedKey:h,onChange:f,icon:"chart"===m?c().z:void 0,iconStyle:{height:14},options:[{key:0,type:"button",title:(0,g.jsx)(l()._H,{id:"database.viewSettings.groupTab.startWeekOn.sunday",defaultMessage:"Sunday"})},{key:1,type:"button",title:(0,g.jsx)(l()._H,{id:"database.viewSettings.groupTab.startWeekOn.monday",defaultMessage:"Monday"})}]})}},691594:(e,t,r)=>{r.d(t,{H5:()=>Y,HE:()=>$,Pz:()=>L,ZP:()=>te,aK:()=>X,bc:()=>Z,cE:()=>U,cR:()=>I,ci:()=>Q,y3:()=>pe});r(821057),r(670560),r(267602),r(653476),r(30005),r(241792);var a=r(667294),o=()=>r(219727),n=()=>r(142735),i=()=>r(846550),l=()=>r(263184),s=()=>r(834458),u=()=>r(608352),d=()=>r(788860),c=()=>r(513670),p=()=>r(696459),g=()=>r(250303),y=()=>r(384667),m=()=>r(139224),h=()=>r(421654),f=()=>r(269299),v=()=>r(67901),S=()=>r(157593),b=()=>r(827973),x=()=>r(119891),_=()=>r(9641),C=()=>r(1910),w=()=>r(312578),M=()=>r(18748),B=()=>r(92175),T=()=>r(388284),V=()=>r(667637),F=()=>r(899316),G=()=>r(559729),k=()=>r(527278),P=()=>r(314379),A=()=>r(109806),D=()=>r(607031),R=()=>r(642966),j=()=>r(446955),K=()=>r(508858),z=r(785893);const H=l().default.createClass(void 0,{name:"ReducerResultStore"}),E=l().default.createClass(G().XD,{name:"GroupsLimitStore"});function L(e){let{collectionContextStore:t,groupByKey:r,groupsFormatKey:a,reducerResult:o,groupsLimit:i,renderGroupsFromAggregationArgs:l,removeUncategorized:s}=e;return(0,n().VK)((()=>{var e;const n=t.normalizedFormatStore.state,d=t.normalizedSchemaStore.state,c=t.collectionViewBlockStore(),p=(0,u().b7)(n,r,a);if(!p||!c||!o)return;if("v2"===o.version){const e=[],t=[];return o.results.forEach((r=>{r.visible?e.push({property:p.property,value:r.value}):t.push({property:p.property,value:r.value})})),{currentGroups:[...e,...t],visibleGroups:e,hiddenGroups:t,total:e.length+t.length}}const g=(0,u().Qq)({schema:d,groupBy:p}),y="chart_subgroups"===a&&o.subGroupResults?o.subGroupResults:o.results,m=o?o.total:0,h=(0,G().Cz)({groupBy:p,schema:d,formatGroups:n[a]||[],schemaGroups:g,reducerResults:y,getRecordModel:c.getRecordModel,relativeVariableResult:t.relativeVariableStore.state,viewAppConfigUri:null===(e=t.collectionViewStore())||void 0===e?void 0:e.getFormat().app_config_uri,allowedCollectionStores:t.collectionStoresStore.state,renderGroupsFromAggregationArgs:l,removeUncategorized:s}),f=h.filter((e=>!(0,u().eF)(e))).slice(0,i),v=h.filter((e=>(0,u().eF)(e)));return{currentGroups:[...f,...v],visibleGroups:f,hiddenGroups:v,total:m}}),[t,r,o,a,i,l,s])}function Z(e){return e?(0,z.jsx)(F().ZP,{propertySchema:e,showIcon:!1}):(0,z.jsx)(d()._H,{defaultMessage:"None",id:"database.viewSettings.groupTab.noGroupingSetMessage"})}function U(e,t){return"collection_group_by"===e&&"board"===t?(0,z.jsx)(d()._H,{defaultMessage:"Sub-group by",id:"database.viewSettings.groupTab.subGroupProperty"}):(0,z.jsx)(d()._H,{defaultMessage:"Group by",id:"database.viewSettings.groupTab.groupProperty"})}function O(e){const{groupBy:t,schema:r}=e,a=r[t.property];if(!a||!(0,u().LG)(a))return;let o;if("formula"===a.type){const e=(0,s().getFormulaPropertySchemaResultType)(a);if("unknown"===e||"array"===e)return;o="block"===e?"relation":e}else o=a.type;return(0,u().A1)(o)||(0,u().HB)(o)||"number"===o||"status"===o?o:void 0}function I(e){const t=O(e);if(t)return(0,u().A1)(t)?(0,z.jsx)(d()._H,{defaultMessage:"Date by",id:"database.viewSettings.groupByTypeTab.dateBy"}):(0,u().HB)(t)?(0,z.jsx)(d()._H,{defaultMessage:"Text by",id:"database.viewSettings.groupByTypeTab.textBy"}):"number"===t?(0,z.jsx)(d()._H,{defaultMessage:"Number by",id:"database.viewSettings.groupByTypeTab.numberBy"}):"status"===t?(0,z.jsx)(d()._H,{defaultMessage:"Status by",id:"database.viewSettings.groupByTypeTab.statusBy"}):void 0}function N(e){return(0,u().ib)(e)?e:"formula"===e.type&&"date"===e.groupBy.type?e.groupBy:void 0}function W(e){return(0,u().aB)(e)?e:"formula"===e.type&&"text"===e.groupBy.type?e.groupBy:void 0}function Y(e){return"number"===e.type?e:"formula"===e.type&&"number"===e.groupBy.type?{...e.groupBy,property:e.property}:void 0}function q(e){const{groupBy:t}=e,r=O(e);if(r)if((0,u().A1)(r)){const e=N(t);if(e)return J(e.groupBy)}else if((0,u().HB)(r)){const e=W(t);if(e)return ee(e.groupBy)}else if("number"===r){const e=Y(t);if(e)return(0,z.jsx)(d()._H,{defaultMessage:"{start} to {end}",id:"database.groupMenu.numberGroupBy.range",values:{start:e.start,end:e.end}})}}const Q=(0,d().vU)({group:{defaultMessage:"Group",id:"database.groupMenu.statusGroupBy.group"},option:{defaultMessage:"Option",id:"database.groupMenu.statusGroupBy.option"}});const X=(0,d().vU)({relative:{defaultMessage:"Relative",id:"database.groupMenu.dateGroupBy.relative"},day:{defaultMessage:"Day",id:"database.groupMenu.dateGroupBy.day"},week:{defaultMessage:"Week",id:"database.groupMenu.dateGroupBy.week"},month:{defaultMessage:"Month",id:"database.groupMenu.dateGroupBy.month"},year:{defaultMessage:"Year",id:"database.groupMenu.dateGroupBy.year"}}),$=(0,d().vU)({relative:{defaultMessage:"Relative",id:"database.groupMenu.dateGroupBy.relative"},day:{defaultMessage:"Days",id:"database.groupMenu.dateGroupBy.days"},week:{defaultMessage:"Weeks",id:"database.groupMenu.dateGroupBy.weeks"},month:{defaultMessage:"Months",id:"database.groupMenu.dateGroupBy.months"},year:{defaultMessage:"Years",id:"database.groupMenu.dateGroupBy.years"}});function J(e){return"relative"===e?(0,z.jsx)(d()._H,{...X.relative}):"day"===e?(0,z.jsx)(d()._H,{...X.day}):"week"===e?(0,z.jsx)(d()._H,{...X.week}):"month"===e?(0,z.jsx)(d()._H,{...X.month}):"year"===e?(0,z.jsx)(d()._H,{...X.year}):void(0,p().t1)(e)}function ee(e){return"exact"===e?(0,z.jsx)(d()._H,{defaultMessage:"Exact",id:"database.groupMenu.textGroupBy.exact"}):"alphabet_prefix"===e?(0,z.jsx)(d()._H,{defaultMessage:"Alphabetical",id:"database.groupMenu.textGroupBy.alphabetical"}):void(0,p().t1)(e)}const te=function(e){const{collectionContextStore:t,groupsFormatKey:a,groupByKey:i,collectionSettingsStore:l}=e,s=(0,o().O7)(),c=(0,n().qz)(void 0,E),p=(0,n().qz)(void 0,H),y=(0,n().Kw)(p),m=(0,n().Kw)(c),v=L({collectionContextStore:t,groupByKey:i,groupsFormatKey:a,reducerResult:y,groupsLimit:m}),S=(0,n().VK)((()=>(0,u().b7)(t.normalizedFormatStore.state,i,a)),[t,i,a]),b=(0,n().Kw)(t.normalizedSchemaStore),x=(0,n().VK)((()=>function(e,t){return ae(e)&&(0,G()._1)({viewType:re(e),groupByKey:t})}(t,i)),[t,i]);return(0,z.jsxs)(r(205951).ZP,{collectionSettingsStore:l,title:(0,z.jsx)(oe,{collectionSettingsStore:l,collectionContextStore:t}),children:[(0,z.jsxs)(T().Z,{children:[(0,z.jsx)(ne,{collectionContextStore:t,collectionSettingsStore:l,groupByKey:i,groupsFormatKey:a,groupBy:S}),S&&O({groupBy:S,schema:b})&&(0,z.jsx)(le,{collectionContextStore:t,collectionSettingsStore:l,groupByKey:i,groupsFormatKey:a,groupBy:S}),S&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(r(221362).q,{groupBy:S}),(0,z.jsx)(se,{collectionContextStore:t,groupByKey:i,groupBy:S,groupsFormatKey:a}),(0,z.jsx)(ue,{groupByKey:i,collectionContextStore:t,groupsFormatKey:a,groupsDisplayState:v,groupBy:S})]}),S&&"board_columns_by"===i&&(0,z.jsx)(ie,{collectionContextStore:t})]}),S&&(0,z.jsx)(ge,{groupsFormatKey:a,collectionContextStore:t,groupByKey:i,reducerResultStore:p,groupsLimitStore:c,groupsDisplayState:v}),(0,z.jsxs)(T().Z,{topBorder:!0,children:[S&&x&&(0,z.jsx)(j().Z,{isGray:!0,icon:r(739479).y,title:(0,z.jsx)(d()._H,{defaultMessage:"Remove grouping",id:"database.viewSettings.groupTab.removeButton.title"}),onClick:()=>function(e,t,r,a){const o=t.collectionViewStore();if(!o)return;f().createAndCommit({userAction:"CollectionSettingsViewGroup.handleRemoveClick",environment:e,canUndo:!0,perform:e=>{h().FH({stores:[o],update:{[r]:void 0,[a]:void 0},transaction:e})}}),g().wd({environment:e,collectionContextStore:t,action:"click_remove_grouping"})}(s,t,i,a),isRed:!0}),(0,z.jsx)(r(576447).Z,{href:(0,r(148126).UY)("guides.databaseGroup"),title:(0,z.jsx)(d()._H,{defaultMessage:"Learn about grouping",id:"database.viewSettings.groupTab.learnMoreButton.title"}),analyticsFrom:"view_settings_group"})]})]})};function re(e){var t;const r=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!r)throw new Error("View type was not defined.");return r}function ae(e){return e.permissionScopesStore.state.canConfigureBlock}function oe(e){let{collectionSettingsStore:t,collectionContextStore:r}=e;const a=(0,n().VK)((()=>(0,R().n)(t)),[t]),o=(0,n().VK)((()=>re(r)),[r]);return a&&"group"===a.type?"collection_group_by"===a.groupByKey&&"board"===o?(0,z.jsx)(d()._H,{defaultMessage:"Sub-group",id:"database.viewSettings.groupTab.subGroup.title"}):(0,z.jsx)(d()._H,{defaultMessage:"Group",id:"database.viewSettings.groupTab.group.title"}):null}function ne(e){let{groupBy:t,collectionContextStore:r,collectionSettingsStore:a,groupByKey:i,groupsFormatKey:l}=e;const s=(0,o().O7)(),u=(0,n().Kw)(r.normalizedSchemaStore),d=t?u[t.property]:void 0,c=(0,n().VK)((()=>ae(r)),[r]),p=(0,n().VK)((()=>re(r)),[r]);return(0,z.jsx)(j().Z,{title:U(i,p),showChevron:!0,right:Z(d),onClick:()=>{g().wd({environment:s,collectionContextStore:r,action:"click_group_by_property",original_view_type:void 0,property_type:null==d?void 0:d.type}),m().H4({collectionSettingsStore:a,item:{type:"groupByProperty",groupByKey:i,groupsFormatKey:l}})},disabled:!c})}function ie(e){let{collectionContextStore:t}=e;const r=(0,o().O7)(),a=(0,n().VK)((()=>(0,G().h6)(t.normalizedFormatStore.state)),[t]),i=(0,n().VK)((()=>ae(t)),[t]);return(0,z.jsx)(V().Z,{title:(0,z.jsx)(d()._H,{defaultMessage:"Color columns",id:"database.viewSettings.groupTab.colorColumns"}),on:!a,focused:!1,onClick:()=>{m().iN({environment:r,collectionContextStore:t})},disabled:!i,textWrapperStyle:{opacity:1}})}function le(e){let{groupBy:t,collectionContextStore:r,collectionSettingsStore:a,groupByKey:i,groupsFormatKey:l}=e;const s=(0,o().O7)(),y=(0,n().Kw)(r.normalizedSchemaStore),v=(0,n().VK)((()=>ae(r)),[r]),S="formula"===t.type?{...t.groupBy,property:t.property}:t;return(0,u().ib)(S)?(0,z.jsx)(K().Z,{title:I({groupBy:S,schema:y}),popupStyle:{minWidth:190},selectedKey:S.groupBy,options:u().z8.map((e=>({key:e,type:"button",title:J(e)}))),onChange:e=>function(e,t,r,a,o){const n=(0,u().b7)(r.normalizedFormatStore.state,a,o),i=r.collectionViewStore();if(!n||!i)return;const l=N(n);if(l){if((0,u().ib)(n))f().createAndCommit({userAction:"CollectionSettingsViewGroup.handleDateGroupByTypeChange",environment:t,canUndo:!0,perform:t=>{h().FH({stores:[i],update:{[a]:{...n,groupBy:e},[o]:void 0},transaction:t}),"week"===e&&h().$P(i,t)}});else if("formula"===n.type){const r={...c().CE(l,"property"),type:"date",groupBy:e},s={...n,groupBy:r};f().createAndCommit({userAction:"CollectionSettingsViewGroup.handleDateGroupByTypeChange",environment:t,canUndo:!0,perform:t=>{h().FH({stores:[i],update:{[a]:s,[o]:void 0},transaction:t}),"week"===e&&h().$P(i,t)}})}g().wd({environment:t,collectionContextStore:r,action:"update_date_group_by"})}}(e,s,r,i,l),disabled:!v}):(0,u().aB)(S)?(0,z.jsx)(K().Z,{title:I({groupBy:S,schema:y}),popupStyle:{minWidth:190},selectedKey:S.groupBy,options:u().Kp.map((e=>({key:e,type:"button",title:ee(e)}))),onChange:e=>function(e,t,r,a,o){const n=(0,u().b7)(r.normalizedFormatStore.state,a,o),i=r.collectionViewStore();if(!n||!i)return;const l=W(n);if(l){if((0,u().aB)(n))f().createAndCommit({userAction:"CollectionSettingsViewGroup.handleTextGroupByTypeChange",environment:t,canUndo:!0,perform:t=>{h().FH({stores:[i],update:{[a]:{...n,groupBy:e},[o]:void 0},transaction:t})}});else if("formula"===n.type){const r={...c().CE(l,"property"),groupBy:e},s={...n,groupBy:r};f().createAndCommit({userAction:"CollectionSettingsViewGroup.handleTextGroupByTypeChange",environment:t,canUndo:!0,perform:e=>{h().FH({stores:[i],update:{[a]:s,[o]:void 0},transaction:e})}})}g().wd({environment:t,collectionContextStore:r,action:"update_text_group_by"})}}(e,s,r,i,l),disabled:!v}):"number"===S.type?(0,z.jsx)(j().Z,{title:I({groupBy:S,schema:y}),showChevron:!0,right:q({groupBy:S,schema:y}),onClick:()=>{m().H4({collectionSettingsStore:a,item:{type:"groupByNumber",groupByKey:i,groupsFormatKey:l}})},disabled:!v}):"status"===S.type?(0,z.jsx)(K().Z,{title:I({groupBy:S,schema:y}),popupStyle:{minWidth:190},selectedKey:S.groupBy,options:u().vu.map((e=>{return{key:e,type:"button",title:(t=e,"group"===t?(0,z.jsx)(d()._H,{...Q.group}):"option"===t?(0,z.jsx)(d()._H,{...Q.option}):void(0,p().t1)(t))};var t})),onChange:e=>function(e,t,r,a,o){const n=(0,u().b7)(r.normalizedFormatStore.state,a,o),i=r.collectionViewStore();n&&i&&"status"===(null==n?void 0:n.type)&&(f().createAndCommit({userAction:"CollectionSettingsViewGroup.handleStatusGroupByTypeChange",environment:t,canUndo:!0,perform:t=>{h().FH({stores:[i],update:{[a]:{...n,groupBy:e},[o]:void 0},transaction:t})}}),g().wd({environment:t,collectionContextStore:r,action:"update_status_group_by"}))}(e,s,r,i,l),disabled:!v}):null}function se(e){let{groupBy:t,collectionContextStore:r,groupByKey:a,groupsFormatKey:i}=e;const l=(0,o().O7)(),s=(0,n().VK)((()=>(0,u().YG)(t)),[t]),c=(0,n().VK)((()=>ae(r)),[r]);if(s.length<=1)return null;const p=(0,u().mu)(t);return(0,z.jsx)(K().Z,{title:(0,z.jsx)(d()._H,{defaultMessage:"Sort",id:"database.viewSettings.groupTab.sort"}),popupStyle:{minWidth:190},selectedKey:p.type,options:s.map((e=>({key:e,type:"button",title:k().Z.formatMessage((0,G().h8)(t,e))}))),onChange:e=>{f().createAndCommit({userAction:"CollectionSettingsViewGroup.handleSortTypeChange",environment:l,canUndo:!0,perform:t=>{y().qn({sortType:e,environment:l,collectionContextStore:r,groupByKey:a,groupsFormatKey:i,transaction:t})}})},disabled:!c})}function ue(e){let{groupBy:t,groupByKey:r,collectionContextStore:i,groupsFormatKey:l,groupsDisplayState:s}=e;const c=(0,o().O7)(),p=(0,a.useCallback)((()=>function(e,t,r,a,o){const n=(0,u().b7)(r.normalizedFormatStore.state,t,a);if(!o)return;const{currentGroups:i}=o,l=r.collectionViewStore();if(!n||!l)return;const s=!n.hideEmptyGroups;f().createAndCommit({userAction:"CollectionSettingsViewGroup.handleHideEmptyGroupsClick",environment:e,canUndo:!0,perform:e=>{if(s){const t=i.map((e=>!1===e.hidden?{...e,hidden:void 0}:e));y().A6({collectionContextStore:r,newGroups:t,groupsFormatKey:a,transaction:e})}h().FH({stores:[l],update:{[t]:{...n,hideEmptyGroups:s}},transaction:e})}}),g().wd({environment:e,collectionContextStore:r,action:"toggle_hide_empty_groups"})}(c,r,i,l,s)),[c,r,i,l,s]),m=(0,n().VK)((()=>ae(i)),[i]);return(0,z.jsx)(V().Z,{title:(0,z.jsx)(d()._H,{defaultMessage:"Hide empty groups",id:"database.viewSettings.groupTab.hideEmptyGroups"}),on:Boolean(t.hideEmptyGroups),focused:!1,onClick:p,disabled:!m,textWrapperStyle:{opacity:1}})}function de(e){const t=(0,o().O7)(),{groupFormat:r,canReorder:a,collectionContextStore:i,groupByKey:l,groupsFormatKey:s,groupsDisplayState:d,isLastGroup:c}=e,p=(0,n().Kw)(i.normalizedSchemaStore),m=(0,u().eF)(r),h=(0,n().VK)((()=>(0,u().b7)(i.normalizedFormatStore.state,l,s)),[i,l,s]),v=(0,n().VK)((()=>ae(i)),[i]);if(!h)return null;const b=c&&!m;return(0,z.jsx)(M().ZP,{disabled:!v,title:(0,z.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[a&&(0,z.jsx)(_().Z,{iconSize:12,style:{marginRight:3}}),(0,z.jsx)(S().Z,{groupBy:h,groupFormat:r,currentGroups:(null==d?void 0:d.currentGroups)??[],schema:p,disabled:!0,isHiddenGroup:!1,style:{padding:0},collectionContextStore:i})]}),right:b?null:(0,z.jsx)(C().Z,{icon:m?D().B:A().c,iconStyle:{width:16,height:16},isDarkIconColor:!m,onClick:()=>{!function(e,t,r,a,o){if(!o)return;const{currentGroups:n}=o,i=n.map((t=>(0,u().ZH)(t,e)?{...e,hidden:!(0,u().eF)(e)}:t));f().createAndCommit({userAction:"CollectionSettingsViewGroup.handleToggleGroupVisibility",environment:t,canUndo:!0,perform:e=>{y().A6({collectionContextStore:r,newGroups:i,groupsFormatKey:a,transaction:e})}}),g().wd({environment:t,collectionContextStore:r,action:"toggle_group_visibility"})}(r,t,i,s,d)},disabled:!v}),textWrapperStyle:{opacity:1}})}function ce(e){const t=(0,o().O7)(),{groups:r,canReorder:i,isHidden:l,collectionContextStore:s,groupByKey:d,groupsFormatKey:c,groupsDisplayState:p,disableHideAll:g}=e,m=(0,n().VK)((()=>ae(s)),[s]),h=g&&1===r.length,f=r.map((e=>(0,u().mD)(e)));return i?(0,z.jsx)(x().ZP,{direction:"vertical",keys:f,renderKey:(e,t)=>{const a=r[t];return(0,z.jsx)(de,{collectionContextStore:s,groupByKey:d,groupsFormatKey:c,groupsDisplayState:p,groupFormat:a,canReorder:i,isLastGroup:h})},onDrop:e=>{p&&y().Zv({newGroupIds:e,isHidden:l,environment:t,collectionContextStore:s,groupByKey:d,groupsFormatKey:c,currentGroups:p.currentGroups})},disabled:!m}):(0,z.jsx)(z.Fragment,{children:r.map((e=>(0,z.jsx)(a.Fragment,{children:(0,z.jsx)(de,{collectionContextStore:s,groupByKey:d,groupsFormatKey:c,groupsDisplayState:p,groupFormat:e,canReorder:i,isLastGroup:h})},(0,u().mD)(e))))})}function pe(e){let{collectionContextStore:t,groupsFormatKey:r,groupByKey:l,groupsLimitStore:s,groupsDisplayState:c,disableHideAll:p,disableLoadMore:m,disableReorder:h}=e;const v=(0,i().Fg)(),S=(0,o().O7)(),x=(0,a.useCallback)((()=>function(e,t,r,a,o){if(!o)return;const{currentGroups:n}=o,i=n.map((e=>({...e,hidden:!1})));a.setState(G().XD),f().createAndCommit({userAction:"CollectionSettingsViewGroup.handleShowAllClick",environment:e,canUndo:!0,perform:e=>{y().A6({collectionContextStore:t,newGroups:i,groupsFormatKey:r,transaction:e})}}),g().wd({environment:e,collectionContextStore:t,action:"click_groups_show_all"})}(S,t,r,s,c)),[S,t,r,s,c]),_=(0,a.useCallback)((()=>function(e,t,r,a,o){if(!o)return;const{currentGroups:n}=o,i=n.map((e=>({...e,hidden:!0})));a.setState(G().XD),f().createAndCommit({userAction:"CollectionSettingsViewGroup.handleHideAllClick",environment:e,canUndo:!0,perform:e=>{y().A6({collectionContextStore:t,newGroups:i,groupsFormatKey:r,transaction:e})}}),g().wd({environment:e,collectionContextStore:t,action:"click_groups_hide_all"})}(S,t,r,s,c)),[S,t,r,s,c]),C=(0,n().VK)((()=>(0,u().b7)(t.normalizedFormatStore.state,l,r)),[t,l,r]),M=(0,n().VK)((()=>ae(t)),[t]),V=(0,n().VK)((()=>!S.device.isMobile&&M&&!h),[M,S,h]),F=(0,n().Kw)(s);if(!C)return null;if(!c)return(0,z.jsx)(T().Z,{topBorder:!0,disableMobileBorders:!0,noTextOverflow:!0,children:(0,z.jsx)("div",{style:{marginTop:6,display:"flex",alignItems:"center",flexDirection:"column"},children:(0,z.jsx)(w().Z,{})})});const{total:k,hiddenGroups:A,visibleGroups:D}=c,R=Math.min(G().kW,k-A.length-D.length),j=R>0&&!Boolean(m)?(0,z.jsx)(b().Z,{disabled:!1,focused:!1,style:{color:v.mediumTextColor},icon:(0,P().o)({width:14,height:14}),title:(0,z.jsx)(d()._H,{id:"database.groupMenu.loadMoreButton.text",defaultMessage:"Show {loadMoreAmount, plural, one {{loadMoreAmount} more group} other {{loadMoreAmount} more groups}}",values:{loadMoreAmount:R}}),onClick:()=>{t.isLoadingStore.state||t.loadingDetailsStore.setState({type:"load_groups_menu"}),s.setState(F+G().kW)}}):void 0;return(0,z.jsxs)(z.Fragment,{children:[D.length>0&&(0,z.jsxs)(T().Z,{topBorder:!0,noTextOverflow:!0,isTitleUppercase:!1,title:(0,z.jsx)("span",{style:{alignSelf:"center"},children:(0,z.jsx)(d()._H,{id:"database.groupMenu.visibleGroups",defaultMessage:"Visible groups"})}),right:p?null:(0,z.jsx)(B().Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:_,disabled:!M,children:(0,z.jsx)(d()._H,{id:"database.groupMenu.hideAllGroups",defaultMessage:"Hide all"})}),children:[(0,z.jsx)(ce,{collectionContextStore:t,groupByKey:l,groupsFormatKey:r,groupsDisplayState:c,groups:D,canReorder:V,isHidden:!1,disableHideAll:p}),j]}),A.length>0&&(0,z.jsx)(T().Z,{topBorder:!0,noTextOverflow:!0,isTitleUppercase:!1,title:(0,z.jsx)(d()._H,{id:"database.groupMenu.hiddenGroups",defaultMessage:"Hidden groups"}),right:p?null:(0,z.jsx)(B().Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:x,disabled:!M,children:(0,z.jsx)(d()._H,{id:"database.groupMenu.showAllGroups",defaultMessage:"Show all"})}),children:(0,z.jsx)(ce,{collectionContextStore:t,groupByKey:l,groupsFormatKey:r,groupsDisplayState:c,groups:A,canReorder:V,isHidden:!0,disableHideAll:p})})]})}function ge(e){let{groupsFormatKey:t,collectionContextStore:r,groupByKey:a,reducerResultStore:o,groupsLimitStore:i,groupsDisplayState:l}=e;const s=(0,n().VK)((()=>{const e=r.normalizedFormatStore.state,o=r.normalizedSchemaStore.state,n=(0,u().b7)(r.normalizedFormatStore.state,a,t);if(n)return(0,G().ej)({groupBy:n,schema:o,format:e,groupsFormatKey:t,limit:i.state})}),[r,t,a,i]);return s?(0,z.jsx)(v().Z,{id:`${u().rT}_${t}`,reducer:s,collectionContextStore:r,resultStore:o,render:()=>(0,z.jsx)(pe,{collectionContextStore:r,groupsFormatKey:t,groupByKey:a,groupsLimitStore:i,groupsDisplayState:l})}):(0,z.jsx)(pe,{collectionContextStore:r,groupsFormatKey:t,groupByKey:a,groupsLimitStore:i,groupsDisplayState:l})}},265195:(e,t,r)=>{r.d(t,{EE:()=>u,GL:()=>c,Ns:()=>v,TR:()=>g,Y9:()=>y,iM:()=>d,jl:()=>m,jr:()=>f,zn:()=>p});var a=()=>r(145112),o=()=>r(226413),n=()=>r(661727),i=()=>r(568017),l=()=>r(696459),s=()=>r(559729);function u(e){return void 0!==e&&"auto"!==e&&"colorful"!==e}function d(e,t){if("auto"!==e){if("colorful"===e)return i().ZE.colorful.slice(0,6);if(c(e)){const r="gray"===e?"dark"===t.mode?"white":"black":e;return i().ZE[r]}(0,l().t1)(e)}}function c(e){return a().Fh.includes(e)}function p(e,t,r){const a=function(e,t,r){if("auto"===e)return;let a;if(a="gray"===e?"dark"===r.mode?"white":"black":e,t&&c(e)){const e=i().ZE[a];return[e[0],e[3]]}return i().ZE[a]}(e,t,r);if(a)return c(e)&&t?{colorAxis:{minColor:a[1],maxColor:a[0],showInLegend:!1},colors:a}:{colorAxis:void 0,colors:a}}function g(e){var t,r;let{collectionContextStore:a,groupValue:n,index:l,groupBy:u,theme:d,environment:c}=e;const g=a.normalizedSchemaStore.state,y=a.normalizedFormatStore.state;if("placeholder"===(null===(t=y.chart_config)||void 0===t?void 0:t.type)||void 0===n.value)return"light"===d.mode?i().ZE.translucentGray[0]:i().ZE.translucentGray[1];const m=g[u.property],h=m&&((0,o().cu)(m)||(0,o().gB)(m)),f=(null===(r=y.chart_config)||void 0===r||null===(r=r.chartFormat)||void 0===r?void 0:r.colorTheme)||"auto";if("auto"===f&&h){const e=(0,s().II)({environment:c,groupFormat:{property:u.property,value:n},schema:g,format:y,theme:d,ignoreDisableColorColumns:!0});if(e)return e.chartColor}const v=p("auto"===f?"colorful":f,!1,d),S=(null==v?void 0:v.colors)||i().ZE.colorful;return S[l%S.length]}function y(e,t){return t?{linearGradient:{x1:0,x2:0,y1:0,y2:1},stops:[[0,"rgba(0, 0, 0, 0)"],[1,"rgba(0, 0, 0, 0)"]]}:{linearGradient:{x1:0,x2:0,y1:0,y2:1},stops:[[0,(0,n().Fq)(e,.1)],[1,(0,n().Fq)(e,0)]]}}const m=["gradient","blue","red","yellow","grey","none"],h=(0,r(788860).vU)({gradient:{defaultMessage:"Gradient",id:"chart.export.background.gradient"},blue:{defaultMessage:"Blue",id:"chart.export.background.blue"},red:{defaultMessage:"Red",id:"chart.export.background.red"},yellow:{defaultMessage:"Yellow",id:"chart.export.background.yellow"},grey:{defaultMessage:"Grey",id:"chart.export.background.grey"},none:{defaultMessage:"None",id:"chart.export.background.none"}});function f(e){return h[e]}function v(e,t,r){const a="light"===e.mode?r?100:50:r?600:500;switch(t){case"blue":return e.accentColors.blue[a];case"red":return e.accentColors.red[a];case"yellow":return e.accentColors.yellow[a];case"grey":return e.accentColors.gray[a];case"none":const o=r?e.buttonHoveredBackground:e.popoverBackground;return`linear-gradient(to top right, ${o} calc(50% - 1px), ${e.regularDividerColor}, ${o} calc(50% + 1px) )`;case"gradient":return`${r?`linear-gradient(${e.buttonHoveredBackground}, ${e.buttonHoveredBackground}), `:""}${"dark"===e.mode?"linear-gradient(123deg, #3C3F41 40.15%, #4A2F27 89.33%)":"linear-gradient(123deg, #FEF5E9 40.15%, #FEE9E9 89.33%)"}`;default:(0,l().t1)(t)}}},615719:(e,t,r)=>{r.d(t,{C6:()=>j,FZ:()=>P,Iq:()=>z,P3:()=>N,VB:()=>K,bc:()=>U,d:()=>O,yd:()=>A});r(670560),r(267602),r(30005);var a=()=>r(730120),o=()=>r(816512),n=()=>r(926724),i=()=>r(145112),l=()=>r(964120),s=()=>r(790300),u=()=>r(834458),d=()=>r(608352),c=()=>r(226413),p=()=>r(532850),g=()=>r(295617),y=()=>r(22183),m=()=>r(605974),h=()=>r(375255),f=()=>r(396136),v=()=>r(568017),S=()=>r(513670),b=()=>r(696459),x=()=>r(360240),_=()=>r(749826),C=()=>r(128076),w=()=>r(559729),M=()=>r(527278),B=()=>r(549813),T=()=>r(129338),V=()=>r(615676),F=()=>r(731738),G=()=>r(265195),k=()=>r(422118);function P(e){var t,r,a;let{collectionContextStore:o,groupedDataConfig:n,xAxisType:l,groupResults:s,aggregationResults:u,subGroupResults:c,timezone:g,theme:y,environment:m,intl:h,groupTotals:f}=e;const b=n.groupBy,x=n.aggregationConfig,_=null===(t=o.collectionViewStore())||void 0===t?void 0:t.getChartConfig();if(!_||"placeholder"===_.type)return;const C=null==_?void 0:_.chartFormat,w=null==C?void 0:C.weightColorValue,M=null==C?void 0:C.mainSort,B=null==C?void 0:C.smoothLine;if(!u||!b||!x)return;if(!(0,d().sM)(b.type))return;const T=o.normalizedSchemaStore.state,V=(0,p().Qm)({schema:T,property:b.property});if(!V)return;const F=Boolean(null===(r=_.chartFormat)||void 0===r?void 0:r.axisHideEmptyGroups),k="datetime"===l||"linear"===l;"formula"!==b.type&&"descending"===b.sort.type&&k&&(s=s.reverse());const P=!k,A=k;let j=0,K=0,z=[];const L=null===(a=x.stackOptions)||void 0===a?void 0:a.groupBy,Z=x.seriesFormat.displayType;if(c&&L){if(!(0,p().Qm)({schema:T,property:L.property}))return;const e=null==C?void 0:C.axisCumulative;let t=0;c.forEach((r=>{const a=r.value,n=H({collectionContextStore:o,groupBy:L,groupValue:a,removeUncategorizedDateOrNumber:!1,environment:m,intl:h,timezone:g});if(!n)return;const l=(0,d().Hd)(a),c=u[l],p=c?E(c):void 0;if(F&&!p)return;const v=D(n.stringValue,Z,B),{maxGroupValue:S,minGroupValue:x,dataPoints:M}=R({collectionContextStore:o,subGroupKey:l,groupBy:b,hideEmptyGroups:F,groupResults:s,aggregationResults:u,groupTotals:f,timezone:g,environment:m,shouldSetDataPointColor:"line"!==Z&&!w,theme:y,intl:h,useIndexAsX:P,removeUncategorizedDateOrNumber:A,seriesDisplayType:Z});var T;(v.color=(0,G().TR)({collectionContextStore:o,groupValue:a,index:t,groupBy:L,theme:y,environment:m}),"line"===Z)&&(v.fillColor=(0,G().Y9)(v.color,Boolean(null===(T=_.chartFormat)||void 0===T?void 0:T.hideLineFillArea)));if(e&&O(_)){const{maxDataPoint:e,minDataPoint:t,cumulatedDataPoints:r}=I(M);v.data=r,"line"===Z&&C.axisGroupStyle===i().UJ.side_by_side?(e>j&&(j=e),t<K&&(K=t)):(j+=e,K+=t)}else v.data=M,S>j&&(j=S),x<K&&(K=x);z.push(v),t+=1})),"y-ascending"!==M&&"y-descending"!==M||(z=function(e,t){const r=(0,S().Xh)(e);return r.forEach((e=>{const r=e.data.sort(((e,r)=>"y-ascending"===t?(e.total?e.total:0)-(r.total?r.total:0):(r.total?r.total:0)-(e.total?e.total:0)));r.forEach(((e,t)=>{e.x=t})),e.data=r})),r}(z,M))}else{const e=V.name,{maxGroupValue:t,minGroupValue:r,dataPoints:a}=R({collectionContextStore:o,subGroupKey:void 0,groupBy:b,hideEmptyGroups:F,groupResults:s,aggregationResults:u,groupTotals:f,timezone:g,environment:m,shouldSetDataPointColor:"line"!==Z&&!(0,G().EE)(null==C?void 0:C.colorTheme)&&!w,theme:y,intl:h,useIndexAsX:P,removeUncategorizedDateOrNumber:A,seriesDisplayType:Z}),n=D(e.toString(),Z,B);if("line"===Z){var U,N,W;const e=(null===(U=(0,G().zn)((null===(N=_.chartFormat)||void 0===N?void 0:N.colorTheme)||"colorful",!1,y))||void 0===U||null===(U=U.colors)||void 0===U?void 0:U[0])||v().ZE.colorful[0];n.fillColor=(0,G().Y9)(e,Boolean(null===(W=_.chartFormat)||void 0===W?void 0:W.hideLineFillArea))}if((null==C?void 0:C.axisCumulative)&&O(_)){const{maxDataPoint:e,minDataPoint:t,cumulatedDataPoints:r}=I(a);n.data=r,j+=e,K+=t}else n.data=a,t>j&&(j=t),r<K&&(K=r);z.push(n)}return{seriesData:z,maxValue:j,minValue:K}}function A(e){var t;const r=[],{groupedDataConfig:a,collectionContextStore:o,groupResults:n,aggregationResults:i,timezone:l,environment:s,theme:u,intl:d,groupTotals:c}=e,g=null===(t=o.collectionViewStore())||void 0===t?void 0:t.getChartConfig();if(!g||"placeholder"===g.type)return;const y=null==g?void 0:g.chartFormat,m=null==y?void 0:y.weightColorValue,h=a.groupBy,f=o.normalizedSchemaStore.state,v=(0,p().Qm)({schema:f,property:h.property});if(!v)return;const{dataPoints:S}=R({collectionContextStore:o,subGroupKey:void 0,groupBy:h,groupResults:n,aggregationResults:i,groupTotals:c,timezone:l,environment:s,shouldSetDataPointColor:!m,theme:u,intl:d,hideEmptyGroups:!0,useIndexAsX:!0,removeUncategorizedDateOrNumber:!1});return r.push({name:v.name,data:S}),r}function D(e,t,r){let a;return a="line"===t?r?"areaspline":"area":t,{name:e,type:a,data:[]}}function R(e){var t;let{collectionContextStore:r,subGroupKey:a,groupBy:o,hideEmptyGroups:n,groupResults:l,aggregationResults:s,groupTotals:u,timezone:c,environment:p,shouldSetDataPointColor:g,theme:y,intl:m,useIndexAsX:h,removeUncategorizedDateOrNumber:f,seriesDisplayType:v}=e,S=0,b=0;const x=[],_=null===(t=r.collectionViewStore())||void 0===t?void 0:t.getChartConfig();if(!_||"placeholder"===_.type)return{maxGroupValue:S,minGroupValue:b,dataPoints:x};let C=0;return l.forEach(((e,t)=>{var l,w,M,B,T;const V=e.value,F=(0,d().Hd)(V),k=a?(0,d().Lr)([a,F]):F,P=s[k],A=s[F];if(!P||!A)return;const D=H({collectionContextStore:r,groupBy:o,removeUncategorizedDateOrNumber:f,groupValue:V,environment:p,intl:m,timezone:c}),R=E(P),j=(null===(l=u.get(F))||void 0===l?void 0:l.max)||0,K=(null===(w=u.get(F))||void 0===w?void 0:w.min)||0,z=(null===(M=u.get(F))||void 0===M?void 0:M.total)||0,L=g&&!a?(0,G().TR)({collectionContextStore:r,groupValue:V,index:C,groupBy:o,theme:y,environment:p}):void 0;if(void 0===D||void 0===R||void 0===j||void 0===K)return;if(n&&0===z)return;if(n&&"side_by_side"===(null===(B=_.chartFormat)||void 0===B?void 0:B.axisGroupStyle)&&0===R)return;const Z=null===(T=_.chartFormat)||void 0===T?void 0:T.axisGroupStyle;let U;Z===i().UJ.side_by_side?(R>S&&(S=R),R<b&&(b=R)):"line"===v&&Z===i().UJ.normal?(z>S&&(S=z),z<b&&(b=z)):(j>S&&(S=j),K<b&&(b=K)),h?(U={x:a?t:C,y:R,name:D.stringValue,total:z},D.actorPointer&&(U.actorPointer=D.actorPointer),D.relationId&&(U.relationId=D.relationId),D.relativeSprintVariable&&(U.relativeSprintVariable=D.relativeSprintVariable),void 0!==D.numberValue&&(U.numberValue=D.numberValue),D.isUncategorized&&(U.isUncategorized=!0)):U={x:D.numberValue,y:R,name:D.stringValue,total:z},D.dateValue&&(U.dateValue=D.dateValue),L&&(U.color=L),x.push(U),C+=1})),{maxGroupValue:S,minGroupValue:b,dataPoints:x}}function j(e){var t,r;let{collectionContextStore:a,resultsDataConfig:o,resultsChartReducerResults:n,chartType:i,timezone:s,theme:d,intl:c}=e;const g=null===(t=a.collectionViewStore())||void 0===t?void 0:t.getChartConfig();if(!g||"placeholder"===g.type)return;const m=null==g?void 0:g.chartFormat,f=null==m?void 0:m.weightColorValue,S=null==m?void 0:m.smoothLine,b=a.normalizedSchemaStore.state,x=(0,p().Qm)({schema:b,property:o.valueProperty});if(!x)return;const w=Boolean(null===(r=g.chartFormat)||void 0===r?void 0:r.axisHideEmptyGroups),M=[],B=x.name,T="axis"===i?o.valueSeriesFormat.displayType:"column",{maxDataPoint:F,minDataPoint:P,dataPoints:A}=function(e){var t,r,a;let{collectionContextStore:o,hideEmptyGroups:n,resultsDataConfig:i,resultsChartReducerResults:s,shouldSetDataPointColor:d,theme:c,useIndexAsX:g,timezone:m,intl:f}=e,v=0,S=0;const b=[],x=o.normalizedFormatStore.state.chart_config,w=o.collectionStore();if(!w||!x||"placeholder"===x.type||!s)return{maxDataPoint:v,minDataPoint:S,dataPoints:b};let M=0;const B=(null===(t=x.chartFormat)||void 0===t?void 0:t.colorTheme)||"auto",T=(0,G().zn)("auto"===B?"colorful":B,!1,c),F=o.normalizedSchemaStore.state,P=(0,p().Qm)({schema:F,property:i.nameProperty}),A=(0,p().Qm)({schema:F,property:i.valueProperty}),D=new Map,R=new Map;if(s.blockIds.forEach((e=>{const t=C().G.createChildStore(w,{table:"block",id:e,spaceId:w.getSpaceId()}),r=t.getModel(),a=(()=>{if("formula"===(null==P?void 0:P.type)){if("text"!==(0,u().getFormulaPropertySchemaResultType)(P)||!r)return;return(0,y().primitiveFormulaValueFromPropertySchema)({schema:F,property:i.nameProperty,blockModel:r,getRecordModel:t.getRecordModel,intl:f,userTimeZone:m,depth:0,resultCache:D,regExpCache:R,experimentService:_().default,collectionFeatureGates:(0,V().W)()})??""}const e=t.getPropertyValue(i.nameProperty),a=(0,h().Xh)({textValue:e,getRecordModel:t.getRecordModel,userTimeZone:m,intl:f});return"title"===(null==P?void 0:P.type)?a||f.formatMessage(k().s1.titlePlaceholder):a})(),o=(()=>{if("formula"===(null==A?void 0:A.type)){if("number"!==(0,u().getFormulaPropertySchemaResultType)(A)||!r)return;const e=(0,y().primitiveFormulaValueFromPropertySchema)({schema:F,property:i.valueProperty,blockModel:r,getRecordModel:t.getRecordModel,intl:f,userTimeZone:m,depth:0,resultCache:D,regExpCache:R,experimentService:_().default,collectionFeatureGates:(0,V().W)()});if("number"!=typeof e)return;return e}const e=t.getPropertyValue(i.valueProperty);return(0,p().VY)(e)})();if(n&&void 0===o)return;let l;o&&o>v&&(v=o),o&&o<S&&(S=o);const s=null==T?void 0:T.colors;if(s&&d&&(l=s[M%s.length]),g){const e={x:M,y:o,name:a,color:l};"title"===(null==P?void 0:P.type)&&r&&(e.pagePointer=r.pointer),b.push(e)}M+=1})),(null==x||null===(r=x.chartFormat)||void 0===r?void 0:r.axisCumulative)&&O(x)){const{maxDataPoint:e,minDataPoint:t,cumulatedDataPoints:r}=I(b);return{maxDataPoint:e,minDataPoint:t,dataPoints:r}}const j=null===(a=x.chartFormat)||void 0===a?void 0:a.mainSort;if(j===l().MN.yAscending||j===l().MN.yDescending){const e=b.sort(((e,t)=>{const r=void 0===e.y?-1/0:e.y,a=void 0===t.y?-1/0:t.y;return j===l().MN.yDescending?a-r:r-a}));return e.forEach(((e,t)=>{e.x=t})),{maxDataPoint:v,minDataPoint:S,dataPoints:e}}return{maxDataPoint:v,minDataPoint:S,dataPoints:b}}({collectionContextStore:a,hideEmptyGroups:w,resultsDataConfig:o,resultsChartReducerResults:n,shouldSetDataPointColor:"line"!==T&&!f,theme:d,useIndexAsX:!0,timezone:s,intl:c}),R=D(B.toString(),T,S);if("line"===T){var j,K,z;const e=(null===(j=(0,G().zn)((null===(K=g.chartFormat)||void 0===K?void 0:K.colorTheme)||"colorful",!1,d))||void 0===j||null===(j=j.colors)||void 0===j?void 0:j[0])||v().ZE.colorful[0];R.fillColor=(0,G().Y9)(e,Boolean(null===(z=g.chartFormat)||void 0===z?void 0:z.hideLineFillArea))}return R.data=A,M.push(R),{maxValue:F,minValue:P,seriesData:M}}function K(e){let{groupedDataConfig:t,hideEmptyGroups:r,mainSort:a}=e;if(r||"y-ascending"===a||"y-descending"===a)return"category";const{type:o}=t.groupBy;return(0,d().ib)(t.groupBy)&&"relative"!==t.groupBy.groupBy?"datetime":"number"===o?"linear":"category"}function z(e){let{mainSort:t,xAxisType:r}=e;return"datetime"===r&&"x-descending"===t||"linear"===r&&"x-descending"===t}function H(e){let{collectionContextStore:t,groupBy:r,groupValue:n,removeUncategorizedDateOrNumber:i,environment:l,intl:u,timezone:y}=e;const h=t.collectionViewBlockStore();if(!h)return;const v=t.normalizedSchemaStore.state,S=(0,p().Qm)({schema:v,property:r.property});if(!S)return;const x=S.name;if(!n.value){if(i&&("number"===n.type&&"number"===(null==S?void 0:S.type)||(0,d().Mc)(n)))return;if((0,d().tL)(n)&&(0,c().p_)(S)){const e=h.getAssociatedCollectionStore();return{stringValue:Z(x,!!e&&(0,F().OG)({collectionStore:e,property:r.property,propertySchema:S,parentStore:e})),isUncategorized:!0}}return{stringValue:Z(x),isUncategorized:!0}}if((0,d().Mc)(n)){const e=(0,w().fZ)({intl:u,value:n.value}),t="formula"===r.type?r.groupBy:r;if((0,d().ib)(t)&&"relative"===t.groupBy)return{stringValue:e,dateValue:n.value};if("day"===n.value.type||"month"===n.value.type||"week"===n.value.type||"year"===n.value.type){const e=a().ou.fromISO(n.value.range.start_date,{zone:y}).startOf("day").toMillis();return{stringValue:e.toString(),numberValue:e,dateValue:n.value}}return{stringValue:e,dateValue:n.value}}if((0,d().tL)(n)&&(0,c().p_)(S)){const e=n.value;if((0,d().RA)(e)){const t=e.id,r=C().G.createChildStore(h,{id:t,table:f().iU});return{stringValue:(0,B().vU)({environment:l,intl:u,store:r}),relationId:t}}if((0,d().t2)(e)){var _;const t=(0,T().ke)(S,h);if(!t)return;const r=null===(_=m().qB[t])||void 0===_||null===(_=_[e.value.variable])||void 0===_?void 0:_.messageDescriptor;return r?{stringValue:u.formatMessage(r),relativeSprintVariable:e.value.variable}:void 0}}else if((0,d().Rc)(n)){const e=n.value,t=null==e?void 0:e.type;if("by_group"===t&&null!=e&&e.group)return(0,g().lH)(e.group)?{stringValue:u.formatMessage((0,g().GX)(e.group))}:{stringValue:e.group};if("by_option"===t&&null!=e&&e.option)return{stringValue:null==e?void 0:e.option}}else{if("select"===n.type||"multi_select"===n.type)return{stringValue:n.value};if("number"===n.type){var M;const e=n.value,r=e.type;let a;const o=null===(M=t.collectionViewStore())||void 0===M?void 0:M.getChartConfig();var V;if(o&&(0,s().u)(o))a=null===(V=o.chartFormat)||void 0===V?void 0:V.numberPrecisionOverride;const i=(0,k().py)({propertySchema:S,aggregation:void 0,intl:u,numberPrecisionOverride:a});if(!i)return;if("range"===r)return{stringValue:i(e.start),numberValue:e.start};if("unique"===r)return{stringValue:i(e.value),numberValue:e.value};if("out_of_range"===r)return;(0,b().t1)(r)}else{if((0,d().q6)(n)){const e=n.value,t=(0,o().Hl)({pointer:e,getRecordModel:h.getRecordModel});if(!t)return;return{stringValue:(0,o().$4)(u,t),actorPointer:e}}if("checkbox"===n.type)return{stringValue:S.name};if("title"===n.type){if("exact"===n.value.type)return{stringValue:n.value.value||u.formatMessage(k().s1.titlePlaceholder)}}else if((0,d().R7)(n)){if("exact"===n.value.type)return{stringValue:n.value.value}}else if("formula"===n.type&&"formula"===r.type){return H({collectionContextStore:t,groupBy:r,groupValue:n.value,removeUncategorizedDateOrNumber:i,environment:l,intl:u,timezone:y})}}}}function E(e){if(!e)return;const t=e.aggregationResult;return"number"===t.type?t.value:void 0}const L=(0,r(788860).vU)({chartUncategorizedGroup:{defaultMessage:"No {name}",id:"database.chartView.uncategorizedGroupLabel"}});function Z(e,t){return t?M().Z.formatMessage(F().uL.sprintUncategorizedGroup,{name:e??M().Z.formatMessage(n().Ww.sprint_plural)}):M().Z.formatMessage(L.chartUncategorizedGroup,{name:e??(0,x().Q_)(void 0)})}function U(e){if("column"!==e.type&&"bar"!==e.type)return!1;{const r=e.dataConfig.type;var t;if("groups_reducer"===r)return void 0===(null===(t=e.dataConfig.aggregationConfig.stackOptions)||void 0===t?void 0:t.groupBy);if("results_reducer"===r)return!0;(0,b().t1)(r)}}function O(e){var t;const r=(0,s().u)(e),a="groups_reducer"===e.dataConfig.type?e.dataConfig.aggregationConfig.aggregation.aggregator:"count",o="count"===a||"sum"===a,n=null===(t=e.chartFormat)||void 0===t?void 0:t.mainSort;return r&&o&&"x-ascending"===n}function I(e){let t=0,r=0;const a=[];let o=0;for(const n of e){const e=n.y||0,i={...n,y:e+o};a.push(i),o+=e,o>r&&(r=o),o<t&&(t=o)}return{maxDataPoint:r,minDataPoint:t,cumulatedDataPoints:a}}function N(e){let{groupedChartReducerResults:t,chartConfig:r,sortType:a}=e;const o=null==t?void 0:t.aggregationResults;if(!o)return;const n=r.chartFormat,i=null==n?void 0:n.mainSort;let l;"main"!==a||"y-ascending"!==i&&"y-descending"!==i||(l="y-ascending"===i?"asc":"desc");const s=null==n?void 0:n.axisHideEmptyGroups,u=function(e){const{groupResults:t,aggregationResults:r,subGroupResults:a}=e,o=new Map;return t.forEach((e=>{const t=e.value,n=(0,d().Hd)(t);let i=0,l=0;if(a)a.forEach((e=>{const t=e.value,a=(0,d().Hd)(t),o=(0,d().Lr)([a,n]),s=E(r[o])||0;s>0&&(i+=s),s<0&&(l+=s)}));else{const e=E(r[n])||0;e>i&&(i=e),e<l&&(l=e)}o.set(n,{min:l,max:i,total:l+i})})),o}({aggregationResults:o,groupResults:t.results,subGroupResults:t.subGroupResults});return{aggregationResults:o,yAxisSortOrder:l,hideZeroAggregations:s||"donut"===r.type,groupTotals:u}}},593695:(e,t,r)=>{r.d(t,{M:()=>o,e:()=>n});var a=()=>r(527278);const o=(0,r(788860).vU)({noData:{defaultMessage:"No data",id:"chartError.noData"},badYAxisRange:{defaultMessage:"No data due to axis range",id:"chartError.badYAxisRange"},unconfiguredProperty:{id:"chartError.unconfiguredProperty",defaultMessage:"Property is not configured. Please make another selection."},unsupportedProperty:{id:"chartError.unsupportedProperty",defaultMessage:"This property type is not supported. Please select another property"},unsupportedFormula:{id:"chartError.unsupportedFormula",defaultMessage:"This formula is not supported. Please select another property or adjust your formula."},deletedProperty:{id:"chartError.deletedProperty",defaultMessage:"This property has been deleted. Please select another property."},invalidAggregation:{id:"chartError.invalidAggregation",defaultMessage:"Previously selected property is no longer valid with the current aggregation. Please make another selection."},invalidPropertyValueChart:{id:"chartError.invalidPropertyValueChart",defaultMessage:"Selected property is no longer valid with the previous configured chart. Please make another selection."},noValues:{id:"chartError.noValues",defaultMessage:"This property has no values. Please add some values or select another property."}});function n(e){switch(e){case"groupBy_property_not_configured":case"aggregation_property_not_configured":case"name_property_not_configured":case"property_value_property_not_configured":return a().Z.formatMessage(o.unconfiguredProperty);case"groupBy_property_not_groupable":case"stackBy_property_not_groupable":return a().Z.formatMessage(o.unsupportedProperty);case"groupBy_formula_not_groupable":case"stackBy_formula_not_groupable":return a().Z.formatMessage(o.unsupportedFormula);case"groupBy_property_deleted":case"stackBy_property_deleted":case"aggregation_deleted":case"name_property_deleted":case"property_value_property_deleted":return a().Z.formatMessage(o.deletedProperty);case"aggregation_invalid":return a().Z.formatMessage(o.invalidAggregation);case"stackBy_property_no_values":return a().Z.formatMessage(o.noValues);case"name_property_invalid":case"property_value_property_invalid":return a().Z.formatMessage(o.invalidPropertyValueChart);default:return}}},75468:(e,t,r)=>{r.d(t,{CN:()=>g,C_:()=>u,FZ:()=>n,LY:()=>a,QG:()=>o,TZ:()=>p,VD:()=>f,Yh:()=>m,b:()=>l,lM:()=>y,nZ:()=>h,qM:()=>d,rV:()=>i,y9:()=>c});const a=(0,r(788860).vU)({chart:{defaultMessage:"chart",id:"chartExport.chart"},exportChart:{defaultMessage:"Save chart as...",id:"chartExport.exportChart"},exportChartPreview:{defaultMessage:"Preview",id:"chartExport.exportChartPreview"},exportChartBackground:{defaultMessage:"Background",id:"chartExport.exportChartBackground"},copyPng:{defaultMessage:"Copy as PNG",id:"chartExport.copyAsPng"},downloadPng:{defaultMessage:"Download PNG",id:"chartExport.downloadPng"},downloadSvg:{defaultMessage:"Download SVG",id:"chartExport.downloadSVG"},madeWithNotion:{defaultMessage:"Made with Notion",id:"chartExport.madeWithNotion"}}),o=200,n=2,i=800,l=500,s=240,u=120,d=96,c=64,p=2*u,g=2*d,y=2*c;function m(e){let t={width:i,height:l};return"none"===e&&(t={width:i+p,height:l+g}),{chart:t,plotOptions:{pie:{size:s}}}}const h=20,f=8},629352:(e,t,r)=>{r.d(t,{x:()=>u});r(241792);var a=()=>r(142735),o=()=>r(970977),n=()=>r(790300),i=()=>r(55406),l=()=>r(559729),s=()=>r(263483);function u(e){let{chartConfig:t,chartError:r,collectionContextStore:u}=e;const d=(0,a().Kw)(u.normalizedFormatStore),c=(0,a().VK)((()=>(0,s().WT)()),[]),p=(0,a().VK)((()=>(0,s().K9)()),[]);return(0,a().VK)((()=>{if((!r||(0,o().se)(r))&&t)return function(e){var t,r,a;let{chartConfig:o,format:s,groupsLimit:u,subGroupsLimit:d}=e;if("placeholder"===o.type||"groups_reducer"!==(null===(t=o.dataConfig)||void 0===t?void 0:t.type))return;const c=null===(r=o.chartFormat)||void 0===r?void 0:r.axisHideEmptyGroups,p=s.collection_groups||[],g=p.map((e=>e.value)),y=o.dataConfig.groupBy,m=(0,n().u)(o)?null===(a=o.dataConfig.aggregationConfig.stackOptions)||void 0===a?void 0:a.groupBy:void 0,h=(0,i().x7)(o);if(!h)return;const f=(0,l().Wr)(y,s);if(m){const e=(s.chart_subgroups||[]).map((e=>e.value));return{type:"groups",groupBy:f,limit:u,groupSortPreference:g,subGroup:{groupBy:(0,l().Wr)(m,s),limit:d,groupSortPreference:e},aggregation:{type:"intersection_and_independent",intersectionAggregation:h,groupAggregation:h,subGroupAggregation:h},hideEmptyAggregationGroups:Boolean(c)}}const v={type:"groups",limit:u,groupBy:f,groupSortPreference:g??[],aggregation:{type:"independent",groupAggregation:h},hideEmptyAggregationGroups:Boolean(c)};return v}({chartConfig:t,format:d,groupsLimit:c,subGroupsLimit:p})}),[r,t,c,d,p],{useDeepEqual:!0})}},422118:(e,t,r)=>{r.d(t,{ug:()=>U,s1:()=>k,hZ:()=>E,qQ:()=>j,T3:()=>O,Xn:()=>H,vY:()=>R,ff:()=>K,py:()=>D,NX:()=>z,dt:()=>I,V4:()=>P,Bv:()=>A});var a=()=>r(730120),o=r(667294),n=()=>r(846550),i=()=>r(816512),l=()=>r(145112),s=()=>r(790300),u=()=>r(608352),d=()=>r(532850),c=()=>r(696459),p=()=>r(743359),g=()=>r(109477),y=()=>r(530980),m=r(785893);function h(e){let{size:t,style:r,icon:a,baseUrl:o,getRecordModel:n}=e;return(0,m.jsx)("div",{style:{height:t,width:t,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,verticalAlign:"top",marginTop:1,...r},children:(0,m.jsx)(b,{icon:a,size:t,baseUrl:o,getRecordModel:n})})}const f=o.memo(h);function v(e){return.9*e}function S(e){return.888*e}function b(e){let{icon:t,size:r,baseUrl:a,getRecordModel:o}=e;if(!t)return null;const n=(e,t)=>{const o=p().EK({url:e,baseUrl:a,fullyQualified:!0,permissionRecord:t,width:S(r),userId:void 0});return(0,m.jsx)("img",{alt:"icon",src:o,style:{width:S(r),height:S(r),objectFit:"cover",borderRadius:4,marginTop:1}})},i=(0,g().Lf)(t.icon);switch(i.type){case"unicode_emoji":return(0,m.jsx)("div",{style:{fontSize:v(r)},children:i.emoji.unicode});case"custom_emoji":const e=y().vq9.resolveCustomEmojiIcon(t,o);return e?n(e.icon,e.pointer):null;case"app_package_asset":case"notion_icon":case"url":return n(t.icon,t.pointer);default:(0,c().t1)(i)}}var x=()=>r(965708);const _=function(e){const{botValue:t,avatarSize:a,baseUrl:o,theme:n,style:i}=e;if(null!=t&&t.icon){const l=r(225339).F8(t.icon)?p().Q4({url:t.icon,width:e.avatarSize,fullyQualified:!0,stripGoogleIconQuery:!0,baseUrl:o,userId:void 0}):t.icon;return(0,m.jsx)("div",{style:{...(0,x().nH)({theme:n,avatarSize:a}),...i},children:(0,m.jsx)("img",{src:l,style:{display:"block",width:"100%",height:"100%",objectFit:"cover"}})})}if(null!=t&&t.name){const e=t.name[0];return(0,m.jsx)("div",{children:(0,m.jsx)("div",{style:{...(0,x().r4)({theme:n,avatarSize:a}),...i},children:(0,m.jsx)("div",{children:e})})})}return(0,m.jsx)("span",{children:"🤖"})};var C=()=>r(803021),w=()=>r(646574),M=()=>r(114079),B=()=>r(582900),T=()=>r(568017),V=()=>r(707513),F=()=>r(205228),G=()=>r(559729);const k=(0,r(788860).vU)({titlePlaceholder:{defaultMessage:"Untitled",id:"chartLabelFormatHelpers.untitledBlock"}});function P(e,t,r){const a=(0,n().yK)((e=>({wrapper:{display:"flex",alignItems:"center",gap:6,minWidth:0},initialStyle:{backgroundColor:e.chartAvatarBackgroundColor,border:`1px solid ${e.chartAvatarBorderColor}`,color:e.chartAvatarColor},avatarStyle:{background:"none"},botStyle:{backgroundColor:e.chartAvatarBackgroundColor,border:`1px solid ${e.chartAvatarBorderColor}`,color:e.chartAvatarColor,fontSize:r?8:10},avatarWrapper:{flexShrink:0},nameWrapper:{minWidth:0,...V().Yu}})),[r]);return(0,o.useCallback)(((o,n)=>{var l,s;if(!n)return o.toString();let u,d,c;if(n.actorPointer&&e){var p;const r=(0,i().Hl)({pointer:n.actorPointer,getRecordModel:e});d=null==r?void 0:r.asActor,c=null===(p=d)||void 0===p?void 0:p.getDisplayName(t)}return c||(c=o||t.formatMessage(y().T_T.messages.anonymousPlaceholder)),u=null!==(l=d)&&void 0!==l&&l.isUser()?(0,m.jsx)(x().ZP,{userValue:d,avatarSize:r?16:20,baseUrl:F().default.domainBaseUrl,theme:(0,T().Vx)(),fontSize:r?8:10,initialStyle:a.initialStyle,avatarStyle:a.avatarStyle}):null!==(s=d)&&void 0!==s&&s.isBot()?(0,m.jsx)(_,{botValue:d,avatarSize:r?16:20,baseUrl:F().default.domainBaseUrl,theme:(0,T().Vx)(),style:a.botStyle}):(0,m.jsx)(x().ZP,{userValue:{name:"?"},avatarSize:r?16:20,baseUrl:F().default.domainBaseUrl,theme:(0,T().Vx)(),fontSize:r?8:10,initialStyle:a.initialStyle,avatarStyle:a.avatarStyle}),B().Z.renderToStaticMarkup((0,m.jsxs)("div",{style:a.wrapper,children:[(0,m.jsx)("div",{style:a.avatarWrapper,children:u}),r?(0,m.jsx)("div",{style:a.nameWrapper,children:c}):null]}))}),[e,t,r,a])}function A(e,t,r){const a=(0,n().yK)((()=>({wrapper:{display:"flex",alignItems:"center",gap:6,minWidth:0},avatarWrapper:{flexShrink:0},titleWrapper:{minWidth:0,...V().Yu}})),[]),i=t.formatMessage(k.titlePlaceholder);return(0,o.useCallback)(((o,n)=>{if(!n||!e)return o.toString()||i;let l;if(n.pagePointer&&e&&(l=e(n.pagePointer)),!l)return o.toString()||i;const s=l.getRenderTitleWithPlaceholder({getRecordModel:e,userTimeZone:r,intl:t}),u=l.getRenderIcon({getRecordModel:e});return B().Z.renderToStaticMarkup((0,m.jsxs)("div",{style:a.wrapper,children:[u&&(0,m.jsx)("div",{style:a.avatarWrapper,children:(0,m.jsx)(f,{getRecordModel:e,icon:u,size:16,baseUrl:F().default.domainBaseUrl})}),(0,m.jsx)("div",{style:a.titleWrapper,children:s})]}))}),[e,r,t,i,a.wrapper,a.avatarWrapper,a.titleWrapper])}function D(e){var t,r,a,o;const n="count"===(null===(t=e.aggregation)||void 0===t?void 0:t.aggregator)||"unique"===(null===(r=e.aggregation)||void 0===r?void 0:r.aggregator)?"number":K(e.propertySchema);let i;return i="count"===(null===(a=e.aggregation)||void 0===a?void 0:a.aggregator)||"unique"===(null===(o=e.aggregation)||void 0===o?void 0:o.aggregator)?"precision_0":"precision_from_number_property"===e.numberPrecisionOverride?z(e.propertySchema):e.numberPrecisionOverride,t=>"string"==typeof t?t:i&&"precision_uncapped"!==i?(0,M().uf)(t,n,e.intl,"compact",i):(0,M().uf)(I(t,2),n,e.intl,"compact",void 0)}function R(e){let{groupBy:t,dateFormat:r,intl:a}=e;return(e,o)=>{let n;return n=o?o.name:"string"==typeof e?e:e.toString(),j({dateString:n,dateFormat:r,groupBy:t,intl:a})}}function j(e){let{dateString:t,dateFormat:r,groupBy:o,intl:n}=e;const i=parseInt(t,10);if(isNaN(i))return t;switch(o){case"relative":default:return t;case"day":return(0,w().ZV)({value:{type:"date",start_date:a().ou.fromMillis(i).toISODate()},date_format:r||C().sF,allowRelativeDates:!0,intl:n});case"week":case"month":case"year":const e=a().ou.fromMillis(i),l={type:o,range:{type:"daterange",start_date:e.toISODate(),end_date:e.plus({[`${o}s`]:1}).minus({days:1}).toISODate()}};return(0,G().fZ)({value:l,intl:n})}}function K(e){let t;return("number"===e.type||"formula"===e.type)&&(t=e.number_format),t}function z(e){return"number"===e.type||"formula"===e.type?e.number_precision:void 0}function H(e){let{chartConfig:t,schema:r,highChartsLabel:a,highChartsValue:o,isMultiSeries:n,intl:i,numberPrecisionOverride:u}=e,c=a,p=o;if(!t)return{label:c,value:p};const g=t.dataConfig;let y,m,h,f;if(n){if((0,s().u)(t)&&"groups_reducer"===t.dataConfig.type){var v;const e=t.dataConfig;if(y=null===(v=e.aggregationConfig.stackOptions)||void 0===v?void 0:v.groupBy,y){const e=(0,d().Qm)({schema:r,property:y.property});e&&(0,l().f3)(e)&&(m=e)}f=e.aggregationConfig.aggregation,"count"!==f.aggregator&&(h=(0,d().Qm)({schema:r,property:f.property}))}}else"groups_reducer"===g.type?(y=g.groupBy,m=(0,d().Qm)({schema:r,property:g.groupBy.property}),f=g.aggregationConfig.aggregation,"count"!==f.aggregator&&(h=(0,d().Qm)({schema:r,property:f.property}))):h=(0,d().Qm)({schema:r,property:g.valueProperty});if(c=m?E({propertySchema:m,groupByFormat:y,aggregation:void 0,highChartsLabel:a,intl:i}):c,p&&"number"==typeof p&&h&&(0,l().HQ)(h)){var S,b,x,_;const e="count"===(null===(S=f)||void 0===S?void 0:S.aggregator)||"unique"===(null===(b=f)||void 0===b?void 0:b.aggregator)?"number":K(h),t="count"===(null===(x=f)||void 0===x?void 0:x.aggregator)||"unique"===(null===(_=f)||void 0===_?void 0:_.aggregator)?"precision_0":u??z(h);p=t&&"precision_uncapped"!==t?(0,M().uf)(p,e,i,"compact",t):I(p,2)}return{label:c,value:p}}function E(e){const{propertySchema:t,groupByFormat:r,aggregation:a,highChartsLabel:o,intl:n}=e;if(t&&(0,l().HQ)(t)){const e="count"===(null==a?void 0:a.aggregator)||"unique"===(null==a?void 0:a.aggregator)?"number":K(t),r=parseInt(o,10);return isNaN(r)||"percent"===e?o:(0,M().uf)(r,e,n,"compact")}const i="formula"===(null==r?void 0:r.type)?r.groupBy:r;return t&&(0,l().l2)(t)&&i&&(0,u().ib)(i)?j({dateString:o,dateFormat:t.date_format,groupBy:i.groupBy,intl:n}):o}const L=1.2,Z=2;function U(e){var t,r,a,o;if("count"===(null===(t=e.aggregation)||void 0===t?void 0:t.aggregator)||"unique"===(null===(r=e.aggregation)||void 0===r?void 0:r.aggregator))return!1;return"percent"===K(e.propertySchema)||(void 0!==e.userYAxisMax&&void 0!==e.userYAxisMin&&Math.abs(e.userYAxisMax-e.userYAxisMin)<Z||(!!(null!==(a=e.userYAxisMax)&&void 0!==a&&a.toString().includes(".")||null!==(o=e.userYAxisMin)&&void 0!==o&&o.toString().includes("."))||Math.abs(e.dataYAxisMax)<L&&Math.abs(e.dataYAxisMin)<L))}function O(e){return e%1==0?e:e.toFixed(1)}function I(e,t){const r=Math.pow(10,t);return Math.round(e*r)/r}},263483:(e,t,r)=>{r.d(t,{K9:()=>s,WT:()=>u,Zl:()=>l});var a=()=>r(749826);const o=1e3,n=1e3,i=1e3;function l(){const e=a().default.getConfigKey("charts_query_collection_limits","max_results_reducer_limit");return e||i}function s(){const e=a().default.getConfigKey("charts_query_collection_limits","max_subgroups_reducer_limit");return e||n}function u(){const e=a().default.getConfigKey("charts_query_collection_limits","max_groups_reducer_limit");return e||o}},132258:(e,t,r)=>{r.d(t,{q:()=>o});var a=()=>r(749826);function o(){return a().default.getConfigKey("collection_reducer_request_settings","chart").debounce_wait_ms}},120793:(e,t,r)=>{r.d(t,{FW:()=>o,OS:()=>a,jW:()=>n});const a="ungrouped_chart_results",o="grouped_chart_results",n="aggregation_chart_results"},970977:(e,t,r)=>{r.d(t,{C:()=>y,Ib:()=>p,SO:()=>c,lY:()=>g,o0:()=>m,se:()=>h});r(122556),r(582845),r(250570),r(533019),r(721473),r(788208),r(22624);var a=()=>r(332143),o=()=>r(834458),n=()=>r(608352),i=()=>r(532850),l=()=>r(820271),s=()=>r(145112),u=()=>r(790300);const d=new Set(["groupBy_property_not_configured","groupBy_property_deleted","groupBy_property_not_groupable","groupBy_formula_not_groupable","aggregation_property_not_configured","aggregation_invalid","aggregation_deleted","stackBy_property_not_groupable","stackBy_formula_not_groupable","stackBy_property_deleted","name_property_not_configured","name_property_deleted","name_property_invalid","property_value_property_not_configured","property_value_property_deleted","property_value_property_invalid"]);function c(e){let{chartConfig:t,collectionSchema:r}=e;if(!t||"placeholder"===t.type)return"chart_config_not_found";if(void 0===t.dataConfig)return"data_model_invalid";if("groups_reducer"===t.dataConfig.type){const e=t.dataConfig.groupBy;if(!e)return"groupBy_property_not_configured";const l=(0,i().Qm)({schema:r,property:e.property});if(!l)return"groupBy_property_deleted";const c=(0,n().LG)(l);if("formula"===l.type&&!c)return"groupBy_formula_not_groupable";if(!c)return"groupBy_property_not_groupable";const p=t.dataConfig.aggregationConfig;if(!p)return"aggregation_property_not_configured";if("count"!==p.aggregation.aggregator){const e=p.aggregation.property,t=(0,i().Qm)({schema:r,property:e});if(!t)return"aggregation_deleted";if((0,a().nC)(p.aggregation)&&t&&!(0,s().HQ)(t))return"aggregation_invalid";if("formula"===(null==t?void 0:t.type)&&"unique"===p.aggregation.aggregator){const e=(0,o().getFormulaPropertySchemaResultType)(t);if(!(0,s().Oy)(e))return"aggregation_invalid"}}if((0,u().u)(t)){var d;const e=null===(d=t.dataConfig.aggregationConfig.stackOptions)||void 0===d?void 0:d.groupBy.property;if(e){const t=(0,i().Qm)({schema:r,property:e});if(!t)return"stackBy_property_deleted";const a=(0,n().LG)(t);if("formula"===t.type&&!a)return"stackBy_formula_not_groupable";if(!a)return"stackBy_property_not_groupable"}}}else{if("results_reducer"!==t.dataConfig.type)return"data_model_invalid";{const e=t.dataConfig.nameProperty;if(!e)return"name_property_not_configured";const a=(0,i().Qm)({schema:r,property:e});if(!a)return"name_property_deleted";if(!(0,l().HT)(a))return"name_property_invalid";const o=t.dataConfig.valueProperty;if(!o)return"property_value_property_not_configured";const n=(0,i().Qm)({schema:r,property:o});if(!n)return"property_value_property_deleted";if(!(0,l()._i)(n))return"property_value_property_invalid"}}}function p(e){return"groupBy_property_not_configured"===e||"groupBy_property_deleted"===e||"groupBy_property_not_groupable"===e||"groupBy_formula_not_groupable"===e||"name_property_not_configured"===e||"name_property_deleted"===e||"name_property_invalid"===e}function g(e){return"aggregation_property_not_configured"===e||"aggregation_deleted"===e||"aggregation_invalid"===e||"property_value_property_not_configured"===e||"property_value_property_deleted"===e||"property_value_property_invalid"===e}function y(e){return"stackBy_property_deleted"===e||"stackBy_property_not_groupable"===e||"stackBy_formula_not_groupable"===e||"stackBy_property_no_values"===e}function m(e){return d.has(e)}function h(e){return"stackBy_property_no_values"===e}},145112:(e,t,r)=>{r.d(t,{Dv:()=>p,Fh:()=>d,GX:()=>_,Gs:()=>c,HQ:()=>V,Ni:()=>g,OY:()=>x,Oy:()=>P,Q5:()=>y,R1:()=>C,Sw:()=>G,T9:()=>B,UJ:()=>v,Xg:()=>h,Xm:()=>f,dY:()=>w,f3:()=>F,gg:()=>S,l2:()=>k,lr:()=>m,qL:()=>A,qV:()=>T,v6:()=>M,vi:()=>D});var a=()=>r(696459),o=()=>r(834458),n=()=>r(608352),i=()=>r(226413),l=()=>r(532850),s=()=>r(964120),u=()=>r(790300);const d=["gray","blue","yellow","green","purple","teal","orange","pink","red"],c=["auto","colorful"];let p=function(e){return e.small="small",e.medium="medium",e.large="large",e.extra_large="extra_large",e}({});function g(e){switch(e){case p.small:return 300;case p.medium:return 400;case p.large:return 600;case p.extra_large:return 800;default:(0,a().t1)(e)}}function y(e){switch(e){case p.small:return 150;case p.medium:return 250;case p.large:return 300;case p.extra_large:return 400;default:(0,a().t1)(e)}}let m=function(e){return e.avatar="avatar",e.avatar_name="avatar_name",e.name="name",e}({}),h=function(e){return e.none="none",e.x_axis="x_axis",e.y_axis="y_axis",e.both="both",e}({}),f=function(e){return e.none="none",e.horizontal="horizontal",e.vertical="vertical",e.both="both",e}({}),v=function(e){return e.normal="normal",e.percent="percent",e.side_by_side="side_by_side",e}({}),S=function(e){return e.none="none",e.value="value",e.name="name",e.name_and_value="name_and_value",e}({});function b(e){if(!e)return!1;return n().z8.includes(e)}function x(e){const t=(0,o().getFormulaPropertySchemaBaseResultType)(e);return"text"===t||"number"===t||"checkbox"===t||"person"===t||"date"===t}function _(e,t){var r,o;let i,u=e.chartFormat;if("groups_reducer"===e.dataConfig.type){var d;const{chartFormat:r,chartGroupByFormat:a}=function(e,t,r,a){const o=(0,l().Qm)({schema:a,property:e.property});if(o&&"donut"===r&&(0,s().jn)(o)){const r=(0,n().Cc)(e);return{chartFormat:{...t,mainSort:s().MN.yDescending},chartGroupByFormat:r}}return{chartFormat:t,chartGroupByFormat:e}}(null==e||null===(d=e.dataConfig)||void 0===d?void 0:d.groupBy,null==e?void 0:e.chartFormat,"donut",t);u=r,i={...e.dataConfig,groupBy:a,aggregationConfig:{aggregation:e.dataConfig.aggregationConfig.aggregation}}}else"results_reducer"===e.dataConfig.type?(i=e.dataConfig,u={...u,mainSort:s().MN.yDescending}):(0,a().t1)(e.dataConfig);D(e)&&u&&(void 0===(null===(r=u)||void 0===r?void 0:r.donutDataLabels)||(null===(o=u)||void 0===o?void 0:o.donutDataLabels)===S.none)?u.donutDataLabels=S.value:!D(e)&&u&&(u.donutDataLabels=S.none);const c={...e,type:"donut",dataConfig:i};return u&&(c.chartFormat=u),c}function C(e,t){let r;"groups_reducer"===e.dataConfig.type?r={...e.dataConfig,aggregationConfig:{...e.dataConfig.aggregationConfig,seriesFormat:{displayType:t},stackOptions:void 0}}:"results_reducer"===e.dataConfig.type?r={...e.dataConfig,valueSeriesFormat:{displayType:t}}:(0,a().t1)(e.dataConfig);const o=e.chartFormat;return o&&o.donutDataLabels&&o.donutDataLabels!==S.none?o.axisShowDataLabels=!0:!o||o.donutDataLabels!==S.none&&void 0!==o.donutDataLabels||(o.axisShowDataLabels=!1),{...e,type:t,dataConfig:r}}function w(e,t){let r;if("groups_reducer"===e.dataConfig.type){var o;const a=null==e||null===(o=e.dataConfig)||void 0===o?void 0:o.groupBy;r={...e.dataConfig,groupBy:a,aggregationConfig:{...e.dataConfig.aggregationConfig,seriesFormat:{displayType:t}}}}else"results_reducer"===e.dataConfig.type?r={...e.dataConfig,valueSeriesFormat:{displayType:t}}:(0,a().t1)(e.dataConfig);return{...e,type:t,dataConfig:r}}const M={main:s().MN.xAscending,stacked:s().MN.manual};function B(e){let{chartConfig:t,xAxisPropertyId:r,newDataConfigType:o,groupBy:n,aggregation:i,valueProperty:l}=e;const u="groups_reducer"===t.dataConfig.type?t.dataConfig.aggregationConfig.seriesFormat:t.dataConfig.valueSeriesFormat;"groups_reducer"===o?t.dataConfig={type:"groups_reducer",groupBy:n,aggregationConfig:{aggregation:i,seriesFormat:u,stackOptions:"groups_reducer"===t.dataConfig.type?t.dataConfig.aggregationConfig.stackOptions:void 0}}:"results_reducer"===o?t.dataConfig={type:"results_reducer",nameProperty:r,valueProperty:l,valueSeriesFormat:u}:(0,a().t1)(o);const d="formula"===n.type?n.groupBy.sort:n.sort;return t.chartFormat={...t.chartFormat,mainSort:(0,s().H9)(d)},t}function T(e){let{property:t,propertySchema:r,groupByOption:a,hideEmptyGroups:i}=e;const l=r.type;if((0,n().LG)(r)){if((0,n().A1)(l)){if(a&&b(a))return{type:l,property:t,groupBy:a,sort:{type:"ascending"}}}else{if((0,n().zb)(l)||"select"===l||"multi_select"===l)return{type:l,property:t,sort:{type:"ascending"}};if((0,n().H1)(l)){if(a&&((s=a)&&n().vu.includes(s)))return{type:l,property:t,groupBy:a,sort:{type:"ascending"}}}else{if("number"===l)return{type:l,property:t,groupBy:{type:"unique"},start:-1,end:-1,size:-1,sort:{type:"ascending"}};if("formula"===l){const e=(0,o().getFormulaPropertySchemaResultType)(r);if("number"===e)return{type:"formula",property:t,groupBy:{type:"number",groupBy:{type:"unique"},start:-1,end:-1,size:-1,sort:{type:"ascending"}}};if("date"===e&&b(a))return{type:"formula",property:t,groupBy:{type:"date",groupBy:a,sort:{type:"ascending"}}}}else if("person"===l)return{type:l,property:t,sort:{type:"manual"}}}}var s;return(0,n().fw)({property:t,propertySchema:r,hideEmptyGroups:i})}}function V(e){const t="formula"===e.type?(0,o().getFormulaPropertySchemaResultType)(e):void 0;return(0,i().G$)(e)||"number"===t}function F(e){const t="formula"===e.type?(0,o().getFormulaPropertySchemaResultType)(e):void 0;return(0,n().A1)(e.type)||"date"===t}function G(e){const t="formula"===e.type?(0,o().getFormulaPropertySchemaResultType)(e):void 0;return(0,i().U8)(e)||"person"===t}function k(e){if("formula"===e.type){const t=(0,o().getFormulaPropertySchemaResultType)(e);return(0,n().A1)(t)}return(0,n().A1)(e.type)}function P(e){return"text"===e||"number"===e||"person"===e||"date"===e}function A(e){var t;return!(!e||!(0,u().u)(e))&&("groups_reducer"!==e.dataConfig.type||!e.dataConfig.aggregationConfig.stackOptions||"percent"!==(null===(t=e.chartFormat)||void 0===t?void 0:t.axisGroupStyle))}function D(e){return!!A(e)&&(!(!e||!(0,u().u)(e))&&(void 0===(null===(t=e.chartFormat)||void 0===t?void 0:t.axisShowDataLabels)||(null===(r=e.chartFormat)||void 0===r?void 0:r.axisShowDataLabels)));var t,r}}}]);