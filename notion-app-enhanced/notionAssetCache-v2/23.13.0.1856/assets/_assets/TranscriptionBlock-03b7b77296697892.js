"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[93191],{442531:(e,t,n)=>{n.d(t,{HZ:()=>o,YD:()=>s,_7:()=>r,io:()=>i});const i=new(n(677559).Ss)("framer-motion",(async()=>await Promise.all([n.e(37358),n.e(7312),n.e(70355),n.e(99464)]).then(n.bind(n,524138))));function o(e){return e.useAnimate()}function r(e){return e.useAnimation()}function s(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return e.useInView(...n)}},592183:(e,t,n)=>{n.r(t),n.d(t,{setToggleState:()=>_,startTranscribingBlockOnPage:()=>A,startTranscription:()=>M,stopTranscription:()=>C,updatePreferredSummarizationFormat:()=>B});n(492176),n(7961);var i=()=>n(156642),o=()=>n(396136),r=()=>n(989478),s=()=>n(342792),a=()=>n(959137),c=()=>n(421654),l=()=>n(332542),d=()=>n(636340),u=()=>n(970105),p=()=>n(269299),m=()=>n(254940),f=()=>n(298721),g=()=>n(964433),h=()=>n(527278),y=()=>n(876822),v=(n(670560),()=>n(852465));function x(e,t){const n=t??[];e.isType("transcription")&&n.push(e);const i=e.getContentStores();for(const o of i)x(o,n);return n}function b(e){const{blockStore:t}=e,n=t.getNavigableBlockStore();if(!n)return[];const i=[],o=(0,v().MI)({blockStore:n,transclusionReferences:"omit",childPages:"omit"});for(const r of o){const e=r.getFormatStore();(null==e?void 0:e.getKeyValue("created_by_transcription_block_id"))===t.id&&i.push(r)}return i}var S=()=>n(648587),k=()=>n(874023);function _(e){const{blockId:t,state:n}=e;S().i.setOpen(t,n)}const j=(0,n(788860).vU)({transcribingTitle:{id:"transcriptionBlock.transcribingTitle",defaultMessage:"Transcribing..."}});function M(e){var t;const{environment:n,blockStore:i}=e;S().i.setCurrentlyListeningBlockId(i.id);const o=i.getContentStores().at(-1)??i;k().DictationManager.startDictation({environment:n,blockStore:o,from:"transcription_block",preCreateDictationBlock:!0});const s=null===(t=y().default.state.currentUserStore)||void 0===t?void 0:t.id;if(!s)return;const a=i.getBlockTitleStore();p().createAndCommit({userAction:"transcriptionBlockActions.initializeTitle",environment:n,perform:e=>{const t=[[h().Z.formatMessage(j.transcribingTitle)]];u().sO({environment:n,store:a,value:t,transaction:e}),c().FH({stores:[i],update:{transcription_state:{state:"transcribing",transcriber_id:s,transcriber_table:r().KJ}},transaction:e})}})}async function C(e){const{environment:t,blockStore:n,disableSummarization:i}=e;S().i.setCurrentlyListeningBlockId(void 0),p().createAndCommit({userAction:"transcriptionBlockActions.stopTranscription",environment:t,perform:e=>{c().FH({stores:[n],update:{transcription_state:{state:"idle"}},transaction:e})}}),k().DictationManager.stopDictation({environment:t,from:"transcription_block"}),i||await T({environment:t,blockStore:n})}async function T(e){const{environment:t,blockStore:n}=e;if(!y().default.state.mainEditorCurrentBlockStore)return;const r=n.pointer.spaceId;if(!r)return;const u=n.getParentStore();if((null==u?void 0:u.table)!==o().iU)return;w({environment:t,blockStore:n});const h={...n.pointer,spaceId:r},v=await g().p.load(),x=await a().F.clipboardActions.load();await(0,f()._O)({environment:t,onResponse:e=>{if("summarize-transcript-response"!==e.type)return;w({environment:t,blockStore:n});const i=e.response;p().createAndCommit({userAction:"transcriptionBlockActions.summarizeTranscript",environment:t,perform:e=>{const o=x.markdownToBlocks({environment:t,text:i,inMemoryRecordCache:n.inMemoryRecordCache,transaction:e,markdownOptions:{},markdownLinkifyIt:v,tinyMceMicrosoftWordPasteFilter:void 0});if(o){(0,m().postProcessAICreatedStores)(t,o),c().FH({stores:o,update:{created_by_transcription_block_id:n.id},transaction:e});for(const t of o)l().SH({childStore:t,parentStore:u,transaction:e,before:n.id})}}})},data:{transcript:[{id:(0,s().ZP)(),type:"config",value:{type:"summarize-transcript",transcriptPointer:h}},{id:(0,s().ZP)(),type:"summarize-transcript"}],traceId:(0,s().ZP)(),spaceId:r,generateTitle:!1},upsellFrom:"transcription_block"}),p().createAndCommit({userAction:"transcriptionBlockActions.createDivider",environment:t,perform:e=>{const o=d().j4({environment:t,type:i().Ti.divider,format:{created_by_transcription_block_id:n.id},inMemoryRecordCache:u.inMemoryRecordCache,transaction:e});l().SH({childStore:o,parentStore:u,transaction:e,before:n.id})}}),S().i.setSettingsOpenForBlockId(n.id)}function w(e){const{environment:t,blockStore:n}=e,i=b({blockStore:n});i.length>0&&p().createAndCommit({userAction:"transcriptionBlockActions.deletePreviousSummarizationBlocks",environment:t,perform:e=>{for(const t of i){const n=t.getParentStore();(null==n?void 0:n.table)===o().iU&&l().hr({childStore:t,parentStore:n,transaction:e})}}})}function A(e){const{environment:t}=e,n=y().default.state.mainEditorCurrentBlockStore;if(!n)return;const i=x(n);i.sort(((e,t)=>t.getCreatedTime()-e.getCreatedTime()));const o=i[0];o&&M({environment:t,blockStore:o})}async function B(e){var t;const{environment:n,blockStore:i,format:o}=e;if((null===(t=i.getFormat())||void 0===t?void 0:t.transcription_summarization_format_type)===o)return;p().createAndCommit({userAction:"transcriptionBlockActions.updatePreferredSummarizationFormat",environment:n,perform:e=>{c().FH({stores:[i],update:{transcription_summarization_format_type:o},transaction:e})}});b({blockStore:i}).length>0&&await T({environment:n,blockStore:i})}},492961:(e,t,n)=>{n.d(t,{h:()=>h});n(670560),n(409045),n(453627),n(994774),n(995194),n(520522),n(200082),n(379976),n(724224),n(761121),n(637133),n(267602),n(241792),n(731107);var i=n(667294),o=()=>n(142735),r=()=>n(846550),s=()=>n(283444),a=()=>n(201741),c=()=>n(360666),l=n(785893);const d=50,u=7e3,p=(d+u)/2,m=(d+p)/2,f=(p+u)/2,g=8;function h(){const e=(0,o().VK)((()=>a().default.state.audioRecorder),[]),t=(0,o().Kw)(c().Z),[n,p]=(0,i.useState)(new Array(g).fill(1));(0,i.useEffect)((()=>{if(e&&t){const n=new AbortController,i=n.signal,o=()=>{const{mediaStream:n}=e;if(n){const e=t.createAnalyser();e.fftSize=2048;const o=(()=>{const i=t.createMediaStreamSource(n),o=t.createBiquadFilter();o.type="highpass",o.frequency.setValueAtTime(m,t.currentTime);const r=t.createBiquadFilter();return r.type="lowpass",r.frequency.setValueAtTime(f,t.currentTime),[i,o,r,e]})();for(let t=0;t<o.length-1;t++)o[t].connect(o[t+1]);const r=()=>{for(const e of o)e.disconnect()};t.resume();const s=new Uint8Array(e.frequencyBinCount),a=()=>{if(i.aborted)return void r();e.getByteFrequencyData(s);const n=t.sampleRate/2/e.frequencyBinCount,o=Math.round(d/n),c=Math.round(u/n),l=s.slice(o,c+1),m=Math.floor(l.length/g),f=[];for(let e=0;e<g;e++){const t=l.slice(e*m,e<g-1?(e+1)*m:l.length+1),n=t.reduce(((e,t)=>e+t),0)/t.length,i=Math.max(1,Math.min(12,n/3));f.push(i)}p(f),requestAnimationFrame(a)},c=requestAnimationFrame(a);return()=>{cancelAnimationFrame(c),r()}}};let r=o();const a=()=>{"function"==typeof r&&r(),r=o()};return e.emitter.on(s().oF,a),()=>{e.emitter.off(s().oF,a),"function"==typeof r&&r(),n.abort()}}}),[e,n.length,t]);const h=(0,r().yK)((e=>({barStyle:{flexShrink:0,bottom:"0",width:"1.5px",backgroundColor:e.icon.primary,borderRadius:"1px"}})),[]);return e?(0,l.jsx)("div",{style:{height:"20px",display:"flex",justifyContent:"center",alignItems:"center",position:"relative",gap:1.3},children:n.map(((e,t)=>(0,l.jsx)("div",{style:{...h.barStyle,height:`${e}px`}},t)))}):(0,l.jsx)("div",{style:{fontSize:"8px"},children:"No audio"})}},124333:(e,t,n)=>{n.d(t,{l:()=>C,$:()=>M});n(241792);var i=n(667294),o=()=>n(219727),r=()=>n(142735),s=()=>n(846550),a=()=>n(707513),c=()=>n(827973),l=()=>n(448419),d=()=>n(255577),u=()=>n(92175),p=()=>n(388284),m=()=>n(442531),f=()=>n(677559),g=()=>n(696347),h=()=>n(653457),y=()=>n(733641),v=()=>n(385485),x=()=>n(452701),b=()=>n(354986),S=()=>n(761588),k=()=>n(247724),_=n(785893);function j(e){const t=(0,o().O7)(),{parent:n}=e,i=(0,r().VK)((()=>Object.keys(S().jH).indexOf((0,b()._A)(t.currentUser.id))),[t.currentUser.id]),s=[{key:"languages",render:e=>(0,_.jsx)(p().Z,{...e,topBorder:0!==e.index}),items:(0,b().TG)().map((e=>{let[i,[o]]=e;const r={key:i,render:e=>(0,_.jsx)(c().Z,{...e,title:o}),action:()=>{(0,b().Yg)(t,i),n.close()}};return r}))}];return(0,_.jsx)("div",{className:k().tXr,style:{display:"flex",flexDirection:"column",width:150},children:(0,_.jsx)(d().Z,{type:d().i.Vertical,initialFocus:i,sections:s})})}function M(e){const{languagePopupStore:t}=e,n=(0,o().O7)(),c=(0,r().VK)((()=>(0,b()._A)(n.currentUser.id)),[n.currentUser.id]);(0,i.useEffect)((()=>{v().ZP.updateMediaDevices()}),[]);const d=(0,s().yK)((e=>({container:{padding:"8px 0px",display:"flex",flexDirection:"column",alignItems:"flex-start",width:300,gap:8},microphoneText:{marginLeft:12,fontSize:12,fontWeight:a().Ue.medium,color:e.text.secondary},microphoneSection:{display:"flex",flexDirection:"column",width:"100%"},languageText:{fontSize:14,color:e.text.primary},languageSection:{padding:"0px 14px",display:"flex",alignItems:"center",width:"100%",justifyContent:"space-between"},rightChevronStyle:{width:13,height:13,opacity:.5,color:e.icon.secondary},line:{width:"100%",height:1,backgroundColor:e.icon.tertiary,opacity:.3},languageButtonStyle:{fontSize:14,display:"flex",alignItems:"center",gap:10,color:e.text.secondary},helpSection:{padding:"5px 14px",display:"flex",alignItems:"center",justifyContent:"flex-start",gap:4,cursor:"pointer"},helpText:{fontSize:12,color:e.text.tertiary},helpIcon:{width:16,height:16,color:e.icon.tertiary}})),[]),p=(0,i.useMemo)((()=>(0,g().o)(d.rightChevronStyle)),[d.rightChevronStyle]),y=(0,i.useMemo)((()=>(0,h().m)(d.helpIcon)),[d.helpIcon]),{value:x}=(0,f().XJ)(m().io);if(!x)return null;const{motion:S}=x;return(0,_.jsxs)("div",{style:d.container,children:[(0,_.jsxs)("div",{style:d.microphoneSection,children:[(0,_.jsx)("div",{style:d.microphoneText,children:"Microphone"}),(0,_.jsx)(C,{})]}),(0,_.jsx)("div",{style:d.line}),(0,_.jsxs)("div",{style:d.languageSection,children:[(0,_.jsx)("div",{style:d.languageText,children:"Language"}),(0,_.jsx)(l().ZP,{buttonPopupStore:t,renderOrigin:e=>(0,_.jsxs)(u().Z,{style:d.languageButtonStyle,...e,children:[c," ",p]}),stopClickPropagation:!0,popupType:l().Z4.Popup,render:e=>(0,_.jsx)(j,{parent:e})})]}),(0,_.jsx)("div",{style:d.line}),(0,_.jsxs)(S.div,{style:d.helpSection,onClick:()=>window.open("https://www.notion.so/help/audio-dictation","_blank"),variants:{hover:{opacity:.6},tap:{opacity:1}},whileHover:"hover",whileTap:"tap",transition:{duration:.2},children:[y,(0,_.jsx)("div",{style:d.helpText,children:"Learn about Dictation"})]})]})}function C(){const e=(0,r().Kw)(v().UR),t=(0,r().Kw)(v().TZ),n=(0,r().VK)((()=>e.findIndex((e=>e.deviceId===(null==t?void 0:t.deviceId)))),[e,t]),i=[{key:"devices",render:e=>(0,_.jsx)(p().Z,{...e,topBorder:0!==e.index}),items:e.map((e=>({key:e.deviceId,render:n=>(0,_.jsx)(c().Z,{...n,title:e.label,right:e.deviceId===(null==t?void 0:t.deviceId)?(0,y().k)({width:14,height:14}):void 0}),action:()=>{x().Z.setState(e)}})))}];return(0,_.jsx)("div",{style:{display:"flex",flexDirection:"column",width:"100%"},children:(0,_.jsx)(d().Z,{type:d().i.Vertical,initialFocus:n,sections:i})})}},302957:(e,t,n)=>{n.r(t),n.d(t,{TranscriptionBlock:()=>ce,TranscriptionBlockImpl:()=>ae});n(267602),n(228244);var i=n(667294),o=n(111681),r=()=>n(219727),s=()=>n(142735),a=()=>n(846550),c=()=>n(494488),l=()=>n(788860),d=()=>n(58836),u=()=>n(154186),p=()=>n(448419),m=()=>n(1910),f=()=>n(690122),g=()=>n(967092),h=()=>n(384241),y=()=>n(98275),v=()=>n(627990),x=()=>n(167705),b=()=>n(239482),S=()=>n(856546),k=()=>n(480089),_=()=>n(439871),j=()=>n(314379),M=()=>n(998901),C=()=>n(592183),T=()=>n(876822);function w(e){return(0,s().VK)((()=>{var t,n;const i=null===(t=T().default.state.currentUserStore)||void 0===t?void 0:t.id,o=null===(n=e.getModel())||void 0===n?void 0:n.getFormat(),r=null==o?void 0:o.transcription_state;return"transcribing"===(null==r?void 0:r.state)&&(null==r?void 0:r.transcriber_id)===i}),[e])}var A=()=>n(201741),B=()=>n(648587),I=()=>n(492961),F=n(785893);function Z(e){const{isRecording:t,...n}=e,[o,r]=(0,i.useState)(!1),s=(0,a().yK)((()=>({outerCircle:{width:20,height:20,borderRadius:"50%",background:"#F6D0CD",display:"flex",alignItems:"center",justifyContent:"center"},innerCircle:{width:o?20:12,height:o?20:12,borderRadius:"50%",transition:"all 0.2s ease-in-out",backgroundColor:"#D44C47"}})),[o]);return(0,F.jsx)(u().Z,{...n,style:s.outerCircle,onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),children:(0,F.jsx)("div",{style:s.innerCircle})})}n(470928),n(241792);const R=(0,l().vU)({autoTitle:{id:"transcriptionSummarizationFormat.label.auto",defaultMessage:"Auto"},autoSubtitle:{id:"transcriptionSummarizationFormat.subtitle.auto",defaultMessage:"Notion AI chooses the best format"},salesCallTitle:{id:"transcriptionSummarizationFormat.label.salesCall",defaultMessage:"Sales Call"},salesCallSubtitle:{id:"transcriptionSummarizationFormat.subtitle.salesCall",defaultMessage:"Customer insights, needs, follow-ups"},standupTitle:{id:"transcriptionSummarizationFormat.label.standup",defaultMessage:"Standup"},standupSubtitle:{id:"transcriptionSummarizationFormat.subtitle.standup",defaultMessage:"Progress, blockers, action items"},teamMeetingTitle:{id:"transcriptionSummarizationFormat.label.teamMeeting",defaultMessage:"Team Meeting"},teamMeetingSubtitle:{id:"transcriptionSummarizationFormat.subtitle.teamMeeting",defaultMessage:"Updates, decisions, action items"}}),E=[{type:"auto",title:R.autoTitle,subtitle:R.autoSubtitle},{type:"sales-call",title:R.salesCallTitle,subtitle:R.salesCallSubtitle,instructions:"\nThis conversation is a sales call. Make sure to capture:\n- Any needs or asks the customer has brought up.\n- Background information about the customer, such as the customer's role, company, if they are using the product or service, etc.\n- A detailed but concise summary of the conversation.\n- Decisions or commitments that were made during the call if any.\n- Next steps.\n- Action items to be taken after the call.\n"},{type:"standup",title:R.standupTitle,subtitle:R.standupSubtitle,instructions:"\nThis conversation is a standup. Make sure to capture:\n- Progress on any projects or tasks.\n- Any blockers or issues that need to be addressed.\n- Action items to be taken after the standup. If possible, include who is responsible for each action item and a deadline for when it should be completed.\n"},{type:"team-meeting",title:R.teamMeetingTitle,subtitle:R.teamMeetingSubtitle,instructions:"\nThis conversation is a team meeting. Make sure to capture:\n- Updates on any projects or tasks.\n- Any decisions that were made.\n- Action items to be taken after the meeting. If possible, include who is responsible for each action item and a deadline for when it should be completed.\n"}];var D=()=>n(707513),U=()=>n(827973),L=()=>n(198829),O=()=>n(18748),z=()=>n(255577),H=()=>n(388284),V=()=>n(981583),K=()=>n(868744),P=()=>n(352230),N=()=>n(226994),q=()=>n(619555),Y=()=>n(653457),W=()=>n(578698),J=()=>n(233227),X=()=>n(826955);var $=()=>n(385485),G=()=>n(124333);function Q(e){const t=w(e.transcriptionBlockStore),n=(0,s().VK)((()=>B().i.getCurrentlyListeningBlockId()===e.transcriptionBlockStore.id),[e.transcriptionBlockStore.id]),i=(o=e.transcriptionBlockStore,(0,s().VK)((()=>{var e;const t=null===(e=o.getModel())||void 0===e?void 0:e.getFormat();return(null==t?void 0:t.transcription_state)??{state:"idle"}}),[o]));var o;return t&&n?(0,F.jsx)(ie,{...e}):"transcribing"===i.state?(0,F.jsx)(ne,{state:i,transcriptionBlockStore:e.transcriptionBlockStore}):(0,F.jsx)(ee,{transcriptionBlockStore:e.transcriptionBlockStore})}function ee(e){const{transcriptionBlockStore:t}=e,n=(0,r().O7)(),o=re(),a=(0,s().VK)((()=>{var e;return(null===(e=t.getModel())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.transcription_summarization_format_type)??"auto"}),[t]),c=E.find((e=>e.type===a))??E[0],d=(0,i.useCallback)((e=>{(0,C().updatePreferredSummarizationFormat)({environment:n,blockStore:t,format:e}),B().i.setSettingsOpenForBlockId(void 0)}),[n,t]);return(0,F.jsx)(z().Z,{type:z().i.Vertical,initialFocus:0,style:o.menuList,sections:[{key:"formatting-options",render:e=>(0,F.jsx)(H().Z,{...e,title:(0,F.jsx)(l()._H,{id:"transcriptionBlockSettings.summarizationSection.title",defaultMessage:"Summarization"})}),items:[{key:"format",render:(e,t)=>(0,F.jsx)(K().Z,{...e,onFocus:t.onFocus,renderOrigin:(e,t)=>(0,F.jsx)(U().Z,{...e,ref:t,icon:(0,W().U)(o.icon),title:(0,F.jsxs)("div",{style:o.sectionTitle,children:[(0,F.jsx)("div",{style:o.option,children:(0,F.jsx)(l()._H,{id:"transcriptionBlockSettings.format.title",defaultMessage:"Format"})}),(0,F.jsx)("div",{style:o.selection,children:(0,F.jsx)(l()._H,{...c.title})})]})}),renderExtension:(e,t)=>(0,F.jsx)(te,{selectedFormat:c,onFormatChange:d})}),action:()=>{}},{key:"custom-instructions",render:(e,t)=>(0,F.jsx)(K().Z,{...e,onFocus:t.onFocus,renderOrigin:(e,t)=>(0,F.jsx)(U().Z,{...e,ref:t,icon:(0,W().U)(o.icon),title:(0,F.jsx)("div",{style:o.sectionTitle,children:(0,F.jsx)("div",{style:o.option,children:(0,F.jsx)(l()._H,{id:"transcriptionBlockSettings.customInstructions.title",defaultMessage:"Custom Instructions"})})})}),renderExtension:(e,t)=>(0,F.jsx)(L().Z,{menuType:P().o.Popup,...e,children:(0,F.jsx)(z().Z,{type:z().i.Vertical,initialFocus:0,sections:[{key:"system-audio-options",render:e=>(0,F.jsx)(H().Z,{...e,title:"Coming soon!"}),items:[]}]})})}),action:()=>{}}]},oe()]})}function te(e){const{selectedFormat:t}=e,n=re();return(0,F.jsx)(z().Z,{type:z().i.Vertical,initialFocus:0,style:n.menuList,sections:[{key:"formatting-options",render:e=>(0,F.jsx)(H().Z,{...e}),items:E.map((n=>({key:n.type,render:(e,i)=>(0,F.jsx)(U().Z,{...e,checkState:t.type===n.type,title:(0,F.jsx)(l()._H,{...n.title}),caption:(0,F.jsx)(l()._H,{...n.subtitle})}),action:()=>{e.onFormatChange(n.type)}})))}]})}function ne(e){const{state:t}=e,n=(0,N().Z)(t.transcriber_id),i=re(),o=(0,s().VK)((()=>X().U6.createChildStore(e.transcriptionBlockStore,{table:t.transcriber_table,id:t.transcriber_id})),[e.transcriptionBlockStore,t.transcriber_id,t.transcriber_table]);return(0,F.jsx)(z().Z,{type:z().i.Vertical,initialFocus:0,style:i.menuList,sections:[{key:"audio-capture",render:e=>(0,F.jsx)(H().Z,{...e,title:(0,F.jsx)(l()._H,{id:"transcriptionBlockSettings.audioCaptureSection.title",defaultMessage:"Audio Capture"})}),items:[{key:"transcriber",render:e=>(0,F.jsx)(O().ZP,{...e,icon:(0,F.jsx)(V().Z,{userValue:o.getModel(),size:18,style:{borderRadius:12}}),title:(0,F.jsx)(l()._H,{id:"transcriptionBlockSettings.transcriber.title",defaultMessage:"{userName} is transcribing",values:{userName:n}})}),action:()=>{}}]},oe()]})}function ie(e){const t=re(),n=(0,s().Kw)($().TZ);return(0,F.jsx)(z().Z,{type:z().i.Vertical,initialFocus:0,style:t.menuList,sections:[{key:"audio-input",render:e=>(0,F.jsx)(H().Z,{...e,title:(0,F.jsx)(l()._H,{id:"transcriptionBlockSettings.audioInputSection.title",defaultMessage:"Audio Input"})}),items:[{key:"microphone",render:(e,i)=>(0,F.jsx)(K().Z,{...e,onFocus:i.onFocus,renderOrigin:(e,i)=>(0,F.jsx)(U().Z,{...e,ref:i,icon:(0,J().q)(t.icon),title:(0,F.jsxs)("div",{style:t.sectionTitle,children:[(0,F.jsx)("div",{style:t.option,children:(0,F.jsx)(l()._H,{id:"transcriptionBlockSettings.microphone.title",defaultMessage:"Mic"})}),(0,F.jsx)("div",{style:t.selection,children:null==n?void 0:n.label})]})}),renderExtension:(e,t)=>(0,F.jsx)(G().l,{})}),action:()=>{}},{key:"system-audio",render:(e,n)=>(0,F.jsx)(K().Z,{...e,onFocus:n.onFocus,renderOrigin:(e,n)=>(0,F.jsx)(U().Z,{...e,ref:n,icon:(0,q().l)(t.icon),title:(0,F.jsxs)("div",{style:t.sectionTitle,children:[(0,F.jsx)("div",{style:t.option,children:(0,F.jsx)(l()._H,{id:"transcriptionBlockSettings.systemAudio.title",defaultMessage:"Audio"})}),(0,F.jsx)("div",{style:t.selection,children:(0,F.jsx)(l()._H,{id:"transcriptionBlockSettings.systemAudio.selection",defaultMessage:"System"})})]})}),renderExtension:(e,t)=>(0,F.jsx)(L().Z,{menuType:P().o.Popup,...e,children:(0,F.jsx)(z().Z,{type:z().i.Vertical,initialFocus:0,sections:[{key:"system-audio-options",render:e=>(0,F.jsx)(H().Z,{...e,title:"Coming soon!"}),items:[]}]})})}),action:()=>{}}]},oe()]})}function oe(){return{key:"learn-more",render:e=>(0,F.jsx)(H().Z,{...e,topBorder:!0}),items:[{key:"learn-more",render:e=>(0,F.jsx)(U().Z,{...e,icon:(0,Y().m)({height:18,width:18}),title:(0,F.jsx)(l()._H,{id:"transcriptionBlockSettings.learnMore.title",defaultMessage:"Learn more"})}),action:()=>{window.open("https://www.notion.so/help/audio-dictation","_blank")}}]}}function re(){return(0,a().yK)((e=>({menuList:{minWidth:250},sectionTitle:{display:"flex",flexDirection:"row",alignItems:"center",gap:8},icon:{height:18,width:18},option:{fontWeight:D().Ue.semibold},selection:{flex:1,color:e.lightTextColor,maxWidth:140,...D().Yu}})),[])}const se=(0,l().vU)({moreOptions:{defaultMessage:"Options",id:"transcription_block.options"}});function ae(e,t){const n=(0,r().O7)(),o=(0,i.useRef)(null),T=(0,l().YB)(),R=(0,s().VK)((()=>B().i.isOpen(e.store.id)),[e.store.id]),E=(0,s().VK)((()=>e.store.getContentStore()),[e.store]),D=(0,s().VK)((()=>B().i.isSettingsOpenForBlockId(e.store.id)),[e.store.id]),U=w(e.store),L=(0,s().VK)((()=>{if(A().default.state.loading)return!0;const t=A().default.state.block;if(!t)return!1;return(0,b().eG)(t).some((t=>t.id===e.store.id))}),[e.store]),O=(0,s().VK)((()=>e.store.getTitleValue().length>0),[e.store]),z=(0,s().VK)((()=>(0,S().b)(e.store)||!e.store.isDefaultRecordCache()),[e.store]),H=(0,s().VK)((()=>B().i.getCurrentlyListeningBlockId()===e.store.id),[e.store.id]),V=(0,_().M)(),K=(0,_().M)();(0,i.useEffect)((()=>{!L&&U&&H&&(0,C().stopTranscription)({environment:n,blockStore:e.store,disableSummarization:!0})}),[L,e.store,n,U,H]),(0,i.useEffect)((()=>{if(!U)return()=>{};const t=()=>{(0,C().stopTranscription)({environment:n,blockStore:e.store})};return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}}),[n,e.store,U]);const P=(0,i.useCallback)((()=>{(0,C().setToggleState)({blockId:e.store.id,state:!R})}),[R,e.store.id]),N=(0,i.useCallback)((()=>{(0,C().startTranscription)({environment:n,blockStore:e.store})}),[n,e.store]),q=(0,i.useCallback)((()=>{(0,C().stopTranscription)({environment:n,blockStore:e.store})}),[n,e.store]),Y=(0,k().rv)(e.store,!0),W=(0,a().yK)((t=>({root:{paddingLeft:c().ZD.paddingLeft,...Y,...e.style},container:{display:"flex",alignItems:"flex-start"},content:{display:"flex",flexDirection:"column",width:"100%"},controlRowContainer:{display:"flex",justifyContent:"flex-end",alignItems:"center",gap:8,minHeight:24,marginTop:2},snippetContainer:{alignSelf:"flex-start"},snippet:{color:t.lightTextColor},placeholder:{fontSize:"inherit",width:"100%",borderRadius:4,caretColor:t.lightTextColor,...c().ZD,marginTop:2},placeholderText:{color:t.lightTextColor},moreIconButton:{width:24,height:24}})),[Y,e.style]),J=(0,F.jsx)(u().Z,{style:W.placeholder,disabled:e.disabled,children:(0,F.jsx)("span",{style:W.placeholderText,children:(0,F.jsx)(l()._H,{id:"transcription_block.placeholder",defaultMessage:"Your transcript will appear here. Click to begin recording."})})}),X=(0,F.jsxs)(v().ZP,{style:W.root,left:(0,F.jsx)(x().Z,{"aria-describedby":V,"aria-controls":K,isSidebar:!1,open:R,fill:!0,onClick:P,tapArea:n.device.isMobile?{size:30}:void 0}),ref:o,children:[(0,F.jsx)(d().p,{allowSelectionWithin:!1,children:(0,F.jsxs)("div",{style:W.controlRowContainer,children:[O?(0,F.jsx)("div",{style:W.snippetContainer,children:(0,F.jsx)(h().Z,{store:e.store,maxLength:75,shouldWrap:!1,removeIfEmpty:!0})}):null,(0,F.jsx)("div",{style:{flex:1}}),H?(0,F.jsx)(I().h,{}):null,(0,F.jsx)(Z,{isRecording:H,onClick:H?q:N}),(0,F.jsx)(p().ZP,{renderOrigin:e=>(0,F.jsx)(m().Z,{icon:j().o,style:W.moreIconButton,ariaLabel:T.formatMessage(se.moreOptions),...e}),render:t=>(0,F.jsx)(Q,{transcriptionBlockStore:e.store}),popupType:g().kQ.Popup,placementToOrigin:M().Placement.Bottom,alignmentToOrigin:M().Alignment.End,open:D,onClick:()=>{B().i.setSettingsOpenForBlockId(e.store.id)},onClose:()=>{B().i.setSettingsOpenForBlockId(void 0)}})]})}),R&&(0,F.jsx)(f().Z,{id:K,loaded:z,spinnerSize:"1em",showSpinnerTimeout:500,innerStyle:W.content,style:W.container,children:(0,F.jsx)(y().Z,{store:E,emptyPlaceholder:J,disabled:e.disabled,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag})})]});return(0,k().ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"transcription",getNode:()=>o.current,getBlockStore:()=>e.store})),[e.store]),X)}const ce=i.memo(i.forwardRef(ae),o.wU)},795597:(e,t,n)=>{n.d(t,{Z:()=>o});class i extends(()=>n(263184))().default{constructor(){super()}getInitialState(){}}const o=new i},360666:(e,t,n)=>{n.d(t,{Z:()=>o});class i extends(()=>n(263184))().default{constructor(){super()}getInitialState(){}setState(e){this.instanceState&&this.instanceState.close(),super.setState(e)}addListener(e){super.addListener(e),this.instanceState||this.setState((0,n(982774).k)(24e3))}removeListener(e){super.removeListener(e),0===this.listenerCount()&&this.setState(void 0)}}const o=new i},648587:(e,t,n)=>{n.d(t,{i:()=>o});class i extends(()=>n(263184))().default{getInitialState(){return{toggleMap:{},currentlyListeningBlockId:void 0,settingsOpenForBlockId:void 0}}setOpen(e,t){this.setState({...this.state,toggleMap:{...this.state.toggleMap,[e]:t}})}isOpen(e){return!!this.state.toggleMap[e]}setCurrentlyListeningBlockId(e){this.setState({...this.state,currentlyListeningBlockId:e})}getCurrentlyListeningBlockId(){return this.state.currentlyListeningBlockId}setSettingsOpenForBlockId(e){this.setState({...this.state,settingsOpenForBlockId:e})}isSettingsOpenForBlockId(e){return this.state.settingsOpenForBlockId===e}}const o=new i},439871:(e,t,n)=>{n.d(t,{M:()=>o});var i=n(667294);function o(e){const t=(0,i.useId)();return e??t}},226994:(e,t,n)=>{n.d(t,{Z:()=>c,s:()=>l});var i=()=>n(142735),o=()=>n(989478),r=()=>n(788860),s=()=>n(876822),a=()=>n(826955);function c(e){const t=(0,r().YB)();return(0,i().VK)((()=>{const{currentSpaceStore:n}=s().default.state;if(!n||!e)return;return a().U6.createChildStore(n,{table:o().KJ,id:e}).getDisplayName(t)}),[t,e])}function l(){const e=(0,r().YB)();return(0,i().VK)((()=>{const{currentUserStore:t}=s().default.state,n=null!=t&&t.isDefined()?t.getModel():void 0;return n?n.getDisplayName(e):void 0}),[e])}},257185:(e,t,n)=>{n.d(t,{y:()=>i().y});var i=()=>n(949489)},953293:(e,t,n)=>{n.d(t,{R:()=>i().R});var i=()=>n(519454)},157955:(e,t,n)=>{n.r(t),n.d(t,{DEFAULT_MAX_RECURRENCE_DUPLICATION_PER_TASK:()=>A,MAXIMUM_DAILY_RECURRENCES_IN_PATH:()=>k,MAXIMUM_NESTED_RECURRENCE_LEVEL:()=>S,MAX_RECURRENCE_INTERVAL:()=>h,MAX_RECURRENCE_NUMBER_OF_RUNS:()=>y,RRULE_WEEKDAYS_MAP:()=>g,convertFromUnpersistedRecurrenceConfig:()=>F,convertToUnpersistedRecurrenceConfig:()=>B,getFormattedEndCondition:()=>w,getFormattedNextRecurrenceTime:()=>T,getNextDateUtc:()=>C,getRecurrenceAfter:()=>j,isRunningBetweenMidnightAnd3AM:()=>M,isValidRecurrenceInterval:()=>v,isValidRecurrenceNumberOfRuns:()=>x,rruleFromRecurrence:()=>b,templateAncestorsViolateRecurrenceNesting:()=>_});n(267602),n(653476),n(241792);var i=()=>n(730120);n(670560);function o(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(0===n.length)return e.map((e=>[e]));const r=[];for(const s of e)r.push(...o(n[0],...n.slice(1)).map((e=>[s,...e])));return r}var r=()=>n(696459),s=()=>n(326966),a=()=>n(803021),c=()=>n(646574),l=()=>n(998411),d=()=>n(578292);class u extends(()=>n(484885))().Ci{constructor(e,t){super(e,t)}after(e,t){return super.after(e,t)}}var p=()=>n(494616);const m=(0,n(788860).vU)({dateAtTime:{id:"automations.recurrenceHelpers.dateAtTime",defaultMessage:"{date} at {time}"},dateBetweenMidnightAnd3AM:{id:"automations.recurrenceHelpers.dateBetweenMidnightAnd3AM",defaultMessage:"{date} between 12–3 AM"},numberEndConditionDescription:{id:"automations.recurrenceHelpers.numberEndConditionDescription",defaultMessage:"{number, plural, one {After {number} run} other {After {number} runs}}"},noEndCondition:{id:"automations.recurrenceHelpers.noEndCondition",defaultMessage:"Never"}}),f={day:u.DAILY,week:u.WEEKLY,month:u.MONTHLY,year:u.YEARLY},g={MO:u.MO,TU:u.TU,WE:u.WE,TH:u.TH,FR:u.FR,SA:u.SA,SU:u.SU},h=99,y=999;function v(e){return(0,s().hj)(e)&&Number.isInteger(e)&&e>0&&e<=h}function x(e){return(0,s().hj)(e)&&Number.isInteger(e)&&e>0&&e<=y}function b(e){const{start_date:t,frequency:n,interval:i,weekdays:s,timezone:c,hour:l,minute:d}=e,p="week"===n&&s?s.map((e=>g[e])):void 0,m={};return(0,r().$K)(e.end_condition)&&("date"===e.end_condition.type?m.until=(0,a().pd)(e.end_condition.end_at):"number"===e.end_condition.type?m.count=e.end_condition.number_of_occurrences:(0,r().t1)(e.end_condition)),"month"===e.frequency&&(0,r().$K)(e.monthly_restriction)&&("monthdays"===e.monthly_restriction.type?m.bymonthday=e.monthly_restriction.monthdays:"weekdays_in_month"===e.monthly_restriction.type?m.byweekday=o(e.monthly_restriction.weekdays,e.monthly_restriction.week_numbers).map((e=>{let[t,n]=e;return g[t].nth(n)})):(0,r().t1)(e.monthly_restriction)),new u({freq:f[n],dtstart:(0,a().pd)(t),interval:i,byweekday:p,tzid:c,byhour:l??0,byminute:d??0,bysecond:0,...m})}const S=1,k=1;function _(e){var t;if(0===e.length)return{violatesConstraint:!1,templateNestingExceedsMaxDepth:!1,ancestorHasDailyTemplate:!1,nestedDepthOfAutomationAncestors:void 0,immediateAncestorRecurrenceType:void 0};const n=e.filter((e=>{var t;return"day"===(null===(t=e.getRecurrence())||void 0===t?void 0:t.frequency)})),i=e.length,o=null===(t=e[0].getRecurrence())||void 0===t?void 0:t.frequency,r=i>S,s=n.length>=k;return{violatesConstraint:r||s,templateNestingExceedsMaxDepth:r,ancestorHasDailyTemplate:s,nestedDepthOfAutomationAncestors:i,immediateAncestorRecurrenceType:o}}function j(e){const{recurrence:t,afterDate:n}=e;if((0,p().nA)(t)){const e=(0,a().kq)(n);return t.start_date>=e?new Date(t.start_date):void 0}{const e=b(t).after((0,a().pd)(n));if(!e)return;return(0,a().YL)(e)}}function M(e){return 0===e.hour||1===e.hour||2===e.hour}function C(e){return b(e).after((0,a().pd)((0,a().Jh)()))||void 0}function T(e){const{recurrence:t,intl:n}=e,o=C(F(t));if(!o)return;const r=M(t),s=i().ou.fromJSDate(o).toUTC().setZone("local",{keepLocalTime:!0}).setLocale((0,d().E2)(n)).setZone(t.timezone),a=(0,c().p6)({date:s,dateFormat:"relative",allowRelativeDates:!0,intl:n,shortenDate:!0});if(r)return n.formatMessage(m.dateBetweenMidnightAnd3AM,{date:a});{let e=s.toLocaleString(i().ou.TIME_SIMPLE);return t.timezone!==(0,l().r)()&&(e+=` ${s.toFormat("ZZZZ")}`),n.formatMessage(m.dateAtTime,{date:a,time:e})}}function w(e,t){return(0,r().$K)(e)?"number"===e.type?t.formatMessage(m.numberEndConditionDescription,{number:e.number_of_occurrences}):"date"===e.type?(0,c().p6)({date:i().ou.fromMillis(e.end_at),dateFormat:"relative",allowRelativeDates:!0,intl:t,shortenDate:!0}):void(0,r().t1)(e):t.formatMessage(m.noEndCondition)}const A=100;function B(e){return{...e,start_date:(0,a().kq)(e.start_date),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?{type:"date",end_at:(0,a().kq)(e.end_condition.end_at)}:(0,r().t1)(e.end_condition):void 0}}function I(e,t){const n=i().ou.fromMillis(t.end_at).set({hour:e.hour??0,minute:e.minute??0});return{type:"date",end_at:(0,a().Jh)(n.toJSDate())}}function F(e){return{...e,start_date:(0,a().Jh)(new Date(e.start_date)),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?I(e,e.end_condition):(0,r().t1)(e.end_condition):void 0}}},578698:(e,t,n)=>{n.d(t,{U:()=>o});n(667294);var i=n(785893);const o=(0,n(827282).IU)("list",{viewBox:"0 0 64 64",svg:(0,i.jsx)("path",{d:"m56,13v6H22v-6h34Zm-34,22h34v-6H22v6Zm0,16h34v-6H22v6ZM12,12c-2.21,0-4,1.79-4,4s1.79,4,4,4,4-1.79,4-4-1.79-4-4-4Zm0,16c-2.21,0-4,1.79-4,4s1.79,4,4,4,4-1.79,4-4-1.79-4-4-4Zm0,16c-2.21,0-4,1.79-4,4s1.79,4,4,4,4-1.79,4-4-1.79-4-4-4Z"})})},519454:(e,t,n)=>{n.d(t,{R:()=>o});n(667294);var i=n(785893);const o=(0,n(827282).IU)("pencil",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M3.926 13.307H14.11c.183 0 .34-.066.472-.199a.644.644 0 00.198-.471.652.652 0 00-.198-.479.644.644 0 00-.472-.198H5.272l-1.346 1.347zm-.704-.636l7.683-7.684-1.312-1.319-7.69 7.684-.67 1.606c-.037.1-.017.191.06.273.083.082.174.105.274.069l1.655-.63zm8.34-8.326l.738-.732c.182-.187.278-.376.287-.567.009-.192-.068-.374-.232-.547l-.267-.267c-.169-.168-.351-.246-.547-.232-.196.014-.385.11-.567.287l-.739.732 1.327 1.326z"})})}}]);