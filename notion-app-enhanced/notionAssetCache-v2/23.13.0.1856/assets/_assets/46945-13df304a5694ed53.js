"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[46945],{657581:(e,t,n)=>{n.d(t,{E:()=>l});n(667294);var o=()=>n(219727),i=()=>n(846550),r=()=>n(223506),a=n(785893);function l(e){const{isMobile:t}=(0,o().Fy)(),n=(0,i().Fg)();return(0,a.jsx)(r().E,{...e,theme:n,isMobile:t})}},486896:(e,t,n)=>{n.d(t,{$:()=>p,Z:()=>d});n(267602),n(653476);var o=n(667294),i=()=>n(219727),r=()=>n(142735),a=()=>n(594546),l=()=>n(637118),s=n(785893);const u=(0,o.createContext)({collectionStore:void 0,currentDraggingActionId:void 0,disabled:!0,maybePersistedTransactionActions:{createAndCommit:n(359620).U},editorPlacement:{type:"inline"},editorWidth:300,suppressActionErrors:[],collapsedActionIds:[],hideDragHandle:!1,cantSaveDueToError:!1,toggleActionIdCollapsed:()=>{}});function p(e){const t=(0,i().O7)(),{automationStore:n}=(0,l().YC)(),p=(0,r().VK)((()=>n.getActionIds()),[n]),[d,c]=(0,o.useReducer)(((e,o)=>{const i=e.includes(o);return(0,a().j)({environment:t,event:{eventName:"automation_action_collapse_toggle",eventProperties:{collapsed:!i,automation_action_id:o,automation_id:n.id}}}),i?e.filter((e=>e!==o)):[...e,o]}),e.defaultCollapseActions?p:[]);return(0,s.jsx)(u.Provider,{value:{...e.value,collapsedActionIds:d,toggleActionIdCollapsed:c},children:e.children})}u.displayName="AutomationEditorContext";const d=u},552245:(e,t,n)=>{n.d(t,{Z:()=>m});n(267602),n(228244),n(667294);var o=()=>n(219727),i=()=>n(142735),r=()=>n(788860),a=()=>n(696459),l=()=>n(308186),s=()=>n(269299),u=()=>n(932753),p=()=>n(887430),d=()=>n(125659),c=n(785893);function m(){const e=(0,d().DK)(),t=(0,o().O7)(),n=(0,i().VK)((()=>null==e?void 0:e.settingsStore),[e]);return function(o){if(!n||!o||!e)return;const i=e.collectionStore();if((0,a().$K)(i)){const e=p().D8({deletedSchema:i.getDeletedSchema(),property:o});if(e){var d;if("verification"===(null===(d=i.getDeletedSchema()[o])||void 0===d?void 0:d.type)){const e=i.getSchema(),t=Object.keys(e).some((t=>{var n;return"verification"===(null===(n=e[t])||void 0===n?void 0:n.type)}));if(t)return void l().vC({message:(0,c.jsx)(r()._H,{id:"deletedPropertyMenu.cannotRestoreDuplicateProperty.modal.verification",defaultMessage:"You can only have one verification property."}),showCancel:!1,keepFocus:!0,items:[{label:(0,c.jsx)(r()._H,{id:"deletedPropertyMenu.cannotRestoreDuplicateProperty.modal.dismissButton",defaultMessage:"Dismiss"}),onAccept:()=>{}}]})}s().createAndCommit({userAction:"deletedPropertyMenu.handleRestoreDeletedPropertyClick",environment:t,canUndo:!0,perform:n=>{u().xO({environment:t,collectionStore:i,update:e.updateSchema,transaction:n}),u().$N({collectionStore:i,update:e.updateDeletedSchema,transaction:n})}})}}}}},359620:(e,t,n)=>{n.d(t,{U:()=>h,$:()=>v});n(821057);var o=n(667294),i=()=>n(219727),r=()=>n(142735),a=()=>n(494616),l=()=>n(696459),s=()=>n(269299),u=(n(267602),n(228244),()=>n(922713)),p=()=>n(513670),d=()=>n(826955);function c(e,t){var n,o;const i=null==e?void 0:e.getModel(),r=null==t?void 0:t.getModel();if(!t||!r)return!0;return!(!i||(null===(n=i.getProperties())||void 0===n?void 0:n.name)===(null===(o=r.getProperties())||void 0===o?void 0:o.name))||(!!function(e,t){const n=null==e?void 0:e.getModel(),o=t.getModel();if(!o)return!0;if((0,l().$K)(n)){if(n.isEventType()&&o.isEventType()||n.isNotificationType()&&o.isNotificationType()){const e=n.getEventConfiguration(),t=o.getEventConfiguration();return!(0,p().Xy)(e,t)}if(n.isRecurrenceType()&&o.isRecurrenceType()){const e=n.getRecurrence(),t=o.getRecurrence();return!(0,p().Xy)(e,t)}return!n.isButtonType()||!o.isButtonType()}if(o.isEventType()||o.isNotificationType()){const e=o.getEventConfiguration();return!1!==e.pagesAdded||"none"!==e.pagePropertiesEdited.type}if(o.isRecurrenceType())return!0;if(o.isButtonType())return!1;(0,l().t1)(o)}(e,t)||!!function(e,t){const n=t.getSpaceId();if(!n)return!1;if((0,l().$K)(e)){const o=e.getActionIds(),i=t.getActionIds();return o.length!==i.length||!(0,p().Xy)(o,i)||o.some((o=>{const i={id:o,spaceId:n,table:u().Xj},r=d().zq.createChildStore(e,i).getModel(),a=d().zq.createChildStore(t,i).getModel();return!(0,l().$K)(r)||!(0,l().$K)(a)||!(0,p().Xy)(r.getConfig(),a.getConfig())}))}return t.getActionIds().length>0}(e,t))}var m=()=>n(718959),y=()=>n(757590),f=()=>n(142109),x=()=>n(728243),g=()=>n(876822);function h(e){const t=new(y().Y)({deadlockTimeoutMs:s().DEADLOCK_WARNING_TIMEOUT_MS});return{performResult:e.perform(t),serverCommitResult:Promise.resolve()}}function v(e){const{automationId:t,spaceId:n,defaultValue:u,persist:p}=e,y=(0,i().O7)(),h=(0,r().VK)((()=>{var e;return null===(e=g().default.state.currentUserStore)||void 0===e?void 0:e.userId}),[]),v=(0,o.useMemo)((()=>{if(t&&n)return{id:t,table:a().cv,spaceId:n}}),[t,n]),b=(0,f().$)("useUnpersistedAutomationStore",{cacheFallback:y.defaultRecordCache.inMemoryRecordCache,isTemporaryData:!0}),k=(0,o.useMemo)((()=>{if(!v)return;const e=b.getEntry({pointer:v,userId:h});if(!(0,l().$K)(e)&&h){if(!u)throw new Error("create is true but no defaultValue provided");b.setRecord({pointer:v,userId:h},{role:"editor",value:u})}return new(d().Mz)(y,v,{inMemoryRecordCache:b})}),[u,y,v,b,h]),C=(0,r().VK)((()=>{const e=m().np();if(v&&e)return d().Mz.createChildStore(e,v)}),[v]),I=p?C:k,S=(0,r().VK)((()=>!p&&c(C,k)),[p,C,k]),{createAndCommit:M}=(0,x().Z)({unpersistedInMemoryRecordCache:b}),T=(0,o.useCallback)((e=>p?s().createAndCommit({...e,environment:y}):M(e)),[M,y,p]);return{maybePersistedTransactionActions:{createAndCommit:T},maybePersistedAutomationStore:I,hasUnpersistedChanges:S}}},418297:(e,t,n)=>{n.d(t,{a:()=>Tt});n(670560),n(267602),n(653476),n(30005),n(241792);var o=n(667294),i=()=>n(219727),r=()=>n(142735),a=()=>n(846550),l=()=>n(756191),s=()=>n(414853),u=()=>n(177634),p=()=>n(998411),d=()=>n(565630),c=()=>n(375255),m=()=>n(955620),y=()=>n(788860),f=()=>n(513670),x=()=>n(855741),g=()=>n(696459),h=()=>n(707513),v=()=>n(959137),b=()=>n(990966),k=()=>n(141735),C=()=>n(594546),I=()=>n(57687),S=()=>n(191003),M=()=>n(677559),T=()=>n(876822),w=()=>n(127519),F=()=>n(719157),j=()=>n(94967),A=()=>n(956057),P=()=>n(741633),E=()=>n(956898),D=()=>n(824462),B=()=>n(308186),R=()=>n(970105),V=()=>n(269299);var N=()=>n(785673),_=()=>n(212493),U=()=>n(154186),K=()=>n(206352),L=()=>n(291198),Z=()=>n(661641),G=n(785893);const O=o.memo((function(e){const{formulaAssistantStore:t,onStop:n,onSubmit:i}=e,l=(0,y().YB)(),{prompt:s,inputMode:u}=(0,r().VK)((()=>{const{state:e}=t;return{prompt:e.prompt,inputMode:e.inputMode}}),[t]),p=(0,o.useCallback)((()=>{i(t.state.prompt)}),[t,i]),d=(0,o.useCallback)((e=>{t.update((t=>({...t,prompt:e})))}),[t]),c=(0,a().yK)((e=>({icon:{height:16,width:16,fill:e.icon.primary},wrapper:{borderTop:`1px solid ${e.stroke.secondary}`,background:e.popoverBackground}})),[]);return(0,G.jsx)(K().Z,{capture:!0,debugName:"FormulaAssistantInput",priority:1,children:(0,G.jsxs)(_().jX,{direction:"row",align:"top-left",gap:6,padding:"9px 12px",style:c.wrapper,children:[(0,G.jsx)(_().jX,{width:20,height:28,align:"center",children:(0,G.jsx)(N().h9,{})}),(0,G.jsx)(_().jX,{width:"fill",children:"busy"===u?(0,G.jsx)($,{}):(0,G.jsx)(Z().q,{styleName:"Body-14px/Regular",children:(0,G.jsx)(K().Z,{debugName:"FormulaAssistantInput_PromptInput",capture:!0,allowMenuList:!1,allowEsc:!0,children:(0,G.jsx)(L().Z,{format:L().B.Transparent,placeholder:l.formatMessage(X(u)),selectAll:!1,value:s,textarea:!0,textareaSubmitOnEnter:!0,autosize:!0,style:{minHeight:28,paddingTop:5,paddingBottom:3},onSubmit:e=>{s&&(e.stopPropagation(),p())},onChange:e=>{d(e.target.value)},focusInitial:!0})})})}),"busy"===u?(0,G.jsx)(H,{onStop:n}):(0,G.jsx)(W,{onSubmit:p,isEnabled:s.length>0})]})})}));function H(e){const{onStop:t}=e,n=(0,y().YB)(),{isPhone:o}=(0,i().Fy)(),r=(0,a().yK)((e=>({lightweightButton:{display:"flex",alignItems:"baseline",justifyContent:"center",fontSize:14,padding:"5px 8px",borderRadius:4,color:e.mediumTextColor,height:32,marginTop:2},keyboardShortcut:{textTransform:"uppercase",fontWeight:500,fontSize:11,marginLeft:6,color:e.lightTextColor,display:o?"none":void 0}})),[o]);return(0,G.jsx)(j().Z,{debugName:"FormulaAssistantInput_StopButton",capture:!0,onEnter:t,onEsc:t,priority:1,children:(0,G.jsx)(_().jX,{width:"hug",height:28,align:"center",children:(0,G.jsxs)(U().Z,{style:r.lightweightButton,onClick:t,children:[n.formatMessage(Y.cancel),(0,G.jsx)("span",{style:r.keyboardShortcut,children:n.formatMessage(Y.cancelShortcut)})]})})})}function W(e){const{isEnabled:t,onSubmit:o}=e;return(0,G.jsx)(_().jX,{width:"hug",height:28,align:"center",children:(0,G.jsx)(n(36763).O,{onSubmit:o,canSend:t})})}function $(){const e=(0,y().YB)();return(0,G.jsxs)(_().jX,{direction:"row",gap:6,height:28,align:"center-left",children:[(0,G.jsx)(Z().q,{styleName:"Body-14px/Regular",colorName:"secondary",children:e.formatMessage(Y.assistantIsBusy)}),(0,G.jsx)(n(292518).Z,{isTriColored:!0})]})}function X(e){switch(e){case"initial":return Y.initialPlaceholder;case"followUp":case"busy":return Y.subsequentPlaceholder;default:(0,g().t1)(e)}}const Y=(0,y().vU)({cancel:{id:"formulaAssistantInput.cancel",defaultMessage:"Cancel"},cancelShortcut:{id:"formulaAssistantInput.cancelShortcut",defaultMessage:"esc"},initialPlaceholder:{id:"formulaAssistantInput.initialPlaceholder",defaultMessage:"What do you want the formula to do?"},subsequentPlaceholder:{id:"formulaAssistantInput.subsequentPlaceholder",defaultMessage:"What do you want to do next?"},assistantIsBusy:{id:"formulaAssistantInput.assistantIsBusy",defaultMessage:"Notion AI is writing"}});class z extends(()=>n(263184))().default{constructor(){super(...arguments),this.hideAssistant=()=>{this.update((e=>({...e,isAssistantVisible:!1})))},this.toggleAssistantVisible=()=>{this.update((e=>({...e,isAssistantVisible:!e.isAssistantVisible})))},this.didBeginRequest=()=>{this.update((e=>({...e,inputMode:"busy"})))},this.didFinishRequest=()=>{this.update((e=>({...e,prompt:"",inputMode:"followUp"})))}}getInitialState(){return{id:A().Il(),inputMode:"initial",isAssistantVisible:!1,prompt:""}}}var q=()=>n(766933),Q=()=>n(92960),J=()=>n(193962),ee=()=>n(93532);const te={true:{name:"true",type:{type:"checkbox"},description:J().Gw.true,examples:[{input:"true"},{input:[(0,ee().h0)("Checked"),[" == true"]]}]},false:{name:"false",type:{type:"checkbox"},description:J().Gw.false,examples:[{input:"false"},{input:[(0,ee().h0)("Checked"),[" == false"]]}]},and:{name:"and",type:{type:"checkbox"},description:J().Gw.and,examples:[{input:"3 > 2 and 2 > 3",output:"false"},{input:[(0,ee().h0)("Naughty"),[" && "],(0,ee().h0)("Nice")]}]},or:{name:"or",type:{type:"checkbox"},description:J().Gw.or,examples:[{input:"3 > 2 or 2 > 3",output:"true"},{input:[(0,ee().h0)("Naughty"),[" || "],(0,ee().h0)("Nice")]}]},not:{name:"not",type:{type:"checkbox"},description:J().Gw.not,examples:[{input:"not true",output:"false"},{input:"not (2 > 3)",output:"true"},{input:[["!"],(0,ee().h0)("Checked")]}]},"+":{name:"+",type:{type:"number"},description:J().Gw["+"],examples:[{input:"3 + 2",output:"5"},{input:"add(-1, 2)",output:"1"}]},"-":{name:"-",type:{type:"number"},description:J().Gw["-"],examples:[{input:"3 - 2",output:"1"},{input:"subtract(-1, 2)",output:"-3"}]},"*":{name:"*",type:{type:"number"},description:J().Gw["*"],examples:[{input:"3 * 2",output:"6"},{input:"multiply(-1, 2)",output:"-2"}]},"/":{name:"/",type:{type:"number"},description:J().Gw["/"],examples:[{input:"3 / 2",output:"1.5"},{input:"divide(-1, 2)",output:"-0.5"}]},"%":{name:"%",type:{type:"number"},description:J().Gw["%"],examples:[{input:"3 % 2",output:"1"},{input:"mod(-1, 2)",output:"-1"}]},"^":{name:"^",type:{type:"number"},description:J().Gw["^"],examples:[{input:"3 ^ 2",output:"9"},{input:"pow(-1, 2)",output:"1"}]},"==":{name:"==",type:{type:"checkbox"},description:J().Gw["=="],examples:[{input:"3 == 2",output:"false"},{input:'equal("A", "A")',output:"true"}]},"!=":{name:"!=",type:{type:"checkbox"},description:J().Gw["!="],examples:[{input:"3 != 2",output:"true"},{input:'unequal("A", "A")',output:"false"}]},">":{name:">",type:{type:"checkbox"},description:J().Gw[">"],examples:[{input:"3 > 2",output:"true"},{input:'now() > parseDate("2040-01-01")',output:"false"}]},"<":{name:"<",type:{type:"checkbox"},description:J().Gw["<"],examples:[{input:"3 < 2",output:"false"},{input:'now() < parseDate("2040-01-01")',output:"true"}]},">=":{name:">=",type:{type:"checkbox"},description:J().Gw[">="],examples:[{input:"3 >= 2",output:"true"},{input:'now() >= parseDate("2040-01-01")',output:"false"}]},"<=":{name:"<=",type:{type:"checkbox"},description:J().Gw["<="],examples:[{input:"3 <= 2",output:"false"},{input:'now() <= parseDate("2040-01-01")',output:"true"}]}};var ne=()=>n(527278),oe=()=>n(352230),ie=()=>n(692304),re=()=>n(178498),ae=()=>n(827973),le=()=>n(448419),se=()=>n(198829),ue=()=>n(255577),pe=()=>n(388284),de=()=>n(332143);const ce=(0,y().vU)({property:{id:"formula2Input.propertyHelper.descriptionGeneric",defaultMessage:"Database property."},titlePropertyDescription:{id:"formulaLibrary.property.title.description",defaultMessage:"Title property."},textPropertyDescription:{id:"formulaLibrary.property.text.description",defaultMessage:"Text property."},urlPropertyDescription:{id:"formulaLibrary.property.url.description",defaultMessage:"URL property."},emailPropertyDescription:{id:"formulaLibrary.property.email.description",defaultMessage:"Email property."},phoneNumberPropertyDescription:{id:"formulaLibrary.property.phoneNumber.description",defaultMessage:"Phone number property."},selectPropertyDescription:{id:"formulaLibrary.property.select.description",defaultMessage:"Select property."},multiSelectPropertyDescription:{id:"formulaLibrary.property.multiSelect.description",defaultMessage:"Multi-select property, list."},statusPropertyDescription:{id:"formulaLibrary.property.status.description",defaultMessage:"Status property."},checkboxPropertyDescription:{id:"formulaLibrary.property.checkbox.description",defaultMessage:"Checkbox property."},datePropertyDescription:{id:"formulaLibrary.property.date.description",defaultMessage:"Date property."},personPropertyDescription:{id:"formulaLibrary.property.person.description",defaultMessage:"Person property, list."},relationPropertyDescription:{id:"formulaLibrary.property.relation.description",defaultMessage:"Relation property, list."},rollupPropertyDescriptionList:{id:"formulaLibrary.property.rollup.description",defaultMessage:"Rollup property, list."},rollupPropertyDescription:{id:"formulaLibrary.property.rollup.descriptionWithList",defaultMessage:"Rollup property."},numberPropertyDescription:{id:"formulaLibrary.property.number.description",defaultMessage:"Number property."},formulaPropertyDescription:{id:"formulaLibrary.property.formula.description",defaultMessage:"Formula property."},formulaPropertyDescriptionList:{id:"formulaLibrary.property.formula.descriptionWithList",defaultMessage:"Formula property, list."},createdTimePropertyDescription:{id:"formulaLibrary.property.createdTime.description",defaultMessage:"Created time property."},lastEditedTimePropertyDescription:{id:"formulaLibrary.property.lastEditedTime.description",defaultMessage:"Last edited time property."},createdByPropertyDescription:{id:"formulaLibrary.property.createdBy.description",defaultMessage:"Created by property."},lastEditedByPropertyDescription:{id:"formulaLibrary.property.lastEditedBy.description",defaultMessage:"Last edited by property."},filePropertyDescription:{id:"formulaLibrary.property.file.description",defaultMessage:"File property, list."},autoincrementIdDescription:{id:"formulaLibrary.property.autoincrementId.description",defaultMessage:"ID property."}}),me={title:{name:"title",type:{type:"text"},description:ce.titlePropertyDescription,examples:e=>e?[{input:[(0,ee().ac)(e)],isCopyable:!0},{input:[(0,ee().ac)(e),['.style("b")']],isCopyable:!0},{input:[(0,ee().h0)("Full Name"),['.split(" ").at(0)']]}]:[{input:[(0,ee().h0)("Title")]},{input:[(0,ee().h0)("Title"),['.style("b")']]},{input:[(0,ee().h0)("Name"),['.split(" ").at(0)']]}]},text:{name:"text",type:{type:"text"},description:ce.textPropertyDescription,examples:e=>e?[{input:[(0,ee().ac)(e)],isCopyable:!0},{input:[["upper("],(0,ee().ac)(e),[")"]],isCopyable:!0},{input:[(0,ee().ac)(e),['.style("b", "red")']],isCopyable:!0}]:[{input:[["upper("],(0,ee().h0)("Name"),[")"]]},{input:[(0,ee().h0)("Name"),['.style("b", "red")']]}]},url:{name:"url",type:{type:"text"},description:ce.urlPropertyDescription,examples:e=>e?[{input:[(0,ee().ac)(e)],isCopyable:!0},{input:[(0,ee().ac)(e),[' ? link("Link", '],(0,ee().ac)(e),[').style("green") : ""']],isCopyable:!0}]:[{input:[(0,ee().h0)("URL"),[' ? link("Link", '],(0,ee().h0)("URL"),[').style("green") : ""']]}]},email:{name:"email",type:{type:"text"},description:ce.emailPropertyDescription,examples:e=>e?[{input:[(0,ee().ac)(e)],isCopyable:!0},{input:[(0,ee().ac)(e),[' ? link("Email", "mailto:" + '],(0,ee().ac)(e),[').style("blue") : ""']],isCopyable:!0}]:[{input:[(0,ee().h0)("Email"),[' ? link("Email", "mailto:" + '],(0,ee().h0)("Email"),[').style("blue") : ""']]}]},phone_number:{name:"phone_number",type:{type:"text"},description:ce.phoneNumberPropertyDescription,examples:e=>e?[{input:[(0,ee().ac)(e)],isCopyable:!0},{input:[(0,ee().ac)(e),[' ? link("Call", "tel:" + '],(0,ee().ac)(e),[').style("blue") : ""']],isCopyable:!0}]:[{input:[(0,ee().h0)("Email"),[' ? link("Call", "tel:" + '],(0,ee().h0)("Email"),[').style("blue") : ""']]}]},number:{name:"number",type:{type:"number"},description:ce.numberPropertyDescription,examples:e=>e?[{input:[(0,ee().ac)(e)],isCopyable:!0},{input:[(0,ee().ac)(e),[" / 2"]],isCopyable:!0},{input:[["pi() * "],(0,ee().ac)(e),[" ^ 2"]],isCopyable:!0}]:[{input:[(0,ee().h0)("Cost"),[" / "],(0,ee().h0)("Total Units")]},{input:[["pi() * "],(0,ee().h0)("Radius"),[" ^ 2"]]}]},select:{name:"select",type:{type:"text"},description:ce.selectPropertyDescription,examples:e=>{const t=[{input:[(0,ee().h0)("Priority"),[' == "High"']]},{input:[['["Feature", "Bug"].includes('],(0,ee().h0)("Task Type"),[")"]]}];return e&&t.unshift({input:[(0,ee().ac)(e)],isCopyable:!0}),t}},multi_select:{name:"select",type:{type:"array",of:{type:"text"}},description:ce.multiSelectPropertyDescription,examples:e=>e?[{input:[(0,ee().ac)(e)],isCopyable:!0},{input:[(0,ee().ac)(e),[".length()"]],isCopyable:!0},{input:[(0,ee().h0)("Tags"),['.includes("Finance")']]}]:[{input:[(0,ee().h0)("Tags"),[".length()"]]},{input:[(0,ee().h0)("Tags"),['.includes("Finance")']]}]},status:{name:"status",type:{type:"text"},description:ce.statusPropertyDescription,examples:e=>"Status"===(null==e?void 0:e.name)?[{input:[(0,ee().ac)(e)],isCopyable:!0},{input:[(0,ee().ac)(e),[' == "Done"']],isCopyable:!0},{input:[['["Not started", "In progress"].includes('],(0,ee().ac)(e),[")"]],isCopyable:!0}]:[{input:[(0,ee().h0)("Status"),[' == "Done"']]},{input:[['["Not started", "In progress"].includes('],(0,ee().h0)("Status"),[")"]]}]},checkbox:{name:"checkbox",type:{type:"checkbox"},description:ce.checkboxPropertyDescription,examples:e=>e?[{input:[(0,ee().ac)(e)],isCopyable:!0},{input:[["not "],(0,ee().ac)(e)],isCopyable:!0},{input:[(0,ee().h0)("Signed"),[" and "],(0,ee().h0)("Sealed"),[" and "],(0,ee().h0)("Delivered")]}]:[{input:[["not"],(0,ee().h0)("Done")]},{input:[(0,ee().h0)("Signed"),[" and "],(0,ee().h0)("Sealed"),[" and "],(0,ee().h0)("Delivered")]}]},date:{name:"date",type:{type:"date"},description:ce.datePropertyDescription,examples:e=>e?[{input:[(0,ee().ac)(e)],isCopyable:!0},{input:[(0,ee().ac)(e),[" > now()"]],isCopyable:!0},{input:[(0,ee().ac)(e),['.dateAdd(1, "weeks")']],isCopyable:!0},{input:[["dateBetween("],(0,ee().ac)(e),[', now(), "days")']],isCopyable:!0}]:[{input:[(0,ee().h0)("Due Date"),[" > now()"]]},{input:[["formatDate("],(0,ee().h0)("Date"),[', "YYYY/MM/DD HH:mm")']]},{input:[["dateBetween("],(0,ee().h0)("Birthday"),[', now(), "days")']]}]},person:{name:"person",type:{type:"array",of:{type:"text"}},description:ce.personPropertyDescription,examples:e=>e?[{input:[(0,ee().ac)(e)],isCopyable:!0},{input:[(0,ee().ac)(e),[".length()"]],isCopyable:!0},{input:[(0,ee().ac)(e),[".at(0)"]],isCopyable:!0},{input:[(0,ee().ac)(e),[".map(current.email())"]],isCopyable:!0},{input:[(0,ee().ac)(e),['.some(current.name() == "Alice")']]}]:[{input:[(0,ee().h0)("Participants"),[".at(0)"]]},{input:[(0,ee().h0)("Participants"),[".length()"]]},{input:[(0,ee().h0)("Participants"),['.some(current.name() == "Alice")']]}]},relation:{name:"relation",type:{type:"array",of:{type:"block"}},description:ce.relationPropertyDescription,examples:e=>e?[{input:[(0,ee().ac)(e)],isCopyable:!0},{input:[(0,ee().ac)(e),[".length()"]],isCopyable:!0},{input:[(0,ee().h0)("Tasks"),[".filter(current."],(0,ee().h0)("Status"),[' != "Done")']]}]:[{input:[(0,ee().h0)("Tasks"),[".length()"]]},{input:[(0,ee().h0)("Tasks"),[".filter(current."],(0,ee().h0)("Status"),[' != "Done")']]}]},rollup:{name:"rollup",type:e=>{if("rollup"===(null==e?void 0:e.type)&&("show_unique"===e.aggregation||void 0===e.aggregation))return{type:"array",of:{type:"unknown"}};if(e&&"aggregation"in e&&void 0!==e.aggregation){return{type:(0,de().W6)((0,de().gu)(e.aggregation))}}return{type:"unknown"}},description:e=>"rollup"!==(null==e?void 0:e.type)||"show_unique"!==e.aggregation&&void 0!==e.aggregation?ce.rollupPropertyDescription:ce.rollupPropertyDescriptionList,examples:(e,t)=>{let n;return n=!t||"rollup"!==(null==t?void 0:t.type)||"show_unique"!==t.aggregation&&void 0!==t.aggregation?[{input:[(0,ee().h0)("Average cost"),[" * 12"]]},{input:[(0,ee().h0)("Sum of customers"),[" > 100"]]}]:[void 0!==e?{input:[(0,ee().ac)(e),[".length()"]],isCopyable:!0}:{input:[(0,ee().h0)("Purchases"),[".length()"]]},{input:[["sum("],(0,ee().h0)("Purchases"),[".map(current."],(0,ee().h0)("Cost"),["))"]]}],e&&n.unshift({input:[(0,ee().ac)(e)],isCopyable:!0}),n}},file:{name:"file",type:{type:"array",of:{type:"text"}},description:ce.filePropertyDescription,examples:e=>e?[{input:[(0,ee().ac)(e)],isCopyable:!0},{input:[(0,ee().ac)(e),[".length()"]],isCopyable:!0},{input:[(0,ee().ac)(e),['.filter(current.match(".pdf$"))']],isCopyable:!0},{input:[(0,ee().ac)(e),['.map(link("File", current))']],isCopyable:!0}]:[{input:[(0,ee().h0)("Attachments"),[".length()"]]},{input:[(0,ee().h0)("Attachments"),['.filter(current.match(".pdf$"))']]},{input:[(0,ee().h0)("Attachments"),['.map(link("File", current))']]}]},formula:{name:"formula",type:e=>{var t,n,o;return e&&"formula2"in e&&null!==(t=e.formula2)&&void 0!==t&&null!==(t=t.result_type)&&void 0!==t&&t.type?e.formula2.result_type:e&&"formula"in e&&null!==(n=e.formula)&&void 0!==n&&n.result_type?{type:null===(o=e.formula)||void 0===o?void 0:o.result_type}:{type:"unknown"}},description:e=>{var t;return e&&"formula2"in e&&"array"===(null===(t=e.formula2)||void 0===t||null===(t=t.result_type)||void 0===t?void 0:t.type)?ce.formulaPropertyDescriptionList:ce.formulaPropertyDescription},examples:(e,t)=>{var n,o;let i={type:"unknown"};if(t&&"formula2"in t&&null!==(n=t.formula2)&&void 0!==n&&null!==(n=n.result_type)&&void 0!==n&&n.type)i=t.formula2.result_type;else if(t&&"formula"in t&&null!==(o=t.formula)&&void 0!==o&&o.result_type){var r;i={type:null===(r=t.formula)||void 0===r?void 0:r.result_type}}if(!e)return[];const a=[{input:[(0,ee().ac)(e)],isCopyable:!0}];switch(i.type){case"array":switch(a.push({input:[(0,ee().ac)(e),[".length()"]],isCopyable:!0}),i.of.type){case"text":a.push({input:[(0,ee().ac)(e),['.join("\\n")']],isCopyable:!0});break;case"number":a.push({input:[(0,ee().ac)(e),[".sum()"]],isCopyable:!0});break;case"date":a.push({input:[(0,ee().ac)(e),['.map(dateBetween(now(), current, "days"))']],isCopyable:!0});break;case"person":a.push({input:[(0,ee().ac)(e),[".map(current.name())"]],isCopyable:!0}),a.push({input:[(0,ee().ac)(e),[".some(current.name() == 'Alice')"]],isCopyable:!0});break;case"checkbox":a.push({input:[(0,ee().ac)(e),[".every(current == true)"]],isCopyable:!0});break;case"block":a.push({input:[(0,ee().h0)("Primary Tasks"),[".filter(current."],(0,ee().h0)("Status"),[' == "Done")']]})}break;case"number":a.push({input:[(0,ee().ac)(e),[" * 2 > 100"]],isCopyable:!0});break;case"text":a.push({input:[(0,ee().ac)(e),[".upper()"]],isCopyable:!0});break;case"date":a.push({input:[(0,ee().ac)(e),[" > now()"]],isCopyable:!0});break;case"person":a.push({input:[(0,ee().ac)(e),[".name()"]],isCopyable:!0});break;case"checkbox":a.push({input:[["not "],(0,ee().ac)(e)],isCopyable:!0});break;case"block":a.push({input:[(0,ee().ac)(e),[".map(current."],(0,ee().um)(Q().FormulaTokenSupportedBlockSystemProperty.CreatedBy),[")"]]})}return a}},created_time:{name:"created_time",type:{type:"date"},description:ce.createdTimePropertyDescription,examples:e=>e?[{input:[(0,ee().ac)(e)],isCopyable:!0},{input:[(0,ee().ac)(e),['.dateAdd(1, "weeks")']],isCopyable:!0},{input:[(0,ee().ac)(e),[' > dateSubtract(now(), 1, "years")']],isCopyable:!0}]:[{input:[(0,ee().um)(Q().FormulaTokenSupportedBlockSystemProperty.CreatedTime),['.dateAdd(1, "weeks")']]},{input:[(0,ee().um)(Q().FormulaTokenSupportedBlockSystemProperty.CreatedTime),[' > dateSubtract(now(), 1, "years")']]}]},last_edited_time:{name:"last_edited_time",type:{type:"date"},description:ce.lastEditedTimePropertyDescription,examples:e=>e?[{input:[(0,ee().ac)(e)],isCopyable:!0},{input:[(0,ee().ac)(e),['.dateAdd(1, "weeks")']],isCopyable:!0},{input:[(0,ee().ac)(e),[' > dateSubtract(now(), 1, "month")']],isCopyable:!0}]:[{input:[(0,ee().um)(Q().FormulaTokenSupportedBlockSystemProperty.LastEditedTime),['.dateAdd(1, "weeks")']]},{input:[(0,ee().um)(Q().FormulaTokenSupportedBlockSystemProperty.LastEditedTime),[' > dateSubtract(now(), 1, "month")']]}]},created_by:{name:"created_by",type:{type:"person"},description:ce.createdByPropertyDescription,examples:e=>e?[{input:[(0,ee().ac)(e)],isCopyable:!0},{input:[(0,ee().ac)(e),[".name()"]],isCopyable:!0},{input:[(0,ee().ac)(e),[".email()"]],isCopyable:!0}]:[{input:[(0,ee().um)(Q().FormulaTokenSupportedBlockSystemProperty.CreatedBy),[".name()"]]},{input:[(0,ee().um)(Q().FormulaTokenSupportedBlockSystemProperty.CreatedBy),[".email()"]]}]},last_edited_by:{name:"last_edited_by",type:{type:"person"},description:ce.lastEditedByPropertyDescription,examples:e=>e?[{input:[(0,ee().ac)(e)],isCopyable:!0},{input:[(0,ee().ac)(e),[".name()"]],isCopyable:!0},{input:[(0,ee().ac)(e),[".email()"]],isCopyable:!0}]:[{input:[(0,ee().um)(Q().FormulaTokenSupportedBlockSystemProperty.LastEditedBy),[".name()"]]},{input:[(0,ee().um)(Q().FormulaTokenSupportedBlockSystemProperty.LastEditedBy),[".email()"]]}]},auto_increment_id:{name:"auto_increment_id",type:{type:"number"},description:ce.autoincrementIdDescription,examples:e=>e?[{input:[(0,ee().ac)(e)],isCopyable:!0},{input:[(0,ee().ac)(e),['.split("-").first() /* Prefix */']],isCopyable:!0},{input:[(0,ee().ac)(e),['.split("-").last().toNumber() /* ID */']],isCopyable:!0}]:[{input:[(0,ee().h0)("ID Code")]},{input:[(0,ee().h0)("Task ID"),['.split("-").first() /* Prefix */']],output:'"TASK"'},{input:[(0,ee().h0)("Task ID"),['.split("-").last().toNumber() /* ID */']],output:"123"}]},button:null,location:null,last_visited_time:null,verification:null},ye={text:{examples:e=>e?[{input:[(0,ee().o3)({id:e.id})]},{input:[["upper("],(0,ee().o3)({id:e.id}),[")"]]},{input:[(0,ee().o3)({id:e.id}),['.style("b", "red")']]}]:[]},number:{examples:e=>e?[{input:[(0,ee().o3)(e)],isCopyable:!0},{input:[(0,ee().o3)(e),[" / 2"]],isCopyable:!0},{input:[["pi() * "],(0,ee().o3)(e),[" ^ 2"]],isCopyable:!0}]:[]},checkbox:{examples:e=>e?[{input:[(0,ee().o3)(e)]},{input:[["not "],(0,ee().o3)(e)]}]:[]},date:{examples:e=>e?[{input:[(0,ee().o3)(e)]},{input:[(0,ee().o3)(e),[" > now()"]]},{input:[(0,ee().o3)(e),['.dateAdd(1, "weeks")']]},{input:[["dateBetween("],(0,ee().o3)(e),[', now(), "days")']]}]:[]},block:{examples:e=>e?[{input:[(0,ee().o3)(e)]},{input:[(0,ee().o3)(e),[".format()"]]},{input:[(0,ee().o3)(e),["."],(0,ee().um)(Q().FormulaTokenSupportedBlockSystemProperty.CreatedBy)]}]:[]},person:{examples:e=>e?[{input:[(0,ee().o3)(e)]},{input:[(0,ee().o3)(e),[".email()"]]},{input:[(0,ee().o3)(e),['.name() == "Alice"']]}]:[]},array:{examples:e=>e?[{input:[(0,ee().o3)(e)]},{input:[(0,ee().o3)(e),[".length()"]]},{input:[(0,ee().o3)(e),[".at(0).format()"]]}]:[]},select:null,function:null,unknown:null};var fe=()=>n(381839),xe=()=>n(572948),ge=()=>n(205228),he=()=>n(315605),ve=()=>n(718611),be=()=>n(338530),ke=()=>n(435441),Ce=()=>n(179809),Ie=()=>n(325107),Se=()=>n(749826),Me=()=>n(1910);const Te=o.memo((function(e){let{infoHelper:t,getRecordModel:n,style:o,typecheckContextValues:i}=e;const r=t;if(void 0===(null==r?void 0:r.kind))return null;switch(r.kind){case Q().FormulaEditorInfoCompletionKind.Token:return(0,G.jsx)(je,{completion:r,getRecordModel:n,style:o,typecheckContextValues:i});case Q().FormulaEditorInfoCompletionKind.LibraryFunction:{const e=!(null==t||!t.calledFromUnifiedFunctionProperty),i=function(e,t){if(t&&void 0!==e.syntax[1])return e.syntax[1];return e.syntax[0]}(r.libraryFunction,e),a=function(e,t){if(t&&void 0!==e.examples[1])return e.examples[1];return e.examples[0]}(r.libraryFunction,e),l=r.libraryFunction.returnType;return(0,G.jsx)(Fe,{icon:Ke("function"==typeof l?l([]).type:l.type),name:i,description:ne().Z.formatMessage(r.libraryFunction.description),examples:a.length>0?a.map(((e,t)=>(0,G.jsx)(we,{example:e,getRecordModel:n},t))):void 0,style:o})}case Q().FormulaEditorInfoCompletionKind.Binding:var a;return r.text===Q().CURRENT_VALUE_NAME?(0,G.jsx)(Fe,{icon:Ke(r.type.type),name:r.text,description:ne().Z.formatMessage(Be.currentValueDescription),style:o}):r.text===Q().CURRENT_INDEX_NAME?(0,G.jsx)(Fe,{icon:Ke(r.type.type),name:r.text,description:ne().Z.formatMessage(Be.currentIndexDescription),style:o}):(0,G.jsx)(Fe,{icon:Ke(r.type.type),name:r.text,description:ne().Z.formatMessage("array"===(null==r||null===(a=r.type)||void 0===a?void 0:a.type)?Be.listVariableType:Be.variableType),style:o});case Q().FormulaEditorInfoCompletionKind.Builtin:{const e=te[r.builtin];return(0,G.jsx)(Fe,{icon:Ke(e.type.type),name:e.name,description:ne().Z.formatMessage(e.description),examples:e.examples.length>0?e.examples.map(((e,t)=>(0,G.jsx)(we,{example:e,getRecordModel:n},t))):void 0,style:o})}default:return(0,g().t1)(r)}}));function we(e){let{example:t,getRecordModel:n,typecheckContextValues:l}=e;const s=(0,M().XJ)(he().o),u=(0,ve().kw)(),d=(0,i().O7)(),{device:x}=d,g=(0,r().VK)((()=>{var e;return null===(e=T().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),h=(0,a().Fg)(),b=(0,y().YB)(),k=(0,be().C)(),C=(0,r().VK)((()=>{var e;const o=document.createElement("div"),i="string"!=typeof t.input?m().QaF(t.input):t.input,r=(null===(e=s.value)||void 0===e?void 0:e.highlight(`${i}`,s.value.languages[fe().PrismLanguages.notion],fe().PrismLanguages.notion))??"";o.innerHTML=Ce().g7(r);const a=f().oA(Array.from(o.childNodes).map(Ee)),c="string"==typeof t.input?[[t.input],[" = "]]:t.input.concat([[" = "]]),y=Ce().kF(c,f().oA(a)),v=c.map(m().hDy).map(((e,t)=>xe().fn({annotations:e,theme:h,getRecordModel:n,spaceId:g})));return y.map(((e,t)=>{const o=v[e.textTokenIndex],i=c[e.textTokenIndex];return m().km_(i)?(0,xe().$i)({args:{textValue:{value:c,spaceId:g},getRecordModel:n,getRecordRole:()=>{},disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableLinks:!1,userTimeZone:(0,p().r)(),disabled:!1,isAndroid:x.isAndroid,isSafariOrIOS:x.isSafari||x.isIOS,isWindows:x.isWindows,showEmojiInline:x.isWindows,emojiType:u,highlightDiscussionId:void 0,theme:h,intl:b,renderedPageBlockId:void 0,parentBlockId:void 0,katex:void 0,isClient:!0,baseUrl:ge().default.domainBaseUrl,publicDomainName:ge().default.publicDomainName,currentUserId:d.currentUser.id,getPublicBaseUrlForPage:void 0,externalIntegrations:[],formulaValueTypes:l??[],emojiData:k,isMobileNative:x.isMobileNative,isMobileNativeExternalLinkFixEnabled:Se().default.checkGate({gateName:"mobile_native_external_link_fix"}),displayInUserTimezone:Se().default.checkGate({gateName:"display_date_in_user_timezone"})},style:o.style,classNames:o.classNames,index:t,token:i,tokenValue:m().WiV(i),tokenAnnotations:m().hDy(i)}):(0,G.jsx)("span",{className:[e.classNames||"",...o.classNames].join(" "),style:o.style,"data-token-index":e.textTokenIndex,children:e.value},t)}))}),[t.input,s.value,h,n,g,x.isAndroid,x.isSafari,x.isIOS,x.isWindows,x.isMobileNative,u,b,d.currentUser.id,l,k]),I=(0,r().VK)((()=>Array.isArray(t.output)?(0,xe().IY)({textValue:{value:t.output,spaceId:g},getRecordModel:n,getRecordRole:()=>{},disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableLinks:!1,userTimeZone:(0,p().r)(),disabled:!1,isAndroid:x.isAndroid,isSafariOrIOS:x.isSafari||x.isIOS,isWindows:x.isWindows,showEmojiInline:x.isWindows,emojiType:u,theme:h,intl:b,katex:void 0,isClient:!0,baseUrl:ge().default.domainBaseUrl,publicDomainName:ge().default.publicDomainName,currentUserId:d.currentUser.id,getPublicBaseUrlForPage:void 0,externalIntegrations:[],formulaValueTypes:[],emojiData:k,isMobileNative:x.isMobileNative,isMobileNativeExternalLinkFixEnabled:Se().default.checkGate({gateName:"mobile_native_external_link_fix"}),displayInUserTimezone:Se().default.checkGate({gateName:"display_date_in_user_timezone"})}):t.output),[x.isAndroid,x.isIOS,x.isSafari,x.isWindows,x.isMobileNative,k,u,d.currentUser.id,t.output,n,b,g,h]),S=!1!==t.isCopyable&&("string"==typeof t.input||!0===t.isCopyable),w=(0,o.useCallback)((async()=>{if(S){const e=(Array.isArray(t.input)?(0,c().Xh)({intl:b,textValue:t.input,getRecordModel:n,userTimeZone:(0,p().r)()}):t.input).replaceAll(/\/\*.*\*\//g,"").trim();(await v().F.clipboardActions.load()).copyString({stringValue:e,environment:d,copiedMessage:De.copiedExampleMessage})}}),[d,t.input,n,b,S]),F=(0,a().yK)((e=>({code:{fontFamily:"monospace",whiteSpaceCollapse:"preserve",fontSize:11,borderRadius:5,border:`1px solid ${e.stroke.secondary}`,margin:"0 -4px",padding:"0 6px",pointerEvents:"none",opacity:.95,display:"flex",flexDirection:"row",alignItems:"center",tabSize:2},left:{flexGrow:1,padding:"6px 0"},right:{alignSelf:"center"},copyButton:{height:22,width:22,pointerEvents:"auto"},copyButtonIcon:{height:12,width:12}})),[]);return(0,G.jsxs)("div",{style:F.code,children:[(0,G.jsxs)("div",{style:F.left,children:[(0,G.jsx)("div",{children:C}),I?(0,G.jsxs)("div",{children:["= ",I]}):null]}),S?(0,G.jsx)("div",{style:F.right,children:(0,G.jsx)(Me().Z,{ariaLabel:b.formatMessage(De.copyToClipboard),onClick:w,icon:Ie().U,style:F.copyButton,iconStyle:F.copyButtonIcon,disallowTabbing:!0})}):null]})}function Fe(e){let{name:t,icon:n,description:o,examples:i,style:r}=e;const l=(0,a().yK)((e=>({helper:{display:"flex",flexDirection:"column",fontSize:12,height:"auto",width:"100%",gap:8,overflow:"auto",textWrap:"wrap",...r},name:{fontSize:14,fontWeight:600,display:"flex",alignItems:"center"},description:{color:e.mediumTextColor},iconStyle:{height:14,width:14,fill:e.mediumIconColor,display:"inline",marginRight:6},divider:{borderColor:e.stroke.secondary},examples:{display:"flex",flexDirection:"column",gap:4}})),[r]);return(0,G.jsxs)("div",{style:l.helper,children:[(0,G.jsxs)("span",{style:l.name,children:[void 0!==n&&n(l.iconStyle),t]}),void 0!==o&&(0,G.jsx)("span",{style:l.description,children:o}),void 0!==i&&(0,G.jsx)("div",{style:l.examples,children:i})]})}function je(e){let{completion:t,getRecordModel:n,style:o,typecheckContextValues:i}=e;const{name:a,description:l,icon:s,examples:p}=(0,r().VK)((()=>{if(!n)return{};if(t.token.type===Q().FormulaTokenType.BlockProperty){var e;if((0,u().Xp)(t.token))return{};if(Q().FormulaTokenSupportedBlockSystemPropertyList.includes(t.token.property)&&!t.token.collection){var o;const e=null===(o=Q().FormulaTokenSupportedBlockSystemPropertyToType[t.token.property])||void 0===o?void 0:o.type,i=e?q().wG[e]:void 0,r=me[t.token.property],a="function"==typeof(null==r?void 0:r.description)?r.description():null==r?void 0:r.description,l=t.name??t.token.property;return{name:l,icon:i,description:a?ne().Z.formatMessage(a):void 0,examples:null!==r?Ae(r,n,{collection:t.token.collection,property:t.token.property,name:l},{name:l,type:t.token.property}):void 0}}if(!t.token.collection)return{};const i=(0,u().SR)(t.token.property),r=n(t.token.collection),a=null==r||null===(e=r.getNormalizedSchema())||void 0===e?void 0:e[i];if(!a)return{};const l=me[a.type];return l?{name:t.name,icon:q().wG[a.type],description:ne().Z.formatMessage("function"==typeof l.description?l.description(a):l.description),examples:Ae(l,n,{collection:t.token.collection,property:i,name:t.name},a)}:{}}if(t.token.type===Q().FormulaTokenType.ContextValue){const e=(0,u().b0)(i,(0,u().Kv)(t.token.valueId));if(!e||e.kind!==Q().FormulaContextValueKind.ContextValue)return{};const o=e.type.type,r=ye[o];return{name:e.name,description:e.description??e.tooltipName,icon:Ke(e.type.type),examples:null!=r&&r.examples?Pe(r,n,i,e):void 0}}if(t.token.type===Q().FormulaTokenType.Block||t.token.type===Q().FormulaTokenType.Checkbox||t.token.type===Q().FormulaTokenType.Date||t.token.type===Q().FormulaTokenType.Person)return{};(0,g().t1)(t.token)}),[t.name,t.token,n,i]);return void 0===a?null:(0,G.jsx)(Fe,{name:a,icon:s,description:l,examples:p,style:o})}function Ae(e,t,n,o){const i=e.examples;let r=[];return r="function"==typeof i?i(n,o).map(((e,n)=>(0,G.jsx)(we,{example:e,getRecordModel:t},n))):i.map(((e,n)=>(0,G.jsx)(we,{example:e,getRecordModel:t},n))),r.length>0?r:void 0}function Pe(e,t,n,o){const i=e.examples;let r=[];return r="function"==typeof i?i(o).map(((e,o)=>(0,G.jsx)(we,{example:e,getRecordModel:t,typecheckContextValues:n},o))):i.map(((e,o)=>(0,G.jsx)(we,{example:e,getRecordModel:t,typecheckContextValues:n},o))),r.length>0?r:void 0}function Ee(e){return ke().Gs(e)?[e.data]:ke().kK(e)?[e.textContent||"",e.className]:void 0}const De=(0,y().vU)({codeExamples:{id:"formula2Input.helperText.codeExamples",defaultMessage:"Examples"},copiedExampleMessage:{id:"formula2Input.helperText.copiedExampleMessage",defaultMessage:"Copied example to clipboard!"},copyToClipboard:{defaultMessage:"Copy to Clipboard",id:"database.copyButton.copyToClipboard"}}),Be=(0,y().vU)({currentValueDescription:{id:"formula2Input.helperText.currentValueDescription",defaultMessage:"Returns the value of the current item in the list function."},currentIndexDescription:{id:"formula2Input.helperText.currentIndexDescription",defaultMessage:"Returns the index of the current item in the list function, starting from 0."},variableType:{id:"formula2Input.variableHelper.description",defaultMessage:"User-defined variable."},listVariableType:{id:"formula2Input.variableHelper.descriptionWithList",defaultMessage:"User-defined variable, list."},emailForUser:{id:"formula2Input.helperText.emailForUser",defaultMessage:"Returns the email address of a provided user."},nameForUser:{id:"formula2Input.helperText.nameForUser",defaultMessage:"Returns the display name of a provided user."}});function Re(e){const{store:t,selection:n,cursorEditorInfo:l,cursorEditorInfoRef:s,context:p,onChange:d,getRecordModel:c,setInfoHelper:y}=e,x=(0,a().yK)((()=>({menu:{top:0,left:0,right:0,bottom:0,position:"absolute",marginBottom:2},menuSection:{paddingTop:6,paddingBottom:2}})),[]),h=(0,i().Fy)(),v=(0,r().qz)(void 0,ie().Z),b=(0,o.useMemo)((()=>{const e=f().vM((null==l?void 0:l.completions)??[],"kind");let o=-1;return Object.entries(e).map(((e,i)=>{const[r,a]=e,l=a.map(((e,r)=>{o+=1;const a=o;return{key:`${i}-${r}`,render:t=>(0,G.jsx)(Ve,{...t,completion:e,context:p,getRecordModel:c,menuListStore:v,indexGlobal:a,cursorEditorInfoRef:s,setInfoHelper:y}),action:()=>{var o;void 0!==e&&s.current&&(y({...e,calledFromUnifiedFunctionProperty:"member dot receiver"===(null===(o=s.current.completionsInfo)||void 0===o?void 0:o.type)}),function(e){var t;const{completion:n,store:o,selection:i,onChange:r,cursorEditorInfo:a}=e,l=(null==i?void 0:i.startIndex)||0,s=(null==i?void 0:i.endIndex)||0,p=l!==s,d=(null===(t=a.completionsInfo)||void 0===t?void 0:t.prefix)||"",c="overridePrefixLength"in n?n.overridePrefixLength??0:d.length,y=p?l:s-c,f=o.getValue();if(n.kind===Q().FormulaEditorInfoCompletionKind.Token){if(n.token.type===Q().FormulaTokenType.Checkbox)return;if(n.token.type===Q().FormulaTokenType.BlockProperty){if((0,u().Xp)(n.token))return;const e=(0,m()._QS)(f,y,s),t=n.token.collection?(0,u().SR)(n.token.property):n.token.property,o=(0,m().YCD)((0,m().kbv)({collection:n.token.collection,property:t,name:n.name}));return void r({newValue:(0,m().P$X)(e,[o],y),newSelection:{startIndex:y+1,endIndex:y+1}})}if(n.token.type===Q().FormulaTokenType.ContextValue){const e=(0,m()._QS)(f,y,s),t=(0,u().Kv)(n.token.valueId),o=(0,m().YCD)((0,m()._QF)({id:t}));r({newValue:(0,m().P$X)(e,[o],y),newSelection:{startIndex:y+1,endIndex:y+1}})}else{if(n.token.type===Q().FormulaTokenType.Date||n.token.type===Q().FormulaTokenType.Block||n.token.type===Q().FormulaTokenType.Person)return;(0,g().t1)(n.token)}}else if(n.kind===Q().FormulaEditorInfoCompletionKind.LibraryFunction){var x,h,v,b;const e=(0,m()._QS)(f,y,s),t=(0,m().V3y)(`${n.libraryFunction.name}()`,[]),o=(0,m().P$X)(e,[t],y);let i=y+n.libraryFunction.name.length+1;void 0!==(null===(x=n.libraryFunction)||void 0===x||null===(x=x.parameters)||void 0===x?void 0:x.varargs)||null!==(h=n.libraryFunction)&&void 0!==h&&null!==(h=h.parameters)&&void 0!==h&&null!==(h=h.expected)&&void 0!==h&&h.length&&(1!==(null===(v=n.libraryFunction)||void 0===v||null===(v=v.parameters)||void 0===v||null===(v=v.expected)||void 0===v?void 0:v.length)||"member dot receiver"!==(null===(b=a.completionsInfo)||void 0===b?void 0:b.type))||(i+=1);r({newValue:o,newSelection:{startIndex:i,endIndex:i}})}else if(n.kind===Q().FormulaEditorInfoCompletionKind.Binding||n.kind===Q().FormulaEditorInfoCompletionKind.Builtin){const e=(0,m()._QS)(f,y,s),t=n.kind===Q().FormulaEditorInfoCompletionKind.Binding?n.text:`${n.builtin} `,o=(0,m().V3y)(t,[]),i=(0,m().P$X)(e,[o],y),a=y+t.length;r({newValue:i,newSelection:{startIndex:a,endIndex:a}})}else(0,g().t1)(n)}({completion:e,store:t,selection:n,onChange:d,cursorEditorInfo:s.current}))}}}));return{key:r,render:e=>(0,G.jsx)(pe().Z,{...e,style:x.menuSection,title:ne().Z.formatMessage(Ge[r])}),items:l}}))}),[p,null==l?void 0:l.completions,s,c,v,d,n,y,t,x.menuSection]),k=(0,o.useCallback)((e=>{var t;if(h.isMobile)return;const n=void 0!==e.indexGlobal?null===(t=s.current)||void 0===t||null===(t=t.completions)||void 0===t?void 0:t[e.indexGlobal]:void 0;var o;n&&y({...n,calledFromUnifiedFunctionProperty:"member dot receiver"===(null===(o=s.current)||void 0===o||null===(o=o.completionsInfo)||void 0===o?void 0:o.type)})}),[s,h.isMobile,y]);let C;return(0,o.useEffect)((()=>{if(h.isMobile)return;const e=e=>{var t,n;if(void 0!==e.state.focus.indexGlobal&&null!==(t=s.current)&&void 0!==t&&t.completions&&(null===(n=s.current)||void 0===n?void 0:n.completions.length)>0){var o;const t=null===(o=s.current)||void 0===o||null===(o=o.completions)||void 0===o?void 0:o[e.state.focus.indexGlobal];void 0!==t&&y((e=>{var n;return void 0===e||void 0===(null===(n=s.current)||void 0===n?void 0:n.callParameter)?t:e}))}};return v.addListener(e),()=>v.removeListener(e)}),[s,v,y,h.isMobile]),(0,o.useEffect)((()=>{var e,t,n,o;if(h.isMobile)return;const i="function"===(null==l||null===(e=l.callParameter)||void 0===e||null===(e=e.expression)||void 0===e||null===(e=e.type)||void 0===e?void 0:e.type)?null===(t=l.callParameter.expression)||void 0===t?void 0:t.type:void 0;void 0!==i&&void 0!==(null==l||null===(n=l.callParameter)||void 0===n?void 0:n.parameterIndex)&&(null==l||null===(o=l.callParameter)||void 0===o?void 0:o.parameterIndex)>-1&&y({kind:Q().FormulaEditorInfoCompletionKind.LibraryFunction,libraryFunction:i.libraryFunction,calledFromUnifiedFunctionProperty:i.calledFromUnifiedFunctionProperty})}),[null==l?void 0:l.callParameter,h.isMobile,y]),(0,o.useEffect)((()=>{b.length>0&&v.update((e=>({focus:{...e,section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})))}),[b.length,v,y]),C=h.isPhone?{menuType:oe().o.ActionSheet,disableBottomPadding:!0,maxHeight:"100%"}:{menuType:oe().o.Popup,width:h.isPhone?180:228,minWidth:h.isPhone?180:228,maxWidth:h.isPhone?180:228},(0,G.jsx)(se().Z,{...C,scrollerStyle:x.menu,children:(0,G.jsx)(ue().Z,{type:ue().i.Vertical,initialFocus:0,priority:1,store:v,onKeyboardArrow:k,sections:f().oA([...b,0===b.length&&{key:"no-results",render:e=>(0,G.jsx)(pe().Z,{...e,disableDesktopPadding:!0,style:x.menuSection,children:(0,G.jsx)(Le,{})}),items:[]}])})})}const Ve=o.forwardRef((function(e,t){const{completion:l,context:s,getRecordModel:p,menuListStore:d,indexGlobal:c,cursorEditorInfoRef:m,setInfoHelper:f,onMouseEnter:x,...h}=e,v=(0,i().Fy)(),b=(0,a().yK)((e=>({icon:{width:14,fill:e.mediumIconColor},lightParens:{color:e.lightTextColor}})),[]),k=(0,o.useCallback)((e=>{if(!v.isMobile){var t;const e=null===(t=m.current)||void 0===t||null===(t=t.completions)||void 0===t?void 0:t[c];f(e)}null==x||x(e)}),[m,c,x,f,v.isMobile]),C=(0,r().VK)((()=>d.state.focus.indexGlobal===c),[d,c]),I=(0,o.useMemo)((()=>v.isMobile?(0,G.jsx)(le().ZP,{popupType:le().Z4.SlideUp,renderOrigin:e=>(0,G.jsx)(U().Z,{mobileFeedback:!0,style:{width:16,height:16},...e,children:(0,n(985695).S)(b.icon)}),render:e=>{var t;let o;return o=v.isMobile?{menuType:oe().o.Modal,title:(0,G.jsx)(y()._H,{defaultMessage:"Documentation",id:"database.formulaPropertyEntryMenuItem.title"}),right:(0,G.jsx)(n(470386).DoneMenuText,{}),onClickRight:e.close}:{menuType:oe().o.Popup},(0,G.jsx)(se().Z,{...o,children:(0,G.jsx)(pe().Z,{children:(0,G.jsx)(n(18748).ZP,{title:(0,G.jsx)(Te,{infoHelper:{...l,calledFromUnifiedFunctionProperty:"member dot receiver"===(null==m||null===(t=m.current)||void 0===t||null===(t=t.completionsInfo)||void 0===t?void 0:t.type)},getRecordModel:p,style:{padding:4},typecheckContextValues:s.valueTypes}),style:{paddingTop:16,paddingBottom:16}})})})}}):(0,G.jsx)(Ne,{visible:C})),[l,s.valueTypes,m,v.isMobile,p,C,b.icon]),S=(0,r().VK)((()=>{var e;if(l.kind!==Q().FormulaEditorInfoCompletionKind.Token||l.token.type!==Q().FormulaTokenType.BlockProperty||!p)return;if(Q().FormulaTokenSupportedBlockSystemPropertyList.includes(l.token.property))return l.token.property;if((0,u().Xp)(l.token)||!l.token.collection)return;const t=(0,u().SR)(l.token.property),n=p(l.token.collection);return null==n||null===(e=n.getNormalizedSchema())||void 0===e||null===(e=e[t])||void 0===e?void 0:e.type}),[l,p]);if(l.kind===Q().FormulaEditorInfoCompletionKind.Token){if(l.token.type===Q().FormulaTokenType.Checkbox)return null;if(l.token.type===Q().FormulaTokenType.BlockProperty)return(0,G.jsx)(ae().Z,{...h,icon:S?q().wG[S](b.icon):(0,G.jsx)(_e,{type:"unknown"}),title:l.name??l.token.property,right:I,onMouseEnter:k,ref:t});if(l.token.type===Q().FormulaTokenType.ContextValue){const e=(0,u().vx)(s.valueTypes,(0,u().Kv)(l.token.valueId));return e?(0,G.jsx)(ae().Z,{...h,icon:(0,G.jsx)(Ue,{contextValue:e}),title:(0,G.jsx)("div",{style:{display:"flex"},children:e.name}),right:I,onMouseEnter:k,ref:t}):null}if(l.token.type===Q().FormulaTokenType.Date)return null;if(l.token.type===Q().FormulaTokenType.Block)return null;if(l.token.type===Q().FormulaTokenType.Person)return null;(0,g().t1)(l.token)}else{if(l.kind===Q().FormulaEditorInfoCompletionKind.LibraryFunction){const e=l.libraryFunction.returnType;return(0,G.jsx)(ae().Z,{...h,icon:(0,G.jsx)(_e,{type:"function"==typeof e?e([]).type:e.type}),title:(0,G.jsxs)(G.Fragment,{children:[l.libraryFunction.name,(0,G.jsx)("span",{style:b.lightParens,children:"()"})]}),right:I,onMouseEnter:k,ref:t})}if(l.kind===Q().FormulaEditorInfoCompletionKind.Builtin)return(0,G.jsx)(ae().Z,{...h,title:l.builtin,icon:(0,G.jsx)(_e,{type:te[l.builtin].type.type}),right:I,onMouseEnter:k,ref:t});if(l.kind===Q().FormulaEditorInfoCompletionKind.Binding)return(0,G.jsx)(ae().Z,{...h,title:l.text,icon:(0,G.jsx)(_e,{type:l.type.type}),right:I,onMouseEnter:k,ref:t});(0,g().t1)(l)}})),Ne=o.memo((function(e){let{visible:t}=e;const o=(0,a().yK)((e=>({icon:{width:14,fill:e.mediumIconColor,transition:"opacity 50ms 200ms",visibility:t?"visible":"hidden",opacity:t?1:0}})),[t]);return(0,n(842595).U)(o.icon)})),_e=o.memo((function(e){var t;let{type:n}=e;const o=(0,a().yK)((e=>({icon:{width:14,fill:e.mediumIconColor,transition:"transform .3s ease"}})),[]);return null===(t=Ke(n))||void 0===t?void 0:t(o.icon)}));function Ue(e){const{contextValue:t}=e,o=(0,a().yK)((e=>({stepNumber:{color:e.mediumIconColor}})),[]);return(0,g().$K)(t.stepNumberForDisplay)?(0,G.jsx)(n(657581).E,{size:n(223506).$.Small,number:t.stepNumberForDisplay,style:o.stepNumber}):(0,G.jsx)(_e,{type:t.type.type})}function Ke(e){return"text"===e?q().wG.text:"number"===e?q().wG.number:"checkbox"===e?q().wG.checkbox:"date"===e?q().wG.date:"block"===e?q().wG.relation:"person"===e?q().wG.person:"select"===e?q().wG.select:"array"===e?q().wG.multi_select:"function"===e||void 0===e||"unknown"===e?q().wG.formula:void(0,g().t1)(e)}function Le(){return(0,G.jsx)(re().Z,{caption:(0,G.jsx)(y()._H,{defaultMessage:"No results",id:"FormulaAutocompleteMenu.noResults.message"})})}const Ze=(0,y().vU)({[Q().FormulaEditorInfoCompletionKind.Token]:{defaultMessage:"Properties",id:"formulaAutocompleteMenu.token.message"},[Q().FormulaEditorInfoCompletionKind.LibraryFunction]:{defaultMessage:"Functions",id:"formulaAutocompleteMenu.function.message"},[Q().FormulaEditorInfoCompletionKind.Binding]:{defaultMessage:"Variables",id:"formulaAutocompleteMenu.variables.message"},[Q().FormulaEditorInfoCompletionKind.Builtin]:{defaultMessage:"Built-ins",id:"formulaAutocompleteMenu.builtin.message"}}),Ge={[Q().FormulaEditorInfoCompletionKind.Token]:Ze[Q().FormulaEditorInfoCompletionKind.Token],[Q().FormulaEditorInfoCompletionKind.LibraryFunction]:Ze[Q().FormulaEditorInfoCompletionKind.LibraryFunction],[Q().FormulaEditorInfoCompletionKind.Binding]:Ze[Q().FormulaEditorInfoCompletionKind.Binding],[Q().FormulaEditorInfoCompletionKind.Builtin]:Ze[Q().FormulaEditorInfoCompletionKind.Builtin]};var Oe=()=>n(998901),He=()=>n(92175),We=()=>n(906651),$e=()=>n(654133);const Xe={height:24,padding:"0 8px"},Ye=(0,y().vU)({accept:{defaultMessage:"Accept",id:"database.formula.acceptFormulaInput.tooltip"},cancel:{defaultMessage:"Cancel",id:"formulas.formulaInputHeader.cancel"},close:{id:"formula2Input.close",defaultMessage:"Close"},save:{id:"formula2Input.save",defaultMessage:"Save"},formulaHeader:{id:"formula2Input.NotionFormula",defaultMessage:"Notion Formula"},learnTooltip:{id:"formula2Input.learnAboutFormulas",defaultMessage:"Learn about formulas!"},revert:{id:"formula2Input.revert",defaultMessage:"Revert"},revertTooltip:{id:"formula2Input.revertTooltip",defaultMessage:"Revert to previous formula"},askAi:{id:"formulas.formulaInputHeader.askAi",defaultMessage:"Ask AI"}}),ze=o.memo((function(e){const{disabled:t,onClickAssistant:n,onClickCancel:o,onClickClose:i,onClickRevert:r,isAssistantVisible:l}=e,s=(0,a().yK)((e=>({headerRow:{color:e.mediumTextColor,flexWrap:"wrap",fontWeight:500,fontSize:14}})),[]),u=!t&&!l;return(0,G.jsxs)(_().jX,{direction:"row",padding:"10px 12px 0 12px",style:s.headerRow,children:[o&&!t?(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(_().jX,{width:"hug",children:(0,G.jsx)(Qe,{onClick:o})}),(0,G.jsx)(_().jX,{width:"fill"})]}):(0,G.jsx)(_().jX,{width:"fill",children:(0,G.jsx)(tt,{})}),(0,G.jsxs)(_().jX,{width:"hug",direction:"row",gap:6,align:"center",children:[r&&!t?(0,G.jsx)(nt,{onClick:r}):null,u?(0,G.jsx)(F().D,{experimentId:"formula_assistant",groups:{on:(0,G.jsx)(qe,{onClick:n})}}):null,t?(0,G.jsx)(Je,{onClick:i}):(0,G.jsx)(et,{onClick:i})]})]})}));function qe(e){const{onClick:t}=e,n=(0,y().YB)(),o=(0,a().yK)((()=>({label:{marginLeft:6,marginRight:2}})),[]),i=n.formatMessage(Ye.askAi);return(0,G.jsxs)(He().Z,{"aria-label":i,isSmall:!0,onClick:t,children:[(0,G.jsx)(N().h9,{}),(0,G.jsx)("span",{style:o.label,children:i})]})}function Qe(e){const{onClick:t}=e,n=(0,y().YB)();return(0,G.jsx)(He().Z,{isGray:!0,isSmall:!0,onClick:t,children:n.formatMessage(Ye.cancel)})}function Je(e){const{onClick:t}=e,n=(0,y().YB)();return(0,G.jsx)(We().Z,{onClick:t,style:Xe,children:n.formatMessage(Ye.close)})}function et(e){const{onClick:t}=e,o=(0,i().O7)(),r=(0,y().YB)(),l=(0,a().yK)((e=>({commandText:{color:e.mediumInvertedTextColor}})),[]);return(0,G.jsx)($e().Z,{renderTooltip:()=>(0,G.jsxs)("div",{children:[(0,G.jsx)("span",{children:r.formatMessage(Ye.accept)})," ",(0,G.jsxs)("span",{style:l.commandText,children:[(0,n(363165).Nt)({environment:o}).command,"+Enter"]})]}),render:e=>(0,G.jsx)(We().Z,{onClick:t,style:Xe,...e,children:r.formatMessage(Ye.save)})})}function tt(){const e=(0,y().YB)(),t=(0,a().yK)((()=>({headerTitle:{fontSize:12,display:"flex",alignItems:"center"},helpButton:{marginLeft:2,height:20,width:20}})),[]);return(0,G.jsxs)("span",{style:t.headerTitle,children:[e.formatMessage(Ye.formulaHeader),(0,G.jsx)($e().Z,{placement:Oe().Placement.Top,render:o=>(0,G.jsx)(Me().Z,{...o,ariaLabel:e.formatMessage(Ye.learnTooltip),icon:n(653457).m,href:(0,n(148126).UY)("guides.formulas"),external:!0,style:t.helpButton}),renderTooltip:()=>e.formatMessage(Ye.learnTooltip)})]})}function nt(e){const{onClick:t}=e,n=(0,y().YB)(),o=(0,a().yK)((e=>({revertButton:{color:e.mediumIconColor}})),[]);return(0,G.jsx)($e().Z,{placement:Oe().Placement.Top,render:e=>(0,G.jsx)(He().Z,{...e,"aria-label":n.formatMessage(Ye.revertTooltip),isGray:!0,isSmall:!0,style:o.revertButton,onClick:t,children:n.formatMessage(Ye.revert)}),renderTooltip:()=>n.formatMessage(Ye.revertTooltip)})}n(492176),n(7961),n(228244);var ot=()=>n(492788),it=()=>n(732811),rt=()=>n(659278),at=()=>n(523733),lt=()=>n(207874),st=()=>n(491308),ut=()=>n(964433),pt=()=>n(542058),dt=()=>n(641702),ct=()=>n(59407),mt=()=>n(550054),yt=()=>n(620218),ft=()=>n(663132),xt=()=>n(24216),gt=()=>n(129301),ht=()=>n(37623);const vt={borderRadius:4,flexGrow:1,flexShrink:1,fontFamily:h().F5(n(146947).locale).githubMono,fontSize:12,height:"100%",minHeight:"1em",paddingBlock:"11px 10px",paddingInline:"12px 13px",tabSize:2,textAlign:"left",whiteSpace:"pre-wrap",wordBreak:"break-all"},bt=(0,y().vU)({formulaPlaceholder:{id:"formulas.formulaPlaceholder",defaultMessage:"Your formula"}});function kt(e){const{analyticsContext:t,clipboardActions:n,disabled:l,errorRanges:s,focus:u,formulasModule:p,handleSave:d,markdownLinkifyIt:c,parentSpaceId:y,Prism:x,store:g,tinyMceMicrosoftWordPasteFilter:h,valueTypes:v}=e,k=(0,o.useRef)(null),C=(0,a().Fg)(),I=(0,i().O7)(),M=(0,r().VK)((()=>{var e;const t=w().default.state;return"editing"===t.mode&&(null===(e=(0,S().QY)(t.multiSelection))||void 0===e?void 0:e.store)===g}),[g]),T=(0,o.useCallback)((()=>{var e;return(null===(e=k.current)||void 0===e?void 0:e.getNode())||void 0}),[k]),F=(0,r().VK)((()=>g.getValue()||[]),[g],{debugName:"FormulaInputText.textValueStore"}),j=(0,o.useCallback)((()=>{var e;return null===(e=T())||void 0===e?void 0:e.blur()}),[T]),A=(0,o.useCallback)((()=>{const e=rt().p4(m().QaF(F));return{endIndex:e.length,startIndex:e.length}}),[F]),P=(0,o.useCallback)((()=>{if(M)return(0,mt().HE)(g)}),[M,g]),E=(0,o.useCallback)((()=>{const e=window.getSelection();null!=e&&e.rangeCount&&ot().default.afterNextFlush((()=>{var t;const n=e.getRangeAt(0).getClientRects()[0],o=null===(t=T())||void 0===t||null===(t=t.parentElement)||void 0===t?void 0:t.parentElement,i=null==o?void 0:o.getBoundingClientRect();n&&o&&i&&(i.top>=n.top?o.scrollTo({top:o.scrollTop+(n.top-i.top)-6}):i.bottom<=n.bottom+n.height&&o.scrollTo({top:o.scrollTop+(n.bottom-i.bottom)+28}))}))}),[T]),D=(0,o.useCallback)((e=>{dt().SD({canEdit:!l,editorNode:T(),environment:I,event:e,store:g,textValue:F})}),[I,F,T,g,l]),B=(0,o.useCallback)((e=>{if(l)return;const t=w().default.state;"editing"===t.mode&&t.multiSelection.start.store===g&&(V().createAndCommit({userAction:"FormulaInputText.handleDelete",environment:I,canUndo:!0,perform:n=>{st().as({environment:I,multiSelection:t.multiSelection,deleteForwards:!0,transaction:n,event:e,editorMode:"default"})}}),E())}),[l,I,E,g]),N=(0,o.useCallback)((e=>{if(l)return;const t=w().default.state;if("editing"===t.mode&&t.multiSelection.start.store===g){if(st().YV({device:I.device,event:e,multiSelection:t.multiSelection}))return;V().createAndCommit({userAction:"FormulaInputText.handleBackspace",environment:I,canUndo:!0,perform:n=>{st().as({environment:I,multiSelection:t.multiSelection,deleteForwards:!1,transaction:n,event:e,editorMode:"default"})}}),E()}}),[l,I,E,g]),_=(0,o.useCallback)((e=>{var t,n,o;if(l)return;if(null===(t=e.preventDefault)||void 0===t||t.call(e),k.current&&k.current.isComposing())return;const i=w().default.state,r="editing"===i.mode&&(0,S().QY)(i.multiSelection);if(!r)return;const a=rt().p4(m().QaF(F)),s=null===(n=a.slice(0,r.selection.startIndex).join("").split("\n"))||void 0===n?void 0:n.at(-1),u=(null==s||null===(o=s.match(/^\t*/))||void 0===o?void 0:o[0].length)||0,p=(null==s?void 0:s.split("").reverse())||[];let d=0;const c=p.some((e=>{if(")"===e)d++;else if("("===e){if(0===d)return!0;d--}return!1}))?u+1:u;let y="\t".repeat(c);const f=")"===a[r.selection.endIndex],x=!(null==s||!s.endsWith("("))&&f;x&&(y+=`\n${"\t".repeat(c-1)}`),V().createAndCommit({userAction:"FormulaInputText.handleShiftEnter",environment:I,canUndo:!0,perform:e=>{R().hJ({environment:I,editorMode:"default",store:g,string:`\n${y}`,selection:r.selection,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:e}),x&&b().setSelection({store:g,selection:{startIndex:r.selection.startIndex+c+1,endIndex:r.selection.startIndex+c+1}})}}),E()}),[l,I,E,g,F]),U=(0,o.useCallback)((e=>{var t;const o=window.getSelection();null!=o&&o.anchorNode&&null!==(t=T())&&void 0!==t&&t.contains(o.anchorNode)&&n.copy({environment:I,event:e,markdownLinkifyIt:c})}),[I,T,c,n]),L=(0,o.useCallback)((e=>{l?e.preventDefault():(n.cutWithMaybeConfirmation({environment:I,event:e,markdownLinkifyIt:c}),E())}),[l,I,E,c,n]),Z=(0,o.useCallback)((e=>{l?e.preventDefault():(V().createAndCommit({userAction:"FormulaInputText.handlePaste",environment:I,canUndo:!0,perform:t=>{n.paste({environment:I,event:e,disableEmbedMenu:!0,transaction:t,onPasteFiles:n.pasteFilesForBlocks,formulasModule:p,markdownLinkifyIt:c,tinyMceMicrosoftWordPasteFilter:h})}}),E())}),[l,I,E,c,h,p,n]),O=(0,o.useCallback)((e=>{dt().vO({environment:I,event:e,textValue:F,editorNode:T(),store:g,canEdit:!l})}),[I,F,T,g,l]),H=(0,o.useCallback)((e=>{dt().kV({environment:I,event:e,textValue:F,editorNode:T(),store:g,canEdit:!l})}),[I,F,T,g,l]),W=(0,o.useCallback)((e=>{l||e.preventDefault()}),[l]),$=(0,o.useCallback)((e=>{V().createAndCommit({userAction:"FormulaInputText.handleMoveUp",environment:I,canUndo:!0,perform:e=>{R().fs({environment:I,transaction:e,direction:"up"})}})}),[I]),X=(0,o.useCallback)((e=>{V().createAndCommit({userAction:"FormulaInputText.handleMoveDown",environment:I,canUndo:!0,perform:e=>{R().fs({environment:I,transaction:e,direction:"down"})}})}),[I]),Y=(0,o.useCallback)((e=>{var t;e.preventDefault();const n=lt().XT();(null==n||null===(t=n.getFirstStore())||void 0===t?void 0:t.id)===g.id&&lt().Yw(I)}),[I,g.id]),z=(0,o.useCallback)((e=>{var t;e.preventDefault();const n=lt().M7();(null==n||null===(t=n.getFirstStore())||void 0===t?void 0:t.id)===g.id&&lt().KX(I)}),[I,g.id]),q=(0,o.useCallback)((e=>{if(l)return;e.preventDefault();const t=w().default.state,n="editing"===t.mode&&(0,S().QY)(t.multiSelection);n&&V().createAndCommit({userAction:"FormulaInputText.handleTab",environment:I,canUndo:!0,perform:e=>{R().wA({environment:I,store:g,editorMode:"default",selection:n.selection,transaction:e,shouldStripTokens:!1,disableFilters:!0})}})}),[l,I,g]),Q=(0,o.useCallback)((e=>{if(l)return;e.preventDefault();const t=w().default.state,n="editing"===t.mode&&(0,S().QY)(t.multiSelection);n&&V().createAndCommit({userAction:"FormulaInputText.handleUntab",environment:I,canUndo:!0,perform:e=>{R().O5({environment:I,store:g,editorMode:"default",selection:n.selection,transaction:e,shouldStripTokens:!1,disableFilters:!0})}})}),[l,I,g]),J=(0,o.useCallback)((e=>{const{newValue:o}=e;yt().default.measureAfterNextFlush({metricName:"formulas_typing_lag",startTime:performance.now()},{environment:I,getData:()=>t}),V().createAndCommit({userAction:"FormulaInputText.handleMutation",environment:I,canUndo:!0,perform:e=>{R().aS({environment:I,editorMode:"default",store:g,newValue:o,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:!0,transaction:e}),e.postEnqueueActions.push((()=>{V().createAndCommit({userAction:"FormulaInputText.normalizeTextValue",environment:I,canUndo:!0,perform:e=>{R().vE({clipboardActions:n,formulasModule:p,store:g,transaction:e})}})}))}})}),[t,I,p,g,n]),ee=(0,o.useCallback)(((e,t)=>{let{leafRef:n,wrapperRef:o,...i}=e;const{device:r}=I,a=F.length>0;return(0,G.jsxs)("div",{ref:o,...i,onKeyDown:e=>{!function(e,t,n){(0,ct().Z)(n,e,"command+enter")&&(t(),e.stopPropagation())}(e,d,I),null==i||i.onKeyDown(e)},style:{flexGrow:1,display:"table",position:"relative"},children:[(0,G.jsx)(It,{hasText:a}),(0,G.jsx)(xt().Z,{ref:(0,at().lq)(k,n),style:vt,isDisabled:l,getHtml:()=>(0,ht().r)({currentUserId:I.currentUser.id,errorRanges:s,getPublicBaseUrlForPage:ft().aR(I),isAndroid:r.isAndroid,isMobileNative:r.isMobileNative,isSafariOrIOS:r.isSafari||r.isIOS,isWindows:r.isWindows,parentSpaceId:y,Prism:x,store:g,textValue:F,theme:C,valueTypes:v}),getSelection:P,onMutation:J,spellCheck:!1,autoCorrect:"off",autoCapitalize:"off",onSelect:t,onMouseOver:O,onMouseOut:H,suppressNewlineEvents:!1,expandSelectionOnTripleClick:!0,placeholder:" "})]})}),[I,F,P,J,O,H,d,l,s,y,x,g,C,v]),te=(0,o.useCallback)((()=>{u&&b().setSelectionAtEnd({store:g})}),[u,g]);return(0,it().K)(te),(0,G.jsxs)(K().Z,{debugName:"FormulaInputText",capture:!0,allowEnter:!0,allowTabUntab:!0,allowUndo:!0,allowEsc:!0,allowCopyPaste:!0,children:[" ",(0,G.jsx)(gt().C,{store:g,disabled:l,clearBrowserSelection:j,getEndSelection:A,onBlur:j,onClick:D,onDelete:B,onBackspace:N,onShiftEnter:_,onCommandShiftEnter:f().yR,onTab:q,onUntab:Q,onToggleBold:W,onToggleItalics:W,onToggleUnderline:W,onToggleStrike:W,onToggleCode:f().yR,onCopy:U,onCut:L,onPaste:Z,onMoveUp:$,onMoveDown:X,onUndo:Y,onRedo:z,onEsc:d,render:ee,disableStyleAnnotations:!0,disableMentions:!0,disableSlashCommands:!0,canSelectAllBlocks:!1,canInsertText:!0,canSelectionDrag:!0,disableMobileActionBar:!0,topBottomPadding:40,pasteBehavior:"inline"})]})}function Ct(e){const{value:t}=(0,M().XJ)(he().o),{value:n}=(0,M().XJ)(ut().p),{value:o}=(0,M().XJ)(pt().m),{value:i}=(0,M().XJ)(k().F.formulas),{value:r}=(0,M().XJ)(v().F.clipboardActions);return t&&i&&r?(0,G.jsx)(kt,{...e,Prism:t,clipboardActions:r,formulasModule:i,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o}):null}function It(e){const{hasText:t}=e,n=(0,y().YB)();return(0,G.jsx)(_().jX,{direction:"row",gap:8,padding:"10px 12px",style:{position:"absolute",inset:0,pointerEvents:"none",userSelect:"none"},children:t?null:(0,G.jsx)(_().jX,{height:20,align:"center-left",children:(0,G.jsx)(Z().q,{colorName:"quaternary",styleName:"Body-14px/Regular",children:n.formatMessage(bt.formulaPlaceholder)})})})}kt.displayName="FormulaInputText";const St=!1,Mt=400;function Tt(e){const{evaluationErrors:t,initialCode:n,parentSpaceId:h,outputFooter:N,disabled:_,typecheckContext:U,formulas:K,handleCancel:L,onCodeChange:Z,onTypeChange:H,parentCollectionStore:W,handleClose:$,getRecordModel:X}=e,Y=(0,y().YB)(),q=(0,i().Fy)(),Q=(0,i().O7)(),{value:J}=(0,M().XJ)(k().F.formulaEditor),ee=(0,o.useMemo)((()=>W?{collection_id:[[W.id]]}:void 0),[W]),{store:te,setValue:ne}=(0,I().Cl)({initialValue:n,onChange:Z,source:"formula",properties:ee}),oe=(0,o.useCallback)((e=>{if(ne(e.newValue),e.newSelection){const t={start:{store:te,index:e.newSelection.startIndex},end:{store:te,index:e.newSelection.endIndex}};b().setMultiSelection({multiSelection:t})}}),[ne,te]),ie=(0,r().VK)((()=>{var e;const t=w().default.state;if("editing"===t.mode&&(null===(e=(0,S().QY)(t.multiSelection))||void 0===e?void 0:e.store)===te)return{startIndex:t.multiSelection.start.index,endIndex:t.multiSelection.end.index}}),[te],{useDeepEqual:!0}),re=(0,r().VK)((()=>te.getValue()),[te]),ae=(0,o.useMemo)((()=>!f().Xy(re,n)),[re,n]),[le,se]=(0,r().VK)((()=>!re||I().il?[void 0,void 0]:K.processFormulaInput(re)),[re,K]),ue=(0,r().VK)((()=>{if(le)return K.parseFormulaInputToCst(le,se)}),[le,K,se]),pe=(0,r().VK)((()=>{if(ue)return K.convertFormulaCSTToAST(ue[0])}),[K,ue]),[de,ce]=(0,o.useState)(void 0);(0,o.useEffect)((()=>{!async function(){if(pe&&U&&x().x.isSuccess(pe)){const e=await K.addTypesToFormulaASTAsync(pe.value,U,se);ce(e),null==H||H(e.node.type)}else ce(void 0)}()}),[pe,U,se,ue,K,H]);const me=(0,o.useMemo)((()=>void 0!==de?[...(0,u().Kl)(de.node,!1),...de.errors]:[]),[de]),ye=(0,o.useMemo)((()=>({parseErrors:(null==ue?void 0:ue[1])??[],typeErrors:me,evaluationErrors:t})),[t,ue,me]),fe=(0,d().Kt)(ye,Mt,Object.is),xe=ye.parseErrors.length+ye.typeErrors.length+ye.evaluationErrors.length>0,ge=(0,r().VK)((()=>function(e){const{errors:t,intl:n,codeLength:o,formulas:i}=e,{parseErrors:r,typeErrors:a,evaluationErrors:s}=t,u=[];a&&a.length>0?a.forEach((e=>{const t=(0,l().FR)((0,l().ic)(n,e));u.push({msg:n.formatMessage(...t),range:{startIndex:e.node.startOffset,endIndex:e.node.endOffset+1}})})):s&&s.length>0&&s.forEach((e=>{const t=(0,l().FR)((0,l().OY)(n,e));u.push({msg:n.formatMessage(...t),range:i.isUniqueFormulaEvaluatorError(e)?{startIndex:e.node.startOffset,endIndex:e.node.endOffset+1}:void 0})}));r&&r.forEach((e=>{const t=(0,l().FR)((0,l().sG)(e));u.push({msg:n.formatMessage(...t),range:"eof"===e.offset?{startIndex:o-1,endIndex:o}:{startIndex:e.offset,endIndex:e.offset+1}})}));return u}({errors:fe,codeLength:se?(0,s().eD)(se):(0,m().QaF)(re).length,formulas:K,intl:Y})),[re,fe,K,Y,se]),he=(0,o.useMemo)((()=>ge.map((e=>e.range)).filter(g().$K)),[ge]),ve=(0,o.useCallback)((()=>{$(_?n:te.getValue())}),[_,$,n,te]),[be,ke]=(0,o.useState)(void 0),Ce=(0,o.useRef)(void 0),[Ie,Se]=(0,o.useState)(void 0),Me=(0,o.useRef)(1);(0,o.useEffect)((()=>{Me.current++;const e=Me.current;!async function(){if(J){const t=await J.getFormulaEditorInfoAtPosition({formula:re??[],inputPosition:ie&&ie.startIndex===ie.endIndex?ie.startIndex:0,context:U,includeDeprecatedCompletions:!1});x().x.isSuccess(t)&&Me.current===e&&(Ce.current=t.value,ke(t.value))}}()}),[ie,J,U,re]);const we=(0,o.useCallback)((()=>{ne(n)}),[n,ne]),Fe=(0,r().qz)(void 0,z),je=(0,r().VK)((()=>{var e;return null==W||null===(e=W.getSchemaStore)||void 0===e||null===(e=e.call(W))||void 0===e?void 0:e.getValue()}),[W]),Ae=(0,r().VK)((()=>Fe.state.isAssistantVisible),[Fe]),Pe=(0,o.useCallback)((()=>(0,c().Xh)({textValue:te.getValue(),intl:Y,getRecordModel:X,userTimeZone:(0,p().r)()})),[te,Y,X]),Ee=null==W?void 0:W.id,De=ge.length>0,Be=(0,o.useCallback)((()=>{var e;Ae||(0,C().j)({environment:Q,event:{eventName:"formula_assistant_open",eventProperties:{formula_assistant_session_id:Fe.state.id,has_existing_formula:(null===(e=Pe())||void 0===e?void 0:e.length)>0,has_errors:De,collection_id:Ee}}});Fe.toggleAssistantVisible()}),[Ae,Fe,Q,Pe,De,Ee]),Ve=(0,o.useCallback)((async()=>{var e;const t=null===(e=T().default.state.currentSpaceStore)||void 0===e?void 0:e.id,n=Fe.state.prompt;if(!t||!n)return;Fe.didBeginRequest();const o=ge.map((e=>{if("string"==typeof e.msg)return e.range?`${e.msg} [${e.range.startIndex},${e.range.endIndex}]`:e.msg})).filter(g().$K),i=function(e){const{prompt:t,collectionSchema:n,typecheckContext:o,existingFormula:i,formulaErrors:r}=e,a=[];if(n){const{sourceProperty:e}=o;for(const[t,o]of Object.entries(n))t!==e&&void 0!==o&&a.push({name:o.name,type:o.type,example:void 0})}return{type:"formula",prompt:t,properties:a,existingFormula:i,formulaErrors:r}}({prompt:n,collectionSchema:je,typecheckContext:U,existingFormula:Pe(),formulaErrors:o}),r=await async function(e){const{environment:t,spaceId:n,formulaInferenceContext:o}=e,i=A().Il();await D().callApi({eventName:"publishAiSession",environment:t,data:{inference_type:"formula",spaceId:n,id:i,metadata:{from:"formulaAssistant"}}});const r=A().Il(),a=await D().callStreamApi({eventName:"getCompletion",environment:t,data:{id:r,context:o,model:"openai-gpt-4o",spaceId:n,isSpacePermission:!1,aiSessionId:i,metadata:{}},headers:(0,P().Bb)({spaceId:n})});if("success"!==a.type)return void B().x2(a);let l="";if(E().H1.is(a.data))for await(const s of a.data)"success"===s.type&&(l+=s.completion);return{formula:l,inferenceId:r}}({environment:Q,spaceId:t,formulaInferenceContext:i});if(r){const e=await v().F.clipboardActions.load();!function(e){const{clipboardActions:t,environment:n,formulasModule:o,newValue:i,store:r}=e;V().createAndCommit({userAction:"FormulaInputText.handleMutation",environment:n,canUndo:!0,perform:e=>{R().YV({environment:n,store:r,newValue:i,editorMode:"default",disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:!0,transaction:e}),e.postEnqueueActions.push((()=>{V().createAndCommit({userAction:"FormulaInputText.normalizeTextValue",environment:n,canUndo:!0,perform:e=>{R().vE({clipboardActions:t,formulasModule:o,store:r,transaction:e})}})}))}})}({environment:Q,clipboardActions:e,formulasModule:K,newValue:r.formula,store:te}),(0,C().j)({environment:Q,event:{eventName:"formula_assistant_prompt",eventProperties:{formula_assistant_session_id:Fe.state.id,inference_id:r.inferenceId}}})}Fe.didFinishRequest()}),[Fe,ge,je,U,Pe,Q,K,te]),Ne=(0,o.useCallback)((()=>{}),[]),_e=(0,o.useCallback)((()=>Fe.hideAssistant()),[Fe]);St&&console.log("FormulaInput",{currentValue:re,cursorEditorInfo:be,infoHelper:Ie,errorMessagesWithRange:ge,errorRanges:he,astWithTypes:de});const Ue=(0,a().yK)((e=>({container:{display:"flex",height:"100%",paddingBottom:void 0,flexDirection:"column"},editorSection:{display:"flex",flexDirection:"column",backgroundColor:"light"===e.mode?e.cardBackground:e.accentColors.gray[30]},inputText:{display:"flex",flexGrow:1,flexShrink:1,overflow:"auto",maxHeight:"min(calc(90vh - 240px - 38px - 30px), 298px)",minHeight:"40px",cursor:"text",position:"relative"},bottomSection:{display:"flex",flexDirection:"row",height:q.isMobile?"100%":240,maxHeight:q.isMobile?void 0:"calc(90vh - 38px - 31px - 38px - 30px)",borderTop:`1px solid ${e.outlineButtonBorder}`},leftColumn:{position:"relative",borderRight:`1px solid ${e.outlineButtonBorder}`,width:q.isMobile?"100%":void 0},rightColumn:{display:"flex",flexDirection:"column",flexGrow:1},infoHelper:{padding:"12px 14px"},assistantOverlay:{position:"absolute",inset:0,background:"transparent"}})),[q.isMobile]);return(0,G.jsx)(j().Z,{debugName:"FormulaInput",capture:!0,children:(0,G.jsxs)("div",{style:Ue.container,children:[(0,G.jsxs)("div",{style:Ue.editorSection,children:[(0,G.jsx)(ze,{disabled:_,onClickAssistant:Be,onClickCancel:L,onClickClose:ve,onClickRevert:ae?we:void 0,isAssistantVisible:Ae}),(0,G.jsxs)("div",{style:Ue.inputText,children:[(0,G.jsx)(Ct,{value:re,focus:!Ae,store:te,disabled:_||Ae,parentSpaceId:h,valueTypes:U.valueTypes,errorRanges:he,handleSave:ve,analyticsContext:{restrict_unaccessible_properties:U.restrictUnaccessibleProperties}},"input"),Ae?(0,G.jsx)("div",{style:Ue.assistantOverlay,onClick:_e}):null]})]}),ge.length>0&&xe?(0,G.jsx)(wt,{errorMessagesWithRange:ge}):N,Ae?(0,G.jsx)(F().D,{experimentId:"formula_assistant",groups:{on:(0,G.jsx)(O,{formulaAssistantStore:Fe,onStop:Ne,onSubmit:Ve})}}):null,!_&&!Ae&&(0,G.jsxs)("div",{style:Ue.bottomSection,children:[(0,G.jsx)("div",{style:Ue.leftColumn,children:(0,G.jsx)(Re,{store:te,context:U,selection:ie,cursorEditorInfo:be,cursorEditorInfoRef:Ce,onChange:oe,getRecordModel:e.getRecordModel,setInfoHelper:Se})}),!q.isMobile&&(0,G.jsx)("div",{style:Ue.rightColumn,children:(0,G.jsx)(Te,{infoHelper:Ie,getRecordModel:e.getRecordModel,style:Ue.infoHelper,typecheckContextValues:U.valueTypes})})]})]})})}const wt=o.memo((function(e){let{errorMessagesWithRange:t}=e;const o=(0,a().yK)((e=>({errors:{display:"flex",flexDirection:"row",alignItems:"start",padding:10,fontSize:h().JB.UISmall.desktop,width:"100%",borderTop:`1px solid ${e.outlineButtonBorder}`,color:e.darkTextColor,flexShrink:0},icon:{width:14,height:14,fill:e.icon.uiRedPrimary,display:"inline",marginRight:3,marginTop:2},errorMessages:{color:e.text.uiRedPrimary}})),[]);return 0===t.length?null:(0,G.jsxs)("div",{style:o.errors,children:[(0,n(764153).l)(o.icon),(0,G.jsx)("span",{style:o.errorMessages,children:t.slice(0,3).map(((e,t)=>(0,G.jsx)(Ft,{shouldAddLeadingSpace:t>0,errorMessageWithRange:e},t)))})]})})),Ft=o.memo((function(e){let{errorMessageWithRange:t,shouldAddLeadingSpace:n}=e;const{msg:o,range:i}=t,r=(0,a().yK)((()=>({errorRange:{opacity:.75}})),[]);return(0,G.jsxs)(G.Fragment,{children:[n?" ":null,o,void 0!==i&&(0,G.jsxs)(G.Fragment,{children:[" ",(0,G.jsx)("span",{style:r.errorRange,children:`[${i.startIndex},${i.endIndex}]`})]})]})}))},37623:(e,t,n)=>{n.d(t,{r:()=>g});n(241792);var o=n(667294),i=()=>n(998411),r=()=>n(582900),a=()=>n(955620),l=()=>n(572948),s=()=>n(513670),u=()=>n(205228),p=()=>n(338530),d=()=>n(435441),c=()=>n(527278),m=()=>n(179809),y=()=>n(749826),f=()=>n(138912),x=n(785893);function g(e){const{currentUserId:t,errorRanges:n,getPublicBaseUrlForPage:d,isAndroid:g,isMobileNative:v,isSafariOrIOS:b,isWindows:k,parentSpaceId:C,Prism:I,store:S,theme:M,valueTypes:T,textValue:w}=e,F=a().QaF(w),j="notion",A=I.languages[j],P=document.createElement("div"),E=I.highlight(F,A,j);P.innerHTML=m().g7(E);const D=s().oA(Array.from(P.childNodes).map(h));let B=w;for(const o of n)B=a().WO0({annotation:[a().GKr.FormulaError],selection:o,textValue:B});const R=function(e){let{syntaxTokens:t,textValue:n,store:o,parentSpaceId:r,valueTypes:s,theme:d,isAndroid:g,isSafariOrIOS:h,isWindows:v,isMobileNative:b,currentUserId:k,getPublicBaseUrlForPage:C}=e;const I=m().kF(n,t),S=n.map(a().hDy).map(((e,t)=>l().fn({annotations:e,theme:d,getRecordModel:o.getRecordModel,spaceId:r})));return I.map(((e,t)=>{const m=n[e.textTokenIndex],I=S[e.textTokenIndex];return a().km_(m)?(0,l().$i)({args:{textValue:{value:n,spaceId:r},getRecordModel:o.getRecordModel,getRecordRole:o.getRecordRole,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableLinks:!1,userTimeZone:(0,i().r)(),disabled:!1,isAndroid:g,isSafariOrIOS:h,isWindows:v,showEmojiInline:v,emojiType:"raw",highlightDiscussionId:void 0,theme:d,intl:c().Z.getIntl(),renderedPageBlockId:void 0,parentBlockId:void 0,katex:void 0,isClient:!0,baseUrl:u().default.domainBaseUrl,publicDomainName:u().default.publicDomainName,currentUserId:k,getPublicBaseUrlForPage:C,externalIntegrations:f().default.integrations.state,formulaValueTypes:s,emojiData:p().Z.state,isMobileNative:b,isMobileNativeExternalLinkFixEnabled:y().default.checkGate({gateName:"mobile_native_external_link_fix"}),displayInUserTimezone:y().default.checkGate({gateName:"display_date_in_user_timezone"})},style:I.style,classNames:I.classNames,index:t,token:m,tokenValue:a().WiV(m),tokenAnnotations:a().hDy(m)}):(0,x.jsx)("span",{className:[e.classNames||"",...I.classNames].join(" "),style:I.style,"data-token-index":e.textTokenIndex,children:e.value},t)}))}({store:S,parentSpaceId:C,valueTypes:T,syntaxTokens:s().oA(D),textValue:w,theme:M,isAndroid:g,isSafariOrIOS:b,isWindows:k,isMobileNative:v,getPublicBaseUrlForPage:d,currentUserId:t}),V=(0,x.jsxs)(o.Fragment,{children:[R,(0,x.jsx)("span",{children:"\n"})]});return r().Z.renderToStaticMarkup(V)}function h(e){return d().Gs(e)?[e.data]:d().kK(e)?[e.textContent||"",e.className]:void 0}},179809:(e,t,n)=>{n.d(t,{g7:()=>a,kF:()=>s});n(670560),n(122556),n(582845),n(250570),n(533019),n(721473),n(788208),n(22624),n(267602),n(30005),n(241792),n(731107);var o=()=>n(955620),i=()=>n(513670),r=()=>n(435441);function a(e){let t="";const n=document.createElement("div");n.innerHTML=e;const o=r().kd(n);for(const r of o){const e=i().YU(r.data);if(null!==r.parentElement&&r.parentElement!==n){t+=`<span class="${l({parent:r.parentElement,root:n}).join(" ")}">${e}</span>`}else t+=e}return t}function l(e){const{parent:t,root:n}=e,o=new Set;let i=t;for(;i&&i!==n;)i.classList.forEach((e=>{o.add(e)})),i=i.parentElement??void 0;return Array.from(o)}function s(e,t){const n={text:u(e),syntax:u(t)},i=function(e){let t=0;return e.reduce(((e,n)=>(e.push([t,n]),t+=n,e)),[])}(function(e,t){const n=e.slice(),o=t.slice(),i=[];let r=0,a=0;for(;r<n.length&&a<o.length;){const e=n[r],t=o[a];e===t?(i.push(e),r+=1,a+=1):e<t?(i.push(e),r+=1,o[a]-=e):(i.push(t),n[r]-=t,a+=1)}return i}(n.text,n.syntax)),r={text:0,syntax:0},a={text:0,syntax:0},l=[],s=e.map(o().WiV).join("");for(const[o,u]of i){const e=o+u,i=t[r.syntax],d={value:s.substring(o,e),textTokenIndex:r.text,classNames:(p=i,p&&p[1])};l.push(d);const c=n.text[r.text],m=n.syntax[r.syntax];e>=a.text+c&&(r.text+=1,a.text+=c),e>=a.syntax+m&&(r.syntax+=1,a.syntax+=m)}var p;return l}function u(e){return e.map((e=>e[0].length))}},282628:(e,t,n)=>{n.d(t,{V:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("checkboxSquareChecked",{viewBox:"0 0 14 14",svg:(0,o.jsx)("path",{d:"M2.85742 13.4561H11.1357C12.6123 13.4561 13.3779 12.6904 13.3779 11.2344V2.91504C13.3779 1.45215 12.6123 0.693359 11.1357 0.693359H2.85742C1.38086 0.693359 0.615234 1.45215 0.615234 2.91504V11.2344C0.615234 12.6973 1.38086 13.4561 2.85742 13.4561ZM2.93945 12.1162C2.30371 12.1162 1.95508 11.7812 1.95508 11.1182V3.02441C1.95508 2.36133 2.30371 2.0332 2.93945 2.0332H11.0537C11.6826 2.0332 12.0381 2.36133 12.0381 3.02441V11.1182C12.0381 11.7812 11.6826 12.1162 11.0537 12.1162H2.93945ZM6.26855 10.3115C6.51465 10.3115 6.72656 10.1885 6.87012 9.96973L9.92578 5.19141C10.0146 5.04785 10.0967 4.88379 10.0967 4.72656C10.0967 4.3916 9.7959 4.16602 9.47461 4.16602C9.26953 4.16602 9.08496 4.27539 8.94141 4.50781L6.24121 8.8418L4.96973 7.22168C4.80566 7.00977 4.6416 6.93457 4.43652 6.93457C4.10156 6.93457 3.8418 7.20117 3.8418 7.54297C3.8418 7.70703 3.90332 7.85742 4.01953 8.00098L5.63281 9.96973C5.81738 10.209 6.01562 10.3115 6.26855 10.3115Z"})})},135515:(e,t,n)=>{n.d(t,{A:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("plusMedium",{viewBox:"0 0 16 16",svg:(0,o.jsx)("g",{children:(0,o.jsx)("path",{d:"M2 8a.77.77 0 01.237-.566.762.762 0 01.566-.244h4.394V2.803a.77.77 0 01.237-.566A.773.773 0 018 2c.225 0 .416.079.573.237a.773.773 0 01.237.566V7.19h4.387c.22 0 .409.081.566.244A.773.773 0 0114 8a.781.781 0 01-.237.573.785.785 0 01-.566.23H8.81v4.401a.764.764 0 01-.237.56A.781.781 0 018 14a.773.773 0 01-.566-.237.764.764 0 01-.237-.559V8.803H2.803a.785.785 0 01-.566-.23A.781.781 0 012 8z"})})})},947189:(e,t,n)=>{n.d(t,{J:()=>o().J});var o=()=>n(121183)},963966:(e,t,n)=>{n.d(t,{p:()=>o().p});var o=()=>n(401506)},985695:(e,t,n)=>{n.d(t,{S:()=>o().S});var o=()=>n(726457)}}]);