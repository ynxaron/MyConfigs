"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[54307],{860285:(e,t,o)=>{o.d(t,{Z:()=>ie,v:()=>ne});o(821057),o(670560),o(267602),o(653476),o(470928),o(241792);var n=o(667294),i=()=>o(219727),r=()=>o(142735),l=()=>o(846550),a=()=>o(506347),s=()=>o(226413),c=()=>o(766933),d=()=>o(874459),p=()=>o(109477),u=()=>o(788860),m=()=>o(513670),S=()=>o(342792),g=()=>o(707513),w=()=>o(250303),y=()=>o(139224),f=()=>o(421654),b=()=>o(497065),v=()=>o(435168),h=()=>o(269299),x=()=>o(932753),C=()=>o(887430),_=()=>o(154186),j=()=>o(448419),T=()=>o(291198),V=()=>o(198829),k=()=>o(967092),K=()=>o(388284),M=()=>o(667637),B=()=>o(718959),P=()=>o(412511),F=()=>o(527278);const Z=(0,u().vU)({none:{defaultMessage:"None",id:"database.viewPropertiesMenu.coverFormat.none"},page_content:{defaultMessage:"Page content",id:"database.viewPropertiesMenu.coverFormat.pageContent"},page_cover:{defaultMessage:"Page cover",id:"database.viewPropertiesMenu.coverFormat.pageCover"}}),H=(0,u().vU)({small:{defaultMessage:"Small",id:"database.viewPropertiesMenu.coverSize.small"},medium:{defaultMessage:"Medium",id:"database.viewPropertiesMenu.coverSize.medium"},large:{defaultMessage:"Large",id:"database.viewPropertiesMenu.coverSize.large"}});function A(e){return e?"page_content"===e.type?F().Z.formatMessage(Z.page_content):"page_cover"===e.type?F().Z.formatMessage(Z.page_cover):void 0:F().Z.formatMessage(Z.none)}function O(e){switch(e){case"small":return F().Z.formatMessage(H.small);case"medium":return F().Z.formatMessage(H.medium);case"large":return F().Z.formatMessage(H.large)}}var z=()=>o(559729),I=()=>o(270315),L=()=>o(605890),W=()=>o(429725),U=()=>o(352230),R=()=>o(148126),E=()=>o(142589),D=()=>o(876822),Q=()=>o(919775),Y=()=>o(482162),G=()=>o(576447),N=()=>o(446955),q=()=>o(508858),$=()=>o(949719),X=()=>o(477253),J=o(785893);const ee=6,te=6,oe=(0,u().vU)({week:{defaultMessage:"Week",id:"calendar.viewRanges.week"},month:{defaultMessage:"Month",id:"calendar.viewRanges.month"}});function ne(e){const{currentViewType:t,theme:o}=e,n=t?L().Ls[t]:void 0;return["side_peek","center_peek","full_page"].map((e=>({key:e,type:"button",title:(0,L().LQ)(e),body:(0,J.jsxs)(J.Fragment,{children:[(0,L().RI)(e),n&&t&&e===n&&(0,J.jsx)("div",{style:{marginTop:2,fontWeight:500,color:o.blueColor},children:(0,J.jsx)(u()._H,{defaultMessage:"Default for {view}",id:"database.viewPropertiesMenu.peekMode.defaultForView",values:{view:I().Bh[t]}})})]}),icon:(0,L().RO)(e)({width:16,fill:o.mediumTextColor})})))}const ie=(0,u().XN)((function(e){let{collectionContextStore:t,showDoneButton:a,collectionSettingsStore:c}=e;const d=(0,l().Fg)(),p=(0,i().O7)(),m=(0,i().Fy)(),S=(0,n.useCallback)((e=>(0,J.jsx)(_e,{collectionContextStore:t,viewType:e},`view-type-button-${e}`)),[t]),g=(0,r().Kw)(t.normalizedQueryStore),b=(0,r().Kw)(t.normalizedSchemaStore),v=(0,r().Kw)(t.normalizedFormatStore),x=(0,r().Kw)(t.isFullScreenStore),C=(0,r().Kw)(t.isRootChildStore),_=(0,r().VK)((()=>t.collectionViewBlockStore()),[t]),j=(0,r().VK)((()=>re(t)),[t]),T=(0,r().VK)((()=>Boolean(le(t))),[t]),V="table"===j||"board"===j||"gallery"===j||"calendar"===j,k="table"===j,P=Object.keys(b).filter((e=>{const t=b[e];return t&&(0,s().Lt)(t)})),F="timeline"===j&&P.length>0,Z=(0,r().VK)((()=>"timeline"===j&&P.length>1&&_&&!(0,B().qG)(_.id)),[j,P,_]),H="timeline"===j&&Boolean(null==g?void 0:g.timeline_by_end),A="calendar"===j&&P.length>0,O=(0,r().VK)((()=>"calendar"===j),[j]),z="calendar"===j,I="board"===j,L=(0,r().VK)((()=>(0,o(701182).d$)({environment:p,isFullScreen:x,isRootChild:C})),[p,x,C]),W="timeline"===j&&Boolean(v.timeline_show_table)&&L,U="timeline"===j&&L,D=(0,r().VK)((()=>null==_?void 0:_.getCollectionViewSourceCollectionStore()),[_]),Q=(0,r().VK)((()=>!("collectionTypedView"===t.contextType||t.isInHomeWidgetStore.state||D&&x)),[t,D,x]),Y=(0,r().VK)((()=>!t.isInHomeWidgetStore.state&&"chart"!==j),[t.isInHomeWidgetStore,j]),N=(0,r().VK)((()=>"chart"!==j),[j]),q=(0,r().Kw)(t.permissionScopesStore),$=(0,r().Kw)(t.shouldShowSourceStore),X=(0,r().VK)((()=>"chart"===j),[j]),ee=(0,r().VK)((()=>"chart"===j),[j]),{isPostsEnabled:te,isFeedOutsidePostsEnabled:oe}=(0,r().VK)((()=>({isPostsEnabled:(0,E().U)({isMobileNative:m.isMobileNative,disableExposureLogging:!0}),isFeedOutsidePostsEnabled:(0,E().x)({disableExposureLogging:!0})})),[m]);if(!_)return null;const ne="page"===j,ie=Q||T||k||V||ne||F||H||Z||A||z||O||U||W||I||Y||N,ae=["table","board","timeline","calendar","list","gallery","chart"];return te&&oe&&ae.push("feed"),(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(K().Z,{topBorder:!1,shouldShowBottomDivider:m.isMobile,children:(0,J.jsx)("div",{style:{...!m.isMobile&&{width:"100%",paddingLeft:8,paddingRight:8},...m.isMobile&&{background:d.contentBackground,width:"100%",paddingTop:12,paddingBottom:12}},children:(0,J.jsx)("div",{style:{display:"flex",flexFlow:"wrap"},children:ae.map(S)})})}),ie&&(0,J.jsxs)(K().Z,{children:[Q&&(0,J.jsx)(M().Z,{title:(0,J.jsx)(u()._H,{defaultMessage:"Show database title",id:"database.viewSettings.layoutTab.showDatabaseTitle.title"}),focused:!1,on:$,onClick:()=>function(e,t){const o=t.collectionViewStore();if(!o)return;const n=!t.shouldShowSourceStore.state;h().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleShowCollectionTitleClick",environment:e,canUndo:!0,perform:e=>{f().FH({stores:[o],update:{hide_linked_collection_name:!n},transaction:e})}}),w().wd({environment:e,collectionContextStore:t,action:"toggle_show_collection_title"})}(p,t),disabled:!q.canConfigureBlock,textWrapperStyle:{opacity:1}}),T&&(0,J.jsx)(Ce,{collectionContextStore:t}),k&&(0,J.jsx)(we,{collectionContextStore:t}),V&&(0,J.jsx)(ye,{collectionContextStore:t}),ne&&(0,J.jsx)(ce,{collectionContextStore:t}),F&&(0,J.jsx)(de,{collectionContextStore:t}),H&&(0,J.jsx)(pe,{collectionContextStore:t}),Z&&(0,J.jsx)(fe,{collectionContextStore:t}),A&&(0,J.jsx)(ue,{collectionContextStore:t}),z&&(0,J.jsx)(be,{collectionContextStore:t}),O&&(0,J.jsx)(ve,{collectionContextStore:t}),U&&(0,J.jsx)(o(818951).N,{collectionContextStore:t}),W&&(0,J.jsx)(me,{collectionContextStore:t,collectionSettingsStore:c}),I&&(0,J.jsx)(Se,{collectionContextStore:t,collectionSettingsStore:c}),Y&&(0,J.jsx)(he,{collectionContextStore:t}),N&&(0,J.jsx)(xe,{collectionContextStore:t})]}),a&&(0,J.jsx)(K().Z,{disableMobileBorders:!0,children:(0,J.jsx)(o(906651).Z,{style:{display:"flex",margin:"0 14px"},onClick:()=>function(e,t,o){y().wl({collectionSettingsStore:t,item:{type:"main"}}),w().wd({environment:e,collectionContextStore:o,action:"click_create_view_done"})}(p,c,t),children:ee?(0,J.jsx)(u()._H,{defaultMessage:"Edit chart",id:"database.viewSettings.createViewTab.editChartButton.title"}):(0,J.jsx)(u()._H,{defaultMessage:"Done",id:"database.viewSettings.createViewTab.doneButton.title"})})}),X?(0,J.jsx)(K().Z,{topBorder:!1,children:(0,J.jsx)(G().Z,{href:(0,R().UY)("guides.charts"),title:(0,J.jsx)(u()._H,{defaultMessage:"Learn about charts",id:"database.viewSettings.layoutTab.learnAboutCharts.title"}),analyticsFrom:"view_settings_layout"})}):(0,J.jsx)(K().Z,{topBorder:!1,children:(0,J.jsx)(G().Z,{href:(0,R().UY)("guides.databaseView"),title:(0,J.jsx)(u()._H,{defaultMessage:"Learn about views",id:"database.viewSettings.layoutTab.learnMoreButton.title"}),analyticsFrom:"view_settings_layout"})})]})}));function re(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}function le(e){return I().DL[re(e)]}function ae(e){return I().oy[re(e)]}function se(e){return I()._Y[re(e)]}function ce(e){let{collectionContextStore:t}=e;const o=(0,i().O7)(),n=(0,r().VK)((()=>t.collectionViewStore()),[t]);return n?(0,J.jsx)("div",{style:{padding:5},children:(0,J.jsx)(T().Z,{showClearButton:!0,placeholder:"Enter page ID",focusInitial:!0,onChange:e=>{Q().Z.setState({pageId:e.target.value})},onSubmit:e=>{const t=Q().Z.state.pageId;t&&h().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderPageViewSettings",environment:o,canUndo:!0,perform:e=>{f().FH({stores:[n],update:{page_pointer:{id:(0,S().Mt)(t),spaceId:e.spaceId,table:"block"}},transaction:e})}})}})}):null}function de(e){let{collectionContextStore:t}=e;const o=(0,i().O7)(),n=(0,i().MO)(),l=(0,r().VK)((()=>{var e;return null===(e=t.normalizedQueryStore.state)||void 0===e?void 0:e.timeline_by}),[t]),a=(0,r().VK)((()=>{var e;return null===(e=t.normalizedQueryStore.state)||void 0===e?void 0:e.timeline_by_end}),[t]),c=(0,r().Kw)(t.permissionScopesStore),d=(0,r().Kw)(t.normalizedSchemaStore),p=(0,r().VK)((()=>t.collectionViewStore()),[t]),m=(0,r().VK)((()=>t.collectionStore()),[t]),S=(0,r().VK)((()=>null==m?void 0:m.getSchema()),[m]),y=(0,r().VK)((()=>null==m?void 0:m.getFormat()),[m]);if(!(l&&p&&m&&y&&S))return null;const f=d[l];return f?(0,J.jsx)(j().ZP,{popupType:n?k().kQ.SlideUp:k().kQ.Popup,alignmentToOrigin:j().vR.End,placementToOrigin:j().pO.Bottom,originGap:0,renderOrigin:e=>(0,J.jsx)(N().Z,{title:a?(0,J.jsx)(u()._H,{defaultMessage:"Start date",id:"database.viewSettings.layoutTab.timelineStartDate.title"}):(0,J.jsx)(u()._H,{defaultMessage:"Show timeline by",id:"database.viewSettings.layoutTab.showTimelineByProperty.title"}),disabled:!c.canConfigureBlock,showChevron:!0,right:(0,J.jsx)("div",{style:g().Yu,children:f.name}),rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0},...e}),render:e=>{let i;return i=n?{menuType:U().o.ActionSheet}:{menuType:U().o.Popup,width:300},(0,J.jsx)(V().Z,{...i,children:(0,J.jsx)($().Z,{schema:S,format:y,currentProperty:l,getProperties:()=>Object.keys(d).filter((e=>{const t=d[e];return t&&(0,s().Lt)(t)})),onAccept:n=>{n&&(h().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderTimelineBySetting",environment:o,canUndo:!0,perform:e=>{x().Es({collectionViewStore:p,update:{timeline_by:n},transaction:e})}}),e.close(),w().wd({environment:o,collectionContextStore:t,action:"update_timeline_by",original_view_type:void 0,property_type:f.type}))}})})}}):null}function pe(e){let{collectionContextStore:t}=e;const o=(0,i().O7)(),n=(0,i().MO)(),l=(0,r().VK)((()=>{var e;return null===(e=t.normalizedQueryStore.state)||void 0===e?void 0:e.timeline_by_end}),[t]),a=(0,r().Kw)(t.permissionScopesStore),c=(0,r().Kw)(t.normalizedSchemaStore),d=(0,r().VK)((()=>t.collectionViewStore()),[t]),p=(0,r().VK)((()=>t.collectionStore()),[t]),m=(0,r().VK)((()=>null==p?void 0:p.getSchema()),[p]),S=(0,r().VK)((()=>null==p?void 0:p.getFormat()),[p]);if(!(l&&d&&p&&S&&m))return null;const g=c[l];return g?(0,J.jsx)(j().ZP,{popupType:n?k().kQ.SlideUp:k().kQ.Popup,alignmentToOrigin:j().vR.End,placementToOrigin:j().pO.Bottom,originGap:0,renderOrigin:e=>(0,J.jsx)(N().Z,{title:(0,J.jsx)(u()._H,{defaultMessage:"End date",id:"database.viewSettings.layoutTab.timelineEndDate.title"}),showChevron:!0,right:g.name,disabled:!a.canConfigureBlock,...e}),render:e=>{let i;return i=n?{menuType:U().o.ActionSheet}:{menuType:U().o.Popup,width:300},(0,J.jsx)(V().Z,{...i,children:(0,J.jsx)($().Z,{schema:m,format:S,currentProperty:l,getProperties:()=>Object.keys(c).filter((e=>{const t=c[e];return t&&(0,s().Lt)(t)})),onAccept:n=>{n&&(h().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderTimelineEndSetting",environment:o,canUndo:!0,perform:e=>{x().Es({collectionViewStore:d,update:{timeline_by_end:n},transaction:e})}}),e.close(),w().wd({environment:o,collectionContextStore:t,action:"update_timeline_by_end",original_view_type:void 0,property_type:g.type}))}})})}}):null}function ue(e){let{collectionContextStore:t}=e;const o=(0,i().O7)(),n=(0,i().MO)(),l=(0,r().VK)((()=>{var e;return null===(e=t.normalizedQueryStore.state)||void 0===e?void 0:e.calendar_by}),[t]),a=(0,r().Kw)(t.permissionScopesStore),c=(0,r().Kw)(t.normalizedSchemaStore),d=(0,r().VK)((()=>t.collectionViewStore()),[t]),p=(0,r().VK)((()=>t.collectionStore()),[t]),m=(0,r().VK)((()=>null==p?void 0:p.getSchema()),[p]),S=(0,r().VK)((()=>null==p?void 0:p.getFormat()),[p]);if(!(l&&d&&p&&S&&m))return null;const y=c[l];return y?(0,J.jsx)(j().ZP,{popupType:n?k().kQ.SlideUp:k().kQ.Popup,alignmentToOrigin:j().vR.End,placementToOrigin:j().pO.Bottom,originGap:0,renderOrigin:e=>(0,J.jsx)(N().Z,{title:(0,J.jsx)(u()._H,{defaultMessage:"Show calendar by",id:"database.viewSettings.layoutTab.showCalendarByProperty.title"}),disabled:!a.canConfigureBlock,showChevron:!0,right:(0,J.jsx)("div",{style:g().Yu,children:y.name}),rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0},...e}),render:e=>{let i;return i=n?{menuType:U().o.ActionSheet}:{menuType:U().o.Popup,width:300},(0,J.jsx)(V().Z,{...i,children:(0,J.jsx)($().Z,{schema:m,format:S,currentProperty:l,getProperties:()=>Object.keys(c).filter((e=>{const t=c[e];return t&&(0,s().Lt)(t)})),onAccept:n=>{n&&(h().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderCalendarBySetting",environment:o,canUndo:!0,perform:e=>{x().Es({collectionViewStore:d,update:{calendar_by:n},transaction:e})}}),e.close(),w().wd({environment:o,collectionContextStore:t,action:"update_calendar_by",original_view_type:void 0,property_type:y.type}))}})})}}):null}function me(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,i().O7)(),l=((0,r().Kw)(t.normalizedFormatStore).timeline_table_properties||[]).filter((e=>Boolean(e.visible))).length,a=(0,r().Kw)(t.permissionScopesStore);return(0,J.jsx)(N().Z,{title:(0,J.jsx)(u()._H,{defaultMessage:"Table properties",id:"database.viewSettings.layoutTab.tablePropertiesButton.title"}),showChevron:!0,right:(0,J.jsx)(u()._H,{defaultMessage:"{propertiesShown} shown",id:"database.viewSettings.layoutTab.propertiesButton.propertiesShown.title",values:{propertiesShown:l}}),onClick:()=>{y().H4({collectionSettingsStore:o,item:{type:"properties",timelineViewTab:"table"}}),w().wd({environment:n,collectionContextStore:t,action:"click_timeline_table_properties"})},disabled:!a.canConfigureBlock})}function Se(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,i().O7)(),l=(0,r().VK)((()=>t.normalizedFormatStore.state.board_columns_by),[t]),a=(0,r().Kw)(t.normalizedSchemaStore),s=(0,r().Kw)(t.permissionScopesStore),c=(0,r().VK)((()=>(0,z().h6)(t.normalizedFormatStore.state)),[t]);if(!l)return null;const d=a[l.property];return d?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(N().Z,{title:(0,J.jsx)(u()._H,{defaultMessage:"Group by",id:"database.viewSettings.layoutTab.boardGroupByButton.title"}),showChevron:!0,right:d.name,onClick:()=>{y().H4({collectionSettingsStore:o,item:{type:"group",groupByKey:"board_columns_by",groupsFormatKey:"board_columns"}}),w().wd({environment:n,collectionContextStore:t,action:"click_board_group_by",original_view_type:void 0,property_type:d.type})},disabled:!s.canConfigureBlock}),(0,J.jsx)(M().Z,{title:(0,J.jsx)(u()._H,{defaultMessage:"Color columns",id:"database.viewSettings.groupTab.colorColumns"}),on:!c,focused:!1,onClick:()=>{y().iN({environment:n,collectionContextStore:t})},disabled:!s.canConfigureBlock,textWrapperStyle:{opacity:1}})]}):null}function ge(e,t,o){const n=o.collectionViewStore();if(!n)return;const{serverCommitResult:i}=h().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleViewRangeOptionClick",environment:t,canUndo:!0,perform:t=>{f().FH({stores:[n],update:{calendar_view_range:e},transaction:t})}}),r=B().AK.state,l=o.dateRangeStartStore.state,a=o.dateRangeEndStore.state,{newDateRangeStart:s,newDateRangeEnd:c}=function(e){const{newViewRange:t,oldCalendarStart:o,startOfWeekSetting:n}=e;if("month"===t){const e=(0,d().IS)(new Date((0,d().V7)(o,n)).getDate()>7?(0,d().kl)(o):o,n);return{newDateRangeStart:e,newDateRangeEnd:(0,d().V7)((0,d()._)({date:e,monthsToAdd:1}),n)}}return{newDateRangeStart:(0,d().IS)(Date.now(),n),newDateRangeEnd:(0,d().V7)(Date.now(),n)}}({oldCalendarStart:l,newViewRange:e,startOfWeekSetting:r});x().t5({dateRangeStart:s,dateRangeEnd:c,collectionContextStore:o}),i.then((()=>{w().wd({environment:t,collectionContextStore:o,action:"update_calendar_view_range"}),(0,P().Xq)({newCalendarStart:s,newCalendarEnd:c,collectionViewId:n.id,currentUserId:t.currentUser.id})})).catch((()=>{x().t5({dateRangeStart:l,dateRangeEnd:a,collectionContextStore:o})}))}function we(e){let{collectionContextStore:t}=e;const o=(0,i().O7)(),n=(0,r().Kw)(t.permissionScopesStore),l=(0,r().VK)((()=>!Boolean(t.normalizedFormatStore.state.hide_table_vertical_lines)),[t]);return(0,J.jsx)(M().Z,{title:(0,J.jsx)(u()._H,{defaultMessage:"Show vertical lines",id:"database.viewSettings.layoutTab.tableShowVerticalLines"}),on:l,focused:!1,onClick:()=>function(e,t){const o=t.collectionViewStore();if(!o)return;const n=Boolean(t.normalizedFormatStore.state.hide_table_vertical_lines);v().AU({environment:e,collectionViewStore:o,currentValue:n}),w().wd({environment:e,collectionContextStore:t,action:"toggle_table_vertical_lines"})}(o,t),disabled:!n.canConfigureBlock,textWrapperStyle:{opacity:1}})}function ye(e){var t;let{collectionContextStore:o}=e;const l=(0,i().O7)(),a=(0,r().Kw)(o.normalizedFormatStore),s=(0,r().Kw)(o.permissionScopesStore),c=(0,r().VK)((()=>re(o)),[o]),d=a.table_wrap||"calendar"===c&&!0===(null==a||null===(t=a.calendar_properties)||void 0===t||null===(t=t.find((e=>"title"===e.property)))||void 0===t?void 0:t.wrap),p=(0,n.useMemo)((()=>{switch(c){case"table":return(0,J.jsx)(u()._H,{defaultMessage:"Wrap all columns",id:"database.viewSettings.layoutTab.tableWrapAllColumns"});case"calendar":return(0,J.jsx)(u()._H,{defaultMessage:"Wrap page titles",id:"database.viewSettings.layoutTab.calendarWrapTitle"});default:return(0,J.jsx)(u()._H,{defaultMessage:"Wrap all properties",id:"database.viewSettings.layoutTab.tableWrapAllProperties"})}}),[c]),m=(0,n.useCallback)((()=>{const e=o.collectionViewStore();e&&(v().MD({environment:l,collectionViewStore:e,currentValue:Boolean(d)}),w().wd({environment:l,collectionContextStore:o,action:"set_first_load_limit"}),w().wd({environment:l,collectionContextStore:o,action:"toggle_table_wrap_cells"}))}),[o,l,d]);return(0,J.jsx)(M().Z,{title:p,on:Boolean(d),focused:!1,onClick:m,disabled:!s.canConfigureBlock,textWrapperStyle:{opacity:1}})}function fe(e){let{collectionContextStore:t}=e;const o=(0,i().O7)(),n=(0,r().Kw)(t.normalizedQueryStore),l=null==n?void 0:n.timeline_by_end,a=(0,r().Kw)(t.permissionScopesStore);return(0,J.jsx)(M().Z,{title:(0,J.jsx)(u()._H,{defaultMessage:"Separate start and end dates",id:"database.viewSettings.layoutTab.timelineUseSeparateDates.title"}),focused:!1,on:Boolean(l),onClick:()=>function(e,t){const o=t.normalizedQueryStore.state,n=t.collectionViewStore(),i=null==o?void 0:o.timeline_by,r=null==o?void 0:o.timeline_by_end;if(!i||!n)return;const l=r?void 0:i;h().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleTimelineSeparateDatesClick",environment:e,canUndo:!0,perform:e=>{x().Es({collectionViewStore:n,update:{timeline_by_end:l??null},transaction:e})}}),w().wd({environment:e,collectionContextStore:t,action:"toggle_timeline_separate_dates"})}(o,t),disabled:!a.canConfigureBlock,textWrapperStyle:{opacity:1}})}function be(e){let{collectionContextStore:t}=e;const o=(0,i().O7)(),l=(0,r().Kw)(t.permissionScopesStore),a=(0,r().VK)((()=>function(e){const t=e.normalizedFormatStore.state;return(null==t?void 0:t.calendar_view_range)||"month"}(t)),[t]),s=(0,r().VK)((()=>"peekModeFormat"===t.settingsStore.state.openButtonPopup),[t]),c=(0,n.useMemo)((()=>["month","week"].map((e=>({key:e,type:"button",title:F().Z.formatMessage(oe[e])})))),[]);return(0,J.jsx)(q().Z,{title:(0,J.jsx)(u()._H,{defaultMessage:"Show calendar as",id:"database.viewSettings.layoutTab.showCalendarAs.title"}),collectionContextStore:t,openButtonPopup:s,selectedKey:a,popupStyle:{minWidth:190},options:c,onChange:e=>ge(e,o,t),disabled:!l.canConfigureBlock})}function ve(e){let{collectionContextStore:t}=e;const o=(0,i().O7)(),l=(0,r().VK)((()=>{var e;return Boolean((null===(e=t.collectionViewStore())||void 0===e?void 0:e.getFormatStore().getKeyStore("calendar_show_weekends").getValue())??!0)}),[t]),a=(0,n.useCallback)((()=>{const e=t.collectionViewStore();e&&(h().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleToggleShowWeekends",environment:o,canUndo:!0,perform:t=>{f().FH({stores:[e],update:{calendar_show_weekends:!l},transaction:t})}}),w().wd({environment:o,collectionContextStore:t,action:"toggle_calendar_show_weekends"}))}),[t,o,l]);return(0,J.jsx)(X().Z,{title:(0,J.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,J.jsx)(u()._H,{defaultMessage:"Show weekends",id:"database.viewSettings.layoutTab.showWeekends.title"})}),showChevron:!1,switcherProps:{on:l,noColor:!1},onClick:a})}function he(e){let{collectionContextStore:t}=e;const o=(0,l().Fg)(),n=(0,i().O7)(),s=(0,r().Kw)(t.permissionScopesStore),c=(0,r().VK)((()=>function(e){const t=e.normalizedFormatStore.state,o=re(e);return(null==t?void 0:t.collection_peek_mode)||L().Ls[o]}(t)),[t]),d=(0,r().VK)((()=>"peekModeFormat"===t.settingsStore.state.openButtonPopup),[t]),p=(0,r().VK)((()=>re(t)),[t]);return(0,J.jsx)(q().Z,{title:(0,J.jsx)(u()._H,{defaultMessage:"Open pages in",id:"database.viewSettings.layoutTab.peekModeTitle"}),collectionContextStore:t,openButtonPopup:d,selectedKey:c,popupStyle:{minWidth:190},options:ne({currentViewType:p,theme:o}),menuItemOptionsStyle:{paddingTop:8,paddingBottom:8},onClick:()=>function(e,t){w().nS({environment:e,collectionContextStore:t,from:"collection_view_settings"})}(n,t),onChange:e=>function(e,t,o){const n=o.collectionViewStore();if(n&&e&&(h().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handlePeekModeFormatClick",environment:t,canUndo:!0,perform:t=>{f().FH({stores:[n],update:{collection_peek_mode:e},transaction:t})}}),w().gl({environment:t,collectionContextStore:o,peek_mode:e,from:"collection_view_settings"}),Y().default.state.open&&Y().default.state.collectionContextStore===o)){const{mainEditorCurrentBlockStore:o}=D().default.state,n="full_page"===e?(0,W().ZP)({store:Y().default.state.targetStore,fullyQualified:!1,pageVisitSource:a().tY.Expand}):(0,C().mb)({environment:t,store:Y().default.state.targetStore,mainEditorCurrentBlockStore:o,collectionContextStore:Y().default.state.collectionContextStore,fullyQualified:!1,overridePeekMode:(0,Y().getPeekModeFromCollectionPeekModeFormat)(e)});n&&b().c4({environment:t,url:n})}}(e,n,t),disabled:!s.canConfigureBlock})}function xe(e){let{collectionContextStore:t}=e;const o=(0,i().O7)(),l=(0,r().Kw)(t.permissionScopesStore),a=(0,r().VK)((()=>t.shouldShowPageIcon()??!0),[t]),s=(0,n.useCallback)((()=>{const e=t.collectionViewStore();e&&(h().createAndCommit({userAction:"CollectionSettingsProperty.TitleOptions.handleToggleShowIcon",environment:o,canUndo:!0,perform:t=>{f().FH({stores:[e],update:{show_page_icon:!a},transaction:t})}}),w().wd({environment:o,collectionContextStore:t,action:"toggle_show_page_icon"}))}),[t,o,a]);return(0,J.jsx)(M().Z,{title:(0,J.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,J.jsx)(u()._H,{defaultMessage:"Show page icon",id:"database.viewSettings.layoutTab.showPageIcon.title"})}),focused:!1,on:a,onClick:s,disabled:!l.canConfigureBlock})}function Ce(e){let{collectionContextStore:t}=e;const o=(0,l().Fg)(),n=(0,i().O7)(),{device:a}=n,s=(0,r().VK)((()=>function(e){const t=e.normalizedFormatStore.state,o=le(e);if(o&&t)return t[o]}(t)),[t]),d=(0,r().VK)((()=>function(e){const t=e.normalizedFormatStore.state,o=ae(e);if(o&&t){const e=t[o];if(e)return e}return p().PZ}(t)),[t]),S=(0,r().VK)((()=>!a.isMobile||"board"===re(t)),[a,t]),g=(0,r().Kw)(t.permissionScopesStore),y=(0,r().VK)((()=>function(e,t,o){const n=o.normalizedSchemaStore.state;let i=Object.keys(n);i=m().MR(i,(e=>{const t=n[e];return t?t.name:""}));const r=m().oA(i.map((o=>{const i=n[o];if(i&&"file"===i.type)return{key:{type:"property",property:o},type:"button",title:i.name,icon:(0,J.jsx)(c().ZP,{type:i.type,icon:i.icon,size:e.device.isMobile?16:14,theme:t,style:{fill:t.regularIconColor}})}})));return[...[void 0,{type:"page_cover"},{type:"page_content"}].map((e=>({key:e,type:"button",title:A(e)}))),...r]}(n,o,t)),[n,o,t]),b=(0,r().VK)((()=>function(e){const t=e.normalizedFormatStore.state,o=se(e);if(o&&t)return t[o]}(t)),[t]);return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(q().Z,{title:(0,J.jsx)(u()._H,{defaultMessage:"Card preview",id:"database.viewSettings.layoutTab.cardPreviewButtonTitle"}),selectedKey:s,popupStyle:{minWidth:190},options:y,onChange:e=>function(e,t,o){const n=le(o),i=o.collectionViewStore();n&&i&&(h().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleCoverFormatChange",environment:t,canUndo:!0,perform:t=>{f().FH({stores:[i],update:{[n]:e},transaction:t})}}),w().wd({environment:t,collectionContextStore:o,action:"update_cover_format"}))}(e,n,t),disabled:!g.canConfigureBlock}),S&&(0,J.jsx)(q().Z,{title:(0,J.jsx)(u()._H,{defaultMessage:"Card size",id:"databdatabase.viewSettings.layoutTab.cardSizeButtonTitle"}),selectedKey:d,popupStyle:{minWidth:190},options:["small","medium","large"].map((e=>({key:e,type:"button",title:O(e)}))),onChange:e=>function(e,t,o){const n=ae(o),i=o.collectionViewStore();n&&i&&(h().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleCoverSizeFormatChange",environment:t,canUndo:!0,perform:t=>{f().FH({stores:[i],update:{[n]:e},transaction:t})}}),w().wd({environment:t,collectionContextStore:o,action:"toggle_cover_size_format"}))}(e,n,t),disabled:!g.canConfigureBlock}),s&&(0,J.jsx)(M().Z,{title:(0,J.jsx)(u()._H,{defaultMessage:"Fit image",id:"databdatabase.viewSettings.layoutTab.fitImageButtonTitle"}),on:"contain"===b,focused:!1,onClick:()=>function(e,t){const o=se(t),n=t.collectionViewStore(),i=t.normalizedFormatStore.state;o&&n&&(h().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleCoverAspectFormatToggle",environment:e,canUndo:!0,perform:e=>{f().FH({stores:[n],update:{[o]:"contain"===i[o]?"cover":"contain"},transaction:e})}}),w().wd({environment:e,collectionContextStore:t,action:"toggle_cover_aspect_format"}))}(n,t),disabled:!g.canConfigureBlock,textWrapperStyle:{opacity:1}})]})}function _e(e){let{viewType:t,collectionContextStore:o}=e;const n=(0,l().Fg)(),a=(0,i().O7)(),s=(0,r().VK)((()=>re(o)),[o]),c=(0,r().Kw)(o.permissionScopesStore),d=s===t,p=d||!c.canConfigureBlock;return(0,J.jsxs)(_().Z,{style:{display:"flex",flexDirection:"column",alignItems:"center",width:`calc(25% - ${2*ee}px)`,flexGrow:0,flexShrink:0,fontSize:11,borderRadius:6,margin:ee,padding:te,boxShadow:`0 0 0 1px ${n.regularDividerColor}`,color:n.mediumTextColor,fill:n.mediumTextColor,...d&&{boxShadow:`0 0 0 2px ${n.blueColor}`,color:n.blueColor,fill:n.blueColor,fontWeight:500}},disabled:p,onClick:()=>{h().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderViewTypeButton",environment:a,canUndo:!0,perform:e=>{x().z2({environment:a,collectionContextStore:o,newViewType:t,transaction:e})}}),w().wd({environment:a,collectionContextStore:o,action:"change_type",original_view_type:s,new_view_type:t})},children:[I().aW[t]({width:void 0,height:20,marginBottom:4,marginTop:4}),(0,J.jsx)("div",{children:I().Bh[t]})]},t)}},818951:(e,t,o)=>{o.d(t,{N:()=>$,Z:()=>X});o(267602),o(653476),o(470928),o(241792);var n=o.n(o(443261)),i=o(667294),r=()=>o(219727),l=()=>o(142735),a=()=>o(846550),s=()=>o(15607),c=()=>o(226413),d=()=>o(532850),p=()=>o(766933),u=()=>o(109477),m=()=>o(788860),S=()=>o(513670),g=()=>o(696459),w=()=>o(707513),y=()=>o(250303),f=()=>o(139224),b=()=>o(853292),v=()=>o(421654),h=()=>o(269299),x=()=>o(932753),C=()=>o(178498),_=()=>o(429158),j=()=>o(827973),T=()=>o(119891),V=()=>o(9641),k=()=>o(1910),K=()=>o(255577),M=()=>o(92175),B=()=>o(388284),P=()=>o(667637),F=()=>o(654133),Z=()=>o(539245),H=()=>o(347577),A=()=>o(514),O=()=>o(164079),z=()=>o(148126),I=()=>o(696347),L=()=>o(109806),W=()=>o(607031),U=()=>o(521777),R=()=>o(739479),E=()=>o(772529),D=()=>o(998901),Q=()=>o(576447),Y=()=>o(446955),G=o(785893);const N=(0,m().vU)({inputPlaceholder:{defaultMessage:"Search for a property…",id:"database.viewSettings.propertiesTab.inputPlaceholder"},toggleFrozenColumnsAriaLabel:{defaultMessage:"Toggle frozen columns",id:"database.viewSettings.propertiesTab.toggleFrozenColumnsAriaLabel"},togglePropertyVisibilityAriaLabel:{defaultMessage:"Toggle property visibility",id:"database.viewSettings.propertiesTab.togglePropertyVisibilityAriaLabel"}}),q=o(263184).default.createClass("",{name:"InputStore"});function $(e){const{collectionContextStore:t,onClick:o}=e,n=(0,r().O7)(),i=(0,l().Kw)(t.normalizedFormatStore),a=Boolean(i.timeline_show_table),s=(0,l().Kw)(t.permissionScopesStore);return(0,G.jsx)(P().Z,{title:(0,G.jsx)(m()._H,{defaultMessage:"Show table",id:"database.viewSettings.propertiesTab.showTable"}),on:a,focused:!1,onClick:()=>{const e=t.collectionViewStore();e&&(h().createAndCommit({userAction:"CollectionSettingsViewProperties.TimelineShowTableSwitcher",environment:n,canUndo:!0,perform:t=>{v().FH({stores:[e],update:{timeline_show_table:!a,timeline_table_properties:[{property:"name",visible:!0}]},transaction:t})}}),null==o||o(),y().wd({environment:n,collectionContextStore:t,action:"timeline_toggle_show_table"}))},disabled:!s.canConfigureBlock,textWrapperStyle:{opacity:1}})}const X=function(e){let{collectionContextStore:t,timelineViewTab:n,collectionSettingsStore:i}=e;const a=(0,r().O7)(),s=(0,l().qz)(void 0,o(692304).Z),c=(0,l().qz)(void 0,q),d=(0,r().Fy)(),p=(0,l().Kw)(c),u=(0,l().VK)((()=>(0,H().WY)({collectionContextStore:t})),[t]),S=(0,l().VK)((()=>(0,H().jI)({timelineViewTab:n,collectionContextStore:t})),[n,t]),g=(0,l().VK)((()=>(0,o(701182).d$)({environment:a,isFullScreen:t.isFullScreenStore.state,isRootChild:t.isRootChildStore.state})),[a,t]);return(0,G.jsxs)(o(205951).ZP,{collectionSettingsStore:i,title:(0,G.jsx)(m()._H,{defaultMessage:"Properties",id:"database.viewSettings.propertiesTab.title"}),header:(0,G.jsx)(B().Z,{children:(0,G.jsx)(o(740046).ZP,{focusInitial:!d.isMobile,value:p,showClearButton:!0,onChange:e=>{c.setState(e.target.value),s.setState({...s.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})},placeholder:o(527278).Z.formatMessage(N.inputPlaceholder)})}),footer:(0,G.jsx)(oe,{collectionContextStore:t,timelineViewTab:n}),children:["timeline"===u&&g&&(0,G.jsx)(de,{collectionSettingsStore:i,collectionContextStore:t,timelineViewTab:n,inputStore:c}),S&&(0,G.jsx)(me,{collectionContextStore:t,collectionSettingsStore:i,inputStore:c,menuListStore:s,formatKey:S}),(0,G.jsx)(B().Z,{children:(0,G.jsx)(ne,{collectionContextStore:t,collectionSettingsStore:i,timelineViewTab:n})})]})};function J(e){let{viewType:t}=e;return"table"===t?(0,G.jsx)(m()._H,{defaultMessage:"Shown in table",id:"database.viewSettings.propertiesTab.shownInTableTitle"}):"timeline"===t?(0,G.jsx)(m()._H,{defaultMessage:"Shown in timeline",id:"database.viewSettings.propertiesTab.shownInTimelineTitle"}):"board"===t?(0,G.jsx)(m()._H,{defaultMessage:"Shown in board",id:"database.viewSettings.propertiesTab.shownInBoardTitle"}):"list"===t?(0,G.jsx)(m()._H,{defaultMessage:"Shown in list",id:"database.viewSettings.propertiesTab.shownInListTitle"}):"gallery"===t?(0,G.jsx)(m()._H,{defaultMessage:"Shown in gallery",id:"database.viewSettings.propertiesTab.shownInGalleryTitle"}):"calendar"===t?(0,G.jsx)(m()._H,{defaultMessage:"Shown in calendar",id:"database.viewSettings.propertiesTab.shownInCalendarTitle"}):"page"===t||"chart"===t||"form_editor"===t||"feed"===t||"chat"===t?null:void(0,g().t1)(t)}function ee(e){let{viewType:t}=e;return"table"===t?(0,G.jsx)(m()._H,{defaultMessage:"Hidden in table",id:"database.viewSettings.propertiesTab.hiddenInTableTitle"}):"timeline"===t?(0,G.jsx)(m()._H,{defaultMessage:"Hidden in timeline",id:"database.viewSettings.propertiesTab.hiddenInTimelineTitle"}):"board"===t?(0,G.jsx)(m()._H,{defaultMessage:"Hidden in board",id:"database.viewSettings.propertiesTab.hiddenInBoardTitle"}):"list"===t?(0,G.jsx)(m()._H,{defaultMessage:"Hidden in list",id:"database.viewSettings.propertiesTab.hiddenInListTitle"}):"gallery"===t?(0,G.jsx)(m()._H,{defaultMessage:"Hidden in gallery",id:"database.viewSettings.propertiesTab.hiddenInGalleryTitle"}):"calendar"===t?(0,G.jsx)(m()._H,{defaultMessage:"Hidden in calendar",id:"database.viewSettings.propertiesTab.hiddenInCalendarTitle"}):"page"===t||"chart"===t||"form_editor"===t||"feed"===t||"chat"===t?null:void(0,g().t1)(t)}function te(e,t,o){const{formatKey:n,visibility:i}=e,r=t.collectionViewStore();if(!r)return;const l=t.normalizedFormatStore.state[n]||[];let a=l.filter((e=>Boolean(e.visible))),s=l.filter((e=>!e.visible));le.includes(n)&&(a=ae(a),s=ae(s));const c=[...a.map((e=>({...e,visible:i}))),...s.map((e=>({...e,visible:i})))];h().createAndCommit({userAction:"CollectionSettingsViewProperties.setAllPropertiesVisibility",environment:o,canUndo:!0,perform:e=>{v().FH({stores:[r],update:{[n]:c},transaction:e})}})}function oe(e){let{collectionContextStore:t,timelineViewTab:o}=e;const n=(0,r().O7)(),i=(0,l().Kw)(t.permissionScopesStore),a=(0,l().VK)((()=>"timeline"===(0,H().WY)({collectionContextStore:t})&&"table"===o&&!(0,H().vw)({collectionContextStore:t})),[t,o]),s=(0,l().VK)((()=>{const e=t.collectionViewBlockStore();return e&&(0,E().Kj)(e.id)}),[t]),c=i.canConfigureCollection&&!a&&!i.isExternallyImportedAndSyncedCollection&&!s;return(0,G.jsxs)(B().Z,{topBorder:!0,children:[c&&(0,G.jsx)(Y().Z,{icon:U().R,title:(0,G.jsx)(m()._H,{id:"database.viewSettings.propertiesTab.newProperty",defaultMessage:"New property"}),isGray:!0,onClick:()=>function(e,t){t.collectionStore()&&(y().wd({environment:e,collectionContextStore:t,action:"click_new_property"}),f().H4({collectionSettingsStore:t.settingsStore,item:{type:"propertyType",onAccept:(o,n,i,r)=>{b().PW({environment:e,propertyType:o,isSuggestedProperty:n,propertyName:i,selectOptions:r,collectionContextStore:t,from:"view_settings"})}}}))}(n,t)}),(0,G.jsx)(Q().Z,{href:(0,z().UY)("guides.databaseProperties"),title:(0,G.jsx)(m()._H,{defaultMessage:"Learn about properties",id:"database.viewSettings.propertiesTab.learnMoreButton.title"}),analyticsFrom:"view_settings_properties"})]})}function ne(e){let{collectionContextStore:t,collectionSettingsStore:o,timelineViewTab:n}=e;const i=(0,r().O7)(),a=(0,l().Kw)(t.normalizedDeletedSchemaStore),s=Object.keys(a).length;return(0,l().Kw)(t.permissionScopesStore).canConfigureCollection&&s>0?(0,G.jsx)(Y().Z,{icon:R().y,title:(0,G.jsx)(m()._H,{id:"database.viewSettings.propertiesTab.deletedProperties",defaultMessage:"Deleted properties"}),isGray:!0,onClick:()=>function(e,t,o,n){o.collectionStore()&&(y().wd({environment:e,collectionContextStore:o,action:"click_deleted_properties"}),f().H4({collectionSettingsStore:t,item:{type:"deletedProperties",timelineViewTab:n}}))}(i,o,t,n),right:s,showChevron:!0}):null}function ie(e,t,o){const n=o.state,i=t.permissionScopesStore.state;return!e.device.isMobile&&i.canConfigureBlock&&!n}function re(e){e.reset()}const le=["board_properties","gallery_properties","calendar_properties"];function ae(e){const t=e.find((e=>"title"===e.property));return t?[t,...e.filter((e=>"title"!==e.property))]:e}function se(e,t,o,n,i,r,l){const{formatKey:a,propertyFormat:m}=e,S=n.permissionScopesStore.state,g=!m.visible,b=n.normalizedSchemaStore.state,v=(0,d().Qm)({schema:b,property:m.property}),C=ie(t,n,l)&&("title"!==m.property||!le.includes(a)),T="title"!==m.property||function(e,t){const o=t.normalizedFormatStore.state,n=(0,H().WY)({collectionContextStore:t});return"board"===n?(0,u().Lw)(o.board_cover):"gallery"===n?(0,u().Lw)(o.gallery_cover):"timeline"===n&&("timeline_table_properties"===e||(0,u().vP)(Boolean(o.timeline_show_table),o.timeline_table_properties||[]))}(a,n);let K=!S.canConfigureCollection||S.isSyncedCollection&&((0,s().w)(m.property)||(0,c().HF)(m.property));if("collectionTypedView"===n.contextType&&S.canConfigureBlock&&(K=!1),v)return{key:m.property,render:e=>{var r;return(0,G.jsx)(F().Z,{disableTooltip:!(null!==(r=v.description)&&void 0!==r&&r.length),renderTooltip:e=>(0,G.jsxs)("div",{...e,style:A().F6,children:[(0,G.jsx)("div",{children:v.name}),void 0!==(null==v?void 0:v.description)&&v.description.length>0?(0,G.jsx)("div",{style:{color:o.mediumInvertedTextColor},children:v.description}):null]}),placement:D().Placement.Left,render:r=>(0,G.jsx)(j().Z,{...(0,O().Z)(e,r),title:(0,G.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[C&&(0,G.jsx)(V().Z,{iconSize:12,style:{marginRight:8}}),(0,G.jsx)(p().ZP,{type:v.type,icon:v.icon,size:16,theme:o,style:{fill:o.regularIconColor}}),(0,G.jsx)("span",{style:{marginLeft:8,...w().Yu},children:v.name}),(0,c().qQ)(v)&&(0,c().q3)(v)&&(0,G.jsx)(_().Z,{})]}),right:(0,G.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,G.jsx)(k().Z,{icon:g?W().B:L().c,iconStyle:{width:16,height:16},isDarkIconColor:!g,onClick:()=>{!function(e,t,o,n){var i;const{formatKey:r,propertyFormat:l}=e,a=o.collectionViewStore();if(!a)return;const s=o.normalizedFormatStore.state,c=(s[r]||[]).filter((e=>e.property!==l.property)),d={...l,visible:!l.visible},p=c.filter((e=>e.visible)),u=c.filter((e=>!e.visible));let m=[];m=le.includes(r)?!0===d.visible?[...ae([...p,d]),...ae(u)]:[...ae(p),...ae([d,...u])]:[...p,d,...u];const S={...s,[r]:m};h().createAndCommit({userAction:"CollectionSettingsViewProperties.handleTogglePropertyVisibility",environment:t,canUndo:!0,perform:e=>{x().iG({collectionViewStore:a,update:{format:S},transaction:e})}}),y().wd({environment:t,collectionContextStore:o,action:"toggle_property_visibility",original_view_type:a.getType(),property_type:null===(i=a.getCollectionStore())||void 0===i||null===(i=i.getSchema()[d.property])||void 0===i?void 0:i.type}),re(n)}({formatKey:a,propertyFormat:m},t,n,l)},ariaLabel:i.formatMessage(N.togglePropertyVisibilityAriaLabel),disabled:!T||!S.canConfigureBlock}),!K&&(0,I().o)({width:12,fill:o.lightTextColor,marginLeft:5})]})})})},action:()=>{K||S.isExternallyImportedAndSyncedCollection||function(e,t,o,n){var i,r,l;const a=(null===(i=n.collectionStore())||void 0===i?void 0:i.getSchema())||n.normalizedSchemaStore.state||{},{formatKey:s,propertyFormat:c}=e;y().wd({environment:t,collectionContextStore:n,action:"click_property",original_view_type:null==n||null===(r=n.collectionViewStore())||void 0===r?void 0:r.getType(),property_type:null===(l=a[c.property])||void 0===l?void 0:l.type}),f().H4({collectionSettingsStore:o,item:{type:"property",formatKey:s,property:c.property}})}({formatKey:a,propertyFormat:m},t,r,n)}}}function ce(e,t,o,n,i,r,l){const{formatKey:a,properties:s}=e;return S().oA(s.map((e=>se({formatKey:a,propertyFormat:e},t,o,n,i,r,l))))}function de(e){let{collectionSettingsStore:t,collectionContextStore:o,timelineViewTab:n,inputStore:l}=e;const a=(0,r().O7)(),s=(0,i.useCallback)((()=>function(e){re(e)}(l)),[l]),c=(0,i.useCallback)((e=>function(e,t,o,n,i){y().wd({environment:t,collectionContextStore:n,action:0===e?"click_properties_tab_timeline":"click_properties_tab_table"}),f().FK({collectionSettingsStore:o,item:{type:"properties",timelineViewTab:0===e?"timeline":"table"}}),re(i)}(e,a,t,o,l)),[a,t,o,l]),d="timeline"===n?0:1;return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(Z().Z,{tabs:[(0,G.jsx)(m()._H,{defaultMessage:"Timeline",id:"database.viewSettings.propertiesTab.timelineProperties"},"database.viewSettings.propertiesTab.timelineProperties"),(0,G.jsx)(m()._H,{defaultMessage:"Table",id:"database.viewSettings.propertiesTab.tableProperties"},"database.viewSettings.propertiesTab.tableProperties")],selectedIndex:d,onChange:c}),"table"===n&&(0,G.jsx)(B().Z,{children:(0,G.jsx)($,{collectionContextStore:o,onClick:s})})]})}function pe(e){const t=(0,r().O7)(),{props:o,formatKey:n,children:i,collectionContextStore:a,inputStore:s}=e,c=(0,l().Kw)(a.permissionScopesStore),d=(0,l().Kw)(s),p=(0,l().VK)((()=>"timeline_table_properties"===n?"table":(0,H().WY)({collectionContextStore:a})),[a,n]);return(0,G.jsx)(B().Z,{...o,noTextOverflow:!0,isTitleUppercase:!1,title:(0,G.jsx)(ee,{viewType:p}),desktopTitleStyle:{height:19},right:!d&&c.canConfigureBlock&&(0,G.jsx)(M().Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:()=>function(e,t,o){y().wd({environment:t,collectionContextStore:o,action:"click_show_all_properties"}),te({formatKey:e,visibility:!0},o,t)}(n,t,a),children:(0,G.jsx)(m()._H,{id:"database.viewSettings.propertiesTab.showAllProperties",defaultMessage:"Show all"})}),style:{width:"100%",paddingBottom:0},children:i})}function ue(e){const t=(0,r().O7)(),{formatKey:o,visibleProperties:n,hiddenProperties:i,children:a,collectionContextStore:s,inputStore:c,menuListStore:d}=e,p=S().oA([...n.map((e=>"title"===e.property&&le.includes(o)?{key:e.property,draggable:!1}:e.property)),n.length>0&&i.length>0&&{key:"group-header-hidden-property",draggable:!1},...i.map((e=>"title"===e.property&&le.includes(o)?{key:e.property,draggable:!1}:e.property))]);return(0,l().VK)((()=>ie(t,s,c)),[t,s,c])?(0,G.jsx)(T().ZP,{direction:"vertical",keys:p,renderKey:(e,t)=>a[t],onDrop:(e,n)=>{!function(e,t,o,n){const{formatKey:i,newPropertyKeys:r}=e,l=o.collectionViewStore();if(!l)return;const a=o.normalizedFormatStore.state[i]||[],s=r.indexOf("group-header-hidden-property");let c=S().oA(r.filter((e=>!e.startsWith("group-header-"))).map(((e,t)=>{const o=a.find((t=>t.property===e));if(o)return s>=0?{...o,visible:Boolean(t<s)}:o}))),d=a.filter((e=>!r.includes(e.property)));le.includes(i)&&(c=ae(c),d=ae(d));const p=[...c,...d];h().createAndCommit({userAction:"CollectionSettingsViewProperties.handlePropertyReorder",environment:t,canUndo:!0,perform:e=>{v().FH({stores:[l],update:{[i]:p},transaction:e})}}),y().wd({environment:t,collectionContextStore:o,action:"reorder_properties",original_view_type:l.getType()}),n.reset()}({formatKey:o,newPropertyKeys:e},t,s,d)}}):(0,G.jsx)(G.Fragment,{children:a})}function me(e){let{formatKey:t,collectionContextStore:o,collectionSettingsStore:i,inputStore:s,menuListStore:c}=e;const p=(0,a().Fg)(),u=(0,r().O7)(),g=(0,m().YB)(),w=(0,l().Kw)(o.permissionScopesStore),f=(0,l().Kw)(o.normalizedFormatStore),b=(0,l().Kw)(o.normalizedSchemaStore),v=(0,l().Kw)(s);let h=f[t]||[];if(v){let e=h.map((e=>{const t=(0,d().Qm)({schema:b,property:e.property});return null==t?void 0:t.name}));e=n().filter(v,e).map((e=>{let{original:t}=e;return t})),h=h.filter((t=>{const o=b[t.property];return o&&o.name&&e.includes(o.name)}))}const x=h.filter((e=>Boolean(e.visible))),_=h.filter((e=>!e.visible)),j=(0,l().VK)((()=>"timeline_table_properties"===t?"table":(0,H().WY)({collectionContextStore:o})),[o,t]),T=(0,l().VK)((()=>ce({formatKey:t,properties:x},u,p,o,g,i,s)),[t,x,u,p,o,g,i,s]),V=(0,l().VK)((()=>ce({formatKey:t,properties:_},u,p,o,g,i,s)),[t,_,u,p,o,g,i,s]);return 0===h.length?(0,G.jsx)(B().Z,{children:(0,G.jsx)(C().Z,{caption:(0,G.jsx)(m()._H,{defaultMessage:"No results",id:"database.viewSettings.propertiesTab.noResults"})})}):(0,G.jsx)(K().Z,{type:K().i.Vertical,store:c,initialFocus:void 0,sections:S().oA([x.length>0&&{key:"visible_and_hidden_properties",render:e=>(0,G.jsx)(B().Z,{...e,noTextOverflow:!0,isTitleUppercase:!1,title:(0,G.jsx)(J,{viewType:j}),desktopTitleStyle:{height:19},right:!v&&w.canConfigureBlock&&(0,G.jsx)(M().Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:()=>function(e,t,o){y().wd({environment:t,collectionContextStore:o,action:"click_hide_all_properties"}),te({formatKey:e,visibility:!1},o,t)}(t,u,o),children:(0,G.jsx)(m()._H,{id:"database.viewSettings.propertiesTab.hideAllProperties",defaultMessage:"Hide all"})}),children:(0,G.jsx)(ue,{collectionContextStore:o,inputStore:s,menuListStore:c,formatKey:t,visibleProperties:x,hiddenProperties:_,children:e.children})}),items:S().oA([...T,_.length>0&&{key:"group-header-hidden-property",render:e=>(0,G.jsx)(pe,{collectionContextStore:o,inputStore:s,props:e,formatKey:t,children:(0,G.jsx)(G.Fragment,{})}),action:()=>{}},...V])},0===x.length&&_.length>0&&{key:"hidden_properties",render:e=>(0,G.jsx)(pe,{collectionContextStore:o,inputStore:s,props:e,formatKey:t,children:(0,G.jsx)(ue,{formatKey:t,visibleProperties:x,hiddenProperties:_,children:e.children,collectionContextStore:o,inputStore:s,menuListStore:c})}),items:V}])})}},711498:(e,t,o)=>{o.d(t,{M:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("bolt",{svg:(0,n.jsx)("path",{d:"M4.629 21.418l8.877-11.416c.166-.205.254-.4.254-.625 0-.371-.293-.654-.703-.654H7.539l2.91-7.598C10.84.12 9.766-.428 9.131.412L.254 11.818c-.166.215-.254.41-.254.626 0 .38.293.663.703.663h5.518l-2.91 7.588c-.391 1.006.683 1.553 1.318.723zm.576-2.627l3.272-7.139H2.44l6.377-8.466-.273-.147-3.262 7.139h6.026l-6.377 8.467z"}),viewBox:"0 0 14 22"})},303611:(e,t,o)=>{o.d(t,{w:()=>n().w});var n=()=>o(870960)},919775:(e,t,o)=>{o.d(t,{Z:()=>i});class n extends(()=>o(263184))().default{getInitialState(){return{pageId:void 0}}}const i=new n}}]);