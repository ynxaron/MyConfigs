"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[23721],{123721:(e,t,o)=>{o.d(t,{ZP:()=>At,Qm:()=>Rt,sY:()=>Ct});o(821057),o(670560),o(122556),o(582845),o(250570),o(533019),o(721473),o(788208),o(22624),o(267602),o(916054),o(653476),o(241792);var a=o(667294),s=()=>o(219727),n=()=>o(142735),i=()=>o(846550),r=()=>o(926724),l=()=>o(714230),c=()=>o(5234),d=()=>o(619186),u=()=>o(396136),p=()=>o(788860),g=()=>o(513670),m=()=>o(696459),h=()=>o(707513),f=()=>o(744091),S=()=>o(818254),v=()=>o(269299),y=()=>o(348141),x=()=>o(360240),T=()=>o(827973),M=()=>o(666414),b=()=>o(206352),j=()=>o(740046),I=()=>o(108714),w=()=>o(312578),k=()=>o(92175),P=()=>o(943620),C=()=>o(388284),A=()=>o(397540),B=()=>o(654133),Z=()=>o(67961),V=()=>o(981583),L=()=>o(73478),O=()=>o(718959),N=()=>o(352230),_=()=>o(164079),K=()=>o(605067),H=()=>o(390886),R=()=>o(239482),q=()=>o(647295),D=()=>o(148126),U=()=>o(345918),E=()=>o(91502),z=()=>o(729201),F=()=>o(615634),W=()=>o(821149),G=()=>o(521777),X=()=>o(270820),Q=()=>o(735501),Y=()=>o(828946),$=()=>o(998901),J=()=>o(876822),ee=()=>o(771097),te=()=>o(804217),oe=()=>o(749826),ae=(o(470928),()=>o(263184));class se extends ae().default{getInitialState(){return{chosenSpaceId:void 0}}getChosenSpaceId(){const{chosenSpaceId:e}=this.state,{currentSpaceStore:t}=J().default.state;return e||(null==t?void 0:t.id)}getChosenSpaceStore(){var e;return null===(e=this.getChosenSpaceViewStore())||void 0===e?void 0:e.getSpaceStore()}getChosenSpaceViewStore(){const{chosenSpaceId:e}=this.state,{currentSpaceViewStore:t,currentUserRootStore:o}=J().default.state;if(!e&&t)return t;if(e&&o){return o.getSpaceViewStores().find((t=>t.getSpaceId()===e))}}}const ne=se;var ie=()=>o(241449),re=()=>o(826955),le=()=>o(469203),ce=()=>o(154439),de=()=>o(255577),ue=()=>o(838367),pe=()=>o(98228),ge=()=>o(154186),me=o(785893);function he(e){let{loading:t,menuListItemProps:a}=e;const n=(0,s().O7)(),{isMobile:r}=n.device,l=(0,i().yK)((e=>({button:{display:"flex",flexDirection:"row",alignItems:"center",color:e.lightTextColor,...r?{fontSize:h().JB.UIRegular.mobile,lineHeight:h().Nv.UIRegular.mobile,padding:4}:{fontSize:h().JB.UIRegular.desktop,lineHeight:h().Nv.UIRegular.desktop,margin:"0px 4px 4px",padding:4,borderRadius:4}},icon:{width:14,height:14,marginRight:8,marginLeft:8,fill:e.lightIconColor},loadingSpinner:{width:12,height:12,marginLeft:8}})),[r]);return(0,me.jsxs)(ge().Z,{style:l.button,...a,children:[(0,o(404553).M)(l.icon),(0,me.jsx)(p()._H,{defaultMessage:"Load more",id:"moveToMenu.loadMoreButtonTitle"}),t&&(0,me.jsx)(w().Z,{style:l.loadingSpinner})]})}const fe=a.memo(he),Se=1e3;function ve(e){let{query:t,spaceId:o,menuListStore:s,requestStore:i,getAutocompleteItems:r}=e;const l=(0,n().VK)((()=>i.state.loading),[i]),c=(0,a.useCallback)((async()=>{!ie().default.state.isOpen||ie().default.state.queryLimit>=Se||(ie().default.setState({...ie().default.state,queryLimit:ie().default.state.queryLimit+20}),await i.refresh())}),[i]);return(0,me.jsx)(ce().Z,{request:{query:t,spaceId:o},render:(e,o)=>(0,me.jsx)(ye,{sections:o,error:e,menuListStore:s,initialFocus:Boolean(t)?0:void 0,loading:l,onLoadMore:c}),requestStore:i,debounce:pe().vp,performRequest:r})}function ye(e){let{sections:t,error:o,menuListStore:a,initialFocus:s,onLoadMore:i,loading:r}=e;const l=(0,n().VK)((()=>{const e=ie().default.state,o=e.isOpen&&e.canLoadMore;return(null==t?void 0:t.find((e=>"pages"===e.key)))&&o}),[t]);if(o)return(0,me.jsx)(C().Z,{children:(0,me.jsx)(ue().Z,{title:(0,me.jsx)(p()._H,{defaultMessage:"Something went wrong.",id:"moveBlockMenu.errorOnMove.label"})})});if(t&&0===t.length)return(0,me.jsx)(C().Z,{children:(0,me.jsx)(ue().Z,{title:(0,me.jsx)(p()._H,{defaultMessage:"No results",id:"moveBlockMenu.noResults.label"})})});const c=[...t||[],...l?[{key:"moveTo load more section",render:e=>(0,me.jsx)(C().Z,{disableDesktopPadding:!0,...e}),items:[{key:"moveTo load more button",render:e=>(0,me.jsx)(fe,{menuListItemProps:e,loading:r}),action:i}]}]:[]];return(0,me.jsx)("div",{children:(0,me.jsx)(de().Z,{type:de().i.Vertical,initialFocus:s,sections:c,store:a})})}var xe=()=>o(752778),Te=()=>o(255933),Me=()=>o(306164),be=()=>o(231219),je=()=>o(384241),Ie=()=>o(852465);function we(e){const{store:t,menuListItemProps:o,hidePath:a}=e,s=(0,n().VK)((()=>function(e){if((0,Ie().OY)(e)&&!e.canEdit())return(0,me.jsx)(p()._H,{id:"moveBlockMenu.needEditAccess.tooltip",defaultMessage:'You need "Can edit" access to "{parentName}" to move this page',values:{parentName:(0,me.jsx)(je().Z,{store:e,shouldWrap:!0})}});if((0,Ie().Y)(e)&&!e.canAddOrRemoveTopLevelPages())return(0,me.jsx)(p()._H,{id:"moveBlockMenu.TeamSidebarLocked.tooltip",defaultMessage:"This teamspace has its sidebar locked. You must be a teamspace owner to move to this teamspace."})}(t)),[t]),r=Boolean(s),l=(0,i().yK)((e=>({disabledTooltip:{maxWidth:240},recordMenuItem:r?{color:e.mediumTextColor}:{}})),[r]);return(0,me.jsx)(B().Z,{placement:$().Placement.Left,textWrap:!0,style:l.disabledTooltip,disableTooltip:!r,renderTooltip:()=>s,render:e=>(0,me.jsx)(be().Z,{...(0,_().Z)(o,e),disabled:r,store:t,hidePath:a,style:l.recordMenuItem})})}var ke=()=>o(679063),Pe=()=>o(641506);function Ce(e){let{spaceStore:t,collectionStore:o,menuListItemProps:a}=e;const n=(0,s().O7)(),r=(0,i().yK)((e=>({caption:{color:e.lightTextColor,fontSize:(0,Pe().yv)(n,"UISmall")}})),[n]);return(0,me.jsx)(be().Z,{caption:(0,me.jsx)("div",{style:r.caption,children:(0,me.jsx)(Ae,{spaceStore:t,collectionStore:o})}),store:o,...a})}function Ae(e){let{spaceStore:t,collectionStore:o}=e;const a=(0,s().O7)(),i=(0,n().VK)((()=>function(e){let{environment:t,spaceStore:o,collectionStore:a}=e;const s=(0,x().tV)({environment:t,spaceStore:o,collectionStore:a});switch(s){case"team":return null;case"private":return(0,me.jsx)(p()._H,{id:"moveToHelpers.privatePageCaptionPrefix",defaultMessage:"Private"});case"shared":return(0,me.jsx)(p()._H,{id:"moveToHelpers.sharedPageCaptionPrefix",defaultMessage:"Shared"});default:(0,m().t1)(s)}}({environment:a,spaceStore:t,collectionStore:o})),[a,t,o]),r=(0,n().VK)((()=>(0,ke().Lk)(o)),[o])&&(0,me.jsx)(ke().ZP,{store:o,showFullPathInTooltip:!0});return r&&i?(0,me.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[i,(0,me.jsx)("div",{style:{paddingLeft:4,paddingRight:4},children:"/"}),r]}):r&&!i?r:(0,me.jsx)(me.Fragment,{children:i})}function Be(e){let{spaceStore:t,value:o,showPath:a,isCreateIn:s,onAccept:n}=e;const i=function(e){let{spaceStore:t,value:o}=e;const{type:a}=o;switch(a){case"page":return re().G.createChildStore(t,{table:u().iU,id:o.id});case"collection":return re().NW.createChildStore(t,{table:xe().vF,id:o.id});case"space":return re().H2.createChildStore(t,{table:Te().bx,id:o.id});case"team":return re().zX.createChildStore(t,{table:Me().e0,id:o.id});case"space-private-pages":return;default:(0,m().t1)(a)}}({spaceStore:t,value:o});if(i)return(0,H().Hn)()&&i instanceof re().NW?{key:i.id,render:e=>(0,me.jsx)(Ce,{spaceStore:t,collectionStore:i,menuListItemProps:e}),action:()=>n(o)}:{key:i.id,render:e=>(0,me.jsx)(we,{store:i,menuListItemProps:e,hidePath:!!s&&!a}),action:()=>n(o)}}o(228244);var Ze=()=>o(801812),Ve=()=>o(63317),Le=()=>o(156642),Oe=()=>o(765056),Ne=()=>o(167705),_e=()=>o(906591),Ke=()=>o(168441),He=()=>o(965913),Re=()=>o(383694);const qe=100,De=14,Ue=24;function Ee(e){return(e+1)*De}function ze(e){const{store:t,spaceStore:o,spaceViewStore:r,depth:l,isAlias:c,menuListItemProps:d,from:g}=e,m=(0,s().O7)(),h=(0,i().Fg)(),[f,S]=a.useState(!1),v=(0,i().yK)((e=>({noChildrenLabelItem:{paddingLeft:Ee(l)+Ue,fontSize:14,paddingBottom:6.5,color:e.lightTextColor},outlinerItem:{display:"flex",flexDirection:"row",fontSize:14,height:28,paddingLeft:"moveToModalTyped"===g?Ee(l)-4:Ee(l),color:e.regularTextColor,alignItems:"center"},icon:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,flexGrow:0,width:22,height:18,marginRight:4,position:"relative"},button:{..."moveToModalTyped"===g?{borderRadius:4}:{}}})),[l,g]);function y(){const e=ie().default.state,o=e.isOpen?e.flowId:void 0;S(!f),Oe().w6(m,{flowId:o,is_toggled:!f,destination_type:t?t.table:"private_pages"})}const x=(0,n().VK)((()=>{if(t){const e=(0,me.jsx)("div",{children:(0,He().Y)({position:"absolute",width:"50%",height:"50%",right:0,bottom:0})});return t instanceof re().zX?(0,me.jsx)("div",{style:v.icon,children:(0,me.jsx)(Re().p,{disabled:!0,store:t,size:18})}):(0,me.jsxs)("div",{style:v.icon,children:[(0,me.jsx)(P().Z,{icon:t instanceof re().G?t.getIcon():void 0,isEmptyPage:t instanceof re().G&&t.isEmptyPage(),title:void 0,size:18,disabled:!0}),c&&e]})}return(0,me.jsx)(V().Z,{size:16,userStore:(0,O().B7)(m),style:{marginLeft:3}})}),[t,v.icon,m,c]),T=(0,n().VK)((()=>t?t.table===Me().e0?"private"!==t.getTeamAccessLevel()?(0,me.jsx)("div",{style:{maxWidth:"80%"},children:(0,me.jsx)(je().Z,{store:t})}):(0,me.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",maxWidth:"80%"},children:[(0,me.jsx)(je().Z,{store:t}),(0,Ke().Q)({width:14,height:14,marginLeft:4,fill:h.mediumIconColor})]}):(0,me.jsx)("div",{style:{maxWidth:"80%"},children:(0,me.jsx)(je().Z,{store:t})}):(0,me.jsxs)("div",{style:{display:"flex",alignItems:"center",marginLeft:7},children:[(0,me.jsx)(p()._H,{defaultMessage:"Private pages",id:"outliner.addToPrivatePages"}),(0,me.jsx)("div",{style:{marginLeft:2},children:(0,W().b)({width:14,height:14,fill:h.mediumIconColor,marginLeft:4})})]})),[t,h.mediumIconColor]),M=(0,n().VK)((()=>{const e=new Set([Le().Ti.page,Le().Ti.collectionViewPage,Le().Ti.collectionView,Le().Ti.alias]),o=new Set([Le().Ti.factory]);let a=[];return t?t instanceof re().zX?a=t.getTeamPagesStores():t instanceof re().G&&(a=(0,_e().Q2)({rootStore:t,shouldSkipItemTypes:o,shouldShowItemTypes:e})):a=r.getPrivatePages(m),a}),[t,r,m]);const b=0!==M.length?(0,me.jsx)(Fe,{spaceStore:o,spaceViewStore:r,itemStores:M,depth:l+1,onAccept:e.onAccept,targets:e.targets}):(0,me.jsx)("div",{style:v.noChildrenLabelItem,children:(0,me.jsx)(p()._H,{defaultMessage:"No pages inside",id:"outliner.NoPagesInside.placeholder"})});return(0,me.jsxs)("div",{...d,children:[(0,me.jsx)(ge().Z,{onClick:function(){e.moveToPagesOnly&&(null==t?void 0:t.table)!==u().iU?y():t?t instanceof re().G?e.onAccept({type:"page",id:t.id,spaceId:o.id}):e.onAccept({type:"team",id:t.id,spaceId:o.id}):e.onAccept({type:"space-private-pages",spaceId:o.id})},style:v.button,children:(0,me.jsxs)("div",{style:v.outlinerItem,children:[(0,me.jsx)(Ne().Z,{isSidebar:!0,fill:!0,icon:"chevron",open:f,color:h.mediumIconColor,onClick:y}),x,T]})}),f&&l<qe&&b]})}function Fe(e){const{spaceStore:t,spaceViewStore:o,itemStores:a,depth:s}=e,r=(0,n().VK)((()=>{const n=a?g().oA(a.map((a=>{if(a instanceof re().zX&&a.canAddOrRemoveTopLevelPages()||a instanceof re().G&&(0,H().Xk)(a,e.targets)&&a.canEdit()){const n=a instanceof re().G&&a.getType()===Le().Ti.alias,i=n?a.getAliasTargetStore():void 0,r=i instanceof re().G?i:a;return(0,me.jsx)(ze,{spaceStore:t,spaceViewStore:o,store:r,depth:s,onAccept:e.onAccept,targets:e.targets,isAlias:n,moveToPagesOnly:e.moveToPagesOnly},a.id)}}))):[];return e.addedItems?[...e.addedItems,...n]:n}),[a,e.addedItems,e.moveToPagesOnly,e.targets,e.onAccept,t,o,s]),l=(0,i().yK)((e=>({sectionHeader:{color:e.mediumTextColor,fontSize:12,fontWeight:h().Ue.medium,padding:"12px 14px 4px 14px"}})),[]);return(0,me.jsxs)(b().Z,{debugName:"MoveToOutliner",capture:!0,allowEsc:!0,allowLeft:!0,children:[e.title&&(0,me.jsx)("div",{style:l.sectionHeader,children:(0,me.jsx)(Z().Z,{isSmall:!0,children:e.title})}),(0,me.jsx)("div",{children:r})]})}function We(e){const{spaceStore:t,spaceViewStore:o,targets:a,moveToPagesOnly:r,forceShowPrivatePageOption:l,onAccept:c}=e,d=(0,n().VK)((()=>J().default.state.currentUserStore),[]),u=(0,s().O7)(),m=(0,p().YB)(),h=(0,i().yK)((()=>({modal:{height:374,maxHeight:"70vh",paddingBottom:12},body:{width:"100%"}})),[]),[f]=(0,Ze().r5)((async()=>t&&d?await(0,E().qX)({environment:u,spaceStore:t,currentUserId:d.id}):[]),[u,t,d]),S=(0,n().VK)((()=>{if(!f.value)return;const e=o.getTeamsStores().filter((e=>e.canAddOrRemoveTopLevelPages()));return e.length>=7?e:g().mN([...e,...f.value||[]],(e=>e.id)).filter((e=>e.canAddOrRemoveTopLevelPages())).slice(0,7)}),[o,f.value]),v=(0,n().VK)((()=>Ge({spaceStore:t,targets:a})),[t,a]),y=(0,n().VK)((()=>o.getWorkspacePages().filter((e=>(0,H().Xk)(e,a)&&e.canEdit()))),[o,a]),x=(0,n().VK)((()=>{if(Xe({environment:u,targets:a,chosenSpaceStore:t,forceShowPrivatePageOption:l}))return(0,me.jsx)(ze,{spaceStore:t,spaceViewStore:o,store:void 0,depth:0,onAccept:c,targets:a,moveToPagesOnly:r},"MoveToModal private item")}),[u,c,a,t,o,r,l]);return t&&o?(0,me.jsx)("div",{style:h.modal,children:(0,me.jsx)("div",{style:h.body,children:(0,me.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,me.jsx)(Fe,{spaceStore:t,spaceViewStore:o,itemStores:v,addedItems:[x],moveToPagesOnly:r,depth:0,title:m.formatMessage({defaultMessage:"Suggested",id:"moveToModal.suggestedSection.title"}),onAccept:e.onAccept,targets:e.targets}),S&&S.length>0&&(0,me.jsx)(Fe,{spaceStore:t,spaceViewStore:o,itemStores:S,moveToPagesOnly:r,depth:0,title:m.formatMessage({defaultMessage:"Teamspaces",id:"moveToModal.teamsSection.title"}),onAccept:e.onAccept,targets:e.targets}),y.length>0&&(0,me.jsx)(Fe,{spaceStore:t,spaceViewStore:o,itemStores:y,moveToPagesOnly:r,depth:0,title:m.formatMessage({defaultMessage:"Workspace",id:"moveToModal.workspaceSection.title"}),onAccept:e.onAccept,targets:e.targets})]})})}):null}function Ge(e){let{spaceStore:t,targets:o}=e,a=Ve().Z.getWithoutSubscribing(t.id).map((e=>{let{store:t}=e;return t})).filter((e=>(null==e?void 0:e.pathIsAccessibleAndAlive())&&!o.some((t=>"block"===t.table&&t.id===e.id))));const s=o.filter((e=>"block"===e.getParentTable())).map((e=>e.getParentId())),n=s.length===o.length,i=[...new Set(s)];return n&&1===i.length&&(a=a.filter((e=>e.id!==i[0]))),a.slice(0,7)}function Xe(e){let{environment:t,targets:o,chosenSpaceStore:a,forceShowPrivatePageOption:s}=e;const n=(0,U().Cx)(a),i=o.every((e=>e.isTopLevelPrivatePage({spaceStore:a,environment:t})));return!n&&(s||!i)}var Qe=()=>o(506347),Ye=()=>o(347628),$e=()=>o(364052),Je=()=>o(955620),et=()=>o(525038),tt=()=>o(332542),ot=()=>o(636340),at=()=>o(47443),st=()=>o(970105),nt=()=>o(369637),it=()=>o(763707),rt=()=>o(727039),lt=()=>o(1910),ct=()=>o(901690),dt=()=>o(653457),ut=()=>o(384334),pt=()=>o(291198),gt=()=>o(708518),mt=()=>o(764767),ht=()=>o(906651),ft=()=>o(263758);class St extends ae().default{getInitialState(){return!1}}const vt=new St,yt=(0,p().vU)({title:{id:"tasksCreateNewDatabase.modal.title",defaultMessage:"How would you like to name your private task database?"},placeholder:{id:"tasksCreateNewDatabase.modal.placeholder",defaultMessage:"{username}'s to-do list"},create:{id:"tasksCreateNewDatabase.modal.create",defaultMessage:"Create database"},cancel:{id:"tasksCreateNewDatabase.modal.cancel",defaultMessage:"Cancel"}}),xt=380,Tt=24;function Mt(e){const{handleCreateTaskDatabase:t}=e,o=(0,p().YB)(),r=(0,n().VK)((()=>J().default.state.currentUserStore),[]),l=(0,n().VK)((()=>null==r?void 0:r.getDisplayName(o)),[r,o]),c=(0,s().Fy)(),[d,u]=(0,a.useState)(""),g=(0,n().Kw)(vt),m=(0,i().yK)((e=>({container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:`${Tt}px`,width:xt},editPropertyTypeIcon:{width:32,height:32,fill:e.lightTextColor},title:{color:e.regularTextColor,textAlign:"center"},input:{width:"100%",height:36,fontSize:16,marginTop:16,marginBottom:`${Tt}px`},createButton:{width:"100%",height:36,fontSize:16,marginBottom:16},cancelButton:{color:e.mediumTextColor,fontSize:16}})),[]),h=(0,a.useCallback)((()=>{d.trim()&&(t(d),vt.setState(!1))}),[d,t]),f=(0,a.useCallback)((()=>{vt.setState(!1)}),[]),S=(0,a.useCallback)((e=>{"Enter"===e.key&&h()}),[h]),v=(0,a.useCallback)((e=>{u(e.target.value)}),[u]),y=(0,a.useCallback)((()=>(0,me.jsxs)("div",{style:m.container,children:[(0,me.jsx)("div",{children:(0,ft().E)(m.editPropertyTypeIcon)}),(0,me.jsx)("h3",{style:m.title,children:o.formatMessage(yt.title)}),(0,me.jsx)(pt().Z,{value:d,onChange:v,placeholder:o.formatMessage(yt.placeholder,{username:l}),style:m.input,autoFocus:!0,onKeyDown:S}),(0,me.jsx)(ht().Z,{style:m.createButton,onClick:h,children:o.formatMessage(yt.create)}),(0,me.jsx)(k().Z,{style:m.cancelButton,onClick:()=>{vt.setState(!1)},children:o.formatMessage(yt.cancel)})]})),[d,l,v,S,h,o,m.cancelButton,m.container,m.createButton,m.editPropertyTypeIcon,m.input,m.title]);return g?c.isPhone?(0,me.jsx)(mt().n,{fullscreen:!0,renderInner:y}):(0,me.jsx)(gt().Z,{open:!0,showCloseIcon:!0,onDismiss:f,render:y}):null}var bt=()=>o(452404),jt=()=>o(431671);const It=7;function wt(e){const{spaceStore:t,spaceViewStore:o,targets:r,menuListStore:l,onAccept:d,moveToPagesOnly:u,forceShowPrivatePageOption:h,maxMenuItems:f=It}=e,S=(0,s().O7)(),y=(0,p().YB)(),M=(0,i().Fg)(),b=(0,n().VK)((()=>{const e=J().default.state.mainEditorCurrentBlockStore;return Boolean(e&&(0,O().qG)(e.id))}),[]),j=(0,n().VK)((()=>o.getTeamsStores().map((e=>e.id))),[o]),I=(0,n().VK)((()=>ie().default.getDatabaseType()),[]),w=(0,n().VK)((()=>H().XN()),[]),k=(0,jt().F)({environment:S,spaceStore:t,parentStore:t,joinedTeamIds:j,moveToTargets:r}),P=(0,i().yK)((e=>({modal:{maxHeight:"70vh"},loadingShimmer:{padding:16},privateMenuItem:{marginLeft:4,marginRight:4,borderRadius:4},menuItemFooterButton:{color:e.mediumTextColor,fill:e.mediumIconColor}})),[]),A=(0,a.useCallback)((e=>{const o={key:e.id,render:o=>(0,me.jsx)(Ce,{spaceStore:t,collectionStore:e,menuListItemProps:o}),action:()=>d({type:"collection",id:e.id,spaceId:t.id})};return o}),[t,d]),B=(0,n().VK)((()=>k.success?k.typedDatabases.map((e=>A(e))):[]),[k,A]);(0,a.useEffect)((()=>{0===B.length&&ie().default.setState({...ie().default.state,variant:"untyped"})}),[B.length]);const Z=(0,n().VK)((()=>Xe({environment:S,targets:r,chosenSpaceStore:t,forceShowPrivatePageOption:h})),[S,h,t,r]),V=(0,n().VK)((()=>{const{isMobile:e}=S.device;if(e){const e=r.every((e=>e.isNavigableBlock()));return Rt({query:"",chosenSpaceStore:t},S,M,y,r,d,e,h)}return{key:"privateMenuItem",render:e=>(0,me.jsx)("div",{style:P.privateMenuItem,children:(0,me.jsx)(ze,{spaceStore:t,spaceViewStore:o,store:void 0,depth:0,onAccept:d,targets:r,moveToPagesOnly:u,menuListItemProps:e,from:"moveToModalTyped"})}),action:()=>{}}}),[S,h,y,u,d,t,o,P.privateMenuItem,r,M]),L=b?"home_tasks":"home_tile_tasks",N=(0,a.useMemo)((()=>({key:"helpMenuItem",render:()=>(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(rt().CollectionTasksEmptyStateModal,{from:L}),(0,me.jsx)(T().Z,{style:P.menuItemFooterButton,icon:(0,dt().m)({width:16,height:16}),focused:!1,title:(0,me.jsx)(p()._H,{defaultMessage:"Don't see your database?",id:"moveToModalTyped.helpMenuItem.title"}),onClick:()=>{bt().Z.setState(!0),(0,ut().Aq)({environment:S,from:L})}})]}),action:()=>{}})),[S,L,P.menuItemFooterButton]),_=(0,a.useCallback)((e=>{let a,s;v().createAndCommit({userAction:"moveToModalTyped.handleCreateTodoList",environment:S,canUndo:!0,perform:function(n){a=ot().j4({environment:S,transaction:n,type:"collection_view",inMemoryRecordCache:S.defaultRecordCache.inMemoryRecordCache}),tt().jG({childStore:a,parentStore:t,transaction:n});const i=it().initializeApp({environment:S,spaceViewStore:o,appUri:Ye().b,presetUri:"notion://tasks_collection_typedDBpreset",appParentStore:t,temporaryContainerBlockStore:a,transaction:n,from:"my_tasks",skipNavigation:!0});s=null==i?void 0:i[0].getCollectionStore(),s&&st().sO({environment:S,store:s.getNameStore(),value:(0,Je().TPx)(e),transaction:n}),nt().m2({id:"database_creation_toast",title:y.formatMessage({id:"moveToModalTyped.databaseCreated.title",defaultMessage:"Database created"}),message:y.formatMessage({id:"moveToModalTyped.databaseCreated.message",defaultMessage:'"{name}" has been created'},{name:e}),presentationType:"persistent",iconGroup:$e().F,iconGroupColorName:"greenPrimary",actions:{primary:{title:y.formatMessage({id:"moveToModalTyped.databaseCreated.openDatabase",defaultMessage:"Open database"}),onAction:()=>{at()._c({environment:S,store:null==i?void 0:i[0],pageVisitSource:Qe().tY.PersonalHomePage}),nt().Xd("database_creation_toast")}}}})}}),s&&(0,ee().a)(s),et().xv({environment:S,clearSelection:!0})}),[S,y,t,o]),K=(0,a.useMemo)((()=>({key:"createDatabaseItem",render:()=>(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(Mt,{handleCreateTaskDatabase:_}),(0,me.jsx)(T().Z,{style:P.menuItemFooterButton,icon:(0,G().R)({width:16,height:16}),focused:!1,title:(0,me.jsx)(p()._H,{defaultMessage:"New private task database",id:"moveToModalTyped.createDatabaseItem.title"}),onClick:()=>{vt.setState(!0)}})]}),action:()=>{}})),[_,P.menuItemFooterButton]);if(!k.success||0===B.length)return(0,me.jsx)("div",{style:P.loadingShimmer,children:(0,me.jsx)(ct().Z,{paragraphs:[{lineHeight:18,lineMargin:4,sectionWidths:[100],repeat:1,sectionMargin:0},{lineHeight:14,lineMargin:4,sectionWidths:[100,40],repeat:1,sectionMargin:-2}]})});if(!I)throw new Error("Trying to show typed moveTo modal when database type is not available.");const R=(0,x().sN)(I),q=g().oA([{key:"suggested",render:e=>(0,me.jsx)(C().Z,{...e,title:w?(0,me.jsx)(p()._H,{defaultMessage:"{typedItemName} databases",id:"moveToModalTyped.suggestedMenuSection.title",values:{typedItemName:(0,c().Z)(R)}}):(0,me.jsx)(p()._H,{defaultMessage:"Where would you like to create your {typedItemName}?",id:"moveToModalTyped.suggestedMenuSection.titleNew",values:{typedItemName:R}}),right:w?(0,me.jsx)(kt,{typedItemName:R}):null}),items:B.slice(0,f)},Z&&(0,m().$K)(V)&&{key:"other",render:e=>(0,me.jsx)(C().Z,{...e,title:(0,me.jsx)(p()._H,{defaultMessage:"Other",id:"moveToModalTyped.otherSection.title"})}),items:[V]},!w&&{key:"create-new-footer",render:e=>(0,me.jsx)(C().Z,{...e,topBorder:!0}),items:[N,K]}]);return(0,me.jsx)("div",{style:P.modal,children:(0,me.jsx)(de().Z,{initialFocus:0,type:de().i.Vertical,sections:q||[],store:l})})}function kt(e){const{typedItemName:t}=e,o=(0,p().YB)(),{isMobile:a}=(0,s().Fy)(),n=(0,i().yK)((e=>({tooltip:{width:220},icon:{width:13,height:13,fill:e.mediumIconColor},iconButton:{height:18,width:18,padding:0,marginTop:-4,marginBottom:-4,marginRight:-4}})),[]);return a?null:(0,me.jsx)(B().Z,{placement:$().Placement.Bottom,style:n.tooltip,textWrap:!0,renderTooltip:()=>(0,me.jsx)(p()._H,{defaultMessage:"{typedItemName} properties will be kept when moving to these locations",id:"moveTypedMenu.tooltip",values:{typedItemName:(0,c().Z)(t)}}),render:e=>(0,me.jsx)(lt().Z,{ariaLabel:o.formatMessage({id:"moveToModalTyped.helpIcon.ariaLabel",defaultMessage:"Help icon for moving typed pages."}),icon:dt().m,iconStyle:n.icon,style:n.iconButton,...e})})}const Pt=5,Ct=(0,p().vU)({createSubpage:{id:"moveToOrCreateMenu.createSubpage.description",defaultMessage:"Create a new sub-page where your cursor is, inside the current block."},newPageIn:{id:"moveToOrCreateMenu.newPageIn.description",defaultMessage:"Create a new page inside any existing page, then link to it in one go."},turnInto:{id:"moveToOrCreateMenu.turnInto.description",defaultMessage:"Turn blocks into new pages inside any existing database or page."},privatePagesTitle:{defaultMessage:"Private Pages",id:"moveBlockMenu.privatePagesMenuTitle"}});const At=function(e){let{targets:t,isCreateIn:l,onAccept:h,isAddTo:f,isTurnIntoPage:v,parentBlockId:y,autocompleteQuery:T,onAutocompleteQueryChange:M,onMouseEnter:j,onCancel:I,desktopWidth:w,forceShowPrivatePageOption:k=!1}=e;const P=(0,p().YB)(),A=(0,i().Fg)(),B=(0,s().O7)(),Z=(0,n().qz)(void 0,o(692304).Z),V=(0,n().qz)(void 0,o(853648).Z),L=(0,n().qz)(void 0,ne),_=(0,n().VK)((()=>t.length>0&&t.every((e=>e.isNavigableBlock()))),[t]),D=(0,a.useCallback)((e=>async function(e,t,o,a,s,n,i,l,h,f,v,y,T){const{currentUserRootStore:M,currentSpaceStore:b}=J().default.state,{query:j}=e,I=v.getChosenSpaceStore();if(!M||!I||!b)return[];const w=(0,q().lX)({spaceStore:I,currentUserId:t.currentUser.id}),[k,P,A,B]=await async function(e,t,o,a,s){const n=[],i=[],r=[];let l=[];if(t&&Bt()){const i=await Y().x.searchActions.load(),l=ie().default.state,c=l.isOpen?l.queryLimit:K().Kg,d=await i.searchPageIds({environment:s,query:t,limit:c+1,spaceId:e.id,requireEditPermissions:!1,excludeTemplates:!1,source:"move_to_menu",boostRecentlyViewedPages:!0}),p=d.results.length>c;ie().default.state.isOpen&&ie().default.state.canLoadMore!==p&&ie().default.setState({...ie().default.state,canLoadMore:p});for(const t of d.results){const s=re().G.createChildStore(e.getPagesStore(),{table:u().iU,id:t});if(H().Xk(s,o)){const e={blockId:s.id,isEditable:s.canEdit()};Vt(s,a)?r.push(e):n.push(e)}}}else{l=(await S().I0(e,e.id)).map((t=>{const o=re().G.createChildStore(e.getPagesStore(),{table:u().iU,id:t});return{blockId:o.id,isEditable:o.canEdit()}})),l=l.filter((t=>{let{blockId:s}=t;const n=re().G.createChildStore(e.getPagesStore(),{table:u().iU,id:s});if(H().Xk(n,o)){const e={blockId:n.id,isEditable:n.canEdit()};return!Vt(n,a)||(r.push(e),!1)}}));const t=O().Xb(s);for(const e of t)if(H().Xk(e,o)){const t={blockId:e.id,isEditable:e.canEdit()};Vt(e,a)?r.push(t):i.push(t)}}return[n,i,r,l]}(I,j,a,s,t),Z=await w;if(H().Hn())return await async function(e,t,o,a,s,n,i,l){const{chosenSpaceStore:u,savedQuickAddParent:h,query:f,blockResults:S,recentPageResults:v}=e,{typedSuggestedMenuSection:y,typedSuggestedResults:T}=await async function(e,t,o,a,s){if(!ie().default.state.isOpen||ie().default.state.variant===r().br||!ee().CachedTypedDatabasesStore.state)throw new Error("Trying to render section when it's either not open, untyped, or typed but uninitialized (i.e. the typed databases are not fetched yet)");const n=ie().default.getDatabaseType(),i=(0,x().sN)(n),{typedDatabases:l}=ee().CachedTypedDatabasesStore.state;let u;u=oe().default.checkGate({gateName:"typed_move_to_improved_search"})?await async function(e,t,o,a,s){const{databaseType:n,query:i,searchSessionId:r}=e,l=_t(s);if(!l)return[];const c=await Y().x.searchActions.load(),d=(await c.searchCollectionsWithRecents({environment:t,query:i,limit:20,databaseType:n,parentStore:l,spaceStore:l,collectionViewBlockStore:void 0,searchSessionId:r})).results,u=d.map((e=>Be({spaceStore:l,value:{type:"collection",id:e,spaceId:l.id},showPath:!0,isCreateIn:o,onAccept:o?a:e=>Lt(e,a,t)}))).filter(m().$K);return u}({query:e,databaseType:n?[n]:void 0,searchSessionId:ie().default.state.flowId},t,o,a,s):function(e,t,o,a){const{query:s,typedDatabases:n}=e,i=_t(a);if(!i||!s||!n)return[];const r=(0,d().ZP)(s,n,(e=>{const t=String(e.getName())||"",o=(0,R().u3)(e);return[t,o instanceof re().zX&&o.getName()||""].join(" ")}));return r.map((e=>Be({spaceStore:i,value:{type:"collection",id:e.id,spaceId:i.id},showPath:!0,isCreateIn:t,onAccept:o}))).filter(m().$K)}({query:e,typedDatabases:l},o,a,s);const g={key:"suggested",render:e=>(0,me.jsx)(C().Z,{...e,title:(0,me.jsx)(p()._H,{defaultMessage:"{typedItemName} databases",id:"moveBlockMenu.typedSuggestedSection.title",values:{typedItemName:(0,c().Z)(i)}}),right:(0,me.jsx)(kt,{typedItemName:i})}),items:u.slice(0,Pt)};return{typedSuggestedMenuSection:g,typedSuggestedResults:l}}(f,t,o,a,i);if(ie().default.state.isOpen&&"aggregated_type"===ie().default.state.moveToContext)return[y].filter((e=>e.items.length>0));let M=H().XQ({recentPageResults:v,blockResults:S,suggestedPages:T});const b=new Set(H().qB(s));b.size>0&&(M=M.filter((e=>!b.has(e.blockId))));const j=g().mN(g().VS(g().oA([Ht({query:f,savedQuickAddParent:h},n,o,a,i),...M.map((e=>{let{blockId:t}=e;return Be({spaceStore:u,value:{type:"page",id:t,spaceId:u.id},showPath:!f,isCreateIn:o,onAccept:a})}))])),(e=>e.key)),I=g().oA(qt(f,o,a,i,l)).slice(0,Pt),w=y.items.length>0,k={key:"teams",render:e=>(0,me.jsx)(C().Z,{...e,desktopStyle:{paddingTop:w?0:6,paddingBottom:6},title:(0,me.jsx)(p()._H,{defaultMessage:"Teamspaces",id:"typedMoveBlockMenu.teamsSection.title"})}),items:I},P=y.items.length>0&&0===k.items.length;return[y,k,{key:"pages",render:e=>(0,me.jsx)(C().Z,{...e,desktopStyle:{paddingTop:P?0:6,paddingBottom:6},title:(0,me.jsx)(p()._H,{defaultMessage:"Pages",id:"typedMoveBlockMenu.pagesSection.title"})}),items:j}].filter((e=>e.items.length>0))}({chosenSpaceStore:I,savedQuickAddParent:Z,query:j,blockResults:k,recentPageResults:B},t,s,n,a,i,v,y);if(s)return function(e,t,o,a,s,n,i,r,l,c,d,u,m,h,f){const S=[],v=new Set,y=e=>{if(!e)return!1;const{key:t}=e;return!v.has(t)&&(v.add(t),!0)},x=g().oA([Zt({query:t},i,c,d,u,r,m)]);!x.length||Boolean(l)||Boolean(r)||S.push({key:"defaults",render:e=>(0,me.jsx)(C().Z,{...e}),items:x});const T=g().oA([...n.slice(0,5).map((t=>{let{blockId:o}=t;return Be({spaceStore:e,value:{type:"page",id:o,spaceId:e.id},showPath:!Boolean(l)&&!Boolean(r),isCreateIn:m,onAccept:d})})),...o.slice(0,10).map((o=>{let{blockId:a}=o;return Be({spaceStore:e,value:{type:"page",id:a,spaceId:e.id},showPath:!t,isCreateIn:m,onAccept:d})})),...a.slice(0,10).map((o=>{let{blockId:a}=o;return Be({spaceStore:e,value:{type:"page",id:a,spaceId:e.id},showPath:!t,isCreateIn:m,onAccept:d})}))].slice(0,20).filter(y));T.length>0&&S.push({key:"blocks",render:e=>(0,me.jsx)(C().Z,{...e,title:(0,me.jsx)(p()._H,{defaultMessage:"Suggested",id:"moveBlockMenu.suggestedSection.title"}),topBorder:S.length>0&&!Boolean(l)&&!Boolean(r)}),items:T});const M=g().oA(qt(t,m,d,h,f).filter(y));M.length>0&&(0,E().bq)()&&S.push({key:"teams",render:e=>(0,me.jsx)(C().Z,{...e,isTitleUppercase:!0,title:(0,me.jsx)(p()._H,{defaultMessage:"Teamspaces",id:"moveBlockMenu.teamsSection.title"}),topBorder:S.length>0}),items:M});const b=g().oA(s.slice(0,5).map((t=>{let{blockId:o}=t;return Be({spaceStore:e,value:{type:"page",id:o,spaceId:e.id},showPath:!0,isCreateIn:m,onAccept:d})})).filter(y));b.length>0&&S.push({key:"templates",render:e=>(0,me.jsx)(C().Z,{...e,isTitleUppercase:!0,title:r?(0,me.jsx)(p()._H,{defaultMessage:"Add from template",id:"moveBlockMenu.addFromTemplate.title"}):(0,me.jsx)(p()._H,{defaultMessage:"Move to template",id:"moveBlockMenu.moveToTemplate.title"}),topBorder:S.length>0}),items:b});x.length&&(Boolean(l)||Boolean(r))&&S.push({key:"defaults",render:e=>(0,me.jsx)(C().Z,{...e,topBorder:S.length>0}),items:x});return S}(I,j,k,P,A,B,t,i,l,a,n,h,s,v,y);return function(e,t,o,a,s,n,i,r,l,c,d,u,m,h,f,S,v){const y=function(e,t,o,a,s,n,i,r,l,c){const d=0===e.length&&t?Ge({spaceStore:t,targets:s}):[],u={key:"suggested",render:e=>(0,me.jsx)(C().Z,{...e,title:(0,me.jsx)(p()._H,{defaultMessage:"Suggested",id:"moveBlockMenu.suggestedSection.title"})}),items:g().oA([Rt({query:e,chosenSpaceStore:t},o,a,n,s,i,l,c),...d.filter((e=>H().Xk(e,s))).map((e=>Be({spaceStore:t,value:{type:"page",id:e.id,spaceId:t.id},showPath:!1,isCreateIn:r,onAccept:i})))])};return u}(o,e,r,l,c,d,u,m,S,v),x=ie().default.state,T=x.isOpen?x.queryLimit:K().Kg,M=[...i.slice(0,3),...a.slice(0,T)],b={key:"pages",render:e=>(0,me.jsx)(C().Z,{...e,title:(0,me.jsx)(p()._H,{defaultMessage:"Pages",id:"moveBlockMenu.pagesSection.title"})}),items:g().mN(g().VS(g().oA([Ht({query:o,savedQuickAddParent:t},h,m,u,f),...M.map((t=>{let{blockId:a}=t;return Be({spaceStore:e,value:{type:"page",id:a,spaceId:e.id},showPath:!o,isCreateIn:m,onAccept:u})}))])),(e=>e.key))},j={key:"teams",render:e=>(0,me.jsx)(C().Z,{...e,title:(0,me.jsx)(p()._H,{defaultMessage:"Teamspaces",id:"moveBlockMenu.teamsSection.title"})}),items:g().oA(qt(o,m,u,f,S)).slice(0,10)};return[y,j,b].filter((e=>e.items.length>0))}(I,Z,j,k,0,0,B,t,o,a,f,n,s,i,v,y,T)}(e,B,A,t,l,h,f,v,y,P,L,_,k)),[B,A,t,l,h,f,v,y,P,L,_,k]),U=(0,n().VK)((()=>ie().default.state.isOpen),[]),z=(0,n().VK)((()=>!V.state.ready&&T.length>0),[V,T]),F=(0,n().VK)((()=>Bt()),[]),W=(0,s().MO)(),G=(0,n().VK)((()=>H().Hn()),[]),X=(0,n().VK)((()=>{var e;return null===(e=_t(L))||void 0===e?void 0:e.id}),[L]);if(!f&&!l&&!U)return(0,me.jsx)(me.Fragment,{});let Q,$;Q=F?W?(0,me.jsx)(Et,{autocompleteQuery:T,onAutocompleteQueryChange:M,isAddTo:f,isTurnIntoPage:v,moveToSpaceMenuStore:L,menuListStore:Z,isLoading:z}):(0,me.jsx)(C().Z,{isInput:!0,children:(0,me.jsx)(Et,{autocompleteQuery:T,onAutocompleteQueryChange:M,isAddTo:f,isTurnIntoPage:v,moveToSpaceMenuStore:L,menuListStore:Z,isLoading:z})}):void 0,$=W?{onMouseEnter:j,menuType:N().o.Modal,title:v?(0,me.jsx)(p()._H,{defaultMessage:"Add to another page",id:"moveBlockMenu.mobileNewPageInj.label"}):f?(0,me.jsx)(p()._H,{defaultMessage:"Add new page in",id:"moveBlockMenu.mobileAddTo.label"}):(0,me.jsx)(p()._H,{defaultMessage:"Move to",id:"moveBlockMenu.mobileMoveTo.label"}),right:(0,me.jsx)(p()._H,{defaultMessage:"Done",id:"moveBlockMenu.rightDoneButton.label"}),onClickRight:I,header:Q}:{onMouseEnter:j,menuType:N().o.Popup,width:w,header:Q};const te=!Boolean(T)&&!W||G&&!Boolean(T);return(0,me.jsxs)(b().Z,{debugName:"MoveToOrCreateMenu",capture:!0,allowMenuList:!0,allowEsc:!0,allowLeft:!0,allowTabUntab:!1,allowUndo:!1,children:[(0,me.jsx)(o(94967).Z,{debugName:"MoveToOrCreateMenu",capture:!0,onEsc:I}),(0,me.jsx)(o(198829).Z,{...$,onClick:e=>{e.stopPropagation()},footer:(0,me.jsx)(Ut,{isCreateIn:l,isAddTo:f,moveToSpaceMenuStore:L,allTargetsAreNavigable:_}),children:te?(0,me.jsx)(Dt,{onAccept:h,targets:t,moveToSpaceMenuStore:L,menuListStore:Z,allTargetsAreNavigable:_,forceShowPrivatePageOption:k}):(0,me.jsx)(ve,{query:T,spaceId:X,menuListStore:Z,requestStore:V,getAutocompleteItems:D})})]})};function Bt(){return te().default.state.online}function Zt(e,t,o,a,s,n,i){if(!n||!i)return;if(e.query)return;const r=J().default.state.mainEditorCurrentBlockStore;if(!r)return;const c=s?re().G.createChildStore(r,{table:u().iU,id:s}):void 0,d=f().gt(c);return d?{key:d.pageStore.id,render:e=>{const a=t=>(0,me.jsx)(T().Z,{...(0,_().Z)(t||{},e),icon:(0,G().R)({width:14}),title:o.length>1?(0,me.jsx)(p()._H,{id:"moveBlockMenu.currentPage.pluralAddTitle",defaultMessage:"New sub-pages"}):(0,me.jsx)(p()._H,{id:"moveBlockMenu.currentPage.singleAddTitle",defaultMessage:"New sub-page"})});return t.device.isPhone?a():(0,me.jsx)(B().Z,{renderTooltip:()=>(0,me.jsx)(L().Z,{imageURL:l().Z.images.tooltips.pageMenu.newSubpagePng,imageWidth:140,imageHeight:100,caption:(0,me.jsx)(p()._H,{...Ct.createSubpage})}),placement:$().Placement.Right,delayThreshold:0,render:e=>a(e)})},action:()=>a(d.createInValue)}:void 0}function Vt(e,t){return!!t&&e.isTemplate()}function Lt(e,t,o){var a;t(e);const s=ie().default.getDatabaseType(),n=null===(a=J().default.state.currentSpaceStore)||void 0===a?void 0:a.id;"collection"===e.type&&n&&v().createAndCommit({userAction:"TypedMoveToMenu.handleClick",environment:o,canUndo:!0,perform:t=>{y().zq({transaction:t,databaseType:s,collectionId:e.id})}})}function Ot(e){return{width:10,marginLeft:4,fill:e.lightIconColor}}function Nt(e){var t;return!!e&&e.getChosenSpaceId()!==(null===(t=J().default.state.currentSpaceStore)||void 0===t?void 0:t.id)}function _t(e){return e.getChosenSpaceStore()??J().default.state.currentSpaceStore}function Kt(e){return e.getChosenSpaceViewStore()??J().default.state.currentSpaceViewStore}function Ht(e,t,o,a,s){const{query:n,savedQuickAddParent:i}=e,r=_t(s);if(r)return t&&!n&&"space"===i.type||"page"===i.type?Be({spaceStore:r,value:i,showPath:!0,isCreateIn:o,onAccept:a}):void 0}function Rt(e,t,o,a,s,n,i,r){var l;const{query:c,chosenSpaceStore:u}=e,g=Ct.privatePagesTitle,m=a.formatMessage(g).replace(/<[^>]*>/g,""),h=c?null===(l=(0,d().C6)(c,m))||void 0===l?void 0:l.score:void 0,f=c&&(h||0)>=d().V5;if((!c||f)&&i&&(!u||Xe({environment:t,targets:s,chosenSpaceStore:u,forceShowPrivatePageOption:r})))return{key:"private",render:e=>(0,me.jsx)(T().Z,{icon:(0,me.jsx)(V().Z,{size:22,userStore:(0,O().B7)(t)}),title:(0,me.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,me.jsx)("span",{children:(0,me.jsx)(p()._H,{...g})}),(0,E().bq)()&&(0,me.jsx)("div",{style:{marginLeft:10,display:"flex",alignItems:"center"},children:(0,W().b)({width:16,height:16,fill:o.mediumIconColor})})]}),...e}),action:()=>{n({type:"space-private-pages"})}}}function qt(e,t,o,a,s){if(e&&!s)return[];const n=_t(a),i=Kt(a);if(!n||!i)return[];let r=i.getTeamsStores();return e&&(r=(0,d().ZP)(e,r,(e=>e.getName()||""))),r.map((e=>Be({spaceStore:n,value:{type:"team",id:e.id,spaceId:n.id},showPath:!1,isCreateIn:t,onAccept:o}))).filter(m().$K)}function Dt(e){let{onAccept:t,targets:o,moveToSpaceMenuStore:a,menuListStore:i,allTargetsAreNavigable:r,forceShowPrivatePageOption:l}=e;const c=(0,s().O7)(),d=(0,n().VK)((()=>_t(a)),[a]),u=(0,n().VK)((()=>Kt(a)),[a]),p=(0,n().VK)((()=>H().Hn()),[]),g=(0,n().VK)((()=>(0,U().Cx)(d)),[d]);if(!u||!d)return null;const m=!r||g;return p?(0,me.jsx)(wt,{spaceStore:d,spaceViewStore:u,onAccept:e=>Lt(e,t,c),targets:o,menuListStore:i,moveToPagesOnly:m,forceShowPrivatePageOption:l,maxMenuItems:5}):(0,me.jsx)(We,{spaceStore:d,spaceViewStore:u,onAccept:t,targets:o,moveToPagesOnly:m,forceShowPrivatePageOption:l})}function Ut(e){let{isCreateIn:t,isAddTo:o,moveToSpaceMenuStore:a,allTargetsAreNavigable:r}=e;const l=(0,p().YB)(),c=(0,i().Fg)(),d=(0,s().O7)(),{currentUserRootStore:u,currentSpaceStore:m}=(0,n().VK)((()=>{const{currentUserRootStore:e,currentSpaceStore:t}=J().default.state;return{currentUserRootStore:e,currentSpaceStore:t}}),[]),h=(0,n().VK)((()=>a.getChosenSpaceStore()),[a]),f=(0,n().VK)((()=>r&&!(null!=m&&m.getDisableMoveToSpace())&&!t&&!o),[r,m,t,o]),S=(0,n().VK)((()=>null==u?void 0:u.getSpaceViewStores()),[u]),v=(0,n().VK)((()=>g().mN(g().oA(null==S?void 0:S.map((e=>{const t=e.getSpaceStore();return!(0,U().Cx)(t)&&t}))),(e=>e.id))),[S]);if(!u||!h||!m)return null;if(!f)return null;const y={menuTitle:l.formatMessage({defaultMessage:"Workspaces",id:"moveBlockMenu.spaceSwitcher.menuTitle"}),items:v,selectedItem:h,onSelect:e=>{a.setState({chosenSpaceId:e.id})},getKey:e=>e.id,renderItem:e=>(0,me.jsx)(T().Z,{...e,checkState:e.value.id===h.id,title:(0,U().rn)(d,e.value),icon:(0,me.jsx)(P().Z,{icon:(0,U().Wd)(d,e.value),isEmptyPage:!1,size:20,disabled:!0,title:(0,U().rn)(d,e.value)})}),renderOrigin:e=>(0,me.jsxs)(k().Z,{isSmall:!0,style:{fontWeight:"normal",fontSize:12,flexShrink:1},...e,children:[(0,me.jsx)(P().Z,{disabled:!0,icon:h.getIcon(),isEmptyPage:!1,size:16,title:h.getName(),style:{marginRight:4}}),(0,me.jsx)(le().s,{children:(0,U().rn)(d,h)}),(0,F().i)(Ot(c))]}),width:150};return(0,me.jsxs)("div",{children:[(0,me.jsx)(M().Z,{vertical:!1,size:1}),(0,me.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",padding:"4px"},children:(0,me.jsx)(A().Z,{...y},"space-switcher")})]})}function Et(e){let{isLoading:t,autocompleteQuery:o,onAutocompleteQueryChange:a,isAddTo:l,isTurnIntoPage:c,moveToSpaceMenuStore:d,menuListStore:u}=e;const g=(0,p().YB)(),m=(0,i().Fg)(),f=(0,s().O7)(),{device:S}=f,v=(0,n().VK)((()=>H().Hn()&&ie().default.state.isOpen&&ie().default.state.variant===r().ii&&!ee().CachedTypedDatabasesStore.state),[]),y=(0,n().VK)((()=>function(e){let{intl:t,isAddTo:o,isTurnIntoPage:a,moveToSpaceMenuStore:s}=e;if(Nt(s))return t.formatMessage({defaultMessage:"Duplicate page…",id:"moveToMenuRenderer.duplicateToSpace.label"});if(H().Hn()){const e=ie().default.getDatabaseType();if(H().XN()){const o=(0,x().sN)(e);return t.formatMessage({defaultMessage:"Move {typedItemName} to…",id:"moveToMenuRenderer.moveTo.typedLabel"},{typedItemName:o})}{const o=(0,x().sN)(e);return t.formatMessage({defaultMessage:"Search for a {typedItemName} database…",id:"moveToMenuRenderer.createIn.typedLabel"},{typedItemName:o})}}return a?t.formatMessage({defaultMessage:"Search page to add in…",id:"moveToMenuRenderer.addNewPageIn.label"}):o?t.formatMessage({defaultMessage:"Search page to add to…",id:"moveToMenuRenderer.addTo.label"}):t.formatMessage({defaultMessage:"Move page to…",id:"moveToMenuRenderer.moveTo.teamLabel"})}({intl:g,isAddTo:l,isTurnIntoPage:c,moveToSpaceMenuStore:d})),[g,l,c,d]),T=(0,n().VK)((()=>Nt(d)),[d]),M=(0,z().Z)(t,400,0);return(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(j().ZP,{onCancel:()=>{ie().default.state.isOpen&&ie().default.setState({...ie().default.state,isOpen:!1})},preventCaptureArrowShortcuts:!o,disabled:v,focus:!S.isMobile||void 0,focusAfterAnimation:!0,value:o,onChange:e=>{a(e.target.value),u.setState({...u.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})},placeholder:y,inputLeft:(0,me.jsx)(j().f_,{icon:X().R}),inputRight:M&&(0,me.jsx)(w().Z,{style:{marginRight:2}}),style:{marginBottom:-2}}),T&&(0,me.jsxs)(Z().Z,{isMultiline:!0,isSecondaryColor:!1,style:{background:m.accentColors.gray[30],marginTop:12,marginLeft:12,marginRight:12,padding:8,borderRadius:6},children:[(0,Q().t)({fill:m.accentColors.orange[400],width:14,height:14,marginRight:4,alignSelf:"center",display:"inline-block",verticalAlign:"text-bottom"}),(0,me.jsx)("span",{children:(0,me.jsx)(p()._H,{id:"moveBlockMenu.duplicateToSpace.message",defaultMessage:"You can only duplicate pages into another workspace — not move them."})}),(0,me.jsx)(I().Z,{href:(0,D().UY)("guides.duplicateToSpace"),style:{color:m.accentColors.gray[500],fontWeight:h().Ue.semibold,marginTop:4},children:(0,me.jsx)(p()._H,{id:"moveBlockMenu.duplicateToSpace.learnMoreLink",defaultMessage:"Learn more"})})]})]})}}}]);