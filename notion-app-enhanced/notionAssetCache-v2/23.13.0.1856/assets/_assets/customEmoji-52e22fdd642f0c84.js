"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[60156],{156875:(e,t,i)=>{i.r(t),i.d(t,{CustomEmojiSettings:()=>q});i(267602),i(653476),i(241792);var o=()=>i(790424),n=i(667294),s=()=>i(146947),r=()=>i(219727),a=()=>i(142735),l=()=>i(846550),d=()=>i(646574);const m=(0,i(827282).CZ)("emojiFace",{default:{loader:()=>Promise.resolve().then(i.bind(i,949558))},small:{loader:()=>i.e(19951).then(i.bind(i,892422))},fill:{loader:()=>i.e(53402).then(i.bind(i,248482))},fillSmall:{loader:()=>i.e(70620).then(i.bind(i,50120))}},["emoji","face","emotion","expression","smile"]);var c=()=>i(788860),u=()=>i(696459),g=()=>i(707513),j=()=>i(269299),h=()=>i(154186),p=()=>i(666414),x=()=>i(291198),f=()=>i(603692),y=()=>i(661297),C=()=>i(906651),E=()=>i(654133),v=()=>i(537876),w=()=>i(504117),S=()=>i(868614),_=()=>i(809807),b=()=>i(378907),B=()=>i(606757),M=()=>i(270820),Z=()=>i(998901),k=()=>i(180099),A=()=>i(933539),I=()=>i(749826),T=()=>i(509695),K=()=>i(308186),H=()=>i(827973),O=()=>i(448419),F=()=>i(1910),P=()=>i(198829),R=()=>i(255577),V=()=>i(388284),D=()=>i(352230),L=()=>i(164079),Y=()=>i(913813),z=()=>i(821149),N=()=>i(953293),W=()=>i(739479);var G=i(785893);function U(e){const t=(0,l().yK)((e=>({editButtonIcon:{width:18,height:18},lockedIcon:{width:24,height:18,fill:e.mediumIconColor}})),[]),i=(0,n.useRef)(null);return(0,a().VK)((()=>e.store.canEdit()),[e.store])?(0,G.jsx)(O().ZP,{alignmentToOrigin:Z().Alignment.End,renderOrigin:e=>(0,G.jsx)(E().Z,{renderTooltip:()=>(0,G.jsx)(c()._H,{id:"customEmojiEditPopup.editCustomEmoji",defaultMessage:"Edit"}),placement:Z().Placement.Bottom,render:o=>(0,G.jsx)(F().Z,{...(0,L().Z)(o,e),ariaLabel:"Edit custom emoji",icon:Y().O,iconStyle:t.editButtonIcon,ref:i})}),popupType:O().Z4.Popup,render:t=>(0,G.jsx)($,{...e,parent:t,iconButtonRef:i})}):(0,G.jsx)(E().Z,{renderTooltip:()=>(0,G.jsx)(c()._H,{id:"customEmojiEditPopup.cantEditCustomEmoji",defaultMessage:"You don't have permission to edit this emoji"}),placement:Z().Placement.Bottom,render:e=>(0,G.jsx)("div",{style:t.lockedIcon,...e,children:(0,z().b)()})})}function $(e){const{parent:t,store:i,iconButtonRef:o}=e,n=(0,r().O7)(),s=(0,c().YB)(),a=[{key:"edit",render:e=>(0,G.jsx)(X,{...e}),action:()=>{var e;A().Z.setState({open:!0,entrypoint:"settings",originRect:null===(e=o.current)||void 0===e?void 0:e.getBoundingClientRect(),store:i}),t.close()}},{key:"delete",render:e=>(0,G.jsx)(J,{...e}),action:async()=>{(await K().gt({message:s.formatMessage({id:"customEmoji.delete.confirmation.title",defaultMessage:"Delete this emoji?"}),description:s.formatMessage({id:"customEmoji.delete.confirmation.description",defaultMessage:"This will delete it for everyone in your workspace"}),acceptLabel:s.formatMessage({id:"customEmoji.delete.confirmation.accept",defaultMessage:"Delete"}),acceptColor:"red",mode:"wide"})).accept&&function(e){const{environment:t,store:i}=e,o=i.getModel();o&&j().createAndCommit({environment:t,userAction:"customEmojiActions.delete",canUndo:!0,perform:e=>{j().applyOperation({transaction:e,store:i,operation:o.ops.delete()})}})}({environment:n,store:i}),t.close()}}];return(0,G.jsx)(P().Z,{menuType:D().o.Popup,width:180,children:(0,G.jsx)(R().Z,{initialFocus:void 0,type:R().i.Vertical,sections:[{key:0,render:e=>(0,G.jsx)(V().Z,{...e}),items:a}]})})}function J(e){return(0,G.jsx)(H().Z,{...e,icon:(0,W().y)({width:14,height:14}),title:(0,G.jsx)(c()._H,{id:"customEmoji.settings.delete",defaultMessage:"Delete"})})}function X(e){return(0,G.jsx)(H().Z,{...e,icon:(0,N().R)({width:14,height:14}),title:(0,G.jsx)(c()._H,{id:"customEmoji.settings.edit",defaultMessage:"Edit"})})}function q(e){const{spaceStore:t}=e,i=(0,r().O7)(),o=(0,a().VK)((()=>{var e;return(null===(e=k().Z.getData(i,{spaceId:t.id}))||void 0===e?void 0:e.pointers)??[]}),[i,t.id]),s=(0,a().VK)((()=>t.canAdmin()),[t]),l=(0,a().VK)((()=>t.getSetting("custom_emoji_creation_only_admin")??!1),[t]),[d,m]=(0,n.useState)(""),u=s||!l;return(0,G.jsx)(w().ZP,{children:(0,G.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,G.jsx)("div",{style:{marginBottom:4},children:(0,G.jsx)(S().Z,{large:!0,divider:"full",children:(0,G.jsx)(c()._H,{id:"emoji.heading.title",defaultMessage:"Emoji"})})}),s&&(0,G.jsx)(oe,{spaceStore:t,customEmojiCreationOnlyAdmin:l}),0===o.length?(0,G.jsx)(te,{canCreateCustomEmoji:u}):(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(ee,{searchFilter:d,setSearchFilter:m,canCreateCustomEmoji:u,customEmojiCount:o.length}),(0,G.jsx)(Q,{searchFilter:d,customEmojiPointers:o})]})]})})}function Q(e){const t=(0,l().yK)((()=>({column:{paddingRight:4,paddingLeft:4,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},imageColumn:{width:"10%"},nameColumn:{width:"40%"},addedByColumn:{width:"25%"},dateAddedColumn:{width:"20%"},editColumn:{width:"5%"}})),[]),{customEmojiPointers:i,searchFilter:r}=e,[m,g]=(0,n.useState)("desc"),j=(0,a().VK)((()=>i.map((e=>{const t=(0,B().KX)({parentStore:void 0,pointer:e});if(null!=t&&t.getAlive())return t}))),[i]),p=(0,c().YB)(),x=(0,a().VK)((()=>(r.length?j.filter((e=>{var t;const i=(null==e||null===(t=e.getCreatedByStore())||void 0===t?void 0:t.getDisplayName(p))??"";return`${(null==e?void 0:e.getName())??""} ${i}`.toLowerCase().includes(r.toLowerCase())})):j).filter(u().$K).sort(((e,t)=>"asc"===m?e.getCreatedTime()-t.getCreatedTime():t.getCreatedTime()-e.getCreatedTime()))),[j,p,r,m]),f=(0,n.useRef)(null),y=(0,o().MG)({count:x.length,getScrollElement:()=>f.current,estimateSize:()=>46,overscan:5});(0,n.useEffect)((()=>{x.length>0&&y.scrollToIndex(0)}),[y,r,x]);const C=y.getVirtualItems(),E=[{key:"image",header:(0,G.jsx)(c()._H,{id:"customEmojis.settings.table.header.image",defaultMessage:"Image"}),style:{...t.column,...t.imageColumn}},{key:"name",header:(0,G.jsx)(c()._H,{id:"customEmojis.settings.table.header.name",defaultMessage:"Name"}),style:{...t.column,...t.nameColumn}},{key:"addedBy",header:(0,G.jsx)(c()._H,{id:"customEmojis.settings.table.header.addedBy",defaultMessage:"Added by"}),style:{...t.column,...t.addedByColumn}},{key:"dateAdded",header:(0,G.jsxs)(h().Z,{ignoreLocalHoverState:!0,onClick:()=>{g("asc"===m?"desc":"asc")},style:{display:"flex",alignItems:"center"},children:[(0,G.jsx)(c()._H,{id:"customEmojis.settings.table.header.dateAdded",defaultMessage:"Date added"}),(0,G.jsx)(_().w,{up:"asc"===m})]}),style:{...t.column,...t.dateAddedColumn}},{key:"edit",header:(0,G.jsx)(G.Fragment,{}),style:{...t.column,...t.editColumn}}];return(0,G.jsx)("div",{style:{height:"100%",width:"100%",overflowY:"auto"},ref:f,children:(0,G.jsx)(b().Z,{tableBodyStyle:{height:y.getTotalSize(),width:"100%",position:"relative"},columns:E,rows:C.map((e=>function(e,t){function i(){return(0,G.jsx)(v().Z,{size:24,emojiStore:e})}function o(){const t=(0,a().VK)((()=>e.getName()),[]);return(0,G.jsx)("span",{children:t})}function n(){const i=(0,a().VK)((()=>{const i=e.getCreatedByStore();return null==i?void 0:i.getDisplayName(t)}),[]);return(0,G.jsx)("span",{children:i})}function r(){const t=(0,a().VK)((()=>e.getCreatedTime()),[]);return(0,G.jsx)("span",{children:(0,d().Yx)(t,"medium",s().locale)})}return{key:e.id,columns:[(0,G.jsx)(i,{},e.id),(0,G.jsx)(o,{},e.id),(0,G.jsx)(n,{},e.id),(0,G.jsx)(r,{},e.id),(0,G.jsx)(U,{store:e},e.id)]}}(x[e.index],p))),rowStyle:e=>{let{rowIndex:t}=e;return{position:"absolute",top:0,left:0,width:"100%",height:C[t].size,transform:`translateY(${C[t].start}px)`,display:"flex",alignItems:"center"}},cellStyle:e=>{let{columnIndex:t}=e;return E[t].style}})})}function ee(e){const{searchFilter:t,setSearchFilter:i,canCreateCustomEmoji:o,customEmojiCount:n}=e,s=(0,l().yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:o?"space-between":"end",marginBottom:20,gap:"16px 8px",flexWrap:"wrap"},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor},searchInput:{flex:"1 1 100px",maxWidth:250,minWidth:100},tooltip:{width:240,textWrap:"wrap"}})),[o]),r=(0,c().YB)(),d=(0,a().VK)((()=>I().default.getConfigKey("custom_emojis_config","limit")),[]),m=n>=d;return(0,G.jsxs)("div",{style:s.container,children:[o&&(0,G.jsx)(E().Z,{style:s.tooltip,placement:Z().Placement.Bottom,alignment:Z().Alignment.Start,disableTooltip:!m,renderTooltip:()=>(0,G.jsx)(c()._H,{id:"customEmoji.settings.customEmojiLimit.error",defaultMessage:"Your workspace has reached the custom emoji limit of {customEmojiLimit}",values:{customEmojiLimit:d.toLocaleString()}}),render:e=>(0,G.jsx)(C().Z,{...e,onClick:ie,disabled:m,children:(0,G.jsx)(c()._H,{id:"customEmoji.settings.addEmoji",defaultMessage:"Add emoji"})})}),(0,G.jsx)(x().Z,{placeholder:r.formatMessage({id:"customEmoji.settings.search",defaultMessage:"Search by name or added by"}),left:(0,M().R)(s.searchIcon),showClearButton:!0,format:x().B.Small,value:t,onChange:e=>{i(e.target.value)},style:s.searchInput})]})}function te(e){const{canCreateCustomEmoji:t}=e,i=(0,l().yK)((e=>({container:{display:"flex",marginTop:100,justifyContent:"center",alignItems:"center",flexDirection:"column",gap:12},text:{maxWidth:200,fontWeight:g().Ue.regular,textAlign:"center",fontSize:g().JB.UISmall.desktop,fontFamily:g().Gl.sans,color:e.mediumTextColor}})),[]);return(0,G.jsxs)("div",{style:i.container,children:[(0,G.jsx)(f().y,{iconGroup:m,variantName:"default",colorName:"tertiary",overrideSize:()=>64}),(0,G.jsx)("span",{style:i.text,children:(0,G.jsx)(c()._H,{id:"customEmoji.empty.title",defaultMessage:"Custom emoji are available for everyone in your workspace"})}),t&&(0,G.jsx)(y().Z,{onClick:ie,children:(0,G.jsx)(c()._H,{id:"customEmoji.empty.addEmoji",defaultMessage:"Add emoji"})})]})}function ie(e){const t=e.target;A().Z.setState({open:!0,entrypoint:"settings",originRect:t.getBoundingClientRect()})}function oe(e){const{spaceStore:t,customEmojiCreationOnlyAdmin:i}=e,o=(0,r().O7)(),n=(0,l().yK)((e=>({divider:{color:e.regularDividerColor,marginTop:20,marginBottom:20}})),[]);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(T().O,{title:(0,G.jsx)(c()._H,{id:"customEmojis.settings.customEmojiCreationOnlyAdmin.title",defaultMessage:"Limit custom emoji creation to workspace owners"}),description:(0,G.jsx)(c()._H,{id:"customEmojis.settings.customEmojiCreationOnlyAdmin.caption",defaultMessage:"Existing emoji can still be edited or deleted by their creator"}),selected:i,onChange:()=>{j().createAndCommit({userAction:"customEmojis.settings.toggleCustomEmojiCreationOnlyAdmin",environment:o,canUndo:!0,perform:e=>{j().applyOperation({transaction:e,store:t,operation:{pointer:t.pointer,path:["settings","custom_emoji_creation_only_admin"],command:"set",args:!i}})}})}}),(0,G.jsx)(p().Z,{size:1,style:n.divider,dividerColor:n.divider.color})]})}}}]);