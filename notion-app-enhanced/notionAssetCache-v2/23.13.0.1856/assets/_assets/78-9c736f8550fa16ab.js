"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[78],{152862:(e,t,n)=>{n.d(t,{Y:()=>a,h:()=>o});var i=()=>n(594546);function o(e){i().K4(e,"view_public_site_click")}function a(e,t){i().K4(e,"share_menu_tab_click",t)}},136343:(e,t,n)=>{n.d(t,{O:()=>Q});var i=()=>n(146947),o=()=>n(743359),a=()=>n(321160),r=()=>n(728670),s=()=>n(955620),l=()=>n(661727),d=()=>n(513670),c=()=>n(707513),u=()=>n(205228),m=()=>n(527278),g=()=>n(239482),p=()=>n(436094),h=()=>n(95718),f=()=>n(421654),v=()=>n(269299),b=()=>n(109757);const S=630,y=1200,I=(0,n(568017).gh)({theme:"light"}),x=240,w="white",k=200,U=96,_=150,C=184,M=100,j=145,B=23,Z=347,P=24,T=100,A=100,E=100,W="black",F=96,O=68,R=I.text.tertiary,H=40,N=(0,n(788860).vU)({builtWithNotion:{id:"socialMediaPreview.madeWithNotion",defaultMessage:"Made with Notion"}}),V='"Apple Color Emoji","Segoe UI Emoji",NotoColorEmoji,"Noto Color Emoji","Segoe UI Symbol","Android Emoji",EmojiSymbols';function D(e){return new Promise(((t,n)=>{const i=new Image;i.onload=()=>t(i),i.onerror=n,i.crossOrigin="anonymous",i.src=e}))}function K(e,t){return`${c().Ue.bold} ${t}px ${c().pe({pageFont:e,locale:i().locale})}`}function L(e){const t=c().Ue.medium,n=c().pe({pageFont:e,locale:i().locale});return`${t} ${H}px ${n}`}function $(e){let{context:t,text:n,font:i,color:o,x:a,y:r}=e;t.font=i,t.textAlign="left",t.textBaseline="top",t.fillStyle=o,t.fillText(n,a,r)}async function Q(e){var t;let{store:n,environment:i}=e;if(n.pathIsDead()||!(0,r().$t)(g().fJ(n))||(0,h().Eo)(n)||n.inMemoryRecordCache.recordHasOverride({pointer:n.pointer,userId:i.currentUser.id}))return;const c=s().QaF(n.getTitleValue())||"",H=null===(t=n.getIcon())||void 0===t?void 0:t.icon,Q=function(e,t){var n;const i=null===(n=t.getCover())||void 0===n?void 0:n.cover;if(i)return o().EK({url:i,width:y,permissionRecord:t.pointer,stripGoogleIconQuery:!0,baseUrl:u().default.domainBaseUrl,fullyQualified:!1,userId:e.currentUser.id})}(i,n),z=n.getFormat(),X=new OffscreenCanvas(y,S),G=X.getContext("2d"),[Y,q]=function(e,t){const n=document.createElement("div");n.style.width="auto",n.style.position="absolute",n.style.whiteSpace="nowrap",n.style.font=K(t,F),n.style.top="110vh",n.innerText=e;const i=y-T-A,o=document.body;if(o.appendChild(n),n.clientWidth<i)return o.removeChild(n),[e,F];if(n.style.font=K(t,O),n.clientWidth<i)return o.removeChild(n),[e,O];let a=e;for(;n.clientWidth>i;)a=a.substring(0,a.length-1),n.innerText=`${a}…`;return o.removeChild(n),[`${a}…`,O]}(c,z.page_font),J=K(z.page_font,q),ee=Z+(H?B:0),te=ee+P+q;if(G){!function(e){e.fillStyle=w,e.fillRect(0,0,y,S)}(G),await async function(e){let{context:t,coverImageUrl:n,icon:i,coverPosition:o=.5}=e;if(n){const e=await D(n),i=e.width*(x/y),a=((0,d().hj)(o)?1-o:.5)*(e.height-i);t.drawImage(e,0,a,e.width,i,0,0,y,x)}else{const e=(0,p().O)({icon:i,theme:I}),n=e?(0,l().Fq)(e,.1):I.home.cards.coverPhoto.base;t.fillStyle=n,t.fillRect(0,0,y,x),t.fillStyle="rgb(0,0,0,1)"}}({context:G,coverImageUrl:Q,icon:H,coverPosition:z.page_cover_position}),await async function(e){let{context:t,store:n,icon:i}=e;if(i)if((0,a().Z)(i))t.font=`${k}px ${V}`,t.textAlign="left",t.textBaseline="top",t.fillText(i,U,_);else{const e=o().EK({url:i,baseUrl:u().default.domainBaseUrl,fullyQualified:!0,permissionRecord:n.pointer,width:C,userId:void 0}),a=await D(e);t.drawImage(a,M,j,C,C)}}({context:G,store:n,icon:H}),$({context:G,text:Y,font:J,color:W,x:T,y:ee}),$({context:G,text:m().Z.formatMessage(N.builtWithNotion),font:L(z.page_font),color:R,x:E,y:te});const e=await X.convertToBlob();!function(e){let{store:t,file:n,environment:i}=e;b().cT({environment:i,file:n,bucket:"secure",record:t.pointer,onComplete:e=>{v().createAndCommit({userAction:"SocialMediaPreviewImageUploadStore.updateSocialMediaPreviewImage",environment:i,canUndo:!1,perform:n=>{f().eO({store:t,url:e,transaction:n})}})},retryWhenOffline:!0})}({store:n,environment:i,file:new File([e],"SocialMediaPreviewImage.png",{type:"image/png"})})}}},279674:(e,t,n)=>{n.d(t,{v:()=>o});n(667294);var i=n(785893);const o=(0,n(827282).IU)("blueCircleDot",{viewBox:"0 0 16 16",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("circle",{cx:"8",cy:"8",r:"8",fill:"none",stroke:"#2383E2",children:[(0,i.jsx)("animate",{attributeName:"r",from:"3",to:"8",dur:"1s",begin:"0s",repeatCount:"indefinite"}),(0,i.jsx)("animate",{attributeName:"opacity",from:"1",to:"0",dur:"1s",begin:"0s",repeatCount:"indefinite"})]}),(0,i.jsx)("circle",{cx:"8",cy:"8",r:"3",fill:"#2383E2"})]})})},363253:(e,t,n)=>{n.d(t,{z:()=>o});n(667294);var i=n(785893);const o=(0,n(827282).IU)("code",{viewBox:"0 0 16 16",svg:(0,i.jsx)("g",{children:(0,i.jsx)("path",{d:"M.056 8.122a.72.72 0 01.07-.306.91.91 0 01.204-.285l3.39-3.05a.745.745 0 01.542-.215.675.675 0 01.505.236c.14.158.202.337.188.537a.737.737 0 01-.264.51L1.855 8.122l2.836 2.573a.737.737 0 01.264.51.716.716 0 01-.188.537.694.694 0 01-.505.242.766.766 0 01-.543-.22L.33 8.708a.87.87 0 01-.204-.274.756.756 0 01-.07-.312zm6.43 5.21a.675.675 0 01-.446-.355.782.782 0 01-.027-.58l2.605-8.942c.068-.226.186-.384.354-.473a.714.714 0 01.559-.054.678.678 0 01.446.344.69.69 0 01.048.553l-2.621 8.98a.738.738 0 01-.35.463.711.711 0 01-.569.064zm9.453-5.21a.695.695 0 01-.065.312.869.869 0 01-.204.274l-3.39 3.056a.773.773 0 01-.547.22.677.677 0 01-.5-.242.707.707 0 01-.193-.537.738.738 0 01.263-.51l2.841-2.573-2.84-2.573a.738.738 0 01-.264-.51.7.7 0 01.193-.537.659.659 0 01.5-.236.75.75 0 01.548.214l3.389 3.051a.91.91 0 01.204.285c.047.1.068.202.064.306z"})})})},436094:(e,t,n)=>{n.d(t,{O:()=>r});n(122556),n(582845),n(250570),n(533019),n(721473),n(788208),n(22624);var i=()=>n(890085),o=()=>n(321160),a=()=>n(338530);function r(e){let{icon:t,theme:n}=e;if(t)return(0,o().Z)(t)?a().Z.state.emojiByColorProcessed[t]:(0,i().V2)(t)?function(e){var t;let{uri:n,theme:o}=e;const a=null===(t=n.match(/\/icons\/[\w\-]*_(.+)\.svg/))||void 0===t?void 0:t[1];if(!function(e){if(!e)return!1;return s.has(e)}(a))return;return i().Lr[o.mode][a]}({uri:t,theme:n}):void 0}const s=new Set((0,n(696459).Yd)(i().Lr.light))},714022:(e,t,n)=>{n.d(t,{Tm:()=>Z,xE:()=>F,zC:()=>T});var i=n(667294),o=()=>n(219727),a=()=>n(142735),r=()=>n(846550),s=()=>n(714230),l=()=>n(956057),d=()=>n(788860),c=()=>n(696459),u=()=>n(707513),m=()=>n(152862),g=()=>n(643051),p=()=>n(1910),h=()=>n(67961),f=()=>n(539245),v=()=>n(514737),b=()=>n(247724),S=()=>n(641506),y=()=>n(880556),I=()=>n(279674),x=()=>n(179512),w=()=>n(688049),k=()=>n(314160),U=()=>n(998470),_=()=>n(836756),C=()=>n(779733),M=()=>n(681832),j=n(785893);const B=(0,d().vU)({seo:{defaultMessage:"Search engine indexing",id:"publishSiteSettings.SEO.title"},embed:{defaultMessage:"Embed this page",id:"embedSiteSettings.title"}});function Z(e){let{inviteTargetsStore:t,mostPermissivePublicItem:n}=e;const{display:i,source:o}=(0,a().VK)((()=>{const{display:e}=M().default.state;if(e===M().wV.Invite){const{source:t}=M().default.state;return{display:e,source:t}}return{display:e,source:void 0}}),[]);switch(i){case M().wV.MainShareMenu:case M().wV.Publish:return(0,j.jsx)(T,{mostPermissivePublicItem:n});case M().wV.Invite:if("notion"===o)return(0,j.jsx)(A,{inviteTargetsStore:t});if("slack"===o||"google"===o)return(0,j.jsx)(E,{source:o});throw(0,c().t1)(o);default:(0,c().t1)(i)}}const P=[M().XF.Share,M().XF.Publish];function T(e){let{mostPermissivePublicItem:t}=e;const n=(0,o().O7)(),s=i.useRef(null),{isMobile:c}=n.device,g=(0,a().VK)((()=>(0,v().L)(t.permissionItem)),[t.permissionItem]);(0,i.useEffect)((()=>{const e=M().default.state,t=e.tab===M().XF.Share&&e.display===M().wV.MainShareMenu?e.source:void 0;g&&t!==M().Xd.InviteBackButton&&(M().default.setState({tab:M().XF.Publish,display:M().wV.Publish,sessionId:l().Il(),isInitialized:!0}),(0,k().Jh)(n,{source:"share_button"}))}),[n,g]);const p=(0,a().VK)((()=>M().default.state.tab),[]),h=(0,a().VK)((()=>(0,C().wZ)()),[]),y=(0,r().yK)((e=>({tabStyle:{color:e.lightTextColor,...c&&{width:"50%",textAlign:"center"}},selectedTabStyle:h?{}:{fontWeight:u().Ue.medium},tabTitleStyle:{color:"inherit",...h&&{fontSize:(0,S().yv)(n,"UIRegular"),fontWeight:u().Ue.medium}},style:c?{marginBottom:8,justifyContent:"space-between"}:{marginBottom:h?16:14,paddingLeft:h?16:8},tabBorderStyle:h?{left:0,right:0}:{}})),[n,c,h]),x=(0,r().yK)((e=>({tabStyle:{width:"50%",textAlign:"center",borderRadius:10,color:e.text.secondary,fontWeight:u().Ue.regular,paddingTop:2,paddingBottom:2},tabBorderStyle:{borderBottom:"none"},selectedTabStyle:{borderRadius:8,background:"dark"===e.mode?e.tint.regular:e.surface.elevated},tabTitleStyle:{color:"inherit",fontSize:(0,S().yv)(n,"UIRegular"),fontWeight:u().Ue.regular},selectedTabTitleStyle:{fontWeight:u().Ue.medium},style:{justifyContent:"space-between",padding:2,background:e.tint.regular,borderRadius:10,marginBottom:0,height:34}})),[n]),w=(0,r().yK)((e=>({publishTabContainer:{display:"flex",alignItems:"center"},publishIcon:{height:16,width:16,marginLeft:4,opacity:p===M().XF.Publish?1:.5},tabBarContainer:{paddingLeft:20,paddingRight:20,paddingTop:8,paddingBottom:16,backgroundColor:e.surface.page}})),[p]),B=(0,i.useCallback)((e=>{const t=P[e];t!==p&&(m().Y(n,{tab:t}),t===M().XF.Share&&M().default.setState({...M().default.state,display:M().wV.MainShareMenu,tab:M().XF.Share,source:M().Xd.ShareTab}),t===M().XF.Publish&&M().default.setState({...M().default.state,display:M().wV.Publish,tab:M().XF.Publish}))}),[p,n]),Z=[(0,j.jsx)(i.Fragment,{children:c&&!h?(0,j.jsx)(d()._H,{defaultMessage:"Permissions",id:"shareMenu.permissionsTab.title"},"permissions"):(0,j.jsx)(d()._H,{defaultMessage:"Share",id:"shareMenu.shareTab.title"},"share")},"title"),(0,j.jsxs)("div",{ref:s,style:w.publishTabContainer,className:b().UBk,children:[(0,j.jsx)(d()._H,{defaultMessage:"Publish",id:"shareMenu.publishTab.title"},"publish"),g&&(0,I().v)(w.publishIcon)]},"publishTab")],T=(0,a().VK)((()=>_().Z.state.siteSettingContentType),[]);return"seo"===T?(0,j.jsx)(O,{}):"embed"===T?(0,j.jsx)(R,{handleBackButtonClick:()=>{U().pn("initial")}}):c&&h?(0,j.jsx)("div",{style:w.tabBarContainer,children:(0,j.jsx)(f().Z,{...x,tabs:Z,selectedIndex:P.indexOf(p),onChange:B,hideTabBorder:!0})}):(0,j.jsx)(f().Z,{...y,tabs:Z,selectedIndex:P.indexOf(p),onChange:B})}function A(e){let{inviteTargetsStore:t}=e;const n=(0,a().VK)((()=>(0,C().wZ)()),[]),o=(0,r().yK)((e=>({container:n?{display:"flex",paddingLeft:12,paddingRight:12,marginBottom:16,height:40,boxShadow:`inset 0 -1px 0 ${e.regularDividerColor}`}:{display:"flex",margin:"0 12px 6px",height:48}})),[n]),s=(0,i.useCallback)((()=>{t.reset(),M().default.setState({...M().default.state,display:M().wV.MainShareMenu,tab:M().XF.Share,source:M().Xd.InviteBackButton})}),[t]);return(0,j.jsx)("div",{style:o.container,children:(0,j.jsx)(F,{onClick:s,titleMessage:n?(0,j.jsx)(d()._H,{id:"shareMenu.sendInvite.labelV2",defaultMessage:"Invite"}):(0,j.jsx)(d()._H,{id:"shareMenu.sendInvite.label",defaultMessage:"Send invite"})})})}function E(e){const{source:t}=e,n=(0,d().YB)(),o=(0,r().yK)((()=>({container:{display:"flex",justifyContent:"space-between",margin:"0 12px",height:48,alignItems:"center"},titleLabel:{display:"flex",fontSize:12,alignItems:"center",fontWeight:u().Ue.semibold}})),[]),a=(0,i.useCallback)((()=>{M().default.setState({...M().default.state,tab:M().XF.Share,display:M().wV.Invite,source:M().T5.Notion,focus:M().Sw.Search,emailMessage:""})}),[]);return(0,j.jsxs)("div",{style:o.container,children:[(0,j.jsx)(h().Z,{style:o.titleLabel,children:(0,j.jsx)(d()._H,{id:"shareMenu.addFromSlack.label",defaultMessage:"Add people from {integrationNameWithLogo}",values:{integrationNameWithLogo:(0,j.jsx)(W,{source:t})}})}),(0,j.jsx)(p().Z,{ariaLabel:n.formatMessage({id:"shareMenuHeader.goBackToInviteFromNotionMenu.iconButton",defaultMessage:"Close external integration and go back to the main invite flow."}),icon:w().D,style:{borderRadius:"100%"},onClick:a})]})}function W(e){let{source:t}=e;const n=(0,r().yK)((()=>({imageStyle:{marginLeft:4,marginRight:4}})),[]);return t===M().T5.Slack?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(g().Z,{type:"image_url",imageURL:s().Z.images.externalIntegrations.slackIconPng,size:18,imageStyle:n.imageStyle}),(0,j.jsx)(d()._H,{defaultMessage:"Slack",id:"shareMenu.slackIntegrationName.label"})]}):t===M().T5.Google?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(g().Z,{type:"image_url",imageURL:s().Z.images.externalIntegrations.googleGIconPng,size:18,imageStyle:n.imageStyle}),(0,j.jsx)(d()._H,{defaultMessage:"Google",id:"shareMenu.googleContactsIntegrationName.label"})]}):void(0,c().t1)(t)}function F(e){const{onClick:t,titleMessage:n}=e,i=(0,o().O7)(),s=(0,a().VK)((()=>(0,C().wZ)()),[]),l=(0,d().YB)(),c=(0,r().yK)((()=>({topContainer:{display:"flex",alignItems:"center",width:"max-content"},backButtonPressedStyle:{backgroundColor:"transparent"},iconButton:{marginRight:6,height:24,width:24},arrowIcon:{...s?{height:20,width:20}:{height:16,width:16},strokeWidth:u().Ue.semibold},sendInviteLabel:{fontWeight:u().Ue.medium,...s&&{fontSize:(0,S().yv)(i,"UIRegular")}}})),[i,s]);return(0,j.jsxs)("div",{style:c.topContainer,children:[(0,j.jsx)(p().Z,{icon:s?x().k:y().W,iconStyle:c.arrowIcon,style:c.iconButton,onClick:t,ariaLabel:l.formatMessage({id:"shareMenu.backButton.iconButton",defaultMessage:"Go back to main share menu."})}),(0,j.jsx)(h().Z,{style:c.sendInviteLabel,children:n})]})}function O(){const e=(0,r().yK)((e=>({container:{display:"flex",padding:"0 12px 0 8px",height:40,borderBottom:`1px solid ${e.stroke.secondary}`}})),[]),t=(0,i.useCallback)((()=>{U().pn("initial")}),[]);return(0,j.jsx)("div",{style:e.container,children:(0,j.jsx)(F,{onClick:t,titleMessage:(0,j.jsx)(d()._H,{...B.seo})})})}function R(e){const t=(0,r().yK)((e=>({container:{display:"flex",padding:"0 12px 0 8px",height:40,borderBottom:`1px solid ${e.stroke.secondary}`}})),[]);return(0,j.jsx)("div",{style:t.container,children:(0,j.jsx)(F,{onClick:e.handleBackButtonClick,titleMessage:(0,j.jsx)(d()._H,{...B.embed})})})}},314160:(e,t,n)=>{n.d(t,{Jh:()=>o,Mo:()=>r,O$:()=>l,_F:()=>a,aC:()=>s,mm:()=>d});var i=()=>n(594546);function o(e,t){(0,i().j)({environment:e,event:{eventName:"open_publish_modal",eventProperties:t}})}function a(e,t){(0,i().j)({environment:e,event:{eventName:"change_domain",eventProperties:t}})}function r(e,t){(0,i().j)({environment:e,event:{eventName:"update_seo_settings",eventProperties:t}})}function s(e,t){(0,i().j)({environment:e,event:{eventName:"site_set_link_expiration",eventProperties:t}})}function l(e,t){(0,i().j)({environment:e,event:{eventName:"page_unpublish",eventProperties:t}})}function d(e,t){(0,i().j)({environment:e,event:{eventName:"page_publish",eventProperties:t}})}},998470:(e,t,n)=>{n.d(t,{AB:()=>Z,Au:()=>V,C$:()=>$,DR:()=>M,Fo:()=>U,H2:()=>R,Hl:()=>N,KD:()=>Q,Q6:()=>j,QP:()=>E,YU:()=>A,Y_:()=>T,c7:()=>O,cy:()=>X,dM:()=>C,dU:()=>B,f$:()=>W,gx:()=>D,pn:()=>P,t:()=>F,wt:()=>z,xz:()=>K,y_:()=>H,yr:()=>L});n(821057),n(670560),n(267602),n(653476),n(241792),n(667294);var i=()=>n(396136),o=()=>n(81954),a=()=>n(928833),r=()=>n(899133),s=()=>n(788860),l=()=>n(513670),d=()=>n(342792),c=()=>n(824462),u=()=>n(636340),m=()=>n(752127),g=()=>n(102182),p=()=>n(269299),h=()=>n(205228),f=()=>n(487270),v=()=>n(314169),b=()=>n(663132),S=()=>n(479875),y=()=>n(836756),I=()=>n(759160),x=()=>n(314160),w=()=>n(566245),k=n(785893);function U(e){const{environment:t,store:n,type:i,header:r,domainId:s}=e,l=n.getSiteStore();if(l)return l.id;let d=s;var c;d||(d=null===(c=b().VA(n.getSpaceStore()))||void 0===c?void 0:c.id);const m=(0,f().$x)({environment:t,table:a().Gs,spaceId:(0,o().J)(n.getSpaceId())});p().createAndCommit({userAction:"publishSite.create",environment:t,canUndo:!0,perform:e=>{const o=u().Ue({environment:t,table:m.table,args:{id:m.id,type:i,spaceId:m.spaceId,blockId:n.id,domainId:d,currentUserId:t.currentUser.id,header:r??{}},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:e});return u().sW({store:n.getFormatStore(),data:{site_id:o.id},transaction:e}),o.id}})}function _(e){const{environment:t,siteRootBlockStore:n,domainId:i}=e;let o=n.getSiteStore();if(o||(U({environment:t,type:"site",store:n,domainId:i}),o=n.getSiteStore()),o)return o}function C(e){const{environment:t,domainId:n,resetWatermark:i}=e,o=_(e);o&&o.isDefined()&&(p().createAndCommit({userAction:"publishSite.updatePublicDomain",environment:t,canUndo:!0,perform:e=>{o.getDomainId()!==n&&p().applyOperation({transaction:e,store:o,operation:o.getModel().ops.updatePublicDomainId({domainId:n,currentUserId:t.currentUser.id})})}}),p().createAndCommit({userAction:"publishSite.resetWatermark",environment:t,canUndo:!0,perform:e=>{if(i){const n=o.getHeader();p().applyOperation({transaction:e,store:o,operation:o.getModel().ops.updateHeader({header:{...n,hideWatermark:!1},currentUserId:t.currentUser.id})})}}}),g().oV({label:(0,k.jsx)(s()._H,{id:"publishSiteSettings.publicDomain.confirmation",defaultMessage:"Successfully updated domain for all pages within this site"})}))}function M(e){const{environment:t,siteRootBlockStore:n,isSearchEngineIndexingEnabled:i}=e,a=_(e);if(!a)return;"form"!==a.getType()&&p().createAndCommit({userAction:"publishSite.updateSeoEnabled",environment:t,canUndo:!0,perform:e=>{a&&a.isDefined()&&i!==a.isSearchEngineIndexingEnabled()&&(p().applyOperation({transaction:e,store:a,operation:a.getModel().ops.updateIsSearchEngineIndexingEnabled({isSearchEngineIndexingEnabled:i,currentUserId:t.currentUser.id})}),i&&e.postSubmitCallbacks.push((async e=>{e||await c().callApi({eventName:"enqueueScanContentTask",environment:t,data:{pagePointer:{id:n.id,table:"block",spaceId:(0,o().J)(n.pointer.spaceId)}}})})))}})}function j(e){const{environment:t,store:n,seoTitle:i,seoDescription:o}=e;p().createAndCommit({userAction:"publishSite.create",environment:t,canUndo:!0,perform:e=>{const a=n.getFormat().seo_title,r=n.getFormat().seo_description;a===i&&r===o||(u().sW({store:n.getFormatStore(),data:{seo_title:i,seo_description:o},transaction:e}),(0,x().Mo)(t,{target_block_id:n.id,new_title:i??null,new_description:o??null}),g().oV({label:(0,k.jsx)(s()._H,{id:"siteSettingsEditor.publishSeoChanges.confirmation",defaultMessage:"Successfully updated the SEO settings"})}))}})}function B(e){I().Z.setState({...I().Z.state,settingOpen:e})}function Z(){I().Z.setState({...I().Z.state,settingOpen:"initial"})}function P(e){y().Z.setState({...y().Z.state,siteSettingContentType:e})}function T(e){var t,n,i;const{siteRootBlockStore:o,permissionItem:a,from:r,sudoModeStore:s}=e,l=o.getSiteStore(),d=null==l?void 0:l.getHeader(),c=(null==d||null===(t=d.customItems)||void 0===t?void 0:t.map((e=>e.blockId)))||[];I().Z.setState({settingOpen:"initial",permissionItem:a,from:r,sudoModeStore:s,faviconUrl:(null==l?void 0:l.getFaviconUrl())||null,previewImageUrl:(null==l?void 0:l.getPreviewImageUrl())||null,hideBreadcrumbs:null==d?void 0:d.hideBreadcrumbs,hideSearch:null==d?void 0:d.hideSearch,hideWatermark:null==d?void 0:d.hideWatermark,enableDuplicateAsTemplate:a.allow_duplicate,customHeaderBlockIds:c,googleAnalyticsId:null==l?void 0:l.getGoogleAnalyticsId(),theme:null==l||null===(n=l.getSettings())||void 0===n?void 0:n.theme,enableQna:null==l||null===(i=l.getSettings())||void 0===i?void 0:i.enableQna})}async function A(e){var t;const{environment:n,store:o,siteRootBlockStore:a}=e,r=_({environment:n,siteRootBlockStore:a}),u=null==r?void 0:r.getType();if(!r||"form"===u)return;const m=I().Z.getState();let h=!1;const f={};let S;m.enableQna&&(S=await async function(e){var t,n,i,o;const{environment:a,siteStore:r}=e,s=null===(t=r.getSettings())||void 0===t?void 0:t.siteUserId;if(s)return s;if(!((null===(n=r.getDomainStore())||void 0===n?void 0:n.getDomainName())??(null===(i=b().VA(r.getSpaceStore()))||void 0===i?void 0:i.domain_name)))throw new Error("no domain on site");const l=b().Co({spaceStore:r.getSpaceStore(),domainId:null===(o=r.getDomainStore())||void 0===o?void 0:o.id}).split(":")[0],u=`${(0,d().XR)(r.id)}@${l}`,m=await c().callApi({eventName:"createEmailUser",environment:a,data:{email:u}});if("failed"===m.type)throw new Error("failed to create qna user");return m.data.userId}({environment:n,siteStore:r})),p().createAndCommit({userAction:"publishSite.updateSiteSettingsInEditor",environment:n,canUndo:!0,perform:e=>{if(r&&r.isDefined()){var t,i;(r.getFaviconUrl()||null)!==m.faviconUrl&&(p().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updateFaviconUrl({faviconUrl:m.faviconUrl,currentUserId:n.currentUser.id})}),h=!0,f.favicon=m.faviconUrl);(r.getPreviewImageUrl()||null)!==m.previewImageUrl&&(p().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updatePreviewImageUrl({previewImageUrl:m.previewImageUrl,currentUserId:n.currentUser.id})}),h=!0,f.preview_image=m.previewImageUrl);const o=r.getHeader();let a=o;const s=function(e,t){const n=e.map((e=>({type:"block",blockId:e})));if(!t&&0===n.length)return;if(t&&(0,l().Xy)(n,t))return;return n}(m.customHeaderBlockIds,null==o?void 0:o.customItems);s&&(a={...a,customItems:s},f.custom_headers=s.map((e=>e.blockId))),(null==o?void 0:o.hideBreadcrumbs)!==m.hideBreadcrumbs&&(a={...a,hideBreadcrumbs:m.hideBreadcrumbs},f.hide_breadcrumbs=m.hideBreadcrumbs),(null==o?void 0:o.hideSearch)!==m.hideSearch&&(a={...a,hideSearch:m.hideSearch},f.hide_search=m.hideSearch),(null==o?void 0:o.hideWatermark)!==m.hideWatermark&&(a={...a,hideWatermark:m.hideWatermark},f.hide_watermark=m.hideWatermark),a&&o!==a&&(p().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updateHeader({header:a,currentUserId:n.currentUser.id})}),h=!0);r.getGoogleAnalyticsId()!==m.googleAnalyticsId&&(p().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updateGoogleAnalyticsId({googleAnalyticsId:m.googleAnalyticsId,currentUserId:n.currentUser.id})}),h=!0,f.google_analytics_id=m.googleAnalyticsId);(null===(t=r.getSettings())||void 0===t?void 0:t.theme)!==m.theme&&(p().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updateTheme({theme:m.theme,currentUserId:n.currentUser.id})}),h=!0,f.theme=m.theme);(null===(i=r.getSettings())||void 0===i?void 0:i.enableQna)!==m.enableQna&&(m.enableQna?S&&p().applyOperation({transaction:e,store:r,operation:{pointer:r.pointer,command:"update",path:["settings"],args:{enableQna:m.enableQna,siteUserId:S}}}):p().applyOperation({transaction:e,store:r,operation:{pointer:r.pointer,command:"update",path:["settings"],args:{enableQna:m.enableQna}}}),h=!0)}}});if((null===(t=m.permissionItem)||void 0===t?void 0:t.allow_duplicate)!==m.enableDuplicateAsTemplate&&m.permissionItem&&m.from){const e=m.from.table===i().iU?m.from.blockId:m.from.teamId;(0,v().iK)({oldPermissionItem:m.permissionItem,newPermissionItem:{...m.permissionItem,allow_duplicate:m.enableDuplicateAsTemplate},wasInherited:e!==o.id,environment:n,store:o,sudoModeStore:m.sudoModeStore,location:"published_site_settings"}),h=!0,f.enable_duplicate_as_template=m.enableDuplicateAsTemplate}h&&((0,w().u6)(n,{settings_changed:f}),g().oV({label:(0,k.jsx)(s()._H,{id:"siteSettingsEditor.publishChanges.confirmation",defaultMessage:"Changes published"})}))}function E(e){I().Z.setState({...I().Z.state,faviconUrl:e})}function W(e){I().Z.setState({...I().Z.state,previewImageUrl:e})}function F(e){I().Z.setState({...I().Z.state,hideBreadcrumbs:e})}function O(e){I().Z.setState({...I().Z.state,hideSearch:e})}function R(e){I().Z.setState({...I().Z.state,hideWatermark:e})}function H(e){I().Z.setState({...I().Z.state,enableDuplicateAsTemplate:e})}function N(e){const t=I().Z.state.customHeaderBlockIds.concat([e]);I().Z.setState({...I().Z.state,customHeaderBlockIds:t})}function V(e){const t=I().Z.state.customHeaderBlockIds.filter((t=>t!==e));I().Z.setState({...I().Z.state,customHeaderBlockIds:t})}function D(e){I().Z.setState({...I().Z.state,googleAnalyticsId:e})}function K(e){I().Z.setState({...I().Z.state,theme:e})}async function L(e){const{environment:t,spaceStore:n,query:i,siteRootBlockId:o}=e;if(!n)return;const a=await c().callApi({eventName:"searchPagesInSite",environment:t,data:{query:i,spaceId:n.id,filters:r().u4({isDeletedOnly:!1,navigableBlockContentOnly:!0,excludeTemplates:!0,editedBy:[],ancestors:[o],inTeams:[]}),sort:{field:"relevance"},limit:10}});return"failed"!==a.type?a.data:void 0}async function $(e){const{environment:t,blockStore:n,slug:i}=e,o=await c().callApi({eventName:"updatePublicPageSlug",environment:t,data:{spaceId:n.getSpaceId(),blockId:n.id,slug:i,clientVersion:h().default.version}});if("success"!==o.type)return{error:o};g().oV({label:(0,k.jsx)(s()._H,{id:"customSlugInput.updateSuccess.toast",defaultMessage:"Successfully updated URL for this page"})})}function Q(e){I().Z.setState({...I().Z.state,enableQna:e})}function z(e){const{environment:t,store:n,pageVisitSource:i}=e,{url:o}=S().$({store:n,pageVisitSource:i});m().D({environment:t,url:o})}function X(e){const{environment:t,siteStore:n,embedSettings:i}=e;p().createAndCommit({userAction:"embedSite.updateEmbedSettings",environment:t,canUndo:!0,perform:e=>{u().sW({store:n.getSettingsStore(),data:{embedSettings:i},transaction:e})}})}},566245:(e,t,n)=>{n.d(t,{Cx:()=>r,g2:()=>o,u6:()=>a});var i=()=>n(594546);function o(e,t){(0,i().j)({environment:e,event:{eventName:"open_customize_site",eventProperties:t}})}function a(e,t){(0,i().j)({environment:e,event:{eventName:"update_site_customization_settings",eventProperties:t}})}function r(e){(0,i().j)({environment:e,event:{eventName:"close_customize_site",eventProperties:{}}})}},759160:(e,t,n)=>{n.d(t,{Z:()=>o});class i extends(()=>n(263184))().default{getInitialState(){return{settingOpen:"initial",permissionItem:void 0,from:void 0,sudoModeStore:void 0,location:"",faviconUrl:null,previewImageUrl:null,hideBreadcrumbs:!1,hideSearch:!1,hideWatermark:!1,enableDuplicateAsTemplate:!1,customHeaderBlockIds:[],googleAnalyticsId:void 0,theme:void 0,enableQna:!1}}}const o=new i}}]);