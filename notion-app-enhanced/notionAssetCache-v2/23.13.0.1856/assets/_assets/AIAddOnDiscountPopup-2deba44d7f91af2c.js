"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[1352],{554240:(e,n,t)=>{t.d(n,{u:()=>o});var r=()=>t(677559);const a=new(r().Ss)("FeatureIntroPopup",(async()=>t.e(44843).then(t.bind(t,660697)))),o=(0,r().kF)(a,(e=>e.FeatureIntroPopup))},438665:(e,n,t)=>{t.d(n,{zL:()=>f,lB:()=>l,ZF:()=>d,DV:()=>g,an:()=>_,n9:()=>v,WV:()=>m});var r=()=>t(799891),a=()=>t(741633);const o={plans_page:["lic_25","lic_50","resurrection_offer","ai_fifty_percent_upgrade"],sidebar_upsell:["lic_25","lic_50"]};var i=()=>t(792409),s=()=>t(824462),c=()=>t(308186),u=()=>t(594546),p=()=>t(876822);async function d(e,n){var t;const{spaceId:r,offerCampaign:a}=n;if(!r||!a||null===(t=p().default.state.currentSpaceStore)||void 0===t||!t.canAdmin())return;const o=await s().callApi({eventName:"getCustomerOffer",environment:e,data:{spaceId:r,offerCampaign:a}});return"failed"!==o.type&&"offer"in o.data&&o.data.offer?o.data.offer:void 0}async function f(e){const{environment:n,spaceId:t,offerCampaign:r,entrypoint:a}=e,o=await s().callApi({eventName:"applyCustomerOffer",environment:n,data:{spaceId:t,offerCampaign:r,entrypoint:a??"unknown"}});if("failed"!==o.type)return o;c().x2(o)}async function l(e,n){const t=await s().callApi({eventName:"applyCustomerOffer",environment:e,data:{...n}});if("failed"!==t.type)return t;c().x2(t)}async function _(e){const{environment:n,spaceId:t,offerCampaign:r}=e;return void 0!==await d(n,{spaceId:t,offerCampaign:r})}async function m(e){var n;const{environment:t,hasReceived:o,offerType:c,newPlan:u,coupon:d}=e,f=null===(n=p().default.state.currentSpaceStore)||void 0===n?void 0:n.getSpaceId();if(!f)return;const l=await s().callApi({eventName:"updateCustomerOffer",environment:t,data:{spaceId:f,hasReceived:o,offerType:c,newPlan:u,coupon:d},headers:(0,a().Bb)({cellId:void 0,spaceId:f})});"failed"===l.type&&r().log({level:"error",from:"offerActions",type:"updateLegacyCustomerOfferFailed",error:(0,i().Ui)(l.error)})}async function g(e,n,t){const r=function(e){if(o.hasOwnProperty(e))return o[e]}(t);if(r)for(const a of r){const t=await d(e,{spaceId:n,offerCampaign:a});if((null==t?void 0:t.campaign)===a)return t}}function v(e){let{environment:n,spaceName:t,offerCampaign:r}=e;if(t)switch(r){case"lic_25":case"lic_50":(0,u().lu)(n,"lic_offer_eligible","lic_offer_eligible",3600,{workspace_name:t,lic_25:"lic_25"===r,lic_50:"lic_50"===r});break;case"resurrection_offer":(0,u().lu)(n,"resurrection_offer_eligible","resurrection_offer_eligible",3600,{workspace_name:t});break;default:return}}},835411:(e,n,t)=>{t.r(n),t.d(n,{AIAddOnDiscountPopup:()=>k});var r=t(667294),a=()=>t(219727),o=()=>t(142735),i=()=>t(846550),s=()=>t(947115),c=()=>t(255393),u=()=>t(629719),p=()=>t(893146),d=()=>t(381348),f=()=>t(788860),l=()=>t(979614),_=()=>t(269299),m=()=>t(348141),g=()=>t(554240),v=()=>t(844958),S=()=>t(876822),y=()=>t(518019),b=()=>t(538992),C=()=>t(438665),A=()=>t(548812),w=()=>t(971025),I=()=>t(18281),h=()=>t(697623),P=()=>t(897257),O=t(785893);function k(){const e=(0,a().O7)(),[n,t]=r.useState(void 0);(0,r.useEffect)((()=>{(0,s().exposeDebugValue)("resetAddOnDiscountPopup",(()=>{const{currentUserSettingsStore:n}=S().default.state;n&&_().createAndCommit({userAction:"AddOnDiscountPopup.resetAddOnPromoPopup",environment:e,canUndo:!0,perform:e=>{m().d2({userSettingsStore:n,transaction:e,data:{seen_ai_discount_popup:!1}})}})}))}),[e]);const{currentUserSettingsStore:k,currentSpaceStore:D}=(0,o().VK)((()=>{const{currentUserSettingsStore:e,currentSpaceStore:n}=S().default.state;return{currentUserSettingsStore:e,currentSpaceStore:n}}),[]),x=(0,o().Kw)(P().subscriptionDataStoreInstance);(0,r.useEffect)((()=>{!async function(){if(!D)return;if(!x)return;if(!(0,I().GJ)(x))return;if("unsubscribed_admin"!==x.type&&"subscribed_admin"!==x.type)return;const n=y().Z.getData(e,{spaceId:D.id}),r=(0,u().KX)(null==n?void 0:n.subscription);if("stripe"!==(null==n?void 0:n.provider)||!r)return;const a=I().XX(x);if((0,c().de)(null==a?void 0:a.addOns))return;const o=await C().ZF(e,{spaceId:D.getSpaceId(),offerCampaign:"ai_fifty_percent_upgrade"}),i=(0,p().iQ)(o);i&&(0,d().pp)(i)&&t(i)}()}),[e,D,x]);const U=(0,r.useCallback)((()=>{k&&(_().createAndCommit({userAction:"AddOnDiscountPopup.markSeen",environment:e,canUndo:!0,perform:e=>{m().d2({userSettingsStore:k,transaction:e,data:{seen_ai_discount_popup:!0}})}}),l().j(e,{name:"add_on_discount_popup_dismissed"}))}),[k,e]),F=(0,r.useCallback)((()=>{n&&(b().k2("ai"),b().Cl(n))}),[n]),j=(0,o().VK)((()=>!(!(0,d().pp)(n)||!(0,A().px)(e,(0,h().zt)()))),[n,e]),M=(0,i().yK)((e=>({icon:{width:20,height:20,fill:e.accentColors.purple[400]}})),[]);return j?(0,O.jsx)(g().u,{calloutId:"add_on_discount_popup",initialPromo:{icon:v().t,iconStyle:M.icon,header:(0,O.jsx)(f()._H,{id:"AddOnDiscountPopup.header",defaultMessage:"Add unlimited AI for {percentage} off?",values:{percentage:(0,d().pp)(n)?(0,w().ov)(n):void 0}}),description:(0,O.jsx)(f()._H,{id:"AddOnDiscountPopup.description",defaultMessage:"Project management is better with Notion AI. Add it on top of your paid plan with half off."})},steps:[],seenFeatureUserSetting:"seen_ai_discount_popup",userSettingsStore:k,allowExternalMouseEvents:!0,onDismiss:U,onTryFeatureClick:F,isUserEligible:j,onPopupSeen:()=>l().j(e,{name:"add_on_discount_popup_seen"}),onLearnMore:()=>{n&&F(),U()},ctaMessage:(0,O.jsx)(f()._H,{id:"AddOnDiscountPopup.purchase.button",defaultMessage:"Claim your deal"})}):null}}}]);