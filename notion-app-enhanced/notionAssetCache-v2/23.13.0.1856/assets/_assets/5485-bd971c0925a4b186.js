"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[5485],{158548:(e,t,n)=>{n.d(t,{w:()=>ue});n(670560);var r=()=>n(730120),i=n(667294),a=()=>n(219727),o=()=>n(846550),s=()=>n(157955),u=()=>n(578292),d=()=>n(788860),c=()=>n(513670),l=()=>n(696459),y=()=>n(707513),m=()=>n(212493),h=()=>n(827973),f=()=>n(448419),g=()=>n(431652),p=()=>n(198829),k=()=>n(18748),x=()=>n(255577),b=()=>n(661297),w=()=>n(388284),j=()=>n(296034),M=()=>n(718959),v=()=>n(615634),R=()=>n(918745),S=()=>n(142735),_=n(785893);function Z(e){const{onChange:t,currentValue:r,extraValidation:a,...o}=e,[s,u]=(0,i.useState)(!1),[d,c]=(0,i.useState)((null==r?void 0:r.toString())??""),y=e=>!(0,l().$K)(a)||a(e);return(0,_.jsx)(n(291198).Z,{errorOutline:s,onKeyDown:e=>{if(("ArrowUp"===e.key||"ArrowDown"===e.key)&&(e.preventDefault(),e.stopPropagation(),(0,l().$K)(r))){const n="ArrowUp"===e.key?1:-1,i=r+n;y(i)&&(t(i),c(i.toString()))}},value:d,onChange:e=>{const n=e.currentTarget.value;if(c(n),""===n)t(void 0),u(!1);else{const n=Number(e.currentTarget.value);y(n)?(t(n),u(!1)):(t(void 0),u(!0))}},...o})}const C=(0,d().vU)({never:{id:"automations.RecurrenceEditor.endConditionMenu.never",defaultMessage:"Never"},numberOfRuns:{id:"automations.RecurrenceEditor.endConditionMenu.numberOfRuns",defaultMessage:"Number of runs"},specificDate:{id:"automations.RecurrenceEditor.endConditionMenu.specificDate",defaultMessage:"Specific date"}});function T(e){const{currentValue:t,onChange:n}=e,r=(0,R().F)({minWidth:230}),a="number"===(null==t?void 0:t.type)?t.number_of_occurrences:void 0,[o,s]=(0,i.useState)(a??1),u=[{key:"never",items:[{key:"never",action:()=>{n(void 0)},render:e=>(0,_.jsx)(h().Z,{...e,title:(0,_.jsx)(d()._H,{...C.never}),checkState:void 0===t})}],render:e=>(0,_.jsx)(w().Z,{...e})},{key:"number_of_occurrences",items:[{key:"number_of_occurrences",action:()=>{n({type:"number",number_of_occurrences:o})},render:e=>(0,_.jsx)(F,{...e,currentNumber:a??o,onNumberChange:e=>{(0,l().$K)(e)&&(s(e),n({type:"number",number_of_occurrences:e}))},selected:"number"===(null==t?void 0:t.type)})}],render:e=>(0,_.jsx)(w().Z,{topBorder:!0,...e})},{key:"date",items:[{key:"date",action:()=>{},render:t=>(0,_.jsx)(B,{...t,...e})}],render:e=>(0,_.jsx)(w().Z,{topBorder:!0,...e})}];return(0,_.jsx)(p().Z,{...r,children:(0,_.jsx)(x().Z,{type:x().i.Vertical,sections:u,initialFocus:0})})}const F=(0,i.forwardRef)((function(e,t){const{currentNumber:n,onNumberChange:r,selected:i,...a}=e,u=(0,o().yK)((e=>({input:{maxWidth:60},menuItemTitle:{overflow:"visible"}})),[]);return(0,_.jsx)(h().Z,{...a,itemMarginRight:4,ref:t,titleStyle:u.menuItemTitle,title:(0,_.jsxs)(m().jX,{gap:"auto",direction:"row",align:"center",children:[(0,_.jsx)("div",{children:(0,_.jsx)(d()._H,{...C.numberOfRuns})}),i&&(0,_.jsx)(Z,{disabled:!i,currentValue:n,onChange:r,extraValidation:s().isValidRecurrenceNumberOfRuns,style:u.input,maxlength:3})]}),checkState:i})})),B=(0,i.forwardRef)((function(e,t){const{currentValue:n,onChange:a,...u}=e,c=(0,i.useMemo)((()=>r().ou.now().plus({weeks:1}).toMillis()),[]),l=(0,d().YB)(),y=(0,S().VK)((()=>M().AK.state),[]),m="date"===(null==n?void 0:n.type),h=m?n.end_at:c,[f,p]=(0,i.useState)(m);(0,i.useEffect)((()=>{!m&&f&&p(!1)}),[m,f]);const k=(0,i.useMemo)((()=>"date"===(null==n?void 0:n.type)?(0,s().getFormattedEndCondition)(n,l):void 0),[n,l]),x=(0,i.useCallback)((e=>{a({type:"date",end_at:e})}),[a]),b=(0,i.useMemo)((()=>({before:new Date})),[]),w=(0,i.useCallback)((()=>{a({type:"date",end_at:c})}),[a,c]),v=(0,o().yK)((()=>({minWidth:{minWidth:"247px"},calendarContainer:{padding:"8px 0"}})),[]),R=f||m;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(g().X,{...u,title:(0,_.jsx)(d()._H,{...C.specificDate}),chevronType:R?"down":"right",right:k,onClick:w,style:v.minWidth}),R&&(0,_.jsx)("div",{style:v.calendarContainer,children:(0,_.jsx)(j().Z,{firstDayOfWeek:y,value:h,onChange:x,disabledDays:b})})]})}));n(241792);const O=(0,d().vU)({day:{id:"automations.FrequencyMenu.day",defaultMessage:"{number, plural, one {Day} other {Days}}"},week:{id:"automations.FrequencyMenu.week",defaultMessage:"{number, plural, one {Week} other {Weeks}}"},month:{id:"automations.FrequencyMenu.month",defaultMessage:"{number, plural, one {Month} other {Months}}"},year:{id:"automations.FrequencyMenu.year",defaultMessage:"{number, plural, one {Year} other {Years}}"}}),E={day:e=>({...O.day,values:{number:e?2:1}}),week:e=>({...O.week,values:{number:e?2:1}}),month:e=>({...O.month,values:{number:e?2:1}}),year:e=>({...O.year,values:{number:e?2:1}})};function W(e){const{onSelect:t,currentFrequency:n,pluralLabels:r}=e,i=(0,R().F)(),a=[{key:"default",items:(0,l().qP)(E).map((e=>{let[i,a]=e;return{key:i,action:()=>{t(i)},render:e=>(0,_.jsx)(h().Z,{...e,title:(0,_.jsx)(d()._H,{...a(r)}),checkState:n===i})}})),render:e=>(0,_.jsx)(w().Z,{...e})}];return(0,_.jsx)(p().Z,{...i,children:(0,_.jsx)(x().Z,{type:x().i.Vertical,sections:a,initialFocus:0})})}var P=()=>n(839480);const N=(0,d().vU)({monthRestrictionLabel:{id:"automations.MonthRestrictionMenuItem.monthRestrictionLabel",defaultMessage:"On the"},last:{id:"automations.MonthRestrictionMenuItem.last",defaultMessage:"Last"},day:{id:"automations.MonthRestrictionMenuItem.day",defaultMessage:"Day"}}),I=31,U=4,V=(0,i.forwardRef)((function(e,t){const{initialValue:n,onChange:s,startDateForFallback:u,...c}=e,y=(0,a().Fy)(),h=(0,o().yK)((e=>({menuItem:{...!y.isMobile&&{width:"calc(100% - 8px)",marginLeft:4,marginRight:4}}})),[y]),[f,g]=(p=function(e,t){const n=()=>t?{type:"day",dayNumber:r().ou.fromMillis(t).day}:q;return e?"monthdays"===e.type?1!==e.monthdays.length?n():{type:"day",dayNumber:e.monthdays[0]}:"weekdays_in_month"===e.type?1!==e.week_numbers.length||1!==e.weekdays.length?n():{type:"weekday",weekday:e.weekdays[0],weekNumber:-1===e.week_numbers[0]?"last":e.week_numbers[0]}:void(0,l().t1)(e):n()}(n,u),(0,i.useReducer)(((e,t)=>{if("change_day"===t.type)if("day"===t.newDay){if("day"===e.type)return e;if("weekday"===e.type)return{type:"day",dayNumber:"last"===e.weekNumber?1:Math.min(e.weekNumber,U)};(0,l().t1)(e)}else{if("weekday"===e.type)return{...e,weekday:t.newDay};if("day"===e.type)return{type:"weekday",weekday:t.newDay,weekNumber:e.dayNumber>U?"last":e.dayNumber};(0,l().t1)(e)}else if("change_number"===t.type){if("day"===e.type)return{...e,dayNumber:"last"===t.newNumber?1:t.newNumber};if("weekday"===e.type)return{...e,weekNumber:t.newNumber};(0,l().t1)(e)}else(0,l().t1)(t)}),p));var p;return function(e,t){const n=(0,i.useRef)(t);(0,i.useEffect)((()=>{n.current=t}),[t]);const r=(0,i.useRef)(!0);(0,i.useEffect)((()=>{r.current?r.current=!1:n.current(function(e){if("day"===e.type)return{type:"monthdays",monthdays:[e.dayNumber]};if("weekday"===e.type)return{type:"weekdays_in_month",weekdays:[e.weekday],week_numbers:["last"===e.weekNumber?-1:e.weekNumber]};(0,l().t1)(e)}(e))}),[e])}(f,s),(0,_.jsx)(k().ZP,{...c,itemMarginRight:12,ref:t,style:h.menuItem,title:(0,_.jsxs)(m().jX,{gap:"auto",direction:"row",align:"center",children:[(0,_.jsx)("div",{children:(0,_.jsx)(d()._H,{...N.monthRestrictionLabel})}),(0,_.jsx)(D,{state:f,dispatch:g})]})})}));function D(e){const{state:t,dispatch:n}=e,r=(0,a().Fy)(),i=(0,d().YB)(),s=Y(),u=(0,o().yK)((e=>({icon:{width:10,marginLeft:4,fill:e.lightIconColor},button:{height:28}})),[]),c=A(t),l=K(t),y=r.isMobile?f().Z4.SlideUp:f().Z4.Popup;return(0,_.jsxs)(m().jX,{width:"hug",direction:"row",gap:4,children:[(0,_.jsx)(f().ZP,{popupType:y,render:e=>(0,_.jsx)(L,{state:t,onSelect:t=>{n({type:"change_number",newNumber:t}),e.close()}}),renderOrigin:e=>(0,_.jsxs)(b().Z,{...e,style:u.button,children:["last"===c?(0,_.jsx)(d()._H,{...N.last}):s(c),(0,v().i)(u.icon)]})}),(0,_.jsx)(f().ZP,{popupType:y,render:e=>(0,_.jsx)(H,{state:t,onSelect:t=>{n({type:"change_day",newDay:t}),e.close()}}),renderOrigin:e=>(0,_.jsxs)(b().Z,{...e,style:u.button,children:[z(i,l),(0,v().i)(u.icon)]})})]})}function L(e){const{state:t,onSelect:n}=e,r=(0,R().F)({maxHeight:255}),i=Y(),a=A(t),o="weekday"===t.type,s=c().oA([{key:"days",items:c().w6(1,("day"===t.type?I:"weekday"===t.type?U:(0,l().t1)(t))+1).map((e=>({key:`day_${e}`,action:()=>n(e),render:t=>(0,_.jsx)(h().Z,{...t,title:i(e),checkState:a===e})}))),render:e=>(0,_.jsx)(w().Z,{...e})},o?{key:"last",items:[{key:"last",action:()=>n("last"),render:e=>(0,_.jsx)(h().Z,{...e,title:(0,_.jsx)(d()._H,{...N.last}),checkState:"last"===a})}],render:e=>(0,_.jsx)(w().Z,{...e,topBorder:!0})}:void 0]);return(0,_.jsx)(p().Z,{...r,children:(0,_.jsx)(x().Z,{type:x().i.Vertical,sections:s,initialFocus:0})})}function H(e){const{state:t,onSelect:n}=e,r=(0,d().YB)(),i=(0,R().F)(),a=K(t),o=[{key:"day",items:[{key:"day",action:()=>n("day"),render:e=>(0,_.jsx)(h().Z,{...e,title:z(r,"day"),checkState:"day"===a})}],render:e=>(0,_.jsx)(w().Z,{...e})},{key:"weekdays",items:(0,S().VK)((()=>1===M().AK.state?["MO","TU","WE","TH","FR","SA","SU"]:["SU","MO","TU","WE","TH","FR","SA"]),[]).map((e=>({key:`weekday_${e}`,action:()=>n(e),render:t=>(0,_.jsx)(h().Z,{...t,title:z(r,e),checkState:e===a})}))),render:e=>(0,_.jsx)(w().Z,{...e,topBorder:!0})}];return(0,_.jsx)(p().Z,{...i,children:(0,_.jsx)(x().Z,{type:x().i.Vertical,sections:o,initialFocus:0})})}const q={type:"day",dayNumber:1};function A(e){return"day"===e.type?e.dayNumber:"weekday"===e.type?e.weekNumber:void(0,l().t1)(e)}function K(e){return"day"===e.type?"day":"weekday"===e.type?e.weekday:void(0,l().t1)(e)}function Y(){const e=(0,d().YB)().locale.substring(0,2);return t=>(0,P().nU)(e,t,"d")}function z(e,t){if("day"===t)return e.formatMessage(N.day);{const n=(0,l().Yd)(s().RRULE_WEEKDAYS_MAP).indexOf(t)+1;return r().ou.fromObject({weekday:n}).setLocale(e.locale).toLocaleString({weekday:"long"})}}n(267602),n(653476),n(749411);const $=(0,d().vU)({aroundMidnight:{id:"automations.RecurTimeMenu.aroundMidnight",defaultMessage:"Around midnight"},aroundMidnightCaption:{id:"automations.RecurTimeMenu.aroundMidnightCaption",defaultMessage:"12â€“3AM"}});function X(e){const{currentRecurTime:t,onRecurTimeSelected:i}=e,a=(0,d().YB)(),o=(0,R().F)(),y=[{key:"default",items:[...(0,n(466970).E)("automations_dev_tools")?[J({onRecurTimeSelected:i})]:[],...[{type:"around_midnight"},...c().w6(0,24).flatMap((e=>c().w6(0,60,15).map((t=>({type:"hour_minute",hour:e,minute:t}))))).filter((e=>{let{hour:t,minute:n}=e;return 0!==t&&1!==t&&2!==t&&!(3===t&&0===n)}))].map((e=>{if("hour_minute"===e.type){const{hour:n,minute:o}=e,s=r().ou.utc().set({hour:n,minute:o,second:0,millisecond:0}).setLocale((0,u().E2)(a)).toFormat("h:mm a"),d=(null==t?void 0:t.minute)===o&&(null==t?void 0:t.hour)===n;return{key:`hour_minute-${n}-${o}`,action:()=>{i({hour:n,minute:o})},render:e=>(0,_.jsx)(h().Z,{...e,title:s,checkState:d})}}if("around_midnight"===e.type){const e=(0,s().isRunningBetweenMidnightAnd3AM)(t);return{key:"around_midnight",action:()=>{i({hour:0,minute:0})},render:t=>(0,_.jsx)(h().Z,{...t,title:(0,_.jsx)(d()._H,{...$.aroundMidnight}),caption:(0,_.jsx)(d()._H,{...$.aroundMidnightCaption}),checkState:e})}}(0,l().t1)(e)}))],render:e=>(0,_.jsx)(w().Z,{...e,desktopStyle:{maxHeight:250,overflow:"scroll"}})}];return(0,_.jsx)(p().Z,{...o,children:(0,_.jsx)(x().Z,{type:x().i.Vertical,sections:y,initialFocus:0})})}function J(e){const{onRecurTimeSelected:t}=e;return{key:"developer",action:()=>{const e=G();t({hour:e.hour,minute:e.minute})},render:e=>(0,_.jsx)(Q,{...e})}}function G(){const e=r().ou.local();let t=e.set({second:0,millisecond:0}).plus({minute:1});return t.diff(e,"seconds").seconds<20&&(t=t.plus({minute:1})),t}const Q=(0,i.forwardRef)((function(e,t){const[a,o]=(0,i.useState)((()=>G()));return(0,n(863606).W)((()=>{o(G())}),1e3,!0),(0,_.jsx)(h().Z,{...e,ref:t,title:`[Dev] Run at ${a.toLocaleString(r().ou.TIME_SIMPLE)}`})}));var ee=()=>n(25303),te=()=>n(568017),ne=()=>n(154186);const re=(0,d().vU)({sunday:{id:"automations.WeekdaySelector.weekdayAbbreviations.sunday",defaultMessage:"Su"},monday:{id:"automations.WeekdaySelector.weekdayAbbreviations.monday",defaultMessage:"Mo"},tuesday:{id:"automations.WeekdaySelector.weekdayAbbreviations.tuesday",defaultMessage:"Tu"},wednesday:{id:"automations.WeekdaySelector.weekdayAbbreviations.wednesday",defaultMessage:"We"},thursday:{id:"automations.WeekdaySelector.weekdayAbbreviations.thursday",defaultMessage:"Th"},friday:{id:"automations.WeekdaySelector.weekdayAbbreviations.friday",defaultMessage:"Fr"},saturday:{id:"automations.WeekdaySelector.weekdayAbbreviations.saturday",defaultMessage:"Sa"}}),ie={SU:re.sunday,MO:re.monday,TU:re.tuesday,WE:re.wednesday,TH:re.thursday,FR:re.friday,SA:re.saturday};function ae(e){const{weekdays:t,onChange:r,style:i,disabled:a}=e,o=(0,d().YB)();return(0,_.jsx)(m().jX,{direction:"row",gap:"auto",width:"fill",style:i,children:n(567149).Z.map((e=>(0,_.jsx)(oe,{isSelected:t.includes(e),onClick:()=>{const n=t.includes(e)?t.length>1?t.filter((t=>t!==e)):t:[...t,e];r(n)},disabled:a,children:o.formatMessage(ie[e])},e)))})}function oe(e){const{isSelected:t,children:n,onClick:r,disabled:i}=e,{isMobile:s}=(0,a().Fy)(),u=(0,o().yK)((e=>({button:{...s?{width:44,height:44,fontSize:32}:{width:28,height:28},color:t?te().ZP.white:e.darkTextColor,display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:100,flexShrink:0,fontSize:s?y().JB.UISmall.mobile:y().JB.UISmall.desktop,background:t?te().ZP.blue:e.accentColors.gray[75]},pressed:{background:t?e.blueButtonPressedBackground:e.accentColors.gray[200]},hovered:{background:t?e.blueButtonHoveredBackground:e.accentColors.gray[100]}})),[s,t]);return(0,_.jsx)(ne().Z,{disabled:i,onClick:r,style:u.button,hoveredStyle:u.hovered,pressedStyle:u.pressed,children:n})}const se=(0,d().vU)({frequencyLabel:{id:"automations.RecurrenceEditor.frequencyLabel",defaultMessage:"Every"},recurTimeLabel:{id:"automations.RecurrenceEditor.recurTimeLabel",defaultMessage:"At"},startTimeLabel:{id:"automations.RecurrenceEditor.startTimeLabel",defaultMessage:"Starting"},endConditionLabel:{id:"automations.RecurrenceEditor.endConditionLabel",defaultMessage:"Ending"},deleteRecurrenceLabel:{id:"automations.RecurrenceEditor.deleteRecurrenceLabel",defaultMessage:"Stop repeating"},timezone:{id:"automations.RecurrenceEditor.timezone",defaultMessage:"Timezone"}});function ue(e){const{onDelete:t,disabled:n,allowExpiredRecurrence:r}=e,i=(0,d().YB)(),u=(0,R().F)({minWidth:260}),l=[],{isMobile:m}=(0,a().Fy)(),h=(0,o().yK)((e=>({disabledMessage:{color:e.lightTextColor,fontSize:m?y().JB.UISmall.mobile:y().JB.UISmall.desktop}})),[m]);n&&l.push({key:"disabled_message",items:[{key:"disabled_message",action:()=>{},render:e=>(0,_.jsx)(k().ZP,{...e,title:(0,_.jsx)("div",{style:h.disabledMessage,children:(0,_.jsx)(d()._H,{id:"automations.RecurrenceEditor.noPermissionMessage",defaultMessage:"You do not have permission to edit this automation"})})})}],render:e=>(0,_.jsx)(w().Z,{...e})}),l.push({key:"main",items:(0,c().oA)([{key:"frequency",action:()=>{},render:t=>(0,_.jsx)(de,{...t,...e})},fe(e),xe(e),{key:"recur_time",action:()=>{},render:t=>(0,_.jsx)(ce,{...t,...e})}]),render:e=>(0,_.jsx)(w().Z,{...e,topBorder:n})}),l.push({key:"times",items:[{key:"start_time",action:()=>{},render:t=>(0,_.jsx)(le,{...t,...e})},{key:"end_condition",action:()=>{},render:t=>(0,_.jsx)(pe,{...t,...e})},{key:"timezone",action:()=>{},render:t=>(0,_.jsx)(ke,{...t,...e})}],render:e=>(0,_.jsx)(w().Z,{...e,topBorder:!0})}),t&&!n&&l.push({key:"delete",items:[{key:"delete",action:()=>{},render:n=>(0,_.jsx)(ye,{...n,...e,onClick:t})}],render:e=>(0,_.jsx)(w().Z,{...e,topBorder:!0})});const f=function(e){const{recurrence:t,intl:n,allowExpiredRecurrence:r}=e;if(!(0,ee().h)(t))return{key:"next_recurrence",items:[{key:"invalid_recurrence_config",action:()=>{},render:e=>(0,_.jsx)(me,{...e,children:(0,_.jsx)(d()._H,{id:"automations.RecurrenceEditor.invalidRecurrenceConfig",defaultMessage:"Missing required fields"})})}],render:e=>(0,_.jsx)(w().Z,{...e,topBorder:!0})};const i=(0,s().getFormattedNextRecurrenceTime)({recurrence:t,intl:n});if(!i)return r?{key:"expired_recurrence",items:[{key:"expired_recurrence",action:()=>{},render:e=>(0,_.jsx)(me,{mode:"info",...e,children:(0,_.jsx)(d()._H,{id:"automations.RecurrenceEditor.automationComplete",defaultMessage:"This is complete and will not run again"})})}],render:e=>(0,_.jsx)(w().Z,{...e,topBorder:!0})}:{key:"next_recurrence",items:[{key:"next_recurrence",action:()=>{},render:e=>(0,_.jsx)(me,{...e,children:(0,_.jsx)(d()._H,{id:"automations.RecurrenceEditor.automationWillNeverRun",defaultMessage:"This automation will never run"})})}],render:e=>(0,_.jsx)(w().Z,{...e,topBorder:!0})};return{key:"next_recurrence",items:[{key:"next_recurrence",action:()=>{},render:e=>(0,_.jsx)(he,{...e,nextRecurrenceTime:i})}],render:e=>(0,_.jsx)(w().Z,{...e,topBorder:!0})}}({recurrence:e.currentValue,intl:i,allowExpiredRecurrence:r});return f&&l.push(f),(0,_.jsx)(p().Z,{...u,children:(0,_.jsx)(x().Z,{disallowBackspace:!0,type:x().i.Vertical,sections:l,initialFocus:0})})}const de=(0,i.forwardRef)((function(e,t){const{currentValue:n,onChange:r,disabled:u,...c}=e,y=(0,a().Fy)(),h=(0,o().yK)((e=>({input:{maxWidth:60,margin:2,opacity:u?.5:1},icon:{width:10,marginLeft:4,fill:e.lightIconColor},button:{justifyContent:"flex-end",height:28,marginRight:12,opacity:u?.5:1},menuItem:{...!y.isMobile&&{width:"calc(100% - 8px)",marginLeft:4,marginRight:4}},menuItemRight:{marginRight:0}})),[y.isMobile,u]),g=(0,l().$K)(n.interval)&&1!==n.interval,p=(0,i.useCallback)((e=>{n.frequency!==e&&r({...n,frequency:e,..."week"===e&&0===(n.weekdays??[]).length?{weekdays:["MO"]}:{},..."month"===e?{monthly_restriction:{type:"monthdays",monthdays:[1]}}:{}})}),[n,r]);return(0,_.jsx)(k().ZP,{...c,ref:t,title:(0,_.jsx)(d()._H,{...se.frequencyLabel}),style:h.menuItem,rightStyle:h.menuItemRight,disabled:u,right:(0,_.jsxs)(m().jX,{direction:"row",gap:4,width:"hug",align:"center",children:[(0,_.jsx)(Z,{style:h.input,currentValue:n.interval,onChange:e=>{r({...n,interval:e})},extraValidation:s().isValidRecurrenceInterval,disabled:u,maxlength:2}),(0,_.jsx)(f().ZP,{popupType:y.isMobile?f().Z4.SlideUp:f().Z4.Popup,render:e=>(0,_.jsx)(W,{currentFrequency:n.frequency,onSelect:t=>{p(t),e.close()},pluralLabels:g}),renderOrigin:e=>(0,_.jsxs)(b().Z,{...e,style:h.button,disabled:u,children:[(0,_.jsx)(d()._H,{...E[n.frequency](g)}),!u&&(0,v().i)(h.icon)]}),disabled:u})]})})})),ce=(0,i.forwardRef)((function(e,t){const{currentValue:n,onChange:i,disabled:o,...c}=e,y=(0,d().YB)(),m=(0,a().Fy)();let h;return(0,l().$K)(n.hour)&&(h=(0,s().isRunningBetweenMidnightAnd3AM)(n)?y.formatMessage($.aroundMidnight):r().ou.utc().set({hour:n.hour,minute:n.minute??0,second:0,millisecond:0}).setLocale((0,u().E2)(y)).toFormat((0,l().$K)(n.minute)&&0!==n.minute?"h:mm a":"h a")),(0,_.jsx)(f().ZP,{disabled:o,popupType:m.isMobile?f().Z4.SlideUp:f().Z4.Popup,render:e=>(0,_.jsx)(X,{onRecurTimeSelected:t=>{i({...n,hour:t.hour,minute:t.minute}),e.close()},currentRecurTime:{hour:n.hour,minute:n.minute}}),placementToOrigin:f().pO.Right,alignmentToOrigin:f().vR.Start,renderOrigin:e=>(0,_.jsx)(g().X,{...c,...e,right:h,title:(0,_.jsx)(d()._H,{...se.recurTimeLabel}),chevronType:"right",disabled:o})})})),le=(0,i.forwardRef)((function(e,t){const{currentValue:i,onChange:o,disabled:s,...u}=e,c=(0,d().YB)(),l=(0,a().Fy)(),y=(0,n(646574).p6)({date:r().ou.fromMillis(i.start_date),dateFormat:"relative",allowRelativeDates:!0,intl:c,shortenDate:!0});return(0,_.jsx)(f().ZP,{disabled:s,popupType:l.isMobile?f().Z4.SlideUp:f().Z4.Popup,render:e=>(0,_.jsx)("div",{style:{padding:"18px 14px 14px"},children:(0,_.jsx)(j().Z,{firstDayOfWeek:M().AK.state,value:Math.max(i.start_date,Date.now()),onChange:t=>{o({...i,start_date:t}),e.close()},disabledDays:{before:new Date}})}),placementToOrigin:f().pO.Right,alignmentToOrigin:f().vR.Start,renderOrigin:e=>(0,_.jsx)(g().X,{...u,...e,right:y,title:(0,_.jsx)(d()._H,{...se.startTimeLabel}),chevronType:"right",disabled:s})})})),ye=(0,i.forwardRef)((function(e,t){const{currentValue:n,...r}=e,i=(0,o().yK)((e=>({menuItem:{paddingBlock:2}})),[]);return(0,_.jsx)(h().Z,{...r,ref:t,title:(0,_.jsx)(d()._H,{...se.deleteRecurrenceLabel}),style:i.menuItem,isRedOnHover:!0})}));const me=(0,i.forwardRef)((function(e,t){const{children:n,mode:r="error",...i}=e,{isMobile:s}=(0,a().Fy)(),u=(0,o().yK)((e=>({disabledMessage:{color:"error"===r?e.errorText:e.lightTextColor,fontSize:s?y().JB.UISmall.mobile:y().JB.UISmall.desktop}})),[r,s]);return(0,_.jsx)(k().ZP,{...i,ref:t,title:(0,_.jsx)("div",{style:u.disabledMessage,children:n})})})),he=(0,i.forwardRef)((function(e,t){const{nextRecurrenceTime:n,...r}=e,{isMobile:i}=(0,a().Fy)(),s=(0,o().yK)((e=>({menuItem:{paddingBlock:2},titleWrap:{display:"flex",...i?{flexDirection:"row",flexWrap:"wrap",gap:4}:{flexDirection:"column"},color:e.lightTextColor,fontSize:i?y().JB.UISmall.mobile:y().JB.UISmall.desktop}})),[i]);return(0,_.jsx)(k().ZP,{...r,style:s.menuItem,title:(0,_.jsxs)("div",{style:s.titleWrap,children:[(0,_.jsx)("div",{children:(0,_.jsx)(d()._H,{defaultMessage:"Next occurrence:",id:"automations.RecurrenceEditor.NextRecurrenceMenuItem.nextOccurrence"})}),(0,_.jsx)("div",{children:n})]})})}));function fe(e){const{currentValue:t}=e;if("week"===t.frequency)return{key:"weekday_selector",action:()=>{},render:t=>(0,_.jsx)(ge,{...t,...e})}}const ge=(0,i.forwardRef)((function(e,t){const{currentValue:n,onChange:r,disabled:i,...a}=e,s=(0,o().yK)((e=>({menuItem:{paddingBlock:6},weekdaySelector:{paddingInline:4}})),[]);return(0,_.jsx)(k().ZP,{...a,disabled:i,style:s.menuItem,title:(0,_.jsx)(ae,{weekdays:n.weekdays??[],style:s.weekdaySelector,onChange:e=>{r({...n,weekdays:e})},disabled:i})})})),pe=(0,i.forwardRef)((function(e,t){const{currentValue:n,onChange:r,disabled:o,...u}=e,c=(0,a().Fy)(),l=(0,d().YB)(),y=(0,i.useMemo)((()=>n.end_condition),[n]),m=(0,i.useCallback)((e=>{r({...n,end_condition:e})}),[n,r]),h=(0,i.useMemo)((()=>(0,s().getFormattedEndCondition)(y,l)),[y,l]);return(0,_.jsx)(f().ZP,{disabled:o,popupType:c.isMobile?f().Z4.SlideUp:f().Z4.Popup,render:e=>(0,_.jsx)(T,{currentValue:y,onChange:m}),placementToOrigin:f().pO.Right,alignmentToOrigin:f().vR.Start,renderOrigin:e=>(0,_.jsx)(g().X,{...u,...e,right:h,title:(0,_.jsx)(d()._H,{...se.endConditionLabel}),chevronType:"right",disabled:o})})})),ke=(0,i.forwardRef)((function(e,t){const{currentValue:r,onChange:a,disabled:o,...s}=e,u=(0,i.useCallback)((e=>{a({...r,timezone:e})}),[r,a]);return(0,_.jsx)(n(91253).X,{enableRecents:!0,placementToOrigin:f().pO.Right,alignmentToOrigin:f().vR.Start,onSelect:u,currentValue:r.timezone,renderOrigin:e=>(0,_.jsx)(g().X,{...s,...e,title:(0,_.jsx)(d()._H,{...se.timezone}),chevronType:"right",right:(0,n(874459).er)(r.timezone)})})}));function xe(e){const{currentValue:t,onChange:n}=e;if("month"===t.frequency)return{key:"month_restriction",action:()=>{},render:e=>(0,_.jsx)(V,{...e,initialValue:t.monthly_restriction,startDateForFallback:t.start_date,onChange:e=>{n({...t,monthly_restriction:e})}})}}},25303:(e,t,n)=>{n.d(t,{h:()=>i});var r=()=>n(696459);function i(e){return(0,r().$K)(e.interval)}},5485:(e,t,n)=>{n.d(t,{k:()=>M});var r=n(667294),i=()=>n(732811),a=()=>n(142735),o=()=>n(157955),s=()=>n(529048),u=()=>n(166312),d=()=>n(158548),c=(n(241792),()=>n(788860)),l=()=>n(696459),y=()=>n(827973),m=()=>n(198829),h=()=>n(255577),f=()=>n(388284),g=()=>n(918745),p=n(785893);const k=(0,c().vU)({day:{id:"automations.RecurrencePresetMenu.day",defaultMessage:"Day"},weekday:{id:"automations.RecurrencePresetMenu.weekday",defaultMessage:"Weekday"},week:{id:"automations.RecurrencePresetMenu.week",defaultMessage:"Week"},twoWeeks:{id:"automations.RecurrencePresetMenu.twoWeeks",defaultMessage:"2 Weeks"},month:{id:"automations.RecurrencePresetMenu.month",defaultMessage:"Month"},threeMonths:{id:"automations.RecurrencePresetMenu.threeMonths",defaultMessage:"3 Months"},sixMonths:{id:"automations.RecurrencePresetMenu.sixMonths",defaultMessage:"6 Months"},year:{id:"automations.RecurrencePresetMenu.year",defaultMessage:"Year"}}),x={day:k.day,weekday:k.weekday,week:k.week,twoWeeks:k.twoWeeks,month:k.month,threeMonths:k.threeMonths,sixMonths:k.sixMonths,year:k.year};function b(e){const{onSelect:t}=e,n=(0,g().F)(),r=[{key:"default",items:(0,l().qP)(x).map((e=>{let[n]=e;return{key:n,action:()=>{t(function(e){const t=(0,u().dF)();switch(e){case"day":return{...t,frequency:"day"};case"weekday":return{...t,frequency:"week",weekdays:["MO","TU","WE","TH","FR"]};case"week":return{...t,frequency:"week",weekdays:["MO"]};case"twoWeeks":return{...t,frequency:"week",interval:2,weekdays:["MO"]};case"month":return{...t,frequency:"month"};case"threeMonths":return{...t,frequency:"month",interval:3};case"sixMonths":return{...t,frequency:"month",interval:6};case"year":return{...t,frequency:"year"};default:(0,l().t1)(e)}}(n))},render:e=>(0,p.jsx)(y().Z,{...e,title:(0,p.jsx)(c()._H,{...x[n]})})}})),render:e=>(0,p.jsx)(f().Z,{...e})}];return(0,p.jsx)(m().Z,{...n,children:(0,p.jsx)(h().Z,{type:h().i.Vertical,sections:r,initialFocus:0})})}var w=()=>n(25303);const j=150;function M(e){const{recurrence:t,onChange:n,disabled:c,autoFocusIfNew:l,allowDelete:y,buttonPopupStore:m}=e,h=(0,a().qz)(m,s().Z);(0,i().K)((()=>{l&&!t&&setTimeout((()=>{h.setState({open:!0})}),j)}));const[f,g]=(0,r.useState)(),k=(0,r.useMemo)((()=>f||(t?{...(0,o().convertToUnpersistedRecurrenceConfig)(t),hour:t.hour??0,minute:t.minute??0}:(0,u().dF)())),[f,t]),[x,M]=(0,r.useState)(!1);(0,r.useEffect)((()=>{M((e=>e||Boolean(t)))}),[t]);const v=(0,r.useCallback)((e=>{g(e);const t=(0,w().h)(e)&&void 0!==(0,o().getNextDateUtc)((0,o().convertFromUnpersistedRecurrenceConfig)(e));n(t?e:void 0)}),[n]),R=(0,r.useCallback)((()=>{n(void 0),M(!1),h.setState({open:!1})}),[n,h]),S=(0,r.useCallback)((e=>{g(e),n(e),h.setState({open:!1}),setTimeout((()=>{M(!0),h.setState({open:!0})}),j)}),[n,h]),_=(0,r.useCallback)((()=>{g(void 0),M(Boolean(t))}),[t]);return{render:(0,r.useCallback)((()=>x||t?(0,p.jsx)(d().w,{currentValue:k,onChange:v,onDelete:y?R:void 0,disabled:c}):(0,p.jsx)(b,{onSelect:S})),[x,t,k,v,y,R,c,S]),onClose:_,buttonPopupStore:h}}}}]);