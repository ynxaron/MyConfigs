"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[45632],{558120:(e,s,t)=>{t.r(s),t.d(s,{DeletePaidWorkspaceModal:()=>b});var o=t(667294),n=()=>t(219727),r=()=>t(142735),a=()=>t(956057),i=()=>t(629719),u=()=>t(893146),c=()=>t(381348),l=()=>t(788860),d=()=>t(513670),p=()=>t(979614),f=()=>t(102182),h=()=>t(876822),v=()=>t(438665),g=()=>t(548812),y=()=>t(402421),m=()=>t(984529),w=()=>t(135658),S=()=>t(663544),_=t(785893);function b(e){let{isOpen:s,onClose:t,onConfirmDelete:d,billingData:m,spaceStore:b}=e;const k=(0,n().O7)(),x=(0,i().zt)(null==m?void 0:m.subscription),O="free",[C,I]=o.useState("survey"),[j,B]=o.useState({reasons:[],reasonOther:void 0,reasonOtherTools:void 0}),[D]=o.useState(a().Il()),[P,M]=o.useState(void 0),R=(0,r().VK)((()=>Boolean(null==b?void 0:b.canAdmin())),[b]);(0,o.useEffect)((()=>p().j(k,{name:"churn_survey",args:{churnType:x,reasons:j.reasons,reasonOther:j.reasonOther,reasonOtherTools:j.reasonOtherTools,stage:C,churnSurveyId:D}})),[k,C,j,D,x]);const H=o.useCallback((()=>{p().j(k,{name:"churn_survey_close",args:{churnSurveyId:D}}),t()}),[D,k,t]),U=o.useCallback((()=>{H(),d()}),[H,d]);return(0,_.jsx)(S().r,{step:C,isOpen:s,onClose:H,children:(()=>{switch(C){case"survey":return(0,_.jsx)(w().tt,{options:T(),description:(0,_.jsx)(l()._H,{id:"deletePaidWorkspaceFlow.surveyStep.description",defaultMessage:"Let us know why youâ€™re deleting your workspace"}),onSubmit:async e=>{var s,t;p().j(k,{name:"churn_survey_submitted",args:{newProduct:O,churnType:x,reasons:e.reasons,reasonOther:e.customTextByReason.other??void 0,reasonOtherTools:e.customTextByReason.switching??void 0,stage:C,churnSurveyId:D}}),B((s=>({...s,reasons:e.reasons,reasonOther:e.customTextByReason.other??void 0,reasonOtherTools:e.customTextByReason.switching??void 0})));const o=await v().ZF(k,{spaceId:null===(s=h().default.state.currentSpaceStore)||void 0===s?void 0:s.getSpaceId(),offerCampaign:(0,y().q)(k,null===(t=h().default.state.currentSpaceStore)||void 0===t?void 0:t.getSpaceId())}),n=(0,u().iQ)(o);if(n&&(0,c().$v)(n))return M(n),void I("offer");U()}});case"offer":return P?(0,_.jsx)(w().oR,{currentProduct:x,coupon:P,newProduct:O,secondaryButtonMessage:(0,_.jsx)(l()._H,{id:"churnSurvey.offer.continueDeletingWorkspace.title",defaultMessage:"Continue deleting workspace"}),onSubmit:async e=>{if(e){var s;p().j(k,{name:"offer_accepted",args:{coupon:P}});const e=null===(s=h().default.state.currentSpaceStore)||void 0===s?void 0:s.getSpaceId(),t=(0,i().KU)(m),o=(0,y().q)(k,e);t&&e&&(0,i().BU)({billingData:m,canUpdateBilling:R})&&(0,c().$v)(P)&&((0,g().$u)()&&o?await v().zL({environment:k,spaceId:e,offerCampaign:o,entrypoint:"deleted_space"}):await v().lB(k,{customerId:t,newPlan:x,coupon:P,offerType:"downgrade_flow"}),f().oV({label:(0,_.jsx)(l()._H,{id:"applyCoupon.success",defaultMessage:"Coupon successfully applied"})})),H()}else U()}}):void U()}})()})}function T(){return[...(0,d().TV)([m().f.consolidatingWorkspaces,m().f.missingFeatures,m().f.notUsingEnough,m().f.switching,m().f.tooExpensive,m().f.tooDifficult]),m().f.other]}},402421:(e,s,t)=>{t.d(s,{q:()=>r});var o=()=>t(629719),n=()=>t(518019);function r(e,s){if(!s)return;const t=n().Z.getData(e,{spaceId:s});if(!t)return;const r=(0,o().zt)(t.subscription),a=(0,o().Hw)(t.subscription);if(r&&a&&"year"!==a)switch(r){case"plus":return"team_three_months";case"business":return"business_three_months";case"enterprise":return"enterprise_three_months";default:return}}}}]);