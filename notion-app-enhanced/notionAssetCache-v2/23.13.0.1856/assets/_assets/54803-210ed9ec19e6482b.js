"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[54803],{849129:(e,t,n)=>{n.d(t,{M5:()=>A,Mr:()=>T,PV:()=>V,Vu:()=>H,XC:()=>U,eH:()=>M,jC:()=>N,jL:()=>Z,kL:()=>R,qg:()=>j,zK:()=>C});n(821057),n(670560),n(122556),n(582845),n(250570),n(533019),n(721473),n(788208),n(22624),n(267602),n(653476),n(30005),n(241792);var a=()=>n(446866),i=()=>n(933868),r=()=>n(396136),s=()=>n(255933),o=()=>n(513670),l=()=>n(839002),c=()=>n(696459),d=()=>n(784234),u=()=>n(303858),m=()=>n(122479),p=()=>n(88476),v=()=>n(852465),f=()=>n(91502),g=()=>n(828946),y=()=>n(876822),S=()=>n(518019),I=()=>n(807463),w=()=>n(896014),h=()=>n(965014),x=()=>n(174896),b=()=>n(930085),_=()=>n(824462);async function C(e){const{environment:t,store:n,sudoModeStore:o,permissionsInviteStore:l,onInviteStart:u,contextualInviteStore:f,inviteOrigin:g}=e,{tokenQuery:y}=l.state;if((0,a().oH)(y.trim())&&(l.state.isInviteTargetsEmpty||!(0,w().ow)(l.state))){const e={type:"newUser",value:{email:y.trim()},source:"email"};p().Nd({target:e,permissionsInviteStore:l})||l.setState({...l.state,inviteTargets:[...l.state.inviteTargets,e],isInviteTargetsEmpty:!1,tokenQuery:""})}if(!l.state.isInviteTargetsEmpty&&l.state.inviteTargets.length>0){null==u||u();const e=l.state;if((0,w().ow)(e)){if(e.table===r().iU){if(!(0,v().OY)(n))throw new Error("Table mismatch.");const{inviteTargets:a,flowId:i,emailMessage:r}=e;l.reset();const s=await d().n_({environment:t,store:n,sudoModeStore:o,inviteTargets:a,inviteRole:void 0,isOnboarding:!1,invite:{inviteFlowId:i,inviteMessage:r,inviteOrigin:g}});return{success:s.success,requestedUserCount:s.success?Object.keys(s.requestedUsers).length:0}}if(e.table===s().bx){if(!(0,v().Mm)(n))throw new Error("Table mismatch.");const{inviteTargets:a,inviteRole:i,flowId:r}=e;l.reset();return{success:(await d().n_({environment:t,store:n,sudoModeStore:o,inviteTargets:a,inviteRole:i,isOnboarding:!1,invite:{inviteFlowId:r,inviteOrigin:g}})).success,requestedUserCount:0}}(0,c().t1)(e)}else{const{inviteRole:a,flowId:r,emailMessage:s}=e;l.reset();const c=await(0,m().mU)(n,e.inviteTargets);if((0,i().iC)(a)){const e=await d().n_({environment:t,store:n,sudoModeStore:o,inviteTargets:c,inviteRole:a,isOnboarding:!1,invite:{inviteFlowId:r,inviteMessage:s,inviteOrigin:g}});return e.success&&(null==f||f.setState({...null==f?void 0:f.state,invitedEmailToUserIdMap:e.invitedUsers})),{success:e.success,requestedUserCount:e.success?Object.keys(e.requestedUsers).length:0}}if((0,v().Y)(n)&&(0,w().Db)(e)){return{success:await d().GQ({environment:t,store:n,inviteTargets:e.inviteTargets,inviteRole:a,createNewTeamFlowId:r}),requestedUserCount:0}}}}return{success:!0,requestedUserCount:0}}function T(e){e.permissionsInviteStore.setState({...e.permissionsInviteStore.state,modalOpen:!1,flowId:void 0})}function M(e){const{permissionsInviteStore:t,contextualInviteStore:n}=e;if(!n)return;const a=[];t.state.inviteTargets.forEach((e=>{if("newUser"===e.type)a.push({email:e.value.email,isGuest:!0});else if("existingUser"===e.type){const t={...e.value,email:e.value.email,isGuest:"none"===e.spaceRole||"not_in_space"===e.spaceRole};a.push(t)}})),n.setState({...n.state,invitedUsers:a})}async function j(e){const{environment:t,store:n,sudoModeStore:a,permissionsInviteStore:i,contextualInviteStore:r,onInviteClick:s,onInviteComplete:o,inviteOrigin:l,intl:c}=e,{currentSpaceStore:d}=y().default.state,m=null==d?void 0:d.id,p=m?await S().Z.awaitData(t,{spaceId:m}):void 0;if((null==r?void 0:r.state.selection)===I().uq.workspace_member&&d&&(0,f().y2)(t,p)){if(!(await x().HD({environment:t,flowId:i.state.flowId||"",trackCreateTeamComplete:!1})))return;M({permissionsInviteStore:i,contextualInviteStore:r}),await(0,u().j_)({environment:t,spaceStore:d,contextualInviteStore:r,from:l,intl:c})}else M({permissionsInviteStore:i,contextualInviteStore:r});let v={success:!1,requestedUserCount:0};try{v=await C({environment:t,store:n,sudoModeStore:a,permissionsInviteStore:i,contextualInviteStore:r,onInviteStart:()=>{null==s||s()},inviteOrigin:l})}catch(g){}finally{null==o||o(v.success,v.requestedUserCount)}}async function R(e){const{environment:t,permissionsInviteStore:n,from:a}=e;await p().Aw({environment:t,permissionsInviteStoreState:n.state,from:a})||n.reset()}function V(e){const{permissionsInviteStore:t,targetToRemove:n,defaultRoleForNonBot:a}=e;if(!t.state.isInviteTargetsEmpty)if((0,w().ow)(t.state))if((0,w().ow)(t.state)){const e=t.state.inviteTargets.filter((e=>e!==n));0===e.length?t.setState({...t.state,inviteTargets:[],inviteRole:a,isInviteTargetsEmpty:!0}):t.setState({...t.state,inviteTargets:e})}else(0,c().t1)(t.state);else{const e=t.state.inviteTargets.filter((e=>e!==n));0===e.length?t.setState({...t.state,inviteTargets:[],inviteRole:a,isInviteTargetsEmpty:!0}):t.setState({...t.state,inviteTargets:e})}}function H(e){const{environment:t,onUpgradeButtonClick:n,upgradeButtonName:a}=e;h().y(t,{from:a,upsell:{type:"product",product:"plus",limit:{type:"none"}}}),null==n||n()}async function A(e,t){const n=new Set(t),a=Array.from(n).map((async t=>{const n=await _().callApi({eventName:"findUser",environment:e,data:{email:t}});if("success"===n.type){const e=n.data;if(e.value){return{type:"existingUser",value:e.value.value}}}return{type:"newUser",value:{email:t},source:"email"}}));return await Promise.all(a)}async function N(e){const t="invitee",{environment:n,permissionsInviteStore:i,event:r}=e;if(!i.state.isInviteTargetsEmpty&&(0,w().ow)(i.state)){const e=r.target.value;i.setState({...i.state,inputFocus:t,tokenQuery:e})}else{const e=r.target.value,{extractedEmails:s,newInputValue:o}=(0,a().zI)(e),l=(await A(n,s)).filter((e=>!p().Nd({target:e,permissionsInviteStore:i}))),c=[...i.state.inviteTargets,...l];c.length>0?i.setState({...i.state,inviteTargets:c,isInviteTargetsEmpty:!1,inputFocus:t,tokenQuery:o}):i.setState({...i.state,inviteTargets:[],isInviteTargetsEmpty:!0,inputFocus:t,tokenQuery:o})}}function U(e){const{environment:t,newRole:n,permissionsInviteStore:a}=e,{state:i}=a;b().TC(t,{...p().a_(t,i),invite_updated_role:n}),!i.isInviteTargetsEmpty&&(0,w().ow)(i)||a.setState({...i,inviteRole:n})}async function Z(e){var t;const{query:n,environment:a,sectionLimit:i,intl:r,membersOnly:s,importContactType:c}=e,{currentSpaceStore:d}=y().default.state;if(!d)return{inviteUsers:[],inviteBots:[],inviteGroups:[]};const{userLimit:u,botLimit:m,groupLimit:p,importContactLimit:v}=i,f=await g().x.searchActions.load(),[S,I,w,{user:h,email:x},b]=await Promise.all([u>0?f.searchVisibleSpaceUsers({environment:a,query:n,membersOnly:s}):[],m>0?f.searchSpaceBots({environment:a,query:n}):[],p>0?f.searchSpaceGroups({query:n,intl:r}):[],f.searchEmailUser(a,n),v>0?(0,l().OI)(1500,_().callApi({eventName:"searchContacts",environment:a,data:{spaceId:d.id,limit:v,query:n,importContactType:c}})):void 0]),C=S.slice(0,u).map((e=>({type:"existingUser",value:e}))),T=I.slice(0,m).map((e=>({type:"bot",value:e}))),M=w.slice(0,p).map((e=>({type:"group",value:e})));h&&C.unshift({type:"existingUser",value:h}),x&&C.unshift({type:"newUser",value:{email:x},source:"email"});let j=[];return"success"===(null==b||null===(t=b.result)||void 0===t?void 0:t.type)&&(j=b.result.data.contacts.map((e=>({type:"newUser",value:{email:e.email,name:e.name,avatar_url:e.profile_photo},source:e.type})))),{inviteUsers:o().mN(C,(e=>e.value.email)),inviteBots:T,inviteGroups:M,importedContacts:j}}},207917:(e,t,n)=>{n.d(t,{Z:()=>s});n(667294);var a=()=>n(788860),i=()=>n(946563),r=n(785893);function s(e){return(0,r.jsx)(i().Z,{...e,children:"membership_admin"===e.role?(0,r.jsx)(a()._H,{id:"spacePermissionsSettings.user.membershipAdmin",defaultMessage:"Membership admin"}):(0,r.jsx)(a()._H,{id:"spacePermissionsSettings.user.workspaceOwner",defaultMessage:"Workspace owner"})})}},64131:(e,t,n)=>{n.d(t,{l:()=>s});n(667294);var a=()=>n(788860),i=()=>n(388284),r=n(785893);function s(e){return(0,r.jsx)(i().Z,{title:e.hideTitle?void 0:(0,r.jsx)(a()._H,{id:"inviteUserModal.searchDropdown.selectPersonTitle",defaultMessage:"Select a person"}),...e})}},490040:(e,t,n)=>{n.d(t,{Z:()=>f});n(667294);var a=()=>n(146947),i=()=>n(142735),r=()=>n(846550),s=()=>n(646574),o=()=>n(788860),l=()=>n(707513),c=()=>n(871953),d=()=>n(998901),u=()=>n(521632),m=()=>n(654133),p=()=>n(67961),v=n(785893);function f(e){let{spaceStore:t,restorationStatus:n,didAttemptRecovery:a}=e;const i=y();return(0,v.jsx)(m().Z,{placement:d().Placement.Bottom,renderTooltip:()=>(0,v.jsx)(g,{spaceStore:t,restorationStatus:n,didAttemptRecovery:a}),render:e=>(0,v.jsx)("div",{...e,children:(0,v.jsx)(u().Z,{content:(0,v.jsx)(p().Z,{style:i.recentlyReaddedText,children:(0,v.jsx)(o()._H,{id:"userCell.recentlyReadded.label",defaultMessage:"Recently re-added"})}),style:i.recentlyReaddedBadge})})})}function g(e){let{spaceStore:t,restorationStatus:n,didAttemptRecovery:r}=e;const l=y(),{displayName:d,displayTime:u}=function(e){let{spaceStore:t,restorationStatus:n}=e;const r="restored"===n.status?{table:n.restoredByTable,id:n.restoredById,spaceId:t.id}:void 0,l=r?(0,c().nc)({parentStore:t,pointer:r}):void 0,d=(0,o().YB)(),{displayName:u}=(0,i().VK)((()=>({displayName:null==l?void 0:l.getDisplayName(d)})),[l,d]),m="restored"===n.status?(0,s().Yx)(n.restoredTime,"medium_with_time",a().locale):void 0;return{displayName:u,displayTime:m}}({spaceStore:t,restorationStatus:n});return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{style:l.tooltipFirstLine,children:(0,v.jsx)(o()._H,{id:"userCell.recentlyReaddedTooltip.label",defaultMessage:"Member was removed and re-added within the last 30 days"})}),r&&(0,v.jsx)("div",{style:l.tooltipSecondLine,children:(0,v.jsx)(o()._H,{id:"userCell.recentlyReaddedTooltip.inProgress.description",defaultMessage:"Restoration of access is in progress",values:{displayName:d,displayTime:u}})}),!r&&d&&u&&(0,v.jsx)("div",{style:l.tooltipSecondLine,children:(0,v.jsx)(o()._H,{id:"userCell.recentlyReaddedTooltip.description",defaultMessage:"{displayName} restored their access on {displayTime}",values:{displayName:d,displayTime:u}})})]})}function y(){return(0,r().yK)((e=>({recentlyReaddedBadge:{background:e.fill.blueSecondary,marginLeft:0,maxWidth:"max-content"},recentlyReaddedText:{color:e.text.bluePrimary,fontSize:l().JB.UISmall.desktop,fontStyle:"normal",fontWeight:400,lineHeight:"15px"},tooltipFirstLine:{color:e.text.contrastPrimary,fontWeight:l().Ue.semibold},tooltipSecondLine:{color:e.text.contrastSecondary}})),[])}},582060:(e,t,n)=>{n.d(t,{Z:()=>C});var a=n(667294),i=()=>n(788860),r=()=>n(707513),s=()=>n(491174),o=()=>n(998901),l=()=>n(1910),c=()=>n(654133),d=()=>n(219727),u=()=>n(142735),m=()=>n(846550),p=()=>n(824462),v=()=>n(308186),f=()=>n(102182),g=()=>n(830581),y=()=>n(921981),S=()=>n(631842),I=()=>n(212493),w=()=>n(78078),h=()=>n(661641),x=()=>n(981583),b=n(785893);function _(e){let{spaceId:t,userStore:n,onDismiss:r,onSubmit:s}=e;const o=(0,d().O7)(),l=n.id,c=(0,i().YB)(),y=(0,u().VK)((()=>n.getDisplayName(c)),[n,c]),S=(0,m().yK)((e=>({secondaryIcon:{fill:e.icon.uiBlueSecondary},primaryIcon:{fill:e.icon.uiBluePrimary},title:{color:e.text.primary,textAlign:"center",fontSize:17,fontWeight:500,lineHeight:"22px"}})),[]),_=(0,a.useCallback)((async()=>{const e=await p().callApi({eventName:"recoverUserContentInSpace",environment:o,data:{spaceId:t,userId:l}});if("failed"===e.type)throw v().x2(e),e;s(),r(),f().oV({label:(0,b.jsx)(i()._H,{id:"restoreAccessModal.snackbarMessage",defaultMessage:"Initiated restoration of access for{nbsp}{displayName}",values:{displayName:(0,b.jsx)("b",{children:y}),nbsp:(0,b.jsx)(b.Fragment,{children:" "})}})})}),[o,t,l,y,r,s]);return(0,b.jsx)(g().sR,{header:(0,b.jsx)(g().vI,{iconAndTitle:(0,b.jsxs)(I().jX,{align:"top-center",gap:9,children:[(0,b.jsx)(x().Z,{userStore:n,size:40}),(0,b.jsx)("div",{style:S.title,children:(0,b.jsx)(i()._H,{defaultMessage:"Restore access",id:"restoreAccessModal.title"})})]}),description:(0,b.jsx)(i()._H,{id:"restoreAccessModal.subtitle",defaultMessage:"Restore additional access for members who were removed and re-added within the last 30 days"})}),footer:(0,b.jsx)(g().a6,{layout:"vertical",primaryButtons:[{buttonType:"primary",label:(0,b.jsx)(i()._H,{defaultMessage:"Restore access",id:"restoreAccessModal.restoreButton"}),onClick:_}],secondaryButtons:[{buttonType:"secondary",label:(0,b.jsx)(i()._H,{defaultMessage:"Cancel",id:"restoreAccessModal.cancelButton"}),onClick:r}]}),children:(0,b.jsxs)(w().sg,{gap:24,children:[(0,b.jsx)(h().q,{styleName:"Body-14px/Regular",colorName:"primary",customStyles:{textAlign:"center"},children:(0,b.jsx)(i()._H,{id:"restoreAccessModal.contextDescription",defaultMessage:"<b>{displayName}</b> already has access to their private pages",values:{b:e=>(0,b.jsx)("b",{children:e}),displayName:y}})}),(0,b.jsx)(h().q,{styleName:"Body-14px/Regular",colorName:"primary",customStyles:{textAlign:"center"},children:(0,b.jsx)(i()._H,{id:"restoreAccessModal.actionDescription",defaultMessage:"Would you like to restore <b>{displayName}</b>'s access to their shared pages, groups, and teamspaces?",values:{b:e=>(0,b.jsx)("b",{children:e}),displayName:y}})})]})})}function C(e){let{spaceId:t,userStore:n,onSubmit:a}=e;const r=(0,i().YB)();return(0,b.jsx)(c().Z,{placement:o().Placement.Right,renderTooltip:()=>(0,b.jsx)(T,{}),render:e=>(0,b.jsx)(l().Z,{icon:s().s,ariaLabel:r.formatMessage({id:"restoreAccessButton.aria",defaultMessage:"Restore access"}),onClick:()=>async function(e,t,n){return await S().o.showAsyncModal((a=>(0,b.jsx)(y().c,{isOpen:a.isOpen,onDismiss:a.onDismiss,onClosed:a.onClosed,areaConstraint:{width:{type:"fixed",length:380}},render:()=>(0,b.jsx)(_,{spaceId:e,userStore:t,onDismiss:a.onDismiss,onSubmit:n})})))}(t,n,a),...e})})}function T(){return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{style:{fontWeight:r().Ue.semibold},children:(0,b.jsx)(i()._H,{id:"userCell.restoreAccessTooltip.label",defaultMessage:"Restore access to teamspaces, groups, and shared pages"})}),(0,b.jsx)("div",{children:(0,b.jsx)(i()._H,{id:"userCell.restoreAccessTooltip.description",defaultMessage:"Only available if a member was removed and re-added in the last 30 days"})})]})}},303858:(e,t,n)=>{n.d(t,{Oh:()=>b,fC:()=>I,fr:()=>y,j_:()=>S,uJ:()=>x});n(670560),n(267602),n(749411),n(241792);var a=()=>n(799891),i=()=>n(578292),r=()=>n(933868),s=()=>n(629719),o=()=>n(824462),l=()=>n(784234),c=()=>n(102182),d=()=>n(527278),u=()=>n(876822),m=()=>n(518019),p=()=>n(807463),v=()=>n(815277),f=()=>n(286338),g=()=>n(532146);async function y(e){const{environment:t,spaceStore:n,contextualInviteStore:a}=e;!function(e){const{spaceStore:t,contextualInviteStore:n}=e,a=t.getRole();if(!a||!(0,r().RN)(a))return!1;if(!n.hasGuests())return!1;if(t.getDisableMembershipRequests())return!1;return(0,f().p1)()}({environment:t,spaceStore:n,contextualInviteStore:a})?await async function(e){const{spaceStore:t,contextualInviteStore:n,environment:a}=e,i=t.getRole();if(!i||!(0,r().dy)(i))return!1;if(!n.hasGuests())return!1;return await(0,v().KQ)(a,{name:"members",spaceId:t.id,userId:t.userId,amount:1})}({environment:t,spaceStore:n,contextualInviteStore:a})?a.startWorkspaceInvite():a.setState({...a.state,inviteStage:p().TG.closed}):a.startRequestMembership()}async function S(e){const{environment:t,spaceStore:n,contextualInviteStore:i,from:r,intl:s}=e,{selection:o,flowId:d}=i.state;if("page_guest"===o||!i.hasGuests())return i.reset(),!1;const{inviteTargets:u,unknownEmails:m}=await w({environment:t,contextualInviteStore:i}),p={...i.state};i.reset();const f=await(0,v().KQ)(t,{name:"non_admin_members",spaceId:n.id,userId:n.userId})?e.inviteRole??"read_and_write":"editor";try{await l().n_({environment:t,store:n,inviteTargets:u,inviteRole:f,isOnboarding:!1,invite:{inviteOrigin:r,inviteFlowId:d,disable_invite_email:!0}})}catch(g){return function(e,t){if(0===t.length)return;c().oV({label:e.formatMessage({id:"contextual_invite.contextual_invite_failure",defaultMessage:"{userCount, plural, one {Failed to invite {users} as member} other {Failed to invite {users} as members}}"},{users:x(t,e),userCount:t.length})})}(s,p.invitedUsers),a().log({level:"error",from:"contextualInviteHelpers",type:"inviteMembers.inviteTargets",data:{miscDataToConvertToString:{...p,inviteTargets:u}}}),!1}finally{m.length&&a().log({level:"error",from:"contextualInviteHelpers",type:"inviteMembers.unknownUserId",data:{miscDataToConvertToString:{...p,unknownEmails:m}}})}return!0}async function I(e){const{environment:t,spaceStore:n,originId:i,originType:r,reasonMessage:s,contextualInviteStore:l,intl:d}=e,{selection:u}=l.state;if("page_guest"===u||!l.hasGuests())return l.reset(),!1;const{inviteTargets:m,unknownEmails:p}=await w({environment:t,contextualInviteStore:l}),v={...l.state};l.reset();const f=[];try{const e=m.map((e=>o().callApi({eventName:"requestAccess",environment:t,data:{type:"actor-to-space",forActorId:e.value.id,spaceId:n.id,message:s,attributes:{origin_id:i,origin_type:r,origin_table:"share_menu"===r?"block":"space",add_permissions_on_approval:!1}}}).catch((()=>f.push(e)))));await Promise.all(e)}catch(g){return function(e,t){if(0===t.length)return;c().oV({label:e.formatMessage({id:"contextual_invite.request_members_failure",defaultMessage:"Failed to request {users} to become members"},{users:x(t,e)})})}(d,v.invitedUsers),a().log({level:"error",from:"contextualInviteHelpers",type:"requestMembers.inviteTargets",data:{miscDataToConvertToString:{...v,inviteTargetsWithErrors:f}}}),!1}finally{p.length&&a().log({level:"error",from:"contextualInviteHelpers",type:"requestMembers.unknownUserId",data:{miscDataToConvertToString:{...v,unknownEmails:p}}})}return!0}async function w(e){const{environment:t,contextualInviteStore:n}=e,{invitedEmailToUserIdMap:a}=n.state,i=[],r=[];for(const s of n.state.invitedUsers){if(!s.isGuest)continue;const e=await h(t,s,a);e?i.push({type:"existingUser",value:{id:e,email:s.email,version:1}}):r.push(s.email)}return{inviteTargets:i,unknownEmails:r}}async function h(e,t,n){const a=await async function(e,t,n){let a=t.id;if(a||(a=n[t.email]),!a){const n=await o().callApi({eventName:"findUser",environment:e,data:{email:t.email}});if("failed"!==n.type){const e=n.data;e.value&&(a=e.value.value.id)}}return a}(e,t,n);if(a)return a;const r=(0,i().E2)(d().Z.getIntl()),s=await o().callApi({eventName:"createEmailUser",environment:e,data:{email:t.email,preferredLocaleOrigin:"inferred_from_inviter",preferredLocale:r}});return"failed"!==s.type?s.data.userId:void 0}function x(e,t){return(0,g().W)(e.flatMap((e=>e.email||[])))}function b(e,t){var n,a;const{state:i}=t,r=null===(n=u().default.state.currentSpaceStore)||void 0===n?void 0:n.id,o=r?(0,s().zt)(null===(a=m().Z.getData(e,{spaceId:r}))||void 0===a?void 0:a.subscription):void 0,l=t.getGuestEmails();return{invite_flow_id:i.flowId,user_count:l.length,user_emails:l,invite_space_role_selection:i.selection,is_bot:!1,subscription_tier:o}}},669086:(e,t,n)=>{n.d(t,{y:()=>s});var a=()=>n(142735),i=()=>n(255393),r=()=>n(897257);function s(){return(0,a().VK)((()=>{var e;const t=(null===(e=r().subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return(0,i().de)(t)}),[])}},519563:(e,t,n)=>{n.d(t,{S:()=>r});var a=()=>n(142735),i=()=>n(876822);function r(){return(0,a().VK)((()=>{const{currentSpaceStore:e}=i().default.state;return(null==e?void 0:e.getMemberCountFromPublicSpaceData())||null}),[])}},104937:(e,t,n)=>{n.d(t,{R:()=>i});n(667294);var a=n(785893);const i=(0,n(827282).IU)("openTeam",{viewBox:"0 0 28 28",svg:(0,a.jsx)("path",{d:"M3.24121 21.4326C3.24121 22.4082 3.80371 23.0322 4.7002 23.0322H22.4629C23.3506 23.0322 23.9131 22.4082 23.9131 21.4326V10.2178C23.9131 9.24219 23.3506 8.61816 22.4629 8.61816H17.2334V5.89355C17.2334 4.91797 16.6709 4.29395 15.7832 4.29395H4.7002C3.80371 4.29395 3.24121 4.91797 3.24121 5.89355V21.4326ZM4.65625 21.1074V6.21875C4.65625 5.86719 4.81445 5.70898 5.16602 5.70898H15.3174C15.6602 5.70898 15.8184 5.86719 15.8184 6.21875V21.1074C15.8184 21.4502 15.6602 21.6172 15.3174 21.6172H13.2959V19.0244C13.2959 18.2686 12.9619 17.917 12.2412 17.917H8.2334C7.5127 17.917 7.17871 18.2686 7.17871 19.0244V21.6172H5.16602C4.81445 21.6172 4.65625 21.4502 4.65625 21.1074ZM7.31934 9.5498H9.0332C9.24414 9.5498 9.39355 9.40918 9.39355 9.18945V7.52832C9.39355 7.31738 9.24414 7.16797 9.0332 7.16797H7.31934C7.1084 7.16797 6.97656 7.31738 6.97656 7.52832V9.18945C6.97656 9.40918 7.1084 9.5498 7.31934 9.5498ZM11.4414 9.5498H13.1465C13.3574 9.5498 13.5068 9.40918 13.5068 9.18945V7.52832C13.5068 7.31738 13.3574 7.16797 13.1465 7.16797H11.4414C11.2217 7.16797 11.0898 7.31738 11.0898 7.52832V9.18945C11.0898 9.40918 11.2217 9.5498 11.4414 9.5498ZM17.2334 21.4326V10.0332H21.9971C22.3398 10.0332 22.498 10.2002 22.498 10.543V21.1074C22.498 21.4502 22.3398 21.6172 21.9971 21.6172H17.2246C17.2334 21.5557 17.2334 21.4941 17.2334 21.4326ZM7.31934 13.0303H9.0332C9.24414 13.0303 9.39355 12.8896 9.39355 12.6699V11.0088C9.39355 10.7979 9.24414 10.6484 9.0332 10.6484H7.31934C7.1084 10.6484 6.97656 10.7979 6.97656 11.0088V12.6699C6.97656 12.8896 7.1084 13.0303 7.31934 13.0303ZM11.4414 13.0303H13.1465C13.3574 13.0303 13.5068 12.8896 13.5068 12.6699V11.0088C13.5068 10.7979 13.3574 10.6484 13.1465 10.6484H11.4414C11.2217 10.6484 11.0898 10.7979 11.0898 11.0088V12.6699C11.0898 12.8896 11.2217 13.0303 11.4414 13.0303ZM19.1582 13.4521H20.5732C20.749 13.4521 20.8721 13.3291 20.8721 13.1533V11.7822C20.8721 11.6064 20.749 11.4834 20.5732 11.4834H19.1582C18.9736 11.4834 18.8682 11.6064 18.8682 11.7822V13.1533C18.8682 13.3291 18.9736 13.4521 19.1582 13.4521ZM7.31934 16.5107H9.0332C9.24414 16.5107 9.39355 16.3613 9.39355 16.1504V14.4893C9.39355 14.2695 9.24414 14.1289 9.0332 14.1289H7.31934C7.1084 14.1289 6.97656 14.2695 6.97656 14.4893V16.1504C6.97656 16.3613 7.1084 16.5107 7.31934 16.5107ZM11.4414 16.5107H13.1465C13.3574 16.5107 13.5068 16.3613 13.5068 16.1504V14.4893C13.5068 14.2695 13.3574 14.1289 13.1465 14.1289H11.4414C11.2217 14.1289 11.0898 14.2695 11.0898 14.4893V16.1504C11.0898 16.3613 11.2217 16.5107 11.4414 16.5107ZM19.1582 16.8096H20.5732C20.749 16.8096 20.8721 16.6865 20.8721 16.5107V15.1396C20.8721 14.9639 20.749 14.8408 20.5732 14.8408H19.1582C18.9736 14.8408 18.8682 14.9639 18.8682 15.1396V16.5107C18.8682 16.6865 18.9736 16.8096 19.1582 16.8096ZM19.1582 20.167H20.5732C20.749 20.167 20.8721 20.0439 20.8721 19.8682V18.4971C20.8721 18.3213 20.749 18.1982 20.5732 18.1982H19.1582C18.9736 18.1982 18.8682 18.3213 18.8682 18.4971V19.8682C18.8682 20.0439 18.9736 20.167 19.1582 20.167ZM8.33008 19.3496C8.33008 19.165 8.42676 19.0684 8.61133 19.0684H11.8633C12.0566 19.0684 12.1445 19.165 12.1445 19.3496V21.6172H8.33008V19.3496Z"})})},421736:(e,t,n)=>{n.d(t,{K:()=>g,Z:()=>y});var a=n(667294),i=()=>n(142735),r=()=>n(934158),s=()=>n(696056),o=()=>n(989478),l=()=>n(788860),c=()=>n(696459),d=()=>n(634760),u=()=>n(67961),m=()=>n(981583),p=()=>n(876822),v=n(785893);function f(e){const{actorStore:t,avatar:n,isLarge:a}=e,i=a?32:28;return t?t.table===s().cZ?(0,v.jsx)(d().Z,{botStore:t,size:i}):t.table===o().KJ?(0,v.jsx)(m().Z,{userStore:t,size:i}):t.table===r().y0?(0,v.jsx)(m().Z,{userStore:void 0,size:i}):void(0,c().t1)(t):n?(0,v.jsx)(m().Z,{avatar:n,size:i}):(0,v.jsx)(m().Z,{userStore:void 0,size:i})}function g(e){return"membership_admin"===e?"membership_admin":"editor"===e||"admin"===e?"admin":"none"===e||"guest"===e?"guest":"team_level_guest"===e?"team_level_guest":void("member"!==e&&"read_and_write"!==e&&"no_access"!==e&&"not_in_space"!==e&&e&&(0,c().t1)(e))}const y=function(e){const t=(0,l().YB)(),{actorStore:r,avatar:s,containerStyle:c,id:d,spaceRole:m,avatarBadge:g,caption:y,isLarge:S,restorationStatus:I,hideRolePill:w}=e,h=!w&&("admin"===m||"membership_admin"===m),x="guest"===m||"team_level_guest"===m,b=!w&&x,_=(0,i().VK)((()=>r?r.getDisplayName(t):null==s?void 0:s.name),[r,s,t]),C=(0,i().VK)((()=>{const{currentUserStore:e}=p().default.state;return!!e&&(!!r&&e.id===r.id)}),[r]),T=(0,n(846550).yK)((e=>({titleYouIndicator:{color:e.mediumTextColor}})),[]),M=(0,i().VK)((()=>Boolean(y)?y:r?r.getDetail():null==s?void 0:s.email),[y,r,s]),j=(0,i().VK)((()=>p().default.state.currentSpaceStore),[]),R=(0,i().VK)((()=>(0,n(779733).wZ)()),[]),[V,H]=(0,a.useState)(!1);return(0,v.jsxs)("div",{style:{display:"flex",alignItems:"center",maxWidth:S?"unset":300,marginLeft:S&&!R?2:0,...c},children:[(0,v.jsxs)("div",{style:{position:"relative",...!S&&{height:28,width:28}},children:[(0,v.jsx)(f,{actorStore:r,avatar:s,isLarge:S}),g]}),(0,v.jsxs)("div",{style:{minWidth:0,marginLeft:S?10:6,marginRight:S?10:6},children:[(0,v.jsxs)("div",{id:d,style:{display:"flex",gap:4},children:[(0,v.jsx)(u().Z,{children:C?(0,v.jsx)(l()._H,{id:"cellMemberAvatar.displayName.title",defaultMessage:"{userFullDisplayName} <youIndicatorText>(You)</youIndicatorText>",values:{userFullDisplayName:_,youIndicatorText:e=>(0,v.jsx)("span",{style:T.titleYouIndicator,children:e})}}):_}),h&&(0,v.jsx)(n(207917).Z,{role:m}),b&&(0,v.jsx)(n(909439).b,{labelType:m,shouldUseTabStyle:R}),j&&I&&(0,v.jsx)(n(490040).Z,{spaceStore:j,restorationStatus:I,didAttemptRecovery:V})]}),(0,v.jsx)(u().Z,{isSmall:!0,style:{display:"flex"},children:(0,v.jsx)(u().Z,{isSmall:!0,children:M})})]}),!x&&!V&&j&&(null==r?void 0:r.table)===o().KJ&&_&&"canBeRestored"===(null==I?void 0:I.status)&&(0,v.jsx)(n(582060).Z,{userStore:r,spaceId:j.id,onSubmit:()=>H(!0)})]})}},438665:(e,t,n)=>{n.d(t,{zL:()=>m,lB:()=>p,ZF:()=>u,DV:()=>g,an:()=>v,n9:()=>y,WV:()=>f});var a=()=>n(799891),i=()=>n(741633);const r={plans_page:["lic_25","lic_50","resurrection_offer","ai_fifty_percent_upgrade"],sidebar_upsell:["lic_25","lic_50"]};var s=()=>n(792409),o=()=>n(824462),l=()=>n(308186),c=()=>n(594546),d=()=>n(876822);async function u(e,t){var n;const{spaceId:a,offerCampaign:i}=t;if(!a||!i||null===(n=d().default.state.currentSpaceStore)||void 0===n||!n.canAdmin())return;const r=await o().callApi({eventName:"getCustomerOffer",environment:e,data:{spaceId:a,offerCampaign:i}});return"failed"!==r.type&&"offer"in r.data&&r.data.offer?r.data.offer:void 0}async function m(e){const{environment:t,spaceId:n,offerCampaign:a,entrypoint:i}=e,r=await o().callApi({eventName:"applyCustomerOffer",environment:t,data:{spaceId:n,offerCampaign:a,entrypoint:i??"unknown"}});if("failed"!==r.type)return r;l().x2(r)}async function p(e,t){const n=await o().callApi({eventName:"applyCustomerOffer",environment:e,data:{...t}});if("failed"!==n.type)return n;l().x2(n)}async function v(e){const{environment:t,spaceId:n,offerCampaign:a}=e;return void 0!==await u(t,{spaceId:n,offerCampaign:a})}async function f(e){var t;const{environment:n,hasReceived:r,offerType:l,newPlan:c,coupon:u}=e,m=null===(t=d().default.state.currentSpaceStore)||void 0===t?void 0:t.getSpaceId();if(!m)return;const p=await o().callApi({eventName:"updateCustomerOffer",environment:n,data:{spaceId:m,hasReceived:r,offerType:l,newPlan:c,coupon:u},headers:(0,i().Bb)({cellId:void 0,spaceId:m})});"failed"===p.type&&a().log({level:"error",from:"offerActions",type:"updateLegacyCustomerOfferFailed",error:(0,s().Ui)(p.error)})}async function g(e,t,n){const a=function(e){if(r.hasOwnProperty(e))return r[e]}(n);if(a)for(const i of a){const n=await u(e,{spaceId:t,offerCampaign:i});if((null==n?void 0:n.campaign)===i)return n}}function y(e){let{environment:t,spaceName:n,offerCampaign:a}=e;if(n)switch(a){case"lic_25":case"lic_50":(0,c().lu)(t,"lic_offer_eligible","lic_offer_eligible",3600,{workspace_name:n,lic_25:"lic_25"===a,lic_50:"lic_50"===a});break;case"resurrection_offer":(0,c().lu)(t,"resurrection_offer_eligible","resurrection_offer_eligible",3600,{workspace_name:n});break;default:return}}},661769:(e,t,n)=>{n.d(t,{pQ:()=>s().p,eG:()=>o().e,bA:()=>l().b,nL:()=>m,Hy:()=>y,PL:()=>p().P,tw:()=>S().t,h1:()=>I().h});var a=()=>n(219727),i=()=>n(801812),r=()=>n(824462);var s=()=>n(595976),o=()=>n(272353),l=()=>n(366637),c=()=>n(142735),d=()=>n(616433),u=()=>n(214488);function m(e){let{spaceId:t}=e;const n=(0,a().O7)(),i=(0,d().J)();return(0,c().VK)((()=>{if(!t||!i)return;const e=u().Z.getData(n,{spaceId:t});return null==e?void 0:e.billingData}),[n,t,i])}var p=()=>n(258590),v=()=>n(629719),f=()=>n(876822),g=()=>n(18281);function y(e,t){const n=(0,c().Kw)(e),a=(0,c().VK)((()=>{var e;return null===(e=f().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),o=(0,s().p)({spaceId:a}),l=(0,c().VK)((()=>g().Nf({billingData:o,spaceStore:f().default.state.currentSpaceStore})),[o]),[{value:d}]=(0,i().r5)((()=>r().callApi({eventName:"isEmailEducation",environment:t,data:{}})),[t]);if(!d)return!1;if("failed"===d.type)return!1;if(!d.data.isEligible)return!1;if(!n)return!1;if(!o)return!1;if(Boolean((0,v().a7)(o.subscription,"plan")))return!1;const u=g().hn(n).length;return l&&1===u}var S=()=>n(76999),I=()=>n(205729)},415339:(e,t,n)=>{n.d(t,{T:()=>r});var a=()=>n(142735),i=()=>n(18281);function r(e){return(0,a().VK)((()=>i().AX(e.state)),[e])}},272353:(e,t,n)=>{n.d(t,{e:()=>s});var a=()=>n(142735),i=()=>n(876822),r=()=>n(18281);function s(e){return(0,a().VK)((()=>r().Nf({billingData:e,spaceStore:i().default.state.currentSpaceStore})),[e])}},366637:(e,t,n)=>{n.d(t,{b:()=>g});var a=n(667294),i=()=>n(219727),r=()=>n(142735),s=()=>n(893146),o=()=>n(381348),l=()=>n(824462),c=()=>n(228772),d=()=>n(345918),u=()=>n(669086),m=()=>n(519563),p=()=>n(876822),v=()=>n(697623),f=()=>n(741380);function g(e){const t=(0,i().O7)(),[n,g]=(0,a.useState)(!1),y=function(e){const t=(0,f().m)("ai_fifty_percent_upgrade"),n=(0,u().y)(),a=(0,m().S)();return(0,r().VK)((()=>{const i=t&&!n&&(0,v().iJ)()&&1===a,r=(0,d().zP)(p().default.state.currentSpaceStore);return Boolean(i&&(!r||"sidebar"!==e||r>=7))}),[t,n,a,e])}(e),S=(0,c().r)(),I=(0,r().VK)((()=>null==S?void 0:S.canAdmin()),[S]),w=(0,r().VK)((()=>null==S?void 0:S.getSpaceId()),[S]);return(0,a.useEffect)((()=>{!async function(){if(y&&w&&I)try{const n=await l().callApi({eventName:"getCustomerOffer",environment:t,data:{spaceId:w,offerCampaign:"ai_fifty_percent_upgrade"}});if("failed"===n.type)return;if("offer"in n.data){var e;const t=(0,s().iQ)(null===(e=n.data)||void 0===e?void 0:e.offer);g((0,o().pp)(t))}}catch(n){return}}()}),[t,y,w,I]),n}},348964:(e,t,n)=>{n.d(t,{f:()=>s});var a=n(667294),i=()=>n(219727),r=()=>n(824462);function s(){const e=(0,i().O7)(),[t,n]=(0,a.useState)();return(0,a.useEffect)((()=>{!async function(){const t=await r().callApi({eventName:"getExternalOrgData",environment:e,data:{}});if("failed"===t.type)return;const a=t.data;n(a)}()}),[e]),t}},741380:(e,t,n)=>{n.d(t,{m:()=>l});var a=n(667294),i=()=>n(219727),r=()=>n(142735),s=()=>n(876822),o=()=>n(438665);function l(e){const t=(0,i().O7)(),[n,l]=(0,a.useState)(),c=(0,r().VK)((()=>{var e;return null===(e=s().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]);return(0,a.useEffect)((()=>{!async function(){c&&l(await(0,o().an)({environment:t,spaceId:c,offerCampaign:e}))}()}),[t,c,e]),n}},258590:(e,t,n)=>{n.d(t,{P:()=>r});var a=n(667294),i=()=>n(348964);function r(){const e=(0,i().f)(),[t,n]=(0,a.useState)();return(0,a.useEffect)((()=>{n(!(!e||!("company_employee_count"in e))&&parseInt(e.company_employee_count)>99)}),[e]),t}},76999:(e,t,n)=>{n.d(t,{t:()=>r});var a=()=>n(142735),i=()=>n(18281);function r(e){return(0,a().VK)((()=>i().YK(e.state)),[e])}},205729:(e,t,n)=>{n.d(t,{h:()=>l});var a=n(667294),i=()=>n(219727),r=()=>n(142735),s=()=>n(876822),o=()=>n(254687);function l(){const e=(0,i().O7)(),[t,n]=(0,a.useState)([]),l=(0,r().VK)((()=>{var e;return null===(e=s().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]);return(0,a.useEffect)((()=>{(async()=>{if(l){const t=await(0,o().aQ)({environment:e,spaceId:l});n(t)}})()}),[e,l]),t}},174896:(e,t,n)=>{n.d(t,{Cm:()=>C,HD:()=>j,Sq:()=>M,VG:()=>T,tW:()=>R});n(821057);var a=()=>n(817629),i=()=>n(799891),r=()=>n(998411),s=()=>n(956057),o=()=>n(306164),l=()=>n(351694),c=()=>n(98934),d=()=>n(955620),u=()=>n(465755),m=()=>n(824462),p=()=>n(241516),v=()=>n(269299),f=()=>n(527278),g=()=>n(729717),y=()=>n(91502),S=()=>n(732491),I=()=>n(620218),w=()=>n(270895),h=()=>n(876822),x=()=>n(826955),b=()=>n(853680),_=()=>n(555813);async function C(e){let{environment:t,name:n,description:a,icon:i,accessLevel:r,isDefault:s,flowId:l,createTeamHome:c,teamPermissionRole:d,spacePermissionRole:p,members:v,settings:f}=e;const{currentSpaceStore:g}=h().default.getState();if(!g)throw new Error("currentSpaceStore does not exist");const y=I().default.mark("client_create_team_latency"),S=g.id,w=await m().callApi({eventName:"createTeam",environment:t,data:{spaceId:S,name:n,description:a,icon:i,isDefault:s,accessLevel:r,teamPermissionRole:d,spacePermissionRole:p,members:v,settings:f}});if("failed"===w.type)return void(0,_().Xy)(w);const{teamId:b}=w.data,C=x().zX.createChildStore(g,{table:o().e0,id:b,spaceId:S});return await C.load(),c&&await V({environment:t,teamStore:C}),u().o_(t,{store:C,flowId:l}),I().default.measure(y,{environment:t}),C}function T(e){var t;let{environment:n,page:a}=e;const i=s().Il(),r=(null===(t=a.getParentPointer())||void 0===t?void 0:t.table)!==o().e0?"page_to_team_nested":"page_to_team";u().kr(n,{from:r,flowId:i}),b().default.setState({open:!0,pageStore:a,flowId:i})}async function M(e){var t;let{environment:n,page:a,flowId:i,intl:s}=e;const{accessLevel:l,spacePermissionRole:c,teamPermissionRole:u,members:m}=(0,y().Pr)(a),p=(a.isDefined()?a.getModel().getRenderTitle({intl:s,userTimeZone:(0,r().r)(),getRecordModel:a.getRecordModel}):void 0)??d().QaF(a.getTitleValue()),f=await C({environment:n,name:p,icon:null===(t=a.getIcon())||void 0===t?void 0:t.icon,accessLevel:l,isDefault:!1,description:"",flowId:i,createTeamHome:!1,teamPermissionRole:u,spacePermissionRole:c,members:m});if(!f)return;const{currentSpaceViewStore:g}=h().default.state;if(!g)return;const I=await(0,S().Z)();v().createAndCommit({userAction:"teamActions.movePageToCreatedTeam",environment:n,canUndo:!0,perform:e=>{I({environment:n,currentSpaceViewStore:g,transaction:e,teamStore:f,action:"move",value:{type:o().e0,id:f.id},targets:[a],location:{type:"append"}})}}),(0,_().RF)({environment:n,teamId:f.id,tab:w().a.Members,from:"create_team_from_page"}),await new Promise((e=>setTimeout((()=>(0,_().JX)({teamStore:f,environment:n})),100)))}async function j(e){let{environment:t,name:n,description:a,icon:i,flowId:r,trackCreateTeamComplete:s}=e;const{currentSpaceStore:l}=h().default.getState();if(!l)throw new Error("currentSpaceStore does not exist");const c=l.id;if(!c)return;const d=await m().callApi({eventName:"enableTeams",environment:t,data:{spaceId:c,defaultTeamName:n,defaultTeamIcon:i,defaultTeamDescription:a}});if("failed"===d.type)return void(0,_().Xy)(d);const{teamId:p}=d.data,v=x().zX.createChildStore(l,{table:o().e0,id:p,spaceId:c});return await v.load(),await V({environment:t,teamStore:v}),u().NO(t,{spaceId:c,store:v,flowId:r}),s&&p&&u().o_(t,{store:v,flowId:r}),v}async function R(e){var t;let{environment:n,teamStore:i,from:r,buttonPopupStore:o}=e;if(!n.currentUser.id)return!1;const l=s().Il(),c=i.isDefault(),d=i.getTeamAccessLevel();if(c)return!1;const m=i.getName(),p=await C({environment:n,name:(0,a().n)(m||""),description:"",icon:i.getRawIcon(),accessLevel:d,isDefault:c,createTeamHome:!0,teamPermissionRole:null===(t=i.getTeamPermission())||void 0===t?void 0:t.role,spacePermissionRole:i.getSpacePermissionRole(),members:[],settings:i.getSettings(),flowId:l});return!!p&&(u().$4(n,{store:p,from:r}),(0,_().hI)({environment:n,teamStore:p,shouldScroll:!0}),(0,_().RF)({environment:n,teamId:p.id,tab:w().a.General,from:"duplicate_team",buttonPopupStore:o}),new Promise((e=>setTimeout(e,500))).then((()=>{(0,g().Ke)(m)})),!0)}async function V(e){const{environment:t,teamStore:n}=e,a=h().default.state.currentSpaceStore,r=h().default.state.currentSpaceViewStore;if(!a||!r)return i().log({level:"error",from:"teamActions",type:"createHomepageOnTeamCreation-SpaceOrSpaceViewStoreError"}),!1;const s=(o=f().Z.getIntl(),(0,c().G)(l().ms.teamsHomepage,o));var o;return!!(await p().createTemplateInstance({environment:t,item:s,spaceStore:a,spaceViewStore:r,useMinimalTemplates:!1,type:"inTeam",teamStore:n,from:"homepage_team",isOnboarding:!1}))||(i().log({level:"error",from:"teamActions",type:"createHomepageOnTeamCreation-PageNotCreated"}),!1)}},853680:(e,t,n)=>{n.d(t,{default:()=>i});class a extends(()=>n(263184))().default{getInitialState(){return{open:!1}}}const i=new a}}]);