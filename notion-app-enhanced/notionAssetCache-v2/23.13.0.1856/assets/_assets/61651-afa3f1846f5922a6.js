"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[61651,58214],{608303:(e,t,o)=>{o.d(t,{B:()=>n,w:()=>i});var r=()=>o(686674);async function i(e){return r().Z.state.open?Promise.resolve(void 0):new Promise((t=>{!function(e){r().Z.setState({...e,open:!0})}({...e,onConfirm:e=>(n(),t(e)),onDismiss:()=>(n(),t(void 0))})}))}function n(){r().Z.reset()}},608531:(e,t,o)=>{o.d(t,{e:()=>d});o(667294);var r=()=>o(142735),i=()=>o(846550),n=()=>o(955620),s=()=>o(788860),l=()=>o(281375),a=o(785893);function d(e){let{disabled:t,formQuestionStore:o,formMode:d}=e;const c=(0,s().YB)(),u=(0,i().yK)((e=>({questionDescriptionInput:{cursor:"text",fontSize:16,color:e.text.secondary,padding:"builder"===d?"4px 10px":"4px 0px",width:"fit-content"}})),[d]),{questionDescriptionStore:p,questionDescription:m,showDescription:y}=(0,r().VK)((()=>{var e;const t=o.getDescriptionStore().getValue();return{showDescription:Boolean(null===(e=o.getConfig())||void 0===e?void 0:e.showDescription),questionDescriptionStore:o.getDescriptionStore(),questionDescription:t?(0,n().QaF)(t):void 0}}),[o]);return y&&("viewer"!==d||m)?(0,a.jsx)(l().Y,{store:p,style:u.questionDescriptionInput,disabled:t,placeholder:c.formatMessage({id:"FormQuestionDescription.placeholder",defaultMessage:"Add description"}),id:`form-description-${o.id}`}):null}},903282:(e,t,o)=>{o.d(t,{Z:()=>a});o(667294);var r=()=>o(142735),i=()=>o(846550),n=()=>o(788860),s=()=>o(491925),l=o(785893);function a(e){let{propertySchema:t,formQuestionStore:o,formMode:a}=e;const d=(0,i().yK)((e=>({select:{color:e.text.tertiary,marginTop:4,marginBottom:12,..."viewer"===a?{marginLeft:0,marginRight:0}:{marginLeft:10,marginRight:10}}})),[a]),c=(0,r().VK)((()=>(0,s().vp)(t,o)),[o,t]),u=(0,r().VK)((()=>"builder"===a?void 0===c?(0,l.jsx)(n()._H,{id:"QuestionMaxSelection.builder.unlimited",defaultMessage:"(Respondents can select as many as they like)"}):(0,l.jsx)(n()._H,{id:"QuestionMaxSelection.builder.limited",defaultMessage:"(Respondents can select up to {count})",values:{count:c}}):void 0===c?(0,l.jsx)(n()._H,{id:"QuestionMaxSelection.viewer.unlimited",defaultMessage:"(Select as many as you like)"}):(0,l.jsx)(n()._H,{id:"QuestionMaxSelection.viewer.limited",defaultMessage:"(Select up to {count})",values:{count:c}})),[a,c]);return(0,l.jsx)("div",{style:d.select,children:u})}},574596:(e,t,o)=>{o.d(t,{T:()=>m});o(667294);var r=()=>o(142735),i=()=>o(846550),n=()=>o(532850),s=()=>o(26970),l=()=>o(788860),a=()=>o(707513),d=()=>o(789568),c=()=>o(839708),u=()=>o(281375),p=o(785893);function m(e){let{disabled:t,onChange:o,formQuestionStore:m,formMode:y,hasSubmitted:g}=e;const f=(0,l().YB)(),v=(0,d().S)(),{parentBlockStore:h,questionNameStore:x,isRequired:b}=(0,r().VK)((()=>({parentBlockStore:m.getParentStore(),questionNameStore:m.getNameStore(),isRequired:m.isRequired()})),[m]),S=(0,r().VK)((()=>{var e,t;const o=v.getFormState();if(!o)return;const r=o.collectionSchema,i=null===(e=m.getConfig())||void 0===e?void 0:e.propertyId;return r&&i?null===(t=(0,n().Qm)({schema:r,property:i}))||void 0===t?void 0:t.type:void 0}),[m,v]),M=(0,r().VK)((()=>v.getQuestionError(m.id)),[v,m.id]),_=(0,i().yK)((e=>({questionTitleInput:{padding:"0px 10px",margin:"10px 0px",fontSize:24,lineHeight:"30px",borderRadius:6,fontWeight:a().Ue.bold,cursor:"text",textWrap:"wrap",width:"fit-content"},viewQuestionTitleOverrides:{display:"block",margin:0,padding:"6px 0px",whiteSpace:"pre-wrap",maxWidth:"100%",wordBreak:"break-word"},pseudoAfter:{content:"'*'",color:g&&"required"===M?e.accentColors.red[500]:e.text.tertiary,fontWeight:"normal"}})),[g,M]),C=(0,c().r)({textStore:x,spaceId:m.pointer.spaceId,parentStore:h,disabled:!1});return"builder"===y?(0,p.jsx)("div",{className:"form-question-title",children:(0,p.jsx)(u().Y,{store:x,onChange:o,disabled:t,placeholder:"builder"===y?f.formatMessage({id:"FormQuestionTitle.placeholder",defaultMessage:"Question name"}):void 0,...(0,s().iv)({..._.questionTitleInput,...b?{pseudoAfter:_.pseudoAfter}:{}})})}):"multi_select"===S?(0,p.jsx)("legend",{className:"form-question-title",...(0,s().iv)({..._.questionTitleInput,..._.viewQuestionTitleOverrides,...b?{pseudoAfter:_.pseudoAfter}:{}}),children:C}):"file"===S?(0,p.jsx)("div",{className:"form-question-title",...(0,s().iv)({..._.questionTitleInput,..._.viewQuestionTitleOverrides,...b?{pseudoAfter:_.pseudoAfter}:{}}),id:`form-question-${m.id}`,children:C}):(0,p.jsx)("h2",{id:`form-question-title-${m.id}`,className:"form-question-title",...(0,s().iv)({..._.questionTitleInput,..._.viewQuestionTitleOverrides,...b?{pseudoAfter:_.pseudoAfter}:{}}),children:C})}},281375:(e,t,o)=>{o.d(t,{Y:()=>l});o(667294);var r=()=>o(513670),i=()=>o(345837),n=()=>o(12512),s=o(785893);function l(e){let{store:t,disabled:o,style:l,placeholder:a,className:d,onChange:c,id:u}=e;return(0,s.jsx)(i().Z,{store:t,style:l,className:d,disableSlashCommands:!0,onEnter:r().ZT,onEsc:r().ZT,onTab:r().ZT,onUntab:r().ZT,onMoveDown:r().ZT,onMoveUp:r().ZT,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableEmbedMenu:!0,disabledMentionTypes:{page:!1,user:!1,date:!1,createPage:!0,inviteUserToWorkspace:!0,inviteUserToPage:!0,reminder:!0,bot:!0,heading:!0,group:!0,templateVariable:!0},disabled:o,pasteBehavior:"inline",placeholder:a,inPageFind:n().B3.none,disableComment:!0,onBlur:r().ZT,onChange:c,id:u})}},944044:(e,t,o)=>{o.d(t,{P:()=>c});var r=o(667294),i=()=>o(66077),n=()=>o(219727),s=()=>o(732811),l=()=>o(142735),a=()=>o(128039),d=()=>o(789568);function c(e){const t=(0,n().O7)(),{inMemoryRecordCacheName:o,collectionSchema:c,collectionId:u,spaceId:p,formMode:m}=e,y=(0,d().S)(),g=(0,r.useMemo)((()=>new(i().Z)({name:o,isTemporaryData:!0})),[o]),f=(0,l().VK)((()=>{var e;const o=null===(e=y.getFormState())||void 0===e?void 0:e.draftFormBlockStore;return o||a().createDummyFormPage({environment:t,spaceId:p,collectionSchema:c,temporaryRecordCache:g,collectionId:u,formMode:m})}),[u,c,t,y,m,p,g]);return(0,s().K)((()=>{g.addCacheFallback(t.defaultRecordCache.inMemoryRecordCache),y.updateFormState({draftFormBlockStore:f})})),f}},789568:(e,t,o)=>{o.d(t,{L:()=>n,S:()=>s});var r=o(667294),i=()=>o(807071);const n=(0,r.createContext)(null);function s(){const e=(0,r.useContext)(n);return e||new(i().Z)}n.displayName="FormBlockContext"},512687:(e,t,o)=>{o.d(t,{$S:()=>s,Mg:()=>l,Vi:()=>d,Vp:()=>p,mO:()=>c,ve:()=>u});o(241792);var r=()=>o(788860),i=()=>o(696459),n=()=>o(641702);const s=12,l=(0,r().vU)({anonymousSubmissionLabel:{id:"FormBlock.anonymousSubmissionLabel",defaultMessage:"Submitting response anonymously"}}),a=(0,r().vU)({inaccessibleTitle:{id:"FormBlock.inaccessible.title",defaultMessage:"This form is not publicly available."},inaccessibleSubtitle:{id:"FormBlock.inaccessible.subtitle",defaultMessage:"Login to submit or contact the form creator to publish."},closedOrDeletedTitle:{id:"FormBlock.closedOrDeleted.title",defaultMessage:"This form is closed or deleted."},closedOrDeletedSubtitle:{id:"FormBlock.closedOrDeleted.subtitle",defaultMessage:"Try contacting the form owner if you think it's a mistake."},submissionErrorTitle:{id:"FormBlock.submissionError.title",defaultMessage:"Something went wrong."},submissionErrorSubtitle:{id:"FormBlock.submissionError.subtitle",defaultMessage:"There was an issue submitting the form. Please try again or contact the form owner."}}),d={closedOrDeleted:a.closedOrDeletedTitle,inaccessible:a.inaccessibleTitle,submissionError:a.submissionErrorTitle},c={closedOrDeleted:a.closedOrDeletedSubtitle,inaccessible:a.inaccessibleSubtitle,submissionError:a.submissionErrorSubtitle};function u(e){let{questionType:t,filePropertyIdToFormFiles:o,draftSubmissionPageStore:r,propertyId:s}=e;switch(t){case"checkbox":return"Yes"===(0,n().Xh)(r.getPropertyValue(s),r)?"true":"false";case"file":return((null==o?void 0:o[s])??[]).map((e=>e.fileName)).join(", ");case"text":case"title":case"select":case"multi_select":case"relation":case"date":case"person":case"number":case"email":case"url":case"phone_number":return(0,n().Xh)(r.getPropertyValue(s),r);default:(0,i().t1)(t)}}function p(e){return e?500:600}},73597:(e,t,o)=>{o.d(t,{A:()=>a,E:()=>d});var r=()=>o(250303),i=()=>o(984871),n=()=>o(501912),s=()=>o(435168),l=()=>o(269299);async function a(e){let{theme:t,collectionContextStore:o,environment:r,property:i,from:s,schema:l,onDeleteCompleted:a,...c}=e;await n().T({environment:r,collectionContextStore:o,property:i,handleDeleteAccept:async()=>{await d({collectionContextStore:o,environment:r,property:i,schema:l,from:s,...c}),null==a||a()},theme:t,from:s})}async function d(e){const{collectionContextStore:t,environment:o,property:n,schema:a,from:d,...c}=e,u=t.collectionStore();if(!u)return;const p=u.getSchema()[n];await l().createAndCommitAsync({environment:o,userAction:"TableHeaderCell.handleDeleteAccept",waitForServerCommit:!1,perform:async e=>{await i().yV({environment:o,collectionStore:u,schema:a,property:n,transaction:e}),c.updateFrozenColumn&&s().oz({environment:o,collectionContextStore:t,currentIndex:c.columnIndex,entrypoint:c.updateFrozenColumnEntrypoint,transaction:e,propertyAction:"delete"})}}),p&&r().y9({environment:o,collectionContextStore:t,property_type:p.type,from:d,property:n})}},267730:(e,t,o)=>{o.d(t,{e:()=>a});var r=o(667294),i=()=>o(142735),n=()=>o(360240),s=o(785893);const l=14,a=r.memo(r.forwardRef((function(e,t){let{collectionContextStore:a,property:d,iconTransformer:c=(e=>e),iconSize:u=l,getTitleOverride:p,...m}=e;const{isMobile:y}=(0,o(219727).Fy)(),g=(0,i().VK)((()=>a.collectionStore()),[a]),f=(0,i().VK)((()=>null==g?void 0:g.getDatabaseType()),[g]),v=(0,i().VK)((()=>Boolean(g&&f&&o(110232).cR((0,o(2971).appConfigs)(),f,d,g))),[g,f,d]),h=(0,r.useCallback)((e=>(0,n().A7)(f,e)),[f]),x=(0,r.useCallback)((e=>(0,s.jsx)(o(827973).Z,{...m,...e,disabled:v,disabledFeedback:v,title:(null==p?void 0:p({isRequiredProperty:v}))??(0,s.jsx)(o(788860)._H,{defaultMessage:"Delete property",id:"database.tableHeaderCell.deleteProperty"}),caption:y&&v?(0,n().A7)(f):null,icon:c(v?(0,s.jsx)("div",{...e,children:(0,o(168441).Q)({width:u})}):(0,o(739479).y)({width:u})),isRedOnHover:!0})),[f,p,u,c,y,v,m]);return(0,s.jsx)(o(654133).Z,{placement:o(998901).Placement.Left,disableTooltip:!v,renderTooltip:h,render:x})})))},652809:(e,t,o)=>{o.d(t,{e:()=>i});o(667294);var r=o(785893);const i=(0,o(827282).IU)("circlePlus",{viewBox:"0 0 22 22",svg:(0,r.jsx)("path",{d:"M11 22C17.0326 22 22 17.0326 22 11C22 4.97795 17.0221 0 10.9895 0C4.9674 0 0 4.97795 0 11C0 17.0326 4.9674 22 11 22ZM5.83221 11.0105C5.83221 10.3461 6.30681 9.87152 6.96069 9.87152H9.88207V6.95014C9.88207 6.30681 10.3461 5.83221 10.9895 5.83221C11.6539 5.83221 12.1285 6.30681 12.1285 6.95014V9.87152H15.0499C15.6932 9.87152 16.1678 10.3461 16.1678 11.0105C16.1678 11.6539 15.6932 12.1179 15.0499 12.1179H12.1285V15.0499C12.1285 15.6932 11.6539 16.1572 10.9895 16.1572C10.3461 16.1572 9.88207 15.6932 9.88207 15.0499V12.1179H6.96069C6.30681 12.1179 5.83221 11.6539 5.83221 11.0105Z"})})},133009:(e,t,o)=>{o.d(t,{_:()=>i});o(667294);var r=o(785893);const i=(0,o(827282).IU)("pinFilled",{viewBox:"0 0 13 19",svg:(0,r.jsx)("path",{d:"M.102 11.773c0 .665.445 1.102 1.148 1.102h4.227v3.648c0 1.196.5 2.188.695 2.188.187 0 .687-.992.687-2.188v-3.648h4.227c.703 0 1.148-.438 1.148-1.102 0-1.648-1.32-3.39-3.515-4.187L8.46 4c1.14-.648 2.078-1.383 2.484-1.906.203-.266.305-.531.305-.766 0-.476-.367-.828-.914-.828H2.008c-.555 0-.914.352-.914.828 0 .234.093.5.297.766.406.523 1.343 1.258 2.484 1.906l-.258 3.586C1.422 8.383.102 10.125.102 11.773z"})})},761651:(e,t,o)=>{o.d(t,{x:()=>$t,D:()=>Ut});o(821057),o(267602),o(653476),o(241792);var r=()=>o(307312),i=o(667294),n=()=>o(219727),s=()=>o(142735),l=()=>o(846550),a=()=>o(532850),d=()=>o(308240),c=()=>o(712185),u=()=>o(210349),p=()=>o(252780),m=()=>o(788860),y=()=>o(568017),g=()=>o(513670),f=()=>o(696459),v=()=>o(707513),h=()=>o(641929),x=()=>o(521632),b=()=>o(251932),S=()=>o(125659),M=()=>o(191586),_=()=>o(466970),C=()=>o(133009),w=()=>o(749826),j=()=>o(311562),T=()=>o(551242),I=()=>o(57956),k=()=>o(963310),P=()=>o(439320),B=()=>o(200936),F=()=>o(590434),V=()=>o(162178),H=o(785893);function A(e){const{wrapper:t,viewsModule:o}=e,{pageStore:r,moduleStateByIdStore:n}=(0,V().PP)(),[l,a]=(0,i.useState)(void 0),d=(0,i.useMemo)((()=>new(B().E)),[]),c=(0,i.useCallback)((e=>{e&&d.observe(e)}),[d]),u=(0,s().VK)((()=>d.rect.state.width),[d]);(0,i.useEffect)((()=>{l&&n.set(o.id,{collectionContextStore:l})}),[l,n,o.id]);const p=(0,i.useMemo)((()=>(0,F().m)(r,o)),[r,o]),{collectionViewBlockStore:m,viewsModuleContextType:y}=(0,s().VK)((()=>{if(!p)return{collectionViewBlockStore:void 0,viewsModuleContextType:void 0};const e={type:"layoutBuilder",viewsModule:p,currentPageInRelatedCollectionStore:r};return{collectionViewBlockStore:p.getCollectionViewBlockStore(),viewsModuleContextType:e}}),[r,p]),g=(0,i.useMemo)((()=>"viewsMain"===o.type),[o]);return m&&p&&y?t((0,H.jsx)("div",{ref:c,children:(0,H.jsx)(P().F,{children:(0,H.jsx)(k().DZ,{store:m,isFullScreen:!1,disabled:!1,disableHoverMenu:!0,headerActionsBehavior:"always_show",headerAllowedActions:["filter","sort"],fullWidth:u,overridePaddingLeft:0,overridePaddingRight:0,setCollectionContextStore:a,showOnlyCurrentView:!g,isUnlistedView:p.isUnlistedView(),viewsModuleContextType:y})})})):null}var K=()=>o(639018),L=()=>o(794623),E=()=>o(98642),Z=()=>o(639708),D=()=>o(492522),R=()=>o(949842),O=()=>o(942226),q=()=>o(641506),Q=()=>o(644248),G=()=>o(420431),N=()=>o(75433),$=()=>o(844650),W=()=>o(761650),Y=()=>o(602801),z=(o(670560),()=>o(421551)),U=()=>o(66006),J=()=>o(215134);var X=()=>o(582025),ee=()=>o(766537),te=()=>o(6623),oe=()=>o(984871),re=()=>o(269299),ie=()=>o(73597),ne=()=>o(267730),se=()=>o(827973),le=()=>o(448419),ae=()=>o(1910),de=()=>o(198829),ce=()=>o(255577),ue=()=>o(388284),pe=()=>o(654133),me=()=>o(352230),ye=()=>o(404553),ge=()=>o(820545),fe=()=>o(660065),ve=()=>o(536635),he=()=>o(314379),xe=()=>o(739479),be=()=>o(998901),Se=()=>o(104088),Me=()=>o(826955),_e=()=>o(227199),Ce=()=>o(99537),we=()=>o(913011),je=()=>o(608303),Te=()=>o(395272);async function Ie(e){switch(e){case"property_number":case"property_title":case"property_person":case"property_file":case"property_text":case"property_checkbox":case"property_url":case"property_email":case"property_phone_number":case"property_created_by":case"property_last_edited_by":case"property_button":case"property_select":case"property_multi_select":case"property_status":case"property_date":case"property_created_time":case"property_last_edited_time":case"property_last_visited_time":case"property_relation":case"property_rollup":case"property_formula":case"property_auto_increment_id":case"property_location":case"property_verification":return await async function(){return await je().w({icon:Te().p,confirmTextStyle:"red",title:(0,H.jsx)(m()._H,{defaultMessage:"Remove property from layout?",id:"deletePropertyActions.title"}),confirmText:(0,H.jsx)(m()._H,{defaultMessage:"Remove",id:"deletePropertyActions.confirmText"}),confirmTextPerRadioOption:{delete_property_and_module:(0,H.jsx)(m()._H,{defaultMessage:"Remove and delete",id:"deletePropertyActions.confirmTextForDeletePropertyAndModule"})},radioOptions:[{key:"delete_module",title:(0,H.jsx)(m()._H,{defaultMessage:"Remove from layout",id:"deletePropertyActions.titleForDeleteModuleOption"}),subtitle:(0,H.jsx)(m()._H,{defaultMessage:"The property will still be visible in database views and in the page’s property group",id:"deletePropertyActions.subtitleForDeleteModuleOption"})},{key:"delete_property_and_module",title:(0,H.jsx)(m()._H,{defaultMessage:"Remove from layout and database",id:"deletePropertyActions.titleForDeletePropertyAndModuleOption"}),subtitle:(0,H.jsx)(m()._H,{defaultMessage:"The property will be removed from both the page layout and the database",id:"deletePropertyActions.subtitleForDeletePropertyAndModuleOption"})}]})}();case"relationsGroup":return await async function(){return await je().w({icon:Te().p,confirmTextStyle:"red",title:(0,H.jsx)(m()._H,{defaultMessage:"Remove relations group from layout?",id:"deleteRelationsGroupModuleActions.title"}),confirmText:(0,H.jsx)(m()._H,{defaultMessage:"Remove",id:"deleteRelationsGroupModuleActions.confirmText"}),confirmTextPerRadioOption:{delete_property_and_module:(0,H.jsx)(m()._H,{defaultMessage:"Remove and delete",id:"deleteRelationsGroupModuleActions.confirmTextForDeletePropertyAndModule"})},radioOptions:[{key:"delete_module",title:(0,H.jsx)(m()._H,{defaultMessage:"Remove from layout",id:"deleteRelationsGroupModuleActions.titleForDeleteModuleOption"}),subtitle:(0,H.jsx)(m()._H,{defaultMessage:"The relations properties will still be visible in database views and in the page's property group",id:"deleteRelationsGroupModuleActions.subtitleForDeleteModuleOption"})},{key:"delete_property_and_module",title:(0,H.jsx)(m()._H,{defaultMessage:"Remove from layout and database",id:"deleteRelationsGroupModuleActions.titleForDeletePropertyAndModuleOption"}),subtitle:(0,H.jsx)(m()._H,{defaultMessage:"The relations properties will be removed from both the page layout and the database",id:"deleteRelationsGroupModuleActions.subtitleForDeletePropertyAndModuleOption"})}]})}();case"formSubmit":case"formQuestion":case"formTitle":case"placeholder":case"views":case"transcript":return"delete_module";default:(0,f().t1)(e)}}var ke=()=>o(142730),Pe=()=>o(655260),Be=()=>o(294630),Fe=(o(470928),()=>o(932753)),Ve=()=>o(128076);var He=()=>o(243144),Ae=()=>o(868744);function Ke(e){let{icon:t}=e;const o=(0,l().yK)((()=>({iconWrapper:{display:"flex",alignItems:"center",justifyContent:"center",width:16,height:16,overflow:"visible"}})),[]);return(0,H.jsx)("div",{style:o.iconWrapper,children:t})}const Le=i.memo(Ke);function Ee(e){let{parent:t,onSelect:r,...i}=e;const a=(0,n().O7)(),{layoutStore:d}=(0,V().J9)(),c=(0,s().VK)((()=>d.getModules()),[d]),u=(0,s().VK)((()=>Boolean((0,J().B1)(c,(e=>"relationsGroup"===e.type)))),[c]),p=(0,l().yK)((e=>({icon:{width:16,height:16},sectionMenuItem:{paddingTop:4,paddingBottom:4}})),[]),y=(0,H.jsx)(m()._H,{id:"AdvancedModuleMenuItem.originButtonTitle",defaultMessage:"Advanced"}),g=(0,H.jsx)(Le,{icon:(0,o(166104).H)(p.icon)}),f=u?(0,H.jsx)(m()._H,{id:"AdvancedModuleMenuItem.buttons.moveToRelationsGroupModule",defaultMessage:"Add to relations group"}):(0,H.jsx)(m()._H,{id:"AdvancedModuleMenuItem.buttons.convertToRelationsGroupModule",defaultMessage:"Convert to relations group"}),v={key:"moveOrConvertToRelationsGroup",render:(e,t)=>(0,H.jsx)(se().Z,{...e,icon:(0,H.jsx)(Le,{icon:(0,o(848854).v)({width:14})}),title:f,caption:(0,H.jsx)(m()._H,{id:"AdvancedModuleMenuItem.moveOrConvertToRelationsGroup.caption",defaultMessage:"Supports minimal or responsive page sections"})}),action:()=>r()};return(0,H.jsx)(Ae().Z,{...i,onFocus:t.onFocus,renderOrigin:(e,t)=>(0,H.jsx)(se().Z,{...e,ref:t,title:y,icon:g}),renderExtension:e=>{let o;return o=a.device.isMobile?{menuType:me().o.ActionSheet}:{menuType:me().o.Popup},(0,H.jsx)(de().Z,{...o,...e,children:(0,H.jsx)(ce().Z,{type:ce().i.Vertical,initialFocus:0,sections:[{key:"sections",render:e=>(0,H.jsx)(ue().Z,{...e}),items:[v]}],onAccept:t.onAccept})})}})}const Ze=i.memo(Ee);const De=(0,o(827282).IU)("propertyGroup",{viewBox:"0 0 20 20",svg:(0,H.jsx)("path",{d:"M5.49512 7.7334C5.35384 7.7334 5.23079 7.68099 5.12598 7.57617C5.02116 7.47135 4.96875 7.34603 4.96875 7.2002C4.96875 7.05436 5.01888 6.92904 5.11914 6.82422C5.22396 6.7194 5.34928 6.66699 5.49512 6.66699H6.27441C6.42025 6.66699 6.54557 6.7194 6.65039 6.82422C6.75977 6.92904 6.81445 7.05436 6.81445 7.2002C6.81445 7.35059 6.75977 7.47819 6.65039 7.58301C6.54557 7.68327 6.42025 7.7334 6.27441 7.7334H5.49512ZM5.49512 9.97559C5.34928 9.97559 5.22396 9.92546 5.11914 9.8252C5.01888 9.72038 4.96875 9.59505 4.96875 9.44922C4.96875 9.29883 5.01888 9.1735 5.11914 9.07324C5.22396 8.96842 5.34928 8.91602 5.49512 8.91602H6.27441C6.4248 8.91602 6.55241 8.96842 6.65723 9.07324C6.76204 9.1735 6.81445 9.29883 6.81445 9.44922C6.81445 9.59505 6.75977 9.72038 6.65039 9.8252C6.54557 9.92546 6.42025 9.97559 6.27441 9.97559H5.49512ZM8.16113 7.65137C8.03353 7.65137 7.92643 7.60807 7.83984 7.52148C7.75781 7.4349 7.7168 7.3278 7.7168 7.2002C7.7168 7.07715 7.76009 6.97461 7.84668 6.89258C7.93327 6.80599 8.03809 6.7627 8.16113 6.7627H14.5732C14.6963 6.7627 14.7988 6.80599 14.8809 6.89258C14.9674 6.97461 15.0107 7.07715 15.0107 7.2002C15.0107 7.3278 14.9674 7.4349 14.8809 7.52148C14.7988 7.60807 14.6963 7.65137 14.5732 7.65137H8.16113ZM8.16113 9.89355C8.03353 9.89355 7.92643 9.85026 7.83984 9.76367C7.75781 9.67708 7.7168 9.57227 7.7168 9.44922C7.7168 9.32161 7.76009 9.21452 7.84668 9.12793C7.93327 9.04134 8.03809 8.99805 8.16113 8.99805H14.5732C14.6963 8.99805 14.7988 9.04362 14.8809 9.13477C14.9674 9.22135 15.0107 9.32617 15.0107 9.44922C15.0107 9.57682 14.9674 9.68392 14.8809 9.77051C14.7988 9.85254 14.6963 9.89355 14.5732 9.89355H8.16113ZM4.1416 16.4492C3.40332 16.4492 2.84505 16.2624 2.4668 15.8887C2.08854 15.515 1.89941 14.9635 1.89941 14.2344V5.9082C1.89941 5.17904 2.08854 4.6276 2.4668 4.25391C2.84505 3.87565 3.40332 3.68652 4.1416 3.68652H15.8447C16.5876 3.68652 17.1481 3.87565 17.5264 4.25391C17.9046 4.6276 18.0938 5.17904 18.0938 5.9082V14.2344C18.0938 14.9635 17.9046 15.515 17.5264 15.8887C17.1481 16.2624 16.5876 16.4492 15.8447 16.4492H4.1416ZM4.22363 15.1094H15.7695C16.084 15.1094 16.3255 15.0273 16.4941 14.8633C16.6628 14.6947 16.7471 14.4463 16.7471 14.1182V6.02441C16.7471 5.69629 16.6628 5.4502 16.4941 5.28613C16.3255 5.11751 16.084 5.0332 15.7695 5.0332H4.22363C3.90462 5.0332 3.66081 5.11751 3.49219 5.28613C3.32812 5.4502 3.24609 5.69629 3.24609 6.02441V14.1182C3.24609 14.4463 3.32812 14.6947 3.49219 14.8633C3.66081 15.0273 3.90462 15.1094 4.22363 15.1094Z"})});function Re(e){let{propertyGroups:t,propertyIds:r,parent:a,onSelectSectionMove:d,...c}=e;const u=(0,n().O7)(),p=(0,S().Y$)(),y=(0,i.useCallback)((e=>{const i=p.collectionStore();let n=t;for(const t of r)n=(0,o(775283).cb)({propertyGroups:n,propertyId:t,destinationGroupId:e.id});i&&re().createAndCommit({environment:u,perform(e){(0,o(170075).N7)({collectionStore:i,newGroups:n,transaction:e})},canUndo:!0,userAction:"MoveToPropertyGroupMenuItem.handlePropertyGroupClick"}),d()}),[p,u,d,t,r]),g=(0,l().yK)((e=>({icon:{width:20,height:20},sectionMenuItem:{paddingTop:4,paddingBottom:4}})),[]),f=(0,s().VK)((()=>t.map((e=>({key:e.id,render:(t,o)=>(0,H.jsx)(se().Z,{...t,title:e.title}),action:()=>y(e)})))),[y,t]),v=(0,H.jsx)(m()._H,{id:"ModuleActionMenu.buttons.moveToPropertiesGroupButton",defaultMessage:"Add to property group"}),h=(0,H.jsx)(Le,{icon:De(g.icon)});return t.length<=1?(0,H.jsx)(se().Z,{...c,icon:h,title:v}):(0,H.jsx)(Ae().Z,{...c,onFocus:a.onFocus,renderOrigin:(e,t)=>(0,H.jsx)(se().Z,{...e,ref:t,title:v,icon:h}),renderExtension:e=>{let t;return t=u.device.isMobile?{menuType:me().o.ActionSheet}:{menuType:me().o.Popup,width:200},(0,H.jsx)(de().Z,{...t,...e,children:(0,H.jsx)(ce().Z,{type:ce().i.Vertical,initialFocus:0,sections:[{key:"sections",render:e=>(0,H.jsx)(ue().Z,{...e,style:g.sectionMenuItem,title:(0,H.jsx)(m()._H,{id:"moveToPropertyGroupMenuItem.sections",defaultMessage:"Sections"})}),items:f}],onAccept:a.onAccept})})}})}const Oe=i.memo(Re),qe=i.memo((function(e){const{layoutType:t,module:o,isModuleHoveredOrSelected:r}=e;switch(t){case"form":if("formQuestion"===o.type)return(0,H.jsx)(Qe,{moduleId:o.id,isModuleHoveredOrSelected:r});break;case"page_in_collection":case void 0:return(0,H.jsx)(Ge,{module:o});default:(0,f().t1)(t)}return null}));function Qe(e){let{moduleId:t,isModuleHoveredOrSelected:o}=e;const{canEditLayout:r}=(0,V().J9)(),i=(0,l().yK)((()=>({actionButton:{position:"absolute",top:10,right:10,zIndex:D().LX}})),[]);return r?(0,H.jsx)("div",{style:i.actionButton,children:(0,H.jsx)(Ne,{moduleId:t,isModuleHoveredOrSelected:o})}):null}function Ge(e){let{module:t}=e;const{canEditLayout:o}=(0,V().J9)(),r=function(e){const{layoutModule:t}=e,{sessionId:o,layoutStore:r,setModuleSelection:l}=(0,V().J9)(),a=(0,n().O7)(),c=(0,S().Y$)(),u=(0,s().VK)((()=>c.collectionStore()),[c]),{collectionSchema:p,collectionFormat:y,propertyGroups:g}=(0,s().VK)((()=>({collectionSchema:null==u?void 0:u.getSchema(),collectionFormat:null==u?void 0:u.getFormat(),propertyGroups:(null==u?void 0:u.getNormalizedPropertyGroups())??[]})),[u]),v=(0,i.useMemo)((()=>y&&p?(0,z().n)({format:y,schema:p,visibilityLevels:["inline","minimal"]}).map((e=>e.section)):[]),[y,p]),{layoutType:h,isTabbedLayout:x,viewsMainTabModuleKey:b,currentModulePosition:M,modulesSplitByMoveable:_}=(0,s().VK)((()=>{var e,o;const i=r.getModules(),n=(0,J().B1)(i,(e=>e.id===t.id)),s=null==n?void 0:n.area;if("form_conditional_modules"===s)throw new Error("[Forms Conditional Logic Not Implemented] usePageLayoutModuleActionMenuListItems not implemented for form_conditional_modules");const l=s&&("views_main_tab_modules"===s?null==i||null===(e=i[s])||void 0===e?void 0:e[n.viewId]:null==i?void 0:i[s]),a=s&&l&&(0,ee().Lk)(s,l),d=null===(o=function(e){if(e.views_main_tab_modules)return(0,f().Yd)(e.views_main_tab_modules)}(i))||void 0===o?void 0:o[0];return{layoutType:r.getLayoutType(),isTabbedLayout:r.isTabbedPageLayout(),viewsMainTabModuleKey:d,currentModulePosition:n,modulesSplitByMoveable:a}}),[t.id,r]),C=(0,i.useCallback)((e=>{let{destinationModuleId:t}=e;h&&((0,U().K)(h)?l(void 0):l({type:"existing_module",moduleId:t,isDragging:!1,draggingModuleInitialArea:void 0,draggingModuleFinalArea:void 0}),(0,U().E)(h)&&(0,Be().O)({layoutStore:r,moduleId:t}))}),[r,h,l]),w=function(e){const{layoutStore:t}=e,o=t.pointer,r=(0,n().O7)(),s=(0,i.useContext)(V().eK),l=null==s?void 0:s.moduleStateByIdStore;return(0,i.useCallback)((e=>{var i;const n=t.getModules(),s=(0,J().h7)(n,(e=>"viewsMain"===e.type));if(!s||!(0,Z().aJ)(s.module))return;const{module:a}=s,d=null==l||null===(i=l.get(a.id))||void 0===i?void 0:i.collectionContextStore;if(!d)return;const c=Ve().G.createChildStore(t,a.collection_view_block_pointer).getCollectionViewStores();let u;"viewId"===(null==e?void 0:e.type)?u=null==c?void 0:c.find((t=>{var o;return(null===(o=t.getFormat().page_layout_pointer)||void 0===o?void 0:o.views_main_tab_id)===e.viewId})):"contentTab"===e.type?u=null==c?void 0:c.find((e=>{var t;return"page"===e.getType()&&(null===(t=e.getFormat().page_layout_pointer)||void 0===t?void 0:t.id)===o.id})):(0,f().t1)(e),u&&(0,Fe().f8)({environment:r,collectionContextStore:d,collectionViewId:u.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1})}),[t,l,r,o.id])}({layoutStore:r}),j=(0,i.useMemo)((()=>{const e=[],i=(0,X().B)(t,"page_details");if(_&&_.moveableModules.length>1&&null!=M&&M.area){const i=_.moveableModules.findIndex((e=>e.id===t.id)),n=-1!==i,s=0===i,l=i===_.moveableModules.length-1;n&&!s&&e.push({key:"move-up",render:e=>(0,H.jsx)(se().Z,{...e,title:(0,H.jsx)(m()._H,{id:"ModuleActionMenu.buttons.moveUpButton",defaultMessage:"Move up"}),icon:(0,H.jsx)(Le,{icon:(0,ve().Z)({width:14})})}),action:()=>{const e=_.nonMoveableHeaderModules.length+i;(0,Ce().ST)({environment:a,layoutStore:r,position:{type:"absolute",index:e-1,..."views_main_tab_modules"===(null==M?void 0:M.area)?{area:"views_main_tab_modules",viewId:M.viewId}:{area:M.area}},moduleId:t.id,sessionId:o}),C({destinationModuleId:t.id})}}),n&&!l&&e.push({key:"move-down",render:e=>(0,H.jsx)(se().Z,{...e,title:(0,H.jsx)(m()._H,{id:"ModuleActionMenu.buttons.moveDownButton",defaultMessage:"Move down"}),icon:(0,H.jsx)(Le,{icon:(0,ye().M)({width:14})})}),action:()=>{const e=_.nonMoveableHeaderModules.length+i;(0,Ce().ST)({environment:a,layoutStore:r,position:{type:"absolute",index:e+1,..."views_main_tab_modules"===(null==M?void 0:M.area)?{area:"views_main_tab_modules",viewId:M.viewId}:{area:M.area}},moduleId:t.id,sessionId:o}),C({destinationModuleId:t.id})}})}if("page_main"!==(null==M?void 0:M.area)&&"views_main_tab_modules"!==(null==M?void 0:M.area)||!i?"page_details"===(null==M?void 0:M.area)&&e.push({key:"moveToMainPage",render:e=>(0,H.jsx)(se().Z,{...e,title:(0,H.jsx)(m()._H,{id:"ModuleActionMenu.buttons.moveToPage",defaultMessage:"Move to page"}),icon:(0,H.jsx)(Le,{icon:(0,ge().I)({width:14})})}),action:()=>{x&&b?((0,Ce().ST)({environment:a,position:{type:"area_relative",area:"views_main_tab_modules",viewId:b,location:"end_moveable"},moduleId:t.id,layoutStore:r,sessionId:o}),w({type:"contentTab"})):(0,Ce().ST)({environment:a,position:{type:"area_relative",area:"page_main",location:"end_moveable"},moduleId:t.id,layoutStore:r,sessionId:o}),C({destinationModuleId:t.id})}}):e.push({key:"moveToSidebar",render:e=>(0,H.jsx)(se().Z,{...e,title:(0,H.jsx)(m()._H,{id:"ModuleActionMenu.buttons.moveToInfoPanel",defaultMessage:"Move to panel"}),icon:(0,H.jsx)(Le,{icon:(0,fe().r)({width:14})})}),action:()=>{(0,Ce().ST)({environment:a,position:{type:"area_relative",area:"page_details",location:"end_moveable"},moduleId:t.id,layoutStore:r,sessionId:o}),C({destinationModuleId:t.id})}}),(0,te().Fo)(t)&&(0,te().m7)(t)){let o=[];(0,Z().f)(t)?o=[t.propertyId]:(0,Z().Cj)(t)?o=v:(0,f().t1)(t);const i=()=>{var e;re().createAndCommitOrAppend({environment:a,transaction:void 0,canUndo:!0,userAction:"ModuleActionsMenu.moveToPropertyGroup",perform(e){for(const t of o)(0,ke().iQ)({environment:a,transaction:e,layoutStore:r,property:t})}});const t=null===(e=r.firstModuleOfType("properties"))||void 0===e?void 0:e.id;t?C({destinationModuleId:t}):l(void 0)};e.push({key:"moveToPropertiesGroupModule",render:(e,t)=>(0,H.jsx)(Oe,{...e,parent:t,propertyIds:o,onSelectSectionMove:i,propertyGroups:g}),action:i})}if((0,Z().J6)(t)){const o=()=>{var e;re().createAndCommitOrAppend({environment:a,transaction:void 0,canUndo:!0,userAction:"ModuleActionsMenu.moveToRelationsGroupModule",perform(e){const o=r.getCollectionModel();if(!o)return;const i=Me().NW.createChildStore(r,o.pointer);(0,ke().iQ)({environment:a,transaction:e,layoutStore:r,property:t.propertyId}),oe().Ji({property:t.propertyId,visibility:"inline",schema:o.getSchema(),format:o.getFormat(),collectionStore:i,environment:a,transaction:e})}});const o=null===(e=r.firstModuleOfType("relationsGroup"))||void 0===e?void 0:e.id;o?C({destinationModuleId:o}):l(void 0)};e.push({key:"moveToRelationsGroup",render:(e,t)=>(0,H.jsx)(Ze,{parent:t,onSelect:o,...e}),action:o})}if((0,te().Fo)(t)){const i=async()=>{var e;if(null==M||!M.area||!p)return;const i=await Ie(t.type);if(i)switch(i){case"delete_module":re().createAndCommitOrAppend({environment:a,transaction:void 0,canUndo:!0,perform(e){if((0,Z().f)(t))(0,ke().iQ)({environment:a,transaction:e,layoutStore:r,property:t.propertyId});else if((0,Z().Cj)(t))for(const t of v)(0,ke().iQ)({environment:a,transaction:e,layoutStore:r,property:t});else(0,we().H)({environment:a,layoutStore:r,position:{..."views_main_tab_modules"===(null==M?void 0:M.area)?{area:"views_main_tab_modules",viewId:M.viewId}:{area:M.area},moduleId:t.id},sessionId:o})},userAction:"ModuleActionsMenu.removePropertyFromLayout.deleteModule"});const s=null===(e=r.firstModuleOfType("properties"))||void 0===e?void 0:e.id;return void(s&&C({destinationModuleId:s}));case"delete_property_and_module":let u=[];if((0,Z().f)(t)?u=[t.propertyId]:(0,Z().Cj)(t)&&(u=v||[]),u.length)for(const e of u){var n;(0,ie().E)({collectionContextStore:c,environment:a,property:e,schema:p,from:"table_column"}),(0,Pe().DZ)({environment:a,module:t,sessionId:o,collectionId:null===(n=r.getCollectionModel())||void 0===n?void 0:n.id,layoutId:r.id,context:(0,d().AR)(null==M?void 0:M.area),area:null==M?void 0:M.area})}else(0,we().H)({environment:a,layoutStore:r,sessionId:o,position:{..."views_main_tab_modules"===(null==M?void 0:M.area)?{area:"views_main_tab_modules",viewId:M.viewId,moduleId:t.id}:{area:M.area,moduleId:t.id}}});return void l(void 0);default:(0,f().t1)(i)}};e.push({key:"removeModule",render:e=>(0,Z().f)(t)?(0,H.jsx)(ne().e,{...e,getTitleOverride:e=>{let{isRequiredProperty:t}=e;return t?void 0:(0,H.jsx)(m()._H,{id:"ModuleActionMenu.buttons.removeFromPropertyModule",defaultMessage:"Remove from layout"})},iconTransformer:e=>(0,H.jsx)(Le,{icon:e}),collectionContextStore:c,iconSize:16,property:t.propertyId}):(0,H.jsx)(se().Z,{...e,title:(0,H.jsx)(m()._H,{id:"ModuleActionMenu.buttons.removeFromModule",defaultMessage:"Remove from layout"}),isRedOnHover:!0,icon:(0,H.jsx)(Le,{icon:(0,xe().y)({width:14})})}),action:i})}return e}),[t,_,M,a,r,o,C,x,b,w,v,l,g,p,c]);return j}({layoutModule:t}),a=(0,l().yK)((()=>({actionButton:{position:"absolute",top:4,right:4,zIndex:D().LX}})),[]);return o&&0!==r.length?(0,H.jsx)("div",{style:a.actionButton,children:(0,H.jsx)($e,{moduleId:t.id,menuListItems:r})}):null}function Ne(e){let{moduleId:t,isModuleHoveredOrSelected:o}=e;const{layoutStore:r,setModuleSelection:i}=(0,V().J9)(),n=(0,s().VK)((()=>r.getModuleById(t)),[r,t]),a=(0,s().VK)((()=>{if(n&&"formQuestion"===n.type)return _e().c.createChildStore(r,{table:"form_question",id:n.formQuestionId,spaceId:r.getSpaceId()??""})}),[r,n]),d=(0,He().F)(),c=(0,l().yK)((e=>({iconStyle:{fill:e.accentColors.uiBlue[600]}})),[]);return n&&a?(0,H.jsx)("div",{style:{opacity:o?1:0,pointerEvents:o?"auto":"none",transition:"opacity 200ms ease",borderRadius:4,height:24},children:(0,H.jsx)(pe().Z,{render:e=>(0,H.jsx)(ae().Z,{...e,icon:he().o,hasBackground:!0,style:{...d.button,cursor:"pointer"},iconStyle:c.iconStyle,pressedStyle:d.buttonPressed,hoveredStyle:d.buttonHovered,ariaLabel:"s",onMouseDown:e=>{(0,R().ZP)({event:e,context:R().Af.EditorMouseDown})},onClick:()=>i({type:"existing_module",moduleId:t,isDragging:!1,draggingModuleInitialArea:void 0,draggingModuleFinalArea:void 0})}),renderTooltip:()=>(0,H.jsx)(m()._H,{id:"FormLayoutModuleActionMenu.editQuestion.tooltip",defaultMessage:"Edit question"})})}):null}function $e(e){let{moduleId:t,menuListItems:o}=e;const r=(0,m().YB)(),n=(0,i.useMemo)((()=>[{type:"actionGroup",label:r.formatMessage({id:"ModuleActionMenu.openButton",defaultMessage:"Action menu for module"}),icon:he().o,menuListItems:o}]),[r,o]);return(0,H.jsx)(Ye,{moduleId:t,actionMenuItems:n,isModuleHoveredOrSelected:!0,boxShadow:!1})}function We(e){let{isFirst:t,isLast:o}=e;return{borderTopLeftRadius:t?4:0,borderBottomLeftRadius:t?4:0,borderTopRightRadius:o?4:0,borderBottomRightRadius:o?4:0,borderRight:"solid rgba(15, 15, 15, 0.1)",borderRightWidth:o?0:1}}function Ye(e){let{moduleId:t,actionMenuItems:o,isModuleHoveredOrSelected:r,boxShadow:n}=e;const[s,l]=(0,i.useState)(!1),a=(0,i.useCallback)((e=>{l(e)}),[]);return(0,H.jsx)("div",{style:{opacity:r||s?1:0,pointerEvents:r||s?"auto":"none",transition:"opacity 200ms ease",borderRadius:4,height:24,boxShadow:n?"rgba(15, 15, 15, 0.1) 0px 0px 0px 1px, rgba(15, 15, 15, 0.1) 0px 2px 4px":void 0},children:o.map(((e,t)=>{const r=0===t,i=o.length-1===t;switch(e.type){case"action":return(0,H.jsx)(ze,{item:e,isFirst:r,isLast:i},t);case"actionGroup":return(0,H.jsx)(Ue,{itemGroup:e,isFirst:r,isLast:i,isOpen:s,setIsOpen:a},t)}}))})}function ze(e){let{item:t,isFirst:o,isLast:r}=e;const{layoutStore:i}=(0,V().J9)(),n=(0,s().VK)((()=>i.getLayoutType()),[i]),a=(0,l().yK)((e=>({iconButton:{...We({isFirst:o,isLast:r})},icon:{..."form"===n?{fill:e.icon.secondary}:{}}})),[o,r,n]);return(0,H.jsx)(pe().Z,{render:e=>(0,H.jsx)(ae().Z,{...e,icon:t.icon,hasBackground:!0,ariaLabel:t.label,style:a.iconButton,iconStyle:a.icon,onMouseDown:e=>{(0,R().ZP)({event:e,context:R().Af.EditorMouseDown})},onClick:t.action}),renderTooltip:()=>t.tooltipLabel??null,disableTooltip:!t.tooltipLabel})}function Ue(e){let{itemGroup:t,isFirst:o,isLast:r,isOpen:i,setIsOpen:n}=e;const{layoutStore:a}=(0,V().J9)(),d=(0,s().VK)((()=>a.getLayoutType()),[a]),c=(0,l().yK)((e=>({iconButton:{...We({isFirst:o,isLast:r})},icon:{..."form"===d?{fill:e.icon.secondary}:{fill:e.text.uiBluePrimary}},iconButtonHovered:{..."form"===d?void 0:{background:e.tint.uiBlueHover}},sectionMenuItem:{paddingTop:4,paddingBottom:4}})),[o,r,d]);return(0,H.jsx)(le().ZP,{alignmentToOrigin:be().Alignment.End,popupType:Se().k.Popup,onClose:()=>n(!1),onClick:()=>n(!0),open:i,render:()=>(0,H.jsx)(de().Z,{menuType:me().o.Popup,onClick:()=>n(!1),children:(0,H.jsx)(ce().Z,{initialFocus:void 0,sections:[{key:0,render:e=>(0,H.jsx)(ue().Z,{...e,desktopStyle:c.sectionMenuItem}),items:t.menuListItems}],type:ce().i.Vertical})}),renderOrigin:e=>(0,H.jsx)(ae().Z,{...e,icon:t.icon,hasBackground:"form"===d,ariaLabel:t.label,style:c.iconButton,iconStyle:c.icon,onMouseDown:e=>{(0,R().ZP)({event:e,context:R().Af.EditorMouseDown})},hoveredStyle:c.iconButtonHovered,pressedStyle:c.iconButtonHovered})})}const Je=(0,i.createContext)(void 0);Je.displayName="PageEditorModuleContext";const Xe=Je.Provider;var et=()=>o(857719);const tt=!1,ot=10;function rt(e){const{isSelected:t,isDragging:o,isConfigurable:r,isDraggable:n}=function(){const e=(0,i.useContext)(Je);if(!e)throw new Error("PageEditorModuleContext not found");return e}(),{style:a,children:d,module:c,area:u}=e,p="placeholder"===c.type,{setModuleSelection:m,layoutStore:y,currentModuleSelection:g}=(0,V().J9)(),[f,v]=(0,Q().C)(),h=(0,i.useRef)(null),x=(0,L().Z)(f,h),b=(0,s().VK)((()=>{var e;return null===(e=y.getModel())||void 0===e?void 0:e.getLayoutType()}),[y]),S=(0,s().VK)((()=>(0,O().wq)(y)),[y]),M=(0,Y().j)();(0,E().c)(N().Z,(()=>({layoutStore:y,moduleId:c.id,moduleType:c.type,area:u,getNode:()=>h.current})),[y,c,h,u]);const _=(0,i.useCallback)((e=>{if(!r||"viewsMain"===c.type)return{};const i={margin:0,borderRadius:"form"===b?12:8,...!r||n||"form"===b&&p?{}:{cursor:"pointer",margin:"0 0 12px 0"},padding:"form"!==b||p?0:12,transition:"box-shadow 0.3s"};if(o&&!p)return{...i,...(0,q().x6)({width:3,color:e.stroke.uiBluePrimary}),transform:"scale(1.03)",transition:"transform 0.8s cubic-bezier(0.5, -1.5, 0.5, 2)"};if(t&&!p)return{...i,...(0,q().x6)({width:3,color:e.stroke.uiBluePrimary})};const s=null==g?void 0:g.isDragging;return v&&!s?{...i,...(0,q().x6)({width:3,color:e.stroke.uiBlueSecondary})}:{...i,...(0,q().x6)({width:1,color:e.stroke.uiBlueSecondary})}}),[null==g?void 0:g.isDragging,r,n,o,v,p,t,b,c.type]),C=(0,l().yK)((e=>{const t=_(e),o="form"!==b?ot:"cover"===c.type?0:"formTitle"===c.type?M:ot,i=p?e.accentColors.uiBlue[75]:"form"===b&&S?e.peekModalBackground:e.contentBackground;return{labelContainer:{height:32,backgroundColor:"light"===e.mode?e.accentColors.uiBlue[100]:e.accentColors.uiBlue[200],display:"flex",alignItems:"center",gap:4,padding:6},dragHandle:{fill:e.text.uiBluePrimary,width:12,height:12},noDragHandle:{},label:{fontSize:14,fontWeight:500,color:e.text.uiBluePrimary,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",paddingRight:24},previewContainer:{padding:12},container:{background:i,width:"100%",position:"relative",marginBottom:o,...r?t:{},overflow:"formTitle"!==c.type?"hidden":void 0,...a},mouseEventCover:{position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:D().mJ}}}),[_,r,c.type,a,b,M,p,S]),w="form"!==b&&!tt&&"viewsMain"!==c.type,j=((0,W().Z)(c),v||t);return(0,H.jsxs)("div",{style:C.container,ref:x,onClick:e=>{r&&!n&&"viewsMain"!==c.type&&m({type:"existing_module",moduleId:c.id,isDragging:!1}),r&&(0,R().ZP)({event:e,context:R().Af.EditorClick})},className:"cover"===c.type||"viewsMain"===c.type?et().w3:et().Vc,children:["form"!==b&&"viewsMain"!==c.type&&r?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsxs)("div",{style:C.labelContainer,children:[n?(0,G().D)(C.dragHandle):(0,H.jsx)("div",{style:C.noDragHandle}),(0,H.jsx)("div",{style:C.label,children:(0,H.jsx)(it,{module:c})})]}),(0,H.jsx)("div",{style:C.previewContainer,children:d})]}):d,w&&(0,H.jsx)("div",{style:C.mouseEventCover}),r&&(0,H.jsx)(qe,{layoutType:b,module:c,isModuleHoveredOrSelected:j})]})}function it(e){const{module:t}=e;return(0,Z().f)(t)?(0,H.jsx)(nt,{module:t}):(0,H.jsx)(m()._H,{...$().B[t.type]})}function nt(e){const{module:t}=e,{collectionStore:o}=(0,V().PP)(),r=(0,s().VK)((()=>o.getSchema()),[o]),i=(0,s().VK)((()=>r[t.propertyId]),[t,r]);return i?(0,H.jsx)(H.Fragment,{children:i.name}):null}var st=()=>o(990966),lt=()=>o(128039),at=()=>o(491925),dt=()=>o(608531),ct=()=>o(903282),ut=()=>o(574596),pt=()=>o(944044),mt=()=>o(768826),yt=()=>o(356321),gt=()=>o(668001),ft=()=>o(653457),vt=()=>o(121700);function ht(e){let{layoutStore:t,formQuestionId:o}=e;const r=(0,n().O7)(),l=(0,S().Y$)(),d=(0,i.useRef)(null),{canEditLayout:c}=(0,V().J9)(),{collectionStore:u,formBlock:p}=(0,s().VK)((()=>{var e;return{collectionStore:l.collectionStore(),formBlock:null===(e=l.collectionViewStore())||void 0===e?void 0:e.getFormBlockStore()}}),[l]);if(!u)throw new Error("No collection store found");const m=(0,s().VK)((()=>t.getSpaceId()),[t]),y=(0,s().VK)((()=>{if(m)return Me().cq.createChildStore(t,{table:"form_question",id:o,spaceId:m})}),[o,t,m]),g=(0,s().VK)((()=>!(null!=y&&y.isReady())),[y]),f=(0,s().VK)((()=>{var e;if(y)return null===(e=y.getConfig())||void 0===e?void 0:e.propertyId}),[y]),v=(0,s().VK)((()=>u.getSchema()),[u]),x=(0,s().VK)((()=>{if(v&&f)return(0,a().Qm)({schema:v,property:f})}),[v,f]),b=(0,pt().P)({inMemoryRecordCacheName:"FormQuestionTemporaryRecordCache",collectionSchema:v,collectionId:u.id,spaceId:m,formMode:"builder"}),M=(0,s().VK)((()=>{const e=u.getSchema();if(!e||!y)return"generic_error";return y.getQuestionErrorState(r,e,null==p?void 0:p.hasPublicPermission())}),[u,r,p,y]),{autofocusedQuestionTextStore:_}=(0,h().Y)(),C=(0,s().VK)((()=>Boolean(_.state&&_.state.questionId===(null==y?void 0:y.id))),[_,null==y?void 0:y.id]);return(0,i.useEffect)((()=>{var e,t;y&&(C&&("title"===(null===(e=_.state)||void 0===e?void 0:e.questionInputType)?st().selectAllTextMulti({environment:r,store:y.getNameStore(),canSelectAllBlocks:!1,contentEditableContextId:void 0}):"description"===(null===(t=_.state)||void 0===t?void 0:t.questionInputType)&&st().setSelectionAtEnd({store:y.getDescriptionStore()}),_.clear()))}),[_,r,C,y]),g?(0,H.jsx)(xt,{}):y&&f&&u&&b?(0,H.jsxs)("div",{ref:d,children:[(0,H.jsx)(bt,{formQuestionStore:y}),M?(0,H.jsx)(_t,{questionErrorState:M,propertyType:null==x?void 0:x.type}):(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(St,{formQuestionStore:y}),x&&(0,at().Ty)(x)&&(0,H.jsx)(Mt,{formQuestionStore:y,propertySchema:x}),(0,H.jsx)(mt().m,{store:b,property:f,disabled:!0,locked:!c,format:yt().C.FormEditor,blockPropertyValueOverlayStore:vt().Z,collectionStore:u,tableWrap:!1,formQuestionStore:y},f)]})]}):null}function xt(){const e=(0,l().yK)((e=>({questionTitleShimmer:{borderRadius:8,height:22,width:200},questionInputShimmer:{borderRadius:5,height:16,width:"100%",marginTop:12}})),[]);return(0,H.jsxs)("div",{children:[(0,H.jsx)(gt().Z,{style:e.questionTitleShimmer}),(0,H.jsx)(gt().Z,{style:e.questionInputShimmer})]})}function bt(e){let{formQuestionStore:t}=e;const o=(0,n().O7)(),r=(0,S().Y$)(),{collectionStore:l}=(0,h().Y)(),{canEditLayout:a}=(0,V().J9)(),d=(0,s().Kw)(r.normalizedSchemaStore),c=(0,i.useCallback)((()=>{(0,lt().maybeSyncQuestionNameToPropertyName)({environment:o,questionStore:t,collectionStore:l,collectionContextStore:r})}),[r,l,o,t]),u=!a;return d&&l?(0,H.jsx)(ut().T,{formMode:"builder",disabled:u,onChange:c,formQuestionStore:t,hasSubmitted:!1}):null}function St(e){let{formQuestionStore:t}=e;const{canEditLayout:o}=(0,V().J9)(),r=!o;return(0,H.jsx)(dt().e,{disabled:r,formQuestionStore:t,formMode:"builder"})}function Mt(e){return(0,H.jsx)(ct().Z,{...e,formMode:"builder"})}function _t(e){let{questionErrorState:t,propertyType:o}=e;const r=(0,l().yK)((e=>({helpIcon:{width:16,marginLeft:6,fill:e.icon.secondary},container:{display:"flex",flexDirection:"row",alignItems:"center",paddingLeft:8},textSpan:{color:e.text.tertiary}})),[]),n=(0,i.useMemo)((()=>{switch(t){case"deleted_property":return(0,H.jsx)(m()._H,{id:"BrokenLinkedPropertyWarning.deletedProperty",defaultMessage:"This question's corresponding property has been deleted."});case"invalid_property_type":return(0,H.jsx)(m()._H,{id:"BrokenLinkedPropertyWarning.invalidProperty",defaultMessage:"This question's corresponding property is not supported."});case"invalid_property_type_for_public_form":return"person"===o?(0,H.jsx)(m()._H,{id:"BrokenLinkedPropertyWarning.invalidPublicProperty.person",defaultMessage:"Person property is not supported in public forms."}):(0,H.jsx)(m()._H,{id:"BrokenLinkedPropertyWarning.invalidPublicProperty.generic",defaultMessage:"This question's linked property type is not supported in public forms."});case"related_collection_not_public":return(0,H.jsx)(m()._H,{...at().hW.relatedCollectionNotPublic});case"generic_error":return(0,H.jsx)(m()._H,{id:"BrokenLinkedPropertyWarning.message",defaultMessage:"Something is wrong with this linked property."})}}),[o,t]),s=(0,i.useMemo)((()=>{switch(t){case"deleted_property":return(0,H.jsx)(m()._H,{id:"BrokenLinkedPropertyWarning.deletedProperty.helperTooltip",defaultMessage:"Delete this question or link it to a different property."});case"invalid_property_type":return(0,H.jsx)(m()._H,{id:"BrokenLinkedPropertyWarning.invalidProperty.helperTooltip",defaultMessage:"Change the question type to a supported type"});case"generic_error":return(0,H.jsx)(m()._H,{id:"BrokenLinkedPropertyWarning.genericError.helperTooltip",defaultMessage:"Delete this question or link it to a different property."})}}),[t]);return(0,H.jsxs)("div",{style:r.container,children:[(0,H.jsx)("span",{style:r.textSpan,children:n}),(0,H.jsx)(pe().Z,{renderTooltip:()=>(0,H.jsx)("div",{style:{width:240,whiteSpace:"pre-wrap"},children:s}),disableTooltip:"invalid_property_type_for_public_form"===t||"related_collection_not_public"===t,render:e=>"invalid_property_type_for_public_form"===t||"related_collection_not_public"===t?null:(0,H.jsx)("div",{...e,children:(0,ft().m)(r.helpIcon)})})]})}var Ct=()=>o(192665),wt=()=>o(725858),jt=()=>o(279080),Tt=()=>o(133049),It=()=>o(780814),kt=(o(228244),()=>o(455947)),Pt=()=>o(139224),Bt=()=>o(922646),Ft=()=>o(119891),Vt=()=>o(92175),Ht=()=>o(652809),At=()=>o(642966),Kt=()=>o(280977);function Lt(e){const{parentModule:t}=e,o=(0,s().VK)((()=>t.conditionalGroups),[t]);return o?(0,H.jsx)(H.Fragment,{children:o.map((e=>(0,H.jsx)(Et,{conditionalGroup:e,parentModule:t},e.id)))}):null}function Et(e){const{conditionalGroup:t,parentModule:o}=e,{setModuleSelection:r,canEditLayout:n,layoutStore:l}=(0,V().J9)(),a=(0,i.useMemo)((()=>new(Kt().Z)),[]),d=(0,s().VK)((()=>{var e;const r=null===(e=o.conditionalGroups)||void 0===e?void 0:e.find((e=>e.id===t.id));return r?r.children??[]:[]}),[t,o]),c=(0,i.useCallback)((e=>(0,H.jsx)("div",{children:(0,H.jsx)($t,{pageModuleId:e,style:{marginTop:24},area:"form_conditional_modules"})},e)),[]),u=(0,s().VK)((()=>{const e=l.getModules().form_conditional_modules;if(!e)return!0;return d.some((t=>"formQuestion"===e[t].type))}),[d,l]),p=(0,i.useCallback)((e=>{}),[]),m=(0,i.useCallback)(((e,t)=>{let{key:o,endPosition:r,startPosition:i}=t}),[]),y=(0,i.useCallback)((()=>{}),[]),g=(0,i.useCallback)((e=>{}),[]),f=(0,i.useCallback)((e=>{e&&r({type:"existing_module",moduleId:e,isDragging:!1})}),[r]);return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(Zt,{parentModule:o,groupId:t.id,trigger:t.trigger}),(0,H.jsx)(Ft().ZP,{className:et().Vc,store:a,keys:d,direction:"vertical",onDraggingKeyChanged:p,onDrop:(e,t)=>{m(e,t)},onDragCancel:y,onDragEnd:g,onClick:f,style:{marginLeft:45,marginTop:-12},renderKey:c,disabled:!n}),u&&(0,H.jsx)(Rt,{parentModuleId:o.id,parentConditionalGroupId:t.id})]})}function Zt(e){const{groupId:t,trigger:o,parentModule:r}=e,a=(0,m().YB)(),d=(0,n().O7)(),{layoutStore:c}=(0,V().J9)(),[u,p]=(0,i.useState)(!1),y=(0,s().VK)((()=>{const e=o.filter,t=(0,kt().a_)(e)?e.subfilter:e;if(!(0,kt().vR)(t))return null;if((0,kt().dx)(t)||(0,kt().NU)(t)){const e=(0,kt().dx)(t)?(0,kt().mg)(t):(0,kt().qC)(t);return 1!==e.length?null:e[0].value}return null}),[o]),g=(0,i.useMemo)((()=>u),[u]),f=(0,i.useCallback)((()=>{p(!0)}),[]),v=(0,i.useCallback)((()=>{p(!1)}),[]),h=(0,i.useCallback)((()=>{Bt().yY({environment:d,parentModule:r,layoutStore:c,groupId:t})}),[d,r,t,c]),x=(0,l().yK)((e=>({indentedBranchContainer:{marginLeft:45,marginTop:16,display:"flex",alignItems:"center",justifyContent:"space-between"},triggerText:{color:e.text.uiBlueSecondary},triggerOption:{color:e.text.uiBluePrimary},deleteIcon:{width:20,height:20}})),[]),b=(0,i.useMemo)((()=>(0,kt().dx)(o.filter)||(0,kt().NU)(o.filter)?(0,H.jsx)(m()._H,{defaultMessage:"If <a>{filterValue}</a> is selected",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.IfFilterValueIsSelected",values:{a:e=>(0,H.jsx)("span",{style:x.triggerOption,children:e}),filterValue:y}}):(0,kt().XA)(o.filter)?(0,H.jsx)(m()._H,{defaultMessage:"If <a>checked</a>",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.IfCheckboxIsChecked",values:{a:e=>(0,H.jsx)("span",{style:x.triggerOption,children:e})}}):null),[o,y,x.triggerOption]);return(0,H.jsxs)("div",{style:x.indentedBranchContainer,onMouseMove:f,onMouseLeave:v,children:[(0,H.jsx)("span",{style:x.triggerText,children:b}),g&&(0,H.jsx)(ae().Z,{style:x.deleteIcon,isBlue:!0,onClick:h,icon:xe().y,ariaLabel:a.formatMessage({defaultMessage:"Delete condition",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.DeleteIcon.title"})})]})}function Dt(){const e=(0,l().yK)((e=>({container:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",height:"100%",gap:8,color:e.text.uiBluePrimary}})),[]);return(0,H.jsxs)("div",{style:e.container,children:[(0,Ht().e)({height:16,width:16}),(0,H.jsx)("span",{children:(0,H.jsx)(m()._H,{defaultMessage:"Add or select questions",id:"FormConditionalLogicModuleRenderer.NestedPlaceholderModuleTitle"})})]})}function Rt(e){const{parentModuleId:t,parentConditionalGroupId:o}=e,r=(0,S().Y$)(),n=(0,i.useRef)(null),a=(0,s().VK)((()=>{const e=(0,At().n)(r.settingsStore);return"formQuestionCreateSettings"===(null==e?void 0:e.type)&&r.settingsStore.state.ref===n}),[r.settingsStore,n]),d=(0,l().yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"center",width:"100%",marginTop:12,cursor:"pointer"},buttonStyle:{width:"35%",color:a?e.text.uiBluePrimary:e.text.uiBlueSecondary,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:8},hoveredStyle:{background:void 0,color:e.text.uiBluePrimary},pressedStyle:{background:void 0,color:e.text.uiBluePrimary}})),[a]),c=(0,i.useCallback)((()=>{Pt().r$({collectionContextStore:r,collectionSettingsStore:r.settingsStore,ref:n}),Pt().FK({collectionSettingsStore:r.settingsStore,item:{type:"formQuestionCreateSettings",area:"form_conditional_modules",parentModuleId:t,parentConditionalGroupId:o},ref:n})}),[r,n,t,o]);return(0,H.jsx)("div",{style:d.container,ref:n,children:(0,H.jsxs)(Vt().Z,{onClick:c,onMouseDown:e=>{(0,R().ZP)({event:e,context:R().Af.EditorMouseDown})},style:d.buttonStyle,hoveredStyle:d.hoveredStyle,pressedStyle:d.pressedStyle,children:[(0,Ht().e)({height:16,width:16}),(0,H.jsx)("span",{children:(0,H.jsx)(m()._H,{defaultMessage:"Add more questions",id:"FormConditionalLogicModuleRenderer.NestedAddMoreQuestionsButton"})})]})})}const Ot={transcript:!0,bottomControls:!0,expandedBacklinks:!0,inlinePageSections:!0},qt={editor:!0,discussions:!0};function Qt(e,t){if(null!=t&&t.isLayoutViewModuleEnabled&&("editor"===e.type||"viewsMain"===e.type))return{minHeight:"500px"}}const Gt="16px",Nt=o(263184).default.createValue(!1,{name:"HEADER_FOCUS_STORE"});function $t(e){let{pageModuleId:t,active:o=!1,isDragging:r=!1,area:n,style:l}=e;const{layoutStore:a}=(0,V().J9)(),d=(0,s().VK)((()=>null==a?void 0:a.getModuleById(t)),[a,t]),c=(0,_().E)("layout_view_module"),m=(0,_().E)("layout_view_module_next"),y=(0,s().VK)((()=>!!d&&(0,u().s)(d,{isLayoutViewModuleEnabled:c,isLayoutViewModuleNextEnabled:m})),[d,c,m]),g=(0,s().VK)((()=>{var e;return null===(e=a.getModel())||void 0===e?void 0:e.getLayoutType()}),[a]),f=(0,s().VK)((()=>!!d&&(("form"!==g||"placeholder"!==d.type)&&(0,p().x)(d))),[g,d]),v=(0,i.useMemo)((()=>({isSelected:o,isDragging:r,isConfigurable:y,isDraggable:f})),[o,r,y,f]);return d?(0,H.jsx)(Xe,{value:v,children:"form"===g?(0,H.jsx)(zt,{pageModule:d,style:l}):(0,H.jsx)(Wt,{pageModule:d,style:l,area:n})}):null}const Wt=i.memo(Yt);function Yt(e){let{pageModule:t,style:r,area:a}=e;const{pageStore:d}=(0,V().PP)(),u=(0,s().VK)((()=>d.hasCover()),[d]),p=(0,c().cm)(t).type,m=t.type,y=(0,_().E)("layout_view_module"),v=(0,n().O7)(),h=(0,s().VK)((()=>(0,o(138196).Z)({environment:v,store:d,pageViewBlockStore:void 0})),[v,d]),x=(0,l().yK)((()=>{return{wrapper:{...Qt(t,{isLayoutViewModuleEnabled:y}),opacity:(e=t,o={isLayoutViewModuleEnabled:y},null!=o&&o.isLayoutViewModuleEnabled&&"editor"===e.type||!0!==(null==qt?void 0:qt[e.type])?void 0:"33%"),marginTop:u&&"normalizedTitleWithIcon"===m?"-50px":void 0,...r}};var e,o}),[u,t,m,y,r]),b=(0,i.useCallback)((e=>(0,H.jsx)(rt,{module:t,style:x.wrapper,area:a,children:e})),[t,x.wrapper,a]);if(Ot[p])return null;switch(m){case"cover":return(0,H.jsx)(Jt,{wrapper:b,pageStore:d,isEditable:!1},`${t.id}-${d.id}`);case"properties":return(0,H.jsx)(ro,{pageStore:d,wrapper:b,pageModule:t},`${t.id}-${d.id}`);case"viewsMain":case"views":return(0,H.jsx)(A,{wrapper:b,viewsModule:t},`${t.id}-${d.id}`);case"property_title":case"property_text":case"property_url":case"property_email":case"property_phone_number":case"property_checkbox":case"property_person":case"property_created_by":case"property_last_edited_by":case"property_file":case"property_select":case"property_multi_select":case"property_status":case"property_number":case"property_date":case"property_created_time":case"property_last_edited_time":case"property_last_visited_time":case"property_formula":case"property_relation":case"property_rollup":case"property_button":case"property_auto_increment_id":case"property_location":case"property_verification":return(0,H.jsx)(o(965631)._,{propertyId:t.propertyId,context:j().S.Frame,disabled:!0,store:d,pageModule:t,wrapper:b,stackPropertyLabelAndValue:!0},`${t.id}-${d.id}`);case"normalizedTitleWithIcon":return(0,H.jsx)(Xt,{wrapper:b,module:t},`${t.id}-${d.id}`);case"editor":return(0,H.jsx)(o(618827).H,{context:j().S.Frame,disabled:!0,handlePlaceholderWrapClick:g().ZT,pageBlockStore:d,editorWrapper:b},`${t.id}-${d.id}`);case"discussions":return(0,H.jsx)(o(293936).s,{store:d,wrapper:b,showDefaultTitle:!0,discussionLocation:"page_discussion",pageDiscussionsRenderState:h},`${t.id}-${d.id}`);case"inlinePageSections":return(0,H.jsx)(eo,{wrapper:b},`${t.id}-${d.id}`);case"relationsGroup":return(0,H.jsx)(o(305128).T,{pageStore:d,wrapper:b,disabled:!0,context:j().S.Frame,showDefaultTitle:!0});case"transcript":case"bottomControls":case"expandedBacklinks":case"deleted_property":return null;case"formQuestion":case"formTitle":case"formSubmit":case"placeholder":throw new Error(`Cannot render ${m} in page layout editor.`);default:(0,f().t1)(m)}}function zt(e){let{pageModule:t,style:o}=e;const n=(0,c().cm)(t).type,{layoutStore:a,canEditLayout:d}=(0,V().J9)(),{formBlockStore:u,headerFocusStore:p,headerMouseStore:m}=(0,h().Y)(),g=(0,S().Y$)(),v=(0,s().VK)((()=>g.permissionScopesStore.state.canConfigureCollection),[g.permissionScopesStore]),x=(0,i.useCallback)((()=>{m.setState({...m.state,mouseEntered:!0})}),[m]),b=(0,i.useCallback)((()=>{m.setState({...m.state,mouseEntered:!1})}),[m]),M=(0,s().VK)((()=>{var e;const t=null===(e=g.collectionViewBlockStore())||void 0===e?void 0:e.getParentBlockStore();return null==t?void 0:t.getFormatStore().getKeyStore("block_color").getValue()}),[g]),_=(0,s().VK)((()=>"formQuestion"===t.type&&t.conditionalGroups&&t.conditionalGroups.length>0),[t]),C=(0,s().VK)((()=>{var e;return void 0!==(null===(e=a.getModules().form_conditional_modules)||void 0===e?void 0:e[t.id])}),[a,t]),w=(0,l().yK)((e=>({formTitleWrapper:{background:M?(0,y().x7)(M,e).background:void 0}})),[M]);if(Ot[n])return null;const j=e=>(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(rt,{module:t,style:o,area:C?"form_conditional_modules":"form_layout_schema",children:e}),_&&"formQuestion"===t.type&&(0,H.jsx)(Lt,{parentModule:t})]}),T=t.type;switch(T){case"formTitle":return j((0,H.jsxs)("div",{style:w.formTitleWrapper,children:[(0,H.jsx)("div",{style:{paddingLeft:Gt},children:(0,H.jsx)(Ct().vw,{formBlockStore:u,disabled:!d,formMode:"builder",headerFocusStore:p,onHeaderMouseEnter:x,onHeaderMouseLeave:b})}),(0,H.jsx)(Ct().Tr,{collectionContextStore:g,formBlockStore:u})]}));case"formQuestion":return j((0,H.jsx)(ht,{layoutStore:a,formQuestionId:t.formQuestionId}));case"formSubmit":return null;case"placeholder":return j((0,H.jsx)(r().E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:C?72:36},transition:{duration:.2},children:C&&(0,H.jsx)(Dt,{})},"placeholderModule"));case"cover":return(0,H.jsx)(Jt,{wrapper:j,pageStore:u,isEditable:v},t.id);case"property_title":case"property_text":case"property_url":case"property_email":case"property_phone_number":case"property_checkbox":case"property_person":case"property_created_by":case"property_last_edited_by":case"property_file":case"property_select":case"property_multi_select":case"property_status":case"property_number":case"property_date":case"property_created_time":case"property_last_edited_time":case"property_last_visited_time":case"property_formula":case"property_relation":case"property_rollup":case"property_button":case"property_auto_increment_id":case"property_location":case"property_verification":case"normalizedTitleWithIcon":case"inlinePageSections":case"expandedBacklinks":case"discussions":case"bottomControls":case"editor":case"transcript":case"properties":case"views":case"viewsMain":case"relationsGroup":case"deleted_property":throw new Error("Cannot render these modules in a form.");default:(0,f().t1)(T)}}const Ut=160;function Jt(e){const{wrapper:t,pageStore:o,isEditable:r}=e;return(0,s().VK)((()=>o.hasCover()),[o])?t((0,H.jsx)(jt().D,{store:o,isEditable:r,onMouseEnter:g().ZT,onMouseLeave:g().ZT,paddingX:0,pageCoverHeight:Ut})):(0,H.jsx)("div",{className:et().Vc,style:{height:0}})}function Xt(e){const{wrapper:t,module:o}=e,{pageStore:r,collectionStore:i}=(0,V().PP)(),n=(0,s().VK)((()=>i.getFormat()),[i]),l=(0,s().VK)((()=>r.hasCover()),[r]),{backlinksConfiguredToShowAboveTitle:a}=(0,I().Kr)({format:n}),d=a?(0,H.jsx)("div",{style:{marginTop:8},children:(0,H.jsx)(K().v,{pageStore:r,customization:{buttonIsLightGray:!0}})}):void 0,c=(0,S().Y$)(),u=o.propertyIds.length?(0,H.jsx)(Tt().V,{context:j().S.Frame,disabled:!0,store:r,variant:"pinned",layoutModule:void 0,propertyIds:o.propertyIds,wrapper:e=>(0,H.jsx)(et().Pb,{children:e})}):(0,H.jsx)(oo,{});return t((0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(It().J,{store:r,context:j().S.Frame,isEditable:!1,headerControls:d,hasCover:l,isInSidePeek:!1,headerFocusStore:Nt,openMenuOnMount:!1,openMenuOnMountCallback:g().ZT,disabled:!0,titlePlaceholder:void 0,collectionContextStore:c,shouldShowTemplatePicker:!1,onTitleChange:g().ZT,onTitleEditText:g().ZT,onTitleEsc:g().ZT,onTitleUntab:g().ZT,onTitleTab:g().ZT,handleHeaderMouseEnter:g().ZT,handleHeaderMouseLeave:g().ZT,isInPageLayoutModuleEditor:!0}),u]}))}function eo(e){const{pageStore:t}=(0,V().PP)(),o=(0,s().VK)((()=>t.getSchema()),[t]),r=(0,s().VK)((()=>(0,M().y6)(t)),[t]),i=(0,s().VK)((()=>{if(!r)return;return(r.collection_page_sections||[]).filter((e=>{const r=o[e.section];if(!r||"relation"!==r.type)return;const i=t.getPropertyValue(e.section),n=(0,a().j$)({relationValue:(0,a().rq)(i),propertySchema:r,getRecordModel:t.getRecordModel,includeDeleted:w().default.checkGate({gateName:"relations_show_deleted"}),includeInvalidCollection:w().default.checkGate({gateName:"relations_show_invalid_collection"}),includeNoAccess:w().default.checkGate({gateName:"relations_show_no_access"})}).length;return"inline"===e.visibility&&o[e.section]&&0!==n})).map((e=>e.section))}),[r,o,t]);return(i??[]).length>0?(0,H.jsx)(wt().bM,{context:j().S.Frame,disabled:!0,inlinePropertyIDs:i,store:t,wrapper:e.wrapper}):(0,H.jsx)(to,{text:"Inline page sections"})}function to(e){const t=(0,l().yK)((e=>({text:{fontSize:14,color:"light"===e.mode?e.accentColors.gray[500]:e.accentColors.gray[600]}})),[]);return(0,H.jsx)(et().Pb,{children:(0,H.jsxs)(b().gq,{children:[(0,H.jsx)("span",{style:t.text,children:e.text}),(0,H.jsx)(x().Z,{content:"Not enabled"})]})})}function oo(e){const t=(0,l().yK)((e=>({wrapper:{marginTop:8},pill:{display:"inline-flex",color:e.lightTextColor,padding:"4px 8px 4px 2px",fontSize:14,alignItems:"center",gap:4},icon:{width:16,height:16,fill:e.lightTextColor,display:"inline-block",flexShrink:0}})),[]),o=(0,C()._)(t.icon);return(0,H.jsx)("div",{style:t.wrapper,children:(0,H.jsxs)("span",{style:t.pill,children:[o,(0,H.jsx)(m()._H,{id:"pageLayout.configurePinnedProperties.noPinnedPropertiesMessage",defaultMessage:"No properties pinned"})]})})}function ro(e){const{pageModule:t,pageStore:o,wrapper:r}=e,i=(0,n().O7)(),{layoutStore:a}=(0,V().J9)(),c=(0,l().yK)((e=>({empty:{color:e.lightTextColor,fontSize:v().JB.UIRegular.desktop,padding:"0 6px"}})),[]),u=(0,s().VK)((()=>{var e;const o=null==a||null===(e=a.getModel())||void 0===e?void 0:e.getRawPageModuleAreaById(t.id);if(o)return(0,d().Gc)(o)}),[a,t.id]),p=(0,s().VK)((()=>!(0,T().D)({environment:i,layoutArea:u,moduleType:t.type,pageViewBlockContext:j().S.Frame})),[i,u,t.type]);return(0,H.jsx)(Tt().V,{context:j().S.Frame,disabled:!0,store:o,wrapper:r,layoutModule:t,variant:t.variant,customization:{disableContainerPadding:!0,neverShowPropertiesElsewhereInLayout:!0,disableLastRowBottomPadding:!0,stackPropertyLabelAndValue:p,renderWhenCompletelyEmpty:()=>(0,H.jsx)("div",{style:c.empty,children:(0,H.jsx)(m()._H,{id:"pageLayout.emptyModule",defaultMessage:"Empty"})})},forceGroupsOpenOrClosed:"open"},`${t.id}-${o.id}`)}},192665:(e,t,o)=>{o.d(t,{Tr:()=>A,vw:()=>H});o(492176),o(7961);var r=o(667294),i=()=>o(219727),n=()=>o(142735),s=()=>o(846550),l=()=>o(955620),a=()=>o(788860),d=()=>o(661727),c=()=>o(513670),u=()=>o(707513),p=()=>o(641929),m=()=>o(281375),y=()=>o(469753),g=()=>o(512687),f=()=>o(92175),v=()=>o(441672),h=()=>o(857815),x=()=>o(628621),b=()=>o(254805),S=()=>o(275200),M=()=>o(345918),_=()=>o(168441),C=()=>o(472753),w=()=>o(876822),j=()=>o(311562),T=()=>o(18281),I=()=>o(30795),k=()=>o(897257),P=()=>o(780814),B=o(785893);function F(e){let{onAfterAddIconClick:t,disabled:o,formBlockStore:r}=e;const i=(0,n().VK)((()=>r.hasIcon()),[r]),s=(0,n().VK)((()=>r.hasCover()),[r]),l=o?(0,B.jsx)(B.Fragment,{}):(0,B.jsx)(V,{onAfterAddIconClick:t});return i&&s?null:(0,B.jsx)(v().Z,{store:r,context:j().S.Form,children:l})}function V(e){let{onAfterAddIconClick:t}=e;const{formBlockStore:o,headerFocusStore:r,headerMouseStore:s}=(0,p().Y)(),l=(0,i().Fy)(),d=(0,n().VK)((()=>{const e=s.state.mouseEntered||r.state;return(0,b().Te)(e)}),[r,s]),{hasIcon:c,hasCover:u}=(0,n().VK)((()=>({hasIcon:o.hasIcon(),hasCover:o.hasCover()})),[o]);return(0,B.jsxs)(B.Fragment,{children:[!c&&(0,B.jsx)(x().Z,{store:o,afterOnClick:t,style:d,label:l.isSmallPhone?(0,B.jsx)(a()._H,{id:"FormHeaderControls.iconMobile",defaultMessage:"Icon"}):(0,B.jsx)(a()._H,{id:"FormHeaderControls.icon",defaultMessage:"Form icon"})}),!u&&(0,B.jsx)(h().Z,{store:o,style:d,label:l.isSmallPhone?(0,B.jsx)(a()._H,{id:"FormHeaderControls.pageCoverMobile",defaultMessage:"Cover"}):(0,B.jsx)(a()._H,{id:"FormHeaderControls.pageCover",defaultMessage:"Form cover"})})]})}function H(e){let{formBlockStore:t,formMode:o,disabled:s,headerFocusStore:d,onHeaderMouseEnter:u,onHeaderMouseLeave:p,aliasStore:y,formBlockWidth:f}=e;const v=(0,a().YB)(),h=(0,i().Fy)(),[x,b]=(0,r.useState)(!1),S=(0,n().VK)((()=>null==t?void 0:t.getTitleStore()),[t]),{hasCoverImage:M,hasPageIcon:_,formDescriptionStore:C}=(0,n().VK)((()=>({hasCoverImage:Boolean(null==t?void 0:t.hasCover()),hasPageIcon:Boolean(null==t?void 0:t.hasIcon()),formDescriptionStore:t.getFormDescriptionStore()})),[t]),w=(0,n().VK)((()=>(0,l().PgY)(C.getValue())),[C]);if(!t||!S)return null;const T="viewer"===o&&h.isMobile&&_?12:0;let I=0;return"builder"===o?_&&M&&(I=12):y?(I=_||M?24:12,y&&"narrow"===f&&!h.isMobile&&(I-=g().$S)):I=_||M?24:48,(0,B.jsxs)("div",{style:{marginTop:T,marginLeft:"builder"===o?3:0},children:[(0,B.jsx)(P().J,{store:t,context:j().S.Form,isEditable:!s,headerControls:(0,B.jsx)(F,{onAfterAddIconClick:()=>b(!0),disabled:s,formBlockStore:t}),hasCover:M,isInSidePeek:!1,hideTitleIfEmpty:"viewer"===o,headerFocusStore:d,openMenuOnMount:x,openMenuOnMountCallback:()=>b(!1),disabled:s,titlePlaceholder:v.formatMessage({id:"formTitle.titlePlaceholder",defaultMessage:"Form title"}),collectionContextStore:void 0,shouldShowTemplatePicker:!1,onTitleChange:c().ZT,onTitleEditText:c().ZT,onTitleEsc:c().ZT,onTitleUntab:c().ZT,onTitleTab:c().ZT,onMoveUp:c().ZT,onMoveDown:c().ZT,handleHeaderMouseEnter:u,handleHeaderMouseLeave:p,disableEnter:!0,extraStyles:{fontSize:40,fontWeight:"bold",cursor:"text",marginTop:I}}),("builder"===o||!w)&&(0,B.jsx)("div",{style:{marginTop:16,marginLeft:3},children:(0,B.jsx)(m().Y,{store:C,disabled:s,placeholder:v.formatMessage({id:"FormTitle.description.placeholder",defaultMessage:"Description (optional)"}),style:{cursor:"text"}})})]})}function A(e){let{collectionContextStore:t,formBlockStore:o}=e;const r=(0,i().O7)(),{currentSpaceStore:l}=(0,n().Kw)(w().default),c=(0,n().VK)((()=>l?(0,M().rn)(r,l):""),[r,l]),{isFormPublic:p,isFormClosed:m}=(0,n().VK)((()=>({isFormPublic:o.getIsFormPublic(),isFormClosed:o.getIsFormClosed()})),[o]),g=(0,n().Kw)(k().subscriptionDataStoreInstance),v=(0,I().V)(g),h=(0,n().VK)((()=>!(null==l||!l.id)&&Boolean(g&&T().Ln(r,l.id,g,v))),[r,l,g,v]),x=(0,n().VK)((()=>h?"closed":(0,y().Nb)(p,m)),[p,m,h]),b=(0,n().VK)((()=>{const e=t.collectionViewBlockStore();return!!e&&e.canEditMembership()}),[t]),j=(0,s().yK)((e=>{const t=()=>{switch(x){case"shared_to_web":return{light:{color:e.accentColors.yellow[500],background:e.accentColors.yellow[50]},dark:{color:e.accentColors.yellow[600],background:e.accentColors.yellow[200]}};case"shared_to_space":return{light:{color:e.text.secondary,background:e.accentColors.gray[30]},dark:{color:e.text.secondary,background:e.accentColors.translucentGray[100]}};case"closed":return{light:{color:e.accentColors.red[500],background:e.accentColors.red[50]},dark:{color:e.accentColors.red[600],background:e.accentColors.red[200]}}}};return{container:{color:t()[e.mode].color,background:t()[e.mode].background,borderRadius:6,width:"100%",padding:"10px 22px",marginTop:24,fontSize:14,display:"flex",alignItems:"center"},lockIconContainer:{display:"flex",alignItems:"center"},changePermissionButton:{marginRight:-4,color:t()[e.mode].color,fontWeight:u().Ue.medium},changePermissionButtonHovered:{backgroundColor:(0,d().Fq)(t()[e.mode].color,.1)},changePermissionButtonPressed:{backgroundColor:(0,d().Fq)(t()[e.mode].color,.2)}}}),[x]),P=(0,y().xd)({formSharingState:x,spaceName:c,isOverBlockLimit:h});return(0,B.jsxs)("div",{style:j.container,children:[(0,B.jsx)("div",{style:{width:h?"100%":"90%",marginRight:10},children:(0,B.jsxs)("div",{style:j.lockIconContainer,children:[!m&&!p&&!h&&(0,_().Q)({width:14,height:14,marginRight:6,marginLeft:-2}),P]})}),!h&&b&&(0,B.jsx)(f().Z,{style:j.changePermissionButton,hoveredStyle:j.changePermissionButtonHovered,pressedStyle:j.changePermissionButtonPressed,onClick:()=>{var e,o;const r=null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.id,i=(null===(o=C().R.getMembersByDOMOrder({filter:e=>e.getBlockStore().id===r}).at(0))||void 0===o?void 0:o.getNode())??null;if(i instanceof Element){const e=t.isFullScreenStore.state?i:i.parentElement;(0,S().Wr)(e,{edgeDist:0,animate:!1})}t.formShareMenuButtonPopupStore.setState({...t.formShareMenuButtonPopupStore.state,open:!0})},children:(0,B.jsx)(a()._H,{id:"editorFormResponderWarning.changePermission",defaultMessage:"Change"})})]})}},294630:(e,t,o)=>{o.d(t,{O:()=>n});var r=()=>o(275200),i=()=>o(75433);function n(e){let{layoutStore:t,moduleId:o}=e;setTimeout((()=>{!function(e){let{layoutStore:t,moduleId:o}=e;const n=i().Z.findModuleContainer({layoutStore:t,moduleId:o}),s=null==n?void 0:n.getNode();s&&(0,r().n5)({element:s,additionalPadding:{top:100,bottom:100}})}({layoutStore:t,moduleId:o})}),100)}},243144:(e,t,o)=>{o.d(t,{F:()=>i});var r=()=>o(846550);function i(){return(0,r().yK)((e=>({button:{background:"light"===e.mode?e.accentColors.uiBlue[100]:e.accentColors.uiBlue[200]},buttonHovered:{background:"light"===e.mode?e.accentColors.uiBlue[200]:e.accentColors.uiBlue[300]},buttonPressed:{background:"light"===e.mode?e.accentColors.uiBlue[300]:e.accentColors.uiBlue[400]}})),[])}},602801:(e,t,o)=>{o.d(t,{j:()=>n});var r=()=>o(142735),i=()=>o(162178);function n(){const{layoutStore:e}=(0,i().J9)();return"form"===(0,r().VK)((()=>{var t;return null===(t=e.getModel())||void 0===t?void 0:t.getLayoutType()}),[e])?24:12}},75433:(e,t,o)=>{o.d(t,{Z:()=>i});o(267602),o(470928);class r extends(()=>o(442))().Z{findModuleContainer(e){let{layoutStore:t,moduleId:o}=e;return this.find((e=>e.layoutStore===t&&e.moduleId===o))}}const i=new r},807071:(e,t,o)=>{o.d(t,{Z:()=>s});var r=()=>o(532850),i=()=>o(955620);class n extends(()=>o(263184))().default{getInitialState(){return{isLoaded:!1}}getFormState(){if(this.state.isLoaded)return this.state}getQuestionError(e){if(this.state.isLoaded)return this.state.formQuestionErrorMap.get(e)}updateFormState(e){this.state.isLoaded&&this.setState({...this.state,...e})}updateFilePropertyIdToFormFiles(e,t){var o;if(!this.state.isLoaded)return;const r=null===(o=this.getFormState())||void 0===o?void 0:o.filePropertyIdToFormFiles;this.updateFormState({filePropertyIdToFormFiles:{...r,[e]:t((null==r?void 0:r[e])??[])}})}updateFormErrorMap(e){if(!this.state.isLoaded)return;const t=this.state.collectionSchema;if(!t)return;const n=new Map,s=this.state.formQuestionStores;for(const c of s??[]){var l,a;const s=c.id,u=null===(l=c.getConfig())||void 0===l?void 0:l.propertyId;if(!u)continue;const p=null===(a=this.state.draftFormBlockStore)||void 0===a?void 0:a.getProperties()[u],m=(0,r().Qm)({schema:t,property:u});if(m){if(c.isRequired()&&this.state.hasAttemptedFormSubmission){const e=this.state.filePropertyIdToFormFiles;if("file"===m.type){var d;if(((null===(d=e[u])||void 0===d?void 0:d.length)??0)<1){n.set(s,"required");continue}}else if("checkbox"===m.type){if(!0!==(0,r().Ml)(p)){n.set(s,"required");continue}}else if((0,i().PgY)(p)){n.set(s,"required");continue}}if(!(0,i().PgY)(p)){const t=(0,i().QaF)(p);if("number"===m.type&&!(0,o(114079).kE)(t,e)){n.set(s,"invalid_number");continue}if("email"===m.type&&!(0,o(446866).oH)(t)){n.set(s,"invalid_email");continue}if("url"===m.type&&!(0,o(994085).m)(t)){n.set(s,"invalid_url");continue}if("phone_number"===m.type&&!(0,o(981850).E)(t)){n.set(s,"invalid_phone_number");continue}}}}this.updateFormState({formQuestionErrorMap:n})}}const s=n},686674:(e,t,o)=>{o.d(t,{Z:()=>i});class r extends(()=>o(263184))().default{getInitialState(){return{open:!1}}}const i=new r},66006:(e,t,o)=>{o.d(t,{E:()=>n,K:()=>i});var r=()=>o(696459);function i(e){switch(e){case"page_in_collection":return!1;case"form":return!0;default:return(0,r().P)(e),!1}}function n(e){switch(e){case"page_in_collection":return!0;case"form":return!1;default:return(0,r().P)(e),!1}}},981850:(e,t,o)=>{function r(e){return/^(\+\d{1,2}[\s.-])?\(?\d{3}\)?[\s.-]\d{3}[\s.-]\d{4}$/.test(e)}function i(e){return/^[0-9 .()\-\+]{7,}$/.test(e)}o.d(t,{E:()=>i,x:()=>r})}}]);