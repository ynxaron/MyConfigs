"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[80582],{230348:(e,t,o)=>{o.d(t,{P:()=>m,w:()=>p});o(821057),o(267602),o(653476);var i=()=>o(156642),n=()=>o(715228),a=()=>o(396136),r=()=>o(139978),l=()=>o(525038),s=()=>o(636340),c=()=>o(205228),d=()=>o(872308),u=()=>o(876822);function m(e){const{environment:t,collectionViewStore:o,parentCollectionViewBlockStore:l,transaction:c,filter:d,inMemoryRecordCache:m,sort:p,semanticQuery:g,assistantChatSessionId:h}=e,v=u().default.state.currentSpaceStore,f=u().default.state.currentSpaceViewStore;if(!v||!f)throw new Error("No current space or space view.");const w=t.currentUser.id;if(!w)throw new Error("User is not logged in.");const b=s().j4({environment:t,type:i().Ti.collectionViewPage,inMemoryRecordCache:v.inMemoryRecordCache,transaction:c,spaceId:v.id,permissions:[{type:"user_permission",user_id:w,role:"editor"}]}),y={type:"table",parent_id:b.id,parent_table:a().iU,alive:!0,space_id:v.id,format:{table_properties:o.getFormat().table_properties,timeline_arrows_by:void 0,subitem_display_mode:"hidden",table_subitem_toggle_column:"title",is_unlisted:!0,collection_pointer:o.getFormat().collection_pointer??l.getCollectionPointer(),...g?{is_unlisted_from_semantic_query:{is_from_semantic_query:!0,query:g}}:{is_unlisted_from_semantic_query:{is_from_semantic_query:!1}}},query2:{filter:d,sort:p}},S=s().ae({environment:t,table:r().np,value:y,inMemoryRecordCache:m,transaction:c});return s().sW({store:b,data:{parent_id:h,parent_table:n().t_,alive:!0,view_ids:[S.id]},transaction:c}),{collectionViewStore:S,linkedDatabaseCollectionBlockStore:b}}async function p(e){const{environment:t,transaction:o,acceptMoveToArgs:i,linkedDatabaseBlockStore:n}=e,[[a],r]=d().duplicateBlock({environment:t,stores:[n],transaction:o,resolveTemplateVariables:!1,targetSpaceId:n.getSpaceId(),baseUrl:c().default.domainBaseUrl,publicDomainName:c().default.publicDomainName,preferDuplicateLocation:"local",addCopyName:!1,deepCopyTransclusionContainers:!0});s().sW({store:a,data:{alive:!0},transaction:o});for(const l of a.getCollectionViewStores())s().sW({store:l.getFormatStore(),data:{is_unlisted:null,is_unlisted_from_semantic_query:null},transaction:o});return await l().RL({...i,targets:[a],transaction:o}),a}},918745:(e,t,o)=>{o.d(t,{F:()=>l,U:()=>r});var i=()=>o(219727),n=()=>o(142735),a=()=>o(352230);function r(e){return e.device.isPhone||"actionSheet"===e.tabletBehavior&&e.device.isTablet?{menuType:a().o.ActionSheet}:{menuType:a().o.Popup,maxHeight:e.maxHeight,maxWidth:e.maxWidth,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,width:e.width,minWidth:e.minWidth}}function l(e){const t=(0,i().Fy)();return(0,n().VK)((()=>r({device:t,maxHeight:null==e?void 0:e.maxHeight,maxWidth:null==e?void 0:e.maxWidth,paddingTop:null==e?void 0:e.paddingTop,paddingBottom:null==e?void 0:e.paddingBottom,width:null==e?void 0:e.width,minWidth:null==e?void 0:e.minWidth,tabletBehavior:null==e?void 0:e.tabletBehavior})),[t,null==e?void 0:e.maxHeight,null==e?void 0:e.maxWidth,null==e?void 0:e.paddingTop,null==e?void 0:e.paddingBottom,null==e?void 0:e.width,null==e?void 0:e.minWidth,null==e?void 0:e.tabletBehavior])}},676279:(e,t,o)=>{o.d(t,{d:()=>r});var i=()=>o(219727),n=()=>o(142735),a=()=>o(967092);function r(e){const t=(0,i().Fy)();return(0,n().VK)((()=>t.isPhone||"slideUp"===(null==e?void 0:e.tabletBehavior)&&t.isTablet?a().kQ.SlideUp:a().kQ.Popup),[t,null==e?void 0:e.tabletBehavior])}},714144:(e,t,o)=>{o.r(t),o.d(t,{default:()=>R});var i=o(667294),n=()=>o(219727),a=()=>o(142735),r=()=>o(846550),l=()=>o(506347),s=()=>o(788860),c=()=>o(513670),d=()=>o(696459),u=()=>o(525038),m=()=>o(497065),p=()=>o(269299),g=()=>o(650996),h=()=>o(230348),v=()=>o(918745),f=()=>o(676279),w=()=>o(717245),b=()=>o(429725),y=()=>o(338217),S=()=>o(314379),_=()=>o(521777),C=()=>o(128119),x=()=>o(827973),k=()=>o(1910),B=()=>o(198829),V=()=>o(255577),T=()=>o(967092),I=()=>o(943620),A=()=>o(384241),W=()=>o(388284),H=()=>o(887330),M=o(785893);const j=(0,s().vU)({moreButtonAriaLabel:{id:"unlistedCollectionView.moreButton.icon",defaultMessage:"More"}});function R(e){const{collectionContextStore:t,shouldHideSaveViewOption:o}=e,n=(0,s().YB)(),l=i.useRef(null),[c,d]=i.useState(!1),u=(0,a().Kw)(t.isInHomeWidgetStore),m=i.useCallback((()=>{d(!c)}),[c]),p=(0,f().d)(),g=(0,r().yK)((e=>({icon:{height:3,width:void 0,fill:e.mediumIconColor},button:(0,H().C)({theme:e,isInHomeWidget:u})})),[u]);return(0,M.jsx)(T().ZP,{popupType:p,alignmentToOrigin:C().lU.Center,placementToOrigin:C().Iw.Bottom,open:c,onDismiss:m,origin:(0,M.jsx)(k().Z,{ref:l,icon:S().o,ariaLabel:n.formatMessage(j.moreButtonAriaLabel),onClick:m,iconStyle:g.icon,style:g.button}),render:()=>{var e;return(0,M.jsx)(P,{collectionContextStore:t,originRect:null===(e=l.current)||void 0===e?void 0:e.getBoundingClientRect(),shouldHideSaveViewOption:o})}})}function P(e){const{collectionContextStore:t,originRect:o,shouldHideSaveViewOption:a}=e,r=(0,n().O7)(),[l,s]=i.useState("origin"),c=i.useCallback((()=>{s("copy");const e=t.collectionViewBlockStore();e&&u().bA({environment:r,blocks:[e],originRect:o,moveToContext:"ai_ephemeral_view",isAddTo:!0,isDefaultPrivateLocation:!0,forceShowPrivatePageOption:!0,dontCommitActions:!0,onAccept:async t=>{const{performResult:o}=await p().createAndCommitAsync({environment:r,userAction:"UnlistedCollectionViewMoreButton.handleAddViewToMenuClick",waitForServerCommit:!0,perform:o=>(0,h().w)({environment:r,transaction:o,linkedDatabaseBlockStore:e,acceptMoveToArgs:t})});await F({environment:r,blockStore:o})}})}),[r,o,t]);return"origin"===l?(0,M.jsx)(U,{collectionContextStore:t,onAddViewToClick:c,shouldHideSaveViewOption:a}):"copy"===l?null:(0,d().t1)(l)}function U(e){const{collectionContextStore:t,onAddViewToClick:o,shouldHideSaveViewOption:i}=e,{isMobile:l}=(0,n().Fy)(),d=(0,n().O7)(),u=(0,a().VK)((()=>t.collectionStore()),[t]),m=(0,a().VK)((()=>null==u?void 0:u.getIcon()),[u]),p=(0,a().VK)((()=>{var e;return null==u||null===(e=u.getParentBlockStore())||void 0===e?void 0:e.getNavigableBlockStore()}),[u]),g=(0,r().yK)((e=>({icon:{color:e.regularIconColor,width:16,height:16},title:{display:"flex",alignItems:"center"},collectionIcon:{marginLeft:4,marginRight:2}})),[]),h=(0,v().F)({maxWidth:250}),f=[i?void 0:{key:"save",render:e=>(0,M.jsx)(x().Z,{...e,icon:(0,_().R)(g.icon),title:(0,M.jsx)(s()._H,{id:"unlistedCollectionView.moreButton.save",defaultMessage:"Save as view inâ€¦"})}),action:()=>{o()}},p?{key:"open",render:e=>(0,M.jsx)(x().Z,{...e,icon:(0,y().J)(g.icon),title:(0,M.jsx)("div",{style:g.title,children:(0,M.jsx)(s()._H,{id:"unlistedCollectionView.moreButton.open",defaultMessage:"Open {databaseName}",values:{databaseName:(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(I().Z,{isEmptyPage:!1,size:l?18:16,disabled:!0,icon:m,style:g.collectionIcon}),u&&(0,M.jsx)(A().Z,{store:u})]})}})})}),action:()=>{F({environment:d,blockStore:p})}}:void 0],w={key:"options",render:e=>(0,M.jsx)(W().Z,{...e}),items:c().oA(f)};return(0,M.jsx)(B().Z,{...h,children:(0,M.jsx)(V().Z,{type:V().i.Vertical,initialFocus:0,sections:[w]})})}async function F(e){const{environment:t,blockStore:o}=e;if(!o)return;const i=(0,b().ZP)({store:o,pageVisitSource:l().tY.AIEphemeralView});m().c4({environment:t,url:i});const{assistantMenuActions:n}=await g().assistantDependency.load();w().M.close(),await n.closeAssistantRightHandSideMenu({environment:t})}},887330:(e,t,o)=>{o.d(t,{C:()=>n,L:()=>a});var i=()=>o(707513);function n(e){const{theme:t,isInHomeWidget:o}=e;return{display:"flex",alignItems:"center",fontSize:14,padding:6,...o?{height:24,width:24,color:t.lightTextColor,fill:t.lightIconColor}:{height:28,width:28,color:t.mediumIconColor,fill:t.mediumIconColor},fontWeight:i().Ue.regular,lineHeight:1,borderRadius:6}}function a(e){const{theme:t}=e;return{display:"flex",alignItems:"center",fontSize:14,height:28,padding:6,color:t.mediumIconColor,fontWeight:i().Ue.regular,lineHeight:1,borderRadius:4}}}}]);