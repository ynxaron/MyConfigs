"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[18700],{900596:(e,t,o)=>{o.d(t,{Z:()=>r});o(667294);var i=()=>o(788860),n=o(785893);const r=function(e){let{collectionViewName:t,collectionViewType:r}=e;return t?(0,n.jsx)(o(827618).Z,{children:t}):"page"===r?(0,n.jsx)(i()._H,{id:"database.collectionView.untitledName.untitled",defaultMessage:"Untitled"}):(0,n.jsx)(i()._H,{...o(887430).b1[r]})}},468754:(e,t,o)=>{o.d(t,{Z:()=>w});o(267602),o(653476),o(241792);var i=o(667294),n=()=>o(219727),r=()=>o(142735),a=()=>o(846550),l=()=>o(490670),s=()=>o(993407),d=()=>o(788860),c=()=>o(239730),u=()=>o(711608),p=()=>o(986286),m=()=>o(945634),g=()=>o(247724),y=()=>o(906591),f=()=>o(876822),b=o(785893);const v=i.memo((e=>{const{disabled:t,childStores:a,areChildrenLoading:l,itemDepth:d,type:u}=e,m=(0,n().O7)(),v=(0,r().VK)((()=>f().default.state.mainEditorCurrentBlockStore),[]),C=(0,r().VK)((()=>(0,o(731322).wF)(f().default.state.currentUserSettingsStore,"jira-sync-onboarding")),[]),w=m.device,T=(0,i.useRef)(),j=(0,i.useRef)(),k=(0,r().Kw)(o(308939).ZP),V=(0,r().VK)((()=>{const e=(0,o(95718).wY)();if(k.showOnboardingTour){let e=null,r=null;for(const i of a){if(i.isCollectionView()){const n=i.getCollectionStore();if((null==v?void 0:v.id)===i.id){var t;const a=null===(t=i.getCollectionStore())||void 0===t?void 0:t.getFormat();if("notion://projects_collection"===(null==a?void 0:a.app_config_uri)||"notion://tasks_collection"===(null==a?void 0:a.app_config_uri)){const t=(0,o(148976).$s)(n);e=t.projectCollectionPointer,r=t.taskCollectionPointer;break}}}}for(const t of a){if(t.isCollectionView()){var i,n;const o=t.getCollectionStore();if(o&&(null==o?void 0:o.id)===(null===(i=e)||void 0===i?void 0:i.id)){T.current=t.id;continue}if(o&&o.id===(null===(n=r)||void 0===n?void 0:n.id)){j.current=t.id;continue}}}}return(0,o(696459).$K)(e)?a.filter((t=>!e.includes(t.id))):a}),[a,null==v?void 0:v.id,k.showOnboardingTour]).map(((t,o)=>{const n=i.createRef();return k.showOnboardingTour&&T.current===t.id&&"all-projects-tooltip"===C?(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{ref:n,style:{boxShadow:c().v.outlineBlueInputBoxShadow.light,borderRadius:6},children:(0,i.createElement)(I,{...e,key:t.id,store:t,index:o})}),(0,b.jsx)(p().YW,{origin:n})]},t.id):k.showOnboardingTour&&j.current===t.id&&"all-issues-tooltip"===C?(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{ref:n,style:{boxShadow:c().v.outlineBlueInputBoxShadow.light,borderRadius:6},children:(0,i.createElement)(I,{...e,key:t.id,store:t,index:o})}),(0,b.jsx)(p().lM,{origin:n})]},t.id):(0,i.createElement)(I,{...e,key:t.id,store:t,index:o})})),D=(0,r().VK)((()=>f().default.state.currentSpaceViewStore),[]),P=(0,r().VK)((()=>void 0!==D&&(0,y().Wu)({spaceViewStore:D})),[D]),M=(0,r().VK)((()=>(0,o(91502).ku)()&&!w.isMobile),[w]),K=0===d,_=0===(null==V?void 0:V.length),B=(_||e.isHeaderless||w.isMobile)&&K&&("private"===u||"workspace"===u)&&!t,Z=_&&!B&&!K&&!M,A={offline:g().blN,bookmarks:g().fe0,workspace:g().BEs,shared:g().JkF,private:g().q1J,team:g().l24,[s().PT]:void 0,[s().cz]:void 0,[s().mu]:void 0,[s().kg]:void 0,[s().g$]:void 0}[e.type];return(0,b.jsxs)(o(690122).Z,{id:e.id,"aria-labelledby":e["aria-labelledby"],role:K?"tree":"group",style:e.style,innerStyle:{display:"flex",flexDirection:"column",gap:1},className:A,loaded:!l,showSpinnerTimeout:3e3,spinnerSize:"relative",children:[(0,b.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:1},children:V}),_&&K&&!("private"===u&&P)&&(0,b.jsx)(x,{type:e.type,parentStore:e.parentStore}),B&&(0,b.jsx)(h,{type:e.type,from:"main_sidebar"}),Z&&(0,b.jsx)(S,{itemStyle:e.itemStyle})]})}));function S(e){const{isMobile:t}=(0,n().Fy)(),o=(0,a().yK)((e=>({placeholder:{color:e.lightTextColor,paddingLeft:16,...t&&{display:"flex",alignItems:"center",height:32}}})),[t]);return(0,b.jsx)(m().Z,{role:"treeitem",style:e.itemStyle,children:(0,b.jsx)("div",{style:o.placeholder,children:(0,b.jsx)(d()._H,{defaultMessage:"No pages inside",id:"outliner.NoPagesInside.placeholder"})})})}function h(e){const{type:t,from:r}=e,l=(0,n().O7)(),s=l.device.isMobile,c=(0,a().yK)((e=>({sidebarItem:{color:e.sidebarSecondaryColor},hovered:{background:e.sidebarItemSelectedBackground}})),[]),p=(0,o(589525).hr)(),g=(0,i.useCallback)((async()=>{if("team"===t||!f().default.state.currentSpaceStore||!f().default.state.currentSpaceViewStore)return;await u().kC({environment:l,spaceStore:f().default.state.currentSpaceStore,spaceViewStore:f().default.state.currentSpaceViewStore,type:t,outlinerItemFrom:r,prepend:!1,shouldPersistToggleState:!0})&&s&&o(793935).close()}),[t,r,l,s]);return(0,b.jsx)(o(154186).Z,{style:p.baseSidebarItem,hoveredStyle:c.hovered,mobileFeedback:s,onClick:g,children:(0,b.jsx)(m().Z,{style:c.sidebarItem,left:(0,b.jsx)(C,{}),disableMobileBorder:!0,children:(0,b.jsx)(d()._H,{defaultMessage:"Add a page",id:"sidebar.addAWorkspaceOrPrivatePage.tooltip"})})})}v.displayName="Outliner";const I=i.memo((function(e){const{store:t,index:i}=e;return(0,b.jsx)(o(187709).ZP,{type:e.type,from:e.from,variant:"primary",store:t,style:e.itemStyle,toggleStyle:e.itemToggleStyle,itemIndex:i,itemDepth:e.itemDepth,itemOpenByDefault:e.itemOpenByDefault,parentStore:t.getRecordStoreUIParent(),onNavigate:e.onNavigate,disabled:e.disabled},t.id)})),x=i.memo((function(e){const t=(0,n().O7)(),{type:i,parentStore:r}=e,a=`OutlinerItem${i??""}${(null==r?void 0:r.id)??""}`;return(0,b.jsx)(o(796408).GR,{dropTargetKey:a,canDropBelow:!0,onSelectableDrop:async e=>{await u().NP({dropArgs:e,environment:t,type:i,isDroppingOnFullSection:!1,parentStore:r})},shouldShowDropZone:!0,canAcceptDrop:e=>{const{currentSpaceStore:o}=f().default.state;return!!o&&(0,y().Pl)({environment:t,draggingStores:e.draggingStores,parentStore:r,currentSpaceStore:o})}})}));function C(){const e=(0,a().yK)((e=>({icon:{fill:e.sidebarSecondaryColor,width:16,height:16},iconContainer:{display:"flex",alignItems:"center",justifyContent:"center"}})),[]);return(0,b.jsx)("div",{style:e.iconContainer,children:(0,l().f)(e.icon)})}const w=v},187709:(e,t,o)=>{o.d(t,{U2:()=>te,gZ:()=>X,aZ:()=>ee,ZP:()=>oe});var i=o(667294),n=()=>o(219727),r=()=>o(142735),a=()=>o(846550),l=()=>o(156642),s=()=>o(696459),d=()=>o(711608),c=()=>o(906591),u=()=>o(856546),p=()=>o(826955),m=()=>o(589525),g=(o(821057),o(122556),o(582845),o(250570),o(533019),o(721473),o(788208),o(22624),o(241792),()=>o(396136)),y=()=>o(788860),f=()=>o(707513),b=()=>o(381140),v=()=>o(110232),S=()=>o(729775),h=()=>o(384241),I=()=>o(654133),x=()=>o(67961),C=()=>o(945634),w=()=>o(429725),T=()=>o(459805),j=()=>o(239482),k=()=>o(91502),V=()=>o(176691),D=()=>o(105649),P=()=>o(998901),M=()=>o(876822),K=()=>o(636340),_=()=>o(269299),B=()=>o(943620),Z=()=>o(772529),A=o(785893);function O(e){const{targetStore:t,canEditItem:o}=e,i=(0,y().YB)(),l=(0,n().O7)(),{isMobile:s}=l.device,d=(0,r().VK)((()=>t.getIcon()),[t]),c=(0,r().VK)((()=>!s&&o&&!t.isNonEditableState()&&!(0,Z().Kj)(t.id)),[s,o,t]),u=(0,r().VK)((()=>{var e;return null===(e=t.getIconStore())||void 0===e?void 0:e.table}),[t]),p=(0,a().yK)((e=>({pageIcon:{fill:e.sidebarSecondaryColor}})),[]),m=e=>{const o=t.getIconStore();o&&_().createAndCommit({userAction:"OutlinerItem.handleRecordIconChange",environment:l,canUndo:!0,perform:t=>{K().sO({store:o,value:e,transaction:t})}})},g=(0,r().VK)((()=>{var e;return{recordTable:u,source:"sidebar",block_type:t.getType(),collection_id:"collection"===u?null===(e=t.getIconStore())||void 0===e?void 0:e.id:void 0}}),[u,t]);return(0,A.jsx)(I().Z,{renderTooltip:()=>(0,A.jsx)(y()._H,{defaultMessage:"Change icon",id:"sidebarItem.changeIconButton.tooltip"}),placement:P().Placement.Bottom,render:e=>c?(0,A.jsx)(B().Z,{bucket:"secure",disabled:!0,icon:d,store:t,title:void 0,isEmptyPage:t.isEmptyPage(),size:s?24:20,onChange:m,pageIconStyle:p.pageIcon,...e,largeIcon:!0,iconLoggingData:g,label:i.formatMessage({defaultMessage:"Change page icon",id:"sidebarItem.changeIconButton.buttonLabel"}),disableAnimation:!0}):(0,A.jsx)(B().Z,{disabled:!0,icon:d,title:void 0,isEmptyPage:t.isEmptyPage(),size:s?24:20,pageIconStyle:p.pageIcon,largeIcon:!0,label:i.formatMessage({defaultMessage:"Page icon",id:"sidebarItem.changeIconButton.disabledLabel"}),disableAnimation:!0,iconLoggingData:g})})}var L=()=>o(167705);function F(e){const{store:t,from:o,type:i,itemIndex:r,itemDepth:l,isOpen:s,onToggle:d}=e,u=(0,n().O7)(),p=(0,a().yK)((e=>({toggle:{color:e.lightIconColor}})),[]);return(0,A.jsx)(L().Z,{isSidebar:!0,fill:!0,icon:"chevron",open:s,color:p.toggle.color,onClick:()=>{const e=0===l,n=j().VP(t);b().t8(u,{teamStore:n,type:e?"top_level":"nested",is_toggled:!s,outliner_type:i,outliner_position:r,outliner_depth:l,outliner_location:"main_sidebar"===o?"sidebar":"pane"}),d(),c().Ps({store:t,toOpen:!s,environment:u,isTopLevelItem:e})},"aria-describedby":e["aria-describedby"],"aria-controls":e["aria-controls"]})}var N=()=>o(283719);const E=function(e){const{store:t,from:l,variant:s,style:d,targetStore:u,itemDepth:p,type:g,nestedOutlinerAriaId:f,titleAriaId:v,isOpen:h,itemIndex:x,onFocus:k,onBlur:V,onMouseMove:K,onMouseLeave:_,onNavigate:B}=e,Z=(0,n().O7)(),O=Z.device.isMobile,L=(0,r().VK)((()=>function(e){const{targetStore:t,type:o,from:i}=e;if(!t)return;const n=(0,c().N)({type:o,from:i});if(t.isNavigableBlock())return(0,w().ZP)({store:t,fullyQualified:!1,pageVisitSource:n});{const e=j().Dg(t);if(e)return(0,w().ZP)({store:e,scrollToBlockId:t.id,fullyQualified:!1,pageVisitSource:n})}}({targetStore:u,type:g,from:l})),[l,u,g]),{isCopyIndicator:F,shouldShowAsLoadingSpinner:N}=(0,m().Qu)(t),E=(0,r().VK)((()=>{const{mainEditorCurrentBlockStore:e}=M().default.state;return e&&t.id===e.id}),[t]),H=(0,r().VK)((()=>{var e;return new Set(null===(e=o(63317).Z.get(t.getSpaceId()))||void 0===e?void 0:e.map((e=>e.pageId)))}),[t]),W=(0,r().VK)((()=>!o(804217).default.state.online&&Z.device.isElectron&&o(749826).default.checkGate({gateName:"download_for_offline"})&&!o(991007)._(t.id)&&!H.has(t.id)),[Z.device.isElectron,H,t.id]),U=(0,r().VK)((()=>{const e=t.getFormat();if("workflow_template_placeholder"===e.collection_view_sub_type&&e.placeholder_workflow_template_id&&t.isCollectionView())return{collectionTemplateId:e.placeholder_workflow_template_id,collectionViewBlockStore:t}}),[t]),z=(0,r().VK)((()=>(0,T().G$)({isMobile:O})),[O]),G=(0,m().hr)(),Y=(0,a().yK)((e=>({sidebarItem:{...!O&&{paddingLeft:5},...E&&G.currentSelectedSidebarItem,...!O&&(0,T().Z3)(),...d,..."secondary"===s&&{padding:8,height:"unset"},...W&&$(!1)},children:{display:"flex",alignItems:"center"},loadingSpinner:{marginLeft:6},moveOrDuplicateProgress:{flex:1,marginLeft:O?10:6,marginRight:O?12:void 0},link:{width:"100%"},sidebarItemHovered:{background:e.sidebarItemSelectedBackground},tooltipContainer:{maxWidth:280,width:"max-content"},tooltipMessage:{color:e.text.secondary}})),[O,E,G.currentSelectedSidebarItem,d,s,W]),Q=(0,i.useCallback)((e=>{if(W)return;B&&B(t);if(!(e.metaKey||e.ctrlKey)){("secondary_sidebar"===l?"peek"===D().default.state.mode&&D().default.isVisible():D().default.isVisible())&&o(815532).TN({environment:Z,skipAnimation:!0})}const i=j().VP(t);b().Yg(Z,{teamStore:i,type:0===p?"top_level":"nested",outliner_type:g,outliner_position:x,outliner_depth:p})}),[l,B,g,x,t,Z,p,W]),J={role:"treeitem","aria-current":E?"page":void 0,"aria-expanded":!!h,"aria-owns":f,"aria-labelledby":v};if(F)return N?(0,A.jsxs)(C().Z,{style:Y.sidebarItem,childrenStyle:Y.children,onFocus:k,onBlur:V,onMouseMove:K,onMouseLeave:_,children:[(0,A.jsx)(o(312578).Z,{style:Y.loadingSpinner}),(0,A.jsx)(o(417622).Z,{targetRecordId:t.id,style:Y.moveOrDuplicateProgress})]}):null;if(U)return(0,A.jsx)(o(154186).Z,{onClick:async()=>{const{collectionTemplateId:e,collectionViewBlockStore:i}=U,{getCollectionTemplateFromId:n}=await o(293307).Vh.load(),r=n(e);if(!r)throw new Error("Collection template not found");B&&B(t);const{onNavigateToPlaceholderWorkflowTemplateBlock:a}=await o(114104).Z.load();a({environment:Z,collectionTemplate:r,collectionViewBlockStore:i})},children:(0,A.jsx)(R,{...e,onFocus:k,onBlur:V,sidebarItemStyle:Y.sidebarItem,sidebarItemChildrenStyle:Y.children,titleAriaId:v,nestedOutlinerAriaId:f,isWorkflowTemplatePlaceholder:!0,...J})});const q=(0,A.jsxs)("div",{style:Y.tooltipContainer,children:[(0,A.jsx)(y()._H,{id:"blockSidebarItem.offlineTooltip.title",defaultMessage:"Unavailable offline"}),(0,A.jsx)("div",{style:Y.tooltipMessage,children:(0,A.jsx)(y()._H,{id:"blockSidebarItem.offlineTooltip.message",defaultMessage:"Return online to view or make the page available offline."})})]});return L?(0,A.jsx)(I().Z,{disableTooltip:!W,placement:P().Placement.Right,textWrap:!0,renderTooltip:()=>q,render:t=>(0,A.jsx)(S().Z,{disabled:W,onFocus:k,onBlur:V,style:Y.link,href:W?void 0:L,onClick:Q,innerStyle:z,hoveredStyle:Y.sidebarItemHovered,...J,...t,children:(0,A.jsx)(R,{...e,sidebarItemStyle:Y.sidebarItem,sidebarItemChildrenStyle:Y.children,titleAriaId:v,nestedOutlinerAriaId:f,disableRightButtons:W})})}):(0,A.jsx)(R,{...e,onFocus:k,onBlur:V,sidebarItemStyle:Y.sidebarItem,sidebarItemChildrenStyle:Y.children,titleAriaId:v,nestedOutlinerAriaId:f,...J})};function R(e){const{store:t,variant:o,from:i,parentStore:s,targetStore:d,itemDepth:u,type:m,onFocus:y,onBlur:b,onMouseMove:S,onMouseLeave:I,onToggle:w,titleAriaId:j,nestedOutlinerAriaId:D,isOpen:P,isHovered:M,isFocused:K}=e,_=(0,r().VK)((()=>function(e){const{store:t,parentStore:o,isTopLevelItem:i,type:n}=e;if(t.isDefined()&&(0,v().h7)(t))return!1;if(t.isCollectionView()&&!(0,k().bq)())return!t.getCollectionViewSourceCollectionStore();if("block"===(null==o?void 0:o.table)){if(p().G.createChildStore(o,{table:g().iU,id:o.id,spaceId:t.getSpaceId()}).isType("collection_view_page"))return!1}if(t.isDefined()&&t.getType()===l().Ti.alias)return!0;if(i&&"team"!==n)return!1;if(!o)return!1;if(t.isDefined())return t.getParentId()!==o.id;return!1}({store:t,parentStore:s,isTopLevelItem:0===u,type:m})),[t,s,u,m]),B=(0,n().Fy)().isMobile,Z=(0,r().VK)((()=>{const e=t.getLastEditedTime();return(0,V().IS)(e,{useLowercase:!1,useCompactFormat:!0})}),[t]),L=M||K,E=(0,r().VK)((()=>{if((0,k().ku)()){const e=Boolean(null==d?void 0:d.isCollectionView()),o=c().Yz(t).length>0;return e||o}return!0}),[t,d]),R=L&&E,W=(0,a().yK)((t=>({iconContainer:{display:"grid"},toggle:{gridColumn:1,gridRow:1,zIndex:1,opacity:R?1:0,order:R?1:0,transition:`opacity ${T().PP}`},itemIcon:{gridColumn:1,gridRow:1,opacity:R?0:1,transition:`opacity ${T().PP}`,order:R?0:1,..."secondary"===o&&{marginTop:-6}},rightIcons:{...!B&&{opacity:L?1:0,transition:`opacity ${T().PP}`}},childrenStyle:{...e.sidebarItemChildrenStyle,..."secondary"===o&&{display:"flex",flexDirection:"column",alignItems:"flex-start"}},title:{fontWeight:f().Ue.medium,..."secondary"===o&&{width:"100%"}},subtitle:{marginTop:2}})),[B,e.sidebarItemChildrenStyle,L,o,R]);return(0,A.jsxs)(C().Z,{role:e.role,"aria-current":e["aria-current"],"aria-expanded":e["aria-expanded"],"aria-owns":e["aria-owns"],"aria-labelledby":e["aria-labelledby"],style:e.sidebarItemStyle,childrenStyle:W.childrenStyle,left:B?(0,A.jsx)(F,{store:t,from:i,type:m,itemIndex:e.itemIndex,itemDepth:u,"aria-controls":D,"aria-describedby":j,onToggle:w,isOpen:P}):void 0,icon:B?d&&(0,A.jsx)(O,{targetStore:d,canEditItem:e.canEditItem}):(0,A.jsxs)("div",{style:W.iconContainer,children:[E&&(0,A.jsx)("div",{style:W.toggle,children:(0,A.jsx)(F,{store:t,from:i,type:m,itemIndex:e.itemIndex,itemDepth:u,"aria-controls":D,"aria-describedby":j,onToggle:w,isOpen:P})}),(0,A.jsx)("div",{style:W.itemIcon,children:d&&(0,A.jsxs)(A.Fragment,{children:[e.isWorkflowTemplatePlaceholder&&(0,A.jsx)(H,{}),(0,A.jsx)(O,{targetStore:d,canEditItem:e.canEditItem})]})})]}),right:e.disableRightButtons?void 0:(0,A.jsx)("div",{style:W.rightIcons,children:(0,A.jsx)(N().ZP,{store:t,from:i,type:m,itemIndex:e.itemIndex,itemDepth:u,canEditItem:e.canEditItem,onToggle:w,isHovered:M,isFocused:K})}),onFocus:y,onBlur:b,onMouseMove:S,onMouseLeave:I,isAlias:_,children:[(0,A.jsx)(h().Z,{id:j,store:t,style:W.title}),"secondary"===o&&(0,A.jsx)(x().Z,{isSmall:!0,isSecondaryColor:!0,style:W.subtitle,children:Z})]})}function H(){const e=(0,a().yK)((e=>({circle:{position:"absolute",background:e.blueColor,borderRadius:"50%",border:`1px solid ${e.surface.wash}`,width:8,height:8,left:14,zIndex:1}})),[]);return(0,A.jsx)("div",{style:e.circle})}var W=function(e){return e[e.opacity=0]="opacity",e}(W||{});function $(e){if((arguments.length>1&&void 0!==arguments[1]?arguments[1]:W.opacity)===W.opacity)return{opacity:"0.2",cursor:"default"}}var U=()=>o(949842),z=(o(267602),o(228244),()=>o(900596)),G=()=>o(468754);function Y(e){const{store:t,collectionViewStore:o,onNavigate:l,type:s,from:d}=e,g=(0,n().O7)(),y=(0,r().VK)((()=>t.getCollectionViewStores().some((e=>"page"===e.getType()))),[t]),f=(0,r().VK)((()=>{if(y)return!1;const{mainEditorCurrentBlockStore:e,currentCollectionViewStore:i}=M().default.state;return Boolean(e&&t.id===e.id&&i&&i.id===o.id)}),[o.id,t.id,y]),b=(0,m().hr)(),v=(0,a().yK)((t=>({initialIcon:{fontSize:12,fontWeight:500,marginLeft:5,color:t.mediumTextColor},sidebarItem:{...f&&b.currentSelectedSidebarItem,...(0,T().Z3)(),...e.style},hoveredItem:{background:t.sidebarItemSelectedBackground},linkBox:{width:"100%"}})),[f,b.currentSelectedSidebarItem,e.style]),h=(0,r().VK)((()=>(0,w().ZP)({store:t,fullyQualified:!1,collectionViewId:o.id,pageVisitSource:(0,c().N)({type:s,from:d})})),[o.id,d,t,s]),I=(0,r().VK)((()=>({ready:o.isReady(),type:o.getType(),pagePointer:o.getFormat().page_pointer,name:o.getName()})),[o]),x=(0,r().VK)((()=>{if("page"!==I.type||!I.pagePointer)return null;const e=p().G.createChildStore(t,{table:I.pagePointer.table,id:I.pagePointer.id});return{ready:(0,u().b)(e),outlinerItems:(0,c().Q2)({rootStore:e})}}),[I,t]),j=(0,r().VK)((()=>t.getContentStore()),[t]),k=(0,i.useCallback)((()=>{l&&l(t)}),[t,l]),V=(0,r().VK)((()=>(0,T().G$)({isMobile:g.device.isMobile})),[g]);if(!I.ready)return null;if("page"===I.type&&x){const{ready:t,outlinerItems:o}=x;return(0,A.jsx)(G().Z,{type:e.type,childStores:o,areChildrenLoading:!t,itemDepth:e.itemDepth+1,parentStore:j,itemStyle:v.sidebarItem,itemToggleStyle:e.itemToggleStyle,onNavigate:e.onNavigate,disabled:e.disabled,from:d})}return y?null:(0,A.jsx)(S().Z,{href:h,style:v.linkBox,hoveredStyle:v.hoveredItem,innerStyle:V,onClick:k,role:"treeitem","aria-current":f?"step":void 0,children:(0,A.jsx)(C().Z,{icon:(0,A.jsx)("div",{style:v.initialIcon,children:"•"}),style:v.sidebarItem,children:(0,A.jsx)(z().Z,{collectionViewName:I.name,collectionViewType:I.type??"table"})})})}function Q(e){const{store:t,from:o}=e,i=(0,r().VK)((()=>t.getCollectionViewStores()),[t]);return(0,A.jsx)("div",{role:"group",id:e.id,"aria-labelledby":e["aria-labelledby"],onContextMenu:e=>{e.preventDefault(),(0,U().ZP)({event:e,context:U().Af.EditorContextMenu,callback:()=>{}})},children:i.map((i=>(0,A.jsx)(Y,{store:t,from:o,collectionViewStore:i,style:e.itemStyle,onNavigate:e.onNavigate,type:e.type,itemDepth:e.itemDepth,disabled:e.disabled,childStores:e.childStores},i.id)))})}function J(e){const{disabled:t,store:o,from:i,style:l,targetStore:s,itemDepth:d,nestedOutlinerAriaId:p,titleAriaId:m,onNavigate:g,type:y,toggleStyle:f}=e,{isMobile:b}=(0,n().Fy)(),v=(0,r().VK)((()=>!(0,u().b)(o)),[o]),S=(0,r().VK)((()=>s.isCollectionView()?s:null),[s]),h=(0,r().VK)((()=>(0,c().Yz)(o)),[o]),I=(0,r().VK)((()=>s.getContentStore()),[s]),x=(0,a().yK)((()=>{const e="number"==typeof(null==l?void 0:l.paddingLeft)?l.paddingLeft:b?X:5,t=b?ee:te;return{item:{...l,paddingLeft:e+t}}}),[l,b]);return S?(0,A.jsx)(Q,{store:S,from:i,itemStyle:x.item,onNavigate:g,type:y,childStores:h,areChildrenLoading:!1,itemDepth:d+1,parentStore:I,itemToggleStyle:e.toggleStyle,disabled:t,id:p,"aria-labelledby":m}):(0,A.jsx)(G().Z,{from:i,type:y,childStores:h,areChildrenLoading:v,itemDepth:d+1,parentStore:I,itemStyle:x.item,itemToggleStyle:f,onNavigate:g,disabled:t,id:p,"aria-labelledby":m})}function q(e){return`Outliner-${e.id}`}const X=6,ee=22,te=8,oe=function(e){const{store:t,itemIndex:c,parentStore:u,type:g,itemDepth:y,disabled:f,from:b,variant:v}=e,S=(0,n().O7)(),h=(0,o(657320).l)(),I=function(e){return 0===e}(y),[x,C]=(0,i.useState)((()=>{if((0,s().$K)(e.itemOpenByDefault))return e.itemOpenByDefault;if(I){const e=o(35980).Z.get({userId:S.currentUser.id,key:q(t)});if((0,s().$K)(e))return e}return!1})),[w,T]=(0,i.useState)(!1),[j,k]=(0,i.useState)(!1),V=(0,i.useId)(),D=(0,i.useId)(),P=(0,r().VK)((()=>function(e){if(e.getType()===l().Ti.alias){const t=e.getAliasTargetStore();return t instanceof p().G?t:void 0}return e}(t)),[t]),M=(0,r().VK)((()=>m().Bb(t)),[t]),K=0===c,_=(0,r().VK)((()=>!f&&(0,o(421797).J5S)({environment:S,blocks:[t],publicEditMode:h&&h.publicEditModeStore.state})),[f,h,S,t]),B=(0,r().VK)((()=>_&&!t.isLinkedCollectionView()),[t,_]),{isCopyIndicator:Z,shouldShowAsLoadingSpinner:O}=(0,m().Qu)(t),L=(0,i.useRef)(null);(0,o(98642).c)(o(972079).Z,(()=>({store:t,parentStore:u,type:g,isTopLevelItem:I,getNode:()=>L.current})),[t,u,g,I]);const F=(0,i.useMemo)((()=>M&&u?{onInsertBelow:e=>d().LR({...e,environment:S,store:t,parentStore:u,before:!0,type:g}),onInsertAbove:e=>d().LR({...e,environment:S,store:t,parentStore:u,before:!1,type:g})}:{}),[M,S,u,t,g]),N=(0,i.useCallback)((e=>{const t=e.target;t instanceof HTMLElement&&(0,o(474788).E)(t)&&k(!0)}),[]),R=(0,i.useCallback)((()=>{k(!1)}),[]),H=(0,i.useCallback)((()=>{o(158083).Z.state.isDragging||T(!0)}),[]),W=(0,i.useCallback)((()=>{T(!1)}),[]),$=(0,i.useCallback)((e=>{C(void 0!==e?e:e=>!e)}),[]),U=(0,a().yK)((()=>({selectableStyle:{display:"flex",flexDirection:"column",gap:1,paddingBottom:x&&"secondary"===v?8:0}})),[x,v]),z=(0,i.useCallback)((e=>{const i=t.getRecordStoreUIParent();null!=i&&i.valueIs(o(262453).i)&&d().A5({...e,type:g,targetStore:t,targetParentStore:i,isTopLevelItem:I})}),[t,g,I]),G=(0,i.useCallback)((async e=>{const{droppedDirection:o,droppedStores:i,duplicate:n}=e;u&&await d().v9({environment:S,type:g,targetParentStore:u,targetStore:t,isTopLevelItem:I,droppedDirection:o,droppedStores:i,duplicate:n,isDroppingOnFullSection:!1})}),[S,t,u,g,I]);return P?Z&&!O?null:(0,A.jsxs)(o(307369).Z,{analyticsName:"outliner_item",actionSectionGroupKey:"sidebar_outliner",contextMenuAndDragStores:[t],canDrag:M,canDropAbove:K,canDropBelow:M,canDropOnto:B,canInsertBelow:M,canInsertAbove:M,canSelect:M,canTriggerContextMenu:!0,onRemove:z,onSelectableDrop:G,shouldShowDropZone:!0,showBlockMenuInput:!1,store:t,ref:L,style:U.selectableStyle,...F,children:[(0,A.jsx)(E,{variant:v,from:b,store:t,style:e.style,parentStore:u,type:g,itemIndex:e.itemIndex,itemDepth:e.itemDepth,onNavigate:e.onNavigate,targetStore:P,canEditItem:_,nestedOutlinerAriaId:V,titleAriaId:D,onFocus:N,onBlur:R,onMouseMove:H,onMouseLeave:W,onToggle:$,isHovered:w,isFocused:j,isOpen:x}),x&&(0,A.jsx)(J,{disabled:f,store:t,from:b,style:e.style,targetStore:P,itemDepth:e.itemDepth,nestedOutlinerAriaId:V,titleAriaId:D,onNavigate:e.onNavigate,type:g,toggleStyle:e.toggleStyle})]}):null}},283719:(e,t,o)=>{o.d(t,{ZP:()=>H,Pr:()=>Q,nW:()=>J});o(492176),o(7961),o(241792);var i=o(667294),n=()=>o(219727),r=()=>o(142735),a=()=>o(846550),l=()=>o(641772),s=()=>o(490670),d=()=>o(139978),c=()=>o(788860),u=()=>o(242619),p=()=>o(711608),m=()=>o(879952),g=()=>o(269299),y=()=>o(793935),f=()=>o(985866),b=()=>o(826955),v=()=>o(807230),S=()=>o(887430),h=()=>o(324090),I=()=>o(903609);var x=()=>o(154186),C=()=>o(827973),w=()=>o(448419),T=()=>o(198829),j=()=>o(255577),k=()=>o(470386),V=()=>o(943620),D=()=>o(384241),P=()=>o(388284),M=()=>o(654133),K=()=>o(527278),_=()=>o(352230),B=()=>o(164079),Z=()=>o(239482),A=()=>o(641506),O=()=>o(998901),L=()=>o(876822),F=()=>o(431671),N=()=>o(273212),E=o(785893);function R(e){const{store:t,from:i,type:a,canEditItem:l,itemDepth:s,isHovered:d,isFocused:c,onToggle:u}=e,{isMobile:p}=(0,n().Fy)(),m=p||d||c,g=(0,r().VK)((()=>{var e;const o=Boolean(t.getAppContainerBlockStore()),i=t.isPlaceholderWorkflowTemplateBlock(),n=null===(e=t.getCollectionStore())||void 0===e?void 0:e.isSyncedCollection();return Boolean(t.getType()&&l&&!o&&!i&&!n)}),[t,l]),y=J({showRightIcons:m});return a===o(993407).g$?null:(0,E.jsxs)("div",{style:y.iconContainer,children:[(0,E.jsx)(Y,{store:t,from:i,type:e.type,itemIndex:e.itemIndex,itemDepth:s}),g&&(0,E.jsx)(W,{store:t,onToggle:u,isTopLevelItem:0===s,from:i,type:a})]})}const H=i.memo(R);function W(e){const{store:t,onToggle:o,isTopLevelItem:i,from:a,type:l}=e,s=(0,n().O7)(),{isMobile:c}=s.device,u=(0,r().VK)((()=>t.isCollectionView()),[t]),m=(0,r().VK)((()=>t.getLinkedViewCollectionBlockStores()),[t]),g=(0,r().VK)((()=>{var e;const o=null===(e=t.getCollectionViewStores().at(0))||void 0===e?void 0:e.id;if(!o)return;const i=b().Xr.createChildStore(t,{table:d().np,id:o});return null==i?void 0:i.getFormatStore().getValue()}),[t]),y=(0,r().VK)((()=>{const e=null==g?void 0:g.collection_view_source;if("typed"===(null==e?void 0:e.type))return null==e?void 0:e.databaseType}),[g]),f=K().Z.formatMessage(N().V.addAPageInside);return u&&!g&&0===m.length?(0,E.jsx)(z,{disabled:!0}):u&&y?(0,E.jsx)(U,{store:t,databaseType:y}):m.length<=1?(0,E.jsx)(M().Z,{renderTooltip:()=>f,placement:O().Placement.Bottom,render:e=>{const n={...e,onClick:e=>{p().bS({blockStore:m[0]??t,shouldNavigateToSource:!1,environment:s,event:e,analytics:{from:a,type:l},toggleOptions:{onToggle:o,isTopLevelItem:i}})}};return(0,E.jsx)(z,{events:n})}}):(0,E.jsx)(M().Z,{renderTooltip:()=>f,placement:O().Placement.Bottom,render:e=>(0,E.jsx)(w().ZP,{popupType:c?w().Z4.SlideUp:w().Z4.Popup,renderOrigin:t=>(0,E.jsx)(z,{events:(0,B().Z)(e,t)}),render:e=>(0,E.jsx)(G,{store:t,onToggle:o,parent:e,isTopLevelItem:i,from:a,type:l})})})}const $=[];function U(e){const{store:t,databaseType:o}=e,a=(0,n().O7)(),l=(0,r().VK)((()=>L().default.state.currentSpaceViewStore),[]),s=(0,r().VK)((()=>L().default.state.currentSpaceStore),[]),c=(0,r().VK)((()=>null==l?void 0:l.getTeamsStores().map((e=>e.id))),[l]),u=(0,F().F)({environment:a,spaceStore:s,parentStore:s,joinedTeamIds:c??$,overrideDatabaseType:o,moveToTargets:$}),p=(0,r().SI)((()=>u.success?u.typedDatabases:[]),[u]),m=(0,r().Kw)(p),x=(0,i.useCallback)((e=>{const o=p.state;o&&function(e){var t;const{store:o,typedDatabases:i,environment:n}=e,r=S().fm(o);if(!(0,v().ww)(n))return;n.device.isMobile&&y().close();const a=null===(t=o.getCollectionViewStores().at(0))||void 0===t?void 0:t.id;if(!r&&!a)return;const l=r??new(f().Z)(n);if(!r&&a){const e=b().Xr.createChildStore(o,{table:d().np,id:a});(0,I().y)({environment:n,collectionViewBlockStore:o,collectionViewStore:e,collectionStore:void 0,collectionContextStore:l,isFullScreen:!0,isRootChild:!0,isInPeekRenderer:!1,viewsModuleContext:void 0,forceLocalQueryCollection:!1}),l.remoteCollectionIdsStore.setState(i.map((e=>e.id)))}else 0===l.collectionStoresStore.state.length&&l.remoteCollectionIdsStore.setState(i.map((e=>e.id)));g().createAndCommit({userAction:"collectionViewActions.handleAddMultiSourceViewPageButtonClick",environment:n,canUndo:!0,perform:e=>{(0,h().N)({transaction:e,store:o,collectionContextStore:l,environment:n,shouldCoerce:!0,templateStore:l.defaultPageTemplateStore.state,showMoveTo:!0,peekModeOverride:"center_peek",from:{createBlock:"sidebar_new_page_button"}})}})}({store:t,event:e,typedDatabases:o,environment:a})}),[a,p,t]),C=K().Z.formatMessage(N().V.addAPageInside);return u.success&&0!==m.length?(0,E.jsx)(M().Z,{renderTooltip:()=>C,placement:O().Placement.Bottom,render:e=>{const t={...e,onClick:x};return(0,E.jsx)(z,{events:t})}}):(0,E.jsx)(z,{disabled:!0})}function z(e){const{isMobile:t}=(0,n().Fy)(),o=Q();return(0,E.jsx)(x().Z,{ariaLabel:K().Z.formatMessage(N().V.addAPageInside),mobileFeedback:t,style:o.button,disabled:e.disabled,disabledFeedback:e.disabled,...e.events,children:(0,s().f)(o.buttonIcon)})}function G(e){const{store:t,onToggle:o,parent:i,isTopLevelItem:l,from:s,type:d}=e,u=(0,n().O7)(),{isMobile:m}=u.device,g=(0,r().VK)((()=>t.getLinkedViewCollectionBlockStores()),[t]),y=(0,a().yK)((()=>({menuItem:{display:"flex",alignItems:"center",whiteSpace:"pre"}})),[]),f={menuType:m?_().o.Modal:_().o.Popup,right:m?(0,E.jsx)(k().DoneMenuText,{}):void 0},b={key:"collections",render:e=>(0,E.jsx)(P().Z,{...e,title:(0,E.jsx)(c()._H,{defaultMessage:"Add to",id:"sidebarItem.addAPageInside.popup.addTo"})}),items:g.map((e=>({key:e.id,render:t=>(0,E.jsx)(C().Z,{...t,title:(0,E.jsx)("div",{style:y.menuItem,children:(0,E.jsx)(D().Z,{store:e})}),icon:(0,E.jsx)(V().Z,{disabled:!0,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:14})}),action:t=>{p().bS({blockStore:e,environment:u,event:t.event,shouldNavigateToSource:!0,analytics:{from:s,type:d},toggleOptions:{onToggle:o,isTopLevelItem:l}})}})))};return(0,E.jsx)(T().Z,{...f,children:(0,E.jsx)(j().ZP,{type:j().iW.Vertical,onAccept:i.close,initialFocus:void 0,sections:[b]})})}function Y(e){const{store:t,from:o,type:i,itemDepth:r,itemIndex:a,iconStyle:s}=e,d=(0,c().YB)(),p=(0,n().O7)(),{isMobile:g}=p.device,y=Q(),f=e=>{const n=Z().VP(t);m().Ys({environment:p,store:t}),u().Qn({environment:p,stores:[t],left:e.clientX,top:e.clientY,showInput:!1,actionSectionGroupKey:"sidebar_outliner",analyticsFrom:"sidebar_more_menu",optionalAnalyticsProperties:{teamStore:n,type:0===r?"top_level":"nested",outliner_type:i,outliner_position:a,outliner_depth:r,outliner_location:"main_sidebar"===o?"sidebar":"pane"}})},b="bookmarks"===i?d.formatMessage({defaultMessage:"Remove, rename, and more…",id:"sidebarItem.favoritedPageMenuButton.tooltip"}):d.formatMessage({defaultMessage:"Delete, duplicate, and more…",id:"sidebarItem.pageMenuButton.tooltip"});return(0,E.jsx)(M().Z,{renderTooltip:()=>b,placement:O().Placement.Bottom,render:e=>(0,E.jsx)(x().Z,{ariaLabel:b,mobileFeedback:g,style:y.button,onClick:f,...e,children:(0,l().o)({...y.buttonIcon,...s})})})}function Q(){const e=(0,n().O7)().device.isMobile;return(0,a().yK)((t=>({button:e?{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32,borderRadius:4,marginLeft:0}:{display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:4,marginLeft:4},buttonIcon:e?{fill:t.lightIconColor,width:18}:{fill:t.mediumIconColor,width:14}})),[e])}function J(e){const{showRightIcons:t}=e;return(0,a().yK)((()=>({iconContainer:{display:"flex",paddingLeft:3,...t?{}:{...A().jy,display:"block"}}})),[t])}},273212:(e,t,o)=>{o.d(t,{V:()=>n,g:()=>r});var i=()=>o(788860);const n=(0,i().vU)({addAPageInside:{defaultMessage:"Add a page inside",id:"sidebarItem.addAPageInside.tooltip"}}),r=(0,i().vU)({addPageTooltip:{defaultMessage:"Add a page",id:"sidebar.addButton.addPageTooltip"}})},771097:(e,t,o)=>{o.d(t,{CachedTypedDatabasesStore:()=>i,a:()=>n});const i=o(263184).default.createValue(void 0,{name:"CachedTypedDatabasesStore"});function n(e){const t=i.state;t&&i.setState({...t,typedDatabases:[...t.typedDatabases,e]})}},431671:(e,t,o)=>{o.d(t,{F:()=>f});o(241792);var i=()=>o(142735),n=()=>o(331540),r=()=>o(801812),a=()=>o(752778),l=()=>o(826955),s=()=>o(824462);var d=()=>o(384791),c=()=>o(677559),u=()=>o(466970),p=()=>o(828946),m=()=>o(98228),g=()=>o(771097),y=()=>o(241449);function f(e){let{environment:t,spaceStore:o,joinedTeamIds:f,parentStore:b,moveToTargets:v,overrideDatabaseType:S}=e;const h=(0,i().VK)((()=>{const e=null==o?void 0:o.id;if(e)return function(e){if(!g().CachedTypedDatabasesStore.state)return;if(e!==g().CachedTypedDatabasesStore.state.spaceId)return;return g().CachedTypedDatabasesStore.state.typedDatabases}(e)}),[null==o?void 0:o.id]),I=(0,u().E)("typed_move_to_improved_default_results"),x=(0,c().XJ)(p().x.searchActions),[{value:C,status:w}]=(0,r().r5)((async()=>{if(h)return h;if(!o||!b)return;const e=S??y().default.getDatabaseType();if(!e)return;if("resolved"!==x.status)return;const i=x.value;let r=[];if(I){const n=((await i.searchCollectionsWithRecents({environment:t,query:"",limit:20,databaseType:[e],spaceStore:o,parentStore:o,collectionViewBlockStore:void 0,searchSessionId:y().default.state.isOpen?y().default.state.flowId:void 0})).results||[]).map((e=>l().NW.createChildStore(b,{table:a().vF,id:e})));r=(0,d().qJ)({typedDatabases:n,blocksToFilterParents:v})}else{const i=await async function(e){let{environment:t,spaceId:o,databaseType:i,parentStore:n}=e;if(!o)return;const r=await s().callApi({eventName:"getTypedDatabases",environment:t,data:{spaceId:o,databaseType:i}});return"success"===r.type?r.data.result.map((e=>l().NW.createChildStore(n,{table:a().vF,id:e.collectionId}))):void 0}({environment:t,spaceId:o.id,databaseType:e,parentStore:b})??[];r=(0,d().mL)({environment:t,typedDatabases:i,spaceStore:o,joinedTeamIds:f})}return g().CachedTypedDatabasesStore.setState({typedDatabases:r,spaceId:o.id}),y().default.update((e=>({...e,variant:n().ii}))),r}),[h,o,b,S,x.status,x.value,I,t,v,f],{debounce:m().vp,throttle:m().vp});return h?{success:!0,typedDatabases:h}:"resolved"===w&&C?{success:!0,typedDatabases:C}:{success:!1}}}}]);