"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[22371],{429394:(e,t,i)=>{i.d(t,{P:()=>u,j:()=>d});i(267602),i(653476),i(241792);var n=()=>i(446866),s=()=>i(581356),o=()=>i(876822),r=()=>i(214488),a=()=>i(849129);const l=i(513670).Ds((e=>{let{environment:t,flowId:n,billingData:s,origin:o}=e;i(930085).UW(t,{invite_flow_id:n,billingData:s,invite_origin:o})}),1e3);async function d(e){var t;const{environment:i,event:d,flowId:u,inviteTargetsStore:c,inviteOrigin:p,onInputChanged:m}=e;null==m||m();const v=null===(t=o().default.state.currentSpaceStore)||void 0===t?void 0:t.id,g=v?await r().Z.awaitData(i,{spaceId:v}):void 0;c.setState({...c.state,tokenQuery:d.target.value}),l({environment:i,flowId:u,billingData:null==g?void 0:g.billingData,origin:p});const h=d.target.value,{extractedEmails:y,invalidParts:f,newInputValue:x}=(0,n().nj)(h),b=[...await a().M5(i,y),...f.map((e=>({type:"invalidUser",value:{text:e}})))].filter((e=>!s().H({inviteTargetsStore:c,target:e}))),S=[...c.state.inviteTargets,...b];c.setState({...c.state,inviteTargets:S,tokenQuery:x})}function u(e){const{targetToRemove:t,inviteTargetsStore:i}=e;if(0===i.state.inviteTargets.length)return;const n=i.state.inviteTargets.filter((e=>e!==t));0===n.length?i.setState({...i.state,inviteTargets:[]}):i.setState({...i.state,inviteTargets:n})}},788899:(e,t,i)=>{i.d(t,{Tp:()=>v,cn:()=>u,fg:()=>p,l0:()=>c});i(667294);var n=()=>i(219727),s=()=>i(573357),o=()=>i(198829),r=()=>i(18748),a=()=>i(470386),l=()=>i(352230),d=i(785893);const u=8,c=8,p=32,m={height:p+u-2,paddingTop:u-2};function v(e){let{title:t,helpButton:i,onCancel:r,desktopMinWidth:u,desktopMaxWidth:c,desktopWidth:p,children:m}=e;const{device:v}=(0,n().O7)();return(0,d.jsx)(s().Z,{capture:!0,allowEsc:!0,allowUndo:!0,render:e=>{let n;return n=v.isMobile?{menuType:l().o.Modal,title:t,right:(0,d.jsx)(a().DoneMenuText,{}),onClickRight:r,...e}:{menuType:l().o.Popup,...u&&{minWidth:u},...c&&{maxWidth:c},...p&&{width:p},...e},(0,d.jsx)(o().Z,{...n,header:t&&(0,d.jsx)(g,{title:t,helpButton:i}),children:m})}})}function g(e){let{title:t,helpButton:i}=e;return(0,n().O7)().device.isMobile?null:(0,d.jsx)(r().ZP,{style:m,title:t,right:i})}},292612:(e,t,i)=>{i.d(t,{Z:()=>o});var n=i(667294),s=i(785893);const o=n.forwardRef((function(e,t){const n=(0,i(846550).yK)((t=>({base:{color:e.isBlue?i(568017).ZP.blue:t.mediumTextColor},disabled:{cursor:"not-allowed"},buttonMenuItem:{...e.style,...e.disabled?{cursor:"not-allowed"}:{}}})),[e.disabled,e.isBlue,e.style]),{color:o}=n.base;return(0,s.jsx)(i(827973).Z,{ref:t,...e,title:(0,s.jsx)("div",{style:{color:o,fill:o},children:e.title}),icon:(0,s.jsx)(i(882292).Z,{icon:i(159732).R,styles:{fill:o}}),style:n.buttonMenuItem})}))},356380:(e,t,i)=>{i.d(t,{e:()=>l});i(667294);var n=()=>i(142735),s=()=>i(788860),o=()=>i(697623),r=()=>i(897257),a=i(785893);function l(e){let{featureAvailability:t}=e;const i=(0,n().VK)((()=>(0,o().c4)(r().subscriptionDataStoreInstance.state)),[])??0,l={type:"upsell",limit:{type:"cumulative",total:i,current:i},upsell:{type:"product",product:"plus",limit:{type:"cumulative",current:i,total:"unlimited"}}};t??=l;const d=t.limit.total,u=t.upsell;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{children:(0,a.jsx)(s()._H,{id:"inviteUserButton.modalTooltip.guestLimitLine1",defaultMessage:"Your plan allows up to {currentLimit, plural, one {{currentLimit} unique guest} other {{currentLimit} unique guests}}.",values:{currentLimit:d}})}),"product"===u.type?(0,a.jsx)("div",{children:(0,a.jsx)(s()._H,{id:"inviteUserButton.modalTooltip.guestLimitLine2upgrade",defaultMessage:"Upgrade to get up to {upsellLimit, plural, one {{upsellLimit} guest} other {{upsellLimit} guests}}",values:{upsellLimit:u.limit.total}})}):(0,a.jsx)(s()._H,{id:"inviteUserButton.modalTooltip.guestLimitLine2contactSales",defaultMessage:"Contact sales to get more guests"})]})}},440633:(e,t,i)=>{i.d(t,{ZP:()=>O,A4:()=>F});i(670560),i(267602),i(653476),i(241792),i(228244);var n=i(667294),s=()=>i(219727),o=()=>i(142735),r=()=>i(816512),a=()=>i(989478),l=()=>i(955620),d=()=>i(788860),u=()=>i(513670),c=()=>i(589024),p=()=>i(352230),m=()=>i(846550),v=()=>i(446866),g=()=>i(674462),h=()=>i(958432),y=()=>i(395362),f=()=>i(253368),x=()=>i(827973),b=()=>i(448419),S=()=>i(838003),T=()=>i(838367),w=()=>i(388284),C=()=>i(876822),M=()=>i(257934),k=()=>i(697623),j=()=>i(416121),_=()=>i(695793),I=()=>i(65217),R=i(785893);function P(e){const t=(0,o().qz)(void 0,M().ZP),i=(0,o().qz)(void 0,_().Z),{store:r,inputValue:l,intl:u,propertySchemaLimit:p,isLoading:P,handlePersonPropertyMenuChange:U,format:B}=e,Z=(0,s().O7)(),E=(0,m().yK)((e=>({moreBarTitleStyle:{color:e.text.secondary,fontSize:11},inviteIconStyle:{width:20,height:20,fill:e.icon.primary},rightIconStyle:{width:20,height:20,fill:e.icon.secondary},desktopTitleStyle:{color:e.text.secondary,fontSize:11},messageBodyStyle:{color:e.text.tertiary,paddingLeft:2},messageTitleStyle:{color:e.text.tertiary},inviteBodyStyle:{color:e.text.primary}})),[]),{isMobile:V}=(0,s().Fy)(),D=(0,o().VK)((()=>{var e;return null===(e=C().default.state.currentSpaceStore)||void 0===e?void 0:e.getName()}),[]),A=(0,o().VK)((()=>i.state.flowId),[i]),{email:L,isEmail:H,inviteButtonTitle:K}=(0,n.useMemo)((()=>{const e=(0,v().H3)(l),t=(0,v().oH)(e),i=u.formatMessage({id:"invite.person_property.button.invite_people",defaultMessage:"Invite people"}),n=u.formatMessage({id:"invite.person_property.button.invite_email",defaultMessage:"Invite ”{email}”"},{email:e});return{email:e,isEmail:t,inviteButtonTitle:t?n:i}}),[l,u]),q=(0,n.useCallback)((()=>{H&&L&&j().handlePopupClickWithEmail({email:L,inviteTargetsStore:t}),y().P0(Z,{origin:"person_property_invite",invite_flow_id:A})}),[H,A,L,Z,t]),F=(0,n.useCallback)((()=>{y().Zv(Z,{origin:"person_property_invite",invite_flow_id:A})}),[A,Z]),O=(0,o().VK)((()=>{const e=function(e){const{canAddPermissions:t,isMobile:i,format:n}=e,s="enterprise"===e.subscriptionTier;if(i||s||!t||(0,c().xE)(n))return!1;return!0}({canAddPermissions:r.canEditMembership(),isMobile:V,subscriptionTier:(0,k().zt)(),format:B});return e&&y().x8(Z,{origin:"person_property_invite",invite_flow_id:A}),e}),[r,A,V,Z,B]),G=(0,o().VK)((()=>{if(!(0,c().xE)(B))return(0,f().$)(p)}),[B,p]);return O?(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(w().Z,{title:(0,R.jsx)(d()._H,{defaultMessage:"People",id:"database.personPropertyValue.selectPerson.noSearchResults.resultsTitle"}),desktopTitleStyle:E.desktopTitleStyle,loading:P,desktopStyle:{paddingBottom:4},children:(0,R.jsx)(T().Z,{title:(0,R.jsx)("span",{style:E.messageBodyStyle,children:(0,R.jsx)(d()._H,{defaultMessage:"No matches in {spaceName}",id:"database.personPropertyMenu.noSearchResults.messageWithSpaceName",values:{spaceName:D}})}),titleStyle:E.messageTitleStyle})}),(0,R.jsx)(w().Z,{title:(0,R.jsx)(d()._H,{defaultMessage:"More",id:"database.personPropertyValue.selectPerson.noSearchResults.suggestionTitle"}),desktopTitleStyle:E.moreBarTitleStyle,topBorder:!0,desktopStyle:{marginTop:0,paddingTop:10},children:(0,R.jsx)(S().Z,{focused:!1,stopClickPropagation:!0,popupType:b().Z4.Popup,renderOrigin:e=>(0,R.jsx)(x().Z,{...e,focused:!1,icon:(0,g().C)(E.inviteIconStyle),title:K,right:(0,h().C)(E.rightIconStyle),textWrapperStyle:E.inviteBodyStyle}),onClick:q,onClose:F,borderRadius:8,render:e=>(0,R.jsx)(I().Z,{inviteOrigin:"person_property_invite",store:r,handleBackButtonClick:()=>e.close(),inviteTargetsStore:t,personPropertyInviteStore:i,onInviteCompleteFn:t=>{e.close();const i=(t.success?Object.values(t.invitedUsers):[]).map((e=>({table:a().KJ,id:e})));U(i)}})})})]}):(0,R.jsx)(w().Z,{title:G,loading:P,children:(0,R.jsx)(T().Z,{title:(0,R.jsx)(d()._H,{defaultMessage:"No results",id:"database.personPropertyMenu.noSearchResults.message"})})})}var U=()=>i(828946),B=()=>i(682518),Z=()=>i(198829),E=()=>i(255577),V=()=>i(864832),D=()=>i(565271),A=()=>i(338855),L=()=>i(824462);var H=()=>i(981583);function K(e){let{environment:t,intl:i,store:n,isSyncedCollection:s,inputValue:o,value:l,format:c,propertySchema:p,handlePersonPropertyMenuAddMentions:m,sectionMenuTitle:v,externalSyncedCollectionType:g}=e;const h=async e=>{if(s&&e.emailAddress){const s=await U().x.searchActions.load(),o=await s.searchSpaceActors({environment:t,query:e.emailAddress,membersOnly:!1,userLocale:i.locale});if(1===o.users.length)m([{table:a().KJ,id:o.users[0].id}]);else{const i=await async function(e){let{environment:t,externalUser:i,blockPointer:n,externalSyncedCollectionType:s}=e;const o=await L().callApi({eventName:"getOrCreateNotionUserFromExternalUser",environment:t,data:{externalUser:(0,A().Nm)(i,s),blockPointer:n}});if(!(0,D().Hu)(o))return"success"===o.type?o.data.notionUser:void 0}({environment:t,externalUser:e,blockPointer:n.pointer,externalSyncedCollectionType:g});i&&m([{table:a().KJ,id:i.id}])}}},y={request:{query:o,actors:u().hX(l,r().Wk)},performRequest:async e=>{let{query:i,actors:s}=e;const o=await async function(e){let{environment:t,blockPointer:i,query:n}=e;const s=await L().callApi({eventName:"getExternalUsersForSyncedCollection",environment:t,data:{blockPointer:i,query:n}});return(0,D().Hu)(s)?[]:"success"===s.type?s.data.externalUsers:[]}({environment:t,blockPointer:n.pointer,query:i});return{externalUsers:o,type:"externalUsers"}},render:(e,t,i)=>{if(e)return(0,R.jsx)(w().Z,{title:v,loading:!i,children:(0,R.jsx)(T().Z,{title:(0,R.jsx)(d()._H,{...F.searchErrorMessage})})});if(t&&"externalUsers"!==t.type)return(0,R.jsx)(w().Z,{title:v,loading:!i,children:(0,R.jsx)(T().Z,{title:(0,R.jsx)(d()._H,{...F.searchErrorMessage})})});const n=u().oA((t&&t.externalUsers||[]).map((e=>{const t=(0,R.jsx)(H().Z,{avatar:{email:e.emailAddress,avatarUrl:"",name:e.displayName}});return{key:e.accountId,render:i=>(0,R.jsx)(x().Z,{...i,title:e.displayName,caption:e.emailAddress,icon:t}),action:async()=>{await h(e)}}}))),s=u().oA([n.length>0?{key:"external user section",render:e=>(0,R.jsx)(w().Z,{...e,title:(0,R.jsx)(d()._H,{defaultMessage:"Select user from Jira",id:"database.personPropertyValue.externalUsers.searchPlaceholder"}),loading:!i}),items:n}:void 0]);return(0,R.jsx)(E().ZP,{type:E().iW.Vertical,initialFocus:o.length>0?0:void 0,sections:s})}};return{...y}}var q=()=>i(122671);const F=(0,d().vU)({searchForPerson:{defaultMessage:"Search for a person…",id:"database.personPropertyValue.searchPlaceholder"},searchErrorMessage:{defaultMessage:"Something went wrong.",id:"database.personPropertyMenu.searchErrorMessage"}});const O=function(e){const t=(0,s().O7)(),m=(0,s().Fy)(),v=(0,d().YB)(),{disabled:g,value:h,format:y,valueIsUnpersistedDefaultValue:b,onChange:S,propertySchema:C,parentStore:M,onDismiss:k,isTemplatePage:j,insertChar:_,formQuestionStore:I,collectionStore:D}=e,[A,L]=(0,n.useState)((()=>_||"")),H=(0,o().VK)((()=>{if(!(0,c().xE)(y))return(0,f().$)(C.limit)}),[y,C.limit]),O=(0,o().VK)((()=>{const e=C.limit;return(0,c().xE)(y)&&I?(0,i(491925).vp)(C,I):e}),[I,y,C]),G=(0,o().VK)((()=>void 0!==O&&h.length>=O),[O,h]),W=(0,n.useCallback)((e=>{!function(e){let{newMentions:t,tokenLimit:i,value:n,valueIsUnpersistedDefaultValue:s,onChange:o}=e;1===i&&t.length>0?o({type:"personPropertyMenuUpdateReplacePerson",newValue:t[0]}):void 0===i?o(s?{type:"personPropertyMenuUpdateAddPerson",newValues:[...n,...t]}:{type:"personPropertyMenuUpdateAddPerson",newValues:t}):t.length+n.length<=i&&o({type:"personPropertyMenuUpdateAddPerson",newValues:t})}({newMentions:e,tokenLimit:O,value:h,valueIsUnpersistedDefaultValue:b,onChange:S}),L("")}),[S,O,h,b]),{tokens:z,selectedTemplateAnnotationVariables:N}=(0,o().VK)((()=>{const e=[];return{tokens:h.map((t=>{if((0,l().D4X)(t))return e.push(t),(0,R.jsx)(B().w,{templateVariableType:t,showRemoveButton:!g,onRemove:()=>{S({type:"personPropertyMenuUpdateRemovePerson",removedValue:t})},style:{margin:"0px 6px 6px 0px"}},t);if((0,r().Wk)(t)){const e=(0,r().Hl)({pointer:t,getRecordValue:M.getRecordValue});return(0,R.jsx)(V().ZP,{actor:e,format:m.isMobile?V().ZP.Format.Large:V().ZP.Format.Medium,showRemoveButton:!g,onClickRemove:()=>{S({type:"personPropertyMenuUpdateRemovePerson",removedValue:t})},shouldShrink:!0,isSingle:!1},t.id)}(0,i(696459).t1)(t)})),selectedTemplateAnnotationVariables:e}}),[m.isMobile,g,S,M.getRecordValue,h]),Y=l().s8k.filter((e=>!N.includes(e))),Q=(0,o().VK)((()=>{const e=Boolean(D&&D.isExternallyImportedAndSyncedCollection()&&(null==D?void 0:D.getFormat().external_collection_type)),n=null==D?void 0:D.getFormat().external_collection_type;if((0,i(148976).Uo)()&&e&&n)return K({environment:t,intl:v,store:M,isSyncedCollection:e,inputValue:A,value:h,format:y,propertySchema:C,handlePersonPropertyMenuAddMentions:W,sectionMenuTitle:H,externalSyncedCollectionType:n});const s={request:{query:A,actors:u().hX(h,r().Wk)},performRequest:async e=>{let{query:i,actors:n}=e;const s=await U().x.searchActions.load(),{users:o}=await s.searchSpaceActors({environment:t,query:i,membersOnly:!1,userLocale:v.locale});return{users:o.filter((e=>!n.some((t=>t.id===e.id)))).slice(0,20),type:"notionUsers"}},render:(e,t,n)=>{if(e)return(0,R.jsx)(w().Z,{title:H,loading:!n,children:(0,R.jsx)(T().Z,{title:(0,R.jsx)(d()._H,{...F.searchErrorMessage})})});if(t&&"notionUsers"!==t.type)return(0,R.jsx)(w().Z,{title:H,loading:!n,children:(0,R.jsx)(T().Z,{title:(0,R.jsx)(d()._H,{...F.searchErrorMessage})})});if(t&&0===t.users.length)return(0,R.jsx)(P,{store:M,inputValue:A,intl:v,propertySchemaLimit:C.limit,isLoading:!n,format:y,handlePersonPropertyMenuChange:e=>{W(e)}});const s=!(G&&O&&O>1),o=u().oA((t&&t.users||[]).map((e=>{const t={key:e.id,render:t=>(0,R.jsx)(i(654133).Z,{disableTooltip:s,renderTooltip:()=>(0,R.jsx)(d()._H,{defaultMessage:"To select more, remove selection above",id:"database.personPropertyMenu.limitReached"}),render:n=>(0,R.jsx)(i(523516).Z,{...t,actor:(0,r().dp)(e),disabled:!s,disabledFeedback:!s,customUserTitleStyles:m.isMobile?{fontSize:16}:void 0,...n})}),action:()=>{W([{table:a().KJ,id:e.id}])}};return t}))),l=u().oA([o.length>0?{key:"person section",render:e=>(0,R.jsx)(w().Z,{...e,title:H,loading:!n}),items:o}:void 0]);return(0,R.jsx)(E().ZP,{type:E().iW.Vertical,initialFocus:A.length>0?0:void 0,sections:l})}};return s}),[D,A,h,t,v,M,y,C,W,H,G,O,m.isMobile]),$=(0,R.jsx)(q().ZP,{focus:!m.isMobile||void 0,focusAfterAnimation:!0,format:q().UR.Person,tokens:z,placeholder:v.formatMessage(F.searchForPerson),hideInput:g,onRemoveLastToken:()=>{S({type:"personPropertyMenuUpdateRemovePerson",removedValue:h[h.length-1]})},value:A,onChange:e=>L(e.target.value),dontShowBorderBottom:m.isAndroid});let X;return X=m.isMobile?{menuType:p().o.Modal,title:C.name,right:(0,R.jsx)(i(470386).DoneMenuText,{}),onClickRight:k,header:$}:{menuType:p().o.Popup,header:$,tokenInputHeader:!0,maxHeight:333},g?(0,R.jsx)(Z().Z,{...X}):(0,R.jsxs)(Z().Z,{...X,children:[j&&(0,R.jsx)(w().Z,{title:(0,R.jsx)(d()._H,{defaultMessage:"Shortcuts",id:"PersonPropertyMenu.menuItem.shortcuts.label"}),children:Y.length>0?(0,R.jsx)(n.Fragment,{children:Y.map((e=>(0,R.jsx)(x().Z,{focused:!1,title:(0,R.jsx)(B().w,{templateVariableType:e}),caption:(0,i(727207).Z0)(e,v),inline:!0,onClick:()=>{W([e])}},`relative-person-shortcut-${e}`)))}):(0,R.jsx)(T().Z,{title:(0,R.jsx)(d()._H,{id:"database.personPropertyMenu.noShorcuts.message",defaultMessage:"No shortcuts"})})}),(0,R.jsx)(i(154439).Z,{...Q})]})}},436732:(e,t,i)=>{i.d(t,{Z:()=>d});i(241792),i(667294);var n=()=>i(846550),s=()=>i(998901),o=()=>i(154186),r=()=>i(654133),a=i(785893);function l(e){const{isFirst:t,isLast:i,isSelected:l,item:d,itemStyle:u,selectedItemStyle:c,innerStyle:p,children:m,colors:v,onClick:g}=e,{isDisabled:h,tooltip:y}=d,f=(0,n().yK)((e=>{const n=(null==v?void 0:v.selectedOutline)??e.blueColor,s=(null==v?void 0:v.unselectedOutline)??e.selectorBorderUnselected;return{SegmentedItem:{alignItems:"center",background:l?null==v?void 0:v.selectedBackground:void 0,borderBottomLeftRadius:t?3:0,borderBottomRightRadius:i?3:0,borderColor:l?n:s,borderStyle:"solid",borderTopLeftRadius:t?3:0,borderTopRightRadius:i?3:0,borderWidth:1,cursor:h?void 0:"pointer",display:"flex",flexBasis:"50%",marginLeft:t?0:-1,padding:0,userSelect:"none",zIndex:l?10:0,...u,...l?c:void 0},Inner:{borderBottomLeftRadius:t?2:0,borderBottomRightRadius:i?2:0,borderColor:l?n:"transparent",borderStyle:"solid",borderTopLeftRadius:t?2:0,borderTopRightRadius:i?2:0,borderWidth:1,display:"flex",flexDirection:"column",height:"100%",justifyContent:"center",padding:"12px 20px",textAlign:"center",width:"100%",...p}}}),[null==v?void 0:v.selectedBackground,null==v?void 0:v.selectedOutline,null==v?void 0:v.unselectedOutline,t,i,l,h,u,c,p]),x=()=>{g&&g(d.key)};return(0,a.jsx)(r().Z,{render:e=>(0,a.jsx)(o().Z,{ariaLabel:d.ariaLabel,"aria-pressed":l,onClick:x,style:f.SegmentedItem,disabled:h,...e,children:(0,a.jsx)("div",{style:f.Inner,children:m})}),renderTooltip:()=>(0,a.jsx)("div",{children:y}),disableTooltip:l||void 0===y,placement:s().Placement.Bottom})}function d(e){const{items:t=[],itemStyle:i,selectedItemStyle:s,innerStyle:o,outerStyle:r,value:d,onChange:u,colors:c}=e,p=(0,n().yK)((e=>({SegmentedButton:{background:e.cardContentBackground,display:"flex",width:"100%",...r}})),[r]);return 0===t.length?null:(0,a.jsx)("div",{style:p.SegmentedButton,children:t.map(((e,n)=>(0,a.jsx)(l,{isFirst:0===n,isLast:n===t.length-1,isSelected:e.key===d,item:e,itemStyle:i,selectedItemStyle:s,innerStyle:o,colors:c,onClick:u,children:e.render()},e.key)))})}},816563:(e,t,i)=>{i.d(t,{H:()=>c});i(667294);var n=()=>i(219727),s=()=>i(846550),o=()=>i(647439),r=()=>i(707513),a=()=>i(641506),l=()=>i(507159),d=()=>i(1910),u=i(785893);function c(e){const{label:t,onClickBackButton:i,onClose:c,width:p,showBottomBorder:m}=e,v=(0,n().O7)(),g=(0,s().yK)((e=>({container:{display:"flex",alignItems:"center",gap:4,height:40,width:p??320,paddingLeft:8,paddingRight:8,borderBottom:m?`1px solid ${e.regularDividerColor}`:void 0},backButton:{width:24,height:24},closeButton:{position:"absolute",right:0,marginRight:8,borderRadius:"100%"},menuTitle:{flexGrow:1,fontWeight:r().Ue.semibold,fontSize:(0,a().yv)(v,"UIRegular")}})),[v,m,p]);return(0,u.jsxs)("div",{style:g.container,children:[(0,u.jsx)(d().Z,{icon:o().W,ariaLabel:"back",onClick:()=>i(),style:g.backButton}),(0,u.jsx)("div",{style:g.menuTitle,children:t}),(0,u.jsx)(l().Z,{onClose:()=>c(),style:g.closeButton})]})}},799026:(e,t,i)=>{i.d(t,{r:()=>u});i(667294);var n=()=>i(219727),s=()=>i(142735),o=()=>i(816512),r=()=>i(501274),a=()=>i(788860),l=()=>i(67961),d=i(785893);function u(e){const{getRecordModel:t,actorPointer:i,lastVerifiedDate:u}=e,c=(0,n().Fy)(),p=(0,a().YB)(),m=(0,s().VK)((()=>(0,o().$4)(p,(0,o().Hl)({pointer:i,getRecordModel:t}))),[t,p,i]);return(0,d.jsxs)("div",{style:{padding:"8px 14px"},children:[(0,d.jsx)(l().Z,{isSmall:!0,isSecondaryColor:!0,isMobile:c.isMobile,isMultiline:!0,style:{marginBottom:4},children:(0,d.jsx)(a()._H,{defaultMessage:"Last verified by {user}",id:"VerificationMetadata.lastVerified",values:{user:m}})}),(0,d.jsx)(l().Z,{isSmall:!0,isSecondaryColor:!0,isMobile:c.isMobile,children:(0,r().mb)({dateTime:u,intl:p})})]})}},75283:(e,t,i)=>{i.d(t,{O:()=>A});var n=i(667294),s=()=>i(219727),o=()=>i(846550),r=()=>i(874459),a=()=>i(998411),l=()=>i(989478),d=()=>i(496205),u=()=>i(788860),c=()=>i(594546),p=()=>i(352230),m=()=>i(749826),v=()=>i(198829),g=()=>i(470386),h=()=>i(816563),y=()=>i(328714),f=()=>i(827973),x=()=>i(388284),b=i(785893);function S(e){const{onClick:t}=e,i=(0,o().yK)((e=>({buttonStyle:{color:e.text.uiRedPrimary,fontSize:14}})),[]);return(0,b.jsx)(x().Z,{topBorder:!0,children:(0,b.jsx)(f().Z,{focused:!1,icon:(0,y().U)({width:14,marginLeft:0}),title:(0,b.jsx)(u()._H,{defaultMessage:"Remove verification",id:"VerificationPropertyOverlayMenu.removeVerificationButton"}),onClick:t,style:i.buttonStyle})})}var T=()=>i(730120),w=()=>i(142735),C=()=>i(718959),M=()=>i(527278),k=()=>i(987798),j=()=>i(296034);const _=(0,u().vU)({placeholder:{id:"VerificationExpiryMenu.pickSpecificDate.placeholder",defaultMessage:"Pick a date"}});function I(e){const{onChange:t,clearCustomDatePicker:i,verificationState:s,addExtraTopPadding:a}=e,l=(0,n.useRef)(e.today),d=(0,n.useRef)(e.today.plus({days:1})),[u,c]=(0,n.useState)(!1),p=(0,w().Kw)(C().AK),m="verified"!==s.type||s.isIndefinite?void 0:s.dateTimeRange.end,v=(0,o().yK)((e=>({containerStyle:{paddingTop:a?12:4,paddingBottom:12},mobileContainerStyle:{paddingBottom:10}})),[a]);return(0,b.jsxs)(x().Z,{mobileStyle:v.mobileContainerStyle,style:v.containerStyle,children:[(0,b.jsx)(k().Z,{placeholder:M().Z.formatMessage(_.placeholder),focused:u,value:"verified"!==e.verificationState.type||e.verificationState.isIndefinite?void 0:r().ME(e.verificationState.dateTimeRange.end),onUpdate:e=>{if(e.error)return;const n=e.value&&r().XI(e.value);n?t({start:l.current,end:n.start}):i()},onFocus:()=>c(!0),onBlur:()=>c(!1),onClearButtonClick:i,hideClearButton:!0}),(0,b.jsx)(j().Z,{firstDayOfWeek:p,value:(null==m?void 0:m.toMillis())||d.current.toMillis(),selectValue:Boolean(m),onChange:e=>{t({start:l.current,end:T().ou.fromMillis(e)})},disabledDays:{before:new Date(d.current.toMillis())}})]})}i(241792);var R=()=>i(471500),P=()=>i(135796);const U=(0,i(827282).IU)("infinity",{viewBox:"0 0 40 19",svg:(0,b.jsx)("path",{d:"M0.297852 9.42383C0.297852 11.2695 0.65918 12.876 1.38184 14.2432C2.11426 15.6104 3.13477 16.6748 4.44336 17.4365C5.75195 18.1885 7.26562 18.5645 8.98438 18.5645C10.3613 18.5645 11.6504 18.2715 12.8516 17.6855C14.0625 17.0898 15.2881 16.1963 16.5283 15.0049L20 11.6504L23.4717 15.0049C24.7119 16.1963 25.9375 17.0898 27.1484 17.6855C28.3594 18.2715 29.6484 18.5645 31.0156 18.5645C32.7344 18.5645 34.248 18.1885 35.5566 17.4365C36.8652 16.6748 37.8809 15.6104 38.6035 14.2432C39.3359 12.876 39.7021 11.2695 39.7021 9.42383C39.7021 7.57812 39.3359 5.97168 38.6035 4.60449C37.8809 3.2373 36.8652 2.17773 35.5566 1.42578C34.248 0.664062 32.7344 0.283203 31.0156 0.283203C29.6484 0.283203 28.3594 0.581055 27.1484 1.17676C25.9375 1.7627 24.7119 2.65137 23.4717 3.84277L20 7.19727L16.5283 3.84277C15.2881 2.65137 14.0625 1.7627 12.8516 1.17676C11.6504 0.581055 10.3613 0.283203 8.98438 0.283203C7.26562 0.283203 5.75195 0.664062 4.44336 1.42578C3.13477 2.17773 2.11426 3.2373 1.38184 4.60449C0.65918 5.97168 0.297852 7.57812 0.297852 9.42383ZM3.5791 9.42383C3.5791 8.23242 3.80371 7.19727 4.25293 6.31836C4.71191 5.43945 5.34668 4.76074 6.15723 4.28223C6.96777 3.80371 7.91016 3.56445 8.98438 3.56445C9.88281 3.56445 10.752 3.78418 11.5918 4.22363C12.4316 4.66309 13.3154 5.3125 14.2432 6.17188L17.7002 9.42383L14.2285 12.6758C13.3105 13.5352 12.4316 14.1846 11.5918 14.624C10.752 15.0635 9.88281 15.2832 8.98438 15.2832C7.91016 15.2832 6.96777 15.0439 6.15723 14.5654C5.34668 14.0869 4.71191 13.4082 4.25293 12.5293C3.80371 11.6406 3.5791 10.6055 3.5791 9.42383ZM22.2998 9.42383L25.7568 6.17188C26.6846 5.3125 27.5684 4.66309 28.4082 4.22363C29.248 3.78418 30.1172 3.56445 31.0156 3.56445C32.0898 3.56445 33.0322 3.80371 33.8428 4.28223C34.6533 4.76074 35.2832 5.43945 35.7324 6.31836C36.1914 7.19727 36.4209 8.23242 36.4209 9.42383C36.4209 10.6055 36.1914 11.6406 35.7324 12.5293C35.2832 13.4082 34.6533 14.0869 33.8428 14.5654C33.0322 15.0439 32.0898 15.2832 31.0156 15.2832C30.1172 15.2832 29.248 15.0635 28.4082 14.624C27.5684 14.1846 26.6895 13.5352 25.7715 12.6758L22.2998 9.42383Z"})});var B=()=>i(501274),Z=()=>i(188296);function E(e){const{verificationState:t,onChange:i,onCustomDateClick:s,showTitle:r,showUpsell:a}=e,l=(0,u().YB)(),c=(0,n.useRef)(e.today),p=(0,o().yK)((e=>({title:{fontSize:14,color:e.regularTextColor},disabledTitle:{color:e.mediumTextColor},disabledCaption:{color:e.lightTextColor},optionsContainer:{width:"100%"},clockIconStyle:{width:14,marginLeft:0,marginTop:2},upsellContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 14px",gap:8,border:`1px solid ${e.regularDividerColor}`,borderRadius:8,margin:"8px 8px 4px 8px"},upsellText:{fontSize:14,color:e.regularTextColor,flex:1},disabledButton:{color:e.lightTextColor}})),[]),m="expired"===t.type||"none"===t.type?(0,b.jsx)(u()._H,{defaultMessage:"Verify page",id:"VerificationExpiryPicker.verify.header"}):(0,b.jsx)(u()._H,{defaultMessage:"Reverify page",id:"VerificationExpiryPicker.reverify.header"}),v="verified"===t.type&&t.isIndefinite,g="verified"===t.type&&!t.isIndefinite&&t.dateTimeRange.end,h=Boolean(a);return(0,b.jsxs)("div",{children:[a&&(0,b.jsxs)("div",{style:p.upsellContainer,children:[(0,b.jsx)("div",{style:p.upsellText,children:(0,b.jsx)(u()._H,{defaultMessage:"Upgrade to unlock",id:"VerificationExpiryPicker.upsellExperience"})}),(0,b.jsx)(Z().Z,{subscriptionTier:"business",analyticsName:"verification_upsell_item_page_entrypoint"})]}),(0,b.jsxs)(x().Z,{title:r&&m,children:[d().Xs.map((e=>{const t=g&&d().fm({start:c.current,end:g})===e;return(0,b.jsx)(f().Z,{buttonStyle:h?p.disabledButton:void 0,disabled:h,focused:!1,icon:(0,R().m)(p.clockIconStyle),inline:!1,title:(0,b.jsx)("span",{style:h?p.disabledTitle:p.title,children:(0,b.jsx)(u()._H,{defaultMessage:"For {numDays} days",id:"VerificationExpiryMenu.preset.title",values:{numDays:e}})}),caption:l.formatMessage({defaultMessage:"Until {date}",id:"VerificationExpiryMenu.preset.subtitle"},{date:B().mb({dateTime:d().z5(e,c.current).end,intl:l,shortenDateAndRange:!0})}),captionStyle:h?p.disabledCaption:void 0,checkState:!!t,onClick:()=>{return t=e,void i({start:c.current,end:c.current.plus({days:t})});var t}},e)})),(0,b.jsx)(f().Z,{buttonStyle:h?p.disabledButton:void 0,disabled:h,focused:!1,icon:U({width:14,marginLeft:0,marginTop:1}),inline:!1,title:(0,b.jsx)("span",{style:h?p.disabledTitle:p.title,children:(0,b.jsx)(u()._H,{defaultMessage:"Indefinitely",id:"VerificationExpiryPicker.option.indefinitely"})}),onClick:()=>i(),checkState:v},"indefinite"),(0,b.jsx)(f().Z,{buttonStyle:h?p.disabledButton:void 0,disabled:h,focused:!1,icon:(0,P().C)({width:14,marginLeft:0}),title:(0,b.jsx)("span",{style:h?p.disabledTitle:p.title,children:(0,b.jsx)(u()._H,{defaultMessage:"Pick a date",id:"VerificationExpiryPicker.option.customDate"})}),onClick:s},"custom")]})]})}var V=()=>i(799026),D=()=>i(783901);function A(e){const{verificationValue:t,getRecordModel:i,onChange:c,blockId:m,propertyName:y,onClose:f,showTitle:x,showRemoveVerificationButton:T,showVerificationFooter:w,showCurrentStatusHeader:C,showCustomHeader:M,customHeader:k,showUpsell:j}=e,_=(0,s().O7)(),R=(0,s().Fy)(),P=(0,u().YB)(),[U,B]=(0,n.useState)(!1),Z=(0,n.useMemo)((()=>d().WN(t)),[t]),A="verified"===Z.type,H=(0,n.useRef)(r().Uu((0,a().r)())),K=(0,n.useRef)(r().Uu((0,a().r)()).plus({days:1})),q=e=>{var t;const i=null===(t=_.currentUser)||void 0===t?void 0:t.id;if(!i)return;if(null!=e&&e.end&&e.end.toMillis()<K.current.toMillis())return;const n={table:l().KJ,id:i},s=e?r().OQ.toPersistedDateTimeRange(e):r().OQ.toPersistedDateTime(H.current.toMillis()),o="none"===Z.type?"add":"update";L(_,{action:o,verification_page_id:m,verification_expiry:e?e.end.toMillis():void 0}),c({value:[n,s]})},F=(0,o().yK)((e=>({footerStyle:{borderTop:`1px solid ${e.regularDividerColor}`},headerStyle:{padding:R.isMobile?10:7,paddingLeft:R.isMobile?20:7,background:R.isMobile?e.popoverBackground:e.tokenInputMenuItemBackground,display:"flex",alignItems:"center",borderBottom:`1px solid ${e.regularDividerColor}`}})),[R.isMobile]);let O={menuType:p().o.Popup,footer:w&&"none"!==Z.type&&(0,b.jsx)("div",{style:F.footerStyle,children:(0,b.jsx)(V().r,{lastVerifiedDate:A&&Z.isIndefinite?Z.startDateTime:Z.dateTimeRange.start,getRecordModel:i,actorPointer:Z.actorPointer})})};R.isMobile&&(O={...O,title:y,menuType:p().o.Modal,right:(0,b.jsx)(g().DoneMenuText,{}),onClickRight:f});return(0,b.jsxs)(b.Fragment,{children:[M&&k&&!U?k:M&&U?(0,b.jsx)(h().H,{label:P.formatMessage({id:"verificationPropertyOverlay.verificationMenuHeader.pickDate",defaultMessage:"Pick a date"}),onClickBackButton:()=>B(!1),onClose:()=>f(),width:265,showBottomBorder:!1}):null,(0,b.jsx)(v().Z,{...O,header:!U&&C&&"none"!==Z.type&&(0,b.jsx)("div",{style:F.headerStyle,children:(0,b.jsx)(D().z,{verificationValue:t})}),children:U?(0,b.jsx)(I,{today:H.current,verificationState:Z,onChange:e=>q(e),clearCustomDatePicker:()=>B(!1),addExtraTopPadding:!M}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(E,{today:H.current,verificationState:Z,onChange:e=>q(e),onCustomDateClick:()=>B(!0),showTitle:x,showUpsell:j}),T&&(A||"expired"===Z.type)&&(0,b.jsx)(S,{onClick:()=>{L(_,{action:"remove",verification_page_id:m}),c({value:void 0})}})]})})]})}function L(e,t){c().K4(e,"verification_update",t),m().default.logEvent("verification_update",t.action)}},17922:(e,t,i)=>{i.d(t,{Z:()=>a});var n=()=>i(239482),s=()=>i(852465),o=()=>i(345918);function r(e,t){return(0,o().Q6)(e)?{isGuestRequestRequired:!0}:t?{isStoreInTeam:!0,teamAllowsGuests:!0,spaceAllowsGuests:!0,isGuestRequestRequired:!1}:{isStoreInTeam:!1,spaceAllowsGuests:!0,isGuestRequestRequired:!1}}const a=function(e){return(0,i(142735).VK)((()=>{if((0,s().R$)(e))return{isStoreInTeam:!1,spaceAllowsGuests:!0,isGuestRequestRequired:!1};if(!(0,s().OY)(e))return(0,o().kt)(e)?r(e,void 0):{isStoreInTeam:!1,spaceAllowsGuests:!0,isGuestRequestRequired:!1};const t=(0,n().VP)(e),a=(0,n().Pj)(e),l=a||i(876822).default.state.currentSpaceStore;if((0,o().kt)(l))return r(l,t);const d=!(null!=a&&a.getDisableGuests());return t?{isStoreInTeam:!0,teamAllowsGuests:!t.getDisableGuests(),spaceAllowsGuests:d,isGuestRequestRequired:!1}:{isStoreInTeam:!1,spaceAllowsGuests:d,isGuestRequestRequired:!1}}),[e])}},551861:(e,t,i)=>{i.d(t,{S:()=>r});i(667294);var n=()=>i(788860),s=()=>i(17922),o=i(785893);function r(e){const t=(0,s().Z)(e);return t.isGuestRequestRequired?(0,o.jsx)(n()._H,{id:"contextualInvite.buttonAndTokenTooltip.guestRequestRequired",defaultMessage:"This guest must be approved by a workspace owner first"}):t.isStoreInTeam?t.teamAllowsGuests?void 0:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{children:(0,o.jsx)(n()._H,{id:"contextualInvite.buttonAndTokenTooltip.teamDisablesGuestsAlertLine1",defaultMessage:"This teamspace doesn't allow guests."})}),(0,o.jsx)("div",{children:(0,o.jsx)(n()._H,{id:"contextualInvite.buttonAndTokenTooltip.teamDisablesGuestsAlertLine2",defaultMessage:"Remove any guests to continue."})})]}):t.spaceAllowsGuests?void 0:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{children:(0,o.jsx)(n()._H,{id:"contextualInvite.buttonAndTokenTooltip.spaceDisablesGuestsAlertLine1",defaultMessage:"This workspace doesn't allow guests."})}),(0,o.jsx)("div",{children:(0,o.jsx)(n()._H,{id:"contextualInvite.buttonAndTokenTooltip.spaceDisablesGuestsAlertLine2",defaultMessage:"Remove any guests to continue."})})]})}},416121:(e,t,i)=>{i.r(t),i.d(t,{handleEnterPress:()=>k,handleGuestInvite:()=>w,handleMemberInvite:()=>T,handleMemberRequest:()=>C,handlePopupClickWithEmail:()=>j,inviteToSpaceAsMembers:()=>M,showMessageForInviteComplete:()=>_});i(670560),i(267602),i(653476),i(749411),i(241792),i(228244),i(667294);var n=()=>i(446866),s=()=>i(799891),o=()=>i(956057),r=()=>i(933868),a=()=>i(788860),l=()=>i(720866),d=()=>i(792409),u=()=>i(395362),c=()=>i(824462),p=()=>i(784234),m=()=>i(849129),v=()=>i(102182),g=()=>i(532146),h=()=>i(581356),y=()=>i(122479),f=()=>i(18281),x=()=>i(697623),b=()=>i(174896),S=i(785893);async function T(e){const{environment:t,onInviteComplete:i,flowId:n,intl:o,spaceStore:r,invitedUsers:a,inviteTargetsStore:c,inviteOrigin:p,disable_invite_email:m}=e;let v={success:!1};try{v=await M({environment:t,spaceStore:r,invitedUsers:a,from:p,flowId:n,intl:o,inviteTargetsStore:c,disable_invite_email:m}),v.success?u().pR(t,{invited_user_count:Object.keys(v.invitedUsers).length,invite_flow_id:n,origin:p}):(u().S4(t,{invite_stage:"invite_member",invite_flow_id:n,error:v.error}),s().log({level:"error",from:"personPropertyInviteAction",type:"handleMemberInvite"}))}catch(g){const e=(0,l().t)(g);u().S4(t,{invite_stage:"invite_member",invite_flow_id:n,error:e}),s().log({level:"error",from:"personPropertyInviteAction",type:"handleMemberInvite",error:(0,d().Ui)(g)})}finally{null==i||i(v)}}async function w(e){const{environment:t,blockStore:i,inviteTargetsStore:a,sudoModeStore:c,onInviteComplete:m,inviteOrigin:v,role:g,emailMessage:f,flowId:x}=e;let b={success:!1};try{if(b=await async function(e){const{environment:t,blockStore:i,sudoModeStore:s,inviteTargetsStore:a,role:l,inviteOrigin:d,emailMessage:u,onInviteStart:c}=e,m=e.flowId||o().Il();if(!(0,r().iC)(l))return{success:!1};const{tokenQuery:v,inviteTargets:g}=a.state;if((0,n().oH)(v.trim())&&0===g.length){const e={type:"newUser",value:{email:v.trim()},source:"email"};h().H({target:e,inviteTargetsStore:a})||a.setState({inviteTargets:[...a.state.inviteTargets,e],tokenQuery:""})}const f=await y().mU(i,h().B({inviteTargetsStore:a}));null==c||c();const x=await p().n_({environment:t,store:i,sudoModeStore:s,inviteTargets:f,inviteRole:l,isOnboarding:!1,invite:{inviteFlowId:m,inviteMessage:u,inviteOrigin:d}});return x}({environment:t,blockStore:i,sudoModeStore:c,inviteTargetsStore:a,role:g,emailMessage:f,inviteOrigin:v,flowId:x}),!b.success)return}catch(S){const e=(0,l().t)(S);u().S4(t,{invite_stage:"invite_guest",invite_flow_id:x,error:e}),s().log({level:"error",from:"personPropertyInviteAction",type:"handleGuestInvite",error:(0,d().Ui)(S)})}finally{b.success&&u().Vi(t,{invited_user_count:Object.keys(b.invitedUsers).length,origin:v,invite_flow_id:x}),null==m||m(b)}return b}async function C(e){const{environment:t,spaceStore:i,originId:n,originType:o,reasonMessage:r,intl:a,flowId:d,onInviteComplete:p,invitedUsers:m,inviteOrigin:h}=e,y=[];let f={success:!1};try{const e=Object.entries(m).map((e=>{let[s,a]=e;return c().callApi({eventName:"requestAccess",environment:t,data:{type:"actor-to-space",forActorId:a,spaceId:i.id,message:r,attributes:{origin_id:n,origin_type:o,origin_table:"block",add_permissions_on_approval:!1}}}).catch((()=>y.push([s,a])))}));await Promise.all(e),f={success:!0,invitedUsers:m,requestedUsers:{}}}catch(x){const e=(0,l().t)(x);return u().S4(t,{invite_stage:"request_member",invite_flow_id:d,error:e}),function(e,t){const i=Object.keys(t);if(0===i.length)return;v().oV({label:e.formatMessage({id:"contextual_invite.request_members_failure",defaultMessage:"Failed to request {users} to become members"},{users:(0,g().W)(i)})})}(a,m),s().log({level:"error",from:"personPropertyInviteAction",type:"handleMemberRequest",data:{miscDataToConvertToString:{inviteTargetEmailsWithErrors:y}}}),f}finally{f.success&&u().TJ(t,{invited_user_count:Object.keys(f.invitedUsers).length,origin:h,invite_flow_id:d}),null==p||p(f)}return f}async function M(e){const{environment:t,spaceStore:i,from:n,invitedUsers:o,intl:r,flowId:a,onInviteStart:l,inviteTargetsStore:d,disable_invite_email:u}=e,c=function(e){const t=[];if(!e)return t;for(const[i,n]of Object.entries(e))t.push({type:"existingUser",value:{id:n,email:i,version:1}});return t}(o),m=function(e){return e.state.inviteTargets.filter((e=>"newUser"===e.type))}(d),h=[...c];for(const s of m){c.some((e=>e.value.email===s.value.email))||h.push(s)}const y=(0,x().zt)(),S=y&&(0,f().o9)(y)?"editor":e.inviteRole??"read_and_write";let T={success:!1};if(!i.isTeamsEnabled()){if(!(await b().HD({environment:t,flowId:a,trackCreateTeamComplete:!1})))return T}try{null==l||l(),T=await p().n_({environment:t,store:i,inviteTargets:h,inviteRole:S,isOnboarding:!1,invite:{inviteOrigin:n,inviteFlowId:a,disable_invite_email:u}})}catch(w){return function(e,t){0!==t.length&&v().oV({label:e.formatMessage({id:"contextual_invite.contextual_invite_failure",defaultMessage:"{userCount, plural, one {Failed to invite {users} as member} other {Failed to invite {users} as members}}"},{users:(0,g().W)(t.flatMap((e=>e.value.email||[]))),userCount:t.length})})}(r,h),s().log({level:"error",from:"contextualInviteHelpers",type:"inviteMembers.inviteTargets",data:{miscDataToConvertToString:{usersToInviteAsMembers:h}}}),T}return T}async function k(e){const{environment:t,inviteTargetsStore:i,allowShowEmptyError:s,personPropertyInviteStore:o}=e,r=i.state.tokenQuery;if(""===r)return void(0===i.state.inviteTargets.length&&s&&o.setState({...o.state,showEmptyError:!0}));const a=(0,n().CU)(r),l=await m().M5(t,a);let d=[];0===l.length&&(d=[{type:"invalidUser",value:{text:r}}]);const u=l.filter((e=>!h().H({inviteTargetsStore:i,target:e}))),c=[...i.state.inviteTargets,...u,...d];i.setState({...i.state,inviteTargets:c,tokenQuery:""})}function j(e){const{email:t,inviteTargetsStore:i}=e,n={type:"newUser",value:{email:t},source:"email"},s=[...i.state.inviteTargets];h().H({inviteTargetsStore:i,target:n})||s.push(n),i.setState({...i.state,inviteTargets:s})}function _(e){const{success:t,invitedUserEmails:i,isRequestMember:n}=e;t?0!==i.length&&(n?v().oV({label:(0,S.jsx)(a()._H,{id:"shareMenu.inviteSuccess.snackbarMessage.sendMemberRequest",defaultMessage:"Successfully sent request to admin to invite {users}",values:{users:(0,g().W)(i)}})}):v().oV({label:(0,S.jsx)(a()._H,{id:"shareMenu.inviteSuccess.snackbarMessage",defaultMessage:"Successfully invited {users}",values:{users:(0,g().W)(i)}})})):v().oV({label:(0,S.jsx)(a()._H,{id:"shareMenu.inviteFailure.snackbarMessage",defaultMessage:"Failed to invite {users}",values:{users:(0,g().W)(i)}})})}},65217:(e,t,i)=>{i.d(t,{Z:()=>ae});var n=i(667294),s=()=>i(219727),o=()=>i(142735),r=()=>i(846550),a=()=>i(788860),l=()=>i(568017),d=()=>i(513670),u=()=>i(395362),c=()=>i(94967),p=()=>i(654133),m=()=>i(370005),v=()=>i(594777),g=()=>i(228772),h=()=>i(591914),y=(i(241792),()=>i(429394)),f=()=>i(122671),x=()=>i(257934),b=(i(122556),i(582845),i(250570),i(533019),i(721473),i(788208),i(22624),i(267602),i(30005),()=>i(38883)),S=()=>i(446866),T=()=>i(696459),w=()=>i(707513),C=()=>i(981583),M=()=>i(17922),k=()=>i(551861),j=()=>i(876822),_=()=>i(897257),I=i(785893);const R=function(e){const{store:t,target:n}=e,d=(0,s().Fy)(),u=(0,a().YB)(),c=function(e){const t=(0,r().yK)((()=>({verifiedDomain:{margin:2,backgroundColor:"rgba(83, 168, 63, 0.1)"},disabled:{margin:2,backgroundColor:"rgba(211, 79, 67, 0.1)",border:"dashed #D9655B 1px",paddingLeft:5},normal:{margin:2},guest:{margin:2,backgroundColor:"rgba(218, 163, 64, 0.2)"},error:{margin:2,backgroundColor:"rgba(195,90,75,0.2)",color:"#DE5550"},tokenContent:{display:"flex",alignItems:"center",maxWidth:"100%"},tokenSpan:{maxWidth:"100%"},tokenText:{marginLeft:4,...w().Yu},base:e?{borderRadius:4}:{}})),[e]);return t}((0,o().VK)((()=>(0,i(779733).wZ)()),[])),m=(0,o().VK)((()=>{const e=_().subscriptionDataStoreInstance.state,t=e?i(18281).CM(e):[],n={};return t.forEach((e=>{n[e.userId]=e})),n}),[]),v=(0,o().VK)((()=>{const e=j().default.state.currentSpaceStore;return new Set(null==e?void 0:e.getEmailDomains())}),[]),g=(0,M().Z)(t),h=(0,k().S)(t),y=(0,o().VK)((()=>{if("invalidUser"===n.type)return"invalidUser";if(e.tokenType)return e.tokenType;if("group"===n.type)return"group";if("existingUser"===n.type&&!Boolean(n.spaceRole)){const e=m[n.value.id];n.spaceRole=e?e.role:"not_in_space"}if(!(0,i(88476).OA)(n))return"member";if(g.isGuestRequestRequired)return"guestRequestRequired";if(g.isStoreInTeam&&!g.teamAllowsGuests)return"teamGuestDisabled";if(!g.isStoreInTeam&&!g.spaceAllowsGuests||g.isStoreInTeam&&!g.teamAllowsGuests&&!g.spaceAllowsGuests)return"spaceGuestDisabled";const t=(0,S().Gd)(n.value.email);return t&&v.has(t)?"verifiedDomain":"guest"}),[e.tokenType,n,m,v,g]),f=(0,o().VK)((()=>{const e=c.base;switch(y){case"member":case"group":return{...e,...c.normal};case"invalidUser":return{...e,...c.error};case"guest":case"guestRequestRequired":return{...e,...c.guest};case"verifiedDomain":return{...e,...c.verifiedDomain};case"spaceGuestDisabled":case"teamGuestDisabled":case"teamGroupOwner":return{...e,...c.disabled};default:(0,T().t1)(y)}}),[y,c]);function R(){switch(n.type){case"newUser":return n.value.email.trim();case"invalidUser":return n.value.text.trim();case"existingUser":return(0,i(499110).Nz)(u,n.value);case"group":return(0,i(907099).kF)({intl:u,groupName:n.value.name});default:(0,T().t1)(n)}}function P(){const e=(0,i(456681).m)({height:16,width:16,color:"#D34F43"});switch(y){case"member":return(0,x().fZ)(n)?(0,I.jsx)(C().Z,{userValue:n.value,size:16}):(0,x().KU)(n)?(0,I.jsx)(C().Z,{size:16,avatar:n.value}):(0,I.jsx)(C().Z,{size:16});case"guest":case"guestRequestRequired":return(0,i(81979).o)({height:16,width:16,color:"#DAA340"});case"invalidUser":return(0,i(280742)._)({height:16,width:16,color:"#DE5550"});case"verifiedDomain":return(0,i(840196).p)({height:16,width:16,color:"#53A83F"});case"group":return(0,I.jsx)("div",{style:{height:16,width:16,backgroundColor:l().ZP.whiteWithAlpha(.8),borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,i(923398).O)({height:12,width:12,color:l().ZP.mediumTextColor})});case"spaceGuestDisabled":case"teamGuestDisabled":case"teamGroupOwner":return e;default:(0,T().t1)(y)}}function U(t){const i=P();let n=R(),s=c.tokenText;return e.onlyShowTokenType&&(["guest","teamGuestDisabled","spaceGuestDisabled"].includes(t)?(n="Guest",s={...s,color:"#DAA340"}):(n="Member",s={...s,color:"#53A83F"})),(0,I.jsxs)("div",{style:c.tokenContent,children:[i,(0,I.jsx)("div",{style:s,children:n})]})}function B(t){var i;t.stopPropagation(),null===(i=e.onClickRemove)||void 0===i||i.call(e)}const Z="newUser"===n.type?n.value.email:"invalidUser"===n.type?n.value.text:n.value.id,E="group"!==n.type&&"invalidUser"!==n.type?n.value.email:void 0;return(0,I.jsx)(p().Z,{placement:i(998901).Placement.Top,renderTooltip:()=>function(e){const{tokenType:t,target:i,email:n}=e;return"guest"===t?(0,I.jsx)(a()._H,{defaultMessage:"{email} will be invited as a guest",id:"inviteTargetToken.guest.tooltip",values:{email:n}}):"spaceGuestDisabled"===t||"teamGuestDisabled"===t||"guestRequestRequired"===t?h:"invalidUser"===i.type?(0,I.jsx)(a()._H,{defaultMessage:"{text} is not a valid email",id:"inviteTargetToken.invalidUser.tooltip",values:{text:i.value.text}}):"verifiedDomain"===t&&"group"!==i.type?(0,I.jsx)(a()._H,{defaultMessage:"{email}{br}will automatically be added to the workspace{br}since @{domain} is an allowed email domain.",id:"inviteTargetToken.verifiedDomain.tooltip",values:{email:i.value.email,br:(0,I.jsx)("br",{}),domain:(0,S().Gd)(i.value.email)}}):"group"===i.type?i.value.name||(0,I.jsx)(a()._H,{defaultMessage:"Untitled group",id:"inviteTargetToken.group.untitled"}):n}({tokenType:y,email:E,target:n}),render:t=>(0,I.jsx)("div",{style:c.tokenSpan,...t,children:(0,I.jsx)(i(78014).Z,{isSingle:!1,format:d.isMobile?b().lo.Large:b().lo.Medium,showRemoveButton:e.showRemoveButton,onClickRemove:B,disabledFeedback:!0,value:U(y),style:f,shouldWrap:!1})})},Z)};const P=function(e){const{flowId:t,store:n,disabled:a,placeholder:u,right:c,focus:p,hideIconColorAndTooltips:m,showEmptyError:v,origin:g,onFocus:h,onSubmit:b,onInputChanged:S}=e,T=(0,s().O7)(),w=(0,s().Fy)(),C=(0,o().qz)(e.inviteTargetsStore,x().ZP),M=(0,o().VK)((()=>C.state.inviteTargets),[C]),k=(0,o().VK)((()=>C.state.tokenQuery),[C]),j=M.map((e=>{const t="newUser"===e.type?e.value.email:"invalidUser"===e.type?e.value.text:e.value.id;return(0,I.jsx)(R,{store:n,target:e,showRemoveButton:!0,tokenType:m?"member":void 0,onClickRemove:()=>y().P({inviteTargetsStore:C,targetToRemove:e})},t)})),_=(0,r().yK)((e=>({tokenSpan:{maxWidth:"100%"},tokenInputMenuItem:{paddingTop:j.length>0?4:6,paddingLeft:4,paddingRight:4,paddingBottom:4,borderRadius:4,minHeight:32,...p&&{background:"none"},...a&&{background:e.inputBackground,color:e.mediumTextColor,fill:l().ZP.white,opacity:.4}},inputAndTokenWrapRight:{gap:2},tokenInputMenuItemInput:{paddingTop:0},warningMessage:{color:"#DE5550"}})),[p,a,j]);return(0,I.jsx)(f().ZP,{focus:p,focusAfterAnimation:!0,onClick:()=>{w.isMobile||null==h||h()},format:f().UR.Share,value:k,onChange:e=>y().j({environment:T,event:e,inviteTargetsStore:C,inviteOrigin:g,flowId:t,onInputChanged:S}),type:"email",tokens:j,disabled:a,autoComplete:"off",placeholder:u,onRemoveLastToken:()=>{C.setState({...C.state,inviteTargets:C.state.inviteTargets.slice(0,-1)})},right:c,showBorder:!0,inputStyle:_.tokenInputMenuItemInput,inputAndTokenWrapRightStyle:_.inputAndTokenWrapRight,style:_.tokenInputMenuItem,onSubmit:b,inputFullWidth:!0,message:(0,I.jsx)(i(189783).z,{invalidInvites:(0,d().oA)(M.map((e=>"invalidUser"===e.type?e:void 0))),showEmptyError:v,styles:_.warningMessage})})};var U=()=>i(885414),B=()=>i(416121),Z=()=>i(695793),E=(i(821057),i(653476),i(228244),()=>i(933868)),V=()=>i(849129),D=()=>i(906651),A=()=>i(67961),L=()=>i(356380),H=()=>i(436732),K=()=>i(581356),q=()=>i(122479),F=()=>i(105459),O=()=>i(815277);function G(e){var t;const{store:i,sudoModeStore:r,personPropertyInviteStore:l,onInviteCompleteFn:d,inviteOrigin:c}=e,m=(0,s().O7)(),v=Y(),g=(0,o().qz)(e.inviteTargetsStore,x().ZP),h=(0,o().VK)((()=>l.state.isLoading),[l]),y=(0,n.useCallback)((e=>{l.setState({...l.state,isLoading:e,focus:Z().S.NoFocus})}),[l]),[f,b]=(0,n.useState)("member"),S=(0,o().VK)((()=>{const{emailMessage:e}=l.state;return e}),[l]),T=(0,o().VK)((()=>{const{role:e}=l.state;return e}),[l]),w=(0,a().YB)(),C=(0,o().VK)((()=>l.state.flowId),[l]),R=(0,o().VK)((()=>j().default.state.currentSpaceStore),[]),P=(0,o().VK)((()=>i.canEditMembership()),[i]),U=(0,o().VK)((()=>(0,K().B)({inviteTargetsStore:g})),[g]),D=(0,n.useCallback)((async()=>{await B().handleEnterPress({environment:m,inviteTargetsStore:g,personPropertyInviteStore:l,allowShowEmptyError:!0})}),[m,g,l]),A=(0,n.useCallback)((()=>{const e=(0,K().B)({inviteTargetsStore:g}),t=e.filter((e=>{let{type:t}=e;return"newUser"===t})).map((e=>{let{value:t}=e;return t.email})),i=e.filter((e=>{let{type:t}=e;return"existingUser"===t})).map((e=>{let{value:t}=e;return t.id}));return q().Xu({subscriptionData:_().subscriptionDataStoreInstance.state,newGuestIds:[...t,...i]})}),[g]),G=(0,o().VK)((()=>A()),[A]),Q=(0,o().Kw)(_().subscriptionDataStoreInstance),$=(0,F().Y)(Q),X=(0,o().VK)((()=>q().Z9(Q,$)),[$,Q]),J=(0,M().Z)(i),ee=(0,o().VK)((()=>{if(J.isGuestRequestRequired)return!1;const e=J.isStoreInTeam&&!J.teamAllowsGuests,t=!J.isStoreInTeam&&!J.spaceAllowsGuests||J.isStoreInTeam&&!J.teamAllowsGuests&&!J.spaceAllowsGuests,i=U.some((e=>"newUser"===e.type||("existingUser"===e.type?"none"===e.spaceRole||"not_in_space"===e.spaceRole:void 0)));return(e||t)&&i}),[U,J]),te=(0,o().VK)((()=>null==R?void 0:R.getRole()),[R]),ie=(0,o().VK)((()=>!(!te||!(0,E().RN)(te))&&!(!R||R.getDisableMembershipRequests())),[te,R]),ne=(0,O().VX)({name:"members",spaceId:null==R?void 0:R.id,userId:null===(t=m.currentUser)||void 0===t?void 0:t.id,amount:1}),se=Boolean(ne&&te&&(0,E().dy)(te));(0,n.useEffect)((()=>{b(se?"member":"guest")}),[se]);const oe=(0,k().S)(i),re=S.length>1e3,ae=(0,n.useCallback)((e=>{const{response:t,shouldDoCompleteFn:i,invitedUserEmails:n,isRequestMember:s}=e;t.success?i&&(u().Y7(m,{invited_user_count:n.length,is_success:t.success,can_add_member:se,invite_option:f,origin:c,invite_flow_id:C}),B().showMessageForInviteComplete({success:t.success,invitedUserEmails:n,isRequestMember:s}),y(!1),d(t)):(B().showMessageForInviteComplete({success:t.success,invitedUserEmails:n}),u().Y7(m,{invited_user_count:n.length,is_success:t.success,can_add_member:se,invite_option:f,origin:c}))}),[d,C,y,m,f,se,c]),le=(0,n.useCallback)((async e=>{const{invitedUserEmails:t,shouldDoCompleteFn:n}=e;return await B().handleGuestInvite({environment:m,inviteOrigin:c,role:T,emailMessage:S,inviteTargetsStore:g,blockStore:i,sudoModeStore:r,flowId:C,onInviteComplete:e=>{ae({response:e,shouldDoCompleteFn:n||!1,invitedUserEmails:t})}})}),[m,T,S,i,r,C,g,ae,c]),de=(0,n.useCallback)((async e=>{const{invitedUserEmails:t,disable_invite_email:i,guestInviteResponse:n,shouldDoCompleteFn:s}=e;if(!R)return null;const o=null!=n&&n.success?n.invitedUsers:void 0;await B().handleMemberInvite({environment:m,spaceStore:R,flowId:C,onInviteComplete:e=>{ae({response:e,shouldDoCompleteFn:s||!1,invitedUserEmails:t})},intl:w,invitedUsers:o,inviteTargetsStore:g,inviteOrigin:c,disable_invite_email:i})}),[R,m,C,g,w,ae,c]),ue=(0,n.useCallback)((async e=>{const{invitedUserEmails:t,guestInviteResponse:n}=e;if(!R)return null;const s=null!=n&&n.success?n.invitedUsers:void 0;s&&await B().handleMemberRequest({environment:m,spaceStore:R,originType:"person_property_invite",intl:w,invitedUsers:s,reasonMessage:void 0,originId:i.id,flowId:C,onInviteComplete:e=>{ae({response:e,shouldDoCompleteFn:!0,invitedUserEmails:t,isRequestMember:!0})},inviteOrigin:c})}),[m,C,R,w,ae,i,c]),ce=(0,n.useCallback)((async()=>{const e="member"===f,t=g.state.inviteTargets.filter((e=>"newUser"===e.type||"existingUser"===e.type)).map((e=>e.value.email));if(0===t.length)return void u().S4(m,{invite_stage:"click_invite_button",invite_flow_id:C,error:"No valid input emails"});const i=A();if(y(!0),e)if(i)await de({invitedUserEmails:t,disable_invite_email:!1,guestInviteResponse:void 0,shouldDoCompleteFn:!0});else{const e=!se&&!ie,i=await le({invitedUserEmails:t,shouldDoCompleteFn:e});se?await de({invitedUserEmails:t,disable_invite_email:!0,guestInviteResponse:i,shouldDoCompleteFn:!0}):ie&&await ue({invitedUserEmails:t,guestInviteResponse:i})}else i?u().S4(m,{invite_stage:"click_invite_button",invite_flow_id:C,error:"Invite guest with guest limitation exceed"}):await le({invitedUserEmails:t,shouldDoCompleteFn:!0});y(!1),g.reset()}),[m,se,ie,f,C,A,g,le,de,ue,y]),pe=(0,n.useCallback)((async()=>{await D();const e=(0,K().B)({inviteTargetsStore:g}).length;u().tX(m,{invited_user_count:e,invite_option:f,can_add_member:se,origin:c,inviteTargets:g.state.inviteTargets.map((e=>e.type.toString())),inviteTokenQuery:g.state.tokenQuery,invite_flow_id:C}),await ce()}),[m,C,D,ce,f,se,g,c]);let me;me=ee?oe:re?(0,I.jsx)(a()._H,{id:"shareMenu.inviteButton.emailOverMaxLength.tooltip",defaultMessage:"Message exceeds the limit of 1000 characters."}):void 0;const ve=(0,n.useMemo)((()=>[{key:"member",render:()=>(0,I.jsx)(p().Z,{disableTooltip:se||ie,renderTooltip:()=>(0,I.jsx)(a()._H,{id:"invite.person_property.invite_member.tooltip",defaultMessage:"You do not have permission to add or request members to this workspace"}),render:e=>(0,I.jsx)(N,{isSelected:"member"===f,inviteOption:"member",events:e})}),isDisabled:!se&&!ie},{key:"guest",render:()=>(0,I.jsx)(p().Z,{disableTooltip:!G&&X,renderTooltip:()=>(0,I.jsx)(L().e,{}),render:e=>(0,I.jsx)(N,{isSelected:"guest"===f,inviteOption:"guest",events:e})})}]),[f,G,X,ie,se]);return(0,I.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[(0,I.jsx)("div",{style:v.section,children:(0,I.jsx)(H().Z,{items:ve,itemStyle:v.itemStyle,innerStyle:v.innerStyle,value:f,onChange:e=>{b(e),u().Io(m,{invite_option:e,invite_flow_id:C,origin:c})}})}),!G&&X||"guest"!==f?(0,I.jsx)(z,{tooltip:me,disabled:!P||ee||re,onClick:pe,isLoading:h}):(0,I.jsx)(W,{onClick:()=>{u().ZA(m,{invited_user_count:U.length,invite_flow_id:C,origin:c}),V().Vu({environment:m,upgradeButtonName:"user_permission_item"})}})]})}function W(e){const{onClick:t}=e;return(0,I.jsx)(p().Z,{disableTooltip:!1,renderTooltip:()=>(0,I.jsx)(L().e,{}),render:e=>(0,I.jsx)(D().Z,{isLarge:!0,style:{margin:"0 16px 16px 16px",borderRadius:6},onClick:t,...e,children:(0,I.jsx)(a()._H,{id:"invite.person_property.upgrade",defaultMessage:"Upgrade"})})})}function z(e){const{tooltip:t,disabled:i,onClick:n,isLoading:s}=e;return(0,I.jsx)(p().Z,{disableTooltip:!Boolean(t),renderTooltip:()=>t,render:e=>(0,I.jsx)(D().Z,{isLarge:!0,style:{margin:"0 16px 16px 16px",borderRadius:6},disabled:i,onClick:n,...e,isLoading:s,children:(0,I.jsx)(a()._H,{id:"invite.person_property.invite",defaultMessage:"Invite"})})})}function N(e){const{isSelected:t,inviteOption:i,events:n}=e,s=Y(),o=t?s.mainTextSelected:s.mainTextUnselected;let r,l;switch(i){case"guest":r=(0,I.jsx)(a()._H,{id:"invite.person_property.addAsGuest.title",defaultMessage:"Add to page only"}),l=(0,I.jsx)(a()._H,{id:"invite.person_property.addAsGuest.subtitle",defaultMessage:"Invite as a Guest"});break;case"member":r=(0,I.jsx)(a()._H,{id:"invite.person_property.addAsMember.title",defaultMessage:"Add to Workspace"}),l=(0,I.jsx)(a()._H,{id:"invite.person_property.addAsMember.subtitle",defaultMessage:"Invite and bill as a Member"});break;default:throw new Error(`Unsupported invite option: ${i}`)}return(0,I.jsx)("div",{style:s.row,...n,children:(0,I.jsxs)("div",{style:o,children:[r,(0,I.jsx)(A().Z,{isSmall:!0,style:s.optionSubtitle,children:l})]})})}function Y(){return(0,r().yK)((e=>({mainTextSelected:{fontWeight:w().Ue.medium,color:e.regularTextColor,fontSize:14,lineHeight:"14px"},mainTextUnselected:{color:e.mediumTextColor,fontSize:14,lineHeight:"14px"},row:{display:"flex",alignItems:"center",justifyContent:"center",gap:4,lineHeight:"14px"},section:{padding:"16px 11px 16px 11px"},itemStyle:{margin:5,borderRadius:8,borderWidth:2},innerStyle:{borderWidth:0},optionSubtitle:{whiteSpace:"pre-wrap",paddingTop:2,fontSize:12}})),[])}var Q=()=>i(647439),$=()=>i(1910);function X(e){let{handleBackButtonClick:t}=e;const i=(0,r().yK)((()=>({container:{display:"flex",margin:"0 12px 0px",height:40}})),[]);return(0,I.jsx)("div",{style:i.container,children:(0,I.jsx)(J,{onClick:t})})}function J(e){const{onClick:t}=e,i=(0,a().YB)(),n=(0,r().yK)((()=>({topContainer:{display:"flex",alignItems:"center",width:"max-content"},iconButton:{marginRight:6,height:24,width:24},arrowIcon:{height:16,width:16,strokeWidth:w().Ue.semibold},sendInviteLabel:{fontWeight:w().Ue.medium}})),[]);return(0,I.jsxs)("div",{style:n.topContainer,children:[(0,I.jsx)($().Z,{icon:Q().W,iconStyle:n.arrowIcon,style:n.iconButton,onClick:t,ariaLabel:i.formatMessage({id:"shareMenu.backButton.iconButton",defaultMessage:"Go back to main share menu."})}),(0,I.jsx)(A().Z,{style:n.sendInviteLabel,children:(0,I.jsx)(a()._H,{id:"invite.person_property.popup_title",defaultMessage:"Invite and mention"})})]})}var ee=()=>i(293338),te=()=>i(291198),ie=()=>i(532146);const ne=d().Ds((e=>{let{environment:t,flowId:i,origin:n}=e;u().KZ(t,{origin:n,invite_flow_id:i})}),1e3);function se(e){const{inviteTargetsStore:t,personPropertyInviteStore:i,inviteOrigin:r}=e,a=(0,s().O7)(),{focus:l,emailMessage:d}=(0,o().VK)((()=>{const{focus:e,emailMessage:t}=i.state;return{focus:e,emailMessage:t}}),[i]),u=(0,o().VK)((()=>i.state.flowId),[i]),c=(0,n.useCallback)((()=>{t.reset()}),[t]),p=(0,n.useCallback)((e=>{i.setState({...i.state,focus:l,emailMessage:e.target.value}),ne({environment:a,flowId:u,origin:r})}),[a,i,u,r,l]),m=(0,n.useCallback)((()=>{c()}),[c]),v=(0,n.useCallback)((()=>{i.setState({...i.state,focus:Z().S.MessageInput,emailMessage:d})}),[i,d]);return(0,I.jsx)(oe,{focus:l===Z().S.MessageInput,value:d,onFocus:v,onChange:p,onCancel:m,maxLength:1e3,inviteTargetsStore:t})}function oe(e){const{focus:t,value:i,maxLength:n,inviteTargetsStore:l,onFocus:d,onChange:u,onCancel:c}=e,p=(0,a().YB)(),m=i.length/n>=.8,v=(0,ee().TQ)(i),g=m||v,h=(0,s().Fy)(),y=(0,r().yK)((e=>({container:{maxHeight:80,bottom:0,padding:"2px 16px 2px 16px",backgroundColor:e.modalBackground,pointerEvents:"all",transitionProperty:"max-height",transitionDuration:"0.3s",overflow:"hidden",zIndex:1,height:72},input:{maxHeight:80,borderTop:1,borderTopStyle:"solid",borderTopColor:e.regularDividerColor,padding:2,fontSize:14,transitionProperty:"max-height",transitionDuration:"0.3s",height:"100%"},inputBox:{padding:"0px 4px 0px 4px",boxShadow:e.inputBoxShadow,background:e.inputBackground,width:"auto",height:"100%",borderRadius:6,...t&&{background:"none",boxShadow:"rgba(35, 131, 226, 0.57) 0px 0px 0px 1px inset, rgba(35, 131, 226, 0.35) 0px 0px 0px 2px"}}})),[t]),f=(0,o().VK)((()=>l.state.inviteTargets.filter((e=>"newUser"===e.type||"existingUser"===e.type)).map((e=>e.value.email))),[l]),x=(0,o().VK)((()=>f.length>0?p.formatMessage({id:"invite.person_property.emailMessageInput.placeholder.withEmails",defaultMessage:"Add a message for {users}"},{users:(0,ie().W)(f)}):p.formatMessage({id:"invite.person_property.emailMessageInput.placeholder.noEmails",defaultMessage:"Add a message to your invite..."})),[p,f]);return(0,I.jsxs)("div",{style:y.container,children:[g&&(0,I.jsx)(re,{value:i,maxLength:n,shouldShowLengthWarning:m,shouldShowLinkWarning:v}),(0,I.jsx)(te().Z,{textarea:!0,focusInitial:!1,format:te().B.Transparent,placeholder:x,maxlength:n,focus:t,value:i,onFocus:d,onChange:u,inputStyle:y.input,onCancel:c,style:y.inputBox,onClick:()=>{h.isMobile||null==d||d()}})]})}function re(e){const{shouldShowLengthWarning:t,shouldShowLinkWarning:i,value:n,maxLength:s}=e,o=(0,r().yK)((e=>({container:{position:"absolute",top:0,display:"flex",justifyContent:"center",fontSize:12,color:e.lightTextColor,width:"100%"},warning:{display:"flex",justifyContent:"center",width:"calc(100% - 36px)",backgroundColor:e.modalBackground,marginTop:1}})),[]);return(0,I.jsx)("div",{style:o.container,children:(0,I.jsxs)("div",{style:o.warning,children:[t&&(0,I.jsx)(a()._H,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:n.length,maxCharacters:s}}),t&&i&&" · ",i&&(0,I.jsx)(a()._H,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"})]})})}function ae(e){const{store:t,handleBackButtonClick:i,onInviteCompleteFn:a,inviteTargetsStore:l,personPropertyInviteStore:u,inviteOrigin:p}=e,m=(0,o().qz)(void 0,U().Z),v=(0,s().O7)(),g=(0,n.useCallback)((async()=>{await B().handleEnterPress({environment:v,inviteTargetsStore:l,personPropertyInviteStore:u,allowShowEmptyError:!1})}),[v,l,u]),h=(0,r().yK)((()=>({container:{position:"relative",width:450,transition:"all",transitionDuration:"0.3s",display:"flex",flexDirection:"column",maxHeight:500},searchBar:{paddingLeft:16,paddingRight:16,paddingBottom:16,paddingTop:16},horizontalLine:{margin:"0",color:"#E3E2E0",opacity:.3}})),[]);return(0,I.jsx)(c().Z,{debugName:"PersonPropertyInvitePopup",capture:!0,onLeft:d().yR,onRight:d().yR,onSelectAll:d().yR,onRedo:d().yR,onUndo:d().yR,onCut:d().yR,onCopy:d().yR,onPaste:d().yR,onKeypress:d().yR,onDelete:d().yR,onBackspace:d().yR,onTab:d().yR,onEnter:g,children:(0,I.jsxs)("div",{style:h.container,children:[(0,I.jsx)(X,{handleBackButtonClick:i}),(0,I.jsx)("hr",{style:h.horizontalLine}),(0,I.jsx)("div",{style:h.searchBar,children:(0,I.jsx)(le,{store:t,inviteTargetsStore:l,personPropertyInviteStore:u,inviteOrigin:p})}),(0,I.jsx)(se,{store:t,inviteTargetsStore:l,personPropertyInviteStore:u,inviteOrigin:p}),(0,I.jsx)("div",{children:(0,I.jsx)(G,{store:t,inviteTargetsStore:l,sudoModeStore:m,onInviteCompleteFn:a,personPropertyInviteStore:u,inviteOrigin:p})})]})})}function le(e){const{store:t,personPropertyInviteStore:i,inviteOrigin:n}=e,d=(0,a().YB)(),c=(0,s().O7)(),y=(0,o().qz)(e.inviteTargetsStore,x().ZP),f=(0,g().r)(),b=(0,h().r_)(),S=(0,v().U)(f),{focus:T,emailMessage:w}=(0,o().VK)((()=>{const{focus:e,emailMessage:t}=i.state;return{focus:e,emailMessage:t}}),[i]),{role:C,showEmptyError:M}=(0,o().VK)((()=>{const{role:e,showEmptyError:t}=i.state;return{role:e,showEmptyError:t}}),[i]),k=(0,o().VK)((()=>t.getType()),[t]),j=(0,o().VK)((()=>i.state.flowId),[i]),_=(0,o().VK)((()=>t.canEditMembership()),[t]),R=(0,r().yK)((()=>({permissionsRoleSelectButton:{display:"flex",whiteSpace:"nowrap",height:20,margin:0,borderRadius:4,color:l().ZP.uiGray}})),[]);return f&&b&&S?(0,I.jsx)(p().Z,{disableTooltip:_,renderTooltip:()=>{if(!_)return(0,I.jsx)(a()._H,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip",defaultMessage:"Only those with full access can add people."})},render:e=>(0,I.jsx)("div",{style:{display:"flex"},...e,children:(0,I.jsx)(P,{inviteTargetsStore:y,store:f,disabled:!_,origin:n,flowId:j,focus:T===Z().S.InviteInput,showEmptyError:M,onFocus:()=>{i.setState({...i.state,focus:Z().S.InviteInput,emailMessage:w||""})},placeholder:d.formatMessage({id:"invite.person_property.inviteTargetsInput.placeholder",defaultMessage:"Add emails..."}),onInputChanged:()=>i.setState({...i.state,showEmptyError:!1}),right:(0,I.jsx)(m().ZP,{disabled:!_,role:C,table:"block",type:"user_permission",blockType:k,isInvite:!0,upgradeButtonName:"invite_permission_block",buttonStyle:R.permissionsRoleSelectButton,isMenuItem:!1,onChange:e=>{i.setState({...i.state,role:e}),u().Om(c,{invited_role:e,invite_flow_id:j,origin:n})}})})})}):null}},695793:(e,t,i)=>{i.d(t,{S:()=>n,Z:()=>o});let n=function(e){return e.InviteInput="invite_input",e.MessageInput="message_input",e.NoFocus="no_focus",e}({});class s extends(()=>i(263184))().default{getInitialState(){return{flowId:i(956057).Il(),role:"editor",focus:n.InviteInput,emailMessage:"",isLoading:!1,showEmptyError:!1}}}const o=s},189783:(e,t,i)=>{i.d(t,{z:()=>o});i(667294);var n=()=>i(788860),s=i(785893);function o(e){let{invalidInvites:t,showEmptyError:i,styles:o}=e;if(i)return(0,s.jsx)("div",{style:o,children:(0,s.jsx)(n()._H,{id:"inviteTargetsInput.invalidWarning.noEmails",defaultMessage:"Please enter an email address"})});if(0===t.length)return null;const r=t[0].value.text;return 1===t.length?(0,s.jsx)("div",{style:o,children:(0,s.jsx)(n()._H,{id:"inviteTargetsInput.invalidWarning.singleEmail",defaultMessage:"“{text}” is not a valid email",values:{text:r}})}):(0,s.jsx)("div",{style:o,children:(0,s.jsx)(n()._H,{id:"inviteTargetsInput.invalidWarning.multipleEmails",defaultMessage:"{additionalInvalid, plural, one {“{text}” and {additionalInvalid} other are not valid emails} other {“{text}” and {additionalInvalid} others are not valid emails}}",values:{text:r,additionalInvalid:t.length-1}})})}}}]);