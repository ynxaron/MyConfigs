"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[37598],{589357:(e,t,n)=>{n.r(t),n.d(t,{AssistantAnimatedFace:()=>E,AssistantAnimatedFaceInner:()=>x});n(492176),n(7961);var i=()=>n(522399),a=()=>n(730120),r=n(667294),o=()=>n(387934),s=()=>n(142735),u=()=>n(846550),c=()=>n(947115),l=()=>n(444263),g=()=>n(840521),d=()=>n(79179),h=()=>n(839002),f=()=>n(696459),p=()=>n(726143),w=()=>n(379072),S=()=>n(95718),m=()=>n(660293),v=()=>n(21062),b=()=>n(934262),T=()=>n(73898),y=()=>n(576917);const k=n.p+"bc69e69669ca365b.riv",I=["Base_Idle","Idle A","Idle B","Idle C"];var C=n(785893);i().RuntimeLoader.setWasmUrl(n(822721));const M=!1;function E(e){const{sizeVariant:t,includeBoxShadow:n,onMouseEnter:i}=e,a=function(){const e=(0,p().Io)().isWriter,t=(0,s().VK)((()=>{const t=e?(0,S().Js)():w().default.getActiveSession();if(!t)return"idle";const n=t.evaluator.getTranscript().at(-1);if(n&&"observation"===n.type&&"error"===n.observationType)return"error";const i=t.isStreaming();if(!i)return"idle";const a=t.getCombinedSteps().at(-1),r="assistantSearch"===(null==a?void 0:a.type)||"assistantShowSearchResults"===(null==a?void 0:a.type),o="assistantLoading"===(null==a?void 0:a.type)||"human"===(null==a?void 0:a.type);return"groupedEditCard"===(null==a?void 0:a.type)?"writing":r?"searching":o?"thinking":i?"writing":"idle"}),[e]);return(0,r.useEffect)((()=>{M&&A("HighLevelState","Pink",t)}),[t]),t}();return(0,C.jsx)(v().N,{step:"ai_assistant",isFullWidth:!1,highlightStyle:{borderRadius:"100%"},children:(0,C.jsx)(x,{sizeVariant:t,includeBoxShadow:n,highLevelState:a,onMouseEnter:i})})}function x(e){const{sizeVariant:t,highLevelState:n,includeBoxShadow:a,onMouseEnter:p}=e,[w,S]=(0,r.useState)(!1),v=(0,r.useCallback)((()=>{S(!0)}),[]),{onStateChange:E,waitUntilState:x,animationState:L}=function(){const e=(0,r.useRef)("Idle B"),t=(0,r.useMemo)((()=>new(l().Z)),[]),n=(0,r.useCallback)((n=>{if(Array.isArray(n.data)&&1===n.data.length){const i=n.data[0];M&&A("State change","DarkGreen",i),e.current=i,t.emit(i)}}),[t]),i=(0,r.useCallback)((()=>new Promise((e=>{const n=i=>{t.removeListener(n),e(i)};t.addListener(n)}))),[t]),a=(0,r.useCallback)((async t=>{(await h().OI(2e3,(async()=>{for(;!t(e.current);)await i()})())).timeout&&(0,o().XY)("Timed out while waiting for an assistant face state change.")}),[i]);return{animationState:e,waitUntilState:a,onStateChange:n}}(),{rive:_,RiveComponent:R}=(0,i().useRive)({src:k,stateMachines:["Main"],autoplay:!0,onAdvance:v,onStateChange:E});!function(e){const t=(0,s().VK)((()=>m().Z.state.isVisible),[]),n=(0,r.useCallback)((()=>{null==e||e.startRendering()}),[e]),i=(0,r.useCallback)((()=>{null==e||e.stopRendering()}),[e]);(0,r.useEffect)((()=>{t?n():i()}),[t,i,n])}(_);const W=function(e){const t=(0,r.useMemo)((()=>{const t=null==e?void 0:e.stateMachineInputs("Main"),n=new Map;if(!t)return n;for(const e of t)n.set(e.name,e);return n}),[e]);(0,r.useEffect)((()=>{(0,c().exposeDebugValue)("AssistantAnimatedFaceTriggers",t)}),[t]);const n=(0,g().X)(),i=(0,r.useCallback)((e=>{var i;n.current&&(M&&A("Firing trigger","MediumBlue",e),null===(i=t.get(e))||void 0===i||i.fire())}),[n,t]);return i}(_),F=(0,r.useMemo)((()=>new(d().z)(1)),[]);(0,r.useEffect)((()=>{F.enqueue((async()=>{"writing"===n?W("WritingInTrigger"):"idle"===n?(await async function(){"Writing_In"===L.current&&await x((e=>"Writing_Loop"===e)),"Writing_Loop"===L.current&&(W("WritingOutTrigger"),await x((e=>(0,f().DE)(I,e)))),"Thinking_In"!==L.current&&"Thinking_Loop"!==L.current||(W("ThinkingOutTrigger"),await x((e=>(0,f().DE)(I,e)))),"Searching_In"===L.current&&await x((e=>"Searching_Loop"===e)),"Searching_Loop"===L.current&&(W("SearchingOutTrigger"),await x((e=>(0,f().DE)(I,e))))}(),W("IdleTrigger")):"searching"===n?W("SearchingInTrigger"):"thinking"===n?W("ThinkingInTrigger"):"error"===n?W("ErrorTrigger"):(0,f().t1)(n)}))}),[n,W,x,F,L]);const V=(0,u().yK)((e=>{const n=(0,T().O)(t);return{wrap:{width:n,height:n,...a&&{boxShadow:e.shadowXS,borderRadius:"100%"},position:"relative"},faceImg:{position:"absolute",height:n,width:n},staticFace:{position:"absolute",left:0,top:0}}}),[t,a]);return(0,C.jsxs)("div",{style:V.wrap,onMouseEnter:e=>{e.stopPropagation(),null==p||p(e),setTimeout((()=>b().default.dismissTourTutorial()),400)},children:[(0,C.jsx)(R,{style:V.faceImg,onMouseEnter:()=>{Math.random()<.1&&W("GreetingTrigger")}}),!w&&(0,C.jsx)(y().P,{variant:t,wrapWithPadding:!0,style:V.staticFace,shadowVariant:a?"strong":"none"})]})}function A(e,t){const n=a().ou.local().toFormat("HH:mm:ss.SSS");for(var i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];console.log(`%c[${n}] %c${e}:`,"color: Grey;",`color: ${t}; font-weight: bold;`,...r)}}}]);