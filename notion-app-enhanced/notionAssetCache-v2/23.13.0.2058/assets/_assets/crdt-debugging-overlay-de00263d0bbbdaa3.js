"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[87125],{767948:(t,e,n)=>{n.r(e),n.d(e,{CrdtDebuggingOverlay:()=>a});n(670560),n(267602),n(30005),n(241792);var o=n(667294),i=()=>n(142735),s=()=>n(492522),r=()=>n(156538),c=()=>n(35982),l=()=>n(172656),f=n(785893);function a(t){return(0,i().VK)((()=>l().Z.state.open),[],{debugName:"CrdtDebuggingOverlay.isOpen"})?(0,f.jsx)(u,{}):null}function u(t){const[e,n]=(0,o.useState)([]);return(0,o.useEffect)((()=>{let t=!1,e=window.requestAnimationFrame((function o(){const i=[];r().E.forEach((t=>{const e=t.props.store.getRecordStoreAtRootPath();if("block"!==e.table||!e.useCrdt())return;const n=e.getBlockTitleTextSliceTree();if(!n)return;const o=t.getContentEditableLeaf();if(!o)return;const s=o.getNode();s&&i.push(...g(e.id,n,s))})),n(i),t||(e=window.requestAnimationFrame(o))}));return()=>{t=!0,window.cancelAnimationFrame(e)}}),[]),(0,f.jsx)("div",{style:{position:"absolute",top:0,left:0,bottom:0,right:0,pointerEvents:"none",zIndex:s().mJ},children:e.map(((t,e)=>(0,f.jsxs)(o.Fragment,{children:[(0,f.jsx)("div",{style:{position:"absolute",top:t.rect.top,left:t.rect.left,width:t.rect.width,height:t.rect.height,backgroundColor:"rgba(0, 0, 255, 0.25)"}}),(0,f.jsx)("div",{style:{position:"absolute",top:t.rect.bottom,left:t.rect.left,color:"blue",fontSize:10},children:t.clock})]},e)))})}function d(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{textOffset:0};if(e-n.textOffset==0)return{container:t,offset:0};for(let o=0;o<t.childNodes.length;o++){const i=t.childNodes[o];if(i.nextSibling,i.nodeType===i.TEXT_NODE){if(null===i.nodeValue)continue;if(i.nodeValue.length+n.textOffset>=e)return{container:i,offset:e-n.textOffset};n.textOffset+=i.nodeValue.length}else if(i instanceof Element){const t=d(i,e,n);if(t)return t}}}function g(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{infos:[],textOffset:0};const i=e.getTextSlice(),s=d(n,o.textOffset),r=d(n,o.textOffset+1);if(s&&r){const{textInstanceId:e}=i;try{const n=document.createRange();n.setStart(s.container,s.offset),n.setEnd(r.container,r.offset),o.infos.push({blockId:t,textInstanceId:e,clock:i.opClock.getValue(),rect:c().iL.from(n.getBoundingClientRect())})}catch(l){console.log("Error attempting to find bounding box for beginning of text slice",e,"in block",t,l)}}o.textOffset+=i.getText().length;for(const c of e.children)g(t,c,n,o);return o.infos}},172656:(t,e,n)=>{n.d(e,{Z:()=>i});class o extends(()=>n(263184))().default{getInitialState(){return{open:!1}}}const i=new o}}]);