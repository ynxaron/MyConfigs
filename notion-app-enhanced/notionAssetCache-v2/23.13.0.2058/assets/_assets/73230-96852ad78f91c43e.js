"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[73230],{294105:(e,t,o)=>{o.d(t,{b:()=>y});o(667294);var n=()=>o(219727),i=()=>o(846550),r=()=>o(891142),l=()=>o(788860),a=()=>o(696459),s=()=>o(94967),c=()=>o(198829),d=()=>o(470386),p=()=>o(921981),u=()=>o(247724),m=()=>o(352230),g=o(785893);const S=(0,l().vU)({createTitle:{id:"automations.builderModal.createTitle",defaultMessage:"Create automation"},updateTitle:{id:"automations.builderModal.updateTitle",defaultMessage:"Edit automation"},backAriaLabel:{defaultMessage:"Back",id:"automations.builderModal.backAriaLabel"},saveButton:{id:"automations.builderModal.saveButton",defaultMessage:"Save"}}),w=88;function y(e){const{children:t,handleOnDismiss:o,canSave:y,handleOnSave:f,mode:b}=e,h=(0,l().YB)(),{isMobile:v}=(0,n().Fy)(),x=(0,i().yK)((e=>({container:{padding:v?0:"12px 16px",display:"flex",flexDirection:"column",overflow:"hidden",...v?{}:{flexGrow:1}},mobileBackIcon:{width:14,height:14,fill:e.mediumIconColor,margin:"0 6px"}})),[v]);if(v){let e;return"create"===b?e=h.formatMessage(S.createTitle):"update"===b||"button_property"===b?e=h.formatMessage(S.updateTitle):"loading"===b?e=null:(0,a().t1)(b),(0,g.jsx)(c().Z,{menuType:m().o.Modal,whiteBackground:!0,title:e,left:(0,g.jsx)(g.Fragment,{children:(0,r().S)(x.mobileBackIcon)}),onClickLeft:o,rightDisabled:!y,right:"button_property"===b?(0,g.jsx)(d().DoneMenuText,{}):(0,g.jsx)(l()._H,{...S.saveButton}),onClickRight:f,children:(0,g.jsx)("div",{style:x.container,className:u().XEp,children:t})})}return(0,g.jsx)(p().c,{anchor:"top",minimumOutsideSpacing:{type:"axes",vertical:w},areaConstraint:{width:{type:"fixed",length:500},height:{type:"min",length:600,scroll:"disallow"}},allowDismissByEscape:!1,isOpen:!0,render:()=>(0,g.jsxs)("div",{style:x.container,className:u().XEp,children:[t,(0,g.jsx)(s().Z,{debugName:"AutomationBuilderModal",capture:!0,onEsc:e=>{o()}})]})})}},525898:(e,t,o)=>{o.d(t,{C:()=>l});var n=()=>o(250303),i=()=>o(139224),r=()=>o(853292);function l(e){const{environment:t,collectionContextStore:o}=e;o.collectionStore()&&(n().wd({environment:t,collectionContextStore:o,action:"click_new_property"}),i().H4({collectionSettingsStore:o.settingsStore,item:{type:"propertyType",onAccept:(e,n,i,l)=>{r().PW({environment:t,propertyType:e,isSuggestedProperty:n,propertyName:i,selectOptions:l,collectionContextStore:o,from:"view_settings"})}}}))}},477253:(e,t,o)=>{o.d(t,{Z:()=>i});o(667294);var n=o(785893);const i=function(e){let{switcherProps:t,...i}=e;return(0,n.jsx)(o(446955).Z,{right:(0,n.jsx)(o(471645).Z,{onClick:i.onClick,disabled:i.disabled,...t}),...i})}},137727:(e,t,o)=>{o.d(t,{Z:()=>de,v:()=>ce});o(821057),o(670560),o(267602),o(653476),o(470928),o(241792);var n=o(667294),i=()=>o(219727),r=()=>o(142735),l=()=>o(846550),a=()=>o(506347),s=()=>o(226413),c=()=>o(766933),d=()=>o(874459),p=()=>o(109477),u=()=>o(827282),m=()=>o(788860),g=()=>o(513670),S=()=>o(342792),w=()=>o(707513),y=()=>o(250303),f=()=>o(139224),b=()=>o(421654),h=()=>o(497065),v=()=>o(435168),x=()=>o(269299),C=()=>o(747589),_=()=>o(392423),j=()=>o(722920),T=()=>o(636340),V=()=>o(973792),k=()=>o(100154);var M=()=>o(887430),K=()=>o(154186),B=()=>o(448419),P=()=>o(291198),Z=()=>o(198829),F=()=>o(967092),H=()=>o(388284),A=()=>o(667637),O=()=>o(718959),z=()=>o(412511),I=()=>o(527278);const L=(0,m().vU)({none:{defaultMessage:"None",id:"database.viewPropertiesMenu.coverFormat.none"},page_content:{defaultMessage:"Page content",id:"database.viewPropertiesMenu.coverFormat.pageContent"},page_cover:{defaultMessage:"Page cover",id:"database.viewPropertiesMenu.coverFormat.pageCover"}}),W=(0,m().vU)({small:{defaultMessage:"Small",id:"database.viewPropertiesMenu.coverSize.small"},medium:{defaultMessage:"Medium",id:"database.viewPropertiesMenu.coverSize.medium"},large:{defaultMessage:"Large",id:"database.viewPropertiesMenu.coverSize.large"}});function U(e){return e?"page_content"===e.type?I().Z.formatMessage(L.page_content):"page_cover"===e.type?I().Z.formatMessage(L.page_cover):void 0:I().Z.formatMessage(L.none)}function D(e){switch(e){case"small":return I().Z.formatMessage(W.small);case"medium":return I().Z.formatMessage(W.medium);case"large":return I().Z.formatMessage(W.large)}}var E=()=>o(559729),R=()=>o(561933),Q=()=>o(605890),G=()=>o(429725),Y=()=>o(352230),N=()=>o(148126),q=()=>o(142589),$=()=>o(876822),X=()=>o(919775),J=()=>o(482162),ee=()=>o(576447),te=()=>o(446955),oe=()=>o(508858),ne=()=>o(949719),ie=()=>o(477253),re=o(785893);const le=6,ae=6,se=(0,m().vU)({week:{defaultMessage:"Week",id:"calendar.viewRanges.week"},month:{defaultMessage:"Month",id:"calendar.viewRanges.month"}});function ce(e){const{currentViewType:t,theme:o}=e,n=t?Q().Ls[t]:void 0;return["side_peek","center_peek","full_page"].map((e=>({key:e,type:"button",title:(0,Q().LQ)(e),body:(0,re.jsxs)(re.Fragment,{children:[(0,Q().RI)(e),n&&t&&e===n&&(0,re.jsx)("div",{style:{marginTop:2,fontWeight:500,color:o.blueColor},children:(0,re.jsx)(m()._H,{defaultMessage:"Default for {view}",id:"database.viewPropertiesMenu.peekMode.defaultForView",values:{view:R().Bh[t]}})})]}),icon:(0,Q().RO)(e)({width:u().ZG.default,height:u().ZG.default,fill:o.mediumTextColor})})))}const de=(0,m().XN)((function(e){let{collectionContextStore:t,showDoneButton:a,collectionSettingsStore:c}=e;const d=(0,l().Fg)(),p=(0,i().O7)(),u=(0,i().Fy)(),g=(0,n.useCallback)((e=>(0,re.jsx)(Ke,{collectionContextStore:t,viewType:e},`view-type-button-${e}`)),[t]),S=(0,r().Kw)(t.normalizedQueryStore),w=(0,r().Kw)(t.normalizedSchemaStore),h=(0,r().Kw)(t.normalizedFormatStore),v=(0,r().Kw)(t.isFullScreenStore),C=(0,r().Kw)(t.isRootChildStore),_=(0,r().VK)((()=>t.collectionViewBlockStore()),[t]),j=(0,r().VK)((()=>pe(t)),[t]),T=(0,r().VK)((()=>Boolean(ue(t))),[t]),V="table"===j||"board"===j||"gallery"===j||"calendar"===j,k="table"===j,M=Object.keys(w).filter((e=>{const t=w[e];return t&&(0,s().Lt)(t)})),K="timeline"===j&&M.length>0,B=(0,r().VK)((()=>"timeline"===j&&M.length>1&&_&&!(0,O().qG)(_.id)),[j,M,_]),P="timeline"===j&&Boolean(null==S?void 0:S.timeline_by_end),Z="calendar"===j&&M.length>0,F=(0,r().VK)((()=>"calendar"===j),[j]),z="calendar"===j,I="board"===j,L=(0,r().VK)((()=>(0,o(701182).d$)({environment:p,isFullScreen:v,isRootChild:C})),[p,v,C]),W="timeline"===j&&Boolean(h.timeline_show_table)&&L,U="timeline"===j&&L,D=(0,r().VK)((()=>null==_?void 0:_.getCollectionViewSourceCollectionStore()),[_]),E=(0,r().VK)((()=>!("collectionTypedView"===t.contextType||t.isInHomeWidgetStore.state||D&&v)),[t,D,v]),R=(0,r().VK)((()=>!t.isInHomeWidgetStore.state&&"chart"!==j),[t.isInHomeWidgetStore,j]),Q=(0,r().VK)((()=>"chart"!==j),[j]),G=(0,r().Kw)(t.permissionScopesStore),Y=(0,r().Kw)(t.shouldShowSourceStore),$=(0,r().VK)((()=>"chart"===j),[j]),X=(0,r().VK)((()=>"chart"===j),[j]),{isPostsEnabled:J,isFeedOutsidePostsEnabled:te}=(0,r().VK)((()=>({isPostsEnabled:(0,q().U)({isMobileNative:u.isMobileNative,disableExposureLogging:!0}),isFeedOutsidePostsEnabled:(0,q().x)({disableExposureLogging:!0})})),[u]),oe=(0,o(466970).E)("geo_point_property");if(!_)return null;const ne="page"===j,ie=E||T||k||V||ne||K||P||B||Z||z||F||U||W||I||R||Q,le=["table","board","timeline","calendar","list","gallery","chart"];return J&&te&&le.push("feed"),oe&&le.push("map"),(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(H().Z,{topBorder:!1,shouldShowBottomDivider:u.isMobile,children:(0,re.jsx)("div",{style:{...!u.isMobile&&{width:"100%",paddingLeft:8,paddingRight:8},...u.isMobile&&{background:d.contentBackground,width:"100%",paddingTop:12,paddingBottom:12}},children:(0,re.jsx)("div",{style:{display:"flex",flexFlow:"wrap"},children:le.map(g)})})}),ie&&(0,re.jsxs)(H().Z,{children:[E&&(0,re.jsx)(A().Z,{title:(0,re.jsx)(m()._H,{defaultMessage:"Show database title",id:"database.viewSettings.layoutTab.showDatabaseTitle.title"}),focused:!1,on:Y,onClick:()=>function(e,t){const o=t.collectionViewStore();if(!o)return;const n=!t.shouldShowSourceStore.state;x().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleShowCollectionTitleClick",environment:e,canUndo:!0,perform:e=>{b().FH({stores:[o],update:{hide_linked_collection_name:!n},transaction:e})}}),y().wd({environment:e,collectionContextStore:t,action:"toggle_show_collection_title"})}(p,t),disabled:!G.canConfigureBlock,textWrapperStyle:{opacity:1}}),T&&(0,re.jsx)(Me,{collectionContextStore:t}),k&&(0,re.jsx)(xe,{collectionContextStore:t}),V&&(0,re.jsx)(Ce,{collectionContextStore:t}),ne&&(0,re.jsx)(Se,{collectionContextStore:t}),K&&(0,re.jsx)(we,{collectionContextStore:t}),P&&(0,re.jsx)(ye,{collectionContextStore:t}),B&&(0,re.jsx)(_e,{collectionContextStore:t}),Z&&(0,re.jsx)(fe,{collectionContextStore:t}),z&&(0,re.jsx)(je,{collectionContextStore:t}),F&&(0,re.jsx)(Te,{collectionContextStore:t}),U&&(0,re.jsx)(o(818951).N,{collectionContextStore:t}),W&&(0,re.jsx)(be,{collectionContextStore:t,collectionSettingsStore:c}),I&&(0,re.jsx)(he,{collectionContextStore:t,collectionSettingsStore:c}),R&&(0,re.jsx)(Ve,{collectionContextStore:t}),Q&&(0,re.jsx)(ke,{collectionContextStore:t})]}),a&&(0,re.jsx)(H().Z,{disableMobileBorders:!0,children:(0,re.jsx)(o(906651).Z,{style:{display:"flex",margin:"0 14px"},onClick:()=>function(e,t,o){f().wl({collectionSettingsStore:t,item:{type:"main"}}),y().wd({environment:e,collectionContextStore:o,action:"click_create_view_done"})}(p,c,t),children:X?(0,re.jsx)(m()._H,{defaultMessage:"Edit chart",id:"database.viewSettings.createViewTab.editChartButton.title"}):(0,re.jsx)(m()._H,{defaultMessage:"Done",id:"database.viewSettings.createViewTab.doneButton.title"})})}),$?(0,re.jsx)(H().Z,{topBorder:!1,children:(0,re.jsx)(ee().Z,{href:(0,N().UY)("guides.charts"),title:(0,re.jsx)(m()._H,{defaultMessage:"Learn about charts",id:"database.viewSettings.layoutTab.learnAboutCharts.title"}),analyticsFrom:"view_settings_layout"})}):(0,re.jsx)(H().Z,{topBorder:!1,children:(0,re.jsx)(ee().Z,{href:(0,N().UY)("guides.databaseView"),title:(0,re.jsx)(m()._H,{defaultMessage:"Learn about views",id:"database.viewSettings.layoutTab.learnMoreButton.title"}),analyticsFrom:"view_settings_layout"})})]})}));function pe(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}function ue(e){return R().DL[pe(e)]}function me(e){return R().oy[pe(e)]}function ge(e){return R()._Y[pe(e)]}function Se(e){let{collectionContextStore:t}=e;const o=(0,i().O7)(),n=(0,r().VK)((()=>t.collectionViewStore()),[t]);return n?(0,re.jsx)("div",{style:{padding:5},children:(0,re.jsx)(P().Z,{showClearButton:!0,placeholder:"Enter page ID",focusInitial:!0,onChange:e=>{X().Z.setState({pageId:e.target.value})},onSubmit:e=>{const t=X().Z.state.pageId;t&&x().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderPageViewSettings",environment:o,canUndo:!0,perform:e=>{b().FH({stores:[n],update:{page_pointer:{id:(0,S().Mt)(t),spaceId:e.spaceId,table:"block"}},transaction:e})}})}})}):null}function we(e){let{collectionContextStore:t}=e;const o=(0,i().O7)(),n=(0,i().MO)(),l=(0,r().VK)((()=>{var e;return null===(e=t.normalizedQueryStore.state)||void 0===e?void 0:e.timeline_by}),[t]),a=(0,r().VK)((()=>{var e;return null===(e=t.normalizedQueryStore.state)||void 0===e?void 0:e.timeline_by_end}),[t]),c=(0,r().Kw)(t.permissionScopesStore),d=(0,r().Kw)(t.normalizedSchemaStore),p=(0,r().VK)((()=>t.collectionViewStore()),[t]),u=(0,r().VK)((()=>t.collectionStore()),[t]),g=(0,r().VK)((()=>null==u?void 0:u.getSchema()),[u]),S=(0,r().VK)((()=>null==u?void 0:u.getFormat()),[u]);if(!(l&&p&&u&&S&&g))return null;const f=d[l];return f?(0,re.jsx)(B().ZP,{popupType:n?F().kQ.SlideUp:F().kQ.Popup,alignmentToOrigin:B().vR.End,placementToOrigin:B().pO.Bottom,originGap:0,renderOrigin:e=>(0,re.jsx)(te().Z,{title:a?(0,re.jsx)(m()._H,{defaultMessage:"Start date",id:"database.viewSettings.layoutTab.timelineStartDate.title"}):(0,re.jsx)(m()._H,{defaultMessage:"Show timeline by",id:"database.viewSettings.layoutTab.showTimelineByProperty.title"}),disabled:!c.canConfigureBlock,showChevron:!0,right:(0,re.jsx)("div",{style:w().Yu,children:f.name}),rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0},...e}),render:e=>{let i;return i=n?{menuType:Y().o.ActionSheet}:{menuType:Y().o.Popup,width:300},(0,re.jsx)(Z().Z,{...i,children:(0,re.jsx)(ne().Z,{schema:g,format:S,currentProperty:l,getProperties:()=>Object.keys(d).filter((e=>{const t=d[e];return t&&(0,s().Lt)(t)})),onAccept:n=>{n&&(x().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderTimelineBySetting",environment:o,canUndo:!0,perform:e=>{(0,_().E)({collectionViewStore:p,update:{timeline_by:n},transaction:e})}}),e.close(),y().wd({environment:o,collectionContextStore:t,action:"update_timeline_by",original_view_type:void 0,property_type:f.type}))}})})}}):null}function ye(e){let{collectionContextStore:t}=e;const o=(0,i().O7)(),n=(0,i().MO)(),l=(0,r().VK)((()=>{var e;return null===(e=t.normalizedQueryStore.state)||void 0===e?void 0:e.timeline_by_end}),[t]),a=(0,r().Kw)(t.permissionScopesStore),c=(0,r().Kw)(t.normalizedSchemaStore),d=(0,r().VK)((()=>t.collectionViewStore()),[t]),p=(0,r().VK)((()=>t.collectionStore()),[t]),u=(0,r().VK)((()=>null==p?void 0:p.getSchema()),[p]),g=(0,r().VK)((()=>null==p?void 0:p.getFormat()),[p]);if(!(l&&d&&p&&g&&u))return null;const S=c[l];return S?(0,re.jsx)(B().ZP,{popupType:n?F().kQ.SlideUp:F().kQ.Popup,alignmentToOrigin:B().vR.End,placementToOrigin:B().pO.Bottom,originGap:0,renderOrigin:e=>(0,re.jsx)(te().Z,{title:(0,re.jsx)(m()._H,{defaultMessage:"End date",id:"database.viewSettings.layoutTab.timelineEndDate.title"}),showChevron:!0,right:S.name,disabled:!a.canConfigureBlock,...e}),render:e=>{let i;return i=n?{menuType:Y().o.ActionSheet}:{menuType:Y().o.Popup,width:300},(0,re.jsx)(Z().Z,{...i,children:(0,re.jsx)(ne().Z,{schema:u,format:g,currentProperty:l,getProperties:()=>Object.keys(c).filter((e=>{const t=c[e];return t&&(0,s().Lt)(t)})),onAccept:n=>{n&&(x().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderTimelineEndSetting",environment:o,canUndo:!0,perform:e=>{(0,_().E)({collectionViewStore:d,update:{timeline_by_end:n},transaction:e})}}),e.close(),y().wd({environment:o,collectionContextStore:t,action:"update_timeline_by_end",original_view_type:void 0,property_type:S.type}))}})})}}):null}function fe(e){let{collectionContextStore:t}=e;const o=(0,i().O7)(),n=(0,i().MO)(),l=(0,r().VK)((()=>{var e;return null===(e=t.normalizedQueryStore.state)||void 0===e?void 0:e.calendar_by}),[t]),a=(0,r().Kw)(t.permissionScopesStore),c=(0,r().Kw)(t.normalizedSchemaStore),d=(0,r().VK)((()=>t.collectionViewStore()),[t]),p=(0,r().VK)((()=>t.collectionStore()),[t]),u=(0,r().VK)((()=>null==p?void 0:p.getSchema()),[p]),g=(0,r().VK)((()=>null==p?void 0:p.getFormat()),[p]);if(!(l&&d&&p&&g&&u))return null;const S=c[l];return S?(0,re.jsx)(B().ZP,{popupType:n?F().kQ.SlideUp:F().kQ.Popup,alignmentToOrigin:B().vR.End,placementToOrigin:B().pO.Bottom,originGap:0,renderOrigin:e=>(0,re.jsx)(te().Z,{title:(0,re.jsx)(m()._H,{defaultMessage:"Show calendar by",id:"database.viewSettings.layoutTab.showCalendarByProperty.title"}),disabled:!a.canConfigureBlock,showChevron:!0,right:(0,re.jsx)("div",{style:w().Yu,children:S.name}),rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0},...e}),render:e=>{let i;return i=n?{menuType:Y().o.ActionSheet}:{menuType:Y().o.Popup,width:300},(0,re.jsx)(Z().Z,{...i,children:(0,re.jsx)(ne().Z,{schema:u,format:g,currentProperty:l,getProperties:()=>Object.keys(c).filter((e=>{const t=c[e];return t&&(0,s().Lt)(t)})),onAccept:n=>{n&&(x().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderCalendarBySetting",environment:o,canUndo:!0,perform:e=>{(0,_().E)({collectionViewStore:d,update:{calendar_by:n},transaction:e})}}),e.close(),y().wd({environment:o,collectionContextStore:t,action:"update_calendar_by",original_view_type:void 0,property_type:S.type}))}})})}}):null}function be(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,i().O7)(),l=((0,r().Kw)(t.normalizedFormatStore).timeline_table_properties||[]).filter((e=>Boolean(e.visible))).length,a=(0,r().Kw)(t.permissionScopesStore);return(0,re.jsx)(te().Z,{title:(0,re.jsx)(m()._H,{defaultMessage:"Table properties",id:"database.viewSettings.layoutTab.tablePropertiesButton.title"}),showChevron:!0,right:(0,re.jsx)(m()._H,{defaultMessage:"{propertiesShown} shown",id:"database.viewSettings.layoutTab.propertiesButton.propertiesShown.title",values:{propertiesShown:l}}),onClick:()=>{f().H4({collectionSettingsStore:o,item:{type:"properties",timelineViewTab:"table"}}),y().wd({environment:n,collectionContextStore:t,action:"click_timeline_table_properties"})},disabled:!a.canConfigureBlock})}function he(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,i().O7)(),l=(0,r().VK)((()=>t.normalizedFormatStore.state.board_columns_by),[t]),a=(0,r().Kw)(t.normalizedSchemaStore),s=(0,r().Kw)(t.permissionScopesStore),c=(0,r().VK)((()=>(0,E().h6)(t.normalizedFormatStore.state)),[t]);if(!l)return null;const d=a[l.property];return d?(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(te().Z,{title:(0,re.jsx)(m()._H,{defaultMessage:"Group by",id:"database.viewSettings.layoutTab.boardGroupByButton.title"}),showChevron:!0,right:d.name,onClick:()=>{f().H4({collectionSettingsStore:o,item:{type:"group",groupByKey:"board_columns_by",groupsFormatKey:"board_columns"}}),y().wd({environment:n,collectionContextStore:t,action:"click_board_group_by",original_view_type:void 0,property_type:d.type})},disabled:!s.canConfigureBlock}),(0,re.jsx)(A().Z,{title:(0,re.jsx)(m()._H,{defaultMessage:"Color columns",id:"database.viewSettings.groupTab.colorColumns"}),on:!c,focused:!1,onClick:()=>{f().iN({environment:n,collectionContextStore:t})},disabled:!s.canConfigureBlock,textWrapperStyle:{opacity:1}})]}):null}function ve(e,t,o){const n=o.collectionViewStore();if(!n)return;const{serverCommitResult:i}=x().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleViewRangeOptionClick",environment:t,canUndo:!0,perform:t=>{b().FH({stores:[n],update:{calendar_view_range:e},transaction:t})}}),r=O().AK.state,l=o.dateRangeStartStore.state,a=o.dateRangeEndStore.state,{newDateRangeStart:s,newDateRangeEnd:c}=function(e){const{newViewRange:t,oldCalendarStart:o,startOfWeekSetting:n}=e;if("month"===t){const e=(0,d().IS)(new Date((0,d().V7)(o,n)).getDate()>7?(0,d().kl)(o):o,n);return{newDateRangeStart:e,newDateRangeEnd:(0,d().V7)((0,d()._)({date:e,monthsToAdd:1}),n)}}return{newDateRangeStart:(0,d().IS)(Date.now(),n),newDateRangeEnd:(0,d().V7)(Date.now(),n)}}({oldCalendarStart:l,newViewRange:e,startOfWeekSetting:r});(0,C().I)({dateRangeStart:s,dateRangeEnd:c,collectionContextStore:o}),i.then((()=>{y().wd({environment:t,collectionContextStore:o,action:"update_calendar_view_range"}),(0,z().Xq)({newCalendarStart:s,newCalendarEnd:c,collectionViewId:n.id,currentUserId:t.currentUser.id})})).catch((()=>{(0,C().I)({dateRangeStart:l,dateRangeEnd:a,collectionContextStore:o})}))}function xe(e){let{collectionContextStore:t}=e;const o=(0,i().O7)(),n=(0,r().Kw)(t.permissionScopesStore),l=(0,r().VK)((()=>!Boolean(t.normalizedFormatStore.state.hide_table_vertical_lines)),[t]);return(0,re.jsx)(A().Z,{title:(0,re.jsx)(m()._H,{defaultMessage:"Show vertical lines",id:"database.viewSettings.layoutTab.tableShowVerticalLines"}),on:l,focused:!1,onClick:()=>function(e,t){const o=t.collectionViewStore();if(!o)return;const n=Boolean(t.normalizedFormatStore.state.hide_table_vertical_lines);v().AU({environment:e,collectionViewStore:o,currentValue:n}),y().wd({environment:e,collectionContextStore:t,action:"toggle_table_vertical_lines"})}(o,t),disabled:!n.canConfigureBlock,textWrapperStyle:{opacity:1}})}function Ce(e){var t;let{collectionContextStore:o}=e;const l=(0,i().O7)(),a=(0,r().Kw)(o.normalizedFormatStore),s=(0,r().Kw)(o.permissionScopesStore),c=(0,r().VK)((()=>pe(o)),[o]),d=a.table_wrap||"calendar"===c&&!0===(null==a||null===(t=a.calendar_properties)||void 0===t||null===(t=t.find((e=>"title"===e.property)))||void 0===t?void 0:t.wrap),p=(0,n.useMemo)((()=>{switch(c){case"table":return(0,re.jsx)(m()._H,{defaultMessage:"Wrap all columns",id:"database.viewSettings.layoutTab.tableWrapAllColumns"});case"calendar":return(0,re.jsx)(m()._H,{defaultMessage:"Wrap page titles",id:"database.viewSettings.layoutTab.calendarWrapTitle"});default:return(0,re.jsx)(m()._H,{defaultMessage:"Wrap all properties",id:"database.viewSettings.layoutTab.tableWrapAllProperties"})}}),[c]),u=(0,n.useCallback)((()=>{const e=o.collectionViewStore();e&&(v().MD({environment:l,collectionViewStore:e,currentValue:Boolean(d)}),y().wd({environment:l,collectionContextStore:o,action:"set_first_load_limit"}),y().wd({environment:l,collectionContextStore:o,action:"toggle_table_wrap_cells"}))}),[o,l,d]);return(0,re.jsx)(A().Z,{title:p,on:Boolean(d),focused:!1,onClick:u,disabled:!s.canConfigureBlock,textWrapperStyle:{opacity:1}})}function _e(e){let{collectionContextStore:t}=e;const o=(0,i().O7)(),n=(0,r().Kw)(t.normalizedQueryStore),l=null==n?void 0:n.timeline_by_end,a=(0,r().Kw)(t.permissionScopesStore);return(0,re.jsx)(A().Z,{title:(0,re.jsx)(m()._H,{defaultMessage:"Separate start and end dates",id:"database.viewSettings.layoutTab.timelineUseSeparateDates.title"}),focused:!1,on:Boolean(l),onClick:()=>function(e,t){const o=t.normalizedQueryStore.state,n=t.collectionViewStore(),i=null==o?void 0:o.timeline_by,r=null==o?void 0:o.timeline_by_end;if(!i||!n)return;const l=r?void 0:i;x().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleTimelineSeparateDatesClick",environment:e,canUndo:!0,perform:e=>{(0,_().E)({collectionViewStore:n,update:{timeline_by_end:l??null},transaction:e})}}),y().wd({environment:e,collectionContextStore:t,action:"toggle_timeline_separate_dates"})}(o,t),disabled:!a.canConfigureBlock,textWrapperStyle:{opacity:1}})}function je(e){let{collectionContextStore:t}=e;const o=(0,i().O7)(),l=(0,r().Kw)(t.permissionScopesStore),a=(0,r().VK)((()=>function(e){const t=e.normalizedFormatStore.state;return(null==t?void 0:t.calendar_view_range)||"month"}(t)),[t]),s=(0,r().VK)((()=>"peekModeFormat"===t.settingsStore.state.openButtonPopup),[t]),c=(0,n.useMemo)((()=>["month","week"].map((e=>({key:e,type:"button",title:I().Z.formatMessage(se[e])})))),[]);return(0,re.jsx)(oe().Z,{title:(0,re.jsx)(m()._H,{defaultMessage:"Show calendar as",id:"database.viewSettings.layoutTab.showCalendarAs.title"}),collectionContextStore:t,openButtonPopup:s,selectedKey:a,popupStyle:{minWidth:190},options:c,onChange:e=>ve(e,o,t),disabled:!l.canConfigureBlock})}function Te(e){let{collectionContextStore:t}=e;const o=(0,i().O7)(),l=(0,r().VK)((()=>{var e;return Boolean((null===(e=t.collectionViewStore())||void 0===e?void 0:e.getFormatStore().getKeyStore("calendar_show_weekends").getValue())??!0)}),[t]),a=(0,n.useCallback)((()=>{const e=t.collectionViewStore();e&&(x().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleToggleShowWeekends",environment:o,canUndo:!0,perform:t=>{b().FH({stores:[e],update:{calendar_show_weekends:!l},transaction:t})}}),y().wd({environment:o,collectionContextStore:t,action:"toggle_calendar_show_weekends"}))}),[t,o,l]);return(0,re.jsx)(ie().Z,{title:(0,re.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,re.jsx)(m()._H,{defaultMessage:"Show weekends",id:"database.viewSettings.layoutTab.showWeekends.title"})}),showChevron:!1,switcherProps:{on:l,noColor:!1},onClick:a})}function Ve(e){let{collectionContextStore:t}=e;const o=(0,l().Fg)(),n=(0,i().O7)(),s=(0,r().Kw)(t.permissionScopesStore),c=(0,r().VK)((()=>function(e){const t=e.normalizedFormatStore.state,o=pe(e);return(null==t?void 0:t.collection_peek_mode)||Q().Ls[o]}(t)),[t]),d=(0,r().VK)((()=>"peekModeFormat"===t.settingsStore.state.openButtonPopup),[t]),p=(0,r().VK)((()=>pe(t)),[t]);return(0,re.jsx)(oe().Z,{title:(0,re.jsx)(m()._H,{defaultMessage:"Open pages in",id:"database.viewSettings.layoutTab.peekModeTitle"}),collectionContextStore:t,openButtonPopup:d,selectedKey:c,popupStyle:{minWidth:190},options:ce({currentViewType:p,theme:o}),menuItemOptionsStyle:{paddingTop:8,paddingBottom:8},onClick:()=>function(e,t){y().nS({environment:e,collectionContextStore:t,from:"collection_view_settings"})}(n,t),onChange:e=>function(e,t,o){const n=o.collectionViewStore();if(n&&e&&(x().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handlePeekModeFormatClick",environment:t,canUndo:!0,perform:t=>{b().FH({stores:[n],update:{collection_peek_mode:e},transaction:t})}}),y().gl({environment:t,collectionContextStore:o,peek_mode:e,from:"collection_view_settings"}),J().default.state.open&&J().default.state.collectionContextStore===o)){const{mainEditorCurrentBlockStore:o}=$().default.state,n="full_page"===e?(0,G().ZP)({store:J().default.state.targetStore,fullyQualified:!1,pageVisitSource:a().tY.Expand}):(0,M().mb)({environment:t,store:J().default.state.targetStore,mainEditorCurrentBlockStore:o,collectionContextStore:J().default.state.collectionContextStore,fullyQualified:!1,overridePeekMode:(0,J().getPeekModeFromCollectionPeekModeFormat)(e)});n&&h().c4({environment:t,url:n})}}(e,n,t),disabled:!s.canConfigureBlock})}function ke(e){let{collectionContextStore:t}=e;const o=(0,i().O7)(),l=(0,r().Kw)(t.permissionScopesStore),a=(0,r().VK)((()=>t.shouldShowPageIcon()??!0),[t]),s=(0,n.useCallback)((()=>{const e=t.collectionViewStore();e&&(x().createAndCommit({userAction:"CollectionSettingsProperty.TitleOptions.handleToggleShowIcon",environment:o,canUndo:!0,perform:t=>{b().FH({stores:[e],update:{show_page_icon:!a},transaction:t})}}),y().wd({environment:o,collectionContextStore:t,action:"toggle_show_page_icon"}))}),[t,o,a]);return(0,re.jsx)(A().Z,{title:(0,re.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,re.jsx)(m()._H,{defaultMessage:"Show page icon",id:"database.viewSettings.layoutTab.showPageIcon.title"})}),focused:!1,on:a,onClick:s,disabled:!l.canConfigureBlock})}function Me(e){let{collectionContextStore:t}=e;const o=(0,l().Fg)(),n=(0,i().O7)(),{device:a}=n,s=(0,r().VK)((()=>function(e){const t=e.normalizedFormatStore.state,o=ue(e);if(o&&t)return t[o]}(t)),[t]),d=(0,r().VK)((()=>function(e){const t=e.normalizedFormatStore.state,o=me(e);if(o&&t){const e=t[o];if(e)return e}return p().PZ}(t)),[t]),u=(0,r().VK)((()=>!a.isMobile||"board"===pe(t)),[a,t]),S=(0,r().Kw)(t.permissionScopesStore),w=(0,r().VK)((()=>function(e,t,o){const n=o.normalizedSchemaStore.state;let i=Object.keys(n);i=g().MR(i,(e=>{const t=n[e];return t?t.name:""}));const r=g().oA(i.map((o=>{const i=n[o];if(i&&"file"===i.type)return{key:{type:"property",property:o},type:"button",title:i.name,icon:(0,re.jsx)(c().ZP,{type:i.type,icon:i.icon,size:e.device.isMobile?16:14,theme:t,style:{fill:t.regularIconColor}})}})));return[...[void 0,{type:"page_cover"},{type:"page_content"}].map((e=>({key:e,type:"button",title:U(e)}))),...r]}(n,o,t)),[n,o,t]),f=(0,r().VK)((()=>function(e){const t=e.normalizedFormatStore.state,o=ge(e);if(o&&t)return t[o]}(t)),[t]);return(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(oe().Z,{title:(0,re.jsx)(m()._H,{defaultMessage:"Card preview",id:"database.viewSettings.layoutTab.cardPreviewButtonTitle"}),selectedKey:s,popupStyle:{minWidth:190},options:w,onChange:e=>function(e,t,o){const n=ue(o),i=o.collectionViewStore();n&&i&&(x().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleCoverFormatChange",environment:t,canUndo:!0,perform:t=>{b().FH({stores:[i],update:{[n]:e},transaction:t})}}),y().wd({environment:t,collectionContextStore:o,action:"update_cover_format"}))}(e,n,t),disabled:!S.canConfigureBlock}),u&&(0,re.jsx)(oe().Z,{title:(0,re.jsx)(m()._H,{defaultMessage:"Card size",id:"databdatabase.viewSettings.layoutTab.cardSizeButtonTitle"}),selectedKey:d,popupStyle:{minWidth:190},options:["small","medium","large"].map((e=>({key:e,type:"button",title:D(e)}))),onChange:e=>function(e,t,o){const n=me(o),i=o.collectionViewStore();n&&i&&(x().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleCoverSizeFormatChange",environment:t,canUndo:!0,perform:t=>{b().FH({stores:[i],update:{[n]:e},transaction:t})}}),y().wd({environment:t,collectionContextStore:o,action:"toggle_cover_size_format"}))}(e,n,t),disabled:!S.canConfigureBlock}),s&&(0,re.jsx)(A().Z,{title:(0,re.jsx)(m()._H,{defaultMessage:"Fit image",id:"databdatabase.viewSettings.layoutTab.fitImageButtonTitle"}),on:"contain"===f,focused:!1,onClick:()=>function(e,t){const o=ge(t),n=t.collectionViewStore(),i=t.normalizedFormatStore.state;o&&n&&(x().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleCoverAspectFormatToggle",environment:e,canUndo:!0,perform:e=>{b().FH({stores:[n],update:{[o]:"contain"===i[o]?"cover":"contain"},transaction:e})}}),y().wd({environment:e,collectionContextStore:t,action:"toggle_cover_aspect_format"}))}(n,t),disabled:!S.canConfigureBlock,textWrapperStyle:{opacity:1}})]})}function Ke(e){let{viewType:t,collectionContextStore:o}=e;const n=(0,l().Fg)(),a=(0,i().O7)(),s=(0,r().VK)((()=>pe(o)),[o]),c=(0,r().Kw)(o.permissionScopesStore),d=s===t,p=d||!c.canConfigureBlock;return(0,re.jsxs)(K().Z,{style:{display:"flex",flexDirection:"column",alignItems:"center",width:`calc(25% - ${2*le}px)`,flexGrow:0,flexShrink:0,fontSize:11,borderRadius:6,margin:le,padding:ae,boxShadow:`0 0 0 1px ${n.regularDividerColor}`,color:n.mediumTextColor,fill:n.mediumTextColor,...d&&{boxShadow:`0 0 0 2px ${n.blueColor}`,color:n.blueColor,fill:n.blueColor,fontWeight:500}},disabled:p,onClick:()=>{x().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderViewTypeButton",environment:a,canUndo:!0,perform:e=>{!function(e){const{environment:t,collectionContextStore:o,newViewType:n,transaction:i}=e,r=o.collectionViewStore(),l=o.collectionViewBlockStore(),a=o.collectionStore();if(!r||!l)return;if(n===r.getType()||"page"===n||"form_editor"===n)return;"chart"===n&&j().Q({environment:t,collectionContextStore:o,collectionViewId:r.id,from:"collection_view_type_change"});const s=r.getType();T().sW({store:r,data:{type:n},transaction:i}),(0,k().y)({environment:t,collectionContextStore:o,collectionViewStore:r,collectionStore:a,oldViewType:s,newViewType:n,transaction:i}),(0,V().I)({collectionContextStore:o})}({environment:a,collectionContextStore:o,newViewType:t,transaction:e})}}),y().wd({environment:a,collectionContextStore:o,action:"change_type",original_view_type:s,new_view_type:t})},children:[R().aW[t]({width:void 0,height:20,marginBottom:4,marginTop:4}),(0,re.jsx)("div",{children:R().Bh[t]})]},t)}},818951:(e,t,o)=>{o.d(t,{N:()=>$,Z:()=>X});o(267602),o(653476),o(470928),o(241792);var n=o.n(o(443261)),i=o(667294),r=()=>o(219727),l=()=>o(142735),a=()=>o(846550),s=()=>o(15607),c=()=>o(226413),d=()=>o(532850),p=()=>o(766933),u=()=>o(109477),m=()=>o(429600),g=()=>o(94250),S=()=>o(717956),w=()=>o(159732),y=()=>o(95886),f=()=>o(788860),b=()=>o(513670),h=()=>o(696459),v=()=>o(707513),x=()=>o(250303),C=()=>o(139224),_=()=>o(421654),j=()=>o(269299),T=()=>o(757216),V=()=>o(178498),k=()=>o(429158),M=()=>o(265640),K=()=>o(827973),B=()=>o(119891),P=()=>o(9641),Z=()=>o(1910),F=()=>o(255577),H=()=>o(388284),A=()=>o(667637),O=()=>o(654133),z=()=>o(539245),I=()=>o(347577),L=()=>o(514),W=()=>o(164079),U=()=>o(148126),D=()=>o(772529),E=()=>o(998901),R=()=>o(525898),Q=()=>o(576447),G=()=>o(446955),Y=o(785893);const N=(0,f().vU)({inputPlaceholder:{defaultMessage:"Search for a property…",id:"database.viewSettings.propertiesTab.inputPlaceholder"},toggleFrozenColumnsAriaLabel:{defaultMessage:"Toggle frozen columns",id:"database.viewSettings.propertiesTab.toggleFrozenColumnsAriaLabel"},togglePropertyVisibilityAriaLabel:{defaultMessage:"Toggle property visibility",id:"database.viewSettings.propertiesTab.togglePropertyVisibilityAriaLabel"}}),q=o(263184).default.createClass("",{name:"InputStore"});function $(e){const{collectionContextStore:t,onClick:o}=e,n=(0,r().O7)(),i=(0,l().Kw)(t.normalizedFormatStore),a=Boolean(i.timeline_show_table),s=(0,l().Kw)(t.permissionScopesStore);return(0,Y.jsx)(A().Z,{title:(0,Y.jsx)(f()._H,{defaultMessage:"Show table",id:"database.viewSettings.propertiesTab.showTable"}),on:a,focused:!1,onClick:()=>{const e=t.collectionViewStore();e&&(j().createAndCommit({userAction:"CollectionSettingsViewProperties.TimelineShowTableSwitcher",environment:n,canUndo:!0,perform:t=>{_().FH({stores:[e],update:{timeline_show_table:!a,timeline_table_properties:[{property:"name",visible:!0}]},transaction:t})}}),null==o||o(),x().wd({environment:n,collectionContextStore:t,action:"timeline_toggle_show_table"}))},disabled:!s.canConfigureBlock,textWrapperStyle:{opacity:1}})}const X=function(e){let{collectionContextStore:t,timelineViewTab:n,collectionSettingsStore:i}=e;const a=(0,r().O7)(),s=(0,l().qz)(void 0,o(692304).Z),c=(0,l().qz)(void 0,q),d=(0,r().Fy)(),p=(0,l().Kw)(c),u=(0,l().VK)((()=>(0,I().WY)({collectionContextStore:t})),[t]),m=(0,l().VK)((()=>(0,I().jI)({timelineViewTab:n,collectionContextStore:t})),[n,t]),g=(0,l().VK)((()=>(0,o(701182).d$)({environment:a,isFullScreen:t.isFullScreenStore.state,isRootChild:t.isRootChildStore.state})),[a,t]);return(0,Y.jsxs)(o(205951).ZP,{collectionSettingsStore:i,title:(0,Y.jsx)(f()._H,{defaultMessage:"Properties",id:"database.viewSettings.propertiesTab.title"}),header:(0,Y.jsx)(H().Z,{children:(0,Y.jsx)(o(740046).ZP,{focusInitial:!d.isMobile,value:p,showClearButton:!0,onChange:e=>{c.setState(e.target.value),s.setState({...s.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})},placeholder:o(527278).Z.formatMessage(N.inputPlaceholder)})}),footer:(0,Y.jsx)(oe,{collectionContextStore:t,timelineViewTab:n}),children:["timeline"===u&&g&&(0,Y.jsx)(de,{collectionSettingsStore:i,collectionContextStore:t,timelineViewTab:n,inputStore:c}),m&&(0,Y.jsx)(me,{collectionContextStore:t,collectionSettingsStore:i,inputStore:c,menuListStore:s,formatKey:m}),(0,Y.jsx)(H().Z,{children:(0,Y.jsx)(ne,{collectionContextStore:t,collectionSettingsStore:i,timelineViewTab:n})})]})};function J(e){let{viewType:t}=e;return"table"===t?(0,Y.jsx)(f()._H,{defaultMessage:"Shown in table",id:"database.viewSettings.propertiesTab.shownInTableTitle"}):"timeline"===t?(0,Y.jsx)(f()._H,{defaultMessage:"Shown in timeline",id:"database.viewSettings.propertiesTab.shownInTimelineTitle"}):"board"===t?(0,Y.jsx)(f()._H,{defaultMessage:"Shown in board",id:"database.viewSettings.propertiesTab.shownInBoardTitle"}):"list"===t?(0,Y.jsx)(f()._H,{defaultMessage:"Shown in list",id:"database.viewSettings.propertiesTab.shownInListTitle"}):"gallery"===t?(0,Y.jsx)(f()._H,{defaultMessage:"Shown in gallery",id:"database.viewSettings.propertiesTab.shownInGalleryTitle"}):"calendar"===t?(0,Y.jsx)(f()._H,{defaultMessage:"Shown in calendar",id:"database.viewSettings.propertiesTab.shownInCalendarTitle"}):"page"===t||"chart"===t||"form_editor"===t||"feed"===t||"map"===t||"chat"===t?null:void(0,h().t1)(t)}function ee(e){let{viewType:t}=e;return"table"===t?(0,Y.jsx)(f()._H,{defaultMessage:"Hidden in table",id:"database.viewSettings.propertiesTab.hiddenInTableTitle"}):"timeline"===t?(0,Y.jsx)(f()._H,{defaultMessage:"Hidden in timeline",id:"database.viewSettings.propertiesTab.hiddenInTimelineTitle"}):"board"===t?(0,Y.jsx)(f()._H,{defaultMessage:"Hidden in board",id:"database.viewSettings.propertiesTab.hiddenInBoardTitle"}):"list"===t?(0,Y.jsx)(f()._H,{defaultMessage:"Hidden in list",id:"database.viewSettings.propertiesTab.hiddenInListTitle"}):"gallery"===t?(0,Y.jsx)(f()._H,{defaultMessage:"Hidden in gallery",id:"database.viewSettings.propertiesTab.hiddenInGalleryTitle"}):"calendar"===t?(0,Y.jsx)(f()._H,{defaultMessage:"Hidden in calendar",id:"database.viewSettings.propertiesTab.hiddenInCalendarTitle"}):"page"===t||"chart"===t||"form_editor"===t||"feed"===t||"map"===t||"chat"===t?null:void(0,h().t1)(t)}function te(e,t,o){const{formatKey:n,visibility:i}=e,r=t.collectionViewStore();if(!r)return;const l=t.normalizedFormatStore.state[n]||[];let a=l.filter((e=>Boolean(e.visible))),s=l.filter((e=>!e.visible));le.includes(n)&&(a=ae(a),s=ae(s));const c=[...a.map((e=>({...e,visible:i}))),...s.map((e=>({...e,visible:i})))];j().createAndCommit({userAction:"CollectionSettingsViewProperties.setAllPropertiesVisibility",environment:o,canUndo:!0,perform:e=>{_().FH({stores:[r],update:{[n]:c},transaction:e})}})}function oe(e){let{collectionContextStore:t,timelineViewTab:o}=e;const n=(0,r().O7)(),a=(0,l().Kw)(t.permissionScopesStore),s=(0,l().VK)((()=>"timeline"===(0,I().WY)({collectionContextStore:t})&&"table"===o&&!(0,I().vw)({collectionContextStore:t})),[t,o]),c=(0,l().VK)((()=>{const e=t.collectionViewBlockStore();return e&&(0,D().Kj)(e.id)}),[t]),d=a.canConfigureCollection&&!s&&!a.isExternallyImportedAndSyncedCollection&&!c,p=(0,i.useCallback)((()=>{(0,R().C)({environment:n,collectionContextStore:t})}),[n,t]);return(0,Y.jsxs)(H().Z,{topBorder:!0,children:[d&&(0,Y.jsx)(G().Z,{icon:w().R,title:(0,Y.jsx)(f()._H,{id:"database.viewSettings.propertiesTab.newProperty",defaultMessage:"New property"}),isGray:!0,onClick:p}),(0,Y.jsx)(Q().Z,{href:(0,U().UY)("guides.databaseProperties"),title:(0,Y.jsx)(f()._H,{defaultMessage:"Learn about properties",id:"database.viewSettings.propertiesTab.learnMoreButton.title"}),analyticsFrom:"view_settings_properties"})]})}function ne(e){let{collectionContextStore:t,collectionSettingsStore:o,timelineViewTab:n}=e;const i=(0,r().O7)(),a=(0,l().Kw)(t.normalizedDeletedSchemaStore),s=Object.keys(a).length;return(0,l().Kw)(t.permissionScopesStore).canConfigureCollection&&s>0?(0,Y.jsx)(G().Z,{icon:y().y,title:(0,Y.jsx)(f()._H,{id:"database.viewSettings.propertiesTab.deletedProperties",defaultMessage:"Deleted properties"}),isGray:!0,onClick:()=>function(e,t,o,n){o.collectionStore()&&(x().wd({environment:e,collectionContextStore:o,action:"click_deleted_properties"}),C().H4({collectionSettingsStore:t,item:{type:"deletedProperties",timelineViewTab:n}}))}(i,o,t,n),right:s,showChevron:!0}):null}function ie(e,t,o){const n=o.state,i=t.permissionScopesStore.state;return!e.device.isMobile&&i.canConfigureBlock&&!n}function re(e){e.reset()}const le=["board_properties","gallery_properties","calendar_properties"];function ae(e){const t=e.find((e=>"title"===e.property));return t?[t,...e.filter((e=>"title"!==e.property))]:e}function se(e,t,o,n,i,r,l){const{formatKey:a,propertyFormat:w}=e,y=n.permissionScopesStore.state,f=!w.visible,b=n.normalizedSchemaStore.state,h=(0,d().Qm)({schema:b,property:w.property}),_=ie(t,n,l)&&("title"!==w.property||!le.includes(a)),V="title"!==w.property||function(e,t){const o=t.normalizedFormatStore.state,n=(0,I().WY)({collectionContextStore:t});return"board"===n?(0,u().Lw)(o.board_cover):"gallery"===n?(0,u().Lw)(o.gallery_cover):"timeline"===n&&("timeline_table_properties"===e||(0,u().vP)(Boolean(o.timeline_show_table),o.timeline_table_properties||[]))}(a,n);let M=!y.canConfigureCollection||y.isSyncedCollection&&((0,s().w)(w.property)||(0,c().HF)(w.property));if("collectionTypedView"===n.contextType&&y.canConfigureBlock&&(M=!1),h)return{key:w.property,render:e=>{var r;return(0,Y.jsx)(O().Z,{disableTooltip:!(null!==(r=h.description)&&void 0!==r&&r.length),renderTooltip:e=>(0,Y.jsxs)("div",{...e,style:L().F6,children:[(0,Y.jsx)("div",{children:h.name}),void 0!==(null==h?void 0:h.description)&&h.description.length>0?(0,Y.jsx)("div",{style:{color:o.mediumInvertedTextColor},children:h.description}):null]}),placement:E().Placement.Left,render:r=>(0,Y.jsx)(K().Z,{...(0,W().Z)(e,r),title:(0,Y.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[_&&(0,Y.jsx)(P().Z,{iconSize:12,style:{marginRight:8}}),(0,Y.jsx)(p().ZP,{type:h.type,icon:h.icon,size:16,theme:o,style:{fill:o.regularIconColor}}),(0,Y.jsx)("span",{style:{marginLeft:8,...v().Yu},children:h.name}),(0,c().qQ)(h)&&(0,c().q3)(h)&&(0,Y.jsx)(k().Z,{})]}),right:(0,Y.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,Y.jsx)(Z().Z,{icon:f?S().B:g().c,iconStyle:{width:16,height:16},isDarkIconColor:!f,onClick:()=>{!function(e,t,o,n){var i;const{formatKey:r,propertyFormat:l}=e,a=o.collectionViewStore();if(!a)return;const s=o.normalizedFormatStore.state,c=(s[r]||[]).filter((e=>e.property!==l.property)),d={...l,visible:!l.visible},p=c.filter((e=>e.visible)),u=c.filter((e=>!e.visible));let m=[];m=le.includes(r)?!0===d.visible?[...ae([...p,d]),...ae(u)]:[...ae(p),...ae([d,...u])]:[...p,d,...u];const g={...s,[r]:m};j().createAndCommit({userAction:"CollectionSettingsViewProperties.handleTogglePropertyVisibility",environment:t,canUndo:!0,perform:e=>{(0,T().i)({collectionViewStore:a,update:{format:g},transaction:e})}}),x().wd({environment:t,collectionContextStore:o,action:"toggle_property_visibility",original_view_type:a.getType(),property_type:null===(i=a.getCollectionStore())||void 0===i||null===(i=i.getSchema()[d.property])||void 0===i?void 0:i.type}),re(n)}({formatKey:a,propertyFormat:w},t,n,l)},ariaLabel:i.formatMessage(N.togglePropertyVisibilityAriaLabel),disabled:!V||!y.canConfigureBlock}),!M&&(0,m().o)({width:12,fill:o.lightTextColor,marginLeft:5})]})})})},action:()=>{M||y.isExternallyImportedAndSyncedCollection||function(e,t,o,n){var i,r,l;const a=(null===(i=n.collectionStore())||void 0===i?void 0:i.getSchema())||n.normalizedSchemaStore.state||{},{formatKey:s,propertyFormat:c}=e;x().wd({environment:t,collectionContextStore:n,action:"click_property",original_view_type:null==n||null===(r=n.collectionViewStore())||void 0===r?void 0:r.getType(),property_type:null===(l=a[c.property])||void 0===l?void 0:l.type}),C().H4({collectionSettingsStore:o,item:{type:"property",formatKey:s,property:c.property}})}({formatKey:a,propertyFormat:w},t,r,n)}}}function ce(e,t,o,n,i,r,l){const{formatKey:a,properties:s}=e;return b().oA(s.map((e=>se({formatKey:a,propertyFormat:e},t,o,n,i,r,l))))}function de(e){let{collectionSettingsStore:t,collectionContextStore:o,timelineViewTab:n,inputStore:l}=e;const a=(0,r().O7)(),s=(0,i.useCallback)((()=>function(e){re(e)}(l)),[l]),c=(0,i.useCallback)((e=>function(e,t,o,n,i){x().wd({environment:t,collectionContextStore:n,action:0===e?"click_properties_tab_timeline":"click_properties_tab_table"}),C().FK({collectionSettingsStore:o,item:{type:"properties",timelineViewTab:0===e?"timeline":"table"}}),re(i)}(e,a,t,o,l)),[a,t,o,l]),d="timeline"===n?0:1;return(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(z().ZP,{tabs:[(0,Y.jsx)(f()._H,{defaultMessage:"Timeline",id:"database.viewSettings.propertiesTab.timelineProperties"},"database.viewSettings.propertiesTab.timelineProperties"),(0,Y.jsx)(f()._H,{defaultMessage:"Table",id:"database.viewSettings.propertiesTab.tableProperties"},"database.viewSettings.propertiesTab.tableProperties")],selectedIndex:d,onChange:c}),"table"===n&&(0,Y.jsx)(H().Z,{children:(0,Y.jsx)($,{collectionContextStore:o,onClick:s})})]})}function pe(e){const t=(0,r().O7)(),{props:o,formatKey:n,children:i,collectionContextStore:a,inputStore:s}=e,c=(0,l().Kw)(a.permissionScopesStore),d=(0,l().Kw)(s),p=(0,l().VK)((()=>"timeline_table_properties"===n?"table":(0,I().WY)({collectionContextStore:a})),[a,n]);return(0,Y.jsx)(H().Z,{...o,noTextOverflow:!0,isTitleUppercase:!1,title:(0,Y.jsx)(ee,{viewType:p}),desktopTitleStyle:{height:19},right:!d&&c.canConfigureBlock&&(0,Y.jsx)(M().D,{size:"sm",shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:()=>function(e,t,o){x().wd({environment:t,collectionContextStore:o,action:"click_show_all_properties"}),te({formatKey:e,visibility:!0},o,t)}(n,t,a),children:(0,Y.jsx)(f()._H,{id:"database.viewSettings.propertiesTab.showAllProperties",defaultMessage:"Show all"})}),style:{width:"100%",paddingBottom:0},children:i})}function ue(e){const t=(0,r().O7)(),{formatKey:o,visibleProperties:n,hiddenProperties:i,children:a,collectionContextStore:s,inputStore:c,menuListStore:d}=e,p=b().oA([...n.map((e=>"title"===e.property&&le.includes(o)?{key:e.property,draggable:!1}:e.property)),n.length>0&&i.length>0&&{key:"group-header-hidden-property",draggable:!1},...i.map((e=>"title"===e.property&&le.includes(o)?{key:e.property,draggable:!1}:e.property))]);return(0,l().VK)((()=>ie(t,s,c)),[t,s,c])?(0,Y.jsx)(B().ZP,{direction:"vertical",keys:p,renderKey:(e,t)=>a[t],onDrop:(e,n)=>{!function(e,t,o,n){const{formatKey:i,newPropertyKeys:r}=e,l=o.collectionViewStore();if(!l)return;const a=o.normalizedFormatStore.state[i]||[],s=r.indexOf("group-header-hidden-property");let c=b().oA(r.filter((e=>!e.startsWith("group-header-"))).map(((e,t)=>{const o=a.find((t=>t.property===e));if(o)return s>=0?{...o,visible:Boolean(t<s)}:o}))),d=a.filter((e=>!r.includes(e.property)));le.includes(i)&&(c=ae(c),d=ae(d));const p=[...c,...d];j().createAndCommit({userAction:"CollectionSettingsViewProperties.handlePropertyReorder",environment:t,canUndo:!0,perform:e=>{_().FH({stores:[l],update:{[i]:p},transaction:e})}}),x().wd({environment:t,collectionContextStore:o,action:"reorder_properties",original_view_type:l.getType()}),n.reset()}({formatKey:o,newPropertyKeys:e},t,s,d)}}):(0,Y.jsx)(Y.Fragment,{children:a})}function me(e){let{formatKey:t,collectionContextStore:o,collectionSettingsStore:i,inputStore:s,menuListStore:c}=e;const p=(0,a().Fg)(),u=(0,r().O7)(),m=(0,f().YB)(),g=(0,l().Kw)(o.permissionScopesStore),S=(0,l().Kw)(o.normalizedFormatStore),w=(0,l().Kw)(o.normalizedSchemaStore),y=(0,l().Kw)(s);let h=S[t]||[];if(y){let e=h.map((e=>{const t=(0,d().Qm)({schema:w,property:e.property});return null==t?void 0:t.name}));e=n().filter(y,e).map((e=>{let{original:t}=e;return t})),h=h.filter((t=>{const o=w[t.property];return o&&o.name&&e.includes(o.name)}))}const v=h.filter((e=>Boolean(e.visible))),C=h.filter((e=>!e.visible)),_=(0,l().VK)((()=>"timeline_table_properties"===t?"table":(0,I().WY)({collectionContextStore:o})),[o,t]),j=(0,l().VK)((()=>ce({formatKey:t,properties:v},u,p,o,m,i,s)),[t,v,u,p,o,m,i,s]),T=(0,l().VK)((()=>ce({formatKey:t,properties:C},u,p,o,m,i,s)),[t,C,u,p,o,m,i,s]);return 0===h.length?(0,Y.jsx)(H().Z,{children:(0,Y.jsx)(V().Z,{caption:(0,Y.jsx)(f()._H,{defaultMessage:"No results",id:"database.viewSettings.propertiesTab.noResults"})})}):(0,Y.jsx)(F().ZP,{type:F().iW.Vertical,store:c,initialFocus:void 0,sections:b().oA([v.length>0&&{key:"visible_and_hidden_properties",render:e=>(0,Y.jsx)(H().Z,{...e,noTextOverflow:!0,isTitleUppercase:!1,title:(0,Y.jsx)(J,{viewType:_}),desktopTitleStyle:{height:19},right:!y&&g.canConfigureBlock&&(0,Y.jsx)(M().D,{size:"sm",shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:()=>function(e,t,o){x().wd({environment:t,collectionContextStore:o,action:"click_hide_all_properties"}),te({formatKey:e,visibility:!1},o,t)}(t,u,o),children:(0,Y.jsx)(f()._H,{id:"database.viewSettings.propertiesTab.hideAllProperties",defaultMessage:"Hide all"})}),children:(0,Y.jsx)(ue,{collectionContextStore:o,inputStore:s,menuListStore:c,formatKey:t,visibleProperties:v,hiddenProperties:C,children:e.children})}),items:b().oA([...j,C.length>0&&{key:"group-header-hidden-property",render:e=>(0,Y.jsx)(pe,{collectionContextStore:o,inputStore:s,props:e,formatKey:t,children:(0,Y.jsx)(Y.Fragment,{})}),action:()=>{}},...T])},0===v.length&&C.length>0&&{key:"hidden_properties",render:e=>(0,Y.jsx)(pe,{collectionContextStore:o,inputStore:s,props:e,formatKey:t,children:(0,Y.jsx)(ue,{formatKey:t,visibleProperties:v,hiddenProperties:C,children:e.children,collectionContextStore:o,inputStore:s,menuListStore:c})}),items:T}])})}},919775:(e,t,o)=>{o.d(t,{Z:()=>i});class n extends(()=>o(263184))().default{getInitialState(){return{pageId:void 0}}}const i=new n},928374:(e,t,o)=>{o.d(t,{M:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("bolt",{svg:(0,n.jsx)("path",{d:"M4.629 21.418l8.877-11.416c.166-.205.254-.4.254-.625 0-.371-.293-.654-.703-.654H7.539l2.91-7.598C10.84.12 9.766-.428 9.131.412L.254 11.818c-.166.215-.254.41-.254.626 0 .38.293.663.703.663h5.518l-2.91 7.588c-.391 1.006.683 1.553 1.318.723zm.576-2.627l3.272-7.139H2.44l6.377-8.466-.273-.147-3.262 7.139h6.026l-6.377 8.467z"}),viewBox:"0 0 14 22"})},12663:(e,t,o)=>{o.d(t,{N:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("properties",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M1.91602 4.83789C2.44238 4.83789 2.87305 4.40723 2.87305 3.87402C2.87305 3.34766 2.44238 2.91699 1.91602 2.91699C1.38281 2.91699 0.952148 3.34766 0.952148 3.87402C0.952148 4.40723 1.38281 4.83789 1.91602 4.83789ZM5.1084 4.52344H14.3984C14.7607 4.52344 15.0479 4.23633 15.0479 3.87402C15.0479 3.51172 14.7607 3.22461 14.3984 3.22461H5.1084C4.74609 3.22461 4.45898 3.51172 4.45898 3.87402C4.45898 4.23633 4.74609 4.52344 5.1084 4.52344ZM1.91602 9.03516C2.44238 9.03516 2.87305 8.60449 2.87305 8.07129C2.87305 7.54492 2.44238 7.11426 1.91602 7.11426C1.38281 7.11426 0.952148 7.54492 0.952148 8.07129C0.952148 8.60449 1.38281 9.03516 1.91602 9.03516ZM5.1084 8.7207H14.3984C14.7607 8.7207 15.0479 8.43359 15.0479 8.07129C15.0479 7.70898 14.7607 7.42188 14.3984 7.42188H5.1084C4.74609 7.42188 4.45898 7.70898 4.45898 8.07129C4.45898 8.43359 4.74609 8.7207 5.1084 8.7207ZM1.91602 13.2324C2.44238 13.2324 2.87305 12.8018 2.87305 12.2686C2.87305 11.7422 2.44238 11.3115 1.91602 11.3115C1.38281 11.3115 0.952148 11.7422 0.952148 12.2686C0.952148 12.8018 1.38281 13.2324 1.91602 13.2324ZM5.1084 12.918H14.3984C14.7607 12.918 15.0479 12.6309 15.0479 12.2686C15.0479 11.9062 14.7607 11.6191 14.3984 11.6191H5.1084C4.74609 11.6191 4.45898 11.9062 4.45898 12.2686C4.45898 12.6309 4.74609 12.918 5.1084 12.918Z"})})}}]);