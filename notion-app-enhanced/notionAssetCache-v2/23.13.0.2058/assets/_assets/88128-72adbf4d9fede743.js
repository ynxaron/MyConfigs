"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[88128],{86609:(e,t,o)=>{o.d(t,{KV:()=>W,Rh:()=>$,U6:()=>G,Wu:()=>te,Xx:()=>N,YD:()=>ee,g9:()=>q,jc:()=>z,m8:()=>Q,ys:()=>X,zX:()=>J});o(122556),o(582845),o(250570),o(533019),o(721473),o(788208),o(22624),o(267602),o(30005),o(241792),o(228244);var n=()=>o(730120),r=()=>o(506347),i=()=>o(926724),a=()=>o(271896),s=()=>o(226413),l=()=>o(803021),c=()=>o(874459),u=()=>o(956057),d=()=>o(528514),p=()=>o(494616),m=()=>o(922713),S=()=>o(396136),g=()=>o(752778),f=()=>o(255933),y=()=>o(306164),x=()=>o(856466),v=()=>o(126301),C=()=>o(955620),h=()=>o(253335),_=()=>o(110232),b=()=>o(285755),k=()=>o(23151),j=()=>o(757216),w=()=>o(544903),T=()=>o(594546),M=()=>o(487270),B=()=>o(527278),I=()=>o(876822),R=()=>o(826955),V=()=>o(250303),F=()=>o(824462),A=()=>o(984871),D=()=>o(139224),P=()=>o(421654),Z=()=>o(636340),O=()=>o(511614),L=()=>o(269299),K=()=>o(663366),H=()=>o(348141);const U="week";function N(e){var t;const{environment:o,transaction:n,tasksBlockStore:r,sprintsBlockStore:i}=e,a=null===(t=i.getFormat())||void 0===t?void 0:t.collection_pointer,s=r.getFormat().collection_pointer;if(!a||!s)return;const l=R().NW.createChildStore(i,a),c=l.getRole()??"none";if(!(0,d().yY)(c,"editor"))return;l.getAutomationStores().some((e=>e.isCompleteSprintAutomation()))||E({environment:o,transaction:n,sprintCollectionStore:l,taskCollectionStore:R().NW.createChildStore(r,s),sprintSettingsConfig:x().iZ})}function E(e){const{environment:t,sprintSettingsConfig:o,transaction:n,sprintCollectionStore:r,taskCollectionStore:i}=e,a=r.getSpaceId(),s=(0,M().TS)({environment:t,table:p().cv,spaceId:a}),l=(0,M().TS)({environment:t,table:m().Xj,spaceId:a});Z().ae({environment:t,table:p().cv,inMemoryRecordCache:r.inMemoryRecordCache,value:{id:s,parent_id:r.id,parent_table:r.table,alive:!0,space_id:a,status:o.autoCompleteSprints?"active":"disabled",trigger:{id:u().Il(),type:"recurrence",recurrence:ne(o)},action_ids:[l]},transaction:n}),P().FH({stores:[r],update:{automation_ids:[...r.getFormat().automation_ids??[],s]},transaction:n}),Z().ae({environment:t,table:m().Xj,inMemoryRecordCache:r.inMemoryRecordCache,transaction:n,value:{id:l,parent_id:s,parent_table:p().cv,type:"complete_sprint",alive:!0,space_id:a,config:{sprint_collection:r.getSpaceShardedPointer(),task_collection:i.getSpaceShardedPointer(),complete_sprint_action:o.actionConfig.complete_sprint_action}}})}function W(e){const{environment:t,automationStore:o,transaction:n,newDuration:r,currentSprintBlockStore:i}=e;Z().sW({store:o.getTriggerStore().getKeyStore("recurrence"),data:{interval:r},transaction:n}),Y({environment:t,transaction:n,automationStore:o,currentSprintBlockStore:i})}function q(e){const{environment:t,automationStore:o,transaction:n,newWeekday:r,currentSprintBlockStore:i}=e;Z().sW({store:o.getTriggerStore().getKeyStore("recurrence"),data:{weekdays:[r]},transaction:n}),Y({environment:t,transaction:n,automationStore:o,currentSprintBlockStore:i})}function z(e){const{environment:t,actionStore:o,automationStore:n,transaction:r,newAutocompleteStatus:i,currentSprintBlockStore:s}=e;Z().sW({store:n,data:{status:i?"active":"disabled"},transaction:r}),Y({environment:t,transaction:r,automationStore:n,currentSprintBlockStore:s});const l=n.getParentPointer();if(!l||l.table!==g().vF)return;const c=(0,T().mc)(t),u={automation_id:n.id,automation_actions:[{automation_action_id:o.id,type:"complete_sprint"}],automation_triggers:[{type:"recurrence"}],collection_id:l.id};i?(0,a().Rt)(c,u):(0,a().ai)(c,u)}function Y(e){const{automationStore:t,currentSprintBlockStore:o,transaction:r,environment:a}=e;if(!t.isActive())return;const s=t.getRecurrence();if(!s)return;const c=(0,v().Su)(s);if(!c)return;const u=o.getPropertyValue(i().b0.Dates);if(!u)return;const d=(0,C().nai)(u)[0];if(!d||"daterange"!==d.type)return;const p=d.start_date,{start_date:m,end_date:S}=(0,v().DW)({currentSprintStartDate:p,sprintSchedule:c});Z().sW({store:t.getTriggerStore().getKeyStore("recurrence"),data:{start_date:(0,l().Jh)(n().ou.fromISO(m).plus({minutes:1}).toJSDate())},transaction:r}),k().xD({store:o,propertyId:i().b0.Dates,transaction:r,environment:a,type:"dateValue",dateValue:{type:"daterange",start_date:p,end_date:S}})}function G(e){const{transaction:t,newRemainingTasksBehavior:o,actionStore:n}=e;Z().sW({store:n.getConfigStore(),data:{complete_sprint_action:o},transaction:t})}async function X(e){var t;const{appTemplatesSetupActions:o,appTemplatesSprintBoardActions:n,appConfigs:a}=await w().vF.load(),{environment:s,collectionContextStore:l,from:c}=e,{currentSpaceViewStore:u}=I().default.state,d=l.collectionStore(),p=null==d?void 0:d.getParentBlockStore(),m=null==p?void 0:p.getParentStore(),g=null==d||null===(t=d.getFormat())||void 0===t?void 0:t.app_config_uri,x=g&&(0,_().YB)(a(),g);if(!d||!p||!m||!u||m.table!==f().bx&&m.table!==S().iU&&m.table!==y().e0||!x)return;const v=p.getFormat().app_id,C=v?await F().callApi({eventName:"getCollectionViewBlocksByAppId",environment:s,data:{spaceId:p.getSpaceId(),appId:v}}):void 0,b="success"===(null==C?void 0:C.type)&&C.data.result.length?C.data.result.map((e=>R().G.createChildStore(m,{table:S().iU,id:e.blockId,spaceId:p.getSpaceId()}))):[p];await oe({environment:s,taskCollectionStore:d,executeFn:()=>{const e=L().createAndCommit({userAction:"sprintSettingsActions.handleTurnOnSprints",environment:s,canUndo:!0,perform:e=>{const t=(0,h().eu)(),r=o.applyTypedFeatures({environment:s,spaceViewStore:u,appParentStore:m,appUri:x.uri,features:[{type:"simple",featureUri:t.uri}],transaction:e,createOrModify:"modify",appCollectionViewBlockStores:b}),a=n.createSprintPage({environment:s,spaceViewStore:u,appParentStore:m,transaction:e,blockStores:r,creationEntryPoint:{type:"sprint_settings"}});if(D().E3({collectionSettingsStore:l.settingsStore}),!a)return;const d=c?{feature:{id:i().Es.TaskToSprintRelation,from:c,type:"notion://projects/tasks_with_sprints_feature"}}:{};return V()._H({environment:s,collectionContextStore:l,from:"view_settings",property:i().Es.TaskToSprintRelation,property_type:"relation",is_suggested_property:!0,...d}),a}});e.serverCommitResult.then((()=>{const t=e.performResult;t&&O().r({environment:s,store:t,pageVisitSource:r().tY.Create})}))}})}async function Q(e){const{environment:t,collectionContextStore:o,sprintSettingsContext:n,sprintBoardViewBlockIds:a}=e,{sprintCollectionStore:s,automationContext:l,currentCollectionViewBlockStore:c,sprintCollectionViewBlockStore:u,taskCollectionStore:d,taskCollectionViewBlockStore:p}=n;if(!s||!u||!l)return;const m=p.getSpaceId(),g=[u,...a.map((e=>new(R().G)(t,{id:e,table:S().iU,spaceId:m})))];c.id===p.id?D().E3({collectionSettingsStore:o.settingsStore}):O().r({environment:t,store:p,pageVisitSource:r().tY.LeaveOrRemove});const{automationActions:f}=await b().Sm.automations.load(),{automationStore:y}=l;await oe({environment:t,taskCollectionStore:d,executeFn:()=>{L().createAndCommit({userAction:"sprintSettingsActions.handleTurnOffSprints",environment:t,canUndo:!0,perform:e=>{!function(e){const{transaction:t,blocksToDelete:o,environment:n,taskCollectionStore:r,sprintCollectionStore:a}=e;Z().sW({store:a,transaction:t,data:{alive:!1}}),A().E2({environment:n,collectionStore:r,schema:r.getSchema(),property:i().Es.TaskToSprintRelation,transaction:t,permanentlyDelete:!0}),K().y8({environment:n,blocks:o,transaction:t,permanentlyDelete:!0})}({environment:t,transaction:e,blocksToDelete:g,sprintCollectionStore:s,taskCollectionStore:d}),f.disableAutomation({automationStore:y,environment:t,transaction:e}),f.deleteAutomation({automationStore:y,environment:t,transaction:e})}}),V().y9({environment:t,collectionContextStore:o,property_type:"relation",from:"view_settings",property:i().Es.TaskToSprintRelation})}})}function J(e){const{environment:t,userSettingsStore:o}=e;L().createAndCommit({userAction:"sprintSettingsActions.handleSeenSprintsEngagementBanner",environment:t,canUndo:!0,perform:e=>{H().d2({userSettingsStore:o,data:{seen_sprint_settings_engagement_banner:!0},transaction:e})}})}function $(e){e.settingsStore.setState({open:!0,stack:[{type:"main"},{type:"sprintSettings"}]})}function ee(e){const{environment:t,collectionContextStore:o,currentViewBlockStore:n,taskCollectionViewBlockStore:r}=e,a=o.collectionViewStore();if(!a)return;const s=a.getFormat(),l=a.getRawQuery();L().createAndCommit({userAction:"sprintSettingsActions.handleManageSprintFromThisView",environment:t,canUndo:!0,perform:e=>{if((0,j().i)({collectionViewStore:a,transaction:e,update:{name:B().Z.formatMessage(h().sY.tasksCurrentSprintV2ViewName),query2:{...l,filter:void 0},format:{...s,collection_view_icon:"/icons/playback-play-button_gray.svg",property_filters:h().Jt,app_config_uri:i().g3,hide_linked_collection_name:!0}}}),n.id===r.id){var t;const o=(null===(t=n.getFormat())||void 0===t?void 0:t.app_uri_map)??{},l=s.app_config_uri;l&&delete o[l],P().FH({stores:[r],update:{app_uri_map:{...o,[i().g3]:a.id}},transaction:e})}}})}function te(e){const{environment:t,sprintSettingsContext:o}=e;if(!o)return;const n=o.sprintCollectionStore,r=(null==n?void 0:n.getRole())??"none";n&&(0,d().yY)(r,"editor")&&o.automationContextLoaded&&!o.automationContext&&L().createAndCommit({userAction:"sprintSettingsActions.ensureCompleteSprintAutomation",environment:t,canUndo:!0,perform:e=>{E({environment:t,transaction:e,sprintCollectionStore:n,taskCollectionStore:o.taskCollectionStore,sprintSettingsConfig:x().iZ})}})}async function oe(e){const{executeFn:t,environment:o,taskCollectionStore:n}=e;await async function(e){var t;const{environment:o,taskCollectionStore:n}=e,r=n.getFormat().app_uri_map,a=i().Es.TaskToSprintRelation,l=n.getSchema(),c=(null==r?void 0:r[a])??a,u=l[c];if(!u||!(0,s().p_)(u))return;const d=null===(t=(0,s().j0)(u))||void 0===t?void 0:t.id;if(!d)return;const p=new Set([c]);Object.entries(l).forEach((e=>{var t;let[o,n]=e;n&&(0,s().p_)(n)&&(null===(t=(0,s().j0)(n))||void 0===t?void 0:t.id)===d&&p.add(o)}));const{serverCommitResult:m}=L().createAndCommit({userAction:"sprintSettingsActions.clearSprintRelationDataFromTaskCollection",environment:o,canUndo:!0,perform:e=>{for(const t of p)A().E2({environment:o,transaction:e,permanentlyDelete:!0,collectionStore:n,schema:l,property:t});null==r||delete r[a],r&&P().FH({stores:[n],transaction:e,update:{app_uri_map:r}})}});await m}({environment:o,taskCollectionStore:n}),t()}function ne(e){return{frequency:U,interval:e.recurrenceConfig.interval,weekdays:e.recurrenceConfig.weekdays,start_date:(0,l().Jh)(n().ou.local().set({hour:0,minute:0,second:0,millisecond:0}).toJSDate()),timezone:(0,c().Sv)(),hour:0,minute:0}}},23151:(e,t,o)=>{o.d(t,{Fv:()=>M,JN:()=>b,QG:()=>I,cQ:()=>T,f$:()=>k,fX:()=>w,td:()=>j,xD:()=>B});o(670560),o(267602),o(30005),o(241792);var n=()=>o(730120),r=()=>o(552221),i=()=>o(532850),a=()=>o(803021),s=()=>o(874459),l=()=>o(998411),c=()=>o(752778),u=()=>o(513670),d=()=>o(696459),p=()=>o(250303),m=()=>o(384667),S=()=>o(366257),g=()=>o(332542),f=()=>o(636340),y=()=>o(970105),x=()=>o(887430),v=()=>o(32969),C=()=>o(35982),h=()=>o(826955),_=()=>o(526243);function b(e){const{environment:t,droppedStores:o,duplicate:i,calendarBy:u,transaction:d,collectionContextStore:S}=e,f=n().ou.fromMillis(e.startOfDay);let y=!0;for(const n of o){const t=e.collectionStore?e.collectionStore:(0,x().Bm)({store:n,collectionContextStore:S});if(n.getParentTable()===c().vF||!t){y=!1;break}g().zw({childStore:n,parentStore:t,transaction:d})||(y=!1)}const v=m().Ab({environment:t,droppedStores:o,duplicate:i,transaction:d,collectionStore:e.collectionStore});for(const n of v){const o=e.collectionStore?e.collectionStore:(0,x().Bm)({store:n,collectionContextStore:S});if(!o)continue;const i=o.getMappedProperty(u),c=n.getPropertyStore(i),g=(0,r().G)(c.getValue())||s().Lg((0,l().r)()),v=s().c$(g,(0,l().r)()),C=f.toFormat(s().Iq);let h;if("date"===v.type||"datetime"===v.type)h={...v,start_date:C};else{const e=s().NK(v,(0,l().r)());if(!e.end)return;const t={...v,start_date:C},o=s().NK(t,(0,l().r)()).start.diff(e.start,"days"),n=e.end.plus(o).toFormat(s().Iq);h={...v,start_date:C,end_date:n}}const _=s().c$(h,a().yw(g)||(0,l().r)());m().mp({environment:t,store:n,collectionStore:o,collectionContextStore:S,shouldCoerce:!0,groupsPointer:[],transaction:d,alreadyMovedToCollection:y}),B({environment:t,type:"dateValue",propertyId:i,store:n,transaction:d,dateValue:_}),p().rv({environment:t,collectionContextStore:S,block_id:n.id,property:i,property_type:"date",from:"calendar"})}}function k(e){const{calendarStore:t,direction:o,targetStore:n}=e;t.setState({...t.state,isDragging:!0,targetStore:n,direction:o,temporaryValue:void 0})}function j(e){const{calendarStore:t,x:o,y:i,calendarBy:c}=e,d=t.state;if(d.isDragging){const e=(0,r().G)(d.targetStore.getPropertyStore(c).getValue());if(!e)return;const p=s().c$(e,(0,l().r)()),m=d.temporaryValue||e,S=s().c$(m,(0,l().r)()),g=[];d.dayStoreMap.forEach(((e,t)=>{g.push({store:e,timestamp:t})}));const f=g.find((e=>{let{store:t}=e;const n=v().C.getRectFromStore(t);return Boolean(n&&C().uh(n,o,i))}));let y;if(f){const e=n().ou.fromMillis(f.timestamp),t=e.endOf("day"),o=e.toFormat(s().Iq);if(p){const r=s().NK(p,(0,l().r)());if(d.direction===_().to.Left)if(n().Xp.fromDateTimes(e,t).contains(r.start))y=p;else{let e;e="datetimerange"===p.type||"daterange"===p.type?{...p,start_date:o,end_date:p.end_date}:"datetime"===p.type?{type:"datetimerange",start_date:o,start_time:p.start_time,end_date:p.start_date,end_time:p.start_time,time_zone:p.time_zone,reminder:p.reminder}:{type:"daterange",start_date:o,end_date:p.start_date,reminder:p.reminder};const t=s().NK(e,(0,l().r)());y=!r.end&&t.start>r.start||r.end&&t.start>r.end?S:e}else if(r.end?n().Xp.fromDateTimes(e,t).contains(r.end):n().Xp.fromDateTimes(e,t).contains(r.start))y=p;else{let e;e="date"===p.type?{...p,type:"daterange",end_date:o}:"datetime"===p.type?{...p,type:"datetimerange",end_date:o,end_time:"00:00"}:{...p,end_date:o};const t=s().NK(e,(0,l().r)());y=t.end&&t.end<t.start?S:e}}}if(y&&!u().Xy(S,y)){const e=s().c$(y,a().yw(m)||(0,l().r)());t.setState({...d,temporaryValue:e})}}}function w(e){const{environment:t,calendarStore:o,calendarBy:n,transaction:r}=e,i=o.state;i.isDragging&&i.temporaryValue&&(B({type:"dateValue",environment:t,dateValue:i.temporaryValue,propertyId:n,store:i.targetStore,transaction:r}),o.setState({...o.state,isDragging:!1}))}function T(e){const{calendarStore:t}=e,o=t.state;o.isDragging&&t.setState({...o,isDragging:!1})}function M(e){const{environment:t,store:o,collectionStore:r,collectionContextStore:a,startDayOfWeek:c,transaction:u}=e,d=a.dateRangeStartStore.state,p=(0,l().r)(),S=a.normalizedQueryStore.state;if(!S||!S.calendar_by)return;const g=(null==r?void 0:r.getMappedProperty(S.calendar_by))??S.calendar_by,y=s().gQ(d,c,p),x=y.startOf("month"),v=y.endOf("month"),C=n().ou.now().startOf("day");let h;return h=n().Xp.fromDateTimes(x,v).contains(C)?s().hT(C.valueOf(),p):s().hT(s().em(d,c,p).valueOf(),p),f().sW({store:o.getPropertiesStore(),data:{[g]:i().d7(h)},transaction:u}),m().mp({environment:t,store:o,collectionStore:r,collectionContextStore:a,shouldCoerce:!0,groupsPointer:[],transaction:u}),o}function B(e){const{environment:t,store:o,propertyId:n,transaction:r}=e;let a;"timestamp"===e.type?a=s().hT(e.timestampMs.valueOf(),(0,l().r)()):"dateValue"===e.type?a=e.dateValue:(0,d().t1)(e);const c=o.getPropertyValue(n),u=i().d7(a);f().sW({store:o.getPropertiesStore(),data:{[n]:u},transaction:r}),S().H({environment:t,store:o,dateProperty:{id:n,oldValue:c,newValue:u}})}function I(e){const{environment:t,collectionStore:o,calendarBy:n,store:r,insertStores:i,collectionContextStore:a,transaction:s}=e,l=r.getPropertyStore(n).getValue();for(const c of i)m().mp({environment:t,store:c,collectionStore:o,collectionContextStore:a,shouldCoerce:!0,groupsPointer:[],transaction:s}),y().sO({environment:t,store:c.getPropertyStore(n),value:l,transaction:s});return i.map((e=>h().G.createChildStore(o,e.pointer)))}},67901:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(667294),r=()=>o(142735),i=o(785893);function a(e){const{resultStore:t,render:a,...s}=e,l=(0,o(662753).Z)(s),c=(0,r().qz)(t,o(263184).default.createClass(void 0));(0,n.useEffect)((()=>{c.setState(l)}),[l,c]);const u=(0,r().VK)((()=>a?a(c):null),[a,c]);return(0,i.jsx)(i.Fragment,{children:u})}const s=n.memo(a)},259314:(e,t,o)=>{o.d(t,{Pt:()=>N,Xo:()=>G,ZP:()=>W});o(267602),o(653476),o(470928),o(241792);var n=o(667294),r=()=>o(629013),i=()=>o(219727),a=()=>o(142735),s=()=>o(846550),l=()=>o(570328),c=()=>o(159732),u=()=>o(788860),d=()=>o(513670),p=()=>o(250303),m=()=>o(151861),S=()=>o(139224),g=()=>o(879952),f=()=>o(990966),y=()=>o(765458),x=()=>o(84439),v=()=>o(830700),C=()=>o(628370),h=()=>o(265640),_=()=>o(69870),b=()=>o(119891),k=()=>o(206352),j=()=>o(291198),w=()=>o(967092),T=()=>o(560287),M=()=>o(71410),B=()=>o(347577),I=()=>o(565276),R=()=>o(673385),V=()=>o(845297),F=()=>o(364300),A=()=>o(703256),D=()=>o(237789),P=()=>o(933713),Z=()=>o(707513),O=()=>o(104088),L=()=>o(61738),K=o(785893);function H(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const{device:r}=(0,i().O7)(),s=(0,a().VK)((()=>o.state.open),[o]),l=(0,n.useCallback)((e=>{e&&(0,I().yT)(e.target)||S().E3({collectionSettingsStore:o})}),[o]),c=(0,n.useCallback)((()=>(0,K.jsx)(y().PJ,{context:B().HV.FilterBar,collectionContextStore:t,collectionSettingsStore:o,hideDesktopHeader:!0})),[t,o]);return(0,n.useEffect)((()=>()=>S().E3({collectionSettingsStore:o})),[]),(0,K.jsx)(w().ZP,{popupType:r.isMobile?O().k.SlideUp:O().k.Popup,open:s,origin:(0,K.jsx)(U,{collectionContextStore:t,collectionSettingsStore:o}),onDismiss:l,disableMouseCapture:!0,enableOutsideClickDismiss:!0,originGap:4,render:c})}function U(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const r=(0,i().O7)(),[l,c,d,m]=(0,a().VK)((()=>[t.currentSortsStore.state,t.localStateDiffStore.state,t.normalizedSchemaStore.state,t.permissionScopesStore.state]),[t]),g=l[0],f=g?d[g.property]:void 0,y=(0,n.useCallback)((()=>{p().wd({environment:r,collectionContextStore:t,action:"click_sort"}),S().wl({collectionSettingsStore:o,item:{type:"sort"}})}),[t,o,r]),x=(0,s().yK)((e=>({arrowIcon:{width:12,marginRight:4,fill:e.blueColor},arrowsIcon:{width:16,marginRight:4,fill:e.blueColor},title:{marginTop:-1,maxWidth:220,...Z().Yu}})),[]);let v;return v=1===l.length?g&&"descending"===g.direction?(0,A().N)(x.arrowIcon):(0,P().w)(x.arrowIcon):(0,D().T)(x.arrowsIcon),(0,K.jsx)(L().Z,{on:!0,hasDiff:Boolean(m.canConfigureBlock&&c.sorts),icon:v,title:(0,K.jsx)("span",{style:x.title,children:1===l.length&&f?f.name:(0,K.jsx)(u()._H,{defaultMessage:"{sortCount} sorts",id:"database.filterBar.sorts.label",values:{sortCount:l.length}})}),onClick:y})}let N=function(e){return e[e.FilterBar=0]="FilterBar",e[e.SettingsFilters=1]="SettingsFilters",e}({});const E=o(263184).default.createClass({open:!1,stack:[]},{name:"CreateFilterSettingsStore"});const W=function(e){var t;let{collectionContextStore:n,showHoverActionsStore:r,createFilterSettingsStore:l,saveControlMoreActionsButtonPopupStore:c}=e;const u=(0,i().MO)(),d=(0,s().Fg)(),p=(0,a().qz)(c,o(529048).Z),m=(0,a().qz)(l,E),S=(0,a().VK)((()=>(0,o(576868).Nq)(n)),[n]),g=(0,a().VK)((()=>u&&n.searchOpenStore.state),[u,n]),f=(0,a().Kw)(n.currentPropertyFiltersStore),y=(0,a().Kw)(n.currentSortsStore),x=(0,a().VK)((()=>n.shouldShowSourceStore.state?8:12),[n]),v=(0,a().VK)((()=>n.filterBarSortSettingsStore.state.open),[n]),C=y.length>0||v,h=(0,a().Kw)(n.permissionScopesStore),_=(0,a().VK)((()=>h.canConfigureBlock?n.currentCombinatorFilterStore.state:void 0),[h,n]),b=(0,a().VK)((()=>n.isUnlistedViewStore.state),[n]),k=(0,a().qz)(void 0,o(561280).Z),j=null===(t=(0,o(887430).jw)(n,d))||void 0===t?void 0:t.background;return(0,K.jsxs)("div",{style:{width:"100%",zIndex:o(492522)._Y,...b&&{paddingLeft:16,paddingRight:16}},onClick:e=>function(e,t){t.filtersBarOpenStore.setState(!0)}(0,n),children:[(0,K.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[g&&(0,K.jsx)(J,{collectionContextStore:n}),!g&&(0,K.jsxs)("div",{style:{position:"relative",flexGrow:0,overflow:"hidden"},children:[(0,K.jsx)(o(842574).T,{store:k,type:o(520849).Z.X,style:{display:"flex",alignItems:"center",paddingTop:x,paddingBottom:8},children:u?(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)($,{collectionContextStore:n}),C&&(0,K.jsx)(z,{collectionContextStore:n}),C&&!u&&(0,K.jsx)(G,{}),_&&(0,K.jsx)(q,{collectionContextStore:n}),(0,K.jsx)(Q,{collectionContextStore:n,propertyFilters:f}),(0,K.jsx)(oe,{collectionContextStore:n,showHoverActionsStore:r,createFilterSettingsStore:m})]}):(0,K.jsxs)(K.Fragment,{children:[C&&(0,K.jsx)(z,{collectionContextStore:n}),C&&!u&&(0,K.jsx)(G,{}),_&&(0,K.jsx)(q,{collectionContextStore:n}),(0,K.jsx)(Q,{collectionContextStore:n,propertyFilters:f}),(0,K.jsx)(oe,{collectionContextStore:n,showHoverActionsStore:r,createFilterSettingsStore:m})]})}),!u&&(0,K.jsx)(o(242758).Z,{store:k,backgroundColor:j})]}),(0,K.jsxs)("div",{style:{display:"flex",alignItems:"center",marginLeft:"auto"},children:[!u&&S&&(0,K.jsx)(ee,{collectionContextStore:n,showHoverActionsStore:r,saveControlMoreActionsButtonPopupStore:p}),!u&&(0,K.jsx)(T().Z,{collectionContextStore:n})]})]}),u&&!g&&(0,K.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[S&&(0,K.jsx)(ee,{collectionContextStore:n,showHoverActionsStore:r,saveControlMoreActionsButtonPopupStore:p}),(0,K.jsx)(T().Z,{collectionContextStore:n})]})]})};function q(e){let{collectionContextStore:t}=e;return(0,K.jsx)(V().B,{context:N.FilterBar,collectionSettingsStore:t.filterBarCombinatorFilterSettingsStore,collectionContextStore:t})}function z(e){let{collectionContextStore:t}=e;return(0,K.jsx)(H,{collectionContextStore:t,collectionSettingsStore:t.filterBarSortSettingsStore},"sort")}function Y(e){let{filter:t,collectionContextStore:o}=e;const n=(0,a().VK)((()=>o.getFilterBarItemSettingsStore(t)),[o,t]);return(0,K.jsx)(F().Z,{id:t.id,context:N.FilterBar,collectionContextStore:o,collectionSettingsStore:n},t.id)}function G(){const e=(0,s().Fg)();return(0,K.jsx)("div",{style:{borderRight:`1px solid ${e.regularDividerColor}`,height:24,marginRight:12,marginLeft:8}})}function X(e){e.searchOpenStore.setState(!1),e.searchQueryStore.setState("")}function Q(e){let{propertyFilters:t,collectionContextStore:o}=e;const n=(0,i().O7)();if((0,a().Kw)(o.permissionScopesStore).canConfigureBlock){const e=t.map((e=>e.id));return(0,K.jsx)(b().ZP,{direction:"horizontal",keys:e,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,renderKey:e=>{const n=t.find((t=>t.id===e));if(n)return(0,K.jsx)(Y,{collectionContextStore:o,filter:n})},style:{display:"flex",flexShrink:0},onDrop:e=>function(e,t,o){if(!o.collectionViewBlockStore())return;const n=o.currentPropertyFiltersStore.state,r=d().oA(e.map((e=>n.find((t=>t.id===e)))));m().iU({environment:t,collectionContextStore:o,temporaryState:{...o.temporaryStateStore.state,propertyFilters:{value:r}}}),p().wd({environment:t,collectionContextStore:o,action:"reorder_filters"})}(e,n,o)})}return(0,K.jsx)(K.Fragment,{children:t.map((e=>(0,K.jsx)(Y,{filter:e,collectionContextStore:o},e.id)))})}function J(e){let{collectionContextStore:t}=e;const o=(0,u().YB)(),c=(0,s().Fg)(),d=(0,i().O7)(),p=(0,a().Kw)(t.searchQueryStore),m=(0,n.useCallback)((e=>{t.searchQueryStore.setState(e.target.value)}),[t]),S=(0,r().y)(m,250);return(0,K.jsx)(k().Z,{debugName:"CollectionViewFilterBar",capture:!0,children:(0,K.jsx)(M().Z,{capture:!0,render:e=>(0,K.jsx)("div",{...e,style:{width:"100%",paddingTop:d.device.isMobile?8:12,paddingBottom:6},children:(0,K.jsx)(L().Z,{wrapStyle:{width:"100%"},innerStyle:{width:"100%"},icon:(0,l().e)({width:14,fill:c.mediumIconColor,marginRight:6}),hideChevron:!0,title:(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(j().Z,{format:j().B.Transparent,value:p,placeholder:o.formatMessage({defaultMessage:"Type to search…",id:"database.filterBar.mobileSearch.placeholder"}),onChange:S,autoComplete:"on",autoCorrect:"on",onBlur:()=>function(e){e.searchQueryStore.state||X(e)}(t),onClearButtonClick:()=>X(t),showClearButton:!0,focus:!d.device.isIOS||void 0,focusInitial:!0,inputStyle:{height:"100%"}}),(0,K.jsx)(_().Z,{show:!0})]})})})})})}function $(e){let{collectionContextStore:t}=e;const o=(0,s().Fg)(),n=(0,i().O7)();return"chart"===(0,a().VK)((()=>t.getViewType()),[t])?null:(0,K.jsx)(L().Z,{wrapStyle:{display:"flex",alignItems:"center"},icon:(0,l().e)({width:14,fill:o.mediumIconColor,marginRight:6}),hideChevron:!0,title:(0,K.jsx)("span",{style:{marginTop:-1,color:o.mediumTextColor},children:(0,K.jsx)(u()._H,{defaultMessage:"Search",id:"database.filterBar.search.title"})}),onClick:()=>function(e,t){f().clear({preventDismissMobileKeyboard:!0,environment:e}),g().ZH({preventDismissMobileKeyboard:!0,environment:e}),(0,R().w)(),t.searchOpenStore.setState(!0),t.searchQueryStore.setState(""),p().wd({environment:e,collectionContextStore:t,action:"click_mobile_search"})}(n,t)},"search")}function ee(e){let{collectionContextStore:t,showHoverActionsStore:o,saveControlMoreActionsButtonPopupStore:n}=e;return(0,K.jsx)(x().ZP,{context:x().R1.FilterBar,collectionContextStore:t,showHoverActionsStore:o,moreActionsButtonPopupStore:n})}function te(e){let{collectionContextStore:t,createFilterSettingsStore:o}=e;return(0,K.jsx)(y().PJ,{context:B().HV.FilterBar,collectionContextStore:t,collectionSettingsStore:o,hideDesktopHeader:!0})}function oe(e){let{collectionContextStore:t,showHoverActionsStore:o,createFilterSettingsStore:r}=e;const s=(0,i().O7)(),l=(0,n.useCallback)((e=>function(e,t){e&&(0,I().yT)(e.target)||S().E3({collectionSettingsStore:t})}(e,r)),[r]),d=(0,v().o)({collectionContextStore:t}),m=(0,n.useCallback)((()=>(0,K.jsx)(te,{collectionContextStore:t,createFilterSettingsStore:r})),[t,r]),g=(0,n.useCallback)((()=>function(e,t,o){p().wd({environment:e,collectionContextStore:t,action:"click_new_filter"}),S().wl({collectionSettingsStore:o,item:{type:"createFilter"}})}(s,t,r)),[s,t,r]),f=(0,a().VK)((()=>r.state.open),[r]),y=(0,a().VK)((()=>o.state||f),[o,f]);return(0,K.jsx)(w().ZP,{open:f,popupType:s.device.isMobile?w().kQ.SlideUp:w().kQ.Popup,style:d?{height:B().DQ,maxHeight:B().DQ}:void 0,origin:(0,K.jsx)(C().Z,{tag:h().D,visible:y,animate:{opacity:1},initial:{opacity:0},exit:{opacity:0},icon:c().R,size:"sm",isLightGray:!0,hovered:f,onClick:g,style:{fontSize:14},children:(0,K.jsx)(u()._H,{defaultMessage:"Add filter",id:"database.filterBar.addButton.title"})}),render:m,disableMouseCapture:!0,enableOutsideClickDismiss:!0,originGap:4,onDismiss:l})}},845297:(e,t,o)=>{o.d(t,{B:()=>_});var n=o(667294),r=()=>o(219727),i=()=>o(142735),a=()=>o(846550),s=()=>o(185056),l=()=>o(788860),c=()=>o(707513),u=()=>o(250303),d=()=>o(151861),p=()=>o(139224),m=()=>o(765458),S=()=>o(830700),g=()=>o(967092),f=()=>o(347577),y=()=>o(949842),x=()=>o(565276),v=()=>o(104088),C=()=>o(61738),h=o(785893);function _(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const a=(0,r().O7)(),[s,l]=(0,i().VK)((()=>[o.state.open,t.currentCombinatorFilterStore.state]),[t,o]),c=(0,S().o)({collectionContextStore:t}),u=(0,n.useCallback)((()=>(0,h.jsx)(m().PJ,{context:f().HV.FilterBar,collectionContextStore:t,collectionSettingsStore:o,hideDesktopHeader:!0})),[t,o]),y=(0,n.useCallback)((e=>{var n;e&&(0,x().yT)(e.target)||(p().E3({collectionSettingsStore:o}),l&&0===(null===(n=l.filters)||void 0===n?void 0:n.length)&&d().iU({environment:a,collectionContextStore:t,temporaryState:{...t.temporaryStateStore.state,combinatorFilter:{value:void 0}}}))}),[t,o,a,l]);return(0,n.useEffect)((()=>()=>p().E3({collectionSettingsStore:o})),[]),(0,h.jsx)(g().ZP,{popupType:a.device.isMobile?v().k.SlideUp:v().k.Popup,open:s,origin:(0,h.jsx)(b,{collectionContextStore:t,collectionSettingsStore:o}),style:c?{height:f().DQ,maxHeight:f().DQ}:void 0,onDismiss:y,disableMouseCapture:!0,enableOutsideClickDismiss:!0,originGap:4,render:u})}function b(e){var t;let{collectionContextStore:o,collectionSettingsStore:d}=e;const m=(0,r().O7)(),S=(0,a().yK)((e=>({icon:{width:void 0,height:m.device.isMobile?14:12,fill:e.blueColor,marginRight:6},title:{maxWidth:180,...c().Yu}})),[m.device]),[g,f]=(0,i().VK)((()=>[Boolean(o.localStateDiffStore.state.combinatorFilter),o.currentCombinatorFilterStore.state]),[o]),x=(0,n.useCallback)((()=>{f&&(p().wl({collectionSettingsStore:d,item:{type:"filter"}}),u().wd({environment:m,collectionContextStore:o,action:"click_combinator_filter"}))}),[o,d,m,f]);return f?(0,h.jsx)(C().Z,{icon:(0,s().Q)(S.icon),title:(0,h.jsx)("span",{style:S.title,children:(0,h.jsx)(l()._H,{defaultMessage:"{ruleCount, plural, one {{ruleCount} rule} other {{ruleCount} rules}}",id:"database.filterBar.advancedFilterRulesCount.title",values:{ruleCount:(null===(t=f.filters)||void 0===t?void 0:t.length)||0}})}),on:!0,hasDiff:g,onClick:e=>(0,y().ZP)({event:e,context:y().Af.CollectionSettingsClick,callback:x})},"combinator"):null}},364300:(e,t,o)=>{o.d(t,{Z:()=>U});o(267602),o(653476),o(470928),o(241792);var n=o(667294),r=()=>o(142735),i=()=>o(455947),a=()=>o(788860),s=()=>o(707513),l=()=>o(250303),c=()=>o(151861),u=()=>o(139224),d=()=>o(780550),p=()=>o(654133),m=()=>o(576868),S=()=>o(949842),g=()=>o(620218),f=()=>o(998901),y=()=>o(104088),x=()=>o(163262),v=()=>o(803021),C=()=>o(995867),h=()=>o(605974),_=()=>o(396136),b=()=>o(696056),k=()=>o(752778),j=()=>o(989478),w=()=>o(499110),T=()=>o(513670),M=()=>o(696459),B=()=>o(384241),I=()=>o(308252),R=()=>o(32072),V=()=>o(826955),F=o(785893);const A=function(e){let{schema:t,propertyFilter:n,parentStore:s,valueOnly:l,style:c}=e;const u=(0,r().VK)((()=>{const e=t[n.property];if(e&&(0,o(226413).p_)(e))return(0,o(129338).ke)(e,s)}),[t,n,s]),{filter:d}=n,p=(0,i().a_)(d)?d.subfilter:d,m=(0,i().h6)(p)&&!(0,i().mv)(d),S={...c,maxWidth:void 0};return(0,F.jsx)("span",{style:(0,i().gE)(p)?S:c,children:(0,F.jsx)(a()._H,{defaultMessage:"{propertyName}{colonSeparator} {filterOperator} {propertyValue}",id:"database.filterBarFilterValue.title",values:{propertyName:l?void 0:(0,F.jsx)(P,{propertyFilter:n,schema:t}),colonSeparator:l||m?void 0:":",filterOperator:(0,F.jsx)(Z,{propertyFilter:n}),propertyValue:(0,F.jsx)(L,{propertyFilter:n,schema:t,parentStore:s,relatedCollectionAppConfigUri:u})}})})};function D(){return(0,F.jsx)(a()._H,{defaultMessage:"Not",id:"database.filterBarFilterValue.notOperator"})}function P(e){let{propertyFilter:t,schema:o}=e;const n=o[t.property];return n?(0,F.jsx)("span",{style:{fontWeight:s().Ue.medium},children:n.name}):null}function Z(e){let{propertyFilter:t}=e;const{filter:o}=t,n=(0,i().a_)(o)?o.subfilter:o;if((0,i().Ly)(n))return"string_contains"===n.operator||"string_is"===n.operator?null:"string_does_not_contain"===n.operator||"string_is_not"===n.operator?(0,F.jsx)(D,{}):(0,F.jsx)(F.Fragment,{children:(0,R().WC)(n.operator)});if((0,i().JQ)(n))return"geo_point_is_within"===n.operator?null:"geo_point_is_not_within"===n.operator?(0,F.jsx)(D,{}):(0,F.jsx)(F.Fragment,{children:(0,R().WC)(n.operator)});if((0,i().h6)(n))return(0,F.jsx)(F.Fragment,{children:(0,R().WC)(n.operator)});if((0,i().XA)(n)){if("checkbox_is_not"===n.operator)return(0,F.jsx)(D,{})}else{if((0,i().dx)(n))return"enum_is"===n.operator?null:"enum_is_not"===n.operator?(0,F.jsx)(D,{}):(0,F.jsx)(F.Fragment,{children:(0,R().WC)(n.operator)});if((0,i().NU)(n))return"enum_contains"===n.operator?null:"enum_does_not_contain"===n.operator?(0,F.jsx)(D,{}):(0,F.jsx)(F.Fragment,{children:(0,R().WC)(n.operator)});if((0,i().r2)(n))return"status_is"===n.operator?null:"status_is_not"===n.operator?(0,F.jsx)(D,{}):(0,F.jsx)(F.Fragment,{children:(0,R().WC)(n.operator)});if((0,i().e)(n))return"relation_contains"===n.operator?null:"relation_does_not_contain"===n.operator?(0,F.jsx)(D,{}):(0,F.jsx)(F.Fragment,{children:(0,R().WC)(n.operator)});if((0,i().Gb)(n))return"person_contains"===n.operator?null:"person_does_not_contain"===n.operator?(0,F.jsx)(D,{}):(0,F.jsx)(F.Fragment,{children:(0,R().WC)(n.operator)});if((0,i().Mp)(n)){if("location_is"===n.operator)return null;if("location_is_not"===n.operator)return(0,F.jsx)(D,{})}else if((0,i().gE)(n)){if("date_is"===n.operator)return null;if("date_is_after"===n.operator)return(0,F.jsx)(a()._H,{defaultMessage:"After",id:"database.filterValue.dateType.dateIsAfter.title"});if("date_is_before"===n.operator)return(0,F.jsx)(a()._H,{defaultMessage:"Before",id:"database.filterValue.dateType.dateIsBefore.title"});if("date_is_on_or_after"===n.operator)return(0,F.jsx)(a()._H,{defaultMessage:"On or after",id:"database.filterValue.dateType.dateIsOnOrAfter.title"});if("date_is_on_or_before"===n.operator)return(0,F.jsx)(a()._H,{defaultMessage:"On or before",id:"database.filterValue.dateType.dateIsOnOrBefore.title"});if(!(0,i().TQ)(n))return(0,F.jsx)(F.Fragment,{children:(0,R().WC)(n.operator)});{const e=n.value;if(!e.value||"exact"!==e.type||!(0,v().gR)(e.value))return(0,F.jsx)(F.Fragment,{children:(0,R().ip)(e)});if(e.value.start_date&&e.value.end_date)return null;if(e.value.start_date)return(0,F.jsx)(a()._H,{defaultMessage:"Starting",id:"database.filterValue.dateType.starting.title"});if(e.value.end_date)return(0,F.jsx)(a()._H,{defaultMessage:"Ending",id:"database.filterValue.dateType.ending.title"})}}else{if((0,i().Jw)(n))return"verification_is"===n.operator?null:"verification_is_not"===n.operator?(0,F.jsx)(D,{}):(0,F.jsx)(F.Fragment,{children:(0,R().WC)(n.operator)});(0,M().t1)(n)}}return null}function O(e){let{index:t}=e;return(0,F.jsx)("span",{style:{whiteSpace:"pre"},children:(0,F.jsx)(a()._H,{defaultMessage:", ",id:"database.filterValue.commaSeparator"})},t)}function L(e){let{propertyFilter:t,schema:o,parentStore:n,relatedCollectionAppConfigUri:r}=e;const{filter:s}=t,l=(0,i().a_)(s)?s.subfilter:s;if(!(0,i().vR)(l))return null;if((0,i().Ly)(l)||(0,i().h6)(l)){const e=l.value.value;if(void 0!==e)return(0,F.jsx)("span",{children:e})}else if((0,i().XA)(l)){const e=l.value.value;if(!0===e)return(0,F.jsx)("span",{children:(0,F.jsx)(a()._H,{defaultMessage:"Checked",id:"database.filterValue.checkboxType.checked.title"})});if(!1===e)return(0,F.jsx)("span",{children:(0,F.jsx)(a()._H,{defaultMessage:"Unchecked",id:"database.filterValue.checkboxType.unchecked.title"})})}else{if((0,i().dx)(l)||(0,i().NU)(l)){const e=(0,i().dx)(l)?(0,i().mg)(l):(0,i().qC)(l),t=T().oA(e.map((e=>{let{value:t}=e;return t})));return 0===t.length?null:(0,F.jsx)("span",{children:(0,C().Z)(t,(e=>(0,F.jsx)(O,{index:e})))})}if((0,i().r2)(l)){const e=(0,i().wB)(l),t=T().oA(e.map((e=>{let{value:t}=e;return t})));return 0===t.length?null:(0,F.jsx)("span",{children:(0,C().Z)(t,(e=>(0,F.jsx)(O,{index:e})))})}if((0,i().e)(l)){const e=(0,i().YO)(l),t=T().oA(e.map(((e,t)=>{if(!e.value)return null;const o=e.type;if("exact"===o){const t=V().G.createChildStore(n,{table:_().iU,id:e.value});return(0,F.jsx)(B().Z,{style:{display:"inline"},store:t},e.value)}if("relative"===o){var i;if("builtin"===e.value.type)return r?(0,F.jsx)("span",{children:(0,F.jsx)(a()._H,{...null===(i=h().qB[r])||void 0===i||null===(i=i[e.value.variable])||void 0===i?void 0:i.messageDescriptor})},t):null;if("current_page_in_related_collection"===e.value.type)return(0,F.jsx)("span",{children:(0,F.jsx)(a()._H,{defaultMessage:"This page",id:"database.filterAndSort.currentPagePropertyValue.title"})},t)}else(0,M().t1)(o)})));return(0,F.jsx)(F.Fragment,{children:(0,C().Z)(t,(e=>(0,F.jsx)(O,{index:e})))})}if((0,i().Gb)(l))return(0,F.jsx)(K,{useFilter:l,parentStore:n});if((0,i().Mp)(l)){const e=(0,i().u0)(l),t=T().oA(e.map((e=>{if(e.value){const t=e.value,o=V().t1.createChildStore(n,{table:k().vF,id:t});return(0,F.jsx)(B().Z,{style:{display:"inline"},store:o},t)}})));return(0,F.jsx)(F.Fragment,{children:(0,C().Z)(t,(e=>(0,F.jsx)(O,{index:e})))})}if((0,i().gE)(l)){const e=o[t.property],n=(e&&"date"===e.type?e.date_format:void 0)||v().sF;let r;if("exact"===l.value.type){const e=l.value;if(e.value)if((0,v().J_)(e.value))r=e.value;else if((0,v().gR)(e.value)){const t=(0,v().Gc)(e.value);t&&(r=t.value)}}else if(!(0,i().TQ)(l))return(0,F.jsx)(F.Fragment,{children:(0,R().x)(l.value)});if(r)return(0,F.jsx)(I().Z,{style:{display:"inline"},value:r,dateFormat:n,shortenDateAndRange:!0})}else{if((0,i().Jw)(l)){const e=(0,i().fl)(l).filter((e=>{let{value:t}=e;return Boolean(t)})).map(R().cq);return 0===e.length?null:(0,F.jsx)("span",{children:(0,C().Z)(e,(e=>(0,F.jsx)(O,{index:e})))})}if((0,i().JQ)(l))return null;(0,M().t1)(l)}}return null}function K(e){let{parentStore:t,useFilter:o}=e;const n=(0,a().YB)(),s=(0,i().R8)(o),l=(0,r().VK)((()=>T().oA(s.map(((e,o)=>{if("relative"===e.type)return(0,F.jsx)("span",{children:(0,F.jsx)(a()._H,{defaultMessage:"Me",id:"database.filterValue.personType.firstPersonPropertyValue.title"})},o);if(e.value){const r=e.value;if(r.table===j().KJ){const e=V().t1.createChildStore(t,{table:r.table,id:r.id});return(0,F.jsx)("span",{children:(0,w().Nz)(n,e.getModel())},o)}if(r.table===b().cZ){const e=V().t1.createChildStore(t,{table:r.table,id:r.id});return(0,F.jsx)("span",{children:(0,x().Mh)(e.getModel())},o)}}})))),[s,t,n]);return(0,F.jsx)(F.Fragment,{children:(0,C().Z)(l,(e=>(0,F.jsx)(O,{index:e})))})}function H(e){let{id:t,context:s,collectionContextStore:x,collectionSettingsStore:v,onClick:C}=e;const h=(0,o(219727).O7)(),_=(0,o(846550).Fg)(),{filter:b,isReadOnly:k}=(0,r().VK)((()=>{const e=function(e,t){const o=t.currentPropertyFiltersStore.state;return o.find((t=>t.id===e))}(t,x);return{filter:e,isReadOnly:Boolean(e&&(0,m().mu)(e.id))}}),[x,t]),j=(0,r().VK)((()=>{const e=x.localStateDiffStore.state;return e.filters.updated.includes(t)||e.filters.added.includes(t)}),[x,t]),w=(0,r().VK)((()=>x.collectionViewStore()),[x]),T=(0,r().Kw)(x.normalizedSchemaStore),M=(0,r().VK)((()=>x.permissionScopesStore.state.canConfigureBlock),[x]),B=(0,r().VK)((()=>v.state.open),[v]),I=(0,r().VK)((()=>{var e;return b?null==x||null===(e=x.collectionStore())||void 0===e||null===(e=e.getSchema()[b.filter.property])||void 0===e?void 0:e.type:void 0}),[x,b]),R=(0,r().VK)((()=>b&&b.id===m().OC),[b]),V=(0,n.useCallback)((e=>{e&&(0,o(565276).yT)(e.target)||u().E3({collectionSettingsStore:v})}),[v]),D=(0,n.useCallback)((()=>{var e;C&&C(),b&&(v.state.open?u().E3({collectionSettingsStore:v}):u().wl({collectionSettingsStore:v,item:{type:"filter"}}),l().wd({environment:h,collectionContextStore:x,action:"click_property_filter",original_view_type:void 0,property_type:null==x||null===(e=x.collectionStore())||void 0===e||null===(e=e.getSchema()[b.filter.property])||void 0===e?void 0:e.type}))}),[x,v,h,b,C]),P=(0,n.useCallback)((()=>{u().E3({collectionSettingsStore:v})}),[v]),Z=(0,n.useCallback)((e=>{var t;if(!b)return;const n=null===(t=x.remoteResultStore.state)||void 0===t?void 0:t.sizeHint,r=g().default.DO_NOT_USE_markLegacy("collections.update_filter_lag");g().default.DO_NOT_USE_measureAfterNextFlushLegacy(r,{environment:h,getData:()=>o(861026).Y5({from:"property_filter",property_type:I,collectionContextStore:x,sizeHintAtStart:n})});const i=b.filter,a=x.currentPropertyFiltersStore.state.map((t=>{if(t.id===b.id){return{...b,filter:{...i,filter:e}}}return t}));c().iU({environment:h,collectionContextStore:x,temporaryState:{...x.temporaryStateStore.state,propertyFilters:{value:a}}}),l().wd({environment:h,collectionContextStore:x,action:"update_property_filter",original_view_type:void 0,property_type:I})}),[x,h,b,I]),O=(0,o(629013).y)(Z,250),L=(0,n.useCallback)((()=>{var e;if(!b)return;const t=x.currentPropertyFiltersStore.state.filter((e=>e.id!==b.id));c().iU({environment:h,collectionContextStore:x,temporaryState:{...x.temporaryStateStore.state,propertyFilters:{value:t}}}),l().wd({environment:h,collectionContextStore:x,action:"delete_property_filter",original_view_type:void 0,property_type:null==x||null===(e=x.collectionStore())||void 0===e||null===(e=e.getSchema()[b.filter.property])||void 0===e?void 0:e.type})}),[x,h,b]),K=(0,n.useCallback)((()=>{var e;if(!b)return;const{combinatorFilter:t,propertyFilters:n}=(0,m().Gz)(x,b);c().iU({environment:h,collectionContextStore:x,temporaryState:{...x.temporaryStateStore.state,propertyFilters:{value:n},combinatorFilter:{value:t}}});const r=s===o(259314).Pt.FilterBar?x.filterBarCombinatorFilterSettingsStore:x.filterOptionsCombinatorFilterSettingsStore;u().wl({collectionSettingsStore:r,item:{type:"filter"}}),l().wd({environment:h,collectionContextStore:x,action:"merge_filter_into_combinator",property_type:null==x||null===(e=x.collectionStore())||void 0===e||null===(e=e.getSchema()[b.filter.property])||void 0===e?void 0:e.type})}),[x,s,h,b]),H=(0,n.useCallback)(((e,t)=>{if(!w||!b)return null;const n=b.filter,r=!(0,i().Oo)(n),a=T[n.property];return(0,F.jsx)(o(61738).Z,{icon:a&&(0,F.jsx)(o(766933).ZP,{type:a.type,icon:a.icon,size:h.device.isMobile?18:16,theme:_,style:{fill:void 0,marginRight:6}}),title:r?(0,F.jsx)(A,{propertyFilter:n,schema:T,style:N(),parentStore:w}):(0,F.jsx)("span",{style:N(),children:null==a?void 0:a.name}),on:r,hasDiff:j,disabled:t,hideChevron:t,onClick:e=>((0,S().ZP)({event:e,context:S().Af.CollectionSettingsClick,callback:D}),e.preventDefault(),!1),...e},b.id)}),[w,h,b,D,j,T,_]),U=(0,n.useCallback)((()=>R?(0,F.jsx)(p().Z,{placement:f().Placement.Bottom,render:e=>H(e,!0),renderTooltip:()=>(0,F.jsx)(a()._H,{id:"database.filterBarPropertyFilter.cannotConfigureSubitemDisplayMode",defaultMessage:"To modify this filter, first change the subitem display mode."})}):(0,F.jsx)(p().Z,{placement:f().Placement.Bottom,render:e=>H(e,!0),renderTooltip:()=>(0,F.jsx)(a()._H,{id:"database.filterBarPropertyFilter.cannotConfigure",defaultMessage:"This filter cannot be modified on this view."})})),[H,R]),E=(0,n.useCallback)((()=>{if(!b)return;const e=b.filter;return w?(0,F.jsx)(d().ZP,{collectionViewId:w.id,propertyFilter:e,schema:T,parentStore:w,onChange:Z,onChangeDebounced:O,onClose:P,onDelete:L,onAddToCombinatorFilter:K,context:d().Qv.PropertyFilter,userCanConfigureFilters:M,allowRelativeDateFilter:!0,allowRelativePersonFilter:!0,collectionContextStore:x}):void 0}),[M,x,w,b,K,L,P,O,Z,T]);return k?U():(0,F.jsx)(o(967092).ZP,{popupType:h.device.isMobile?y().k.SlideUp:y().k.Popup,open:B,origin:k?U():H(void 0,!1),onDismiss:V,disableMouseCapture:!0,enableOutsideClickDismiss:!0,originGap:4,render:E})}const U=n.memo(H,o(632314).Z);function N(){return{maxWidth:180,...s().Yu}}},61738:(e,t,o)=>{o.d(t,{Z:()=>l});o(667294);var n=()=>o(219727),r=()=>o(846550),i=()=>o(374289),a=()=>o(154186),s=o(785893);function l(e){const{icon:t,title:o,on:l,disabled:c,hasDiff:u,wrapStyle:d,innerStyle:p,hideChevron:m}=e,S=(0,n().O7)(),g=(0,r().yK)((e=>{const t=S.device.isMobile;return{filterPill:{fontSize:14,display:"inline-flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",borderRadius:32,height:t?28:24,lineHeight:t?"28px":"24px",padding:"0 8px",border:`1px solid ${e.outlineButtonBorder}`,color:e.mediumTextColor,...l&&{color:e.blueColor,border:`1px solid ${e.filterPillBorder}`,background:e.filterPillBackground},...c&&{color:e.text.uiBlueTertiary,border:`1px solid ${e.text.uiBlueTertiary}`,background:e.filterPillBackground},...p},hovered:l?{background:e.outlineBlueButtonHoveredBackground}:{},pressed:l?{background:e.outlineBlueButtonPressedBackground}:{},chevron:{width:10,marginLeft:4,marginTop:1,fill:c?e.text.uiBlueTertiary:l?e.blueColor:e.lightIconColor},diffDot:{position:"absolute",top:-2,right:-2,background:"dark"===e.mode?e.accentColors.orange[500]:e.accentColors.orange[300],border:`1px solid ${e.contentBackground}`,width:9,height:9,borderRadius:9}}}),[c,S.device.isMobile,p,l]);return(0,s.jsxs)("div",{style:{borderRadius:14,marginRight:6,display:"inline-flex",...u&&{position:"relative"},...d},children:[(0,s.jsxs)(a().Z,{disabled:c,style:g.filterPill,hoveredStyle:g.hovered,pressedStyle:g.pressed,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onClick:e.onClick,onDoubleClick:e.onDoubleClick,children:[t,o,!m&&(0,i().i)(g.chevron)]}),u&&(0,s.jsx)("div",{style:g.diffDot})]})}},662753:(e,t,o)=>{o.d(t,{Z:()=>p});o(267602),o(653476);var n=o(667294),r=()=>o(492788),i=()=>o(142735),a=()=>o(336860),s=()=>o(840521),l=()=>o(513670),c=()=>o(543172),u=(o(122556),o(582845),o(250570),o(533019),o(721473),o(788208),o(22624),()=>o(608352));function d(e){const{reducerId:t,instanceId:o,reducer:n,collectionContextStore:r,groupsPointer:i}=e,a=r.reducersStore.state,s=a[t];let c,d;if(i&&i.length>0&&(c=(0,u().KW)(i)),n){if(d={instanceIds:l().jj([...(null==s?void 0:s.instanceIds)||[],o]),reducer:n},c){r.reducerDependencies.has(c)||r.reducerDependencies.set(c,new Set);const e=r.reducerDependencies.get(c);null==e||e.add(t)}}else{if(c){const e=r.reducerDependencies.get(c);e&&(e.delete(t),0===e.size&&r.reducerDependencies.delete(c))}const e=l().zu((null==s?void 0:s.instanceIds)||[],o);d=s&&e.length>0?{instanceIds:e,reducer:s.reducer}:void 0}l().Xy(s,d)||r.reducersStore.setState({...a,[t]:d})}function p(e){const{id:t,reducer:o,collectionContextStore:u,groupsPointer:p,debounceWait:m}=e,S=(0,i().VK)((()=>p),[p],{useDeepEqual:!0}),g=(0,i().VK)((()=>o),[o],{useDeepEqual:!0}),f=(0,i().VK)((()=>u.collectionViewStore()),[u]),y=(0,i().VK)((()=>u.normalizedFormatStore.state.collection_pointer),[u.normalizedFormatStore]),x=(0,i().VK)((()=>{var e;return null==f||null===(e=f.getFormatStore())||void 0===e?void 0:e.getKeyStore("collection_view_source").getValue()}),[f]),v=(0,n.useRef)(!1),C=(0,s().g)(),[h,_]=(0,n.useReducer)(((e,t)=>l().Xy(e,t)?e:t),void 0),b=(0,n.useCallback)((()=>{const e=u.localResultStore.state,o=u.remoteResultStore.state,n=e&&"reducer"===e.type?e.reducerResults[t]:void 0,r=o&&"reducer"===o.type?o.reducerResults[t]:void 0;return function(e){const{reducerId:t,localReducerResult:o,remoteReducerResult:n,collectionContextStore:r,reducer:i}=e,s=r.reducersStore.state,c=r.remoteResultStore.state,u=r.isClientModeEnabledStore.state;if(u)return o;if("aggregation"===i.type||"groups"===i.type){const e=r.isCreatingNewChartCollectionStore.state,n=null==c?void 0:c.reducerResults[t],a=r.wasCreatedThisSessionStore.state;if(e&&a){const e=Boolean(n&&"groups"===n.type&&("v2"===n.version?n.hasMore:0!==n.total)),t=Boolean(n&&"aggregation"===n.type&&"number"===n.aggregationResult.type&&0!==n.aggregationResult.value);return(e||t)&&r.isCreatingNewChartCollectionStore.setState(!1),o}if(n)return n;const u=Boolean(c&&"reducer"===c.type&&l().sE(c.reducerResults,((e,t)=>{const o=s[t];if(!o)return!1;const n="groups"===i.type?void 0:i.filter;return Boolean("results"===o.reducer.type&&!o.reducer.searchQuery&&"results"===e.type&&e.hasMore&&l().Xy(n,o.reducer.filter))})));return u?o:n}if("results"===i.type){var d;const e=r.wasCreatedThisSessionStore.state,i=Boolean(c&&"reducer"===c.type&&c.reducerResults[t]),s=null===(d=r.collectionViewStore())||void 0===d?void 0:d.getCollectionSource(),l=(0,a().WW)(s)||(0,a().v7)(s);if((i||e)&&!l&&o&&"results"===o.type){return{...o,hasMore:n&&"results"===n.type?n.hasMore:o.hasMore}}return n}}({reducerId:t,collectionContextStore:u,reducer:g,localReducerResult:n,remoteReducerResult:r})}),[u,g,t]),k=(0,n.useCallback)((()=>{v.current=!1,C.current||_(b())}),[b,C]),j=(0,n.useCallback)((()=>{v.current||(v.current=!0,r().default.afterNextFlush(k))}),[k]),[w]=(0,n.useState)((()=>(0,c().ZP)()));return(0,n.useEffect)((()=>{const e=m?(0,l().Ds)(j,m,{leading:!0}):j;return u.remoteResultStore.addListener(j),u.localResultStore.addListener(e),()=>{u.remoteResultStore.removeListener(j),u.localResultStore.removeListener(e)}}),[u,j,m]),(0,n.useEffect)((()=>(d({reducerId:t,instanceId:w,reducer:g,collectionContextStore:u,groupsPointer:S}),()=>{d({reducerId:t,instanceId:w,reducer:void 0,collectionContextStore:u,groupsPointer:S})})),[u,f,y,x,S,g,t,w]),(0,n.useEffect)((()=>{j()}),[]),(0,n.useEffect)((()=>(u.timingTracker.mountCollectionReducerRequest(t,g.type),()=>{u.timingTracker.unmountCollectionReducerRequest(t)})),[u,t,g]),h}},178498:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(667294),r=o(785893);function i(e,t){return(0,r.jsx)(o(18748).ZP,{...e,ref:t,style:{background:"none",borderBottom:"none",boxShadow:"",marginTop:2,marginBottom:6,paddingTop:4,paddingBottom:4,minHeight:"none",...e.style}})}const a=(0,n.forwardRef)(i)},840820:(e,t,o)=>{o.d(t,{Z:()=>l});o(667294);var n=()=>o(219727),r=()=>o(104088),i=()=>o(708518),a=()=>o(967092),s=o(785893);function l(e){const{isMobile:t}=(0,n().Fy)();return t?(0,s.jsx)(a().ZP,{ariaLabel:e.ariaLabel,open:e.isOpen,popupType:r().k.SlideUp,origin:e.origin,onDismiss:e.onDismiss,render:e.render,style:e.style}):(0,s.jsx)(i().Z,{ariaLabel:e.ariaLabel,open:e.isOpen,preventHideChildrenWhileOpening:!0,render:e.render,onDismiss:e.onDismiss,style:e.style,innerStyle:e.innerStyle,showCloseIcon:e.showCloseIcon})}},523516:(e,t,o)=>{o.d(t,{X:()=>m,Z:()=>g});var n=o(667294),r=()=>o(219727),i=()=>o(142735),a=()=>o(816512),s=()=>o(788860),l=()=>o(998901),c=()=>o(661641),u=()=>o(981583),d=o(785893);const p=n.forwardRef(((e,t)=>{const{actor:n,userTitle:c,defaultUserTitle:p="name_only",defaultUserCaption:g,useEmailAsTooltip:f,tooltip:y,tooltipPlacement:x,hoveredStyle:v,disabledFeedback:C,customUserTitleStyles:h}=e,_=(0,r().O7)(),b=(0,s().YB)(),k=(0,i().VK)((()=>n.asActor&&n.asActor.getDisplayName(b)),[n,b]),{email:j,showEmail:w}=(0,i().VK)((()=>{const e=n.asActor&&n.isUser()?n.email:void 0;return{email:e,showEmail:k!==e}}),[n,k]),T=f&&j?j:y;let M=20;_.device.isMobile&&(M=24),"email"===g&&(M=32);const B=("name_and_email"===p||"name_and_email_unless_right"===p&&!Boolean(e.right))&&void 0===g?(0,d.jsx)(S,{actor:null==n?void 0:n.asActor,customStyles:h}):(0,d.jsx)(m,{bold:"name_only_semibold"===p,customStyles:h,actor:null==n?void 0:n.asActor}),I=c??B,R="email"===g&&w?j:void 0;let V;return(0,a().YU)(n)?V=(0,d.jsx)(o(634760).Z,{botValue:null==n?void 0:n.asActor,size:M}):(0,a().$S)(n)?V=(0,d.jsx)(u().Z,{userValue:null==n?void 0:n.asActor,size:M}):(0,a().Iq)(n)?V=(0,d.jsx)(u().Z,{userValue:void 0,size:M}):(0,o(696459).t1)(n),(0,d.jsx)(o(654133).Z,{placement:x??l().Placement.Bottom,alignment:l().Alignment.Start,textWrap:!0,render:n=>(0,d.jsx)(o(827973).Z,{...(0,o(164079).Z)(n,e),icon:V,title:I,disabledFeedback:C,className:"notranslate",right:e.right,ref:t,hoveredStyle:v,caption:R}),disableTooltip:!T,renderTooltip:()=>T})}));function m(e){const{actor:t,bold:o,customStyles:n}=e,a=(0,r().O7)(),l=(0,s().YB)(),u=(0,i().VK)((()=>t&&t.id===a.currentUser.id),[a,t]),p=(0,i().VK)((()=>t&&t.getDisplayName(l)),[t,l]),m=o?"UIRegular-14px/Semibold":"UIRegular-14px/Regular";return u?(0,d.jsx)(s()._H,{id:"UserMenuItem.fullName.authorLabel",defaultMessage:"<author>{fullName}</author> <you>(You)</you>",values:{author:e=>(0,d.jsx)(c().q,{as:"span",styleName:m,customStyles:n,children:e}),fullName:p,you:e=>(0,d.jsx)(c().q,{as:"span",colorName:"secondary",styleName:"UIRegular-14px/Regular",customStyles:n,children:e})}}):p?(0,d.jsx)(c().q,{styleName:m,customStyles:n,children:p}):(0,d.jsx)(c().q,{styleName:m,customStyles:n,children:(0,d.jsx)(s()._H,{id:"UserMenuItem.fullName.unknownAuthorLabel",defaultMessage:"Unknown author"})})}function S(e){const{actor:t,customStyles:o}=e,n=(0,s().YB)(),r=(0,i().VK)((()=>t&&t.getDisplayName(n)),[t,n]),{email:a,showEmail:l}=(0,i().VK)((()=>{const e=t&&t.asActor&&t.isUser()?t.email:void 0;return{email:e,showEmail:r!==e}}),[t,r]);return r?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(c().q,{styleName:"UIRegular-14px/Semibold",customStyles:o,children:r}),l&&(0,d.jsx)(c().q,{styleName:"UIRegular-14px/Regular",customStyles:o,children:a})]}):(0,d.jsx)(c().q,{styleName:"UIRegular-14px/Semibold",customStyles:o,children:(0,d.jsx)(s()._H,{id:"UserMenuItem.fullName.unknownAuthorLabel",defaultMessage:"Unknown author"})})}p.displayName="UserMenuItem";const g=p},50272:(e,t,o)=>{o.d(t,{FF:()=>a,Yy:()=>l,bZ:()=>s});o(667294);var n=()=>o(788860),r=()=>o(125302),i=o(785893);function a(e){let{origin:t}=e;return(0,i.jsx)(r().r,{origin:t,placementToOrigin:"bottom",style:{minWidth:240},tutorialId:"sprints-onboarding",tutorialStepId:"current-sprint-view-tooltip",header:(0,i.jsx)(n()._H,{id:"SprintsBoardOnboardingTooltip.SprintBoardView.header",defaultMessage:"Manage the current sprint"}),content:(0,i.jsx)(n()._H,{id:"SprintsBoardOnboardingTooltip.SprintBoardView.content",defaultMessage:"Add tasks and update task status as your team makes progress during the sprint."})})}function s(e){let{origin:t}=e;return(0,i.jsx)(r().r,{origin:t,placementToOrigin:"bottom",tutorialId:"sprints-onboarding",tutorialStepId:"sprint-task-tooltip",header:(0,i.jsx)(n()._H,{id:"SprintsBoardOnboardingTooltip.SprintBoardItem.header",defaultMessage:"Change tasks status"}),content:(0,i.jsx)(n()._H,{id:"SprintsBoardOnboardingTooltip.SprintBoardItem.content",defaultMessage:'Drag this task to "In progress".'})})}function l(e){let{origin:t}=e;return(0,i.jsx)(r().r,{origin:t,placementToOrigin:"bottom",style:{minWidth:240},tutorialId:"sprints-onboarding",tutorialStepId:"complete-sprint-button-tooltip",header:(0,i.jsx)(n()._H,{id:"SprintsBoardOnboardingTooltip.CompleteSprintButton.header",defaultMessage:"Complete this sprint"}),content:(0,i.jsx)(n()._H,{id:"SprintsBoardOnboardingTooltip.CompleteSprintButton.content",defaultMessage:"Click the button when you're done with this sprint."})})}},560287:(e,t,o)=>{o.d(t,{Z:()=>et});var n=o(667294),r=()=>o(142735),i=()=>o(219727),a=()=>o(846550),s=()=>o(788860),l=()=>o(707513),c=()=>o(491927),u=()=>o(315917),d=()=>o(861026),p=()=>o(731322),m=()=>o(876822),S=()=>o(50272),g=(o(267602),o(653476),o(241792),()=>o(198690)),f=()=>o(263184),y=()=>o(506347),x=()=>o(926724),v=()=>o(38883),C=()=>o(803021),h=()=>o(646574),_=()=>o(286977),b=()=>o(374289),k=()=>o(328714),j=()=>o(159732),w=()=>o(229010),T=()=>o(827370),M=()=>o(396136),B=()=>o(126301),I=()=>o(955620),R=()=>o(568017),V=()=>o(513670),F=()=>o(696459),A=()=>o(326966),D=()=>o(47443),P=()=>o(86609),Z=()=>o(285755),O=()=>o(141735),L=()=>o(352230),K=()=>o(549813),H=()=>o(129338),U=()=>o(677559),N=()=>o(738957),E=()=>o(826955),W=()=>o(679791),q=()=>o(356321),z=()=>o(265640),Y=()=>o(827973),G=()=>o(448419),X=()=>o(1910),Q=()=>o(668001),J=()=>o(198829),$=()=>o(255577),ee=()=>o(470386),te=()=>o(906651),oe=()=>o(943620),ne=()=>o(384241),re=()=>o(388284),ie=()=>o(565796),ae=()=>o(840820),se=()=>o(765513),le=()=>o(78014),ce=o(785893);const ue=(0,s().vU)({completedPercentSummary:{id:"completeAutomationSprintModal.sprintSummary.completedPercentSummary",defaultMessage:"{completedTaskCount} / {totalTaskCount} total tasks"},selectNextSprintLabel:{id:"completeAutomationSprintModal.sprintSummary.selectNextSprintLabel",defaultMessage:"Next sprint"},selectDatesForNextSprintLabel:{id:"completeAutomationSprintModal.sprintSummary.selectDatesForNextSprintLabel",defaultMessage:"Start and end dates"},nextSprintDatesLabel:{id:"completeAutomationSprintModal.sprintSummary.nextSprintDatesLabel",defaultMessage:"Next sprint dates"},cancelButton:{id:"completeAutomationSprintModal.sprintSummary.cancel",defaultMessage:"Cancel"},fallbackSprintName:{id:"completeAutomationSprintModal.sprintName.placeholder",defaultMessage:"Sprint"}});function de(e){let{onDismiss:t,...o}=e;const{isOpen:r}=o,a=(0,i().O7)(),s=(0,n.useId)(),l=e=>{t();let n=!1;(0,F().Kn)(e)&&(0,F().$K)(e.clickedCancel)&&(n=!0===e.clickedCancel),c().$X(a,{...(0,d().Pn)(o.taskCollectionContextStore),action:n?"cancel_modal":"dismiss_modal"})};return(0,ce.jsx)(ae().Z,{ariaLabelledBy:s,isOpen:r,onDismiss:()=>l(),render:()=>(0,ce.jsx)(pe,{...o,onDismiss:l,titleAriaId:s})})}function pe(e){var t;const{completeSprintAutomationContext:o,setIsLoading:a,taskCollectionContextStore:l,onDismiss:c,completeSprintAutomationState:u,onAutomationComplete:d,titleAriaId:p}=e,{currentSprintId:S,querySprintsResult:y,currentSprintTaskSummary:x}=u,v=(0,s().YB)(),h=(0,i().O7)(),{isMobile:_}=(0,i().Fy)(),{value:b}=(0,U().XJ)(O().F.formulas),{value:k}=(0,U().XJ)(Z().Sm.automationTypecheck),{value:j}=(0,U().XJ)(Z().Sm.automationActionRegistry),w=(0,r().VK)((()=>m().default.state.currentUserSettingsStore),[]),T=(0,r().VK)((()=>o.sprintCollectionStore),[o]),I=(0,r().VK)((()=>{var e;const t=null===(e=o.automationContext)||void 0===e?void 0:e.automationStore;return null==t?void 0:t.getRecurrence()}),[o]),R=(0,r().VK)((()=>{var e;return(null===(e=o.automationContext)||void 0===e||null===(e=e.automationActionStore.getConfig())||void 0===e?void 0:e.complete_sprint_action)??"complete_sprint_and_move_incomplete_tasks_to_next_sprint"}),[null===(t=o.automationContext)||void 0===t?void 0:t.automationActionStore]),V=(0,r().VK)((()=>T.getSpaceId()),[T]),F=(0,r().VK)((()=>{if(S)return E().G.createChildStore(T,{id:S,table:M().iU,spaceId:T.getSpaceId()})}),[S,T]),D=(0,r().VK)((()=>F?(0,K().vU)({intl:v,environment:h,store:F,untitledFallback:ue.fallbackSprintName}):v.formatMessage(ue.fallbackSprintName)),[F,v,h]),P=(0,r().VK)((()=>xe({sprintBlockStore:F,sprintCollectionStore:T})),[F,T]),L=(0,r().VK)((()=>ve({sprintDateRange:P,intl:v})),[P,v]),[H,N]=n.useState(),W=(0,r().VK)((()=>f().default.createValue(R)),[R]),q=n.useMemo((()=>{if(!I||null==P||!P.end_date)return;const e=(0,B().Su)(I);return e?(0,B().rP)({currentSprintEndDate:P.end_date,sprintSchedule:e}):void 0}),[I,null==P?void 0:P.end_date]),Y=(0,r().VK)((()=>{if("pointer"!==(null==H?void 0:H.type))return;return xe({sprintBlockStore:E().G.createChildStore(T,H.pointer),sprintCollectionStore:T})}),[H,T]),[G,X]=n.useState(void 0),Q=n.useMemo((()=>{if(G&&(0,C().h)(G))return G}),[G]),J=n.useMemo((()=>{if(!y)return;const{nextSprintIds:e,futureSprintIds:t}=y;return e.length>0?e:t}),[y]),$=(0,r().VK)((()=>{if(void 0===J)return;const e=J[0];return e?{type:"pointer",pointer:{id:e,table:M().iU,spaceId:V}}:{type:"actionId"}}),[J,V]),ee=(0,r().VK)((()=>{var e;return!Boolean(null==w||null===(e=w.getSettings())||void 0===e?void 0:e.seen_sprint_settings_engagement_banner)}),[w]);n.useEffect((()=>{$&&N($)}),[$,N]),n.useEffect((()=>{X(Y??q)}),[Y,q,X]);const oe=n.useCallback((async()=>{if(c(),!(b&&k&&j&&H&&Q&&o.automationContext))return;a(!0);const e=0===(null==x?void 0:x.incompleteTaskCount)?"complete_sprint":W.state;if(!o.automationContext)return;const t={type:"recurrence",recurrence:{type:"completeSprint",completeSprintActionType:e,nextSprintDateRange:Q},automationStore:o.automationContext.automationStore,intl:v,parentRecordStore:o.currentCollectionViewBlockStore,formulasModule:b,isLoggedIn:h.currentUser.isLoggedIn(),automationTypecheckModule:k,automationActionRegistryModule:j},n=()=>{d()},{automationExecutionActions:r}=await Z().Sm.automations.load();await r.executeClientAutomation({environment:h,clientContext:t,onUndo:()=>{a(!0),n(),a(!1)}}),n(),a(!1)}),[c,b,H,Q,o.automationContext,o.currentCollectionViewBlockStore,k,j,a,null==x?void 0:x.incompleteTaskCount,W,v,h,d]),ne=ge({isMobile:_}),{status:re}=(0,g().V)({value:u,validateLoaded:e=>!1===e.isLoading,waitTimeInMs:1*A().hM});if("pending"!==re&&u.isLoading)return(0,ce.jsx)(me,{titleAriaId:p,onDismiss:c,sprintCollectionStore:T});if(u.isLoading)return(0,ce.jsx)(Se,{titleAriaId:p,onDismiss:c});const{incompleteTaskCount:ie}=u.currentSprintTaskSummary,ae=Boolean(H)&&Boolean(Q),se=void 0!==J&&J.length>0;return(0,ce.jsxs)("div",{style:ne.modalContainer,children:[(0,ce.jsx)("div",{style:ne.header,id:p,children:(0,ce.jsx)(s()._H,{id:"completeAutomationSprintModal.sprintSummary.title",defaultMessage:"{sprintName} summary",values:{sprintName:D}})}),(0,ce.jsx)(ye,{currentSprintFormattedDateRange:L,currentSprintTaskSummary:x}),ee&&(0,ce.jsx)(fe,{collectionContextStore:l,userSettingsStore:w,onDismissModal:c}),se&&(0,ce.jsxs)("div",{style:ne.flexRow,children:[v.formatMessage(ue.selectNextSprintLabel),(0,ce.jsx)(ke,{nextSprintInput:H,setNextSprintInput:N,completeSprintAutomationContext:o,sprintPageIds:J})]}),(0,ce.jsxs)("div",{style:ne.flexRow,children:[se?v.formatMessage(ue.selectDatesForNextSprintLabel):v.formatMessage(ue.nextSprintDatesLabel),(0,ce.jsx)(we,{sprintDateRange:G,setSprintDateRange:X})]}),ie>0&&(0,ce.jsxs)("div",{style:ne.flexRow,children:[(0,ce.jsx)(s()._H,{id:"completeAutomationSprintModal.sprintSummary.incompleteTasksLabel",defaultMessage:"{incompleteTaskCount, plural, one {{incompleteTaskCount} incomplete task} other {{incompleteTaskCount} incomplete tasks}}",values:{incompleteTaskCount:ie}}),(0,ce.jsx)(he,{actionTypeStore:W})]}),(0,ce.jsx)(te().Z,{disabled:!ae,onClick:()=>{oe()},style:ne.button,children:(0,ce.jsx)(s()._H,{id:"completeAutomationSprintModal.sprintSummary.completeSprintButton",defaultMessage:"Complete {sprintName}",values:{sprintName:D}})}),(0,ce.jsx)(z().D,{onClick:()=>c({clickedCancel:!0}),style:ne.button,children:v.formatMessage(ue.cancelButton)})]})}function me(e){const{onDismiss:t,sprintCollectionStore:o,titleAriaId:n}=e,a=(0,i().O7)(),l=(0,s().YB)(),{isMobile:c}=(0,i().Fy)(),u=(0,r().VK)((()=>o.getParentBlockStore()),[o]),d=ge({isMobile:c});return(0,ce.jsxs)("div",{style:d.modalContainer,children:[(0,ce.jsx)("div",{style:d.header,id:n,children:(0,ce.jsx)(s()._H,{id:"completeAutomationSprintModal.missingCurrentSprint.title",defaultMessage:"No current sprint found"})}),(0,ce.jsx)(te().Z,{onClick:()=>{u&&D()._c({environment:a,store:u,pageVisitSource:y().tY.LinkInPage})},style:{...d.button,marginTop:24},children:(0,ce.jsx)(s()._H,{id:"completeAutomationSprintModal.missingCurrentSprint.navigateToSprintsDatabase",defaultMessage:"Fix in Sprints database"})}),(0,ce.jsx)(z().D,{onClick:t,style:d.button,children:l.formatMessage(ue.cancelButton)})]})}function Se(e){const{onDismiss:t,titleAriaId:o}=e,n=(0,s().YB)(),{isMobile:r}=(0,i().Fy)(),a=ge({isMobile:r});return(0,ce.jsxs)("div",{style:a.modalContainer,children:[(0,ce.jsx)("div",{style:a.header,id:o,children:(0,ce.jsx)(s()._H,{id:"completeAutomationSprintModal.sprintSummary.titlePlaceholder",defaultMessage:"Sprint summary"})}),(0,ce.jsx)("div",{style:a.subheader,children:(0,ce.jsx)(Q().Z,{style:a.subheaderShimmer})}),(0,ce.jsxs)("div",{style:a.flexRow,children:[n.formatMessage(ue.selectNextSprintLabel),(0,ce.jsx)(Q().Z,{style:a.flexRowShimmerBox1})]}),(0,ce.jsxs)("div",{style:a.flexRow,children:[n.formatMessage(ue.selectDatesForNextSprintLabel),(0,ce.jsx)(Q().Z,{style:a.flexRowShimmerBox2})]}),(0,ce.jsxs)("div",{style:a.flexRow,children:[(0,ce.jsx)(s()._H,{id:"completeAutomationSprintModal.sprintSummary.incompleteTasksPlaceholder",defaultMessage:"Incomplete tasks"}),(0,ce.jsx)(Q().Z,{style:a.flexRowShimmerBox3})]}),(0,ce.jsx)(te().Z,{disabled:!0,onClick:V().ZT,style:a.button,children:(0,ce.jsx)(s()._H,{id:"completeAutomationSprintModal.sprintSummary.completeSprintButtonPlaceholder",defaultMessage:"Complete sprint"})}),(0,ce.jsx)(z().D,{onClick:t,style:a.button,children:n.formatMessage(ue.cancelButton)})]})}function ge(e){let{isMobile:t}=e;return(0,a().yK)((e=>{const o={height:44,borderRadius:8,display:"flex",alignItems:"center",width:void 0},n={...o,marginTop:12,marginBottom:18};return{modalContainer:{width:400,display:"flex",fontSize:t?l().JB.UIRegular.mobile:l().JB.UIRegular.desktop,flexDirection:"column",justifyContent:"center",padding:20},header:{display:"flex",alignItems:"center",justifyContent:"center",fontSize:t?18:16,fontWeight:l().Ue.semibold},subheader:{display:"flex",alignItems:"center",justifyContent:"center",color:e.lightTextColor,marginBottom:16,gap:8},separator:{height:2,width:2,borderRadius:2,backgroundColor:e.lightIconColor},flexRow:{display:"flex",...t?{flexDirection:"column",fontSize:14,color:e.mediumTextColor}:{justifyContent:"space-between",alignItems:"center",height:24,marginBottom:16}},completedTaskGroup:{display:"flex",gap:4},button:{display:"flex",alignItems:"center",justifyContent:"center",marginTop:8,...t&&o},subheaderShimmer:{borderRadius:4,marginTop:6,width:200,height:16,...t&&{height:22}},flexRowShimmerBox1:{borderRadius:4,width:60,height:16,...t&&n},flexRowShimmerBox2:{borderRadius:4,width:80,height:16,...t&&n},flexRowShimmerBox3:{borderRadius:4,width:140,height:16,...t&&n},dropdownButton:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:4,...t&&{...n,border:`1px solid ${e.stroke.secondary}`,justifyContent:"space-between"}},dropdownChevronIcon:{color:e.lightIconColor,width:12,height:"auto"}}}),[t])}function fe(e){const{collectionContextStore:t,userSettingsStore:o,onDismissModal:n}=e,r=(0,i().O7)(),c=(0,a().yK)((e=>({banner:{width:"100%",display:"flex",alignItems:"start",backgroundColor:e.accentColors.blue["light"===e.mode?50:300],borderRadius:4,padding:12,marginBottom:12,fontSize:12,lineHeight:1.5,gap:8},bannerContent:{flex:"1 1 auto",color:e.regularTextColor},bannerTitle:{fontWeight:l().Ue.regular},icon:{width:12,color:e.blueColor},repeatIcon:{flex:"0 0 auto",marginBlockStart:3},closeButton:{marginTop:-3,borderRadius:"50%"},link:{color:e.text.uiBluePrimary}})),[]);return(0,ce.jsxs)("div",{style:c.banner,children:[(0,ce.jsx)("div",{style:c.repeatIcon,children:(0,w().N)(c.icon)}),(0,ce.jsx)("div",{style:c.bannerContent,children:(0,ce.jsx)("div",{style:c.bannerTitle,children:(0,ce.jsx)(s()._H,{id:"completeAutomationSprintModal.turnOnAutomaticSprints.banner.title",defaultMessage:"Complete your sprints automatically. Turn on Automated sprints in <linkToSprintSettings>Settings</linkToSprintSettings>.",values:{linkToSprintSettings:function(){for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];return(0,ce.jsx)(se().Z,{onClick:()=>{o&&(n(),P().zX({environment:r,userSettingsStore:o}),P().Rh(t))},disableUnderline:!0,style:c.link,children:i})}}})})}),(0,ce.jsx)(X().Z,{icon:k().U,ariaLabel:"closeButton",style:c.closeButton,onClick:()=>{o&&P().zX({environment:r,userSettingsStore:o})}})]})}function ye(e){const{currentSprintFormattedDateRange:t,currentSprintTaskSummary:o}=e,{isMobile:n}=(0,i().Fy)(),r=(0,s().YB)(),a=ge({isMobile:n}),l=o?r.formatMessage(ue.completedPercentSummary,{completedTaskCount:o.completedTaskCount,totalTaskCount:o.totalTaskCount}):void 0,c=t&&o?(0,ce.jsxs)(ce.Fragment,{children:[t,(0,ce.jsx)("div",{style:a.separator}),l]}):t||l;return void 0===c?null:(0,ce.jsx)("div",{style:a.subheader,children:c})}function xe(e){const{sprintBlockStore:t,sprintCollectionStore:o}=e;if(!t)return;const n=o.getPropertyMapping(),r=null==n?void 0:n[x().b0.Dates];if(!r)return;const i=t.getPropertyValue(r);if(!i)return;const a=(0,I().nai)(i)[0];return a?(0,C().Ls)(a):void 0}function ve(e){const{sprintDateRange:t,intl:o}=e;if(t&&(0,C().h)(t))return(0,h().ZV)({value:t,allowRelativeDates:!1,shortenDateAndRange:!0,displayInUserTimezone:!0,intl:o})}const Ce={complete_sprint_and_move_incomplete_tasks_to_next_sprint:(0,ce.jsx)(s()._H,{id:"completeAutomationSprintModal.sprintSummary.moveToNextSprintOption",defaultMessage:"Move to next sprint"}),complete_sprint_and_move_incomplete_tasks_to_backlog:(0,ce.jsx)(s()._H,{id:"completeAutomationSprintModal.sprintSummary.moveToBacklogOption",defaultMessage:"Move to backlog"}),complete_sprint:(0,ce.jsx)(s()._H,{id:"completeAutomationSprintModal.sprintSummary.keepInThisSprintOption",defaultMessage:"Keep in current sprint"})};function he(e){const{actionTypeStore:t}=e,{isMobile:o}=(0,i().Fy)(),n=(0,r().Kw)(t),a=ge({isMobile:o});return(0,ce.jsx)(G().ZP,{popupType:o?G().Z4.SlideUp:G().Z4.Popup,alignmentToOrigin:G().vR.Start,placementToOrigin:G().pO.Bottom,render:e=>(0,ce.jsx)(be,{actionTypeStore:t,buttonPopupParent:e}),renderOrigin:e=>(0,ce.jsxs)(z().D,{...e,style:a.dropdownButton,children:[Ce[n],(0,b().i)(a.dropdownChevronIcon)]})})}const _e=["complete_sprint_and_move_incomplete_tasks_to_next_sprint","complete_sprint_and_move_incomplete_tasks_to_backlog","complete_sprint"];function be(e){const{actionTypeStore:t,buttonPopupParent:o}=e,{isMobile:n}=(0,i().Fy)(),s=(0,a().yK)((e=>({checkIcon:{color:e.lightIconColor,width:12,height:"auto",marginLeft:4}})),[]),l=(0,r().VK)((()=>_e.map((e=>{const n=e===t.state;return{key:e,action:()=>{t.setState(e),o.close()},render:t=>(0,ce.jsx)(Y().Z,{...t,title:Ce[e],right:n&&(0,_().e)(s.checkIcon)})}}))),[t,s.checkIcon,o]);let c;return c=n?{menuType:L().o.ActionSheet}:{menuType:L().o.Popup,maxHeight:"50vh",minWidth:230},(0,ce.jsx)(J().Z,{...c,children:(0,ce.jsx)($().ZP,{type:$().iW.Vertical,initialFocus:0,sections:[{key:"sprint_automations",items:l,render:e=>(0,ce.jsx)(re().Z,{...e})}]})})}function ke(e){const{nextSprintInput:t,completeSprintAutomationContext:o,setNextSprintInput:n,sprintPageIds:l}=e,{sprintCollectionStore:c}=o,{isMobile:u}=(0,i().Fy)(),d=(0,i().O7)(),p=(0,s().YB)(),m=(0,r().VK)((()=>{if(void 0===t)return(0,ce.jsx)(s()._H,{id:"completeAutomationSprintModal.sprintSelect.empty",defaultMessage:"Select sprint"});if("actionId"===t.type)return(0,ce.jsx)(s()._H,{id:"completeAutomationSprintModal.sprintSelect.newSprint",defaultMessage:"New sprint"});if("pointer"===t.type){const e=E().G.createChildStore(c,t.pointer);return(0,K().vU)({intl:p,environment:d,store:e,untitledFallback:ue.fallbackSprintName})}(0,F().t1)(t)}),[t,p,c,d]),S=ge({isMobile:u}),g=(0,a().yK)((e=>({button:{...void 0===t&&{color:e.lightTextColor}}})),[t]),f={...S.dropdownButton,...g.button};return 0===l.length||1===l.length?(0,ce.jsx)(z().D,{style:f,disabled:!0,children:m}):(0,ce.jsx)(G().ZP,{popupType:u?G().Z4.SlideUp:G().Z4.Popup,alignmentToOrigin:G().vR.Start,placementToOrigin:G().pO.Bottom,render:e=>(0,ce.jsx)(je,{buttonPopupParent:e,completeSprintAutomationContext:o,sprintPageIds:l,nextSprintInput:t,setNextSprintInput:n}),renderOrigin:e=>(0,ce.jsxs)(z().D,{...e,style:f,children:[m,(0,b().i)(S.dropdownChevronIcon)]})})}function je(e){const{sprintPageIds:t,completeSprintAutomationContext:o,buttonPopupParent:l,nextSprintInput:c,setNextSprintInput:u}=e,{sprintCollectionStore:d}=o,{isMobile:p}=(0,i().Fy)(),m=(0,r().VK)((()=>d.getSpaceId()),[d]),S=(0,r().VK)((()=>(0,H().U1)({collectionStore:o.taskCollectionStore,property:x().Es.TaskToSprintRelation}).filter((e=>e.visible&&("title"===e.property||o.sprintCollectionSchema[e.property])))),[o]),g=(0,r().VK)((()=>new(N().Z)),[]),f=(0,a().yK)((e=>({checkIcon:{color:e.lightIconColor,width:12,height:"auto",marginLeft:4},plusIcon:{color:e.lightIconColor,width:12,height:"auto"},createSprintRow:{display:"flex",gap:4},sprintRow:{display:"flex",maxHeight:22,alignItems:"center"},recordTitle:{...p&&{marginRight:12}}})),[p]),y="purple",C=(0,a().Fg)(),h=(0,R().KR)(C,y),b=n.useMemo((()=>{const e="actionId"===(null==c?void 0:c.type);return{key:"new_sprint",action:()=>{u({type:"actionId"}),l.close()},render:t=>(0,ce.jsx)(Y().Z,{...t,icon:(0,j().R)(f.plusIcon),title:(0,ce.jsxs)("div",{style:f.createSprintRow,children:[(0,ce.jsx)(s()._H,{id:"completeAutomationSprintModal.selectSprintDropdown.createNew",defaultMessage:"New sprint"}),(0,ce.jsx)(le().Z,{isRound:!0,showRemoveButton:!1,value:(0,ce.jsx)(s()._H,{id:"completeAutomationSprintModal.selectSprintDropdown.createNewToken",defaultMessage:"Next"}),format:v().lo.Medium,isSingle:!0,color:h.textColor,backgroundColor:h.backgroundColor,showColoredDot:y})]}),right:e&&(0,_().e)(f.checkIcon)})}}),[c,l,u,f,h]),k=(0,r().VK)((()=>t.map((e=>{const t={id:e,table:M().iU,spaceId:m},o=E().G.createChildStore(d,t),n=o.getIcon(),r="pointer"===(null==c?void 0:c.type)&&T().dr.isEqual(c.pointer,t);return{key:e,action:()=>{u({type:"pointer",pointer:t}),l.close()},render:e=>(0,ce.jsx)(Y().Z,{...e,icon:n&&(0,ce.jsx)(oe().Z,{disabled:!0,icon:n,isEmptyPage:!1,size:20}),title:(0,ce.jsx)("div",{style:f.sprintRow,children:S.map((e=>"title"===e.property?(0,ce.jsx)(ne().Z,{store:o,style:f.recordTitle},"title"):(0,ce.jsx)(W().m,{store:o,property:e.property,disabled:!1,locked:!1,format:q().C.Relation,tableWrap:!1,blockPropertyValueOverlayStore:g,collectionStore:d},e.property))).filter(F().$K)}),right:r&&(0,_().e)(f.checkIcon)})}}))),[d,g,l,c,S,m,u,f,t]),w=[{key:"sprints",items:n.useMemo((()=>k.length>0?k:[b]),[k,b]),render:e=>(0,ce.jsx)(re().Z,{...e})}];let B;return B=p?{menuType:L().o.ActionSheet}:{menuType:L().o.Popup,maxHeight:"50vh",minWidth:230},(0,ce.jsx)(J().Z,{...B,children:(0,ce.jsx)($().ZP,{type:$().iW.Vertical,initialFocus:0,sections:w})})}function we(e){const{sprintDateRange:t,setSprintDateRange:o}=e,l=(0,s().YB)(),{isMobile:c}=(0,i().Fy)(),u=n.useMemo((()=>ve({sprintDateRange:t,intl:l})),[t,l]),d=ge({isMobile:c}),p=(0,a().yK)((e=>({button:{...!u&&{color:e.lightTextColor}}})),[u]),m=(0,r().VK)((()=>u||(0,ce.jsx)(s()._H,{id:"completeAutomationSprintModal.sprintSummary.nextSprintDate.placeholder",defaultMessage:"Select dates"})),[u]);return(0,ce.jsx)(G().ZP,{popupType:c?G().Z4.SlideUp:G().Z4.Popup,alignmentToOrigin:G().vR.Start,placementToOrigin:G().pO.Bottom,render:e=>(0,ce.jsx)(Te,{sprintDateRange:t,setSprintDateRange:o,onDismiss:()=>{e.close()}}),renderOrigin:e=>(0,ce.jsxs)(z().D,{...e,style:{...d.dropdownButton,...p.button},children:[m,(0,b().i)(d.dropdownChevronIcon)]})})}function Te(e){const{sprintDateRange:t,setSprintDateRange:o,onDismiss:r}=e,{isMobile:a}=(0,i().Fy)(),l=n.useMemo((()=>({starting:null!=t&&t.start_date?{type:"date",start_date:t.start_date}:void 0,ending:null!=t&&t.end_date?{type:"date",start_date:t.end_date}:void 0})),[t]);let c;return c=a?{menuType:L().o.Modal,right:(0,ce.jsx)(ee().DoneMenuText,{}),onClickRight:r}:{menuType:L().o.Popup,maxHeight:"50vh",paddingTop:6},(0,ce.jsxs)(J().Z,{...c,children:[(0,ce.jsx)(re().Z,{children:(0,ce.jsx)(ie().Z,{title:void 0,disableMenuWrap:!0,allowRelativeRangeFilter:!0,value:l,onUpdate:e=>{var t,n;if(e.error)return;const r={...l,...e.value},i=null===(t=r.starting)||void 0===t?void 0:t.start_date,a=null===(n=r.ending)||void 0===n?void 0:n.start_date;o({type:"daterange",start_date:i,end_date:a})},onDismiss:r})}),(0,ce.jsx)(re().Z,{topBorder:!0,children:(0,ce.jsx)(Y().Z,{focused:!1,onClick:()=>{o(void 0)},title:(0,ce.jsx)(s()._H,{id:"completeAutomationSprintModal.sprintSummary.datePicker.clear",defaultMessage:"Clear"})})})]})}o(470928);var Me=()=>o(998411),Be=()=>o(801812),Ie=()=>o(605974),Re=()=>o(824462),Ve=()=>o(856466),Fe=()=>o(253335);function Ae(e){if(!e)return;if("aggregation"!==e.type)return;if("text"!==e.aggregationResult.type)return;const t=e.aggregationResult.value,o=null==t?void 0:t.split("/");if(!o||2!==o.length)return;const n=Number(o[0]),r=Number(o[1]);return{completedTaskCount:n,incompleteTaskCount:r-n,totalTaskCount:r,completedTaskPercent:0===r?0:n/r}}function De(e){if(!e)return;const t=e.getPropertyMapping(),o=null==t?void 0:t[x().Es.TaskToSprintRelation];if(!o)return;return Fe().Ws.filter.property=o,{...Fe().Ws.filter,property:o}}function Pe(e,t){if(!t)return;const o=t.getPropertyMapping(),n=De(t);if(!n)return;const r=null==o?void 0:o[x().Es.Status];if(!r)return;const i=t.getSchema()[r];if(!i||"status"!==i.type)return;const a=(0,Ve().F_)(e,i);return a?{type:"aggregation",filter:{operator:"and",filters:[n]},aggregation:{aggregator:{operator:"count_per_group",groupName:a},property:r}}:void 0}class Ze extends f().default{getInitialState(){return{isLoading:!0,currentSprintId:void 0,querySprintsResult:void 0,currentSprintTaskSummary:void 0}}updateCurrentSprint(e){const{querySprintsResult:t,currentSprintTaskSummary:o}=this.state;void 0!==e&&void 0!==t&&void 0!==o?this.setState({isLoading:!1,currentSprintId:e,querySprintsResult:t,currentSprintTaskSummary:o}):e?this.setState({...this.state,currentSprintId:e}):this.setState({...this.state,isLoading:!0,currentSprintId:e})}updateNextAndFutureSprints(e){const{currentSprintId:t,currentSprintTaskSummary:o}=this.state;void 0!==t&&void 0!==e&&void 0!==o?this.setState({isLoading:!1,currentSprintId:t,querySprintsResult:e,currentSprintTaskSummary:o}):e?this.setState({...this.state,querySprintsResult:e}):this.setState({...this.state,isLoading:!0,querySprintsResult:e})}updateCurrentSprintTaskSummary(e){const{currentSprintId:t,querySprintsResult:o}=this.state;void 0!==t&&void 0!==o&&void 0!==e?this.setState({isLoading:!1,currentSprintId:t,querySprintsResult:o,currentSprintTaskSummary:e}):e?this.setState({...this.state,currentSprintTaskSummary:e}):this.setState({...this.state,isLoading:!0,currentSprintTaskSummary:e})}}const Oe=Ze;function Le(e){const{taskCollectionContextStore:t,completeSprintAutomationContext:o,children:a,isModalOpen:l}=e,{sprintCollectionStore:c}=o,u=c.id,d=(0,i().O7)(),p=(0,r().VK)((()=>new Oe),[]),m=(0,r().VK)((()=>p.state),[p]),S=(0,r().VK)((()=>{var e;const o=t.relativeVariableStore.state;return null==o||null===(e=o[u])||void 0===e?void 0:e.current}),[u,t]);n.useEffect((()=>{p.updateCurrentSprint(S)}),[S,p]);const[{value:g}]=(0,Be().r5)((async()=>await async function(e){var t;const{environment:o,completeSprintAutomationContext:n}=e,{sprintCollectionStore:r}=n,i=function(e){var t,o;const{sprintCollectionStore:n,sprintCollectionSchema:r}=e,i=n.getPropertyMapping(),a=null==i?void 0:i[x().b0.StatusV2];if(!a)return;const s=r[a];if(!s||"status"!==s.type)return;const l=null===(t=s.options)||void 0===t||null===(t=t.find((e=>e.id===x().YE)))||void 0===t?void 0:t.value,c=null===(o=s.options)||void 0===o||null===(o=o.find((e=>e.id===x().eH)))||void 0===o?void 0:o.value;if(!l||!c)return;const u=Ie().qB[x().p$].next.reducer.getCombinatorFilter(r);if(!u)return;const d={type:"results",filter:u,limit:Ke},p={type:"results",filter:{operator:"and",filters:[{property:a,filter:{operator:"status_is",value:{type:"is_option",value:c}}}]},limit:Ke};return{[x().YE]:d,[x().eH]:p}}(n),a=r.getPropertyMapping(),s=null==a?void 0:a[x().b0.Dates],l=null==a?void 0:a[x().b0.UniqueId];if(!i||!s||!l)return;const c={userId:o.currentUser.id,userTimeZone:(0,Me().r)(),searchQuery:void 0,sort:[{property:s,direction:"ascending"},{property:l,direction:"ascending"}],reducers:i},u=null===(t=r.getParentBlockStore())||void 0===t?void 0:t.getCollectionViewStores()[0],d=r.getSpaceId();if(!u)return;const p=await Re().callApi({eventName:"queryCollection",environment:o,data:{source:{type:"collection",id:r.id,spaceId:d},collectionView:{id:u.id,spaceId:d},loader:c},tracking:{src:"complete_sprint_modal_sprint_picker"}});if("success"!==p.type)return;const m=p.data.result.reducerResults[x().YE],S=p.data.result.reducerResults[x().eH];if("results"!==m.type||"results"!==S.type)return;const g=m.blockIds,f=S.blockIds;return{nextSprintIds:g,futureSprintIds:f}}({environment:d,completeSprintAutomationContext:o})),[S,d,o]);n.useEffect((()=>{p.updateNextAndFutureSprints(g)}),[g,p]);const f=(0,s().YB)(),[{value:y}]=(0,Be().r5)((async()=>await async function(e){var t;const{environment:o,completeSprintAutomationContext:n,intl:r}=e,{taskCollectionStore:i}=n,a=Pe(r,i);if(!a)return;const s=De(i);if(!s)return;const l={filter:{operator:"and",filters:[s]},userId:o.currentUser.id,userTimeZone:(0,Me().r)(),searchQuery:"",sort:[],reducers:{completed_tasks_in_current_sprint:a}},c=null===(t=i.getParentBlockStore())||void 0===t?void 0:t.getCollectionViewStores()[0],u=i.getSpaceId();if(!c)return;const d=await Re().callApi({eventName:"queryCollection",environment:o,data:{source:{type:"collection",id:i.id,spaceId:u},collectionView:{id:c.id,spaceId:u},loader:l},tracking:{src:"complete_sprint_modal_sprint_picker"}});if("success"!==d.type)return;return Ae(d.data.result.reducerResults.completed_tasks_in_current_sprint)}({intl:f,environment:d,completeSprintAutomationContext:o})),[S,d,o,l]);return n.useEffect((()=>{p.updateCurrentSprintTaskSummary(y)}),[y,p]),(0,ce.jsx)(ce.Fragment,{children:a({completeSprintAutomationState:m,onAutomationComplete:()=>{p.reset()}})})}const Ke=5;var He=()=>o(661297),Ue=()=>o(67901),Ne=()=>o(576868),Ee=()=>o(472344);function We(e){const{percentage:t}=e;return(0,ce.jsx)(Ee().b,{numberValue:t,numberFormat:void 0,numberPrecision:void 0,numberShowAs:{type:"ring",maxValue:1,color:"blue",showValue:!1},shouldRenderTooltip:!1,progressSize:15})}const qe=function(e){const{isLoading:t,taskSummary:n,styles:r}=e;return(0,ce.jsx)("div",{style:{width:16,height:"auto",...r},children:t?(0,ce.jsx)(o(312578).Z,{}):(0,ce.jsx)(We,{percentage:(null==n?void 0:n.completedTaskPercent)??0})})};function ze(e){const{taskCollectionContextStore:t,children:o}=e,n=(0,r().VK)((()=>(0,Ne().Nq)(t)),[t]),i=(0,r().VK)((()=>t.collectionStore()),[t]),a=(0,s().YB)(),l=(0,r().VK)((()=>Pe(a,i)),[i,a]);return!l||n?null:(0,ce.jsx)(Ue().Z,{id:"completed_tasks_in_current_sprint_view",collectionContextStore:t,reducer:l,render:e=>{const t=Ae(e.state);return t?(0,ce.jsxs)(ce.Fragment,{children:[(0,ce.jsx)(Ye,{currentSprintTasksInView:t}),o(t)]}):null}})}function Ye(e){const{currentSprintTasksInView:t}=e,o=(0,a().yK)((e=>({summary:{display:"flex",alignItems:"center",justifyContent:"center",columnGap:5,color:e.lightTextColor,fontSize:l().JB.UIRegular.desktop,fontWeight:l().Ue.regular,whiteSpace:"nowrap"}})),[]),{isPhone:n}=(0,i().Fy)();return n?null:(0,ce.jsxs)("div",{style:o.summary,children:[(0,ce.jsx)(qe,{styles:{paddingTop:1},isLoading:!1,taskSummary:t}),(0,ce.jsx)(s()._H,{id:"completeAutomationSprintAutomation.inlineSummary.completedPercentSummary",defaultMessage:"{completedTaskCount} / {totalTaskCount} tasks",values:{completedTaskCount:t.completedTaskCount,totalTaskCount:t.totalTaskCount}})]})}function Ge(e){const{collectionContextStore:t,completeSprintAutomationContext:o}=e,a=(0,i().O7)(),[s,l]=n.useState(!1),[S,g]=n.useState(!1),f=n.useCallback((()=>{g(!1)}),[g]),y=(0,r().VK)((()=>o.permissionsContext.canEdit),[o.permissionsContext.canEdit]),x=(0,r().VK)((()=>m().default.state.currentUserSettingsStore),[]),v=()=>{g(!0);"complete-sprint-button-tooltip"===(0,p().wF)(x,"sprints-onboarding")&&u().tutorialGoToNextStep(a,"sprints-onboarding"),c().$X(a,{...(0,d().Pn)(t),action:"open_modal"})};return y?(0,ce.jsxs)(ce.Fragment,{children:[(0,ce.jsx)(Le,{completeSprintAutomationContext:o,taskCollectionContextStore:t,isModalOpen:S,children:e=>{let{completeSprintAutomationState:n,onAutomationComplete:r}=e;return(0,ce.jsx)(de,{completeSprintAutomationContext:o,isOpen:S,onDismiss:f,setIsLoading:l,taskCollectionContextStore:t,completeSprintAutomationState:n,onAutomationComplete:r})}}),(0,ce.jsx)(ze,{taskCollectionContextStore:t,children:()=>(0,ce.jsx)(Xe,{taskCollectionContextStore:t,onClick:v,isLoading:s})})]}):null}function Xe(e){const{taskCollectionContextStore:t,onClick:o,isLoading:c}=e,{isPhone:u}=(0,i().Fy)(),d=n.useRef(null),p=function(e){const{isPhone:t}=e;return(0,a().yK)((e=>({button:{height:26,marginLeft:8,fontWeight:l().Ue.medium,...t&&{flexGrow:1,borderRadius:8,height:44}}})),[t])}({isPhone:u}),g=(0,r().VK)((()=>t.collectionViewBlockStore()),[t]),f=(0,r().VK)((()=>m().default.state.currentSpaceStore),[]),y=(0,r().VK)((()=>null==g?void 0:g.getSpaceId()),[g]);if(!g)return(0,ce.jsx)(ce.Fragment,{});const x=y===(null==f?void 0:f.id);return(0,ce.jsxs)(ce.Fragment,{children:[(0,ce.jsx)(He().Z,{ref:d,onClick:o,style:p.button,disabled:c,disabledFeedback:c,children:(0,ce.jsx)(s()._H,{defaultMessage:"Complete sprint",id:"completeSprintAutomationButton.label"})}),x&&(0,ce.jsx)(S().Yy,{origin:d})]})}var Qe=()=>o(730120);function Je(e){var t;const{collectionContextStore:o,sprintAutomationContext:n}=e,s=(0,a().yK)((e=>({summary:{display:"flex",alignItems:"center",justifyContent:"center",marginLeft:17,columnGap:5,color:e.lightTextColor,fontSize:l().JB.UIRegular.desktop,fontWeight:l().Ue.regular,whiteSpace:"nowrap"},icon:{width:16,height:"auto",paddingTop:2}})),[]),{isPhone:c}=(0,i().Fy)(),u=(0,r().VK)((()=>{var e;const t=null===(e=n.automationContext)||void 0===e?void 0:e.automationStore.getRunAt();if(!t)return;const o=Qe().ou.fromMillis(t,{zone:"utc"}).toLocal().startOf("day"),r=Qe().ou.now().startOf("day"),i=o.diff(r,"days").days;return i<1?"soon":1===i?"today":2===i?"tomorrow":i-1}),[null===(t=n.automationContext)||void 0===t?void 0:t.automationStore]);return u?(0,ce.jsx)(ze,{taskCollectionContextStore:o,children:()=>c?null:(0,ce.jsxs)("div",{style:s.summary,children:[(0,w().N)(s.icon),(0,ce.jsx)($e,{daysRemaining:u})]})}):null}function $e(e){const{daysRemaining:t}=e;return"soon"===t?(0,ce.jsx)(s()._H,{id:"completeAutomationSprintAutomation.inlineSummary.endingSoon",defaultMessage:"Ending soon"}):"today"===t?(0,ce.jsx)(s()._H,{id:"completeAutomationSprintAutomation.inlineSummary.endsToday",defaultMessage:"Ends today"}):"tomorrow"===t?(0,ce.jsx)(s()._H,{id:"completeAutomationSprintAutomation.inlineSummary.endsTomorrow",defaultMessage:"Ends tomorrow"}):(0,ce.jsx)(s()._H,{id:"completeAutomationSprintAutomation.inlineSummary.daysRemaining",defaultMessage:"Ends in {daysRemaining} days",values:{daysRemaining:t}})}const et=function(e){var t;const{collectionContextStore:o}=e,n=(0,r().VK)((()=>o.completeSprintButtonContextStore.state),[o]),i=(0,r().VK)((()=>{var e;return Boolean(null==n||null===(e=n.automationContext)||void 0===e?void 0:e.automationStore.isActive())}),[null==n||null===(t=n.automationContext)||void 0===t?void 0:t.automationStore]);return n?i?(0,ce.jsx)(Je,{collectionContextStore:o,sprintAutomationContext:n}):(0,ce.jsx)(Ge,{collectionContextStore:o,completeSprintAutomationContext:n}):null}},779013:(e,t,o)=>{o.d(t,{_:()=>i});var n=o(667294);const r=new Map;function i(e){const t=!r.get(e),o=(0,n.useRef)(t);return o.current&&r.set(e,!0),(0,n.useEffect)((()=>()=>{o.current&&r.set(e,!1)}),[e]),o.current}},682890:(e,t,o)=>{o.d(t,{M:()=>r});o(667294);var n=o(785893);const r=(0,o(827282).IU)("arrowDown",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M8 1.57715C7.5625 1.57715 7.25488 1.88477 7.25488 2.33594V10.8262L7.30957 12.3027L5.50488 10.2861L3.95312 8.75488C3.82324 8.625 3.63184 8.53613 3.42676 8.53613C3.0166 8.53613 2.70898 8.85059 2.70898 9.26758C2.70898 9.46582 2.78418 9.64355 2.94141 9.80762L7.44629 14.3193C7.59668 14.4697 7.79492 14.5586 8 14.5586C8.20508 14.5586 8.40332 14.4697 8.55371 14.3193L13.0586 9.80762C13.2158 9.64355 13.291 9.46582 13.291 9.26758C13.291 8.85059 12.9902 8.53613 12.5801 8.53613C12.3682 8.53613 12.1836 8.625 12.0469 8.75488L10.4951 10.2861L8.69043 12.2959L8.74512 10.8262V2.33594C8.74512 1.88477 8.44434 1.57715 8 1.57715Z"})})},703256:(e,t,o)=>{o.d(t,{N:()=>r});o(667294);var n=o(785893);const r=(0,o(827282).IU)("arrowDownThick",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M7.99316 1.52246C7.40527 1.52246 7.00195 1.93262 7.00195 2.54785V10.1357L7.07031 11.6191L5.69629 10.0332L4.1582 8.50195C3.98047 8.31738 3.74805 8.19434 3.44727 8.19434C2.91406 8.19434 2.51074 8.59082 2.51074 9.15137C2.51074 9.41113 2.61328 9.65039 2.81836 9.8623L7.26172 14.3125C7.44629 14.5039 7.72656 14.6133 7.99316 14.6133C8.2666 14.6133 8.54004 14.5039 8.72461 14.3125L13.1748 9.8623C13.3799 9.65039 13.4824 9.41113 13.4824 9.15137C13.4824 8.59082 13.0791 8.19434 12.5459 8.19434C12.252 8.19434 12.0195 8.31738 11.835 8.50195L10.2969 10.0332L8.92285 11.6191L8.98438 10.1357V2.54785C8.98438 1.93262 8.58789 1.52246 7.99316 1.52246Z"})})},889919:(e,t,o)=>{o.d(t,{k:()=>r});o(667294);var n=o(785893);const r=(0,o(827282).IU)("arrowRightSmaller",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M15.383 8.352a.877.877 0 01-.274.64l-5.156 5.14a.864.864 0 01-.617.266.831.831 0 01-.602-.234.795.795 0 01-.234-.586c0-.12.02-.232.063-.336a.912.912 0 01.187-.273l1.75-1.766 2.914-2.656.274.5-2.711.156H1.484c-.26 0-.471-.078-.632-.234a.851.851 0 01-.235-.617c0-.256.078-.461.235-.618a.856.856 0 01.632-.242h9.493l2.71.164-.273.508L10.5 5.5 8.75 3.727a.946.946 0 01-.188-.266.917.917 0 01-.062-.344c0-.234.078-.43.234-.586a.831.831 0 01.602-.234.79.79 0 01.328.07c.104.047.203.117.297.211l5.148 5.133a.877.877 0 01.274.64z"})})},237789:(e,t,o)=>{o.d(t,{T:()=>r});o(667294);var n=o(785893);const r=(0,o(827282).IU)("arrowsUpDown",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M4.11 2.385a.61.61 0 01.48-.211c.191 0 .353.07.486.21L8.03 5.409a.66.66 0 01.2.475c0 .191-.061.347-.182.469a.627.627 0 01-.463.181.59.59 0 01-.451-.187L5.926 5.098l-.72-.844.04 1.219v7.242a.624.624 0 01-.187.469.624.624 0 01-.47.187.636.636 0 01-.468-.187.635.635 0 01-.182-.47V5.474l.041-1.22-.726.845-1.201 1.248a.61.61 0 01-.457.187.627.627 0 01-.463-.181.634.634 0 01-.182-.47.66.66 0 01.2-.474l2.958-3.023zm7.786 10.781a.636.636 0 01-.486.205.665.665 0 01-.486-.205l-2.947-3.035a.64.64 0 01-.206-.475c0-.191.061-.345.182-.463a.634.634 0 01.469-.181c.18 0 .33.06.451.181l1.201 1.248.727.85-.041-1.219V2.824c0-.187.06-.342.181-.463a.636.636 0 01.47-.187.627.627 0 01.65.65v7.248l-.041 1.219.726-.85 1.207-1.248a.6.6 0 01.451-.181c.188 0 .342.06.463.181a.615.615 0 01.182.463.648.648 0 01-.2.475l-2.953 3.035z"})})},570328:(e,t,o)=>{o.d(t,{e:()=>r});o(667294);var n=o(785893);const r=(0,o(827282).IU)("collectionSearch",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M0 6.35938C0 9.86719 2.85156 12.7188 6.35938 12.7188C7.66406 12.7188 8.85938 12.3203 9.85938 11.6406L13.4531 15.2344C13.6719 15.4609 13.9766 15.5625 14.2812 15.5625C14.9453 15.5625 15.4219 15.0625 15.4219 14.4141C15.4219 14.1016 15.3125 13.8125 15.1016 13.5938L11.5312 10.0156C12.2734 8.99219 12.7188 7.72656 12.7188 6.35938C12.7188 2.85156 9.86719 0 6.35938 0C2.85156 0 0 2.85156 0 6.35938ZM1.65625 6.35938C1.65625 3.76562 3.75781 1.65625 6.35938 1.65625C8.95312 1.65625 11.0625 3.76562 11.0625 6.35938C11.0625 8.95312 8.95312 11.0625 6.35938 11.0625C3.75781 11.0625 1.65625 8.95312 1.65625 6.35938Z"})})},259739:(e,t,o)=>{o.d(t,{D:()=>r});o(667294);var n=o(785893);const r=(0,o(827282).IU)("eyeHideInversePadded",{viewBox:"0 0 24 24",svg:(0,n.jsx)("path",{d:"M17.3867 18.1074C17.6055 18.3193 17.9404 18.333 18.1592 18.1074C18.3848 17.875 18.3711 17.5469 18.1592 17.335L6.5791 5.76855C6.37402 5.55664 6.01855 5.5498 5.80664 5.76855C5.60156 5.97363 5.60156 6.3291 5.80664 6.53418L17.3867 18.1074ZM12 6.1582C10.8105 6.1582 9.73047 6.36328 8.72559 6.69141L9.81934 7.78516C10.5098 7.58691 11.2275 7.4707 12 7.4707C16.3682 7.4707 19.8408 11.2715 19.8408 12.0713C19.8408 12.6113 18.7334 14.0059 16.9766 15.1064L17.9883 16.125C20.1348 14.7168 21.3857 12.8779 21.3857 12.0713C21.3857 10.6699 17.6055 6.1582 12 6.1582ZM12 17.9912C13.2646 17.9912 14.4199 17.7725 15.4658 17.4102L14.3789 16.3232C13.6338 16.542 12.8477 16.6787 12 16.6787C7.63184 16.6787 4.15918 13.0283 4.15918 12.0713C4.15918 11.6133 5.32129 10.1299 7.19434 8.98145L6.16211 7.94922C3.92676 9.37109 2.60742 11.251 2.60742 12.0713C2.60742 13.4727 6.46973 17.9912 12 17.9912ZM15.4111 13.3906C15.5889 12.9873 15.6914 12.5361 15.6914 12.0713C15.6914 10.0137 14.0508 8.39355 12 8.39355C11.5283 8.39355 11.084 8.48242 10.6738 8.65332L15.4111 13.3906ZM12 15.7559C12.5332 15.7559 13.0322 15.6328 13.4766 15.4209L8.64355 10.5811C8.4248 11.0322 8.30176 11.5312 8.30176 12.0781C8.30859 14.0811 9.94238 15.7559 12 15.7559Z"})})},490670:(e,t,o)=>{o.d(t,{f:()=>r});o(667294);var n=o(785893);const r=(0,o(827282).IU)("plusThick",{viewBox:"0 0 14 14",svg:(0,n.jsx)("path",{d:"M2 7.16357C2 7.59692 2.36011 7.95093 2.78735 7.95093H6.37622V11.5398C6.37622 11.9731 6.73022 12.3271 7.16357 12.3271C7.59692 12.3271 7.95093 11.9731 7.95093 11.5398V7.95093H11.5398C11.9731 7.95093 12.3271 7.59692 12.3271 7.16357C12.3271 6.73022 11.9731 6.37622 11.5398 6.37622H7.95093V2.78735C7.95093 2.36011 7.59692 2 7.16357 2C6.73022 2 6.37622 2.36011 6.37622 2.78735V6.37622H2.78735C2.36011 6.37622 2 6.73022 2 7.16357Z"})})},928595:(e,t,o)=>{o.d(t,{j:()=>r});o(667294);var n=o(785893);const r=(0,o(827282).IU)("sortPadded",{viewBox:"0 0 24 24",svg:(0,n.jsx)("path",{d:"M7.50879 5.80273L4.06348 9.32324C3.92676 9.4668 3.83789 9.67188 3.83789 9.85645C3.83789 10.2803 4.13184 10.5674 4.54883 10.5674C4.75391 10.5674 4.91797 10.499 5.04785 10.3623L6.46289 8.89941L7.37891 7.83984L7.32422 9.30273V17.8477C7.32422 18.2715 7.625 18.5723 8.04199 18.5723C8.45898 18.5723 8.75977 18.2715 8.75977 17.8477V9.30273L8.70508 7.83984L9.62793 8.89941L11.0361 10.3623C11.166 10.499 11.3369 10.5674 11.5352 10.5674C11.9521 10.5674 12.2461 10.2803 12.2461 9.85645C12.2461 9.67188 12.1641 9.4668 12.0205 9.32324L8.58203 5.80273C8.28125 5.48828 7.80957 5.48145 7.50879 5.80273ZM16.4912 18.3398L19.9365 14.8057C20.0732 14.6689 20.1621 14.4639 20.1621 14.2793C20.1621 13.8555 19.8682 13.5684 19.4512 13.5684C19.2461 13.5684 19.082 13.6367 18.9453 13.7734L17.5371 15.2295L16.6211 16.2959L16.6758 14.833V6.28809C16.6758 5.87109 16.375 5.56348 15.958 5.56348C15.541 5.56348 15.2334 5.87109 15.2334 6.28809V14.833L15.2881 16.2959L14.3721 15.2295L12.9639 13.7734C12.8271 13.6367 12.6631 13.5684 12.4648 13.5684C12.0479 13.5684 11.7539 13.8555 11.7539 14.2793C11.7539 14.4639 11.8359 14.6689 11.9727 14.8057L15.418 18.3398C15.7188 18.6475 16.1904 18.6543 16.4912 18.3398Z"})})},856466:(e,t,o)=>{o.d(t,{$X:()=>a,F_:()=>s,iZ:()=>i});o(267602),o(470928);var n=()=>o(926724),r=()=>o(295617);const i={autoCompleteSprints:!1,actionConfig:{complete_sprint_action:"complete_sprint_and_move_incomplete_tasks_to_next_sprint"},recurrenceConfig:{interval:2,weekdays:["MO"]}};function a(e){const{eventTracker:t,properties:o}=e;t.DO_NOT_USE_commonTrackEvent({eventName:"complete_sprint_action",properties:o})}function s(e,t){var o;return null===(o=t.groups)||void 0===o||null===(o=o.find((t=>t.id===n().nl||(null==t?void 0:t.name)===r().RW||(null==t?void 0:t.name)===e.formatMessage(r().ct.statusGroupNameComplete))))||void 0===o?void 0:o.name}},126301:(e,t,o)=>{o.d(t,{DW:()=>s,IX:()=>a,Su:()=>r,rP:()=>i});var n=()=>o(730120);function r(e){if("week"===e.frequency&&e.weekdays&&1===e.weekdays.length)return{weekday:e.weekdays[0],duration:e.interval}}function i(e){const{currentSprintEndDate:t,sprintSchedule:o}=e;return l({startDate:u({dateToAdjust:n().ou.fromISO(t),weekday:o.weekday,wrapForEqualDays:!0}),duration:o.duration})}function a(e){const{userTimeZone:t,sprintSchedule:o}=e;return l({startDate:n().ou.local({zone:t}),duration:o.duration})}function s(e){const{currentSprintStartDate:t,sprintSchedule:o}=e,r=u({dateToAdjust:n().ou.fromISO(t),weekday:o.weekday,wrapForEqualDays:!1}),{end_date:i}=l({startDate:r,duration:o.duration});let a=n().ou.fromISO(i);const s=n().ou.now().startOf("day");for(;a.diff(s,"days").days<0;)a=a.plus({weeks:1});return{type:"daterange",start_date:a.plus({days:1}).minus({weeks:o.duration}).toISODate(),end_date:a.toISODate()}}function l(e){const{startDate:t,duration:o}=e,n=t.plus({weeks:o}).minus({days:1});return{type:"daterange",start_date:t.toISODate(),end_date:n.toISODate()}}const c={SU:0,MO:1,TU:2,WE:3,TH:4,FR:5,SA:6};function u(e){const{dateToAdjust:t,weekday:o,wrapForEqualDays:n}=e,r=d({currentWeekday:t.weekday%7,nextWeekday:c[o],wrapForEqualDays:n});return t.plus({days:r})}function d(e){const{currentWeekday:t,nextWeekday:o,wrapForEqualDays:n}=e,r="number"==typeof t?t:c[t],i="number"==typeof o?o:c[o];if(r===i)return n?7:0;let a=r,s=0;for(;a!==i;)a===c.SA?a=0:a+=1,s+=1;return s}}}]);