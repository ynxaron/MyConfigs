"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[6215],{509417:(e,t,i)=>{i.d(t,{Vy:()=>_,YN:()=>y,fJ:()=>b,kj:()=>x,mY:()=>S});i(492176),i(7961),i(267602),i(653476),i(241792);var o=()=>i(548347),r=()=>i(255933),n=()=>i(989478),a=()=>i(513670),s=()=>i(930085),d=()=>i(395362),l=()=>i(824462),c=()=>i(784234),u=()=>i(636340),m=()=>i(269299),g=()=>i(572623),p=()=>i(779522),v=()=>i(826955),h=()=>i(219099),f=()=>i(576387);async function y(e){const{environment:t,store:i,status:o,requests:r}=e,s=t.currentUser.id;d().VM(t,{status:o,user_count:r.length,from:e.from,request_type:"member"});const l=await Promise.all(r.map((e=>A(t,{id:e.getForActorId(),table:n().KJ})))).then((e=>(0,a().oA)(e)));if("approved"===o){const e=l.map((e=>({type:"existingUser",value:e.__IM_SORRY__getValue(),spaceRole:"read_and_write"})));if(!(await c().n_({environment:t,store:i,inviteTargets:e,inviteRole:"read_and_write",isOnboarding:!1,invite:{inviteOrigin:"membership_request"}})).success)return{failedUsers:l,resolvedUsers:[]}}return m().createAndCommit({userAction:"accessRequestActions.resolveMembershipRequests",environment:t,canUndo:!0,perform:a=>{r.map((r=>{const l=new(v().oK)(t,r.pointer);u().sW({store:l,transaction:a,data:{granted_time:Date.now(),granted_by_table:n().KJ,granted_by_id:s,resolved_time:Date.now(),resolved_by_table:n().KJ,resolved_by_id:s,status:o}}),d().O8(t,{status:o,request_id:r.id,from:e.from,for_actor_id:r.for_actor_id,space_role:i.getRole()})}))}}),{failedUsers:[],resolvedUsers:l}}async function b(e){const{environment:t,store:i,status:o,requests:r}=e,l=t.currentUser.id;d().VM(t,{status:o,user_count:r.length,from:e.from,request_type:"member"});const g=await Promise.all(r.map((e=>A(t,{id:e.getForActorId(),table:n().KJ})))).then((e=>(0,a().oA)(e)));if("approved"===o){const e=g.map((e=>({type:"existingUser",value:e.__IM_SORRY__getValue(),spaceRole:"read_and_write"})));if(!(await c().n_({environment:t,store:i,inviteTargets:e,inviteRole:"read_and_write",isOnboarding:!1,invite:{inviteOrigin:"membership_request"}})).success)return{failedUsers:g,resolvedUsers:[]};const o=i.id,r=await p().Z.awaitData(t,{spaceId:o}),n=r?r.map((e=>e.domain.url)):[];s().oI(t,{invite_flow_id:void 0,invite_origin:"membership_request",user_ids:g.map((e=>e.id)),internal_domains:n})}return m().createAndCommit({userAction:"accessRequestActions.resolveMembershipRequests",environment:t,canUndo:!0,perform:e=>{r.map((i=>{const r=new(v().oK)(t,i.pointer);u().sW({store:r,transaction:e,data:{granted_time:Date.now(),granted_by_table:n().KJ,granted_by_id:l,resolved_time:Date.now(),resolved_by_table:n().KJ,resolved_by_id:l,status:o,type:"space_membership_request"}})}))}}),{failedUsers:[],resolvedUsers:g}}async function S(e){const{environment:t,status:i,requests:o,from:r}=e;d().VM(t,{status:i,user_count:o.length,from:r,request_type:"guest"});const c=await Promise.all(o.map((async e=>{var o,a,c;const u=await A(t,{id:e.getForActorId(),table:n().KJ});if(!u)return{type:"failed",user:void 0};if(!e.isGuestInviteRequest())return{type:"failed",user:u};const m=await l().callApi({eventName:"resolveAccessRequest",environment:t,data:{accessRequestId:e.id,status:i,spaceId:e.getParentId()}}),p=null===(o=e.getAttributes().permission_records_and_roles.at(0))||void 0===o?void 0:o.role,v=null===(a=e.getAttributes().permission_records_and_roles.at(0))||void 0===a?void 0:a.id,h=(null===(c=e.getAttributes().invite_message)||void 0===c?void 0:c.length)??0;return"success"===m.type&&"approved"===i&&s().jB(t,{role:p,is_space:!1,invite_targets:[{type:"existingUser",value:{id:u.id,version:0,email:u.getEmail()},spaceRole:"none"}],is_onboarding:!1,invite_origin:"guest_invite_request",permission_items:[{type:"user_permission",role:p,user_id:u.id}],invite_message_length:h,domainType:(0,g().JF)()}),"success"===m.type&&d().Cg(t,{status:i,request_id:e.id,for_actor_id:e.getForActorId(),created_by_id:e.getCreatedById(),requested_page_id:v,requested_role:p,from:r}),{type:m.type,user:u}})));await f().bi(t);const u=c.filter((e=>"failed"===e.type)).map((e=>e.user)),m=c.filter((e=>"success"===e.type)).map((e=>e.user));return{failedUsers:(0,a().oA)(u),resolvedUsers:(0,a().oA)(m)}}async function x(e){if(h().Z.reset(),!e.canAdmin)return;const{environment:t,spaceId:i}=e,o=await l().callApi({eventName:"getUnreadAccessRequestCount",environment:t,data:{parentTable:r().bx,parentId:i,size:1}});"success"===o.type&&h().Z.setState({spaceId:i,count:o.data.count})}async function _(e,t,i){const r=function(e){return Object.values((0,a().vM)(e,(e=>function(e){if(e.isGuestInviteRequest()){const t=e.getAttributes().permission_records_and_roles[0];return`guest_invite_${e.getForActorId()}:${null==t?void 0:t.id}:${e.getCreatedById()}`}return e.isSpaceMembershipRequest()?`space_membership_${e.getForActorId()}:${e.getCreatedById()}}`:e.isTeamMembershipRequest()?void 0:void e.isPageAccessRequest()}(e)))).map((e=>{const t=(0,a().MR)(e,(e=>e.getCreatedTime()));return t[t.length-1]}))}(await Promise.all(i.map((async t=>{const i=o().J8,r=new(v().oK)(e,{table:i,id:t});return await r.load(),r.getModel()}))).then((e=>(0,a().oA)(e)))),s=await function(e,t){const i=Object.values((0,a().vM)(t,(e=>function(e){if(e.isGuestInviteRequest()){const t=e.getAttributes().permission_records_and_roles[0];return`guest_invite_${e.getForActorId()}:${null==t?void 0:t.id}:${null==t?void 0:t.role}`}return e.isSpaceMembershipRequest()?`space_membership_${e.getForActorId()}`:e.isTeamMembershipRequest()?void 0:void e.isPageAccessRequest()}(e))));return Promise.all(i.map((async t=>{const i=(0,a().MR)(t,(e=>e.getCreatedTime())),o=i[0];return{createdByActorsWithReason:await Promise.all(i.map((async t=>{const i=await A(e,{id:t.created_by_id,table:n().KJ});if(i)return{actor:i,reason:t.message}}))).then((e=>(0,a().oA)(e))),accessRequest:o}})))}(e,r);return Promise.all(s.map((async t=>{const i=await A(e,{id:t.accessRequest.getForActorId(),table:n().KJ});if(i)return{forActor:i,...t}}))).then((e=>(0,a().oA)(e)))}async function A(e,t){const i=new(v().U6)(e,t);return await i.load(),i.getModel()}},325186:(e,t,i)=>{i.r(t),i.d(t,{ActivityNotification:()=>bo,NotificationTypeToComponent:()=>So});var o=i(667294),r=()=>i(219727),n=()=>i(142735),a=()=>i(59438),s=()=>i(799891),d=()=>i(542973),l=()=>i(712910),c=(i(492176),i(7961),()=>i(846550)),u=()=>i(217388),m=()=>i(506347),g=()=>i(548347),p=()=>i(396136),v=()=>i(255933),h=()=>i(306164),f=()=>i(989478),y=()=>i(788860),b=()=>i(696459),S=()=>i(707513),x=()=>i(509417),_=()=>i(104822),A=()=>i(527278),j=()=>i(613119),C=()=>i(466970),M=()=>i(763589),R=()=>i(826955),K=()=>i(646574),k=()=>i(578292),w=()=>i(135796),V=()=>i(666117),I=()=>i(513670),T=()=>i(603274),B=()=>i(932005),q=()=>i(269299),U=()=>i(247724),P=()=>i(250625),N=()=>i(949842),O=()=>i(164079),H=()=>i(176691),L=()=>i(657174),E=()=>i(156216),F=()=>i(998901),D=()=>i(745740),z=()=>i(448419),Z=()=>i(1910),W=()=>i(943620),G=()=>i(384241),J=()=>i(654133),Y=()=>i(878517),$=()=>i(46335),X=i(785893);const Q=o.createContext((()=>{}));function ee(e){const{disabled:t=!1,children:i}=e,r=(0,o.useContext)(Q),n=(0,o.useCallback)((()=>{t||r(!0)}),[r,t]),a=(0,o.useCallback)((()=>{t||r(!1)}),[r,t]);return(0,X.jsx)("div",{style:{display:"contents"},onMouseEnter:n,onMouseLeave:a,children:i})}Q.displayName="NestedNotificationButtonContext";const te=0,ie=8,oe=24,re=24+oe+ie,ne="150ms ease";function ae(e){const{notification:t,children:a,rootStore:s,icon:d,isPrivate:l,onArchiveClicked:u,onUnarchiveClicked:m,onMarkAsReadClicked:g,onMarkAsUnreadClicked:v,onNotificationBodyClicked:h,navigableBlockId:f,url:y,showSnapshotButton:b,hidePageTitle:S,header:x,isFirst:_,isLast:A}=e,j=(0,r().O7)(),C=(0,r().Fy)(),M=parseInt(t.end_time),K=(0,n().VK)((()=>{const e=t.navigable_block_id;if(e)return R().t1.createChildStore(s,{table:p().iU,id:e,spaceId:s.id})}),[s,t.navigable_block_id]),k=(0,n().VK)((()=>i(105649).default.isPeekDismissableState()),[]),[w,V]=(0,o.useState)(!1),[I,B]=(0,o.useState)(!1),P=(0,o.useRef)(null),O=(0,i(981697).Z)({onLongPress:()=>{var e;return null===(e=P.current)||void 0===e?void 0:e.setOpen(!0)}}),[H,L]=(0,o.useState)(!1),F=w&&!I&&!H,Z=(0,n().VK)((()=>"mentions"===i(781022).default.state.currentTab),[]),W=!t||t.read,G=C.isMobile,J=(0,n().VK)((()=>{const e=j.WindowSizeStore.state;return{left:e.paddingLeftCSS,right:e.paddingRightCSS}}),[j.WindowSizeStore]),Y=(0,c().yK)((e=>({article:{display:"flex",flexDirection:"column"},mainClickTargetButton:{display:"flex",flexDirection:"column",gap:8,paddingTop:14-te,paddingBottom:14-te,paddingLeft:G?J.left:0,paddingRight:G?J.right:0,marginTop:_?0:te,marginBottom:A?0:te,marginLeft:te,marginRight:te,transition:`background ${ne}`},mainClickTargetButtonHovered:{background:e.state.hover},headerAndAvatar:{display:"flex",paddingLeft:8-te,paddingRight:20-te,gap:ie,maxWidth:"100%"},avatarAndStatusDot:{display:"flex",gap:8,alignItems:"center",height:oe},statusDotSpacer:{width:8,flexShrink:0},privatePageBadge:{marginTop:1,marginBottom:4,marginLeft:8},children:{paddingLeft:re-te,paddingRight:20-te},divider:{height:1,backgroundColor:e.stroke.secondary},buttonPressed:{backgroundColor:w&&I?e.buttonBackground:e.state.pressed}})),[G,J.left,J.right,_,A,w,I]),$=(0,o.useCallback)((e=>{t&&(H||(!y&&t.read||h(),(0,N().ZP)({event:e,context:N().Af.NotificationClick,callback:()=>{!k||e.metaKey||e.ctrlKey||i(815532).TN({environment:j}),t.read||q().createAndCommit({userAction:"ActivityNotificationSection.handleMarkAsRead",environment:j,canUndo:!0,perform:e=>{T().$h({notification:t,rootStore:s,transaction:e,read:!0})}})}})))}),[j,H,t,h,k,s,y]),ee=(0,o.useCallback)((e=>{t&&(0,N().ZP)({event:e,context:N().Af.NotificationClick,callback:()=>{t.read?v():g(),q().createAndCommit({userAction:"InboxActionsMenu.toggleNotificationReadStatus",environment:j,canUndo:!0,perform:e=>{T().$h({notification:t,rootStore:s,transaction:e,read:!t.read})}})}})}),[j,t,g,v,s]),ae=(0,o.useCallback)((e=>{t&&(0,N().ZP)({event:e,context:N().Af.NotificationClick,callback:()=>{u(),q().createAndCommit({userAction:"InboxActionsMenu.handleArchive",environment:j,canUndo:!0,perform:e=>{T().aZ({notification:t,rootStore:s,transaction:e})}})}})}),[j,t,u,s]),se=(0,o.useCallback)((e=>{t&&(0,N().ZP)({event:e,context:N().Af.NotificationClick,callback:()=>{m(),q().createAndCommit({userAction:"Activity.handleUnarchive",environment:j,canUndo:!0,perform:e=>{T().E1({notificationId:t.id,visited:!1,rootStore:s,transaction:e})}})}})}),[j,t,m,s]),de=(0,o.useCallback)((()=>V(!0)),[]),le=(0,o.useCallback)((()=>V(!1)),[]),ue=(0,o.useId)(),me=(0,i(76225).aE)();return(0,X.jsx)(z().ZP,{ref:P,disabled:!C.isMobile,style:me.popup,popupType:C.isTablet?z().Z4.Popup:z().Z4.SlideUp,render:e=>(0,X.jsx)(E().PQ,{blockStore:K,notification:t,handlers:{handleUnarchive:se,handleArchive:ae,toggleNotificationReadStatus:ee},closePopup:()=>e.close()}),renderOrigin:()=>(0,X.jsx)("div",{...C.isMobile&&O,children:(0,X.jsx)("article",{style:Y.article,onMouseOver:de,onMouseLeave:le,children:(0,X.jsxs)(Q.Provider,{value:B,children:[(0,X.jsx)(ce,{notification:t,rootStore:s,isMobile:G,isHovered:w,isFirst:_,onMouseEnter:()=>L(!0),onMouseLeave:()=>L(!1),onArchiveClicked:u,onUnarchiveClicked:m,onMarkAsReadClicked:g,onMarkAsUnreadClicked:v}),(0,X.jsxs)(D().Z,{href:y,hovered:F,ignoreLocalHoverState:!0,style:Y.mainClickTargetButton,onClick:$,hoveredStyle:Y.mainClickTargetButtonHovered,disabled:!Boolean(y),pressedStyle:Y.buttonPressed,"aria-labelledby":ue,children:[(0,X.jsxs)("div",{style:Y.headerAndAvatar,children:[(0,X.jsxs)("div",{className:U().FoE,style:Y.avatarAndStatusDot,children:[Z&&!W?(0,X.jsx)(i(819792).z,{size:8}):(0,X.jsx)("div",{style:Y.statusDotSpacer}),d]}),(0,X.jsx)(pe,{blockStore:K,timestamp:M,header:x,hidePageTitle:Boolean(S),hasChildren:Boolean(a),titleAriaId:ue}),b&&f&&(0,X.jsx)(ve,{timestamp:M,navigableBlockId:f,rootStore:s}),l&&!t&&(0,X.jsx)(i(116432).Z,{style:Y.privatePageBadge})]}),a&&(0,X.jsx)("div",{style:Y.children,className:U().nU_,children:a})]}),!A&&(0,X.jsx)("div",{style:Y.divider})]})})})},t.id)}const se=12-te,de=12-te,le="100ms ease-out";function ce(e){const{notification:t,rootStore:i,isMobile:o,isHovered:r,isFirst:n,onArchiveClicked:a,onUnarchiveClicked:s,onMarkAsReadClicked:d,onMarkAsUnreadClicked:l,onMouseEnter:u,onMouseLeave:m}=e,g=(0,c().yK)((()=>({container:{display:"flex",alignItems:"flex-start",position:"relative",zIndex:1},body:{transition:`opacity ${le}`,opacity:o||r?1:0,position:"absolute",right:se,top:de+(o?-3:0)+(n?0:te)}})),[o,r,n]);return t?(0,X.jsx)("div",{style:g.container,onMouseEnter:u,onMouseLeave:m,children:(0,X.jsx)("div",{style:g.body,children:(0,X.jsx)(L().lD,{notification:t,rootStore:i,onArchiveClicked:a,onUnarchiveClicked:s,onMarkAsReadClicked:d,onMarkAsUnreadClicked:l})})}):null}const ue=14,me=12,ge=3;function pe(e){const{blockStore:t,timestamp:i,hidePageTitle:a,header:s,hasChildren:d,titleAriaId:l}=e,u=(0,r().Fy)().isMobile,m=!a,[g,p]=(0,o.useState)(!1),[v,h]=(0,o.useState)(!1),f=(0,H().IS)(i,{useUltraCompactFormat:!0}),y=(0,H().uy)(i),b=(0,n().VK)((()=>{var e;if(t)return null===(e=t.getModel())||void 0===e?void 0:e.getRenderIcon({getRecordModel:t.getRecordModel})}),[t]),x=(0,n().VK)((()=>!!t&&t.isEmptyPage()),[t]),_=(0,n().VK)((()=>null==t?void 0:t.isDefined()),[t]),A=(0,o.useCallback)((()=>{p(!0),h(!1)}),[]),j=I().P2((()=>{h(!0)}),200,{leading:!0}),C=(0,o.useCallback)((()=>{p(!1),h(!1),P().ZV(window,"scroll",j,!0)}),[j]),M=(0,o.useCallback)((e=>(0,X.jsx)(Y().E5,{store:t,events:e})),[t]);(0,o.useEffect)((()=>(P().lj(window,"scroll",j,!0),()=>P().ZV(window,"scroll",j,!0))),[j]);const R=(0,c().yK)((e=>({container:{display:"flex",flexDirection:"row",minWidth:0,width:"100%",marginTop:2},headerMobile:{fontSize:ue,minWidth:0},header:{display:"inline-grid",gridAutoFlow:"column",justifyContent:"space-between",fontSize:ue,minWidth:0},headlineMobile:{paddingTop:2,display:"inline",whiteSpace:"pre-wrap",wordBreak:"break-word"},headline:{flexShrink:2,whiteSpace:"pre-wrap",wordBreak:"break-word"},title:{fontSize:ue,marginTop:4,marginBottom:d?8:4},time:{display:"flex",fontSize:me,color:e.lightTextColor,whiteSpace:"nowrap",...u&&{display:"inline"},paddingLeft:6,marginTop:ue-me},headerAndPageTitle:{display:"flex",flex:1,flexDirection:"column",gap:ge,minWidth:0},pageTitleMockedButton:{maxWidth:"fit-content",display:"flex",alignItems:"center",gap:4,borderRadius:3,paddingTop:2,paddingBottom:2,paddingLeft:3,paddingRight:5,marginTop:-2,marginBottom:-2,marginLeft:-3,marginRight:-5,background:g&&_?e.state.hover:void 0},recordTitle:{fontSize:14,fontWeight:S().Ue.medium},recordPath:{color:e.regularInvertedTextColor}})),[d,u,g,_]),K=!0!==v&&void 0;return(0,X.jsxs)("div",{style:R.container,children:[(0,X.jsxs)("div",{style:R.headerAndPageTitle,children:[(0,X.jsxs)("div",{style:u?R.headerMobile:R.header,children:[(0,X.jsx)("div",{style:u?R.headlineMobile:R.headline,className:U().NFf,id:l,children:s}),(0,X.jsx)("div",{style:R.time,className:U().CZG,children:(0,X.jsx)($().Z,{text:f,tooltipText:y,icon:w().C})})]}),t&&m&&(0,X.jsx)(ee,{disabled:!_,children:(0,X.jsx)(J().Z,{originGap:3,disableTooltip:!_,alignment:F().Alignment.Start,placement:F().Placement.Bottom,renderTooltip:M,closeDelay:0,noStyle:!0,textWrap:!0,forceVisibleState:K,render:e=>(0,X.jsxs)("div",{style:R.pageTitleMockedButton,...(0,O().Z)(e,{onMouseEnter:A,onMouseLeave:C}),children:[(0,X.jsx)(W().Z,{disabled:!0,icon:b,isEmptyPage:x,size:16}),(0,X.jsx)(G().Z,{store:t,style:R.recordTitle,underline:!0})]})})})]}),u&&(0,X.jsx)("div",{style:{width:E().b8-se,flexShrink:0}})]})}function ve(e){const{timestamp:t,navigableBlockId:i,rootStore:o}=e,n=(0,r().O7)();if(t<new Date("2018-10-26").getTime())return null;const a=A().Z.getIntl().formatMessage({defaultMessage:"View version for this update",id:"activitySection.viewVersionForUpdate.tooltip"}),s=()=>{const e=R().G.createChildStore(o,{table:p().iU,id:i});B().jN({environment:n,blockStore:e,openSnapshotNearTimestamp:t.toString(),from:"activity"})};return(0,X.jsx)(J().Z,{renderTooltip:()=>a,render:e=>(0,X.jsx)(Z().Z,{ariaLabel:a,onClick:s,icon:V().J,...e})})}function he(e){const{children:t}=e,i=(0,c().yK)((e=>({container:{borderRadius:"100%",display:"flex",flexShrink:0,justifyContent:"center",alignItems:"center",height:oe,width:oe,backgroundColor:e.surface.elevated,borderWidth:1,borderStyle:"solid",borderColor:e.stroke.secondary},icon:{height:16,width:16,fill:e.icon.secondary}})),[]);return(0,X.jsx)("div",{style:i.container,children:t})}const fe=o.memo(ae);var ye=()=>i(777346);const be=function(e){const{accessRequestStore:t,teamStore:o}=e,a=(0,r().O7)(),s=(0,y().YB)(),{isRequestResolved:d,resolvedStatus:l,resolvedTime:u}=(0,n().VK)((()=>({isRequestResolved:t.isResolvedTeamMembershipRequest(),resolvedStatus:t.getStatus(),resolvedTime:t.getResolvedTime()})),[t]),m=(0,n().VK)((()=>{const e=t.getResolvedById();if(!e)return;const i=R().U6.createChildStore(t,{table:f().KJ,id:e});return i?i.getDisplayName(s):void 0}),[t,s]),g=async e=>{await i(223248).ow({environment:a,teamStore:o,accessRequestStore:t,status:e})},p=(0,c().yK)((e=>({container:{display:"flex",alignItems:"center"},redesignedContainer:{display:"flex",alignItems:"center",fontSize:14,color:e.mediumTextColor},approveButton:{height:26,paddingLeft:8,paddingRight:8,fontSize:12,marginRight:10,fontWeight:500,boxShadow:e.shadow2XS,color:e.regularTextColor},declineButton:{height:26,paddingLeft:8,paddingRight:8,color:e.regularTextColor}})),[]);return(0,X.jsx)("div",{style:p.container,children:d?(0,X.jsx)("div",{style:p.redesignedContainer,children:"approved"===l?(0,X.jsx)(y()._H,{defaultMessage:"Approved by {grantedBy} on {resolvedTime}",id:"approveTeamMembershipActivityButton.requestApprovedWithTime.title",values:{grantedBy:m,resolvedTime:(0,K().Yx)(Math.min(u??0,Date.now()),"medium_with_time",(0,k().E2)(s))}}):(0,X.jsx)(y()._H,{defaultMessage:"Denied by {grantedBy} on {resolvedTime}",id:"approveTeamMembershipActivityButton.requestDeniedWithTime.title",values:{grantedBy:m,resolvedTime:(0,K().Yx)(Math.min(u??0,Date.now()),"medium_with_time",(0,k().E2)(s))}})}):(0,X.jsxs)("div",{children:[(0,X.jsx)(ee,{children:(0,X.jsx)(ye().Z,{style:p.approveButton,onClick:()=>g("approved"),children:(0,X.jsx)(y()._H,{defaultMessage:"Approve",id:"approveTeamMembershipActivityButton.approveButton.label"})})}),(0,X.jsx)(ee,{children:(0,X.jsx)(ye().Z,{style:p.approveButton,onClick:()=>g("rejected"),children:(0,X.jsx)(y()._H,{defaultMessage:"Deny",id:"approveTeamMembershipActivityButton.denyButton.label"})})})]})})};var Se=()=>i(816512),xe=()=>i(696056),_e=()=>i(912732),Ae=()=>i(454393),je=()=>i(72950);const Ce=function(e){const{accessRequestStore:t,effectiveAccessRequestType:i,onApprove:o,onReject:a,spaceStore:s}=e,d=(0,r().O7)(),l=(0,n().VK)((()=>t.isDefined()),[t]),u=(0,n().VK)((()=>t.getModel()),[t]),m=(0,n().VK)((()=>s.canAdmin()),[s]),g=(0,n().VK)((()=>s.canEditMembership()),[s]),p=(0,n().VK)((()=>null==u?void 0:u.isResolved()),[u]),v=(0,n().VK)((()=>null==u?void 0:u.isGuestInviteRequest()),[u]),h=(0,C().E)("workspace_member_access_notif_polish"),f=(0,c().yK)((e=>({viewAllButton:{height:26,paddingLeft:8,paddingRight:8,color:e.regularTextColor,fontSize:14},secondaryButtonForGuestInvites:{height:26,paddingLeft:8,paddingRight:8},actionButton:{height:28,paddingLeft:12,paddingRight:12,boxShadow:e.shadow2XS,fontSize:14,color:e.regularTextColor},notifContainer:{display:"flex",alignItems:"center",gap:v||!h?10:8},guestApproveButton:{height:28,paddingLeft:8,paddingRight:8,boxShadow:e.shadow2XS,fontSize:12,color:e.regularTextColor,fontWeight:500}})),[v,h]),b="space_membership_request"===i;return l?p?(0,X.jsx)(Ke,{accessRequestStore:t,spaceStore:s}):v&&!m||b&&!g?null:(0,X.jsxs)("div",{style:f.notifContainer,children:[(0,X.jsx)(ee,{children:(0,X.jsx)(ye().Z,{onClick:o,style:v||!h?f.guestApproveButton:f.actionButton,children:(0,X.jsx)(y()._H,{defaultMessage:"Approve",id:"approveSpaceMembershipActivityAction.approveButton.label"})})}),(0,X.jsx)(ee,{children:(0,X.jsx)(ye().Z,{onClick:a,style:v||!h?f.secondaryButtonForGuestInvites:f.actionButton,children:(0,X.jsx)(y()._H,{defaultMessage:"Deny",id:"approveSpaceMembershipActivityAction.denyButton.label"})})}),!d.device.isMobile&&(0,X.jsx)(ee,{children:(0,X.jsx)(ye().Z,{onClick:()=>{_e().E5(d,{disable_membership_requests:s.getDisableMembershipRequests()}),Ae().r$({currentTab:"members",subtab:je().Q.Requests})},style:v||!h?f.secondaryButtonForGuestInvites:f.viewAllButton,children:v||!h?(0,X.jsx)(y()._H,{defaultMessage:"View all requests",id:"approveSpaceMembershipActivityAction.viewAllRequests.label"}):(0,X.jsx)(y()._H,{defaultMessage:"View all",id:"approveSpaceMembershipActivityAction.viewAll.label"})})})]}):null};function Me(e,t,i){if(e===f().KJ){const o=i.getRecordValue({table:e,id:t});if(o)return(0,Se().dp)(o)}if(e===xe().cZ){const o=i.getRecordValue({table:e,id:t});if(o)return(0,Se().D$)(o)}}function Re(e){const{pointer:t,accessRequestStore:i}=e,{table:o,id:r}=t,a=(0,n().VK)((()=>I().oA([Me(o,r,i)])),[o,r,i]),s=(0,n().VK)((()=>(0,l().XW)(a,(0,M().h_)())),[a]);return(0,X.jsx)(X.Fragment,{children:s})}function Ke(e){const{accessRequestStore:t,spaceStore:i}=e,o=(0,y().YB)(),r=(0,c().Fg)(),a=(0,n().VK)((()=>t.getModel()),[t]),s=(0,n().VK)((()=>t.getStatus()),[t]),d=(0,n().VK)((()=>t.getResolvedTime()),[t]),{isResolved:l,resolveByPointer:u}=(0,n().VK)((()=>({isResolved:(null==a?void 0:a.isResolved())??!1,resolveByPointer:null==a?void 0:a.getResolvedByPointer(i.id)})),[a,i.id]);if(!a)return null;const m=l&&u&&(0,X.jsx)(Re,{accessRequestStore:t,pointer:u});return(0,X.jsx)("div",{style:{fontSize:14,color:r.mediumTextColor},children:"approved"===s?(0,X.jsx)(y()._H,{defaultMessage:"Approved by {grantedBy} on {resolvedTime}",id:"approveSpaceMembershipActivityAction.requestApprovedWithTime.title",values:{grantedBy:m,resolvedTime:(0,K().Yx)(Math.min(d??1/0,Date.now()),"medium_with_time",(0,k().E2)(o))}}):(0,X.jsx)(y()._H,{defaultMessage:"Denied by {grantedBy} on {resolvedTime}",id:"approveSpaceMembershipActivityAction.requestDenied.title",values:{grantedBy:m,resolvedTime:(0,K().Yx)(Math.min(d??1/0,Date.now()),"medium_with_time",(0,k().E2)(o))}})})}var ke=()=>i(67961),we=()=>i(933868),Ve=()=>i(934158),Ie=()=>i(253502),Te=()=>i(784234),Be=()=>i(636340),qe=()=>i(122479),Ue=()=>i(384510),Pe=()=>i(876822),Ne=()=>i(969243),Oe=()=>i(514380),He=()=>i(370005);const Le=i(263184).default.createClass(void 0,{name:"RoleStore"});const Ee=function(e){const{accessRequestStore:t,targetBlockStore:i,notification:o,initialRole:r,rootStore:a,activity:s,tabArgs:d}=e,l=(0,n().qz)(void 0,Le),c=(0,n().VK)((()=>t.getValue()),[t]),u=(0,n().VK)((()=>i.canAdmin()),[i]);return c?(0,g().Kc)(c)?(0,X.jsx)(et,{accessRequestStore:t,accessRequestValue:c}):u?(0,X.jsx)(Qe,{accessRequestStore:t,notification:o,targetBlockStore:i,initialRole:r,roleStore:l,accessRequestValue:c,rootStore:a,activity:s,tabArgs:d}):null:null};function Fe(){const e=(0,c().yK)((e=>({banner:{borderRadius:Ue().Z.borderRadius,padding:"5px 8px",background:e.accentColors.yellow[50],marginBottom:12,fontSize:S().JB.UISmall.desktop,lineHeight:S().Nv.UISmall.desktop,fontWeight:S().Ue.regular,color:e.accentColors.yellow[500]}})),[]);return(0,X.jsx)("div",{style:e.banner,children:(0,X.jsx)(y()._H,{defaultMessage:"Make sure you trust this external user before sharing any content",id:"grantPageAccessActivityAction.externalWarning"})})}function De(e,t){const i=e.getValue();if(!i)return;const o=t.getPermissionItems();for(const r of o){if(i.for_actor_table===f().KJ&&(0,we().jg)(r)&&r.user_id===i.for_actor_id)return r;if(i.for_actor_table===xe().cZ&&(0,we().FB)(r)&&r.bot_id===i.for_actor_id)return r}}function ze(e){return{tab:Ie().Jn(),activityId:null==e?void 0:e.activity_id,notificationId:null==e?void 0:e.id}}function Ze(e,t){const i={height:26,paddingLeft:8,paddingRight:8,boxShadow:t.shadow2XS,fontSize:12,marginRight:10};return e?i:{...i,color:t.regularTextColor,fontWeight:500}}function We(e){const{notification:t,accessRequestStore:i,activity:o,tabArgs:n}=e,a=(0,r().O7)();return t?t.visited?null:(0,X.jsx)(ee,{children:(0,X.jsx)(ye().Z,{onClick:e=>{(0,Oe().ug)({...n,environment:a,activity:o}),function(e,t,i,o){o&&(0,N().ZP)({event:e,context:N().Af.NotificationClick,callback:()=>{q().createAndCommit({userAction:"GrantPageAccessActivityAction.handleArchive",environment:i,canUndo:!0,perform:e=>{T().aZ({notification:o,rootStore:t,transaction:e})}});const e=t.id,r=ze(o);_e().cO(i,{...r,requestId:e})}})}(e,i,a,t)},style:{height:26,paddingLeft:8,paddingRight:8},children:(0,X.jsx)(y()._H,{defaultMessage:"Deny",id:"grantPageAccessActivityAction.ignoreButton.label.deny"})})}):null}function Ge(e,t,i,o){const r=De(e,t),n=r&&r.role;return o.state||n||i}function Je(e,t,i,o,r){var n;const a=function(e,t,i,o){const r=e.getValue();if(r)return r.for_actor_table===f().KJ?{type:"user_permission",user_id:r.for_actor_id,role:Ge(e,t,i,o)}:r.for_actor_table===xe().cZ?{type:"bot_permission",bot_id:r.for_actor_id,role:Ge(e,t,i,o)}:void(r.for_actor_table!==Ve().y0&&(0,b().t1)(r.for_actor_table))}(t,i,o,r);if(!a)return{};if(De(t,i))return{permissionItem:a};const s=null===(n=Pe().default.getState().currentSpaceStore)||void 0===n?void 0:n.id;if(!s)return{};if("user_permission"===a.type){const i=Ne().r.getData(e,{userId:a.user_id,spaceId:s});if(i&&"none"!==i.membership_type){return{type:"existingUser",value:t.getRecordModel({table:f().KJ,id:a.user_id}),permissionItem:a}}return{permissionItem:a}}if("bot_permission"===a.type){const e=t.getRecordModel({table:xe().cZ,id:a.bot_id}),i=s&&s===(null==e?void 0:e.space_id)&&e.alive;return e&&!i?{type:"bot",value:e,permissionItem:a}:{permissionItem:a}}(0,b().t1)(a)}function Ye(e,t,i){if(e===f().KJ){const o=i.getRecordModel({table:e,id:t});if(o)return(0,Se().dp)(o)}if(e===xe().cZ){const o=i.getRecordModel({table:e,id:t});if(o)return(0,Se().D$)(o)}}async function $e(e,t,i,o,r,n,a,s){if(o.getKeyStore("for_actor_table").getValue()!==f().KJ)return;const d=o.getKeyStore("for_actor_id").getValue(),l=(0,qe().Dt)({userId:d,store:i}).role,c=Je(t,o,i,r,n);if(!("permissionItem"in c))return;s&&(c.permissionItem.role=s);const u=t.currentUser.id;if(u){if("type"in c&&!s){let e;if("existingUser"===c.type){e=(await Te().n_({environment:t,store:i,inviteTargets:[c],inviteRole:c.permissionItem.role,isOnboarding:!1,invite:{inviteOrigin:"page_request_access"}})).success}else if("bot"===c.type){e=(await Te().n_({environment:t,store:i,inviteTargets:[c],inviteRole:void 0,isOnboarding:!1,invite:{inviteOrigin:"page_request_access"}})).success}else(0,b().t1)(c);if(!e)return}(0,N().ZP)({event:e,context:N().Af.NotificationClick,callback:()=>{q().createAndCommit({userAction:"GrantPageAccessActivityAction.handleGrantPageAccess",environment:t,canUndo:!0,perform:e=>{"type"in c||Te().l3({environment:t,transaction:e,store:i,permissionItems:[c.permissionItem]}),a&&T().$h({notification:a,rootStore:i,transaction:e,read:!0}),Be().sW({store:o,transaction:e,data:{granted_time:Date.now(),granted_by_table:f().KJ,granted_by_id:u,resolved_time:Date.now(),resolved_by_table:f().KJ,resolved_by_id:u,status:"approved"}})}});const e=o.isDefined(),r=o.id,n=o.getKeyStore("created_time").getValue(),s=o.getKeyStore("resolved_time").getValue(),d=e&&n&&s?s-n:void 0;_e().nC(t,{requestId:r,timeElapsedSinceRequest:d,newAccessLevel:c.permissionItem.role,prevAccessLevel:l,...ze(a)})}})}}function Xe(e){const{table:t,id:i,accessRequestStore:o}=e,r=(0,n().VK)((()=>{const e=I().oA([Ye(t,i,o)]);return(0,l().XW)(e,{...(0,M().h_)()})}),[t,i,o]);return(0,X.jsx)(X.Fragment,{children:r})}function Qe(e){const{accessRequestValue:t,accessRequestStore:i,notification:a,targetBlockStore:s,initialRole:d,roleStore:l,rootStore:u,activity:m,tabArgs:h}=e,b=(0,c().Fg)(),S=(0,r().O7)(),x=(0,o.useCallback)((e=>function(e,t,i,o,r){const n=i.id,a=o.state;o.setState(e),_e().If(t,{requestId:n,previousAccessLevel:a,newAccessLevel:e,...ze(r)})}(e,S,i,l,a)),[S,i,l,a]),A=t.parent_table===v().bx,j=(0,n().VK)((()=>De(i,s)),[i,s]),C=(0,n().VK)((()=>Ge(i,s,d,l)),[i,s,d,l]),M=(0,g().b5)(t),R=(0,n().VK)((()=>(0,_().B)(t,u)),[t,u]),K=(0,n().VK)((()=>s.getType()),[s]);if(j&&!A){const e=(0,X.jsx)(Xe,{accessRequestStore:i,table:t.for_actor_table,id:t.for_actor_id}),o=j.role===C;if(!M||M&&(0,we().J5)(j.role))return(0,X.jsxs)(X.Fragment,{children:[M?(0,X.jsx)(ke().Z,{isSecondaryColor:!0,isMultiline:!0,style:{marginBottom:6},children:(0,X.jsx)(y()._H,{defaultMessage:"{requestingUser} already has edit access.",id:"grantPageAccessActivityAction.alreadyHasEditAccess.label",values:{requestingUser:e}})}):(0,X.jsx)(ke().Z,{isSecondaryColor:!0,isMultiline:!0,style:{marginBottom:6},children:(0,X.jsx)(y()._H,{defaultMessage:"{requestingUser} already has access.",id:"grantPageAccessActivityAction.alreadyHasAccess.label",values:{requestingUser:e}})}),(0,X.jsx)(ee,{children:(0,X.jsx)(He().ZP,{upgradeButtonName:"user_permission_item",role:C,table:p().iU,blockType:K,type:t.for_actor_table===f().KJ?"user_permission":"bot_permission",onChange:x,isInvite:!0,buttonStyle:Ze(!0,b)})}),(0,X.jsx)(ee,{children:(0,X.jsx)(ye().Z,{onClick:e=>$e(e,S,s,i,d,l,a),style:Ze(o,b),children:(0,X.jsx)(y()._H,{defaultMessage:"Change",id:"grantPageAccessActivityAction.changePermissionButton.label"})})}),(0,X.jsx)(We,{notification:a,accessRequestStore:i,activity:m,tabArgs:h})]})}return(0,X.jsxs)(X.Fragment,{children:[R&&(0,X.jsx)(Fe,{}),(0,X.jsx)(ee,{children:!M&&(0,X.jsx)(He().ZP,{upgradeButtonName:"user_permission_item",role:C,table:p().iU,blockType:K,type:t.for_actor_table===f().KJ?"user_permission":"bot_permission",onChange:x,isInvite:!0,buttonStyle:Ze(!1,b)})}),(0,X.jsx)(ee,{children:M?(0,X.jsx)(ye().Z,{onClick:e=>{a&&(0,Oe().YE)({...h,environment:S,activity:m}),$e(e,S,s,i,d,l,a,"read_and_write")},style:Ze(!1,b),children:(0,X.jsx)(y()._H,{defaultMessage:"Approve",id:"grantPageAccessActivityAction.grantEditAccessButton.label.approve"})}):(0,X.jsx)(ye().Z,{onClick:e=>{a&&(0,Oe().YE)({...h,environment:S,activity:m}),$e(e,S,s,i,d,l,a)},style:Ze(!1,b),children:(0,X.jsx)(y()._H,{defaultMessage:"Approve",id:"grantPageAccessActivityAction.grantAccessButton.label.approve"})})}),(0,X.jsx)(We,{notification:a,accessRequestStore:i,activity:m,tabArgs:h})]})}function et(e){const{accessRequestValue:t,accessRequestStore:i}=e,o=(0,y().YB)(),r=(0,c().Fg)(),n=(0,X.jsx)(Xe,{accessRequestStore:i,table:t.granted_by_table,id:t.granted_by_id}),a=(0,K().Yx)(Math.min(t.granted_time,Date.now()),"medium_with_time",(0,k().E2)(o));return(0,X.jsx)("div",{style:{fontSize:12,color:r.text.secondary},children:(0,X.jsx)(y()._H,{defaultMessage:"Approved by {grantedBy} on {time}",id:"grantPageAccessActivityAction.accessGrantedWithTime.title",values:{grantedBy:n,time:a}})})}var tt=()=>i(126514),it=()=>i(966842),ot=()=>i(541714);function rt(e){var t;const i=(null===(t=e.profileEmail)||void 0===t?void 0:t.charAt(0).toUpperCase())??"?",o=(0,c().yK)((e=>({circleStyle:{width:20,height:20,borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center",borderColor:e.UIUserAvatarIdleOutline,borderWidth:1,borderStyle:"solid",marginRight:6},letterStyle:{color:e.mediumTextColor,fontWeight:S().Ue.medium,fontSize:12}})),[]);return(0,X.jsx)("div",{style:o.circleStyle,children:(0,X.jsx)("span",{style:o.letterStyle,children:i})})}function nt(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:a,isLast:s}=e,{notification:d,tab:u,source:v}=o,h=(0,r().O7)(),f=(0,n().VK)((()=>t.getEdits()),[t]),y=f[0],b=(0,c().yK)((()=>({message:{marginBottom:8},messageLabel:{whiteSpace:"pre-wrap"},titleStyle:{fontSize:14,display:"flex"}})),[]),S=(0,n().VK)((()=>R().oK.createChildStore(i,{table:g().J8,id:t.access_request_id})),[t,i]),x=(0,n().VK)((()=>S.getModel()),[S]),A=(0,n().VK)((()=>Boolean(x&&(0,_().B)(x,i))),[x,i]),M=x&&(0,X.jsx)(st,{activity:t,accessRequest:x,rootStore:i,tabArgs:o}),K=y.message,k=(0,n().VK)((()=>(0,l().P6)({edits:f,rootStore:i})),[f,i]),w=(0,n().VK)((()=>{if(null!=x&&x.isGuestInviteRequest()){const e=x.getAttributes().permission_records_and_roles[0],r=e&&R().G.createChildStore(i,{table:p().iU,id:e.id}),n=e.role;if(r.isDefined())return;return(0,X.jsx)(ot().Z,{titledRecordStore:r,activity:t,tabArgs:o,getRecordModel:i.getRecordModel,permissionRole:n,shouldRenderEmpty:!0})}}),[o,x,t,i]),V=(0,n().VK)((()=>{if(t.navigable_block_id)return R().G.createChildStore(i,{table:p().iU,id:t.navigable_block_id})}),[t,i]),I=(0,n().VK)((()=>{if(!V)return;const e=V.getModel();return e?e.getRenderUrl({getRecordModel:i.getRecordModel,discussionId:t.discussion_id,pageVisitSource:m().tY.Notification}):void 0}),[V,i,t]),T=(0,j().v)({spaceStore:i,request:x}),B=(0,C().E)("workspace_member_access_notif_polish");return M?(0,X.jsxs)(fe,{header:(0,X.jsx)("span",{children:M}),isFirst:a,isLast:s,isPrivate:!1,rootStore:i,notification:d,icon:(0,X.jsx)(tt().BE,{authors:k,size:oe,style:{marginTop:0,marginRight:0},iconStyle:{right:-3},showAvatarShadow:!1,showWarningIcon:A}),showSnapshotButton:!1,url:I,...(0,Oe().JJ)({notification:d,activity:t,environment:h,tab:u}),children:[B&&"space_membership_request"===T&&(0,X.jsx)(at,{rootStore:i,accessRequestModel:x}),K&&(0,X.jsx)("div",{style:b.message,children:(0,X.jsx)(ke().Z,{isMultiline:!0,style:b.messageLabel,children:K})}),w&&(0,X.jsx)("div",{style:b.titleStyle,children:w}),(0,X.jsx)(mt,{activity:t,accessRequestStore:S,rootStore:i,source:v,notification:d,tabArgs:o})]}):null}function at(e){const{rootStore:t,accessRequestModel:i}=e,o=(0,n().VK)((()=>i.getForActorId()===i.getCreatedById()),[i]),r=(0,n().VK)((()=>i.getForActorPointer(t.id)),[i,t.id]),a=r.table===f().KJ?R().U6.createChildStore(t,r):void 0,s=(0,n().VK)((()=>null==a?void 0:a.getModel()),[a]),d=(0,n().VK)((()=>null==s?void 0:s.getEmail()),[s]),l=(0,n().VK)((()=>{if(!o)return d;const e=null==s?void 0:s.getFullName(A().Z.getIntl());return e?`${e} (${d})`:d}),[o,s,d]),u=(0,c().yK)((()=>({inviteeBox:{display:"flex",alignItems:"center",marginBottom:8},inviteePhrase:{fontWeight:S().Ue.medium,fontSize:14}})),[]);return(0,X.jsxs)("div",{style:u.inviteeBox,children:[(0,X.jsx)(rt,{profileEmail:l}),(0,X.jsx)("span",{style:u.inviteePhrase,children:l})]})}function st(e){const{activity:t,accessRequest:i,rootStore:o,tabArgs:r}=e,n=(0,j().v)({spaceStore:o,request:i});if(!n)return null;switch(n){case"guest_invite_request":return(0,X.jsx)(ct,{activity:t,accessRequest:i,rootStore:o});case"space_membership_request":return(0,X.jsx)(lt,{activity:t,accessRequest:i,rootStore:o});case"team_membership_request":return(0,X.jsx)(ut,{activity:t,rootStore:o,tabArgs:r});case"page_access_request":return(0,X.jsx)(dt,{activity:t,tabArgs:r,rootStore:o,accessRequest:i});default:(0,b().t1)(n)}}function dt(e){const{activity:t,rootStore:i,accessRequest:o}=e,r=(0,n().VK)((()=>t.getEdits()),[t]),a=(0,n().VK)((()=>{const e=o.getForActorPointer(i.id),t=e.table===f().KJ?R().U6.createChildStore(i,e):void 0,r=null==t?void 0:t.getModel();return null==r?void 0:r.getEmail()}),[o,i]),s=(0,n().VK)((()=>Boolean(o&&(0,_().B)(o,i))),[o,i]),d=(0,n().VK)((()=>(0,l().P6)({edits:r,rootStore:i})),[r,i]),c=(0,n().VK)((()=>s&&a?(0,l().m4)(a,(0,M().h_)()):(0,l().XW)(d,(0,M().h_)())),[s,a,d]),u=(0,n().VK)((()=>{if(t.navigable_block_id)return R().G.createChildStore(i,{table:p().iU,id:t.navigable_block_id})}),[t,i]),m=(0,n().VK)((()=>o.isEditPageAccessRequest()),[o]);return u?m?(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested edit access to} other {{authorOrAuthors} requested edit access to}}",values:{numberOfAuthors:d.length,authorOrAuthors:c},id:"activity.editAccessRequested.header.short"}):(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested access to} other {{authorOrAuthors} requested access to}}",values:{numberOfAuthors:d.length,authorOrAuthors:c},id:"activity.accessRequested.header.short"}):null}function lt(e){const{activity:t,accessRequest:i,rootStore:o}=e,r=(0,c().yK)((()=>({inviteePhrase:{fontWeight:S().Ue.semibold}})),[]),a=(0,n().VK)((()=>t.getEdits()),[t]),s=(0,n().VK)((()=>i.getForActorPointer(o.id)),[i,o.id]),d=s.table===f().KJ?R().U6.createChildStore(o,s):void 0,u=(0,n().VK)((()=>null==d?void 0:d.getModel()),[d]),m=(0,n().VK)((()=>null==u?void 0:u.getEmail()),[u]),g=(0,n().VK)((()=>i.getForActorId()===i.getCreatedById()),[i]),p=(0,n().VK)((()=>(0,l().P6)({edits:a,rootStore:o})),[a,o]),v=(0,n().VK)((()=>(0,l().XW)(p,(0,M().h_)())),[p]),h=(0,n().VK)((()=>{if(!g)return m;const e=null==u?void 0:u.getFullName(A().Z.getIntl());return e?`${e} (${m})`:m}),[g,u,m]),b=(0,C().E)("workspace_member_access_notif_polish");return u&&s.table===f().KJ?g?(0,X.jsx)(y()._H,{defaultMessage:"{invitee} requested to become a workspace member",values:{invitee:(0,X.jsx)("span",{style:r.inviteePhrase,children:h})},id:"activity.accessRequestedMembershipFromGuest.header"}):b?(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested to add a workspace member} other {{authorOrAuthors} requested to add workspace members}}",values:{numberOfAuthors:p.length,authorOrAuthors:v},id:"activity.accessRequestedMembershipNoInvitee.header.short"}):(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested to add {invitee} as a workspace member} other {{authorOrAuthors} requested to add {invitee} as a workspace member}}",values:{numberOfAuthors:p.length,authorOrAuthors:v,invitee:(0,X.jsx)("span",{style:r.inviteePhrase,children:h})},id:"activity.accessRequestedMembership.header.short"}):null}function ct(e){const{activity:t,accessRequest:i,rootStore:o}=e,r=(0,n().VK)((()=>t.getEdits()),[t]),a=(0,c().yK)((()=>({inviteePhrase:{fontWeight:S().Ue.semibold}})),[]),s=(0,n().VK)((()=>i.getForActorPointer(o.id)),[i,o.id]),d=s.table===f().KJ?R().U6.createChildStore(o,s):void 0,u=(0,n().VK)((()=>null==d?void 0:d.getModel()),[d]),m=(0,n().VK)((()=>null==u?void 0:u.getEmail()),[u]),g=(0,n().VK)((()=>(0,l().P6)({edits:r,rootStore:o})),[r,o]),p=(0,n().VK)((()=>(0,l().XW)(g,{...(0,M().h_)()})),[g]);return(0,n().VK)((()=>i.isGuestInviteRequest()),[i])&&u&&s.table===f().KJ?(0,X.jsx)(y()._H,{defaultMessage:"{requestorsPhrase} requested inviting {guestEmail} as a guest",values:{requestorsPhrase:p,guestEmail:(0,X.jsx)("span",{style:a.inviteePhrase,children:m})},id:"activity.guestInviteRequest.header.short"}):null}function ut(e){const{activity:t,rootStore:i,tabArgs:o}=e,r=(0,n().VK)((()=>t.getEdits()),[t]),a=(0,n().VK)((()=>(0,l().P6)({edits:r,rootStore:i})),[r,i]),s=(0,n().VK)((()=>(0,l().XW)(a,{...(0,M().h_)()})),[a]),d=(0,n().VK)((()=>{if(t.team_id)return R().zX.createChildStore(i,{table:h().e0,id:t.team_id})}),[t,i]);return r&&d?(0,X.jsx)(y()._H,{defaultMessage:"{user} requested to join {teamName}",values:{user:(0,X.jsx)("span",{style:{fontWeight:S().Ue.semibold},children:s}),teamName:(0,X.jsx)(ot().Z,{titledRecordStore:d,getRecordModel:i.getRecordModel,activity:t,tabArgs:o})},id:"activity.teamAccessRequest.header.short"}):null}function mt(e){const{activity:t,accessRequestStore:i,rootStore:a,notification:s,tabArgs:d}=e,l=(0,r().O7)(),m=(0,n().VK)((()=>t.getEdits()),[t])[0],g=(0,n().VK)((()=>i.getParentTable()),[i]),f=(0,n().VK)((()=>i.getParentId()),[i]),y=(0,n().VK)((()=>t.navigable_block_id),[t]),S=(0,n().VK)((()=>i.getModel()),[i]),_=(0,n().VK)((()=>S&&(0,u().Z)(S)),[S]),A=(0,j().v)({spaceStore:a,request:S}),C=(0,n().VK)((()=>{if("page_access_request"===_){var e;const t=null==S||null===(e=S.getAttributes())||void 0===e||null===(e=e.permission_records_and_roles)||void 0===e||null===(e=e.at(0))||void 0===e?void 0:e.role;if(t)return t}return"reader"}),[S,_]),M=(0,o.useCallback)((async()=>{if(_&&A&&S)if("space_membership_request"===A&&"space_membership_request"===_)await x().YN({status:"approved",environment:l,requests:[S],store:a,from:"notification"});else if("space_membership_request"===A&&"guest_invite_request"===_)await x().fJ({status:"approved",environment:l,store:a,requests:[S],from:"notification"});else{if("guest_invite_request"!==_)return;await x().mY({status:"approved",environment:l,requests:[S],from:"notification"})}}),[l,S,a,A,_]),K=(0,o.useCallback)((async()=>{if(_&&S)if("space_membership_request"===_)await x().YN({status:"rejected",environment:l,requests:[S],store:a,from:"notification"});else if("guest_invite_request"===_)await x().mY({status:"rejected",environment:l,requests:[S],from:"notification"});else{if("team_membership_request"===_||"page_access_request"===_)return;(0,b().t1)(_)}}),[l,S,a,_]),k=(0,c().yK)((e=>({actionPrimaryContainer:{paddingTop:4,paddingBottom:0,paddingRight:0},actionButton:(0,it().b9)(e)})),[]),w=y?R().G.createChildStore(a,{table:p().iU,id:y}):void 0,V=(0,n().VK)((()=>g===p().iU&&Boolean(null==w?void 0:w.canAdmin())),[g,w]);if(!(g&&f&&A&&m))return null;if("page_access_request"===A)return V&&w?(0,X.jsx)("div",{style:k.actionPrimaryContainer,children:(0,X.jsx)(Ee,{accessRequestStore:i,targetBlockStore:w,initialRole:C,buttonStyle:k.actionButton,notification:s,rootStore:a,activity:t,tabArgs:d})}):null;if("space_membership_request"===A||"guest_invite_request"===A){const e=R().H2.createChildStore(a,{table:v().bx,id:f});return(0,X.jsx)("div",{style:k.actionPrimaryContainer,children:(0,X.jsx)(Ce,{effectiveAccessRequestType:A,accessRequestStore:i,spaceStore:e,initialRole:"reader",buttonStyle:k.actionButton,notification:s,onApprove:M,onReject:K})})}if("team_membership_request"===A){const e=R().zX.createChildStore(a,{table:h().e0,id:f});return(0,X.jsx)("div",{style:k.actionPrimaryContainer,children:(0,X.jsx)(be,{accessRequestStore:i,teamStore:e})})}(0,b().t1)(A)}const gt=o.memo(nt);function pt(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:a,isLast:s}=e,{notification:d,tab:c}=o,u=(0,r().O7)(),v=(0,n().VK)((()=>t.getEdits()),[t]),h=(0,n().VK)((()=>R().oK.createChildStore(i,{table:g().J8,id:t.access_request_id})),[t,i]),f=(0,n().VK)((()=>{const e=h.getModel();return e&&e.isGuestInviteRequest()&&e.isResolved()||e&&e.isEditPageAccessRequest()&&e.isApproved()?e:void 0}),[h]),y=(0,n().VK)((()=>Boolean(null==f?void 0:f.isEditPageAccessRequest())),[f]),b=(0,n().VK)((()=>(0,l().P6)({edits:v,rootStore:i})),[v,i]),S=(0,n().VK)((()=>{if(t.navigable_block_id)return R().G.createChildStore(i,{table:p().iU,id:t.navigable_block_id})}),[t,i]),x=f&&(0,X.jsx)(vt,{activity:t,accessRequest:f,rootStore:i,isEditAccessRequest:y}),_=(0,n().VK)((()=>{if(!S)return;const e=S.getModel();return e?e.getRenderUrl({getRecordModel:i.getRecordModel,discussionId:t.discussion_id,pageVisitSource:m().tY.Notification}):void 0}),[S,i,t]);return x&&S?(0,X.jsx)(fe,{header:(0,X.jsx)("span",{children:x}),isFirst:a,isLast:s,isPrivate:!1,rootStore:i,notification:d,icon:(0,X.jsx)(tt().BE,{authors:b,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:_,...(0,Oe().JJ)({notification:d,activity:t,environment:u,tab:c})}):null}function vt(e){const{accessRequest:t,rootStore:i,isEditAccessRequest:o}=e,r=(0,c().yK)((()=>({inviteePhrase:{fontWeight:S().Ue.medium}})),[]),a=(0,n().VK)((()=>i.getRecordModel({id:t.getForActorId(),table:t.getForActorTable()})),[t,i]),s=(0,n().VK)((()=>null==a?void 0:a.getEmail()),[a]),d=(0,n().VK)((()=>{const e=(null==a?void 0:a.isUser())&&(null==a?void 0:a.getFullName(A().Z.getIntl()));return e?`${e} (${s})`:s}),[a,s]),u=(0,n().VK)((()=>i.getRecordModel({id:t.getResolvedById(),table:t.getResolvedByTable()})),[t,i]),m=(0,n().VK)((()=>u&&(0,l().XW)([u],{fontWeight:S().Ue.medium})),[u]),g=(0,n().VK)((()=>t.getStatus()),[t]);return m&&d?o?(0,X.jsx)(y()._H,{defaultMessage:"{resolverPhrase} approved your request to edit the page",values:{resolverPhrase:m},id:"activity.EditAccessRequestResolvedMembership.approved.header.short"}):"approved"===g?(0,X.jsx)(y()._H,{defaultMessage:"{resolverPhrase} approved your request to invite {invitee} as a guest",values:{resolverPhrase:m,invitee:(0,X.jsx)("span",{style:r.inviteePhrase,children:d})},id:"activity.AccessRequestResolvedMembership.approved.header.short"}):"rejected"===g?(0,X.jsx)(y()._H,{defaultMessage:"{resolverPhrase} denied your request to invite {invitee} as a guest",values:{resolverPhrase:m,invitee:(0,X.jsx)("span",{style:r.inviteePhrase,children:d})},id:"activity.AccessRequestResolvedMembership.rejected.header.short"}):void(0,b().t1)(g):null}const ht=o.memo(pt);i(122556),i(582845),i(250570),i(533019),i(721473),i(788208),i(22624),i(267602),i(653476),i(241792);var ft=()=>i(731424),yt=()=>i(521913),bt=()=>i(494616),St=()=>i(497065),xt=()=>i(594546),_t=()=>i(429725),At=()=>i(154186);function jt(e){const{automationNames:t,handleAutomationNavigate:i}=e,o=(0,y().YB)(),r=t.at(0),n=t.length,a=n-2,s=o.formatList([...t.slice(0,2),a>0?o.formatMessage({defaultMessage:"{numRemainingAutomations} more",id:"AutomationTypecheckErrorRaisedActivity.wrappedAutomationName.tooltipNumRemainingAutomations"},{numRemainingAutomations:a}):void 0].filter(b().$K),{style:"long",type:"conjunction"}),d={defaultMessage:"{numAutomations, plural, one {{firstAutomationName}} other {{numAutomations} automations}}",values:{firstAutomationName:r,numAutomations:n},id:"AutomationTypecheckErrorRaisedActivity.wrappedAutomationName.automationName",description:"The display name for an automation."},l=e=>(0,X.jsx)(At().Z,{...e,onClick:i,children:(0,X.jsx)(y()._H,{...d})});return 1===n?l():(0,X.jsx)(J().Z,{renderTooltip:e=>(0,X.jsx)("div",{...e,children:s}),render:e=>l(e)})}function Ct(e){let{automationName:t}=e;const i=(0,c().yK)((e=>({icon:{fill:e.icon.uiRedPrimary,height:12,left:9,position:"absolute",top:14,width:12},firstLetter:{textTransform:"uppercase",color:e.text.secondary},wrapper:{position:"relative"}})),[]);return(0,X.jsx)(he,{children:(0,X.jsxs)("div",{style:i.wrapper,children:[(0,X.jsx)("div",{style:i.firstLetter,children:t.charAt(0)}),(0,yt().t)(i.icon)]})})}i(30005);var Mt=()=>i(386617),Rt=()=>i(104014);var Kt=()=>i(532850),kt=()=>i(907171),wt=()=>i(235605),Vt=()=>i(81954),It=()=>i(463212),Tt=()=>i(874018),Bt=()=>i(547592),qt=()=>i(654953),Ut=()=>i(718611),Pt=()=>i(641702),Nt=()=>i(852465),Ot=()=>i(987503),Ht=()=>i(43360),Lt=()=>i(729775),Et=()=>i(634760),Ft=()=>i(981583),Dt=()=>i(765513),zt=()=>i(837416),Zt=()=>i(943707);function Wt(e){const{activity:t,tabArgs:i,rootStore:a,isFirst:c,isLast:u}=e,{source:g,tab:v,notification:h}=i,f=(0,n().VK)((()=>t.getEdits()),[t]);let y=f.filter((e=>{switch(e.type){case"comment-changed":return!1;case"comment-created":case"comment-deleted":case"suggestion-created":return!0;default:(0,b().t1)(e)}}));const x=(0,n().VK)((()=>"suggestion-created"===f[0].type),[f]);0===y.length&&0!==f.length&&(y=f);const _=y.length>0,A=(0,r().O7)(),j=(0,n().VK)((()=>{const e=a.getRecordStore(a,{table:d().qF,id:t.discussion_id,spaceId:t.space_id});if(e.isDefined())return e}),[t,a]),C=(0,n().VK)((()=>j?j.getCommentStores():[]),[j]),M=(0,n().VK)((()=>{const e=null==j?void 0:j.getParentPointer();if(e)return R().G.createChildStore(a,e)}),[j,a]),K=(0,n().VK)((()=>Boolean(M&&M.isDefined())),[M]),k="on"===(0,Ot().a)("inbox_activity_split"),w=(0,n().VK)((()=>{const e=null==M?void 0:M.getNavigableBlockStore();return(null==e?void 0:e.id)||t.navigable_block_id}),[t,M]),V=R().G.createChildStore(a,{table:p().iU,id:w}),T=(0,n().VK)((()=>V.isDefined()),[V]),B=(0,n().VK)((()=>Boolean(!(null!=M&&M.pathIsDead()))),[M]),q=(0,n().VK)((()=>V.canComment()&&B&&!k),[B,V,k]),U=(0,n().VK)((()=>{var e;if(M)return null===(e=M.getModel())||void 0===e?void 0:e.getRenderUrl({getRecordModel:a.getRecordModel,discussionId:t.discussion_id,pageVisitSource:m().tY.Notification})}),[M,a,t]),P=(0,n().VK)((()=>(0,l().P6)({edits:y,rootStore:a})),[y,a]),N=(0,n().VK)((()=>(0,I().mN)(C.map((e=>e.getCreatedByPointer())).filter(b().$K),"id").map((e=>R().t1.createChildStore(a,e)))),[C,a]),O=(0,n().VK)((()=>N.map((e=>e.getModel())).filter(b().$K)),[N]),{backActorStore:H,frontActorStore:L}=(0,n().VK)((()=>{const e=A.currentUser.id;return e?(0,l().V2)({authorStores:N,currentUserId:e}):{backActorStore:void 0,frontActorStore:void 0}}),[A.currentUser.id,N]),E=B,F=(0,o.useCallback)((e=>{if((0,Oe().dG)({...i,environment:A,activity:t,mightCloseTab:E}),!B&&M&&j){var o;const r=e.target;Bt().oK({environment:A,discussionStore:j,rect:r.getBoundingClientRect(),blockStore:M,discussionLocation:ei({forReplyMenu:!0,source:i.source}),activityId:t.id,notificationId:null===(o=i.notification)||void 0===o?void 0:o.id})}}),[t,B,M,j,A,i,E]),D=(0,o.useCallback)((e=>{"Removed"===e?(0,Oe().Tq)({...i,environment:A,activity:t,mightCloseTab:E}):"Added"===e?(0,Oe().Z5)({...i,environment:A,activity:t,mightCloseTab:E}):(0,b().t1)(e)}),[i,A,t,E]),z=(0,n().VK)((()=>(0,l().jC)({recordId:w,recordType:p().iU,tab:v,rootStore:a,environment:A})),[w,v,a,A]),Z=(0,n().VK)((()=>ei({source:g,forReplyMenu:!1})),[g]),W=(0,n().VK)((()=>{const e=null==j?void 0:j.getModel();if(e)return(0,l().Pq)(e)}),[j]);return _&&T&&K&&j?(0,X.jsxs)(fe,{header:(0,X.jsx)(ti,{authorCount:P.length,authorPhrase:(0,X.jsx)(ui,{authorsLength:N.length,frontActorStore:L,backActorStore:H,authorTextStyle:{fontWeight:S().Ue.medium}}),isSuggestionCreatedActivity:x}),isFirst:c,isLast:u,isPrivate:z,rootStore:a,navigableBlockId:w,notification:h,icon:L&&H?(0,X.jsx)(ci,{frontActorStore:L,backActorStore:H}):O.length>0?(0,X.jsx)(tt().BE,{authors:O,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}):(0,X.jsx)(mi,{}),showSnapshotButton:!1,url:U,...(0,Oe().JJ)({notification:h,environment:A,tab:v,activity:t}),children:[j&&W&&(0,X.jsx)(Yt,{discussionStore:j,url:U,onClick:F,rootStore:a,source:g,isSuggestionCreatedActivity:x}),j&&(0,X.jsx)(ni,{discussionStore:j,discussionLocation:Z,onReactionToggle:D}),q&&(0,X.jsx)(Qt,{activity:t,rootStore:a,tabArgs:i,isSuggestionCreatedActivity:x}),j&&(0,X.jsx)(Jt,{discussionStore:j})]}):(s().log({level:"warning",from:"CommentActivityNotification",type:"invalidNotificationData",data:{ids:[(null==h?void 0:h.id)??"unknown"]}}),null)}const Gt=8;function Jt(e){const{discussionStore:t}=e,i=(0,n().VK)((()=>t.getResolved()),[t]),o=(0,c().yK)((e=>({container:{display:"flex",alignItems:"center",gap:4,fontSize:12,color:e.text.secondary,marginTop:Gt},icon:{height:12,width:12}})),[]);return i?(0,X.jsxs)("div",{style:o.container,children:[(0,wt().k)(o.icon),(0,X.jsx)(y()._H,{id:"activity.commentActivity.commentStatusResolved",defaultMessage:"Resolved on the page"})]}):null}function Yt(e){const{url:t,onClick:i,discussionStore:o,rootStore:r,isSuggestionCreatedActivity:a}=e,s=(0,c().yK)((e=>({linkbox:{display:"flex",alignItems:"center",fontSize:13,color:e.mediumTextColor,paddingTop:2,paddingBottom:8,marginBottom:0}})),[,]),d=(0,n().VK)((()=>o.getType()),[o]);return(0,X.jsx)(Lt().Z,{href:t,onClick:i,innerStyle:s.linkbox,disabled:!0,children:"suggestion"===d?!a&&(0,X.jsx)(Tt().s3,{discussionStore:o,collapsed:!1}):(0,X.jsx)($t,{rootStore:r,discussionStore:o})})}function $t(e){const t=(0,r().O7)(),i=(0,c().Fg)(),{rootStore:o,discussionStore:a}=e,s=(0,n().VK)((()=>{const e=a.getModel();if(e)return(0,l().Pq)(e)}),[a]),d=(0,n().VK)((()=>{var e;const t=null==a||null===(e=a.getParentStore())||void 0===e?void 0:e.getParentStore();if(!t||"collection"!==t.table)return;const i=t.getSchema(),o=a.getPropertyId();return void 0!==o?(0,Kt().Qm)({schema:i,property:o}):void 0}),[a]),u=(0,n().VK)((()=>(0,Pt().IY)({environment:t,textValue:s?{value:s,spaceId:o.id}:void 0,parentStore:o,disableHover:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!0,disabled:!0,highlightDiscussionId:a.id,theme:i,emojiType:(0,Ut().e_)(t),katex:t.KatexStore.getKatex(),formulaValueTypes:[]})),[t,s,o,a.id,i]);return s?(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(Zt().Z,{}),d&&(0,X.jsx)(qt().Z,{propertySchema:d}),(0,X.jsx)("div",{style:S().Yu,children:u})]}):null}const Xt=8;function Qt(e){const{activity:t,rootStore:i,tabArgs:a,isSuggestionCreatedActivity:s}=e,{source:l,notification:u,tab:m}=a,g=(0,n().VK)((()=>{const e=i.getRecordStore(i,{table:d().qF,id:t.discussion_id,spaceId:t.space_id});if(e.isDefined())return e}),[t,i]),v=(0,r().O7)(),h=(0,n().VK)((()=>R().t1.createChildStore(i,{table:d().qF,id:t.discussion_id,spaceId:(0,Vt().J)(i.pointer.spaceId)})),[t,i]),f=(0,n().VK)((()=>null==g?void 0:g.getParentId()),[g]),b=(0,o.useCallback)((e=>{(0,N().ZP)({event:e,context:N().Af.NotificationClick,callback:()=>{if(!f)return;const o=R().G.createChildStore(i,{table:p().iU,id:f}),r=e.target,n=null==u?void 0:u.id;Bt().oK({environment:v,discussionStore:h,rect:r.getBoundingClientRect(),blockStore:o,discussionLocation:ei({forReplyMenu:!0,source:l}),activityId:t.id,notificationId:n}),"notifications_tab"===l&&Ie().gY({environment:v,notificationId:n,alreadyRead:Boolean(null==u?void 0:u.read),activity:t,tab:m})}})}),[t,h,v,u,f,i,l,m]),S=(0,c().yK)((e=>({container:{paddingTop:Xt},actionButton:(0,it().b9)(e)})),[]);return!g||s?null:(0,X.jsx)("div",{style:S.container,children:(0,X.jsx)(ee,{children:(0,X.jsx)(ye().Z,{onClick:b,style:S.actionButton,children:(0,X.jsx)(y()._H,{defaultMessage:"Reply",id:"activityNotification.replyButton.label"})})})})}function ei(e){const{forReplyMenu:t,source:i}=e;if("updates_sidebar"===i)return t?"reply_menu_updates_sidebar":"updates_sidebar";return`${t?"reply_menu_":"updates_menu_"}${Ie().Jn()}`}function ti(e){const{authorCount:t,authorPhrase:i,isSuggestionCreatedActivity:o}=e;return o?(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} suggested in} other {{authorOrAuthors} suggested in}}",values:{numberOfAuthors:t,authorOrAuthors:i},id:"activity.commentActivity.standardizedHeader.suggestion"}):(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented in} other {{authorOrAuthors} commented in}}",values:{numberOfAuthors:t,authorOrAuthors:i},id:"activity.commentActivity.standardizedHeader"})}const ii=2,oi=10,ri=4;function ni(e){const{discussionStore:t,discussionLocation:i,onReactionToggle:a}=e,s=(0,r().O7)(),[d,l]=(0,o.useState)(!1),u=(0,n().VK)((()=>{if(!t)return[];const e=t.getCommentStores();return"suggestion"===t.getType()?e.slice(1):e}),[t]),m=u.length-ii,g=m>0,p="on"===(0,Ot().a)("inbox_activity_split"),v=1===u.length,h=(0,o.useCallback)((e=>{(0,N().ZP)({event:e,context:N().Af.NotificationClick,callback:()=>{l(!d),Ie().EH(s,{expand:!d,comments_count:u.length,discussion_id:t.id})}})}),[s,d,u.length,t.id]),f=(0,c().yK)((e=>({discussion:{display:"flex",flexDirection:"column",gap:oi},truncateRepliesButton:{display:"flex",gap:8,padding:4,marginLeft:-4,borderRadius:4},avatars:{display:"flex"},truncationText:{display:"flex",alignItems:"center",color:e.lightTextColor,fontSize:12},expandButton:{display:"flex",justifyContent:"start",alignItems:"center",gap:14,borderRadius:6,fontSize:12,padding:6,marginLeft:-6,marginTop:ri-oi,marginBottom:ri-oi,color:e.mediumTextColor,maxWidth:"fit-content",maxHeight:26},divider:{width:20,flexGrow:2,color:e.stroke.secondary}})),[]),b=d?void 0:v?4:3;if(v){const e=u[0];return(0,X.jsx)("div",{style:f.discussion,children:(0,X.jsx)(ai,{commentStore:e,discussionStore:t,discussionLocation:i,onReactionToggle:a,maxLines:b,showAuthor:!1,onMore:h},e.id)})}if(p&&u.length>0){const e=u[u.length-1];return(0,X.jsx)("div",{style:f.discussion,children:(0,X.jsx)(ai,{commentStore:e,discussionStore:t,discussionLocation:i,onReactionToggle:a,maxLines:b,showAuthor:!1,onMore:h},e.id)})}return(0,X.jsxs)("div",{style:f.discussion,children:[u.slice(0,1).map((e=>(0,X.jsx)(ai,{commentStore:e,discussionStore:t,discussionLocation:i,onReactionToggle:a,maxLines:b,onMore:h},e.id))),g&&(0,X.jsx)(ee,{children:(0,X.jsx)(D().Z,{style:f.expandButton,onClick:h,children:d?(0,X.jsx)(y()._H,{id:"CommentGroupingActivity.discussionThread.hidePreviousRepliesCount",defaultMessage:"Hide {previousRepliesCount} {previousRepliesCount, plural, one {comment} other {comments}}",values:{previousRepliesCount:m}}):(0,X.jsx)(y()._H,{id:"CommentGroupingActivity.discussionThread.showPreviousRepliesCount",defaultMessage:"{previousRepliesCount} {previousRepliesCount, plural, one {more comment} other {more comments}}",values:{previousRepliesCount:m}})})}),d&&u.slice(1,-1).map((e=>(0,X.jsx)(ai,{commentStore:e,discussionStore:t,discussionLocation:i,onReactionToggle:a,maxLines:b,onMore:h},e.id))),u.slice(-1).map((e=>(0,X.jsx)(ai,{commentStore:e,discussionStore:t,discussionLocation:i,onReactionToggle:a,maxLines:b,onMore:h},e.id)))]})}function ai(e){const{commentStore:t,discussionStore:i,discussionLocation:a,onReactionToggle:s,maxLines:d,showAuthor:l=!0,onMore:u}=e,m=(0,r().Fy)(),[g,v]=(0,o.useState)(!1),h=(0,n().VK)((()=>{const e=t.getContent(),i=0===e.length;if(e||!i)return e.map((e=>{const i=R().t1.createChildStore(t,{table:p().iU,id:e,spaceId:t.getSpaceId()}).getValue();if(i)return(0,X.jsx)(Ht().ZP,{blockValue:i,rootStore:t},e)})).filter(b().$K)}),[t]),f=(0,n().VK)((()=>R().bh.getUserVisibleReactions(t).length>0),[t]),x=(0,n().VK)((()=>t.getLastEditedTime()>t.getCreatedTime()+100),[t]),_=!f&&m.isMobile,A=!_,j=(0,o.useCallback)((e=>{m.isMobile?e.preventDefault():v(!0)}),[m.isMobile]),C=(0,o.useCallback)((e=>{m.isMobile?e.preventDefault():v(!1)}),[m.isMobile]),M=(0,c().yK)((e=>({avatarCommentReactionBarContainer:{...!f&&!m.isMobile&&{position:"relative"}},avatarAndCommentContainer:{display:"flex",flexDirection:"column"},commentContainer:{display:"flex",justifyContent:"space-between",gap:6,flexGrow:1},commentClampContainer:{lineHeight:S().Nv.UIRegular.desktop,color:e.accentColors.gray[500]},toggleOverflowButton:{color:e.accentColors.gray[500],fontSize:14},editedBadge:{fontSize:13,color:e.mediumTextColor,paddingLeft:4},reactionBarMobile:f?{marginTop:4}:{marginRight:-6},reactionBar:{...!f&&{position:"absolute",top:-2,right:-8,opacity:g?1:0,transition:`opacity ${le}`},...f&&{marginTop:4}},newReaction:{borderWidth:1,borderStyle:"solid",borderColor:m.isMobile?"transparent":e.stroke.primary,borderRadius:6,boxShadow:m.isMobile?"unset":"0px 2px 4px 0px rgba(22, 29, 27, 0.02)"}})),[m,f,g]),K=(0,o.useCallback)((e=>{e.preventDefault(),u(e)}),[u]);return(0,X.jsx)("div",{children:(0,X.jsxs)("div",{style:M.avatarCommentReactionBarContainer,onMouseEnter:j,onMouseLeave:C,children:[(0,X.jsxs)("div",{style:M.avatarAndCommentContainer,children:[l&&(0,X.jsx)("div",{children:(0,X.jsx)(si,{commentStore:t})}),(0,X.jsxs)("div",{style:M.commentContainer,dir:"auto",children:[(0,X.jsxs)(zt().Z,{style:M.commentClampContainer,maxLines:d,onMore:K,moreElement:(0,X.jsxs)(Dt().Z,{style:M.toggleOverflowButton,disableUnderline:!0,hoverColor:"blue",children:["","",(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{id:"commentActivityNotification.truncated.showMoreLabel",defaultMessage:"more"})})]}),children:[(0,X.jsx)(di,{discussionStore:i,commentStore:t}),h,x&&(0,X.jsx)("span",{style:M.editedBadge,children:(0,X.jsx)(y()._H,{id:"CommentGroupingActivity.discussionThreadComment.editedBadge",defaultMessage:"(edited)"})})]}),_&&(0,X.jsx)("div",{style:m.isMobile?M.reactionBarMobile:M.reactionBar,children:(0,X.jsx)(ee,{children:(0,X.jsx)(Tt().DU,{parentStore:t,discussionLocation:a,onReactionToggle:s,newReactionStyle:M.newReaction})})})]})]}),A&&(0,X.jsx)("div",{style:m.isMobile?M.reactionBarMobile:M.reactionBar,children:(0,X.jsx)(ee,{children:(0,X.jsx)(Tt().DU,{parentStore:t,discussionLocation:a,onReactionToggle:s,newReactionStyle:M.newReaction})})})]})})}function si(e){const{commentStore:t}=e,i=(0,r().O7)(),o=(0,y().YB)(),a=(0,n().VK)((()=>{const e=t.getCreatedByPointer();if(e)return R().t1.createChildStore(t,e)}),[t]),s=(0,n().VK)((()=>{if(a)return a.getDisplayName(o)}),[a,o]),d=(0,n().VK)((()=>!!a&&i.currentUser.id===a.id),[i,a]),l=(0,c().yK)((e=>({fullName:{fontWeight:S().Ue.regular,fontSize:12,lineHeight:"22px",color:e.text.secondary},you:{fontWeight:S().Ue.regular,fontSize:12,lineHeight:"22px",color:e.text.tertiary}})),[]);return d?(0,X.jsx)(y()._H,{id:"CommentGroupingActivity.discussionThreadComment.authorLabel",defaultMessage:"<author>{fullName}</author> <you>(You)</you>",values:{author:e=>(0,X.jsx)("span",{style:l.fullName,children:e}),fullName:s,you:e=>(0,X.jsx)("span",{style:l.you,children:e})}}):s?(0,X.jsx)("span",{style:l.fullName,children:s}):(0,X.jsx)("span",{style:l.fullName,children:(0,X.jsx)(y()._H,{id:"CommentGroupingActivity.discussionThreadComment.unknownAuthorLabel",defaultMessage:"Unknown author"})})}function di(e){const{discussionStore:t,commentStore:i}=e,o=(0,r().O7)(),a=(0,c().Fg)(),s=(0,n().VK)((()=>Nt().zP(i).getValue()),[i]),d=(0,n().VK)((()=>i.getSpaceId()),[i]),l=(0,n().VK)((()=>{if(!s||!d)return null;const e=(0,It().H4)({textValue:s,currentUserId:o.currentUser.id,getRecordModel:t.getRecordModel,highlightStyle:"text_only"});return(0,Pt().IY)({environment:o,textValue:{value:e,spaceId:d},parentStore:t,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableHover:!0,disabled:!0,theme:a,emojiType:(0,Ut().e_)(o),katex:o.KatexStore.getKatex(),formulaValueTypes:[]})}),[o,t,a,s,d]),u=(0,c().yK)((e=>({commentText:{whiteSpace:"pre-wrap",wordBreak:"break-word",display:"inline",fontSize:14,color:e.regularTextColor,lineHeight:"22px"}})),[]);return(0,X.jsx)("span",{style:u.commentText,children:l})}const li=20;function ci(e){const{frontActorStore:t,backActorStore:i}=e,o=(0,c().yK)((()=>({container:{display:"grid",height:oe,width:oe},back:{gridColumn:1,gridRow:1,marginLeft:-3,marginTop:-3,maxWidth:li,minWidth:li},front:{gridColumn:1,gridRow:1,marginLeft:7,marginTop:7,maxWidth:li,minWidth:li}})),[]);return(0,X.jsxs)("div",{style:o.container,children:[(0,X.jsx)("div",{style:o.back,children:(0,X.jsx)(gi,{size:li,actorStore:i,avatar:void 0})}),(0,X.jsx)("div",{style:o.front,children:(0,X.jsx)(gi,{size:li,actorStore:t,avatar:void 0})})]})}function ui(e){const{authorsLength:t,frontActorStore:i,backActorStore:o,authorTextStyle:a}=e,s=(0,r().O7)(),d=(0,y().YB)(),l=s.currentUser.id,c=(0,n().VK)((()=>{if(i)return i.getDisplayName(d)}),[i,d]),u=(0,n().VK)((()=>{if(o)return o.getDisplayName(d)}),[o,d]),m={fontWeight:S().Ue.semibold,...a};return 0===t?(0,X.jsx)("span",{style:m,children:(0,X.jsx)(y()._H,{defaultMessage:"<b>Nobody</b>",id:"activitySection.authorPhraseInboxRedesign.forNoAuthors.label",values:{b:e=>(0,X.jsx)("span",{style:m,children:e})}})}):1===t&&i?i.id===l?(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{defaultMessage:"<b>You</b>",id:"activitySection.authorPhraseInboxRedesign.forOneAuthorCurrentUser.label",values:{b:e=>(0,X.jsx)("span",{style:m,children:e})}})}):(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{defaultMessage:"<b>{author}</b>",id:"activitySection.authorPhraseInboxRedesign.forOneAuthor.label",values:{author:c,b:e=>(0,X.jsx)("span",{style:m,children:e})}})}):2===t?o&&o.id===l?(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{defaultMessage:"<b>{frontActorName} and You</b>",id:"activitySection.authorPhraseInboxRedesign.forTwoAuthorsCurrentUser.label",values:{frontActorName:c,b:e=>(0,X.jsx)("span",{style:m,children:e})}})}):(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{defaultMessage:"<b>{frontActorName} and {backActorName}</b>",id:"activitySection.authorPhraseInboxRedesign.forTwoAuthors.label",values:{frontActorName:c,backActorName:u,b:e=>(0,X.jsx)("span",{style:m,children:e})}})}):t>2?(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{defaultMessage:"<b>{frontActorName} and {numberOfOtherAuthors} others</b>",id:"activitySection.authorPhraseInboxRedesign.forMoreThanTwoAuthors.label",values:{frontActorName:c,numberOfOtherAuthors:t-1,b:e=>(0,X.jsx)("span",{style:m,children:e})}})}):null}function mi(){const e=(0,c().yK)((e=>({icon:{height:14,width:14,fill:e.icon.secondary}})),[]);return(0,X.jsx)(he,{children:(0,kt().S)(e.icon)})}function gi(e){const{actorStore:t,avatar:i}=e,o=e.size??28;return t?t.table===xe().cZ?(0,X.jsx)(Et().Z,{botStore:t,size:o}):t.table===f().KJ?(0,X.jsx)(Ft().Z,{userStore:t,size:o}):t.table===Ve().y0?(0,X.jsx)(Ft().Z,{userStore:void 0,size:o}):void(0,b().t1)(t):i?(0,X.jsx)(Ft().Z,{avatar:i,size:o}):(0,X.jsx)(Ft().Z,{userStore:void 0,size:o})}const pi=o.memo(Wt);const vi=function(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:a,isLast:s}=e,{tab:d,notification:c}=o,u=(0,r().O7)(),m=(0,n().VK)((()=>(0,Mt().hI)(t.getEdits())),[t]),g=(0,n().VK)((()=>(0,l().P6)({edits:m,rootStore:i})),[m,i]),p=(0,n().VK)((()=>{const e=m[0];return e?e.new_email:""}),[m]);return(0,X.jsx)(fe,{header:(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{defaultMessage:"You updated your email to {newEmail}",values:{newEmail:p},id:"activity.emailEdited.header.short"})}),isFirst:a,isLast:s,isPrivate:!1,rootStore:i,notification:c,icon:(0,X.jsx)(tt().BE,{authors:g,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:void 0,...(0,Oe().JJ)({notification:c,activity:t,environment:u,tab:d})})};var hi=()=>i(836108),fi=()=>i(251932);function yi(){const e=(0,c().yK)((e=>({icon:{height:16,width:16,fill:e.icon.secondary}})),[]);return(0,X.jsx)(he,{children:(0,hi().c)(e.icon)})}i(470928);var bi=()=>i(1723),Si=()=>i(108205),xi=()=>i(641506),_i=()=>i(91502),Ai=()=>i(577325),ji=()=>i(44556);const Ci=3;function Mi(e){const{userIds:t,remainingAvatarCount:i,shownAvatarCount:o,titledRecordStore:r,isMobile:n}=e,a=(0,c().yK)((e=>({avatarContainer:{display:"flex",flexDirection:"row",justifyContent:"start",overflow:"hidden",paddingRight:2,alignItems:"center"},overlappingAvatar:{marginRight:-5,position:"relative"},rightmostAvatar:{position:"relative"},remainderCount:{paddingLeft:2,color:e.lightTextColor}})),[]);return(0,X.jsxs)("div",{style:a.avatarContainer,children:[t.slice(0,Ci).map(((e,t)=>{const i=R().U6.createChildStore(r,{table:f().KJ,id:e}),s=t===o-1;if(i)return(0,X.jsx)(Ft().Z,{userStore:i,size:24,avatarShouldShowShadow:!1,style:s?a.rightmostAvatar:a.overlappingAvatar,isOffline:!1,hasTooltip:!n},e)})),i>0&&(0,X.jsx)("div",{style:a.remainderCount,children:(0,X.jsx)(y()._H,{defaultMessage:"{remainingAvatarCount, plural, one {+{remainingAvatarCount}} other {+{remainingAvatarCount}}}",id:"activity.titleCard.members.otherCount.message",values:{remainingAvatarCount:i}})})]})}function Ri(e){const{titledRecordStore:t,rootStore:a,activity:s,tabArgs:d}=e,l=a.getRecordModel,u=(0,n().VK)((()=>t.getModel()),[t]),g=(0,r().O7)(),y=(0,n().VK)((()=>null==u?void 0:u.getRenderIcon({getRecordModel:l})),[u,l]),x=(0,n().VK)((()=>g.device.isMobile),[g]),_=(0,c().yK)((e=>({container:{display:"block",borderWidth:1,borderStyle:"solid",borderColor:e.tint.regular,borderRadius:8,marginTop:0,padding:12,background:e.contentBackground,boxShadow:"0px 1px 2px 0px "+("light"===e.mode?"rgba(0, 0, 0, 0.03)":"rgba(0, 0, 0, 0.12)"),transition:`background ${ne}`},icon:{...it().e9,marginRight:10},activityTitle:{fontSize:14,marginRight:void 0!==y?3:0,display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2,verticalAlign:"top",textAlign:"left",lineHeight:S().Nv.UIRegular.desktop,...S().Yu,whiteSpace:"normal",...it().nP},flexRow:{display:"flex",alignItems:"center"},title:{maxWidth:"80%"},spacer:{flexGrow:1},subtitle:{fontSize:12,color:e.lightTextColor}})),[y]),A=(0,n().VK)((()=>{if(u&&u.table!==h().e0)return u.getRenderUrl({getRecordModel:l,pageVisitSource:m().tY.Notification})}),[u,l]),j=(0,o.useCallback)((e=>{const i=t.table;switch(i){case p().iU:case v().bx:(0,Oe().V3)({environment:g,activity:s,...d});break;case h().e0:(0,Oe().dG)({environment:g,activity:s,...d}),ji().hI({environment:g,teamStore:t,shouldScroll:!0}),Ai().Z.setState({...Ai().Z.state,open:!1});break;default:(0,b().t1)(i)}}),[s,g,d,t]),C=(0,n().VK)((()=>{const e=t.table,o=(0,i(18281).Io)();let r=[],n=0;switch(e){case"space":if(!t.getModel())break;r=o.map((e=>e.userId)),n=Math.max(0,r.length-Ci);break;case"block":const i=t.getCreatedByPointer();(null==i?void 0:i.table)===f().KJ&&(r=[i.id]),n=Math.max(0,r.length-Ci);break;case"team":const a=(0,_i().oT)(t);r=(null==a?void 0:a.sampleMemberUserIds)??[],n=Math.max(0,(null==a?void 0:a.memberCount)??0-Ci);break;default:(0,b().t1)(e)}const a=Math.min(r.length,Ci);return(0,X.jsx)(Mi,{userIds:r,remainingAvatarCount:n,shownAvatarCount:a,titledRecordStore:t,isMobile:x})}),[x,t]);return u?(0,X.jsx)(Lt().Z,{href:A,onClick:j,external:!1,innerStyle:_.container,inline:!0,children:(0,X.jsxs)("div",{style:_.flexRow,children:[y&&(0,X.jsx)(W().Z,{disabled:!0,icon:y,isEmptyPage:!1,size:25,style:_.icon}),(0,X.jsx)("div",{style:_.title,children:(0,X.jsx)(G().Z,{store:t,style:_.activityTitle})}),(0,X.jsx)("div",{style:_.spacer}),(0,X.jsx)("div",{children:C})]})}):null}const Ki=o.memo(Ri);function ki(){const e=(0,c().yK)((e=>({icon:{height:16,width:16,fill:e.icon.secondary}})),[]);return(0,X.jsx)(he,{children:(0,bi().l)(e.icon)})}function wi(){const e=(0,r().O7)(),t=(0,n().VK)((()=>"dark"===e.ThemeStore.state.mode),[e]),i=(0,c().yK)((e=>({icon:{height:18,width:18,marginTop:2,marginRight:2,fill:t?e.primaryBlack:e.blueColor}})),[t]);return(0,X.jsx)(he,{children:(0,Si().k)(i.icon)})}var Vi=()=>i(29248),Ii=()=>i(352230),Ti=()=>i(104088),Bi=()=>i(529048),qi=()=>i(198829),Ui=()=>i(470386),Pi=()=>i(679063);function Ni(e){const{timestamp:t,header:i,hasChildren:o,navigableBlockId:n,rootStore:a,showRecordPath:s,disableJustify:d,onBacklinkClick:l,titleAriaId:u}=e,m=(0,H().IS)(t,{useUltraCompactFormat:!0}),g=(0,r().O7)().device.isMobile,v=(0,H().uy)(t),h=(0,c().yK)((e=>({container:{width:"100%"},header:{width:g?"calc(100% - 98px)":"100%",fontSize:14,lineHeight:1.4,minWidth:0,minHeight:g?28:void 0,display:"flex",alignItems:"baseline",justifyContent:d?void 0:"space-between"},flatIndentHeader:{width:g?"calc(100% - 98px)":"100%",fontSize:14,lineHeight:1.4,minWidth:0,minHeight:g?28:void 0,display:"flex",justifyContent:"space-between",alignItems:"baseline"},title:{fontSize:14,marginTop:4,marginBottom:o?8:4},time:{fontSize:12,color:e.lightTextColor,whiteSpace:"nowrap",display:"inline",paddingLeft:6},path:{marginTop:4,marginBottom:4},separatorDot:{fontSize:12,color:e.lightTextColor,marginLeft:4,marginRight:4}})),[o,g,d]);return(0,X.jsxs)("div",{style:h.container,children:[(0,X.jsxs)("div",{className:U().NFf,style:h.header,children:[(0,X.jsx)("span",{id:u,children:i}),(0,X.jsx)("div",{style:h.time,className:U().CZG,children:(0,X.jsx)($().Z,{text:m,tooltipText:v,icon:w().C})})]}),s&&n&&a&&(0,X.jsx)("div",{style:h.path,children:(0,X.jsx)(Pi().ZP,{isLink:!0,store:R().G.createChildStore(a,{table:p().iU,id:n}),onClick:l})})]})}const Oi=1;function Hi(e){const{rootStore:t,activity:i,isLast:a,tabArgs:s,edits:d,style:u,isFirst:g}=e,{tab:v,notification:h,source:f}=s,y=(0,r().O7)(),x=d.at(0),[_,A]=(0,o.useState)(null),j=(0,o.useMemo)((()=>_&&_.scrollHeight>_.clientHeight),[_]),C=(0,n().VK)((()=>{if(!x)return;const e=R().G.createChildStore(t,{table:p().iU,id:x.navigable_block_id});return(0,b().$K)(e)?e:void 0}),[x,t]),M=(0,n().VK)((()=>{const e=null==C?void 0:C.getModel();if(e)return e.getRenderUrl({getRecordModel:t.getRecordModel,pageVisitSource:m().tY.Notification})}),[t,C]),K=(0,n().VK)((()=>(0,l().jC)({recordId:null==C?void 0:C.id,recordType:p().iU,tab:v,rootStore:t,environment:y})),[C,v,t,y]),k=(0,c().yK)((e=>({formattedTitleStyle:{fontSize:S().JB.UISmall.desktop,color:e.lightTextColor},container:{paddingBlock:4,display:"flex",flexDirection:"row",columnGap:1.5*Number((0,it()._W)(e).paddingLeft),alignItems:"center"},unarchiveButton:{marginLeft:-1*Number((0,it()._W)(e).paddingLeft)}})),[]),w=(0,o.useMemo)((()=>new Set(d.map((e=>e.automation_id)))),[d]),V=1===w.size;return(0,b().$K)(C)&&(0,b().$K)(x)?(0,X.jsx)(fe,{header:(0,X.jsx)(Di,{rootStore:t,uniqueAutomations:w,firstEdit:x,spaceId:i.spaceId,environment:y,shortened:!1,titleStyle:{fontWeight:S().Ue.semibold}}),isFirst:g,isLast:a,isPrivate:K,rootStore:t,navigableBlockId:C.id,notification:h,icon:(0,X.jsx)(Zi,{}),showSnapshotButton:!1,url:M,...(0,Oe().JJ)({notification:h,activity:i,environment:y,tab:v}),children:(0,X.jsxs)("div",{style:u,children:[d.slice(-1*Oi).map(((i,o)=>(0,X.jsxs)("div",{children:[!V&&(0,X.jsx)(Di,{rootStore:t,firstEdit:i,uniqueAutomations:new Set([i.automation_id]),shortened:!0,spaceId:i.space_id,environment:y,titleStyle:k.formattedTitleStyle}),(0,X.jsx)(Fi,{...e,edit:i,isViewAllMenu:!1,source:f,isLast:d.length>Oi?o===d.length-1-Oi:o===d.length-1,clampedMessageContainerRef:A})]},o))),(0,X.jsx)("div",{style:k.container,children:(j||d.length>Oi)&&(0,X.jsx)(Li,{edits:d,rootStore:t,activity:i,navigableBlockStore:C,source:f})})]})}):null}function Li(e){const{edits:t,rootStore:i,activity:a,navigableBlockStore:s,source:d}=e,l=(0,r().Fy)(),u=(0,r().O7)(),{handleAnalyticsForPopupMenu:m}=(0,o.useContext)(Wi),g=(0,n().qz)(void 0,Bi().Z),p=(0,o.useCallback)((()=>g.reset()),[g]),v=(0,o.useMemo)((()=>(0,X.jsx)(y()._H,{defaultMessage:"{numNotifications, plural, one {View more} other {View {numRemainingNotifications}}}",id:"inAppNotificationAutomationActionTriggeredActivity.renderViewAllNotificationsButton.buttonLabel",values:{numNotifications:t.length,numRemainingNotifications:t.length}})),[t.length]);let h;h=l.isMobile?{menuType:Ii().o.Modal,title:v,right:(0,X.jsx)(Ui().DoneMenuText,{}),onClickRight:p,whiteBackground:!0}:{menuType:Ii().o.Popup,width:420,maxWidth:l.isMobileBrowser?"80vw":"100%"};const f=(0,c().yK)((e=>({actionButton:(0,it().b9)(e),divider:{borderBlockEnd:`1px solid ${e.regularDividerColor}`},viewAllMenuNotificationContainer:{display:"flex",flexDirection:"column",padding:12},viewAllMenuHeaderContainer:{display:"flex",flexDirection:"row",gap:ie},popupMenu:{marginInlineStart:-2,fontSize:ue}})),[]),b=(0,o.useId)();return(0,X.jsx)(z().ZP,{buttonPopupStore:g,popupType:l.isMobile?Ti().k.SlideUp:Ti().k.Popup,placementToOrigin:F().Placement.Bottom,alignmentToOrigin:F().Alignment.Center,originGap:4,onClick:()=>!g.state.open&&m(),renderOrigin:e=>(0,X.jsx)(ye().Z,{...e,style:f.actionButton,children:v}),render:()=>(0,X.jsx)(qi().Z,{...h,children:(0,X.jsx)("div",{style:f.popupMenu,children:t.map(((o,r)=>(0,X.jsxs)("div",{children:[(0,X.jsxs)("div",{style:f.viewAllMenuNotificationContainer,children:[(0,X.jsxs)("div",{style:f.viewAllMenuHeaderContainer,children:[(0,X.jsx)(Zi,{}),(0,X.jsx)(Ni,{timestamp:o.timestamp,titleAriaId:b,onBacklinkClick:()=>null,hasChildren:!0,disableJustify:!0,header:(0,X.jsx)(Di,{rootStore:i,uniqueAutomations:new Set([o.automation_id]),firstEdit:o,spaceId:a.spaceId,environment:u,closeViewAllMenu:p,shortened:!0,titleStyle:{fontWeight:S().Ue.semibold}}),rootStore:i,navigableBlockId:s.id,showRecordPath:!1})]}),(0,X.jsx)(Fi,{...e,edit:o,isViewAllMenu:!0,source:d,isLast:r===t.length-1},r)]}),r!==t.length-1&&(0,X.jsx)("div",{style:f.divider})]},r)))})})})}const Ei=4;function Fi(e){const{edit:t,rootStore:i,source:o,isViewAllMenu:a,clampedMessageContainerRef:s}=e,d=(0,c().Fg)(),l=(0,r().O7)(),u=(0,r().Fy)(),{isMobile:m}=u,g=(0,n().VK)((()=>l.KatexStore.getKatex()),[l]),p=(0,Ut().kw)(),v=(0,n().VK)((()=>(0,X.jsx)("div",{children:(0,Pt().IY)({environment:l,textValue:t.message.value?{value:t.message.value,spaceId:t.space_id}:void 0,parentStore:i,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disabled:!1,theme:d,emojiType:p,katex:g,parentBlockId:void 0,renderedPageBlockId:void 0,formulaValueTypes:[],stopLinkPropagation:!0})})),[l,p,g,d,t.message.value,i,t.space_id]),h=(0,c().yK)((e=>({container:{paddingInlineStart:a?32:(0,it().c3)({source:o,isMobile:m}),paddingBlockEnd:4},messageContainer:{position:"relative",display:"flex",justifyContent:"space-between",alignItems:"center"},clampedMessageContainer:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:a?void 0:Ei,verticalAlign:"top",textAlign:"left",lineHeight:S().Nv.UIRegular.desktop,...S().Yu},messageContent:{whiteSpace:"pre-wrap",wordBreak:"break-word",fontSize:ue,lineHeight:(0,xi().Dp)({device:u},"UIRegular"),paddingInlineEnd:8}})),[m,o,u,a]);return(0,X.jsx)("div",{style:{...a&&h.container,...h.messageContainer},children:(0,X.jsx)("div",{ref:s,style:h.clampedMessageContainer,children:(0,X.jsx)("div",{style:h.messageContent,children:v})})})}function Di(e){const{rootStore:t,spaceId:i,environment:o,closeViewAllMenu:r,shortened:a,titleStyle:s,firstEdit:d,uniqueAutomations:c}=e,u=(0,y().YB)(),g=1===c.size,v=(0,n().VK)((()=>!R().Mz.createChildStore(t,{table:bt().cv,id:d.automation_id,spaceId:t.getSpaceId()}).getAlive()),[t,d]),h=(0,n().VK)((()=>{const e=new(R().G)(o,{id:d.automation_navigable_block_id,table:p().iU}).getRole();return!e||!(0,we().YX)(e)}),[d,o]),f=(0,n().VK)((()=>{if(!(v&&g||h))return()=>{const e=d.automation_navigable_block_id,i=d.automation_id,n=R().G.createChildStore(t,{table:p().iU,id:e});if(!n)return;r&&r();const a=(0,_t().ZP)({store:n,preferPublicLink:!1,pageVisitSource:m().tY.Notification});St().c4({environment:o,url:a,callback:async()=>await(0,l().dM)({environment:o,automationNavigableBlockStore:n,automationId:g?i:void 0,rootStore:t,source:"in_app_notification"})})}}),[o,g,d,t,r,v,h]),S=(0,n().VK)((()=>[...c].map((e=>{const o=t.getRecordStore(t,{table:bt().cv,id:e,spaceId:i}),r=o.getRole();return(0,b().$K)(r)&&(0,we().YX)(r)?o.getAlive()?o.getNameWithDefault(u):u.formatMessage(ft().pQ.automationDeletedName):u.formatMessage(ft().pQ.automationPrivateName)}))),[u,t,i,c]);return a?(0,X.jsx)("div",{style:{...s,display:"inline-flex"},children:(0,X.jsx)(zi,{handleAutomationNavigate:f,automationNames:S})}):(0,X.jsx)(y()._H,{id:"inAppNotificationAutomationActionTriggeredActivity.formattedHeaderMessage.automationTitle",defaultMessage:"{automationNameWrappedHeader} sent you a message",values:{automationNameWrappedHeader:(0,X.jsx)("div",{style:{...s,display:"inline-flex"},children:(0,X.jsx)(zi,{handleAutomationNavigate:f,automationNames:S})})}})}function zi(e){const{automationNames:t,handleAutomationNavigate:i}=e,o=(0,y().YB)(),r=t.at(0),n=t.length,a=n-2,s=o.formatList([...t.slice(0,2),a>0?o.formatMessage({defaultMessage:"{numRemainingAutomations} more",id:"inAppNotificationAutomationActionTriggeredActivity.wrappedAutomationName.tooltipNumRemainingAutomations"},{numRemainingAutomations:a}):void 0].filter(b().$K),{style:"long",type:"conjunction"}),d={defaultMessage:"{numAutomations, plural, one {{firstAutomationName}} other {{numAutomations} automations}}",values:{firstAutomationName:r,numAutomations:n},id:"inAppNotificationAutomationActionTriggeredActivity.wrappedAutomationName.automationName",description:"The display name for an automation."},l=e=>i?(0,X.jsx)(At().Z,{...e,onClick:i,children:(0,X.jsx)(y()._H,{...d})}):(0,X.jsx)("div",{...e,children:(0,X.jsx)(y()._H,{...d,...e})});return 1===n?l():(0,X.jsx)(J().Z,{renderTooltip:e=>(0,X.jsx)("div",{...e,children:s}),render:e=>l(e)})}function Zi(){const e=(0,c().yK)((e=>({icon:{height:12,width:12,fill:e.icon.secondary}})),[]);return(0,X.jsx)(he,{children:(0,Vi().K)(e.icon)})}const Wi=(0,o.createContext)({handleAnalyticsForPopupMenu:()=>{}});function Gi(e){const{analyticsInfo:t,children:i}=e,r=(0,o.useCallback)((()=>Ie().hI(t)),[t]);return(0,X.jsx)(Wi.Provider,{value:{handleAnalyticsForPopupMenu:r},children:i})}Wi.displayName="InAppNotificationAutomationActionTriggeredAnalyticsContext";var Ji=()=>i(72539);const Yi=function(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:a,isLast:s}=e,{tab:d,notification:c}=o,u=(0,r().O7)(),m=(0,n().VK)((()=>t.getEdits()),[t]),g=(0,n().VK)((()=>(0,l().P6)({edits:m,rootStore:i})),[m,i]),v=(0,n().VK)((()=>(0,l().XW)(g,{...(0,M().h_)()})),[g]),h=(0,n().VK)((()=>{const e=R().G.createChildStore(i,{table:p().iU,id:t.navigable_block_id});if(e.isDefined())return e}),[t,i]),b=(0,n().VK)((()=>Boolean(h&&(0,l().jC)({recordId:h.id,recordType:p().iU,tab:d,rootStore:i,environment:u}))),[h,d,i,u]),S=m[0],x=(0,n().VK)((()=>(0,l().N8)(S.from_user_id,i)),[S,i]),_=(0,n().VK)((()=>(0,l().N8)(S.to_user_id,i)),[S,i]);if(!(m.length>0&&x&&_&&h))return null;const j=(0,Se().$4)(A().Z.getIntl(),(0,Se().LU)({table:f().KJ,value:x}));return(0,X.jsx)(fe,{header:(0,X.jsx)(y()._H,{defaultMessage:"{authorPhrase} transferred {fromUserName}{fromUserNameEndsWithS, select, true {} other {s}} private pages to you",values:{authorPhrase:v,fromUserName:j,fromUserNameEndsWithS:"s"===j.slice(-1).toLowerCase()},id:"activity.privateContentTransferred.standardizedHeader.short"}),isPrivate:b,rootStore:i,notification:o.notification,isFirst:a,isLast:s,icon:(0,X.jsx)(tt().BE,{authors:g,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:void 0,...(0,Oe().JJ)({notification:c,activity:t,environment:u,tab:d})})};var $i=()=>i(602299);function Xi(e){const{authorCount:t,authorPhrase:i,targetStore:o}=e;return(0,n().VK)((()=>o instanceof R().T5),[o])?(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} reacted in} other {{authorOrAuthors} reacted in}}",values:{numberOfAuthors:t,authorOrAuthors:i},id:"activity.reactionActivity.standardizedHeader.comment"}):(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} reacted to} other {{authorOrAuthors} reacted to}}",values:{numberOfAuthors:t,authorOrAuthors:i},id:"activity.reactionActivity.standardizedHeader.discussion"})}function Qi(e){const{targetStore:t,source:i}=e,o=(0,r().O7)(),a=(0,r().Fy)(),s=(0,c().Fg)(),d=(0,n().VK)((()=>ei({source:i,forReplyMenu:!1})),[i]),l=(0,c().yK)((e=>({linkbox:{display:"flex",alignItems:"center",fontSize:13,color:e.mediumTextColor,paddingTop:2,paddingBottom:8,marginBottom:0},commentText:{whiteSpace:"pre-wrap",wordBreak:"break-word",display:"inline",fontSize:14,color:e.regularTextColor,lineHeight:"22px"},newReaction:{borderWidth:1,borderStyle:"solid",borderColor:a.isMobile?"transparent":e.stroke.primary,borderRadius:6,boxShadow:a.isMobile?"unset":"0px 2px 4px 0px rgba(22, 29, 27, 0.02)"},avatarCommentReactionBarContainer:{...!a.isMobile&&{position:"relative"}},avatarAndCommentContainer:{display:"flex",flexDirection:"column"},commentContainer:{display:"flex",justifyContent:"space-between",gap:6,flexGrow:1}})),[a.isMobile]),u=(0,n().VK)((()=>{const e=Nt().zP(t).getValue();if(!e)return null;const i=t.getSpaceId();if(!i)return null;const r=(0,It().H4)({textValue:e,currentUserId:o.currentUser.id,getRecordModel:t.getRecordModel,highlightStyle:"text_only"});return(0,Pt().IY)({environment:o,textValue:{value:r,spaceId:i},parentStore:t,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableHover:!0,disabled:!0,theme:s,emojiType:(0,Ut().e_)(o),katex:o.KatexStore.getKatex(),formulaValueTypes:[]})}),[t,o,s]);return(0,X.jsxs)("div",{style:l.avatarCommentReactionBarContainer,children:[(0,X.jsx)("div",{style:l.avatarAndCommentContainer,children:(0,X.jsx)("div",{children:(0,X.jsx)(si,{commentStore:t})})}),(0,X.jsx)("div",{style:l.commentContainer,children:(0,X.jsx)("div",{style:S().Yu,children:(0,X.jsx)("span",{style:l.commentText,children:u})})}),(0,X.jsx)(Tt().DU,{parentStore:t,discussionLocation:d,onReactionToggle:()=>{},newReactionStyle:l.newReaction})]})}var eo=()=>i(471500);function to(){const e=(0,c().yK)((e=>({icon:{height:16,width:16,fill:e.icon.secondary}})),[]);return(0,X.jsx)(he,{children:(0,eo().m)(e.icon)})}function io(e){const{titledRecordStore:t,rootStore:i,activity:a,tabArgs:s}=e,d=i.getRecordModel,l=(0,n().VK)((()=>t.getModel()),[t]),u=(0,r().O7)(),m=(0,n().VK)((()=>u.device.isMobile),[u]),g=(0,n().VK)((()=>null==l?void 0:l.getRenderIcon({getRecordModel:d})),[l,d]),v=(0,o.useCallback)((o=>{const r=t.table;switch(r){case p().iU:(0,Oe().V3)({environment:u,activity:a,...s});break;case h().e0:(0,Oe().V3)({environment:u,activity:a,...s}),ji().hI({environment:u,teamStore:t,shouldScroll:!0}),Ai().Z.setState({...Ai().Z.state,open:!1});const n=e.notification;if(!n||n.read)break;(0,N().ZP)({event:o,context:N().Af.NotificationClick,callback:()=>{q().createAndCommit({userAction:"NotificationTitleCard.handleMarkAsRead",environment:u,canUndo:!0,perform:e=>{T().$h({notification:n,rootStore:i,transaction:e,read:!0})}})}});break;default:(0,b().t1)(r)}}),[a,u,e.notification,i,s,t]),[y,x]=o.useState(!1),[_,A]=o.useState(!1),j=(0,c().yK)((e=>({container:{display:"flex",alignItems:"center",borderRadius:8,background:_?e.state.pressed:y?e.state.hover:"transparent",transition:`background ${ne}`,marginTop:0,padding:12,boxShadow:"0px 1px 2px 0px "+("light"===e.mode?"rgba(0, 0, 0, 0.03)":"rgba(0, 0, 0, 0.12)"),border:"1px",borderStyle:"solid",borderColor:e.tint.regular,cursor:y?"pointer":"default"},icon:{...it().e9,marginRight:10},activityTitle:{fontSize:14,marginRight:void 0!==g?3:0,display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2,verticalAlign:"top",textAlign:"left",lineHeight:S().Nv.UIRegular.desktop,...S().Yu,whiteSpace:"normal",...it().nP},title:{maxWidth:"80%"},spacer:{flexGrow:1},subtitle:{fontSize:12,color:e.lightTextColor},avatarContainer:{display:"flex",flexDirection:"row",justifyContent:"start",overflow:"hidden",paddingRight:2,alignItems:"center"},overlappingAvatar:{marginRight:-5,position:"relative"},rightmostAvatar:{position:"relative"},remainderCount:{paddingLeft:2,color:e.lightTextColor}})),[g,y,_]),C=(0,n().VK)((()=>{let e=[],i=0;const o=t.table;switch(o){case"block":const r=t.getCreatedByPointer();(null==r?void 0:r.table)===f().KJ&&(e=[r.id]),i=Math.max(0,e.length-Ci);break;case"team":const n=(0,_i().oT)(t);e=(null==n?void 0:n.sampleMemberUserIds)??[],i=Math.max(0,(null==n?void 0:n.memberCount)??0-Ci);break;default:(0,b().t1)(o)}const r=Math.min(e.length,Ci);return(0,X.jsx)(Mi,{userIds:e,remainingAvatarCount:i,shownAvatarCount:r,titledRecordStore:t,isMobile:m})}),[m,t]);return l?(0,X.jsxs)("div",{style:j.container,onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),onMouseDown:()=>A(!0),onMouseUp:()=>A(!1),onClick:v,children:[g&&(0,X.jsx)(W().Z,{disabled:!0,icon:g,isEmptyPage:!1,size:25,style:j.icon}),(0,X.jsx)("div",{style:j.title,children:(0,X.jsx)(G().Z,{store:t,style:j.activityTitle})}),(0,X.jsx)("div",{style:j.spacer}),(0,X.jsx)("div",{children:C})]}):null}const oo=o.memo(io);var ro=()=>i(309672),no=()=>i(126139),ao=()=>i(293338),so=()=>i(326966);function lo(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:a,isLast:s}=e,{notification:d,tab:c}=o,u=(0,r().O7)(),g=(0,n().VK)((()=>t.getEdits()),[t]),p=g[0],v=go({rootStore:i,edit:p}),h=function(e){let{data:t,tab:i,rootStore:o}=e;const a=(0,r().O7)();return(0,n().VK)((()=>{if("block"!==(null==t?void 0:t.type))return!1;const e=t.blockStore.id;return(0,l().jC)({recordId:e,recordType:"block",tab:i,rootStore:o,environment:a})}),[t,a,o,i])}({data:v,tab:c,rootStore:i}),f=(0,n().VK)((()=>(0,l().P6)({edits:g,rootStore:i})),[g,i]),y=(0,n().VK)((()=>{if("block"===(null==v?void 0:v.type))return v.blockStore}),[v]),b=(0,n().VK)((()=>{if(!y)return;const e=y.getModel();return e?e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:m().tY.Notification}):void 0}),[y,i.getRecordModel]),S=(0,n().VK)((()=>t.navigable_block_id),[t]);if(0===g.length||!v)return null;const x=0===f.filter(Se().uC).length,_=x?void 0:(0,X.jsx)(tt().BE,{authors:f,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1});return(0,X.jsxs)(fe,{header:(0,X.jsx)(uo,{data:v,authors:f,isFromBot:x}),hidePageTitle:!0,isFirst:a,isLast:s,isPrivate:h,rootStore:i,navigableBlockId:S,notification:d,icon:_,showSnapshotButton:!1,url:b,...(0,Oe().JJ)({notification:d,environment:u,tab:c,activity:t}),children:[(0,X.jsx)(mo,{...e,edit:p}),(0,X.jsx)(co,{data:v,rootStore:i,activity:t,tabArgs:o})]})}function co(e){var t;const{data:i,rootStore:o,activity:r,tabArgs:n}=e,a=(0,c().yK)((e=>({group:{color:e.mediumTextColor,fontSize:14},titleCardWrapper:{display:"contents",pointerEvents:"none"}})),[]);switch(i.type){case"block":return(0,X.jsx)(ee,{children:(0,X.jsx)(oo,{titledRecordStore:i.blockStore,rootStore:o,activity:r,tabArgs:n})});case"group":return(0,X.jsx)("div",{style:a.group,children:(0,X.jsx)(y()._H,{defaultMessage:"You will now get notifications when @{groupName} is mentioned",id:"activity.userInvitedActivity.groupInviteExplanation",values:{groupName:null===(t=i.group)||void 0===t?void 0:t.name}})});case"space":return(0,X.jsx)(ee,{children:(0,X.jsx)("div",{style:a.titleCardWrapper,children:(0,X.jsx)(Ki,{tabArgs:n,titledRecordStore:i.spaceStore,rootStore:o,activity:r})})});default:(0,b().t1)(i)}}function uo(e){var t,i;const{data:o,authors:r,isFromBot:a}=e,s=(0,n().VK)((()=>(0,l().XW)(r,{...(0,M().h_)()})),[r]);switch(o.type){case"block":return a?(0,X.jsx)(y()._H,{defaultMessage:"You were invited to a page",id:"activity.userInvitedActivityByBot.standardizedHeader.redesign"}):(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a page} other {{authorOrAuthors} invited you to a page}}",values:{numberOfAuthors:r.length,authorOrAuthors:s},id:"activity.userInvitedActivity.standardizedHeader.redesign"});case"group":return a?(0,X.jsx)(y()._H,{defaultMessage:"You were added to @{groupName}",values:{groupName:null===(t=o.group)||void 0===t?void 0:t.name},id:"activity.userInvitedActivityGroupIdByBot.standardizedHeader.redesign"}):(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to @{groupName}} other {{authorOrAuthors} added you to @{groupName}}}",values:{numberOfAuthors:r.length,authorOrAuthors:s,groupName:null===(i=o.group)||void 0===i?void 0:i.name},id:"activity.userInvitedActivityGroupId.standardizedHeader.redesign"});case"space":return a?(0,X.jsx)(y()._H,{defaultMessage:"You were invited to a workspace",id:"activity.userInvitedActivityOtherInviteByBot.standardizedHeader.redesign"}):(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a workspace} other {{authorOrAuthors} invited you to a workspace}}",values:{numberOfAuthors:r.length,authorOrAuthors:s},id:"activity.userInvitedActivityOtherInvite.standardizedHeader.redesign"});default:(0,b().t1)(o)}}function mo(e){const{edit:t,activity:i,rootStore:o,tabArgs:a}=e,s=(0,r().O7)(),{isMobile:d}=s.device,{source:l}=a,u=(0,c().yK)((()=>({redesignedInviteMessage:{fontSize:14,paddingTop:8,paddingBottom:8},inviteMessage:{paddingLeft:(0,it().c3)({source:l,isMobile:d}),paddingTop:8,paddingBottom:8,paddingRight:12,fontSize:14}})),[d,l]),m=go({rootStore:o,edit:t}),g=(0,n().VK)((()=>parseInt(i.end_time)),[i]),p=(0,n().VK)((()=>{if("block"!==(null==m?void 0:m.type))return;const e=m.blockStore;return null!=e&&e.isDefined()?e.getModel():void 0}),[m]),v=(0,n().VK)((()=>{if(!p)return{isValid:!1};const e=p&&(0,ao().$e)(p,i);if(!e)return{isValid:!1};const t=o.getRecordModel({table:no().Tu,id:e,spaceId:i.space_id});return t&&t.getMessage()&&t.getCreatedTime()<=g+5*so().hM?{isValid:!0,message:t.getMessage()}:{isValid:!1}}),[i,g,p,o]);return null!=v&&v.isValid?(0,X.jsx)("div",{style:u.redesignedInviteMessage,children:v.message}):null}function go(e){let{rootStore:t,edit:i}=e;return(0,n().VK)((()=>{if(i)return i.navigable_block_id?{type:"block",blockStore:R().G.createChildStore(t,{table:p().iU,id:i.navigable_block_id})}:i.permission_group_id?{type:"group",group:(0,ro().Bg)({spaceId:i.space_id,permissionGroupId:i.permission_group_id,getRecordValue:t.getRecordValue})}:{type:"space",spaceStore:R().H2.createChildStore(t,{table:v().bx,id:i.space_id})}}),[i,t])}var po=()=>i(926724);function vo(e){const{mentionedProperty:t,authorPhrase:i,authors:o}=e;switch(t){case po().Es.Assign:return(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} assigned you a task} other {{authorOrAuthors} assigned you a task}}",values:{numberOfAuthors:o.length,authorOrAuthors:i},id:"activity.mentionTaskActivity.standardizedHeader"});case po().zI.People:return(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned you in} other {{authorOrAuthors} mentioned you in}}",values:{numberOfAuthors:o.length,authorOrAuthors:i},id:"activity.mentionProjectActivity.standardizedHeader.short"});default:return(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned you in} other {{authorOrAuthors} mentioned you in}}",values:{numberOfAuthors:o.length,authorOrAuthors:i},id:"activity.mentionActivity.standardizedHeader.short"})}}var ho=()=>i(836083),fo=()=>i(496205);function yo(){const e=(0,c().yK)((e=>({icon:{height:16,width:16,fill:e.icon.secondary}})),[]);return(0,X.jsx)(he,{children:(0,ho().f)(e.icon)})}function bo(e){const t=(0,r().O7)();return(0,o.useEffect)((()=>{!function(e,t){if("commented"===e.type){const o=t.getRecordStore(t,{table:d().qF,id:e.discussion_id,spaceId:e.space_id});if(o.isDefined()){const e=o.getCommentStores();for(const t of e){var i;null===(i=t.getCreatedByStore())||void 0===i||i.load()}}}}(e.activity,e.rootStore),t.KatexStore.loadIfNeeded((()=>function(e,t){const i=(0,l().cr)({activity:e,rootStore:t});if(!i)return;return i.context}(e.activity,e.rootStore)))}),[t.KatexStore,e.activity,e.rootStore]),(0,X.jsx)("div",{children:(0,X.jsx)(xo,{...e})})}const So={"block-property-edited":function(e){const{activity:t,rootStore:o,tabArgs:a,isFirst:s,isLast:d}=e,{tab:c,notification:u}=a,g=(0,n().VK)((()=>(0,Mt().hI)(t.getEdits())),[t]),v=g.length>0,h=(0,n().VK)((()=>R().G.createChildStore(o,{table:p().iU,id:g[0].navigable_block_id})),[o,g]),f=(0,n().VK)((()=>{const e=h.getModel();if(e)return e.getRenderUrl({getRecordModel:o.getRecordModel,pageVisitSource:m().tY.Notification})}),[h,o]),b=(0,n().VK)((()=>(0,l().P6)({edits:g,rootStore:o})),[g,o]),S=(0,r().O7)(),x=(0,n().VK)((()=>(0,l().XW)(b,{...(0,M().h_)()})),[b]),_=(0,n().VK)((()=>(0,l().jC)({recordId:h.id,recordType:"block",tab:c,rootStore:o,environment:S})),[h,c,o,S]);if(!(0,n().VK)((()=>h.isDefined()),[h])||!v)return null;const A=new Set;return g.forEach((e=>{Object.keys(e.property_updates).forEach((e=>{A.add(e)}))})),(0,X.jsx)(fe,{header:A.size>1?(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} updated properties} other {{authorOrAuthors} updated properties}}",id:"activity.blockEdited.standardizedHeader.multiple",values:{numberOfAuthors:b.length,authorOrAuthors:x}})}):(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} updated a property} other {{authorOrAuthors} updated a property}}",id:"activity.blockEdited.standardizedHeader.single",values:{numberOfAuthors:b.length,authorOrAuthors:x}})}),isFirst:s,isLast:d,isPrivate:_,rootStore:o,navigableBlockId:h.id,notification:u,icon:(0,X.jsx)(tt().BE,{authors:b,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:f,...(0,Oe().JJ)({notification:u,activity:t,environment:S,tab:c}),children:(0,X.jsx)(i(75308).Z,{visible:5,items:g.map(((e,t)=>(0,X.jsx)(Rt().Z,{edit:e,rootStore:o},t)))})})},"user-mentioned":function(e){const{activity:t,rootStore:o,tabArgs:a,isFirst:s,isLast:d}=e,{tab:c,notification:u}=a,g=(0,r().O7)(),v=(0,n().VK)((()=>t.getEdits()),[t]),h=v.length>0,f=v[0],y=R().G.createChildStore(o,{table:p().iU,id:f.navigable_block_id}),b=(0,n().VK)((()=>y.isDefined()),[y]),S=(0,n().VK)((()=>R().WJ.createChildStore(o,{table:i(114882).TY,id:t.id,spaceId:t.space_id}).getStandardizedMentionedPropertyURI()),[t,o]),x=(0,n().VK)((()=>{const e=R().G.createChildStore(o,{table:p().iU,id:t.mentioned_block_id}).getModel();return null==e?void 0:e.getRenderUrl({getRecordModel:o.getRecordModel,pageVisitSource:m().tY.Notification})}),[t,o]),_=(0,n().VK)((()=>(0,l().P6)({edits:v,rootStore:o})),[v,o]),A=(0,n().VK)((()=>(0,l().XW)(_,{...(0,M().h_)()})),[_]),j=(0,n().VK)((()=>(0,l().jC)({recordId:y.id,recordType:"block",tab:c,rootStore:o,environment:g})),[y,c,o,g]);return h&&b&&x?(0,X.jsx)(fe,{header:(0,X.jsx)(vo,{mentionedProperty:S,authorPhrase:A,authors:_}),isFirst:s,isLast:d,isPrivate:j,rootStore:o,navigableBlockId:y.id,notification:u,icon:(0,X.jsx)(tt().BE,{authors:_,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:x,...(0,Oe().JJ)({notification:u,activity:t,environment:g,tab:c}),children:(0,X.jsx)(Rt().Z,{edit:f,rootStore:o,highlightCurrentUser:!0,highlightCurrentUserStyle:"text_only"})}):null},commented:pi,"user-invited":o.memo(lo),reminder:function(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:a,isLast:s}=e,{notification:d,tab:c}=o,u=(0,r().O7)(),g=(0,n().VK)((()=>t.getEdits()),[t]),v=g.length>0,h=R().G.createChildStore(i,{table:p().iU,id:g[0].navigable_block_id}),f=(0,n().VK)((()=>h.isDefined()),[h]),b=(0,n().VK)((()=>{const e=R().G.createChildStore(i,{table:p().iU,id:t.reminder_block_id}).getModel();if(e)return e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:m().tY.Notification})}),[t,i]),x=(0,n().VK)((()=>(0,l().jC)({recordId:h.id,recordType:p().iU,tab:c,rootStore:i,environment:u})),[h,c,i,u]);return v&&f&&b?(0,X.jsx)(fe,{header:(0,X.jsx)("span",{style:{fontWeight:S().Ue.medium},children:(0,X.jsx)(y()._H,{defaultMessage:"Reminder",id:"activity.reminderInActivity.header.short"})}),isFirst:a,isLast:s,isPrivate:x,rootStore:i,navigableBlockId:h.id,notification:d,icon:(0,X.jsx)(to,{}),showSnapshotButton:!1,url:b,...(0,Oe().JJ)({notification:d,activity:t,environment:u,tab:c}),children:(0,X.jsx)(Rt().Z,{edit:g[0],rootStore:i})}):null},"email-edited":vi,"access-requested":gt,"access-request-resolved":ht,"team-membership-edited":function(e){const{activity:t,rootStore:o,tabArgs:a,isFirst:s,isLast:d}=e,{notification:c,tab:u}=a,g=(0,r().O7)(),p=(0,n().VK)((()=>t.getEdits()),[t]),v=p.length>0,f=(0,n().VK)((()=>(0,l().P6)({edits:p,rootStore:o})),[p,o]),b=(0,n().VK)((()=>(0,l().XW)(f,{...(0,M().h_)()})),[f]),S=p[0],x=R().zX.createChildStore(o,{table:h().e0,id:S.team_id}),_=(0,n().VK)((()=>x.isDefined()),[x]),A=(0,n().VK)((()=>{if((0,i(142589).U)({isMobileNative:g.device.isMobileNative}))return(0,i(161002).y)({teamId:S.team_id,pageVisitSource:m().tY.Notification})}),[S.team_id,g]);return v&&_?(0,X.jsx)(fe,{header:(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a teamspace} other {{authorOrAuthors} invited you to a teamspace}}",values:{numberOfAuthors:f.length,authorOrAuthors:b},id:"activity.userInvitedToTeamActivity.standardizedHeader"}),isFirst:s,isLast:d,isPrivate:!1,rootStore:o,notification:c,icon:(0,X.jsx)(tt().BE,{authors:f,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:A,...(0,Oe().JJ)({notification:c,activity:t,environment:g,tab:u}),children:(0,X.jsx)(ee,{children:(0,X.jsx)(oo,{titledRecordStore:x,rootStore:o,activity:t,tabArgs:a,notification:c})})}):null},"private-content-transferred":Yi,"permission-group-mentioned":function(e){const{activity:t,rootStore:i,isFirst:o,isLast:a,tabArgs:s}=e,{tab:d,notification:c}=s,u=(0,r().O7)(),g=(0,n().VK)((()=>t.getEdits()),[t]),v=g.length>0,h=g[0],f=R().G.createChildStore(i,{table:p().iU,id:h.navigable_block_id}),b=(0,n().VK)((()=>f.isDefined()),[f]),S=(0,n().VK)((()=>{const e=R().G.createChildStore(i,{table:p().iU,id:t.mentioned_block_id}).getModel();if(e)return e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:m().tY.Notification})}),[t,i]),x=(0,n().VK)((()=>(0,l().P6)({edits:t.getEdits(),rootStore:i})),[t,i]),_=(0,n().VK)((()=>(0,l().XW)(x,{...(0,M().h_)()})),[x]),A=(0,n().VK)((()=>(0,l().jC)({recordId:f.id,recordType:p().iU,tab:d,rootStore:i,environment:u})),[f,d,i,u]);return v&&b&&S?(0,X.jsx)(fe,{header:(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned your group} other {{authorOrAuthors} mentioned your group}}",values:{numberOfAuthors:x.length,authorOrAuthors:_},id:"activity.groupMentionActivity.standardizedHeader.short"})}),isFirst:o,isLast:a,isPrivate:A,rootStore:i,navigableBlockId:f.id,notification:c,icon:(0,X.jsx)(tt().BE,{authors:x,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:S,...(0,Oe().JJ)({notification:c,activity:t,environment:u,tab:d}),children:(0,X.jsx)(Rt().Z,{edit:h,rootStore:i,highlightCurrentUser:!0,highlightCurrentUserStyle:"text_only"})}):null},"team-mentioned":function(e){const{activity:t,rootStore:i,isFirst:o,isLast:a,tabArgs:s}=e,{tab:d,notification:c}=s,u=(0,r().O7)(),g=(0,n().VK)((()=>t.getEdits()),[t]),v=g.length>0,h=g[0],f=(0,n().VK)((()=>R().G.createChildStore(i,{table:p().iU,id:h.navigable_block_id})),[h,i]),b=(0,n().VK)((()=>f&&f.isDefined()),[f]),S=(0,n().VK)((()=>{const e=R().G.createChildStore(i,{table:p().iU,id:t.mentioned_block_id}).getModel();if(e)return e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:m().tY.Notification})}),[t,i]),x=(0,n().VK)((()=>(0,l().P6)({edits:t.getEdits(),rootStore:i})),[t,i]),_=(0,n().VK)((()=>(0,l().XW)(x,{...(0,M().h_)()})),[x]),A=(0,n().VK)((()=>(0,l().jC)({recordId:f.id,recordType:p().iU,tab:d,rootStore:i,environment:u})),[f,d,i,u]);return v&&b&&S?(0,X.jsx)(fe,{header:(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned your teamspace} other {{authorOrAuthors} mentioned your teamspace}}",values:{numberOfAuthors:x.length,authorOrAuthors:_},id:"activity.teamMentionActivity.standardizedHeader.short"})}),isFirst:o,isLast:a,isPrivate:A,rootStore:i,navigableBlockId:f.id,notification:c,icon:(0,X.jsx)(tt().BE,{authors:x,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:S,...(0,Oe().JJ)({notification:c,activity:t,environment:u,tab:d}),children:(0,X.jsx)(Rt().Z,{edit:h,rootStore:i,highlightCurrentUser:!0,highlightCurrentUserStyle:"text_only"})}):null},"verification-expired":function(e){const{activity:t,rootStore:o,tabArgs:a,isFirst:s,isLast:d}=e,{tab:u,notification:g}=a,v=(0,r().O7)(),h=(0,n().VK)((()=>R().G.createChildStore(o,{table:p().iU,id:t.navigable_block_id})),[t,o]),f=(0,n().VK)((()=>h.isDefined()),[h]),b=(0,n().VK)((()=>{const e=h.getModel();if(e)return e.getRenderUrl({getRecordModel:o.getRecordModel,pageVisitSource:m().tY.Notification})}),[h,o]),x=(0,n().VK)((()=>t.collection_id?R().NW.createChildStore(o,{table:i(752778).vF,id:t.collection_id,spaceId:t.space_id}):void 0),[t,o]),_=(0,n().VK)((()=>!(null==x||!x.isPageTreeCollection())),[x]),A=(0,n().VK)((()=>{let e;if(_){const t=null==x?void 0:x.getSchema();e=(t?Object.keys(t):[]).find((e=>{var i;return!!t&&"verification"===(null===(i=t[e])||void 0===i?void 0:i.type)}))}else e=fo().EI.Verification;let t=(0,X.jsx)(y()._H,{id:"Activity.author.unknown",defaultMessage:"Unknown"});if(e){const i=h.getPropertyValue(e),r=(0,fo()._w)(i);if(r){const e=r[0],i=(0,l().uA)(e,o);i&&i.asActor&&(t=(0,l().XW)([i],{...(0,M().h_)()}))}}return t}),[h,x,_,o]),j=(0,n().VK)((()=>(0,l().jC)({recordId:h.id,recordType:"block",tab:u,rootStore:o,environment:v})),[h,u,o,v]),{activityStartTimestamp:C,activityEndTimestamp:K}=(0,n().VK)((()=>({activityStartTimestamp:parseInt(t.start_time),activityEndTimestamp:parseInt(t.end_time)})),[t]),k=(0,c().yK)((e=>({verificationMessage:{fontSize:14,color:e.mediumTextColor}})),[]);return f?(0,X.jsx)(fe,{header:_?(0,X.jsx)(y()._H,{defaultMessage:"<medium>Wiki verification</medium> expired",id:"activity.verificationExpired.header.short",values:{medium:e=>(0,X.jsx)("span",{style:{fontWeight:S().Ue.medium},children:e})}}):(0,X.jsx)(y()._H,{defaultMessage:"<medium>Page verification</medium> expired",id:"activity.verificationExpired.page.header.short",values:{medium:e=>(0,X.jsx)("span",{style:{fontWeight:S().Ue.medium},children:e})}}),isFirst:s,isLast:d,isPrivate:j,rootStore:x??o,navigableBlockId:h.id,notification:g,icon:(0,X.jsx)(yo,{}),showSnapshotButton:!1,url:b,...(0,Oe().JJ)({notification:g,activity:t,environment:v,tab:u}),children:(0,X.jsx)("div",{style:k.verificationMessage,children:C&&K?(0,X.jsx)(y()._H,{defaultMessage:"Last verified by {person} from {startDate} to {endDate}",values:{person:A,startDate:(0,H().gs)(C),endDate:(0,H().gs)(K)},id:"activity.verificationExpired.contentWithTimestamp"}):(0,X.jsx)(y()._H,{defaultMessage:"Last verified by {person}",values:{person:A},id:"activity.verificationExpired.contentWithoutTimestamp"})})}):null},"export-completed":function(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:a,isLast:s}=e,{tab:d,notification:l,source:u}=o,m=(0,r().O7)(),g=m.device.isMobile,{edits:p}=(0,n().VK)((()=>({edits:t.getEdits()})),[t]),v=(0,c().yK)((e=>({container:{paddingLeft:(0,it().c3)({source:u,isMobile:g}),paddingTop:12,paddingBottom:4},newContainer:{paddingTop:12,paddingBottom:4},actionButton:(0,it().b9)(e)})),[g,u]),h=(0,X.jsx)(y()._H,{defaultMessage:"Your workspace export is ready",id:"activity.exportCompleted.header"}),f=(0,X.jsx)(fi().gq,{style:{fontSize:12},children:(0,X.jsx)(y()._H,{defaultMessage:"The download link will expire in 7 days.",id:"activity.exportCompleted.downloadLink"})});return(0,X.jsxs)(fe,{header:h,isFirst:a,isLast:s,isPrivate:!0,rootStore:i,notification:l,icon:(0,X.jsx)(yi,{}),showSnapshotButton:!1,url:void 0,...(0,Oe().JJ)({notification:l,activity:t,environment:m,tab:d}),children:[f,(0,X.jsx)("div",{style:v.newContainer,children:(0,X.jsx)(ye().Z,{onClick:()=>{window.open(p[0].link,"_blank")},style:v.actionButton,children:(0,X.jsx)(y()._H,{defaultMessage:"Download",id:"activity.actions.exportCompleted.download"})})})]})},"import-completed":function(e){var t;const{activity:o,rootStore:a,tabArgs:s,isFirst:d,isLast:l}=e,{tab:u,notification:g,source:v}=s,h=(0,r().O7)(),{edits:f}=(0,n().VK)((()=>({edits:o.getEdits()})),[o]),b=null===(t=f[0])||void 0===t?void 0:t.teamspace_id,S=(0,n().VK)((()=>i(700696).default.state.teams.find((e=>e.id===b))),[b]),x=(0,n().VK)((()=>null==S?void 0:S.getName()),[S]),_=h.device.isMobile,A=(0,c().yK)((e=>({linkbox:{...(0,it().OD)({source:v,isMobile:_}),display:"flex",alignItems:"center",fontSize:xi().yv(h,"UIRegular"),paddingTop:2,paddingBottom:6,marginBottom:0,width:"100%"},newContainerLinkBox:{...(0,it().OD)({source:v,isMobile:_}),display:"flex",alignItems:"center",fontSize:xi().yv(h,"UIRegular"),paddingTop:2,paddingBottom:6,marginBottom:0,paddingLeft:0,width:"100%"}})),[_,v,h]);if(!f.length)return(0,X.jsx)(X.Fragment,{});const{import_source:j,import_status:C,version:M,landing_page:K,collection_page_ids:k}=f[0],w=(0,X.jsx)(y()._H,{defaultMessage:"Your {importSource} import has failed",id:"activity.importFailed.header",values:{importSource:j,importStatus:C}}),V=(0,X.jsx)(y()._H,{defaultMessage:"Your {importSource} import was successful",id:"activity.importSuccess.header",values:{importSource:j,importStatus:C}}),I=(0,X.jsx)(fi().gq,{style:{fontSize:xi().yv(h,"UISmall")},children:(0,X.jsx)(y()._H,{defaultMessage:"View projects and tasks in Notion",id:"activity.importCompleted.projects.redirect"})}),T=(0,X.jsx)(fi().gq,{style:{fontSize:xi().yv(h,"UISmall")},children:(0,X.jsx)(y()._H,{defaultMessage:"View boards in Notion",id:"activity.importCompleted.boards.redirect"})}),B=(0,X.jsx)(fi().gq,{style:{fontSize:xi().yv(h,"UISmall")},children:(0,X.jsx)(y()._H,{defaultMessage:"View import logs",id:"activity.importCompleted.loggerPage.redirect"})}),q=(0,i(135857).Z)({pageId:K,pageVisitSource:m().tY.Import});let U="successful"===C?V:w,P=(0,X.jsx)(fi().gq,{children:(0,X.jsx)(Lt().Z,{href:q,innerStyle:A.newContainerLinkBox,children:"successful"===C?"Monday"===j&&"v2"===M?T:I:B})});const N="Jira"===j?(0,X.jsx)(wi,{}):(0,X.jsx)(ki,{}),O=null==k?void 0:k[0];if("Jira"===j){const{headerComponent:e,bodyComponent:t}=(()=>{let e,t;if(S&&"successful"===C&&(e=(0,X.jsxs)("div",{children:[(0,X.jsx)(y()._H,{defaultMessage:"Your Jira projects and tasks have been synced to",id:"activity.importCompleted.jira.success.header"})," ",(0,X.jsx)("div",{style:{display:"inline-block",position:"relative"},children:(0,X.jsx)(i(383694).p,{disabled:!0,store:S,size:20})})," ",(0,X.jsx)("span",{children:x})]})),O){const e=R().G.createChildStore(a,{id:O.projectCollectionPageId,spaceId:a.id,table:p().iU}),i=R().G.createChildStore(a,{id:O.taskCollectionPageId,spaceId:a.id,table:p().iU});t=(0,X.jsxs)("div",{style:{paddingRight:12},children:[(0,X.jsx)(Ki,{titledRecordStore:e,rootStore:a,activity:o,tabArgs:s}),(0,X.jsx)("div",{style:{height:6}}),(0,X.jsx)(Ki,{titledRecordStore:i,rootStore:a,activity:o,tabArgs:s})]})}return{headerComponent:e,bodyComponent:t}})();t&&(P=t),e&&(U=e)}return(0,X.jsx)(fe,{url:void 0,header:U,isPrivate:!0,isFirst:d,isLast:l,rootStore:a,notification:g,icon:N,showSnapshotButton:!1,...(0,Oe().JJ)({notification:g,activity:o,environment:h,tab:u}),children:P})},"in-app-notification-automation-action-triggered":function(e){const{activity:t,tabArgs:i}=e,{tab:o,notification:a}=i,s=(0,r().O7)(),d=(0,n().VK)((()=>t.getEdits()),[t]),l=d.length>0,u={tab:o,notificationId:null==a?void 0:a.id,environment:s,alreadyRead:Boolean(null==a?void 0:a.read),activity:t},m=(0,c().yK)((e=>({notificationContainer:{paddingBlock:"8px 4px",display:"flex",flexDirection:"column",rowGap:8}})),[]);return l?(0,X.jsx)(Gi,{analyticsInfo:u,children:(0,X.jsx)(Hi,{...e,edits:d,style:m.notificationContainer})}):null},"no-conflicts-found":function(e){const{activity:t,rootStore:o,tabArgs:a,isFirst:s,isLast:d}=e,{tab:l,notification:c}=a,u=(0,r().O7)(),g=(0,y().YB)(),v=(0,n().VK)((()=>t.navigable_block_id),[t]),h=(0,n().VK)((()=>{const e=i(128076).G.createChildStore(o,{table:p().iU,id:t.navigable_block_id}).getModel();if(e)return e.getRenderUrl({getRecordModel:o.getRecordModel,pageVisitSource:m().tY.Notification})}),[t,o]),f=(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{defaultMessage:"<b>{author}</b> did not find conflicts",id:"activity.noConflictsFound.header",values:{author:Ji().GR.getDisplayName(g),b:e=>(0,X.jsx)("span",{style:{fontWeight:S().Ue.semibold},children:e})}})});return h?(0,X.jsx)(fe,{header:f,isFirst:s,isLast:d,isPrivate:!0,rootStore:o,navigableBlockId:v,notification:c,icon:(0,X.jsx)(tt().BE,{authors:[Ji().GR],size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:h,...(0,Oe().JJ)({notification:c,activity:t,environment:u,tab:l})}):null},"automation-typecheck-error-raised":function(e){const{rootStore:t,activity:a,isLast:s,tabArgs:d,isFirst:u}=e,{tab:g,notification:v}=d,h=(0,y().YB)(),f=(0,r().O7)(),x=(0,n().VK)((()=>a.getEdits()),[a]),_=x.at(0),A=(0,c().yK)((e=>({notificationContainer:{paddingTop:4,display:"flex",flexDirection:"column",rowGap:8},editAutomation:{marginTop:8,height:26,fontWeight:S().Ue.medium},messageContainer:{alignItems:"center",color:e.text.secondary,display:"flex",fontSize:ue,justifyContent:"space-between",lineHeight:S().Nv.UIRegular.desktop,paddingInlineEnd:12,position:"relative"},headerName:{fontWeight:S().Ue.medium,display:"inline-flex"}})),[]),j=(0,o.useMemo)((()=>new Set(x.map((e=>e.automation_id)))),[x]),M=(0,n().VK)((()=>{if(!(0,b().$K)(_))return!1;return!R().Mz.createChildStore(t,{table:bt().cv,id:_.automation_id,spaceId:t.getSpaceId()}).getAlive()}),[t,_]),{handleNavigateToAutomation:K,navigableBlockStore:k,navigableBlockUrl:w}=function(e){let{edit:t,rootStore:i,uniqueAutomationIds:o}=e;const a=(0,r().O7)(),s=1===o.size,d=(0,n().VK)((()=>{if(!(0,b().$K)(t))return!1;return!R().Mz.createChildStore(i,{table:bt().cv,id:t.automation_id,spaceId:i.getSpaceId()}).getAlive()}),[i,t]),c=(0,n().VK)((()=>{if((0,b().$K)(t))return new(R().G)(a,{id:t.automation_navigable_block_id,table:p().iU})}),[t,a]),u=(0,n().VK)((()=>{if(!(0,b().$K)(c))return!0;const e=c.getRole();return!e||!(0,we().YX)(e)}),[c]),g=(0,n().VK)((()=>{if((0,b().$K)(c))return(0,_t().ZP)({store:c,preferPublicLink:!1,pageVisitSource:m().tY.Notification})}),[c]),v=(0,n().VK)((()=>u||!(0,b().$K)(t)?()=>{}:()=>{const e=t.automation_id;c&&g&&((0,xt().j)({environment:a,event:{eventName:"click_automation_typecheck_error_notification",eventProperties:{block_id:c.id,automation_id:e}}}),St().c4({environment:a,url:g,callback:async()=>await(0,l().dM)({environment:a,automationNavigableBlockStore:c,automationId:s&&!d?e:void 0,rootStore:i,source:"automation_typecheck_error_raised_notification"})}))}),[d,s,u,t,c,g,a,i]);return{handleNavigateToAutomation:v,navigableBlockStore:c,navigableBlockUrl:g}}({edit:_,rootStore:t,uniqueAutomationIds:j}),V=(0,n().VK)((()=>(0,l().jC)({recordId:null==k?void 0:k.id,recordType:p().iU,tab:g,rootStore:t,environment:f})),[k,g,t,f]),I=(0,n().VK)((()=>{const e=j.values().next().value;if(e){return t.getRecordStore(t,{table:bt().cv,id:e,spaceId:a.spaceId}).getNameWithDefault(h)}return""}),[a.spaceId,h,t,j]),B=(0,n().VK)((()=>[...j].map((e=>{const i=t.getRecordStore(t,{table:bt().cv,id:e,spaceId:a.spaceId}),o=i.getRole();return(0,b().$K)(o)&&(0,we().YX)(o)?i.getAlive()?i.getNameWithDefault(h):h.formatMessage(ft().pQ.automationDeletedName):h.formatMessage(ft().pQ.automationPrivateName)}))),[h,t,a,j]),U=(0,o.useCallback)((e=>{(0,N().ZP)({event:e,context:N().Af.NotificationClick,callback:()=>{q().createAndCommit({userAction:"AutomationTypecheckErrorRaisedActivity.viewError",environment:f,canUndo:!0,perform:e=>{T().$h({notification:v,rootStore:t,transaction:e,read:!0})}}),K(),Ie().bi({tab:g,notificationId:null==v?void 0:v.id,environment:f,alreadyRead:Boolean(null==v?void 0:v.read),activity:a})}})}),[a,f,K,v,t,g]),P=(0,C().E)("automation_updated_error_states");if(!(0,b().$K)(k)||!(0,b().$K)(_)||0===x.length||!P)return null;const O=(0,X.jsx)("div",{style:A.headerName,children:(0,X.jsx)(jt,{handleAutomationNavigate:U,automationNames:B})}),H=M&&1===j.size;return(0,X.jsx)(fe,{header:(0,X.jsx)(y()._H,{id:"AutomationTypecheckErrorRaisedActivity.formattedHeaderMessage.automationTitle",defaultMessage:"{automationNames} {numAutomationNames, plural, one {is} other {are}} invalid",values:{numAutomationNames:j.size,automationNames:O}}),isFirst:u,isLast:s,isPrivate:V,rootStore:t,navigableBlockId:k.id,notification:v,icon:(0,X.jsx)(Ct,{automationName:I}),showSnapshotButton:!1,url:w,...(0,Oe().JJ)({notification:v,activity:a,environment:f,tab:g}),children:(0,X.jsx)("div",{style:A.notificationContainer,onClick:U,children:!H&&(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)("div",{style:A.messageContainer,children:(0,X.jsx)(y()._H,{id:"AutomationTypecheckErrorRaisedActivity.formattedHeaderMessage.automationMessage",defaultMessage:"Resolve any errors or remove failing steps to enable {numAutomationNames, plural, one {this automation} other {these automations}}",values:{numAutomationNames:j.size}})}),(0,X.jsx)("div",{children:(0,X.jsx)(i(661297).Z,{style:A.editAutomation,onClick:U,size:"sm",children:(0,X.jsx)(y()._H,{id:"AutomationTypecheckErrorRaisedActivity.editAutomation.automationMessage",defaultMessage:"Edit automation"})})})]})})})},reacted:function(e){const{activity:t,tabArgs:o,rootStore:a,isFirst:s,isLast:c}=e,{source:u,tab:g,notification:v}=o,h=(0,n().VK)((()=>t.getEdits()),[t]),f=(0,r().O7)(),y=(0,n().VK)((()=>{const e=t.discussion_id;if(!h||!t.discussion_id)return;const{reacted_comment_id:i}=h[0],o=i?$i().x_:d().qF,r=i??e;return a.getRecordStore(a,{table:o,id:r,spaceId:t.space_id})}),[h,t,a]),b=(0,n().VK)((()=>{if(y){if(y.table===$i().x_){const e=y.getParentStore(),t=null==e?void 0:e.getParentPointer();if(!t)return;return R().G.createChildStore(a,t)}if(y.table===d().qF){const e=y.getParentPointer();if(!e)return;return R().G.createChildStore(a,e)}}}),[y,a]),x=(0,n().VK)((()=>{const e=null==b?void 0:b.getNavigableBlockStore();return(null==e?void 0:e.id)||t.navigable_block_id}),[t,b]),_=(0,n().VK)((()=>{var e;if(b)return null===(e=b.getModel())||void 0===e?void 0:e.getRenderUrl({getRecordModel:a.getRecordModel,discussionId:t.discussion_id,pageVisitSource:m().tY.Notification})}),[b,a,t]),A=(0,n().VK)((()=>(0,l().P6)({edits:h,rootStore:a})),[h,a]),{frontActorStore:j,backActorStore:C}=(0,n().VK)((()=>{const e=f.currentUser.id;if(!e||0===A.length)return{frontActorStore:void 0,backActorStore:void 0};const i=A.map((e=>R().t1.createChildStore(a,{table:e.table,id:e.id,spaceId:t.space_id})));return(0,l().V2)({authorStores:i,currentUserId:e})}),[A,f.currentUser.id,a,t.space_id]),M=(0,n().VK)((()=>(0,l().jC)({recordId:t.navigable_block_id,recordType:p().iU,tab:g,rootStore:a,environment:f})),[t,a,g,f]),K=(0,n().VK)((()=>{const e=null==h?void 0:h[0];if(null==e||!e.reaction_id)return;const o=a.getRecordStore(a,{table:i(421476).yo,id:e.reaction_id,spaceId:t.space_id});return null==o?void 0:o.getIcon()}),[t,a,h]),k=(0,n().VK)((()=>{if(y&&y.table===$i().x_)return y}),[y]);return(0,X.jsx)(fe,{header:y&&(0,X.jsx)(Xi,{authorCount:A.length,authorPhrase:(0,X.jsx)(ui,{authorsLength:A.length,frontActorStore:j,backActorStore:C,authorTextStyle:{fontWeight:S().Ue.medium}}),targetStore:y}),isFirst:s,isLast:c,isPrivate:M,rootStore:a,navigableBlockId:x,notification:v,icon:(0,X.jsx)("span",{style:{fontSize:18},children:K}),showSnapshotButton:!1,url:_,...(0,Oe().JJ)({notification:v,environment:f,tab:g,activity:t}),children:k&&(0,X.jsx)(Qi,{targetStore:k,source:u})})}};function xo(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:r,isLast:d}=e,l=(0,n().VK)((()=>t.type),[t]);if(!(0,a().n_)(l))return s().log({level:"error",from:"ActivityNotification",type:"unsupportedActivityType",data:{message:`Activity type ${l} is not supported for ActivityNotification`}}),null;const c=So[l];return(0,X.jsx)(c,{activity:t,rootStore:i,tabArgs:o,isFirst:r,isLast:d})}},594777:(e,t,i)=>{i.d(t,{U:()=>a});i(241792);var o=()=>i(219727),r=()=>i(142735),n=()=>i(779522);function a(e){const t=(0,o().O7)();return(0,r().VK)((()=>{var i;const o=null==e?void 0:e.id;if(o)return null===(i=n().Z.getData(t,{spaceId:o}))||void 0===i?void 0:i.map((e=>e.domain))}),[t,e])}},104822:(e,t,i)=>{i.d(t,{B:()=>l,U:()=>d});var o=()=>i(530980),r=()=>i(243225),n=()=>i(989478),a=()=>i(565818),s=()=>i(286338);function d(e,t){return e.getKeyStore("settings").getKeyStore("seen_guest_membership_requests").getValue()&&(0,s().Ye)()}function l(e,t){const i=o().kk5.fromAccessRequest(e);if(!i.isPageAccessRequest())return!1;const s=i.getForActorPointer(t.id);return s.table===n().KJ&&!a().y.createChildStore(t,r().v8({userId:s.id,spaceId:t.id})).isMember()}},613119:(e,t,i)=>{i.d(t,{v:()=>p,E:()=>v});i(492176),i(7961),i(241792);var o=()=>i(219727),r=()=>i(142735),n=()=>i(217388),a=()=>i(989478),s=()=>i(513670),d=i(667294),l=()=>i(429490);var c=()=>i(826955),u=()=>i(367246),m=()=>i(897257),g=()=>i(591914);function p(e){var t;let{spaceStore:i,request:n}=e;const d=(0,o().O7)(),l=(0,r().VK)((()=>{if(n)return new(c().U6)(d,{id:n.getForActorId(),table:a().KJ}).getModel()}),[n,d]),u=n&&l?{accessRequest:n,forActor:l}:void 0;return null===(t=v({spaceStore:i,requests:(0,s().oA)([u])}))||void 0===t?void 0:t.at(0)}function v(e){let{spaceStore:t,requests:i}=e;const a=function(e){let{spaceStore:t,requests:i}=e;const n=(0,o().O7)(),a=function(e){const t=(0,l().U)(e);return(0,d.useCallback)((e=>t.memberEmails.has(e)?"member":t.guestEmails.has(e)?"guest":void 0),[t])}(m().subscriptionDataStoreInstance),s=(0,r().VK)((()=>null==i?void 0:i.map((e=>({email:e.forActor.email,currentRole:a(e.forActor.email)})))),[i,a]),c=n.currentUser.id,p=c?(0,g().VK)(t,c):void 0;return(0,u().WT)({space:t,spaceUser:p,team:void 0,optimism:"optimistic",invitees:s??[],publicPageDataGuestSetting:void 0})}({spaceStore:t,requests:i});return(0,r().VK)((()=>null==i?void 0:i.map((e=>{var t;const i=(0,n().Z)(e.accessRequest),o=null==a||null===(t=a[e.forActor.email])||void 0===t?void 0:t.type;return"guest_invite_request"!==i?i:"cannot_add"===o?"space_membership_request":"guest_invite_request"}))),[i,a])}},981697:(e,t,i)=>{i.d(t,{Z:()=>n});var o=i(667294),r=()=>i(219727);function n(e){const t=(0,r().O7)(),{onLongPress:i,hapticsEnabled:n=!0,timeout:a=300}=e,s=(0,o.useCallback)((()=>{var e,o,r;n&&(null!==(e=t.mobileNative)&&void 0!==e&&e.buzz?t.mobileNative.buzz():null===(o=(r=window.navigator).vibrate)||void 0===o||o.call(r,20));i()}),[t.mobileNative,n,i]),d=(0,o.useRef)(),l=(0,o.useRef)(0),c=(0,o.useRef)(0),u=(0,o.useCallback)((()=>clearTimeout(d.current)),[]);(0,o.useEffect)((()=>u),[u]);return{onTouchStart:(0,o.useCallback)((()=>{clearTimeout(d.current),d.current=setTimeout(s,a)}),[a,s]),onTouchMove:(0,o.useCallback)((e=>{const t=e.touches[0].clientX,i=e.touches[0].clientY;(Math.abs(t-l.current)>50||Math.abs(i-c.current)>50)&&clearTimeout(d.current)}),[]),onTouchEnd:u,onTouchCancel:u}}},847354:(e,t,i)=>{i.d(t,{u:()=>d});var o=()=>i(219727),r=()=>i(142735),n=()=>i(658096),a=()=>i(749826);const s=new(i(168469).q)((e=>{if("block-space"===e.type)return`${e.type}-${e.blockId}-${e.spaceId}`;(0,i(696459).t1)(e.type)}),(async(e,t)=>{const o=await Promise.resolve().then(i.bind(i,824462)),r={[i(547913).YM]:t.spaceId},n=await o.callApi({eventName:"getPublicPageData",environment:e,data:t,headers:r});return"success"===n.type?n.data:void 0}));function d(e){const{blockStore:t}=e,i=(0,o().O7)();return(0,r().VK)((()=>{const e=t.id,o=t.getSpaceId(),r=n().default.state.publicPageData;if(a().default.checkGate({gateName:"ui_guest_disable_changes"})){var d;if((null==r?void 0:r.pageId)===e)return(null==r||null===(d=r.securitySettings)||void 0===d?void 0:d.guestSetting)??{type:"can_add"};{var l;const t=s.getData(i,{type:"block-space",blockId:e,spaceId:o});return(null==t||null===(l=t.securitySettings)||void 0===l?void 0:l.guestSetting)??{type:"can_add"}}}}),[t,i])}},429490:(e,t,i)=>{i.d(t,{U:()=>l});i(122556),i(582845),i(250570),i(533019),i(721473),i(788208),i(22624),i(267602),i(653476),i(241792);var o=()=>i(219727),r=()=>i(142735),n=()=>i(989478),a=()=>i(696459),s=()=>i(826955),d=()=>i(18281);function l(e){const t=(0,o().O7)();return(0,r().VK)((()=>{const i=e.state;if(!i)return{memberEmails:new Set,guestEmails:new Set};const o=d().hn(i),r=d().ND(i),l=e=>new(s().U6)(t,{table:n().KJ,id:e.userId}).getEmail();return{memberEmails:new Set(o.map(l).filter(a().$K)),guestEmails:new Set(r.map(l).filter(a().$K))}}),[t,e])}},219099:(e,t,i)=>{i.d(t,{Z:()=>r});class o extends(()=>i(263184))().default{getInitialState(){return{count:0}}}const r=new o},969243:(e,t,i)=>{i.d(t,{r:()=>r});var o=()=>i(143346);const r=new(i(168469).q)((e=>{let{userId:t,spaceId:i}=e;return`${t}-${i}`}),(async function(e,t){var r;let{userId:n,spaceId:a}=t;const[s,d]=await Promise.all([o().bG({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:{table:i(989478).KJ,id:n},userId:n}),o().bG({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:(0,i(243225).v8)({userId:n,spaceId:a}),userId:n})]),l=null===(r=i(876822).default.state.currentSpaceViewStore)||void 0===r||null===(r=r.getModel())||void 0===r?void 0:r.first_joined_space_time,c=null==s?void 0:s.value,u=null==d?void 0:d.value;if(c&&u&&l)return{id:c.id,space_id:u.id,membership_type:u.membership_type,email:c.email,name:c.name,profile_photo:c.profile_photo,onboarding_completed:c.onboarding_completed,first_joined_space_time:l}}));i(947115).exposeDebugValue("UserOnSpaceStore",r)},367246:(e,t,i)=>{i.d(t,{AW:()=>c,WT:()=>u});var o=()=>i(219727),r=()=>i(142735),n=()=>i(557876),a=()=>i(594777),s=()=>i(847354),d=()=>i(458335),l=()=>i(815277);function c(e){let{space:t,team:i,spaceUser:o,invitees:d,blockStore:c}=e;const u=(0,r().VK)((()=>null==o?void 0:o.getUserId()),[o]),v=(0,l().oo)({name:"internal_guests",spaceId:null==t?void 0:t.id,userId:u,amount:0}),h=(0,l().oo)({name:"guests",spaceId:null==t?void 0:t.id,userId:u,amount:0}),f=(0,s().u)({blockStore:c}),y=m(t),b=g(o),S=p(b,i),x=(0,a().U)(t);return(0,r().VK)((()=>{if(y&&b&&h&&v&&x)return(0,n().CR)({space:y,domains:x,team:S,spaceUser:b,invitees:d,internalGuestFeatureAvailability:v,guestFeatureAvailability:h,publicPageDataGuestSetting:f})}),[y,S,v,h,b,d,x,f])}function u(e){let{space:t,team:i,spaceUser:o,invitees:s,optimism:d="pessimistic",publicPageDataGuestSetting:c}=e;const u=(0,r().VK)((()=>null==o?void 0:o.getUserId()),[o]),v=(0,l().oo)({name:"internal_guests",spaceId:null==t?void 0:t.id,userId:u,amount:0}),h=(0,l().oo)({name:"guests",spaceId:null==t?void 0:t.id,userId:u,amount:0}),f=m(t),y=g(o),b=p(y,i),S=(0,a().U)(t);return(0,r().VK)((()=>{if(f&&y&&h&&v&&S)return(0,n().Lw)({space:f,domains:S,team:b,spaceUser:y,invitees:s,optimism:d,guestFeatureAvailability:h,internalGuestFeatureAvailability:v,publicPageDataGuestSetting:c})}),[f,y,S,b,s,h,v,d,c])}function m(e){const t=(0,o().O7)(),i=(0,r().VK)((()=>null==e?void 0:e.getModel()),[e]),n=(0,r().VK)((()=>{if(null==e||!e.id)return;const i=d().Z.getData(t,{spaceId:e.id});return i?{id:i.id,disable_guests:i.disableGuests,getSettings:()=>({disable_membership_requests:!1,enable_guest_invite_requests:i.enableGuestInviteRequest})}:void 0}),[e,t]);return i??n}function g(e){return(0,r().VK)((()=>null==e?void 0:e.getModel()),[e])??{isMember:()=>!1,isWorkspaceOwner:()=>!1}}function p(e,t){const i=(0,r().VK)((()=>null==t?void 0:t.getModel()),[t]);return(0,r().VK)((()=>null==e?void 0:e.isMember()),[e])?i:{getDisableGuests:()=>!1}}},223248:(e,t,i)=>{i.d(t,{Id:()=>x,Ng:()=>_,Px:()=>b,ow:()=>S,t_:()=>y,um:()=>f});i(267602),i(653476);var o=()=>i(506347),r=()=>i(989478),n=()=>i(465755),a=()=>i(824462),s=()=>i(636340),d=()=>i(102182),l=()=>i(224597),c=()=>i(269299),u=()=>i(527278),m=()=>i(345918),g=()=>i(876822),p=()=>i(44556),v=()=>i(111631);const h=(0,i(788860).vU)({joinTeamSuccessMessage:{id:"teamInviteLinkActions.joinTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},requestTeamSuccessMessage:{id:"teamInviteLinkActions.requestAccess.successMessage",defaultMessage:"Successfully requested membership"},requestTeamFailureMessage:{id:"teamInviteLinkActions.requestAccess.failureMessage",defaultMessage:"Failed to request membership"}});async function f(e){let{environment:t,userId:i,teamStore:o,user:r}=e;const a=o.getSpaceId();if(!a)return;await p().Wi({environment:t,teamId:o.id,spaceId:a,teamUserInfo:r,isSettingDefaultTeam:!1,inviterId:i})&&(n().UD(t,{store:o,joined_role:"member",from:"team_invite_link"}),await y({environment:t,userId:i,teamStore:o}),d().oV({label:u().Z.formatMessage(h.joinTeamSuccessMessage,{teamName:o.getName()})}))}async function y(e){let{environment:t,userId:i,teamStore:r}=e;const n=g().default.state.currentUserRootStore,a=r.getSpaceId();if(!a||!n)return;const s=n.getSpaceViewStores().filter((e=>e.getSpaceId()===a))[0];await l().y3({environment:t,spaceViewStore:s,userSettingsStore:void 0,userRootStore:n,pageVisitSource:o().tY.JoinTeam,navigationType:"switchingToOrLoadingSpace"}),await v().I({environment:t,spaceId:a,userId:i}),p().hI({environment:t,teamStore:r,shouldScroll:!0})}async function b(e){let{environment:t,teamId:i,message:o}=e;if(!t.currentUser.id)return;"success"===(await a().callApi({eventName:"requestAccess",environment:t,data:{type:"current-actor-to-team",teamId:i,message:o}})).type?(n().LB(t,{teamId:i}),await x({environment:t}),new Promise((e=>setTimeout(e,500))).then((()=>{d().oV({label:u().Z.formatMessage(h.requestTeamSuccessMessage)})}))):d().oV({label:u().Z.formatMessage(h.requestTeamFailureMessage)})}async function S(e){let{environment:t,teamStore:i,accessRequestStore:o,status:a}=e;const d=o.getForActorId();if(!d)return;const l=o.getRecordModel({table:r().KJ,id:d});if(l){if("approved"===a){const e=[{type:"member",entity_type:"user",user_id:l.id}];if(!(await p().Uj({environment:t,teamStore:i,teamMemberInfos:e,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})))return}c().createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,canUndo:!0,perform:e=>{s().sW({store:o,transaction:e,data:{resolved_time:Date.now(),resolved_by_table:r().KJ,resolved_by_id:t.currentUser.id,status:a}})}}),n().co(t,{store:i,resolution:a})}}async function x(e){let{environment:t}=e;const{lastVisitedSpaceView:i,userRootStore:r,userSettingsStore:n}=await(0,m().iX)({environment:t,disableRedirectUrl:!1});i?await l().y3({environment:t,spaceViewStore:i,userRootStore:r,userSettingsStore:n,pageVisitSource:o().tY.BackForward,navigationType:"switchingToOrLoadingSpace"}):await l().L5({environment:t,userRootStore:r,userSettingsStore:n,pageVisitSource:o().tY.BackForward})}async function _(e){let{environment:t,teamId:i}=e;const o=await a().callApi({eventName:"getTeamAccessRequestMetadata",environment:t,data:{teamId:i}});if("success"===o.type)return o.data}},217388:(e,t,i)=>{i.d(t,{Z:()=>r});var o=()=>i(696459);function r(e){return e.isGuestInviteRequest()?"guest_invite_request":e.isPageAccessRequest()?"page_access_request":e.isSpaceMembershipRequest()?"space_membership_request":e.isTeamMembershipRequest()?"team_membership_request":void(0,o().t1)(e)}},907171:(e,t,i)=>{i.d(t,{S:()=>r});i(667294);var o=i(785893);const r=(0,i(827282).IU)("personBadgeQuestionMark",{viewBox:"0 0 15 14",svg:(0,o.jsx)("path",{d:"M12.4551 5.41699C12.8037 5.41699 13.0088 5.19824 13.0088 4.93164V4.84961C13.0088 4.45996 13.2344 4.2207 13.7061 3.90625C14.3691 3.46875 14.8408 3.07227 14.8408 2.25195C14.8408 1.11719 13.8291 0.501953 12.667 0.501953C11.498 0.501953 10.7256 1.0625 10.5342 1.69141C10.5 1.80078 10.4795 1.91016 10.4795 2.02637C10.4795 2.33398 10.7188 2.49805 10.9443 2.49805C11.1836 2.49805 11.3271 2.38867 11.4502 2.22461L11.5732 2.06055C11.8125 1.66406 12.1748 1.43164 12.626 1.43164C13.248 1.43164 13.6514 1.78711 13.6514 2.30664C13.6514 2.77148 13.3643 2.99707 12.7695 3.41406C12.2773 3.75586 11.915 4.11816 11.915 4.78809V4.87695C11.915 5.23242 12.1064 5.41699 12.4551 5.41699ZM5.79004 6.99609C7.25293 6.99609 8.52441 5.68359 8.52441 3.97461C8.52441 2.28613 7.25293 1.03516 5.79004 1.03516C4.32715 1.03516 3.05566 2.31348 3.05566 3.98828C3.05566 5.68359 4.32031 6.99609 5.79004 6.99609ZM12.4414 7.4541C12.8379 7.4541 13.1797 7.13965 13.1797 6.74316C13.1797 6.34668 12.8447 6.03223 12.4414 6.03223C12.0381 6.03223 11.7031 6.35352 11.7031 6.74316C11.7031 7.13281 12.0449 7.4541 12.4414 7.4541ZM1.20312 13.3262H10.3701C11.1016 13.3262 11.5391 12.9844 11.5391 12.417C11.5391 10.6533 9.33105 8.21973 5.7832 8.21973C2.24219 8.21973 0.0341797 10.6533 0.0341797 12.417C0.0341797 12.9844 0.47168 13.3262 1.20312 13.3262Z"})})},557876:(e,t,i)=>{i.d(t,{CR:()=>s,I2:()=>g,Lw:()=>d,tV:()=>m,tX:()=>u});i(267602),i(653476),i(241792),i(228244);var o=()=>i(513670),r=()=>i(696459),n=()=>i(446866),a=()=>i(703976);function s(e){let{space:t,domains:i,team:n,spaceUser:a,invitees:s,internalGuestFeatureAvailability:l,guestFeatureAvailability:u,publicPageDataGuestSetting:m}=e;const g=d({domains:i,internalGuestFeatureAvailability:l,guestFeatureAvailability:u,invitees:s,space:t,spaceUser:a,team:n,publicPageDataGuestSetting:m}),v=c({domains:i,internalGuestFeatureAvailability:l,guestFeatureAvailability:u,invitees:s,space:t,spaceUser:a,team:n,publicPageDataGuestSetting:m}),h=s.some((e=>{const t=v[e.email],i=g[e.email];return"can_autojoin"!==t.type&&p(i)}));return(0,o().Pe)(s.map((e=>{const{email:t,currentRole:i}=e,o=v[t],n=g[t];if("member"===i)return[t,{type:"member_page_add"}];if("guest"===i&&"can_add"===n.type)return[t,{type:"guest_page_add"}];if("can_autojoin"===o.type)return[t,{type:"member",reason:"autojoin_domain"}];if("cannot_add"===(a=g[t]).type&&"over_general_guest_limit"===a.reason)return[t,{type:"none",reason:"must_upgrade"}];if("can_add"===o.type&&h)return[t,{type:"member",reason:"over_internal_guest_limit"}];if("can_add"===n.type)return[t,{type:"guest"}];if("can_request"===n.type)return[t,{type:"guest_request"}];if("can_add"===o.type)return[t,{type:"member",reason:"guests_disabled"}];if("can_request"===o.type)return[t,{type:"member_request"}];if("cannot_add"===o.type&&"not_authorized_domain"===o.reason)return[t,{type:"none",reason:"not_authorized_domain"}];if("cannot_add"===n.type){return[t,{type:"none",reason:n.reason}]}if("cannot_add"===o.type){return[t,{type:"none",reason:o.reason}]}return(0,r().t1)(o)&&(0,r().t1)(n);var a})))}function d(e){let{space:t,domains:i,team:r,internalGuestFeatureAvailability:n,guestFeatureAvailability:s,optimism:d="pessimistic",spaceUser:c,invitees:m,publicPageDataGuestSetting:p}=e;const v=u({space:t,team:r,spaceUser:c,publicPageDataGuestSetting:p}),h=l(d,s,g(m)),f=function(e,t){return e.filter((e=>(0,a().is)(e.email,t)&&!e.currentRole)).length}(m,i),y=l(d,n,f);return(0,o().Pe)(m.map((e=>{const t=(0,a().is)(e.email,i),o=void 0!==e.currentRole;let r;return r=o||h?!t||o||y?"cannot_add"===v.type?{type:"cannot_add",reason:"disabled_by_admins"}:v:{type:"cannot_add",reason:"over_internal_guest_limit"}:{type:"cannot_add",reason:"over_general_guest_limit"},[e.email,r]})))}function l(e,t,i){const o=t.limit,r="unlimited"===o.total?"unlimited":o.total-o.current;return"optimistic"===e?"unlimited"===r||r>=1:"unlimited"===r||r>=i}function c(e){let{space:t,team:i,domains:a,spaceUser:s,invitees:l,internalGuestFeatureAvailability:c,guestFeatureAvailability:u,publicPageDataGuestSetting:g}=e;const v=m({space:t,domains:a,spaceUser:s}),h=d({space:t,domains:a,internalGuestFeatureAvailability:c,guestFeatureAvailability:u,team:i,spaceUser:s,invitees:l,publicPageDataGuestSetting:g}),f=!s.isMember();return(0,o().Pe)(l.map((e=>{const t=(0,n().Gd)(e.email);if(!t)return[e.email,{type:"cannot_add",reason:"invalid_email"}];const i=p(h[e.email]),o=v.autojoinDomains;let a;return o.includes(t)?a={type:"can_autojoin"}:"can_add"===v.type?a={type:"can_add"}:"can_request"===v.type||i&&!f?a={type:"can_request"}:o.length>0?a={type:"cannot_add",reason:"not_authorized_domain"}:"cannot_add"===v.type?a={type:"cannot_add",reason:"disabled_by_admins"}:(0,r().t1)(v),[e.email,a]})))}function u(e){let{space:t,team:i,spaceUser:o,publicPageDataGuestSetting:n}=e;const a=o.isWorkspaceOwner(),s=(0,r().$K)(n)?n:function(e){let t,i,{space:o,team:r}=e;t=r&&r.getDisableGuests()?"cannot_add":r&&!r.getDisableGuests()?"can_add":void 0;const n=o.disable_guests,a=o.getSettings().enable_guest_invite_requests;i=a?"can_request":n?"cannot_add":"can_add";return"can_request"===i?{type:"can_request"}:void 0!==t?{type:t}:{type:i}}({space:t,team:i});return a&&"can_request"===s.type?{type:"can_add"}:s}function m(e){let{space:t,domains:i,spaceUser:o}=e;const r=!o.isMember(),n=function(e){let{space:t,domains:i}=e;const o=i.filter((e=>e.isAutojoinable)).map((e=>e.url));return t.getSettings().disable_membership_requests?{type:"cannot_add",autojoinDomains:o}:{type:"can_request",autojoinDomains:o}}({space:t,domains:i});return r?{type:"cannot_add",autojoinDomains:[]}:o.isWorkspaceOwner()?{...n,type:"can_add"}:n}function g(e){return e.filter((e=>!e.currentRole)).length}function p(e){return"cannot_add"===e.type&&"over_internal_guest_limit"===e.reason}},703976:(e,t,i)=>{i.d(t,{TC:()=>a,dr:()=>r,is:()=>n});i(267602),i(470928);var o=()=>i(446866);function r(e,t){return!!e&&n(e.getEmail(),t)}function n(e,t){return void 0!==a(e,t)}function a(e,t){if(!e)return;const i=(0,o().Gd)(e);return t.find((e=>e.url===i))}}}]);