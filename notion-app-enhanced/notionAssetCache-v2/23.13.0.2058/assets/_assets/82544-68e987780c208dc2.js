"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[82544],{666357:(e,t,i)=>{i.d(t,{EK:()=>r,IM:()=>s,QZ:()=>a,_g:()=>o,x9:()=>l,yb:()=>c});var n=()=>i(594546);function o(e,t){const{name:i,...o}=t;n().K4(e,"click_link",{...o,click_name:i})}function a(e,t){n().K4(e,"scroll",t)}function s(e,t){n().K4(e,"customer_io_in_app_callout_show",t)}function r(e,t){n().K4(e,"customer_io_in_app_callout_suppress",t)}function l(e,t){n().K4(e,"customer_io_in_app_callout_dismiss",t)}function c(e,t){n().K4(e,"customer_io_in_app_callout_error",t)}},449660:(e,t,i)=>{function n(e){const{buttonsStore:t,buttonName:i,buttonState:n}=e;t.setState({buttons:{...t.state.buttons,[i]:n}})}i.d(t,{G:()=>n})},653274:(e,t,i)=>{i.d(t,{Z:()=>o});i(667294);var n=i(785893);const o=function(e){const{analyticsName:t}=e,o=(0,i(219727).O7)(),a=(0,i(142735).VK)((()=>(0,i(692912).z)(o,"maxWidth","large")),[o]);return(0,n.jsx)("div",{style:{flexShrink:0},children:(0,n.jsx)(i(108714).Z,{"aria-label":"Notion",href:"https://www.notion.com/product",onMouseDown:()=>i(666357)._g(o,{from:t,name:"notion_logo",href:i(836273)._j.product}),style:{cursor:"pointer",userSelect:"auto",WebkitUserSelect:"auto"},children:(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,i(968061).h)({width:a?28:30,height:a?28:30,marginRight:10,flexShrink:0}),!e.hideNotionText&&(0,n.jsx)("div",{style:{fontWeight:i(707513).Ue.medium,fontSize:16},children:"Notion"})]})})})}},692912:(e,t,i)=>{i.d(t,{z:()=>o});const n={small:600,medium:800,large:1020,giant:1380};function o(e,t,i){const{WindowSizeStore:o}=e,a="number"==typeof i?i:n[i];return"minWidth"===t?o.state.width>=a:o.state.width<=a}},81958:(e,t,i)=>{i.d(t,{Es:()=>Q,X_:()=>X,fZ:()=>C,aP:()=>V,mJ:()=>j,Qo:()=>Z,Pn:()=>K,YX:()=>G,OZ:()=>J,pK:()=>F,tR:()=>W,cX:()=>H,CA:()=>O,lm:()=>$});i(313429),i(398858),i(461318),i(33228);var n=()=>i(156603),o=()=>i(146947),a=()=>i(698422),s=()=>i(756280),r=()=>i(799891),l=()=>i(54193),c=()=>i(836273),d=()=>i(282017),g=()=>i(792409),u=()=>i(916673),m=()=>i(824462),p=()=>i(231077),f=()=>i(50219),v=()=>i(13382),h=()=>i(528918),w=()=>i(402269),y=()=>i(497065),S=()=>i(205228),b=()=>i(594546),k=()=>i(848643),M=(i(821057),()=>i(839002));const I="challengeHelpers";async function T(e,t,i,n){if(!t||!i.executeTurnstile)return;const o=performance.now();let a;try{const e=await(0,M().aM)(i.executeTurnstile(n),15e3);e.timeout?(r().log({level:"error",from:I,type:"turnstileExecutionTimeout"}),a=void 0):a=e.result}catch(s){r().log({level:"error",from:I,type:"turnstileExecutionError",error:(0,g().Ui)(s)}),a=void 0}return function(e,t){(0,b().K4)(e,"challenge_executed",t)}(e,{provider:"turnstile",action:n,is_success:void 0!==a,time_ms:performance.now()-o}),a}var P=()=>i(274879),_=()=>i(443269),N=()=>i(796093),L=()=>i(527278),A=()=>i(594723),U=()=>i(838266),x=()=>i(341691),E=()=>i(846441);const R=(0,i(788860).vU)({loggingInWithApple:{id:"loginActions.loggingInWithApple.loadingMessage",defaultMessage:"Logging in with Apple…"},loggingInWithGoogle:{id:"loginActions.loggingInWithGoogle.loadingMessage",defaultMessage:"Logging in with Google…"},loggingInWithMicrosoft:{id:"loginActions.loggingInWithMicrosoft.loadingMessage",defaultMessage:"Logging in with Microsoft…"},googleErrorMessage:{id:"loginActions.loggingInWithGoogle.errorMessage",defaultMessage:"Something went wrong while trying to log in with Google."},microsoftLoginNotSupported:{id:"loginActions.loggingInWithMicrosoft.notSupported",defaultMessage:"Logging in with Microsoft not supported."},titleMessageGooglePopup:{defaultMessage:"Google login",id:"loginActions.googleLoginPopupModal.title"},titleMessageMicrosoftPopup:{defaultMessage:"Microsoft login",id:"loginActions.microsoftLoginPopupModal.title"}});async function W(e){const{environment:t,loginStore:i,disableLoginLink:n,reverify:a,needsSendTemporaryPasswordReason:s,turnstileProps:r,onSendTemporaryPasswordSuccess:l,onSendTemporaryPasswordFailure:g}=e;await async function(e){const{environment:t,store:i,reverify:n,turnstileToken:a,loginOptionsToken:s,onSendTemporaryPasswordSuccess:r,onSendTemporaryPasswordFailure:l}=e,{RouterStore:g}=t,p=e.disableLoginLink||Boolean((0,d().mM)());E()._5(t);const{url:h}=v().Vr(t),w=A().S4(t),y=i.isMicrosoftLogin()||i.isMicrosoftVerification();let k={email:i.state.email,redirectURL:h,disableLoginLink:p,native:t.device.isNative,isSignup:"signup"===g.state.route.name,turnstileToken:a,shouldHidePasscode:w,loginOptionsToken:s,deviceId:await(0,P().getExperimentDeviceId)(t)};y&&(k={...k,thirdPartyToken:i.state.thirdPartyToken,microsoftEmailVerification:!0});const M=await m().callApi({eventName:"sendTemporaryPassword",environment:t,data:k});if("success"===M.type){const{csrfState:e}=M.data;if(y?i.setState({...i.state,loginType:"microsoft_verification",password:"",alert:void 0,hiddenPasscode:w,sentEmailPasscodeState:e}):i.setState({...i.state,loginType:n?"reverify":"temporary",password:"",sentEmailPasscodeState:e,alert:void 0,hiddenPasscode:w}),null==r||r(),function(e){let{environment:t,isMicrosoftLogin:i}=e;const n=t.device.isElectronAny;return n&&"en-US"===o().locale&&!i}({environment:t,isMicrosoftLogin:y})){const e=await(0,b().cG)(t),n=u().bf({url:`${S().default.domainBaseUrl}${c()._j.desktopEmailConfirm}`,query:{state:btoa(JSON.stringify({email:i.state.email,deviceId:e}))}});t.device.isElectronAny&&f().m(n)}}else{null==l||l();const e=(0,_().wf)(L().Z.getIntl(),M);i.setState({...i.state,loginType:"email",password:"",alert:e})}}({environment:t,store:i,disableLoginLink:n,reverify:a,needsSendTemporaryPasswordReason:s,turnstileToken:await T(t,"turnstile"===i.state.challengeProvider,r,"login_temporary_password"),loginOptionsToken:i.state.loginOptionsToken,onSendTemporaryPasswordSuccess:l,onSendTemporaryPasswordFailure:g})}async function C(e){const{environment:t,email:i,password:n,redirectURL:o,turnstileProps:a,loginStore:s}=e,r=await(0,N().loadCurrentUserId)(t),l=x().buildHeadersForLoginWithEmail(i),c=await m().callApi({eventName:"loginWithEmail",environment:t,data:{email:i,password:n,turnstileToken:await T(t,"turnstile"===s.state.challengeProvider,a,"login_password"),loginOptionsToken:s.state.loginOptionsToken},headers:l});if("success"!==c.type){await x().handleLoginFailureIfSamlRequired(t,c),function(e,t){var i;"login_options_invalid"===(null===(i=t.body.clientData)||void 0===i?void 0:i.type)&&e.setState({...e.state,loginType:"email",password:""})}(s,c);return(0,_().wf)(L().Z.getIntl(),c)}{const e=c.data.enabledMfaSettings??[],{userId:i}=c.data;e.length>0?x().handleLoginWithMfa({environment:t,isNewSignup:!1,userId:i,redirectURL:o,previousPersistedUserId:r,loginMethod:"password",mfaSettings:e,loginStore:s}):await x().handleLoginSuccess({environment:t,isNewSignup:!1,userId:i,redirectURL:o,previousPersistedUserId:r,loginMethod:"password"})}}async function O(e){const{environment:t,store:i}=e,n=await m().callApi({eventName:"sendTemporaryPassword",environment:t,data:{passwordReset:!0,email:i.state.email,native:t.device.isNative,loginOptionsToken:i.state.loginOptionsToken}});if("success"===n.type){const{csrfState:e}=n.data;i.setState({...i.state,loginType:"reset",password:"",sentPasswordResetState:e,alert:void 0})}else{const e=(0,_().wf)(L().Z.getIntl(),n);i.setState({...i.state,password:"",alert:e})}}async function j(e){const{environment:t,store:i}=e,{mobileNative:n}=t,o=await(0,N().loadCurrentUserId)(t);if(E().z_(t),n&&n.hasNativeAppleLogin())return void(await async function(e){const{environment:t,store:i,previousPersistedUserId:n}=e,{mobileNative:o}=t;if(!o)return;const a=await o.requestNativeAppleAuth();if(!a)return;if(a.error)r().log({level:"error",from:"loginActions",type:"requestNativeAppleAuth",error:(0,g().Ui)(a.error)});else{h().j({message:R.loggingInWithApple});const{code:e,nonce:o,firstName:s,lastName:r}=a.value,l=await m().callApi({eventName:"loginWithAppleNativeAuth",environment:t,data:{code:e,nonce:o,firstName:s,lastName:r}});if("success"===l.type){const{isNewSignup:e,userId:i}=l.data;await x().handleLoginSuccess({environment:t,isNewSignup:e,userId:i,previousPersistedUserId:n,loginMethod:"login-with-apple"}),h().x()}else{await x().handleLoginFailureIfSamlRequired(t,l);const e=(0,_().wf)(L().Z.getIntl(),l);i.setState({...i.state,alert:e}),h().x()}}}({environment:t,store:i,previousPersistedUserId:o}));const a=(0,k().IJ)(t);let s=l().MQ(S().default.domainBaseUrl,{authType:a});s=a.redirectToAuth?s:await(0,k().HU)(t,s),t.mobileNative?x().openBrowserInMobileNative(t,s):t.device.isElectronAny?f().m(s):window.location.href=s}const B=L().Z.formatMessage(R.microsoftLoginNotSupported);async function G(e){const{environment:t,store:i}=e,n=A().qr()||A().qh()?(0,d().cr)():void 0;E().ag(t);const o=(0,k().eC)(t);let a=l().iR(S().default.domainBaseUrl,{authType:o,source:n});if(a=o.redirectToAuth?a:await(0,k().HU)(t,a),t.mobileNative)x().openBrowserInMobileNative(t,a);else if("redirect"===o.callbackType)window.location.href=a;else if(t.device.isElectron)p().openExternalUrl(a);else if(t.device.isElectronMail||t.device.isElectronCalendar)r().log({level:"warning",from:"loginActions",type:"requestLoginWithMicrosoft",error:(0,g().Ui)("Unsupported login attempted via other desktop app.")}),i.setState({...i.state,alert:B}),h().x();else{const e=await w().M(t,{width:610,height:700,url:a,titleMessage:R.titleMessageMicrosoftPopup});if(!e)return;const i=u().K5({url:u().T1(e),pathname:c()._j.microsoftAuthCallback});y().c4({environment:t,url:i})}}const q=L().Z.formatMessage(R.googleErrorMessage);async function K(e){const{environment:t,store:i,email:n,permissionsStore:o}=e,{mobileNative:a}=t,s=await(0,N().loadCurrentUserId)(t);E().Be(t);const p=a&&a.hasNativeGoogleLogin()?()=>a.requestGoogleJwt():void 0;if(p){const e=await p();if(e){if(e.error)return void r().log({level:"error",from:"loginActions",type:"requestGoogleJwt",error:(0,g().Ui)(e.error)});{h().j({message:R.loggingInWithGoogle});const{idToken:n}=e.value,{device:o}=t;let a;o.isElectronMail?a="nativemailredirect":o.isElectron?a="nativeredirect":o.isNative&&(a="native");const r=await m().callApi({eventName:"loginWithGoogleJwt",environment:t,data:{idToken:n,callbackType:a}});if("success"===r.type){const{isNewSignup:e,userId:i}=r.data;await x().handleLoginSuccess({environment:t,isNewSignup:e,userId:i,previousPersistedUserId:s,loginMethod:"login-with-google"}),h().x()}else await x().handleLoginFailureIfSamlRequired(t,r),i.setState({...i.state,alert:q}),h().x()}return}}const v=A().qr()||A().qh()?(0,d().cr)():void 0,b=(0,k().eC)(t);let M=l().OB(S().default.domainBaseUrl,{email:n,contacts:o.state.contacts,authType:b,source:v});if(M=b.redirectToAuth?M:await(0,k().HU)(t,M,!!(t.mobileNative&&S().default.domainBaseUrl.indexOf("localhost")>=0)),t.mobileNative)x().openBrowserInMobileNative(t,M);else if("redirect"===b.callbackType)window.location.href=M;else if(t.device.isElectronAny)f().m(M);else{const e=await w().M(t,{width:610,height:700,url:M,titleMessage:R.titleMessageGooglePopup});if(!e)return;const i=u().K5({url:u().T1(e),pathname:c()._j.googleAuthCallback});y().c4({environment:t,url:i})}}async function Z(e){const{loginStore:t,environment:i}=e;if(!t.isEmail())return;const{email:n}=t.state,o=await m().callApi({eventName:"getLoginOptions",environment:i,data:{email:n}});if("failed"===o.type){const e=(0,_().wf)(L().Z.getIntl(),o);return t.setState({...t.state,loginType:"email",alert:e}),void function(e,t){(0,b().K4)(e,"login_invalid_email_submitted",{invalidEmail:t})}(i,n)}const s=o.data;if("required"===s.samlSignIn)return await x().showSamlRedirectMessage(2e3),t.setState({...t.state,loginType:"saml",alert:"Redirecting you to use SAML SSO"}),void F({environment:i,loginStore:t});(0,a().k3)({device:i.device,email:n,cookieService:i.cookieService}),t.setState({...t.state,loginOptionsToken:s.loginOptionsToken,challengeProvider:s.challengeProvider}),s.hasAccount?s.mustReverify?t.setState({...t.state,needsSendTemporaryPasswordReason:"reverify"}):s.passwordSignIn?t.setState({...t.state,loginType:"password",alert:void 0}):t.setState({...t.state,needsSendTemporaryPasswordReason:"login_no_password"}):t.setState({...t.state,needsSendTemporaryPasswordReason:"signup"})}async function F(e){const{environment:t,loginStore:i}=e,{device:n}=t;if(!i.isSaml())return;const{email:o}=i.state,a=L().Z.getIntl();if(!o&&!i.state.forceAdminSamlLogin)return;let r;n.isElectronMail?r="nativemailredirect":n.isElectronCalendar?r="nativecalendarredirect":n.isElectron||(0,k().Q7)(t)?r="nativeredirect":n.isNative&&(r="native");const l=await m().callApi({eventName:"getSamlRedirect",environment:t,data:{email:o,callbackType:r}});if("failed"===l.type)return void i.setState({...i.state,alert:(0,_().wf)(a,l)});i.setState({...i.state,alert:void 0});const c=l.data.redirectUrl;if(c){const e=(0,s().LC)();if(e){const i=new URL(c);i.searchParams.set(s().J6,e),x().redirectToSaml(t,i.toString())}else x().redirectToSaml(t,c)}}function V(e){const t={callbackType:(0,k().eC)(e).callbackType},i=u().bf({url:`${S().default.domainBaseUrl}${c()._j.passkeyAuthVerify}`,query:t});p().openExternalUrl(i)}async function H(e,t){const i=await z(e);if(!i)return;const{attestation:n,attemptId:o}=i,a=u().SK(c()._j.passkeyAuthCallback,{attestation:JSON.stringify(n),attemptId:o});"nativemailredirect"===t?y().c4({environment:e,url:`/nativemail${a}`}):"nativecalendarredirect"===t?y().c4({environment:e,url:`/nativecalendar${a}`}):y().c4({environment:e,url:`/native${a}`})}async function z(e){const t=await m().callApi({eventName:"authPasskeyGenerateChallenge",environment:e,data:{}});if("success"!==t.type)return;let i;try{i=await(0,n().oz)(t.data.options,!1)}catch(o){return}return{attestation:i,attemptId:t.data.attemptId}}async function J(e){const{environment:t,showInvitationVersion:i}=e,n=await z(t);if(!n)return!1;const{attestation:o,attemptId:a}=n;return await x().loginUserWithPasskeyVerifyChallenge({environment:t,attestation:o,attemptId:a,showInvitationVersion:i})}async function $(e){const{environment:t,state:i,password:n}=e,o=await m().callApi({eventName:"verifyEmail",environment:t,data:{state:i,password:n}});if("success"!==o.type){return(0,_().wf)(L().Z.getIntl(),o)}}async function Q(e){const{environment:t,redirectURL:i,previousPersistedUserId:n,userId:o,regenerateBackupCodes:a}=e;await x().handleLoginSuccess({environment:t,isNewSignup:!1,userId:o,redirectURL:i,previousPersistedUserId:n,loginMethod:"password-mfa"}),a&&U().default.setState({open:!0,openedFrom:"login",currentTab:"profile",defaultSubtab:void 0,highlightedSetting:void 0})}function X(e){e.reset()}},599593:(e,t,i)=>{i.d(t,{b:()=>r});i(667294);var n=()=>i(846550),o=()=>i(707513),a=()=>i(154186),s=i(785893);function r(e){let{onClick:t,getLabel:i,id:r,iconFn:l,iconStyles:c,isLoading:d,themeOverride:g,isSmallScreen:u}=e;const m=(0,n().yK)((e=>{const t=g??e;return{base:{position:"relative",display:"inline-flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",height:36,borderRadius:6,color:t.text.primary,fill:t.text.primary,background:"none",fontSize:14,lineHeight:1,paddingLeft:12,paddingRight:12,fontWeight:o().Ue.medium,border:`1px solid ${t.stroke.primary}`,width:"100%",boxShadow:"none",marginTop:"8px",...u&&{height:48,borderRadius:12,fontSize:16,marginTop:10,fontWeight:o().Ue.semibold},...d&&{display:"grid",gridTemplateColumns:"1fr auto 1fr"}},hovered:{background:t.buttonHoveredBackground}}}),[u,g,d]);return(0,s.jsx)(a().Z,{id:r,onClick:t,style:m.base,hoveredStyle:m.hovered,isLoading:d,loadingSpinnerStyle:{marginLeft:"auto"},children:(0,s.jsxs)("div",{style:{display:"flex",textAlign:"center",justifyContent:"center",alignItems:"center"},children:[" ",null==l?void 0:l(c??{width:u?28:20,height:u?28:20,marginRight:u?0:2}),i()]})})}},601615:(e,t,i)=>{i.d(t,{v:()=>m});i(667294);var n=()=>i(219727),o=()=>i(142735),a=()=>i(108450),s=()=>i(788860),r=()=>i(449660),l=()=>i(661641),c=()=>i(620218),d=()=>i(81958),g=()=>i(599593),u=i(785893);function m(e){const{loginStore:t,buttonsStore:i,showInvitationVersion:m,isMobile:p,themeOverride:f,isSmallScreen:v,callbackType:h}=e,w=(0,n().Fy)(),y=(0,n().O7)(),S=(0,s().YB)(),b=(0,o().VK)((()=>"loading"===(null==i?void 0:i.state.buttons.loginWithPasskeyButton)),[i]),k=(0,o().VK)((()=>(null==t?void 0:t.state.forceAdminSamlLogin)??!1),[t]),M=(0,s().vU)({message:{id:"passkey.genericError",defaultMessage:"Something went wrong; please try another sign-in option or follow the instructions on your device for passkeys"}}),I=S.formatMessage(M.message);return w.isBannedGoogleSSOUserAgent||k?null:(0,u.jsx)("div",{style:{width:"100%"},children:(0,u.jsx)(g().b,{onClick:async()=>{if(r().G({buttonsStore:i,buttonName:"loginWithPasskeyButton",buttonState:"loading"}),w.isElectron||w.isElectronMail||w.isElectronCalendar)d().aP(y);else{if(h)return void(await d().cX(y,h));c().default.mark("login_time.passkey");"boolean"==typeof(await d().OZ({environment:y,showInvitationVersion:m,isMobile:p}))&&(null==t||t.setState({...null==t?void 0:t.state,alert:I}))}r().G({buttonsStore:i,buttonName:"loginWithPasskeyButton",buttonState:"idle"})},iconFn:a().r,iconStyles:{width:v?20:16,height:v?20:16,position:"absolute",left:10},getLabel:()=>m?(0,u.jsx)(l().q,{styleName:"UIRegular-14px/Medium",children:(0,u.jsx)(s()._H,{id:"loginForm.verifyWithPasskeyButton.label",defaultMessage:"Verify with Passkey"})}):(0,u.jsx)(l().q,{styleName:"UIRegular-14px/Medium",children:(0,u.jsx)(s()._H,{id:"loginForm.loginWithPasskeyButton.label",defaultMessage:"Log in with passkey"})}),isLoading:b,themeOverride:f,isSmallScreen:v})})}},510795:(e,t,i)=>{i.d(t,{Z:()=>o});class n extends(()=>i(263184))().default{getInitialState(){return{buttons:{}}}}const o=n}}]);