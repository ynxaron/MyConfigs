"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[12351],{787738:(e,t,s)=>{s.d(t,{K:()=>o});var r=()=>s(594546);function o(e,t){const{spaceId:s,pageId:o,joinSpaceMethod:a}=t;(0,r().j)({environment:e,event:{eventName:"trusted_domain_banner_cta_clicked",eventProperties:{spaceId:s,pageId:o,joinSpaceMethod:a}}})}},184495:(e,t,s)=>{s.d(t,{Z:()=>B});var r=s(667294),o=()=>s(219727),a=()=>s(142735),c=()=>s(263184),n=()=>s(788860),i=()=>s(568017),l=()=>s(696459),d=()=>s(707513),u=()=>s(438793),p=()=>s(912732),m=()=>s(787738),g=()=>s(824462),f=()=>s(443269),b=()=>s(352230),y=()=>s(876822),v=()=>s(697623),q=()=>s(154439),_=()=>s(206352),x=()=>s(291198),h=()=>s(198829),C=()=>s(661297),I=()=>s(906651),k=s(785893);const j={marginBottom:10},A={...j,width:"100%",height:"100%",padding:10,alignItems:"top",borderRadius:0},w=(0,n().vU)({requestAccessMessagePlaceholder:{defaultMessage:"Message (optional)",id:"requestAccessForm.messageInput.placeholder"},rateLimitError:{defaultMessage:"You have recently requested access to this page.",id:"requestAccessForm.errorMessage.rateLimit"},currentUserNotFound:{defaultMessage:"Current user not found.",id:"requestAccessForm.errorMessage.currentUserNotFound"}});function M(){return(0,k.jsx)(n()._H,{defaultMessage:"Cancel",id:"requestAccessForm.cancelButton.label"})}const S=c().default.createClass(0,{name:"RequestAttemptStore"}),Z=c().default.createClass(void 0,{name:"MessageStore"});const B=function(e){const t=(0,o().O7)(),c=(0,o().MO)(),i=(0,a().qz)(void 0,s(529048).Z),l=(0,a().qz)(void 0,Z),p=(0,a().qz)(void 0,S),g=(0,r.useCallback)((()=>U(i)),[i]),f=(0,r.useCallback)((()=>(0,k.jsx)(F,{...e,requestAttemptStore:p,messageStore:l,buttonPopupStore:i})),[e,p,l,i]),b=(0,a().VK)((()=>p.state>0),[p]),y=(0,a().VK)((()=>i.state.open),[i]);if("current-actor-to-block"===e.type)return(0,k.jsx)(P,{type:"page",block:e.block,flowId:e.flowId,buttonType:e.buttonType});if("current-actor-to-collection"===e.type)return(0,k.jsx)(P,{type:"collection",collection:e.collection,flowId:e.flowId,buttonType:e.buttonType});const v="primary"===e.buttonType?I().Z:C().Z;return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(v,{isLarge:!0,disabled:b,onClick:()=>{var s,r;return function(e,t){const{environment:s,flowId:r,type:o,source:a,spaceId:c,pageId:n}=e;"trusted_domain_page"===a&&c&&m().K(s,{spaceId:c,pageId:n,joinSpaceMethod:"request_to_join"});"current-actor-to-block"===o?u().zX(s,{button_name:"request-access",flow_id:r,request_access_type:"page"}):"current-actor-to-space-via-team"===o&&u().zX(s,{button_name:"request-access",flow_id:r,request_access_type:"team"});t.setState({open:!0})}({environment:t,flowId:e.flowId,type:e.type,source:e.source,pageId:null===(s=e.block)||void 0===s?void 0:s.id,spaceId:null===(r=e.block)||void 0===r?void 0:r.spaceId},i)},style:"outline"===e.buttonType?{fontWeight:d().Ue.semibold}:{},children:b?(0,k.jsx)(n()._H,{id:"fullPageError.requestAccessButton.requested",defaultMessage:"Requested access"}):N(e.type)}),c?(0,k.jsx)(s(967092).ZP,{popupType:s(104088).k.SlideUp,open:y,render:f}):(0,k.jsx)(s(708518).Z,{open:y,onDismiss:g,render:f})]})};function R(e){let{result:t}=e;return t&&t.error?(0,k.jsx)("div",{style:{color:i().ZP.redWithAlpha(1),textAlign:"center",width:"100%",marginBottom:16},children:t.error}):null}function T(e){e.update((e=>e+1))}function U(e){return e.setState({open:!1})}function L(e){let{error:t,result:s,ready:c,requestAttemptStore:i,messageStore:l,type:u}=e;const p=(0,n().YB)(),m=(0,o().MO)(),g=(0,r.useCallback)((()=>T(i)),[i]),f=(0,r.useCallback)((e=>function(e,t){t.setState(e.target.value)}(e,l)),[l]),b=(0,a().VK)((()=>Boolean(0===i.state||c&&s&&s.error)),[i,c,s]),y=(0,a().VK)((()=>l.state||""),[l]);return(0,k.jsxs)(k.Fragment,{children:[!m&&(0,k.jsx)("div",{style:{fontSize:16,fontWeight:d().Ue.semibold,marginBottom:16},children:N(u)}),(0,k.jsx)(x().Z,{format:m?x().B.Transparent:void 0,textarea:!0,value:y,onChange:f,disabled:!b,placeholder:p.formatMessage(w.requestAccessMessagePlaceholder),style:{...m?{...A,padding:"16px"}:{...j,marginBottom:16,padding:"8px 12px",alignItems:"flex-start"}}}),!m&&(0,k.jsx)(I().Z,{isLarge:!0,disabled:!b,onClick:g,style:j,children:(0,k.jsx)(n()._H,{defaultMessage:"Send request",id:"requestAccessForm.sendRequestButton.label"})}),(0,k.jsx)(R,{result:s})]})}function F(e){const{requestAttemptStore:t,messageStore:s,buttonPopupStore:c}=e,i=(0,o().O7)(),d=(0,o().MO)(),u=(0,n().YB)(),m=(0,r.useCallback)(((r,o,a)=>(0,k.jsx)(L,{requestAttemptStore:t,messageStore:s,error:r,result:o,ready:a,type:e.type})),[t,s,e.type]),v=(0,a().VK)((()=>{var e;return null===(e=y().default.state.currentUserStore)||void 0===e?void 0:e.id}),[]),x=(0,r.useCallback)((t=>async function(e){const{messageStore:t,buttonPopupStore:s,type:r,teamId:o,requestAttempt:a,environment:c,currentUserId:n,intl:i,flowId:d}=e;if(0===a)return;const u=t.state,m=await async function(){if("current-actor-to-block"===r)return g().callApi({eventName:"requestAccess",environment:c,data:{type:"current-actor-to-block",block:e.block,message:u}});if("current-actor-to-collection"===r)return g().callApi({eventName:"requestAccess",environment:c,data:{type:"current-actor-to-collection",collection:e.collection,message:u}});if("current-actor-to-space-via-team"===r)return g().callApi({eventName:"requestAccess",environment:c,data:{type:"current-actor-to-space-via-team",teamId:o,message:u}});if("current-actor-to-space-via-block"===r){if(!n)return;return g().callApi({eventName:"requestAccess",environment:c,data:{type:"actor-to-space",spaceId:e.block.spaceId,message:u,forActorId:n,attributes:{add_permissions_on_approval:!1,origin_type:"trusted_domain_page"}}})}}();return m?"success"!==m.type?"UserRateLimitResponse"===(null===(b=m.body)||void 0===b?void 0:b.name)?{error:i.formatMessage(w.rateLimitError)}:{error:(0,f().wf)(i,m)}:("current-actor-to-block"===r?p().dU(c,{request_access_type:"page",flow_id:d,requestId:m.data.requestId}):"current-actor-to-space-via-team"===r?p().dU(c,{request_access_type:"team",flow_id:d}):"current-actor-to-space-via-block"===r?p().dU(c,{request_access_type:"space",flow_id:d,source:"trusted_domain_page"}):"current-actor-to-collection"===r?p().dU(c,{request_access_type:"collection",flow_id:d,requestId:m.data.requestId}):(0,l().t1)(r),s.reset(),{value:!0}):{error:i.formatMessage(w.currentUserNotFound)};var b}({...e,requestAttempt:t,environment:i,intl:u,currentUserId:v})),[i,u,e,v]),I=(0,r.useCallback)((()=>T(t)),[t]),j=(0,r.useCallback)((()=>U(c)),[c]),A=(0,a().Kw)(t);return d?(0,k.jsx)(h().Z,{menuType:b().o.Modal,whiteBackground:!0,title:N(e.type),left:M(),onClickLeft:j,right:(0,k.jsx)(n()._H,{id:"requestAccessForm.mobileSend.label",defaultMessage:"Send"}),onClickRight:I,children:(0,k.jsx)(_().Z,{debugName:"RequestAccessForm",capture:!0,children:(0,k.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"stretch",alignItems:"stretch",width:"100%",height:"100%"},children:(0,k.jsx)(q().Z,{request:A,performRequest:x,render:m})})})}):(0,k.jsx)(_().Z,{debugName:"RequestAccessForm",capture:!0,children:(0,k.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-evently",alignItems:"stretch",padding:"20px 28px 24px",width:"340px"},children:[(0,k.jsx)(q().Z,{request:A,performRequest:x,render:m}),(0,k.jsx)(C().Z,{onClick:j,children:M()})]})})}function P(e){const{type:t,flowId:s,buttonType:c}=e,i=(0,o().O7)(),d="outline"===c?C().Z:I().Z,[u,m]=(0,r.useState)(!1),[f,b]=(0,r.useState)(!1),y={attributes:{add_permissions_on_approval:!1,role:(0,a().VK)((()=>(0,v().QM)()),[])?"reader":"read_and_write"},message:void 0};let q;"page"===t?q={...y,type:"current-actor-to-block",block:{id:e.block.id,spaceId:e.block.spaceId}}:"collection"===t?q={...y,type:"current-actor-to-collection",collection:{id:e.collection.id,spaceId:e.collection.spaceId}}:(0,l().t1)(t);const _=(0,r.useCallback)((async()=>{var e;const r=await g().callApi({eventName:"requestAccess",environment:i,data:q});"success"===r.type&&r.data.request?(m(!0),p().dU(i,{request_access_type:t,previous_access_level:"none",requested_access_level:"read_and_write",flow_id:s,requestId:r.data.requestId})):"failed"===r.type&&"UserRateLimitResponse"===(null===(e=r.body)||void 0===e?void 0:e.name)&&b(!0)}),[i,q,t,s]);return(0,k.jsx)(d,{isLarge:!0,disabled:u||f,disabledFeedback:u||f,onClick:_,children:u?(0,k.jsx)(n()._H,{id:"fullPageError.requestAccessButton.edit.Requested",defaultMessage:"Requested access"}):f?(0,k.jsx)(n()._H,{id:"fullPageError.requestAccessButton.edit.TryAgain",defaultMessage:"Try again later"}):N("page"===t?"current-actor-to-block":"current-actor-to-collection")})}function N(e){return"current-actor-to-space-via-block"===e?(0,k.jsx)(n()._H,{defaultMessage:"Request membership",id:"requestAccessForm.requestAccessToSpaceButton.title"}):(0,k.jsx)(n()._H,{defaultMessage:"Request access",id:"requestAccessForm.requestAccessButton.title"})}},212351:(e,t,s)=>{s.d(t,{Z:()=>c});s(667294);var r=()=>s(342792),o=()=>s(184495),a=s(785893);const c=function(e){let{targetStore:t,title:c,description:n,hasBorder:i=!1,buttonType:l="outline"}=e;const d=(0,s(142735).VK)((()=>t&&t.getSpaceId()),[t]),u=(0,s(846550).yK)((e=>({requestAccessContainer:{boxShadow:i?e.shadow2XS:void 0,borderRadius:4,padding:32}})),[i]);return(0,a.jsx)("div",{style:u.requestAccessContainer,children:(0,a.jsx)(s(552064).Z,{icon:s(81739).C,title:c,description:n,cta:t instanceof s(826955).NW?(0,a.jsx)(o().Z,{flowId:(0,r().ZP)(),type:"current-actor-to-collection",collection:{spaceId:d,id:t.id},buttonType:l}):(0,a.jsx)(o().Z,{flowId:(0,r().ZP)(),type:"current-actor-to-block",block:{spaceId:d,id:t.id},buttonType:l})})})}},81739:(e,t,s)=>{s.d(t,{C:()=>o});s(667294);var r=s(785893);const o=(0,s(827282).IU)("eyeHide",{viewBox:"0 0 16 12",svg:(0,r.jsx)("path",{d:"M12.2754 10.9346L3.08545 1.76074C2.91895 1.59424 2.91895 1.3042 3.08545 1.1377C3.25732 0.96582 3.53662 0.971191 3.7085 1.1377L12.8931 10.3169C13.0649 10.4888 13.0703 10.752 12.8931 10.9346C12.7212 11.1172 12.4473 11.1064 12.2754 10.9346ZM8 1.44922C12.4526 1.44922 15.4067 5.02637 15.4067 6.13281C15.4067 6.76123 14.4346 8.20605 12.7588 9.31787L11.8618 8.41553C13.167 7.58301 13.978 6.54102 13.978 6.13281C13.978 5.50977 11.3516 2.62012 8 2.62012C7.43066 2.62012 6.9043 2.70068 6.39404 2.84033L5.42188 1.86816C6.21143 1.61035 7.06006 1.44922 8 1.44922ZM8 10.811C3.60645 10.811 0.587891 7.22852 0.587891 6.13281C0.587891 5.48828 1.6084 4.0166 3.33789 2.89404L4.25635 3.8125C2.87598 4.67725 2.0166 5.77832 2.0166 6.13281C2.0166 6.87402 4.64307 9.64014 8 9.64014C8.6123 9.64014 9.18701 9.54883 9.73486 9.39307L10.707 10.3652C9.88525 10.6445 8.98291 10.811 8 10.811ZM10.6211 7.06201L7.06543 3.50635C7.35547 3.38818 7.66699 3.32373 8 3.32373C9.55762 3.32373 10.8145 4.56445 10.8145 6.12744C10.8145 6.45508 10.7446 6.77734 10.6211 7.06201ZM8 8.93652C6.43164 8.93652 5.18555 7.6582 5.18018 6.13281C5.18018 5.75146 5.26074 5.39697 5.41113 5.08008L9.04199 8.70557C8.7251 8.85059 8.37598 8.93652 8 8.93652Z"})})}}]);