"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[21668],{66036:(t,e,n)=>{n.r(e),n.d(e,{CollectionMapView:()=>g});n(267602),n(653476),n(241792),n(731107);var o=()=>n(943027),i=n.n(n(124613)),l=n(667294),r=()=>n(142735),u=()=>n(442884),d=()=>n(25594),c=()=>n(662753),s=()=>n(826955),a=()=>n(164809),p=n(785893);function g(t){const{collectionContextStore:e,query:n,paddingLeft:g,paddingRight:h}=t,f=(0,l.useRef)(null),b=(0,c().Z)({id:"map_results",reducer:{type:"results",limit:100},collectionContextStore:e}),m=(0,r().VK)((()=>{var t;const o=null==n?void 0:n.map_by,i=e.collectionViewBlockStore();if(!i)return[];const l=(null==b||null===(t=b.blockIds)||void 0===t?void 0:t.map((t=>s().G.createChildStore(i,{table:"block",id:t}))))??[];return o?l.map((t=>{const e=t.getProperties()[o],n=t.getProperties().title;return{geoPoint:(0,u().X)(e),title:n,blockStore:t,url:(0,d().Vf)(t)}})).filter((t=>Boolean(t.geoPoint))):[]}),[e,null==b?void 0:b.blockIds,null==n?void 0:n.map_by]);return(0,l.useEffect)((()=>{const t=m.map((t=>t.geoPoint)).reduce((function(t,e){return e?t.extend(e):t}),new(i().LngLatBounds));var e;t.isEmpty()||(null===(e=f.current)||void 0===e||e.getMap().fitBounds(t))})),(0,p.jsx)("div",{style:{paddingLeft:g,paddingRight:h,height:"100%"},children:(0,p.jsx)(o().D5,{ref:f,initialViewState:{longitude:-100,latitude:40,zoom:3.5},mapStyle:"https://demotiles.maplibre.org/style.json",children:m.map((t=>{let{geoPoint:e,title:n,url:i}=t;return(0,p.jsx)(o().Jx,{longitude:e.lon,latitude:e.lat,anchor:"bottom",children:(0,p.jsx)("div",{style:{backgroundColor:"white",borderRadius:"4px"},children:(0,p.jsx)(a().Z,{href:i,children:n})})},null==n?void 0:n.toString())}))})})}},442884:(t,e,n)=>{n.d(e,{B:()=>l,X:()=>i});var o=()=>n(955620);function i(t){if(!t)return;const e=o().lzi(t),n=o().hDy(e[0])[0];if(!n||!o().kf_(n))return;const i=n[1];return{lat:i.lat,lon:i.lon}}function l(t){if(!t)return[];const e=o().YOw(t);return[o().YCD(e)]}}}]);