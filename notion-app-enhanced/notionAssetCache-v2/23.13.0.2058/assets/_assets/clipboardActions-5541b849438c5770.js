"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[81480,39447,14705],{379622:(e,t,o)=>{o.r(t),o.d(t,{clipboardMessages:()=>Bt,copy:()=>po,copyDirectLinkToContent:()=>Oo,copyFormattedLinkToBlock:()=>Lo,copyHtml:()=>Wo,copyLinkToBlock:()=>Go,copyLinksToBlocks:()=>No,copyString:()=>Zo,copyWithToast:()=>Ko,createSelectedMultiColumnBlockSubtree:()=>no,cutWithMaybeConfirmation:()=>uo,getFormulaEditorInformation:()=>Fo,getInlineTextValueFromClipboardData:()=>Qo,getInlineTitleValueFromClipboardTextHtml:()=>So,getNotionSelectionClipboardData:()=>eo,htmlToMultiTextSelectionClipboardData:()=>ho,insertOrTransformToCodeBlock:()=>Ao,markdownToBlocks:()=>$o,multiTextSelectionToMarkdown:()=>jo,paste:()=>Vo,pasteFilesForBlocks:()=>mo,pasteMarkdown:()=>vo,serializeMultiTextSelectionToClipboardData:()=>ao,serializePagePropertiesAsText:()=>ro,triggerBrowserCopy:()=>Yo});var n={};o.r(n),o.d(n,{clipboardMessages:()=>Bt,copy:()=>po,copyDirectLinkToContent:()=>Oo,copyFormattedLinkToBlock:()=>Lo,copyHtml:()=>Wo,copyLinkToBlock:()=>Go,copyLinksToBlocks:()=>No,copyString:()=>Zo,copyWithToast:()=>Ko,createSelectedMultiColumnBlockSubtree:()=>no,cutWithMaybeConfirmation:()=>uo,getFormulaEditorInformation:()=>Fo,getInlineTextValueFromClipboardData:()=>Qo,getInlineTitleValueFromClipboardTextHtml:()=>So,getNotionSelectionClipboardData:()=>eo,htmlToMultiTextSelectionClipboardData:()=>ho,insertOrTransformToCodeBlock:()=>Ao,markdownToBlocks:()=>$o,multiTextSelectionToMarkdown:()=>jo,paste:()=>Vo,pasteFilesForBlocks:()=>mo,pasteMarkdown:()=>vo,serializeMultiTextSelectionToClipboardData:()=>ao,serializePagePropertiesAsText:()=>ro,triggerBrowserCopy:()=>Yo});o(670560),o(122556),o(582845),o(250570),o(533019),o(721473),o(788208),o(22624),o(267602),o(916054),o(653476),o(749411),o(30005),o(241792),o(731107),o(228244);var r=o.n(o(827856)),i=()=>o(66077),a=()=>o(492788),s=()=>o(816512),l=()=>o(506347),c=()=>o(156642),d=()=>o(226413),u=()=>o(135857),p=()=>o(455530),m=()=>o(659278),f=()=>o(922785),g=()=>o(374847),b=()=>o(569427),k=()=>o(225339),v=()=>o(329866),y=()=>o(177634),h=()=>o(799891),S=()=>o(942275),T=()=>o(998411),x=()=>o(459422),C=()=>o(956057),M=()=>o(526839),I=()=>o(321160),w=()=>o(225771),_=()=>o(665553),F=()=>o(530980),R=()=>o(481529),D=()=>o(396035),P=()=>o(981850),B=()=>o(217465),V=()=>o(827370),A=()=>o(375255),U=()=>o(54193),E=()=>o(396136),G=()=>o(752778),L=()=>o(602299),N=()=>o(81954),O=()=>o(245015),W=()=>o(955620),Z=()=>o(386616),H=()=>o(463212),Y=()=>o(727207),K=()=>o(426546),j=()=>o(96642),$=()=>o(788860),Q=()=>o(568017),z=()=>o(513670),J=()=>o(342792),q=()=>o(543172),X=()=>o(696459),ee=()=>o(916673),te=()=>o(406799),oe=()=>o(523709),ne=()=>o(324877),re=()=>o(673385),ie=()=>o(539410),ae=()=>o(205228),se=()=>o(718048),le=()=>o(872308),ce=()=>o(630903),de=()=>o(338530),ue=()=>o(718959),pe=()=>o(921995),me=()=>o(615676),fe=()=>o(845111),ge=()=>o(429725),be=()=>o(487270),ke=()=>o(123927),ve=()=>o(527278),ye=()=>o(191003),he=()=>o(271308),Se=()=>o(852465),Te=()=>o(339523),xe=()=>o(924390),Ce=()=>o(505462),Me=()=>o(550054),Ie=()=>o(10208),we=()=>o(472753),_e=()=>o(156538),Fe=()=>o(156958),Re=()=>o(881688),De=()=>o(663132),Pe=()=>o(495439),Be=()=>o(876822),Ve=()=>o(516623),Ae=()=>o(804217),Ue=()=>o(279386),Ee=()=>o(749826),Ge=()=>o(138912),Le=()=>o(475335),Ne=()=>o(826955),Oe=()=>o(965903),We=()=>o(127519),Ze=()=>o(807230),He=()=>o(286310),Ye=()=>o(454393),Ke=()=>o(369637),je=()=>o(348141),$e=()=>o(572623),Qe=()=>o(532306);function ze(e){var t;const{originalHtmlContentSize:o,environment:n}=e;if(o<500)return;const r=(0,$e().WD)(n),i=null==r||null===(t=r.getSettings())||void 0===t?void 0:t.adoption_entry_points,a=i?i.import_nudge_on_large_paste:void 0;if(a){const e=Ee().default.getConfigKey("adoption_entry_point_time_delta","import_nudge_on_large_paste"),t=a[a.length-1];if(!(Date.now()-t>e.view_delta))return}"nudge_on_large_paste"===Ee().default.getEligibleGroup({experimentId:"adoption_import_entry_point",defaultGroup:"control"})&&Ke().MV({message:ve().Z.formatMessage(Je.triggerNudgeOnPasteDescription),presentationType:"persistent",id:"nudge-on-paste",title:ve().Z.formatMessage(Je.triggerNudgeOnPasteTitle),onUserDismiss:()=>{(0,Qe().b)({environment:n,action:"dismiss"})},onDismiss:()=>{(0,Qe().b)({environment:n,action:"view"}),je().CL(n,{entryPoint:"import_nudge_on_large_paste"})},actions:{primary:{title:ve().Z.formatMessage(Je.triggerNudgeOnPastePrimaryAction),onAction:()=>{(0,Qe().b)({environment:n,action:"click"}),He().Sy(n,{from:"import_nudge_on_paste"}),Ke().Xd("nudge-on-paste"),Ye().r$({currentTab:"imports",openedFrom:"import_nudge_on_paste"})}}}})}const Je=(0,$().vU)({triggerNudgeOnPasteTitle:{id:"adoption.nudgeOnPaste.title",defaultMessage:"Import content directly"},triggerNudgeOnPasteDescription:{id:"adoption.nudgeOnPaste.description",defaultMessage:"Get all your content into Notion with a click"},triggerNudgeOnPastePrimaryAction:{id:"adoption.nudgeOnPaste.primaryAction",defaultMessage:"Import now"}});var qe=()=>o(491927),Xe=()=>o(54512),et=()=>o(332079),tt=(o(821057),o(470928),()=>o(843200)),ot=()=>o(163836),nt=()=>o(349220),rt=()=>o(332542),it=()=>o(643937),at=()=>o(239482),st=()=>o(321930),lt=()=>o(32969),ct=()=>o(893379),dt=()=>o(970105),ut=()=>o(990966);function pt(e){var t;const{environment:o,clipboardData:n,transaction:r,allowPasteIntoHeaderWithoutChildren:i,selectAll:s,preventLegacyTransclusions:l}=e;if(We().default.isEditingComment()||(0,Me().qK)())return!1;if(function(e,t){return e.blockSelection.blocks.some((e=>{var o;if(!e.blockSubtree)return!0;const n=null===(o=e.blockSubtree.getModel({id:e.blockId,table:E().iU}))||void 0===o?void 0:o.spaceId;return!!(n&&t&&te().uq({sourceSpaceId:n,targetSpaceId:t,sourceBlockSubtree:e.blockSubtree}))||void 0}))}(n,null===(t=Be().default.state.currentSpaceStore)||void 0===t?void 0:t.id))return!1;const d=We().default.state;if("editing"!==d.mode)return!1;const u=d.multiSelection.start.store;if(!u.isTable(E().iU))return!1;const p=(0,Te().sQ)(u);if(!p)return!1;if(u!==p.getBlockTitleStore())return!1;const m=p.getType(),f=p.getFormat();if(!m)return!1;if(!((0,c().Um)(m,f)||i&&(0,c().zp)(m)))return!1;if(i&&(0,c().zp)(m)){const e=n.blockSelection.blocks[0],t=null==e?void 0:e.blockId,o=null==e?void 0:e.blockSubtree,r=t&&o?o.getModel({id:t,table:"block"}):void 0;if(Boolean(null==r?void 0:r.getContentLength()))return!1}const g=(0,st().dq)({includeNonSelectableListContainer:!0});if(!g)return!1;const b=(0,st().v5)(p,[g]);if(!b)return!1;let k=0;for(let a=b.length-1;a>=0;a--){const e=b[a].value.store,t=lt().C.findSelectableFromStore(e),o=e.getModel();if(null!=o&&o.isType(c().$t)||t&&!t.props.canSelect){k=a;break}}const v=b.slice(k);if(0===v.length)return!1;const y=v[0].value.store,h=y.pointer.spaceId,S=y.isInsideTemplate()||y.isInsideFactoryOrDuplicateBlocksAction();r.logDebugMessage("pasteMultiTextSelection: pasting",v,{spaceId:h,pastingIntoTemplate:S,insertionPathRootStore:y});const T=n.blockSelection.blocks.map((e=>{var t;let{blockId:n,blockSubtree:i}=e;if(!i)throw new Error("Missing data for local duplicate block during paste");const a=(null===(t=i.getModel({table:E().iU,id:n}))||void 0===t?void 0:t.getType())===c().Ti.factory,s=!(S||a),d=Ne().G.createChildStore(y,{table:E().iU,id:n}),u=le().localDuplicate({environment:o,sourceBlockId:n,targetBlockPointer:(0,be().Ii)({environment:o,table:E().iU,spaceId:h}),sourceBlockSubtree:i,targetInMemoryRecordCache:y.inMemoryRecordCache,addCopyName:(0,xe().Z)(d),deepCopyTransclusionContainers:!1,resolveTemplateVariables:s,transaction:r,preventLegacyTransclusions:l}),m=u.targetBlockStore.getType();return m&&Xe().W(o,{from:"paste",type:m,new_page_id:"page"===m?u.targetBlockStore.id:void 0,creating_block_id:u.targetBlockStore.id,parent_collection_id:p.getParentCollectionIdUpToTwoLevels()}),u})),x=n.multiTextSelection.start.pointerPath,C=n.multiTextSelection.end.pointerPath,M=[],I=[],w=Math.max(x.length,C.length),_=(v[v.length-w]||v[0]).value.store,F=(0,K().MW)({node:n.tree,recordStoreParent:_},(e=>{let{node:t,recordStoreParent:o}=e;const n=((e,t)=>{let o;for(const{originalToDuplicate:n}of T)if(o=n.get(t),o)break;if(o)return Ne().G.createChildStore(e,o)})(o,t.value),r=M.length<x.length?x[M.length]:void 0,i=I.length<C.length?C[I.length]:void 0;let a=!1;if((null==r?void 0:r.id)===t.value.id&&(a=!0,M.push(n)),(null==i?void 0:i.id)===t.value.id&&(a=!0,I.push(n)),!a)return{value:{store:n}};const s=(null==n?void 0:n.getContentStore())||y;return{value:{store:n},children:t.children.map((e=>({node:e,recordStoreParent:s})))}}));if(M.length!==x.length||0===M.length)throw new Error(`Failed to hydrate start path during paste (found ${M.length} of ${x.length})`);if(I.length!==C.length||0===I.length)throw new Error(`Failed to hydrate end path during paste (found ${I.length} of ${C.length})`);const R=M[M.length-1],D=I[I.length-1];if(!R||!D)throw new Error(`Failed to hydrate position during paste (${R?"":"missing start"} ${D?"":"missing end"})`);const P=(0,K().DY)([F],(e=>e.value.store===R)),B=(0,K().DY)([F],(e=>e.value.store===D)),V=P&&B&&ot().T.fromNearestCommonAncestor(P,B);if(!V)throw new Error(`Failed to build range for paths: ${P?"":"missing start"} ${B?"":"missing end"}`);dt().pz({environment:o,multiSelection:d.multiSelection,transaction:r});const A=We().default.state,U="editing"===A.mode?A.multiSelection:d.multiSelection;if((0,Se().Nm)(p)&&0===n.multiTextSelection.start.textIndex){const e=R.getType();e&&(0,c().Zu)(e)&&ce().transformBlocks({environment:o,blocks:[p],blockType:e,transaction:r})}let G;return y.useCrdt()?(ft({transaction:r,clipboardData:n,startBlockStore:p,duplicateStartStore:R,range:V,insertionPath:v,duplicates:T,insertionPathRootStore:y}),G=mt({environment:o,transaction:r,clipboardData:n,insertionPoint:U,textSelectionState:d,duplicateEndStore:D,pastingIntoTemplate:S}).newSelectionIndex):(G=mt({environment:o,transaction:r,clipboardData:n,insertionPoint:U,textSelectionState:d,duplicateEndStore:D,pastingIntoTemplate:S}).newSelectionIndex,ft({transaction:r,clipboardData:n,startBlockStore:p,duplicateStartStore:R,range:V,insertionPath:v,duplicates:T,insertionPathRootStore:y})),a().default.afterNextFlush((()=>{const e=(0,st().kC)({rootStore:y,root:g,target:V.end}),t=e&&(0,Te().mh)(e[e.length-1]);if(!t)return;const o={start:{index:s?U.start.index:G,store:s?U.start.store:t},end:{index:G,store:t}};ut().setMultiSelection({multiSelection:o})})),!0}function mt(e){const{insertionPoint:t,duplicateEndStore:o,pastingIntoTemplate:n,environment:r,transaction:i,clipboardData:a}=e;let s=0;const l=t.end.store,c=t.end.index,d=(0,Te().mh)(o);if(d){s=W().eeV(d.getValue()).length;const e=(0,nt().TO)((0,Te().sQ)(l)),t=(0,nt().TO)((0,Te().sQ)(d));se().Ls({store:l,blockStore:e})&&se().Ls({store:d,blockStore:t})?(it().Wc({sourceBlockStore:e,targetBlockStore:t,splitAtGraphemeIndex:c,transaction:i,moveIntoNewBlock:!1}),i.logDebugMessage("(CRDT) pasted suffix into end",d)):(dt().gc({environment:r,sourceStore:l,sourceIndex:c,targetStore:d,targetIndex:s,transaction:i}),i.logDebugMessage("pasted suffix into end",d))}else dt().pe({environment:r,transaction:i,store:l,selection:{startIndex:c,endIndex:1/0}}),i.logDebugMessage("no end title store to paste text into");let u=W().V3g(a.multiTextSelection.start.copiedText,{removeSuggestionAnnotationsAndText:!1,removeSuggestionAnnotations:!0,removeDiscussions:!0});return n||(u=(0,Y().KV)(u,{currentUserId:r.currentUser.id,currentTimeZone:(0,T().r)()})),dt().mM({environment:r,index:t.start.index,store:t.start.store,tokens:u,transaction:i}),{newSelectionIndex:s}}function ft(e){const{transaction:t,clipboardData:o,startBlockStore:n,duplicateStartStore:r,insertionPath:i,insertionPathRootStore:a,duplicates:s,range:l}=e,c=Ee().default.checkGate({gateName:"prefer_high_level_operations"});for(const p of l.iterateInsertionAt(i))(0,st().D_)({transaction:t,treeOperation:p,deleteFrom:"tree-parent",preferHighLevelOperations:c}),tt().f.applyMutable(p);if(o.blockSelection.wasContiguousSelection&&o.blockSelection.blocks.length>0&&!n.hasContent())for(const p of r.getContentStores())rt().jG({parentStore:n.getContentStore(),childStore:p,transaction:t});const d=new Set;for(const{originalToDuplicate:p}of s){const e=p.getByTable(E().iU);for(const{value:o}of e){var u;if(!o||d.has(o.id))continue;d.add(o.id);const e=Ne().G.createChildStore(r,o),n=(0,at().eG)(e),i="transclusion_reference"===a.getType()?null===(u=a.getTransclusionReferenceTargetStore())||void 0===u?void 0:u.id:a.id;n.find((e=>e.id===i))||(t.logDebugMessage("disposing of unwanted duplicated block",e,e.id===r.id),ct().YM({childStore:e,parentStore:a,alive:!1,transaction:t}))}}}var gt=()=>o(33150),bt=()=>o(308186),kt=()=>o(231077),vt=()=>o(544607),yt=()=>o(295703),ht=()=>o(905),St=()=>o(282662),Tt=()=>o(636340),xt=()=>o(453999),Ct=()=>o(879952),Mt=()=>o(102182),It=()=>o(435168),wt=()=>o(15672),_t=()=>o(269299),Ft=()=>o(423402);const Rt=!1;function Dt(){if(Rt){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];console.log("clipboardActions:",...t)}}const Pt=(0,$().vU)({offlineError:{id:"clipboardActions.offlineError.message",defaultMessage:"Please go online to copy this block."},untitled:{defaultMessage:"Untitled",id:"clipboardActions.untitledMessage"}}),Bt=(0,$().vU)({copiedQnAMessageToClipboard:{id:"action.copiedQnAMessageToClipboard",defaultMessage:"Copied response to clipboard"},copiedHumanMessageToClipboard:{id:"action.copiedHumanMessageToClipboard",defaultMessage:"Copied your message to clipboard"},copiedLinkToClipboard:{id:"action.copiedLinkToClipboard.snackBarMessage",defaultMessage:"Copied link to clipboard"},copiedPageLinkToClipboard:{id:"action.copiedPageLinkToClipboard.snackBarMessage",defaultMessage:"Copied page link to clipboard"},copiedFormLinkToClipboard:{id:"action.copiedFormLinkToClipboard.snackBarMessage",defaultMessage:"Copied form link to clipboard"},copiedTeamHomeLinkToClipboard:{id:"action.copiedTeamHomeLinkToClipboard.snackBarMessage",defaultMessage:"Copied page link to clipboard"},copiedBlockLinkToClipboard:{id:"action.copiedBlockLinkToClipboard.snackBarMessage",defaultMessage:"Copied block link to clipboard"},copiedLinksToClipboard:{id:"action.copiedLinksToClipboard.snackBarMessage",defaultMessage:"Copied links to clipboard"},copiedPropertyToClipboard:{id:"action.copiedPropertyToClipboard.snackBarMessage",defaultMessage:"Copied property to clipboard"},copiedCodeToClipboard:{id:"action.copiedCodeToClipboard.snackBarMessage",defaultMessage:"Copied code to clipboard"},copiedTokenToClipboard:{id:"action.copiedTokenToClipboard.snackBarMessage",defaultMessage:"Copied token to clipboard"},copiedToClipboard:{id:"action.copiedToClipboard.snackBarMessage",defaultMessage:"Copied to clipboard"},copiedApiObjectToClipboard:{id:"action.copiedApiObjectToClipboard.snackBarMessage",defaultMessage:"Copied API object to clipboard"},copiedImageToClipboard:{id:"action.copiedImageToClipboard.snackBarMessage",defaultMessage:"Copied image to clipboard"},copyImageError:{id:"action.copyImageError.snackBarMessage",defaultMessage:"Failed to copy image to clipboard"},copiedPageToClipboard:{id:"action.copiedPageToClipboard.snackBarMessage",defaultMessage:"Copied page to clipboard"}}),Vt={...o(748456).Y,dockerfile:"Docker",javascriptreact:"JavaScript",jsonc:"JSON","objective-c":"Objective-C",proto:"Protobuf",shellscript:"Shell",typescriptreact:"TypeScript",vb:"Visual Basic"},At="text/_notion-blocks-v3-production",Ut="text/_notion-text-production",Et="text/_notion-multi-text-production",Gt="text/_notion-page-source-production",Lt="vscode-editor-data",Nt=[At,Ut,Et,Gt],Ot=new Set(Nt);const Wt={fromJson:e=>e,toJson:e=>e},Zt=Wt,Ht=Wt,Yt=Wt,Kt={fromJson(e){const t=(0,K().MW)(e.tree,(e=>e)),o=jt.fromJson(e.blockSelection);return{...e,tree:t,blockSelection:o}},toJson(e){const t=jt.toJson(e.blockSelection);return{...e,blockSelection:t}}},jt={fromJson:e=>({...e,blocks:e.blocks.map((e=>({...e,blockSubtree:e.blockSubtree?B().RecordMap.create(e.blockSubtree):void 0})))}),toJson:e=>({...e,blocks:e.blocks.map((e=>({...e,blockSubtree:e.blockSubtree?e.blockSubtree.toJson():void 0})))})},$t="VirtualClipboard:production";let Qt;function zt(e){return e.isAndroid}function Jt(e,t){if(!zt(t))return e;const o=(0,pe().nZ)(e.getData("text/html"));if(o){Qt||(Qt=O().Z.get($t));const t=Qt;if(o===(null==t?void 0:t.id)){const o=e.types.concat(Object.keys(t.mimeTypes));return{getData(o){const n=e.getData(o);return!n&&function(e){return Ot.has(e)}(o)?t.mimeTypes[o]||"":n},types:[...new Set(o)].filter((o=>{const n=t.mimeTypes[o];return""!==e.getData(o)||n&&""!==n})),items:e.items}}}return e}function qt(e,t,o,n){if(!e.clipboardData)return;const r=o.toJson(n),i=JSON.stringify(r);e.clipboardData.setData(t,i)}function Xt(e,t,o){try{const n=e.getData(t),r=JSON.parse(n);return o.fromJson(r)}catch(n){return}}function eo(e){const{clipboardData:t}=e,{text:o,html:n,isFromMicrosoftOffice:r,isHtmlTable:i}=function(e){const{clipboardData:t,tinyMceMicrosoftWordPasteFilter:o}=e,n=t.getData("text/uri-list"),r=t.getData("text/plain").replace(Bo,"\n")||n,i=t.getData("text/html"),a=Io(i),{isHtmlTable:s,htmlContainsRichFormatting:l}=function(e){var t;const o=document.createElement("div");o.innerHTML=wo(e);const n=Boolean("table"===(null===(t=o.firstElementChild)||void 0===t?void 0:t.nodeName.toLowerCase()));return{htmlContainsRichFormatting:x().RE({node:o,window,emojiData:de().Z.state}),isHtmlTable:n}}({html:i,tinyMceMicrosoftWordPasteFilter:o});if(!l&&!function(e,t){return Po.test(e)&&Po.test(t)}(i,r))return{text:r,isFromMicrosoftOffice:a,isHtmlTable:s};return{text:r,html:i,isFromMicrosoftOffice:a,isHtmlTable:s}}(e);return{text:o,html:n,multiTextSelectionData:Xt(t,Et,Kt),textSelectionData:Xt(t,Ut,Zt),blockSelectionData:Xt(t,At,jt),isFromMicrosoftOffice:r,isHtmlTable:i}}function to(e){const{blocks:t,action:o,environment:n}=e;if(0===t.length)return{action:o,blocks:[],wasContiguousSelection:!1};const r=t[0],i=r.inMemoryRecordCache,a=z().jj(z().oA(t.map((e=>e.id)))),s=r.getParentBlockStore(),l=s?s.getRenderableContentIds():[],c=l.indexOf(r.id),d=Boolean(s&&t.every(((e,t)=>l.indexOf(e.id)===c+t)));if(i.isTemplatePreview){return{blocks:a.map((e=>({blockId:e,blockSubtree:le().loadLocalSubtree(n,{blockId:e,inMemoryRecordCache:i,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0,excludeCrdtData:!0,includeLegacyTransclusionBlockValues:(0,ke().hC)()}).recordMap}))),action:o,wasContiguousSelection:d}}if(i.snapshotData){qe().P_(n,i.snapshotData);return{blocks:a.map((e=>({blockId:e,blockSubtree:le().loadLocalSubtree(n,{blockId:e,inMemoryRecordCache:i,allowCopyCollections:!0,requireFullSubtree:!0,skipNavigableChildren:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0,excludeCrdtData:!0,includeLegacyTransclusionBlockValues:(0,ke().hC)()}).recordMap}))),action:o,wasContiguousSelection:d,wasSelectionFromSnapshot:!0}}{const e=(0,pe().IU)(t),r=e&&no({environment:n,inMemoryRecordCache:i,multiColumnPasteInfo:e});if(e&&r){let t=!1;const s=[];for(const o of a)e.blockIds.has(o)?t||(s.push({blockId:e.columnListId,blockSubtree:r}),t=!0):s.push({blockId:o,blockSubtree:le().loadLocalSubtree(n,{blockId:o,inMemoryRecordCache:i,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0,excludeCrdtData:!0,includeLegacyTransclusionBlockValues:(0,ke().hC)()}).recordMap});return{blocks:s,action:o,wasContiguousSelection:d}}return{blocks:a.map((e=>({blockId:e,blockSubtree:le().loadLocalSubtree(n,{blockId:e,inMemoryRecordCache:i,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0,excludeCrdtData:!0,includeLegacyTransclusionBlockValues:(0,ke().hC)()}).recordMap}))),action:o,wasContiguousSelection:d}}}function oo(e){const{markdown:t,markdownOptions:o,markdownLinkifyIt:n}=e;if(n)return _().c8({...n,markdown:t,plugin:null==o?void 0:o.plugin})}function no(e){var t;const{environment:o,multiColumnPasteInfo:n,inMemoryRecordCache:r}=e,{columnListId:i,columnIds:a,spaceId:s}=n,l=B().RecordMap.create(),c=null===(t=r.getEntry({pointer:{table:E().iU,id:i,spaceId:s},userId:o.currentUser.id}))||void 0===t?void 0:t.value.value;if("column_list"!==(null==c?void 0:c.type))return;const d={...c,content:(c.content||[]).filter((e=>a.has(e)))};l.setValue({table:E().iU,id:i,spaceId:s},d);for(const m of a){var u;const e=null===(u=r.getEntry({pointer:{table:E().iU,id:m,spaceId:s},userId:o.currentUser.id}))||void 0===u?void 0:u.value.value;if("column"!==(null==e?void 0:e.type))return;const t={...e,content:(e.content||[]).filter((e=>n.blockIds.has(e)))};l.setValue({table:E().iU,id:m,spaceId:s},t)}const p=[l];for(const m of n.blockIds){const e=le().loadLocalSubtree(o,{blockId:m,inMemoryRecordCache:r,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0,excludeCrdtData:!0,includeLegacyTransclusionBlockValues:(0,ke().hC)()}).recordMap;if(!e)return;p.push(e)}return B().RecordMap.merge(p)}function ro(e){const{rootBlock:t,getRecordValue:o}=e,n=o(t);if(!n)return;const r=(0,S().ky)({block:n,getRecordValue:o});if(!r)return;const i=(0,pe().ax)({rootBlock:t,getRecordValue:o,formulasModule:v()}),a=(0,d().oC)(r),s=Object.keys(a),l=z().MR(s,(e=>{const t=a[e];return t&&t.name||""}));let c="";for(const d of l){const e=a[d];if(e&&"title"!==d){const t=(0,g().Wy)({property:d,schema:a,block:n,exportArgs:i,renderers:f().O});t&&(c+=`${e.name}: ${t}\n`)}}return c||void 0}function io(e){const{treePath:t,textPosition:o,endpoint:n}=e,{store:r,index:i}=o,a=t.map((e=>e.value.store.pointer)),s=se().FX(o.store)?["properties","title"]:o.store.path,l=W().xrQ(r.getValue(),i,i);return{copiedText:"end"===n?l.tokensBeforeRange:l.tokensAfterRange,textIndex:i,attributePath:s,pointerPath:a}}function ao(e){var t;const{multiSelection:o,action:n,environment:r}=e;(0,ye().qS)(o)&&console.warn("Warning, serializeMultiTextSelectionToClipboardData() was called with a single-store text selection! This function should only be  called with a multi-selection that spans multiple blocks.");const i=null===(t=(0,he().tp)({filterCommonAncestors:!0,multiSelection:o,focus:void 0}))||void 0===t?void 0:t.stores;if(!i)return;const a=o.start.store.inMemoryRecordCache,s=to({action:n,blocks:i,environment:r});if(0===s.blocks.length)return;const l=(0,he().Nj)({multiSelection:o,includeNonSelectable:!1});if(!l)return;const{treeRange:c}=l,d=[],u=new Map,p=(e,t)=>{t.forEach((e=>p(e,[])));const o=u.get(e),n=o&&o.length>t.length?o:t;u.set(e,n)},m=Ee().default.checkGate({gateName:"prefer_high_level_operations"});for(const{start:y,end:h}of c.iterateAnalogousNodes()){if(y){const e=y.childrenBeforeRange.slice(-1).concat(y.childrenInsideRange);p(y.parent,e)}if(h)if(p(h.parent,h.childrenInsideRange),m)for(const e of h.childrenAfterRange)d.push({command:"removeChild",path:["content"],pointer:h.parent.value.store.pointer,args:{id:e.value.store.id}});else d.push(R().op.set({pointer:h.parent.value.store.pointer,path:["content"],args:h.childrenInsideRange.map((e=>e.value.store.id))}))}const f=io({textPosition:o.start,endpoint:"start",treePath:c.startPath}),g=io({textPosition:o.end,endpoint:"end",treePath:c.endPath});d.push(...(0,pe().FQ)(f),...(0,pe().FQ)(g));for(const y of[null===(b=s.blocks[0])||void 0===b?void 0:b.blockSubtree,null===(k=s.blocks[s.blocks.length-1])||void 0===k?void 0:k.blockSubtree]){var b,k;y&&((0,D().FS)({recordMap:y,operations:d,updateOnly:!0}),m&&so(r,a,y))}const v=(0,K().MW)(c.commonAncestor,(e=>{const t=u.get(e);if(t)return{value:e.value.store.pointer,children:t}}));if(v)return{blockSelection:s,tree:v,multiTextSelection:{start:f,end:g},action:n};Dt("unexpected: trimming tree produced undefined")}function so(e,t,o){const n=[];for(const{model:r}of o)if(r instanceof F().yJh&&!r.alive){n.push(r.pointer);const o=le().loadLocalSubtree(e,{blockId:r.pointer.id,inMemoryRecordCache:t,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0,excludeCrdtData:!0,includeLegacyTransclusionBlockValues:(0,ke().hC)()}).recordMap;if(o)for(const{pointer:e}of o)n.push(e)}for(const r of n)o.delete(r)}function lo(e){const{environment:t,event:o}=e,n=C().Il();!function(e){const{environment:t,event:o,markdownLinkifyIt:n}=e;if(!o.clipboardData)return;const r=Oe().default.state.stores,i=We().default.isEditingComment(),a=Pe().default.state.open,s=Re().UQ(),l="empty"!==We().default.state.mode&&We().default.state.multiSelection,d=t.currentUser.id,u="copy"===o.type?"copy":"cut",p=ue().RM();p&&(0,V().$O)(p.pointer,E().iU)&&qt(o,Gt,Ht,p.pointer);const m=l&&(0,ye().QY)(l);if(m&&m.selection.startIndex!==m.selection.endIndex){const e=ve().Z.getIntl(),{store:n,selection:r}=m,i=n.inMemoryRecordCache,a=n.getValue();if(Dt("copy: copying single-store text selection"),o.preventDefault(),a&&!Fo()){const e=n.table===E().iU?(0,Te().sQ)(n):void 0,t=e&&z().Xy(n.path,e.getBlockTitleStore().path)?e.getType():void 0,i=t&&(0,c().Zu)(t)?t:void 0,s=a.filter((e=>!W().eIM(e)));qt(o,Ut,Zt,{blockType:i,editing:s,selection:r,action:u})}const s=W().KU1(a,r.startIndex,r.endIndex),l=F().omK.fromGetRecordValueFn(i.makeGetRecordValueFn(d)),p=i.makeGetRecordRoleFn(d),f=(0,A().Xh)({intl:e,textValue:s,getRecordModel:l,userTimeZone:(0,T().r)(),externalIntegrations:Ge().default.integrations.state});o.clipboardData.setData("text/plain",(0,pe().ZI)(t.device.isWindows,f));const g=H().hW({textValue:s&&{value:s,spaceId:(0,N().J)(n.pointer.spaceId)},getRecordModel:l,getRecordRole:p,userTimeZone:(0,T().r)(),isAndroid:!1,isSafariOrIOS:!1,isWindows:!1,disableLinks:!1,disabled:!0,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,baseUrl:ae().default.domainBaseUrl,publicDomainName:ae().default.publicDomainName,showEmojiInline:!0,emojiType:"raw",theme:(0,Q().Vx)(),intl:e,katex:void 0,isClient:void 0,currentUserId:void 0,getPublicBaseUrlForPage:ge().Lr,externalIntegrations:Ge().default.integrations.state,formulaValueTypes:[],emojiData:de().Z.state,isMobileNative:!1});return void o.clipboardData.setData("text/html",(0,pe().ZI)(t.device.isWindows,g))}if(l&&!(0,ye().iG)(l)&&!i&&l.start.store.table===E().iU&&l.end.store.table===E().iU){const e=ao({environment:t,multiSelection:l,action:u});if(e){Dt("copy: copying multi-text selection"),o.preventDefault(),qt(o,Et,Kt,e);const r=l.start.store.inMemoryRecordCache,i=l.start.store.getRecordStoreUIRoot().getValue();if(!i)return;const{markdown:a,html:s}=(0,pe().Ef)({clipboardData:e,rootBlock:{id:i.id,table:E().iU,spaceId:i.space_id},isWindows:t.device.isWindows,fallbackGetRecordValue:r.makeGetRecordValueFn(d),markdownLinkifyIt:n,markdownSerializationOptions:{transformBlockMapping:{image:Ee().default.checkGate({gateName:"docs_clipboard_imagedata"})?co:void 0}},formulasModule:v()});return a&&o.clipboardData.setData("text/plain",a),void(s&&o.clipboardData.setData("text/html",s))}}if(l&&!(0,ye().iG)(l)&&!i&&l.start.store.table===L().x_&&l.end.store.table===L().x_){Dt("copy: copying comment multi-text selection"),o.preventDefault();const e=(0,he().L5)(l),n=ve().Z.getIntl(),r=e.map((e=>{let{store:o,selection:r}=e;if(r.startIndex===r.endIndex)return;const i=o.inMemoryRecordCache,a=F().omK.fromGetRecordValueFn(i.makeGetRecordValueFn(d)),s=i.makeGetRecordRoleFn(d),l=W().KU1(o.getValue(),r.startIndex,r.endIndex);return{plainText:(0,A().Xh)({intl:n,textValue:l,getRecordModel:a,userTimeZone:(0,T().r)(),externalIntegrations:Ge().default.integrations.state}),htmlContent:H().hW({textValue:l&&{value:l,spaceId:(0,N().J)(o.pointer.spaceId)},getRecordModel:a,getRecordRole:s,userTimeZone:(0,T().r)(),isAndroid:!1,isSafariOrIOS:!1,isWindows:!1,disableLinks:!1,disabled:!0,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,baseUrl:ae().default.domainBaseUrl,publicDomainName:ae().default.publicDomainName,showEmojiInline:!0,emojiType:"raw",theme:(0,Q().Vx)(),intl:n,katex:void 0,isClient:void 0,currentUserId:void 0,getPublicBaseUrlForPage:De().aR(t),externalIntegrations:Ge().default.integrations.state,formulaValueTypes:[],emojiData:de().Z.state,isMobileNative:!1}),textValue:l}})).filter(X().$K),i=r.map((e=>e.plainText)).join("\n\n"),a=`<div>${r.map((e=>e.htmlContent)).join("</div><div>")}</div>`;return o.clipboardData.setData("text/plain",(0,pe().ZI)(t.device.isWindows,i)),void o.clipboardData.setData("text/html",(0,pe().ZI)(t.device.isWindows,a))}if(r.length>0&&!i&&!s&&!a){Dt("copy: copying block selection"),o.preventDefault();const e=r[0],i=e.inMemoryRecordCache,a=to({blocks:r,environment:t,action:u});if(qt(o,At,jt,a),!e.isDefined())return;const s=z().oA(r.map((e=>e.computeWithRecordValues((t=>{let{getRecordValueAndSubscribe:o}=t;return o(e)}))))),l=i.makeGetRecordValueFn(d),{markdown:c,html:p}=(0,pe().X4)({rootBlock:{id:e.id,table:E().iU,spaceId:e.getSpaceId()},blockValues:s,getRecordValue:l,isWindows:t.device.isWindows,markdownLinkifyIt:n,formulasModule:v()});return c&&o.clipboardData.setData("text/plain",c),void(p&&o.clipboardData.setData("text/html",p))}Dt("copy: doing nothing")}(e),(0,pe().Li)(o,n),function(e){let{event:t,device:o,customEventId:n}=e;if(!t.clipboardData||!zt(o))return;const r={};for(const s of Nt)r[s]=t.clipboardData.getData(s);const i=t.clipboardData.getData("text/html");t.clipboardData.setData("text/html",`${i}${(0,pe().Gp)(n)}`),Qt={id:n,mimeTypes:r};try{O().Z.set($t,Qt)}catch(a){h().log({level:"error",from:"clipboardActions",type:"setVirtualClipboardData",error:{message:"Unable to persistently store virtual clipboard data."}})}}({event:o,device:t.device,customEventId:n})}function co(e){const{block:t,exportArgs:o}=e,{getExportedRenderAsset:n}=o,{source:r}=F().kk5.fromBlock(t).getProperties(),i=W().QaF(r),a=function(e){if(!e.file_ids)return;const t=we().R.findBlockFromId(e.id);if(!t)return;const o=t.getNode();if(!(o instanceof Element))return;const n=o.querySelector("img");if(!n)return;const r=document.createElement("canvas");r.width=n.width,r.height=n.height;const i=r.getContext("2d");if(!i)return;return i.drawImage(n,0,0,n.width,n.height),r.toDataURL()}(t)??n({fromBlockId:o.blockId,toFileURI:i}),s=_().cG(e)||_().WB({block:t,exportArgs:o})||a;return{text:(0,p().SR)({url:i})?`![${s}](${a})`:`[${s}](${a})`,breakLines:!0,children:_().AS(e)}}async function uo(e){const{event:t,environment:o,markdownLinkifyIt:n}=e;ut().syncTextSelection();const r=Oe().default.state.stores,i=We().default.isEditingComment(),a=ue().JE(),s="editing"===We().default.state.mode&&We().default.state.multiSelection,{phase:l}=Oe().default.state;if(po({environment:o,event:t,disableSyncTextSelection:!0,markdownLinkifyIt:n}),s&&!(0,ye().iG)(s)){const e=s.start.store.getAncestorBlockStoreAtRootPath(),t=e?Ue().MT.getMode(e):"default";_t().createAndCommit({userAction:"clipboardActions.cutWithMaybeConfirmation",environment:o,canUndo:!0,perform:n=>{if("suggest"===t){const t=ie().oG(o,n,e);ie().Sz({environment:o,multiSelection:s,transaction:n,discussionStore:t})}else dt().pz({environment:o,multiSelection:s,transaction:n})}})}else(l===Oe().SelectionPhase.Selected||s)&&r.length>0&&!i&&!a&&await xt().Qw({environment:o,blocks:r,shouldCheckSuggestEdit:!0});Le().default.setKeyboardMode(!0)}function po(e){const{environment:t,event:o,disableSyncTextSelection:n,markdownLinkifyIt:r}=e;n||ut().syncTextSelection(),lo({environment:t,event:o,markdownLinkifyIt:r}),Le().default.setKeyboardMode(!0)}function mo(e){var t;const{environment:o,files:n,transaction:r,insertBelowBlockStore:i}=e,a=Oe().default.getCurrentRecordCache(),s=ue().qQ(o);if(!a)return;const l=Oe().default.state.stores,c=vt().z({environment:o,files:n,inMemoryRecordCache:a,transaction:r,pageWidth:s,spaceId:0!==l.length?l[0].pointer.spaceId:null===(t=ue().RM())||void 0===t?void 0:t.pointer.spaceId});c.forEach((e=>{const t=e.getType();t&&Xe().W(o,{from:"paste",type:t,creating_block_id:e.id})})),bo({environment:o,blocks:c,transaction:r,replaceEmptyTextBlock:!0,insertBelowBlockStore:i})}function fo(e){const{environment:t,store:o,tokens:n,index:r,transaction:i,multiTextSelection:s,disableEmbedMenu:l,selectAll:c}=e,d=(0,ye().QY)(s),u=d?{value:d.store.getValue()}:void 0,p=o.getAncestorBlockStoreAtRootPath(),f=p?Ue().MT.getMode(p):"default";let g=n;(We().default.isEditingComment()||We().default.isEditingCaption())&&(g=function(e){const{environment:t,tokens:o}=e,n=go(o);if(n&&n.url===n.text){const e=(0,U().parseRoute)({url:n.url,baseUrl:ae().default.domainBaseUrl,publicDomainName:ae().default.publicDomainName,isMobile:t.device.isMobile,protocol:ae().default.protocol,currentUrl:window.location.href});if("page"===e.name&&e.blockId){const t=W().$0A(e.scrollToBlockId??e.blockId,void 0);return[W().YCD(t),W().V3y(" ")]}}return o}({environment:t,tokens:n})),dt().mM({environment:t,store:o,tokens:g,index:r,transaction:i,selectAll:c,editorMode:f});const b=go(g);!l&&u&&b&&"suggest"!==f&&function(e){const{environment:t,hyperlink:o,oldTextValue:n}=e,r="editing"===We().default.state.mode&&(0,ye().QY)(We().default.state.multiSelection),i=Oe().default.state;if(r&&i.stores.length>0){const e=r.store.getValue(),i=W().QaF(e),s=m().p4(i.substring(0,i.indexOf(o.text))).length,l=s+m().p4(o.text).length;if(r.store.isTable(E().iU)||r.store.isTable(L().x_)){if(Ft().KT({environment:t,blockStore:Oe().default.state.stores[0],textStore:r.store,textValueBeforePaste:n,url:o.url,urlSelection:{startIndex:s,endIndex:l}}))return;if(ht().QZ({environment:t,textStore:r.store,blockStore:Oe().default.state.stores[0],oldTextValue:n,url:o.url,urlSelection:{startIndex:s,endIndex:l}}))return}a().default.afterNextFlush((()=>{const e=o.url;yt().KT({environment:t,textStore:r.store,oldTextValue:n,url:e,urlSelection:{startIndex:s,endIndex:l}})}))}}({environment:t,hyperlink:b,oldTextValue:u.value,transaction:i})}function go(e){if(1!==e.length)return;const t=e[0];if(!W().AJd(t))return;const[o,n]=t;if(1!==n.length)return;const r=n[0];if(!W().j0F(r))return;return{text:o,url:W().zW$(r)}}function bo(e){const{environment:t,blocks:o,transaction:n,replaceEmptyTextBlock:r,insertBelowBlockStore:i}=e,a=Oe().default.state.stores;if(1===a.length){const e=a[0];if(e.getType()&&e.isType(c().hY)&&function(e){if("editing"!==We().default.state.mode||!We().default.state.multiSelection)return!1;const t=(0,ye().QY)(We().default.state.multiSelection);if(!t)return!1;return t.store===e.getTitleStore()}(e)){const r=e.getContentStore(),i=z().d9(o).reverse().map((e=>St().Ce({parentStore:r,prependStore:e,transaction:n}).childStore));return Ct().Z5({environment:t,stores:i}),i}}return xt().BM({environment:t,blocksToInsert:o,target:i?[i]:a,transaction:n,replaceEmptyTextBlock:r})}function ko(e,t,o,n){const r=(0,ue().RM)();if(!r)return;const i=Oe().default.state.stores,s=0!==i.length?i[0].pointer.spaceId:r.pointer.spaceId,l="suggest"===Ue().MT.getMode(r,!0);let d=function(e,t){if("cut"!==t.action||!Ee().default.checkGate({gateName:"convert_cut_paste_to_move"}))return;const o="suggest"===Ue().MT.getMode(e,!0),n=[];for(const r of t.blocks){const t=Ne().G.createChildStore(e,{table:E().iU,id:r.blockId});if(!t.isReady())return;const i=t.getModel();if(!i)return;if(i.getSpaceId()!==e.getSpaceId())return;if(!1!==i.alive)return;o&&!c().ZM[i.getType()]||n.push(t)}return n}(r,t);if(!d){const o=JSON.stringify(t).length>Ie()._V;d=t.blocks.reduce(((i,a)=>{var d,u,p,m,f,g;let{blockId:b,blockSubtree:k}=a;const v=Ne().G.createChildStore(r,{table:E().iU,id:b});let y;if(v.isDefined())y=v.getModel();else{const e=null==k?void 0:k.getValue({table:E().iU,id:b});y=e&&F().kk5.fromBlock(e)}if(l&&y&&!c().ZM[y.getType()])return i;if(null!==(d=y)&&void 0!==d&&d.isCollectionView()&&(null===(u=y)||void 0===u||!u.getCollectionPointer())&&(null===(p=y)||void 0===p?void 0:p.getSpaceId())!==s&&Ee().default.checkGate({gateName:"collections_xws"})){const t=Tt().j4({environment:e,type:c().Ti.text,inMemoryRecordCache:v.inMemoryRecordCache,transaction:n,spaceId:s});return dt().mM({environment:e,store:t.getBlockTitleStore(),tokens:[W().YCD(W().$0A(b,y.getSpaceId()))],index:0,transaction:n}),i.push(t),i}const S=!(r.isInsideTemplate()||Ro()||r.isInsideFactoryOrDuplicateBlocksAction()||null!==(m=y)&&void 0!==m&&m.isTemplateVariableContainerBlock()),T=k&&s&&(null===(f=y)||void 0===f?void 0:f.getSpaceId())&&te().uq({sourceSpaceId:y.getSpaceId(),targetSpaceId:s,sourceBlockSubtree:k});if(k&&!o&&!T){const o=le().localDuplicate({environment:e,sourceBlockId:b,targetBlockPointer:(0,be().Ii)({environment:e,table:E().iU,spaceId:s}),sourceBlockSubtree:k,targetInMemoryRecordCache:v.inMemoryRecordCache,addCopyName:(0,xe().Z)(v),deepCopyTransclusionContainers:!1,shallowCopyNavigableBlock:!!t.wasSelectionFromSnapshot&&Ee().default.checkGate({gateName:"duplicate_snapshot_navigable_blocks_by_reference"}),resolveTemplateVariables:S,transaction:n,preventLegacyTransclusions:(0,ke().hC)()}).targetBlockStore,r=o.getType();return r&&Xe().W(e,{from:"paste",type:r,new_page_id:"page"===r?o.id:void 0,creating_block_id:o.id,parent_collection_id:v.getParentCollectionIdUpToTwoLevels()}),i.push(o),i}if(t.wasSelectionFromSnapshot)return h().log({level:"warning",from:"clipboardActions",type:"pasteBlockSelection",data:{message:"Unable to locally duplicate pasted block selection from snapshot",miscDataToConvertToString:{blockId:b,blockType:v.getType(),blockSelectionTooBig:o,missingBlockSubtree:!k}}}),i;Ae().default.state.online||bt().UW(ve().Z.formatMessage(Pt.offlineError));const[x,C]=le().serverDuplicate({environment:e,sourceBlocks:[{id:b,spaceId:(0,N().J)(null===(g=y)||void 0===g?void 0:g.getSpaceId())}],targetInMemoryRecordCache:v.inMemoryRecordCache,addCopyName:(0,xe().Z)(v),transaction:n,deepCopyTransclusionContainers:!1,resolveTemplateVariables:S,targetSpaceId:(0,N().J)(s),convertExternalObjectInstancesToPlaceholders:!1,userActionSuffix:k&&o?" (forceServerSideCopy)":void 0}),M=x[0],I=M.getType();return C.then((o=>{if("error"===o.status){const n=o.error;te().nr(n)?t.blocks.length>1?te().qR(e,{product:n.clientData.metadata.product}):te().y1({product:n.clientData.metadata.product}):bt().UW(o.errorMessage)}else I&&Xe().W(e,{from:"paste",type:I,new_page_id:"page"===I?M.id:void 0,creating_block_id:M.id,parent_collection_id:v.getParentCollectionIdUpToTwoLevels()})})),i.push(M),i}),[])}if(l){const t=ie().oG(e,n,d[0]),o=[];d.forEach((e=>{const r={type:"insert",id:C().Il(),discussionId:t.id};ie().n1(n,e,r),o.push(e.id)})),n.preEnqueueActions.push((()=>{ie().vh({environment:e,transaction:n,discussionStore:t,addModifiedBlockIdsAfter:o})})),wt().uj({environment:e,blocks:d,annotation:[W().GKr.SuggestionInsertText,t.id],transaction:n})}bo({environment:e,blocks:d,transaction:n,replaceEmptyTextBlock:!0});const u=Oe().default.state.stores,p=u.length>0?u:[r],m=t.blocks.map((e=>{const t=p.length>0?p[0]:function(e){return e.isCollectionView()?e.getCollectionStore()||e:e.getContentStore()}(r);return Ne().G.createChildStore(t,{table:E().iU,id:e.blockId})}));a().default.afterNextFlush((async()=>{await Promise.all(p.map((e=>e.waitUntil((()=>{const t=e.getType();return Boolean(t&&t!==c().Ti.copyIndicator)}))))),await Promise.all(m.map((e=>e.load()))),o&&et().RH({environment:e,blocks:p,pageSource:o,copiedStores:m,action:t.action,wasContiguousSelection:t.wasContiguousSelection,rootStore:r})&&et().kE({environment:e,copiedStores:m,blocks:p,pageSource:o})}))}function vo(e){const{environment:t,disableEmbedMenu:o,transaction:n,overwrite:r,selectAll:i,markdownOptions:a,markdownLinkifyIt:s,text:l,tinyMceMicrosoftWordPasteFilter:c}=e,d=l.includes("\n"),u=We().default.state,p=_o(u);d&&"inline"!==p||"editing"!==u.mode?r?(n.logDebugMessage("paste: pasting as markdown overwrite"),function(e){const{environment:t,text:o,transaction:n,selectAll:r,markdownOptions:i,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s}=e,l=oo({markdown:o,markdownOptions:i,markdownLinkifyIt:a});if(!l)return;let c=ho({environment:t,html:l,wrapInEmptyBlocks:!1,tinyMceMicrosoftWordPasteFilter:s});c||(c=ho({environment:t,html:l,wrapInEmptyBlocks:!0,tinyMceMicrosoftWordPasteFilter:s}));if(!c)return;pt({environment:t,clipboardData:c,transaction:n,allowPasteIntoHeaderWithoutChildren:!0,selectAll:r,preventLegacyTransclusions:(0,ke().hC)()})}({environment:t,text:l,transaction:n,selectAll:i,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:c})):l&&(n.logDebugMessage("paste: pasting as markdown append"),function(e){const{environment:t,text:o,transaction:n,markdownOptions:r,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:a}=e,s=oo({markdown:o,markdownOptions:r,markdownLinkifyIt:i});if(s)xo({environment:t,html:s,transaction:n,tinyMceMicrosoftWordPasteFilter:a})}({environment:t,text:l,transaction:n,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:c})):(n.logDebugMessage("paste: pasting as inline markdown"),function(e){const{environment:t,text:o,disableEmbedMenu:n,transaction:r,selectAll:i,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}=e,c="editing"===We().default.state.mode&&We().default.state.multiSelection;if(c){const e=(0,ye().QY)(c);if(e&&function(e){const t=We().default.state;return"editing"===t.mode&&!(0,ye().iG)(t.multiSelection)&&(0,ye().qS)(t.multiSelection)&&w().B(e,"url")}(o))Do({environment:t,text:o,transaction:r,editingSelection:e,selectAll:i});else if((0,Me().Ld)("c")){const e=(0,Te().sQ)(c.start.store);dt().hJ({environment:t,editorMode:e?Ue().MT.getMode(e):"default",multiSelection:c,string:o,disableMentions:!0,disableEmojiCommands:!0,disableSlashCommands:!0,transaction:r,selectAll:i})}else{const e=s&&_().lM({...s,markdown:o,plugin:null==a?void 0:a.plugin});if(!e)return;To({environment:t,html:e,transaction:r,stripText:!1,stripSurroundingWhitespace:!1,disableEmbedMenu:n,selectAll:i,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l})}}}({environment:t,text:l,disableEmbedMenu:o,transaction:n,selectAll:i,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:c}))}function yo(e,t){const o=e.getValue({table:E().iU,id:t});if(!o)return;const n={table:E().iU,id:t,spaceId:o.space_id},r=(o.content??[]).map((t=>yo(e,t))).filter(X().$K);return new(K().mp)(n,r)}function ho(e){var t,o,n,r;const a=ue().RM(),{html:s,wrapInEmptyBlocks:l,tinyMceMicrosoftWordPasteFilter:c,environment:d}=e,u=Mo({environment:d,html:s,tinyMceMicrosoftWordPasteFilter:c,useCrdt:!1});if(!u)return;const{currentUserStore:p}=Be().default.state;if(!p)return;let{allOperations:m,rootContentIds:f}=u;if(l){const e=Co(d),t=Co(d);if(!e||!t)return;m=[e.operation,...m,t.operation],f=[e.id,...f,t.id]}const g=B().RecordMap.create();(0,D().FS)({recordMap:g,operations:m,updateOnly:!1});const b=[],k=function(e){const{name:t,userId:o,recordMap:n}=e,r=B().RecordMapWithRole.create();for(const{pointer:i,model:a}of n)r.setModelAndRole(i,a,"reader");return new(i().Z)({name:t,data:new(j().o)({[o]:r})})}({name:"htmlToMultiTextSelectionClipboardData",userId:p.id,recordMap:g});for(const i of f){const e=le().loadLocalSubtree(d,{blockId:i,inMemoryRecordCache:k,allowCopyCollections:!0,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0,excludeCrdtData:!0,includeLegacyTransclusionBlockValues:(0,ke().hC)()}).recordMap;b.push({blockId:i,blockSubtree:e})}const v=new(K().mp)({...(0,be().Ii)({environment:d,table:E().iU,spaceId:null==a?void 0:a.pointer.spaceId})},f.map((e=>yo(g,e))).filter(X().$K));if(0===v.children.length)return;const y=v.children[0],h=null===(t=(0,K().DY)([v],(e=>e===y)))||void 0===t?void 0:t.map((e=>e.value)),S=null===(o=g.getValue(y.value))||void 0===o||null===(o=o.properties)||void 0===o?void 0:o.title,T=(0,K().CY)(v),x=null===(n=(0,K().DY)([v],(e=>e===T)))||void 0===n?void 0:n.map((e=>e.value)),C=null===(r=g.getValue(T.value))||void 0===r||null===(r=r.properties)||void 0===r?void 0:r.title,M=C?W().QaF(C).length:0;return S&&h&&C&&x?{blockSelection:{blocks:b,wasContiguousSelection:!0,action:"copy"},tree:v,multiTextSelection:{start:{textIndex:0,copiedText:S,attributePath:["properties","title"],pointerPath:h},end:{textIndex:M,copiedText:C,attributePath:["properties","title"],pointerPath:x}},action:"copy"}:void 0}function So(e){const{text:t,html:o,stripText:n,stripSurroundingWhitespace:r,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:a}=e,s=o||(t?oo({markdown:t,markdownLinkifyIt:i}):void 0);if(!s)return;if(Ee().default.checkGate({gateName:"paste_links_as_mentions"})){const e=(0,pe().hh)(s);if(e)return[W().YCD(W().$0A(e.id,e.spaceId),[])]}const l=document.createElement("div");return l.innerHTML=wo({html:s,tinyMceMicrosoftWordPasteFilter:a}),x().xR({node:l,window,stripText:n,stripSurroundingWhitespace:r,emojiData:de().Z.state})}function To(e){const{environment:t,html:o,transaction:n,stripText:r,stripSurroundingWhitespace:i,disableEmbedMenu:a,selectAll:s,markdownLinkifyIt:l,tinyMceMicrosoftWordPasteFilter:c}=e,d="editing"===We().default.state.mode&&We().default.state.multiSelection;if(d){const e=So({html:o,stripText:r,stripSurroundingWhitespace:i,markdownLinkifyIt:l,tinyMceMicrosoftWordPasteFilter:c});if(!e)return;const u=(0,Te().sQ)(d.start.store),p=1===e.length;if(p){if(p&&(!e[0][1]||0===e[0][1].length)){n.logDebugMessage("pasteInlineHtml: insertString");const o=e[0][0];return void dt().hJ({environment:t,editorMode:u?Ue().MT.getMode(u):"default",multiSelection:d,string:o,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:n,selectAll:s})}const o=(0,ye().QY)(d);if(o&&!(0,ye().iG)(d)){const[,r]=e[0],i=r&&W().rlz(r);if(i){n.logDebugMessage("pasteInlineHtml: pasteLinkOverText");return void Do({environment:t,text:W().zW$(i),transaction:n,editingSelection:o,selectAll:s})}}}n.logDebugMessage("pasteInlineHtml: delete selection and insert"),dt().pz({environment:t,multiSelection:d,transaction:n}),fo({environment:t,store:d.start.store,tokens:e,index:d.start.index,transaction:n,disableEmbedMenu:a,multiTextSelection:d,selectAll:s})}}function xo(e){const{environment:t,html:o,transaction:n,tinyMceMicrosoftWordPasteFilter:r}=e,i=ue().RM();if(!i)return;const s=Mo({environment:t,html:o,tinyMceMicrosoftWordPasteFilter:r,useCrdt:i.useCrdt()});if(!s)return;const{allOperations:l,rootContentIds:d}=s;for(const a of l)if((0,Z().Qf)(a)){const e=Ne().G.createChildStore(i,a.pointer);_t().applyCrdtTextOperation({store:e,operation:a,invertedOperation:void 0,transaction:n})}else if((0,R().V_)(a)){const e=(0,Ne().Kv)(i,a.pointer);_t().applyOperation({store:e,operation:a,transaction:n})}else(0,X().t1)(a);const u=d.map((e=>Ne().G.createChildStore(i,{table:E().iU,id:e})));u.forEach((e=>{const o=e.getType();o&&Xe().W(t,{from:"paste",type:o,creating_block_id:e.id,parent_collection_id:e.getParentCollectionIdUpToTwoLevels()})}));const p=bo({environment:t,blocks:u,transaction:n,replaceEmptyTextBlock:!0}).slice().reverse();return a().default.afterNextFlush((()=>{const e=p.map((e=>{if(e.getType()!==c().Ti.text)return;const o=go(e.getTitleValue());if(!o)return;const n=(0,U().parseRoute)({url:o.url,baseUrl:ae().default.domainBaseUrl,publicDomainName:ae().default.publicDomainName,isMobile:t.device.isMobile,protocol:ae().default.protocol,currentUrl:window.location.href});return"page"===n.name?n:void 0})).filter(X().$K);et()._x({environment:t,rootStore:i,blocks:p,copiedLinks:e})||et().QS({environment:t,blocks:p})})),u}function Co(e){const{currentUserStore:t}=Be().default.state,o=ue().RM();if(!t||!o)return;const n=t.id;if(!n)return;const r=o.id,i=o.pointer.spaceId,a=(0,be().TS)({environment:e,table:E().iU,spaceId:i});return{operation:{pointer:{table:"block",id:a,spaceId:i},command:"set",path:[],args:{id:a,version:1,type:"text",properties:{title:[[""]]},parent_id:r,parent_table:"block",space_id:i,created_by_table:"notion_user",created_by_id:n,created_time:Date.now(),last_edited_by_table:"notion_user",last_edited_by_id:n,last_edited_time:Date.now(),alive:!0}},id:a}}function Mo(e){const{environment:t,useCrdt:o,...n}=e,r=document.createElement("div");r.innerHTML=wo(n);const{currentUserStore:i}=Be().default.state,a=ue().RM();if(!i||!a)return;const l=i.getValue();if(!l)return;const c=a.getSpaceId(),d=(0,be().l5)({environment:t,spaceId:c}),u=t.idCreator.getSpaceShortIdCreator(c,d);return x().$O({actor:(0,s().dp)(l),parent:{id:a.id,table:E().iU,spaceId:c},rootNode:r,deps:{importFileMap:{},window,intl:ve().Z.getIntl(),randomID:J().ZP,spaceIdCreator:u,randomShortID:q().ZP,isPhoneNumber:P().x,emojiData:de().Z.state},options:{useCrdt:o,ignoreBlockCount:!1}})}function Io(e){return/schemas-microsoft-com:office/.test(e)||/xmlns:m="http:\/\/schemas.microsoft.com\/office\/2004\/12\/omml"/.test(e)}function wo(e){const{html:t,tinyMceMicrosoftWordPasteFilter:o}=e;return r().sanitize(o&&Io(t)?o(t):t)}function _o(e){const t="editing"===e.mode&&e.multiSelection;if(!t)return;const o=_e().E.findEditableWithStore(t.start.store),n=null==o?void 0:o.props;return n&&!n.disabled?n.pasteBehavior:void 0}function Fo(){var e;if("editing"!==We().default.state.mode)return;const t=We().default.state.multiSelection.start,o=t.store.path;if("formula"!==o[o.length-1])return;const n=t.store.getRecordStoreAtRootPath();if((null==n?void 0:n.table)!==E().iU)return;const r=null==n||null===(e=n.getPropertiesStore())||void 0===e||null===(e=e.getValue())||void 0===e||null===(e=e.collection_id)||void 0===e||null===(e=e[0])||void 0===e?void 0:e[0];if(!r)return;const i={table:G().vF,id:r,spaceId:n.getSpaceId()},a=n.getRecordModel(i);return a?{parentCollection:a,start:t,getRecordModel:n.getRecordModel}:void 0}function Ro(){const e=Oe().default.state.stores;if("editing"!==We().default.state.mode)return e.length>0&&e[0].isInsideFactoryOrDuplicateBlocksAction();if(0===e.length)return!1;const{multiSelection:t}=We().default.state,o=t.start.store;if(!o.isTable(E().iU))return!1;const n=fe().W(o);return Boolean(n)}function Do(e){const{text:t,transaction:o,environment:n,editingSelection:r,selectAll:i}=e,a=(0,U().parseRoute)({url:t,baseUrl:ae().default.domainBaseUrl,publicDomainName:ae().default.publicDomainName,isMobile:n.device.isMobile,protocol:ae().default.protocol,currentUrl:window.location.href}),s="page"===a.name&&a.blockId?(0,M().nR)({pageId:a.blockId,peekViewBlockId:a.peekViewBlockId,peekMode:a.peekMode,discussionId:a.discussionId,scrollToBlockId:a.scrollToBlockId,collectionViewId:a.collectionViewId}):t,l=dt().ao({environment:n,store:r.store,selection:r.selection,transaction:o});dt().ST({environment:n,store:r.store,selection:l,annotationKey:"a",transaction:o,updateSelection:!1}),wt().WO({environment:n,store:r.store,selection:l,annotation:["a",s],transaction:o}),ut().setSelection({store:r.store,selection:{startIndex:i?l.startIndex:l.endIndex,endIndex:l.endIndex}})}const Po=/\<\!-- wp:/;const Bo=/\u2028/g;function Vo(e){var t;let{environment:o,event:r,disableEmbedMenu:i,transaction:a,onPasteFiles:s,formulasModule:l,markdownLinkifyIt:d,tinyMceMicrosoftWordPasteFilter:u}=e;const p=Ee().default.checkGate({gateName:"allow_cut_copy_comment"});if(r.preventDefault(),ut().syncTextSelection(),!r.clipboardData)return;const f=Jt(r.clipboardData,o.device),g=Array.from(Array((null===(t=f.items)||void 0===t?void 0:t.length)??0).keys()).flatMap((e=>{var t;const o=f.items[e];if("file"!==o.kind)return[];const n=null===(t=o.getAsFile())||void 0===t||null===(t=t.name.match(/\.[^.]+$/))||void 0===t?void 0:t[0];return n?[n]:[]})),b=f.getData("text/html"),k=null==b?void 0:b.length;qe().VJ(o,{source:"editor",types:f.types||[],fileExtensions:g,htmlContent:b});const{text:v,html:h,multiTextSelectionData:S,textSelectionData:x,blockSelectionData:C,isFromMicrosoftOffice:M,isHtmlTable:I}=eo({clipboardData:f,tinyMceMicrosoftWordPasteFilter:u}),w=Xt(f,Gt,Ht),_=function(e){return e.clipboardData?e.clipboardData.items?z().oA(Array.from(e.clipboardData.items).map((e=>{const t=e.getAsFile();if(t&&t.size>0)return new File([t],t.name??ve().Z.formatMessage(Pt.untitled),{type:e.type})}))):m().p4(e.clipboardData.files):[]}(r),F=_o(We().default.state),R=(null==C?void 0:C.action)||(null==S?void 0:S.action)||(null==x?void 0:x.action);a.annotateWithUserAction("cut"===R?"paste.from_cut":pe().xF);const D=v.includes("\n"),P="body"===(0,Me().qK)()&&!x;if((_.length>0||C||D&&!P)&&!(0,Ze().ww)(o))return;const B=function(e){const t=Xt(e,Lt,Yt),o=null==t?void 0:t.mode;if(!o)return;return Vt[o]||"Plain Text"}(f),V=D&&B&&"inline"!==F&&!(0,Me().qK)()?Ao({codeLanguage:B,environment:o,transaction:a}):void 0;He().bO(o,{pastedText:v,source:"editor_paste"});const A=Re().UQ(),U=Re().mv(),E=r.clipboardData.getData(ne().mH),G=Fo();if(_.length>0&&!M&&!I)a.logDebugMessage("paste: file/image detected -> onPasteFiles"),s({environment:o,files:_,transaction:a});else if(P)a.logDebugMessage("paste: editing code block contents with no Notion text selection -> pasteRawText"),Uo(o,v,a);else if(V)a.logDebugMessage("paste: pasting code in existing empty text block with no selection or new code block after selection  -> pasteRawText"),Uo(o,v,a);else if(G){a.logDebugMessage("paste: formulaInformation detected, attempting to paste as formula");const{parentCollection:e,start:t}=G,n=[[v]],r=e;if(!r||!l)return void Uo(o,v,a);const i=We().default.state;"multiSelection"in i&&dt().pz({environment:o,multiSelection:i.multiSelection,transaction:a});const s=(0,y().UQ)({formulasModule:l,getRecordModel:G.getRecordModel,sourceCollection:r,textValue:n,featureGates:(0,me().W)()});dt().mM({environment:o,tokens:s,store:t.store,index:t.index,transaction:a})}else if("plaintext"===F)a.logDebugMessage("paste: plaintext paste behavior detected, pasting as inline html"),To({environment:o,html:v,transaction:a,stripText:!0,stripSurroundingWhitespace:!0,disableEmbedMenu:i,markdownLinkifyIt:d,tinyMceMicrosoftWordPasteFilter:u}),ze({environment:o,type:"plaintext",originalHtmlContentSize:k});else if(S){a.logDebugMessage("paste: multiTextSelectionData detected, attempting to paste as textselection");const e=function(e){const{environment:t,transaction:o,multiTextSelectionData:n,disableEmbedMenu:r,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:a}=e,s=e.pasteBehavior||"inline",l=e.html||oo({markdown:e.text,markdownLinkifyIt:i});if("editing"===We().default.state.mode)switch(s){case"inline":return!!l&&(To({environment:t,html:l,transaction:o,stripText:!1,stripSurroundingWhitespace:!0,disableEmbedMenu:r,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:a}),!0);case"block":return pt({environment:t,clipboardData:n,transaction:o,preventLegacyTransclusions:(0,ke().hC)()});default:(0,X().t1)(s)}}({multiTextSelectionData:S,environment:o,html:h,text:v,transaction:a,disableEmbedMenu:i,pasteBehavior:F,markdownLinkifyIt:d,tinyMceMicrosoftWordPasteFilter:u});e||(a.logDebugMessage("paste: could not paste as textSelection -> paste as blockSelection"),ko(o,S.blockSelection,w,a))}else if(x&&x.editing){a.logDebugMessage("paste: textSelectionData detected, pasting text selection");const e=(0,oe().dI)(),t=(null==w?void 0:w.id)!==(null==e?void 0:e.id);!function(e){const{environment:t,textSelectionData:o,transaction:n,disableEmbedMenu:r,removeDiscussions:i}=e,a=Oe().default.getCurrentRecordCache(),{editing:s,selection:l}=o;let{tokensInsideRange:d}=W().xrQ(s,l.startIndex,l.endIndex);d=W().V3g(d,{removeSuggestionAnnotationsAndText:!1,removeSuggestionAnnotations:!0,removeDiscussions:i??!0});const u=(0,ue().RM)();if(u&&!(u.isInsideTemplate()||Ro()||u.isInsideFactoryOrDuplicateBlocksAction())&&(d=(0,Y().KV)(d,{currentUserId:t.currentUser.id,currentTimeZone:(0,T().r)()})),"body"===(0,Me().qK)()){const e=W().vNd(d);e&&(d=e)}const p="editing"===We().default.state.mode&&We().default.state.multiSelection;if(p){if(!(0,ye().iG)(p)){const t=(0,ye().QY)(p);if(t){const n=W().KU1(o.editing,o.selection.startIndex,o.selection.endIndex);if(1===n.length){const[o,r]=n[0],i=r&&W().rlz(r);if(i){const n=W().zW$(i);if([o,`http://${o}`,`https://${o}`].includes(n))return void Do({environment:e.environment,text:n,transaction:e.transaction,editingSelection:t})}}}}const i=(0,Te().sQ)(p.start.store),a=i?Ue().MT.getMode(i):"default";if("suggest"===a){const e=ie().oG(t,n,p);ie().Sz({environment:t,multiSelection:p,transaction:n,discussionStore:e}),d=W().WO0({textValue:d,selection:{startIndex:0,endIndex:1/0},annotation:[W().GKr.SuggestionInsertText,e.id]})}else"default"===a&&dt().pz({environment:t,multiSelection:p,transaction:n});const s=We().default.state;if("editing"===s.mode){const e=s.multiSelection;if(o.blockType&&0===l.startIndex){const r=(0,Te().sQ)(e.start.store);r&&"page"!==o.blockType&&(0,Se().Nm)(r)&&ce().transformBlocks({environment:t,blocks:[r],blockType:o.blockType,transaction:n})}fo({environment:t,store:e.end.store,tokens:d,index:e.end.index,transaction:n,disableEmbedMenu:"suggest"===a||r,multiTextSelection:p})}}else if(a){var m;const e=Oe().default.state.stores,o=Tt().j4({environment:t,type:c().Ti.text,inMemoryRecordCache:a,transaction:n,spaceId:0!==e.length?e[e.length-1].pointer.spaceId:null===(m=ue().RM())||void 0===m?void 0:m.pointer.spaceId}),r=o.getTitleStore();r&&dt().mM({environment:t,store:r,tokens:d,index:0,transaction:n}),bo({environment:t,blocks:[o],transaction:n,replaceEmptyTextBlock:!1}),Xe().W(t,{from:"paste",type:c().Ti.text,creating_block_id:o.id,parent_collection_id:o.getParentCollectionIdUpToTwoLevels()})}}({environment:o,textSelectionData:x,transaction:a,disableEmbedMenu:i,removeDiscussions:!p||("copy"===R||t)})}else if(C&&C.blocks.length>0&&"inline"!==F)a.logDebugMessage("paste: blockSelectionData detected, pasting block selection"),ko(o,C,w,a);else if(A&&U&&E){const{simpleTableStore:e}=A.getProps(),{selection:t}=U,i=Re().h4(e);t&&i&&It().j0({clipboardActions:n,environment:o,simpleTableStore:e,selection:t,currentRows:e.getContentStores(),columnOrder:i,event:r,transaction:a,markdownLinkifyIt:d,tinyMceMicrosoftWordPasteFilter:u})}else if(h)if(A&&U){const{simpleTableStore:e}=A.getProps(),{selection:t}=U,i=Re().h4(e);t&&i&&(a.logDebugMessage("paste: pasting selection into simple table"),It().j0({clipboardActions:n,environment:o,simpleTableStore:e,selection:t,currentRows:e.getContentStores(),columnOrder:i,event:r,transaction:a,markdownLinkifyIt:d,tinyMceMicrosoftWordPasteFilter:u}))}else(D||I)&&"inline"!==F?(a.logDebugMessage("paste: pasting as html"),xo({environment:o,html:h,transaction:a,tinyMceMicrosoftWordPasteFilter:u}),ze({environment:o,type:"html",originalHtmlContentSize:k})):(a.logDebugMessage("paste: pasting as inline html"),To({environment:o,html:h,transaction:a,stripText:!1,stripSurroundingWhitespace:!1,disableEmbedMenu:i,markdownLinkifyIt:d,tinyMceMicrosoftWordPasteFilter:u}),ze({environment:o,type:"inline_html",originalHtmlContentSize:k}));else a.logDebugMessage("paste: pasting as markdown"),vo({environment:o,text:v,disableEmbedMenu:i,transaction:a,markdownLinkifyIt:d,tinyMceMicrosoftWordPasteFilter:u}),ze({environment:o,type:"markdown",originalHtmlContentSize:k});Le().default.setKeyboardMode(!0)}function Ao(e){const{codeLanguage:t,environment:o,transaction:n}=e,r=We().default.state,i="editing"===r.mode&&r.multiSelection,a=Oe().default.state.stores;if(!i&&0===a.length)return;let s,l,d;if(i?(s=i.start.store,l=i.end.store,d=(0,Te().sQ)(l)):(s=a[0],l=a[a.length-1],d=l),!d)return;let u=d;if((0,Se().Nm)(d))!function(e){const{blockStore:t,environment:o,transaction:n,codeLanguage:r}=e;ce().transformBlocks({environment:o,blocks:[t],blockType:"code",transaction:n}),gt().E5({blocks:[t],language:r,transaction:n})}({blockStore:d,environment:o,transaction:n,codeLanguage:t});else{const e=(0,Te().sQ)(d);if(!e)return;const t=s.inMemoryRecordCache;if(!t)return;u=Tt().j4({environment:o,type:c().Ti.code,inMemoryRecordCache:t,transaction:n,spaceId:e.pointer.spaceId}),St().BE({parentStore:e.getContentStore(),afterStore:l,insertStore:u,transaction:n})}Ce().clear(o);const p=(0,Te().mh)(u);return p&&ut().setSelectionAtStart({store:p}),u}function Uo(e,t,o){const n="editing"===We().default.state.mode&&We().default.state.multiSelection;if(n){const r=(0,Te().sQ)(n.start.store);dt().hJ({environment:e,editorMode:r?Ue().MT.getMode(r):"default",multiSelection:n,string:t,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:o})}}function Eo(e){const t=e.getNavigableBlockStore();if(t)return(0,ge().Hu)({store:t,scrollToBlockId:t.id===e.id?void 0:e.id,fullyQualified:!0,pageVisitSource:l().tY.CopyLink,embedded:!1})}function Go(e){const{environment:t,blocks:o}=e,n=o[0];(0,re().w)(),Fe().MO();const r=Eo(n);if(r){Zo({environment:t,stringValue:r,copiedMessage:n.isPageBlock()||n.isFormBlock()?Bt.copiedLinkToClipboard:Bt.copiedBlockLinkToClipboard})}}function Lo(e){const{environment:t,blocks:o}=e,n=o[0];(0,re().w)(),Fe().MO();const r=Eo(n),i=function(e,t){var o;const n=Eo(t);if(!n)return;const r=e.currentUser.id,i=(0,g().Ho)({blockId:t.id,intl:ve().Z.getIntl(),getRecordValue:t.inMemoryRecordCache.makeGetRecordValueFn(r),userTimeZone:(0,T().r)()}),a=null===(o=t.getBlockIconStore())||void 0===o?void 0:o.getValue(),s=[(0,I().Z)(a)?a:void 0,i].filter(X().$K).join(" ");if(!s)return n;let l=`<a href="${n}"><span>${s}</span></a>`;return Ee().default.checkGate({gateName:"paste_links_as_mentions"})&&(l+=(0,pe().Py)({id:t.id,spaceId:t.getSpaceId()})),l}(t,n);if(r&&i){Wo({environment:t,stringValue:r,htmlValue:i,copiedMessage:n.isPageBlock()?Bt.copiedPageLinkToClipboard:n.isFormBlock()?Bt.copiedFormLinkToClipboard:Bt.copiedBlockLinkToClipboard})}}function No(e){const{environment:t,blocks:o}=e;if(o.length<2)return Go(e);(0,re().w)(),Fe().MO();const n=o.map(Eo).filter(X().$K);if(n.some(Boolean)){const e=n.length>1?Bt.copiedLinksToClipboard:Bt.copiedLinkToClipboard;Zo({environment:t,stringValue:n.join("\n\n"),copiedMessage:e})}}function Oo(e){const{environment:t,blocks:o}=e,n=o[0];if(!n.isDefined())return;const r=n.getModel(),i=n.getProperties(),a=n.getFormat();let s;if(n.isType(c().Ti.bookmark))s=null==i?void 0:i.link,s=W().QaF(s);else if(r.isType(c().Ok))s=null==i?void 0:i.source,s=W().QaF(s);else if(n.isType(c().Ti.file))s=null==i?void 0:i.source,s=W().QaF(s);else if(n.isType(c().Ti.externalObjectInstance)||n.isType(c().Ti.externalObjectInstancePage))s=(null==a?void 0:a.original_url)||(null==a?void 0:a.uri);else if(n.isType(c().Ti.collectionView)){var l;const e=null===(l=n.getCollectionStore())||void 0===l?void 0:l.getValue();var d;if(e&&(0,b().Gq)(e))s=null===(d=e.format)||void 0===d?void 0:d.original_url}else{if(!n.isType(c().Ti.alias))return;s=null==a?void 0:a.comment_alias_url}if(!s)return;if(k().iS(s))return void h().log({level:"error",from:"clipboardActions",type:"copyDirectLinkToContent",error:{message:"Attempted to copy a direct signed url for S3-housed content."}});if(s=ee().yn(s),!s)return;(0,re().w)(),Fe().MO();Zo({environment:t,stringValue:s,copiedMessage:Bt.copiedLinkToClipboard})}function Wo(e){return Ho(e)}function Zo(e){return Ho(e)}async function Ho(e){const{environment:t,htmlValue:o,stringValue:n,copiedMessage:r,showCopyModal:i}=e;function a(){Ct().ZH({environment:t}),Ve().default.setState({...Ve().default.state,active:!0,stringValue:n})}if(i)a();else try{var s;if(t.device.isElectron&&null!==(s=kt().electronApi)&&void 0!==s&&s.clipboard){const e={text:n};o&&(e.html=o),await kt().electronApi.clipboard.write(e)}else if("undefined"==typeof ClipboardItem)await navigator.clipboard.writeText(n);else{const e={"text/plain":new Blob([n],{type:"text/plain"})};o&&(e["text/html"]=new Blob([o],{type:"text/html"}));const t=new ClipboardItem(e);await navigator.clipboard.write([t])}r&&Mt().oV({label:ve().Z.formatMessage(r)})}catch{a()}}function Yo(){document.queryCommandSupported("copy")&&document.execCommand("copy")}async function Ko(e,t){let o;o="string"==typeof t?t:JSON.stringify(t),o&&await Zo({environment:e,stringValue:o,copiedMessage:Bt.copiedToClipboard})}function jo(e){const{environment:t,textSelection:o,markdownSerializationOptions:n,markdownLinkifyIt:r}=e,i=(0,ye().QY)(o);if(i&&i.selection.startIndex!==i.selection.endIndex)return function(e){const{environment:t,singleStoreTextSelection:o,markdownSerializationOptions:n}=e,{store:r,selection:i}=o,a=t.currentUser.id,s=r.inMemoryRecordCache,c=ve().Z.getIntl(),d=r.getValue(),p=W().KU1(d,i.startIndex,i.endIndex),m=r.getRecordStoreUIRoot().getValue();if(!m)return;const f={id:m.id,table:E().iU,spaceId:m.space_id},g=s.makeGetRecordValueFn(a);return _().CK({textValue:p,exportArgs:{root:f,navigableBlockId:f.id,renderParentBlockId:void 0,blockId:f.id,userTimeZone:(0,T().r)(),intl:c,getRecordValue:g,numberedListCache:{},bulletedListCache:{},getRecordsWithParent:()=>[],getExportedPathToFile:e=>{let{toFileURI:t}=e;return t},getExportedRenderAsset:e=>{let{toFileURI:t}=e;return t},getExportedPathToPage:e=>{let{toPageId:t}=e;return(0,u().Z)({pageId:t,pageValue:g({table:E().iU,id:t}),baseUrl:ae().default.domainBaseUrl,pageVisitSource:l().tY.Export})},baseUrl:ae().default.domainBaseUrl,publicDomainName:ae().default.publicDomainName,transformAnnotation:null==n?void 0:n.transformAnnotation,transformBlockMapping:null==n?void 0:n.transformBlockMapping,resultCache:new Map,regExpCache:new Map,experimentService:Ee().default,collectionFeatureGates:(0,me().W)(),formulasModule:v()}})}({environment:t,singleStoreTextSelection:i,markdownSerializationOptions:n});const a=ao({environment:t,multiSelection:o,action:"copy"});if(!a)return;const s=o.start.store.inMemoryRecordCache,c=o.start.store.getRecordStoreUIRoot().getValue();if(!c)return;const d=t.currentUser.id,{markdown:p}=(0,pe().Ef)({clipboardData:a,rootBlock:{id:c.id,table:E().iU,spaceId:c.space_id},isWindows:t.device.isWindows,fallbackGetRecordValue:s.makeGetRecordValueFn(d),markdownSerializationOptions:n,markdownLinkifyIt:r,formulasModule:v()});return p}function $o(e){const{environment:t,inMemoryRecordCache:o,text:n,transaction:r,markdownOptions:i,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:l}=e,c=oo({markdown:n,markdownOptions:i,markdownLinkifyIt:a});if(!c)return;const d=document.createElement("div");d.innerHTML=wo({html:c,tinyMceMicrosoftWordPasteFilter:l});const{currentUserStore:u,currentSpaceStore:p}=Be().default.state;if(!u||!p)return;const m=u.getValue();if(!m)return;const f=(ue().RM()??p).id,g=p.id,b=(0,be().l5)({environment:t,spaceId:g}),k=t.idCreator.getSpaceShortIdCreator(g,b),{allOperations:v,rootContentIds:y}=x().$O({actor:(0,s().dp)(m),parent:{id:f,table:E().iU,spaceId:p.id},rootNode:d,deps:{importFileMap:{},window,intl:ve().Z.getIntl(),randomID:J().ZP,spaceIdCreator:k,randomShortID:q().ZP,isPhoneNumber:P().x,emojiData:de().Z.state},options:{useCrdt:(0,se().WA)(p),ignoreBlockCount:!1}});for(const s of v)if((0,Z().Qf)(s)){const e=new(Ne().G)(t,s.pointer,{inMemoryRecordCache:o,userId:m.id});_t().applyCrdtTextOperation({store:e,operation:s,invertedOperation:void 0,transaction:r})}else if((0,R().V_)(s)){const e=new(Ne().ST)({environment:t,pointer:s.pointer,recordStoreOptions:{inMemoryRecordCache:o,userId:m.id}});_t().applyOperation({store:e,operation:s,transaction:r})}else(0,X().t1)(s);return y.map((e=>new(Ne().G)(t,{table:E().iU,id:e},{inMemoryRecordCache:o})))}function Qo(e){const{event:t,markdownLinkifyIt:o,tinyMceMicrosoftWordPasteFilter:n}=e;if(!t.clipboardData)return;const{text:r,html:i,multiTextSelectionData:a,textSelectionData:s,blockSelectionData:l}=eo({clipboardData:t.clipboardData,tinyMceMicrosoftWordPasteFilter:n});if(a)return So({text:r,html:i,stripText:!1,stripSurroundingWhitespace:!0,markdownLinkifyIt:o,tinyMceMicrosoftWordPasteFilter:n});if(s){const{editing:e,selection:t}=s;return W().V3g(W().xrQ(e,t.startIndex,t.endIndex).tokensInsideRange,{removeSuggestionAnnotationsAndText:!1,removeSuggestionAnnotations:!0,removeDiscussions:!0})}return i||r?function(e){const{text:t,html:o,blockSelectionData:n,markdownLinkifyIt:r,tinyMceMicrosoftWordPasteFilter:i}=e,a=t.includes("\n");return a||n&&n.blocks.length>0?W().TPx(t):So({text:t,html:o,stripText:!1,stripSurroundingWhitespace:!0,markdownLinkifyIt:r,tinyMceMicrosoftWordPasteFilter:i})}({text:r,html:i,blockSelectionData:l,markdownLinkifyIt:o,tinyMceMicrosoftWordPasteFilter:n}):void 0}},905:(e,t,o)=>{o.d(t,{QZ:()=>P,az:()=>V,pg:()=>B});var n=()=>o(66077),r=()=>o(435308),i=()=>o(156642),a=()=>o(530980),s=()=>o(54193),l=()=>o(396136),c=()=>o(542973),d=()=>o(81954),u=()=>o(955620),p=()=>o(696459),m=()=>o(636340),f=()=>o(879952),g=()=>o(990966),b=()=>o(205228),k=()=>o(223321),v=()=>o(852465),y=()=>o(505462),h=()=>o(639832),S=()=>o(490091),T=()=>o(656769),x=()=>o(788206),C=()=>o(543842),M=()=>o(826955),I=()=>o(439373),w=()=>o(351972),_=()=>o(282662),F=()=>o(143346),R=()=>o(970105),D=()=>o(269299);function P(e){const{environment:t,textStore:o,blockStore:i,url:a,oldTextValue:u,urlSelection:p}=e;if(h().Z.state.open||k().Z.state.open||C().Z.state.open||T().Z.state.open)return!1;const m=y().get();if(!m)return!1;const f=y().getRect(m);if(!f)return!1;const g=(0,s().parseRoute)({url:a,baseUrl:b().default.domainBaseUrl,publicDomainName:b().default.publicDomainName,isMobile:t.device.isMobile,protocol:b().default.protocol,currentUrl:window.location.href});if("page"===g.name&&!!g.discussionId&&g.discussionId){const e=g.discussionId,s=g.blockId;if(!s)return!1;const m=i.getParentBlockStore();if(!m)return!1;const b=(0,M().Kv)(m,{table:l().iU,id:s,spaceId:(0,d().J)(m.pointer.spaceId)}),k=(0,M().Kv)(b,{table:c().qF,id:e,spaceId:(0,d().J)(i.pointer.spaceId)});if("none"===k.getRole())return!1;const y=new(r().default)((()=>v().D4(k)[0]),{debugName:"firstCommentStore"}),h=new(n().Z)({name:"internalUnfurlingMenuActions.activate",isTemporaryData:!0});t.defaultRecordCache.inMemoryRecordCache.addCacheOverride(h);const T=i.clone(h),C=o.clone(h),I=m.clone(h);return x().Z.setState({args:{commentStore:y},stores:{blockStore:i,textStore:o,parentStore:m},temporaryStores:{blockStore:T,textStore:C,parentStore:I},temporaryRecordCache:h,focusedIndex:S().Z.Preview,selectionRect:f,oldTextValue:u,open:!0,url:a,urlSelection:p}),w().el(t,{url:a}),!0}return!1}function B(e){const{actionType:t,environment:o,commentStore:n,useTempStores:r}=e,i=x().Z.state;if(!i.open)return;const{oldTextValue:s}=i,l=r?i.temporaryStores:i.stores,{textStore:c,blockStore:m,parentStore:b}=l,k=o.currentUser.id;if(k){if(r){i.temporaryRecordCache.clearCache();for(const e in i.temporaryStores){const t=i.temporaryStores[e],n={userId:k,pointer:t.pointer},r=o.defaultRecordCache.inMemoryRecordCache.getRecord(n);r?F().Wl({environment:o,inMemoryRecordCache:i.temporaryRecordCache,pointer:t.pointer,model:a().kk5.fromValue(t.pointer.table,r.value),role:r.role,updatePaths:[[]],userId:k,force:!0,debugSource:"setUnfurlType"}):F().uo({environment:o,inMemoryRecordCache:i.temporaryRecordCache,persistedRecordCache:void 0,pointer:t.pointer,userId:k})}}else o.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(i.temporaryRecordCache);switch(t){case S().Z.Link:f().eP({environment:o,store:i.stores.blockStore}),g().setSelection({store:i.stores.textStore,selection:{startIndex:i.urlSelection.endIndex,endIndex:i.urlSelection.endIndex}}),x().Z.setState({...i,focusedIndex:S().Z.Link});break;case S().Z.Mention:if(!n)return;const e=(0,d().J)(c.pointer.spaceId);if(!e)return;const r=n.id;D().createAndCommit({environment:o,userAction:"internalUnfurlingMenuActions.mention",canUndo:!0,perform:t=>{R().sO({environment:o,store:c,value:s,transaction:t}),R().lZ({environment:o,editorMode:"default",store:c,selection:{startIndex:i.urlSelection.startIndex,endIndex:i.urlSelection.startIndex},annotation:u().mfJ(r,e),transaction:t,analyticsFrom:"block"})}}),x().Z.setState({...i,focusedIndex:S().Z.Mention});break;case S().Z.Preview:if(!n)return;D().createAndCommit({environment:o,userAction:"internalUnfurlingMenuActions.preview",canUndo:!0,perform:e=>{R().sO({environment:o,store:c,value:s,transaction:e});const t=v().GP(n);if(!t)return;if(!v().HK(t)||!b||!t.getParentId())return;const r=I().k({environment:o,parentBlockStore:b,targetStore:n,transaction:e});if(_().BE({parentStore:b.getContentStore(),insertStore:r,afterStore:m,transaction:e}),0===u().QaF(i.oldTextValue).trim().length){const t=M().G.createChildStore(b.getContentStore(),i.stores.blockStore.pointer);_().Od({parentStore:b.getContentStore(),childToRemoveStore:t,transaction:e})}}}),x().Z.setState({...i,focusedIndex:S().Z.Preview});break;default:throw(0,p().t1)(t)}r||x().Z.setState({open:!1})}}function V(e){var t,o;const{blockStore:n,transaction:r}=e,a=n.getType(),s=n.getFormat(),l=n.getSpaceId();if(!n.isDefined()||a!==i().Ti.alias||null==s||null===(t=s.alias_pointer)||void 0===t||!t.id)return;const c=[u().YCD(u().mfJ(null==s||null===(o=s.alias_pointer)||void 0===o?void 0:o.id,l))];m().sW({store:n,data:{type:i().Ti.text},transaction:r}),m().sW({store:n.getFormatStore(),data:{alias_pointer:null},transaction:r}),R().sO({environment:n.environment,store:n.getBlockTitleStore(),value:c,transaction:r})}},630903:(e,t,o)=>{o.r(t),o.d(t,{maybeTurnCollectionViewIntoCollectionViewPage:()=>x,transformBlocks:()=>T,transformIntoColumnList:()=>C});o(241792);var n=()=>o(492788),r=()=>o(156642),i=()=>o(396136),a=()=>o(513670),s=()=>o(282662),l=()=>o(332542),c=()=>o(771678),d=()=>o(636340),u=()=>o(453999),p=()=>o(879952),m=()=>o(990966),f=()=>o(269299),g=()=>o(28063),b=()=>o(540413),k=()=>o(487270),v=()=>o(852465),y=()=>o(749826),h=()=>o(826955),S=()=>o(262453);function T(e){const{environment:t,blocks:o,blockType:S,transaction:T}=e;if(S!==r().Ti.transclusionContainer)if(S===r().Ti.callout&&y().default.checkGate({gateName:"create_v2_callouts"}))!function(e){const{environment:t,blocks:o,transaction:n}=e,a=o[0];if(!a)return;const s=a.getRecordStoreUIParent();if(!s||!(0,v().dz)(s))return;const u=s.getRecordStoreUIParent();if(!(u&&u instanceof h().G))return;const f=(0,k().TS)({environment:t,table:i().iU,spaceId:u.getSpaceId()}),g=d().j4({environment:t,id:f,type:r().Ti.callout,inMemoryRecordCache:s.inMemoryRecordCache,transaction:n,spaceId:u.getSpaceId(),format:{callout_version:2}});l().jG({parentStore:s,childStore:g,after:a.id,transaction:n});M({newParentStore:g.getContentStore(),blocks:o,transaction:n}),c().WO({store:g,transaction:n}),m().clear({environment:t}),p().ZH({environment:t}),p().Z5({environment:t,stores:[g]})}({environment:t,blocks:o,transaction:T});else if(S!==r().Ti.columnList)if(S!==r().Ti.slide)if((0,r().sX)(S)){const e=parseInt(S.replace("column","").replace("block","")),r=a().oA(a().DZ(e-1,(()=>b().insertTextBelow({environment:t,blocks:o,transaction:T})))),i=[...o,...r],s=C({environment:t,blocks:i,transaction:T});n().default.afterNextFlush((()=>{m().setSelectionAtStart({store:s[0].getBlockTitleStore()})}))}else for(const r of o)if(r.isCalloutV2()){const e=r.getParentBlockStore();if(e){const i=r.getContentStores();f().applyOperation({store:e,operation:{pointer:e.pointer,path:["content"],command:"insertChildrenAfter",args:{ids:i.map((e=>e.id)),after:r.id}},transaction:T}),l().hr({parentStore:e.getContentStore(),childStore:r,transaction:T});for(const e of i)g().vs({environment:t,block:e,blockType:S,transaction:T,isMultiBlockTransformation:o.length>1});n().default.afterNextFlush((()=>{u().DQ(t,i.map((e=>e.id)))}))}}else g().vs({environment:t,block:r,blockType:S,transaction:T,isMultiBlockTransformation:o.length>1});else!function(e){const{environment:t,blocks:o,transaction:n}=e,a=o[0];if(!a)return;const s=a.getRecordStoreUIParent();if(!s||!(0,v().dz)(s))return;const c=s.getRecordStoreUIParent();if(!(c&&c instanceof h().G))return;const u=(0,k().TS)({environment:t,table:i().iU,spaceId:c.getSpaceId()}),f=d().j4({environment:t,id:u,type:r().Ti.slide,inMemoryRecordCache:s.inMemoryRecordCache,transaction:n,spaceId:c.getSpaceId()});l().jG({parentStore:s,childStore:f,after:a.id,transaction:n});M({newParentStore:f.getContentStore(),blocks:o,transaction:n}),m().clear({environment:t}),p().ZH({environment:t}),p().Z5({environment:t,stores:[f]})}({environment:t,blocks:o,transaction:T});else C({environment:t,blocks:o,transaction:T});else!function(e){const{environment:t,blocks:o,transaction:n}=e,a=o[0];if(!a)return;const l=a.getRecordStoreUIParent();if(!l||!(0,v().dz)(l))return;const c=l.getRecordStoreUIParent();if(!c||!(0,v().OY)(c))return;if(!c.isDefined())return;const u=(0,k().TS)({environment:t,table:i().iU,spaceId:c.getSpaceId()}),f=d().j4({environment:t,id:u,type:r().Ti.transclusionContainer,inMemoryRecordCache:l.inMemoryRecordCache,transaction:n,spaceId:c.getSpaceId()});s().BE({parentStore:l,insertStore:f,afterStore:a,transaction:n});M({newParentStore:f.getContentStore(),blocks:o,transaction:n}),m().clear({environment:t}),p().ZH({environment:t}),p().Z5({environment:t,stores:[f]})}({environment:t,blocks:o,transaction:T})}function x(e){let{environment:t,blocks:o,transaction:n}=e;(function(e){return 1===e.length&&"collection_view"===e[0].getType()})(o)&&T({environment:t,blocks:o,blockType:"collection_view_page",transaction:n})}function C(e){const{environment:t,blocks:o,transaction:n}=e,a=o[0];if(!a)return[];const l=a.recordStoreUIParentStore;if(null==l||!l.valueIs(S().i))return[];const c=(0,k().TS)({environment:t,table:i().iU,spaceId:a.getSpaceId()}),u=d().j4({environment:t,id:c,type:r().Ti.columnList,inMemoryRecordCache:a.inMemoryRecordCache,transaction:n,spaceId:a.getSpaceId()}),{childStore:p}=s().Vt({parentStore:l,insertStore:u,beforeStore:a,transaction:n});return o.map((e=>{const o=(0,k().TS)({environment:t,table:i().iU,spaceId:a.getSpaceId()}),c=d().j4({environment:t,id:o,type:r().Ti.column,inMemoryRecordCache:a.inMemoryRecordCache,transaction:n,spaceId:a.getSpaceId()}),{childStore:u}=s().Od({parentStore:l,childToRemoveStore:e,transaction:n}),{childStore:m}=s().BE({parentStore:p.getContentStore(),insertStore:c,transaction:n}),{childStore:f}=s().BE({parentStore:m.getContentStore(),insertStore:u,transaction:n});return f}))}function M(e){const{newParentStore:t,blocks:o,transaction:n}=e;for(const r of o){const e=r.getRecordStoreUIParent();null!=e&&e.valueIs(S().i)&&(s().Od({parentStore:e,childToRemoveStore:r,transaction:n}),s().R3({parentStore:t,appendStore:r,transaction:n}))}}},490091:(e,t,o)=>{o.d(t,{Z:()=>r});var n=function(e){return e[e.Preview=0]="Preview",e[e.Mention=1]="Mention",e[e.Link=2]="Link",e}(n||{});const r=n},516623:(e,t,o)=>{o.d(t,{default:()=>r});class n extends(()=>o(263184))().default{getInitialState(){return{active:!1,stringValue:""}}}const r=new n},532306:(e,t,o)=>{o.d(t,{b:()=>i});var n=()=>o(594546),r=()=>o(749826);function i(e){const{environment:t,...o}=e;r().default.logEvent("import_entrypoint_cta",e.action),(0,n().j)({environment:t,event:{eventName:"import_entrypoint_cta",eventProperties:o}})}},922785:(e,t,o)=>{o.d(t,{O:()=>S});o(670560),o(122556),o(582845),o(250570),o(533019),o(721473),o(788208),o(22624),o(241792);var n=()=>o(816512),r=()=>o(532850),i=()=>o(646574),a=()=>o(874459),s=()=>o(910595),l=()=>o(374847),c=()=>o(665553),d=()=>o(530980),u=()=>o(728670),p=()=>o(396136),m=()=>o(955620),f=()=>o(496205);const g=i().ZV;function b(e){return(0,l().hJ)({...e,fromString:e=>e}).join("")}function k(e){const{textValue:t}=e;if(t){const o=[];for(const n of t)m().QJH(n)||o.push(b({...e,textValue:[n]}));return o.join(", ")}return""}const v={[m().GKr.Page]:e=>{let{annotation:t,exportArgs:o}=e;const{getExportedPathToPage:n}=o,r=m().TOT(t),i=(0,l().Ho)({intl:o.intl,blockId:r,getRecordValue:o.getRecordValue,userTimeZone:o.userTimeZone}),a=n({toPageId:r});if(i&&a)return`${i} (${a})`},[m().GKr.CustomEmoji]:e=>{let{annotation:t,exportArgs:o}=e;const{getRecordValue:n}=o,r=m().PtE(t);if(!r)return;const i=d().omK.fromGetRecordValueFn(n)(r);return i?i.getRenderTitle():void 0},[m().GKr.Comment]:e=>{let{annotation:t,exportArgs:n}=e;const{getRecordValue:r,baseUrl:i}=n,a=d().omK.fromGetRecordValueFn(r),s=m().$WM(t);if(!s)return;const l=a(s);if(!l)return;const c=l.getParentId(),p=l.getParentPointer(),f=(0,u().el)((0,u().DW)(p,r));if(!f)return;const g=a(p);let b;if(g){const e=a(g.getParentPointer());b=e&&"table_row"===e.getType()?e.getParentId():g.getParentId()}return(0,o(135857).Z)({pageId:f.id,scrollToBlockId:b,pageValue:f,baseUrl:i,discussionId:c,pageVisitSource:o(506347).tY.Export})},[m().GKr.Link]:e=>{let{annotation:t,exportArgs:n}=e;const{getExportedPathToFile:r,getExportedPathToPage:i,navigableBlockId:a,baseUrl:s,publicDomainName:l}=n,c=m().zW$(t),d=(0,o(526839).A5)({url:c,baseUrl:s,publicDomainName:l});return d?i({toPageId:d}):r({fromBlockId:a,toFileURI:c})},[m().GKr.User]:e=>{let{annotation:t,exportArgs:n}=e;const{intl:r}=n,i=m().zEN(t),a=n.getRecordValue({table:o(989478).KJ,id:i});if(a)return`@${(0,o(499110).Nz)(r,a)}`},[m().GKr.Bot]:e=>{let{annotation:t,exportArgs:n}=e;const r=m()._Rq(t),i=n.getRecordValue({table:o(696056).cZ,id:r});if(i)return`@${(0,o(163262).Mh)(i)}`},[m().GKr.Group]:e=>{let{annotation:t,exportArgs:o}=e;const n=(0,l().kF)({annotation:t,exportArgs:o});if(n)return n},[m().GKr.Team]:e=>{let{annotation:t,exportArgs:o}=e;const n=(0,l().cg)({annotation:t,exportArgs:o});if(n)return n},[m().GKr.ExternalObjectInstance]:e=>{var t;let{annotation:o,exportArgs:n}=e;const r=m().frW(o);return null===(t=n.getRecordValue({table:p().iU,id:r,spaceId:n.root.spaceId}))||void 0===t||null===(t=t.format)||void 0===t?void 0:t.original_url},[m().GKr.LinkMention]:e=>{let{annotation:t,exportArgs:o}=e;const{href:n}=m().r0m(t);return n},[m().GKr.Date]:e=>{let{annotation:t,exportArgs:o}=e;const{date_format:n,time_format:r,...a}=m().zyO(t);return`@${(0,i().ZV)({value:a,date_format:n,time_format:r,userTimeZone:o.userTimeZone,allowRelativeDates:!1,intl:o.intl})}`},[m().GKr.Equation]:e=>{let{annotation:t,exportArgs:o}=e;const n=(0,c().dx)(t),r=(0,c().wB)(t,o.getExportedPathToPage,o);return`${n}${m().xey(t)}${r}`},[m().GKr.Bold]:l().Hf,[m().GKr.Italic]:l().Hf,[m().GKr.Strike]:l().Hf,[m().GKr.Code]:l().Hf,[m().GKr.Highlight]:l().Hf,[m().GKr.Discussion]:l().Hf,[m().GKr.Underline]:l().Hf,[m().GKr.Inserted]:l().Hf,[m().GKr.Deleted]:l().Hf,[m().GKr.TemporaryComment]:l().Hf,[m().GKr.TemporaryCursor]:l().Hf,[m().GKr.TemporaryEquation]:l().Hf,[m().GKr.TemporaryPage]:l().Hf,[m().GKr.TemporaryInput]:l().Hf,[m().GKr.TemporarySelection]:l().Hf,[m().GKr.TemporaryFindHighlight]:l().Hf,[m().GKr.TemporarySelectedFindHighlight]:l().Hf,[m().GKr.TemplateVariable]:l().Hf,[m().GKr.FormulaPageProperty]:l().Hf,[m().GKr.FormulaContextValue]:l().Hf,[m().GKr.FormulaError]:l().Hf,[m().GKr.Citation]:l().Hf,[m().GKr.SuggestionInsertText]:l().Hf,[m().GKr.SuggestionRemoveText]:l().Hf,[m().GKr.SuggestionAnnotate]:l().Hf,[m().GKr.SuggestionUnannotate]:l().Hf,[m().GKr.TemporaryNativeMABFilter]:l().Hf,[m().GKr.TemporaryDictation]:l().Hf,[m().GKr.TemporaryHighlight]:l().Hf,[m().GKr.AssistantInstructionsCollection]:l().Hf,[m().GKr.TemporaryCommentHighlight]:l().Hf,[m().GKr.TemporarySuggestionUnderline]:l().Hf,[m().GKr.GeoPoint]:l().Hf};function y(){}function h(){return Promise.resolve(void 0)}const S={blockRenderers:{text:y,encrypted_text:y,header:y,sub_header:y,sub_sub_header:y,quote:y,bulleted_list:y,toggle:y,to_do:y,numbered_list:y,code:y,page:y,image:y,video:y,embed:y,bookmark:y,file:y,tweet:y,maps:y,gist:y,framer:y,invision:y,mixpanel:y,drive:y,figma:y,loom:y,pdf:y,typeform:y,codepen:y,audio:y,divider:y,equation:y,collection_view:y,collection_view_page:y,column_list:y,column:y,factory:y,copy_indicator:y,breadcrumb:y,link_to_collection:y,link_to_page:y,table_of_contents:y,callout:y,whimsical:y,miro:y,abstract:y,sketch:y,excalidraw:y,replit:y,alias:y,transclusion_container:y,transclusion_reference:y,external_object_instance:y,table:y,table_row:y,tab:y,hex:y,deepnote:y,external_object_instance_page:y,button:y,ai_block:y,drawing:y,slide:y,personal_home_page:y,form:y,post:y,workflow:y,transcription:y},asyncBlockRenderers:{text:h,encrypted_text:h,header:h,sub_header:h,sub_sub_header:h,quote:h,bulleted_list:h,toggle:h,to_do:h,numbered_list:h,code:h,page:h,image:h,video:h,embed:h,bookmark:h,file:h,tweet:h,maps:h,gist:h,framer:h,invision:h,mixpanel:h,drive:h,figma:h,loom:h,pdf:h,typeform:h,codepen:h,audio:h,divider:h,equation:h,collection_view:h,collection_view_page:h,column_list:h,column:h,factory:h,copy_indicator:h,breadcrumb:h,link_to_collection:h,link_to_page:h,table_of_contents:h,callout:h,whimsical:h,miro:h,abstract:h,sketch:h,excalidraw:h,replit:h,alias:h,transclusion_container:h,transclusion_reference:h,external_object_instance:h,table:h,table_row:h,tab:h,hex:h,deepnote:h,external_object_instance_page:h,button:h,ai_block:h,drawing:h,slide:h,personal_home_page:h,form:h,post:h,workflow:h,transcription:h},annotationRenderers:v,propertyRenderers:{title:e=>b(e),text:b,select:e=>{const{textValue:t,propertySchema:o}=e,n=o.options||[];return r().Sj(t,n)},multi_select:e=>{const{textValue:t,propertySchema:o}=e,n=o.options||[],i=r().uP(t,n);return i.sort(),i.join(", ")},status:e=>{const{textValue:t,propertySchema:o}=e;return r().ZG(t,o)},relation:e=>{const{textValue:t,propertySchema:o,exportArgs:n}=e;if("relation"!==o.type)return;const i=r().j$({relationValue:r().rq(t),getRecordModel:d().omK.fromGetRecordValueFn(n.getRecordValue),propertySchema:o,includeDeleted:n.collectionFeatureGates.relations_show_deleted,includeInvalidCollection:n.collectionFeatureGates.relations_show_invalid_collection,includeNoAccess:n.collectionFeatureGates.relations_show_no_access}),a=r().ow(i);return k({...e,textValue:a})},rollup:e=>{const t=e.exportArgs.getRecordValue,n=e.exportArgs.formulasModule,r=d().kk5.fromValue(p().iU,e.block),i=d().omK.fromGetRecordValueFn(t);return o(235819).kJ({...e,block:r,getRecordModel:i,collectionRequestContext:{userId:void 0,userTimeZone:e.exportArgs.userTimeZone,depth:0,intl:e.exportArgs.intl,visitedProperties:new Set,resultCache:e.exportArgs.resultCache,regExpCache:e.exportArgs.regExpCache,experimentService:e.exportArgs.experimentService,collectionFeatureGates:e.exportArgs.collectionFeatureGates},formulasModule:n})},url:e=>{let{textValue:t}=e;return m().Jcv(t)},email:e=>{let{textValue:t}=e;return m().Jcv(t)},phone_number:e=>{let{textValue:t}=e;return m().Jcv(t)},checkbox:e=>{let{textValue:t}=e;return r().Ml(t)?"Yes":"No"},person:e=>{let{textValue:t,exportArgs:n,propertySchema:i,block:a}=e;const{intl:s}=n,l=d().kk5.fromBlock(a),c=r().DW({textValue:t,propertySchema:i,blockCreatorPointer:l.getCreatedByPointer()});return o(513670).oA(c.map((e=>{const t=n.getRecordValue(e),o=t&&d().kk5.fromValue(e.table,t);return null==o?void 0:o.getDisplayName(s)}))).join(", ")},number:e=>{let{exportArgs:t,property:n,schema:i,textValue:a}=e;const l=i[n],c=r().VY(a);if(!(0,o(696459).$K)(c))return;let d=!0;var u;l&&(0,o(226413).G$)(l)&&(d=(null===(u=l.show_as)||void 0===u?void 0:u.showValue)??!0);return d?(0,s().V)({intl:t.intl,propertySchema:l,value:c}):void 0},date:e=>{let{textValue:t,propertySchema:n,...r}=e;const a=r.exportArgs.userTimeZone,s=(0,o(552221).G)(t),{date_format:l,time_format:c}=n;if(s)return(0,i().ZV)({allowRelativeDates:!1,value:s,date_format:l,time_format:c,userTimeZone:a,intl:r.exportArgs.intl,displayInUserTimezone:r.exportArgs.displayInUserTimezone??!1,alwaysIncludeTimezone:!0})},file:k,formula:e=>{const{property:t,schema:n,block:r,exportArgs:i}=e,{userTimeZone:a,getRecordValue:l,intl:c,resultCache:u,regExpCache:p,formulasModule:m}=i;if(!m)return;const f=n[t],b=m.primitiveFormulaValueFromPropertySchema({schema:n,property:t,blockModel:d().kk5.fromBlock(r),getRecordModel:d().omK.fromGetRecordValueFn(l),intl:c,userTimeZone:a,depth:0,resultCache:u,regExpCache:p,experimentService:i.experimentService,collectionFeatureGates:i.collectionFeatureGates});return"boolean"==typeof b?b?"Yes":"No":(0,o(326966).hj)(b)?(0,s().V)({intl:i.intl,propertySchema:f,value:b}):(0,o(803021).U3)(b)?g({value:b,userTimeZone:a,allowRelativeDates:!1,intl:i.intl}):b},created_time:e=>{const{block:t,exportArgs:o}=e,{userTimeZone:n}=o;if(t.created_time)return g({allowRelativeDates:!1,value:(0,a().CQ)(t.created_time,n),userTimeZone:n,intl:o.intl})},last_edited_time:e=>{const{block:t,exportArgs:o}=e,{userTimeZone:n}=o;if(t.last_edited_time)return g({allowRelativeDates:!1,value:(0,a().CQ)(t.last_edited_time,n),userTimeZone:n,intl:o.intl})},created_by:e=>{const{block:t,exportArgs:o}=e,{getRecordValue:r,intl:i}=o;if(t.created_by_table&&t.created_by_id){const e=(0,n().Hl)({getRecordValue:r,pointer:{table:t.created_by_table,id:t.created_by_id,spaceId:t.space_id}});if(e.asActor)return(0,n().$4)(i,e)}},last_edited_by:e=>{const{block:t,exportArgs:o}=e,{getRecordValue:r,intl:i}=o;if(t.last_edited_by_table&&t.last_edited_by_id){const e=(0,n().Hl)({getRecordValue:r,pointer:{table:t.last_edited_by_table,id:t.last_edited_by_id,spaceId:t.space_id}});if(e.asActor)return(0,n().$4)(i,e)}},button:e=>"",auto_increment_id:e=>{let{textValue:t,block:n,exportArgs:i}=e;const a=r().ah(t),{getRecordValue:s}=i;if(void 0!==a){const e=d().kk5.fromBlock(n),t=e.getParentTable();if(t!==o(752778).vF)return;const r=s((0,o(889646).We)({spaceId:e.getSpaceId(),parentTable:t,parentId:e.getParentId()}));return(0,o(659089).wf)(null==r?void 0:r.record_key,a)}},last_visited_time:e=>"",location:e=>"",verification:e=>{let{textValue:t,exportArgs:o}=e;const n=f()._w(t);if(!n)return"";const r=f().WN(n);return o.intl.formatMessage(f().A3(r.type))},geo_point:()=>""}}},910595:(e,t,o)=>{o.d(t,{V:()=>i});var n=()=>o(226413),r=()=>o(996106);function i(e){let{intl:t,propertySchema:o,value:i}=e,a=r().dk;return o&&(0,n().G$)(o)&&(a=o.number_format??r().dk),r().uf(i,a,t)}},756191:(e,t,o)=>{o.d(t,{FR:()=>f,OY:()=>m,ic:()=>p,sB:()=>u,sG:()=>d,y_:()=>g});o(241792);var n=()=>o(513670),r=()=>o(696459),i=()=>o(834458),a=()=>o(193962),s=()=>o(455222),l=()=>o(177634);function c(e){switch(e){case"checkbox":return"boolean";case"number":return"number";case"text":return"text";case"date":return"date";case"array":return"array";case"block":return"block";case"person":return"person";case"select":return"select";case"function":return"function";case"unknown":return"unknown";case"undefined":return"undefined";default:(0,r().t1)(e)}}function d(e){switch(e.type){case s().$E.InvalidCharacter:return{...a().mr.InvalidCharacter,values:{errorCharacter:e.character}};case s().$E.UnclosedStringLiteral:return a().mr.UnclosedStringLiteral;case s().$E.UnclosedComment:return a().mr.UnclosedComment;case s().$E.TokenExpected:return{...a().mr.TokenExpected,values:{expectedToken:e.token}};case s().$E.StringLiteralContainsToken:return a().mr.StringLiteralContainsToken;case s().$E.ExpressionExpected:return a().mr.ExpressionExpected;case s().$E.PropertyTokenOrFunctionExpected:return a().mr.PropertyTokenOrFunctionExpected;case s().$E.EndOfInputExpected:return a().mr.EndOfInputExpected;case s().$E.UnexpectedError:return a().mr.UnexpectedError;case s().$E.TooDeeplyNested:return a().mr.TooDeeplyNested;default:(0,r().t1)(e)}}function u(e){switch(e.type){case s().h4.FunctionCallArgumentWrongType:case s().h4.FunctionCallUnexpectedArgument:return e.argument;default:return e.node}}function p(e,t){let o;switch(t.type){case s().h4.ThisRowTypeNotFound:o=a().o8.ThisRowTypeNotFound;break;case s().h4.ThisRowNotBlockWithCollection:o=a().o8.ThisRowNotBlockWithCollection;break;case s().h4.MissingPropertyOnThisRow:o={...a().o8.MissingPropertyOnThisRow,values:{propertyName:t.property}};break;case s().h4.MissingContextVariable:{const e=(0,l().Xp)(t.token)?t.token.contextValueId:t.token.valueId;o={...a().o8.MissingContextVariable,values:{valueId:e}}}break;case s().h4.MissingBlock:o={...a().o8.MissingBlock,values:{blockId:t.token.blockId}};break;case s().h4.CallingNotFunction:o={...a().o8.CallingNotFunction,values:{expressionType:c(t.callee.type.type)}};break;case s().h4.FunctionCallTooFewArguments:o={...a().o8.FunctionCallTooFewArguments,values:{minNumParameters:t.minNumParameters,functionName:t.libraryFunction.name,numArguments:t.numArguments}};break;case s().h4.FunctionCallUnexpectedArgument:o={...a().o8.FunctionCallUnexpectedArgument,values:{functionName:t.libraryFunction.name}};break;case s().h4.FunctionCallArgumentWrongType:o={...a().o8.FunctionCallArgumentWrongType,values:{argumentType:c(t.argument.type.type),functionName:t.libraryFunction.name}};break;case s().h4.MemberPropertyMismatchCollection:o={...a().o8.MemberPropertyMismatchCollection,values:{propertyName:t.token.property}};break;case s().h4.MemberPropertyMissing:o={...a().o8.MemberPropertyMissing,values:{propertyName:t.property}};break;case s().h4.MemberPropertyTargetNotBlock:o=a().o8.MemberPropertyTargetNotBlock;break;case s().h4.MemberPropertyTypeInvalid:o={...a().o8.MemberPropertyTypeInvalid,values:{propertyName:t.propertyName,propertyType:t.propertyType}};break;case s().h4.UndefinedIdentifier:o={...a().o8.UndefinedIdentifier,values:{identifier:t.node.text}};break;case s().h4.UnifiedFunctionCannotFindFunction:o={...a().o8.UnifiedFunctionCannotFindFunction,values:{functionName:t.name}};break;case s().h4.UnifiedFunctionNoArguments:o={...a().o8.UnifiedFunctionNoArguments,values:{functionName:t.libraryFunction.name}};break;case s().h4.UnifiedFunctionTargetWrongType:o={...a().o8.UnifiedFunctionTargetWrongType,values:{functionName:t.libraryFunction.name,targetType:c(t.expression.type.type)}};break;case s().h4.CannotRelativelyCompareTypes:o={...a().o8.CannotRelativelyCompareTypes,values:{lhsType:c(t.lhsType.type),rhsType:c(t.rhsType.type)}};break;case s().h4.CannotDoMathOnType:o={...a().o8.CannotDoMathOnType,values:{lhsType:c(t.lhsType.type),rhsType:c(t.rhsType.type)}};break;case s().h4.UnaryMinusOnNonNumber:o={...a().o8.UnaryMinusOnNonNumber,values:{type:c(t.expression.type.type)}};break;case s().h4.IdentifierExpected:o=a().o8.IdentifierExpected;break;case s().h4.FunctionCallExpected:o={...a().o8.FunctionCallExpected,values:{functionName:t.functionName}};break;case s().h4.RenamedIdentifier:o={...a().o8.RenamedIdentifier,values:{identifier:t.identifier,renamedTo:t.renamedTo}};break;case s().h4.RemovedFunction:o={...a().o8.RemovedFunction,values:{functionName:t.functionName,alternative:t.alternative}};break;case s().h4.ContextVariableNotBlockWithCollection:o={...a().o8.ContextVariableNotBlockWithCollection,values:{valueId:t.token.contextValueId}};break;case s().h4.MissingPropertyOnContextVariable:o={...a().o8.MissingPropertyOnContextVariable,values:{propertyName:t.property,valueId:t.token.contextValueId}};break;case s().h4.BlockPropertyTypeInvalid:o={...a().o8.BlockPropertyTypeInvalid,values:{propertyName:t.propertyName}};break;case s().h4.DisallowedReturnType:{const n=t.allowedReturnTypes.map((t=>e.formatMessage((0,i().getHumanReadableType)(t)).toLocaleLowerCase()));o={...a().o8.DisallowedReturnType,values:{allowedReturnType:e.formatList(n,{style:"long",type:"conjunction"}),allowedReturnTypeCount:t.allowedReturnTypes.length,returnType:e.formatMessage((0,i().getHumanReadableType)(t.returnType)).toLocaleLowerCase()}};break}case s().h4.CrossSpacePropertyNotSupported:o={...a().o8.CrossSpacePropertyNotSupported};break;default:(0,r().t1)(t)}return{...o,values:{...o.values,startOffset:t.node.startOffset,endOffset:t.node.endOffset+1}}}function m(e,t){let o;switch(t.type){case s().FY.MissingThisRow:o=a().YG.MissingThisRow;break;case s().FY.MissingSchemaPropertyOnThisRow:o={...a().YG.MissingSchemaPropertyOnThisRow,values:{propertyName:t.property}};break;case s().FY.ThisRowBlockPropertyMismatchCollection:o=a().YG.ThisRowBlockPropertyMismatchCollection;break;case s().FY.MissingContextVariable:o={...a().YG.MissingContextVariable,values:{valueId:t.valueId}};break;case s().FY.IdentifierNotFound:o={...a().YG.IdentifierNotFound,values:{identifier:t.node.text}};break;case s().FY.CannotRelativelyCompareTypes:o={...a().YG.CannotRelativelyCompareTypes,values:{lhsType:c(t.lhsType),rhsType:c(t.rhsType)}};break;case s().FY.CannotDoMathOnType:o={...a().YG.CannotDoMathOnType,values:{valueType:c(t.valueType)}};break;case s().FY.CannotCallNonFunction:o={...a().YG.CannotCallNonFunction,values:{calleeType:c(t.calleeType)}};break;case s().FY.UnifiedFunctionPropertyNotFound:o={...a().YG.UnifiedFunctionPropertyNotFound,values:{functionName:t.node.name}};break;case s().FY.LibraryFunctionExecutionError:const n=t.error instanceof s().Mu?t.error:void 0;o=(null==n?void 0:n.info.type)===s().sj.DateInvalidDurationUnit?{...a().z8.DateInvalidDurationUnit,values:{functionName:t.libraryFunction.name,invalidUnit:n.info.invalidUnit}}:(null==n?void 0:n.info.type)===s().sj.CannotUseToNumberOnList?{...a().z8.CannotUseToNumberOnList}:(null==n?void 0:n.info.type)===s().sj.CannotRoundToNonInteger?{...a().z8.CannotRoundToNonInteger,values:{precision:n.info.precision}}:(null==n?void 0:n.info.type)===s().sj.CannotRoundToTooManyDecimalPlaces?{...a().z8.CannotRoundToTooManyDecimalPlaces,values:{precision:n.info.precision}}:{...a().YG.LibraryFunctionExecutionError,values:{functionName:t.libraryFunction.name}};break;case s().FY.FunctionCallTooFewArguments:o={...a().YG.FunctionCallTooFewArguments,values:{functionName:t.libraryFunction.name}};break;case s().FY.FunctionCallUnexpectedArgument:o={...a().YG.FunctionCallUnexpectedArgument,values:{functionName:t.libraryFunction.name}};break;case s().FY.FunctionCallArgumentWrongType:o={...a().YG.FunctionCallArgumentWrongType,values:{functionName:t.libraryFunction.name,argumentType:c(t.argumentType)}};break;case s().FY.AccessingPropertyOnNonBlock:o=a().YG.AccessingPropertyOnNonBlock;break;case s().FY.MissingDataDependencyBlock:o={...a().YG.MissingDataDependencyBlock,values:{blockId:t.blockPointer.id}};break;case s().FY.MissingDataDependencyPerson:o={...a().YG.MissingDataDependencyPerson,values:{personId:t.personPointer.id}};break;case s().FY.MemberPropertyMismatchCollection:o=a().YG.MemberPropertyMismatchCollection;break;case s().FY.MissingPropertyOnSchemaForMemberProperty:o=a().YG.MissingPropertyOnSchemaForMemberProperty;break;case s().FY.UnaryMinusOnNonNumber:o={...a().YG.UnaryMinusOnNonNumber,values:{expressionType:c(t.expressionType)}};break;case s().FY.UnexpectedRecoveryNode:o=a().YG.UnexpectedRecoveryNode;break;case s().FY.UnexpectedError:o=a().YG.UnexpectedError;break;case s().FY.DepthExceeded:o=a().YG.DepthExceeded;break;case s().FY.CycleDetected:o=a().YG.CycleDetected;break;case s().FY.DownstreamParseFailure:o=a().YG.DownstreamParseFailure;break;case s().FY.MaxEvaluationTimeExceeded:o=a().YG.MaxEvaluationTimeExceeded;break;case s().FY.MissingSchemaPropertyOnCollection:o={...a().YG.MissingSchemaPropertyOnCollection,values:{collectionId:t.collectionId,propertyName:t.property}};break;case s().FY.ContextVariableWrongType:o={...a().YG.ContextVariableWrongType,values:{expectedType:t.expectedType,propertyType:t.resultType,valueId:t.valueId}};break;case s().FY.DisallowedValueType:{const n=t.allowedValueTypes.map((t=>e.formatMessage((0,i().getHumanReadableType)(t)).toLocaleLowerCase()));o={...a().o8.DisallowedReturnType,values:{allowedValueType:e.formatList(n,{style:"long",type:"conjunction"}),allowedValueTypeCount:t.allowedValueTypes.length,valueType:e.formatMessage((0,i().getHumanReadableValueType)(t.expressionValue)).toLocaleLowerCase()}};break}default:(0,r().t1)(t)}return(0,l().w7)(t)?{...o,values:{...o.values,startOffset:t.node.startOffset,endOffset:t.node.endOffset+1}}:o}function f(e){const t=null==e?void 0:e.values;return[n().CE(e,"values"),t]}function g(e){return e.type===s().FY.DepthExceeded||e.type===s().FY.CycleDetected||e.type===s().FY.MaxEvaluationTimeExceeded||e.type===s().FY.LibraryFunctionExecutionError}},981850:(e,t,o)=>{function n(e){return/^(\+\d{1,2}[\s.-])?\(?\d{3}\)?[\s.-]\d{3}[\s.-]\d{4}$/.test(e)}function r(e){return/^[0-9 .()\-\+]{7,}$/.test(e)}o.d(t,{E:()=>r,x:()=>n})}}]);