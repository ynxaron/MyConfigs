"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[19454],{677243:(e,t,r)=>{r.d(t,{h:()=>b});r(122556),r(582845),r(250570),r(533019),r(721473),r(788208),r(22624),r(267602),r(653476),r(241792),r(667294);var i=()=>r(219727),n=()=>r(142735),a=()=>r(38883),o=()=>r(665385),s=()=>r(396136),l=()=>r(788860),d=()=>r(527278),c=()=>r(15981),u=()=>r(828946),g=()=>r(876822),m=()=>r(826955),p=()=>r(943620),f=()=>r(231219),h=()=>r(384241),S=()=>r(114755),x=()=>r(78014),v=()=>r(630029),y=r(785893);const w={token:{display:"flex",alignItems:"center"},icon:{marginRight:4}},j=(0,l().vU)({searchPages:{defaultMessage:"Search pages",id:"searchPageFilter.searchTokenFilter.tokenInput.placeholder"},selectAPage:{defaultMessage:"Select a page",id:"searchPageFilter.searchTokenFilter.resultSection.title"}});function b(e){let{mode:t,title:r,blockIds:n,onChange:a,disabled:s,focused:m,onMenuDismiss:p,onMenuOpen:f,parentStore:h}=e;const S=(0,i().O7)();return(0,y.jsx)(v().Z,{mode:t,hasItemsSelected:(null==n?void 0:n.length)>0,title:r,icon:o().j,iconStyles:P(S).recordIcon,items:n,onChange:a,focused:m,renderFilter:(e,t)=>(0,y.jsx)(T,{item:e,args:t,parentStore:h}),renderToken:(e,t)=>(0,y.jsx)(k,{item:e,handlers:t,blockIds:n,parentStore:h}),renderItemForSummary:e=>(0,y.jsx)(M,{item:e,parentStore:h}),addItemLabel:(0,y.jsx)(l()._H,{defaultMessage:"Add another page",id:"searchPageFilter.searchTokenFilter.addAPage.button"}),labelText:{title:r,tokenInputPlaceholder:d().Z.formatMessage(j.searchPages),componentDebugName:"SearchPageFilter"},performRequest:e=>async function(e,t){let{query:r,current:i}=e;const{currentSpaceStore:n}=g().default.state;if(!n)return[];const a=await u().x.searchActions.load(),o=r?(await a.searchPageIds({environment:t,query:r,limit:20,spaceId:n.id,requireEditPermissions:!1,excludeTemplates:!1,source:"ancestor_filter_page_search",boostRecentlyViewedPages:!0})).results:c().X4.state.map((e=>e.pageId)),s=new Set(i);return o.filter((e=>!s.has(e)))}(e,S),renderResultMenuItem:(e,t)=>(0,y.jsx)(C,{item:e,props:t,parentStore:h}),disabled:s,onMenuDismiss:p,onMenuOpen:f})}function I(e,t){return m().G.createChildStore(t,{table:s().iU,id:e})}function M(e){let{item:t,parentStore:r}=e;const i=I(t,r);return(0,y.jsx)(h().Z,{store:i,shouldWrap:!0,maxLength:50})}function k(e){let{item:t,handlers:r,blockIds:o,parentStore:s}=e;const l=(0,i().O7)(),d=w,c=1===o.length,u=I(t,s),g=(0,n().VK)((()=>u.getIcon()),[u]),m=(0,y.jsxs)("div",{style:d.token,children:[(0,y.jsx)(p().Z,{disabled:!0,icon:g,isEmptyPage:!1,size:20,style:d.icon}),(0,y.jsx)(h().Z,{store:u})]});return(0,y.jsx)(x().Z,{format:l.device.isMobile?a().lo.Large:a().lo.Small,value:m,showRemoveButton:!0,onClickRemove:r.onRemove,isSingle:c,shouldShrink:!0,backgroundColor:"transparent",shouldWrap:!1})}function C(e){let{item:t,props:r,parentStore:i}=e;const a=(0,n().VK)((()=>I(t,i)),[t,i]);return(0,y.jsx)(f().Z,{...r,store:a})}function P(e){return{menuItem:{minHeight:void 0,paddingTop:e.device.isMobile?12:4,paddingBottom:e.device.isMobile?12:4},menuItemTitle:{width:"100%"},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginRight:12},recordIcon:{fill:"currentColor"}}}function T(e){let{item:t,args:r,parentStore:n}=e;const{disabled:a,onRemove:o,onClick:s}=r,l=P((0,i().O7)()),d=I(t,n),c=(0,y.jsx)(S().Z,{disabled:a,onClick:o});return(0,y.jsx)(f().Z,{disabled:a,focused:!1,store:d,right:c,style:l.menuItem,desktopTitleStyle:l.menuItemTitle,onClick:s})}},543771:(e,t,r)=>{r.d(t,{Z:()=>w});r(122556),r(582845),r(250570),r(533019),r(721473),r(788208),r(22624),r(267602),r(653476),r(30005),r(241792);var i=r(667294),n=()=>r(219727),a=()=>r(142735),o=()=>r(35e3),s=()=>r(306164),l=()=>r(899133),d=()=>r(788860),c=()=>r(91502),u=()=>r(828946),g=()=>r(876822),m=()=>r(826955),p=()=>r(700696),f=()=>r(943620),h=()=>r(793041),S=()=>r(114755),x=()=>r(435676),v=()=>r(630029),y=r(785893);function w(e){let{mode:t,title:r,teamIds:i,onChange:a,disabled:s,focused:m,onMenuDismiss:f,onMenuOpen:h,parentStore:S}=e;const x=(0,n().O7)(),w=(0,d().YB)(),j=(0,l().iY)(i);return(0,y.jsx)(v().Z,{mode:t,title:r,icon:o().I,iconStyles:k(x).recordIcon,items:j||[],onChange:a,disabled:s,focused:m,renderFilter:(e,t)=>(0,y.jsx)(C,{item:e,args:t,parentStore:S}),renderToken:(e,t)=>(0,y.jsx)(M,{item:e,handlers:t,teamIds:i,parentStore:S}),renderItemForSummary:e=>(0,y.jsx)(b,{item:e,parentStore:S}),addItemLabel:(0,y.jsx)(d()._H,{defaultMessage:"Add a teamspace",id:"search.filterMenu.addATeamButton.label"}),labelText:{title:r,tokenInputPlaceholder:w.formatMessage({defaultMessage:"Search teamspaces",id:"search.filterMenu.searchTeams.placeholder"}),componentDebugName:"SearchTeamFilter"},performRequest:e=>async function(e,t){var r;let{query:i,current:n}=e;const a=new Set(n),o=g().default.state.currentSpaceViewStore,s=g().default.state.currentSpaceStore,l=null===(r=g().default.state.currentUserStore)||void 0===r?void 0:r.id;if(!o||!s||!l)return[];if(!i){const e=new Set(o.getTeamsStores().map((e=>e.id)));if(p().default.state.teams.map((e=>e.id)).forEach((t=>e.add(t))),e.size>0)return[...e]}const d=await(0,c().qX)({environment:t,spaceStore:s,currentUserId:l}),m=await u().x.searchActions.load();return(await m.searchTeams({query:i,spaceViewStore:o,teamStores:d})).filter((e=>!a.has(e.id))).slice(0,20).map((e=>e.id))}(e,x),renderResultMenuItem:(e,t)=>(0,y.jsx)(I,{item:e,props:t,parentStore:S}),onMenuDismiss:f,onMenuOpen:h,hasItemsSelected:Boolean(j&&(null==j?void 0:j.length)>0)})}function j(e,t){return m().zX.createChildStore(t,{table:s().e0,id:e})}function b(e){let{item:t,parentStore:r}=e;return(0,y.jsx)(y.Fragment,{children:j(t,r).getName()})}function I(e){let{item:t,props:r,parentStore:n}=e;const a=j(t,n);return(0,i.createElement)(x().Z,{...r,key:t,teamStore:a})}function M(e){let{item:t,handlers:r,teamIds:i,parentStore:o}=e;const s=(0,n().O7)(),d=(0,l().iY)(i),c=1===(null==d?void 0:d.length),u=(0,a().VK)((()=>j(t,o)),[t,o]),g=(0,a().VK)((()=>u.getName()),[u]),m=(0,a().VK)((()=>function(e){const t=e.getIcon();return function(e){return(0,y.jsx)(f().Z,{disabled:!0,icon:t,isEmptyPage:!1,size:e})}}(u)),[u]);return u?(0,y.jsx)(h().ZP,{format:s.device.isMobile?h().lP.Large:h().lP.Small,showRemoveButton:!0,isSingle:c,onClickRemove:r.onRemove,renderAvatar:m,title:g,style:{background:"transparent"}}):null}function k(e){return{menuItem:{minHeight:void 0,paddingTop:e.device.isMobile?12:4,paddingBottom:e.device.isMobile?12:4},menuItemTitle:{width:"100%"},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginRight:12},recordIcon:{marginRight:6,fill:"currentColor"}}}function C(e){let{item:t,args:r,parentStore:i}=e;const{disabled:a,onRemove:o,onClick:s}=r,l=k((0,n().O7)()),d=j(t,i),c=(0,y.jsx)(S().Z,{disabled:a,onClick:o});return(0,y.jsx)(x().Z,{disabled:a,focused:!1,teamStore:d,right:c,style:l.menuItem,desktopTitleStyle:l.menuItemTitle,onClick:s},t)}},378341:(e,t,r)=>{r.r(t),r.d(t,{VerifiedPagesSettings:()=>q});r(267602),r(653476),r(241792);var i=r(667294),n=()=>r(219727),a=()=>r(142735),o=()=>r(846550),s=()=>r(899133),l=()=>r(788860),d=()=>r(696459),c=()=>r(285473),u=()=>r(312578),g=()=>r(67961),m=()=>r(677243),p=()=>r(237427),f=()=>r(543771),h=()=>r(630029),S=()=>r(504117),x=()=>r(868614),v=()=>r(868982),y=()=>r(718959),w=()=>r(527278),j=()=>r(90065),b=()=>r(766463),I=(r(821057),r(470928),()=>r(146947)),M=()=>r(506347),k=()=>r(646574),C=()=>r(265640),P=()=>r(448419),T=()=>r(729775),Z=()=>r(166124),H=()=>r(654133),O=()=>r(239444),R=()=>r(731887),F=()=>r(429725),_=()=>r(826955),V=()=>r(838266),B=r(785893);const K=10;function L(e){let{pageStore:t}=e;const r=(0,a().VK)((()=>(0,F().Hu)({store:t,pageVisitSource:M().tY.VerifiedPagesSettings})),[t]),n=(0,i.useCallback)((e=>{e.metaKey||V().default.setState({...V().default.state,open:!1})}),[]),s=(0,o().yK)((()=>({container:{width:"100%"},linkBox:{width:"100%"},linkBoxHover:{marginLeft:-K,paddingLeft:K,width:`calc(100% + ${K}px)`}})),[]);return(0,B.jsx)("div",{style:s.container,children:(0,B.jsx)(T().Z,{href:r,style:s.linkBox,hoveredStyle:s.linkBoxHover,onClick:n,children:(0,B.jsx)(Z().o,{blockStore:t})})})}function D(e){let{pageStore:t,filteredOwnerIds:r}=e;const i=(0,o().yK)((()=>({ownerCell:{display:"flex",alignItems:"center"},owner:{width:"fit-content"}})),[]),{verificationOwners:n}=(0,a().VK)((()=>(0,j().zV)({blockStore:t})),[t]),s=n.map((e=>_().t1.createChildStore(t,e))).filter((e=>e instanceof _().U6));if(0===s.length)throw Error("Verified page has no verification owner");const l=s.find((e=>r.includes(e.id)))??s[0],d=s.filter((e=>e.id!==l.id));return(0,B.jsxs)("div",{style:i.ownerCell,children:[(0,B.jsx)(O().Z,{userStore:l,avatarSize:20,style:i.owner},`${t.id}-owner`),d.length>0&&(0,B.jsx)(z,{hiddenOwners:d})]})}function z(e){let{hiddenOwners:t}=e;const r=(0,o().yK)((e=>({hiddenOwnersCount:{marginLeft:4},hiddenOwner:{margin:"4px 0px",color:e.regularInvertedTextColor},tooltip:{width:200},tooltipHeader:{color:e.mediumInvertedTextColor,marginBottom:6}})),[]);return(0,B.jsx)(H().Z,{allowHover:!0,originGap:7,style:r.tooltip,renderTooltip:e=>(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(g().Z,{isSmall:!0,style:r.tooltipHeader,children:(0,B.jsx)(l()._H,{id:"verifiedPagesSettings.hiddenOwners.tooltipHeader",defaultMessage:"Owners"})}),(0,B.jsx)("div",{...e,children:t.map((e=>(0,B.jsx)(O().Z,{userStore:e,avatarSize:20,style:r.hiddenOwner},e.id)))})]}),render:e=>(0,B.jsx)("div",{...e,style:r.hiddenOwnersCount,children:(0,B.jsx)(g().Z,{isSecondaryColor:!0,children:`+${t.length}`})})})}function U(e){let{pageStore:t,verificationState:r}=e;const i=(0,n().Fy)();return(0,B.jsx)(P().ZP,{renderOrigin:e=>(0,B.jsx)(C().D,{size:"sm",isLightGray:"expired"===r.type,...e,children:A({verificationState:r})}),render:e=>(0,B.jsx)(R().D,{onClose:()=>e.close(),blockStore:t}),popupType:i.isMobile?P().Z4.SlideUp:P().Z4.Popup})}function A(e){let{verificationState:t}=e;if("none"===t.type)throw new Error("Verified page has no verification state");return"expired"===t.type?(0,B.jsx)(l()._H,{id:"verifiedPagesSettings.verificationStatus.expired",defaultMessage:"Expired"}):"verified"===t.type?t.isIndefinite?(0,B.jsx)(l()._H,{id:"verifiedPagesSettings.verificationStatus.indefinite",defaultMessage:"Indefinitely"}):(0,k().$b)(t.dateTimeRange.end.toMillis(),I().locale,w().Z.getIntl(),void 0,"medium"):void(0,d().t1)(t)}function q(e){let{spaceStore:t}=e;const r=(0,n().O7)(),[c,u]=(0,i.useState)(""),[g,I]=(0,i.useState)(r.currentUser.id?[r.currentUser.id]:[]),[M,k]=(0,i.useState)([]),[C,P]=(0,i.useState)([]),T={ancestors:C,inTeams:M,verificationOwners:g},Z=(0,a().VK)((()=>y().Pw(r)),[r]),{results:H,isResultsLoading:O,fetchAdditionalServerResultsOnChange:R}=(0,b().s)({disable:!1,searchQuery:c,limit:20,type:s().n8.BlocksInSpace,source:"verified_pages_settings",filters:T}),F=(0,a().VK)((()=>function(e){return e.map((e=>{const t=(0,j().T7)(e);if("none"===t.type)return;return{id:e.id,isClickable:!1,pageStore:e,verificationState:t}})).filter(d().$K)}(H.map((e=>e.store)))),[H]),_=(0,o().yK)((()=>({filterBar:{display:"flex",marginBottom:20}})),[]);return(0,B.jsxs)(S().ZP,{children:[(0,B.jsx)(x().Z,{large:!0,divider:"full",children:(0,B.jsx)(l()._H,{id:"verifiedPages.heading.title",defaultMessage:"Verified pages"})}),(0,B.jsx)(v().ON,{mode:v().p3.OnChange,query:c,setQueryFilter:u,placeholderText:w().Z.formatMessage(v()._7.titleOnlyPlaceholder)}),Z&&(0,B.jsxs)("div",{style:_.filterBar,children:[(0,B.jsx)(p().Z,{mode:h().z.Pill,focused:!1,title:(0,B.jsx)(l()._H,{id:"verifiedPagesSettings.searchFilter.owner",defaultMessage:"Owner"}),parentStore:Z,userIds:g,onChange:I}),(0,B.jsx)(m().h,{mode:h().z.Pill,focused:!1,title:(0,B.jsx)(l()._H,{id:"verifiedPagesSettings.searchFilter.ancestor",defaultMessage:"In"}),parentStore:Z,blockIds:C,onChange:P}),(0,B.jsx)(f().Z,{mode:h().z.Pill,focused:!1,title:(0,B.jsx)(l()._H,{id:"verifiedPagesSettings.searchFilter.teamspace",defaultMessage:"Teamspace"}),parentStore:Z,teamIds:M,onChange:k})]}),(0,B.jsx)(E,{loading:O,verifiedPageRows:F??[],onLoadMore:R,filteredOwnerIds:g})]})}function E(e){let{loading:t,verifiedPageRows:r,onLoadMore:n,filteredOwnerIds:a}=e;const s=function(e){const t=(0,o().yK)((e=>({pageStoreHeaderStyle:{boxShadow:`\n\t\t\t\t\tinset 0 1px 0 ${e.tableDividerColor},\n\t\t\t\t\tinset 0 -1px 0 ${e.tableDividerColor}\n\t\t\t\t`},pageStoreRowStyle:{boxShadow:void 0}})),[]);return(0,i.useMemo)((()=>({pageTitle:{id:"pageTitle",headerTitle:(0,B.jsx)(l()._H,{id:"verifiedPagesSettings.tableHeader.pageName",defaultMessage:"Page name"}),renderCell:e=>(0,B.jsx)(L,{pageStore:e.pageStore}),widthData:{width:100,maxWidth:400},sortable:!1,headerStyle:t.pageStoreHeaderStyle,rowStyle:t.pageStoreRowStyle},owner:{id:"owner",headerTitle:(0,B.jsx)(l()._H,{id:"verifiedPagesSettings.tableHeader.owner",defaultMessage:"Owner"}),renderCell:t=>(0,B.jsx)(D,{pageStore:t.pageStore,filteredOwnerIds:e}),widthData:{width:150,maxWidth:200},sortable:!1},verifiedUntil:{id:"verifiedUntil",headerTitle:(0,B.jsx)(l()._H,{id:"verifiedPagesSettings.tableHeader.verifiedUntil",defaultMessage:"Verified until"}),renderCell:e=>(0,B.jsx)(U,{pageStore:e.pageStore,verificationState:e.verificationState}),widthData:{width:100,maxWidth:200},sortable:!1}})),[t,e])}(a),m=(0,d().Yd)(s).map((e=>s[e])),p=(0,o().yK)((e=>(0,c().bE)({columnRenderInfo:m,theme:e,containerMarginTop:0})),[m]),f=(0,o().yK)((()=>({emptyQuery:{marginTop:15,marginBottom:40,textAlign:"center"},loadingSpinner:{margin:"24px auto 24px"}})),[]);return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(c().Dp,{setStickyHeaderRow:!0,hideHeaderRowPadding:!0,showRowBorders:!0,allowHorizontalScroll:!0,maxHeight:500,columnRenderInfo:m,rows:r,loadMoreMethod:n?{type:"scroll",onLoadMore:n}:void 0,renderNoRowsComponent:()=>(0,B.jsx)(g().Z,{isSmall:!0,style:f.emptyQuery,children:!t&&0===r.length&&(0,B.jsx)(l()._H,{id:"settings.verifiedPagesSettings.searchTable.empty",defaultMessage:"No verified pages to display."})}),styles:p}),t&&(0,B.jsx)(u().Z,{style:f.loadingSpinner})]})}},29248:(e,t,r)=>{r.d(t,{K:()=>n});r(667294);var i=r(785893);const n=(0,r(827282).IU)("boltFilled",{svg:(0,i.jsx)("path",{d:"M0 12.117c0 .38.293.664.703.664h5.518l-2.91 7.91c-.381 1.006.664 1.543 1.318.723l8.877-11.094c.166-.205.254-.4.254-.625 0-.371-.293-.664-.703-.664H7.539l2.91-7.91C10.83.115 9.785-.422 9.131.408L.254 11.492c-.166.215-.254.41-.254.625z"}),viewBox:"0 0 14 22"})}}]);