"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[95175],{372931:(e,t,i)=>{i.d(t,{A9:()=>d,TC:()=>u,hh:()=>c});i(821057);var o=()=>i(874459),n=()=>i(81954),r=()=>i(513670),s=()=>i(876822),a=()=>i(824462);const l=20;async function d(e,t){const{store:i,activityIds:o,spaceId:s,filterActivityTypes:d,filterDateRange:c,navigableBlockId:u,collectionId:g}=t,f=r().Ps(o),v=await a().callApi({eventName:"getActivityLog",environment:e,data:{spaceId:s,navigableBlock:u?{id:u,spaceId:(0,n().J)(void 0)}:void 0,collection:g?{id:g,spaceId:(0,n().J)(void 0)}:void 0,endingBeforeId:f,limit:l,activityTypes:d,...h(c)}});if("failed"===v.type)throw v.error;const p=v.data.activityIds;i.update((e=>({...e,shouldLoadNewerActivities:!1,activityIds:p.concat(o)})))}async function c(e,t){const{store:i,activityIds:o,spaceId:s,filterActivityTypes:d,filterDateRange:c,navigableBlockId:u,collectionId:g}=t,f=r().Z$(o),v=await a().callApi({eventName:"getActivityLog",environment:e,data:{spaceId:s,navigableBlock:u?{id:u,spaceId:(0,n().J)(void 0)}:void 0,collection:g?{id:g,spaceId:(0,n().J)(void 0)}:void 0,startingAfterId:f,limit:l,activityTypes:d,...h(c)}});if("failed"===v.type)throw v.error;const p=v.data.activityIds;i.update((e=>({...e,shouldLoadOlderActivities:!1,activityIds:o.concat(p),hasOlderActivities:p.length>0})))}async function u(e,t){var i;const{store:o,activityIds:n}=t,r=null===(i=s().default.state.currentSpaceViewStore)||void 0===i?void 0:i.id;if(!r)throw new Error("No space view id");const l=await a().callApi({eventName:"getActivityFeedForHomePrototypeDoNotUse",environment:e,data:{spaceViewId:r}});if("failed"===l.type)throw l.error;const d=l.data.activityIds;o.update((e=>({...e,shouldLoadOlderActivities:!1,activityIds:n.concat(d),hasOlderActivities:!1})))}function h(e){var t,i;const n=null!==(t=e.ending)&&void 0!==t&&t.start_date?o().OQ.isoToUnixMs(e.ending.start_date):void 0;return{startingAfterTimeMs:null!==(i=e.starting)&&void 0!==i&&i.start_date?o().OQ.isoToUnixMs(e.starting.start_date):void 0,endingBeforeTimeMs:n?o().Xz({date:n,daysToAdd:1}):void 0}}},932005:(e,t,i)=>{i.d(t,{zb:()=>f,U4:()=>h,FF:()=>u,jN:()=>c,xx:()=>v,gs:()=>g});var o=()=>i(81954);const n=(0,i(830742).LS)("restoreSnapshot");var r=()=>i(727475),s=()=>i(491927),a=()=>i(782646),l=()=>i(528918);const d=(0,i(788860).vU)({restoringPreviousVersion:{id:"historyModalActions.restoringPreviousVersion.loadingMessage",defaultMessage:"Restoring…"}});function c(e){const{environment:t,from:i,...o}=e;s().y(t,i),r().Z.setState({...o,open:!0,size:50})}function u(){const e=r().Z.state;e.open&&r().Z.setState({...e,size:e.size+20})}function h(){r().Z.setState({open:!1})}function g(e){const{environment:t,snapshot:i,nextFutureSnapshot:o}=e;s().qD(t,i);const n=r().Z.state;n.open&&r().Z.setState({...n,snapshot:i,nextFutureSnapshot:o,openSnapshotNearTimestamp:void 0})}function f(){const e=r().Z.state;e.open&&r().Z.setState({...e,snapshot:void 0,nextFutureSnapshot:void 0})}async function v(e,t){if(!r().Z.state.open||!r().Z.state.snapshot)return;if(!r().Z.state.snapshot)return;s().R9(e,r().Z.state.snapshot),l().j({message:d.restoringPreviousVersion});const i=await a().Lj(e,n,{block:{id:r().Z.state.blockStore.id,spaceId:(0,o().J)(r().Z.state.blockStore.pointer.spaceId)},timestamp:r().Z.state.snapshot.timestamp,shouldRestoreCollection:t??!1}).next();if(l().x(),i.value.error)throw i.value.error}},857773:(e,t,i)=>{i.d(t,{Z:()=>ae});i(241792);var o=i(667294),n=()=>i(219727),r=()=>i(142735),s=()=>i(846550),a=()=>i(801812),l=()=>i(135796),d=()=>i(788680),c=()=>i(183922),u=()=>i(114882),h=()=>i(788860),g=()=>i(513670),f=()=>i(326966),v=()=>i(372931),p=()=>i(253502),m=()=>i(677559);const y=new(m().Ss)("activityUpdate",(async()=>await i.e(57866).then(i.bind(i,623722)))),b=(0,m().kF)(y,(e=>e.ActivityUpdate));var x=()=>i(852465),S=()=>i(91502),j=()=>i(118761),I=()=>i(466970),A=()=>i(635596),k=()=>i(745624),_=()=>i(297861),T=()=>i(70751),C=()=>i(876822),M=()=>i(529048),w=()=>i(804217);class R extends(()=>i(263184))().default{getInitialState(){return{selectedItems:[]}}}const B=R;var Z=()=>i(781022),V=(i(670560),()=>i(504008)),O=(i(821057),i(267602),i(653476),()=>i(542973)),L=(i(916054),()=>i(59438)),K=()=>i(695644),U=()=>i(602299),P=()=>i(955620),D=()=>i(43360),N=()=>i(312578),F=()=>i(712910),H=i(785893);const z=["block-deleted","block-created","block-changed"];function E(e){return 0===e.length?["\n"]:e}const q=function(e){let{batch:t,rootStore:a,pageTitleElem:l,activityTime:d,source:c,currentPageTitle:u}=e;const g=(0,n().O7)(),f=(0,h().YB)(),v=(0,r().VK)((()=>{var e;return null===(e=C().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),p=(0,o.useMemo)((()=>V().Z.withListenerIgnored((()=>t.map((e=>{const t=e.edits;let i;i="comment-created"===e.type?function(e,t,i,o){var n,r;const s=t.getRecordStore(t,{table:O().qF,id:i,spaceId:o});if(!s||0===e.length||!e[0].comment_id)return{beforeValue:"",afterValue:"",diffs:[],error:"invalid comment/discussion"};const a=e[0],l=t.getRecordModel({table:U().x_,id:a.comment_id,spaceId:a.space_id}),d=s.getModel();return d?{beforeValue:"",afterValue:`New comment on text: "${null===(n=(0,F().Pq)(d))||void 0===n?void 0:n[0][0]}" in the document. The comment says: "${null==l||null===(r=l.getText())||void 0===r?void 0:r.toString()}"`,diffs:[],error:void 0}:{beforeValue:"",afterValue:"",diffs:[],error:"invalid comment/discussion"}}(e.edits,a,e.discussion_id,e.space_id):function(e,t){const i=[],o=[],n=[];if(e.every(L().RR))return{beforeValue:"",afterValue:"",diffs:[],error:"unsupported"};for(const r of e){const e=(0,L().al)(r,t).title,s=null==e?void 0:e.type,a="text"===s||"title"===s,l=z.includes(r.type);if(a||l){if("block-changed"===r.type&&a){const e=(0,D().SX)(r.block_data.before.block_value,"title"),t=(0,D().SX)(r.block_data.after.block_value,"title");i.push(e),o.push(t),n.push(K().Mg({before:e,after:t,insertionAnnotation:[P().GKr.Inserted],deletionAnnotation:[P().GKr.Deleted]}))}else if("block-created"===r.type&&a){const e=(0,D().SX)(r.block_data.block_value,"title");o.push(e),n.push(K().Mg({before:[],after:e,insertionAnnotation:[P().GKr.Inserted],deletionAnnotation:[P().GKr.Deleted]}))}else if("block-deleted"===r.type&&a){const e=(0,D().SX)(r.block_data.block_value,"title");i.push(e),n.push(K().Mg({before:e,after:[],insertionAnnotation:[P().GKr.Inserted],deletionAnnotation:[P().GKr.Deleted]}))}}else{const e=`Invalid types '${r.type}', '${s}' for AI summary.`;i.push([e]),o.push([e])}}return{beforeValue:i.map((e=>JSON.stringify(E(e)))).join(", "),afterValue:o.map((e=>JSON.stringify(E(e)))).join(", "),diffs:n,error:void 0}}(e.edits,f);const o=function(e,t,i){return(0,F().P6)({edits:e,rootStore:i}).map((e=>e.isUser()?e.getFullName(t):"A bot ")).join(", ")}(t,f,a);return{authors:o,before:i.beforeValue,after:i.afterValue,end_time:e.end_time}}))))),[t,f,a]),[m,y]=(0,o.useState)(""),b=(0,s().yK)((e=>({inner:{color:e.text.primary,fontSize:14,margin:13,marginBottom:-5},text:{margin:5,marginLeft:2}})),[]);return(0,o.useEffect)((()=>{(async()=>{const e=i(956057).Il(),t={type:"edit_history",edits:p,page_title:u};if(!v)return;const o=await i(824462).callStreamApi({eventName:"getCompletion",environment:g,data:{id:(0,i(342792).c9)(),context:t,model:"openai-gpt-4o-mini",spaceId:v,isSpacePermission:!1,aiSessionId:e,inferenceReason:"home_tile_prototype",metadata:{}},headers:(0,i(741633).Bb)({spaceId:v})});if("success"!==o.type)return;let n="";if(i(956898).H1.is(o.data))for await(const i of o.data)"success"===i.type&&(n+=i.completion);y(n)})()}),[g,v,u,d,p]),(0,H.jsxs)("div",{style:b.inner,children:["home_tile"===c&&(0,H.jsx)(h()._H,{id:"activityUpdate.aiSummary",defaultMessage:"{pageTitle} · {activityTime}",values:{pageTitle:l,activityTime:(0,i(176691).IS)(d)}}),void 0===m||""===m?(0,H.jsxs)("div",{style:b.text,children:[(0,H.jsx)(N().Z,{style:{display:"inline"}}),(0,H.jsx)("span",{style:{marginLeft:"10px"},children:"Loading summary... "}),(0,H.jsx)("br",{})]}):(0,H.jsx)("div",{style:b.text,children:m})]})};var G=()=>i(121761);const W=function(e){const{batch:t,rootStore:a,tabArgs:l,isLast:d}=e,c=(0,n().O7)(),u=(0,h().YB)(),g=(0,s().yK)((e=>({details:{color:e.text.secondary,fontSize:12,marginLeft:15,marginTop:9,marginBottom:10},hr:{border:"none",height:1,backgroundColor:e.tableDividerColor}})),[]),f=(0,o.useMemo)((()=>V().Z.withListenerIgnored((()=>t.activities.map((e=>{if("block-edited"===e.type)return{type:"block-edited",end_time:parseInt(e.end_time),edits:(0,i(472706).R)(e.getEdits())};if("commented"===e.type){const t=a.getRecordStore(a,{table:O().qF,id:e.discussion_id,spaceId:e.space_id});if(!t.isDefined())return;const i=(0,G().QZ)(e.getEdits(),l.source,t);if(!(0,G().HY)(i)||0===i.length)return;return{type:"comment-created",end_time:parseInt(e.end_time),edits:i,discussion_id:e.discussion_id,space_id:e.space_id}}throw new Error("Unsupported activity type")})).filter(i(696459).$K)))),[t,a,l.source]),v=(0,r().VK)((()=>{if(0===f.length)return;const e=f[0].edits[0];return e&&i(826955).G.createChildStore(a,{table:i(396136).iU,id:e.navigable_block_id})}),[f,a]),p=(0,r().VK)((()=>v&&(0,i(549813).V)(v,u,c,!0)),[c,u,v]);return 0!==f.length&&v?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(q,{batch:f,rootStore:a,activityTime:f[0].end_time,source:l.source,pageTitleElem:(0,H.jsx)(i(541714).Z,{titledRecordStore:v,activity:t.activities[0],tabArgs:l,getRecordModel:a.getRecordModel}),currentPageTitle:p??"No page title"}),(0,H.jsx)("details",{style:g.details,open:!1,children:t.activities.map((e=>(0,H.jsx)(b,{activity:e,rootStore:a,tabArgs:l,isLast:d},e.id)))}),(0,H.jsx)("hr",{style:g.hr})]}):null};const Y=function(e){let{activities:t,rootStore:i}=e;const n=(0,o.useMemo)((()=>V().Z.withListenerIgnored((()=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;const i=[],o={};for(const n of e){const e=n.navigable_block_id;if(!e)continue;if(!o[e]){o[e]=[n];continue}const r=o[e][o[e].length-1];Math.abs((Number(r.end_time)-parseInt(n.end_time))/36e5)<=t?o[e].push(n):(o[e].sort(((e,t)=>parseInt(t.end_time)-parseInt(e.end_time))),i.push({page:e,activities:o[e],latest_activity_end_time:parseInt(o[e][0].end_time)}),o[e]=[n])}for(const n in o)o[n].length>0&&(o[n].sort(((e,t)=>parseInt(t.end_time)-parseInt(e.end_time))),i.push({page:n,activities:o[n],latest_activity_end_time:parseInt(o[n][0].end_time)}));return i.sort(((e,t)=>t.latest_activity_end_time-e.latest_activity_end_time)),i}(t).slice(0,20)))),[t]);return(0,H.jsx)("section",{role:"feed","aria-label":"Recent updates",children:n.map(((e,t)=>(0,H.jsx)(W,{batch:e,rootStore:i,isLast:t===e.activities.length-1,tabArgs:{tab:"homeTile",source:"home_tile"}},t)))})};var J=()=>i(906769),$=()=>i(67961),X=()=>i(658976),Q=()=>i(827973),ee=()=>i(114755),te=()=>i(630029);const ie=function(e){let{mode:t,title:i,onChange:n,disabled:s,focused:a,onMenuDismiss:l,items:d,addItemLabel:c,tokenInputPlaceholder:u,resultSectionTitle:h,componentDebugName:g,icon:f,getItemLabel:v,options:p,store:m}=e;const y=(0,r().qz)(m,B),b=(0,r().Kw)(y);return(0,o.useEffect)((()=>{y.setState({selectedItems:d})}),[d,y]),(0,H.jsx)(te().Z,{mode:t,hasItemsSelected:b.selectedItems.length>0,title:i,icon:f,items:d,onChange:e=>{n(e)},disabled:s,focused:a,renderFilter:(e,t)=>(0,H.jsx)(re,{getItemLabel:v,item:e,args:t}),renderToken:e=>(0,H.jsx)(ne,{item:e}),renderItemForSummary:e=>(0,H.jsx)(oe,{item:e}),addItemLabel:c,labelText:{title:i,tokenInputPlaceholder:u,resultSectionTitle:h,componentDebugName:g},performRequest:e=>function(e,t){let{query:i}=e;return Promise.resolve(t.filter((e=>e.includes(i))))}(e,p),renderResultMenuItem:(e,i)=>(0,H.jsx)(se,{getItemLabel:v,mode:t,store:y,item:e,props:i}),onMenuDismiss:l})};function oe(e){let{item:t}=e;return(0,H.jsx)(H.Fragment,{children:`hello${t}`})}function ne(e){let{item:t}=e;return(0,H.jsx)(H.Fragment,{children:t})}function re(e){let{item:t,args:i,getItemLabel:o}=e;const{disabled:r,onRemove:s,onClick:a}=i,l=function(e){return{menuItem:{minHeight:void 0,paddingTop:e.device.isMobile?12:4,paddingBottom:e.device.isMobile?12:4},menuItemTitle:{width:"100%"},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginRight:12},recordIcon:{marginRight:4}}}((0,n().O7)()),d=(0,H.jsx)(ee().Z,{disabled:r,onClick:s});return(0,H.jsx)(Q().Z,{title:(null==o?void 0:o(t))||t,disabled:r,focused:!1,right:d,style:l.menuItem,desktopTitleStyle:l.menuItemTitle,onClick:a})}function se(e){let{item:t,props:i,getItemLabel:n,mode:s,store:a}=e;const l=(0,r().qz)(a,B),d=(0,r().VK)((()=>l.state.selectedItems),[l]);return(0,o.createElement)(Q().Z,{...i,key:t,title:(null==n?void 0:n(t))||t,checkState:s===te().z.Pill&&d.includes(t)})}function ae(e){var t;const{spaceId:i,navigableBlockStore:l,collectionId:d,source:u}=e,p=null==l?void 0:l.id,m=(0,n().O7)(),y=(0,r().qz)(void 0,T().o),R=(0,r().qz)(void 0,M().Z),B=(0,s().yK)((e=>({placeholderContent:ue(m,e),banner:{padding:"12px 10px"}})),[m]),V=(0,o.useMemo)((()=>g().P2((e=>function(e,t){t.update((e=>({...e,shouldLoadNewerActivities:!0})))}(0,y)),1e3)),[y]),O=(0,o.useMemo)((()=>f().YX(V)),[V]),L=(0,o.useMemo)((()=>f().YX(V)),[V]);(0,o.useEffect)((()=>{let e,t;if(p){const t=(0,c().bS)(p);e=A().ZP.addListener(t,O,void 0,m)}if(d){const e=(0,c().Cy)(d);t=A().ZP.addListener(e,L,void 0,m)}return()=>{e&&A().ZP.removeListener(e,m),t&&A().ZP.removeListener(t,m)}}),[d,m,L,O,p]);const K=(0,r().VK)((()=>w().default.state.online),[]),U=(0,r().VK)((()=>{const e=y.state;return 0===e.filterActivityTypes.length&&void 0===e.filterDateRange.ending&&void 0===e.filterDateRange.starting}),[y]),P=(0,r().VK)(S().oI,[]),D=(0,I().E)("updates_ai"),{currentUserStore:N,currentSpaceStore:F}=(0,r().VK)((()=>{const{currentUserStore:e,currentSpaceStore:t}=C().default.state;return{currentUserStore:e,currentSpaceStore:t}}),[]),{shouldLoadOlderActivities:z,shouldLoadNewerActivities:E,filterActivityTypes:q,filterDateRange:G,activityIds:W,hasOlderActivities:X}=(0,r().VK)((()=>{const{shouldLoadOlderActivities:e,shouldLoadNewerActivities:t,filterActivityTypes:i,filterDateRange:o,activityIds:n,hasOlderActivities:r}=y.state;return{shouldLoadOlderActivities:e,shouldLoadNewerActivities:t,filterActivityTypes:i,filterDateRange:o,activityIds:n,hasOlderActivities:r}}),[y]),[Q]=(0,a().r5)((async()=>{if(!K||!N||!F)return;const e=Z().default.startLoading();E?await v().A9(m,{store:y,activityIds:W,spaceId:i,filterActivityTypes:q,filterDateRange:G,navigableBlockId:p,collectionId:d}):z&&X&&("home_tile"===u?await v().TC(m,{store:y,activityIds:W,spaceId:i,filterActivityTypes:q,filterDateRange:G,navigableBlockId:p,collectionId:d}):await v().hh(m,{store:y,activityIds:W,spaceId:i,filterActivityTypes:q,filterDateRange:G,navigableBlockId:p,collectionId:d})),Z().default.endLoading(e)}),[W,y,d,F,N,m,q,G,X,K,p,E,z,i,u]),ee=Q.error,te="resolved"===Q.status,ie=(0,r().VK)((()=>{if(!N)return[];const e=N.id,t=(0,_().Y)("supportsNativeHome"),o={spaceId:i,userId:e,navigableBlockId:p,collectionId:d,filterDateRange:G,filterActivityTypes:q},n=t&&0===W.length&&!te?j().IS(o):W;return t&&te&&j().HB(o,W),function(e){return g().oA(e.map((e=>function(e){const{currentUserStore:t,currentSpaceStore:i}=C().default.state;if(!t||!i)return;const o=(0,x().No)(i,e,i.id),n=o.getModel();return n&&!n.invalid?n:null}(e))))}(n)}),[W,d,N,q,G,p,te,i]);if(!K)return(0,H.jsx)(he,{});if(!N||!F)return null;const oe=0===ie.length&&!X&&te,ne=F;if(ee)return(0,H.jsx)("div",{style:B.placeholderContent,children:(0,H.jsx)(h()._H,{defaultMessage:"Something went wrong.",id:"activityUpdate.unknownErrorLoadingActivities.message"})});if(0===ie.length&&!te)return(0,H.jsxs)("div",{children:[P&&(0,H.jsx)(le,{collectionId:d,source:u,activityUpdatesStore:y,filterPopupStore:R}),(0,H.jsx)(k().B,{areaHeight:window.innerHeight})]});const re=(0,H.jsx)($().Z,{isSecondaryColor:!0,isMultiline:!0,children:(0,H.jsxs)("div",{style:{paddingTop:"15px",paddingRight:"10px",marginBottom:"-8px",paddingLeft:"10px"},children:["We're testing out AI summaries of updates on suggested pages. AI can make mistakes. Please leave feedback ",(0,H.jsx)("a",{href:"https://dev.notion.so/notion/Home-feed-with-AI-summary-feedback-doc-fffb35e6e67f8083b14ecc64c6ed465d",children:"here"}),"!"]})}),se=(0,H.jsxs)("div",{style:{...B.banner,marginTop:"-10px"},children:["Did you read to the end? Please let us know ",(0,H.jsx)("a",{href:"https://dev.notion.so/notion/Home-feed-with-AI-summary-feedback-doc-fffb35e6e67f8083b14ecc64c6ed465d",children:"here"}),", particularly if anything was helpful or unhelpful!"]});return(0,H.jsxs)("div",{children:[D&&"home_tile"===u&&re,P&&(0,H.jsx)(le,{collectionId:d,source:u,activityUpdatesStore:y,filterPopupStore:R}),(0,H.jsxs)("div",{style:oe?B.placeholderContent:ce(m,u),className:oe?"":"notranslate",children:[oe?null===(t=e.empty)||void 0===t?void 0:t.call(e,{hasFiltersOn:!U}):null,D&&"home_tile"===u?(0,H.jsx)(Y,{activities:ie,rootStore:ne}):(0,H.jsx)("section",{role:"feed",children:ie.map(((e,t,i)=>{const o=i.length-1===t,n="notifications_tab"===u?{tab:"all",source:u}:"updates_sidebar"===u?{tab:"pageUpdatesSidebar",source:u}:{tab:"homeTile",source:u};return(0,H.jsx)(b,{activity:e,rootStore:ne,isLast:o,tabArgs:n},e.id)}))}),(0,H.jsx)(J().Z,{onChange:e=>{e<200&&te&&!z&&X&&(U||ie.length>0)&&y.update((e=>({...e,shouldLoadOlderActivities:!0})))},children:!te&&X?(0,H.jsx)(ge,{isPaginated:!0}):null})]}),D&&("home_tile"===u?(0,H.jsx)($().Z,{isSecondaryColor:!0,isMultiline:!0,children:se}):null)]})}function le(e){const{collectionId:t,source:i,activityUpdatesStore:o,filterPopupStore:n}=e,{currentUserStore:s,currentSpaceStore:a}=(0,r().VK)((()=>{const{currentUserStore:e,currentSpaceStore:t}=C().default.state;return{currentUserStore:e,currentSpaceStore:t}}),[]),l=(0,r().VK)((()=>o.state.filterActivityTypes.length>0||o.state.filterDateRange.ending||o.state.filterDateRange.starting),[o]);return s&&a?(0,H.jsxs)("div",{style:{display:"flex",flexDirection:"row",padding:"12px 10px",width:"100%",gap:6},children:[(0,H.jsx)(de,{collectionId:t,source:i,filterPopupStore:n,activityUpdatesStore:o}),(0,H.jsx)(ye,{source:e.source,activityUpdatesStore:o,filterPopupStore:n}),l&&(0,H.jsx)(me,{source:e.source,activityUpdatesStore:o})]}):null}function de(e){const{collectionId:t,source:i,activityUpdatesStore:s,filterPopupStore:a}=e,l=(0,h().YB)(),c=(0,n().O7)(),g=t?u().Se:u().Py,f=(0,r().qz)(void 0,B),v=(0,r().VK)((()=>s.state.filterActivityTypes),[s]),p=(0,o.useCallback)((()=>{ve(a)}),[a]);return(0,H.jsx)(ie,{store:f,focused:!1,icon:d().A,options:[...g].sort(),items:v,mode:te().z.Pill,title:(0,H.jsx)(h()._H,{id:"activityUpdates.filterMenu.byType.title",defaultMessage:"Activity type"}),tokenInputPlaceholder:l.formatMessage({id:"activityUpdates.filterMenu.byType.search",defaultMessage:"Search for a type"}),resultSectionTitle:l.formatMessage({id:"activityUpdates.filterMenu.byType.resultSectionTitle",defaultMessage:"Activity Types"}),addItemLabel:l.formatMessage({id:"activityUpdates.filterMenu.byType.addItemLabel",defaultMessage:"Add an activity type"}),componentDebugName:"ActivityUpdatesSearchEditTypesFilter",onChange:e=>pe((()=>s.update((t=>({...t,filterActivityTypes:e,activityIds:[],hasOlderActivities:!0,shouldLoadOlderActivities:!0,shouldLoadNewerActivities:!1})))),c,i,s),onMenuDismiss:p,getItemLabel:e=>e.split("-").map((e=>e.replace(/(^.)/,(e=>e.toUpperCase())))).join(" ")})}function ce(e,t){return{minHeight:e.device.isMobile?void 0:"75vh",padding:t&&"home_tile"===t?"10px":void 0}}function ue(e,t){const{device:i}=e;return{...ce(e),paddingTop:i.isMobile?32:void 0,paddingBottom:i.isMobile?32:void 0,minHeight:i.isMobile?void 0:220,display:"flex",textAlign:"center",alignItems:"center",justifyContent:"center",fontSize:14,color:t.mediumTextColor,flexDirection:"column",flex:"1 1 0%"}}function he(){const e=(0,n().O7)(),t=(0,s().yK)((t=>({offlineMessage:ue(e,t)})),[e]);return(0,H.jsx)("div",{style:t.offlineMessage,children:(0,H.jsx)(h()._H,{defaultMessage:"Please go online to view updates.",id:"activityUpdates.offlineMessage"})})}function ge(e){let{isPaginated:t}=e;const i=(0,n().O7)(),o=(0,s().yK)((e=>({spinner:{...ue(i,e),minHeight:t?64:220}})),[i,t]);return(0,H.jsx)("div",{style:o.spinner,children:(0,H.jsx)(N().Z,{})})}function fe(e){var t,i;const{filterActivityTypes:o,filterDateRange:n}=e.state;return{activityTypes:o,dateRange:{start:null===(t=n.starting)||void 0===t?void 0:t.start_date,end:null===(i=n.ending)||void 0===i?void 0:i.start_date}}}function ve(e){e.setState({...e.state,open:!1})}function pe(e,t,i,o){const n=fe(o);e();const r=fe(o);p().Q6({environment:t,activityUpdatesSource:i,filters:r,prevFilters:n})}function me(e){let{source:t,activityUpdatesStore:i}=e;const o=(0,n().O7)(),r=(0,s().yK)((e=>({clearButton:{flexGrow:1,textAlign:"right",cursor:"pointer",fontSize:14,color:e.mediumTextColor,marginRight:8}})),[]);return(0,H.jsx)("div",{style:r.clearButton,onClick:()=>pe((()=>i.reset()),o,t,i),children:(0,H.jsx)(h()._H,{defaultMessage:"Clear",id:"activityUpdates.clearFilters"})})}function ye(e){let{source:t,activityUpdatesStore:i,filterPopupStore:s}=e;const a=(0,n().O7)(),d=(0,o.useCallback)((()=>ve(s)),[s]),c=(0,r().VK)((()=>i.state.filterDateRange),[i]);return(0,H.jsx)(X().Z,{mode:te().z.Pill,focused:!1,showButtons:!0,title:(0,H.jsx)(h()._H,{id:"activityUpdates.filterMenu.byDate",defaultMessage:"Date Range"}),icon:l().C,value:c,onMenuDismiss:d,onChange:e=>pe((()=>i.update((t=>({...t,filterDateRange:e,activityIds:[],hasOlderActivities:!0,shouldLoadOlderActivities:!0})))),a,t,i)})}},46335:(e,t,i)=>{i.d(t,{Z:()=>l});i(667294);var o=()=>i(846550),n=()=>i(707513),r=()=>i(998901),s=()=>i(654133),a=i(785893);function l(e){let{text:t,tooltipText:i,icon:l}=e;const d=(0,o().yK)((e=>({icon:{height:"1em",width:"1em",marginRight:"0.25em",fill:e.mediumIconColor,marginBottom:"0.1em"},tooltip:{background:e.contentBackground,boxShadow:e.shadowSM},container:{display:"flex",alignItems:"center",fontWeight:n().Ue.regular,color:e.mediumTextColor,fontSize:n().JB.UISmall.desktop,textAlign:"center"},text:{display:"inline"}})),[]);return(0,a.jsx)(s().Z,{style:d.tooltip,render:e=>(0,a.jsx)("div",{style:d.text,...e,children:t}),renderTooltip:()=>(0,a.jsxs)("div",{style:d.container,children:[l(d.icon),(0,a.jsx)("div",{children:i})]}),alignment:r().Alignment.Start,placement:r().Placement.Bottom})}},782698:(e,t,i)=>{i.d(t,{Z:()=>s});i(667294);var o=()=>i(846550),n=i(785893);const r=(0,i(827282).IU)("inbox",{viewBox:"0 0 30 30",svg:(0,n.jsx)("path",{d:"M4.445 25.3h20.532c2.296 0 3.457-1.16 3.457-3.421v-6.715c0-.902-.13-1.324-.563-1.887l-4.406-5.53c-1.195-1.5-1.793-1.934-3.668-1.934H9.625c-1.875 0-2.473.433-3.668 1.933l-4.406 5.531c-.434.563-.563.985-.563 1.887v6.715c0 2.273 1.172 3.422 3.457 3.422zm10.266-6.948c-1.734 0-2.93-1.442-2.93-3v-.059c0-.422-.234-.785-.738-.785h-8.11c-.304 0-.374-.27-.222-.469l4.664-5.93c.574-.726 1.207-1.02 2.121-1.02h10.43c.914 0 1.547.294 2.12 1.02l4.665 5.93c.164.2.094.469-.211.469h-8.121c-.504 0-.738.363-.738.785v.059c0 1.558-1.196 3-2.93 3zM4.469 23.859c-1.313 0-2.028-.703-2.028-2.05v-5.977h7.957c.188 2.25 2.004 3.855 4.313 3.855 2.309 0 4.125-1.617 4.312-3.855h7.957v5.977c0 1.347-.738 2.05-2.027 2.05H4.47z"})});function s(e){const{message:t,title:i}=e,s=(0,o().yK)((e=>({wrapper:{textAlign:"center",paddingLeft:20,paddingRight:20,height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",overflow:"hidden",minHeight:220},icon:{width:48,fill:e.mediumTextColor},message:{fontSize:14,color:e.lightTextColor,marginTop:2,marginBottom:4,maxWidth:380,textWrap:"balance"},title:{fontSize:14,fontWeight:500,color:e.mediumTextColor,maxWidth:380,textWrap:"balance"}})),[]),a=e.icon||r;return(0,n.jsxs)("div",{style:s.wrapper,children:[(0,n.jsx)("div",{style:{paddingBottom:12},children:a(s.icon)}),(0,n.jsx)("div",{style:s.title,children:i}),(0,n.jsx)("div",{style:s.message,children:t})]})}},75308:(e,t,i)=>{i.d(t,{Z:()=>a});var o=i(667294),n=()=>i(142735),r=i(785893);const s=i(263184).default.createClass(!1,{name:"OpenStore"});const a=function(e){let{items:t,visible:a}=e;const d=(0,i(846550).Fg)(),c=(0,n().qz)(void 0,s),u=(0,n().Kw)(c),h=(0,o.useCallback)((()=>function(e){e.setState(!0)}(c)),[c]);return u||t.length<=a?(0,r.jsx)("div",{children:t}):(0,r.jsxs)("div",{children:[t.slice(0,a),(0,r.jsx)(i(154186).Z,{onClick:h,style:l(d),children:(0,r.jsx)(i(788860)._H,{defaultMessage:"View {moreCount} more",id:"activity.viewMoreButton.label",values:{moreCount:t.length-a}})})]})};function l(e){return{display:"flex",alignItems:"center",height:28,fontSize:12,color:e.lightTextColor,padding:0,paddingLeft:52,paddingRight:16}}},943707:(e,t,i)=>{i.d(t,{Z:()=>s});i(667294);var o=()=>i(846550),n=()=>i(568017),r=i(785893);function s(){const e=(0,o().yK)((e=>({blockContext:{flexShrink:0,display:"flex",width:3,borderRadius:4,marginLeft:2,marginRight:8,minHeight:20,background:(0,n().DB)(e.mode)}})),[]);return(0,r.jsx)("div",{style:e.blockContext})}},930845:(e,t,i)=>{i.d(t,{D:()=>h,Z:()=>u});i(667294);var o=()=>i(846550),n=()=>i(788860),r=()=>i(253502),s=()=>i(603274),a=()=>i(269299),l=()=>i(777346),d=()=>i(966842),c=i(785893);function u(e){var t;const{isMobile:i,environment:n,rootStore:r,activity:s,tabArgs:a}=e,{source:l}=a,u=Boolean(null===(t=a.notification)||void 0===t?void 0:t.visited),g=(0,o().yK)((()=>({container:{paddingLeft:(0,d().c3)({source:l,isMobile:i})-8,paddingTop:4}})),[i,l]);return u?(0,c.jsx)("div",{style:g.container,children:(0,c.jsx)(h,{tabArgs:a,environment:n,rootStore:r,activity:s})}):null}function h(e){const{tabArgs:t,environment:i,rootStore:u,activity:h}=e,{notification:g,tab:f}=t,v=(0,o().yK)((e=>({secondaryButton:(0,d()._W)(e)})),[]);return Boolean(null==g?void 0:g.visited)?(0,c.jsx)(l().Z,{onClick:()=>{g&&(a().createAndCommit({userAction:"Activity.handleUnarchive",environment:i,canUndo:!0,perform:e=>{s().E1({notificationId:g.id,visited:!1,rootStore:u,transaction:e})}}),r().F5({environment:i,activity:h,tab:f,notificationId:g.id,alreadyRead:g.read}))},style:v.secondaryButton,children:(0,c.jsx)(n()._H,{defaultMessage:"Unarchive",id:"activity.actions.unarchiveButton.label"})}):null}},541714:(e,t,i)=>{i.d(t,{Z:()=>f});var o=i(667294),n=()=>i(142735),r=()=>i(506347),s=()=>i(396136),a=()=>i(306164),l=()=>i(577325),d=()=>i(384241),c=()=>i(514380),u=()=>i(966842),h=i(785893);function g(e){const{titledRecordStore:t,getRecordModel:g,activity:f,tabArgs:v,permissionRole:p,shouldRenderEmpty:m}=e,y=(0,n().VK)((()=>t.getModel()),[t]),b=(0,i(219727).O7)(),x=(0,i(788860).YB)(),S=(0,n().VK)((()=>null==y?void 0:y.getRenderIcon({getRecordModel:g})),[y,g]),j=(0,i(846550).yK)((()=>({container:p?{...u().lS,display:"flex",alignItems:"center"}:u().lS,icon:u().e9,recordTitle:(0,u().TL)(void 0!==S),role:{marginLeft:4,padding:0},titleAndRole:{display:"flex",flexFlow:"row",padding:1}})),[S,p]),I=(0,o.useCallback)((()=>{const e=t.table;switch(e){case s().iU:case i(752778).vF:case i(255933).bx:(0,c().V3)({environment:b,activity:f,...v});break;case a().e0:(0,c().dG)({environment:b,activity:f,...v}),i(44556).hI({environment:b,teamStore:t,shouldScroll:!0}),l().Z.setState({...l().Z.state,open:!1});break;default:(0,i(696459).t1)(e)}}),[f,b,v,t]),A=(0,n().VK)((()=>y&&y.table!==a().e0?y.getRenderUrl({getRecordModel:g,pageVisitSource:r().tY.Notification}):m&&t.table===s().iU?(0,i(135857).Z)({pageId:t.id,pageVisitSource:r().tY.LinkInPage}):void 0),[y,g,m,t.table,t.id]);if(!y&&!m)return null;const k=p?(0,h.jsxs)("div",{style:j.titleAndRole,children:[(0,h.jsx)(d().Z,{store:t,style:j.recordTitle}),(0,h.jsx)(i(67961).Z,{style:j.role,isSecondaryColor:!0,children:`(${x.formatMessage((0,i(528514).kD)(p,s().iU)).toLocaleLowerCase()})`})]}):(0,h.jsx)(d().Z,{store:t,style:j.recordTitle});return(0,h.jsxs)(i(729775).Z,{href:A,onClick:I,external:!1,innerStyle:j.container,inline:!0,children:[(S||m)&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(i(943620).Z,{disabled:!0,icon:S,isEmptyPage:!1,size:18,style:j.icon}),(0,h.jsx)("span",{children:" "})]}),k]})}const f=o.memo(g)},126514:(e,t,i)=>{i.d(t,{BE:()=>R,ZP:()=>B});var o=i(667294),n=()=>i(219727),r=()=>i(142735),s=()=>i(846550),a=()=>i(135796),l=()=>i(666117),d=()=>i(521913),c=()=>i(396136),u=()=>i(788860),h=()=>i(696459),g=()=>i(932005),f=()=>i(247724),v=()=>i(176691),p=()=>i(826955),m=()=>i(1910),y=()=>i(679063),b=()=>i(654133),x=()=>i(634760),S=()=>i(981583),j=()=>i(46335),I=()=>i(116432),A=()=>i(712910),k=i(785893);const _=16,T={paddingTop:12},C={fontSize:14,lineHeight:1.4,flexGrow:1,minWidth:0},M=i(263184).default.createClass(!1,{name:"HoveredStore"});const w={marginTop:2,marginRight:8,flexShrink:0};function R(e){const{authors:t,size:i,style:o,iconStyle:r,showAvatarShadow:a,showWarningIcon:l}=e,c=(0,n().O7)(),u=(0,s().yK)((e=>({container:{position:"relative"},icon:{position:"absolute",right:5,bottom:-3,fill:e.icon.yellowPrimary,height:12,width:12}})),[]),g=t.sort(((e,t)=>(0,A().FV)({actor:e,environment:c})-(0,A().FV)({actor:t,environment:c})))[0],f=i,v={...w,...o},p={...u.icon,...r};return g?g.isBot()?(0,k.jsxs)("div",{style:u.container,children:[(0,k.jsx)(x().Z,{botValue:g,style:v,size:f}),l&&(0,d().t)(p)]}):g.isUser()?(0,k.jsxs)("div",{style:u.container,children:[(0,k.jsx)(S().Z,{userValue:g,style:v,size:f,avatarShouldShowShadow:a??!0}),l&&(0,d().t)(p)]}):g.isAgent()?null:void(0,h().t1)(g):null}const B=function(e){let{children:t,icon:i,timestamp:s,header:a,navigableBlockId:l,rootStore:d,onBacklinkClicked:c,showSnapshotButton:u,isPrivate:h,isLast:g}=e;const v=(0,n().O7)(),p=(0,r().qz)(void 0,M),m=(0,o.useCallback)((()=>function(e){e.setState(!1)}(p)),[p]),y=(0,o.useCallback)((()=>function(e){e.setState(!0)}(p)),[p]),b=(0,o.useId)(),x=(0,r().VK)((()=>v.WindowSizeStore.state.paddingLeftCSS),[v]),S=(0,r().VK)((()=>v.WindowSizeStore.state.paddingRightCSS),[v]),j=(0,k.jsxs)("div",{style:{...T,paddingBottom:t?12:8,paddingLeft:v.device.isMobile?x:0,paddingRight:v.device.isMobile?S:0},children:[(0,k.jsxs)("div",{style:{display:"flex",paddingLeft:_,paddingRight:_},children:[(0,k.jsxs)("div",{className:f().FoE,style:{display:"flex",alignItems:"flex-start",position:"relative"},children:[(0,k.jsx)("div",{style:{marginRight:4}}),i]}),(0,k.jsx)(N,{timestamp:s,header:a,children:t,navigableBlockId:l,rootStore:d,onBacklinkClicked:c,titleAriaId:b}),(0,k.jsx)(D,{showSnapshotButton:u,timestamp:s,navigableBlockId:l,rootStore:d}),(0,k.jsx)(Z,{isPrivate:h})]}),t&&(0,k.jsx)(V,{children:t})]});return(0,k.jsxs)("article",{onMouseOver:y,onMouseLeave:m,"aria-labelledby":b,children:[j,(0,k.jsx)(P,{isLast:g})]})};function Z(e){let{isPrivate:t}=e;return t?(0,k.jsx)(I().Z,{style:{marginTop:1,marginBottom:4,marginLeft:8}}):null}function V(e){let{children:t}=e;return(0,k.jsx)("div",{className:f().nU_,children:t})}function O(e){return{borderBottom:`1px solid ${e.regularDividerColor}`}}function L(e){return{fontSize:12,color:e.lightTextColor}}function K(e){return{fontSize:12,color:e.lightTextColor,whiteSpace:"nowrap"}}function U(e){return{fontSize:12,color:e.lightTextColor,marginLeft:4,marginRight:4}}function P(e){let{isLast:t}=e;const i=(0,s().Fg)();return t?null:(0,k.jsx)("div",{style:O(i)})}function D(e){let{showSnapshotButton:t,timestamp:i,navigableBlockId:o,rootStore:r}=e;const s=(0,n().O7)(),a=(0,u().YB)();if(!t)return null;if(i<new Date("2018-10-26").getTime())return null;const d=a.formatMessage({defaultMessage:"View version for this update",id:"activitySection.viewVersionForUpdate.tooltip"});return o?(0,k.jsx)(b().Z,{renderTooltip:()=>d,render:e=>(0,k.jsx)(m().Z,{ariaLabel:d,onClick:()=>function(e,t,i,o){if(o){const n=p().G.createChildStore(e,{table:c().iU,id:o});g().jN({environment:i,blockStore:n,openSnapshotNearTimestamp:t.toString(),from:"activity"})}}(r,i,s,o),icon:l().J,...e})}):null}function N(e){let{titleAriaId:t,timestamp:i,header:n,children:r,navigableBlockId:l,rootStore:d,onBacklinkClicked:u}=e;const h=(0,s().Fg)(),g=(0,v().IS)(i),m=(0,v().uy)(i),b=(0,o.useMemo)((()=>l?p().G.createChildStore(d,{table:c().iU,id:l}):void 0),[l,d]);return(0,k.jsxs)("div",{style:C,children:[(0,k.jsx)("div",{id:t,className:f().NFf,children:n}),(0,k.jsxs)("div",{style:{display:"flex",marginTop:4,marginBottom:r?8:4},children:[(0,k.jsx)("div",{style:K(h),className:f().CZG,children:(0,k.jsx)(j().Z,{text:g,tooltipText:m,icon:a().C})}),d&&b&&(0,k.jsx)(y().ZP,{isLink:!0,innerStyle:L(h),store:b,left:(0,k.jsx)("div",{style:U(h),children:"·"}),onClick:u})]})]})}},27625:(e,t,i)=>{function o(e){return"pageUpdatesSidebar"===e.tab}i.d(t,{x:()=>o})},472706:(e,t,i)=>{i.d(t,{R:()=>A,Z:()=>k});i(267602),i(653476),i(241792),i(667294);var o=()=>i(219727),n=()=>i(142735),r=()=>i(506347),s=()=>i(156642),a=()=>i(836273),l=()=>i(396136),d=()=>i(602299),c=()=>i(386617),u=()=>i(788860),h=()=>i(826955),g=()=>i(729775),f=()=>i(104014),v=()=>i(75308),p=()=>i(514380),m=()=>i(712910),y=()=>i(930845),b=()=>i(966842),x=()=>i(541714),S=()=>i(126514),j=()=>i(27625),I=i(785893);function A(e){return(0,c().hI)(e).filter((e=>{const{block_value:t}="block-changed"===e.type?e.block_data.after:e.block_data;return t.parent_table!==d().x_}))}function k(e){const{activity:t,tabArgs:i,rootStore:r,isLast:s}=e,{notification:a,tab:d}=i,c=(0,o().O7)(),g=(0,n().VK)((()=>A(t.getEdits())),[t]),f=g[0],b=(0,n().VK)((()=>parseInt(t.end_time)),[t]),k=(0,n().VK)((()=>f&&h().G.createChildStore(r,{table:l().iU,id:f.navigable_block_id})),[f,r]),T=(0,n().VK)((()=>(0,m().P6)({edits:g,rootStore:r})),[g,r]),C=(0,n().VK)((()=>(0,m().XW)(T)),[T]),M=(0,n().VK)((()=>k&&(0,m().jC)({recordId:k.id,recordType:"block",tab:d,rootStore:r,environment:c})),[k,d,r,c]);if(0===g.length||!k)return null;const w=(0,I.jsx)(x().Z,{titledRecordStore:k,activity:t,tabArgs:i,getRecordModel:r.getRecordModel});return(0,I.jsxs)(S().ZP,{timestamp:b,header:(0,I.jsx)("span",{children:(0,I.jsx)(u()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited {pageTitle}} other {{authorOrAuthors} edited {pageTitle}}}",id:"activity.blockEdited.header",values:{numberOfAuthors:T.length,authorOrAuthors:C,pageTitle:w}})}),isLast:s,isPrivate:M,rootStore:r,navigableBlockId:k.id,icon:(0,I.jsx)(S().BE,{authors:T,size:24}),showSnapshotButton:(0,j().x)(i),...(0,p().h9)({notification:a,activity:t,environment:c,tab:d}),children:[(0,I.jsx)(v().Z,{visible:5,items:g.map(((e,o)=>(0,I.jsx)(_,{edit:e,index:o,activity:t,rootStore:r,tabArgs:i},o)))}),(0,I.jsx)(y().Z,{tabArgs:i,activity:t,isMobile:c.device.isMobile,environment:c,rootStore:r})]})}function _(e){let{edit:t,index:i,activity:d,rootStore:c,tabArgs:u}=e;const h=(0,o().O7)(),{source:v}=u,m=(0,n().VK)((()=>{let e=c.getRecordModel({table:l().iU,id:t.block_id});return e&&e.type===s().Ti.tableRow&&(e=c.getRecordModel({table:l().iU,id:e.parent_id})),e?e.getRenderUrl({getRecordModel:c.getRecordModel,pageVisitSource:r().tY.Activity}):a()._j.root}),[t.block_id,c]),y=h.device.isMobile;return"block-deleted"===t.type?t.block_data.block_value.type===s().Ti.page?(0,I.jsx)(g().Z,{href:m,onClick:()=>(0,p().dG)({...u,environment:h,activity:d}),innerStyle:(0,b().OD)({source:v,isMobile:y}),children:(0,I.jsx)(f().Z,{edit:t,rootStore:c})},i):(0,I.jsx)("div",{style:(0,b().OD)({source:v,isMobile:y}),children:(0,I.jsx)(f().Z,{edit:t,rootStore:c})},i):(0,I.jsx)(g().Z,{href:m,onClick:()=>(0,p().dG)({...u,environment:h,activity:d}),innerStyle:(0,b().OD)({source:v,isMobile:y}),children:(0,I.jsx)(f().Z,{edit:t,rootStore:c})},i)}},121761:(e,t,i)=>{i.d(t,{HY:()=>R,QZ:()=>B,tB:()=>P});i(267602),i(916054),i(653476),i(241792);var o=i(667294),n=()=>i(219727),r=()=>i(142735),s=()=>i(846550),a=()=>i(396136),l=()=>i(542973),d=()=>i(81954),c=()=>i(955620),u=()=>i(788860),h=()=>i(696459),g=()=>i(707513),f=()=>i(253502),v=()=>i(874018),p=()=>i(547592),m=()=>i(718611),y=()=>i(641702),b=()=>i(239482),x=()=>i(826955),S=()=>i(729775),j=()=>i(777346),I=()=>i(126514),A=()=>i(514380),k=()=>i(943707),_=()=>i(712910),T=()=>i(930845),C=()=>i(966842),M=i(785893);function w(e){return"comment-created"===e.type}function R(e){return e.length>0&&e.every(w)}function B(e,t,i){if(!i)return[];let o=e.filter((e=>{switch(e.type){case"comment-changed":return!1;case"comment-created":case"comment-deleted":case"suggestion-created":return!0;default:(0,h().t1)(e)}}));0===o.length&&0!==e.length&&"updates_sidebar"!==t&&(o=e);const n="suggestion"===(null==i?void 0:i.getType())&&(null==i?void 0:i.getCommentPointers()[0]),r=o[0];return r&&n&&r&&"comment-created"===r.type&&r.comment_id===n.id&&(o=o.slice(0)),o}function Z(e){const{activity:t,rootStore:s,isLast:d,tabArgs:c}=e,{source:g,tab:f,notification:v}=c,m=(0,n().O7)(),y=(0,r().VK)((()=>{const e=s.getRecordStore(s,{table:l().qF,id:t.discussion_id,spaceId:t.space_id});if(e.isDefined())return e}),[t,s]),j=(0,r().VK)((()=>null==y?void 0:y.getType()),[y]),k=(0,r().VK)((()=>{const e=null==y?void 0:y.getModel();if(e)return(0,_().Pq)(e)}),[y]),T=(0,r().VK)((()=>{const e=null==y?void 0:y.getParentPointer();if(e)return x().G.createChildStore(s,e)}),[y,s]),w=(0,r().VK)((()=>Boolean(T&&T.isDefined())),[T]),R=(0,r().VK)((()=>{const e=null==T?void 0:T.getNavigableBlockStore();return(null==e?void 0:e.id)||t.navigable_block_id}),[t,T]),Z=x().G.createChildStore(s,{table:a().iU,id:R}),O=(0,r().VK)((()=>Z.isDefined()),[Z]),K=(0,r().VK)((()=>Boolean(T&&(0,b().fl)((0,b().eG)(T)))),[T]),P=(0,r().VK)((()=>{if(!K||!T)return;const e=T.getModel();return e?e.getRenderUrl({getRecordModel:s.getRecordModel,discussionId:t.discussion_id,pageVisitSource:i(506347).tY.Notification}):void 0}),[K,T,s,t]),D=(0,r().VK)((()=>B(t.getEdits(),g,y)),[t,y,g]),N=D.length>0,F=(0,r().VK)((()=>(0,_().P6)({edits:D,rootStore:s})),[D,s]),H=(0,r().VK)((()=>(0,_().XW)(F)),[F]),z=K,E=(0,o.useCallback)((e=>{if((0,A().dG)({...c,environment:m,activity:t,mightCloseTab:z}),!K&&T&&y){var i;const o=e.target;p().oK({environment:m,discussionStore:y,rect:o.getBoundingClientRect(),blockStore:T,discussionLocation:U({forReplyMenu:!0,source:c.source}),activityId:t.id,notificationId:null===(i=c.notification)||void 0===i?void 0:i.id})}}),[t,K,T,y,m,c,z]),q=(0,o.useCallback)((e=>{"Removed"===e?(0,A().Tq)({...c,environment:m,activity:t,mightCloseTab:z}):"Added"===e?(0,A().Z5)({...c,environment:m,activity:t,mightCloseTab:z}):(0,h().t1)(e)}),[c,m,t,z]),G=(0,M.jsx)(i(541714).Z,{titledRecordStore:Z,getRecordModel:s.getRecordModel,activity:t,tabArgs:c}),W=(0,r().VK)((()=>(0,_().jC)({recordId:R,recordType:a().iU,tab:f,rootStore:s,environment:m})),[R,f,s,m]),Y=m.device.isMobile,J=(0,r().VK)((()=>U({source:g,forReplyMenu:!1})),[g]),$=(0,r().VK)((()=>parseInt(t.end_time)),[t]);return N&&O&&w&&y?(0,M.jsxs)(I().ZP,{timestamp:$,header:"suggestion"===j?(0,M.jsx)("span",{children:(0,M.jsx)(u()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} suggested in {blockName}} other {{authorOrAuthors} suggested in {blockName}}}",values:{numberOfAuthors:F.length,authorOrAuthors:H,blockName:G},id:"activity.commentActivity.header.suggestion"})}):(0,M.jsx)("span",{children:(0,M.jsx)(u()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented in {blockName}} other {{authorOrAuthors} commented in {blockName}}}",values:{numberOfAuthors:F.length,authorOrAuthors:H,blockName:G},id:"activity.commentActivity.header"})}),isLast:d,isPrivate:W,rootStore:s,navigableBlockId:R,icon:(0,M.jsx)(I().BE,{authors:F,size:24}),showSnapshotButton:!1,...(0,A().h9)({notification:v,environment:m,tab:f,activity:t}),children:[y&&k&&(0,M.jsx)(V,{rootStore:s,discussionStore:y,onClick:E,source:g,url:P}),(0,M.jsx)(i(75308).Z,{visible:5,items:D.map(((e,t,o)=>(0,M.jsx)(S().Z,{onClick:E,href:P,innerStyle:(0,C().OD)({source:g,isMobile:Y}),children:(0,M.jsx)(i(104014).Z,{edit:e,rootStore:s,type:"comment-edit",discussionLocation:J,onReactionToggle:q,hideAuthorName:!1})},t)))}),(0,M.jsx)(L,{activity:t,rootStore:s,tabArgs:c})]}):null}function V(e){const{rootStore:t,discussionStore:i,onClick:o,source:a,url:l}=e,d=(0,r().VK)((()=>i.getType()),[i]),c=(0,n().O7)().device.isMobile,u=(0,s().yK)((e=>({linkbox:{...(0,C().OD)({source:a,isMobile:c}),display:"flex",alignItems:"center",fontSize:14,paddingTop:2,paddingBottom:6,marginBottom:0}})),[c,a]);return(0,M.jsx)(S().Z,{href:l,onClick:o,innerStyle:u.linkbox,children:"suggestion"===d?(0,M.jsx)(v().s3,{discussionStore:i,collapsed:!1}):(0,M.jsx)(O,{rootStore:t,discussionStore:i})})}function O(e){const t=(0,n().O7)(),i=(0,s().Fg)(),{rootStore:o,discussionStore:a}=e,l=(0,r().VK)((()=>{const e=a.getModel();if(e)return(0,_().Pq)(e)}),[a]),d=0===(0,c().llS)(l).length,u=(0,s().yK)((e=>({text:{...g().Yu,...d&&{color:e.mediumTextColor}}})),[d]),h=(0,r().VK)((()=>(0,y().IY)({environment:t,textValue:l?{value:l,spaceId:o.id}:void 0,parentStore:o,disableHover:!0,disableStyleAnnotations:d,disableInsertedDeletedAnnotations:d,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disabled:!0,highlightDiscussionId:a.id,theme:i,emojiType:(0,m().e_)(t),katex:t.KatexStore.getKatex(),formulaValueTypes:[]})),[t,l,o,d,a.id,i]);return(0,M.jsxs)(M.Fragment,{children:[d&&(0,M.jsx)(k().Z,{}),(0,M.jsx)("div",{style:u.text,children:h})]})}function L(e){const{activity:t,rootStore:i,tabArgs:c}=e,{source:h,notification:g,tab:v}=c,m=(0,r().VK)((()=>{const e=i.getRecordStore(i,{table:l().qF,id:t.discussion_id,spaceId:t.space_id});if(e.isDefined())return e}),[t,i]),y=(0,n().O7)(),b=y.device.isMobile,S=(0,r().VK)((()=>x().t1.createChildStore(i,{table:l().qF,id:t.discussion_id,spaceId:(0,d().J)(i.pointer.spaceId)})),[t,i]),I=(0,r().VK)((()=>null==m?void 0:m.getParentId()),[m]),A=(0,o.useCallback)((e=>{if(!I)return;const o=x().G.createChildStore(i,{table:a().iU,id:I}),n=e.target,r=null==g?void 0:g.id;p().oK({environment:y,discussionStore:S,rect:n.getBoundingClientRect(),blockStore:o,discussionLocation:U({forReplyMenu:!0,source:h}),activityId:t.id,notificationId:r}),"notifications_tab"===h&&f().gY({environment:y,notificationId:r,alreadyRead:Boolean(null==g?void 0:g.read),activity:t,tab:v})}),[t,S,y,g,I,i,h,v]),k=(0,s().yK)((e=>({container:{paddingLeft:(0,C().c3)({source:h,isMobile:b}),paddingTop:12,paddingBottom:4},actionButton:(0,C().b9)(e)})),[b,h]),_=Boolean(null==g?void 0:g.visited);return m?(0,M.jsxs)("div",{style:k.container,children:[(0,M.jsx)(j().Z,{onClick:A,style:k.actionButton,children:(0,M.jsx)(u()._H,{defaultMessage:"Reply",id:"activityUpdate.replyButton.label"})}),_&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(K,{}),(0,M.jsx)(T().D,{tabArgs:c,environment:y,rootStore:i,activity:t})]})]}):null}function K(){return(0,M.jsx)("div",{style:{width:5,display:"inline-block"}})}function U(e){const{forReplyMenu:t,source:i}=e;if("updates_sidebar"===i)return t?"reply_menu_updates_sidebar":"updates_sidebar";return`${t?"reply_menu_":"updates_menu_"}${f().Jn()}`}const P=o.memo(Z)},514380:(e,t,i)=>{i.d(t,{JJ:()=>p,Tq:()=>h,V3:()=>d,YE:()=>c,Z5:()=>g,dG:()=>l,h9:()=>v,ug:()=>u});var o=()=>i(575741),n=()=>i(253502),r=()=>i(594546),s=()=>i(763589),a=()=>i(781022);function l(e){const t=e.mightCloseTab??!0;f({target:"body",...e,mightCloseTab:t})}function d(e){const t=e.mightCloseTab??!0;f({target:"title",...e,mightCloseTab:t})}function c(e){f({target:"approve_request_access",...e,mightCloseTab:!1})}function u(e){f({target:"deny_request_access",...e,mightCloseTab:!1})}function h(e){f({target:"remove_reaction",...e,mightCloseTab:!1})}function g(e){f({target:"add_reaction",...e,mightCloseTab:!1})}function f(e){const{target:t,environment:i,activity:s,notification:l,source:d,tab:c,mightCloseTab:u}=e,h="notifications_tab"===d?a().default.state.sessionId:void 0,g="notifications_tab"===d?a().default.isFilteredToUnreadOnly():void 0;n().Cg(i,{target:t,activity_id:s.id,notification_id:null==l?void 0:l.id,notification_page_id:null==l?void 0:l.navigable_block_id,sessionId:h,is_filtered:g,tab:c}),u&&n().pw({environment:i,target:t}),l&&o().e((0,r().mc)(i),{alreadyRead:l.read,notificationId:l.id,activityId:l.activity_id,from:t,sessionId:h})}function v(e){const{notification:t,activity:i,environment:o,tab:r}=e,s={environment:o,activity:i,notificationId:null==t?void 0:t.id,alreadyRead:Boolean(null==t?void 0:t.read),tab:r};return{onBacklinkClicked:e=>n().EQ({...s,backlinkPageId:e}),onNotificationFrameClicked:()=>n().ix(s),...p({notification:t,activity:i,environment:o,tab:r})}}function p(e){const{notification:t,activity:i,environment:o,tab:r}=e,a={environment:o,activity:i,notificationId:null==t?void 0:t.id,alreadyRead:Boolean(null==t?void 0:t.read),tab:r},l=()=>{const e={notification_type:null==t?void 0:t.type,notification_page_id:null==t?void 0:t.navigable_block_id,tab:s().Fz()};return"commented"===(null==t?void 0:t.type)&&(e.discussion_id=null==i?void 0:i.discussion_id),e};return{onArchiveClicked:()=>n()._b({...a,otherArgs:l()}),onUnarchiveClicked:()=>n().F5({...a,otherArgs:l()}),onMarkAsReadClicked:()=>n().cC({...a,otherArgs:l()}),onMarkAsUnreadClicked:()=>n().u_({...a,otherArgs:l()}),onNotificationBodyClicked:()=>n()._H({...a,otherArgs:l()})}}},712910:(e,t,i)=>{i.d(t,{FV:()=>T,uA:()=>B,XW:()=>w,m4:()=>R,P6:()=>M,cr:()=>O,Pq:()=>L,jC:()=>V,V2:()=>C,N8:()=>Z,dM:()=>K});i(492176),i(7961),i(267602),i(749411),i(241792),i(228244),i(667294);var o=()=>i(492788),n=()=>i(816512),r=(i(653476),i(470928),()=>i(788860)),s=()=>i(707513),a=i(785893);var l=()=>i(580397),d=()=>i(494616),c=()=>i(396136),u=()=>i(696056),h=()=>i(752778),g=()=>i(542973),f=()=>i(989478),v=()=>i(955620),p=()=>i(349220),m=()=>i(513670),y=()=>i(839002),b=()=>i(696459),x=()=>i(139224),S=()=>i(915687),j=()=>i(887430),I=()=>i(527278),A=()=>i(122479),k=()=>i(876822),_=()=>i(826955);function T(e){let{actor:t,environment:i}=e;return t.isBot()?2:i.currentUser.id===t.id?1:0}function C(e){const{authorStores:t,currentUserId:i}=e;if(!i||0===t.length)return{frontActorStore:void 0,backActorStore:void 0};const o=t.some((e=>e.id===i)),n=t.sort(((e,t)=>(e.id===i?1:0)-(t.id===i?1:0)));return{frontActorStore:n.at(0)||void 0,backActorStore:n.at(Math.max(1,n.length-(o?2:1)))||void 0}}function M(e){const{edits:t,rootStore:i}=e,o=m().sv(t.flatMap((e=>e.authors||[])),m().Xy),n=m().oA(o.map((e=>B(e,i))));return n.sort(((e,t)=>T({actor:e,environment:i.environment})-T({actor:t,environment:i.environment}))),n}function w(e,t){const{currentUserStore:i}=k().default.state,o=null==i?void 0:i.id;return function(e,t,i,o){const l=t.find((e=>e.id===i)),d=t.map((t=>(0,n().$4)(e,t))),c={fontWeight:s().Ue.semibold,...o};if(1===t.length)return l?(0,a.jsx)("span",{children:(0,a.jsx)(r()._H,{defaultMessage:"You",id:"activitySection.authorPhrase.forOneAuthorCurrentUser.label",values:{b:e=>(0,a.jsx)("span",{style:c,children:e})}})}):(0,a.jsx)("span",{children:(0,a.jsx)(r()._H,{defaultMessage:"<b>{author}</b>",id:"activitySection.authorPhrase.forOneAuthor.label",values:{author:d[0],b:e=>(0,a.jsx)("span",{style:c,children:e})}})});if(2===t.length){if(l){const i=t.filter((e=>e!==l)).map((t=>(0,n().$4)(e,t)));return(0,a.jsx)("span",{children:(0,a.jsx)(r()._H,{defaultMessage:"<b>{firstAuthor}</b> and you",id:"activitySection.authorPhrase.forTwoAuthorsCurrentUser.label",values:{firstAuthor:i[0],b:e=>(0,a.jsx)("span",{style:c,children:e})}})})}return(0,a.jsx)("span",{children:(0,a.jsx)(r()._H,{defaultMessage:"<b>{firstAuthor}</b> and <b>{secondAuthor}</b>",id:"activitySection.authorPhrase.forTwoAuthors.label",values:{firstAuthor:d[0],secondAuthor:d[1],b:e=>(0,a.jsx)("span",{style:c,children:e})}})})}if(d.length>2){if(l){const i=t.filter((e=>e!==l)).map((t=>(0,n().$4)(e,t))),o=(0,a.jsx)(r()._H,{defaultMessage:"{numberOfOtherAuthors, plural, =0 {<b>{firstAuthor}</b>, <b>{secondAuthor}</b> and you} one {<b>{firstAuthor}</b>, <b>{secondAuthor}</b>, you and {numberOfOtherAuthors} other} other {<b>{firstAuthor}</b>, <b>{secondAuthor}</b>, you and {numberOfOtherAuthors} others}}",id:"activitySection.authorPhrase.forMoreThanTwoAuthorsCurrentUser.label",values:{numberOfOtherAuthors:i.length-2,firstAuthor:i[0],secondAuthor:i[1],b:e=>(0,a.jsx)("span",{style:c,children:e})}});return(0,a.jsx)("span",{children:o})}{const e=(0,a.jsx)(r()._H,{defaultMessage:"{numberOfOtherAuthors, plural, one {<b>{firstAuthor}</b>, <b>{secondAuthor}</b>, and {numberOfOtherAuthors} other} other {<b>{firstAuthor}</b>, <b>{secondAuthor}</b>, and {numberOfOtherAuthors} others}}",id:"activitySection.authorPhrase.forMoreThanTwoAuthors.label",values:{numberOfOtherAuthors:d.length-2,firstAuthor:d[0],secondAuthor:d[1],b:e=>(0,a.jsx)("span",{style:c,children:e})}});return(0,a.jsx)("span",{children:e})}}return(0,a.jsx)("span",{style:c,children:(0,a.jsx)(r()._H,{defaultMessage:"Nobody",id:"activitySection.authorPhrase.forNoAuthors.label"})})}(I().Z.getIntl(),e,o,t)}function R(e,t){return(0,a.jsx)("span",{children:(0,a.jsx)(r()._H,{defaultMessage:"<b>{author}</b>",id:"activitySection.authorPhrase.forOneAuthor.email",values:{author:e,b:e=>(0,a.jsx)("span",{style:t,children:e})}})})}function B(e,t){if(e.table===f().KJ){const i=Z(e.id,t);if(i)return(0,n().dp)(i)}else{const i=function(e,t){const i=(0,_().Kv)(t,{table:u().cZ,id:e});return i.getValue()}(e.id,t);if(i)return(0,n().D$)(i)}}function Z(e,t){return _().U6.createChildStore(t,{table:f().KJ,id:e}).getValue()}function V(e){const{tab:t,recordId:i,recordType:o,rootStore:n,environment:r}=e;if("all"===t){if(!i)return!1;let e;return"block"===o?e=_().G.createChildStore(n,{table:c().iU,id:i}):"collection"===o?e=_().NW.createChildStore(n,{table:h().vF,id:i}):(0,b().t1)(o),(0,A().yi)(r,e)}return!1}function O(e){const{activity:t,rootStore:i}=e;if("commented"!==t.type)return;const o=i.getRecordModel({table:g().qF,id:t.discussion_id,spaceId:t.space_id});if(!o)return;const n=L(o);return n?{id:o.id,context:n}:void 0}function L(e){const t=e.getPersistedContext(),i=t?(0,l().Bb)({discussionContextData:t,discussionType:(0,p().TO)(e.getType()),discussionId:e.id,intl:I().Z.getIntl()}):void 0;if(i)return(0,v().VP_)(i,(t=>!(0,v().xw5)(t)||(0,v().h19)(t)===e.id))}async function K(e){const{environment:t,automationNavigableBlockStore:i,automationId:n,source:r,rootStore:s}=e;await o().default.afterNextFlush();const a=await async function(e,t){const i=Date.now(),o=async()=>{const n=e();return void 0!==n?n:Date.now()-i>=t?void 0:(await(0,y().Vs)(10),await o())};return await o()}((()=>(0,j().fm)(i)),2e3);if(!a)return;const l=a.settingsStore;if(l)if(n){"event"===s.getRecordStore(s,{table:d().cv,id:n,spaceId:s.getSpaceId()}).getTriggerType()&&(x().r$({collectionContextStore:a,collectionSettingsStore:l}),S().b({environment:t,collectionContextStore:a,collectionSettingsStore:l,mode:"edit_automation",automationId:n,source:r}))}else x().r$({collectionContextStore:a,collectionSettingsStore:l}),x().wl({collectionSettingsStore:l,item:{type:"automationSettings",source:r}})}},966842:(e,t,i)=>{i.d(t,{OD:()=>a,TL:()=>c,_W:()=>d,b9:()=>u,c3:()=>l,e9:()=>r,lS:()=>n,nP:()=>s});const o={userSelect:"text",WebkitUserSelect:"text"},n={padding:1,...o},r={display:"inline-flex",marginRight:2,verticalAlign:"text-top"},s={fontWeight:i(707513).Ue.semibold};function a(e){return{padding:0,paddingLeft:l(e),paddingRight:16,paddingBottom:3,...o}}function l(e){const{source:t,isMobile:i}=e;return"notifications_tab"===t?52+(i?3:2):52}function d(e){return{height:26,paddingLeft:8,paddingRight:8,color:e.mediumTextColor}}function c(e){return{display:"inline",whiteSpace:"normal",marginRight:e?3:0,wordBreak:"break-word",...s}}function u(e){return{boxShadow:e.shadow2XS,height:26,paddingLeft:8,paddingRight:8,fontWeight:500,color:e.regularTextColor}}},118761:(e,t,i)=>{i.d(t,{EX:()=>o,HB:()=>r,IS:()=>s});i(241792);let o=function(e){return e[e.Sidebar=0]="Sidebar",e[e.SidebarMobile=1]="SidebarMobile",e[e.MobileBottomBarPhone=2]="MobileBottomBarPhone",e[e.MobileBottomBarTablet=3]="MobileBottomBarTablet",e[e.TopbarMobile=4]="TopbarMobile",e[e.RenderAsPage=5]="RenderAsPage",e}({});const n=new Map;function r(e,t){n.set(a(e),t)}function s(e){return n.get(a(e))??[]}function a(e){return Object.keys(e).sort().map((t=>{const i=e[t];return JSON.stringify(i)})).join("-")}},745624:(e,t,i)=>{i.d(t,{B:()=>s});i(241792),i(667294);var o=()=>i(846550),n=()=>i(668001),r=i(785893);function s(e){let t=Math.floor(e.areaHeight/124);0===t&&(t=1);const i=(0,o().yK)((e=>({skeletonRect:{height:8,borderRadius:4,margin:10,backgroundColor:e.lightDividerColor},skeletonCircle:{display:"flex",width:28,height:28,marginRight:8,backgroundColor:e.lightDividerColor,borderRadius:20},skeletonSection:{display:"flex",width:"100%",margin:20,flexDirection:"row"}})),[8,10,20]),s=[...Array(t)].map(((e,t)=>(0,r.jsxs)("div",{style:i.skeletonSection,children:[(0,r.jsx)(n().Z,{style:i.skeletonCircle}),(0,r.jsxs)("div",{style:{width:"80%"},children:[(0,r.jsx)(n().Z,{style:{width:"80%",...i.skeletonRect,marginTop:0}}),(0,r.jsx)(n().Z,{style:{width:"50%",...i.skeletonRect}}),(0,r.jsx)(n().Z,{style:{width:"60%",...i.skeletonRect}}),(0,r.jsx)(n().Z,{style:{width:"50%",...i.skeletonRect}})]})]},t)));return(0,r.jsx)("div",{children:s})}},70751:(e,t,i)=>{i.d(t,{o:()=>o});class o extends(()=>i(263184))().default{getInitialState(){return{activityIds:[],shouldLoadNewerActivities:!1,shouldLoadOlderActivities:!0,hasOlderActivities:!0,filterActivityTypes:[],filterDateRange:{starting:void 0,ending:void 0}}}}},666117:(e,t,i)=>{i.d(t,{J:()=>n});i(667294);var o=i(785893);const n=(0,i(827282).IU)("versionHistoryThick",{viewBox:"0 0 14 14",svg:(0,o.jsx)("path",{d:"M0 7C0 3.136 3.129 0 6.993 0C10.864 0 14 3.136 14 7C14 10.864 10.864 14 6.993 14C3.129 14 0 10.864 0 7ZM1.4 7C1.4 10.094 3.906 12.6 7 12.6C10.094 12.6 12.6 10.094 12.6 7C12.6 3.906 10.094 1.4 7 1.4C3.906 1.4 1.4 3.906 1.4 7ZM6.3 3.5H7.35V7.175L10.5 9.044L9.975 9.905L6.3 7.7V3.5Z"})})}}]);