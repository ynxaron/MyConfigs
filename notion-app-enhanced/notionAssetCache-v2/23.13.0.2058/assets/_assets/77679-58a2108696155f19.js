"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[77679],{491925:(e,t,o)=>{o.d(t,{Ty:()=>l,hW:()=>a,nI:()=>s,vp:()=>c});o(267602),o(653476),o(241792);var i=()=>o(142735),r=()=>o(696459),n=()=>o(469753);const a=(0,o(788860).vU)({unsupportedPublicQuestionType:{defaultMessage:"This question type cannot be used in public forms.",id:"useNewQuestionPropertyMenuItems.invalidPublicQuestionType"},relatedCollectionNotPublic:{defaultMessage:"Only relations to public databases are supported in public forms.",id:"formEditorQuestion.relatedCollectionNotPublic"},editorPlaceholder:{defaultMessage:"Respondent's answer",id:"formEditorQuestion.editorPlaceholder"},viewerEmptyPlaceholder:{defaultMessage:"Your answer",id:"formEditorQuestion.viewerEmptyPlaceholder"}});function s(e){let{layoutStore:t,collectionStore:o}=e;const a=(0,i().VK)((()=>t.getFormQuestionsForFormLayout()??[]),[t]),s=(0,i().VK)((()=>a.map((e=>{var t;return null===(t=e.getConfig())||void 0===t?void 0:t.propertyId})).filter(r().$K)),[a]);return(0,i().VK)((()=>{if(!o)return[];const e=o.getSchema();if(!t.getModel())return[];return(0,r().qP)(e).map((e=>{let[t,o]=e;if(o&&(0,n().I0)(o)&&!s.includes(t))return t})).filter(r().$K)}),[o,t,s])}function l(e){const t=e.type;return["person","relation","multi_select"].includes(t)}function c(e,t){var o;if(!e||!l(e))return;const i=e.type,r=null==t||null===(o=t.getPropertyTypeSpecificConfig(i))||void 0===o?void 0:o.maxSelectionCount;if("multi_select"===e.type)return r;const n=e.limit;return void 0===r?n:void 0===n||r<n?r:n}},731887:(e,t,o)=>{o.d(t,{D:()=>K});var i=o(667294),r=()=>o(219727),n=()=>o(142735),a=()=>o(496205),s=()=>o(788860),l=()=>o(696459),c=()=>o(75283),d=()=>o(333068),u=(o(267602),o(228244),()=>o(846550)),p=()=>o(816512),f=()=>o(135796),m=()=>o(429600),v=()=>o(328714),g=()=>o(730388),y=()=>o(501274),b=()=>o(707513),h=()=>o(352230),V=()=>o(90065),M=()=>o(998901),P=()=>o(827973),x=()=>o(198829),w=()=>o(255577),C=()=>o(470386),S=()=>o(388284),T=()=>o(654133),O=()=>o(67961),k=()=>o(799026),R=()=>o(213121),B=o(785893);function j(e){const{onClose:t,blockStore:o,setVerificationMenuDisplay:i}=e,a=(0,r().O7)(),l=(0,s().YB)(),c=a.device.isMobile,j=(0,n().VK)((()=>(0,V().T7)(o)),[o]),A="verified"===j.type,E="verified"===j.type||"expired"===j.type,U=(0,n().VK)((()=>{const{verificationOwners:e}=(0,V().zV)({blockStore:o}),t=e.length;if(t<=0)return l.formatMessage(R().b.noOwners);const i=e[0],r=(0,p().Hl)({pointer:i,getRecordModel:o.getRecordModel}),n=null==r?void 0:r.asActor,a=null==n?void 0:n.getDisplayName(l);if(!a)return l.formatMessage(R().b.noOwners);const s=t-1;return l.formatMessage(R().b.ownersAttribution,{actorName:a,numOtherActors:s})}),[o,l]),D=(0,n().VK)((()=>o.canEdit()),[o]),H=(0,n().VK)((()=>{const{verificationOwners:e}=(0,V().zV)({blockStore:o}),t=a.currentUser.id;return e.some((e=>e.id===t))}),[o,a.currentUser]),I=(0,u().yK)((e=>({disabledButton:{opacity:.7},redStyling:{color:e.text.uiRedPrimary},iconStyle:{height:c?16:12,width:c?16:12},buttonRightContainer:{display:"flex",alignItems:"center",maxWidth:150,gap:2,color:e.icon.secondary},buttonRightText:{color:e.icon.secondary,fontSize:c?b().JB.UIRegular.mobile:b().JB.UISmall.desktop},footer:{color:e.text.secondary,fontSize:b().JB.UISmall.desktop,borderTop:c?`1px solid ${e.regularDividerColor}`:void 0}})),[c]),K="none"!==j.type&&(0,B.jsx)("div",{style:I.footer,children:(0,B.jsx)(k().r,{lastVerifiedDate:A&&j.isIndefinite?j.startDateTime:j.dateTimeRange.start,getRecordModel:o.getRecordModel,actorPointer:j.actorPointer})});let N;return N=c?{menuType:h().o.Modal,title:l.formatMessage(R().b.verificationMenuTitle),right:(0,B.jsx)(C().DoneMenuText,{}),onClickRight:t,footer:K}:{menuType:h().o.Popup,width:320,footer:K},(0,B.jsx)(x().Z,{...N,children:(0,B.jsx)(w().ZP,{type:w().iW.Vertical,initialFocus:0,sections:[{key:"Verification Configuration",render:e=>(0,B.jsx)(S().Z,{...e,hideTitle:c,title:l.formatMessage(R().b.verificationMenuTitle),disableMobilePadding:!0,disableMobileBorders:!0}),items:[{key:"Expiration",render:e=>{let t=l.formatMessage(R().b.noExpiration);"verified"!==j.type||j.isIndefinite?"expired"===j.type&&(t=y().mb({dateTime:j.dateTimeRange.end,intl:l,shortenDateAndRange:!0})):t=y().mb({dateTime:j.dateTimeRange.end,intl:l,shortenDateAndRange:!0});const o=!H,i=(0,B.jsxs)("div",{style:I.buttonRightContainer,children:[(0,B.jsx)(O().Z,{style:I.buttonRightText,showTooltipWhenTruncated:!0,children:t}),H&&(0,m().o)(I.iconStyle)]});return(0,B.jsx)(T().Z,{placement:M().Placement.Right,render:t=>(0,B.jsx)(P().Z,{...e,...t,title:l.formatMessage(R().b.expirationProperty),icon:(0,f().C)({...I.iconStyle}),right:i,disabled:o,buttonStyle:o?I.disabledButton:void 0}),renderTooltip:()=>l.formatMessage(R().b.nonOwnersCannotEditVerification),disableTooltip:!o})},action:()=>{i("expiration")}},{key:"Verifier",render:e=>(0,B.jsx)(P().Z,{...e,title:l.formatMessage(R().b.verifierProperty),icon:(0,g().f)({...I.iconStyle}),right:(0,B.jsxs)("div",{style:I.buttonRightContainer,children:[(0,B.jsx)(O().Z,{style:I.buttonRightText,showTooltipWhenTruncated:!0,children:U}),(0,m().o)(I.iconStyle)]}),disabled:!D}),action:()=>{i("owner")}},{key:"Remove",render:e=>{const t=!H||!E;return(0,B.jsx)(T().Z,{placement:M().Placement.Right,render:o=>(0,B.jsx)(P().Z,{...e,...o,title:l.formatMessage(R().b.removeVerificationProperty),icon:(0,v().U)({...I.iconStyle}),style:I.redStyling,disabled:t,buttonStyle:t?I.disabledButton:void 0}),renderTooltip:()=>l.formatMessage(R().b.nonOwnerCannotRemoveVerification),disableTooltip:!t})},action:()=>{var e;e={value:void 0},d().O({environment:a,blockStore:o,verificationValue:e.value}),t()}}]}]})})}var A=()=>o(102182),E=()=>o(269299),U=()=>o(356321),D=()=>o(440633);function H(e){const{blockStore:t,onClose:o}=e,i=(0,r().O7)(),c=(0,s().YB)(),{verifierValue:d,isDefaultUnpersistedValue:u}=(0,n().VK)((()=>{const{verificationOwners:e,isCreatedByDefault:o}=(0,V().zV)({blockStore:t});return{verifierValue:e,isDefaultUnpersistedValue:Boolean(o)}}),[t]);return(0,B.jsx)(D().ZP,{value:d,format:U().C.Page,valueIsUnpersistedDefaultValue:u,propertySchema:{name:c.formatMessage(R().b.verifierProperty),type:"person",limit:void 0,default:"created_by"},schema:{},insertChar:void 0,disabled:!1,onChange:e=>{(e=>{const o=t.getPropertyStore(a().EI.Owner);"personPropertyMenuUpdateAddPerson"===e.type?E().createAndCommit({userAction:"PageVerificationBadge.addVerifier",environment:i,canUndo:!0,perform:t=>{for(const i of e.newValues)E().applyOperation({transaction:t,store:o,operation:{path:o.path,pointer:o.pointer,command:"addPersonAfter",args:{pointer:i}}})}}):"personPropertyMenuUpdateRemovePerson"===e.type?1===d.length?A().oV({label:(0,B.jsx)(s()._H,{id:"pageVerification.removeLastVerifier.error",defaultMessage:"At least one owner is required for verification."})}):E().createAndCommit({userAction:"PageVerificationBadge.removeVerifier",environment:i,canUndo:!0,perform:t=>{E().applyOperation({transaction:t,store:o,operation:{path:o.path,pointer:o.pointer,command:"removePerson",args:{pointer:e.removedValue}}})}}):"personPropertyMenuUpdateReplacePerson"===e.type?E().createAndCommit({userAction:"PageVerificationBadge.replaceVerifier",environment:i,canUndo:!0,perform:t=>{E().applyOperation({transaction:t,store:o,operation:{path:o.path,pointer:o.pointer,command:"addPersonAfter",args:{pointer:e.newValue}}})}}):(0,l().t1)(e)})(e)},onDismiss:o,parentStore:t,isTemplatePage:!1,formQuestionStore:void 0})}var I=()=>o(816563);function K(e){const{onClose:t,blockStore:o}=e,[r,n]=(0,i.useState)("mainVerificationMenu");return"mainVerificationMenu"===r?(0,B.jsx)(j,{onClose:t,blockStore:o,setVerificationMenuDisplay:n}):"owner"===r?(0,B.jsx)(N,{blockStore:o,onClose:t,setVerificationMenuDisplay:n}):"expiration"===r?(0,B.jsx)(Z,{blockStore:o,onClose:t,setVerificationMenuDisplay:n}):void(0,l().t1)(r)}function N(e){const{onClose:t,blockStore:o,setVerificationMenuDisplay:i}=e,n=(0,r().O7)(),a=(0,s().YB)(),l=n.device.isMobile;return(0,B.jsxs)(B.Fragment,{children:[!l&&(0,B.jsx)(I().H,{label:Q(a,"owner"),onClickBackButton:()=>i("mainVerificationMenu"),onClose:t,showBottomBorder:!0,width:350}),(0,B.jsx)(H,{blockStore:o,onClose:t})]})}function Z(e){const{onClose:t,blockStore:o,setVerificationMenuDisplay:i}=e,l=(0,r().O7)(),u=(0,s().YB)(),p=l.device.isMobile,f=(0,n().VK)((()=>o.getPropertyStore(a().EI.Verification).getValue()),[o]);return(0,B.jsx)(c().O,{propertyName:"Verification Status",onChange:e=>{(e=>{d().O({environment:l,blockStore:o,verificationValue:e.value})})(e)},verificationValue:(0,a()._w)(f),getRecordModel:o.getRecordModel,blockId:o.id,onClose:t,showTitle:p,showRemoveVerificationButton:p,showVerificationFooter:p,showCurrentStatusHeader:p,showCustomHeader:!p,customHeader:!p&&(0,B.jsx)(I().H,{label:Q(u,"expiration"),onClickBackButton:()=>i("mainVerificationMenu"),onClose:t,showBottomBorder:!0,width:320})})}function Q(e,t){return"expiration"===t?e.formatMessage(R().b.expirationProperty):"owner"===t?e.formatMessage(R().b.verifierProperty):"mainVerificationMenu"===t?null:void(0,l().t1)(t)}},333068:(e,t,o)=>{o.d(t,{O:()=>c,T:()=>l});var i=()=>o(532850),r=()=>o(989478),n=()=>o(496205),a=()=>o(970105),s=()=>o(269299);function l(e){const{environment:t,blockStore:o,verificationValue:l}=e,c=o.getPropertyStore(n().EI.Verification),d=(0,i().Tp)(l),u=o.getPropertyStore(n().EI.Owner),p=t.currentUser.id,f=p?{table:r().KJ,id:p}:void 0;s().createAndCommit({userAction:"PageAddVerificationButton.verifyPage",environment:t,canUndo:!0,perform:e=>{a().sO({environment:t,store:c,value:d,transaction:e}),f&&s().applyOperation({transaction:e,store:u,operation:{path:u.path,pointer:u.pointer,command:"addPersonAfter",args:{pointer:f}}})}})}function c(e){const{environment:t,blockStore:o,verificationValue:r}=e,l=o.getPropertyStore(n().EI.Verification),c=(0,i().Tp)(r);s().createAndCommit({userAction:"PageVerificationBadge.updatePageVerification",environment:t,canUndo:!0,perform:e=>{a().sO({environment:t,store:l,value:c,transaction:e})}})}},213121:(e,t,o)=>{o.d(t,{b:()=>i});const i=(0,o(788860).vU)({expirationProperty:{defaultMessage:"Expiration",id:"verificationHelpers.menuTitle.Expiration"},noExpiration:{defaultMessage:"None",id:"verificationHelpers.noExpiration"},verifierProperty:{defaultMessage:"Owner",id:"verificationHelpers.menuTitle.Owner"},noOwners:{defaultMessage:"No owners",id:"verificationHelpers.noOwners.placeholder"},removeVerificationProperty:{defaultMessage:"Remove verification",id:"verificationHelpers.removeVerification"},nonOwnerCannotRemoveVerification:{defaultMessage:"Only owners can remove verification",id:"verificationHelpers.nonOwnerCannotRemoveVerification"},nonOwnersCannotEditVerification:{defaultMessage:"Only owners can edit verification",id:"verificationHelpers.nonOwnersCannotEditVerification"},ownersAttribution:{defaultMessage:"{numOtherActors, plural, =0 {{actorName}} one {{actorName} and {numOtherActors} other} other {{actorName} and {numOtherActors} others}}",id:"verificationHelpers.displayPageOwners"},verificationMenuTitle:{defaultMessage:"Configure Verification",id:"verificationHelpers.verificationMenu.menuTitle.configureVerification"},addVerificationMenuTitle:{defaultMessage:"Verification Status",id:"verificationHelpers.verificationMenu.menuTitle.addVerification"}})}}]);