"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[91752],{95352:(e,t,o)=>{o.d(t,{DQ:()=>ee,rw:()=>te,OF:()=>G,L6:()=>J,$1:()=>ne});o(670560),o(267602),o(653476),o(241792);var i=o(667294),n=()=>o(219727),a=()=>o(732811),s=()=>o(142735),r=()=>o(846550),l=()=>o(659278),c=()=>o(801812),d=()=>o(245015),u=()=>o(788860),m=()=>o(568017),p=()=>o(513670),g=()=>o(707513),h=()=>o(571896),f=()=>o(150569),x=()=>o(709344),j=()=>o(527278),v=()=>o(876822),y=()=>o(808985),C=()=>o(692304),b=()=>o(178498),k=()=>o(312578),S=()=>o(255577),M=()=>o(906769),P=()=>o(388284),I=()=>o(890085),Z=()=>o(164079),w=()=>o(529048),T=()=>o(154186),E=()=>o(448419),L=()=>o(206352),B=()=>o(94967),R=()=>o(654133),H=o(785893);function U(e){let{shouldOpenVariations:t,icon:o,focused:i,color:n,onClick:a,onMouseEnter:r,variations:l,hideTooltip:c,insertIcon:d}=e;const u=(0,s().qz)(void 0,w().Z);return t?(0,H.jsx)(V,{icon:o,focused:i,color:n,onClick:a,onMouseEnter:r,variations:l,hideTooltip:c,insertIcon:d,buttonPopupStore:u}):(0,H.jsx)(W,{icon:o,focused:i,color:n,onClick:a,onMouseEnter:r,variations:l,hideTooltip:c})}const _=U;function F(e){const{device:t}=e;return t.isMobile?{width:f().mz,height:f().mz,fontSize:f().jo}:{width:f().T8,height:f().T8,fontSize:f().WB}}function D(e){return{iconButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,...F(e)},variationMenu:{display:"flex",padding:2,gap:1},iconImage:{...e.device.isMobile?{width:f().jo,height:f().jo}:{width:f().WB,height:f().WB}}}}function W(e){let{events:t,icon:o,focused:i,color:a,onClick:s,onMouseEnter:l,variations:c,hideTooltip:d}=e;const u=(0,r().Fg)(),m=(0,n().O7)(),p=c.tooltip?c.tooltip:o,g="dark"===u.mode?c.dark:c.light;return(0,H.jsx)(R().Z,{allowHover:Boolean(o&&!d),disableTooltip:d,renderTooltip:()=>p.replaceAll("-"," ").replaceAll("_"," "),closeDelay:0,render:e=>(0,H.jsx)(T().Z,{focused:i,onClick:s,...(0,Z().Z)(t||{},(0,Z().Z)({onMouseEnter:l},e)),ignoreLocalHoverState:!0,style:D(m).iconButton,children:(0,H.jsx)("img",{src:`data:image/svg+xml;utf8,${encodeURIComponent(g[a])}`,style:D(m).iconImage,onContextMenu:e=>e.preventDefault()})},o)})}function A(e){const{parent:t,icon:o,variations:i,insertIcon:a}=e,s=(0,r().Fg)(),l=(0,n().O7)(),c="dark"===s.mode?i.light:i.dark,d=Object.keys(c).sort(((e,t)=>I().Oe.indexOf(e)-I().Oe.indexOf(t))).map((n=>{const s=`${o}_${n}`;return{key:s,action:e=>{t.close(),a(`/icons/${s}.svg`)},render:t=>(0,H.jsx)(U,{...e,...t,icon:s,color:n,variations:i,shouldOpenVariations:!1,hideTooltip:!0})}}));return(0,H.jsx)(L().Z,{debugName:"IconPickerMenuItem",capture:!0,allowEsc:!0,children:(0,H.jsx)(S().ZP,{type:S().iW.Grid,getItemsPerRowForSection:()=>5,initialFocus:0,sections:[{key:"variations",render:e=>(0,H.jsx)("div",{...e}),items:d}],renderRow:(e,t)=>(0,H.jsx)("div",{style:D(l).variationMenu,children:e},t)})})}function V(e){let{icon:t,focused:o,color:n,onClick:a,onMouseEnter:s,variations:r,hideTooltip:l,insertIcon:c,buttonPopupStore:d}=e;const u=(0,i.useCallback)((()=>function(e){e.setState({...e.state,open:!1})}(d)),[d]),m=(0,i.useCallback)((e=>function(e,t){e.preventDefault(),t.setState({...t.state,open:!0})}(e,d)),[d]);return(0,H.jsx)(B().Z,{debugName:"IconPickerMenuItem",capture:o,onEnter:m,children:(0,H.jsx)(E().ZP,{buttonPopupStore:d,popupType:E().Z4.Popup,renderOrigin:e=>(0,H.jsx)(W,{icon:t,focused:o,color:n,onClick:a,onMouseEnter:s,variations:r,hideTooltip:l,events:e}),render:e=>(0,H.jsx)(B().Z,{debugName:"IconPickerMenuItem.VariationMenuComponent",capture:o,onEsc:u,children:(0,H.jsx)(A,{parent:e,icon:t,variations:r,insertIcon:c})})})},t)}const z={display:"flex",flexDirection:"column"},O="recentIcons",K=100,N=12,q=f().tg,$=f().Nm,G=f().II,J=f().pq,Y=f().$P,Q=f().qJ,X=f().PS,ee=356,te=f().T8*N+2*X,oe=f().vP,ie=(0,u().vU)({noResults:{defaultMessage:"No results",id:"emojiPicker.noResults.message"}});function ne(e){const{filter:t,enforceIconColor:o,onSubmit:m,menuRef:I,iconLoggingData:Z,onNoResults:w}=e,T=(0,n().O7)(),E=(0,r().Fg)(),{isDesktop:L,isMobile:B}=(0,n().Fy)(),[R,U]=(0,i.useState)(!0),[F,D]=(0,i.useState)(void 0),{loadIconCount:W,recentIcons:A}=(0,s().Kw)(y().default),V=(0,s().qz)(void 0,C().Z),ee=(0,s().VK)((()=>{var e;return null===(e=v().default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.icon_picker_color}),[]),te=(0,s().VK)((()=>Math.floor(function(e,t){var o,i;const{device:n,WindowSizeStore:a}=e;if(n.isPhone)return(window.innerWidth-a.getSafePaddingLeftPx(Y)-a.getSafePaddingRightPx(Q))/f().mz;if(n.isTablet)return q;if(null==t||null===(o=t.current)||void 0===o||!o.offsetWidth)return N;return((null==t||null===(i=t.current)||void 0===i?void 0:i.offsetWidth)-2*X)/f().T8}(T,I))),[T,I]),oe=(0,s().VK)((()=>function(e){return e.device.isMobile?J:G}(T)),[T]);(0,a().K)((()=>{const e=d().Z.get(O);y().default.update((t=>({...t,recentIcons:e||[]})))}));const[ne]=(0,c().r5)((async()=>{try{const e=await async function(e,t,o){if(!p().xb(o.allIcons))return o.allIcons;const i=await(0,x().default)({environment:t,url:e,method:"GET",format:"json",mode:"cors"});if("success"===i.type)return y().default.setState({...o,allIcons:i.data}),i.data;throw i.error}("/icons/all",T,y().default.state);D(e),U(!1)}catch(e){throw e}}),[T]),se=(0,i.useMemo)((()=>l().rJ(e.filter)??""),[e.filter]),re=(0,i.useCallback)((e=>{const t=function(e){return e.replace("_dark","")}(e);m(t);const o=t.split(/[/_.]/),i=o[2],n=o[3];!function(e,t){const o=d().Z.get(O),i=p().G0([e],o),n=p().qn(i,t);d().Z.set(O,n),y().default.update((e=>({...e,recentIcons:n})))}(i,te*$),Z&&h().fA(T,"pick_colored_icon",{icon:i,color:n,...Z})}),[T,m,Z,te]),le=(0,i.useCallback)(((e,t)=>{const i=o??ee,n=`/icons/${`${e}${i?`_${i}`:""}`}.svg`;return{key:n,action:()=>re(n),render:o=>(0,H.jsx)(_,{...o,icon:e,color:i??"gray",variations:t,insertIcon:re,shouldOpenVariations:!Boolean(i)})}}),[o,re,ee]),ce=(0,i.useCallback)((e=>{if(!e)return[];const o=function(e,t){const o=p().oA(Object.keys(e).map((o=>{const i=e[o],n=((null==i?void 0:i.tooltip)??o).replace("-"," "),a=[n,...i.tags],s=a.findIndex((e=>e===t));if(-1!==s)return[0===s?100:50,o];const r=a.findIndex((e=>e.startsWith(t))),l=n.includes(t);return 0!==r&&l?[40,o]:-1!==r?[0===r?80:30,o]:void 0})));return p().MR(o,(e=>-e[0])).map((e=>e[1]))}(e,t.toLowerCase());return 0===o.length?[]:[{key:"search-results",items:o.map((t=>le(t,e[t]))),render:e=>(0,H.jsx)(P().Z,{children:(0,H.jsx)("div",{style:ae(T,E),children:e.children})},e.key)}]}),[t,le,T,E]),de=(0,i.useCallback)(((e,t)=>{if(!t)return;let o=[];return o="recent"===e.id?A||[]:Object.keys(t),0!==o.length?{key:e.id,items:o.map((e=>{if(void 0!==t[e])return le(e,t[e])})).filter(Boolean),render:t=>(0,H.jsx)(P().Z,{isTitleUppercase:!0,title:e.title,children:(0,H.jsx)("div",{style:ae(T,E),children:t.children})},t.key)}:void 0}),[A,le,T,E]),ue=(0,i.useCallback)((e=>{const o=p().oA(function(e){return p().oA([!e&&{id:"recent",title:(0,H.jsx)(u()._H,{id:"iconPicker.section.recent",defaultMessage:"Recent"})},!e&&{id:"icons",title:(0,H.jsx)(u()._H,{id:"iconPicker.section.icons",defaultMessage:"Icons"})}])}(t).map((t=>de(t,e))));return t&&se?ce(e):o}),[t,se,de,ce]),me=(0,i.useCallback)((e=>{const t=ue(e);let o=0;for(const i of t)o+=i.items.length;return o}),[ue]),pe=(0,i.useCallback)((e=>{let t=W;0===W&&(t+=te*oe);const o=[],i=ue(e);let n=0;for(const a of i){if(!(n+a.items.length<=t)){o.push({...a,items:a.items.slice(0,t-n)});break}o.push(a),n+=a.items.length}return o}),[ue,W,te,oe]),ge=(0,i.useMemo)((()=>({type:S().iW.Grid,getItemsPerRowForSection:()=>te,renderRow:(e,t)=>(0,H.jsx)("div",{style:{display:"flex"},children:e},t)})),[te]),he=(0,i.useCallback)((e=>{if(Math.abs(e)<K){const{loadIconCount:e,allIcons:t}=y().default.state,o=te*oe,i=Math.max(o,me(t));y().default.setState({...y().default.state,loadIconCount:Math.min(i,e+o)})}}),[oe,te,me]),fe=(0,i.useMemo)((()=>{const e=pe(F),t=L&&e.length>0?0:void 0;return"resolved"===ne.status&&0===e.length&&(w&&w(),e.push({key:"no results",items:[{key:"no results",action:p().ZT,render:e=>(0,H.jsx)(b().Z,{...e,style:{fontWeight:g().Ue.medium,marginBottom:2,marginLeft:2,height:20,boxSizing:"content-box"},caption:j().Z.formatMessage(ie.noResults)})}],render:e=>(0,H.jsx)(P().Z,{...e})})),(0,H.jsxs)("div",{style:z,children:[(0,H.jsx)("div",{style:{flexGrow:1},children:(0,H.jsx)(S().ZP,{...ge,store:V,initialFocus:t,sections:e,disableKeyboardArrowWrap:!0,unfocusOnScroll:B})}),(0,H.jsx)(M().Z,{onChange:he})]})}),[pe,F,L,ge,V,B,he,ne.status,w]);return(0,H.jsxs)("div",{children:[R&&(0,H.jsx)("div",{style:{display:"flex",width:"100%",height:"100%",justifyContent:"center",alignItems:"center",paddingBottom:"10px"},children:(0,H.jsx)(k().Z,{})}),fe]})}function ae(e,t){const{device:o,WindowSizeStore:i}=e;return{display:"flex",flexDirection:"column",flexWrap:"wrap",alignItems:"flex-start",...o.isPhone?{background:t.popoverBackground,paddingTop:10,paddingBottom:10,paddingLeft:i.getSafePaddingLeftCSS(Y),paddingRight:i.getSafePaddingLeftCSS(Q),boxShadow:`0 1px 0 ${t.regularDividerColor}`,marginBottom:1}:{background:m().ZP.transparent,paddingLeft:o.isTablet?oe:X,paddingRight:o.isTablet?oe:X}}}},551693:(e,t,o)=>{o.d(t,{Z:()=>q,z:()=>K});o(122556),o(582845),o(250570),o(533019),o(721473),o(788208),o(22624);var i=o(667294),n=()=>o(219727),a=()=>o(142735),s=()=>o(846550),r=()=>o(659278),l=()=>o(225339),c=()=>o(369180),d=()=>o(76910),u=()=>o(717740),m=()=>o(989478),p=()=>o(788860),g=()=>o(513670),h=()=>o(696459),f=()=>o(707513),x=()=>o(636340),j=()=>o(102182),v=()=>o(269299),y=()=>o(109757),C=()=>o(265640),b=()=>o(715139),k=()=>o(433989),S=()=>o(291198),M=()=>o(94967),P=()=>o(198829),I=()=>o(906651),Z=()=>o(654133),w=()=>o(205228),T=()=>o(594546),E=()=>o(606757),L=()=>o(487270),B=()=>o(733193),R=()=>o(363165),H=()=>o(352230),U=()=>o(998901),_=()=>o(180099),F=()=>o(933539),D=()=>o(749826),W=()=>o(148882),A=()=>o(338530),V=o(785893);const z=(0,p().vU)({nameInputPlaceholder:{defaultMessage:"have-fun-with-it",id:"customEmojiUploadPopup.nameInput.placeholder"},urlPasteInputPlaceholder:{defaultMessage:"Paste a link to an image...",id:"customEmojiUploadPopup.urlPasteInput.placeholder"},nameInputDuplicateError:{defaultMessage:"Name already taken",id:"customEmojiUploadPopup.nameInput.duplicateError"},nameInputCharacterError:{defaultMessage:"Name can only contain lowercase letters, numbers, hyphens, or underscores",id:"customEmojiUploadPopup.nameInput.characterError"},nameInputLengthError:{defaultMessage:"Name must be less than 50 characters",id:"customEmojiUploadPopup.nameInput.lengthError"},fileUploadImageError:{defaultMessage:"Only images are supported",id:"customEmojiUploadPopup.fileUpload.imageError"},urlPasteHintImageError:{defaultMessage:"Pasted link does not contain an image.{br}Use {keyboardShortcut} to paste a different link",id:"customEmojiUploadPopup.urlPasteHint.imageError"},urlPasteInputImageError:{defaultMessage:"Pasted link does not contain an image",id:"customEmojiUploadPopup.urlPasteInput.imageError"},customEmojiLimitError:{defaultMessage:"Your workspace has reached the custom emoji limit of {customEmojiLimit}",id:"customEmojiUploadPopup.customEmojiLimit.error"},uploadReplaceButton:{defaultMessage:"Replace",id:"customEmojiUploadPopup.uploadButton.replace"}}),O="\\p{Ll}\\p{Lo}\\d_-";function K(e){const t=(0,n().O7)(),o=(0,p().YB)(),[c,d]=(0,i.useState)(""),[k,B]=(0,i.useState)(null),[K,q]=(0,i.useState)(null),[J,Y]=(0,i.useState)(null),[Q,X]=(0,i.useState)(!1),[ee,te]=(0,i.useState)(""),oe=e.allowUrlPaste&&t.device.isDesktop,ie=e.allowUrlPaste&&t.device.isMobile,{existingEmojiStore:ne,isEditing:ae}=(0,a().VK)((()=>({existingEmojiStore:F().Z.state.store,isEditing:F().Z.state.isEditing})),[]),se=(0,a().VK)((()=>null==ne?void 0:ne.getName()),[ne]),re=(0,a().VK)((()=>(0,E().Jy)()),[]),le=(0,a().VK)((()=>{var e;return re?(null===(e=_().Z.getData(t,{spaceId:re.id}))||void 0===e?void 0:e.names)??new Set:new Set}),[t,re]),ce=(0,a().VK)((()=>A().Z.state.emojiByName),[]),de=(0,a().VK)((()=>(0,E().Zr)({spaceStore:re})),[re]),ue=(0,a().VK)((()=>D().default.getConfigKey("custom_emojis_config","limit")),[]),me=(0,i.useCallback)((e=>{if(d(e),0===e.length)return void B(null);new RegExp(`^[${O}]*$`,"u").test(e)?e.length>50?B(o.formatMessage(z.nameInputLengthError)):e===se&&ae||!le.has(e)&&!ce.hasOwnProperty(e)?B(null):B(o.formatMessage(z.nameInputDuplicateError)):B(o.formatMessage(z.nameInputCharacterError))}),[se,ae,le,ce,o]);function pe(e){const t=(0,l().Wv)({source:e,secureFileConfigRootpath:w().default.secureFileConfig.rootPath,secureFileConfigHostname:w().default.secureFileConfig.hostname}),o=t?t.link:e,i=new Image;i.src=o,i.onload=()=>{q({type:"url",url:o,isExistingImage:!1}),Y(null)},i.onerror=()=>{Y(oe?z.urlPasteHintImageError:z.urlPasteInputImageError)}}(0,i.useEffect)((()=>{null!=ne&&ne.isDefined()&&(me(ne.getName()),q({type:"url",url:ne.getUrl(),isExistingImage:!0}))}),[ne,ae,me]);const ge=void 0!==re&&(!e.confirmToAdd||Q),he=!ae&&le.size>=ue,fe=ge?Boolean(!c)||Boolean(!K)||Boolean(k)||c===se&&(null==K?void 0:K.isExistingImage)&&ae||he:Boolean(!K);const xe=function(e){const{customEmojiLimitReached:t}=e,o=(0,n().O7)();return(0,s().yK)((e=>({wrapper:{padding:"0 16px",display:"flex",flexDirection:"column",fontSize:f().JB.UIRegular.desktop},title:{marginTop:12,fontSize:f().JB.UIRegular.desktop,color:e.text.primary,fontWeight:f().Ue.semibold},description:{marginTop:2,color:e.text.secondary,fontSize:f().JB.UISmall.desktop},errorDescription:{marginTop:2,color:e.text.uiRedPrimary,fontSize:f().JB.UISmall.desktop},textInputContainer:{marginTop:20},textInputLabel:{marginBottom:6,color:e.text.secondary,fontWeight:f().Ue.medium,fontSize:f().JB.UISmall.desktop},nameErrorText:{marginTop:10,color:e.text.uiRedPrimary,fontSize:f().JB.UISmall.desktop},imageErrorText:{marginTop:10,color:e.text.uiRedPrimary,fontSize:f().JB.UISmall.desktop,textAlign:"center"},checkboxContainer:{marginTop:12,display:"flex",alignItems:"center",gap:8,fontSize:f().JB.UIRegular.desktop,...t&&{color:e.text.quaternary}},buttonFooter:{marginTop:16,marginBottom:12,display:"flex",flexDirection:o.device.isMobile?"column-reverse":"row",gap:8,justifyContent:"space-between",alignItems:"center"},secondaryButton:{color:e.text.secondary},primaryButton:{...o.device.isMobile&&{width:"100%"}},pastePrompt:{marginTop:10,color:e.text.tertiary,textAlign:"center",fontSize:f().JB.UISmall.desktop},disabledCheckbox:{stroke:e.stroke.secondary},tooltip:{maxWidth:240,textWrap:"wrap"},divider:{width:19,height:1,borderBottom:`1px solid ${e.darkDividerColor}`},dividerContainer:{display:"flex",gap:4,alignItems:"center",justifyContent:"center",marginTop:10,marginBottom:10,color:e.text.tertiary,textAlign:"center",fontSize:f().JB.UISmall.desktop}})),[o.device.isMobile,t])}({customEmojiLimitReached:he}),je=e.showTitle?(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)("div",{style:xe.title,children:ae?(0,V.jsx)(p()._H,{id:"customEmojiUploadPopup.title.edit",defaultMessage:"Edit custom emoji"}):(0,V.jsx)(p()._H,{id:"customEmojiUploadPopup.title.add",defaultMessage:"Add custom emoji"})}),he?(0,V.jsx)("div",{style:xe.errorDescription,children:(0,V.jsx)(p()._H,{...z.customEmojiLimitError,values:{customEmojiLimit:ue.toLocaleString()}})}):(0,V.jsx)("div",{style:xe.description,children:(0,V.jsx)(p()._H,{id:"customEmojiUploadPopup.description",defaultMessage:"Custom emoji can be used by anyone in your workspace"})})]}):null,ve=(0,V.jsx)(N,{image:K,onFileChanged:e=>{if(null===e)return void q(null);(null==e?void 0:e.name)&&(""===c||"file"===(null==K?void 0:K.type)&&G(K.file.name)===c)&&me(G(e.name)),q({file:e,type:"file"})},isSavingAsCustomEmoji:ge,largeEmoji:e.largeEmoji,hideReplaceButton:e.allowUrlPaste,setError:Y,disabled:he&&ge}),ye=oe&&null===K&&!Boolean(J)?(0,V.jsx)("div",{style:xe.pastePrompt,children:(0,V.jsx)(p()._H,{id:"customEmojiUploadPopup.pastePrompt.label",defaultMessage:"or {keyboardShortcut} to paste an image link",values:{keyboardShortcut:(0,R().mB)({name:"paste",environment:t})}})}):null,Ce=ie&&null===K?(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)("div",{style:xe.dividerContainer,children:[(0,V.jsx)("div",{style:xe.divider}),(0,V.jsx)(p()._H,{id:"customEmojiUploadPopup.divider.label",defaultMessage:"or"}),(0,V.jsx)("div",{style:xe.divider})]}),(0,V.jsx)(S().Z,{placeholder:o.formatMessage(z.urlPasteInputPlaceholder),value:ee,onChange:e=>te(e.target.value),type:"text",autoComplete:"off"})]}):null,be=Boolean(J)?(0,V.jsx)("div",{style:xe.imageErrorText,children:(0,V.jsx)(p()._H,{...J,values:{br:(0,V.jsx)("br",{}),keyboardShortcut:(0,R().mB)({name:"paste",environment:t})}})}):null,ke=t.device.isDesktop&&de&&e.confirmToAdd&&null!==K?(0,V.jsx)(Z().Z,{style:xe.tooltip,placement:U().Placement.Bottom,alignment:U().Alignment.Start,disableTooltip:!he,renderTooltip:()=>(0,V.jsx)(p()._H,{...z.customEmojiLimitError,values:{customEmojiLimit:ue.toLocaleString()}}),render:e=>(0,V.jsxs)("label",{...e,style:xe.checkboxContainer,htmlFor:"confirmToAddCheckbox",children:[(0,V.jsx)(b().Z,{id:"confirmToAddCheckbox",size:14,checked:Q,onClick:()=>X(!Q),disabled:he,stroke:he?xe.disabledCheckbox.stroke:void 0}),(0,V.jsx)(p()._H,{id:"customEmojiUploadPopup.confirmToAddCheckbox.label",defaultMessage:"Add to workspace emoji library"})]})}):null,Se=ge&&(!e.allowUrlPaste||e.allowUrlPaste&&null!==K)?(0,V.jsxs)("label",{style:xe.textInputContainer,htmlFor:"emojiName",children:[(0,V.jsx)("div",{style:xe.textInputLabel,children:(0,V.jsx)(p()._H,{id:"customEmojiUploadPopup.input.label",defaultMessage:"Emoji name"})}),(0,V.jsx)(S().Z,{id:"emojiName",placeholder:o.formatMessage(z.nameInputPlaceholder),value:c,onChange:e=>me(e.target.value),type:"text",autoFocus:!0,focus:!0,onSubmit:e=>{e.preventDefault()},autoComplete:"off",disabled:he}),Boolean(k)&&(0,V.jsx)("div",{style:xe.nameErrorText,children:k})]}):null,Me=(0,V.jsxs)("div",{style:xe.buttonFooter,children:[e.allowUrlPaste&&null!==K?(0,V.jsx)(C().D,{style:xe.secondaryButton,onClick:()=>{q(null),Y(null),d(""),B(null),X(!1),te("")},children:(0,V.jsx)(p()._H,{id:"customEmojiUploadPopup.backButton.label",defaultMessage:"Back"})}):t.device.isDesktop?(0,V.jsx)(C().D,{style:xe.secondaryButton,onClick:()=>{var t;F().Z.dismiss(),null===(t=e.onCancel)||void 0===t||t.call(e)},children:(0,V.jsx)(p()._H,{id:"customEmojiUploadPopup.cancelButton.label",defaultMessage:"Cancel"})}):null,ie&&null===K?(0,V.jsx)(I().Z,{onClick:()=>pe(ee),disabled:0===ee.length,style:xe.primaryButton,children:(0,V.jsx)(p()._H,{id:"customEmojiUploadPopup.nextButton.label",defaultMessage:"Next"})}):(0,V.jsx)(I().Z,{onClick:function(){var o;fe||(ge?ae&&void 0!==ne?async function(e){const{environment:t,name:o,existingEmojiStore:i,image:n}=e,a=i.getModel();if(!a)return;if(n.isExistingImage)v().createAndCommit({userAction:"customEmojiActions.rename",environment:t,canUndo:!0,perform:e=>{v().applyOperation({store:i,operation:a.ops.rename(o),transaction:e})}}),await W().transactionQueue.awaitRecordTransaction(i.pointer),j().oV({label:(0,V.jsx)($,{name:o})});else{const e=async e=>{v().createAndCommit({userAction:"customEmojiActions.replaceImageAndRename",environment:t,canUndo:!0,perform:t=>{v().applyOperation({store:i,operation:a.ops.setUrl(e),transaction:t}),v().applyOperation({store:i,operation:a.ops.rename(o),transaction:t})}}),await W().transactionQueue.awaitRecordTransaction(i.pointer),j().oV({label:(0,V.jsx)($,{name:o})})};"file"===n.type?y().cT({environment:t,file:n.file,bucket:"public",onComplete:e}):"url"===n.type?e(n.url):(0,h().t1)(n)}F().Z.dismiss()}({environment:t,name:c,existingEmojiStore:ne,image:K}):((0,T().j)({environment:t,event:{eventName:"create_custom_emoji",eventProperties:{entrypoint:e.entrypoint,is_first_emoji:0===le.size}}}),function(e){const{environment:t,name:o,currentSpaceStore:i,uploadFileEventHandlers:n,image:a}=e,s=async e=>{const a=(0,L().$x)({environment:t,table:u().p,spaceId:i.getSpaceId()});if(v().createAndCommit({userAction:"customEmojiActions.createCustomEmoji",environment:t,canUndo:!0,perform:n=>{x().ae({environment:t,table:u().p,inMemoryRecordCache:i.inMemoryRecordCache,transaction:n,value:{id:a.id,url:e,name:o,file_ids:[],space_id:a.spaceId,created_by_id:t.currentUser.id,created_by_table:m().KJ,created_time:Date.now(),alive:!0}})}}),await W().transactionQueue.awaitRecordTransaction(a),j().oV({label:(0,V.jsx)(p()._H,{id:"uploadCustomEmoji.success",defaultMessage:"{name} has been added to your workspace",values:{name:o}})}),null!=n&&n.onComplete){const e=r().xo.toString(r().xo.fromPointer(a));n.onComplete(e)}};"file"===a.type?y().cT({...n,environment:t,file:a.file,bucket:"public",onComplete:s}):"url"===a.type?s(a.url):(0,h().t1)(a);F().Z.dismiss()}({environment:t,name:c,currentSpaceStore:re,uploadFileEventHandlers:e.uploadFileEventHandlers,image:K})):null===(o=e.onUploadWithoutSaving)||void 0===o||o.call(e,K))},disabled:fe,style:xe.primaryButton,children:(0,V.jsx)(p()._H,{id:"customEmojiUploadPopup.saveButton.label",defaultMessage:"Save"})})]});let Pe;return Pe=t.device.isMobile?{menuType:H().o.ActionSheet}:{menuType:H().o.Popup,minWidth:280},(0,V.jsx)(P().Z,{...Pe,children:(0,V.jsx)(M().Z,{debugName:"CustomEmojiUploadPopup",capture:!0,onUp:g().yR,onDown:g().yR,onLeft:g().yR,onRight:g().yR,onBackspace:g().yR,onSelectAll:g().yR,onUndo:g().yR,onRedo:g().yR,onTab:g().yR,onUntab:g().yR,onPaste:oe&&null===K?function(e){e.preventDefault(),pe(e.clipboardData.getData("text/plain"))}:g().yR,children:(0,V.jsxs)("div",{style:xe.wrapper,children:[je,ve,ye,Ce,be,ke,Se,Me]})})})}function N(e){const t=(0,p().YB)(),[o,n]=(0,i.useState)(null),{onFileChanged:a,image:r,isSavingAsCustomEmoji:l,largeEmoji:u,hideReplaceButton:m,setError:g,disabled:x}=e;(0,i.useEffect)((()=>{if(null!==r)if("file"===r.type){const e=new FileReader;e.onload=e=>{e.target&&"string"==typeof e.target.result&&n(e.target.result)},e.readAsDataURL(r.file)}else"url"===r.type?n(r.url):(0,h().t1)(r);else n(null)}),[r]);const j=(0,s().yK)((e=>({uploadIcon:{width:19,height:19,marginRight:8,color:e.icon.secondary},wrapper:{marginTop:20,display:"flex",flexDirection:"column",alignItems:"stretch"},dropZone:{backgroundColor:e.inputBackground,borderRadius:4},dropZoneInnerEmpty:{height:"100%",display:"flex",flexDirection:"row",padding:14,color:e.text.secondary,justifyContent:"center"},dropZoneInnerWithEmoji:{display:"flex",flexDirection:"column",padding:u?16:12,...!m&&{paddingBottom:4},alignItems:"center",gap:4},buttonCaption:{fontSize:f().JB.UISmall.desktop,color:e.text.secondary,fontWeight:f().Ue.medium},buttonIcon:{fill:e.icon.secondary,marginRight:4},previewLabel:{fontSize:f().JB.UISmall.desktop,color:e.text.secondary,marginBottom:4},emojiContainer:{display:"flex",flexDirection:"row",alignItems:"center",gap:6},emojiImage:{width:u?80:48,height:u?80:48,padding:u?6:8,borderRadius:8,borderWidth:1,borderStyle:"solid",borderColor:e.darkDividerColor,objectFit:l?"contain":"cover"},darkBackground:{background:e.primaryBlack},lightBackground:{background:e.white}})),[l,u,m]),v=(0,i.useCallback)((e=>{g(null),a(e??null)}),[a,g]),b=(0,i.useCallback)((async()=>{const e=await y().y({multiple:!1,accept:"image/jpeg, image/png, image/gif, image/webp, image/avif, image/svg+xml"});e.length&&((0,B().Gh)({fileMimeType:e[0].type,allowedType:B().LR})?v(e[0]):g(z.fileUploadImageError))}),[v,g]);return(0,V.jsx)("div",{style:j.wrapper,children:(0,V.jsx)(k().Q,{type:B().LR,style:j.dropZone,dropTargetKey:"customEmoji",onDropFile:e=>{"invalidFileDrop"!==e.type?(g(null),e.file&&v(e.file)):g(z.fileUploadImageError)},disabled:x,children:o?(0,V.jsxs)("div",{style:j.dropZoneInnerWithEmoji,children:[(0,V.jsx)("div",{style:j.previewLabel,children:(0,V.jsx)(p()._H,{id:"customEmojiUploadPopup.preview.label",defaultMessage:"Preview"})}),(0,V.jsxs)("div",{style:j.emojiContainer,children:[(0,V.jsx)("img",{style:{...j.emojiImage,...j.lightBackground},src:o,alt:"Light Mode Image"}),(0,V.jsx)("img",{style:{...j.emojiImage,...j.darkBackground},src:o,alt:"Dark Mode Image"})]}),!m&&(0,V.jsx)(C().D,{icon:e=>(0,d().n)({...e,...j.buttonIcon}),onClick:b,"aria-label":t.formatMessage(z.uploadReplaceButton),disabled:x,disabledFeedback:x,children:(0,V.jsx)("div",{style:j.buttonCaption,children:t.formatMessage(z.uploadReplaceButton)})})]}):(0,V.jsxs)(C().D,{style:j.dropZoneInnerEmpty,onClick:b,disabled:x,disabledFeedback:x,children:[(0,c().A)(j.uploadIcon),(0,V.jsx)(p()._H,{id:"customEmojiUploadPopup.uploadButton.label",defaultMessage:"Upload an image"})]})})})}const q=function(){const{open:e,originRect:t,entrypoint:i}=(0,a().VK)((()=>F().Z.state.open?{open:!0,originRect:F().Z.state.originRect,entrypoint:F().Z.state.entrypoint}:{open:!1,originRect:void 0,entrypoint:void 0}),[]),n=(0,a().VK)((()=>{if(F().Z.state.open)return F().Z.state.uploadFileEventHandlers}),[]);return(0,V.jsx)(o(967092).ZP,{popupType:o(104088).k.Popup,open:e,originRect:t,placementToOrigin:U().Placement.Bottom,alignmentToOrigin:U().Alignment.Start,onDismiss:()=>F().Z.dismiss(),onClosed:()=>F().Z.reset(),render:()=>(0,V.jsx)(K,{allowUrlPaste:!1,largeEmoji:!1,showTitle:!0,confirmToAdd:!1,entrypoint:i,uploadFileEventHandlers:n}),sameWidthAsOrigin:!1})};function $(e){let{name:t}=e;return(0,V.jsx)(p()._H,{id:"editCustomEmoji.success",defaultMessage:"{name} has been edited",values:{name:t}})}function G(e){let t=e;const o=e.lastIndexOf(".");-1!==o&&(t=e.slice(0,o));const i=new RegExp(`[^${O}]`,"gu");return t.toLocaleLowerCase().replace(i,"-")}},531633:(e,t,o)=>{o.d(t,{I:()=>le,h:()=>ue});o(670560),o(725847),o(267602),o(916054),o(653476),o(470928),o(749411),o(30005),o(241792),o(228244);var i=()=>o(790424),n=o(667294),a=()=>o(504008),s=()=>o(219727),r=()=>o(732811),l=()=>o(142735),c=()=>o(846550),d=()=>o(642240),u=()=>o(611382),m=()=>o(659278),p=()=>o(827282),g=o(785893);const h=(0,p().IU)("emojiActivities",{viewBox:"0 0 28 28",svg:(0,g.jsx)("path",{d:"M14.2227 22.3281C9.87109 22.3281 6.25391 18.7109 6.25391 14.3594C6.25391 10 9.86328 6.39062 14.2148 6.39062C18.5742 6.39062 22.1914 10 22.1914 14.3594C22.1914 18.7109 18.582 22.3281 14.2227 22.3281ZM14.6602 11.5547L16.8477 13.25L18.8164 12.4531L19.5586 10.0078C18.7852 9.07031 17.7852 8.33594 16.6367 7.89844L14.6602 9.5V11.5547ZM9.62891 12.4531L11.5977 13.25L13.793 11.5547V9.51562L11.7852 7.89844C10.6523 8.33594 9.65234 9.07031 8.88672 10L9.62891 12.4531ZM7.31641 14.3828C7.32422 15.7344 7.72266 16.9922 8.41797 18.0625L11.0742 18.0234L12.168 16.625L11.3477 14.0859L9.31641 13.2656L7.31641 14.3828ZM17.3633 18.0547L20.0117 18.0938C20.7148 17.0156 21.1289 15.7266 21.1289 14.3828L19.1289 13.2656L17.0977 14.0859L16.2695 16.6484L17.3633 18.0547ZM14.2227 21.2656C14.8867 21.2656 15.5273 21.1719 16.1367 20.9922L16.6914 18.6016L15.6914 17.3203H12.7227L11.7461 18.5703L12.3086 20.9922C12.918 21.1719 13.5586 21.2656 14.2227 21.2656Z"})}),f=(0,p().IU)("emojiCustom",{viewBox:"0 0 28 28",svg:(0,g.jsx)("path",{d:"M8.295 13.355c-.994 0-1.494-.5-1.494-1.533V8.325c0-1.032.5-1.525 1.494-1.525h3.566c.994 0 1.494.493 1.494 1.525v3.497c0 1.032-.5 1.533-1.494 1.533H8.296zm7.853 0c-1.001 0-1.502-.5-1.502-1.533V8.325c0-1.032.5-1.525 1.502-1.525h3.559c.993 0 1.494.493 1.494 1.525v3.497c0 1.032-.5 1.533-1.494 1.533h-3.56zM8.31 12.252h3.528c.274 0 .415-.141.415-.43V8.325c0-.281-.141-.422-.415-.422H8.31c-.273 0-.406.14-.406.422v3.497c0 .289.133.43.406.43zm7.853 0h3.528c.274 0 .407-.141.407-.43V8.325c0-.281-.133-.422-.407-.422h-3.527c-.282 0-.415.14-.415.422v3.497c0 .289.133.43.414.43zM8.295 21.2c-.994 0-1.494-.493-1.494-1.525V16.17c0-1.025.5-1.526 1.494-1.526h3.566c.994 0 1.494.5 1.494 1.526v3.504c0 1.032-.5 1.525-1.494 1.525H8.296zm7.853 0c-1.001 0-1.502-.493-1.502-1.525V16.17c0-1.025.5-1.526 1.502-1.526h3.559c.993 0 1.494.5 1.494 1.526v3.504c0 1.032-.5 1.525-1.494 1.525h-3.56zM8.31 20.097h3.528c.274 0 .415-.14.415-.422v-3.497c0-.289-.141-.43-.415-.43H8.31c-.273 0-.406.141-.406.43v3.497c0 .281.133.422.406.422zm7.853 0h3.528c.274 0 .407-.14.407-.422v-3.497c0-.289-.133-.43-.407-.43h-3.527c-.282 0-.415.141-.415.43v3.497c0 .281.133.422.414.422z"})}),x=(0,p().IU)("emojiFlags",{viewBox:"0 0 28 28",svg:(0,g.jsx)("path",{d:"M8.49902 22.0312C8.17871 22.0312 7.90527 21.7656 7.90527 21.4453V8.46094C7.90527 7.75 8.25684 7.34375 8.7959 7.10156C9.38965 6.83594 9.85059 6.70312 11.0693 6.70312C13.9678 6.70312 15.7725 8.11719 18.5225 8.11719C19.8662 8.11719 20.585 7.78906 20.9678 7.78906C21.4209 7.78906 21.7803 8.03125 21.7803 8.45312V16.3828C21.7803 17.1016 21.4287 17.5078 20.8896 17.75C20.2959 18.0156 19.8428 18.1484 18.624 18.1484C15.874 18.1484 14.0615 16.7344 11.1709 16.7344C10.0225 16.7344 9.28809 17.0156 9.09277 17.1016V21.4453C9.09277 21.7734 8.82715 22.0312 8.49902 22.0312ZM18.624 16.9688C19.8428 16.9688 20.4912 16.6094 20.6006 16.3516V9.04688C20.0771 9.19531 19.374 9.29688 18.5225 9.29688C15.6553 9.29688 13.8193 7.88281 11.0693 7.88281C9.85059 7.88281 9.20215 8.24219 9.09277 8.5V15.8359C9.53027 15.6562 10.3115 15.5547 11.1709 15.5547C14.1787 15.5547 16.0225 16.9688 18.624 16.9688Z"})}),j=(0,p().IU)("emojiFood",{viewBox:"0 0 28 28",svg:(0,g.jsx)("path",{d:"M7.89355 23.2188C7.13574 23.6953 6.52637 23.4375 6.12793 23.0312C5.66699 22.5703 5.4873 21.9453 5.9248 21.2422L12.4482 10.875C13.9639 8.46875 16.2373 7.82031 18.1279 9.17188C17.9248 7.57812 18.4404 5.30469 19.5654 5.5625C20.2139 5.72656 20.2842 6.58594 20.0498 7.53906C20.9873 6.39062 22.1826 5.61719 22.8779 6.3125C23.5732 7.01562 22.7998 8.21094 21.6514 9.14844C22.6123 8.91406 23.4795 8.98438 23.6357 9.64844C23.9014 10.7656 21.5811 11.2812 19.9873 11.0625C21.2998 12.9688 20.6592 15.2031 18.2842 16.6953L7.89355 23.2188ZM10.5732 18.8125C10.7764 18.6094 11.0889 18.6016 11.2998 18.8125L11.8389 19.3438L12.7061 18.7969L11.9717 18.0859C11.7607 17.875 11.7686 17.5625 11.9639 17.3594C12.1748 17.1562 12.4873 17.1484 12.6904 17.3516L13.5967 18.2422L17.6748 15.6797C19.8076 14.3359 20.0732 12.7266 18.5967 11.2266L17.9326 10.5469C16.6279 9.23438 15.2061 9.28906 13.9639 10.7812L15.4717 12.2656C15.6826 12.4766 15.6826 12.7812 15.4873 12.9844C15.2842 13.1953 14.9717 13.2031 14.7607 12.9922L13.3701 11.625L12.8232 12.4922L13.7061 13.3594C13.917 13.5703 13.917 13.8828 13.7139 14.0859C13.5029 14.2891 13.1982 14.2969 12.9873 14.0859L12.2686 13.3828L6.94043 21.8516C6.77637 22.1016 7.04199 22.3594 7.2998 22.1953L10.9482 19.9062L10.5811 19.5391C10.3701 19.3359 10.3701 19.0156 10.5732 18.8125Z"})}),v=(0,p().IU)("emojiNature",{viewBox:"0 0 28 28",svg:(0,g.jsx)("path",{d:"M5.83008 10.4766C5.83008 10.0547 5.87695 8.71875 6.06445 7.96094C6.2832 7.0625 7.18164 7.10938 7.63477 7.64062C8.49414 8.61719 9.5332 8.98438 10.7363 8.98438C12.166 8.98438 13.4551 8.625 14.7285 8.625C18.4238 8.625 21.1035 11 21.1035 14.2891C21.1035 15.2109 20.9082 16.0625 20.5488 16.8125C21.3535 17.9531 22.3848 19.6016 22.3848 20.5859C22.3848 21.2344 21.9238 21.7734 21.3457 21.7734C21.0723 21.7734 20.8145 21.6406 20.6973 21.2656C20.3301 20.0859 20.1191 19.0469 19.6504 18.1484C18.5098 19.3906 16.7676 20.1328 14.6973 20.1328C9.32227 20.1328 5.83008 16.3047 5.83008 10.4766ZM10.4004 12.2969C10.2832 11.9453 10.666 11.7109 10.916 12.0469C11.8145 13.2188 13.127 13.6094 14.6113 13.8594C16.9551 14.2422 18.5879 14.8438 19.6816 15.8125C19.8379 15.3438 19.9238 14.8359 19.9238 14.2891C19.9238 11.6719 17.7754 9.80469 14.7285 9.80469C14.2051 9.80469 13.6582 9.875 13.0332 9.96094C12.3457 10.0547 11.5801 10.1641 10.7363 10.1641C9.47852 10.1641 8.10352 9.71094 7.22852 8.91406C7.1582 8.85156 7.10352 8.85938 7.08789 8.96094C7.01758 9.38281 7.00977 9.96094 7.00977 10.4766C7.00977 15.6562 9.98633 18.9531 14.6973 18.9531C16.541 18.9531 18.041 18.2734 18.9551 17.1484C17.9316 15.9688 16.7129 15.4766 14.2129 14.8828C12.3691 14.4297 10.8926 13.8203 10.4004 12.2969Z"})}),y=(0,p().IU)("emojiObjects",{viewBox:"0 0 29 28",svg:(0,g.jsx)("path",{d:"M13.6611 3.90625V2.40625C13.6611 2.03906 13.9658 1.72656 14.333 1.72656C14.7002 1.72656 15.0127 2.03906 15.0127 2.40625V3.90625C15.0127 4.26562 14.708 4.57812 14.333 4.57812C13.9658 4.57812 13.6611 4.26562 13.6611 3.90625ZM8.85645 6.45312L7.79395 5.38281C7.53613 5.125 7.53613 4.71094 7.79395 4.4375C8.05957 4.17969 8.49707 4.17969 8.74707 4.4375L9.80176 5.50781C10.0596 5.76562 10.0674 6.1875 9.80176 6.45312C9.54395 6.71875 9.11426 6.71094 8.85645 6.45312ZM18.8564 5.50781L19.9268 4.4375C20.1846 4.17969 20.5986 4.17969 20.8721 4.4375C21.1299 4.71094 21.1299 5.125 20.8721 5.38281L19.8018 6.45312C19.5439 6.71094 19.1299 6.71875 18.8564 6.45312C18.5908 6.1875 18.5986 5.76562 18.8564 5.50781ZM14.333 6.03125C17.0908 6.03125 19.2705 8.03906 19.2705 10.5938C19.2705 13.4219 17.5752 14.125 17.0986 19.0078C17.0752 19.2812 16.9268 19.4531 16.6377 19.4531H12.0283C11.7393 19.4531 11.5908 19.2812 11.5596 19.0078C11.0908 14.125 9.40332 13.4219 9.40332 10.5938C9.40332 8.03906 11.5674 6.03125 14.333 6.03125ZM14.333 7.17969C12.2783 7.17969 10.5518 8.60938 10.5518 10.5938C10.5518 12.6875 11.9346 13.1719 12.6064 18.3047H16.0596C16.7314 13.1719 18.1221 12.6875 18.1221 10.5938C18.1221 8.60938 16.3877 7.17969 14.333 7.17969ZM7.25488 11.6484H5.75488C5.39551 11.6484 5.09082 11.3359 5.09082 10.9766C5.09082 10.6094 5.39551 10.2969 5.75488 10.2969H7.25488C7.62207 10.2969 7.94238 10.6016 7.94238 10.9766C7.94238 11.3438 7.62207 11.6484 7.25488 11.6484ZM22.8955 11.6484H21.3955C21.0361 11.6484 20.7236 11.3438 20.7236 10.9766C20.7236 10.6016 21.0361 10.2969 21.3955 10.2969H22.8955C23.2627 10.2969 23.5752 10.6094 23.5752 10.9766C23.5752 11.3359 23.2627 11.6484 22.8955 11.6484ZM12.0049 21.0469C11.7549 21.0469 11.5596 20.8594 11.5596 20.6016C11.5596 20.3438 11.7549 20.1562 12.0049 20.1562H16.6611C16.9189 20.1562 17.1143 20.3438 17.1143 20.6016C17.1143 20.8594 16.9189 21.0469 16.6611 21.0469H12.0049ZM14.333 23.1875C13.1768 23.1875 12.2002 22.6094 12.1533 21.75H16.5127C16.458 22.6094 15.4814 23.1875 14.333 23.1875Z"})}),C=(0,p().IU)("emojiPeople",{viewBox:"0 0 28 28",svg:(0,g.jsx)("path",{d:"M14.5557 22.3281C10.2041 22.3281 6.58691 18.7109 6.58691 14.3594C6.58691 10 10.1963 6.39062 14.5479 6.39062C18.9072 6.39062 22.5244 10 22.5244 14.3594C22.5244 18.7109 18.915 22.3281 14.5557 22.3281ZM14.5557 21C18.2432 21 21.1963 18.0469 21.1963 14.3594C21.1963 10.6719 18.2354 7.71875 14.5479 7.71875C10.8604 7.71875 7.92285 10.6719 7.92285 14.3594C7.92285 18.0469 10.8682 21 14.5557 21ZM12.2354 13.6641C11.7432 13.6641 11.3135 13.2188 11.3135 12.5938C11.3135 11.9609 11.7432 11.5156 12.2354 11.5156C12.7354 11.5156 13.165 11.9609 13.165 12.5938C13.165 13.2188 12.7275 13.6641 12.2354 13.6641ZM16.8682 13.6641C16.376 13.6641 15.9463 13.2188 15.9463 12.5938C15.9463 11.9609 16.376 11.5156 16.8682 11.5156C17.3682 11.5156 17.7979 11.9609 17.7979 12.5938C17.7979 13.2188 17.3604 13.6641 16.8682 13.6641ZM14.5479 18.2734C12.915 18.2734 11.8213 17.1875 11.8213 16.6719C11.8213 16.4844 12.001 16.3984 12.1729 16.4766C12.7354 16.7812 13.415 17.1406 14.5479 17.1406C15.6807 17.1406 16.3604 16.7891 16.9307 16.4766C17.0947 16.3984 17.2744 16.4844 17.2744 16.6719C17.2744 17.1875 16.1807 18.2734 14.5479 18.2734Z"})}),b=(0,p().IU)("emojiPlus",{viewBox:"0 0 28 28",svg:(0,g.jsx)("path",{d:"M14 22c-4.369 0-8-3.631-8-8 0-4.376 3.624-8 7.992-8C18.37 6 22 9.624 22 14c0 4.369-3.623 8-8 8zm-3.828-7.992c0 .4.283.667.69.667h2.456v2.462c0 .4.274.69.674.69.408 0 .69-.282.69-.69v-2.463h2.463c.4 0 .69-.266.69-.666 0-.408-.29-.69-.69-.69h-2.463v-2.455c0-.408-.282-.698-.69-.698-.4 0-.674.29-.674.698v2.455h-2.455c-.408 0-.69.282-.69.69z"})});const k=(0,p().IU)("emojiSymbols",{viewBox:"0 0 28 28",svg:(0,g.jsx)("path",{d:"M14.8887 22.3281C10.5371 22.3281 6.91992 18.7109 6.91992 14.3594C6.91992 10 10.5293 6.39062 14.8809 6.39062C19.2402 6.39062 22.8574 10 22.8574 14.3594C22.8574 18.7109 19.248 22.3281 14.8887 22.3281ZM14.8887 21C18.5762 21 21.5293 18.0469 21.5293 14.3594C21.5293 10.6719 18.5684 7.71875 14.8809 7.71875C11.1934 7.71875 8.25586 10.6719 8.25586 14.3594C8.25586 18.0469 11.2012 21 14.8887 21ZM14.0293 18.0703C13.7715 18.0703 13.5605 17.9609 13.3652 17.7031L11.459 15.3594C11.3496 15.2109 11.2793 15.0469 11.2793 14.875C11.2793 14.5312 11.5449 14.2578 11.8809 14.2578C12.0996 14.2578 12.2715 14.3203 12.459 14.5703L13.998 16.5625L17.2402 11.3594C17.3887 11.1328 17.584 11.0078 17.7793 11.0078C18.1074 11.0078 18.4199 11.2344 18.4199 11.5859C18.4199 11.7578 18.3184 11.9297 18.2324 12.0859L14.6621 17.7031C14.5059 17.9453 14.2871 18.0703 14.0293 18.0703Z"})}),S=(0,p().IU)("emojiTravel",{viewBox:"0 0 28 28",svg:(0,g.jsx)("path",{d:"M10.4102 6.59999L13.2496 12.8777L8.06153 13.4701L6.47152 10.5536C6.46512 10.5533 6.45784 10.5531 6.44961 10.5531H6.37773V17.3453H6.44961C6.45975 17.3453 6.46847 17.345 6.4759 17.3446L8.06153 14.4362L13.2496 15.0285L10.4102 21.3062H10.7855C10.8271 21.3062 10.8762 21.2947 10.944 21.2204L16.192 15.4882C16.343 15.3193 16.5192 15.1534 16.7671 15.0493C17.0082 14.9481 17.2567 14.9312 17.4965 14.9312H20.6449C21.3092 14.9312 21.8867 14.7803 22.2776 14.5596C22.6756 14.3348 22.7834 14.1043 22.787 13.953C22.7834 13.7972 22.6746 13.5671 22.2784 13.3442C21.888 13.1245 21.3105 12.975 20.6449 12.975H17.4965C17.2572 12.975 17.0066 12.9583 16.7636 12.8544C16.5154 12.7483 16.3396 12.5795 16.1896 12.4076L10.9354 6.67645C10.8794 6.6124 10.8381 6.59999 10.7855 6.59999H10.4102ZM9.13689 5.81573C9.30066 5.53389 9.59424 5.39999 9.8793 5.39999H10.7855C11.1991 5.39999 11.562 5.57301 11.8335 5.88032L17.0848 11.6083L17.0901 11.6144C17.1939 11.7339 17.2288 11.7483 17.2348 11.7508C17.2476 11.7563 17.2983 11.775 17.4965 11.775H20.6449C21.4716 11.775 22.2612 11.9576 22.8669 12.2984C23.4624 12.6335 23.9806 13.1898 23.9871 13.948L23.9872 13.9583C23.9807 14.7134 23.4613 15.2693 22.8677 15.6045C22.2625 15.9462 21.4728 16.1312 20.6449 16.1312H17.4965C17.2988 16.1312 17.2464 16.1496 17.2317 16.1558C17.2242 16.1589 17.1888 16.1735 17.0849 16.29L17.0797 16.2958L11.8302 22.0296C11.5699 22.3147 11.2127 22.5062 10.7855 22.5062H9.8793C9.58383 22.5062 9.29417 22.3619 9.13515 22.0846C8.97977 21.8136 8.99861 21.5052 9.11616 21.2555L11.4778 16.034L8.72831 15.7201L7.50843 17.9576C7.50827 17.9579 7.50811 17.9582 7.50795 17.9585C7.40427 18.1496 7.25122 18.3087 7.04689 18.4132C6.85046 18.5136 6.64222 18.5453 6.44961 18.5453H6.11367C5.88888 18.5453 5.64429 18.4742 5.45252 18.2888C5.25823 18.101 5.17773 17.8533 5.17773 17.6172V10.2891C5.17773 10.0541 5.25718 9.80874 5.44527 9.62065C5.63336 9.43256 5.87871 9.35312 6.11367 9.35312H6.44961C6.64191 9.35312 6.85261 9.38475 7.05157 9.48866C7.25706 9.59597 7.40839 9.75869 7.51001 9.95148L8.72831 12.1862L11.4778 11.8722L9.11482 6.64781C9.00203 6.40262 8.97622 6.09223 9.13689 5.81573Z"})});var M=()=>o(490670),P=()=>o(788860),I=()=>o(568017),Z=()=>o(513670),w=()=>o(696459),T=()=>o(707513),E=()=>o(571896),L=()=>o(178498),B=()=>o(745740),R=()=>o(255577),H=()=>o(388284),U=()=>o(654133),_=()=>o(606757),F=()=>o(761936),D=()=>o(466970),W=()=>o(876822),A=()=>o(180099),V=()=>o(933539),z=()=>o(692304),O=()=>o(718611);const K=1,N=6048e5;function q(e,t,o){if(void 0===e||void 0===t)return 0;const i=o-t,n=e*Math.pow(.5,i/N);return Math.round(n)}const $=100;class G extends(()=>o(263184))().default{getInitialState(){return{stores:{}}}getStore(e){if(e)return this.state.stores[e]||(this.state.stores[e]=new(o(41158).D)({key:`emojiFrecency:${e}`,namespace:o(149310).$p,important:!0,trackingType:"necessary"})),this.state.stores[e]}getEmojiFrecencyMap(){var e;const t=this.getStore(null===(e=W().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId());if(!t)return{};return t.state??{}}}const J=new G;var Y=()=>o(150569),Q=()=>o(338530),X=()=>o(384546),ee=()=>o(253339),te=()=>o(1910),oe=()=>o(998901);function ie(e){const t=(0,c().yK)((e=>({wrapper:{borderTop:`solid 1px ${e.stroke.secondary}`,display:"flex",justifyContent:"space-between",paddingTop:8,paddingBottom:10,paddingLeft:12,paddingRight:12},categoryIcon:{width:28,height:28,fill:e.icon.secondary,transform:"scale(1.1)"}})),[]);return(0,g.jsx)("div",{style:t.wrapper,children:le.map(((o,i)=>e.isHidden(o)?null:(0,g.jsx)(U().Z,{alignment:oe().Alignment.Start,placement:oe().Placement.Bottom,render:i=>(0,n.createElement)(te().Z,{focused:e.isFocused(o),disabled:e.isDisabled(o),...i,key:o.id,ariaLabel:o.category??o.id,icon:()=>{var e;return null===(e=o.icon)||void 0===e?void 0:e.call(o,t.categoryIcon)},style:{width:32,height:32},onClick:t=>{e.onCategoryClick(o,t)}}),renderTooltip:e=>(0,g.jsx)("div",{...e,children:o.title})},o.id)))})}var ne=()=>o(369032);const ae=(0,P().vU)({noResults:{defaultMessage:"No results",id:"emojiPicker.noResults.message"}}),se=(0,g.jsx)(P()._H,{id:"emojiPicker.addCustomEmoji",defaultMessage:"Add emoji"}),re="__ADD_CUSTOM_EMOJI__",le=[{id:"recent",title:(0,g.jsx)(P()._H,{id:"emojiPicker.section.recent",defaultMessage:"Recent"}),icon:o(698357).d},{id:"callout",title:(0,g.jsx)(P()._H,{id:"emojiPicker.section.callout",defaultMessage:"Callout"})},{id:"people",category:"People & Body",title:(0,g.jsx)(P()._H,{id:"emojiPicker.section.people",defaultMessage:"People"}),icon:C},{id:"nature",category:"Animals & Nature",title:(0,g.jsx)(P()._H,{id:"emojiPicker.section.animals",defaultMessage:"Animals and nature"}),icon:v},{id:"food",category:"Food & Drink",title:(0,g.jsx)(P()._H,{id:"emojiPicker.section.food",defaultMessage:"Food and drink"}),icon:j},{id:"activities",category:"Activities",title:(0,g.jsx)(P()._H,{id:"emojiPicker.section.activity",defaultMessage:"Activity"}),icon:h},{id:"travel",category:"Travel & Places",title:(0,g.jsx)(P()._H,{id:"emojiPicker.section.travel",defaultMessage:"Travel and places"}),icon:S},{id:"objects",category:"Objects",title:(0,g.jsx)(P()._H,{id:"emojiPicker.section.objects",defaultMessage:"Objects"}),icon:y},{id:"symbols",category:"Symbols",title:(0,g.jsx)(P()._H,{id:"emojiPicker.section.symbols",defaultMessage:"Symbols"}),icon:k},{id:"flags",category:"Flags",title:(0,g.jsx)(P()._H,{id:"emojiPicker.section.flags",defaultMessage:"Flags"}),icon:x},{id:"custom",title:(0,g.jsx)(P()._H,{id:"emojiPicker.section.custom",defaultMessage:"Custom"}),icon:f},{id:"add",title:se,icon:b}],ce=Object.fromEntries(le.map((e=>[e.id,e]))),de=["ðŸ’¡","ðŸ‘‰","â˜","ðŸ‘Œ","ðŸ”‘","ðŸš§","âš ï¸","ðŸ”¥","ðŸ“Œ","âœ‚ï¸","â“","ðŸš«","â›”","â°","â˜Žï¸","ðŸš¨","â™»ï¸","âœ…","ðŸ”’","ðŸ“Ž","ðŸ“–","ðŸ—£","âž¡ï¸","ðŸ“¢","ðŸ› ","âš™"];function ue(e){const{onSubmit:t,isInline:o,onUpload:p,iconLoggingData:h,onNoResults:f}=e,x=(0,s().O7)(),j=(0,c().Fg)(),v=(0,P().YB)(),y=(0,s().Fy)(),C=(0,D().E)("emoji_frecency"),b=(0,l().VK)((()=>Math.floor(function(e,t){var o,i;const{device:n,WindowSizeStore:a}=e;if(n.isPhone)return(window.innerWidth-a.getSafePaddingLeftPx(Y().$P)-a.getSafePaddingRightPx(Y().qJ))/Y().mz;if(n.isTablet)return Y().tg;if(null==t||null===(o=t.current)||void 0===o||!o.offsetWidth)return Y().IQ;return((null==t||null===(i=t.current)||void 0===i?void 0:i.offsetWidth)-2*Y().PS)/Y().T8}(x,e.menuRef))),[x,e.menuRef]),k=(0,l().VK)((()=>x.device.isMobile?Y().pq:Y().II),[x]),S=(0,l().VK)((()=>(0,_().Zr)({spaceStore:(0,_().Jy)()})),[]),I=y.isDesktop&&S,N=a().Z.withListenerIgnored((()=>C?J.getEmojiFrecencyMap():{})),G=(0,n.useMemo)((()=>C?Object.keys(N).sort(((e,t)=>N[t].f!==N[e].f?N[t].f-N[e].f:N[t].u-N[e].u)).slice(0,Y().Nm*b):[]),[N,b,C]),te=(0,l().VK)((()=>{var e;const t=(0,_().Jy)();if(!t)return[];return((null===(e=A().Z.getData(x,{spaceId:t.id}))||void 0===e?void 0:e.pointers)??[]).map((e=>m().xo.toString(m().xo.fromPointer(e))))}),[x]),oe=(0,n.useCallback)((e=>{t(e),C?function(e){var t;const o=J.getStore(null===(t=W().default.state.currentSpaceStore)||void 0===t?void 0:t.getSpaceId());if(!o)return;let i=o.state??{};const n=Date.now();for(const s in i)i[s].f=q(i[s].f,i[s].u,n);const a=(0,O().U6)(e);if(a in i?(i[a].f+=K,i[a].u=n):i[a]={f:K,u:n},Object.keys(i).length>$){const e=Object.entries(i);e.sort(((e,t)=>e[1].f!==t[1].f?t[1].f-e[1].f:t[1].u-e[1].u)),i=Object.fromEntries(e.slice(0,$))}o.setState(i)}(e):function(e,t){var o;const i=ee().Z.getStore((null===(o=W().default.state.currentSpaceStore)||void 0===o?void 0:o.getSpaceId())||""),n=i.state,a=Z().jj(Z().G0([(0,O().U6)(e)],null==n?void 0:n.split(",").filter(Boolean))),s=Z().qn(a,t);i.setState(s.join(",")),X().Z.setState({...X().Z.state,recentEmojis:s})}(e,Y().Nm*b),h&&E().fA(x,"pick_emoji",{icon:e,...h})}),[t,C,h,b,x]),le=(0,Q().C)(),ue=(0,l().VK)(O().sg,[]),xe=(0,n.useCallback)((e=>{const t=void 0===ue?m().yS(e,le):[];return{key:e,action:()=>{0===t.length&&oe(e)},render:o=>(0,g.jsx)(ne().Z,{...o,emoji:e,showTooltip:!0,variations:t,insertEmoji:oe})}}),[oe,le,ue]),je=(0,l().VK)((()=>{const t=function(e){const{environment:t,filter:o,isCallout:i,maxEmojisPerSection:n,showCategoriesThreshold:a,customEmojiStrings:s,shouldShowCustomAddButton:r,isEmojiFrecencyEnabled:l,frequentlyUsedEmojis:c,emojiFrecencyMap:d}=e,p=function(e){return Z().oA([e.filterIsEmpty?ce.recent:void 0,e.isCallout?ce.callout:void 0,ce.people,ce.nature,ce.food,ce.activities,ce.travel,ce.objects,ce.symbols,ce.flags,ce.custom])}({filterIsEmpty:!(null!=o&&o.trim()),isCallout:i}),g=m().rJ(o)??"",h=o.split(" ").filter(Boolean),f=p.map((e=>{const o=function(e,t,o,i){return"recent"===e.id?o?i:X().Z.state.recentEmojis:"callout"===e.id?de:"custom"===e.id?t:Q().Z.state.emojiByCategory[e.category]||[]}(e,s,l,c),i=function(e,t,o,i,n){const a=Z().oA(t.map((t=>{if(""===o)return{rank:100,emoji:t};const a=(0,u().y)(t,Q().Z.state);let s=[];if(a&&a.keywords)s=a.keywords||[];else if(m().xo.isCustomEmojiString(t)){var r;const o=m().xo.fromCustomEmojiString(t).pointer,i=e.currentUser.id;if(!i)return;const n=null===(r=e.defaultRecordCache.inMemoryRecordCache.getRecord({pointer:o,userId:i}))||void 0===r?void 0:r.value;if(!n||!n.alive)return;s=m().xu(n.name)}const l=o.length<3||o.includes(" ")?s:s.map((e=>e.replaceAll(" ",""))),c=o.indexOf(t);if(-1!==c)return{rank:100-c+pe(t,n),emoji:t};const d=":",p=l.findIndex((e=>e===`${d}${o}`));if(-1!==p)return{rank:100-p+pe(t,n),emoji:t};const g=l.findIndex((e=>e===o));if(-1!==g)return{rank:10*(10-g)+pe(t,n),emoji:t};const h=l.findIndex((e=>e.startsWith(o)));if(-1!==h)return{rank:10-h+pe(t,n),emoji:t};if(i.length>1){const e=a&&a.uniqueKeywords||[];if(i.every((t=>e.find((e=>e.startsWith(t))))))return{rank:i.length+pe(t,n),emoji:t}}return l.some((e=>e.includes(o)))?{rank:1+pe(t,n),emoji:t}:void 0})));return a.sort(((e,t)=>t.rank-e.rank))}(t,o,g,h,d);return{category:e,emojis:i.map((e=>({rank:e.rank,emoji:ge(e.emoji)})))}})),x=[];let j=0;for(const{category:u,emojis:m}of f){if(r&&"custom"===u.id){const e={rank:-1/0,emoji:re};m.unshift(e)}let e=0;for(;e<m.length;){const t=m.slice(e,e+n);x.push({id:u.id,title:0===e?u.title:void 0,emojis:t}),e+=t.length}j+=m.length}if(""===o||j>a){return x.map((e=>({...e,emojis:e.emojis.map((e=>{let{emoji:t}=e;return t}))})))}const v=Z().MR(x.flatMap((e=>e.emojis)),(e=>-e.rank)).map((e=>{let{emoji:t}=e;return t}));if(0===v.length)return[];return[{emojis:v}]}({environment:x,filter:e.filter,isCallout:e.isCallout??!1,maxEmojisPerSection:b,showCategoriesThreshold:Math.floor(b*k/2),customEmojiStrings:te,shouldShowCustomAddButton:I,isEmojiFrecencyEnabled:C,frequentlyUsedEmojis:G,emojiFrecencyMap:N});return t}),[x,e.filter,e.isCallout,b,k,I,te,G,C,N]),ve=(0,n.useRef)(null),ye=(0,n.useMemo)((()=>{const e=[];for(const[t,o]of je.entries()){let i;i=y.isPhone||y.isTablet?Y().mz:Y().T8;const n=void 0!==o.title,a=t===je.length-1||void 0!==je[t+1].title;n&&(y.isPhone?i+=58:y.isTablet?i+=42:i+=32),a&&y.isMobile&&(i+=10),e.push(i)}return e}),[je,y]),Ce=(0,i().MG)({count:je.length,getScrollElement:()=>ve.current,estimateSize:e=>ye[e]}),be=(0,n.useCallback)((e=>{const t=je.findIndex((t=>t.id===e));-1!==t&&Ce.scrollToIndex(t,{behavior:"auto",align:"start"})}),[Ce,je]),ke=(0,n.useRef)(null);(0,r().Q)((()=>{C||X().Z.cleanupSkinTonedRecents((0,O().sg)()),async function(){await(0,F().L)(),await async function(){if(!me){await Q().Z.waitUntilLoaded();for(const t in Q().Z.state.positionalEmojiData){var e;const o=null===(e=(0,u().y)(t,Q().Z.state))||void 0===e?void 0:e.keywords;o&&(d().Q4[t]={...d().Q4[t],uniqueKeywords:Z().jj(o.flatMap((e=>e.split(" "))))})}me=!0}}()}()}));const Se=(0,l().qz)(void 0,z().Z);(0,r().K)((()=>{Se.setState({...Se.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}));const Me=I?1===je.length&&je[0].emojis[0]===re:0===je.length;(0,n.useEffect)((()=>{Me?Se.unsetFocus():Se.setState({...Se.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}),[e.filter,Se,Me]),(0,n.useEffect)((()=>{0===je.length&&(null==f||f())}),[je,f]);const Pe=(0,n.useMemo)((()=>I?{key:"custom-emoji-add",action:()=>{ke.current&&V().Z.setState({open:!0,isEditing:!1,entrypoint:"picker",originRect:ke.current.getBoundingClientRect(),uploadFileEventHandlers:p})},render:e=>(0,g.jsx)(U().Z,{renderTooltip:()=>se,render:t=>(0,g.jsx)(B().Z,{...e,...t,ref:ke,ignoreLocalHoverState:!1,style:{width:28,height:28,margin:2,display:"flex",justifyContent:"center",alignItems:"center",border:`1px solid ${j.stroke.primary}`,cursor:"pointer",borderRadius:15},children:(0,M().f)({height:14,width:14,color:j.icon.secondary})})})}:null),[p,I,j]),Ie=[];let Ze,we=!1;if(Me)Ie.push({key:"no results",items:[{key:"no results",action:()=>{ke.current&&I&&V().Z.setState({open:!0,isEditing:!1,entrypoint:"no_results",originRect:ke.current.getBoundingClientRect(),uploadFileEventHandlers:p})},render:(e,t)=>(0,g.jsxs)("div",{style:{...o&&{width:"100%"},display:"flex",flexDirection:o?"row":"column"},children:[(0,g.jsx)(L().Z,{...!I&&e,caption:v.formatMessage(ae.noResults),style:{fontWeight:T().Ue.medium,marginBottom:2,marginLeft:2,height:20,boxSizing:"content-box"}}),I?(0,g.jsxs)(B().Z,{...e,ref:ke,style:{display:"flex",alignItems:"center",gap:6,padding:"4px 8px",margin:o?"2px 8px":"0 12px",height:28,borderRadius:6,border:`1px solid ${j.stroke.primary}`,fontWeight:T().Ue.medium,fontSize:T().JB.UIRegular.desktop,whiteSpace:"nowrap"},children:[(0,M().f)({height:14,width:14,color:j.icon.primary}),se]}):null]})}],render:e=>(0,g.jsx)(H().Z,{...e})});else if(1===je.length&&void 0===je[0].id){const e=Z().jj(je[0].emojis).map((e=>e===re?Pe:xe(e))).filter(w().K0);Ie.push({key:"search-results",items:e,render:e=>(0,g.jsx)(H().Z,{shouldShowBottomDivider:!0,children:(0,g.jsx)("div",{style:he(x,j),children:e.children})},e.key)})}else we=!0,Ce.getVirtualItems().map((e=>{const{key:t,index:o,start:i,end:n,size:a}=e,s=je[o],r=void 0!==s.title,l=o===je.length-1||void 0!==je[o+1].title,[c,d]=[Ce.scrollOffset,Ce.scrollOffset+Ce.scrollRect.height];d<i||c>=n||void 0===Ze&&(Ze=s.id);const u=s.emojis.map((e=>e===re?Pe:xe(e))).filter(w().K0);return{key:t,items:u,render:e=>(0,g.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:a,transform:`translateY(${i}px)`},children:(0,g.jsx)("div",{"data-index":o,children:(0,g.jsx)(H().Z,{title:s.title,isTitleUppercase:!0,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,mobileTitleStyle:{...r?{paddingTop:28}:{}},desktopTitleStyle:{...r?{paddingTop:6,lineHeight:"100%"}:{}},style:{display:"flex",flexDirection:"column",alignItems:"stretch"},children:(0,g.jsx)("div",{style:{...he(x,j),...r&&y.isMobile?{paddingTop:10}:{},...l&&y.isMobile?{paddingBottom:10}:{},...y.isPhone&&{boxShadow:fe({theme:j,isFirstRowInSection:r,isLastRowInSection:l})}},children:e.children})})},t)},o)}})).forEach((e=>e&&Ie.push(e)));const Te=y.isDesktop&&Ie.length>0?0:void 0,Ee=(0,g.jsx)(R().ZP,{style:{alignItems:"stretch",width:"100%",position:"relative",height:"100%"},type:R().iW.Grid,getItemsPerRowForSection:()=>b,renderRow:(e,t)=>(0,g.jsx)("div",{style:{display:"flex"},children:e},t),store:Se,initialFocus:Te,sections:Ie,disableKeyboardArrowWrap:!0,unfocusOnScroll:y.isMobile,performHandleEnterOnTab:!0});if(!we)return(0,g.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:(0,g.jsx)("div",{style:{width:"100%",flexGrow:1},children:Ee})});const Le=(0,g.jsx)(ie,{isHidden:e=>{switch(e.id){case"callout":return!0;case"custom":return!S&&0===te.length;case"add":return!I;default:return!1}},isFocused:e=>Ze===e.id,isDisabled:e=>{if(["custom","add"].includes(e.id))return!1;const t=je.find((t=>t.id===e.id));return void 0===t||0===t.emojis.length},onCategoryClick:(e,t)=>{"add"===e.id?V().Z.setState({open:!0,isEditing:!1,entrypoint:"categories_bar",originRect:t.currentTarget.getBoundingClientRect(),uploadFileEventHandlers:p}):be(e.id)}});return(0,g.jsxs)("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:[(0,g.jsx)("div",{style:{width:"100%",flexGrow:1,maxHeight:y.isDesktop?Y().VJ:void 0,overflowX:"hidden",overflowY:"auto",paddingBottom:6},ref:ve,children:(0,g.jsx)("div",{style:{height:Ce.getTotalSize(),width:"100%",position:"relative"},children:Ee})}),Le]})}let me=!1;function pe(e,t){const o=t[e];return o?100*o.f:0}function ge(e){var t;const o=(0,O().sg)();if(!(void 0!==o&&0!==o))return e;const i=null===(t=(0,u().y)(e,Q().Z.state))||void 0===t?void 0:t.variations;return 5===(null==i?void 0:i.length)||"ðŸ¤"===e?(null==i?void 0:i[o-1])??e:e}function he(e,t){const{device:o,WindowSizeStore:i}=e;return{display:"flex",flexDirection:"column",flexWrap:"wrap",alignItems:"flex-start",...o.isPhone?{background:t.popoverBackground,paddingLeft:i.getSafePaddingLeftCSS(Y().$P),paddingRight:i.getSafePaddingRightCSS(Y().qJ)}:{background:I().ZP.transparent,paddingLeft:o.isTablet?Y().vP:Y().PS,paddingRight:o.isTablet?Y().vP:Y().PS}}}function fe(e){const{theme:t,isFirstRowInSection:o,isLastRowInSection:i}=e;return o&&i?`0 1px 0 ${t.regularDividerColor}, 0 -1px 0 ${t.regularDividerColor}`:o?`0 -1px 0 ${t.regularDividerColor}`:i?`0 1px 0 ${t.regularDividerColor}`:"none"}},369032:(e,t,o)=>{o.d(t,{Z:()=>p});o(241792);var i=o(667294),n=()=>o(219727),a=()=>o(142735),s=()=>o(659278),r=()=>o(448419),l=()=>o(255577),c=()=>o(150569),d=()=>o(164079),u=o(785893);const m=(0,i.forwardRef)((function(e,t){const{variations:i,emoji:n,focused:s,onClick:r,onMouseEnter:l,insertEmoji:c,showTooltip:d}=e,m=(0,a().qz)(void 0,o(529048).Z);return void 0===(0,a().VK)((()=>(0,o(718611).sg)()),[])&&i&&i.length>0?(0,u.jsx)(v,{buttonPopupStore:m,emoji:n,focused:s,insertEmoji:c,onClick:r,onMouseEnter:l,showTooltip:d,variations:i,ref:t}):(0,u.jsx)(f,{emoji:n,focused:s,onClick:r,onMouseEnter:l,ref:t,showTooltip:d})})),p=m;function g(e){const{device:t}=e;return t.isMobile?{width:c().mz,height:c().mz,fontSize:c().jo}:{width:c().T8,height:c().T8,fontSize:c().WB}}function h(e){return{emojiButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,...g(e)},variationMenu:{display:"flex",padding:4}}}const f=(0,i.forwardRef)((function(e,t){let{events:i,emoji:r,focused:l,onClick:c,onMouseEnter:m,showTooltip:p}=e;const f=(0,n().O7)(),{fontSize:x}=g(f),j=s().xo.isCustomEmojiString(r),v=(0,a().VK)((()=>{if(j){const e=s().xo.fromCustomEmojiString(r);return(0,o(606757).KX)({parentStore:void 0,pointer:e.pointer})}}),[r,j]),y=(0,a().VK)((()=>j?null==v?void 0:v.getName():s().Hk(r,o(338530).Z.state)),[v,r,j]);return(0,u.jsx)(o(654133).Z,{allowHover:p,renderTooltip:()=>y,closeDelay:0,disableTooltip:!p,render:e=>(0,u.jsx)(o(154186).Z,{ref:t,focused:l,onClick:c,...(0,d().Z)(i||{},(0,d().Z)({onMouseEnter:m},e)),ignoreLocalHoverState:!0,style:h(f).emojiButton,children:j?v?(0,u.jsx)(o(1898).Z,{size:x,emojiStore:v}):null:(0,u.jsx)(o(754668).Z,{size:x,char:r})},r)})}));function x(e){let{props:t}=e;const o=(0,n().O7)();return(0,u.jsx)("div",{style:h(o).variationMenu,children:t.children})}function j(e){const{parent:t,emoji:i,variations:a,insertEmoji:s}=e,r=(0,n().O7)(),c=(a&&a.length>0?[i,...a]:[i]).map(((i,n)=>({key:i,action:e=>{t.close(),(null==a?void 0:a.length)===o(642240).tN&&(0,o(926534).W)({environment:r,skinTone:n}),s(i,n)},render:t=>(0,u.jsx)(m,{...e,...t,emoji:i,variations:void 0,showTooltip:!1})})));return(0,u.jsx)(o(206352).Z,{debugName:"EmojiPickerMenuItem",capture:!0,allowEsc:!0,children:(0,u.jsx)(l().ZP,{type:l().iW.Horizontal,initialFocus:0,sections:[{key:"variations",render:e=>(0,u.jsx)(x,{props:e}),items:c}]})})}const v=(0,i.forwardRef)((function(e,t){const{emoji:n,focused:a,onClick:s,onMouseEnter:l,showTooltip:c,variations:d,insertEmoji:m,buttonPopupStore:p}=e,g=(0,i.useCallback)((()=>function(e){e.setState({...e.state,open:!1})}(p)),[p]),h=(0,i.useCallback)((e=>function(e,t){var o;null===(o=e.preventDefault)||void 0===o||o.call(e),t.setState({...t.state,open:!0})}(e,p)),[p]);return(0,u.jsx)(o(94967).Z,{debugName:"EmojiPickerMenuItem",capture:a,onEnter:h,onEsc:g,children:(0,u.jsx)(r().ZP,{buttonPopupStore:p,popupType:r().Z4.Popup,renderOrigin:e=>(0,u.jsx)(f,{ref:t,emoji:n,focused:a,onClick:s,onMouseEnter:l,showTooltip:c,events:e}),render:e=>(0,u.jsx)(j,{parent:e,emoji:n,variations:d,insertEmoji:m})})},n)}))},926534:(e,t,o)=>{o.d(t,{W:()=>b,Z:()=>C});o(241792),o(667294);var i=()=>o(219727),n=()=>o(142735),a=()=>o(642240),s=()=>o(788860),r=()=>o(269299),l=()=>o(348141),c=()=>o(448419),d=()=>o(206352),u=()=>o(740046),m=()=>o(255577),p=()=>o(654133),g=()=>o(164079),h=()=>o(998901),f=()=>o(876822),x=()=>o(529048),j=()=>o(384546),v=()=>o(369032),y=o(785893);function C(){const e=(0,n().VK)((()=>{var e;return null===(e=f().default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.emoji_picker_skin_tone}),[]),t=(0,i().O7)(),o=(0,n().qz)(void 0,x().Z);return(0,y.jsx)(p().Z,{renderTooltip:()=>(0,y.jsx)(s()._H,{defaultMessage:"Select skin tone",id:"emojiPickerSkinTonePicker.selectSkinTone"}),placement:h().Placement.Bottom,render:i=>(0,y.jsx)(c().ZP,{buttonPopupStore:o,popupType:c().Z4.Popup,renderOrigin:t=>(0,y.jsx)(u().DO,{icon:()=>(0,y.jsx)("div",{style:{paddingRight:6},children:void 0!==e?a().YN[e]:"âœ‹"}),style:{fontSize:20,border:"none"},...(0,g().Z)(t,i)}),render:o=>function(e){const{parent:t,environment:o,currentSkinTone:i}=e,n=a().YN.map(((e,i)=>({key:e,action:()=>{t.close(),b({environment:o,skinTone:i})},render:t=>(0,y.jsx)(v().Z,{...t,insertEmoji:()=>{},emoji:e,variations:void 0,showTooltip:!1})})));return(0,y.jsx)(d().Z,{debugName:"EmojiPickerSkinTonePicker",capture:!0,allowEsc:!0,children:(0,y.jsx)(m().ZP,{type:m().iW.Horizontal,initialFocus:i,sections:[{key:"variations",render:e=>(0,y.jsx)("div",{style:{display:"flex",padding:4},...e}),items:n}]})})}({parent:o,environment:t,currentSkinTone:e}),...i})})}function b(e){const{environment:t,skinTone:o}=e,{currentUserSettingsStore:i}=f().default.state;i&&(void 0!==o&&j().Z.cleanupSkinTonedRecents(o),r().createAndCommit({userAction:"mediaPicker.setEmojiSkinTone",environment:t,canUndo:!0,perform:e=>{l().d2({userSettingsStore:i,transaction:e,data:{emoji_picker_skin_tone:o}})}}))}},384546:(e,t,o)=>{o.d(t,{Z:()=>n});o(267602),o(653476),o(241792);class i extends(()=>o(263184))().default{getInitialState(){return{recentEmojis:[]}}cleanupSkinTonedRecents(e){var t,i;const n=o(253339).Z.getStore((null===(t=o(876822).default.state.currentSpaceStore)||void 0===t?void 0:t.getSpaceId())||""),a=o(513670).jj(null===(i=n.state)||void 0===i?void 0:i.split(",").filter(Boolean).map((t=>void 0===e?t:o(659278).Gb(t))));return n.setState(a.join(",")),this.setState({...this.state,recentEmojis:a}),a}}const n=new i},253339:(e,t,o)=>{o.d(t,{Z:()=>n});class i extends(()=>o(263184))().default{getInitialState(){return{stores:{}}}getStore(e){return this.state.stores[e]||(this.state.stores[e]=new(o(41158).D)({key:`recentEmojis:${e}`,namespace:o(149310).$p,important:!0,trackingType:"necessary"})),this.state.stores[e]}}const n=new i},691752:(e,t,o)=>{o.d(t,{v3:()=>at,s5:()=>Ye,ZP:()=>Oe});o(267602),o(470928),o(241792);var i=o(667294),n=()=>o(219727),a=()=>o(142735),s=()=>o(846550),r=()=>o(225339),l=()=>o(890085),c=()=>o(827282),d=o(785893);const u=(0,c().IU)("giphyLogo",{viewBox:"0 0 12 12",svg:(0,d.jsx)("path",{d:"M 1.332031 0 L 1.332031 12 L 10.667969 12 L 10.667969 4.332031 L 9.332031 5.667969 L 9.332031 10.667969 L 2.667969 10.667969 L 2.667969 1.335938 L 5 1.335938 L 6.332031 0 Z M 6.667969 0 L 6.667969 4 L 10.667969 4 L 10.667969 2.667969 L 9.332031 2.667969 L 9.332031 1.335938 L 8 1.335938 L 8 0 "})});var m=()=>o(899548);const p=(0,c().IU)("shuffle",{viewBox:"0 0 16 16",svg:(0,d.jsx)("path",{d:"M0.162354 11.7542C0.162354 12.1365 0.458984 12.4067 0.867676 12.4067H2.41675C3.55054 12.4067 4.21631 12.0771 4.99414 11.1609L6.58936 9.26245L8.16479 11.1279C8.9624 12.0771 9.71387 12.4067 10.8477 12.4067H12.166V13.9954C12.166 14.3118 12.3572 14.4963 12.6736 14.4963C12.8186 14.4963 12.9504 14.4436 13.0625 14.3579L15.6465 12.2024C15.897 11.998 15.897 11.6816 15.6465 11.4641L13.0625 9.30859C12.9504 9.21631 12.8186 9.17017 12.6736 9.17017C12.3572 9.17017 12.166 9.34814 12.166 9.67114V11.095H10.8872C10.1094 11.095 9.60181 10.8379 9.0415 10.1655L7.43311 8.2605L9.0481 6.34888C9.62158 5.66992 10.083 5.42603 10.8477 5.42603H12.166V6.87622C12.166 7.19263 12.3572 7.3772 12.6736 7.3772C12.8186 7.3772 12.9504 7.32446 13.0625 7.23877L15.6465 5.08325C15.897 4.87891 15.897 4.5625 15.6465 4.34497L13.0625 2.18945C12.9504 2.09717 12.8186 2.05103 12.6736 2.05103C12.3572 2.05103 12.166 2.229 12.166 2.552V4.10767H10.8542C9.68091 4.10767 8.9624 4.43066 8.12524 5.43262L6.58936 7.25854L4.99414 5.36011C4.21631 4.44385 3.50439 4.11426 2.3772 4.11426H0.867676C0.458984 4.11426 0.162354 4.38452 0.162354 4.76685C0.162354 5.14917 0.458984 5.42603 0.867676 5.42603H2.32446C3.06274 5.42603 3.5769 5.68311 4.1438 6.35547L5.74561 8.2605L4.1438 10.1655C3.5769 10.8379 3.10229 11.095 2.37061 11.095H0.867676C0.458984 11.095 0.162354 11.3718 0.162354 11.7542Z"})});var g=()=>o(828042);const h=(0,c().IU)("unsplashLogo",{viewBox:"0 0 12 12",svg:(0,d.jsx)("path",{d:"M3.75 3.375V0H8.25V3.375H3.75ZM8.25 5.25H12V12H0V5.25H3.75V8.625H8.25V5.25Z"})});var f=()=>o(788860),x=()=>o(661727),j=()=>o(568017),v=()=>o(513670),y=()=>o(571896),C=()=>o(286310),b=()=>o(819026),k=()=>o(421654),S=()=>o(102182),M=()=>o(109757),P=(o(670560),()=>o(989478)),I=()=>o(57687),Z=()=>o(876822),w=()=>o(826955),T=()=>o(247724),E=()=>o(12512),L=()=>o(127519),B=()=>o(623498);function R(e){const{placeholder:t,onSubmit:o}=e,n=(0,s().yK)((e=>({wrap:{flexGrow:1,flexShrink:1,boxShadow:e.inputBoxShadow,borderRadius:6,padding:"6px 10px",marginLeft:8,marginRight:8,overflow:"hidden",fontSize:14,..."dark"===e.mode?{backgroundColor:e.inputBackground}:{}},text:{minHeight:60},placeholder:{minHeight:60}})),[]),a=(0,i.useCallback)((e=>{if(o&&!e.shiftKey)o();else{if("editing"!==L().default.state.mode)return}}),[o]);return(0,d.jsx)("div",{style:n.wrap,className:T().Wh_,children:(0,d.jsx)(B().Z,{placeholder:t,disabled:!1,store:e.store,style:n.text,placeholderStyle:n.placeholder,pasteBehavior:"inline",disableSlashCommands:!0,disableEmbedMenu:!0,disableEmojiCommands:!0,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onEnter:a,disableMobileActionBar:!1,disabledMentionTypes:{reminder:!0},disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,inPageFind:E().B3.none})})}var H=()=>o(178498),U=()=>o(388284),_=()=>o(29090);function F(e){const{tab:t}=e,o=(0,n().O7)(),{store:a}=(0,I().Cl)({initialValue:void 0,onChange:v().yR}),r=(0,s().yK)((e=>({desktopStyle:{marginTop:8,marginBottom:6},sparkleStyle:{width:16,height:16,marginRight:4},captionStyle:{textAlign:o.device.isMobile?"left":"center"}})),[o.device.isMobile]),l=(0,i.useCallback)((async()=>{const o=a.getValue();if(!o)return;const i=[];for(const e of o){var n;if("â€£"===e[0]&&null!==(n=e[1])&&void 0!==n&&n.length){if("d"===e[1][0][0]){const t=e[1][0][1].start_date;i.push(t)}else if("u"===e[1][0][0]){const t=e[1][0][1],{currentSpaceStore:o}=Z().default.state;if(!o)return{users:[],bots:[]};const n=w().U6.createChildStore(o,{table:P().KJ,id:t});await n.load();const a=n.getEmail();i.push(a||"")}}else i.push(e[0])}const s=i.join(""),r=t.integration;if(s){e.store.setState({...e.store.state,loading:!0});const o=await t.getResults(s,r);e.store.setState({...e.store.state,loading:!1,result:o.results})}}),[a,e.store,t]);return(0,d.jsxs)("div",{children:[(0,d.jsx)(U().Z,{desktopStyle:r.desktopStyle,children:(0,d.jsx)(R,{placeholder:e.placeholder,onSubmit:l,store:a})}),(0,d.jsx)(U().Z,{children:(0,d.jsx)(_().Z,{onClick:l,title:t.buttonText||(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(f()._H,{defaultMessage:"Ask",id:"mediaPicker.aiSourcePickerTab.askButtonText"}),(0,d.jsx)("div",{children:(0,g().t)(r.sparkleStyle)})]}),fullWidth:e.isSmallWidth})}),t.caption&&(0,d.jsx)(H().Z,{shouldWrapCaption:!0,caption:t.caption,style:r.captionStyle})]})}var D=()=>o(154439),W=()=>o(265640),A=()=>o(827973),V=()=>o(433989),z=()=>o(643051),O=()=>o(740046),K=()=>o(292518),N=()=>o(661297),q=()=>o(906651),$=()=>o(654133),G=()=>o(95352),J=()=>o(50366),Y=()=>o(269299),Q=()=>o(348141),X=()=>o(164079),ee=()=>o(998901),te=()=>o(529048),oe=()=>o(448419),ie=()=>o(242958),ne=()=>o(667637);const ae=(0,f().vU)({selectSpecificIconColor:{defaultMessage:"Select icon color {iconColor}",id:"iconPickerColorPicker.selectSpecificColor"},selectIconColor:{defaultMessage:"Select icon color",id:"iconPickerColorPicker.selectColor"},selectIconColorWithCurrentColor:{defaultMessage:"Select icon color, {iconColor} selected",id:"iconPickerColorPicker.selectColorWithCurrentColor"},noIconColor:{defaultMessage:"no color",id:"iconPickerColorPicker.noColor"}});function se(){const e=(0,a().VK)((()=>{var e;return null===(e=Z().default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.icon_picker_color}),[]),t=(0,f().YB)(),o=(0,n().O7)(),i=(0,s().Fg)(),r=(0,n().Fy)(),c=(0,a().qz)(void 0,te().Z);return(0,d.jsx)($().Z,{renderTooltip:()=>t.formatMessage(ae.selectIconColor),placement:ee().Placement.Bottom,render:n=>(0,d.jsx)(oe().ZP,{preventBlockRenderQueueOnEnter:!0,buttonPopupStore:c,popupType:oe().Z4.Popup,renderOrigin:o=>(0,d.jsx)(O().DO,{ariaLabel:t.formatMessage(ae.selectIconColorWithCurrentColor,{iconColor:t.formatMessage(e?l().RR[e]:ae.noIconColor)}),icon:t=>(0,J().U)({...t,stroke:e?l().Lr[i.mode][e]:l().Lr[i.mode].lightgray,fill:e?l().Lr[i.mode][e]:i.lightIconColor}),...(0,X().Z)(o,n)}),render:n=>function(e){const{parent:t,environment:o,currentIconPickerColor:i,theme:n,device:a}=e,s=[];return s.push({key:"askEveryTime",action:()=>{t.close(),re({environment:o,color:void 0})},render:e=>(0,d.jsx)(ne().Z,{...e,title:(0,d.jsx)(f()._H,{id:"iconPickerColorPicker.askEveryTime",defaultMessage:"Ask every time"}),onClick:()=>{re(void 0!==i?{environment:o,color:void 0}:{environment:o,color:"gray"})},on:void 0===i,style:{boxShadow:void 0},textWrapperStyle:{marginLeft:a.isMobile?10:6},rightStyle:{marginRight:4}})}),(0,d.jsx)(ie().Z,{parent:t,currentColor:i,onColorSelected:re,additionalItems:s,rowStyle:e=>({...e<2&&{opacity:void 0===i?.5:1},...2===e&&{flexDirection:"row-reverse",padding:"4px 0 0",margin:"4px 0 0",borderTop:`1px solid ${n.regularDividerColor}`}}),menuStyle:{padding:"4px 0"}})}({parent:n,environment:o,currentIconPickerColor:e,theme:i,device:r,intl:t})})})}function re(e){const{environment:t,color:o}=e,{currentUserSettingsStore:i}=Z().default.state;i&&Y().createAndCommit({userAction:"mediaPicker.setIconPickerColor",environment:t,canUndo:!0,perform:e=>{const t=void 0!==o?o:null;Q().d2({userSettingsStore:i,transaction:e,data:{icon_picker_color:t}})}})}var le=()=>o(497459),ce=()=>o(539245),de=()=>o(205228),ue=()=>o(926534);var me=()=>o(733193),pe=()=>o(352230),ge=()=>o(707138);class he extends(()=>o(263184))().default{getInitialState(){return{inputValue:"",focus:!1,result:void 0,loading:!1,hover:""}}}const fe=he;var xe=()=>o(808985),je=()=>o(145702),ve=()=>o(188296),ye=()=>o(18281),Ce=()=>o(897257),be=()=>o(154186),ke=()=>o(518242),Se=()=>o(135499),Me=()=>o(527278);function Pe(){const{device:e,WindowSizeStore:t}=(0,n().O7)(),o=(0,a().VK)((()=>e.isPhone),[e]),{phonePaddingLeft:i,phonePaddingRight:r}=(0,a().VK)((()=>({phonePaddingLeft:t.getSafePaddingLeftCSS(14),phonePaddingRight:t.getSafePaddingRightCSS(14)})),[t]);return(0,s().yK)((e=>({galleryWrap:{display:"flex",flexWrap:"wrap",alignContent:"flex-start",background:e.popoverBackground,paddingTop:o?12:0,paddingBottom:o?12:0,paddingLeft:o?i:12,paddingRight:o?r:12,boxShadow:o?`0 1px 0 ${e.regularDividerColor}`:""}})),[o,i,r])}function Ie(e){let{pageCover:t,tab:o}=e;const{coverUrl:n,title:a,subtitle:r,position:l}=t,c=(0,s().yK)((e=>({container:{width:"25%",padding:3},tooltip:{maxWidth:180,whiteSpace:"normal"},title:{color:e.regularInvertedTextColor},subtitle:{color:e.mediumInvertedTextColor},buttonHover:{opacity:.85},imageBox:{width:"100%",height:64,objectFit:"cover",objectPosition:`center ${100*(l||0)}%`,borderRadius:4}})),[l]),u=(0,i.useCallback)((()=>{o.onChange({url:n,position:l})}),[o,n,l]);return(0,d.jsx)("div",{style:c.container,children:(0,d.jsx)($().Z,{originGap:0,placement:ee().Placement.Bottom,delayThreshold:600,renderTooltip:()=>(0,d.jsxs)("div",{style:c.tooltip,children:[(0,d.jsx)("span",{style:c.title,children:Me().Z.formatMessage(a)})," ",(0,d.jsx)("span",{style:c.subtitle,children:r&&Me().Z.formatMessage(r)})]}),render:e=>(0,d.jsx)(be().Z,{hoveredStyle:c.buttonHover,...e,onClick:u,children:(0,d.jsx)(Se().Z,{url:n,width:200,isAuthenticated:!1,render:(e,t)=>t&&(0,d.jsx)(ke().ZP,{src:t,style:c.imageBox})})})})})}const Ze=function(e){let{tab:t}=e;const[n,a]=(0,i.useState)({}),[r,l]=(0,i.useState)(!1);(0,i.useEffect)((()=>{(async()=>{l(!0),await o(521412).X.load().then((e=>{a(e.default),l(!1)}))})()}),[]);const c=Pe(),u=(0,s().yK)((e=>({container:{paddingBottom:8},groupTitle:{marginLeft:-5},loader:{height:300}})),[]);return r?(0,d.jsx)("div",{style:u.loader,children:(0,d.jsx)(o(632599).Z,{})}):(0,d.jsx)("div",{style:u.container,children:Object.keys(n).map((e=>{const i=n[e];return(0,d.jsx)(U().Z,{title:(0,d.jsx)(o(108714).Z,{style:u.groupTitle,href:i.url,external:!0,children:(0,d.jsx)(o(777346).Z,{children:Me().Z.formatMessage(i.title)})}),isTitleUppercase:!0,noTextOverflow:!0,children:(0,d.jsx)("div",{style:c.galleryWrap,children:i.items.map(((e,o)=>(0,d.jsx)(Ie,{pageCover:e,tab:t},o)))})},e)}))})};var we=()=>o(824462),Te=()=>o(312578),Ee=()=>o(67961),Le=()=>o(765513),Be=()=>o(98228);const Re=(0,f().vU)({giphyPlaceholder:{id:"mediaPicker.giphyPlaceholder.text",defaultMessage:"Search GIPHY"}});function He(e){const{tab:t,results:o,ready:n,isSmallWidth:a,giphyRandomId:r}=e,l=(0,s().yK)((e=>({loading:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:320,flex:1},captionMenuItem:{textAlign:a?"left":"center",color:e.mediumTextColor}})),[a]);return n?!o||o&&!o.length?(0,d.jsx)(H().Z,{shouldWrapCaption:!0,caption:(0,d.jsx)(f()._H,{defaultMessage:"No results found.",id:"mediaPicker.giphy.noResultsText"}),style:l.captionMenuItem}):(0,d.jsxs)(i.Fragment,{children:[o.map(((e,o)=>(0,d.jsx)(Ue,{tab:t,image:e,giphyRandomId:r},o))),(0,d.jsx)(H().Z,{shouldWrapCaption:!0,caption:(0,d.jsx)(f()._H,{defaultMessage:"Search to find more results.",id:"mediaPicker.giphy.searchText"}),style:l.captionMenuItem})]}):(0,d.jsx)("div",{style:l.loading,children:(0,d.jsx)(Te().Z,{})})}function Ue(e){var t;let{tab:o,image:a,giphyRandomId:r}=e;const l=(0,n().O7)(),{device:c}=l,u=(0,s().yK)((e=>({container:{width:c.isMobile?"33%":"25%",padding:3},hoveredButton:{opacity:.85},imageBox:{width:"100%",height:64,objectFit:"cover",objectPosition:"center 0%",borderRadius:4},label:{marginTop:2,marginBottom:4}})),[c.isMobile]),m=(0,i.useCallback)((async()=>{var e;if(o.onChange({url:a.imageUrl}),null!==(e=a.analytics)&&void 0!==e&&e.onclick)try{var t;await we().callApi({eventName:"postGiphyAnalytics",environment:l,data:{url:null===(t=a.analytics)||void 0===t?void 0:t.onclick.url,timestamp:Date.now(),random_id:r}})}catch(i){}}),[l,r,a.imageUrl,o,null===(t=a.analytics)||void 0===t?void 0:t.onclick]);return(0,d.jsxs)("div",{style:u.container,children:[(0,d.jsx)(be().Z,{hoveredStyle:u.hoveredButton,onClick:m,children:(0,d.jsx)(ke().ZP,{src:a.thumbUrl,style:u.imageBox})}),(0,d.jsx)(Ee().Z,{isSmall:!0,isSecondaryColor:!0,style:u.label,children:(0,d.jsx)(f()._H,{defaultMessage:"by <inlinetextlink>{authorName}</inlinetextlink>",id:"mediaPicker.giphy.byAuthor",values:{authorName:a.authorName||"GIPHY",inlinetextlink:e=>(0,d.jsx)(Le().Z,{external:!0,href:a.imageUrl,children:e})}})})]},a.id)}const _e=function(e){let{tab:t,isSmallWidth:o}=e;const[a,s]=(0,i.useState)(""),[r,l]=(0,i.useState)(""),c=(0,n().O7)(),{device:u}=c,m=Pe(),p=(0,i.useCallback)((async()=>{if(!v().xb(a))return a;const e=await we().callApi({eventName:"getGiphyRandomId",environment:c,data:{}});return"success"===e.type?(s(e.data.random_id),e.data.random_id):void 0}),[c,a]);return(0,d.jsxs)("div",{style:{paddingBottom:8},children:[(0,d.jsx)(U().Z,{desktopStyle:{marginTop:8,marginBottom:6},children:(0,d.jsx)(O().ZP,{value:r,placeholder:Me().Z.formatMessage(Re.giphyPlaceholder),showClearButton:!0,focus:!u.isMobile||void 0,onChange:e=>l(e.target.value)})}),(0,d.jsx)("div",{style:m.galleryWrap,children:(0,d.jsx)(D().Z,{request:r,debounce:Be().vp,performRequest:async e=>{await p();const t=await we().callApi({eventName:"searchGiphyImages",environment:c,data:{query:e,page:0}});if("success"===t.type)return t.data.results;throw t.error},render:(e,i,n)=>(0,d.jsx)(He,{tab:t,results:i,ready:n,isSmallWidth:o,giphyRandomId:a})})})]})};var Fe=()=>o(709344);const De=(0,f().vU)({unsplashPlaceholder:{id:"mediaPicker.unsplashPlaceholder.text",defaultMessage:"Search for an imageâ€¦"}});function We(e){const{tab:t,results:o,ready:n,isSmallWidth:a}=e,r=(0,s().yK)((e=>({loading:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:320,flex:1},captionMenuItem:{textAlign:a?"left":"center",color:e.mediumTextColor}})),[a]);return n?!o||o&&!o.length?(0,d.jsx)(H().Z,{shouldWrapCaption:!0,caption:(0,d.jsx)(f()._H,{defaultMessage:"No results found.",id:"mediaPicker.unsplash.noResultsText"}),style:r.captionMenuItem}):(0,d.jsxs)(i.Fragment,{children:[o.map(((e,o)=>(0,d.jsx)(Ae,{tab:t,image:e},o))),(0,d.jsx)(H().Z,{shouldWrapCaption:!0,caption:(0,d.jsx)(f()._H,{defaultMessage:"Search to find more results.",id:"mediaPicker.unsplash.searchText"}),style:r.captionMenuItem})]}):(0,d.jsx)("div",{style:r.loading,children:(0,d.jsx)(Te().Z,{})})}function Ae(e){let{tab:t,image:o}=e;const a=(0,n().O7)(),{device:s}=a,r=(0,i.useCallback)((async()=>{const e=await(0,Fe().default)({environment:a,url:o.downloadUrl,method:"GET",format:"json"});"success"===e.type&&t.onChange({url:e.data.url})}),[a,o.downloadUrl,t]);return(0,d.jsxs)("div",{style:{width:s.isMobile?"33%":"25%",padding:3},children:[(0,d.jsx)(be().Z,{hoveredStyle:{opacity:.85},onClick:r,children:(0,d.jsx)(ke().ZP,{src:o.thumbUrl,style:{width:"100%",height:64,objectFit:"cover",objectPosition:"center 0%",borderRadius:4}})}),(0,d.jsx)(Ee().Z,{isSmall:!0,isSecondaryColor:!0,style:{marginTop:2,marginBottom:4},children:(0,d.jsx)(f()._H,{defaultMessage:"by <inlinetextlink>{authorName}</inlinetextlink>",id:"mediaPicker.unsplash.byAuthor",values:{authorName:o.authorName,inlinetextlink:e=>(0,d.jsx)(Le().Z,{external:!0,href:o.unsplashUrl,children:e})}})})]},o.id)}const Ve=function(e){let{tab:t,isSmallWidth:o}=e;const[a,s]=(0,i.useState)(""),r=(0,n().O7)(),{device:l}=r,c=Pe();return(0,d.jsxs)("div",{style:{paddingBottom:8},children:[(0,d.jsx)(U().Z,{desktopStyle:{marginTop:8,marginBottom:6},children:(0,d.jsx)(O().ZP,{value:a,placeholder:Me().Z.formatMessage(De.unsplashPlaceholder),showClearButton:!0,focus:!l.isMobile||void 0,onChange:e=>s(e.target.value)})}),(0,d.jsx)("div",{style:c.galleryWrap,children:(0,d.jsx)(D().Z,{request:a,debounce:Be().vp,performRequest:async e=>{const t=await we().callApi({eventName:"searchUnsplashImages",environment:r,data:{query:e,page:0}});if("success"===t.type)return t.data.results;throw t.error},render:(e,i,n)=>(0,d.jsx)(We,{tab:t,results:i,ready:n,isSmallWidth:o})})})]})},ze=(0,f().vU)({embedPlaceholder:{id:"mediaPicker.embedPlaceholder.text",defaultMessage:"Paste in https://â€¦"},filterPlaceholder:{id:"mediaPicker.emojiFilter.text",defaultMessage:"Filterâ€¦"},aiSourcePickerPlaceholder:{id:"mediaPicker.githubPlaceholder.text",defaultMessage:"Ask query here"},aiIsFetchingLoader:{id:"mediaPicker.aiIsFetchingLoader.text",defaultMessage:"Ai is fetching"}});const Oe=function(e){var t,s;const r=(0,n().O7)(),c=(0,i.useRef)(null),[u,m]=(0,i.useState)(""),[p,g]=(0,i.useState)({inputValue:"",focus:!1}),[h,x]=(0,i.useState)({inputValue:"",focus:!1}),j=(0,a().qz)(void 0,fe);function y(){const t=e.tabs.find((t=>t.type===e.currentTab));if(!t)return(0,d.jsx)(f()._H,{defaultMessage:"Uh oh! Something went wrong.",id:"mediaPicker.errorMessage"});switch(t.type){case"embed":return(0,d.jsx)(dt,{isSmallWidth:e.isSmallWidth,embedInputValue:u,setEmbedInputValue:m,tab:t});case"file":return(0,d.jsx)(Je,{isSmallWidth:e.isSmallWidth,onCancel:e.onCancel,tab:t});case"emoji":return(0,d.jsx)(o(531633).h,{onSubmit:t.onChange,filter:p.inputValue||"",isCallout:e.isCallout,iconLoggingData:e.recordIconLoggingData,menuRef:c,onUpload:t.uploadFileEventHandlers,isInline:!1});case"icon":return(0,d.jsx)(G().$1,{filter:h.inputValue||"",onSubmit:t.onChange,iconLoggingData:e.recordIconLoggingData,enforceIconColor:t.enforceIconColor,menuRef:c});case"gallery":return(0,d.jsx)(Ze,{tab:t});case"unsplash":return(0,d.jsx)(Ve,{tab:t,isSmallWidth:e.isSmallWidth});case"giphy":return(0,d.jsx)(_e,{tab:t,isSmallWidth:e.isSmallWidth});case"drive":return(0,d.jsx)(st,{tab:t});case"box":return(0,d.jsx)(tt,{tab:t});case"aiSourcePicker":return(0,d.jsx)(rt,{isSmallWidth:e.isSmallWidth,aiSourcePickerStore:j,tab:t});case"custom":return(0,d.jsx)(ct,{isSmallWidth:e.isSmallWidth,onCancel:e.onCancel,embedInputValue:u,setEmbedInputValue:m,tab:t});case"customEmoji":return(0,d.jsx)(o(551693).z,{showTitle:!1,largeEmoji:!0,allowUrlPaste:!0,confirmToAdd:!0,uploadFileEventHandlers:t.uploadFileEventHandlers,onUploadWithoutSaving:t.onUploadWithoutSaving,onCancel:e.onCancel,entrypoint:"upload_tab"});default:(0,o(696459).t1)(t)}}const C=null!=c&&null!==(t=c.current)&&void 0!==t&&t.offsetWidth?((null==c||null===(s=c.current)||void 0===s?void 0:s.offsetWidth)-24)/32:12,{device:b}=r,S=(0,d.jsxs)(i.Fragment,{children:[(0,d.jsx)(nt,{tabs:e.tabs,onDelete:e.onDelete,currentTab:e.currentTab}),(0,d.jsx)(Ke,{tabs:e.tabs,currentTab:e.currentTab,onFilterChange:e=>{const t=C*(r.device.isMobile?G().L6:G().OF);g({...p,inputValue:e.currentTarget.value}),x({...h,inputValue:e.currentTarget.value}),xe().default.setState({...xe().default.state,loadIconCount:t})},iconInput:h.inputValue,emojiInput:p.inputValue,onRandomButtonClick:t=>{"emoji"===t.type?function(e,t,o){const{device:i}=o,n=e.find((e=>e.type===t));if(n&&"emoji"===n.type){const e=k().zM();n.onChange(e,{keepVisible:!i.isMobile})}}(e.tabs,e.currentTab,r):function(e,t,o){const{device:i}=e,n=t.find((e=>e.type===o));if(n&&"icon"===n.type){const e=n.enforceIconColor??(null===(a=Z().default.state)||void 0===a||null===(a=a.currentUserSettingsStore)||void 0===a||null===(a=a.getSettings())||void 0===a?void 0:a.icon_picker_color),t=`/icons/${v().UP(Object.keys(xe().default.getState().allIcons))}_${e??v().UP(l().Oe)}.svg`;n.onChange(t,{keepVisible:!i.isMobile})}var a}(r,e.tabs,e.currentTab)}})]});let M;if(b.isMobile)M={menuType:pe().o.Modal,title:e.title,header:S,right:(0,d.jsx)(f()._H,{defaultMessage:"Close",id:"mediaPicker.mobileCloseButton.label"}),onClickRight:e.onCancel,left:e.onDelete&&(0,d.jsx)(f()._H,{defaultMessage:"Remove",id:"mediaPicker.mobileRemoveButton.label"}),onClickLeft:e.onDelete};else{M={menuType:pe().o.Popup,header:S};const t=e.tabs.find((t=>t.type===e.currentTab)),o=t&&"tabHeight"in t?t.tabHeight:void 0;M.width=e.popupWidth||300,M.height=o||e.popupHeight,M.maxHeight=e.maxHeight,M.maxWidth=e.maxWidth}return(0,d.jsx)(o(604898).Z,{onSwipeLeft:()=>function(e,t){if(!je().Z.state.isActive)return;const o=e.map((e=>e.type)).indexOf(je().Z.state.currentTab),i=e[o+1];void 0!==i&&it(i.type,t)}(e.tabs,r),onSwipeRight:()=>function(e,t){if(!je().Z.state.isActive)return;const o=e.map((e=>e.type)).indexOf(je().Z.state.currentTab),i=e[o-1];void 0!==i&&it(i.type,t)}(e.tabs,r),render:e=>(0,d.jsx)(o(198829).Z,{...M,...e,className:T().tQh,innerRef:c,children:y()})})};function Ke(e){const t=(0,f().YB)(),{isPhone:o,isMobile:i,isAndroid:a}=(0,n().Fy)(),s=e.tabs.find((t=>t.type===e.currentTab));if("emoji"===(null==s?void 0:s.type)||"icon"===(null==s?void 0:s.type)){const n="emoji"===s.type?e.emojiInput:e.iconInput,r=()=>e.onRandomButtonClick(s),l=(0,d.jsx)($e,{tabs:e.tabs,currentTab:e.currentTab,hasRandomButtonOnLeft:!s.hideRandomButton});return(0,d.jsx)("div",{style:{display:"flex",...o?{}:{marginTop:16,marginBottom:10}},children:(0,d.jsx)(O().ZP,{value:n,placeholder:t.formatMessage(ze.filterPlaceholder),autoFocus:!i||void 0,focusInitial:!i||void 0,showClearButton:!0,inputLeft:(0,d.jsx)(O().f_,{icon:m().R}),onChange:e.onFilterChange,right:(0,d.jsxs)("div",{style:{display:"flex"},children:[null!=s&&s.hideRandomButton?void 0:(0,d.jsx)($().Z,{renderTooltip:()=>(0,d.jsx)(f()._H,{id:"mediaPicker.emojiTab.random",defaultMessage:"Random"}),placement:ee().Placement.Bottom,render:e=>(0,d.jsx)(O().DO,{icon:p,onClick:r,...e})}),l]}),isRightLastElementOfInput:!0,style:{...a&&{borderBottom:"none"}}})},`input-header-${s.type}`)}return null}function Ne(e){return e.fileUpload?me().jo:e.imageUpload?me().LR:e.videoUpload?me().G7:void 0}async function qe(e){let{tab:t,accept:o,allowMultipleFileSelection:i=!1}=e;const n=await M().y({multiple:i,accept:o});n.length&&t.onUpload(n)}function $e(e){let{hasRandomButtonOnLeft:t,tabs:o,currentTab:i}=e;const n=o.find((e=>e.type===i));if(!n)return null;let a;return"emoji"===(null==n?void 0:n.type)?a=(0,d.jsx)(ue().Z,{}):"icon"===(null==n?void 0:n.type)&&void 0===n.enforceIconColor&&(a=(0,d.jsx)(se,{})),t&&a?(0,d.jsx)("div",{style:{marginLeft:6},children:a}):a??null}function Ge(e){let{tab:t,isSmallWidth:o}=e;return t.imageUpload||t.videoUpload?(0,d.jsxs)(U().Z,{desktopStyle:{marginTop:4,display:"flex",justifyContent:"center",marginRight:12,marginLeft:12},children:[t.imageUpload&&(0,d.jsx)(N().Z,{size:"lg",onClick:()=>qe({tab:t,accept:"image/*",allowMultipleFileSelection:!0}),style:{width:"100%"},children:(0,d.jsx)(f()._H,{defaultMessage:"Upload file",id:"mediaPicker.chooseImage.buttonText"})}),t.videoUpload&&(0,d.jsx)(_().Z,{title:(0,d.jsx)(f()._H,{defaultMessage:"Choose a video",id:"mediaPicker.chooseVideo.buttonText"}),onClick:()=>qe({tab:t,accept:"video/*"}),fullWidth:o})]}):null}function Je(e){let{tab:t,isSmallWidth:o,onCancel:i}=e;const r=(0,n().O7)(),l=(0,a().Kw)(Ce().subscriptionDataStoreInstance),c=(0,s().yK)((e=>({dropzone:{background:(0,j().fn)([j().ZP.blueWithAlpha(.14),(0,x().Fq)(e.contentBackground,.5)])},caption:{textAlign:o?"left":"center",color:e.mediumTextColor},fileLimitWrapper:{display:"flex",alignItems:"center",justifyContent:o?"flex-start":"center"},fileLimitInner:{marginRight:6,color:e.mediumTextColor}})),[o]),u=(0,a().VK)((()=>ge().default.state.isOnboarding),[]),m=(0,a().VK)((()=>ye().M9(r)||"plus"),[r]);return(0,d.jsx)(V().Q,{type:Ne(t)??me().gU,dropTargetKey:"uploadTab",onDropFile:e=>{if("invalidFileDrop"===e.type)return S().oV({label:(0,d.jsx)(f()._H,{id:"mediaPicker.invalidImageDrop.wrongTypeErrorMessage",defaultMessage:"Sorry, that file type is not supported."})}),null;t.onUpload([e.file])},dropzoneStyle:c.dropzone,children:(0,d.jsxs)("div",{style:{marginTop:-24,paddingTop:24},children:[t.fileUpload&&(0,d.jsx)(U().Z,{desktopStyle:{marginTop:o?8:24},children:(0,d.jsx)(_().Z,{title:(0,d.jsx)(f()._H,{defaultMessage:"Choose a file",id:"mediaPicker.chooseFile.button.label"}),onClick:()=>qe({tab:t}),fullWidth:o})}),(0,d.jsx)(Ge,{isSmallWidth:o,tab:t}),t.caption&&(0,d.jsx)(H().Z,{shouldWrapCaption:!0,caption:t.caption,style:c.caption}),t.preventUploadLimitFreeFileSize||l&&ye().YK(l)&&(0,d.jsx)("div",{style:{height:8}}),l&&!t.preventUploadLimitFreeFileSize&&!ye().YK(l)&&(0,d.jsx)(H().Z,{shouldWrapCaption:!0,caption:(0,d.jsxs)("div",{style:c.fileLimitWrapper,children:[(0,d.jsx)("div",{style:c.fileLimitInner,children:(0,d.jsx)(f()._H,{defaultMessage:"The maximum size per file is {filesize} MB.",id:"mediaPicker.maximumFileSize.notice",values:{filesize:M().K_}})}),!u&&(0,d.jsx)(ve().Z,{subscriptionTier:m,onClick:()=>{i&&i()},analyticsName:"media_picker",desktopStyle:{marginBottom:1}})]})})]})})}let Ye=function(e){return e.Drive="drive",e.Docs="gDocs",e}({});function Qe(e){let{tab:t,type:o}=e;return o===Ye.Docs?(0,d.jsx)(et,{tab:t}):(0,d.jsx)(Xe,{tab:t})}function Xe(e){let{tab:t}=e;const o=(0,s().yK)((e=>({buttonItem:{color:e.blueColor}})),[]);return(0,d.jsxs)(U().Z,{children:[(0,d.jsx)(A().Z,{title:(0,d.jsx)(f()._H,{defaultMessage:"Connect Google account",id:"mediaPicker.menuItem.connectFirstGoogleAccount.label"}),onClick:()=>t.onSelect(),focused:!1,style:o.buttonItem}),(0,d.jsx)(H().Z,{shouldWrapCaption:!1,caption:(0,d.jsx)(f()._H,{defaultMessage:"Find and embed your Google Drive files.",id:"mediaPicker.menuItem.connectFirstGoogleAccount.caption"})})]})}function et(e){let{tab:t}=e;return(0,d.jsx)(U().Z,{children:(0,d.jsx)(A().Z,{title:(0,d.jsx)(f()._H,{defaultMessage:"Connect Google account",id:"mediaPicker.menuItem.connectFirstGoogleAccount.label"}),onClick:()=>t.onSelect(),focused:!1})})}function tt(e){let{tab:t}=e;const o=(0,s().yK)((e=>({connectFirstAccountButton:{color:e.blueColor},connectSecondAccountButton:{color:e.mediumTextColor}})),[]),{accounts:i}=t;return 0===i.length?(0,d.jsxs)(U().Z,{children:[(0,d.jsx)(A().Z,{title:(0,d.jsx)(f()._H,{defaultMessage:"Connect Box account",id:"mediaPicker.menuItem.connectFirstBoxAccount.label"}),onClick:()=>t.onSelect(),focused:!1,style:o.connectFirstAccountButton}),(0,d.jsx)(H().Z,{shouldWrapCaption:!1,caption:(0,d.jsx)(f()._H,{defaultMessage:"Find and embed your Box files.",id:"mediaPicker.menuItem.connectFirstBoxAccount.caption"})})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(U().Z,{children:i.map((e=>(0,d.jsx)(A().Z,{title:(0,d.jsx)(f()._H,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:e.account_name}}),onClick:()=>t.onSelect(e),focused:!1},e.account_key)))}),(0,d.jsx)(U().Z,{topBorder:!0,children:(0,d.jsx)(A().Z,{title:(0,d.jsx)(f()._H,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreBoxAccounts.label"}),onClick:()=>t.onSelect(),style:o.connectSecondAccountButton,focused:!1})})]})}function ot(e,t){return()=>{e&&t.onChange(e)}}function it(e,t){je().Z.state.isActive&&(je().Z.setState({...je().Z.state,currentTab:e}),"icon"===e&&je().Z.state.recordIconLoggingData&&y().kz(t,"select_icon_tab",je().Z.state.recordIconLoggingData))}function nt(e){let{tabs:t,onDelete:o,currentTab:a}=e;const r=(0,s().yK)((e=>({sparklesIcon:{width:16,height:16,marginRight:4,color:e.accentColors.purple[400]}})),[]),l=(0,n().O7)(),{device:c}=l;if(t.length<=1&&!o)return null;{const e={gallery:(0,d.jsx)(f()._H,{id:"mediaPicker.tabs.gallery",defaultMessage:"Gallery"}),embed:(0,d.jsx)(f()._H,{id:"mediaPicker.tabs.embedLink",defaultMessage:"Embed link"}),file:(0,d.jsx)(f()._H,{id:"mediaPicker.tabs.upload",defaultMessage:"Upload"}),emoji:(0,d.jsx)(f()._H,{id:"mediaPicker.tabs.emoji",defaultMessage:"Emoji"}),icon:(0,d.jsx)(f()._H,{id:"mediaPicker.tabs.icon",defaultMessage:"Icon"}),custom:(0,d.jsx)(f()._H,{id:"mediaPicker.tabs.custom",defaultMessage:"Custom"}),customEmoji:(0,d.jsx)(f()._H,{id:"mediaPicker.tabs.customEmoji",defaultMessage:"Upload"}),unsplash:(0,d.jsxs)(i.Fragment,{children:[h({width:12,marginRight:4,height:12}),(0,d.jsx)("span",{children:"Unsplash"})]}),giphy:(0,d.jsxs)(i.Fragment,{children:[u({width:12,marginRight:4,height:12}),(0,d.jsx)("span",{children:"GIPHY"})]}),drive:(0,d.jsx)(f()._H,{id:"mediaPicker.tabs.browse",defaultMessage:"Browse"}),box:(0,d.jsx)(f()._H,{id:"mediaPicker.tabs.browse",defaultMessage:"Browse"}),aiSourcePicker:(0,d.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,d.jsx)(f()._H,{id:"mediaPicker.tabs.ask",defaultMessage:"Ask"}),(0,g().t)(r.sparklesIcon)]})},n=t.findIndex((e=>e.type===a)),s=t.map((t=>t.title||e[t.type])),m=t.find((e=>e.type===a)),p=m&&"emoji"!==m.type&&c.isAndroid;return(0,d.jsx)(ce().ZP,{tabs:s,selectedIndex:n,onChange:e=>{it(t[e].type,l)},right:o&&!c.isMobile&&(0,d.jsx)(W().D,{isGray:!0,onClick:o,children:(0,d.jsx)(f()._H,{id:"mediaPicker.tabs.remove",defaultMessage:"Remove"})}),style:{...p&&{borderBottom:"none"}}})}}function at(e){let{tab:t,accounts:o,type:n=Ye.Drive}=e;const a=(0,s().yK)((e=>({buttonItem:{color:e.mediumTextColor}})),[]);return"accounts"in t?t.accounts&&0===t.accounts.length?(0,d.jsx)(Qe,{tab:t,type:n}):(0,d.jsxs)(i.Fragment,{children:[(0,d.jsx)(U().Z,{children:t.accounts.map(((e,o)=>(0,d.jsx)(A().Z,{title:(0,d.jsx)(f()._H,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:e.account_name}}),onClick:()=>t.onSelect(e),focused:!1},e.account_key)))}),(0,d.jsx)(U().Z,{topBorder:!0,children:(0,d.jsx)(A().Z,{title:(0,d.jsx)(f()._H,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreGoogleAccounts.label"}),onClick:()=>t.onSelect(),style:a.buttonItem,focused:!1})})]}):o?0===o.length?(0,d.jsx)(Qe,{tab:t,type:n}):(0,d.jsxs)(i.Fragment,{children:[(0,d.jsx)(U().Z,{children:o.map(((e,o)=>(0,d.jsx)(A().Z,{title:(0,d.jsx)(f()._H,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:e.accountName}}),onClick:()=>t.onSelect(e),focused:!1},e.accountId)))}),(0,d.jsx)(U().Z,{topBorder:!0,children:(0,d.jsx)(A().Z,{title:(0,d.jsx)(f()._H,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreGoogleAccounts.label"}),onClick:()=>t.onSelect(),style:a.buttonItem,focused:!1})})]}):null}function st(e){let{tab:t}=e;const o=(0,n().O7)();return"accounts"in t?(0,d.jsx)(at,{tab:t}):(0,d.jsx)(D().Z,{request:o,performRequest:b().vQ,render:(e,o,i)=>{if(!i)return(0,d.jsx)(U().Z,{children:(0,d.jsx)(le().Z,{})});const n=o&&o.accounts?o.accounts:[];return(0,d.jsx)(at,{tab:t,accounts:n})}})}function rt(e){var t,o;let{tab:n,isSmallWidth:r,aiSourcePickerStore:l}=e;const c=(0,f().YB)(),u=(0,s().yK)((e=>({captionItem:{textAlign:r?"left":"center",color:e.mediumTextColor},aiResult:{cursor:"pointer",color:e.mediumTextColor,textAlign:"left",hyphens:"auto",padding:"10px 8px",display:"flex",flexDirection:"row"},aiTitleWrapper:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"rgb(55, 53, 47)",fontWeight:500,fontSize:"14px",paddingLeft:8},aiLoadingWrapper:{flex:1,color:e.accentColors.purple[400],fontWeight:500,flexDirection:"row",gap:6,display:"flex",alignItems:"center",padding:"12px 12px",marginLeft:10},loadingDots:{backgroundColor:e.accentColors.purple[400]}})),[r]),m=(0,a().qz)(l,fe),p=(0,a().Kw)(m);return(0,d.jsxs)(i.Fragment,{children:[p.result&&!1===p.loading&&(0===(null===(t=p.result)||void 0===t?void 0:t.length)?(0,d.jsx)(H().Z,{shouldWrapCaption:!0,caption:(0,d.jsx)(f()._H,{defaultMessage:"No results found.",id:"mediaPicker.aiSourcePicker.noResultsText"}),style:u.captionItem}):null===(o=p.result)||void 0===o?void 0:o.map((e=>(0,d.jsxs)("div",{style:{...u.aiResult,backgroundColor:p.hover===e.url?"rgba(55,53,47,0.08)":""},onClick:ot(e.url,n),onMouseEnter:()=>{m.setState({...p,hover:e.url})},children:[(0,d.jsx)(z().Z,{imageURL:"NONE"===e.avatar?n.defaultAvatar:e.avatar,size:24,imageStyle:{borderRadius:34,boxShadow:"0 2px 4px rgba(15, 15, 15, 0.1)"},type:"image_url"}),(0,d.jsx)("div",{style:u.aiTitleWrapper,children:e.title})]},e.url)))),p.loading&&(0,d.jsxs)("div",{style:u.aiLoadingWrapper,children:[c.formatMessage(ze.aiIsFetchingLoader),(0,d.jsx)(K().Z,{style:u.loadingDots})]}),!p.result&&!p.loading&&(0,d.jsx)(F,{tab:n,placeholder:n.inputPlaceholder||c.formatMessage(ze.aiSourcePickerPlaceholder),store:m,isSmallWidth:r})]})}function lt(e,t,o){return()=>{const i=o;if(i){const o=(0,r().Wv)({source:i,secureFileConfigRootpath:de().default.secureFileConfig.rootPath,secureFileConfigHostname:de().default.secureFileConfig.hostname}),n=o?o.link:i;e.onChange(n),C().bO(t,{pastedText:n,source:"media_picker"})}}}function ct(e){let{tab:t,isSmallWidth:o,onCancel:i,embedInputValue:r,setEmbedInputValue:l}=e;const c=(0,f().YB)(),u=(0,n().O7)(),m=(0,n().Fy)(),p=(0,a().Kw)(Ce().subscriptionDataStoreInstance),g=(0,a().VK)((()=>ye().M9(u)),[u]),h=(0,a().VK)((()=>ge().default.state.isOnboarding),[]),v=(0,s().yK)((e=>({dropZone:{background:(0,j().fn)([j().ZP.blueWithAlpha(.14),(0,x().Fq)(e.contentBackground,.5)])},caption:{textAlign:o?"left":"center",color:e.mediumTextColor},subscriptionLimitWrapper:{display:"flex",alignItems:"center",justifyContent:o?"flex-start":"center"},subscriptionLimitInner:{marginRight:6,color:e.mediumTextColor}})),[o]),y=(0,d.jsx)(q().Z,{onClick:lt(t,u,r),disabled:0===r.length,hovered:!1,children:t.buttonText||(0,d.jsx)(f()._H,{defaultMessage:"Link",id:"mediaPicker.embedTab.embedLinkButtonText"})}),C=(0,d.jsx)(U().Z,{desktopStyle:{marginTop:16,display:"flex",paddingTop:0,paddingBottom:12},children:(0,d.jsx)(O().ZP,{type:"url",value:r,placeholder:t.inputPlaceholder||c.formatMessage(ze.embedPlaceholder),autoFocus:!m.isMobile||void 0,showClearButton:!0,focus:!m.isMobile||void 0,onSubmit:lt(t,u,r),onChange:e=>l(e.target.value),inputRight:m.isPhone?y:void 0,right:m.isPhone?void 0:y,isRightLastElementOfInput:!0})}),b=(0,d.jsx)(V().Q,{type:Ne(t)??me().gU,dropTargetKey:"uploadTab",onDropFile:e=>{if("invalidFileDrop"===e.type)return S().oV({label:(0,d.jsx)(f()._H,{id:"mediaPicker.invalidImageDrop.wrongTypeErrorMessage",defaultMessage:"Sorry, that file type is not supported."})}),null;t.onUpload([e.file])},dropzoneStyle:v.dropZone,children:(0,d.jsxs)("div",{style:{marginTop:-24,paddingTop:24},children:[t.fileUpload&&(0,d.jsx)(U().Z,{desktopStyle:{marginTop:o?8:24},children:(0,d.jsx)(_().Z,{title:(0,d.jsx)(f()._H,{defaultMessage:"Choose a file",id:"mediaPicker.chooseFile.button.label"}),onClick:()=>qe({tab:t}),fullWidth:o})}),(0,d.jsx)(Ge,{isSmallWidth:o,tab:t}),t.caption&&(0,d.jsx)(H().Z,{shouldWrapCaption:!0,caption:t.caption,style:v.caption}),t.preventUploadLimitFreeFileSize||p&&ye().YK(p)&&(0,d.jsx)("div",{style:{height:8}}),p&&!t.preventUploadLimitFreeFileSize&&!ye().YK(p)&&(0,d.jsx)(H().Z,{shouldWrapCaption:!0,caption:(0,d.jsxs)("div",{style:v.subscriptionLimitWrapper,children:[(0,d.jsx)("div",{style:v.subscriptionLimitInner,children:(0,d.jsx)(f()._H,{defaultMessage:"The maximum size per file is {filesize} MB.",id:"mediaPicker.maximumFileSize.notice",values:{filesize:M().K_}})}),!h&&(0,d.jsx)(ve().Z,{subscriptionTier:g||"plus",onClick:()=>{i&&i()},analyticsName:"media_picker",desktopStyle:{marginBottom:1}})]})})]})});return(0,d.jsxs)(d.Fragment,{children:[C,b]})}function dt(e){let{tab:t,isSmallWidth:o,embedInputValue:a,setEmbedInputValue:s}=e;const r=(0,n().O7)(),l=(0,f().YB)(),{device:c}=r;return(0,d.jsxs)(i.Fragment,{children:[(0,d.jsx)(U().Z,{desktopStyle:{marginTop:8},children:(0,d.jsx)(O().ZP,{type:"url",value:a,placeholder:t.inputPlaceholder||l.formatMessage(ze.embedPlaceholder),autoFocus:!c.isMobile||void 0,showClearButton:!0,focus:!c.isMobile||void 0,onSubmit:lt(t,r,a),onChange:e=>s(e.target.value)})}),(0,d.jsx)(U().Z,{style:t.caption?{}:{marginBottom:6},children:(0,d.jsx)(_().Z,{onClick:lt(t,r,a),title:t.buttonText||(0,d.jsx)(f()._H,{defaultMessage:"Link",id:"mediaPicker.embedTab.embedLinkButtonText"}),fullWidth:o})}),t.caption&&(0,d.jsx)(H().Z,{shouldWrapCaption:!0,caption:t.caption,style:{textAlign:c.isMobile?"left":"center",marginBottom:4}})]})}},180099:(e,t,o)=>{o.d(t,{Z:()=>s});o(670560),o(122556),o(582845),o(250570),o(533019),o(721473),o(788208),o(22624),o(241792);const i={value:-1,refetch:!1};class n extends(()=>o(168469))().q{constructor(e,t){super(e,t),this.emitDataMapStore=void 0,this.emitDataMapStore=o(263184).default.createValue({})}getData(e,t){var o;let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=this.keyFn(t);a in this.emitDataMapStore.state||(this.emitDataMapStore.state[a]={...i},this.emitDataMapStore.emit());const s=n||this.emitDataMapStore.state[a].refetch||void 0===(null===(o=this.storeMap[a])||void 0===o?void 0:o.state);return this.emitDataMapStore.state[a].refetch=!1,super.getData(e,t,s)}getDataWithoutRefetch(e,t){const o=this.keyFn(t);return o in this.emitDataMapStore.state||(this.emitDataMapStore.state[o]={...i},this.emitDataMapStore.emit()),super.getData(e,t,!1)}emit(e,t){const o=this.keyFn(e),n=this.emitDataMapStore.state[o].value;t!==n&&n!==i.value&&(this.emitDataMapStore.state[o].refetch=!0),this.emitDataMapStore.state[o].value=t;const a={...this.emitDataMapStore.state[o]};this.emitDataMapStore.setState({...this.emitDataMapStore.state,[o]:a})}getKeys(){return Object.keys(this.emitDataMapStore.state)}}const a=new n((e=>{let{spaceId:t}=e;return t}),(async function(e,t){const i=await o(824462).callApi({eventName:"getCustomEmojisForSpace",environment:e,data:t,headers:(0,o(741633).Bb)({spaceId:t.spaceId})});if("failed"===i.type)return;const n={pointers:[],names:new Set,lastFetchedBy:e.currentUser.id},a=o(217465).RecordMapWithRole.create(i.data.recordMap),s=[];for(const{pointer:r}of a.getByTable(o(717740).p)){const e=a.getModel(r);if(!e)continue;const t=e.getName();n.names.add(t),s.push({pointer:r,name:t})}return n.pointers=s.sort(((e,t)=>e.name.localeCompare(t.name))).map((e=>e.pointer)),n}));o(947115).exposeDebugValue("CustomEmojisStore",a);const s=a},808985:(e,t,o)=>{o.d(t,{default:()=>n});class i extends(()=>o(263184))().default{getInitialState(){return{allIcons:{},recentIcons:[],loadIconCount:0}}}const n=new i},50366:(e,t,o)=>{o.d(t,{U:()=>n});o(667294);var i=o(785893);const n=(0,o(827282).IU)("colorPickerCircle",{viewBox:"0 0 32 32",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("circle",{cx:"16",cy:"16",r:"14",strokeWidth:"3",fill:"none"}),(0,i.jsx)("circle",{cx:"16",cy:"16",r:"14",opacity:"0.9"})]})})},698357:(e,t,o)=>{o.d(t,{d:()=>n});o(667294);var i=o(785893);const n=(0,o(827282).IU)("emojiRecents",{viewBox:"0 0 28 28",svg:(0,i.jsx)("path",{d:"M14 22.4297C9.58594 22.4297 5.92969 18.7812 5.92969 14.3594C5.92969 9.94531 9.57812 6.28906 13.9922 6.28906C18.4141 6.28906 22.0703 9.94531 22.0703 14.3594C22.0703 18.7812 18.4141 22.4297 14 22.4297ZM14 20.8438C17.5938 20.8438 20.4844 17.9531 20.4844 14.3594C20.4844 10.7656 17.5859 7.88281 13.9922 7.88281C10.3984 7.88281 7.52344 10.7656 7.52344 14.3594C7.52344 17.9531 10.4062 20.8438 14 20.8438ZM10.0469 15.3281C9.69531 15.3281 9.42969 15.0547 9.42969 14.7109C9.42969 14.3594 9.69531 14.0938 10.0469 14.0938H13.375V9.58594C13.375 9.24219 13.6484 8.96875 13.9922 8.96875C14.3438 8.96875 14.6172 9.24219 14.6172 9.58594V14.7109C14.6172 15.0547 14.3438 15.3281 13.9922 15.3281H10.0469Z"})})},369180:(e,t,o)=>{o.d(t,{A:()=>n});o(667294);var i=o(785893);const n=(0,o(827282).IU)("photo",{viewBox:"0 0 19 16",svg:(0,i.jsx)("path",{d:"M17.938 12.18c.03.755-.146 1.33-.532 1.726-.385.396-.971.594-1.758.594H2.992c-.65 0-1.143-.185-1.476-.555-.334-.37-.51-.916-.532-1.64l2.946-2.64a1.66 1.66 0 01.484-.33 1.292 1.292 0 011.063.009c.182.073.354.182.515.328l1.446 1.305L10.96 7.82c.182-.156.37-.273.562-.351a1.607 1.607 0 011.22.008c.202.078.39.197.562.359l4.633 4.344zM6.296 8.008a1.85 1.85 0 01-.945-.25 1.93 1.93 0 01-.68-.68 1.846 1.846 0 01-.25-.945c0-.339.083-.651.25-.938a1.93 1.93 0 01.68-.68c.286-.171.601-.257.945-.257s.656.086.937.258c.282.166.506.393.672.68.172.286.258.598.258.937a1.8 1.8 0 01-.258.945c-.166.287-.39.513-.672.68-.28.166-.593.25-.937.25zm-3.492 7.148c-.844 0-1.482-.213-1.914-.64-.433-.428-.649-1.058-.649-1.891V3.109c0-.833.216-1.463.649-1.89C1.323.786 1.96.57 2.805.57H16.18c.849 0 1.49.216 1.922.649.432.427.648 1.057.648 1.89v9.516c0 .833-.216 1.463-.648 1.89-.433.428-1.073.641-1.922.641H2.805zm.093-1.531h13.196c.36 0 .635-.094.828-.281.193-.193.289-.477.289-.852v-9.25c0-.375-.096-.656-.29-.844-.192-.192-.468-.289-.827-.289H2.898c-.364 0-.643.097-.836.29-.187.187-.28.468-.28.843v9.25c0 .375.093.659.28.852.193.187.472.281.836.281z"})})},76910:(e,t,o)=>{o.d(t,{n:()=>n});o(667294);var i=o(785893);const n=(0,o(827282).IU)("refresh",{viewBox:"0 0 14 15",svg:(0,i.jsx)("path",{d:"m1.382 7.22 1.294-1.782q.156-.215.376-.215c.22 0 .272.071.376.215l1.289 1.787q.195.263.112.483-.078.215-.39.215H3.69a3.7 3.7 0 0 0 .445 1.24q.337.576.844 1.016.508.435 1.153.673.645.245 1.372.245.771 0 1.445-.288a3.8 3.8 0 0 0 1.182-.777q.277-.225.537-.195a.61.61 0 0 1 .552.674q-.015.258-.254.464-.66.639-1.553 1.02a4.8 4.8 0 0 1-1.91.386 5.13 5.13 0 0 1-3.428-1.304 5.4 5.4 0 0 1-1.132-1.42 5 5 0 0 1-.561-1.734h-.718q-.322 0-.4-.215-.074-.22.117-.488Zm2.666-3.745q.66-.64 1.553-1.02a4.75 4.75 0 0 1 1.904-.387q.99 0 1.865.347a5.2 5.2 0 0 1 1.563.962q.694.615 1.132 1.426.44.806.567 1.728h.703q.317 0 .395.22.083.215-.112.483l-1.294 1.783q-.156.214-.376.214-.215 0-.37-.214l-1.295-1.788q-.195-.263-.112-.478.083-.22.395-.22h.757a3.7 3.7 0 0 0-.454-1.24 3.85 3.85 0 0 0-1.987-1.69 3.8 3.8 0 0 0-1.377-.248q-.762 0-1.44.288a3.8 3.8 0 0 0-1.182.776q-.279.225-.537.195a.63.63 0 0 1-.42-.23.6.6 0 0 1-.137-.439q.02-.258.259-.468"})})}}]);