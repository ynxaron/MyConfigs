"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[89294],{737244:(e,t,n)=>{n.d(t,{Z:()=>i});class a extends(()=>n(263184))().default{getInitialState(){return{open:!1}}}const i=new a},489294:(e,t,n)=>{n.r(t),n.d(t,{applyStudentGitHubGrant:()=>Ze,cancelSubscription:()=>we,closeSubscriptionUpgradeModal:()=>Me,handlePaymentIntentNextActions:()=>Ue,handlePlanChangeClick:()=>Ee,openSubscriptionUpgradeModal:()=>Ce,openSubscriptionUpgradeModalForClaimAndUpgrade:()=>xe,payUnpaidInvoice:()=>ve,refresh:()=>De,refreshBillingHistory:()=>Te,trackSubscriptionUpdate:()=>me,updateAddress:()=>ge,updateBillingEmail:()=>ye,updateCurrentSpace:()=>he,updatePaymentMethod:()=>fe,updateSubscription:()=>ue,updateSubscriptionToEducationPlan:()=>Ie,updateVatId:()=>be});n(821057),n(667294);var a=()=>n(799891),i=()=>n(956057),r=()=>n(35980),s=()=>n(741633),o=()=>n(629719);function d(e){return!!e&&e.items.length>0}var c=()=>n(976102),l=()=>n(381348);var u=()=>n(681941),p=()=>n(788860),m=()=>n(513670),f=()=>n(696459),v=()=>n(979614),g=()=>n(824462),b=()=>n(917801),y=()=>n(308186),w=()=>n(528918),S=()=>n(106502),I=()=>n(572623),h=()=>n(527278),D=()=>n(693622),_=()=>n(341691),T=()=>n(151165),A=()=>n(876822),C=()=>n(293760),M=()=>n(518019),x=()=>n(245845),E=()=>n(749826),U=()=>n(214488),P=()=>n(9599),Z=()=>n(148882),O=()=>n(801072),N=()=>n(458335),j=()=>n(826955),F=()=>n(838266),B=()=>n(145613),k=()=>n(515323),V=()=>n(396992),Y=()=>n(620252),L=()=>n(615389),z=()=>n(548812),H=()=>n(111631),$=()=>n(254687),K=()=>n(28886);n(267602),n(653476),n(470928),n(241792);var q=()=>n(38812),G=()=>n(18281),J=()=>n(697623),R=()=>n(939985),Q=()=>n(46135),W=()=>n(745181),X=()=>n(419157),ee=()=>n(897257),te=()=>n(183922),ne=()=>n(635596);async function ae(e){const{environment:t,spaceId:n}=e,a=(0,te().Ap)({spaceId:n});if(!se||se!==a){let n;!function(e){re&&ne().ZP.removeListener(re,e)}(t);const i=(t,a)=>{void 0!==n&&n!==a&&ie(e),n=a},r=m().P2(i,5e3);re=ne().ZP.addListener(a,r,void 0,t),se=a;const s=T().Z.state;if(!Object.keys(s).length)return ie(e)}}async function ie(e){const{environment:t,spaceId:n}=e;if((0,G().ro)(t,n))return;const a=await g().callApi({eventName:"getBillingSubscriptionBannerData",environment:t,data:{spaceId:n},headers:(0,s().Bb)({cellId:void 0,spaceId:n})});var i;"success"===a.type&&((null===(i=A().default.state.currentSpaceStore)||void 0===i?void 0:i.id)===n&&T().Z.setState(a.data.bannerData));const r=await g().callApi({eventName:"getSubscriptionEntitlements",environment:t,data:{spaceId:n}});var o;"success"===r.type&&((null===(o=A().default.state.currentSpaceStore)||void 0===o?void 0:o.id)===n&&C().default.setState(r.data))}let re,se;var oe=()=>n(444297),de=n(785893);const ce="SubscriptionData",le=(0,p().vU)({updatingSubscription:{id:"subscriptionSettings.updatingSubscriptionMessage",defaultMessage:"Updating your subscription…"},paymentMethodUpdateAuthFailed:{id:"subscriptionSettings.paymentMethodUpdateAuthFailedMessage",defaultMessage:"We could not update your payment method. Please try again or contact support."},verifyingEligibility:{id:"subscriptionSettings.verifyingEligibilityMessage",defaultMessage:"Verifying eligibility…"},personalFree:{id:"subscriptionSettings.personalFreeMessage",defaultMessage:"You are now subscribed to Notion’s Personal Pro Plan for free."},educationPlusFree:{id:"subscriptionSettings.educationPlusFreeMessage",defaultMessage:"You are now subscribed to Notion's Education plan for free"},finishingUp:{id:"subscription.upgrade.finishing",defaultMessage:"Finishing up..."},overFreeBlockLimitMobileNativeDialog:{id:"subscriptionActions.overFreeBlockLimit.mobileNativeDialog",defaultMessage:"Your free blocks have been used up. Unfortunately, unlimited blocks cannot be purchased on mobile."}});async function ue(e){const{from:t,environment:n,spaceStore:a,billingEmail:i,paymentData:r,vatId:s,coupon:d,customerName:l,businessName:u,addressLine1:p,addressZip:m,addressCity:f,addressState:v,addressCountry:S,promoCodeId:I,useTestClock:h,sessionId:D,inAppOffer:_,desiredState:T,trialData:A}=e;b().Js({bannerStore:P().Z}),w().j({message:le.updatingSubscription});if(!ee().subscriptionDataStoreInstance.state)throw new Error("Subscription data not loaded.");const C=await M().Z.awaitData(n,{spaceId:null==a?void 0:a.id});if(!C)throw new Error("Billing data not loaded");const x=(0,o().iv)(C),{plan:E,addOns:U,isTrial:Z}=function(e,t){if(!t)return{plan:void 0,addOns:[],isTrial:void 0};const n=e.items.filter((e=>"plan"!==(0,o().tw)(e))),a=t.items.find((e=>"plan"===(0,o().tw)(e))),i=t.items.filter((e=>"plan"!==(0,o().tw)(e)));return{isTrial:Boolean(t.trialEnd),plan:null==a?void 0:a.price.externalId,addOns:(0,c().dK)(n,i).map((e=>{let[t,n]=e;return{isCancellation:!n,priceId:(n??t).price.externalId,quantity:null==n?void 0:n.quantity}}))}}(x,T),O=await g().callApi({eventName:"updateSubscription",environment:n,data:{spaceId:a.id,plan:E,addOns:U,billingEmail:i,paymentMethodId:(0,q().optionalPaymentMethodIdGivenPaymentData)(r),vatId:s,coupon:d,customerName:l,businessName:u,addressLine1:p,addressZip:m,addressCity:f,addressState:v,addressCountry:S,promoCodeId:I,useTestClock:h,modalSessionId:D,inAppOffer:_,isTrial:Z,clientVersion:n.device.version,trialData:A,from:t}});if(w().x(),"failed"===O.type)throw y().x2(O),new Error("An error occurred while updating subscription");await Se({environment:n,spaceStore:a,newDefaultTeamId:O.data.newDefaultTeamId});const N=ee().subscriptionDataStoreInstance.state,j=a.id,F=a.getPlanType(),B=await M().Z.awaitData(n,{spaceId:null==a?void 0:a.id});if(!B)throw new Error("Billing data not loaded");if(me({environment:n,context:{spaceId:j,planType:F,from:t,isMmOrEnt:await(0,oe().D)(n),trialData:A,modalId:D},oldData:C,newData:B,desiredState:T}),!N)throw new Error("Subscription data not loaded.");return Boolean(A)||pe({oldTier:(0,o().wO)(C.subscription),newTier:(0,o().wO)(B.subscription),oldAddOns:(0,o().aV)(C.subscription),newAddOns:(0,o().aV)(B.subscription)}),O.data}function pe(e){return!!(0,z().X3)()&&W().Z.open(e)}function me(e){var t;let{environment:n,context:a,oldData:i,newData:r,desiredState:s}=e;const c=(0,o().F5)(i.subscription),l=(0,o().wO)(i.subscription),u=(0,o().aV)(i.subscription),p=(0,o().Tz)(i.subscription),m=(0,o().YF)(i.subscription),f=i.email,g=(0,o().F5)(s),b=(0,o().wO)(s),y=(0,o().aV)(s),w=(0,o().Tz)(s),S=(0,o().YF)(s),h=Boolean(null==s?void 0:s.trialEnd),D=r.email,_=!(0,o().YK)(i)&&d(s),T=(0,o().YK)(i)&&d(s),A=(0,o().YK)(i)&&!d(s);_&&g?v().k6(n,{plan:g,credit_amount:0}):T?v().wl(n,{billing_email_changed:f!==D,plan_changed:g!==c,plan_current:g,plan_old:c,currency_code:S,billing_address_changed:!1}):A&&c&&v().rx(n,{plan:c}),v()._j(n,{from:a.from,action:A?"cancel":"update",spaceId:a.spaceId,isMmOrEnt:a.isMmOrEnt,planType:a.planType,addressCountry:null===(t=r.address)||void 0===t?void 0:t.country,oldSubscriptionTier:l,newSubscriptionTier:b,oldCurrency:m,newCurrency:S,oldPriceId:c,newPriceId:g,oldAddOns:u,newAddOns:y,oldBillingInterval:p,newBillingInterval:w,creditAmount:0,isProfessionalTeamUser:(0,I().QZ)(),isTrial:h,trialEndDate:(0,o().Dw)(i),trialData:a.trialData,modalId:a.modalId})}async function fe(e){const{environment:t,stripe:n,spaceStore:a,paymentMethodId:i}=e,r=await g().callApi({eventName:"updatePaymentMethod",environment:t,data:{spaceId:a.id,paymentMethodId:i}});if("failed"!==r.type){if(r.data.clientSecret&&"requires_action"===r.data.status){if("succeeded"!==await Pe({stripe:n,clientSecret:r.data.clientSecret}))return void y().UW(h().Z.formatMessage(le.paymentMethodUpdateAuthFailed));const e=await g().callApi({eventName:"setDefaultPaymentMethod",environment:t,data:{spaceId:a.id,paymentMethodId:i}});if("failed"===e.type)return void y().x2(e)}await De(t)}else y().x2(r)}async function ve(e){const{environment:t,invoiceId:n,paymentMethodId:a}=e,i=await g().callApi({eventName:"payInvoice",environment:t,data:{invoiceId:n,paymentMethodId:a}});"failed"!==i.type||y().x2(i)}async function ge(e){const{environment:t,spaceStore:n,address:a}=e;b().Js({bannerStore:P().Z}),w().j({message:le.updatingSubscription});const i=await g().callApi({eventName:"updateBillingInformation",environment:t,data:{spaceId:n.id,address:a}});if("failed"===i.type)throw w().x(),y().x2(i),i.error;v().wl(t,{billing_email_changed:!1,plan_changed:!1,billing_address_changed:!0}),await _e(t),await De(t),w().x()}async function be(e){const{environment:t,spaceStore:n,vatId:a}=e;b().Js({bannerStore:P().Z}),w().j({message:le.updatingSubscription});const i=await g().callApi({eventName:"updateBillingInformation",environment:t,data:{spaceId:n.id,vatId:a}});if("failed"===i.type)throw w().x(),y().x2(i),i.error;v().wl(t,{billing_email_changed:!1,plan_changed:!1,billing_address_changed:!1}),await _e(t),await De(t),w().x()}async function ye(e){const{environment:t,spaceStore:n,email:a}=e;b().Js({bannerStore:P().Z}),w().j({message:le.updatingSubscription});const i=await g().callApi({eventName:"updateBillingInformation",environment:t,data:{spaceId:n.id,billingEmail:a}});if("failed"===i.type)throw w().x(),y().x2(i),i.error;v().wl(t,{billing_email_changed:!0,plan_changed:!1,billing_address_changed:!1}),await _e(t),await De(t),w().x()}async function we(e){var t;const{environment:n,spaceStore:a,from:i}=e,r=await M().Z.awaitData(n,{spaceId:null==a?void 0:a.id});if(!r)throw new Error("Billing data not loaded");b().Js({bannerStore:P().Z}),w().j({message:le.updatingSubscription});const s=await g().callApi({eventName:"cancelSubscription",environment:n,data:{spaceId:a.id,cancelImmediately:e.cancelImmediately}});if("failed"===s.type)return w().x(),void y().x2(s);const d=(0,o().F5)(r.subscription);d&&v().rx(n,{plan:d}),await Se({environment:n,spaceStore:a,newDefaultTeamId:void 0});if(!ee().subscriptionDataStoreInstance.state)throw new Error("Subscription data not loaded.");return v()._j(n,{from:i,action:"cancel",spaceId:a.id,oldSubscriptionTier:(0,o().wO)(r.subscription),newSubscriptionTier:void 0,oldPriceId:null===(t=(0,o().a7)(r.subscription,"plan"))||void 0===t?void 0:t.price.externalId,oldCurrency:(0,o().YF)(r.subscription),newCurrency:void 0,oldAddOns:(0,o().aV)(r.subscription),oldBillingInterval:(0,o().Tz)(r.subscription),newBillingInterval:void 0,isCancelSubscription:!0,isProfessionalTeamUser:(0,I().QZ)(),trialEndDate:(0,o().Dw)(r)}),w().x(),!0}async function Se(e){let{environment:t,newDefaultTeamId:n,spaceStore:a}=e;if(await De(t),await _e(t),X().Z.reset(),t.currentUser.id&&void 0!==n){await H().m({userId:t.currentUser.id,spaceId:a.id,environment:t});const e=j().zX.createChildStore(a,{table:"team",id:n,spaceId:a.id});await e.load()}}const Ie=(0,m().Ds)((async function(e){const{environment:t,spaceStore:a,code:i}=e;w().j({message:le.verifyingEligibility});const r=ee().subscriptionDataStoreInstance.state;if(!r)throw new Error("Subscription data not loaded.");const s=await g().callApi({eventName:"updateSubscriptionToEducationPlan",environment:t,data:{spaceId:a.id,code:i}});"failed"===s.type?y().x2(s):s.data.isEligible?Ae(r,t):n(737244).Z.setState({open:!0,handlePromoCode:async e=>{w().j({message:le.updatingSubscription});const n=await g().callApi({eventName:"updateSubscriptionToEducationPlan",environment:t,data:{spaceId:a.id,code:e}});"failed"===n.type?y().x2(n):n.data.isEligible?Ae(r,t):y().UW((0,de.jsx)(p()._H,{id:"subscriptionSettings.invalidPromoCodeError.message",defaultMessage:"This promo code is not valid."})),w().x()}}),w().x()}),1e3,{leading:!0,trailing:!1});async function he(e){const{environment:t,spaceId:n,isNewlyCreatedSpace:a}=e,i=ee().subscriptionDataStoreInstance.spaceId;if(!t.currentUser.isLoggedIn()||i&&i===n)await ee().subscriptionDataStoreInstance.waitUntilLoaded();else if(T().Z.setState({}),ae({environment:t,spaceId:n}),C().default.setState({}),a){const e={type:"unsubscribed_admin",users:[],joinedMemberIds:[],blockUsage:0,hasPaidNonzero:!1,accountBalance:0,timelineViewUsage:0,userSimilarity:{},spaceUsers:[],members:[],customerData:void 0,revenueCatEnabled:!1,addOns:[]};ee().subscriptionDataStoreInstance.setState(e),ee().subscriptionDataStoreInstance.spaceId=n,L().O.setState(e.userSimilarity),De(t)}else De(t)}async function De(e){var t;const n=null===(t=A().default.state.currentSpaceStore)||void 0===t?void 0:t.id,i=e.currentUser.id;if(!n)throw new Error("No spaceId.");{const t=`${ce}:${n}:v2`,o=r().Z.get({userId:i,key:t});o&&(ee().subscriptionDataStoreInstance.setState(o),ee().subscriptionDataStoreInstance.spaceId=n,L().O.setState(o.userSimilarity)),await async function(e){let{environment:t,spaceId:n,currentUserId:i,localKey:o}=e;await Z().transactionQueue.drain();const d=E().default.checkGate({gateName:"dont_load_users"}),[c,l]=await Promise.all([g().callApi({eventName:"getSubscriptionData",environment:t,data:{spaceId:n},headers:(0,s().Bb)({cellId:void 0,spaceId:n})}),d?Promise.resolve({type:"success",data:{users:[],joinedMemberIds:[],userSimilarity:{},shouldUseEdgeCache:!0},status:200}):g().callApi({eventName:"getVisibleUsers",environment:t,data:{spaceId:n,supportsEdgeCache:!0},headers:(0,s().Bb)({spaceId:n})})]),u=E().default.checkGate({gateName:"users_edge_cache"});u&&x().Z.state.shouldUseEdgeCache&&await Y().x.resetData(t,{spaceId:n});if("success"===c.type&&"success"===l.type){var p;const e={...c.data,...l.data};x().Z.setState({shouldUseEdgeCache:x().Z.state.shouldUseEdgeCache&&u});try{r().Z.set({userId:i,key:o,value:e})}catch{a().log({level:"error",from:"subscriptionActions",type:"subscriptionDataTooLarge",data:{miscDataToConvertToString:{subscriptionDataJsonSize:JSON.stringify(e).length}}})}(null===(p=A().default.state.currentSpaceStore)||void 0===p?void 0:p.id)===n&&(ee().subscriptionDataStoreInstance.setState(e),ee().subscriptionDataStoreInstance.spaceId=n,L().O.setState(e.userSimilarity),G().YK(e)&&v().jw(t))}else a().log({level:"error",from:"subscriptionActions",type:"fetchSubscriptionDataFailed",data:{miscDataToConvertToString:{getSubscriptionDataResponseType:c.type,getSubscriptionDataResponseStatus:c.status,getVisibleUserResponseType:l.type,getVisibleUserResponseStatus:l.status}}});await Promise.all([N().Z.awaitData(t,{spaceId:n},!0),S().aiDependency.load().then((e=>{let{completionActions:a}=e;return a.maybeUpdateAiEligibility(t,n,!0)}))])}({environment:e,spaceId:n,currentUserId:i,localKey:t}),await M().Z.resetData(e,{spaceId:n}),await k().U.resetData(e,{spaceId:n}),await U().Z.resetData(e,{spaceId:n})}}function _e(e){var t;const n=null===(t=A().default.state.currentSpaceStore)||void 0===t?void 0:t.id;if(!n)throw new Error("No spaceId.");return V().Z.resetData(e,{spaceId:n})}async function Te(e,t){const n=A().default.state.currentSpaceStore;if(!n)return;const a=await g().callApi({eventName:"getBillingHistory",environment:e,data:{spaceId:n.id,limit:t.state.billingEventsLimit}});"success"===a.type&&t.update((e=>({...e,billingEvents:a.data.events})))}async function Ae(e,t){await De(t),await _e(t),X().Z.reset();const n=()=>{pe({oldTier:e.subscriptionTier??"free",newTier:"student",oldAddOns:[],newAddOns:[]})||y().PV({message:h().Z.formatMessage(le.educationPlusFree)}),F().default.setState({...F().default.state,currentTab:"billing",defaultSubtab:void 0});const n=G().XX(e);v().jh(t,{plan:"student_free",old_plan:n?n.plan:void 0})};await _().shouldCreatePassword(t)?D().E({environment:t,onSubmit:n,onCancel:n}):n()}function Ce(e,t){const{subscriptionTier:n,from:a,addOnFeature:r,coupon:s,isTrial:o,dismissMobilePlansModal:d,offer:c}=t,l=i().Il();v().Lc(e,{subscriptionTier:n,from:a,addOnFeature:r,currency_code:X().Z.state.selectedCurrencyCode,isTrial:o,modal_id:l}),B().Z.open({subscriptionTier:n,billingInterval:"month",addOnFeature:r,coupon:s,isTrial:o,sessionId:l,dismissMobilePlansModal:d,offer:c})}function Me(e){const t=B().Z.state;t.open&&(v().LY(e,{modal_id:t.sessionId}),B().Z.setState({open:!1}))}function xe(e){Q().default.open(e)}async function Ee(e){var t;const{environment:n,product:i,spaceStore:r,from:s,pageSection:d,churnState:p,billingData:v}=e,g=await $().aQ({environment:n,spaceId:r.id}),b=(null===(t=(0,o().a7)(null==v?void 0:v.subscription,"sites_custom_hostnames"))||void 0===t?void 0:t.quantity)??0,y=v.subscription;if(!(y&&(0,f().$K)(v.paymentMethod)||"free"===i))return void Ce(n,{subscriptionTier:i,from:s});const w=(0,o().Lg)(v),S=(0,o().YF)(y),I=(0,o().Tz)(w),h=(0,o().Tz)(y),D=I??h,_=(0,o().nW)({spaceId:r.id,logFunction:a().log.bind(a()),subscriptionState:w}),T=(0,o().nW)({spaceId:r.id,logFunction:a().log.bind(a()),subscriptionState:y}),A=_??T;let C;if("free"===i)C=(0,c().t4)(w,"plan");else{if(!(S&&D&&A))throw new Error("Trying to update plan on a subscription with no items");{const e={product:i,currency:S,interval:D};C=(0,c().dP)((0,u().Vj)({prices:g,quantity:A,domainsQuantity:b}),w,e)}}if(!m().Xy(w,C)){if((0,c()._D)(w,C)){if("no_churn"===p||!p)return;if((0,l().s6)(O().Z.getData(n,{spaceId:null==r?void 0:r.id}))&&(0,l().CF)("resurrection_offer",J().zt(),h)){if(!(await(0,R().D)(n)))return}return 0===C.items.length?await we({environment:n,spaceStore:r,from:s,cancelImmediately:"churn_immediately"===p}):await ue({environment:n,spaceStore:r,desiredState:C,from:s})}(0,K().m)(n,{desiredProducts:[i],analyticsArgs:{from:s,pageSection:d}})}}async function Ue(e){w().j({message:le.finishingUp});const{paymentIntentData:t,stripe:n,onSuccess:a,onFailure:i}=e,r=t.paymentIntentClientSecret;let s=t.paymentIntentStatus;r&&"requires_action"===s&&(s=await Pe({stripe:n,clientSecret:r})),"succeeded"===s||"processing"===s?null==a||a():function(e){let{status:t}=e;return["requires_payment_method","requires_source"].includes(t)}({status:s})&&(null==i||i()),w().x()}async function Pe(e){let{stripe:t,clientSecret:n}=e;const{paymentIntent:a,setupIntent:i,error:r}=await t.handleNextAction({clientSecret:n});if(a)return a.status;if(i)return i.status;if(r.payment_intent)return r.payment_intent.status;if(r.setup_intent)return r.setup_intent.status;throw new Error(`Unexpected error handling intent: ${r.message}`)}async function Ze(e){const{environment:t,data:n}=e;await g().callApi({eventName:"applyStudentGitHubGrant",environment:t,data:n})}},939985:(e,t,n)=>{n.d(t,{D:()=>g});n(667294);var a=()=>n(824462),i=()=>n(771474),r=()=>n(631842),s=()=>n(594546),o=()=>n(876822),d=()=>n(605716),c=()=>n(788860),l=()=>n(830581),u=()=>n(765513),p=()=>n(148126),m=n(785893);function f(e){let{onAccept:t}=e;return(0,m.jsx)(l().sR,{header:(0,m.jsx)(l().vI,{iconAndTitle:(0,m.jsx)(l().kC,{iconGroup:d().h,iconColorName:"uiRedPrimary",title:(0,m.jsx)(c()._H,{id:"voidOfferModal.title",defaultMessage:"Are you sure?"})}),description:(0,m.jsx)(c()._H,{id:"voidOfferModal.subtitle",defaultMessage:"If you continue, your current discount will no longer be applied. See <terms>terms and conditions</terms> for more information.",values:{terms:e=>(0,m.jsx)(u().Z,{external:!0,href:(0,p().UY)("resurrectionLearnMore"),children:e})}})}),footer:(0,m.jsx)(l().a6,{layout:"vertical",primaryButtons:[{buttonType:"destructive",label:(0,m.jsx)(c()._H,{id:"voidOfferModal.primaryAction",defaultMessage:"Yes and remove discount"}),onClick:t}],secondaryButtons:[{buttonType:"dismiss",label:(0,m.jsx)(c()._H,{id:"voidOfferModal.cancelButton",defaultMessage:"Cancel"})}]})})}const v=406;async function g(e){var t;const n=null===(t=o().default.state.currentSpaceStore)||void 0===t?void 0:t.id;return await r().o.showAsyncModal((t=>(0,m.jsx)(i().c,{isOpen:t.isOpen,onDismiss:()=>{(0,s().j)({environment:e,event:{eventName:"void_offer_modal_dismiss",eventProperties:{}}}),t.onDismiss()},onClosed:t.onClosed,areaConstraint:{width:{type:"min",length:v},height:{type:"unlimited",scroll:"allow"}},render:()=>(0,m.jsx)(f,{onAccept:async()=>{(0,s().j)({environment:e,event:{eventName:"void_offer_modal_accept",eventProperties:{}}}),n&&await a().callApi({eventName:"voidCustomerOffer",environment:e,data:{spaceId:n}}),t.resolve("accepted")}})})))}},745181:(e,t,n)=>{n.d(t,{Z:()=>i});n(267602),n(470928);class a extends(()=>n(263184))().default{getInitialState(){return{open:!1}}close(){this.state.open&&this.setState({open:!1})}open(e){let{oldTier:t,newTier:a,oldAddOns:i,newAddOns:r}=e;if(function(e){if(!e)return!1;return["plus","enterprise","business","student"].includes(e)}(a)){if(function(e,t){if(!e||!t)return!1;return"upgrade"===(0,n(122792).NY)({oldTier:e,newTier:t})}(t,a))return this.setState({productUpgrade:a,open:!0}),!0}if(r.length>i.length){const e=r.find((e=>!i.includes(e)));if(function(e){if(!e)return!1;return["ai"].includes(e)}(e))return this.setState({productUpgrade:e,open:!0}),!0}return!1}}const i=new a},976102:(e,t,n)=>{n.d(t,{AI:()=>c,Zl:()=>o,_D:()=>s,dK:()=>u,dP:()=>l,pc:()=>p,t4:()=>d});n(821057),n(267602),n(653476),n(470928),n(241792),n(228244);var a=()=>n(326966),i=()=>n(629719),r=()=>n(122792);function s(e,t){return u(e.items,t.items).some((e=>{let[t,n]=e;return function(e,t){if(!e)return!1;if(!t)return!0;const n=i().H6(e),a=i().H6(t);if(!n||!a)return!1;return r().rC[n]>r().rC[a]}(t,n)}))}function o(e,t,n){let{trialEnd:a,items:i}=t;const r=i.map((t=>{const a=t.price.product,i=t.price.unitAmount.currencyCode,r=function(e,t){let{interval:n,product:a,currency:i}=t;const r=e.find((e=>e.product===a&&e.billingInterval===n&&e.unitAmount.currencyValue.currencyCode===i));return m(r,`Unable to find price with interval: ${n}, product: ${a}, currency: ${i}`)}(e,{interval:n,product:a,currency:i});return{...t,price:r}}));return{trialEnd:a,items:r}}function d(e,t){const n=e.items.filter((e=>i().tw(e)!==t));return{...e,items:n}}function c(e,t){const n=e.items.filter((e=>i().tw(e)!==i().tw(t)));return{...e,items:n.concat([t])}}function l(e,t,n){const{product:a,interval:r,currency:s}=n,o=function(e){if("personal_free"===e||"team_free"===e)return"free";return e}(a),d=t.items.filter((e=>i().tw(e)!==i().h_(o))),c=function(e,t){let{interval:n,product:a,currency:i}=t;const r=e.find((e=>e.price.product===a&&e.price.billingInterval===n&&e.price.unitAmount.currencyValue.currencyCode===i));return m(r,`Unable to find price with interval: ${n}, product: ${a}, currency: ${i}`)}(e,{interval:r,product:o,currency:s});return{...t,items:d.concat([c])}}function u(e,t){return(0,a().UV)(e,(e=>i().tw(e)),t,(e=>i().tw(e)))}function p(e){const{prices:t,billingData:n,product:a}=e,r=i().YF(n.subscription),s=i().Lg(n),o=i().Tz(s),d=i().Tz(n.subscription),c=o??d;return t.find((e=>e.product===a&&e.billingInterval===c&&e.unitAmount.currencyValue.currencyCode===r))}function m(e,t){if(null==e)throw new Error(t);return e}}}]);