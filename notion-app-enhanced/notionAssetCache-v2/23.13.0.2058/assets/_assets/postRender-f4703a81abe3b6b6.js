"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[58586,52194,82472,8564],{116926:(e,t,n)=>{n.d(t,{Oq:()=>S,t0:()=>y});n(670560),n(667294);var o=()=>n(269299),i=()=>n(388284),a=()=>n(421797),r=()=>n(345918),s=()=>n(793935),l=()=>n(876822),d=()=>n(20919),c=()=>n(182008),u=()=>n(717538),m=()=>n(313351),p=()=>n(222670),g=n(785893);const f=(0,n(788860).vU)({unpinName:{id:"action.unpin.name",defaultMessage:"Remove from sidebar"},leaveName:{id:"action.leave.name",defaultMessage:"Leave"},duplicateToName:{id:"action.duplicateTo.name",defaultMessage:"Duplicate to"},editFormName:{id:"action.editForm.name",defaultMessage:"Edit form"}}),h=(0,m().cN)({key:"remove pinned shared page",displayName:f.unpinName,analyticsName:f.unpinName.defaultMessage,svg:n(233687).A,validators:[a().cWe,a().uqO,a().ffD(a().zME)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:i}=e;const{currentSpaceViewStore:a,currentUserSettingsStore:r}=l().default.state;a&&r&&(o().createAndCommit({userAction:"actionRegistry.removePinnedSharedPage",environment:i,canUndo:!0,perform:e=>{for(const n of t)s().unpinSharedPage({environment:i,transaction:e,spaceViewStore:a,userSettingsStore:r,store:n})}}),n(381140).An(i,{type:"shared",from:"sidebar_dropdown_menu"}))}}),v=(0,m().cN)({key:"edit form",displayName:f.editFormName,analyticsName:f.editFormName.defaultMessage,svg:n(519454).R,validators:[a().jBR,a().WWj],closeParentMenu:!0,action:e=>{let{blocks:t,environment:o}=e;const i=t[0],a=i.getFormBlockParentBlockStore();var r;a&&n(47443)._c({environment:o,store:a,collectionViewId:null===(r=i.getParentStore())||void 0===r?void 0:r.id,pageVisitSource:n(506347).tY.FormInternalPage})}}),y=(0,m().cN)({key:"delete block without shortcuts",displayName:m().RE.moveToTrashName,analyticsName:m().RE.moveToTrashName.defaultMessage,svg:n(434383).y,isRed:!0,validators:[a().or([a().DFt,a().STD,a().SYI]),a().eot,a().ffD(a().sRS),a().ffD(a().P99(n(156642).Ti.externalObjectInstancePage)),a().ffD(a().Q_M),a().vdd,a().ffD(a().uY7),a().ffD(a().NB0)],closeParentMenu:!0,action:async e=>{let{blocks:t,environment:o}=e;await n(453999).Qw({environment:o,blocks:t,shouldCheckSuggestEdit:!1})}}),b=(0,m().cN)({key:"leave shared page",displayName:f.leaveName,analyticsName:f.leaveName.defaultMessage,svg:n(313084).S,validators:[a().cWe,a().zl0],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;o().createAndCommit({userAction:"actionRegistry.leaveSharedPage",environment:n,canUndo:!0,perform:e=>{s().leaveBlocks({environment:n,blocks:t,transaction:e})}})}}),x=(0,m().MV)({key:"duplicate to workspace",displayName:f.duplicateToName,analyticsName:f.duplicateToName.defaultMessage,svg:n(44037).a,validators:[a().DFt,a().nJQ,a().zzA,a().ffD(a().KEd),a().Jlb],subActions:e=>{let{blocks:t,environment:o}=e;const{currentUserRootStore:a}=l().default.state;if(!a)return[];const s=t[0],d=n(718959).o(a),c=[];for(const i of d){const e=i.getSpaceStore();if(e){const t=(0,r().rn)(o,e),a=(0,r().Wd)(o,e);c.push({key:i.id,displayName:t||"",analyticsName:"Duplicate to workspace",searchName:t||"",closeParentMenu:!0,action:async()=>{await n(291338).DK({environment:o,store:s,spaceStore:e,spaceViewStore:i,isPrivate:!0,context:"duplicate_to_another_space"})},render:(e,o)=>{let{environment:i}=o;return(0,g.jsx)(n(827973).Z,{title:t,icon:(0,g.jsx)(n(943620).Z,{icon:a,isEmptyPage:!1,title:t,size:i.device.isMobile?24:20,disabled:!0}),...e})}})}}return[(0,m().$J)({key:"duplicate-to",render:e=>(0,g.jsx)(i().Z,{...e}),actions:c})]}}),S=[(0,n(58991).KE)({shouldRenderMobileRefresh:!1}),{key:"outliner organization actions",render:e=>(0,g.jsx)(i().Z,{...e}),actions:[d()._p,d().zm,h,b]},{key:"outliner available offline action",render:e=>(0,g.jsx)(i().Z,{...e}),actions:[n(929626).n]},{key:"outliner primary actions",render:e=>(0,g.jsx)(i().Z,{...e}),actions:[c().Hs,c().Kk,d().Dw,d().IK,u().o1,u().vh,u().fI,u().MI,x,v,n(63684).$,n(609967).A,y]},{key:"turn page into",render:e=>(0,g.jsx)(i().Z,{...e}),actions:[p().NO,p().LM,p().BW]},{key:"outliner navigation",render:e=>(0,g.jsx)(i().Z,{...e}),actions:n(998244).ej}]},222670:(e,t,n)=>{n.d(t,{NO:()=>j,LM:()=>w,BW:()=>T,bV:()=>_,R$:()=>P});n(667294);var o=()=>n(585402),i=()=>n(955620),a=()=>n(788860),r=()=>n(269299),s=()=>n(626788),l=()=>n(846550),d=()=>n(164079),c=()=>n(998901),u=()=>n(855238),m=()=>n(663631),p=()=>n(654133),g=n(785893);function f(e){let{menuListItemProps:t,title:n,caption:o,icon:i,disabled:a,tooltipText:r,showNewBadge:s}=e;const f=(0,l().yK)((()=>({menuItem:{WebkitBackfaceVisibility:"hidden"},caption:{whiteSpace:"pre-wrap"}})),[]);return(0,g.jsx)(p().Z,{placement:c().Placement.Right,disableTooltip:!r,renderTooltip:()=>r,render:e=>(0,g.jsx)(u().Z,{...(0,d().Z)(t,e),style:f.menuItem,title:n,caption:o,captionStyle:o?f.caption:void 0,svg:i,disabled:a,disabledFeedback:a,right:s&&(0,g.jsx)(m().Z,{})})})}var h=()=>n(421797),v=()=>n(91502),y=()=>n(697623),b=()=>n(313351),x=()=>n(790082);const S=(0,a().vU)({createTeamFromPageFullName:{id:"action.createTeamFromPage.fullName",defaultMessage:"Turn into teamspace"},createTeamFromPageCaption:{id:"action.createTeamFromPage.caption",defaultMessage:"Space for your team to customize permissions and collaborate"},createTeamFromPageName:{id:"action.createTeamFromPage.name",defaultMessage:"Teamspace"},turnPageIntoWikiCaption:{id:"action.turnPageIntoWiki.caption",defaultMessage:"Organize by owner, tags, verification, and more"},turnPageIntoWikiName:{id:"action.turnPageIntoWiki.name",defaultMessage:"Wiki"},undoTurnPageIntoWikiName:{id:"action.undoTurnPageIntoWiki.name",defaultMessage:"Undo wiki"},turnPageIntoWikiFullName:{id:"action.turnPageIntoWiki.fullName",defaultMessage:"Turn into wiki"}});function M(e,t){return(0,b().cN)({key:"turn page into team",displayName:t,analyticsName:S.createTeamFromPageFullName.defaultMessage,svg:o().g,validators:e,closeParentMenu:!0,render:(e,o)=>{const r=function(e){const{blockStore:t,environment:n}=e;if(!n.currentUser.id)return null;if(0===i().QaF(t.getTitleValue()).length)return(0,g.jsx)(a()._H,{defaultMessage:"Cannot turn page without a title into a Teamspace",id:"sidebar.turnPageIntoTeamButton.missingTitleDisabledTooltip"});if("private"===(0,v().Pr)(t).accessLevel&&!(0,y().Rs)())return(0,g.jsx)(a()._H,{defaultMessage:"Only Business Plans and above can turn a private page into a Teamspace",id:"sidebar.turnPageIntoTeamButton.privateTeamsOnlyOnBusinessPlansAndAboveDisabledTooltip"});return null}({environment:o.environment,blockStore:o.blocks[0]});return(0,g.jsx)(f,{menuListItemProps:e,title:(0,g.jsx)(a()._H,{...t}),caption:(0,g.jsx)(a()._H,{...S.createTeamFromPageCaption}),disabled:Boolean(r),tooltipText:r,icon:n(757665).K})},action:e=>{let{blocks:t,environment:o}=e;const i=t[0];n(174896).VG({environment:o,page:i})}})}const w=M([h().xDy([h().jp9,h().ffD(h().KSG)])],S.createTeamFromPageFullName),C=M([h().jp9],S.createTeamFromPageName),j=(0,b().MV)({key:"turn into teamspace or wiki",displayName:x().sY.turnIntoSection,analyticsName:x().sY.turnIntoSection.defaultMessage,svg:o().g,validators:[h().jp9,h().KSG],subActions:()=>[(0,b().$J)({key:"turn into teamspace or wiki",render:e=>(0,g.jsx)(n(388284).Z,{...e}),actions:[C,I]})],width:300});function k(e,t){return(0,b().cN)({key:"turn page into wiki",displayName:t,analyticsName:S.turnPageIntoWikiFullName.defaultMessage,svg:o().g,validators:e,closeParentMenu:!0,action:e=>{let{environment:t,blocks:o}=e;"bottom_right"===n(749826).default.getEligibleGroup({experimentId:"wiki_education_convert_modal",defaultGroup:"control"})?n(570065).E.setState({showConvertTooltip:!1,forceShow:!0,pendingWikiBlockStore:o[0]}):r().createAndCommit({userAction:"actionRegistry.turnIntoAction.wiki",environment:t,canUndo:!0,perform:e=>{s().Y({environment:t,blocks:o,transaction:e,source:"page_menu"})}})},render:e=>(0,g.jsx)(f,{menuListItemProps:e,title:(0,g.jsx)(a()._H,{...t}),disabled:!1,icon:o().g,tooltipText:(0,g.jsx)(a()._H,{...S.turnPageIntoWikiCaption})})})}const T=k([h().xDy([h().KSG,h().ffD(h().jp9)]),h().ffD(h().uY7)],S.turnPageIntoWikiFullName),I=k([h().KSG],S.turnPageIntoWikiName);const _=k([h().KSG,h().ffD(h().uY7)],S.turnPageIntoWikiFullName),P=(0,b().cN)({key:"undo turn page into wiki",displayName:S.undoTurnPageIntoWikiName,analyticsName:S.undoTurnPageIntoWikiName.defaultMessage,svg:n(363728).S,validators:[h().U7o,h().U_8,h().ffD(h().p1d),h().f7f,h().zzA,h().ffD(h().uY7)],closeParentMenu:!0,action:async e=>{let{environment:t,blocks:o}=e;const{accept:l}=await n(308186).gt({message:(0,g.jsx)("div",{style:{textAlign:"center"},children:(0,g.jsx)(a()._H,{defaultMessage:'Turn "{pageName}" back into a normal page?',id:"action.undoTurnIntoWiki.message",values:{pageName:i().QaF(o[0].getTitleValue())}})}),description:(0,g.jsx)("div",{style:{textAlign:"center"},children:(0,g.jsx)(a()._H,{defaultMessage:"This will remove properties like owners and verification from your pages",id:"action.undoTurnIntoWiki.description"})})});l&&r().createAndCommit({userAction:"actionRegistry.undoTurnIntoAction.wiki",environment:t,canUndo:!0,perform:e=>{s().Cq({environment:t,blocks:o,transaction:e,source:"page_menu"})}})}})},152862:(e,t,n)=>{n.d(t,{Y:()=>a,h:()=>i});var o=()=>n(594546);function i(e){o().K4(e,"view_public_site_click")}function a(e,t){o().K4(e,"share_menu_tab_click",t)}},942834:(e,t,n)=>{n.d(t,{k:()=>s});var o=()=>n(431143),i=()=>n(253502),a=()=>n(636340),r=()=>n(269299);function s(e){const{environment:t,key:n,selectedKey:s,following:l,followSettings:d,navigableBlockId:c,userId:u,spaceId:m,from:p}=e;r().createAndCommit({userAction:"UpdateSidebarFollowControl.setFollowing",environment:e.environment,canUndo:!1,perform:t=>{a().Ue({environment:e.environment,table:o().t0,args:{following:l,followSettings:d,navigableBlockId:c,userId:u,spaceId:m},inMemoryRecordCache:e.environment.defaultRecordCache.inMemoryRecordCache,transaction:t})}}),l?i().RJ(t,{from:"page_updates"}):i().ub(t,{from:"page_updates"}),s!==n&&i().kL(t,{from:p,navigableBlockId:c,oldSetting:s,newSetting:n})}},518370:(e,t,n)=>{n.d(t,{b:()=>i,x:()=>a});var o=()=>n(175928);function i(){o().k.setState({isOpen:!0})}function a(){o().k.setState({isOpen:!1})}},405129:(e,t,n)=>{n.d(t,{l1:()=>a,pj:()=>i().pj,q$:()=>r});var o=()=>n(201023),i=()=>n(155056);function a(){o().default.setState({open:!0,submitted:!1,error:void 0})}function r(){o().default.setState({open:!1})}},932005:(e,t,n)=>{n.d(t,{zb:()=>g,U4:()=>m,FF:()=>u,jN:()=>c,xx:()=>f,gs:()=>p});var o=()=>n(81954);const i=(0,n(830742).LS)("restoreSnapshot");var a=()=>n(727475),r=()=>n(491927),s=()=>n(782646),l=()=>n(528918);const d=(0,n(788860).vU)({restoringPreviousVersion:{id:"historyModalActions.restoringPreviousVersion.loadingMessage",defaultMessage:"Restoring…"}});function c(e){const{environment:t,from:n,...o}=e;r().y(t,n),a().Z.setState({...o,open:!0,size:50})}function u(){const e=a().Z.state;e.open&&a().Z.setState({...e,size:e.size+20})}function m(){a().Z.setState({open:!1})}function p(e){const{environment:t,snapshot:n,nextFutureSnapshot:o}=e;r().qD(t,n);const i=a().Z.state;i.open&&a().Z.setState({...i,snapshot:n,nextFutureSnapshot:o,openSnapshotNearTimestamp:void 0})}function g(){const e=a().Z.state;e.open&&a().Z.setState({...e,snapshot:void 0,nextFutureSnapshot:void 0})}async function f(e,t){if(!a().Z.state.open||!a().Z.state.snapshot)return;if(!a().Z.state.snapshot)return;r().R9(e,a().Z.state.snapshot),l().j({message:d.restoringPreviousVersion});const n=await s().Lj(e,i,{block:{id:a().Z.state.blockStore.id,spaceId:(0,o().J)(a().Z.state.blockStore.pointer.spaceId)},timestamp:a().Z.state.snapshot.timestamp,shouldRestoreCollection:t??!1}).next();if(l().x(),n.value.error)throw n.value.error}},136343:(e,t,n)=>{n.d(t,{O:()=>G});var o=()=>n(146947),i=()=>n(743359),a=()=>n(321160),r=()=>n(728670),s=()=>n(955620),l=()=>n(661727),d=()=>n(513670),c=()=>n(707513),u=()=>n(205228),m=()=>n(527278),p=()=>n(239482),g=()=>n(436094),f=()=>n(95718),h=()=>n(421654),v=()=>n(269299),y=()=>n(109757);const b=630,x=1200,S=(0,n(568017).gh)({theme:"light"}),M=240,w="white",C=200,j=96,k=150,T=184,I=100,_=145,P=23,Z=347,A=24,R=100,B=100,L=100,D="black",V=96,O=68,U=S.text.tertiary,N=40,F=(0,n(788860).vU)({builtWithNotion:{id:"socialMediaPreview.madeWithNotion",defaultMessage:"Made with Notion"}}),H='"Apple Color Emoji","Segoe UI Emoji",NotoColorEmoji,"Noto Color Emoji","Segoe UI Symbol","Android Emoji",EmojiSymbols';function K(e){return new Promise(((t,n)=>{const o=new Image;o.onload=()=>t(o),o.onerror=n,o.crossOrigin="anonymous",o.src=e}))}function E(e,t){return`${c().Ue.bold} ${t}px ${c().pe({pageFont:e,locale:o().locale})}`}function W(e){const t=c().Ue.medium,n=c().pe({pageFont:e,locale:o().locale});return`${t} ${N}px ${n}`}function z(e){let{context:t,text:n,font:o,color:i,x:a,y:r}=e;t.font=o,t.textAlign="left",t.textBaseline="top",t.fillStyle=i,t.fillText(n,a,r)}async function G(e){var t;let{store:n,environment:o}=e;if(n.pathIsDead()||!(0,r().$t)(p().fJ(n))||(0,f().Eo)(n)||n.inMemoryRecordCache.recordHasOverride({pointer:n.pointer,userId:o.currentUser.id}))return;const c=s().QaF(n.getTitleValue())||"",N=null===(t=n.getIcon())||void 0===t?void 0:t.icon,G=function(e,t){var n;const o=null===(n=t.getCover())||void 0===n?void 0:n.cover;if(o)return i().EK({url:o,width:x,permissionRecord:t.pointer,stripGoogleIconQuery:!0,baseUrl:u().default.domainBaseUrl,fullyQualified:!1,userId:e.currentUser.id})}(o,n),q=n.getFormat(),Y=new OffscreenCanvas(x,b),$=Y.getContext("2d"),[J,Q]=function(e,t){const n=document.createElement("div");n.style.width="auto",n.style.position="absolute",n.style.whiteSpace="nowrap",n.style.font=E(t,V),n.style.top="110vh",n.innerText=e;const o=x-R-B,i=document.body;if(i.appendChild(n),n.clientWidth<o)return i.removeChild(n),[e,V];if(n.style.font=E(t,O),n.clientWidth<o)return i.removeChild(n),[e,O];let a=e;for(;n.clientWidth>o;)a=a.substring(0,a.length-1),n.innerText=`${a}…`;return i.removeChild(n),[`${a}…`,O]}(c,q.page_font),X=E(q.page_font,Q),ee=Z+(N?P:0),te=ee+A+Q;if($){!function(e){e.fillStyle=w,e.fillRect(0,0,x,b)}($),await async function(e){let{context:t,coverImageUrl:n,icon:o,coverPosition:i=.5}=e;if(n){const e=await K(n),o=e.width*(M/x),a=((0,d().hj)(i)?1-i:.5)*(e.height-o);t.drawImage(e,0,a,e.width,o,0,0,x,M)}else{const e=(0,g().O)({icon:o,theme:S}),n=e?(0,l().Fq)(e,.1):S.home.cards.coverPhoto.base;t.fillStyle=n,t.fillRect(0,0,x,M),t.fillStyle="rgb(0,0,0,1)"}}({context:$,coverImageUrl:G,icon:N,coverPosition:q.page_cover_position}),await async function(e){let{context:t,store:n,icon:o}=e;if(o)if((0,a().Z)(o))t.font=`${C}px ${H}`,t.textAlign="left",t.textBaseline="top",t.fillText(o,j,k);else{const e=i().EK({url:o,baseUrl:u().default.domainBaseUrl,fullyQualified:!0,permissionRecord:n.pointer,width:T,userId:void 0}),a=await K(e);t.drawImage(a,I,_,T,T)}}({context:$,store:n,icon:N}),z({context:$,text:J,font:X,color:D,x:R,y:ee}),z({context:$,text:m().Z.formatMessage(F.builtWithNotion),font:W(q.page_font),color:U,x:L,y:te});const e=await Y.convertToBlob();!function(e){let{store:t,file:n,environment:o}=e;y().cT({environment:o,file:n,bucket:"secure",record:t.pointer,onComplete:e=>{v().createAndCommit({userAction:"SocialMediaPreviewImageUploadStore.updateSocialMediaPreviewImage",environment:o,canUndo:!1,perform:n=>{h().eO({store:t,url:e,transaction:n})}})},retryWhenOffline:!0})}({store:n,environment:o,file:new File([e],"SocialMediaPreviewImage.png",{type:"image/png"})})}}},543573:(e,t,n)=>{n.d(t,{k2:()=>l,l6:()=>s,wk:()=>r});var o=()=>n(998411),i=()=>n(269299),a=()=>n(348141);function r(e){const{environment:t,userSettingsStore:n}=e,i=n.getSettings(),a=null==i?void 0:i.time_zone,r=(0,o().r)();a!==r&&s({environment:t,userSettingsStore:n,timeZone:r})}function s(e){const{environment:t,userSettingsStore:n,timeZone:o}=e;i().createAndCommit({userAction:"checkUserTimeZoneAction.updateTimeZone",environment:t,canUndo:!0,perform:e=>{a().d2({userSettingsStore:n,transaction:e,data:{time_zone:o}})},userId:n.id})}function l(e){const{environment:t,userSettingsStore:n,disableAutoSetTimezone:o}=e;i().createAndCommit({userAction:"checkUserTimeZoneAction.updateDisableAutoSetTimezone",environment:t,canUndo:!0,perform:e=>{a().d2({userSettingsStore:n,transaction:e,data:{disable_auto_set_timezone:o}})},userId:n.id})}},358122:(e,t,n)=>{n.d(t,{J:()=>r});var o=()=>n(142735),i=()=>n(18610),a=()=>n(876822);function r(){return(0,o().VK)((()=>{var e;const t=(null===(e=a().default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.preferred_locale)??i().al;return(0,i()._u)(t)}),[])}},234478:(e,t,n)=>{n.d(t,{w:()=>s});var o=()=>n(219727),i=()=>n(142735),a=()=>n(416403),r=()=>n(676922);function s(e){const t=function(e){const{pageStore:t,enabled:n,forceUpdate:a=!1}=e,s=(0,o().O7)();return(0,i().VK)((()=>n?r().HE({pageStore:t,environment:s,enabled:n,forceUpdate:a}):void 0),[t,s,n,a])}(e);if(!t||(0,a().O5)(t))return t}},259801:(e,t,n)=>{n.d(t,{N:()=>b,U:()=>y});n(821057);var o=()=>n(492788),i=()=>n(217465),a=()=>n(955620),r=()=>n(54512),s=()=>n(132156),l=()=>n(970105),d=()=>n(269299),c=()=>n(28063),u=()=>n(907005),m=()=>n(527278),p=()=>n(472753),g=()=>n(876822),f=()=>n(749826),h=()=>n(253225);const v=(0,n(788860).vU)({formDatabaseTitle:{id:"newBlock.databaseInline.formDatabaseTitle",defaultMessage:"New form"}});function y(e){var t,n,a;const{environment:d,store:m,viewType:v,transaction:y}=e,b=null===(t=m.getBlockTitleStore())||void 0===t?void 0:t.getValue();f().default.checkGate({gateName:"mobile_keep_template_gallery_open"})&&h().Z.state.open&&h().Z.setState({open:!1});const x=m.getSpaceId()??(null===(n=g().default.state.currentSpaceStore)||void 0===n?void 0:n.id)??(null===(a=g().default.state.mainEditorCurrentBlockStore)||void 0===a?void 0:a.getSpaceId()),S=x?d.idCreator.getSpaceIdCreatorSync(x):void 0;s().Z({environment:d,sourceBlockId:"root",targetBlockPointer:m.pointer,sourceBlockSubtree:(0,i().partialRecordMapToRecordMap)((0,u().GP)({isInline:!1,viewType:v})),targetRecordCache:m.inMemoryRecordCache,transaction:y,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,spaceIdCreator:S}),c().vs({environment:d,block:m,blockType:"collection_view_page",transaction:y}),b&&l().sO({environment:d,store:m.getBlockTitleStore(),value:b,transaction:y}),o().default.afterNextFlush((()=>{const e=p().R.findCollectionViewBlockFromStore(m);var t;e&&"handleCreated"in e&&(null===(t=e.handleCreated)||void 0===t||t.call(e))})),r().W(d,{from:"template_picker",type:"collection_view_page",creating_block_id:m.id,is_full_screen:!0,view_type:v})}async function b(e){var t,o,l;const{environment:p,store:f}=e,h=null===(t=f.getBlockTitleStore())||void 0===t?void 0:t.getValue(),{formsEditorDependency:y}=await Promise.resolve().then(n.bind(n,688725)),{formEditorActions:b}=await y.load(),x=f.getSpaceId()??(null===(o=g().default.state.currentSpaceStore)||void 0===o?void 0:o.id)??(null===(l=g().default.state.mainEditorCurrentBlockStore)||void 0===l?void 0:l.getSpaceId()),S=x?p.idCreator.getSpaceIdCreatorSync(x):void 0;d().createAndCommit({userAction:"HorizontalTemplatePicker.createForm",environment:p,canUndo:!0,perform:e=>{var t;s().Z({environment:p,sourceBlockId:"root",targetBlockPointer:f.pointer,sourceBlockSubtree:(0,i().partialRecordMapToRecordMap)((0,u().Xq)({isInline:!1,name:(0,a().PgY)(h)?(0,a().TPx)(m().Z.formatMessage(v.formDatabaseTitle)):h})),targetRecordCache:f.inMemoryRecordCache,transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,spaceIdCreator:S}),c().vs({environment:p,block:f,blockType:"collection_view_page",transaction:e});const n=f.getCollectionStore(),o=null==n||null===(t=n.getModel())||void 0===t?void 0:t.getNormalizedSchema(),l=f;if(!o)throw new Error("Schema not found");const d=b.createCollectionFormEditorView({environment:p,transaction:e,collectionViewBlockStore:l,schema:o,initializeWithAllDefaultQuestions:!0});b.createResponsesCollectionView({environment:p,transaction:e,collectionViewBlockStore:l,schema:o}),r().W(p,{from:"template_picker",type:"form",creating_block_id:f.pointer.id,form_id:null==d?void 0:d.formId,view_id:l.id})}})}},654493:(e,t,n)=>{n.d(t,{I:()=>r});var o=()=>n(527278);const i=(0,n(788860).vU)({table:{defaultMessage:"Table",id:"templatePickerHelpers.databaseTemplateNames.table"},board:{defaultMessage:"Board",id:"templatePickerHelpers.databaseTemplateNames.board"},list:{defaultMessage:"List",id:"templatePickerHelpers.databaseTemplateNames.list"},calendar:{defaultMessage:"Calendar",id:"templatePickerHelpers.databaseTemplateNames.calendar"},gallery:{defaultMessage:"Gallery",id:"templatePickerHelpers.databaseTemplateNames.gallery"},timeline:{defaultMessage:"Timeline",id:"templatePickerHelpers.databaseTemplateNames.timeline"},form:{defaultMessage:"Form",id:"templatePickerHelpers.databaseTemplateNames.form"},tableView:{defaultMessage:"Table view",id:"templatePickerHelpers.databaseTemplateNames.tableView"},boardView:{defaultMessage:"Board view",id:"templatePickerHelpers.databaseTemplateNames.boardView"},listView:{defaultMessage:"List view",id:"templatePickerHelpers.databaseTemplateNames.listView"},calendarView:{defaultMessage:"Calendar view",id:"templatePickerHelpers.databaseTemplateNames.calendarView"},galleryView:{defaultMessage:"Gallery view",id:"templatePickerHelpers.databaseTemplateNames.galleryView"},timelineView:{defaultMessage:"Timeline view",id:"templatePickerHelpers.databaseTemplateNames.timelineView"}});function a(e){const{environment:t,store:o,viewType:i}=e;n(269299).createAndCommit({userAction:"templatePickerHelpers.handleClickForViewType",environment:t,canUndo:!0,perform:e=>{(0,n(259801).U)({environment:t,store:o,viewType:i,transaction:e}),n(47443)._c({environment:t,store:o,pageVisitSource:n(506347).tY.LinkInPage});const a=o.getCollectionViewStores()[0];a&&(0,n(714966).u)(a.id,{viewType:i})}})}const r=[{name:o().Z.formatMessage(i.table),type:"table",iconFn:n(644602).t,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>a({environment:e,store:t,viewType:"table"})},{name:o().Z.formatMessage(i.board),type:"board",iconFn:n(5837).i,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>a({environment:e,store:t,viewType:"board"})},{name:o().Z.formatMessage(i.list),type:"list",iconFn:n(150345).O,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>a({environment:e,store:t,viewType:"list"})},{name:o().Z.formatMessage(i.timeline),type:"timeline",iconFn:n(161906)._,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>a({environment:e,store:t,viewType:"timeline"})},{name:o().Z.formatMessage(i.calendar),type:"calendar",iconFn:n(866417).N,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>a({environment:e,store:t,viewType:"calendar"})},{name:o().Z.formatMessage(i.gallery),type:"gallery",iconFn:n(770019).n,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>a({environment:e,store:t,viewType:"gallery"})}]},552009:(e,t,n)=>{n.d(t,{n:()=>a});var o=()=>n(275200),i=()=>n(472753);function a(e){const{collectionContextStore:t}=e,n=t.collectionViewBlockStore();if(n){const e=i().R.findCollectionViewBlockFromStore(n);if(e){const t=e.getNode();t&&(0,o().Wr)(t,{edgeDist:0,animate:!1})}}}},138555:(e,t,n)=>{n.d(t,{_:()=>s,mN:()=>r,vE:()=>a});var o=()=>n(677559);const i={CollectionNewViewsPopupComponent:new(o().Ss)("CollectionNewViewsPopupComponent",(async()=>await Promise.all([n.e(62743),n.e(84885),n.e(90698),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(63707),n.e(92329),n.e(66123),n.e(59822)]).then(n.bind(n,368199)))),CollectionLinkExistingModal:new(o().Ss)("CollectionLinkExistingModal",(async()=>await Promise.all([n.e(62743),n.e(84885),n.e(90698),n.e(90424),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(7678),n.e(5006),n.e(18162),n.e(91752),n.e(80730),n.e(62084),n.e(66463),n.e(9587)]).then(n.bind(n,10053)))),ModalOverlayCollectionView:new(o().Ss)("ModalOverlayCollectionView",(async()=>await n.e(41926).then(n.bind(n,366005))))},a=(0,o().kF)(i.CollectionNewViewsPopupComponent,(e=>e.CollectionNewViewsPopupComponent)),r=(0,o().kF)(i.CollectionLinkExistingModal,(e=>e.CollectionLinkExistingModal)),s=(0,o().kF)(i.ModalOverlayCollectionView,(e=>e.ModalOverlayCollectionView))},281063:(e,t,n)=>{n.d(t,{Z:()=>_});var o=n(667294),i=()=>n(98642),a=()=>n(142735),r=()=>n(846550),s=()=>n(532850),l=()=>n(722917),d=()=>n(788860),c=()=>n(707513),u=()=>n(43360),m=()=>n(18748),p=()=>n(67961),g=()=>n(141735),f=()=>n(718959),h=()=>n(527278),v=()=>n(487073),y=()=>n(876822),b=()=>n(604068),x=()=>n(444851),S=()=>n(37272),M=()=>n(8208),w=()=>n(958783),C=()=>n(472675),j=()=>n(297490),k=()=>n(887328),T=()=>n(654953),I=n(785893);function _(e){const{environment:t,menuListItemProps:n,shouldShowTopDividerLine:_,shouldShowBottomDividerLine:P,shouldExpandDiscussionWidth:Z,noBackgroundColors:A,onMouseEnter:R,onMouseLeave:B,onFocus:L,onBlur:D}=e,V=(0,a().VK)((()=>y().default.state.mainEditorCurrentBlockStore),[]),O=(0,a().VK)((()=>(0,f().B7)(t)),[t]),U=x().IX,N=(0,a().VK)((()=>M().Z.state.isActivelyComposing),[]),F=(0,a().VK)((()=>M().Z.state.isHovered),[]),H=(0,o.useCallback)((()=>{null==R||R()}),[R]),K=(0,o.useCallback)((()=>{null==B||B()}),[B]),E=(0,o.useCallback)((()=>{null==L||L()}),[L]),W=(0,o.useCallback)((()=>{w().default.hasContent()?M().Z.resetAllActiveSources():(w().default.reset(),M().Z.reset()),null==D||D()}),[D]),z=(0,d().YB)(),G=(0,o.useRef)(null);(0,i().c)(v().Z,(()=>({getNode:()=>G.current})),[]);const q=(0,r().yK)((e=>({menuDiscussionItem:{marginLeft:-14,marginRight:-14,width:"calc(100% + 28px)"},discussionContainer:{paddingTop:t.device.isMobile?4:6,borderTop:!t.device.isMobile&&_?`1px solid ${e.regularDividerColor}`:void 0,borderBottom:!t.device.isMobile&&P?`1px solid ${e.regularDividerColor}`:void 0,transition:"background 300ms ease",background:A?void 0:N?e.focusDiscussionBackground:F?e.hoveredDiscussionBackground:void 0},comment:{position:"relative",fontSize:14},commentElementsBelowUserRow:{paddingLeft:x().yx},avatar:{marginTop:0,marginRight:8,userSelect:"none",WebkitUserSelect:"none"},userRow:{display:"flex",flexDirection:"row",alignItems:"center",userSelect:"none",WebkitUserSelect:"none"},placeholder:{height:8,width:81,borderRadius:6,background:e.lightDividerColor},attachIcon:{width:18,height:18,fill:e.mediumIconColor},text:{cursor:"text",lineHeight:"20px",paddingTop:4},attachmentContainer:{display:"flex",alignItems:"center"},draftLabel:{margin:"0 6px",flexBasis:140,whiteSpace:"normal",flexGrow:void 0,display:"inline",color:e.text.tertiary},commentAuthorPlaceholder:{marginRight:8,marginTop:2,height:U,width:U,borderRadius:20,flexShrink:0},container:{paddingTop:x().En,paddingRight:16,paddingBottom:x().rb,paddingLeft:16},noOverflow:{overflow:"hidden"},commentContext:{display:"flex",width:"100%",marginTop:6,marginBottom:22,fontSize:13,color:e.text.secondary},displayName:{fontWeight:c().Ue.medium,whiteSpace:"normal"},fullWidthFlex:{display:"flex",width:"100%"},smallTopPadding:{marginTop:1}})),[U,t.device.isMobile,F,N,A,P,_]),Y=(0,o.useCallback)((async()=>{const e=await g().F.formulas.load();b().Dc({environment:t,allowActionsWhileCommenting:!0,formulasModule:e})}),[t]),$=(0,a().VK)((()=>!w().default.state.open||"reaction"===w().default.state.content),[]),J=(0,a().VK)((()=>{var e;return w().default.getBlockStore()??(null===(e=w().default.getClosestBlockStore())||void 0===e?void 0:e.parentBlockStore)}),[]),Q=(0,a().VK)((()=>w().default.getPropertyId()),[]),X=(0,a().VK)((()=>{if(Q){var e;const t=null===(e=w().default.getBlockStore())||void 0===e?void 0:e.getAssociatedCollectionStore();if(!t||"collection"!==t.table)return;const n=t.getSchema();return(0,s().Qm)({schema:n,property:Q})}}),[Q]),ee=(0,a().VK)((()=>(0,l().Kc)(h().Z.getIntl()).title),[]),te=(0,a().VK)((()=>w().default.getDiscussionInputStore()),[]),ne=(0,a().VK)((()=>null==O?void 0:O.getDisplayName(z)),[O,z]),oe=(0,a().VK)((()=>null==J?void 0:J.getSpaceId()),[J]),ie=(0,a().VK)((()=>b().Qu({environment:t})),[t]),ae=(0,a().VK)((()=>w().default.getType()),[]),re=(0,a().VK)((()=>null==J?void 0:J.getValue()),[J]);if($||!ee||!O||!J||!V||!te||!oe||!re&&"block"===ae||!ie&&"inline"===ae)return null;const se="inline"===ae||Q,le="block"===ae&&!Q?(0,I.jsx)(u().ZP,{blockValue:re,rootStore:J,blockPreviewLocation:"comments_sidebar"}):se?(0,I.jsx)(u().KX,{value:{value:(null==ie?void 0:ie.context)??[],spaceId:oe},propertySchema:ee,labeled:!1,rootStore:J,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!0}):null;return(0,I.jsx)("div",{style:q.discussionContainer,ref:G,onClick:null==n?void 0:n.onClick,onMouseEnter:H,onMouseLeave:K,children:(0,I.jsx)(m().ZP,{allowTextSelection:!0,style:q.menuDiscussionItem,title:(0,I.jsx)("div",{style:q.container,children:(0,I.jsxs)("div",{style:q.comment,children:[(0,I.jsxs)("div",{style:q.userRow,children:[(0,I.jsx)(C().S,{authorStore:O,avatarSize:U,avatarStyle:q.avatar,placeholderStyle:q.commentAuthorPlaceholder}),(0,I.jsxs)("div",{style:q.noOverflow,children:[(0,I.jsx)("span",{style:q.displayName,children:ne||(0,I.jsx)("span",{style:q.placeholder})}),(0,I.jsx)(p().Z,{isSmall:!0,isSecondaryColor:!0,isMultiline:!0,style:q.draftLabel,children:(0,I.jsx)(d()._H,{defaultMessage:"Draft",id:"DraftCommentInputWithContext.draftLabel"})})]})]}),(0,I.jsxs)("div",{style:q.commentElementsBelowUserRow,children:[(0,I.jsx)("div",{style:q.commentContext,children:(0,I.jsxs)("div",{style:q.fullWidthFlex,children:[(0,I.jsx)(j().C,{}),X&&(0,I.jsx)(T().Z,{propertySchema:X}),(0,I.jsx)("div",{style:q.smallTopPadding,children:le})]})}),(0,I.jsx)(k().Z,{showAvatar:!1,parentStore:V,blockStore:J,onSubmit:Y,discussionInputStore:te,isNewComment:!0,isEditingExistingComment:!1,isMobileSlideUpMenu:!0,shouldSaveUnsentComments:!1,discussionFormat:S().DiscussionFormat.Sidebar,canDrop:!0,disableFocusRing:!0,adjustWidthForDraftDiscussions:Z,dontMoveCursorToInputEndOnFocus:!0,onBlur:W,onFocus:E},"draft-comment-sidebar")]})]})})})},"draft-comment-discussion-updates")}},685375:(e,t,n)=>{n.d(t,{Z:()=>M});n(267602),n(470928),n(228244);var o=n(667294),i=()=>n(219727),a=()=>n(523709),r=()=>n(491927),s=()=>n(959137),l=()=>n(964433),d=()=>n(542058),c=()=>n(141735),u=()=>n(267629),m=()=>n(465371),p=()=>n(677559),g=()=>n(32969),f=()=>n(340819),h=()=>n(749826),v=()=>n(475335),y=()=>n(645805),b=()=>n(965903),x=()=>n(65344),S=n(785893);function M(e){const t=(0,i().O7)(),{value:n}=(0,p().XJ)(l().p),{value:r}=(0,p().XJ)(d().m),{value:u}=(0,p().XJ)(c().F.formulas),{value:m}=(0,p().XJ)(s().F.clipboardActions),g=(0,o.useRef)(),f=(0,o.useRef)();(0,o.useEffect)((()=>{function e(e){e.clientX===g.current&&e.clientY===f.current||(g.current=e.clientX,f.current=e.clientY,v().default.setKeyboardMode(!1))}return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}}),[]);const h=(0,o.useMemo)((()=>function(e,t,n,o,i){const r={};for(const s of a().L6)for(const a of s.shortcuts)r[a]=r=>C(a,r,e,t,n,o,i);return r}(m,u,n,r,t)),[t,u,n,r,m]);return(0,S.jsx)(x().t,{debugName:e.debugName,priority:e.priority,enable:e.capture,shortcuts:h})}function w(){return!function(){const e=document.querySelector("#intercom-container");return!(!e||!e.contains(document.activeElement))}()&&!(f().Z.state.isActive&&!h().default.checkGate({gateName:"block_menu_shortcut_fix"}))}function C(e,t,n,o,i,s,l){if(!w())return;const d=b().default.state.stores,c=b().default.state.pivot||d[0],p=c&&g().C.getRectFromStore(c),x=a().L6.find((t=>!!t.shortcuts.some((t=>t===e))&&u().vG(t,{environment:l,blocks:d,originRect:p,publicEditMode:void 0})));if(x){"keydown"===t.type&&t.preventDefault&&t.preventDefault();const e=f().Z.state.isActive;x.action({environment:l,blocks:d,originRect:p,publicEditMode:void 0,lazyDependencies:{clipboardActions:n,formulasModule:o,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:s}},t);const a=d[0];let c,u,g,b;var S;if(a)c=a.getType(),u=c?(0,m()._A)(c,a.getFormat()):void 0,g=null===(S=a.getCollectionStore())||void 0===S?void 0:S.id,b=a.getParentCollectionIdUpToTwoLevels();r().dh(l,{analyticsName:x.analyticsName,action_type:x.analyticsActionType,from:"keyboard_shortcut",block_id:null==a?void 0:a.id,block_type:c,is_toggleable:u,collection_id:g,parent_collection_id:b}),M={resetBlockMenuStore:e},v().default.setKeyboardMode(!0),y().default.reset(),h().default.checkGate({gateName:"block_menu_shortcut_fix"})&&M.resetBlockMenuStore&&f().Z.reset()}var M}},496218:(e,t,n)=>{n.r(t),n.d(t,{AiAssistantIntroModal:()=>W,useSetLastExposedToQnaAtTimestamp:()=>te});n(241792);var o=n(667294),i=()=>n(219727),a=()=>n(732811),r=()=>n(142735),s=()=>n(846550),l=()=>n(605305),d=()=>n(667067),c=()=>n(788860),u=()=>n(696459),m=()=>n(707513),p=()=>n(894011),g=()=>n(636340),f=()=>n(901193),h=()=>n(497065),v=()=>n(269299),y=()=>n(343353),b=()=>n(236692),x=()=>n(789168),S=()=>n(551576),M=()=>n(941912),w=()=>n(124913),C=()=>n(559155);var j=()=>n(916095),k=()=>n(442531),T=()=>n(677559),I=()=>n(803728),_=()=>n(738740),P=()=>n(876822),Z=()=>n(524434),A=()=>n(212493),R=()=>n(779300),B=()=>n(729775),L=()=>n(961033),D=()=>n(67961),V=()=>n(765513),O=n(785893);const U=24,N=254,F=170,H=(0,c().vU)({shareDataTitle:{defaultMessage:"You’re in control of your data",id:"AiAssistantWelcomeModal.intro.titleShareData"},shareDataHeader:{defaultMessage:"By default, Notion does not train on your content",id:"AiAssistantWelcomeModal.intro.shareDataHeader"},shareDataDescription:{defaultMessage:"But, if you’d like to help improve our models and features, please opt-in below:",id:"AiAssistantWelcomeModal.intro.shareDataDescription"},welcomeTitle:{defaultMessage:"Meet the new Notion AI",id:"AiAssistantWelcomeModal.intro.title"},subtitle:{defaultMessage:"One AI tool that does it all. Search, generate, analyze, and chat—right inside Notion.",id:"AiAssistantWelcomeModal.intro.subtitle"},findInSlack:{defaultMessage:"Find in Slack",id:"AiAssistantIntroModal.findInSlack"},findInGoogleDrive:{defaultMessage:"Find in Google Drive",id:"AiAssistantIntroModal.findInGoogleDrive"},attachFile:{defaultMessage:"Analyze PDF",id:"AiAssistantIntroModal.attachPDF"}}),K=[{id:p().if.searchQnA.id,label:p().if.searchQnA,icon:n(989506).A,color:"blue"},{id:p().if.chatKeyPoints.id,label:p().if.chatKeyPoints,icon:n(150345).O,color:"green"},{id:p().if.brainstormIdeas.id,label:p().if.brainstormIdeas,icon:n(275141).b,color:"green"},{id:p().if.writeCode.id,label:p().if.writeCode,icon:n(660781).y,color:"green"},{id:p().if.draftDiagram.id,label:p().if.draftDiagram,icon:n(913549).x,color:"purple"},{id:"attachment",label:H.attachFile,icon:n(738017).s},{id:p().if.draftTable.id,label:p().if.draftTable,icon:n(644602).t,color:"purple"},{id:p().if.draftMeetingAgenda.id,label:p().if.draftMeetingAgenda,icon:n(519454).R,color:"purple"},{id:p().if.translate.id,label:p().if.translate,icon:n(825350).Q,color:"green"},{id:p().if.improveWriting.id,label:p().if.improveWriting,icon:n(567195).d,color:"purple"},{id:"findInGoogleDrive",label:H.findInGoogleDrive,icon:n(679950).c},{id:"findInSlack",label:H.findInSlack,icon:n(525372).P}],E=K.concat(K).concat(K);function W(){const e=(0,i().O7)(),t=(0,o.useCallback)((t=>{let{source:n}=t;const{currentUserSettingsStore:o}=P().default.state;o&&((0,b().trackAssistantIntroModalClose)(e,{source:n}),(0,y().setAssistantOnboardingPhase)(e,{phase:"tooltip",transactionUserAction:"AiAssistantIntroModal.dismissModal",userSettingsStore:o}),I().Gi(e,"ai_assistant_announcement"))}),[e]);return te(),(0,O.jsx)(_().k,{messageKey:"ai_assistant_announcement",desktopRenderInner:()=>(0,O.jsx)(J,{onDismiss:t}),phoneRenderInner:()=>null})}function z(){const e=G();return(0,O.jsxs)("div",{style:e.rowItemWrapper,children:[(0,O.jsx)("div",{style:e.rowItemIconWrapper,children:(0,d().Q)(e.rowItemIcon)}),(0,O.jsxs)("div",{style:e.textWrapper,children:[(0,O.jsx)("div",{style:e.sharedataTitle,children:(0,O.jsx)(c()._H,{...H.shareDataHeader})}),(0,O.jsx)(D().Z,{isSecondaryColor:!0,isSmall:!0,isMultiline:!0,children:(0,O.jsx)(c()._H,{...H.shareDataDescription})})]})]})}function G(){const e=ne();return(0,s().yK)((t=>({...e,rowItemWrapper:{display:"flex",alignItems:"start",marginBottom:12},rowItemIconWrapper:{color:t.accentColors.uiBlue[600],background:t.accentColors.uiBlue[100],display:"flex",alignItems:"center",justifyContent:"center",borderRadius:100,marginRight:8},rowItemIcon:{height:30,width:30,padding:8},sharedataTitle:{fontWeight:m().Ue.medium,fontSize:14,marginBottom:4},textWrapper:{display:"flex",flexDirection:"column",maxWidth:"100%"},icon:{width:16,height:16},sparklesIcon:{fill:t.accentColors.translucentGray[800],width:14},contentWrapper:{paddingLeft:24,paddingRight:26,width:424},assistantIntroHeaderWrapper:{height:200},title:{fontSize:25,fontWeight:700,paddingBottom:8},subtitle:{fontSize:m().JB.UIRegular.desktop,fontWeight:m().Ue.regular,color:t.text.secondary},body:{fontWeight:400,fontSize:14,color:t.text.secondary},faceImg:{pointerEvents:"none",width:72,height:72,boxShadow:t.shadowSM,borderRadius:100,flexGrow:0},imgWrap:{display:"flex",alignItems:"center",paddingTop:40,paddingBottom:30,paddingLeft:24},spacer:{marginTop:20,marginBottom:20},footer:{paddingTop:8,paddingBottom:24,marginTop:20},simpleFooter:{paddingBottom:24},helpTitle:{fontSize:14,fontWeight:600},consentButton:{fontWeight:600,height:"36px"},firstSelector:{fontWeight:400,border:"none"},lastSelector:{fontWeight:400,border:"none"},introAnimationWrapper:{height:294,overflowY:"hidden",maskImage:"linear-gradient(to bottom, rgba(0, 0, 0,0) 24px, rgba(0, 0, 0) 50%, rgba(0,0,0,0) 265px"},introAnimationWrapperLeapStep:{height:140,marginTop:8},faceWrapper:{alignContent:"center",paddingLeft:2},faceWrapperLeapStep:{height:"100%",alignContent:"center",paddingLeft:2,paddingTop:40,paddingBottom:30},skillListWrapper:{display:"flex",flexDirection:"column",gap:8,marginLeft:24,overflowY:"hidden"},pillWrapper:{display:"flex",alignItems:"center",padding:"8px 16px 8px 12px",borderRadius:100,width:"max-content",backgroundColor:t.tint.regular,color:t.text.primary,fontSize:14,fontWeight:m().Ue.medium,gap:8},blue:{color:t.accentColors.uiBlue[500]},green:{color:t.accentColors.green[500]},purple:{color:t.accentColors.purple[500]}})),[e])}function q(e){const{label:t,icon:n,color:o}=e,i=G(),a=o?i[o]:{},{value:r}=(0,T().XJ)(k().io);if(!r)return null;const{motion:s}=r;return(0,O.jsxs)(s.div,{style:i.pillWrapper,children:[n({...i.icon,...a}),(0,O.jsx)(c()._H,{...t})]})}function Y(e){const t=G(),{phase:n}=e,i="welcome"===n,a=function(){const e=(0,s().Fg)();return(0,o.useMemo)((()=>"dark"===e.mode?M():w()),[e])}(),{value:r}=(0,T().XJ)(k().io);if(!r)return null;const{motion:l}=r;return(0,O.jsx)("div",{style:i?t.introAnimationWrapper:t.introAnimationWrapperLeapStep,children:(0,O.jsxs)(A().jX,{gap:0,direction:"row",height:"fill",align:i?"center":"center-left",children:[(0,O.jsx)(l.div,{layoutId:"face",style:t.faceWrapper,children:(0,O.jsx)("img",{style:t.faceImg,src:a,alt:"Notion AI logo"})}),(0,O.jsx)(l.div,{initial:{y:45},animate:{y:-45*(K.length-1)},transition:{repeat:1/0,duration:22,ease:"linear"},style:{...t.skillListWrapper,opacity:i?1:0},children:E.map(((e,t)=>(0,O.jsx)(q,{label:e.label,icon:e.icon,color:e.color},e.id+t)))})]})})}function $(e){const{environment:t}=e,n=Z().KR.getNavigationTargetForTryAssistantNowButton();switch(n){case"fullPage":h().c4({environment:t,url:"/chat"});break;case"corner":(0,x().openAssistantRightHandSideMenu)({environment:t,from:"assistant_intro_modal"});break;case"writer":f().w({environment:t,prefill:void 0});break;default:(0,u().t1)(n)}}function J(e){const{onDismiss:t}=e,n=(0,i().O7)(),[a,s]=(0,o.useState)("welcome"),l=(0,r().VK)((()=>{const e=P().default.state.currentSpaceStore,t=P().default.state.currentSpaceViewStore;return!(!e||!t)&&function(e){var t;const{environment:n,assistantFeatureGateStore:o,currentSpaceViewStore:i,currentSpaceStore:a}=e;return!(!i||!a)&&!!a.canAdmin()&&!(0,C().$_)(n,a.id)&&!Boolean(null===(t=i.getSettings())||void 0===t?void 0:t.has_user_seen_leap_modal)&&!Boolean(a.getSettings().enable_ai_training)&&o.isWorkspaceLeapEligible()}({environment:n,assistantFeatureGateStore:Z().KR,currentSpaceStore:e,currentSpaceViewStore:t})}),[n]),d=(0,o.useCallback)((()=>{l?s("leap"):((0,b().trackAssistantIntroModalTryNow)(n,{}),t({source:"tryNow"}),$({environment:n}))}),[l,n,t]),u=(0,o.useCallback)((()=>{if(t({source:"closeButton"}),l){const e=P().default.state.currentSpaceViewStore;if(!e)return;v().createAndCommit({userAction:"AiAssistantIntroModal.updateLeapModalSeen",environment:n,canUndo:!0,perform:t=>{v().applyOperation({store:e,operation:{pointer:e.pointer,path:["settings"],command:"update",args:{...e.getSettings(),has_user_seen_leap_modal:!0}},transaction:t})}})}}),[t,l,n]),m=(0,o.useCallback)((()=>{S().assistantAnalyticsActions.trackLeapDismissed(n),u()}),[n,u]);(0,o.useEffect)((()=>{const e=Date.now();return()=>{const t=Date.now();(0,b().trackAssistantIntroModalRead)(n,{reading_time:t-e})}}),[]);const p=G(),g=(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(Y,{phase:"welcome"}),(0,O.jsx)("div",{style:p.title,children:(0,O.jsx)(c()._H,{...H.welcomeTitle})}),(0,O.jsx)("div",{style:p.subtitle,children:(0,O.jsx)(c()._H,{...H.subtitle})}),(0,O.jsxs)(A().jX,{align:"center",direction:"row",gap:"auto",style:p.footer,children:[(0,O.jsx)(ee,{}),(0,O.jsx)(A().jX,{align:"center-right",direction:"row",gap:12,width:"hug",children:(0,O.jsx)(R().h,{onClick:d,children:(0,O.jsx)(c()._H,{defaultMessage:"Try it",id:"AssistantIntroMessage.intro.signup.nextMessage"})})})]})]});return(0,O.jsxs)("div",{children:[(0,O.jsx)(j().U4,{onDismiss:u}),(0,O.jsx)(A().jX,{gap:0,children:(0,O.jsx)("div",{style:p.contentWrapper,children:"leap"===a?(0,O.jsx)(Q,{onDismiss:m}):g})})]})}function Q(e){const{onDismiss:t}=e,[n,r]=(0,o.useState)(),l=void 0===n,d=(0,i().O7)(),m=(0,o.useCallback)((e=>{r(e),S().assistantAnalyticsActions.trackLeapPreferenceSelect(d,{will_share:e})}),[d]),p=(0,o.useCallback)((e=>{const t=P().default.state.currentSpaceStore;t&&v().createAndCommit({userAction:"AiAssistantIntroModal.updateWorkspaceShouldTrain",environment:d,canUndo:!0,perform:n=>{g().sW({store:t,data:{settings:{...t.getSettings(),enable_ai_training:e}},transaction:n})}})}),[d]),f=(0,o.useCallback)((()=>{(0,u().$K)(n)&&(p(n),S().assistantAnalyticsActions.trackLeapSubmit(d,{will_share:n})),t(),$({environment:d})}),[d,t,n,p]);(0,a().K)((()=>{S().assistantAnalyticsActions.trackLeapPresented(d)}));const h=G(),y=(0,s().yK)((()=>({...h,skip:{fontSize:14,padding:"0px 12px",height:36,display:"flex",alignItems:"center",cursor:l?"default":"pointer",opacity:l?.4:1},titleLeap:{marginBottom:12}})),[l,h]);return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(Y,{phase:"leap"}),(0,O.jsx)("div",{style:{...y.title,...y.titleLeap},children:(0,O.jsx)(c()._H,{...H.shareDataTitle})}),(0,O.jsx)(z,{}),(0,O.jsxs)(A().jX,{direction:"column",children:[(0,O.jsx)(L().n,{style:y.firstSelector,label:(0,O.jsx)(c()._H,{defaultMessage:"Share data to help improve Notion AI",id:"AiAssistantWelcomeModal.admin.shareData"}),onChange:()=>{},isSelected:!0===n,onClick:()=>m(!0),value:"share_data",selectType:"radio"}),(0,O.jsx)(L().n,{style:y.lastSelector,label:(0,O.jsx)(c()._H,{defaultMessage:"Do not share data",id:"AiAssistantWelcomeModal.admin.doNotShareData"}),onChange:()=>{},selectType:"radio",isSelected:!1===n,onClick:()=>m(!1),value:"do_not_share_data"})]}),(0,O.jsxs)(A().jX,{align:"center",direction:"row",gap:"auto",style:y.footer,children:[(0,O.jsx)(X,{}),(0,O.jsx)(A().jX,{align:"center-right",direction:"row",gap:12,width:"hug",children:(0,O.jsx)(R().h,{onClick:f,disabled:l,children:(0,O.jsx)(c()._H,{defaultMessage:"Confirm",id:"AssistantIntroMessage.intro.signup.confirmMessage"})})})]})]})}function X(){const e=(0,s().Fg)(),t=(0,i().O7)(),n=(0,o.useCallback)((e=>{S().assistantAnalyticsActions.trackLeapLinkClick(t,{link:e})}),[t]);return(0,O.jsx)("div",{style:{color:e.mediumTextColor,fontSize:12,width:256},children:(0,O.jsx)("div",{children:(0,O.jsx)(c()._H,{defaultMessage:"If you choose to share data, you are agreeing to these <terms>Terms</terms>. <learnmore>Learn more</learnmore>",id:"AiAssistantIntroModal.AdminAgreeToTerms",values:{terms:e=>(0,O.jsx)(V().Z,{onClick:()=>n("terms"),external:!0,href:"https://www.notion.so/notion/Notion-AI-Learning-and-Early-Access-Program-Terms-0c55d702d0154a788d9e70c4ee396399",children:e}),learnmore:e=>(0,O.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:"2px"},children:[(0,O.jsx)(V().Z,{onClick:()=>n("faq"),external:!0,href:"https://www.notion.so/help/notion-ai-leap-program-faqs",children:e}),(0,l().K)({width:14,height:14})]})}})})})}function ee(){const e=ne(),t=(0,i().O7)(),n=(0,o.useCallback)((()=>{(0,b().trackLearnMoreAboutAssistantClicked)(t,{})}),[t]);return(0,O.jsx)("div",{style:e.learnMoreCopy,children:(0,O.jsxs)(B().Z,{onClick:n,style:e.learnMoreLink,innerStyle:e.learnMoreLinkInner,href:"https://www.notion.so/help/guides/everything-you-can-do-with-notion-ai",external:!0,children:[(0,O.jsx)(c()._H,{defaultMessage:"Learn more",id:"AiAssistantIntroModal.LearnMoreAboutAssistantButton"}),(0,l().K)({width:14,height:14,marginTop:2,marginLeft:4})]})})}function te(){const e=(0,o.useRef)(!1),t=(0,i().O7)();(0,r().VK)((()=>{const{currentUserSettingsStore:n}=P().default.state;if(!n||!n.isReady())return;if(!Z().KR.showRemindersToUseQnA())return;const o=n.getSettingsStore().getKeyStore("last_exposed_to_ai_qna_at").getValue();(0,u().$K)(o)||e.current||(e.current=!0,(0,y().setLastExposedToQnaAtToCurrentTimestamp)(t,{userSettingsStore:n}))}),[t])}function ne(){return(0,s().yK)((e=>({betaBadge:{borderRadius:4,display:"inline-block",fontSize:11,fontWeight:500,padding:"1px 4px"},importDisclaimerWrap:{marginTop:10,display:"flex",alignItems:"center",gap:2},clockIcon:{width:14,height:14,color:e.mediumTextColor},footer:{borderTop:`1px solid ${e.tableLightDividerColor}`},introCopyArea:{paddingLeft:U,paddingRight:U},introTitle:{fontWeight:m().Ue.bold,fontSize:25,display:"flex"},learnMoreCopy:{color:e.mediumTextColor,fontSize:12,textDecoration:"underline"},learnMoreLink:{width:"max-content",marginLeft:-4},learnMoreLinkInner:{display:"flex",alignItems:"center",paddingLeft:4,paddingRight:4},mainCopyText:{width:350},notionAiText:{marginTop:2,paddingLeft:4,color:e.accentColors.gray[900],fontWeight:m().Ue.medium},sparklesIcon:{width:14},stubPng:{width:"100%",height:N},smallVariantVideoStubPng:{width:"100%",height:F}})),[])}},676667:(e,t,n)=>{n.r(t),n.d(t,{AppComponents:()=>pu});var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(658325),s=()=>n(138555),l=()=>n(874018),d=()=>n(677559);const c=new(d().Ss)("desktop",(async()=>{const[{Notification:e},{default:t}]=await Promise.all([n.e(99380).then(n.bind(n,521477)),n.e(99380).then(n.bind(n,929586))]);return{Notification:e,ElectronContextMenu:t}})),u=(0,d().kF)(c,(e=>e.ElectronContextMenu));var m=()=>n(675393),p=()=>n(551693),g=(n(267602),n(653476),()=>n(955620)),f=()=>n(513670),h=()=>n(571896),v=()=>n(220228),y=()=>n(269299),b=()=>n(198829),x=()=>n(967092),S=()=>n(352230),M=()=>n(191003),w=()=>n(440721),C=()=>n(998901),j=()=>n(104088),k=()=>n(933539),T=()=>n(127519),I=()=>n(150569),_=()=>n(223321),P=()=>n(531633),Z=n(785893);function A(){const e=(0,i().Fy)(),{open:t,filter:n,emojiTextStore:r,popupOpen:s,originRect:l,alwaysShowPopup:d}=(0,a().VK)((()=>{const e=_().Z.state,t=e.open;if(!t)return{open:t,popupOpen:!1};const n=function(e){return w().zK(e.textStore,e.oldTextValue,!0)}(e)||"",{textStore:o,showPopupWithEmptyFilter:i,selectionRect:a}=e,r=Boolean(i);return{open:t,filter:n,emojiTextStore:o,popupOpen:n.length>0||r,originRect:a,alwaysShowPopup:r}}),[]),{textMode:c,prevChar:u,singleTextSelectionStore:m}=(0,a().VK)((()=>{var e;const t=T().default.state,{mode:n}=t;if("editing"!==n)return{mode:n};const{multiSelection:o}=t,i=g().eeV(o.start.store.getValue());return{textMode:n,prevChar:i?i[o.start.index-1]:void 0,singleTextSelectionStore:null===(e=(0,M().QY)(o))||void 0===e?void 0:e.store}}),[]),p=(0,a().VK)((()=>k().Z.state.open),[]);return(0,o.useEffect)((()=>{t&&!p&&("editing"!==c||!n&&":"!==u||m!==r||void 0===n||":"===n||n.startsWith(" ")||n.includes("\n"))&&v().xv()}),[r,n,p,t,u,m,c]),(0,Z.jsx)(x().ZP,{popupType:e.isMobileNative&&!e.isTablet?j().k.SlideUp:j().k.Popup,open:s,originRect:l,placementToOrigin:C().Placement.Bottom,alignmentToOrigin:C().Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,onDismiss:B,render:()=>(0,Z.jsx)(R,{open:t,filter:n||"",alwaysShowPopup:d}),keepFocus:!0})}function R(e){let{open:t,filter:n,alwaysShowPopup:a}=e;const r=(0,i().O7)(),s=(0,i().Fy)(),l=(0,o.useRef)(null),d=s.isMobileNative&&!s.isTablet?{menuType:S().o.ActionSheet}:{menuType:S().o.Popup,width:I().fG,onClickOutside:v().xv};const c=(0,o.useMemo)((()=>f().Ds((e=>{h().VJ(r,{searchQuery:e})}),500)),[r]);return t?!Boolean(a)&&n.length<1?null:(0,Z.jsx)(b().Z,{innerRef:l,...d,children:(0,Z.jsx)(P().h,{filter:n,onSubmit:e=>L(e,r),onNoResults:function(){if(!t)return;if(!n||0===n.length)return;const e=n.charAt(n.length-1);e&&(/\s/g.test(e)?v().xv():c(n))},isCallout:!1,menuRef:l,isInline:!0,onUpload:{onComplete:e=>{L(e,r)}}})}):null}function B(){v().xv()}function L(e,t){y().createAndCommit({userAction:"EmojiMenu.handleSubmit",environment:t,canUndo:!0,perform:n=>{v().RL({environment:t,emoji:e,transaction:n})}})}var D=()=>n(154057),V=(n(670560),n(241792),()=>n(59438)),O=()=>n(506347),U=()=>n(998411),N=()=>n(183922),F=()=>n(779565),H=()=>n(788860),K=()=>n(253502),E=()=>n(824462),W=()=>n(231077),z=()=>n(205228),G=()=>n(615676),q=()=>n(852465),Y=()=>n(635596),$=()=>n(704259),J=()=>n(141938),Q=()=>n(876822),X=()=>n(749826),ee=()=>n(826955),te=()=>n(987503);function ne(e,t){const n=(0,a().VK)((()=>t?null==e?void 0:e.userId:void 0),[t,null==e?void 0:e.userId]),r=(0,H().YB)(),s=(0,i().O7)(),l=(0,o.useRef)(),d=(0,o.useRef)(),c=(0,o.useRef)(-1),u=(0,o.useCallback)((()=>{const{mobileNative:e}=s,{allSpaces:t,currentSpace:n}=oe();e&&(t===l.current&&n===d.current||e.setBadgeNumber(t,n),d.current=n),t!==l.current&&(t>0?W().setBadge(`${t}`):W().setBadge("")),l.current=t}),[s]),m=(0,o.useMemo)((()=>f().IH(u)),[u]),p="on"===(0,te().a)("inbox_activity_split"),g=(0,o.useCallback)((async(t,n)=>{if(n===c.current||!e)return;if(c.current=n,!function(e){if(0===$().default.state.results.length)return!0;if(!document.hasFocus())return!0;if(!e.includes("unreadCount"))return!0;return!1}(String(n)))return;let o=[];if(X().default.checkGate({gateName:"multi_cell_get_user_notifications"})){const e=E().callMultiCellApi({eventName:"getUserNotifications",environment:s,data:{size:1e3,isInboxV2:!0,splitInboxActivity:p},headers:{}});for await(const t of e)"success"===t.type&&o.push(...t.data.results)}else{const e=await E().callApi({eventName:"getUserNotifications",environment:s,data:{size:1e3,isInboxV2:!0,splitInboxActivity:p}});if("failed"===e.type)return;o=e.data.results}$().default.setState({results:o}),m();const i=f().G0.apply(null,o.map((e=>e.unreceived.notificationIds)));for(const a of i)ie(a,e,r,s)}),[e,m,s,p,r]),h=(0,o.useMemo)((()=>f().P2(g,1e3)),[g]);(0,o.useEffect)((()=>{if(!n)return;let e;const t=(e,t)=>{J().Z.whenActive((()=>{h(e,t)}))};if(n){const o=(0,N().Lp)(n);e=Y().ZP.addListener(o,t,void 0,s),g("initializeListener",-1)}return $().default.addListener(u),s.mobileNative&&Q().default.addListener(u),()=>{e&&Y().ZP.removeListener(e,s),$().default.addListener(u),s.mobileNative&&Q().default.removeListener(u)}}),[n,s,g,h,u])}function oe(){const e="on"===X().default.getGroup("inbox_activity_split")?"comments":"mentions";return{allSpaces:$().default.getTotalUnreadCountForType(e),currentSpace:$().default.getUnreadCountForCurrentSpace()[e]??0}}async function ie(e,t,n,o){const i=(0,ee().Kv)(t,{table:F().uX,id:e});await i.load();const a=i.getKeyStore("activity_id").getValue(),r=i.getKeyStore("space_id").getValue();if(!r||!a)return;const s=(0,q().No)(i,a,r);await s.load();const l=s.getModel(),{currentUserStore:d,currentSpaceViewStore:u}=Q().default.state;if(d&&u&&l&&!l.invalid&&!V().BX(l,d.id)&&await W().isMainTabOrWindow()&&"undefined"!=typeof Notification){if(await u.load(),!u.isDefined())return;if(!l.isMentionType())return;if(!u.getNotifyDesktop())return;if(!o.device.isDesktop)return;const e=(0,(await c.load()).Notification)({activity:l,getRecordValue:i.getRecordValue,userTimeZone:(0,U().r)(),intl:n,pageVisitSource:O().tY.PushNotification,recipientUser:d.getModel(),experimentService:X().default,collectionFeatureGates:(0,G().W)()});if(!e)return;const{subject:t,body:a}=e,r=new Notification(t,{body:a,silent:!0}),m=V().Fb(l.type),p={medium:"desktop_push",type:m,badge_number:oe().allSpaces,notification_id:i.id,activity_id:s.id},g=e=>K().b2({environment:o,args:p,action:e});g("sent"),r.addEventListener("show",(()=>g("shown"))),r.addEventListener("close",(()=>g("closed"))),r.addEventListener("click",(()=>{const e=V().hY({activity:l,getRecordModel:i.getRecordModel,baseUrl:z().default.domainBaseUrl,pageVisitSource:O().tY.PushNotification}),t=(0,O().k6)(e,[m,"desktop_push"],O().tY.PushNotification);W().openNotificationUrl(t,o),g("clicked")}))}}const ae=new(d().Ss)("linkMenu",(()=>Promise.all([n.e(62743),n.e(73308)]).then(n.bind(n,895330)))),re=(0,d().kF)(ae,(e=>e.default)),se=new(d().Ss)("message-store-debug-panel",(async()=>await n.e(51308).then(n.bind(n,36706)))),le=(0,d().kF)(se,(e=>e.MessageStoreDebugPanel));var de=()=>n(638445);function ce(){return(0,a().VK)((()=>de().Z.state.open),[],{debugName:"MessageStoreDebugPanelWrapper.isOpen"})?(0,Z.jsx)(le,{}):null}var ue=()=>n(801812),me=()=>n(741633),pe=()=>n(696459),ge=()=>n(91502);function fe(e){let{environment:t}=e;const{currentSpaceViewStore:n,currentSpaceStore:o,currentUserStore:i}=Q().default.state,a=null==n?void 0:n.getUserId(),r=null==n?void 0:n.getSpaceId(),s={readyForHomePagesRequest:!1,spaceViewUserId:void 0,spaceViewId:void 0,spaceViewSpaceId:void 0};return null!=n&&n.isDefined()&&n.getAlive()&&n.canRead()&&a&&r?function(){const{spaceTransitionStatus:e}=Q().default.state;switch(e){case"notTransitioning":return!1;case"joiningOrCreatingSpace":case"switchingToOrLoadingSpace":return!0;default:(0,pe().t1)(e)}}()||t.currentUser.id!==a||(null==i?void 0:i.id)!==a||(null==o?void 0:o.id)!==r?s:(0,ge().QI)()?{readyForHomePagesRequest:!0,spaceViewId:n.id,spaceViewUserId:a,spaceViewSpaceId:r}:s:s}const he=(0,f().Ds)(E().callApi,1e3,{leading:!0,trailing:!0}),ve=function(){const e=(0,i().O7)(),t=(0,a().VK)((()=>fe({environment:e})),[e]);return(0,ue().r5)((async()=>{t.readyForHomePagesRequest&&await he({eventName:"getUserHomePages",environment:e,data:{spaceViewId:t.spaceViewId,spaceId:t.spaceViewSpaceId},userId:t.spaceViewUserId,headers:(0,me().Bb)({cellId:void 0,recordId:t.spaceViewId,spaceId:t.spaceViewSpaceId})})}),[e,t.readyForHomePagesRequest,t.spaceViewId,t.spaceViewUserId,t.spaceViewSpaceId]),null};var ye=()=>n(106342),be=()=>n(616728),xe=()=>n(688450),Se=()=>n(121700),Me=()=>n(27475),we=()=>n(557576),Ce=()=>n(111631),je=()=>n(502175);function ke(){const e=(0,i().O7)(),{currentSpaceStore:t}=(0,a().Kw)(Q().default),n=e.currentUser.id,r=(0,a().VK)((()=>null==t?void 0:t.id),[t]);return(0,o.useEffect)((()=>{if(!r||!n)return;const t=Y().ZP.addListener((0,N().pD)({userId:n,spaceId:r}),(async(t,o)=>{(function(e){var t;let{spaceId:n,userId:o,emitValue:i}=e;const a=null===(t=je().Z.getUserJoinedTeamsState({userId:o,spaceId:n}))||void 0===t?void 0:t.lastEmitValue;if(a===i)return!1;if(void 0===a&&je().Z.getHasFetched({userId:o,spaceId:n}))return!1;return!0})({spaceId:r,userId:n,emitValue:o})&&await Ce().m({environment:e,spaceId:r,userId:n,emitValue:o});const i=je().Z.getUserJoinedTeamsState({userId:n,spaceId:r});i&&je().Z.setUserJoinedTeamsState({userId:n,spaceId:r,state:{...i,lastEmitValue:o}})}),void 0,e);return function(){t&&Y().ZP.removeListener(t,e)}}),[e,n,r]),null}var Te=()=>n(685375),Ie=()=>n(846550),_e=()=>n(205248),Pe=()=>n(456681),Ze=()=>n(707513),Ae=()=>n(198046),Re=()=>n(990966),Be=()=>n(641702),Le=()=>n(12512),De=()=>n(148126),Ve=()=>n(495439),Oe=()=>n(1910),Ue=()=>n(654133),Ne=()=>n(623498);const Fe=(0,H().vU)({learnTooltip:{defaultMessage:"Learn more about alt text",id:"altTextMenuPopup.helpButton.tooltip"}});function He(){const e=(0,i().O7)(),{device:t}=e,n=(0,H().YB)(),r=(0,Ie().yK)((e=>({wrapper:{padding:t.isMobile?16:12,display:"flex",flexDirection:"column",fontSize:t.isMobile?Ze().JB.UIRegular.mobile:Ze().JB.UIRegular.desktop,wordBreak:"break-word",maxHeight:t.isMobile?"35vh":"200px",overflowY:"auto"},closeButton:{borderRadius:"100%",width:22,height:22,float:"right",marginLeft:8},input:{marginTop:t.isMobile?16:12,padding:t.isMobile?"8px 12px":"4px 10px",width:"100%",borderRadius:6,boxShadow:e.inputBoxShadow,background:e.surface.page,cursor:"text",overflowX:"hidden"},helpText:{color:e.text.secondary,display:"inline"},helpButton:{marginLeft:2,display:"inline-flex",position:"absolute",transform:t.isMobile?void 0:"translateY(-1px)"}})),[t.isMobile]),{altTextStore:s,altText:l,canEdit:d}=(0,a().VK)((()=>{const e=Ve().default.state.blockStore;return{altTextStore:null==e?void 0:e.getPropertyStore("alt_text"),altText:e?(0,Be().Xh)(null==e?void 0:e.getPropertyValue("alt_text"),e):void 0,canEdit:(null==e?void 0:e.canEdit())&&!(null!=e&&e.isNavigableAncestorNonEditableState())}}),[]);return(0,o.useEffect)((()=>{s&&Re().setSelectionAtEnd({store:s})}),[s]),(0,Z.jsx)(b().Z,{menuType:t.isMobile?S().o.ActionSheet:S().o.Popup,width:t.isMobile?"100vw":310,children:(0,Z.jsxs)("div",{style:r.wrapper,children:[(0,Z.jsxs)("div",{children:[(0,Z.jsx)(Oe().Z,{style:r.closeButton,hovered:!0,icon:_e().D,onClick:()=>Ae().x(e),ariaLabel:n.formatMessage({id:"altTextMenuPopup.closeButton",defaultMessage:"Close"})}),d?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("div",{style:r.helpText,children:(0,Z.jsx)(H()._H,{id:"altTextMenuPopup.description",defaultMessage:"Add alt text to describe this image. This makes your page more accessible to people who are vision-impaired or blind"})}),(0,Z.jsx)(Ue().Z,{renderTooltip:()=>n.formatMessage(Fe.learnTooltip),render:e=>(0,Z.jsx)(Oe().Z,{ariaLabel:n.formatMessage(Fe.learnTooltip),icon:Pe().m,external:!0,href:(0,De().UY)("guides.altText"),style:r.helpButton,isLightIconColor:!0,...e})})]}):l]}),d&&s&&(0,Z.jsx)(Ne().Z,{store:s,disabled:!1,pasteBehavior:"plaintext",style:r.input,placeholderStyle:r.input,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableInsertText:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableMentions:!0,disableEmbedMenu:!0,disableMobileActionBar:!0,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onEnter:()=>Ae().x(e),onEsc:()=>Ae().x(e),placeholder:n.formatMessage({id:"altTextMenuPopup.placeholder",defaultMessage:"Add alt text..."}),inPageFind:Le().B3.none})]})})}const Ke=function(){const e=(0,i().O7)(),{device:t}=e,n=(0,Ie().yK)((e=>({popup:{background:e.altTextPopupBackground,borderTopLeftRadius:t.isMobile?12:6,borderTopRightRadius:t.isMobile?12:6,left:t.isMobile?0:8}})),[t.isMobile]),{open:o,originRect:r}=(0,a().VK)((()=>{const{open:e}=Ve().default.state;return e?{open:e,originRect:Ve().default.state.originRect}:{open:e,originRect:void 0}}),[]);return(0,Z.jsx)(x().ZP,{popupType:t.isMobile?j().k.SlideUp:j().k.Popup,open:o,originRect:r,originGap:8,placementToOrigin:C().Placement.Bottom,alignmentToOrigin:C().Alignment.End,onDismiss:()=>Ae().x(e),render:()=>(0,Z.jsx)(He,{}),sameWidthAsOrigin:!1,style:n.popup})};var Ee=()=>n(799454),We=()=>n(70191),ze=()=>n(589525),Ge=()=>n(590972),qe=()=>n(687647),Ye=()=>n(156642),$e=()=>n(281063),Je=()=>n(8208),Qe=()=>n(958783),Xe=()=>n(520849),et=()=>n(180512),tt=()=>n(94967),nt=()=>n(470386),ot=()=>n(299519),it=()=>n(539245);const at=[qe().u.Open,qe().u.Resolved];const rt=function(e){let{discussionIds:t,blockStore:o,recursivelyLoadAllDiscussions:r,tab:s,property_id:l}=e;const d=(0,i().O7)(),{resolved:c,unresolved:u}=(0,a().VK)((()=>{const e=q().al(o,{recursivelyLoadAllDiscussions:r,includePropertyDiscussions:!0}).filter((e=>{if(t&&!t.includes(e.id)&&!q().De(e))return!1;return!Boolean(l)||e.getPropertyId()===l})).sort(((e,t)=>t.getReactionStores().length-e.getReactionStores().length)),{resolved:n,unresolved:i}=q().bB(e);return{resolved:n,unresolved:i}}),[o,r,t,l]),{device:m}=d;let p;return p=m.isMobile?{menuType:S().o.Modal,title:(0,Z.jsx)(H()._H,{defaultMessage:"Comments",id:"blockDiscussionMenu.mobileMenu.title"}),header:(0,Z.jsx)(ct,{tab:s,resolved:c,unresolved:u}),right:(0,Z.jsx)(nt().DoneMenuText,{}),onClickRight:Ee().LZ,whiteBackground:!0}:{menuType:S().o.Popup,header:(0,Z.jsx)(ct,{tab:s,resolved:c,unresolved:u}),width:480,maxHeight:"50vh",onClickOutside:Ee().LZ},(0,Z.jsx)(n(695284).Z,{capture:!0,preventType:Xe().Z.All,children:(0,Z.jsx)(n(573357).Z,{capture:!0,allowMobileAutoScroll:!0,render:()=>(0,Z.jsx)(tt().Z,{debugName:"BlockDiscussionMenu",capture:!0,onEsc:Ee().LZ,onBackspace:dt,onDelete:dt,children:(0,Z.jsx)(ot().Z,{store:o,droppable:!0,render:()=>(0,Z.jsx)(b().Z,{...p,children:(0,Z.jsx)(mt,{tab:s,blockStore:o,resolved:c,unresolved:u})})},o.id)})})})};function st(e){let{message:t}=e;const n=(0,i().O7)(),{device:o}=n,a=(0,Ie().yK)((e=>({emptyState:{textAlign:"center",padding:o.isMobile?"64px 18px":"32px 18px 36px",fontSize:14,color:e.mediumTextColor}})),[o.isMobile]);return(0,Z.jsx)("div",{style:a.emptyState,children:t})}function lt(e){const t=qe().Z.state;t.open&&qe().Z.setState({...t,tab:at[e]})}function dt(e){null==e||e.preventDefault(),Ee().LZ()}function ct(e){let{tab:t,resolved:n,unresolved:o}=e;const a=(0,i().O7)(),{device:r}=a,s=o.length,l=n.length,d=(0,Ie().yK)((e=>({openCountStyle:{color:e.text.tertiary},resolvedCountStyle:{color:e.text.quaternary}})),[]);return 0===l||0===s?null:(0,Z.jsx)(it().ZP,{tabs:[(0,Z.jsxs)("div",{children:[(0,Z.jsx)(H()._H,{defaultMessage:"Open",id:"blockDiscussionMenu.openDiscussionsTab.title"},"openDiscussionsTitle")," ",(0,Z.jsx)("span",{style:d.openCountStyle,children:s})]},"openDiscussions"),(0,Z.jsxs)("div",{children:[(0,Z.jsx)(H()._H,{defaultMessage:"Resolved",id:"blockDiscussionMenu.resolvedDiscussionsTab.title"},"resolvedDiscussionsTitle")," ",(0,Z.jsx)("span",{style:d.resolvedCountStyle,children:l})]},"resolvedDiscussions")],selectedIndex:at.indexOf(t),onChange:lt,style:{...r.isAndroid&&{borderBottom:"none"}}})}function ut(e){const{value:t}=(0,d().XJ)(l().commentsDependency),n=(0,i().O7)(),o=(0,a().VK)((()=>Qe().default.state.open&&Je().Z.state.overlapsExistingDiscussionMenu),[]),r=(0,a().VK)((()=>qe().Z.state.open&&qe().Z.state.tab===qe().u.Open),[]),s=(0,a().VK)((()=>qe().Z.state.open&&qe().Z.state.keepNewDiscussionAtBottom),[]),c=(0,a().VK)((()=>(Qe().default.state.open&&Je().Z.state.overlapsExistingDiscussionMenu)??!1),[]);if(0===e.discussionStores.length)return null;const u=s?e.discussionStores[0]:void 0;return(0,Z.jsxs)(Z.Fragment,{children:[t&&e.discussionStores.slice(u?1:0).map(((n,o,i)=>(0,Z.jsx)(l().gU,{store:n,format:t.discussionHelpers.DiscussionFormat.Menu,isFirst:0===o,isOnly:1===i.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:e.blockStore,onDismiss:Ee().LZ},n.id))),u&&t&&(0,Z.jsx)(l().gU,{store:u,format:t.discussionHelpers.DiscussionFormat.Menu,isFirst:1===e.discussionStores.length,isOnly:1===e.discussionStores.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:e.blockStore,onDismiss:Ee().LZ},u.id),o&&r&&(0,Z.jsx)($e().Z,{environment:n,shouldShowTopDividerLine:!0,shouldExpandDiscussionWidth:c,noBackgroundColors:!0})]})}function mt(e){let{tab:t,blockStore:n,resolved:r,unresolved:s}=e;const c=(0,Ie().Fg)(),u=(0,i().O7)(),{device:m}=u,p=(0,a().VK)((()=>n.getType()),[n]),g=(0,a().VK)((()=>et().h(n)),[n]),{value:f}=(0,d().XJ)(l().commentsDependency);if(!f)return null;if(t===qe().u.Open){if(s.length){const e=p&&(0,pe().qg)(Ye().p2,p);return m.isMobile&&e&&g?(0,Z.jsxs)(o.Fragment,{children:[(0,Z.jsx)("div",{style:{padding:"12px 16px",boxShadow:`0 1px 0 ${c.regularDividerColor}`,marginBottom:1},children:(0,Z.jsx)(g,{store:n,disabled:!0,hideContent:!0,style:{fontSize:14,pointerEvents:"none"},isQuickFind:!0})}),(0,Z.jsx)(ut,{discussionStores:s,blockStore:n})]}):(0,Z.jsx)(ut,{discussionStores:s,blockStore:n})}return(0,Z.jsx)(st,{message:(0,Z.jsx)(H()._H,{defaultMessage:"No comments to show.",id:"blockDiscussionMenu.emptyState.noCommentsMessage"})})}return r.length?(0,Z.jsx)(ut,{discussionStores:r,blockStore:n}):(0,Z.jsx)(st,{message:(0,Z.jsx)(H()._H,{defaultMessage:"No resolved comments.",id:"blockDiscussionMenu.emptyState.noResolvedCommentsMessage"})})}const pt=function(){const e=(0,i().O7)(),{device:t}=e,r=(0,a().VK)((()=>qe().Z.state.rect),[]),s=(0,a().VK)((()=>{if(!qe().Z.state.open)return!1;let t=!1;const o=qe().Z.state.property_id;if(qe().Z.state.open&&o){var i;const e=null===(i=qe().Z.state.blockStore)||void 0===i||null===(i=i.getAssociatedCollectionStore())||void 0===i?void 0:i.getLayoutStore();e&&(t=(0,We().Uo)({layoutStore:e,propertyId:o}).isPropertyInPageDetails)}const a=(0,n(954452).az)(e,qe().Z.state.blockStore);return!!t||(Ge().default.state.currentTab!==Ge().gY.Comments||!(0,ze().Sx)(e))&&!a}),[e]),l=(0,o.useCallback)((()=>{Ee().LZ()}),[]),d=(0,o.useCallback)((()=>{if(qe().Z.state.open)return(0,Z.jsx)(rt,{tab:qe().Z.state.tab,blockStore:qe().Z.state.blockStore,discussionIds:qe().Z.state.discussionIds,recursivelyLoadAllDiscussions:qe().Z.state.recursivelyLoadAllDiscussions,property_id:qe().Z.state.property_id})}),[]);return(0,Z.jsx)(x().ZP,{popupType:t.isMobile?j().k.SlideUp:j().k.Popup,open:s,originRect:r,placementToOrigin:C().Placement.Bottom,alignmentToOrigin:C().Alignment.Center,disableMouseCapture:!0,originGap:4,render:d,preventScaleTransition:!0,preventOpacityTransition:!0,onDismiss:l})};var gt=()=>n(499411),ft=()=>n(494293),ht=()=>n(799891),vt=()=>n(754048),yt=()=>n(47992),bt=()=>n(332079),xt=()=>n(869211),St=()=>n(785673),Mt=()=>n(640566),wt=()=>n(78815),Ct=()=>n(894011),jt=()=>n(832309),kt=()=>n(82451),Tt=()=>n(334591),It=()=>n(594546),_t=()=>n(718959),Pt=()=>n(247724),Zt=()=>n(228362),At=()=>n(527278),Rt=()=>n(524434),Bt=()=>n(482970),Lt=()=>n(845622),Dt=()=>n(965903),Vt=()=>n(827973),Ot=()=>n(255577),Ut=()=>n(388284);const Nt=(0,H().vU)({createTransclusion:{defaultMessage:"Paste and sync",id:"blockPasteMenu.actions.createTransclusion.title"},linkToPage:{defaultMessage:"Link to page",id:"blockPasteMenu.actions.linkToPage.title"},dismissItem:{defaultMessage:"Dismiss",id:"blockPasteMenu.actions.dismiss.title"},pasteItem:{defaultMessage:"Paste",id:"blockPasteMenu.actions.paste.label"},suggestedActionsSectionTitle:{defaultMessage:"Suggested actions",id:"blockPasteMenu.actions.suggestedActionsSectionTitle"}});const Ft=function(){const e=(0,i().Fy)(),t=(0,i().O7)(),r=(0,a().Kw)(Bt().Z),{stores:s,phase:l}=(0,a().Kw)(Dt().default);(0,o.useEffect)((()=>{r.open&&((0,n(632314).Z)(s,r.blocks)&&l===Dt().SelectionPhase.Selected||bt().xv(t))}),[r,s,l,t]);const d=(0,o.useCallback)((()=>{bt().xv(t)}),[t]),c=r.open&&"ai_actions"===r.type;return(0,Z.jsx)(x().ZP,{popupType:e.isMobileNative&&!e.isTablet?j().k.SlideUp:j().k.Popup,open:r.open,originRect:r.open?r.rect:void 0,placementToOrigin:c?C().Placement.Right:C().Placement.Bottom,alignmentToOrigin:c?C().Alignment.Start:C().Alignment.End,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:()=>(0,Z.jsx)(Kt,{}),onDismiss:d,disableFlippingPlacement:c})};function Ht(e){const{menuItemProps:t}=e,{isMobile:n}=(0,i().Fy)(),o=(0,a().Kw)(Rt().r4),r=n?{mobileIconStyle:o?{marginLeft:18,marginRight:2}:void 0}:{desktopIconStyle:o?{marginLeft:8,marginRight:2}:void 0};return(0,Z.jsx)(Vt().Z,{...t,title:At().Z.formatMessage(Zt().Dr.askAI),icon:(0,Z.jsx)(St().sW,{}),...r})}function Kt(){const e=(0,i().O7)(),t=(0,Ie().Fg)(),{device:n}=e,o=(0,a().VK)((()=>{const n=Bt().Z.state;return n.open?"ai_actions"===n.type?function(e,t,n){var o;const i=(0,_t().np)();if(!i)return null;const a=(0,Mt().clientSkillToAssistantSurfaceAction)((0,wt().getAllClientSkills)({currentPageRecordPointer:void 0,currentCollectionRecordPointer:void 0})),r={type:"entrypoint",entrypoint:"blockPasteMenu",isMobile:t.device.isMobile,pageStore:i,selectionState:Dt().default.state,textSelectionState:T().default.state,userSettings:null===(o=Q().default.state.currentUserSettingsStore)||void 0===o?void 0:o.getSettings()},s=(0,Mt().filterAssistantSurfaceActionsForContext)(a,r),l=(0,jt().fb)({assistantSuggestionContext:r,validatedActions:s}).filter(wt().isAssistantSurfaceActionWithClientSkill),d=(0,Mt().clientSkillToAssistantSurfaceAction)(l),c=(0,gt().Oy)();return[{key:"ai_actions_paste_menu",render:e=>(0,Z.jsx)(Ut().Z,{...e,title:At().Z.formatMessage(Nt.suggestedActionsSectionTitle)}),items:[{key:"paste",render:e=>(0,Z.jsx)(Vt().Z,{...e,icon:(0,Z.jsx)(yt().lA,{svg:vt().U}),title:At().Z.formatMessage(Nt.pasteItem)}),action:()=>{(0,It().j)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:"ai_actions",action:"paste"}}}),bt().xv(t)}},...d.map((e=>({key:e.skillType,render:t=>(0,Z.jsx)(Vt().Z,{...t,title:At().Z.formatMessage(Tt().sY.writerGlobalSkill,{displayName:At().Z.formatMessage(e.displayName),acceptsParameters:(0,ft().Vz)(e.skillType)||(0,ft().Zf)(e.skillType)}),icon:(0,Z.jsx)(yt().lA,{svg:e.icon,svgFill:(0,Ct().zm)(e.category).color(n).color})}),action:async()=>{try{(0,It().j)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:"ai_actions",action:"client_skill",skill_type:e.skillType}}}),bt().xv(t),await(0,xt().toggleInitialPrompt)({from:"block_paste_menu",environment:t,sessionId:c});const n=Lt().default.state;if(!n||"assistantCompletionPopup"!==n.type||"initialPrompt"!==n.stage)return;await kt().assistantWriterActions.triggerAssistantSkillCompletion({environment:t,context:n.context,clientSkillWithParameterValues:(0,wt().dangerouslyCreateClientSkillWithParameterValues)(e),updater:Lt().default.createUpdater(),sessionId:c,from:"block_paste_menu",assistantSurfaceType:t.device.isMobile?"mobileWriter":"writer"})}catch{ht().log({level:"info",from:"BlockPasteMenu",type:"triggerAssistantSkillCompletionError",error:{message:"Error triggering assistant skill completion"},data:{miscDataToConvertToString:{skillType:e.skillType}}})}}}))),{key:"ask_ai",render:e=>(0,Z.jsx)(Ht,{menuItemProps:e}),action:async()=>{try{(0,It().j)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:"ai_actions",action:"ask_ai"}}}),bt().xv(t),await(0,xt().toggleInitialPrompt)({from:"block_paste_menu",environment:t,sessionId:c})}catch{ht().log({level:"info",from:"BlockPasteMenu",type:"triggerAssistantWriterError",error:{message:"Error opening assistant writer"}})}}}]}]}(0,e,t):"blocks"===n.type||"links"===n.type?function(e,t){const{blocks:n}=e,{currentSpaceStore:o}=Q().default.state,i=[];if("blocks"===e.type){const{copiedStores:a,pageSource:r}=e;bt().H8({currentSpaceId:null==o?void 0:o.id,blocks:n,copiedStores:a})&&i.push({name:At().Z.formatMessage(Nt.createTransclusion),action:async()=>{(0,It().j)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"create_transclusion"}}}),await bt().ry({environment:t,blocks:n,copiedBlockIds:a.map((e=>e.id))})}}),bt().wK({blocks:n})&&i.push({name:At().Z.formatMessage(Nt.linkToPage),action:async()=>((0,It().j)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"link_to_page"}}}),bt().Dq({environment:t,blocks:n,source:{type:"blocks",copiedStores:a,pageSource:r}}))})}return"links"===e.type&&i.push({name:At().Z.formatMessage(Nt.linkToPage),action:async()=>((0,It().j)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"link_to_page"}}}),bt().Dq({environment:t,blocks:n,source:{type:"links",copiedLinks:e.copiedLinks}}))}),[{key:"embed section",render:e=>(0,Z.jsx)(Ut().Z,{...e}),items:[{key:"dismiss",render:e=>(0,Z.jsx)(Vt().Z,{...e,title:At().Z.formatMessage(Nt.dismissItem)}),action:()=>{(0,It().j)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"dismiss"}}}),bt().xv(t)}},...i.map((e=>{let{name:t,action:n}=e;return{key:`embed ${t}`,render:e=>(0,Z.jsx)(Vt().Z,{...e,title:t}),action:n}}))]}]}(n,e):void(0,pe().t1)(n):null}),[e,t]);if(null===o)return null;let r;return r=n.isMobile?{menuType:S().o.ActionSheet}:{menuType:S().o.Popup,width:320,maxHeight:"40vh"},(0,Z.jsx)(b().Z,{...r,className:Pt().srZ,children:(0,Z.jsx)(Ot().ZP,{type:Ot().iW.Vertical,sections:o,initialFocus:0})})}var Et=()=>n(516623),Wt=()=>n(291198),zt=()=>n(67961);const Gt=function(){const e=(0,i().O7)(),{device:t}=e,{active:n,stringValue:o}=(0,a().VK)((()=>{const{active:e,stringValue:t}=Et().default.state;return{active:e,stringValue:t}}),[]),r=window.innerWidth/2-150,s=window.innerHeight/2,l=t.isMobileNative?(0,Z.jsx)(H()._H,{defaultMessage:"Tap to copy the link above",id:"clipboardInputRenderer.copyLink.mobile_message"}):(0,Z.jsx)(H()._H,{defaultMessage:"Right click and copy the link above",id:"clipboardInputRenderer.copyLink.message"});return(0,Z.jsx)(x().ZP,{popupType:t.isMobileNative?j().k.SlideUp:j().k.Popup,open:n,originRect:{top:s,left:r},onDismiss:qt,placementToOrigin:C().Placement.Bottom,alignmentToOrigin:C().Alignment.Start,originGap:0,render:()=>(0,Z.jsx)(tt().Z,{debugName:"ClipboardInputRenderer",capture:!0,onEnter:f().yR,onCommandEnter:f().yR,onCommandShiftEnter:f().yR,onCommandSlash:f().yR,onDelete:f().yR,onBackspace:f().yR,onEsc:f().yR,onLeft:f().yR,onRight:f().yR,onUntab:f().yR,onTab:f().yR,onSelectAll:f().yR,onRedo:f().yR,onUndo:f().yR,onToggleBold:f().yR,onToggleItalics:f().yR,onToggleStrike:f().yR,onToggleCode:f().yR,onCut:f().yR,onCopy:f().yR,onPaste:f().yR,onKeypress:f().yR,children:(0,Z.jsxs)("div",{style:{padding:8,width:300},children:[(0,Z.jsx)(Wt().Z,{style:{width:"100%",fontSize:12},value:o,focus:!0,textarea:!0,selectAll:!0,readOnly:!0}),(0,Z.jsx)(zt().Z,{isSmall:!0,style:{marginTop:6,pointerEvents:"none"},children:l})]})})})};function qt(){Et().default.setState({...Et().default.state,active:!1,stringValue:""})}var Yt=()=>n(664136),$t=()=>n(441275),Jt=()=>n(393974),Qt=()=>n(543631),Xt=()=>n(467806);const en=function(){const e=(0,i().O7)(),{currentSpaceStore:t}=(0,a().VK)((()=>({currentSpaceStore:Q().default.state.currentSpaceStore})),[]);return(0,o.useEffect)((()=>{if(!t)return;const o=Y().ZP.addListener((0,N().Cm)(t.id),(async(o,i)=>{if(!Xt().Z.shouldRefetch({currentSpaceId:t.id,emitValue:i}))return;const a=await E().callApi({eventName:"getAllSpacePermissionGroupsWithMemberCount",environment:e,data:{spaceId:t.id},headers:(0,me().Bb)({cellId:void 0,spaceId:t.id})});if("failed"===a.type)return ht().rateLimitedLog({from:"CurrentSpacePermissionGroupsListener",level:"error",type:"getAllCurrentSpacePermissionGroupsFailed"}),[];Xt().Z.setState({permissionGroupsAndMemberCounts:a.data.groupsWithMemberCount.map((e=>({group:n(530980).kk5.fromValue("space_permission_group",e.group),memberCount:e.memberCount}))),lastEmitData:{spaceId:t.id,value:i}})}),void 0,e);return function(){o&&Y().ZP.removeListener(o,e)}}),[t,e]),null};n(122556),n(582845),n(250570),n(533019),n(721473),n(788208),n(22624);var tn=()=>n(619779);const nn=function(){const e=(0,i().O7)(),{currentSpaceStore:t,currentUserStore:n}=(0,a().Kw)(Q().default),r=null==n?void 0:n.id;return(0,o.useEffect)((()=>{if(!t||!r)return;const n=Y().ZP.addListener((0,N().eJ)({spaceId:t.id,userId:r}),(async(n,o)=>{if(!tn().Z.shouldRefetch({currentSpaceId:t.id,currentUserId:r,emitValue:o}))return;const i=await E().callApi({eventName:"getSpacePermissionGroupIdsContainingMembers",environment:e,data:{spaceId:t.id,userIds:[r]},headers:(0,me().Bb)({cellId:void 0,spaceId:t.id})});if("failed"===i.type)return ht().rateLimitedLog({from:"CurrentUserSpaceGroupMembershipListener",level:"error",type:"getSpacePermissionGroupIdsContainingMembers"}),[];tn().Z.setState({spacePermissionGroupIds:new Set(i.data.userToGroupMap[r]||[]),lastEmitData:{spaceId:t.id,userId:r,value:o}})}),void 0,e);return function(){n&&Y().ZP.removeListener(n,e)}}),[t,r,e]),null};var on=()=>n(143346),an=()=>n(263168),rn=()=>n(180099);function sn(e){const{environment:t,pointers:n,userIdToCloneFrom:o}=e;for(const i of n)on().Wl({environment:t,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,pointer:i,model:t.defaultRecordCache.inMemoryRecordCache.getRecordModel({pointer:i,userId:o}),role:"reader",updatePaths:[[]],debugSource:"CustomEmojisListener"})}const ln=new(n(783540).G)((()=>0));const dn=function(){const e=(0,i().O7)(),[t,r]=(0,o.useState)(!1);(0,o.useEffect)((()=>{!async function(){await n(512258).waitForInitialPageRenderToComplete(),r(!0)}()}),[]);const s=(0,a().VK)((()=>{var e;return null===(e=(0,n(606757).Jy)())||void 0===e?void 0:e.id}),[]),l=e.currentUser.id,d=(0,a().VK)((()=>{const e=rn().Z.getKeys();return s&&l?e.includes(s)?e:[...e,s]:e}),[s,l]);return function(e,t){const n=(0,i().O7)();(0,o.useEffect)((()=>{const o=ln.get(e)+1;ln.set(e,o);const i=()=>{};Object.defineProperty(i,"name",{configurable:!0,enumerable:!1,value:`useRetainRecordsInMemory(${e} ${o})`});for(const e of t)n.defaultRecordCache.inMemoryRecordCache.addListenerToRecord(e,i),an().cancelEviction({pointer:e,userId:n.currentUser.id});return()=>{for(const e of t)n.defaultRecordCache.inMemoryRecordCache.removeListenerToRecord(e,i),an().unsubscribeAfterDelay({environment:n,pointer:e,userId:n.currentUser.id})}}),[e,n,t])}("CustomEmojis",(0,a().VK)((()=>{if(!t)return[];const n=[];for(const t of d){const o=rn().Z.getDataWithoutRefetch(e,{spaceId:t});if(!o)continue;const i=o.pointers,a=o.lastFetchedBy;t===s&&a!==l&&sn({environment:e,pointers:i,userIdToCloneFrom:a}),n.push(...i)}return n}),[d,s,l,e,t])),function(e){const t=(0,i().O7)();(0,o.useEffect)((()=>{const n=[];for(const o of e){const e=Y().ZP.addListener((0,N().h8)(o),((e,t)=>{rn().Z.emit({spaceId:o},t)}),void 0,t);e&&n.push(e)}return()=>{for(const e of n)Y().ZP.removeListener(e,t)}}),[t,e])}(d),null};var cn=()=>n(803021),un=()=>n(349220),mn=()=>n(531149),pn=()=>n(970105),gn=()=>n(170722);const fn=function(){const e=(0,i().O7)(),{device:t}=e,n=(0,a().Kw)(gn().Z);return(0,Z.jsx)(x().ZP,{popupType:t.isMobile?j().k.SlideUp:j().k.Popup,open:n.open,originRect:n.originRect,onDismiss:mn().x,render:()=>(0,Z.jsx)(hn,{shouldShowReminder:!!n.open&&n.allowReminders})})};function hn(e){let{shouldShowReminder:t}=e;const n=(0,i().O7)(),o=(0,a().VK)((()=>vn()),[]);if(!o)return null;const r="default",{date_format:s,time_format:l,dateValue:c}=o;return(0,Z.jsx)(d().ev,{dependency:m().Di,children:e=>{let{DatePropertyMenu:o}=e;return(0,Z.jsx)(o,{firstDayOfWeek:_t().AK.state,value:c,canConfigureCollection:!0,onChangeValue:e=>function(e,t,n){if(!e)return void function(e,t){const n=vn();if(!n)return;const{textStore:o,textValue:i,tokenIndex:a}=n,r=g().VrM(i.slice(0,a)),s=g().VrM(i.slice(0,a+1));y().createAndCommit({userAction:"DateMentionMenu.removeDateAnnotation",environment:e,canUndo:!0,perform:t=>{pn().pe({environment:e,store:o,selection:{startIndex:r,endIndex:s},transaction:t})}})}(t);if(!cn().U3(e))return;const o=vn();if(!o)return;const{date_format:i,time_format:a}=o;yn({date_format:i,time_format:a,...e},t,n)}(e,n,r),dateFormat:s,onChangeDateFormat:e=>function(e,t,n){const o=vn();if(!o)return;const{dateValue:i,time_format:a}=o;yn({date_format:e,time_format:a,...i},t,n)}(e,n,r),timeFormat:l,onChangeTimeFormat:e=>function(e,t,n){const o=vn();if(!o)return;const{dateValue:i,date_format:a}=o;yn({date_format:a,time_format:e,...i},t,n)}(e,n,r),onDismiss:mn().x,disabled:!1,shouldShowReminder:t,isTemplatePage:!1})}})}function vn(){const e=gn().Z.state;if(e.open){const{textStore:t,tokenIndex:n}=e,o=t.getValue();if(o){const e=o[n];if(e){(0,un().T)(g().km_(e),"Token should be a mention token");const i=g().hDy(e),a=g().K9C(i);if(a){const{date_format:r,time_format:s,...l}=g().zyO(a);return{textStore:t,textValue:o,tokenIndex:n,token:e,annotations:i,date_format:r,time_format:s,dateValue:l}}}}}}function yn(e,t,n){const o=vn();if(!o)return;const{textStore:i,textValue:a,tokenIndex:r,token:s,annotations:l}=o,d=l.map((t=>g().fpG(t)?["d",e]:t)),c=g().V3y(s[0],d),u=g().VrM(a.slice(0,r)),m=g().VrM(a.slice(0,r+1));y().createAndCommit({userAction:"DateMentionMenu.setDateAnnotationData",environment:t,canUndo:!0,perform:e=>{pn().pe({environment:t,store:i,selection:{startIndex:u,endIndex:m},transaction:e}),pn().mM({environment:t,store:i,tokens:[c],index:u,transaction:e})}})}n(228244);var bn=()=>n(903680),xn=()=>n(455530),Sn=()=>n(54193),Mn=()=>n(396136),wn=()=>n(326966),Cn=()=>n(351972),jn=()=>n(295703),kn=()=>n(887274),Tn=()=>n(239482),In=()=>n(656769),_n=()=>n(308939),Pn=()=>n(666414),Zn=()=>n(312578),An=()=>n(663631);const Rn=(0,H().vU)({image:{defaultMessage:"Embed image",id:"embedMenu.action.image"},video:{defaultMessage:"Embed video",id:"embedMenu.action.video"},tweet:{defaultMessage:"Embed Tweet",id:"embedMenu.action.tweet"},drive:{defaultMessage:"Embed Google Drive",id:"embedMenu.action.drive"},gist:{defaultMessage:"Embed GitHub Gist",id:"embedMenu.action.gist"},figma:{defaultMessage:"Embed Figma",id:"embedMenu.action.figma"},invision:{defaultMessage:"Embed Invision project",id:"embedMenu.action.invision"},abstract:{defaultMessage:"Embed Abstract project",id:"embedMenu.action.abstract"},framer:{defaultMessage:"Embed Framer prototype",id:"embedMenu.action.framer"},whimsical:{defaultMessage:"Embed Whimsical board",id:"embedMenu.action.whimsical"},mixpanel:{defaultMessage:"Embed Mixpanel project",id:"embedMenu.action.mixpanel"},sketch:{defaultMessage:"Embed Sketch document",id:"embedMenu.action.sketch"},excalidraw:{defaultMessage:"Embed Excalidraw",id:"embedMenu.action.excalidraw"},replit:{defaultMessage:"Embed a repl",id:"embedMenu.action.replit"},miro:{defaultMessage:"Embed Miro board",id:"embedMenu.action.miro"},audio:{defaultMessage:"Embed audio",id:"embedMenu.action.audio"},maps:{defaultMessage:"Embed Google Maps",id:"embedMenu.action.maps"},loom:{defaultMessage:"Embed Loom",id:"embedMenu.action.loom"},typeform:{defaultMessage:"Embed Typeform",id:"embedMenu.action.typeform"},codepen:{defaultMessage:"Embed CodePen",id:"embedMenu.action.codepen"},pdf:{defaultMessage:"Embed PDF",id:"embedMenu.action.pdf"},embed:{defaultMessage:"Embed",id:"embedMenu.action.createEmbed"},hex:{defaultMessage:"Embed Hex",id:"embedMenu.action.hex"},deepnote:{defaultMessage:"Embed Deepnote",id:"embedMenu.action.deepnote"},drawing:{defaultMessage:"Embed a drawing",id:"embedMenu.action.drawing"}}),Bn=(0,H().vU)({mentionPage:{defaultMessage:"Mention",id:"embedMenu.actions.mentionPage.title"},mentionBlock:{defaultMessage:"Mention",id:"embedMenu.actions.mentionBlock.title"},createLinkedDatabase:{defaultMessage:"Create linked database",id:"embedMenu.actions.createLinkedDatabase.title"},createLinkedViewOfDatabase:{defaultMessage:"Linked database view",id:"embedMenu.actions.createLinkedViewOfDatabase.title"},bookmarkMenuItem:{defaultMessage:"Bookmark",id:"embedMenu.actions.createBookmark.title"},newBookmarkMenuItem:{defaultMessage:"Preview",id:"embedMenu.actions.createNewBookmark.title"},createTransclusionItem:{defaultMessage:"Synced block",id:"embedMenu.actions.createTransclusion.title"},dismissItem:{defaultMessage:"URL",id:"embedMenu.actions.dismiss.title"},linkMention:{defaultMessage:"Mention",id:"embedMenu.actions.linkMention.title"},pagePreview:{defaultMessage:"Preview",id:"embedMenu.actions.pagePreview.title"},embed:{defaultMessage:"Embed",id:"embedMenu.actions.embed.title"}}),Ln={image:At().Z.formatMessage(Rn.image),video:At().Z.formatMessage(Rn.video),tweet:At().Z.formatMessage(Rn.tweet),drive:At().Z.formatMessage(Rn.drive),gist:At().Z.formatMessage(Rn.gist),figma:At().Z.formatMessage(Rn.figma),invision:At().Z.formatMessage(Rn.invision),abstract:At().Z.formatMessage(Rn.abstract),framer:At().Z.formatMessage(Rn.framer),whimsical:At().Z.formatMessage(Rn.whimsical),mixpanel:At().Z.formatMessage(Rn.mixpanel),miro:At().Z.formatMessage(Rn.miro),sketch:At().Z.formatMessage(Rn.sketch),excalidraw:At().Z.formatMessage(Rn.excalidraw),replit:At().Z.formatMessage(Rn.replit),audio:At().Z.formatMessage(Rn.audio),maps:At().Z.formatMessage(Rn.maps),loom:At().Z.formatMessage(Rn.loom),typeform:At().Z.formatMessage(Rn.typeform),codepen:At().Z.formatMessage(Rn.codepen),pdf:At().Z.formatMessage(Rn.pdf),embed:At().Z.formatMessage(Rn.embed),hex:At().Z.formatMessage(Rn.hex),deepnote:At().Z.formatMessage(Rn.deepnote),drawing:At().Z.formatMessage(Rn.drawing)};const Dn=function(){const e=(0,i().O7)(),t=(0,i().Fy)(),n=(0,a().Kw)(In().Z);return(0,Z.jsx)(x().ZP,{popupType:t.isMobileNative&&!t.isTablet?j().k.SlideUp:j().k.Popup,open:n.open,originRect:n.open?n.selectionRect:void 0,placementToOrigin:C().Placement.Bottom,alignmentToOrigin:C().Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:t.isMobile,keepFocus:t.isMobile,render:()=>n.loading?(0,Z.jsx)(Zn().Z,{}):(0,Z.jsx)(Kn,{}),onDismiss:()=>Vn(e)})};function Vn(e){const t=In().Z.state;if(!t.open)return;const{url:n}=t;Cn().X0(e,{url:n,type:"close"}),jn().xv()}function On(e,t){const n=In().Z.state;if(!n.open)return;const{url:o}=n;jn().RL({environment:t,type:e}),"form"!==e&&Cn().X0(t,{url:o,type:e})}function Un(e,t){const{device:n}=t,{url:o,textStore:i}=e,{currentSpaceStore:a}=Q().default.state,r=[],s=(0,Sn().parseRoute)({url:o,baseUrl:z().default.domainBaseUrl,publicDomainName:z().default.publicDomainName,isMobile:n.isMobile,protocol:z().default.protocol,currentUrl:window.location.href}),l=["youtube.com","youtu.be","instagram.com","twitter.com","x.com","facebook.com","linkedin.com","pinterest.com","tiktok.com","spotify.com","maps.google.com","drive.google.com","docs.google.com","slides.google.com","sheets.google.com","forms.google.com","indify.co","open.spotify.com","music.youtube.com","figma.com","amazon","wikipedia.org","medium.com","naver.com","canva.com","miro.com","reddit.com","calendly.com","forms.gle"],d=i.getRecordStoreUIParent(),c="page"===s.name?s.blockId:"team"===s.name?s.peekViewBlockId:void 0,u="page"===s.name&&s.scrollToBlockId,m="page"===s.name?s.collectionViewId:void 0;if(c){const e=ee().G.createChildStore(i,{table:Mn().iU,id:c});e.isType("form")&&r.push({name:At().Z.formatMessage(Bn.embed),validator:()=>!jn().f_(i)&&Hn(d)&&(null==a?void 0:a.id)===e.getSpaceId(),type:Ye().Ti.form});const t=u?ee().G.createChildStore(i,{table:Mn().iU,id:u}):void 0;r.push({name:At().Z.formatMessage(Bn.createLinkedViewOfDatabase),validator:()=>!t&&e.isCollectionView()&&!jn().f_(i)&&(!e.isCollectionViewPageWithContent()||!function(e,t){const n=e.getCollectionViewStores(),o=f().sE(n,(e=>e.id===t&&"page"===e.getType()));return Boolean(o)}(e,m))&&!function(e,t){const n=e.getCollectionViewStores(),o=f().sE(n,(e=>e.id===t&&"form_editor"===e.getType()));return Boolean(o)}(e,m)&&(null==a?void 0:a.id)===e.getSpaceId()&&Hn(d)&&Fn(e),type:Ye().Ti.collectionView}),r.push({name:At().Z.formatMessage(void 0===t?Bn.mentionPage:Bn.mentionBlock),validator:()=>Fn(e),type:"mention-page"}),r.push({name:At().Z.formatMessage(Bn.createTransclusionItem),validator:()=>Boolean(t&&!t.isNavigableBlock()&&!jn().f_(i)&&!t.isNonEditableState()&&!t.isNavigableAncestorNonEditableState()&&t.canEdit()&&t.getSpaceId()===(null==a?void 0:a.id)&&Hn(d)&&Fn(e)),type:"create-transclusion"}),X().default.checkGate({gateName:"enable_page_previews"})&&r.push({name:At().Z.formatMessage(Bn.pagePreview),validator:()=>!t&&!e.isCollectionView()&&!jn().f_(i)&&Fn(e)&&Hn(d)&&!e.isType("form"),type:"page-preview"})}const p=wn().XP(Ln);for(const f of p)"embed"!==f&&r.push({name:Ln[f],validator:e=>xn().Wb[f](e)&&Hn(d),type:f});r.push({name:At().Z.formatMessage(Bn.bookmarkMenuItem),validator:e=>!jn().f_(i)&&Hn(d)&&xn().Cm(e),type:Ye().Ti.bookmark}),r.push({name:Ln.embed,validator:e=>!jn().f_(i)&&Hn(d)&&xn().Wb.embed(e),type:"embed"});const g=f().oA(r.map((e=>{let{name:n,validator:i,type:a}=e;if(i({url:o,baseUrl:z().default.domainBaseUrl,publicDomainName:z().default.publicDomainName})){return{key:`embed ${n}`,render:e=>(0,Z.jsx)(Vt().Z,{...e,title:n}),action:()=>On(a,t)}}}))),h={key:"link-mention",render:e=>(0,Z.jsx)(Vt().Z,{...e,title:At().Z.formatMessage(Bn.linkMention),right:(0,Z.jsx)(An().Z,{})}),action:()=>On("link-mention",t)},v={key:"dismiss",render:e=>(0,Z.jsx)(Vt().Z,{...e,title:At().Z.formatMessage(Bn.dismissItem)}),action:()=>Vn(t)};if(0===g.length)return[];(0,Sn().iJ)(s)?g.push(v):(Nn(o,l)?("embed Create bookmark"!==g[0].key||g.reverse(),g.push(v)):g.unshift(v),X().default.checkGate({gateName:"enable_link_mentions"})&&g.splice(0,0,h));const y={key:"embed section",render:e=>(0,Z.jsx)(Ut().Z,{...e}),items:g},b={key:"import section",render:e=>(0,Z.jsx)(Ut().Z,{...e,style:{paddingTop:0,paddingBottom:6}}),items:[{key:"jira-sync",render:e=>(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(Pn().Z,{size:4}),(0,Z.jsx)(Vt().Z,{...e,title:(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(H()._H,{id:"embedMenu.actions.import.jiraTitle",defaultMessage:"Sync Jira projects and issues"}),(0,Z.jsx)(An().Z,{style:{display:"inline"}})]})})]}),action:()=>function(e){var t,n;const o=In().Z.state;if(!o.open)return;const{url:i}=o,a=Q().default.state.mainEditorCurrentBlockStore,r=a&&(null===(t=(0,Tn().VP)(a))||void 0===t?void 0:t.id),s=null===(n=i.match(/\/projects\/(\w+)\//))||void 0===n?void 0:n[1];_n().ZP.setState({..._n().ZP.state,teamSpaceId:r,projectKeys:s?[s]:[]}),kn().jW({environment:e,from:"external_object_instance_block",action:"show_teamspaces"}),(0,It().j)({environment:e,event:{eventName:"external_sync_entry_point",eventProperties:{integration:"jira",flowId:_n().ZP.createNewFlowId(),from:"link_paste_menu"}}}),jn().xv(),Cn().X0(e,{url:i,type:"jira-sync"})}(t)}]};return Nn(o,["atlassian.net/jira","/jira/"])?[y,b]:[y]}function Nn(e,t){return t.some((t=>e.includes(t)))}function Fn(e){const t=e.getSystemBlockTypeStore().getValue();return!(0,bn().bv)(t)}function Hn(e){if(!(e instanceof ee().G))return!1;const t=e.getType();return!!t&&(0,Ye().Um)(t,e.getFormat())}function Kn(){const e=(0,i().O7)(),{device:t}=e,n=(0,a().VK)((()=>{const t=In().Z.state;return t.open?Un(t,e):null}),[e]),r=(0,a().VK)((()=>!!In().Z.state.loading),[]),s=(null==n?void 0:n.length)??0;(0,o.useEffect)((()=>{r||0!==s||jn().xv()}),[s,r]),function(){const e=(0,a().Kw)(In().Z),t=(0,a().Kw)(T().default);(0,o.useEffect)((()=>{if(e.open&&"editing"===t.mode){const{multiSelection:n}=t;(0,M().qS)(n)&&n.start.store.id===e.textStore.id&&n.end.index===e.urlSelection.endIndex||jn().xv()}}),[e,t])}();const l=(0,Ie().yK)((e=>({header:t.isMobile?{display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,fontWeight:Ze().Ue.semibold,background:e.surface.wash,height:45}:{paddingLeft:16,paddingRight:16,paddingTop:10,color:e.text.secondary,fontSize:Ze().JB.UISmall.desktop,fontWeight:450,fontStyle:"normal",font:"SF Pro"}})),[t]);if(null===n)return null;let d;return d=t.isMobile?{menuType:S().o.ActionSheet}:{menuType:S().o.Popup,width:n.some((e=>"import section"===e.key))?260:200,maxHeight:"40vh"},(0,Z.jsx)(Z.Fragment,{children:r?(0,Z.jsx)(Zn().Z,{style:{marginLeft:3,marginRight:3}}):(0,Z.jsx)(b().Z,{...d,className:Pt().srZ,header:(0,Z.jsx)(zt().Z,{style:l.header,isSmall:!t.isMobile,isSecondaryColor:!t.isMobile,children:(0,Z.jsx)(H()._H,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,Z.jsx)(Ot().ZP,{type:Ot().iW.Vertical,sections:n,initialFocus:0})})})}var En=()=>n(423402),Wn=()=>n(546438);function zn(){const e=(0,i().O7)(),t=e.currentUser.id,n=(0,a().VK)((()=>{var e;return null===(e=Q().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),r=(0,a().VK)((()=>(0,Wn().W)({isPhone:e.device.isPhone,spaceStore:Q().default.state.currentSpaceStore})),[e.device]);return(0,o.useEffect)((()=>{if(!n||!t||!r)return;const o=Y().ZP.addListener((0,N().iX)({notionUserId:t,spaceId:n}),(0,Y().Qk)(((t,n,o,i)=>{-1!==i&&Gn(e)})),void 0,e);return function(){o&&Y().ZP.removeListener(o,e)}}),[e,t,n,r]),null}const Gn=(0,f().Ds)((e=>{En().pJ({environment:e})}),5e3,{leading:!0,trailing:!0});var qn=()=>n(492788),Yn=()=>n(225339),$n=()=>n(370668),Jn=()=>n(374844),Qn=()=>n(827282);const Xn=(0,Qn().IU)("collapse",{viewBox:"0 0 16 16",svg:(0,Z.jsx)("path",{d:"M2.477 7.51h3.787c.396 0 .701-.106.916-.32.214-.22.321-.525.321-.917V2.534a.723.723 0 00-.745-.745.731.731 0 00-.54.212.736.736 0 00-.205.533v.486l.15 2.146-1.6-1.682-1.968-1.982a.695.695 0 00-.52-.219.791.791 0 00-.574.219.736.736 0 00-.219.554.78.78 0 00.055.294.917.917 0 00.17.253L3.482 4.57l1.675 1.593-2.153-.143h-.526a.723.723 0 00-.746.745.723.723 0 00.746.745zm6.74 6.912a.71.71 0 00.526-.212.7.7 0 00.212-.526v-.554l-.143-2.14 1.6 1.682 2.002 2.016a.69.69 0 00.526.22c.224 0 .41-.074.561-.22a.725.725 0 00.226-.553.707.707 0 00-.062-.294.728.728 0 00-.164-.246l-2.01-2.017-1.688-1.586 2.16.144h.588a.736.736 0 00.533-.205.711.711 0 00.219-.534.72.72 0 00-.219-.54.723.723 0 00-.533-.211H9.702c-.392 0-.697.109-.916.328-.214.214-.321.517-.321.909v3.8a.7.7 0 00.212.527.746.746 0 00.54.212z"})});var eo=()=>n(945719),to=()=>n(698005),no=()=>n(159732),oo=()=>n(602299),io=()=>n(492522),ao=()=>n(568017),ro=()=>n(491927),so=()=>n(64880),lo=()=>n(611253),co=()=>n(453999),uo=()=>n(879952),mo=()=>n(84080),po=()=>n(472753),go=()=>n(255313),fo=()=>n(628370),ho=()=>n(265640),vo=()=>n(748621);const yo={background:"rgba(255, 255, 255, 0.055)"},bo={padding:"6px 10px 6px 6px"},xo={padding:"6px 6px 6px 10px"},So={display:"flex",borderRadius:4,background:ao().ZP.blackWithAlpha(.65)},Mo=.5,wo=.5,Co=2,jo=-.002,ko=-.004;function To(e){let{visible:t,isOpen:n,zoomScale:o,handleZoomIn:r,handleZoomOut:s,handleNext:l,handlePrevious:d,setZoomScale:c,disableZoomEditing:u,enableZoomEditing:m,resetHideControlsTimeout:p,clearHideControlsTimeout:f,isSaving:h,isEditingZoom:v,handleClose:y}=e;const b=(0,i().Fy)(),x=(0,i().O7)(),{blockStore:S,imageUrl:M}=(0,a().VK)((()=>({blockStore:go().default.state.blockStore,imageUrl:go().default.state.imageUrl})),[]),w=(0,a().VK)((()=>{var e;return Boolean(S&&(M||(null===(e=S.getProperties())||void 0===e?void 0:e.source)&&g().QaF(S.getProperties().source)))}),[S,M]);if(b.isMobile)return null;return(0,Z.jsxs)(fo().Z,{visible:t,initial:{opacity:1},exit:{opacity:0},animate:{opacity:1},style:Do(n),onClick:e=>{!function(e){e.stopPropagation()}(e),p(),u()},children:[(0,Z.jsx)("div",{style:{...So,marginRight:10},children:(0,Z.jsx)(_o,{handlePrevious:d,handleNext:l})}),(0,Z.jsxs)("div",{style:So,children:[(0,Z.jsx)(Io,{zoomScale:o,handleZoomIn:r,handleZoomOut:s,setZoomScale:c,disableZoomEditing:u,enableZoomEditing:m,isEditingZoom:v}),(0,Z.jsx)(Ho,{}),w?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(Po,{onClick:()=>{if(!S||!w)return;go().default.setState({...go().default.state,isSaving:!0}),f();const e=null==S?void 0:S.getProperties();let t,n;if(t=M||g().QaF(null==e?void 0:e.source),t){if((0,Yn().iS)(t)){const o=g().QaF(null==e?void 0:e.title)||(0,Yn().w2)(t);n=so().ji(x,{url:t,download:!0,downloadName:o,permissionRecord:S.pointer})}else{const o=g().QaF(null==e?void 0:e.caption);n=(0,Yn()._H)(t,null==S?void 0:S.pointer,z().default.domainBaseUrl,x.currentUser.id,o)}n.then((()=>{go().default.setState({...go().default.state,isSaving:!1}),ro().Lf(x,{type:"download",triggered_by:"click"}),p()}))}},loading:h}),(0,Z.jsx)(Ho,{})]}):void 0,(0,Z.jsx)(Zo,{onClick:y})]})]})}function Io(e){let{zoomScale:t,handleZoomIn:n,handleZoomOut:a,setZoomScale:r,disableZoomEditing:s,enableZoomEditing:l,isEditingZoom:d}=e;const c=(100*t).toFixed(0),u=(0,i().O7)(),m=(0,o.useCallback)((e=>{const t=e.target,n=parseInt(t.value);if(!isNaN(n)){const e=n/100;ro().Lf(u,{type:"set_zoom",new_zoom:e}),r(e)}s()}),[s,u,r]);return(0,Z.jsxs)("div",{style:{alignItems:"center",display:"flex",height:"100%",justifySelf:"flex-start"},children:[(0,Z.jsx)(Ue().Z,{renderTooltip:()=>(0,Z.jsx)(Fo,{primaryText:(0,Z.jsx)(H()._H,{id:"fullScreenRenderer.zoomOut",defaultMessage:"Zoom out"}),secondaryText:"-"}),disableTooltip:t<=wo,render:e=>(0,Z.jsx)(ho().D,{...e,disabled:t<=wo,style:{...Uo(t<=wo),...xo},onClick:a,icon:e=>(0,to().$)({...e,fill:Vo(),height:16,margin:0,width:16})})}),d?(0,Z.jsx)(Ao,{initialValue:c,onSubmit:m,onCancel:s,primaryColor:Vo(),secondaryColor:Oo()}):(0,Z.jsx)(ho().D,{onClick:e=>{e.stopPropagation(),l()},style:{color:Oo(),margin:0,width:46,padding:0,justifyContent:"center"},children:`${c}%`}),(0,Z.jsx)(Ue().Z,{renderTooltip:()=>(0,Z.jsx)(Fo,{primaryText:(0,Z.jsx)(H()._H,{id:"fullScreenRenderer.zoomIn",defaultMessage:"Zoom in"}),secondaryText:"+"}),disableTooltip:t>=Co,render:e=>(0,Z.jsx)(ho().D,{...e,disabled:t>=Co,style:Uo(t>=Co),onClick:n,icon:e=>(0,no().R)({...e,fill:Vo(),height:16,margin:0,width:16})})})]})}function _o(e){let{handlePrevious:t,handleNext:n}=e;const o=(0,Z.jsx)("div",{}),{blockStore:i,allImageBlocksOnPage:r}=(0,a().VK)((()=>{const{blockStore:e}=go().default.state;return{blockStore:e,allImageBlocksOnPage:e?Bo():[]}}),[]);if(!i)return o;if(r.length<=1)return o;const s=r.findIndex((e=>e.id===(null==i?void 0:i.id)))??-1;if(-1===s)return o;const l=r.length;return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(Ue().Z,{renderTooltip:()=>(0,Z.jsx)(Fo,{primaryText:(0,Z.jsx)(H()._H,{id:"fullScreenRenderer.previous",defaultMessage:"Back"}),secondaryText:(0,Z.jsx)(No,{imageIndex:s-1,totalImageCount:l})}),disableTooltip:0===s,render:e=>(0,Z.jsx)(ho().D,{...e,disabled:s<=0,style:{...Uo(s<=0),...xo},hoveredStyle:yo,onClick:()=>t(),icon:e=>(0,$n().V)({...e,fill:Vo(),height:16,margin:0,width:16})})}),(0,Z.jsx)(Ue().Z,{renderTooltip:()=>(0,Z.jsx)(Fo,{primaryText:(0,Z.jsx)(H()._H,{id:"fullScreenRenderer.next",defaultMessage:"Next"}),secondaryText:(0,Z.jsx)(No,{imageIndex:s+1,totalImageCount:l})}),disableTooltip:s+1===l,render:e=>(0,Z.jsx)(ho().D,{...e,disabled:s>=l-1,style:{...Uo(s>=l-1),...bo},hoveredStyle:yo,onClick:()=>n(),icon:e=>(0,Jn().n)({...e,fill:Vo(),height:16,margin:0,width:16})})})]})}function Po(e){let{onClick:t,loading:n}=e;return(0,Z.jsx)(Ue().Z,{renderTooltip:()=>(0,Z.jsx)(Fo,{primaryText:(0,Z.jsx)(H()._H,{id:"fullScreenRenderer.download",defaultMessage:"Download"})}),render:e=>(0,Z.jsx)(ho().D,{...e,disabled:n,onClick:t,style:Uo(!1),hoveredStyle:yo,children:n?(0,Z.jsx)(Zn().Z,{size:"sm"}):(0,eo().a)({fill:Vo(),width:16})})})}function Zo(e){let{onClick:t}=e;return(0,Z.jsx)(Ue().Z,{renderTooltip:()=>(0,Z.jsx)(Fo,{primaryText:(0,Z.jsx)(H()._H,{defaultMessage:"Close",id:"fullscreenRenderer.closeButton.label"}),secondaryText:"esc"}),render:e=>(0,Z.jsx)(ho().D,{...e,onClick:t,style:{...Uo(!1),...bo},hoveredStyle:yo,icon:e=>Xn({...e,fill:Vo(),height:16,margin:0,width:16})})})}function Ao(e){const[t,n]=(0,o.useState)(e.initialValue);return(0,Z.jsx)(Wt().Z,{style:{width:46,color:e.primaryColor},inputStyle:{textAlign:"center",border:"solid 1px rgba(45, 156, 219, 0.72)",borderRadius:4,boxShadow:"0px 0px 0px 3px rgba(45, 156, 219, 0.2)"},onClick:e=>e.stopPropagation(),onChange:e=>{const t=e.target;n(t.value)},value:t,onSubmit:e.onSubmit,focusInitial:!0,selectAll:!0,format:Wt().B.Transparent,right:(0,Z.jsx)("span",{style:{color:e.secondaryColor},children:"%"}),onKeyDown:t=>{t.stopPropagation(),"Escape"===t.key?e.onCancel():"Tab"===t.key&&e.onSubmit(t)}})}const Ro=function(){const e=(0,i().O7)(),t=(0,o.useRef)(!1),r=(0,o.useRef)(),s=(0,o.useRef)(),[l,d]=(0,o.useState)(!1),[c,u]=(0,o.useState)(void 0),[m,p]=(0,o.useState)(!1),{isOpen:g,rendered:h,fullScreenNodeRect:v,fullscreenNodeAnimationComplete:y,contentAspectRatio:b,zoomScale:x,panOffset:S,skipAnimations:M,isSaving:w,blockStore:C,panStartPosition:j}=(0,a().VK)((()=>{var e;const{state:t}=go().default;return{isOpen:t.isOpen,rendered:null===(e=t.renderFullScreenNode)||void 0===e?void 0:e.call(t),fullScreenNodeRect:t.fullScreenNodeRect,fullscreenNodeAnimationComplete:t.fullscreenNodeAnimationComplete,contentAspectRatio:t.contentAspectRatio,zoomScale:t.zoomScale,panOffset:t.panOffset,skipAnimations:t.skipAnimations,isSaving:Boolean(t.isSaving),blockStore:t.blockStore,panStartPosition:t.panStartPosition}}),[]),k=(0,a().VK)((()=>{const t=e.WindowSizeStore.state.width;return lo().zp(t)}),[e.WindowSizeStore]);(0,n(36296).Z)({capture:g,preventType:Xe().Z.All});const T=(0,o.useCallback)((()=>{r.current&&clearTimeout(r.current)}),[]),I=(0,o.useCallback)((()=>{p(!0),T(),l||w||(r.current=setTimeout((()=>p(!1)),2e3))}),[T,l,w]),_=(0,o.useCallback)((e=>{I();const t=Math.max(Math.min(e,Co),wo),n=t<=1?{x:0,y:0}:S;go().default.setState({...go().default.state,zoomScale:t,panOffset:n})}),[S,I]),P=(0,o.useCallback)((e=>{const t=zo(e,c);t&&(e.x!==t.x&&(j.x=j.x+(e.x-t.x)),e.y!==t.y&&(j.y=j.y+(e.y-t.y)),go().default.setState({...go().default.state,panOffset:t,panStartPosition:j}))}),[c,j]),A=(0,o.useCallback)((()=>{d(!1),go().default.setState({...go().default.state,zoomScale:1,panStartPosition:{x:0,y:0},panOffset:{x:0,y:0}})}),[]),R=(0,o.useCallback)((()=>{d(!0),T()}),[T]),B=(0,o.useCallback)((()=>{d(!1),I()}),[I]),L=(0,o.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];lo().xv(),ro().Lf(e,{type:"close",triggered_by:t?"keypress":"click"}),uo().ZH({environment:e}),Wo(),qn().default.afterNextFlush((()=>{A()}))}),[e,A]),V=(0,o.useCallback)((e=>{(0,D().uG)(e)||L()}),[L]),O=(0,o.useCallback)((e=>{if(e.stopPropagation(),(0,D().uG)(e))return;let t,n;t=x<1?1:x<1.5?1.5:1,n=t<=1?{x:0,y:0}:zo({x:(window.innerWidth/2-e.clientX)/(t/(t-1)),y:(window.innerHeight/2-e.clientY)/(t/(t-1))},c)??S,go().default.setState({...go().default.state,zoomScale:t,panOffset:n}),I(),B()}),[c,B,S,I,x]),U=(0,o.useCallback)((function(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!C)return;const o=Bo();if(!o)return;const i=o.findIndex((e=>e.id===C.id));if(i+t<0||i+t>=o.length)return;ro().Lf(e,{type:t>0?"next":"previous",image_count:o.length,image_index:i+t,triggered_by:n?"keypress":"click"}),go().default.setState({...go().default.state,skipAnimations:!0}),s.current&&clearTimeout(s.current),s.current=setTimeout((()=>{go().default.setState({...go().default.state,skipAnimations:!1})}),250);const a=o[i+t];co().dK({environment:e,blockStore:a}),A()}),[C,e,A]),N=(0,o.useCallback)((function(){U(-1,arguments.length>0&&void 0!==arguments[0]&&arguments[0])}),[U]),F=(0,o.useCallback)((function(){U(1,arguments.length>0&&void 0!==arguments[0]&&arguments[0])}),[U]),H=(0,o.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=Math.ceil(2*(x-Mo))/2;x-n<.25&&(n-=Mo),ro().Lf(e,{type:"zoom_out",new_zoom:n,triggered_by:t?"keypress":"click"}),_(n)}),[e,_,x]),K=(0,o.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=Math.floor(2*(x+Mo))/2;n-x<.25&&(n+=Mo),ro().Lf(e,{type:"zoom_in",new_zoom:n,triggered_by:t?"keypress":"click"}),_(n)}),[e,_,x]),E=(0,o.useCallback)((e=>{c&&1===e.buttons&&Lo()&&P({x:e.clientX/x-j.x,y:e.clientY/x-j.y})}),[c,j.x,j.y,P,x]),W=(0,o.useCallback)((e=>{switch(e.key){case"+":case"=":K(!0);break;case"-":case"_":H(!0)}}),[K,H]);(0,o.useEffect)((()=>{const e=e=>{_(x+e)},n=t=>{g&&(t.preventDefault(),t.ctrlKey?t.deltaY?e(t.deltaY*ko):t.deltaX&&e(t.deltaX*ko):t.metaKey?t.deltaY?e(t.deltaY*jo):t.deltaX&&e(t.deltaX*jo):Lo()&&P({x:S.x-t.deltaX,y:S.y-t.deltaY}))};return g&&(window.addEventListener("wheel",n,{passive:!1}),t.current=!0),()=>{window.removeEventListener("wheel",n),t.current=!1}}),[g,S.x,S.y,P,_,x]);const z=window.innerWidth,G=window.innerHeight-2*k;let q=z-2*k;const Y=b??(v?v.width/v.height:void 0);if(void 0===Y)return null;let $=q/Y;if($>G){const e=$/G;$/=e,q/=e}const J={opacity:0},Q={scale:x,opacity:1,translateX:S.x,translateY:S.y,width:"100%",height:"100%"};let X;return X=m?x>=1.5?"zoom-out":"zoom-in":"none",(0,Z.jsx)(vo().Z,{open:g||!y,children:(0,mo().Z)((e=>(0,Z.jsx)(tt().Z,{debugName:"FullScreenRenderer",capture:g,onEsc:()=>{L(!0)},onEnter:f().yR,onSpace:()=>L(!0),onCommandEnter:()=>L(!0),onCommandShiftEnter:f().yR,onCommandSlash:f().yR,onUp:f().yR,onDown:f().yR,onDelete:f().yR,onBackspace:f().yR,onLeft:()=>N(!0),onRight:()=>F(!0),onUntab:f().yR,onTab:f().yR,onSelectAll:f().yR,onRedo:f().yR,onUndo:f().yR,onToggleBold:f().yR,onToggleItalics:f().yR,onToggleStrike:f().yR,onToggleCode:f().yR,onCut:f().yR,onCopy:f().yR,onPaste:f().yR,onKeypress:W,children:(0,Z.jsxs)("div",{style:Go({isOpen:g,showControls:m}),...e,onClick:V,onMouseMove:I,children:[g&&(0,Z.jsx)(n(470725).m,{}),(0,Z.jsx)(fo().Z,{visible:g,initial:J,exit:J,animate:Q,skip:M,forceCompositeLayer:!0,style:{display:"flex",cursor:X,maxWidth:q,maxHeight:$,justifyContent:"center"},ref:e=>{e&&!c&&u({width:e.clientWidth,height:e.clientHeight})},onClick:O,onMouseDown:Eo,onMouseUp:Wo,onMouseLeave:Wo,onMouseMove:E,onAnimationEnd:Ko,children:h}),(0,Z.jsx)(To,{visible:m,isOpen:g,zoomScale:x,handleZoomIn:K,handleZoomOut:H,handlePrevious:N,handleNext:F,setZoomScale:_,disableZoomEditing:B,enableZoomEditing:R,clearHideControlsTimeout:T,resetHideControlsTimeout:I,isSaving:w,isEditingZoom:l,handleClose:L})]})})))})};function Bo(){const{blockStore:e}=go().default.state;if(!e)return[];if(function(){const{blockStore:e}=go().default.state;return(null==e?void 0:e.getParentTable())===oo().x_}()){return e.getParentStore().getContentStores().filter((e=>"image"===e.getType())).filter((e=>Boolean(e.getProperties().source)))}const t=Dt().default.getCurrentRootStore();return po().R.getMembersByDOMOrder({filter:e=>"image"===e.renderedType&&Boolean(e.getBlockStore().findRecordStoreUIAncestor((e=>Boolean(t&&e===t))).ancestor)}).map((e=>e.getBlockStore())).filter((e=>Boolean(e.getProperties().source)))}function Lo(){const{zoomScale:e}=go().default.state;return e>1}function Do(e){return{bottom:30,display:e?"flex":"none",fontSize:14,left:"50%",lineHeight:1.2,position:"absolute",transform:"translate(-50%, 0)"}}function Vo(){return ao().ZP.white}function Oo(){return ao().ZP.whiteWithAlpha(.5)}function Uo(e){return{borderRadius:4,opacity:e?.4:1,padding:6}}function No(e){let{imageIndex:t,totalImageCount:n}=e;return(0,Z.jsx)(H()._H,{values:{currentIndex:t+1,totalCount:n},defaultMessage:"{currentIndex} of {totalCount}",id:"fullscreenRenderer.imageCount.label"})}function Fo(e){const{primaryText:t,secondaryText:n}=e;return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("span",{style:{marginRight:n?4:void 0},children:t}),n?(0,Z.jsx)("span",{style:{color:Oo()},children:n}):void 0]})}function Ho(){return(0,Z.jsx)("span",{style:{borderLeft:`1px solid ${ao().ZP.whiteWithAlpha(.25)}`,height:"100%"}})}function Ko(){const{isOpen:e}=go().default.state;e||go().default.setState({...go().default.state,fullscreenNodeAnimationComplete:!0})}function Eo(e){const{panOffset:t,zoomScale:n}=go().default.state;go().default.setState({...go().default.state,panStartPosition:{x:e.clientX/n-t.x,y:e.clientY/n-t.y},skipAnimations:!0})}function Wo(){go().default.setState({...go().default.state,skipAnimations:!1})}function zo(e,t){if(!t)return;let n,o;n=t.width*Co>window.innerWidth?(t.width*Co-window.innerWidth)/(2*Co):(window.innerWidth-t.width*Co)/(2*Co),o=t.height*Co>window.innerHeight?(t.height*Co-window.innerHeight)/(2*Co):(window.innerHeight-t.height*Co)/(2*Co);return{x:Math.min(Math.max(e.x,-1*n),n),y:Math.min(Math.max(e.y,-1*o),o)}}function Go(e){const{isOpen:t,showControls:n}=e;return{zIndex:io().mJ,position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:t?"auto":"none",cursor:n?void 0:"none"}}var qo=()=>n(878517),Yo=()=>n(198732),$o=()=>n(339523),Jo=()=>n(550054),Qo=()=>n(762557);const Xo=function(){const e=(0,i().O7)(),t=(0,o.useRef)(null),r=(0,o.useCallback)((n=>function(e,t,n){if(!Qo().Z.isOpen())return;if(!n.current)return;const o=n.current.getSelection();if(!o)return;const i=Qo().Z.state.value.length;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&o.startIndex===i&&o.endIndex===i&&(ni(t),Yo().Wj())}(n,e,t)),[e]),s=(0,o.useCallback)((n=>function(e,t,n){if(!n.current)return;const o=n.current.getSelection();if(!o)return;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&0===o.startIndex&&0===o.endIndex&&(ni(t),Yo().Wj(Qo().P.Backward))}(n,e,t)),[e]),l=(0,o.useCallback)((()=>ni(e)),[e]),c=(0,a().VK)((()=>Qo().Z.state),[]),u=(0,a().VK)((()=>function(){if(!Qo().Z.isOpen())return;return Qo().Z.state.savedTextSelectionRect}()),[]),m=(0,a().VK)((()=>function(){var e;if("editing"!==T().default.state.mode&&!Qo().Z.isOpen())return!0;const t=Qo().Z.isOpen()?null===(e=(0,M().QY)(Qo().Z.state.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store:void 0;if(t&&!t.canEdit())return!0;if(t){const e=(0,$o().J2)(t);if(e&&e.isNonEditableState())return!0}const n={[g().GKr.User]:g().GKr.User,[g().GKr.Page]:g().GKr.Page,[g().GKr.CustomEmoji]:g().GKr.CustomEmoji,[g().GKr.Comment]:g().GKr.Comment,[g().GKr.Bot]:g().GKr.Bot,[g().GKr.Date]:g().GKr.Date,[g().GKr.ExternalObjectInstance]:g().GKr.ExternalObjectInstance,[g().GKr.TemporaryPage]:g().GKr.TemporaryPage,[g().GKr.TemplateVariable]:g().GKr.TemplateVariable,[g().GKr.FormulaPageProperty]:g().GKr.FormulaPageProperty,[g().GKr.FormulaContextValue]:g().GKr.FormulaContextValue,[g().GKr.Group]:g().GKr.Group,[g().GKr.Team]:g().GKr.Team,[g().GKr.Citation]:g().GKr.Citation,[g().GKr.LinkMention]:g().GKr.LinkMention,[g().GKr.AssistantInstructionsCollection]:g().GKr.AssistantInstructionsCollection,[g().GKr.GeoPoint]:g().GKr.GeoPoint};for(const o of Object.values(n))if((0,Jo().J6)(o))return!0;return!1}()),[]);if(!c.open)return null;const p=c.value,f=c.error;return(0,Z.jsx)(d().ev,{dependency:n(315605).o,children:e=>c.open?(0,Z.jsx)(n(890631).Z,{Prism:e,ref:t,isOpen:!0,equationValue:p,error:f,displayMode:"inline",disabled:m,originRect:u,originGap:8,onDismiss:ti,onChange:ei,onSubmit:l,onLeft:s,onRight:r}):null})};function ei(e,t){Qo().Z.isOpen()&&Qo().Z.setState({...Qo().Z.state,value:e,error:t})}function ti(){Yo().Wj()}function ni(e){y().createAndCommit({userAction:"InlineEquationOverlay.handleSubmit",environment:e,canUndo:!0,perform:t=>{Yo().gt({environment:e,equationStore:Qo().Z,transaction:t})}})}var oi=()=>n(905),ii=()=>n(250625),ai=()=>n(490091),ri=()=>n(788206);function si(e){switch(e){case ai().Z.Preview:return(0,Z.jsx)(H()._H,{id:"internalUnfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Preview"});case ai().Z.Mention:return(0,Z.jsx)(H()._H,{id:"internalUnfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Mention"});case ai().Z.Link:return(0,Z.jsx)(H()._H,{id:"internalUnfurlingMenu.actions.pasteAsLink.title",defaultMessage:"Link"});default:(0,pe().t1)(e)}}const li=function(){const e=(0,i().O7)(),t=(0,o.useRef)(null),[n]=(0,a().AF)(ri().Z),r=(0,o.useCallback)((t=>{if(n.open){var o;if(!t)oi().pg({actionType:n.focusedIndex,environment:e,commentStore:null===(o=n.args.commentStore)||void 0===o?void 0:o.state,useTempStores:!1});ri().Z.setState({open:!1})}}),[e,n]),s=(0,o.useCallback)((e=>{n.open&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&r(void 0)}),[r,n.open]),l=(0,o.useCallback)((e=>{if(!n.open||!e.target)return;const o=t.current;o&&(o.contains(e.target)||r(void 0))}),[r,n.open]);(0,o.useEffect)((()=>((0,ii().lj)(window,"keydown",s),(0,ii().lj)(window,"mousedown",l),()=>{(0,ii().ZV)(window,"keydown",s),(0,ii().ZV)(window,"mousedown",l)})),[s,l]);const d=(0,o.useRef)(!1);function c(t){var o;n.open&&void 0!==t.indexGlobal&&(ri().Z.setState({...n,focusedIndex:t.indexGlobal}),oi().pg({actionType:t.indexGlobal,environment:e,commentStore:null===(o=n.args.commentStore)||void 0===o?void 0:o.state,useTempStores:!0}))}(0,a().VK)((()=>{var t,o;const i=(n.open&&(null===(t=n.args.commentStore)||void 0===t?void 0:t.state)&&(null===(o=n.args.commentStore.state)||void 0===o?void 0:o.isReady()))??!1;var a;i&&!d.current&&n.open&&oi().pg({actionType:n.focusedIndex,environment:e,commentStore:null===(a=n.args.commentStore)||void 0===a?void 0:a.state,useTempStores:!0});d.current=i}),[e,n]);const u=(0,a().VK)((()=>e.device.isMobileNative&&!e.device.isTablet),[e]),m=e.device.isMobile;return(0,Z.jsx)(x().ZP,{popupType:u?j().k.SlideUp:j().k.Popup,open:n.open,originRect:n.open?n.selectionRect:void 0,placementToOrigin:C().Placement.Top,alignmentToOrigin:C().Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:m,keepFocus:m,render:function(){var o;const{device:i}=e;if(!n.open)return;const a=function(t){const{url:n,args:o}=t,i=[];i.push({title:si(ai().Z.Preview),validator:()=>!0,type:ai().Z.Preview}),i.push({title:si(ai().Z.Mention),validator:()=>!0,type:ai().Z.Mention}),i.push({title:si(ai().Z.Link),validator:()=>!0,type:ai().Z.Link});return[{key:"menu section",render:e=>(0,Z.jsx)(Ut().Z,{...e}),items:f().oA(i.map((t=>{let{title:i,validator:a,type:r}=t;if(a({url:n,baseUrl:z().default.domainBaseUrl,publicDomainName:z().default.publicDomainName})){return{key:`item ${r}`,render:t=>(0,Z.jsx)(Vt().Z,{...t,title:i,onMouseEnter:n=>{var i;t.onMouseEnter(n),oi().pg({actionType:r,environment:e,commentStore:null===(i=o.commentStore)||void 0===i?void 0:i.state,useTempStores:!0})}}),action:()=>{var t;return oi().pg({actionType:r,environment:e,commentStore:null===(t=o.commentStore)||void 0===t?void 0:t.state,useTempStores:!1})}}}})))}]}(n),r=i.isMobile?{display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,fontWeight:Ze().Ue.semibold,height:45}:{paddingLeft:16,paddingRight:16,paddingTop:10,fontWeight:Ze().Ue.semibold};let s;return s=i.isMobile?{menuType:S().o.ActionSheet}:{menuType:S().o.Popup,width:200,maxHeight:"40vh"},null!==(o=n.args.commentStore)&&void 0!==o&&o.state&&n.args.commentStore.state.isReady()?(0,Z.jsx)(b().Z,{...s,className:Pt().srZ,ref:t,header:(0,Z.jsx)(zt().Z,{style:r,isSmall:!i.isMobile,isSecondaryColor:!i.isMobile,children:(0,Z.jsx)(H()._H,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,Z.jsx)(Ot().ZP,{type:Ot().iW.Vertical,sections:a,onKeyboardArrow:c,initialFocus:0,priority:1,disallowBackspace:!0})}):(0,Z.jsx)(b().Z,{...s,className:Pt().srZ,ref:t,header:(0,Z.jsx)(zt().Z,{style:r,isSmall:!i.isMobile,isSecondaryColor:!i.isMobile,children:(0,Z.jsx)(H()._H,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,Z.jsx)(Ut().Z,{style:{display:"flex",justifyContent:"center"},children:(0,Z.jsx)(Zn().Z,{})})})},onDismiss:()=>r(void 0)})};var di=()=>n(719542),ci=(n(470928),()=>n(627817)),ui=()=>n(81821),mi=()=>n(209628),pi=()=>n(10271),gi=()=>n(695793),fi=()=>n(257934),hi=()=>n(263184);class vi extends hi().default{getInitialState(){return{formulaTypecheckContextValue:void 0}}}const yi=vi;var bi=()=>n(543842),xi=()=>n(200936),Si=()=>n(731424),Mi=()=>n(766933),wi=()=>n(92960),Ci=()=>n(177634),ji=()=>n(984478),ki=()=>n(775404),Ti=()=>n(483586),Ii=()=>n(899548),_i=()=>n(582900),Pi=()=>n(463212),Zi=()=>n(338530);function Ai(e){return"+"===e.insertionType?(0,Z.jsx)(Ri,{}):(0,Z.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,Z.jsx)(Vi,{svg:Ii().R.__iconDefinition.svg,viewBox:Ii().R.__iconDefinition.viewBox})})}function Ri(){return(0,Z.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,Z.jsx)(Vi,{svg:no().R.__iconDefinition.svg,viewBox:no().R.__iconDefinition.viewBox})})}function Bi(){return(0,Z.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,Z.jsx)(Vi,{svg:Ti().f.__iconDefinition.svg,viewBox:Ti().f.__iconDefinition.viewBox})})}function Li(){return(0,Z.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,Z.jsx)(Vi,{svg:ki().p.__iconDefinition.svg,viewBox:ki().p.__iconDefinition.viewBox})})}function Di(e){const{pageStore:t,theme:n,isSafariOrIOS:o,emojiType:i,currentUserId:a}=e;return(0,Pi().tp)({pageModel:t.getModel(),pageRole:t.getRole(),showEmojiInline:!0,emojiType:i,baseUrl:z().default.domainBaseUrl,getRecordModel:t.getRecordModel,isClient:!0,isSafariOrIOS:o,currentUserId:a,theme:n,emojiData:Zi().Z.state})}function Vi(e){const{svg:t,viewBox:n}=e,i=(0,o.useMemo)((()=>{const e=_i().Z.renderToString((0,Z.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:n,children:t}));return`url("${`data:image/svg+xml,${encodeURIComponent(e)}`}")`}),[t,n]),a=(0,Ie().yK)((e=>({container:{width:"100%",height:"100%",backgroundColor:e.mediumIconColor,WebkitMaskImage:i,maskImage:i,WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat"}})),[i]);return(0,Z.jsx)("div",{style:a.container})}function Oi(){return(0,ge().bq)()?400:330}var Ui=()=>n(504008);class Ni extends hi().default{getInitialState(){}}const Fi=new Ni;function Hi(e){const{isFirefox:t}=(0,i().Fy)();return(0,o.useCallback)((n=>{Ui().Z.withListenerIgnored((()=>{var o;const i=bi().Z.state;if(!i.open)return;if(!n)return void i.temporaryInputData.setState(void 0);const{title:a,icon:r,allowTabCompletion:s}=n,l=e.current??"",d=a.toLowerCase().startsWith(l)?i.oldTextValue&&0!==(null===(o=i.oldTextValue)||void 0===o?void 0:o.length)?"":a.slice(l.length):"";Fi.setState(s?d:void 0);const c=t?void 0:r;i.temporaryInputData.setState({prefix:i.insertionType,suffix:"[["===i.insertionType&&l.endsWith("]]")?"]]":"",completion:d,prefixIcon:c})}))}),[e,t])}const Ki=(0,H().vU)({backButtonAriaLabel:{defaultMessage:"Back",id:"formulaMentionMenu.backButton.ariaLabel"},possessiveContextValueProperty:{defaultMessage:"{contextValueName}'s {propertyName}",id:"formulaMentionMenu.possessiveContextValueProperty.title"}}),Ei=o.memo((function(e){const{mentionMenuCurrentFormulaStore:t,queryRef:n}=e,r=(0,a().VK)((()=>Oi()),[]),s=(0,a().VK)((()=>{const e=t.state.formulaTypecheckContextValue;if(e&&e.kind===wi().FormulaContextValueKind.ContextValue)return e}),[t]),l=function(e){const{contextValue:t,queryRef:n,setTemporaryInputData:o}=e,r=(0,i().O7)(),s=(0,H().YB)(),l=(0,a().VK)((()=>{if(!t)return;const e=_t().RF();return e?function(e,t){const n=function(e){if("block"!==e.type.type||!(0,pe().$K)(e.type.collection))return;return e.type.collection}(t);if(!n)return;const o=ee().NW.createChildStore(e,n);return o.getSchema()}(e,t):void 0}),[t]);if(!t||!l)return[];const d=(0,Ci().NP)(t);return(0,f().oA)(Object.entries(l).map((e=>{let[i,a]=e;if(a&&wi().FORMULAS_SUPPORTED_COLLECTION_PROPERTY_TYPES.includes(a.type))return{action:e=>{y().createAndCommit({userAction:"FormulaMentionMenu.menuItem",environment:r,canUndo:!0,perform:o=>{const l=(0,g().kbv)({contextValueId:t.id,name:(0,Si().sB)(s,d,a.name),property:i,valueSnapshot:"current"});ci().RL({annotations:[l],editorMode:"default",environment:r,mentionType:"formulaContextVariable",menuListItemAction:e,query:n.current??"",transaction:o})}})},key:`formula property ${i}`,render:e=>(e.focused&&o({allowTabCompletion:!0,icon:(0,Z.jsx)(Li,{}),title:s.formatMessage(Ki.possessiveContextValueProperty,{contextValueName:d,propertyName:a.name})}),(0,Z.jsx)(Vt().Z,{...e,icon:(0,Z.jsx)(Wi,{children:Mi().wG[a.type]({height:17,width:17})}),title:a.name}))}})))}({contextValue:s,queryRef:n,setTemporaryInputData:Hi(n)}),d=function(e){const{contextValue:t,items:n,mentionMenuCurrentFormulaStore:i}=e,a=(0,H().YB)(),r=(0,o.useCallback)((()=>{i.setState({formulaTypecheckContextValue:void 0}),bi().Z.updateOpenState({showFormulaProperty:!1})}),[i]),s=(0,Ie().yK)((()=>({backButton:{height:20,width:20},backButtonIcon:{width:17},sectionDesktopTitle:{paddingInline:10},titleHeader:{display:"inline-flex",alignItems:"center",gap:2}})),[]);if(0===n.length||!t)return[];const l=(0,Ci().NP)(t);return[{items:n,key:"formula properties section",render:e=>(0,Z.jsx)(Ut().Z,{...e,desktopTitleStyle:s.sectionDesktopTitle,title:(0,Z.jsxs)("header",{style:s.titleHeader,children:[(0,Z.jsx)(Oe().Z,{ariaLabel:a.formatMessage(Ki.backButtonAriaLabel),icon:ji().f,iconStyle:s.backButtonIcon,onClick:r,style:s.backButton}),(0,Z.jsx)(H()._H,{defaultMessage:"Property from {contextValueName}",id:"formulaMentionMenu.formulaPropertiesSection.title",values:{contextValueName:l}})]})})}]}({contextValue:s,items:l,mentionMenuCurrentFormulaStore:t});if(!d||0===d.length)return null;const c={menuType:S().o.Popup,width:r};return(0,Z.jsx)(b().Z,{...c,children:(0,Z.jsx)(Ot().ZP,{initialFocus:0,sections:d,type:Ot().iW.Vertical})})}));function Wi(e){const{children:t}=e,n=(0,Ie().yK)((()=>({wrapper:{display:"inline-flex",alignItems:"center",justifyContent:"center",height:20,width:20}})),[]);return(0,Z.jsx)("div",{style:n.wrapper,children:t})}class zi extends hi().default{getInitialState(){return{userId:"",userEmail:"",displayName:""}}}const Gi=zi;function qi(e,t){return t?bi().Z.state.open&&"@"===bi().Z.state.insertionType&&e.device.isAndroid&&t.startsWith("@")?t.slice(1).trim():bi().Z.state.open&&"[["===bi().Z.state.insertionType&&t.endsWith("]]")?t.slice(0,-2).trim():t.trim():""}var Yi=()=>n(30238),$i=()=>n(395362),Ji=()=>n(150356);function Qi(e,t){const n=(0,a().VK)((()=>bi().Z.getMentionMenuContext()),[]);return(0,o.useCallback)((()=>{let o,i=Date.now();const a=bi().Z.state;if(a.open&&(i=a.openTime,o=a.flowId),a.open){var r;const s=Date.now(),{numServerRequests:l}=Ji().default.state,d=a.sessionId,c=a.showMentionAndShare;Yi().ew(e,{timeToAbandonInMs:s-i,analyticsFrom:n,queryLength:(null===(r=t.current)||void 0===r?void 0:r.length)??0,flowId:o,searchSessionId:d,searchSessionFlowNumber:l,stage:c?"share":"user_selection"})}a.open&&a.showInvite&&$i().Zv(e,{origin:bi().Z.getInviteOrigin(),invite_flow_id:a.flowId}),ci().xv()}),[n,e,t])}function Xi(e){let{usePopupOnMobile:t}=e;const n=(0,i().Fy)();return!t&&(n.isMobileNative&&!n.isTablet)}var ea=()=>n(123721);function ta(e){let{clearSavedSelection:t,filter:n}=e;const o=(0,i().O7)(),r=(0,a().Kw)(bi().Z),s=(0,a().VK)((()=>Oi()),[]);if(!r.open)return null;const l="block"===r.textStore.table?r.textStore.id:void 0;return(0,Z.jsx)(ea().ZP,{targets:[],isAddTo:!0,isCreateIn:!0,onAccept:e=>{ci().Br({environment:o,titleText:qi(o,n),clearSavedSelection:t,createInValue:e,menuListItemAction:void 0})},parentBlockId:l,onAutocompleteQueryChange:na,autocompleteQuery:r.createInQuery,desktopWidth:s,onCancel:oa})}function na(e){bi().Z.updateOpenState({createInQuery:e})}function oa(){bi().Z.updateOpenState({showCreateIn:!1,createInQuery:""})}var ia=()=>n(65217);function aa(e){let{inviteTargetsStore:t,personPropertyInviteStore:n,filter:r}=e;const s=(0,i().O7)(),l=(0,o.useCallback)((()=>ra(s,t,n)),[s,t,n]),d=(0,a().VK)((()=>_t().np()),[]),c=(0,a().VK)((()=>bi().Z.getInviteOrigin()),[]);return d?(0,Z.jsx)(ia().Z,{inviteOrigin:c,store:d,onInviteCompleteFn:e=>{if(!e.success)return ra(s,t,n),null;const{invitedUsers:o,requestedUsers:i}=e,a=f().zo(Object.values(o),Object.values(i));a.length?y().createAndCommit({userAction:"MentionMenu.inviteMenu",environment:s,canUndo:!0,perform:e=>{ci().RL({environment:s,editorMode:"default",annotations:a.map((e=>(0,g().tEo)(e))),transaction:e,menuListItemAction:void 0,query:qi(s,r),mentionType:"user"})}}):ra(s,t,n)},handleBackButtonClick:l,inviteTargetsStore:t,personPropertyInviteStore:n}):null}function ra(e,t,n){const o=bi().Z.state;o.open&&($i().Zv(e,{origin:bi().Z.getInviteOrigin(),invite_flow_id:o.flowId}),t.setState({tokenQuery:"",inviteTargets:[]}),n.setState({...n.state,emailMessage:""}),bi().Z.updateOpenState({showInvite:!1}))}var sa=()=>n(674462),la=()=>n(35980),da=()=>n(930085),ca=()=>n(784234),ua=()=>n(102182),ma=()=>n(302353);const pa="ShowMentionInvite";function ga(e){return`${pa}-${e}`}function fa(e){const t=(0,i().O7)(),n=(0,a().VK)((()=>_t().np()),[]),{mentionMenuCurrentMentionStore:o,menuPopupType:r}=e,{userId:s,displayName:l,userEmail:d}=(0,a().VK)((()=>o.getState()),[o]),c=(0,a().VK)((()=>ma().default.mobileNativeBottomPadding(t)),[t]),u=(0,a().VK)((()=>bi().Z.state.open),[]);if(!n)return null;const m={key:"invite buttons",render:e=>(0,Z.jsx)(Ut().Z,{...e}),items:[{key:"MentionMenu.MentionWithoutSharing",render:e=>(0,Z.jsx)(Vt().Z,{title:(0,Z.jsx)(H()._H,{defaultMessage:"Mention without sharing",id:"mentionMenu.peopleSection.invitePrompt.mentionWithoutSharing"}),caption:(0,Z.jsx)(H()._H,{defaultMessage:"Mention {userDisplayName} without sharing this document",id:"mentionMenu.peopleSection.invitePrompt.mentionWithoutSharingCaption",values:{userDisplayName:l}}),icon:(0,ki().p)({width:18}),...e}),action:()=>{y().createAndCommit({userAction:"MentionMenu.menuItem",environment:t,canUndo:!0,perform:e=>{ci().RL({environment:t,editorMode:"default",annotations:[(0,g().tEo)(s)],transaction:e,menuListItemAction:void 0,query:"",mentionType:"user",shareMenuSelection:"mention_without_share"})}}),la().Z.set({userId:t.currentUser.id,key:ga(n.id),value:!0})}},{key:"MentionMenu.MentionAndShare",render:e=>(0,Z.jsx)(Vt().Z,{title:(0,Z.jsx)(H()._H,{defaultMessage:"Mention and share",id:"mentionMenu.peopleSection.invitePrompt.mentionAndShare"}),caption:(0,Z.jsx)(H()._H,{defaultMessage:"Grant {userDisplayName} full access",id:"mentionMenu.peopleSection.invitePrompt.mentionAndShareCaption",values:{userDisplayName:l}}),icon:(0,sa().C)({width:18}),...e}),action:()=>{y().createAndCommit({userAction:"MentionMenu.menuItem",environment:t,canUndo:!0,perform:e=>{ci().RL({environment:t,editorMode:"default",annotations:[(0,g().tEo)(s)],transaction:e,menuListItemAction:void 0,query:"",mentionType:"user",shareMenuSelection:"mention_and_share"})}}),y().createAndCommit({userAction:"MentionAndInviteUserComponent.setPermission",environment:t,canUndo:!0,perform:e=>{ca().l3({environment:t,transaction:e,store:n,permissionItems:[{type:"user_permission",role:"editor",user_id:s}],pagePermissionChangeLocation:"mention_share_menu"})}}),da().jB(t,{role:"editor",is_space:!1,invite_targets:[{type:"existingUser",value:{id:s,version:0,email:d}}],is_onboarding:!1,invite_origin:"mention_menu",permission_items:[{type:"user_permission",role:"editor",user_id:s}],invite_message_length:0}),ua().d4({item:{label:(0,Z.jsx)(H()._H,{id:"mentionMenu.mentionShareMenu.mentionAndShare.snackbarMessage",defaultMessage:"Successfully granted {user} full access",values:{user:l}})},undoFunc:()=>y().createAndCommit({userAction:"MentionAndInviteUserComponent.setPermission.undoShare",environment:t,canUndo:!0,perform:e=>{ca().l3({environment:t,transaction:e,store:n,permissionItems:[{type:"user_permission",role:"none",user_id:s}],pagePermissionChangeLocation:"mention_share_menu"})}})})}}]},p=r===S().o.ActionSheet?{menuType:S().o.ActionSheet,disableBottomPadding:!0,height:`calc(70vh - ${c}px)`}:{menuType:S().o.Popup};return(0,Z.jsxs)(b().Z,{...p,children:[(0,Z.jsx)(tt().Z,{debugName:"MentionMenu",capture:u}),(0,Z.jsx)(Ot().ZP,{type:Ot().iW.Vertical,initialFocus:0,sections:[m]})]})}var ha=()=>n(804217),va=()=>n(838367);const ya=(0,H().vU)({addPage:{defaultMessage:"Type to add or link page…",id:"mentionMenu.addPage.prompt2"}});var ba=()=>n(641772),xa=()=>n(620218),Sa=()=>n(752348),Ma=()=>n(619186),wa=()=>n(727207),Ca=()=>n(142589),ja=()=>n(583352);var ka=()=>n(714230),Ta=()=>n(843403),Ia=()=>n(744091),_a=()=>n(47443),Pa=()=>n(164079);const Za={...Ze().Yu,fontWeight:Ze().Ue.medium,maxWidth:160,display:"inline-block",verticalAlign:"bottom"};function Aa(e){const{pageTitle:t}=e;return t?(0,Z.jsx)(H()._H,{defaultMessage:"New “{filterText}” page in…",id:"createPageMenuItem.title.withPageName",values:{filterText:(0,Z.jsx)("span",{style:Za,children:t})}}):(0,Z.jsx)(H()._H,{defaultMessage:"Add new page in…",id:"createPageMenuItem.title.withoutPageName"})}function Ra(e){const{pageTitle:t}=e;return t?(0,Z.jsx)(H()._H,{defaultMessage:"New “{filterText}” sub-page",id:"createSubpageMenuItem.title.withPageName",values:{filterText:(0,Z.jsx)("span",{style:Za,children:t})}}):(0,Z.jsx)(H()._H,{defaultMessage:"Add new sub-page",id:"createSubpageMenuItem.title.withoutPageName"})}var Ba=()=>n(73478);function La(e){const{topBorder:t,query:n,clearSavedSelection:r,setTemporaryInputData:s}=e,{isOpen:l,insertionType:d,isCreatePageEnabled:c,textStore:u}=(0,a().VK)((()=>{const e=bi().Z.state.open;return{isOpen:e,isCreatePageEnabled:bi().Z.state.mentionTypes.createPage,insertionType:e?bi().Z.state.insertionType:void 0,textStore:e?bi().Z.state.textStore:void 0}}),[]),m=function(e){const{query:t,textStore:n,clearSavedSelection:r,setTemporaryInputData:s}=e,l=(0,i().O7)(),d=(0,H().YB)(),c=(0,a().VK)((()=>Ia().gt(n)),[n]),u=(0,o.useMemo)((()=>({key:"add new subpage",action:async e=>{c&&await ci().Br({environment:l,clearSavedSelection:r,titleText:t,createInValue:c.createInValue,onPageCreated:e=>{e&&""===g().QaF(e.getTitleValue())&&_a()._c({environment:l,store:e,pageVisitSource:O().tY.Create})},menuListItemAction:e})},render:e=>{e.focused&&s({title:0===t.length?d.formatMessage(ya.addPage):"",icon:(0,Z.jsx)(Ri,{}),allowTabCompletion:!1});const n=n=>(0,Z.jsx)(Vt().Z,{...(0,Pa().Z)(n||{},e),icon:(0,no().R)({width:16}),title:(0,Z.jsx)(Ra,{pageTitle:t})});return l.device.isMobile?n():(0,Z.jsx)(Ue().Z,{renderTooltip:()=>(0,Z.jsx)(Ba().Z,{imageURL:ka().Z.images.tooltips.pageMenu.newSubpagePng,imageWidth:140,imageHeight:100,caption:(0,Z.jsx)(H()._H,{...ea().sY.createSubpage})}),placement:C().Placement.Right,delayThreshold:0,render:e=>n(e)})}})),[l,r,c,d,t,s]);return u}({query:n,textStore:u,clearSavedSelection:r,setTemporaryInputData:s}),p=function(e){const{query:t,setTemporaryInputData:n}=e,a=(0,i().O7)(),r=(0,H().YB)(),s=(0,o.useCallback)((()=>{bi().Z.updateOpenState({showCreateIn:!0})}),[]),l=(0,o.useMemo)((()=>({key:"open create in menu",action:s,render:e=>{e.focused&&n({title:0===t.length?r.formatMessage(ya.addPage):"",icon:(0,Z.jsx)(Ri,{}),allowTabCompletion:!1});const o=n=>(0,Z.jsx)(Vt().Z,{...(0,Pa().Z)(n||{},e),icon:(0,Ta().J)({width:16}),title:(0,Z.jsx)(Aa,{pageTitle:t})});return a.device.isMobile?o():(0,Z.jsx)(Ue().Z,{renderTooltip:()=>(0,Z.jsx)(Ba().Z,{imageURL:ka().Z.images.tooltips.pageMenu.newPageInPng,imageWidth:140,imageHeight:100,caption:(0,Z.jsx)(H()._H,{...ea().sY.newPageIn})}),placement:C().Placement.Right,delayThreshold:0,render:e=>o(e)})}})),[a.device.isMobile,s,r,t,n]);return l}({query:n,setTemporaryInputData:s}),f="@"===d?(0,Z.jsx)(H()._H,{id:"mentionMenu.createPageSection.title",defaultMessage:"New page"}):void 0;if(c&&l)return{key:"create page",render:e=>(0,Z.jsx)(Ut().Z,{title:f,isTitleUppercase:!0,...e,topBorder:t}),items:[m,p]}}var Da=()=>n(629013),Va=()=>n(646574),Oa=()=>n(874459),Ua=()=>n(312117),Na=()=>n(358122),Fa=()=>n(466970);function Ha(e){const{category:t,query:n,setTemporaryInputData:o,templateVariableResults:a}=e,r=(0,i().O7)(),s=(0,H().YB)();return a.filter((e=>(0,wa().i6)(e,t))).map((e=>({key:e,render:t=>{const n=(0,wa().U$)(e,s),i=(0,wa().Z0)(e,s);return t.focused&&o({title:n,icon:(0,Z.jsx)(Li,{}),allowTabCompletion:!0}),(0,Z.jsx)(Vt().Z,{...t,title:n,caption:i,inline:!0})},action:t=>{y().createAndCommit({userAction:"MentionMenu.menuItem",environment:r,canUndo:!0,perform:o=>{ci().RL({environment:r,editorMode:"default",annotations:[g().WBu({type:e})],transaction:o,menuListItemAction:t,query:n,mentionType:"templateVariable"})}})}})))}var Ka=()=>n(429600),Ea=()=>n(855238);function Wa(e,t){return function(){t.setState({formulaTypecheckContextValue:e}),bi().Z.updateOpenState({showFormulaProperty:!0})}}function za(e){const{formulaReturnType:t,query:n,formulaContextVariableResults:o,setTemporaryInputData:a}=e;return Ga({environment:(0,i().O7)(),formulaVariableFilter:e=>e.kind===wi().FormulaContextValueKind.ContextValue&&e.type.type===t&&!(0,Ci().iT)(e),query:n,formulaContextVariableResults:o,setTemporaryInputData:a})}function Ga(e){const{environment:t,formulaVariableFilter:n,query:o,formulaContextVariableResults:i,setTemporaryInputData:a}=e;if(0===i.length)return[];const r=i.filter(n);return 0===r.length?[]:r.map((e=>{const n=(0,Ci().NP)(e),i=(0,Ci().WT)(e),r=(0,Ci().RX)(e.type);return{action:qa(t,e,o),key:e.id,render:t=>(t.focused&&a({allowTabCompletion:!0,icon:(0,Z.jsx)(Li,{}),title:e.name}),(0,Z.jsx)(Ea().Z,{...t,svg:r,title:n,tooltipText:i}))}}))}function qa(e,t,n){return function(o){y().createAndCommit({userAction:"MentionMenu.formulaMenuItem",environment:e,canUndo:!0,perform:i=>{const a=(0,g()._QF)(t);ci().RL({annotations:[a],editorMode:"default",environment:e,mentionType:"formulaContextVariable",menuListItemAction:o,query:n,transaction:i})}})}}function Ya(e){const{topBorder:t,query:r,setTemporaryInputData:s,templateVariableResults:l,formulaContextVariableResults:d}=e,c=(0,i().O7)(),u=(0,H().YB)(),m=function(e){const[t,i]=(0,o.useState)([]),r=(0,H().YB)(),{areDateMentionsAllowed:s,areReminderMentionsAllowed:l}=(0,a().VK)((()=>({areDateMentionsAllowed:bi().Z.state.mentionTypes.date,areReminderMentionsAllowed:bi().Z.state.mentionTypes.reminder})),[]),d=(0,Na().J)(),c=(0,Fa().E)("chrono_node_date_mentions"),u=(0,o.useCallback)((async()=>{if(e.length<1)return;const t=await async function(e){const{query:t,intl:o,userLocal:i}=e,{chronoNodeDependency:a}=await Promise.all([n.e(62126),n.e(3351)]).then(n.bind(n,687092)),r=await a.load(),s={en:r.en.parse,ja:r.ja.parse,zh:r.zh.parse,fr:r.fr.parse,de:r.de.parse,es:r.es.parse,pt:r.pt.parse,nl:r.nl.parse}[i]??r.en.parse,l=s(t,void 0,{forwardDate:!0}),d=l.length>0?l[0]:void 0;if(!d)return;const{start:c,end:u}=d,m=c.isCertain("minute")||c.isCertain("hour"),p=(null==u?void 0:u.isCertain("minute"))||(null==u?void 0:u.isCertain("hour")),g=c.date().getTime(),f=null==u?void 0:u.date().getTime(),h=(0,U().r)(),v=Oa().CQ(g,h),y={unit:"day",value:0,time:cn().HZ,defaultTimeZone:h},b=t.toLowerCase().startsWith(o.formatMessage(Ua().sY.remind).toLowerCase());let x;if(g&&!f)x=m?{...v,reminder:b?$a(c):void 0}:{type:"date",start_date:v.start_date,reminder:b?y:void 0};else if(f){const e=Oa().iC(g,f,(0,U().r)());x=m&&p?{...e,reminder:b?$a(c):void 0}:{type:"daterange",end_date:e.end_date,start_date:e.start_date,reminder:b?y:void 0}}if(!x)return;let S=(0,Va().ZV)({value:x,allowRelativeDates:!0,userTimeZone:(0,U().r)(),intl:o});b&&(S=o.formatMessage(Ja.reminder,{dateTime:S}));return{label:S,value:()=>x}}({query:e,intl:r,userLocal:d});i(t?[t]:[])}),[r,e,d]),m=(0,Da().y)((async()=>await u()),100);return(0,ue().r5)((async()=>{if(!s)return;c&&m.cancel();const t=function(e){const{query:t,allowReminder:n,intl:o}=e;if(0===t.length)return(0,f().oA)([{label:o.formatMessage(Ja.autocompleteToday),value:()=>Oa().Lg((0,U().r)())},n?void 0:{label:o.formatMessage(Ja.autocompleteNextTuesday),value:()=>{const e=Oa().Uu((0,U().r)()),t=e.set({weekday:2,hour:15}),n=t<=e?t.plus({week:2}):t.plus({week:1});return{type:"datetime",start_date:n.toFormat(Oa().Iq),start_time:n.toFormat(cn().jK),time_zone:(0,U().r)()}}},n?{label:o.formatMessage(Ja.autocompleteReminder),value:()=>({type:"datetime",start_date:Oa().Ro((0,U().r)()).start_date,start_time:"09:00",reminder:{unit:"day",value:0,time:cn().HZ,defaultTimeZone:(0,U().r)()},time_zone:(0,U().r)()})}:void 0]);const i=t.normalize("NFKD"),a=n?Ua().St(i,o):Ua().cg(i,o);if(!a)return[];let r=(0,Va().ZV)({value:a,date_format:"relative",userTimeZone:(0,U().r)(),intl:o,allowRelativeDates:!0});a.reminder&&(r=o.formatMessage(Ja.reminder,{dateTime:r}));return[{label:r,value:()=>a}]}({query:e,allowReminder:l,intl:r}).slice(0,6);t.length>0||!c?i(t):await m()}),[m,s,e,l,r,c]),t}(r),p=Ha({templateVariableResults:l,category:"date",query:r,setTemporaryInputData:s}),g=za({formulaReturnType:"date",query:r,formulaContextVariableResults:d,setTemporaryInputData:s}),h=(0,o.useMemo)((()=>m.map((e=>{let{label:t,value:n}=e;return{key:t,render:e=>{if(e.focused&&s({title:t,icon:(0,Z.jsx)(Li,{}),allowTabCompletion:!0}),Ua().UL(t,u)){const o=(0,Va().ZV)({value:n(),userTimeZone:(0,U().r)(),intl:u,allowRelativeDates:!1});return(0,Z.jsx)(Vt().Z,{...e,title:t,caption:o,inline:!0})}return(0,Z.jsx)(Vt().Z,{...e,title:t})},action:e=>{y().createAndCommit({userAction:"MentionMenu.menuItem",environment:c,canUndo:!0,perform:t=>{const o=n();ci().RL({environment:c,editorMode:"default",annotations:[["d",{...o,date_format:"relative"}]],transaction:t,menuListItemAction:e,query:r,mentionType:o.reminder?"reminder":"date"})}})}}}))),[m,u,s,c,r]),v=(0,o.useMemo)((()=>[...g,...p,...h]),[h,g,p]),b=(0,o.useMemo)((()=>{if(v.length>0)return{key:"date results",render:e=>(0,Z.jsx)(Ut().Z,{...e,title:(0,Z.jsx)(H()._H,{defaultMessage:"Date",id:"mentionMenu.dateSection.title"}),topBorder:t,isTitleUppercase:!0}),items:v}}),[v,t]);return b}function $a(e){const t=e.isCertain("minute")?"minute":e.isCertain("hour")?"hour":"day";return"minute"===t?{unit:t,value:e.get("minute")??0}:"hour"===t?{unit:t,value:e.get("hour")??0}:{unit:"day",value:0,time:cn().HZ}}const Ja=(0,H().vU)({autocompleteToday:{defaultMessage:"Today",id:"mentionMenu.date.autocomplete.today"},autocompleteNextTuesday:{defaultMessage:"Next Tuesday 3pm",id:"mentionMenu.date.autocomplete.nextTuesday"},autocompleteReminder:{defaultMessage:"Remind tomorrow 9am",id:"mentionMenu.date.autocomplete.reminder"},reminder:{defaultMessage:"Remind {dateTime}",id:"mentionMenu.date.remindAtDateTime"}});var Qa=()=>n(763928);const Xa=(0,H().vU)({groupMentionCaption:{defaultMessage:"{numMembersInGroup, plural, one {{numMembersInGroup} member} other {{numMembersInGroup} members}}",id:"mentionMenu.group.caption"}});function er(e){const{topBorder:t,query:n,setTemporaryInputData:r}=e,s=(0,i().O7)(),l=(0,H().YB)(),d=function(e){const{query:t}=e,n=(0,a().VK)((()=>bi().Z.state.mentionTypes.group),[]),i=(0,a().VK)((()=>Xt().Z.state.permissionGroupsAndMemberCounts.map((e=>e.group))),[]),r=(0,o.useMemo)((()=>n?(0,Ma().ZP)(t,i,(e=>e.name||""),{normalizeFuzzyScore:!0}):[]),[n,t,i]);return r}({query:n}),c=(0,a().VK)((()=>f().KX(Xt().Z.state.permissionGroupsAndMemberCounts,(e=>e.group.group_id))),[]),u=(0,a().VK)((()=>{var e;return null===(e=Q().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),m=(0,o.useMemo)((()=>f().oA(d.map((e=>{var t;if(!u)return;const o=l.formatMessage(Xa.groupMentionCaption,{numMembersInGroup:(null===(t=c[e.group_id])||void 0===t?void 0:t.memberCount)||0});return{key:e.id,render:t=>(t.focused&&r({title:e.name||"",icon:(0,Z.jsx)(Li,{}),allowTabCompletion:!0}),(0,Z.jsx)(Qa().l,{menuListItemProps:{...t,caption:o},group:e})),action:t=>{y().createAndCommit({userAction:"MentionMenu.groupMention",environment:s,canUndo:!0,perform:o=>{ci().RL({environment:s,editorMode:"default",annotations:[g().XIB(e.group_id,u)],transaction:o,menuListItemAction:t,query:n,mentionType:"group"})}})}}})))),[d,u,l,c,r,s,n]);if(0!==d.length)return{key:"group results",render:e=>(0,Z.jsx)(Ut().Z,{...e,title:(0,Z.jsx)(H()._H,{defaultMessage:"Groups",id:"mentionMenu.groupSection.title"}),topBorder:t,isTitleUppercase:!0}),items:m}}var tr=()=>n(970381),nr=()=>n(482162),or=()=>n(236190);function ir(e){const t=(0,i().O7)(),n=(0,H().YB)(),{query:o,setTemporaryInputData:r,topBorder:s}=e,l=function(e){const{intl:t,query:n}=e,o=n.toLowerCase(),i=(0,Fa().E)("mention_menu_page_headings"),r=(0,a().VK)((()=>{const e=(0,_t().RM)();if(!e)return;const{mainEditorCurrentBlockStore:t}=Q().default.state;return e===t?t:nr().default.peekTargetStore.state===e?nr().default.peekTargetStore.state:void 0}),[]),s=(0,a().VK)((()=>{if(!i||!r)return[];const e=X().default.checkGate({gateName:"toc_nested_headings"});return(0,tr().Q)(r.id,r.getRecordModel,e)}),[i,r]),l=(0,a().VK)((()=>r?(0,f().oA)(s.map((e=>{const n=ee().G.createChildStore(r,{table:Mn().iU,id:e}),i=n.getModel();if(!i)return;const a=i.getRenderTitle({getRecordModel:n.getRecordModel,userTimeZone:(0,U().r)(),intl:t});return a&&a.toLowerCase().includes(o)?n:void 0}))):[]),[t,o,r,s]);return l}({query:o,intl:n}),d=0===l.length,c=(0,a().VK)((()=>l.map((e=>{const i=e.id;return{key:i,render:t=>{if(t.focused){const t=e.getModel();if(t){const o=t.getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:(0,U().r)(),intl:n});r({title:o||"",icon:(0,Z.jsx)(Bi,{}),allowTabCompletion:!0})}}return(0,Z.jsx)(or().Z,{...t,store:e})},action:e=>{y().createAndCommit({userAction:"MentionMenu.getHeaderResultsMenuSection",environment:t,canUndo:!0,perform:n=>{ci().RL({environment:t,editorMode:"default",annotations:[["p",i]],transaction:n,menuListItemAction:e,query:o,mentionType:"heading"})}})}}}))),[t,l,n,o,r]);if(!d)return{key:"heading results",render:e=>(0,Z.jsx)(Ut().Z,{...e,title:(0,Z.jsx)(H()._H,{defaultMessage:"Link to heading",id:"mentionMenu.headerSection.title"}),topBorder:s,isTitleUppercase:!0}),items:c}}var ar=()=>n(435676);function rr(e){const{topBorder:t,environment:n,query:r,setTemporaryInputData:s}=e,{teamResults:l,currentTeamResultStore:d}=function(e){const t=(0,i().O7)(),{query:n}=e,o=(0,a().VK)((()=>(0,Ca().U)({isMobileNative:t.device.isMobileNative,disableExposureLogging:!0})&&bi().Z.state.mentionTypes.team),[t.device.isMobileNative]),r=(0,a().VK)((()=>{var e;if(!o)return[];if(!bi().Z.state.open)return[];const t=(null===(e=Q().default.state.currentSpaceViewStore)||void 0===e?void 0:e.getTeamsStores().filter(pe().$K))||[];return(0,Ma().ZP)(n,t,(e=>e.getName()||""),{normalizeFuzzyScore:!0})}),[o,n]),s=(0,a().VK)((()=>bi().Z.state.open?bi().Z.state.textStore:void 0),[]);return{teamResults:r,currentTeamResultStore:(0,a().VK)((()=>{if(s&&(0,Tn().n3)(s))return(0,Tn().tM)(s)}),[s])}}({query:r}),c=(0,a().VK)((()=>{var e;return null===(e=Q().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),u=(0,a().VK)((()=>f().oA(l.map((e=>{if(!c)return;return{key:e.id,render:t=>(t.focused&&s({title:e.getName()||"",icon:(0,Z.jsx)(Li,{}),allowTabCompletion:!0}),(0,o.createElement)(ar().Z,{...t,key:e.id,teamStore:e})),action:t=>{y().createAndCommit({userAction:"MentionMenu.teamMention",environment:n,canUndo:!0,perform:o=>{ci().RL({environment:n,editorMode:"default",annotations:[g().p3r(e.id,c,"teamspace")],transaction:o,menuListItemAction:t,query:r,mentionType:"team"})}})}}})))),[n,r,s,c,l]),m=(0,o.useMemo)((()=>{if(0!==u.length)return{key:"team results",render:e=>(0,Z.jsx)(Ut().Z,{...e,title:(0,Z.jsx)(H()._H,{defaultMessage:"Teams",id:"mentionMenu.teamSection.title"}),topBorder:t,isTitleUppercase:!0}),items:u}}),[u,t]);return{currentTeamResultStore:d,teamResultsSection:m}}var sr=()=>n(899133),lr=()=>n(718611),dr=()=>n(15981),cr=()=>n(766463),ur=()=>n(729201),mr=()=>n(128076),pr=()=>n(231219);const gr=20;function fr(e){const{query:t,topBorder:n,setTemporaryInputData:r,formulaContextVariableResults:s}=e,l=(0,H().YB)(),d=(0,i().O7)(),{device:c}=d,u=d.currentUser.id,m=(0,Ie().Fg)(),p=c.isSafari||c.isIOS,{results:g,isLoading:h}=function(e){const t=(0,a().VK)((()=>bi().Z.state.mentionTypes.page),[]),n=(0,a().VK)((()=>bi().Z.state.open&&bi().Z.state.textStore instanceof mr().G?bi().Z.state.textStore:void 0),[]),o=(0,a().VK)((()=>Boolean(Q().default.state.currentSpaceStore)||Boolean(n)),[n]),i=(0,a().VK)((()=>{var e;return null===(e=(0,_t().np)())||void 0===e?void 0:e.id}),[]),r=(0,a().VK)((()=>dr().X4.state.filter((e=>e.pageId!==i)).slice(0,gr).map((e=>e.store))),[i]),s=""===e,{results:l,isResultsLoading:d}=(0,cr().s)({source:"mention_menu",searchQuery:e,limit:gr,type:sr().n8.BlocksInSpace,disable:!t||!o||s,filters:{excludeTemplates:!0}});return{results:(0,a().VK)((()=>s?r.map((e=>({pageStore:e,serverEventProperties:void 0}))):l.map((e=>{let{store:t,serverEventProperties:n}=e;return{pageStore:t,serverEventProperties:n}}))),[l,r,s]),isLoading:d}}(t),v=za({formulaReturnType:"block",query:t,formulaContextVariableResults:s,setTemporaryInputData:r}),b=(0,o.useMemo)((()=>(0,f().oA)(g.map((e=>{let{pageStore:n,serverEventProperties:o}=e;const i=n.id;return{key:i,render:e=>{if(e.focused){const e=n.getModel();if(e){const t=e.getRenderTitle({getRecordModel:n.getRecordModel,userTimeZone:(0,U().r)(),intl:l});r({title:t||"",icon:(0,Z.jsx)(Di,{pageStore:n,theme:m,isSafariOrIOS:p,emojiType:(0,lr().e_)(d),currentUserId:u}),allowTabCompletion:!0})}}return(0,Z.jsx)(pr().Z,{...e,store:n})},action:e=>{y().createAndCommit({userAction:"MentionMenu.getPageResultsMenuSection",environment:d,canUndo:!0,perform:n=>{ci().RL({environment:d,editorMode:"default",annotations:[["p",i]],transaction:n,menuListItemAction:e,query:t,serverEventProperties:o,mentionType:"page",resultId:i})}})}}})))),[u,d,l,p,t,g,r,m]),x=(0,o.useMemo)((()=>[...v,...b]),[v,b]),S=!(x.length>0)&&!h?vr.noPageResults:vr.linkToPage,M=(0,o.useMemo)((()=>(0,Z.jsxs)(Z.Fragment,{children:[l.formatMessage(S),(0,Z.jsx)(hr,{show:h})]})),[l,h,S]),w=(0,o.useMemo)((()=>({key:"no page results",render:e=>(0,Z.jsx)(Ut().Z,{...e,title:M,topBorder:n,isTitleUppercase:!0}),items:x})),[x,M,n]);return{pageResultsSection:w,isPageResultsLoading:h}}function hr(e){let{show:t}=e;const n=(0,ur().Z)(t,500,300);return(0,Z.jsx)(Zn().Z,{style:{textAlign:"center",visibility:n?"visible":"hidden",display:"inline",marginLeft:8}})}const vr=(0,H().vU)({noPageResults:{defaultMessage:"No page results",id:"mentionMenu.noPageSearchResults.title"},linkToPage:{defaultMessage:"Link to page",id:"mentionMenu.pagesSection.title2"}});var yr=()=>n(816512),br=()=>n(782137),xr=()=>n(499110),Sr=()=>n(342792),Mr=()=>n(369637),wr=()=>n(882637),Cr=()=>n(122479),jr=()=>n(333023),kr=()=>n(864832);function Tr(e,t){const{user:o,focused:r}=e,s=(0,i().O7)(),l=(0,H().YB)(),d=(0,Ie().yK)((e=>({icon:{width:17,height:17,fill:e.icon.secondary},tooltip:{color:e.text.quaternary,fontWeight:Ze().Ue.regular,maxWidth:240},tooltipHeader:{color:e.text.contrastPrimary,fontWeight:Ze().Ue.medium}})),[]),c=(0,yr().dp)(o),u=(0,yr().$4)(l,c),m=(0,a().VK)((()=>{const e=(0,_t().np)();return!(e&&(0,jr().gi)({store:e}))||"none"!==(0,Cr().rc)(o.id)}),[o.id]),p=(0,a().VK)((()=>{var e;return o.id===(null===(e=Q().default.state.currentUserStore)||void 0===e?void 0:e.id)}),[o.id]),g=(0,a().VK)((()=>!bi().Z.getIsMockText()),[]),f=(0,a().VK)((()=>{if(!g)return;if(!r)return;if(m)return;const e=(0,_t().np)(),t=e&&Boolean(la().Z.get({userId:s.currentUser.id,key:ga(e.id)})),o=null==e?void 0:e.canAdmin();return!t&&o?(0,sa().C)(d.icon):(0,n(337621).j)(d.icon)}),[g,s.currentUser.id,m,r,d.icon]),h=(0,a().VK)((()=>{if(!g)return null;const e=o.email;return(0,Z.jsxs)("div",{style:d.tooltip,children:[(0,Z.jsx)("header",{style:d.tooltipHeader,children:(0,Z.jsx)(_r,{userName:u,userHasAccessToPage:m,userIsSelf:p})}),e]})}),[g,m,p,u,o.email,d.tooltip,d.tooltipHeader]);return(0,Z.jsx)(n(523516).Z,{...e,ref:t,actor:c,right:f,tooltip:h,tooltipPlacement:g?C().Placement.Right:void 0,useEmailAsTooltip:!g})}const Ir=o.forwardRef(Tr);function _r(e){let{userName:t,userHasAccessToPage:n,userIsSelf:o}=e;return o?(0,Z.jsx)(H()._H,{defaultMessage:"You",id:"activitySection.authorPhrase.forOneAuthorCurrentUser.label"}):n?null:(0,Z.jsx)(H()._H,{id:"mentionMenu.UserMentionMenuItem.noAccessTooltip",defaultMessage:"{userName} won't be notified because they don't have page access",values:{userName:t}})}var Pr=()=>n(828946);const Zr=75;function Ar(e,t,n){const{hasUserType:o,open:i}=(0,a().VK)((()=>({hasUserType:bi().Z.state.mentionTypes.user,open:bi().Z.state.open})),[]),r=(0,a().VK)((()=>Boolean(Q().default.state.currentSpaceStore)),[]),s=(0,a().VK)((()=>bi().Z.state.emptyQueryUserRequestStore.state.result??[]),[]),[{value:l,status:d}]=(0,ue().r5)((async()=>i&&o&&r?async function(e,t,n,o){const i=0===e.trim().length;let a;a=i?o:await async function(e,t,n){if(ha().default.state.online){const o=await Pr().x.searchActions.load();return await o.searchVisibleSpaceUsers({environment:t,query:e,membersOnly:!1,minFuzzyScore:25,placeSelfFirst:o.isPersonalPronoun(e,n)})}return[]}(e,t,n);if(""===e){const e=4;return a.slice(0,e)}return a.slice(0,20)}(e,t,n.locale,s):[]),[i,o,r,e,t,n.locale,s],{debounce:Zr});return{results:l??[],isLoading:"pending"===d}}const Rr="__invite";function Br(e){const{topBorder:t,query:n,inviteTargetsStore:r,personPropertyInviteStore:s,mentionMenuCurrentMentionStore:l,setTemporaryInputData:d,templateVariableResults:c,formulaContextVariableResults:u,currentTeamResultStore:m}=e,p=(0,i().O7)(),f=(0,H().YB)(),{results:h,isLoading:v}=Ar(n,p,f),b=(0,a().VK)((()=>(0,_t().np)()),[]),x=(0,a().VK)((()=>b&&Boolean(la().Z.get({userId:p.currentUser.id,key:ga(b.id)}))),[p.currentUser.id,b]),S=(0,a().VK)((()=>bi().Z.state.mentionTypes.inviteUserToPage&&!x),[x]),M=Ha({templateVariableResults:c,category:"user",query:n,setTemporaryInputData:d}),w=za({formulaReturnType:"person",query:n,formulaContextVariableResults:u,setTemporaryInputData:d}),C=(0,a().VK)((()=>{const e=bi().Z.state.mentionTypes.team;return(0,Ca().U)({isMobileNative:p.device.isMobileNative,disableExposureLogging:!0})&&e}),[p.device.isMobileNative]),j=(0,a().VK)((()=>!h.find((e=>e.email===n))&&bi().Z.state.mentionTypes.inviteUserToWorkspace),[n,h]),k=(0,a().VK)((()=>{var e;return null===(e=Q().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),T=j||h.length>0||M.length>0||w.length>0||C,I=(0,a().VK)((()=>{if(!k||!m||!T)return;const e=f.formatMessage({id:"posts.teamMenuItem.everyoneMentionNoAmpersand",defaultMessage:"everyone"});return e.startsWith(n)?{key:"everyone-unique-item",render:t=>(t.focused&&d({title:e,icon:(0,Z.jsx)(Li,{}),allowTabCompletion:!0}),(0,o.createElement)(ar().Z,{...t,key:"everyone-unique-item",teamStore:m,renderAsEveryoneMention:!0})),action:e=>{y().createAndCommit({userAction:"MentionMenu.teamMention",environment:p,canUndo:!0,perform:t=>{ci().RL({environment:p,editorMode:"default",annotations:[g().p3r(m.id,k,"everyone")],transaction:t,menuListItemAction:e,query:n,mentionType:"team"})}})}}:void 0}),[T,m,p,f,n,d,k]),_=(0,a().VK)((()=>bi().Z.getIsMockText()),[]),P=(0,o.useMemo)((()=>["reply_menu_all_updates","reply_menu_archive","reply_menu_mentions_comments"]),[]),A=(0,a().VK)((()=>wr().default.state.open&&P.includes(wr().default.state.discussionLocation)),[P]),R=!_&&!A,B=(0,a().VK)((()=>bi().Z.getMentionMenuContext()??Mn().iU),[]),L=(0,a().VK)((()=>!!b&&((0,jr().gi)({store:b})&&b.canAdmin())),[b]),D=(0,o.useCallback)((e=>!("none"!==(0,Cr().rc)(e))&&!p.device.isMobile&&R&&!x&&L),[x,L,p.device.isMobile,R]),V=(0,a().VK)((()=>bi().Z.state.open?bi().Z.state.flowId:void 0),[]),O=(0,o.useCallback)(((e,t,n,o)=>{t.reset(),n.reset(),V&&(t.setState({...t.state,tokenQuery:o}),n.setState({...n.state,flowId:V}),$i().P0(e,{origin:bi().Z.getInviteOrigin(),invite_flow_id:V}),bi().Z.updateOpenState({showInvite:!0}))}),[V]),U=(0,a().VK)((()=>h.map((e=>{const t=e.id,i={key:t,render:n=>(n.focused&&d({title:(0,xr().Nz)(f,e),icon:(0,Z.jsx)(Li,{}),allowTabCompletion:!0}),(0,o.createElement)(Ir,{...n,key:t,user:e})),action:o=>{const i=(0,Cr().rc)(t);if(S&&"none"===i)l.setState({userId:t,userEmail:e.email,displayName:(0,yr().dp)(e).getDisplayName(f)}),bi().Z.updateOpenState({showMentionAndShare:!0});else if(y().createAndCommit({userAction:"MentionMenu.menuItem",environment:p,canUndo:!0,perform:t=>{ci().RL({environment:p,editorMode:"default",annotations:[(0,g().tEo)(e.id)],transaction:t,menuListItemAction:o,query:n,mentionType:"user"})}}),D(t)){const t=(0,Sr().ZP)();Mr().m2(function(e){const{environment:t,user:n,pageStore:o,intl:i,flowId:a,from:r}=e;return o&&la().Z.set({userId:t.currentUser.id,key:ga(o.id),value:!0}),{id:`invite_${n.id}`,title:i.formatMessage(Vr.pageInviteToastTitle,{name:n.name??n.email}),jsxMessage:(0,Z.jsx)(Lr,{user:n}),actions:{primary:{title:i.formatMessage(Vr.pageInviteToastInviteButton),onAction:()=>{if(!o)return;const i="read_and_write";y().createAndCommit({userAction:"MentionMenu.menuItem",environment:t,canUndo:!0,perform:e=>{ca().l3({environment:t,transaction:e,store:o,permissionItems:[{type:"user_permission",role:i,user_id:n.id}],pagePermissionChangeLocation:"mention_share_menu",fromPermissionWrapper:"mention_menu",flowId:a})}}),la().Z.set({userId:t.currentUser.id,key:ga(o.id),value:!1}),da().jB(t,{role:i,is_space:!1,invite_targets:[{type:"existingUser",value:n}],is_onboarding:!1,invite_origin:"mention_menu",permission_items:[{type:"user_permission",role:i,user_id:n.id}],invite_message_length:0,invite_flow_id:a}),Dr(t,{flow_id:a,selection:"invite",target_user_id:n.id,from:r}),Mr().m2(function(e){const{user:t,intl:n,environment:o,pageStore:i,flowId:a,from:r}=e;return{id:`invite_${t.id}`,icon:br().e,title:n.formatMessage(Vr.pageInviteSnackbarSuccessTitle),message:n.formatMessage(Vr.pageInviteSnackbarSuccessMessage),actions:{primary:{title:n.formatMessage(Vr.pageInviteUndo),onAction:()=>{y().createAndCommit({userAction:"MentionMenu.menuItem",environment:o,canUndo:!0,perform:e=>{i&&ca().l3({environment:o,transaction:e,store:i,permissionItems:[{type:"user_permission",role:"none",user_id:t.id}],pagePermissionChangeLocation:"mention_share_menu",flowId:a})}}),Mr().Xd(`invite_${t.id}`),function(e,t){(0,It().j)({environment:e,event:{eventName:"undo_invite_to_page_popup",eventProperties:t}}),X().default.logEvent("undo_invite_to_page_popup",void 0,t)}(o,{flow_id:a,target_user_id:t.id,from:r})}}}}}(e))}},secondary:{title:i.formatMessage(Vr.pageInviteToastIgnoreButton),onAction:()=>{o&&(Mr().Xd(`invite_${n.id}`),Dr(t,{flow_id:a,selection:"dismiss",target_user_id:n.id,from:r}))}}}}}({environment:p,user:e,pageStore:b,intl:f,flowId:t,from:B})),function(e,t){(0,It().j)({environment:e,event:{eventName:"trigger_invite_to_page_popup",eventProperties:t}}),X().default.logEvent("trigger_invite_to_page_popup",void 0,t)}(p,{flow_id:t,target_user_id:e.id,from:B})}}};return i})).concat(j&&T?[{key:Rr,action:()=>O(p,r,s,n),render:e=>(e.focused&&d({title:"",icon:(0,Z.jsx)(Li,{}),allowTabCompletion:!1}),(0,Z.jsx)(Vt().Z,{...e,icon:(0,sa().C)({width:20}),title:n.length>0?(0,Z.jsx)(H()._H,{defaultMessage:"Invite ”{query}”…",id:"mentionMenu.peopleSection.invitePrompt",values:{query:n}}):(0,Z.jsx)(H()._H,{defaultMessage:"Invite…",id:"mentionMenu.peopleSection.invitePrompt.empty"})}))}]:[])),[D,p,O,f,r,B,l,b,s,n,d,j,S,T,h]),N=(0,o.useMemo)((()=>[...I?[I]:[],...w,...M,...U]),[I,w,M,U]),F=(0,o.useMemo)((()=>({key:"user results",render:e=>(0,Z.jsx)(Ut().Z,{...e,title:(0,Z.jsx)(H()._H,{defaultMessage:"People",id:"mentionMenu.peopleSection.title"}),topBorder:t,isTitleUppercase:!0}),items:N})),[N,t]);return{userResultsSection:F,isUserResultsLoading:v,numberOfUserResults:h.length}}function Lr(e){const{user:t}=e,n=(0,Ie().yK)((()=>{const e=(0,ao().gh)({theme:"dark"});return{container:{display:"flex",flexDirection:"column",gap:4},tokenContainer:{paddingTop:4,paddingBottom:4},darkTooltip:{background:e.tooltipBackground,color:e.regularInvertedTextColor}}}),[]);return(0,Z.jsxs)("div",{style:n.container,children:[(0,Z.jsx)(Ue().Z,{overlayContainerZIndex:202,alignment:C().Alignment.Center,originGap:2,placement:C().Placement.Top,renderTooltip:()=>t.email,render:e=>(0,Z.jsx)("div",{style:n.tokenContainer,...e,children:(0,Z.jsx)(kr().vw,{userValue:t,isSingle:!0,shouldShrink:!0,format:kr().vw.Format.Medium})}),style:n.darkTooltip}),(0,Z.jsx)("div",{children:(0,Z.jsx)(H()._H,{...Vr.pageInviteToastMessage})})]})}function Dr(e,t){(0,It().j)({environment:e,event:{eventName:"select_invite_to_page_popup",eventProperties:t}}),X().default.logEvent("select_invite_to_page_popup",t.selection,t)}const Vr=(0,H().vU)({pageInviteToastTitle:{defaultMessage:"Invite to page?",id:"mentionMenu.UserMentionMenuItem.inviteToastTitle"},pageInviteToastMessage:{defaultMessage:"They won’t be notified unless you invite them to the page.",id:"mentionMenu.UserMentionMenuItem.inviteToastMessage"},pageInviteToastInviteButton:{defaultMessage:"Invite",id:"mentionMenu.UserMentionMenuItem.inviteToastInviteButton"},pageInviteToastIgnoreButton:{defaultMessage:"Ignore",id:"mentionMenu.UserMentionMenuItem.inviteToastIgnoreButton"},pageInviteSnackbarSuccessTitle:{defaultMessage:"Invite sent",id:"mentionMenu.UserMentionMenuItem.snackbarInviteSuccessTitle"},pageInviteSnackbarSuccessMessage:{defaultMessage:"They were notified and invited to edit the page.",id:"mentionMenu.UserMentionMenuItem.snackbarInviteSuccessMessage"},pageInviteUndo:{defaultMessage:"Undo",id:"mentionMenu.UserMentionMenuItem.undoToastMessage"}});var Or=()=>n(446866);function Ur(e){const{numberOfUserResults:t,templateVariableResults:n,query:i}=e,r=i.length>0,s=(0,a().VK)((()=>bi().Z.state.open&&bi().Z.state.insertionType),[]),l=function(e){const{templateVariableResults:t,query:n,numberOfUserResults:o}=e,i=(0,a().VK)((()=>bi().Z.state.open),[]),r=(0,a().VK)((()=>bi().Z.state.open?bi().Z.state.sectionOrder:void 0),[]),s=function(e){const{numberOfUserResults:t,templateVariableResults:n,query:o}=e,i=t+n.length;if(""===o||i>0||(0,Or().BZ)(o))return!0;const a=n.some((e=>(0,wa().i6)(e,"user")));if(a)return!0;return!1}({numberOfUserResults:o,templateVariableResults:t,query:n});if(i&&r)return r;if(s)return Fr;return Nr}({numberOfUserResults:t,templateVariableResults:n,query:i});return(0,o.useMemo)((()=>{const e=l,t=(0,wn().jj)([...e,...bi().K]),n=t.filter((e=>"createPage"!==e));return"+"===s?["createPage",...n]:"@"===s&&r||"[["===s?[...n,"createPage"]:t}),[r,s,l])}const Nr=["date","page","team","group","heading","user"],Fr=["date","user","page","team","group","heading"];function Hr(e){const{query:t,clearSavedSelection:n,inviteTargetsStore:r,personPropertyInviteStore:s,mentionMenuCurrentMentionStore:l,mentionMenuCurrentFormulaStore:d,setTemporaryInputData:c}=e,u=(0,i().O7)(),m=(0,Ie().Fg)(),p=(0,i().MO)(),{expandSection:g,isOpen:h}=(0,a().VK)((()=>({isOpen:bi().Z.state.open,expandSection:bi().Z.state.open?bi().Z.state.expandSection:void 0})),[]),v=function(e){const t=(0,H().YB)();return(0,a().VK)((()=>bi().Z.state.mentionTypes.templateVariable),[])?(0,wa().XV)(e,t):[]}(t),y=function(e){const t=(0,a().VK)((()=>bi().Z.state.mentionTypes.formulaContextVariable),[]),{automationActionStore:n,typecheckResult:i}=(0,a().VK)((()=>({automationActionStore:ja().Z.state.automationActionStore,typecheckResult:ja().Z.state.typecheckResult})),[]),r=(0,o.useMemo)((()=>n&&i?(0,Sa().getContextValuesForAction)({value:i},n.id):(null==i?void 0:i.valueTypes)||[]),[n,i]),s=i&&t;return(0,o.useMemo)((()=>s?(0,Ma().ZP)(e,r,(e=>e.kind!==wi().FormulaContextValueKind.ContextValue?"":e.name),{normalizeFuzzyScore:!0}):[]),[s,e,r])}(t),b=(0,o.useRef)(Nr[0]),{pageResultsSection:x,isPageResultsLoading:S}=fr({query:t,topBorder:"page"!==b.current,setTemporaryInputData:c,formulaContextVariableResults:y}),M=Ya({templateVariableResults:v,formulaContextVariableResults:y,topBorder:"date"!==b.current,query:t,setTemporaryInputData:c}),w=ir({query:t,setTemporaryInputData:c,topBorder:"heading"!==b.current}),{teamResultsSection:C,currentTeamResultStore:j}=rr({topBorder:"team"!==b.current,environment:u,query:t,setTemporaryInputData:c}),{userResultsSection:k,isUserResultsLoading:T,numberOfUserResults:I}=Br({topBorder:"user"!==b.current,query:t,inviteTargetsStore:r,personPropertyInviteStore:s,mentionMenuCurrentMentionStore:l,setTemporaryInputData:c,templateVariableResults:v,formulaContextVariableResults:y,currentTeamResultStore:j}),_=er({topBorder:"group"!==b.current,query:t,setTemporaryInputData:c}),P=La({topBorder:"createPage"!==b.current,query:t,clearSavedSelection:n,setTemporaryInputData:c}),A=function(e){const{mentionMenuCurrentFormulaStore:t,setTemporaryInputData:n,topBorder:o,formulaContextVariableResults:i}=e,r=i.filter((e=>e.kind===wi().FormulaContextValueKind.ContextValue&&"block"===e.type.type)),s=(0,a().VK)((()=>{const e=r.map((e=>{const o=(0,Ci().NP)(e),i=(0,Ci().WT)(e),a=(0,Ci().RX)(e.type);return{action:Wa(e,t),key:e.id,render:e=>(e.focused&&n({title:o,icon:(0,Z.jsx)(Li,{}),allowTabCompletion:!1}),(0,Z.jsx)(Ea().Z,{...e,right:(0,Ka().o)({height:"auto",marginInlineStart:6,width:12}),svg:a,title:o,tooltipText:i}))}}));return(0,f().oA)(e)}),[r,t,n]);if(s.length>0)return{items:s,key:"formula property results",render:e=>(0,Z.jsx)(Ut().Z,{...e,title:(0,Z.jsx)(H()._H,{defaultMessage:"Property from",id:"mentionMenu.formulaPropertySection.title"}),topBorder:o})}}({mentionMenuCurrentFormulaStore:d,setTemporaryInputData:c,topBorder:"formula"!==b.current,formulaContextVariableResults:y}),R=function(e){const{query:t,formulaContextVariableResults:n,setTemporaryInputData:o,topBorder:r}=e,s=(0,i().O7)(),l=(0,a().VK)((()=>Ga({environment:s,formulaVariableFilter:e=>e.kind===wi().FormulaContextValueKind.ContextValue&&(0,Ci().iT)(e),query:t,formulaContextVariableResults:n,setTemporaryInputData:o})),[s,n,t,o]);if(0!==l.length)return{items:l,key:"custom formula results",render:e=>(0,Z.jsx)(Ut().Z,{...e,title:(0,Z.jsx)(H()._H,{defaultMessage:"Custom",id:"mentionMenu.customFormulaVariables.title"}),topBorder:r})}}({query:t,formulaContextVariableResults:y,setTemporaryInputData:c,topBorder:"custom-formula"!==b.current}),B=(0,o.useMemo)((()=>({date:M,user:k,page:x,group:_,team:C,heading:w,createPage:P,formula:A,"custom-formula":R,bot:void 0})),[M,k,x,_,C,w,P,A,R]),L=Ur({templateVariableResults:v,numberOfUserResults:I,query:t});(0,o.useEffect)((()=>{const e=L.find((e=>void 0!==B[e]));b.current=e??L[0]}),[B,L]);const D=!T&&!S;(0,o.useEffect)((()=>{const e=xa().default.DO_NOT_USE_markLegacy("rum.mention_menu_ready");D&&xa().default.DO_NOT_USE_measureLegacy(e,{environment:u})}),[u,D]);const V=(0,o.useCallback)((e=>function(e){const{sectionName:t,menuSection:n,isOpen:o,expandSection:i,theme:a,isPhone:r}=e;if(!o||i===t)return n;const{items:s}=n,l=r||"heading"===t?3:5;if(s.length<=l)return n;const d=[...s.slice(0,l),{key:"show more",render:e=>(0,Z.jsx)(Vt().Z,{...e,icon:(0,ba().o)({width:16,fill:a.mediumTextColor}),title:(0,Z.jsx)("span",{style:{color:a.mediumTextColor},children:(0,Z.jsx)(H()._H,{defaultMessage:"{numberMore} more results",id:"mentionMenu.showMoreResultsButton.title",values:{numberMore:s.length-l}})})}),action:()=>{bi().Z.updateOpenState({expandSection:t})}}];return{...n,items:d}}({sectionName:e.sectionName,menuSection:e.menuSection,isPhone:p,isOpen:h,expandSection:g,theme:m})),[p,h,g,m]);return(0,o.useMemo)((()=>{const e=[];for(const t of L){const n=B[t];n&&e.push("createPage"===t?n:V({sectionName:t,menuSection:n}))}return e}),[L,B,V])}const Kr=(0,H().vU)({noResults:{defaultMessage:"No results",id:"mentionMenu.noSearchResults.title"}}),Er=(0,H().vU)({mentionAll:{defaultMessage:"Mention a person, page, or date…",id:"mentionMenu.personPageDate.prompt2"},mentionPersonPage:{defaultMessage:"Mention a person or page…",id:"mentionMenu.personPage.prompt2"},mentionPersonDate:{defaultMessage:"Mention a person or date…",id:"mentionMenu.personDate.prompt2"},mentionPageDate:{defaultMessage:"Mention a page or date…",id:"mentionMenu.pageDate.prompt2"},mentionPerson:{defaultMessage:"Mention a person…",id:"mentionMenu.person.prompt2"},mentionDate:{defaultMessage:"Mention a date…",id:"mentionMenu.date.prompt2"},mentionPage:{defaultMessage:"Type to link or add page…",id:"mentionMenu.page.prompt2"}}),Wr=o.memo((function(e){const{query:t,queryRef:n,clearSavedSelection:o,inviteTargetsStore:i,personPropertyInviteStore:a,mentionMenuCurrentMentionStore:r,mentionMenuCurrentFormulaStore:s}=e;return(0,Z.jsx)(zr,{query:t,queryRef:n,clearSavedSelection:o,inviteTargetsStore:i,personPropertyInviteStore:a,mentionMenuCurrentMentionStore:r,mentionMenuCurrentFormulaStore:s})}));function zr(e){let{query:t,queryRef:r,clearSavedSelection:s,inviteTargetsStore:l,personPropertyInviteStore:d,mentionMenuCurrentMentionStore:c,mentionMenuCurrentFormulaStore:u}=e;const m=(0,H().YB)(),p=(0,i().O7)(),g=(0,a().Kw)(bi().Z),f=(0,a().VK)((()=>ha().default.state.online),[]),h=Boolean(g.open&&g.usePopupOnMobile),v=Hi(r),y=Hr({clearSavedSelection:s,query:t,inviteTargetsStore:l,personPropertyInviteStore:d,mentionMenuCurrentMentionStore:c,mentionMenuCurrentFormulaStore:u,setTemporaryInputData:v}),x=(0,n(76225).Ij)();let M;(0,o.useEffect)((()=>{if(!f)return;const e=g.mentionTypes.user,t=g.mentionTypes.page,n=g.mentionTypes.date;let o="";e&&t&&n?o=m.formatMessage(Er.mentionAll):e&&t?o=m.formatMessage(Er.mentionPersonPage):e&&n?o=m.formatMessage(Er.mentionPersonDate):t&&n?o=m.formatMessage(Er.mentionPageDate):e?o=m.formatMessage(Er.mentionPerson):n?o=m.formatMessage(Er.mentionDate):t&&g&&(o=g.open&&"+"===g.insertionType?m.formatMessage(ya.addPage):m.formatMessage(Er.mentionPage)),v({title:o,icon:(0,Z.jsx)(Ai,{insertionType:g.open?g.insertionType:"+"}),allowTabCompletion:!1})}),[f,v,m,g]),f||(M=(0,Z.jsx)(va().Z,{title:(0,Z.jsx)(H()._H,{defaultMessage:"Please go online to mention a person or page.",id:"mentionMenu.offlineMessage"})}));const{device:w}=p,C=(0,a().VK)((()=>Oi()),[]),j=Qi(p,r);let k;k=Xi({usePopupOnMobile:h})?{menuType:S().o.ActionSheet,disableBottomPadding:!0,height:`calc(70vh - ${x}px)`}:{menuType:S().o.Popup,width:C,maxHeight:w.isMobile?"30vh":"40vh",onClickOutside:j};const T=(0,o.useCallback)((e=>{(function(e){return""===e})(r.current??"")&&(e.preventDefault(),j())}),[r,j]);return(0,Z.jsxs)(b().Z,{...k,header:M,children:[(0,Z.jsx)(tt().Z,{debugName:"MentionMenu",capture:g.open,onBackspace:T}),(0,Z.jsx)(Ot().ZP,{type:Ot().iW.Vertical,initialFocus:Gr(t),sections:y,onEmptyEnter:j,resetInitialFocusOnSectionChange:!0,performHandleEnterOnTab:!0}),0===y.length&&(0,Z.jsx)(Ut().Z,{children:(0,Z.jsx)(va().Z,{title:(0,Z.jsx)(H()._H,{...Kr.noResults})})})]})}function Gr(e){if(""!==e)return 0}function qr(){const e=(0,i().O7)(),t=(0,a().Kw)(bi().Z),n=t.open&&t.showCreateIn,r=t.open&&t.showInvite,s=t.open&&t.showMentionAndShare,l=t.open&&t.showFormulaProperty,d=Boolean(t.open&&t.usePopupOnMobile),c=(0,a().qz)(void 0,fi().ZP),u=(0,a().qz)(void 0,gi().Z),m=(0,a().qz)(void 0,Gi),p=(0,a().qz)(void 0,yi),g=(0,a().VK)((()=>{if(t.open)return w().O2(t.textStore,t.oldTextValue,t.isEmptyPageTitle?"":t.insertionType)}),[t]),f=(0,a().VK)((()=>{if(g&&t.open)return w().ug(t.textStore,g)}),[g,t]),h=(0,a().VK)((()=>qi(e,f)),[e,f]),v=(0,o.useRef)(h);(0,o.useEffect)((()=>{v.current=h}),[h]);const y=(0,a().VK)((()=>!!t.open&&("+"!==t.insertionType||""!==h)),[h,t]),b=(0,a().VK)((()=>_t().np()),[]),k=y&&(b&&(n||r)||s),{clearSavedSelection:I,getSavedSelection:_}=(0,pi().Z)({shouldPreserveTextSelection:k,shouldPreserveBlockSelection:!1,shouldRestoreSelection:k});(0,o.useEffect)((()=>{const e=bi().Z.state;if(e.open){var t;const n=T().default.state,o="editing"===n.mode?(0,M().QY)(n.multiSelection):void 0,i=(null==o?void 0:o.store)===e.textStore,a=_().textSelectionState,r=a&&"editing"===a.mode&&(null===(t=(0,M().QY)(a.multiSelection))||void 0===t?void 0:t.store)===e.textStore;if(!i&&!r)return void ci().xv();const s=i&&(null==o?void 0:o.selection);if(g&&s&&(s.startIndex<g.filter.startIndex||s.endIndex>g.filter.endIndex))return void ci().xv();const l=f&&f[0];if("+"===e.insertionType&&l&&!(0,mi().D_)(l))return void ci().xv();if("@"===e.insertionType&&l&&(0,mi().cb)(l))return void ci().xv();if(void 0===f&&!e.isEmptyPageTitle)return void ci().xv()}}),[f,_,g]);const{device:P}=e,[A,R]=(0,o.useState)(void 0),B=ui().Z.getSize(),L=(0,a().VK)((()=>{if(P.isMobile&&0!==B)return ui().Z.find((e=>e.isCaptured()))}),[P,B]);(0,o.useEffect)((()=>{const e=null==L?void 0:L.getNode();if(e){const t=new(xi().E);return t.observe(e),t.rect.addListener((e=>{R({height:`calc(100vh - ${e.state.height}px)`})})),()=>t.destroy()}}),[L]);const D=Xi({usePopupOnMobile:d}),V=D?j().k.SlideUp:j().k.Popup,O=Qi(e,v);return(0,Z.jsx)(x().ZP,{popupType:V,open:y,originRect:t.open?t.selectionRect?{...t.selectionRect,left:t.selectionRect.left-22}:t.selectionRect:void 0,slideUpWrapStyle:A,placementToOrigin:C().Placement.Bottom,alignmentToOrigin:C().Alignment.Start,originGap:12,disableMouseCapture:!r,disableContentScroll:!0,onDismiss:O,disableDarkOverlayBackground:P.isMobile,keepFocus:!0,render:()=>P.isMobile?(0,Z.jsxs)(Z.Fragment,{children:[!s&&(0,Z.jsx)(Wr,{query:h,queryRef:v,clearSavedSelection:I,inviteTargetsStore:c,personPropertyInviteStore:u,mentionMenuCurrentMentionStore:m,mentionMenuCurrentFormulaStore:p}),(0,Z.jsx)(x().ZP,{popupType:j().k.SlideUp,render:()=>(0,Z.jsx)(ta,{clearSavedSelection:I,filter:f}),open:n,keepFocus:!0}),(0,Z.jsx)(x().ZP,{popupType:j().k.SlideUp,render:()=>(0,Z.jsx)(aa,{inviteTargetsStore:c,personPropertyInviteStore:u,filter:f}),open:r,keepFocus:!0}),(0,Z.jsx)(x().ZP,{popupType:V,render:()=>(0,Z.jsx)(fa,{mentionMenuCurrentMentionStore:m,menuPopupType:D?S().o.ActionSheet:S().o.Popup}),open:s,keepFocus:!0,originRect:t.open?t.selectionRect:void 0,slideUpWrapStyle:A,placementToOrigin:C().Placement.Bottom,alignmentToOrigin:C().Alignment.Start,originGap:12,isFullWidthOnMobile:!0}),(0,Z.jsx)(x().ZP,{keepFocus:!0,open:l,popupType:j().k.SlideUp,render:()=>(0,Z.jsx)(Ei,{mentionMenuCurrentFormulaStore:p,queryRef:v})})]}):n?(0,Z.jsx)(ta,{clearSavedSelection:I,filter:f}):r?(0,Z.jsx)(aa,{inviteTargetsStore:c,personPropertyInviteStore:u,filter:f}):s?(0,Z.jsx)(fa,{mentionMenuCurrentMentionStore:m,menuPopupType:S().o.Popup}):l?(0,Z.jsx)(Ei,{mentionMenuCurrentFormulaStore:p,queryRef:v}):(0,Z.jsx)(Wr,{query:h,queryRef:v,clearSavedSelection:I,inviteTargetsStore:c,personPropertyInviteStore:u,mentionMenuCurrentMentionStore:m,mentionMenuCurrentFormulaStore:p})})}var Yr=()=>n(574089);const $r=function(){const e=(0,i().O7)(),t=(0,o.useRef)(void 0);return(0,o.useEffect)((()=>{const n=t=>{var n;if(null!==(n=t.dataTransfer)&&void 0!==n&&n.types.includes("application/x.notion.tab-id"))return t.dataTransfer.dropEffect="move",void t.preventDefault();t.preventDefault(),function(e,t){const n=Yr().f$(t,{startX:e.clientX,startY:e.clientY,stores:[],isNativeDrag:!0,getGhostElement:void 0});n&&uo().ZH({environment:t})}(t,e),o(t)},o=f().P2((n=>{t.current&&window.clearTimeout(t.current),t.current=window.setTimeout(Qr,function(e){const{device:t}=e;if(t.isLinux)return 2e3;if(t.isIOS&&X().default.checkGate({gateName:"ios_native_drag_handler_delay"}))return 1e3;return 200}(e),e),Yr().td(e,{currentX:n.clientX,currentY:n.clientY})}),Jr),i=t=>{!function(e,t){e.preventDefault();const n=Array.from(e.dataTransfer.files);n.length>0&&Yr()._4({environment:t,files:n,analyticsFrom:"native_drag"})}(t,e)};return window.addEventListener("dragover",n),window.addEventListener("drop",i),()=>{window.removeEventListener("dragover",n),window.removeEventListener("drop",i)}}),[e]),null},Jr=62.5;function Qr(e){Yr().cQ(e)}var Xr=()=>n(614027),es=()=>n(505462),ts=()=>n(64260);const ns=function(){const e=(0,i().O7)(),t=(0,a().VK)((()=>{const e=T().default.state;if("editing"!==e.mode)return null;const t=(0,M().QY)(e.multiSelection);if(!t)return null;const{store:n,selection:o}=t;if(o.endIndex!==o.startIndex+1)return null;const i=n.getValue(),a=g().b1T(i,o.startIndex);if(!a||!g().eOb(a))return null;const[r]=g().jDe([a]);return{pageId:r,store:n}}),[]),n=(0,o.useCallback)((()=>(0,Z.jsx)(os,{pageMentionTokenStoreState:t})),[t]);if(e.device.isMobile)return null;const r=es().getSelectionRect();return(0,Z.jsx)(Ue().Z,{render:()=>{},renderTooltip:n,originRect:r,forceVisibleState:Boolean(t&&r),placement:C().Placement.Bottom})};function os(e){let{pageMentionTokenStoreState:t}=e;const n=(0,Ie().Fg)(),a=(0,i().O7)(),r=(0,o.useCallback)((e=>function(e,t,n){if(!n)return;const{pageId:o,store:i}=n;if(!o)return;e.preventDefault();const a=ee().G.createChildStore(i,{table:Mn().iU,id:o});_a()._c({store:a,environment:t,visitType:Xr().vu.Link,openInNew:"tab",pageVisitSource:O().tY.MentionInPage})}(e,a,t)),[a,t]),s=(0,o.useCallback)((e=>function(e,t,n){if(!n)return;const{pageId:o,store:i}=n;if(!o)return;e.preventDefault&&e.preventDefault();const a=ee().G.createChildStore(i,{table:Mn().iU,id:o});_a()._c({store:a,environment:t,visitType:Xr().vu.Link,pageVisitSource:O().tY.MentionInPage})}(e,a,t)),[a,t]);return(0,Z.jsx)(tt().Z,{debugName:"PageMentionOverlay",capture:!0,onEnter:s,onCommandEnter:r,children:(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(H()._H,{defaultMessage:"Open page",id:"pageMentionOverlay.openPage"}),(0,Z.jsx)("div",{children:(0,Z.jsx)(ts().Z,{onlyShowFirst:!0,name:"enter",style:{color:n.mediumInvertedTextColor}})})]})})}var is=()=>n(951109),as=()=>n(794923);function rs(){const e=(0,H().YB)(),t=(0,Ie().Fg)(),n=(0,i().O7)(),{device:r}=n,s=(0,a().VK)((()=>as().default.state.blockStore),[]),l=(0,a().VK)((()=>null==s?void 0:s.getTitleStore()),[s]),d=(0,a().VK)((()=>(null==s?void 0:s.canEdit())??!1),[s]),c=(0,a().VK)((()=>{var t;return(null==s||null===(t=s.getModel())||void 0===t?void 0:t.getEmptyTitlePlaceholder({getRecordModel:s.getRecordModel,userTimeZone:(0,U().r)(),intl:e}))??""}),[s,e]);if((0,o.useEffect)((()=>{const{blockStore:e}=as().default.state;if(!e)return;const t=e.getTitleStore();t&&Re().selectAllText({environment:n,store:t,canSelectAllBlocks:!1})}),[n]),!s||!l)return null;let u;return u=r.isMobile?{menuType:S().o.ActionSheet}:{menuType:S().o.Popup,width:380},(0,Z.jsx)(b().Z,{...u,children:(0,Z.jsx)("div",{style:ls(t),children:(0,Z.jsx)(Ne().Z,{store:l,disabled:!d,onEsc:()=>is().x(n),onEnter:()=>is().x(n),disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,placeholder:c,style:ds(t),pasteBehavior:"inline",inPageFind:Le().B3.none})})})}const ss=function(){const e=(0,i().O7)(),{device:t}=e,{blockStore:n,originRect:o}=(0,a().VK)((()=>{const{blockStore:e,originRect:t}=as().default.state;return{blockStore:e,originRect:t}}),[]);return(0,Z.jsx)(x().ZP,{popupType:t.isMobile?j().k.SlideUp:j().k.Popup,open:Boolean(n),originRect:o,placementToOrigin:C().Placement.Bottom,alignmentToOrigin:C().Alignment.Center,originGap:4,onDismiss:()=>is().x(e),render:()=>(0,Z.jsx)(rs,{})})};function ls(e){return{display:"flex",alignItems:"center",color:e.regularTextColor,fontSize:"13px",padding:"4px 8px"}}function ds(e){return{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}}var cs=()=>n(95886),us=()=>n(636340),ms=()=>n(547586),ps=()=>n(795820),gs=()=>n(943620);function fs(e){const t=(0,H().YB)(),n=(0,i().O7)(),{device:r}=n,s=(0,a().VK)((()=>ps().default.state.clonedBlockStore),[]),l=(0,a().VK)((()=>null==s?void 0:s.getTitleStore()),[s]),d=(0,a().VK)((()=>(null==s?void 0:s.canEdit())??!1),[s]),c=(0,a().VK)((()=>{var e;if(s)return null===(e=s.getModel())||void 0===e?void 0:e.getEmptyTitlePlaceholder({getRecordModel:s.getRecordModel,userTimeZone:(0,U().r)(),intl:t})}),[s,t]);(0,o.useEffect)((()=>{if(!s)return;const e=s.getTitleStore();e&&Re().selectAllText({environment:n,store:e,canSelectAllBlocks:!1})}),[s,n]);const u=(0,Ie().yK)((e=>({wrapper:{display:"flex",alignItems:"center",color:e.regularTextColor,fontSize:"13px",padding:"4px 8px"},input:{display:"block",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}})),[]);if(!s||!l)return null;const{renderDelete:m}=e;let p;return p=r.isMobile?{menuType:S().o.ActionSheet}:{menuType:S().o.Popup,width:380},(0,Z.jsx)(b().Z,{...p,children:(0,Z.jsxs)("div",{style:u.wrapper,children:[(0,Z.jsx)(bs,{blockStore:s}),(0,Z.jsx)(Ne().Z,{store:l,disabled:!d,onEsc:()=>ms().x(n),onEnter:()=>ms().x(n),disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,placeholder:c,style:u.input,pasteBehavior:"inline",inPageFind:Le().B3.none}),m&&d&&(0,Z.jsx)(vs,{})]})})}const hs=function(){const e=(0,i().O7)(),{device:t}=e,{clonedBlockStore:n,originRect:o}=(0,a().VK)((()=>{const{clonedBlockStore:e,originRect:t}=ps().default.state;return{clonedBlockStore:e,originRect:t}}),[]);return(0,Z.jsx)(x().ZP,{popupType:t.isMobile?j().k.SlideUp:j().k.Popup,open:Boolean(n),originRect:o,placementToOrigin:C().Placement.Bottom,alignmentToOrigin:C().Alignment.Center,originGap:4,onDismiss:()=>ms().x(e),render:()=>(0,Z.jsx)(ys,{}),trapFocus:!0})};function vs(){const e=(0,i().O7)();return(0,Z.jsx)(Oe().Z,{ariaLabel:"Delete",icon:e=>(0,cs().y)({height:20,width:20,...e}),style:{marginLeft:6},hasBackground:!0,isDarkIconColor:!0,showShadow:!0,onClick:async()=>{const{originalBlockStore:t}=ps().default.state;t&&await co().Qw({environment:e,blocks:[t],shouldCheckSuggestEdit:!0}),ms().x(e)}})}function ys(){const e=(0,a().VK)((()=>ps().default.state.renderDelete),[]);return(0,Z.jsx)(fs,{renderDelete:Boolean(e)})}function bs(e){let{blockStore:t}=e;const n=(0,Ie().Fg)(),o=(0,i().O7)(),r={width:28,height:28,marginRight:6,flexShrink:0,flexGrow:0,boxShadow:`inset 0 0 0 1px ${n.darkDividerColor}`},s=(0,a().VK)((()=>t.canEdit()),[t]),l=(0,a().VK)((()=>{var e;return null===(e=t.getIconStore())||void 0===e?void 0:e.table}),[t]),d=(0,a().VK)((()=>{var e;return null===(e=t.getIconStore())||void 0===e?void 0:e.id}),[t]),c=(0,a().VK)((()=>t.getIcon()),[t]),u=(0,a().VK)((()=>t.isEmptyPage()),[t]),m=(0,a().VK)((()=>t.getType()),[t]);return s?(0,Z.jsx)(gs().Z,{disabled:!1,bucket:"secure",store:t,icon:c,isEmptyPage:u,size:18,style:r,iconLoggingData:{recordTable:l,source:"breadcrumb",block_type:m,collection_id:"collection"===l?d:void 0},onChange:e=>function(e,t){const{clonedBlockStore:n}=ps().default.state;if(n){const o=n.getIconStore();o&&y().createAndCommit({userAction:"RenamePageMenuPopup.handleRecordIconChange",environment:t,canUndo:!0,perform:t=>{us().sO({store:o,value:e,transaction:t})}})}}(e,o)}):(0,Z.jsx)(gs().Z,{disabled:!0,icon:c,isEmptyPage:u,size:18,style:r})}n(916054);var xs=()=>n(657320),Ss=()=>n(532850);const Ms=(0,Qn().IU)("bold",{viewBox:"0 0 16 16",svg:(0,Z.jsx)("g",{children:(0,Z.jsx)("path",{d:"M5.067 13.014c-.772 0-1.223-.451-1.223-1.238V4.36c0-.786.45-1.237 1.223-1.237h3.5c1.949 0 3.131.943 3.131 2.488 0 1.1-.793 1.97-1.948 2.12v.061c1.401.068 2.4 1.046 2.4 2.386 0 1.716-1.347 2.837-3.466 2.837H5.067zm1.238-5.81h1.34c1.025 0 1.633-.459 1.633-1.225 0-.738-.553-1.168-1.483-1.168h-1.49v2.392zm0 4.142h1.6c1.148 0 1.742-.472 1.742-1.347 0-.854-.642-1.32-1.804-1.32H6.305v2.667z"})})});var ws=()=>n(374289),Cs=()=>n(38370),js=()=>n(823715);const ks=(0,Qn().IU)("italic",{viewBox:"0 0 16 16",svg:(0,Z.jsx)("g",{children:(0,Z.jsx)("path",{d:"M5.02 13.014c-.397 0-.67-.24-.67-.63 0-.382.266-.614.663-.614H6.42l1.593-7.404H6.612c-.396 0-.67-.239-.67-.629 0-.383.267-.615.663-.615h4.382c.397 0 .663.232.663.615 0 .39-.273.63-.67.63H9.586l-1.6 7.403h1.409c.396 0 .663.232.663.615 0 .39-.274.629-.67.629H5.02z"})})});var Ts=()=>n(237874);const Is=(0,Qn().IU)("strikethrough",{viewBox:"0 0 16 16",svg:(0,Z.jsx)("g",{children:(0,Z.jsx)("path",{d:"M7.973 13.191a5.695 5.695 0 01-1.75-.253 3.694 3.694 0 01-1.306-.71 2.376 2.376 0 01-.71-1.101 1.514 1.514 0 01-.062-.424c0-.205.061-.369.184-.492a.71.71 0 01.513-.185c.155 0 .28.034.376.103a.92.92 0 01.273.328c.128.296.31.554.547.772.237.215.52.379.848.493.328.114.69.17 1.087.17.45 0 .847-.066 1.19-.198.345-.136.614-.321.806-.553.196-.237.294-.506.294-.807 0-.383-.15-.688-.451-.916-.301-.232-.796-.43-1.484-.595L7.043 8.53c-.939-.21-1.636-.528-2.092-.957-.451-.433-.677-.998-.677-1.695 0-.574.158-1.082.472-1.524.32-.443.757-.787 1.313-1.033.556-.25 1.191-.376 1.907-.376.601 0 1.148.09 1.64.267.497.173.91.415 1.238.725.328.31.547.67.656 1.08a.82.82 0 01.034.177c.01.055.014.11.014.164a.625.625 0 01-.185.472c-.123.119-.29.178-.499.178-.287 0-.506-.132-.656-.397a2.244 2.244 0 00-.506-.745 1.98 1.98 0 00-.752-.458 2.897 2.897 0 00-.984-.157c-.406 0-.766.064-1.08.191a1.742 1.742 0 00-.745.527 1.233 1.233 0 00-.267.78c0 .36.148.648.444.867.301.214.784.399 1.45.554l1.169.267c1.016.227 1.756.553 2.221.977.47.42.704.998.704 1.736 0 .611-.162 1.147-.485 1.607-.32.456-.77.809-1.354 1.06-.578.25-1.262.375-2.05.375zM2.552 8.386a.363.363 0 01-.267-.11.378.378 0 01-.11-.266c0-.1.037-.187.11-.26a.352.352 0 01.267-.116h10.89c.104 0 .193.039.266.116.073.073.11.16.11.26s-.037.189-.11.266a.363.363 0 01-.267.11H2.551z"})})}),_s=(0,Qn().IU)("underline",{viewBox:"0 0 16 16",svg:(0,Z.jsx)("g",{children:(0,Z.jsx)("path",{d:"M8 13.191c-.843 0-1.572-.152-2.188-.458a3.46 3.46 0 01-1.421-1.292c-.333-.551-.5-1.191-.5-1.92V3.724c0-.242.071-.431.213-.568.14-.141.33-.212.567-.212.246 0 .44.071.58.212.147.137.22.326.22.568v5.653c0 .488.098.914.294 1.278.2.36.49.64.868.841.378.2.834.3 1.367.3.798 0 1.417-.22 1.86-.662.446-.442.67-1.028.67-1.757V3.724c0-.242.07-.431.211-.568.142-.141.33-.212.568-.212.246 0 .44.071.58.212.147.137.22.326.22.568V9.52c0 .729-.167 1.369-.5 1.92-.332.552-.809.982-1.428 1.292-.616.306-1.342.458-2.181.458zm-3.623 2.174a.487.487 0 01-.349-.136.464.464 0 01-.136-.342c0-.137.045-.25.136-.342a.487.487 0 01.349-.137h7.24c.14 0 .257.046.348.137a.453.453 0 01.143.342c0 .136-.048.25-.143.341a.472.472 0 01-.349.137H4.377z"})})});var Ps=()=>n(752778),Zs=()=>n(790082),As=()=>n(5244);function Rs(e){const{clientSkill:t}=e,n=(0,H().YB)(),o=(0,a().VK)((()=>n.formatMessage(t.displayName)),[t,n]);return(0,Z.jsx)(Z.Fragment,{children:o})}var Bs=()=>n(986631);function Ls(e){if(e.inMemoryRecordCache.isMockTextStore){const t=e.getRecordStoreAtRootPath();if(t.table===Mn().iU){if("automation_id"in t.getProperties())return!0}}return Boolean(e.findRecordStoreUIAncestor((e=>e instanceof ee().zq||e instanceof ee().Mz)).ancestor)}var Ds=()=>n(154186);function Vs(e){const t=(0,i().O7)(),{isMobile:a}=(0,i().Fy)(),r=(0,o.useRef)(null),s=async()=>{const o=T().default.state;if("empty"===o.mode)return;const i=await n(141735).F.formulas.load();n(604068).Bf({environment:t,blockStore:e.blockStore,multiSelection:o.multiSelection,formulasModule:i})};return(0,Z.jsx)(Ue().Z,{renderTooltip:()=>(0,Z.jsx)("div",{children:(0,Z.jsx)(H()._H,{defaultMessage:"React to selected text",id:"inlineReactionButton.tooltip"})}),render:t=>(0,Z.jsxs)(Ds().Z,{ref:r,style:{display:"flex",justifyContent:"center",alignItems:"center",padding:e.iconOnly?6:"0 10px",whiteSpace:"nowrap",...e.style},disabled:e.disabled,disabledFeedback:e.disabled,onClick:s,...t,children:[(0,n(78652).V)({width:a?22:20,height:a?22:20,marginTop:a?0:1,marginRight:e.iconOnly?0:4}),!a&&!e.iconOnly&&(0,Z.jsx)(H()._H,{defaultMessage:"React",id:"inlineReactionButton.reactLabel"})]})})}Vs.displayName="InlineReactionButton";const Os=Vs;var Us=()=>n(606591),Ns=()=>n(271308),Fs=()=>n(191586),Hs=()=>n(465371),Ks=()=>n(105649),Es=()=>n(35982),Ws=()=>n(95718),zs=()=>n(279386),Gs=()=>n(72041),qs=()=>n(886970),Ys=()=>n(855249),$s=()=>n(591051),Js=()=>n(495699),Qs=()=>n(79555),Xs=()=>n(149809),el=()=>n(448419),tl=()=>n(161035),nl=()=>n(13654),ol=()=>n(244540);function il(e){const t=(0,i().O7)(),{isMobile:n}=(0,i().Fy)(),r=(0,a().VK)((()=>"suggest"===zs().MT.getMode(e.blockStore)),[e.blockStore]),s=()=>{const n=e.blockStore.getRecordStoreUIRoot();n&&n instanceof ee().G&&n.isNavigableBlock()&&ol().t_({environment:t,navigableBlockStore:n,mode:r?"default":"suggest",location:"rich_text_menu"})},l=(0,Ie().yK)((t=>({button:{display:"flex",alignItems:"center",padding:e.iconOnly?6:"0 10px",whiteSpace:"nowrap",color:r?t.blueColor:t.icon.primary,...e.style},icon:{width:n?18:16,height:n?18:16,marginTop:n?0:1,marginRight:e.iconOnly?0:4}})),[n,r,e.iconOnly,e.style]);return(0,Z.jsx)(Ue().Z,{renderTooltip:()=>(0,Z.jsxs)(o.Fragment,{children:[(0,Z.jsx)("div",{children:r?(0,Z.jsx)(H()._H,{defaultMessage:"Turn off suggesting",id:"inlineSuggestButton.tooltipDisable"}):(0,Z.jsx)(H()._H,{defaultMessage:"Suggest edits",id:"inlineSuggestButton.tooltipEnable"})}),(0,Z.jsx)("div",{})]}),render:t=>(0,Z.jsxs)(Ds().Z,{style:l.button,disabled:e.disabled,disabledFeedback:e.disabled,onClick:s,...t,children:[(0,nl().I)(l.icon),!n&&!e.iconOnly&&(r?(0,Z.jsx)(H()._H,{defaultMessage:"Suggesting",id:"inlineSuggestButton.suggestingLabel"}):(0,Z.jsx)(H()._H,{defaultMessage:"Suggest",id:"inlineSuggestButton.suggestLabel"}))]})})}var al=()=>n(675876),rl=()=>n(393322),sl=()=>n(284831);function ll(){var e;if(!(0,Fa().E)("selectable_word_count"))return null;const t=null===(e=es().get())||void 0===e?void 0:e.cloneContents(),n=t?dl(t):0;return 0===n?null:(0,Z.jsx)("div",{style:{justifyContent:"center",alignSelf:"center",whiteSpace:"pre-wrap",padding:"0px 6px"},children:(0,Z.jsx)(H()._H,{id:"richTextMenu.wordCount",defaultMessage:"{count, plural, one {# word} other {# words}}",values:{count:n}})})}function dl(e){if(0===e.childNodes.length)return 0;let t=0;for(let n=0;n<e.childNodes.length;n++){const o=e.childNodes[n];o.childNodes.length>0?t+=dl(o):o.textContent&&(t+=(0,Be().WF)(o.textContent))}return t}const cl={[Ye().Ti.button]:new Set(["showActionButton","showCompletions","showDiscuss","showReact","showSuggest","showTurnInto"]),[Ye().Ti.code]:new Set(["showCode","showCompletions"]),[Ye().Ti.table]:new Set(["showTurnInto","showActionButton","showCompletions"]),[Ye().Ti.tableRow]:new Set(["showTurnInto","showActionButton","showCompletions"])},ul={[Ye().Ti.factory]:!0};const ml=function(){const e=(0,xs().l)(),t=(0,i().O7)(),r=(0,i().Fy)(),s=(0,a().Kw)($s().Z),{isActive:l,blockTarget:d,isAnimatingClosed:c}=s,u=(0,a().VK)((()=>Q().default.state.mainEditorCurrentBlockStore),[]),m=(0,a().VK)((()=>Rt().KR.isRichTextMenuSuggestionEnabled()),[]),[p,g]=(0,o.useState)(void 0),h=(0,o.useCallback)((()=>{var e;if(!m||!u)return;const n=(0,Mt().filterAndRankAssistantSurfaceActionsForContext)((0,Mt().clientSkillToAssistantSurfaceAction)((0,wt().getAllClientSkills)({currentPageRecordPointer:void 0,currentCollectionRecordPointer:void 0})),{type:"entrypoint",entrypoint:"richTextMenu",pageStore:u,selectionState:Dt().default.state,textSelectionState:T().default.state,isMobile:t.device.isMobile,userSettings:null===(e=Q().default.state.currentUserSettingsStore)||void 0===e?void 0:e.getSettings()});return n.length?n[0]:void 0}),[m,u,t]),v=(0,a().VK)((()=>{const t=d,o=T().default.state;if(!l||"empty"===o.mode)return;const{multiSelection:i}=o,a=(0,Ns().L5)(i),r=a.map((e=>{let{editable:t}=e;return t.getContextClosestSelectableStore()})),s=(0,M().qS)(i),c=T().default.isEditingComment(),u=T().default.isEditingFormQuestion(),m=t&&"form"===t.getType(),g=u||m,f=T().default.isEditingCaption(),h=t&&t.getParentTable()===Ps().vF,v=s&&t&&i.start.store===t.getCollectionViewSourceDescriptionStore(),y=n(942226).Tx(),b=e&&e.publicEditModeStore.state,x=!(0,Cr().Ix)(b)&&(i.start.store.canEdit()&&i.end.store.canEdit()),S=t&&"suggest"===zs().MT.getMode(t),w=X().default.checkGate({gateName:"block_reactions"}),C=r.some(((e,t)=>{const n=a[t].store.table===oo().x_&&!a[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!n})),j=x&&!C,k=t&&t.getType(),I=k&&cl[k],_=null==t?void 0:t.isType("button"),P=(0,Bs().t)(i.start.store)||(0,Bs().t)(i.end.store),Z=Ls(i.start.store)||Ls(i.end.store);let A=!1;const R=Se().Z.state.isOpen?Se().Z.state:Me().Z.state.isOpen?Me().Z.state:void 0;if(R){const e=R.store.getParentStore();if((null==e?void 0:e.table)===Ps().vF){const t=e.getSchema(),n=R.property,o=(0,Ss().Qm)({schema:t,property:n});"text"!==(null==o?void 0:o.type)||o.ai_inference||(A=!0)}}const B={isSingleStoreSelection:s,showTurnInto:Boolean(s&&!c&&!h&&!v&&!f&&t&&j&&!_&&!S&&!g&&(P||!Z)),showBold:Boolean(j),showItalic:Boolean(j),showStrikethrough:Boolean(j),showUnderline:Boolean(j),showCode:Boolean(j),showLink:Boolean(s&&j),showHighlight:Boolean(j),showDiscuss:Boolean(!c&&t&&(A||!h)&&!v&&!g&&!Z),showReact:Boolean(w&&!c&&t&&!h&&!v&&!Z&&!g),showSuggest:Boolean(!c&&t&&!h&&!v&&!Z&&!y&&!C&&!g),showEquation:Boolean(s&&j&&!S&&!g),showActionButton:Boolean(s&&!c&&!f&&t&&!h&&!g&&(P||!Z)),targetBlockStore:t,isComment:c,showCompletions:Boolean((0,n(982855).GD)(b)&&j&&!c&&!f&&t&&!h&&!v&&!_&&!Z&&!S&&!g),topRankedSkill:p};if(I&&I.size>0)for(const e of I)B[e]=!1;return B}),[d,l,e,p]),[y,b]=(0,o.useState)(v);(0,o.useEffect)((()=>{v&&b(v)}),[v]);const x=(0,a().VK)((()=>t.WindowSizeStore.state.height),[t.WindowSizeStore]),S=(0,a().VK)((()=>v&&v.showDiscuss&&!v.showBold),[v]),w=(0,o.useCallback)((()=>{if(n(385185).Z.state.open||Js().Z.state.open)return;if(n(764189).n.state)return As().w();const e=T().default.state;if("empty"===e.mode)return As().w();const o=(0,Ns().L5)(e.multiSelection);if(0===o.length)return As().w();if(!o.every((e=>{let{store:t}=e;return t.table===Mn().iU||t.table===oo().x_||t.table===Ps().vF||t.table===n(26645).L_})))return As().w();if(!t.currentUser.isLoggedIn()||!o.every((e=>{let{store:t}=e;return t.canComment()})))return;const i=es().get();if(_t().JE())return As().w();if(o.some((e=>{let{editable:t}=e;return t.props.disableStyleAnnotations})))return As().w();const a=o.map((e=>{let{editable:t}=e;return t.getContextClosestSelectableStore()}));if(a.some((e=>e&&e.pathIsDead())))return As().w();if(a.some((e=>e&&(0,Ws().Eo)(e))))return As().w();if(a.some(((e,t)=>{const n=o[t].store.canComment(),i=o[t].store.table===oo().x_&&o[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!n||i})))return As().w();const l=o.some((e=>{let{store:t}=e;const n=t.getRecordStoreAtRootPath();if(!(n instanceof ee().G))return!1;const o=n.getValue();return!!o&&ul[o.type]}));if(l)return As().w();const d=i?es().getRect(i):void 0;if(d&&!Es().kK(d,(0,n(782202).Z)()))return As().w();if(ps().default.isActive()||as().default.isActive()||Qo().Z.isOpen()||l||Ks().default.isPeekDismissableState()||!i||!function(){const e=es().get();return!!e&&!e.collapsed&&"empty"!==T().default.state.mode&&!(0,M().iG)(T().default.state.multiSelection)}()||n(953624).Z.state.open||"assistantCompletionPopup"===Lt().default.state.type)return As().w();let c=0,u=0;if(d){c=d.left;const e=25,t=d.top-36-e,o=n(467171).R6(r.isElectronMac),i=x-36-e;u=Math.min(Math.max(t,o),i)}0===Math.abs($s().Z.state.top-u)&&Math.abs($s().Z.state.left-c)<10&&(u=$s().Z.state.top,c=$s().Z.state.left),g(h()),$s().Z.setState({...s,isActive:!0,isAnimatingClosed:!1,top:u,left:c,blockTarget:Dt().default.state.stores[0]})}),[t.currentUser,x,r.isElectronMac,s,g,h]),C=(0,o.useMemo)((()=>f().P2(w,200,{leading:!1})),[w]);(0,o.useEffect)((()=>(Dt().default.addListener(C),T().default.addListener(C),Gs().Z.addListener(w),Ys().Z.addListener(w),qs().Z.addListener(w),Ks().default.addListener(w),()=>{T().default.removeListener(C),Dt().default.removeListener(C),Gs().Z.removeListener(w),Ys().Z.removeListener(w),qs().Z.removeListener(w),Ks().default.removeListener(w)})),[w,C]);const j=(0,a().VK)((()=>function(e){const t=null==e?void 0:e.getParentStore();if((null==t?void 0:t.table)===Mn().iU)return!!t&&(0,Fs().Wt)(t);return!1}(d)),[d]),k=(0,o.useCallback)((()=>{s.isActive||$s().Z.setState({...s,isAnimatingClosed:!1}),b(v)}),[s,v]);return(0,Z.jsx)(vo().Z,{open:l||c,children:(0,Z.jsx)(gl,{handleAnimationEnd:k,isActive:l,isExternallyImportedAndSyncedCollectionPageBlockTarget:j,lastRenderState:y,richTextMenuStoreState:s,canOnlyDiscuss:S})})},pl=o.forwardRef((function(e,t){let{lastRenderState:n,richTextMenuStoreState:o,canOnlyDiscuss:i,style:a}=e;const{top:r,left:s}=o,l=Math.max(i?s:s-60,0),d=i?"12px 0":12;return(0,Z.jsxs)("div",{className:Pt().Qcf,style:{pointerEvents:"none",position:"absolute",top:r,left:0,display:"flex",width:"100%",...a},ref:t,children:[(0,Z.jsx)("div",{style:{flexShrink:1,width:l,minWidth:24}}),(0,mo().Z)((e=>(0,Z.jsx)("div",{style:{pointerEvents:"none",padding:d},...e,children:n&&(0,Z.jsx)(_l,{renderState:n})}))),(0,Z.jsx)("div",{style:{flexGrow:1,flexShrink:1,minWidth:36}})]})}));function gl(e){let{handleAnimationEnd:t,isActive:n,isExternallyImportedAndSyncedCollectionPageBlockTarget:o,lastRenderState:i,richTextMenuStoreState:a,canOnlyDiscuss:r}=e;return(0,Z.jsx)(fo().Z,{tag:pl,visible:n&&!o,initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.98},onAnimationEnd:t,config:{duration:120},lastRenderState:i,richTextMenuStoreState:a,canOnlyDiscuss:r})}function fl(e){let{theme:t,styles:n}=e;return(0,Z.jsx)("div",{style:{height:24,width:1,borderRight:`1px solid ${t.regularDividerColor}`,margin:"auto 6px",...n}})}function hl(e){let{blockStore:t}=e;const n=(0,Ie().Fg)(),o=(0,i().O7)(),r=(0,H().YB)();let s=(0,Z.jsx)(H()._H,{defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.label"});const l=(0,a().VK)((()=>t.getType()),[t]);if(l){const e=Us().Hc[l];s=e&&e.displayName||s}return(0,Z.jsx)(el().ZP,{popupType:el().Z4.Popup,buttonPopupStore:Js().Z,originGap:4,renderOrigin:e=>(0,Z.jsx)(Ue().Z,{renderTooltip:()=>r.formatMessage({defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.tooltip"}),render:t=>(0,Z.jsxs)(Ds().Z,{style:{display:"flex",alignItems:"center",paddingLeft:7,paddingRight:6,whiteSpace:"nowrap",color:n.icon.primary,borderRadius:6},...(0,Pa().Z)(e,t),children:[s,(0,ws().i)({width:10,marginLeft:4,fill:n.lightIconColor})]})}),render:()=>(0,Z.jsx)(b().Z,{menuType:S().o.Popup,children:(0,Z.jsx)(Xs().Z,{context:{blocks:[t],environment:o,publicEditMode:void 0},sections:[Zs().gH],onAccept:e=>{const n=t.getType(),i=t.getFormat();As().w(),ro().dh(o,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"rich_text_menu",block_id:t.id,block_type:n,is_toggleable:n?(0,Hs()._A)(n,i):void 0,parent_collection_id:t.getParentCollectionIdUpToTwoLevels()})}})}),onClick:()=>{ro().mt(o,{action:"turn_into"})}})}function vl(){const e=(0,Ie().Fg)();return(0,Z.jsx)(al().Z,{type:"b",tooltipLabel:(0,Z.jsxs)(o.Fragment,{children:[(0,Z.jsx)("div",{children:(0,Z.jsx)(H()._H,{defaultMessage:"Bold",id:"richTextMenu.boldButton.tooltip"})}),(0,Z.jsx)("div",{children:(0,Z.jsx)(ts().Z,{style:{color:e.mediumInvertedTextColor},name:"toggleBold"})})]}),children:Ms({width:16,height:16})})}function yl(){const e=(0,Ie().Fg)();return(0,Z.jsx)(al().Z,{type:"i",tooltipLabel:(0,Z.jsxs)(o.Fragment,{children:[(0,Z.jsx)("div",{children:(0,Z.jsx)(H()._H,{defaultMessage:"Italicize",id:"richTextMenu.italicsButton.tooltip"})}),(0,Z.jsx)("div",{children:(0,Z.jsx)(ts().Z,{style:{color:e.mediumInvertedTextColor},name:"toggleItalics"})})]}),children:ks({width:16,height:16})})}function bl(){const e=(0,Ie().Fg)();return(0,Z.jsx)(al().Z,{type:"s",tooltipLabel:(0,Z.jsxs)(o.Fragment,{children:[(0,Z.jsx)("div",{children:(0,Z.jsx)(H()._H,{defaultMessage:"Strike-through",id:"richTextMenu.strikeThroughButton.tooltip"})}),(0,Z.jsx)("div",{children:(0,Z.jsx)(ts().Z,{style:{color:e.mediumInvertedTextColor},name:"toggleStrike"})})]}),children:Is({width:16,height:16})})}function xl(){const e=(0,Ie().Fg)();return(0,Z.jsx)(al().Z,{type:"_",tooltipLabel:(0,Z.jsxs)(o.Fragment,{children:[(0,Z.jsx)("div",{children:(0,Z.jsx)(H()._H,{defaultMessage:"Underline",id:"richTextMenu.underlineButton.tooltip"})}),(0,Z.jsx)("div",{children:(0,Z.jsx)(ts().Z,{style:{color:e.mediumInvertedTextColor},name:"toggleUnderline"})})]}),children:_s({width:16,height:16})})}function Sl(){const e=(0,Ie().Fg)();return(0,Z.jsx)(al().Z,{type:"c",tooltipLabel:(0,Z.jsxs)(o.Fragment,{children:[(0,Z.jsx)("div",{children:(0,Z.jsx)(H()._H,{defaultMessage:"Mark as code",id:"richTextMenu.markAsCodeButton.tooltip"})}),(0,Z.jsx)("div",{children:(0,Z.jsx)(ts().Z,{style:{color:e.mediumInvertedTextColor},name:"toggleCode"})})]}),children:(0,Cs().z)({width:16,height:16})})}function Ml(e){let{}=e;const t=(0,Ie().Fg)();return(0,Z.jsx)(sl().Z,{children:(0,Z.jsxs)("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[(0,Ts().N)({width:16,height:16,color:t.icon.primary}),(0,ws().i)({width:10,fill:t.lightIconColor})]})})}function wl(e){let{intl:t,topRankedSkill:n}=e;const o=(0,Ie().Fg)(),r=(0,i().O7)(),s=(0,a().VK)((()=>Rt().KR.isXMLAssistantEnabled()),[]);return(0,Z.jsxs)(Z.Fragment,{children:[n&&(0,Z.jsxs)(Ds().Z,{style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",borderRadius:6},onClick:()=>{(0,yt().vi)({environment:r,clientSkillWithParameterValues:(0,wt().dangerouslyCreateClientSkillWithParameterValues)(n),from:"rich_text_menu",assistantSurfaceType:r.device.isMobile?"mobileWriter":"writer"}),ro().mt(r,{action:"completions"})},children:[n.icon({width:16,height:16,marginRight:6,fill:(0,Ct().zm)(n.category).color(o).color}),(0,Z.jsx)("span",{children:(0,Z.jsx)(Rs,{clientSkill:n})})]}),(0,Z.jsx)(Ue().Z,{renderTooltip:()=>(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("div",{children:s?t.formatMessage({defaultMessage:"Make edits, find answers, and more",id:"richTextMenu.assist.assistantTooltip"}):t.formatMessage({defaultMessage:"Ask AI to help edit, review, or generate text.",id:"richTextMenu.assist.tooltip"})}),(0,Z.jsx)("div",{children:(0,Z.jsx)(ts().Z,{style:{color:o.mediumInvertedTextColor},name:"commandJ"})})]}),render:e=>(0,Z.jsxs)(Ds().Z,{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"0 6px",whiteSpace:"nowrap",borderRadius:6,height:28},...e,onClick:()=>{(0,xt().toggleInitialPrompt)({from:"rich_text_menu",environment:r}),ro().mt(r,{action:"completions"})},children:[(0,Z.jsx)(St().h9,{}),(0,Z.jsx)("span",{style:{marginLeft:6,marginRight:2},children:(0,Z.jsx)(H()._H,{defaultMessage:"Ask AI",id:"richTextMenu.assistButton.label"})})]})})]})}function Cl(){const e=(0,i().O7)();return(0,Z.jsx)(rl().Z,{onClick:()=>{ro().mt(e,{action:"e"}),As().w()},children:(0,js().G)({width:16,height:16})})}function jl(e){let{targetBlockStore:t,iconOnly:n}=e;const o=(0,Ie().Fg)(),i=(0,H().YB)();return(0,Z.jsx)(tl().Z,{style:{borderRadius:6,color:o.icon.primary,fill:o.icon.primary,height:28},iconOnly:n,blockStore:t,ariaLabel:i.formatMessage({id:"richTextMenu.Discussions.OpenDiscussionButton",defaultMessage:"Write a comment"})})}function kl(e){let{targetBlockStore:t,iconOnly:n}=e;const o=(0,Ie().Fg)();return(0,Z.jsx)(Os,{style:{borderRadius:6,color:o.icon.primary,fill:o.icon.primary,height:28,width:n?28:void 0},iconOnly:n,blockStore:t})}function Tl(e){let{targetBlockStore:t,iconOnly:n}=e;return(0,Z.jsx)(il,{style:{borderRadius:6,height:28},iconOnly:n,blockStore:t})}function Il(e){let{targetBlockStore:t}=e;const n=(0,Ie().Fg)(),o=(0,i().O7)();return(0,Z.jsx)(Qs().Z,{store:t,style:{borderRadius:6,padding:6,width:28,height:28},iconStyle:{fill:n.icon.primary},fadeIn:!1,onClick:()=>{ro().mt(o,{action:"more"})}})}function _l(e){let{renderState:t}=e;const o=(0,H().YB)(),i=(0,Ie().Fg)(),r=(0,a().VK)((()=>$s().Z.state.isActive),[]),s=t.showDiscuss||t.showReact||t.showSuggest,l=t.showBold||t.showItalic||t.showUnderline||t.showStrikethrough||t.showCode||t.showEquation||t.showHighlight,d=l;return(0,Z.jsxs)("div",{style:{display:"inline-flex",alignItems:"stretch",height:36,background:i.popoverBackground,overflow:"hidden",fontSize:14,lineHeight:1.2,borderRadius:8,boxShadow:i.shadowMD,pointerEvents:r?"auto":"none",padding:"4px"},onMouseDown:e=>e.preventDefault(),children:[t.showCompletions&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(wl,{intl:o,topRankedSkill:t.topRankedSkill}),(0,Z.jsx)(fl,{theme:i})]}),s&&t.targetBlockStore&&(0,Z.jsxs)(Z.Fragment,{children:[t.showDiscuss&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(jl,{targetBlockStore:t.targetBlockStore,iconOnly:!1}),!d&&(t.showReact||t.showSuggest)&&(0,Z.jsx)(fl,{theme:i})]}),t.showReact&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(kl,{targetBlockStore:t.targetBlockStore,iconOnly:d}),!d&&t.showSuggest&&(0,Z.jsx)(fl,{theme:i})]}),t.showSuggest&&(0,Z.jsx)(Tl,{targetBlockStore:t.targetBlockStore,iconOnly:d}),l&&(0,Z.jsx)(fl,{theme:i})]}),l&&(0,Z.jsxs)(Z.Fragment,{children:[t.showTurnInto&&t.targetBlockStore&&(0,Z.jsx)(hl,{blockStore:t.targetBlockStore}),(0,Z.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[t.showBold&&(0,Z.jsx)(vl,{}),t.showItalic&&(0,Z.jsx)(yl,{}),t.showUnderline&&(0,Z.jsx)(xl,{}),t.showStrikethrough&&(0,Z.jsx)(bl,{}),t.showCode&&(0,Z.jsx)(Sl,{}),t.showEquation&&(0,Z.jsx)(Cl,{})]}),t.showLink&&(0,Z.jsx)(Ml,{}),t.showHighlight&&(0,Z.jsx)(n(313358).Z,{blockStore:t.targetBlockStore})]}),(0,Z.jsx)(ll,{}),t.showActionButton&&t.targetBlockStore&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(fl,{theme:i}),(0,Z.jsx)(Il,{targetBlockStore:t.targetBlockStore})]})]})}var Pl=()=>n(949842),Zl=()=>n(163085),Al=()=>n(793935),Rl=()=>n(291335);const Bl=5,Ll=18,Dl=.38;const Vl=function(){const e=(0,i().O7)(),t=(0,o.useRef)(void 0),n=(0,o.useRef)(void 0),r=(0,o.useRef)(1/0),s=(0,o.useRef)(void 0),l=(0,a().VK)((()=>e.WindowSizeStore.state.width),[e]);return(0,o.useEffect)((()=>{l<Al().OnlyOneSidebarVisibleWidthThreshold&&(0,ze().Sx)(e)&&(0,ze().in)(e)&&Al().setExpand({environment:e,isExpanded:!1,from:"sidebar_listener",saveDetailsSidebarPreference:!1})}),[e,l]),(0,o.useEffect)((()=>{const o=o=>{!function(e){let{e:t,environment:n,timerRef:o,cachedPageViewRectRef:i,previousMousePositionRef:a,mouseSpeedRef:r}=e;(0,Pl().ZP)({event:t,context:Pl().Af.SidebarMouseMove,callback:()=>{Ul(i),void 0!==a.current&&(r.current=Math.sqrt(Math.pow(t.clientX-a.current.x,2)+Math.pow(t.clientY-a.current.y,2))),function(e){let{x:t,y:n,timerRef:o,previousMousePositionRef:i}=e;i.current={x:t,y:n},clearTimeout(o.current),o.current=setTimeout((()=>{i.current=void 0}),100)}({x:t.clientX,y:t.clientY,timerRef:o,previousMousePositionRef:a});const e=X().default.checkGate({gateName:"sidebar_hover_expansion_v3"});if(i.current){const o=Rl().sidebarOpenStore.state,a=t.clientX,s=i.current.left,l=Math.max(s*Dl,Ll,Rl().sidebarMousePeekXStore.state);a<l&&!nr().default.isCenterPeekOpen()&&r.current<Bl&&0!==r.current&&!o&&!e&&Al().open({fromElectron:!1}),a>(0,ze().qG)(n)&&a>l&&o&&Al().close()}}})}({e:o,environment:e,timerRef:s,cachedPageViewRectRef:t,previousMousePositionRef:n,mouseSpeedRef:r})};return window.addEventListener("mousemove",o),window.addEventListener("mouseout",Ol),()=>{window.removeEventListener("mousemove",o),window.removeEventListener("mouseout",Ol)}}),[e]),(0,Z.jsx)(Z.Fragment,{})};function Ol(e){e.toElement||e.relatedTarget||Al().close()}const Ul=f().P2((function(e){const t=function(){const{mainEditorCurrentBlockStore:e}=Q().default.state,t=Zl().Z.find((t=>t.store===e));if(t){const e=t.getContentWrapEl();if(e)return e}}();e.current=t?t.getBoundingClientRect():document.body.getBoundingClientRect()}),500);var Nl=()=>n(708232),Fl=(n(30005),()=>n(146947)),Hl=()=>n(5234),Kl=()=>n(159408),El=()=>n(894534);const Wl=(0,Qn().CZ)("page",{default:{loader:()=>n.e(53748).then(n.bind(n,153748))},small:{loader:()=>n.e(71762).then(n.bind(n,471762))},mini:{loader:()=>n.e(87589).then(n.bind(n,287589))},large:{loader:()=>n.e(77477).then(n.bind(n,477477))},extraLarge:{loader:()=>n.e(34819).then(n.bind(n,934819))}});var zl=()=>n(73363),Gl=()=>n(802473),ql=()=>n(81954),Yl=()=>n(122792),$l=()=>n(407391),Jl=()=>n(308186),Ql=()=>n(497065),Xl=()=>n(932005),ed=()=>n(620768),td=()=>n(679387),nd=()=>n(181344),od=()=>n(421797),id=()=>n(871953),ad=()=>n(814139),rd=()=>n(480089),sd=()=>n(727475),ld=()=>n(311562),dd=()=>n(965014),cd=()=>n(18281),ud=()=>n(697623),md=()=>n(897257),pd=()=>n(893405),gd=()=>n(108714),fd=()=>n(603692),hd=()=>n(661641),vd=()=>n(661297),yd=()=>n(906651),bd=()=>n(384241),xd=()=>n(842574),Sd=()=>n(641481),Md=()=>n(66077),wd=()=>n(226413),Cd=()=>n(216939),jd=()=>n(217465),kd=()=>n(827370),Td=()=>n(139978),Id=()=>n(989478),_d=()=>n(839002),Pd=()=>n(778447);const Zd=function(e){const t=(0,i().O7)(),r=(0,Fa().E)("large_surface_error_boundary"),s=(0,a().VK)((()=>e.blockStore.getAssociatedCollectionStore()),[e.blockStore]),l=(0,a().VK)((()=>{var e;return null==s||null===(e=s.getLayoutStore())||void 0===e?void 0:e.getModules()}),[s]),d=(0,a().VK)((()=>{if(!s)return 0;const{count:e}=(0,We().nJ)({collectionStore:s});return e}),[s]),{device:{isMobile:c}}=(0,i().O7)(),u=d>0&&!c,m=(0,Ie().yK)((e=>({spinnerWrapper:{padding:32,display:"flex",alignItems:"center",justifyContent:"center"},scroller:{background:e.contentBackground,zIndex:1,flexGrow:1,...u&&{paddingLeft:70,paddingRight:70}},container:{display:"flex",flexDirection:"row",flexGrow:1,overflow:"hidden"},layoutDetailsSidebar:{width:n(242921).NQ,flexShrink:0,borderLeft:`1px solid ${e.stroke.secondary}`}})),[u]),p=(0,o.useCallback)((e=>{Xl().U4(),Ql().c4({environment:t,url:e})}),[t]),h=e.blockStore.id,v=e.timestamp,[y]=(0,ue().r5)((async()=>await async function(e,t,n){const{timestamp:o}=e,i=e.block.id,a=await E().callApi({eventName:"getSnapshotContents",environment:n,data:e});if("failed"===a.type)throw a.error;const r=jd().RecordMapWithRole.create(a.data.contentMap),s=n.currentUser.id,l=new(Md().Z)({name:"PageSnapshotPreview"});for(const{pointer:p,model:g}of r)g&&l.setModelAndRole({pointer:p,userId:s},g,"reader");l.snapshotData={blockId:i,timestamp:o};const d=new Map,c=e=>{const n=l.getRecord({pointer:e,userId:s}),o=(0,Cd().dn)(e);n||!(0,Sr().e)(e.id)||d.has(o)||d.set(o,(0,ee().Kv)(t,e))},u=[];for(const{model:p}of r)if(p)if(p.table===Mn().iU){const e=p,t=e.getProperties(),n=kd().dr.uniq(f().xH(Object.keys(t).map((e=>t[e])).map(g().cCA)));for(const d of n)c(d);const o=kd().dr.uniq(f().xH(Object.keys(t).map((e=>t[e])).map(Ss().rq)));for(const d of o)c(d);const i=e.isNavigableBlock()?[]:e.getContentIds()||[];for(const d of i)c({table:Mn().iU,id:d});const a=e.getCollectionPointer();a&&(c(a),u.push(a.id));const r=f().jj(f().xH(Object.keys(t).map((e=>t[e])).map(g().lcG)));for(const d of r)c({table:Id().KJ,id:d});const s=p.getCreatedByPointer();s&&c(s);const l=p.getLastEditedByPointer();l&&c(l)}else if(p.table===Td().np){var m;const e=null===(m=p.getFormat())||void 0===m?void 0:m.collection_pointer;e&&c(e)}else if(p.table===oo().x_){const e=p.getCreatedByPointer();e&&c(e)}return await Ad({relatedStoresMap:d,inMemoryRecordCache:l,currentUserId:s}),u.forEach((e=>{var t;const n=null===(t=l.getRecord({pointer:{table:Ps().vF,id:e},userId:s}))||void 0===t?void 0:t.value;n&&n.schema&&Object.keys(n.schema).forEach((e=>{var t;const o=null===(t=n.schema)||void 0===t?void 0:t[e],i=o&&(0,wd().p_)(o)?(0,wd().F0)(o):void 0;i&&c({table:Ps().vF,id:i})}))})),await Ad({relatedStoresMap:d,inMemoryRecordCache:l,currentUserId:s}),{blockStore:new(ee().G)(n,{table:Mn().iU,id:i},{inMemoryRecordCache:l}),timestamp:o}}({block:{id:h,spaceId:(0,ql().J)(e.blockStore.pointer.spaceId)},timestamp:v},e.blockStore,t)),[h,t,e.blockStore,v]),b="pending"!==y.status&&"idle"!==y.status,x=y.value,S=y.error,M=(0,ur().Z)(!b||!x,400,400),w=(0,a().VK)((()=>{if(M)return(0,Z.jsx)("div",{style:m.spinnerWrapper,children:(0,Z.jsx)(Zn().Z,{})});if(S)return(0,Z.jsx)("div",{style:{padding:32},children:(0,Z.jsx)(H()._H,{defaultMessage:"Something went wrong.",id:"pageSnapshotPreview.unknownPreviewLoadError.message"})});const o=(0,_t().Zy)({environment:t,store:e.blockStore});return x?(0,Z.jsxs)(n(251932).gq,{style:m.container,children:[(0,Z.jsx)(ot().Z,{store:x.blockStore,isDefaultContainer:!0,droppable:!0,render:e=>{let{selectableEvents:n}=e;return(0,Z.jsx)(xd().T,{style:m.scroller,type:o,...n,children:(0,Z.jsx)(Pd().ZP,{store:x.blockStore,disabled:!0,context:ld().S.InPageSnapShot,paddingBottom:(0,Pd().EA)(t),layoutModulesByArea:l})})}},x.timestamp),u&&(null==l?void 0:l.page_details)&&(0,Z.jsx)(xd().T,{style:m.layoutDetailsSidebar,type:Xe().Z.Y,children:(0,Z.jsx)(n(562219).J,{store:x.blockStore,context:ld().S.InPageSnapShot,disabled:!0,shownAs:"static_sidebar",modules:l.page_details})})]}):void 0}),[M,S,t,e.blockStore,x,m.spinnerWrapper,m.container,m.layoutDetailsSidebar,m.scroller,u,l]);return(0,Z.jsx)(td().T,{disabled:!r,from:"PageSnapshotPreview",fallback:e=>{let{errorId:t}=e;return(0,Z.jsx)(nd().y,{errorId:t})},children:(0,Z.jsx)(n(41340).L,{value:p,children:w})})};async function Ad(e){const{relatedStoresMap:t,inMemoryRecordCache:n,currentUserId:o}=e,i=Array.from(t.values());await(0,_d().qd)(i,25,(async e=>{await e.load();const t=e.getValue();t&&n.setRecord({pointer:e.pointer,userId:o},{role:"reader",value:t})}))}var Rd=()=>n(628965);const Bd={display:"flex",justifyContent:"center",padding:32},Ld=(0,H().vU)({restoreSnapshotError:{id:"historyModal.restoreSnapshot.errorMessage",defaultMessage:"Failed to restore version."}});const Dd=function(){const e=(0,H().YB)(),t=(0,i().O7)(),{device:o}=t,r=(0,a().Kw)(sd().Z),s=ec();return o.isMobile?(0,Z.jsx)(x().ZP,{ariaLabel:Kd(e),popupType:j().k.SlideUp,open:r.open,render:()=>(0,Z.jsx)(Xd,{}),onDismiss:Xl().U4}):(0,Z.jsx)(n(708518).Z,{ariaLabel:Kd(e),open:r.open,innerStyle:s.modal,onDismiss:Xl().U4,render:()=>(0,Z.jsx)(Xd,{}),className:Pt().Nn$})},Vd=(0,Z.jsx)(H()._H,{defaultMessage:"This page does not have any snapshots yet. Allow up to 10 minutes for the first snapshot to be generated.",id:"historyModal.noSnapshotsYet.message"});function Od(){return Gl().sb.filter((e=>"personal"!==e.tier))}function Ud(e){const t=Od(),n=t.findIndex((t=>t.tier===e));if(!(n<=0))return t[n-1]}function Nd(e){var t;if(z().default.isAdminMode)return;const{nextFutureSnapshot:n}=e;if(!n)return;const o=(i=n,(Date.now()-parseInt(i.timestamp))/wn().A0);var i;if((0,ud().Aw)()&&o<=Gl().hy.plus.days)return;const a=function(e){return Od().filter((t=>t.days>e)).map((e=>e.tier))}(o);if((0,ud().p4)(a))return;const r=a[0]??"enterprise";return(0,Yl().QM)(r)?void 0:{tier:r,message:(0,Z.jsx)(H()._H,{defaultMessage:"Please upgrade to the {upsellTier} Plan to access versions older than {snapshotLimitDays} days.",id:"historyModal.upsell.message",values:{upsellTier:(0,Hl().Z)((0,Yl().eR)(r)?"plus":r),snapshotLimitDays:(null===(t=Ud(r))||void 0===t?void 0:t.days)??Math.floor(o)}})}}function Fd(){return(0,Z.jsx)(Sd().Z,{href:(0,De().UY)("guides.pageHistory"),analyticsFrom:"page_history"})}function Hd(e,t){const{device:n}=t;return!n.isMobile||"personal"===e&&(0,ad().S$)({environment:t})}function Kd(e){return e.formatMessage({id:"historyModal.ariaLabel",defaultMessage:"Page History"})}function Ed(e){const{device:t}=e;return t.isMobile?24:20}function Wd(e){let{menuState:t}=e;const n=(0,i().O7)(),r=(0,a().VK)((()=>t.blockStore.getIcon()),[t.blockStore]),s=(0,a().VK)((()=>t.blockStore.isEmptyPage()),[t.blockStore]),l=ec();return t.snapshot?(0,Z.jsxs)(o.Fragment,{children:[(0,Z.jsxs)("div",{style:l.header,children:[r?(0,Z.jsx)(gs().Z,{disabled:!0,icon:r,isEmptyPage:s,size:Ed(n)}):null,r?null:(0,Z.jsx)(fd().y,{iconGroup:Wl,variantName:"default",colorName:"secondary"}),(0,Z.jsx)(hd().q,{styleName:"Body-14px/Regular",colorName:"tertiary",children:(0,Z.jsx)(bd().Z,{store:t.blockStore})})]}),(0,Z.jsx)(Zd,{blockStore:t.blockStore,timestamp:t.snapshot.timestamp})]}):null}function zd(e,t){dd().y(t,{from:"history_modal",upsell:{type:"product",product:e,limit:{type:"none"}}})}function Gd(e){let{message:t,showUpgradeButtonForTier:n}=e;const o=(0,i().O7)(),{device:r}=o,s=(0,a().VK)((()=>cd().GJ(md().subscriptionDataStoreInstance.state)),[]),l=ec();let d=Hd(n,o);return d&&(0,ad().S$)({environment:o})&&"personal"===n&&!s&&(d=!1),(0,Z.jsxs)("div",{style:r.isMobile?l.unavailableMessageComponentMobile:l.unavailableMessageComponent,children:[Hd(n,o)?(0,Z.jsx)("img",{src:ka().Z.images.icons.clockArrowLockSvg,alt:"loading..."}):null,(0,Z.jsx)("div",{style:{...!r.isMobile&&{maxWidth:283}},children:t}),d&&n?(0,Z.jsx)(vd().Z,{size:"lg",onClick:()=>zd(n,o),style:l.upsell,icon:()=>(0,Z.jsx)(fd().y,{iconGroup:Kl().t,variantName:"default",colorName:"uiBluePrimary"}),children:(0,Z.jsx)(H()._H,{defaultMessage:"Upgrade plan",id:"historyModal.upgradeForHistoryButton.labelVHR"})}):null]})}function qd(e){const t=(0,i().O7)(),n=(0,H().YB)(),{device:r}=t,{menuState:s,loadingMore:l}=e,d=(0,ur().Z)(l,300,100),c=ec();const u=function(e){const t=new Map;return e.forEach((e=>{const n=(0,Va().Yx)(parseInt(e.timestamp),"very_short",Fl().locale),o=t.get(n)??0;t.set(n,o+1)})),t}(e.snapshotValues),m=(0,o.useCallback)((e=>{const t=e>Date.now()-6*wn().A0,n=u.get((0,Va().Yx)(e,"very_short",Fl().locale));return!!n&&(n>1||t)}),[u]),p=(0,a().VK)((()=>f().oA(e.snapshotValues.map(((o,i)=>{const a=i>0?e.snapshotValues[i-1]:void 0,l=!Nd({snapshot:o,nextFutureSnapshot:a});return{key:o.id,action:()=>{Xl().gs({environment:t,snapshot:o,nextFutureSnapshot:a})},render:e=>{const t=o.authors||[],i=n.formatList(f().oA(t.map((e=>(0,id().nc)({parentStore:s.blockStore,pointer:e}).getDisplayName(n)))),{type:"conjunction",style:"narrow"}),a=(0,Z.jsx)("div",{style:{...Ze().Yu},children:i}),d=Boolean(s.snapshot&&s.snapshot.id===o.id),u=parseInt(o.timestamp),p=m(u),g=new Date(u).getFullYear()!==(new Date).getFullYear()?"long":"month_day_long",h=p?(0,Va().$b)(u,Fl().locale,n,"·",g):(0,Va().Yx)(u,g,Fl().locale);return l?(0,Z.jsx)(Vt().Z,{...e,title:h,focused:!r.isMobile&&d,caption:a,buttonStyle:c.buttonMenuItem,itemMarginLeft:8}):(0,Z.jsx)(Vt().Z,{...e,title:(0,Z.jsx)("div",{style:c.menuItem,children:(0,Z.jsx)("div",{style:{...r.isMobile&&{display:"flex",flex:1},...Ze().Yu},children:h})}),focused:!r.isMobile&&d,caption:a,right:(0,Z.jsx)(fd().y,{iconGroup:El().n,variantName:"small",colorName:"tertiary"}),buttonStyle:c.buttonMenuItem,itemMarginLeft:8,rightStyle:{marginRight:"7px"}})}}})))),[e.snapshotValues,r.isMobile,t,n,s.blockStore,s.snapshot,c,m]),g=s.snapshot&&s.snapshot.id,h=p.findIndex((e=>g===e.key)),v=[{key:"snapshots",render:e=>(0,Z.jsx)(Ut().Z,{...e}),items:p}];return(0,Z.jsxs)(o.Fragment,{children:[(0,Z.jsx)(Ot().ZP,{type:Ot().iW.Vertical,initialFocus:h,sections:v}),(0,Z.jsx)(pd().Z,{loading:l,fetchSize:s.size,resultSize:e.snapshotValues.length,onLoadMore:Xl().FF}),d&&(0,Z.jsx)("div",{style:Bd,children:(0,Z.jsx)(Zn().Z,{})})]})}function Yd(e){let{menuState:t,onRestoreSnapshot:n}=e;const o=(0,i().O7)();return(0,Z.jsx)(x().ZP,{popupType:j().k.SlideUp,open:Boolean(t.snapshot),forceFullScreenSlideUp:!0,render:()=>{if(!t.snapshot)return null;const e=Nd({snapshot:t.snapshot,nextFutureSnapshot:t.nextFutureSnapshot}),i=!e,a=i?(0,Z.jsx)(Zd,{blockStore:t.blockStore,timestamp:t.snapshot.timestamp}):(0,Z.jsx)(Gd,{message:e.message,showUpgradeButtonForTier:e.tier}),r=!i&&o.device.isMobileBrowser;return(0,Z.jsx)(b().Z,{menuType:S().o.Modal,title:(0,Va().$b)(parseInt(t.snapshot.timestamp),Fl().locale,At().Z.getIntl()),right:(0,Z.jsx)(nt().DoneMenuText,{}),onClickRight:Xl().zb,leftDisabled:!i&&!o.device.isMobileBrowser,left:r?(0,Z.jsx)(H()._H,{defaultMessage:"Upgrade",id:"historyModal.mobileSnapshotMenu.upgradeButton.label"}):(0,Z.jsx)(H()._H,{defaultMessage:"Restore",id:"historyModal.mobileSnapshotMenu.restoreButton.label"}),onClickLeft:()=>(async()=>{r?zd(e.tier,o):await n()})(),whiteBackground:i,forceFullScreenSlideUp:!0,children:a})}})}function $d(e){const t=(0,i().O7)(),{menuState:n}=e,o=(0,rd().cR)(n.blockStore),r=(0,rd().xb)(n.blockStore),s=(0,a().VK)((()=>Boolean(n.snapshot&&!o&&!r&&!Nd({snapshot:n.snapshot,nextFutureSnapshot:n.nextFutureSnapshot})&&function(e,t){return(0,od().k5s)({environment:t,blocks:[e.blockStore],originRect:void 0,publicEditMode:void 0})}(n,t))),[t,n,o,r]),l=ec();return(0,Z.jsxs)("div",{style:l.sidebarStyle,children:[(0,Z.jsxs)("div",{style:l.sidebarHeader,children:[(0,Z.jsx)(hd().q,{styleName:"Heading-17px/Semibold",colorName:"primary",customStyles:{fontSize:16},children:(0,Z.jsx)(H()._H,{id:"historyModal.desktopModal.sidebar.title",defaultMessage:"Version history"})}),(0,Z.jsx)(ed().U,{onClick:Xl().U4,style:l.dismiss})]}),(0,Z.jsx)(xd().T,{type:Xe().Z.Y,style:{flex:1},children:(0,Z.jsx)(qd,{...e})}),(0,Z.jsxs)("div",{style:l.actions,children:[(0,Z.jsx)(ho().D,{size:"lg",style:l.learnMoreButton,onClick:()=>{$l().Fs(t,{from:"page_history"}),Ql().c4({environment:t,url:(0,De().UY)("guides.pageHistory"),openInNew:"tab"})},icon:()=>(0,Z.jsx)(fd().y,{iconGroup:zl().M,variantName:"small",colorName:"secondary"}),children:(0,Z.jsx)(hd().q,{colorName:"secondary",children:(0,Z.jsx)(H()._H,{defaultMessage:"Learn more",id:"historyModal.desktopModal.learnMoreButtonVHR.label"})})}),(0,Z.jsx)(Ue().Z,{disableTooltip:s,renderTooltip:()=>r?(0,Z.jsx)(H()._H,{defaultMessage:"Resolve pending edits to restore snapshots.",id:"historyModal.desktopModal.sidebar.resolvePendingEdits.tooltip"}):o?(0,Z.jsx)(H()._H,{defaultMessage:"Restore page from trash to restore snapshots.",id:"historyModal.desktopModal.sidebar.restorePageFromTrashMessage.tooltip"}):(0,Z.jsx)(H()._H,{defaultMessage:"Upgrade to restore snapshots.",id:"historyModal.desktopModal.sidebar.upgradeMessage.tooltip"}),render:t=>(0,Z.jsx)(yd().Z,{isLarge:!0,onClick:e.onRestoreSnapshot,disabled:!s,...t,style:l.restoreButton,children:(0,Z.jsx)(H()._H,{defaultMessage:"Restore",id:"historyModal.desktopModal.restoreButtonVHR.label"})})})]})]})}function Jd(e){const t=(0,Fa().E)("large_surface_error_boundary");let n,i;return e.loadingMore||0!==e.snapshotValues.length||(n=(0,Z.jsx)(Gd,{message:Vd,showUpgradeButtonForTier:!1})),i=e.error?(0,Z.jsx)("div",{style:Bd,children:(0,Z.jsx)(H()._H,{defaultMessage:"Something went wrong",id:"historyModal.errorMessage"})}):e.initialLoading?(0,Z.jsx)("div",{style:Bd,children:(0,Z.jsx)(Zn().Z,{})}):(0,Z.jsxs)(o.Fragment,{children:[(0,Z.jsx)(xd().T,{type:Xe().Z.Y,children:(0,Z.jsx)(qd,{...e})}),(0,Z.jsx)(Yd,{...e})]}),(0,Z.jsx)(b().Z,{menuType:S().o.Modal,title:(0,Z.jsx)(H()._H,{defaultMessage:"History",id:"historyModal.mobileHistoryMenu.title"}),left:(0,Z.jsx)(Fd,{}),right:(0,Z.jsx)(nt().DoneMenuText,{}),onClickRight:Xl().U4,header:n,children:(0,Z.jsx)(td().T,{disabled:!t,from:"MobileHistory",fallback:e=>{let{errorId:t}=e;return(0,Z.jsx)(nd().y,{errorId:t})},children:i})})}function Qd(e){const t=(0,i().O7)(),n=(0,Fa().E)("large_surface_error_boundary"),o=(0,a().VK)((()=>e.menuState.snapshot?Nd({snapshot:e.menuState.snapshot,nextFutureSnapshot:e.menuState.nextFutureSnapshot}):null),[e.menuState.nextFutureSnapshot,e.menuState.snapshot]),r=ec(),s=(0,a().VK)((()=>(0,Pd().EA)(t)),[t]);let l;return l=e.error?(0,Z.jsx)("div",{style:Bd,children:(0,Z.jsx)(H()._H,{defaultMessage:"Something went wrong",id:"historyModal.desktopModal.errorMessage"})}):e.initialLoading?(0,Z.jsx)("div",{style:Bd,children:(0,Z.jsx)(Zn().Z,{})}):o?(0,Z.jsxs)("div",{style:r.blurContainer,children:[(0,Z.jsx)("div",{style:r.unavailableMessageText,children:(0,Z.jsx)(Gd,{message:o.message,showUpgradeButtonForTier:o.tier})}),(0,Z.jsx)("div",{style:r.snapshotBlur,children:(0,Z.jsx)(Pd().ZP,{store:e.menuState.blockStore,disabled:!0,context:ld().S.InPageSnapShot,paddingBottom:s})})]}):e.loadingMore||0!==e.snapshotValues.length?(0,Z.jsx)(Wd,{menuState:e.menuState}):(0,Z.jsx)(Gd,{message:Vd,showUpgradeButtonForTier:!1}),(0,Z.jsxs)(td().T,{disabled:!n,from:"DesktopHistory",fallback:e=>{let{errorId:t}=e;return(0,Z.jsx)(nd().y,{errorId:t})},children:[(0,Z.jsx)("div",{style:r.preview,children:l}),(0,Z.jsx)($d,{...e})]})}function Xd(){const e=(0,i().O7)(),{device:t}=e,n=(0,a().Kw)(sd().Z),[o]=(0,ue().r5)((async()=>{if(n.open)return await async function(e,t,n){const{device:o}=n,i=await E().callApi({eventName:"getSnapshotsList",environment:n,data:e});if("failed"===i.type)throw i.error;const{snapshots:a}=i.data;if(t.pageHasCollection=a.some((e=>{var t;const n="collection"===e.parent_table,o=null===(t=e.collection_ids)||void 0===t?void 0:t.length;return n||o&&0!==o})),t.openSnapshotNearTimestamp){const e=parseInt(t.openSnapshotNearTimestamp),o=a.findIndex((t=>parseInt(t.timestamp)<e));0===a.length||(0===o?Xl().gs({environment:n,snapshot:a[o],nextFutureSnapshot:void 0}):o>0?Xl().gs({environment:n,snapshot:a[o-1],nextFutureSnapshot:o>1?a[o-2]:void 0}):a.length<t.size?Xl().gs({environment:n,snapshot:a[a.length-1],nextFutureSnapshot:a.length>1?a[a.length-2]:void 0}):Xl().FF())}else Boolean(t.snapshot)||o.isMobile||sd().Z.setState({...t,snapshot:a[0],nextFutureSnapshot:void 0});return i.data}({block:{id:n.blockStore.id,spaceId:(0,ql().J)(n.blockStore.pointer.spaceId)},size:n.size},n,e)}),[e,n]),r="pending"!==o.status&&"idle"!==o.status,s=o.error,l=o.value,d=(0,ur().Z)(Boolean(n.open&&(!l||l.snapshots.length>=n.size&&n.openSnapshotNearTimestamp)),400,100);if(!n.open)return null;const c=t.isMobile?Jd:Qd;return(0,Z.jsx)(c,{snapshotValues:l?l.snapshots:[],menuState:n,onRestoreSnapshot:async function(){if(!n.open)return;const t="restore_collection",o=n.pageHasCollection?[{key:t,text:(0,Z.jsx)(H()._H,{defaultMessage:"Also restore databases on this page",id:"historyModal.confirmDialog.selectOption.collection"}),description:(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(H()._H,{defaultMessage:"All database pages and their properties from this version will be restored, which may impact other users or database views. To restore database page content, restore an earlier version for each page.",id:"historyModal.confirmDialog.selectOption.collection.description"})," ",(0,Z.jsx)(gd().Z,{external:!0,href:(0,De().UY)("guides.pageHistoryRestore"),style:{display:"inline",textDecoration:"underline"},children:(0,Z.jsx)(H()._H,{id:"historyModal.confirmDialog.selectOption.collection.learnMore",defaultMessage:"Learn more"})})]})}]:void 0,{accept:i,selectionResult:a}=await Jl().gt({message:(0,Z.jsx)("div",{style:{fontWeight:Ze().Ue.semibold,fontSize:"medium"},children:(0,Z.jsx)(H()._H,{defaultMessage:"Restore to this version?",id:"historyModal.confirmDialog.description"})}),acceptLabel:(0,Z.jsx)(H()._H,{defaultMessage:"Restore",id:"historyModal.confirmDialog.restoreButton.label"}),selectionItems:o,mode:o?"wide":void 0,textAlign:"left"});if(i){try{await Xl().xx(e,null==a?void 0:a[t])}catch{Jl().UW(At().Z.formatMessage(Ld.restoreSnapshotError))}Xl().U4()}},error:s,initialLoading:d,loadingMore:!r})}function ec(){return(0,Ie().yK)((e=>({sidebarStyle:{display:"flex",flexDirection:"column",flexShrink:0,width:Rd().mD,padding:"10px 8px 0px 8px",borderLeft:`\n\t\t\t1px solid ${e.regularDividerColor}\n\t\t`},sidebarHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",alignSelf:"stretch",padding:"4px 4px 4px 8px"},actions:{display:"flex",padding:"12px 12px 12px 6px",borderTop:`\n\t\t\t\t\t1px solid ${e.regularDividerColor}\n\t\t\t\t`,justifyContent:"space-between",marginLeft:"-8px",marginRight:"-8px"},learnMoreButton:{padding:"0px 8px",borderRadius:"6px",gap:4},preview:{display:"flex",flexDirection:"column",width:`calc(100% - ${Rd().mD}px)`,boxShadow:`1px 0 0 ${e.regularDividerColor}`},restoreButton:{backgroundColor:e.text.uiBluePrimary,borderRadius:"6px",boxShadow:"none"},buttonMenuItem:{marginLeft:"0px",marginRight:"0px",width:"100%",borderRadius:"6px"},menuItem:{display:"flex",alignItems:"center",justifyContent:"space-between"},header:{display:"flex",alignItems:"center",flexShrink:0,height:45,paddingLeft:14,gap:6},modal:{height:`${Rd()._Y}vh`,width:`${Rd().rp}vw`,overflow:"hidden",display:"flex",borderRadius:"12px"},blurContainer:{position:"relative",width:"100%",height:"100%",overflow:"hidden"},unavailableMessageText:{position:"absolute",width:"100%",height:"100%",zIndex:1},snapshotBlur:{position:"relative",pointerEvents:"none",filter:"blur(20px)",opacity:"30%",margin:"-5px"},unavailableMessageComponentMobile:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:28,padding:16,textAlign:"center",fontSize:14,position:"relative",zIndex:1,background:e.popoverBackground,boxShadow:`\n\t\t\t\t\t\t\t\t0 -1px 0 ${e.regularDividerColor},\n\t\t\t\t\t\t\t\t0 1px 0 ${e.regularDividerColor}\n\t\t\t\t\t\t\t`},unavailableMessageComponent:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:16,textAlign:"center",fontSize:14,height:"100%",gap:16},upsell:{gap:4,paddingLeft:"8px",paddingRight:"12px",borderRadius:"6px"},dismiss:{position:"unset"}})),[])}var tc=()=>n(700696);const nc=function(){const e=(0,i().O7)(),{currentSpaceStore:t,currentUserStore:n}=(0,a().Kw)(Q().default),r=null==n?void 0:n.id;return(0,o.useEffect)((()=>{if(!t||!r)return;const n=async n=>{const o=await(0,ge().B$)({environment:e,spaceStore:t,includeArchived:!1,currentUserId:r});tc().default.setState({teams:o.teams,teamAggregateData:o.teamAggregateData,lastEmitData:{spaceId:t.id,userId:r,value:n}})};n(tc().default.state.lastEmitData.value);const o=Y().ZP.addListener((0,N().je)(t.id),(async(e,o)=>{const{lastEmitData:i}=tc().default.state,a=t.id!==i.spaceId,s=r!==i.userId,l=o!==i.value;(a||s||l)&&await n(o)}),void 0,e);return function(){o&&Y().ZP.removeListener(o,e)}}),[t,r,e]),null};var oc=()=>n(388915),ic=()=>n(348141),ac=()=>n(56424);const rc=function(){const e=(0,Ie().Fg)(),t=(0,i().O7)(),o=(0,a().Kw)(ac().Z),r=(0,a().Kw)(n(505121).Z);if(!o.open)return null;const s=o.integration.info.icon;return s?(0,Z.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",cursor:"default",padding:16,background:e.popoverBackground,borderRadius:4,boxShadow:e.shadowSM,position:"absolute",bottom:65+r,right:16+r,width:240,zIndex:io().hT,clipPath:"inset(-10px -10px -10px -10px)"},children:[(0,Z.jsx)(n(643051).Z,{type:"image_url",imageURL:s,size:38,style:{marginBottom:6}}),(0,Z.jsx)("div",{style:{color:e.regularTextColor,fontSize:14,fontWeight:Ze().Ue.semibold,marginBottom:6,textAlign:"center"},children:(0,Z.jsx)(H()._H,{id:"inlineUnfurlingAuthenticationPopup.title",defaultMessage:"Connect to {integration}",values:{integration:o.integration.name}})}),(0,Z.jsxs)("div",{style:{color:e.mediumTextColor,fontSize:12,marginBottom:8,textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,Z.jsx)(H()._H,{id:"inlineUnfurlingAuthenticationPopup.caption",defaultMessage:"You, and anyone else who has access to this Notion page, will see rich previews that update live."}),(0,Z.jsx)(n(765513).Z,{href:(0,De().UY)("guides.unfurling"),external:!0,children:(0,Z.jsx)(H()._H,{id:"inlineUnfurlingAuthenticationPopup.learnMore.text",defaultMessage:"Learn more"})})]}),(0,Z.jsx)(yd().Z,{onClick:()=>async function(e){const t=ac().Z.state,{currentSpaceStore:n}=Q().default.state;if(!t.open||!n)return;await oc().hM({environment:e,integration:t.integration,spaceId:n.id,unfurlUrl:t.unfurlUrl,externalObjectInstanceBlockId:t.externalObjectInstanceBlockId,from:"external_object_instance_inline_popup"}),sc(t.integration.id,e),ac().Z.reset()}(t),style:{width:"100%"},children:(0,Z.jsx)(H()._H,{id:"inlineUnfurlingAuthenticationPopup.connectButton",defaultMessage:"Connect"})}),(0,Z.jsx)(Oe().Z,{icon:n(328714).U,onClick:()=>function(e){const t=ac().Z.state;t.open&&sc(t.integration.id,e);ac().Z.reset()}(t),style:{position:"absolute",top:6,right:6}})]}):null};function sc(e,t){const{currentUserSettingsStore:n}=Q().default.state;n&&y().createAndCommit({userAction:"UnfurlingInformationPopup.markPopupAsDismissed",environment:t,canUndo:!0,perform:t=>{ic().GK({transaction:t,userSettingsStore:n,integrationId:e})}})}n(492176),n(7961);var lc=()=>n(235484),dc=()=>n(286310),cc=()=>n(650996),uc=()=>n(658735),mc=()=>n(989377);const pc=function(){const e=(0,a().qz)(uc().Z),t=(0,i().O7)(),n=(0,o.useRef)(null),r=(0,i().Fy)(),[s,l]=(0,a().VK)((()=>[e.state.open,e.state.open?e.state.renderRect:void 0]),[e]);return(0,o.useEffect)((()=>{const e=e=>{s&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&bc(t)},o=e=>{if(!s||!e.target||!n.current)return;const o=n.current;o&&o!==e.target&&bc(t)};return(0,ii().lj)(window,"keydown",e),(0,ii().lj)(window,"mousedown",o),()=>{(0,ii().ZV)(window,"keydown",e),(0,ii().ZV)(window,"mousedown",o)}}),[s,n,t]),(0,Z.jsx)(x().ZP,{popupType:r.isMobileNative&&!r.isTablet?j().k.SlideUp:j().k.Popup,open:Boolean(s&&l),originRect:s?l:void 0,placementToOrigin:C().Placement.Top,alignmentToOrigin:C().Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:r.isMobile,keepFocus:r.isMobile,render:()=>(0,Z.jsx)(gc,{}),onDismiss:bc})};function gc(){const e=(0,a().qz)(uc().Z),t=(0,i().O7)(),n=(0,i().Fy)(),r=(0,o.useRef)(null),s=(0,H().YB)(),[l,d,c,u]=(0,a().VK)((()=>[e.state.open,e.state.open?e.state.allOptionTypes:[],e.state.open?e.state.integration:void 0,e.state.open?e.state.url:void 0]),[e]),m=(0,Ie().yK)((e=>({header:n.isMobile?{display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,fontWeight:Ze().Ue.semibold,background:e.surface.wash,height:45}:{paddingLeft:16,paddingRight:16,paddingTop:10,color:e.text.secondary,fontSize:Ze().JB.UISmall.desktop,fontWeight:450,font:"SF Pro"}})),[n]);if(!l)return null;const p={fontSize:Ze().JB.UIRegular.desktop,fontWeight:Ze().Ue.regular,font:"SF Pro"},g=[{key:"embed section",render:e=>(0,Z.jsx)(Ut().Z,{...e,style:{paddingTop:6,paddingBottom:0}}),items:d.filter((e=>"import"!==e)).map((e=>({key:e,render:n=>(0,Z.jsx)(Vt().Z,{...n,title:(0,Z.jsx)(fc,{optionType:e,integration:c}),onMouseEnter:o=>{n.onMouseEnter(o),hc(e,s,t)},style:p}),action:()=>vc(e,t)})))},{key:"import section",render:e=>(0,Z.jsx)(Ut().Z,{...e,style:{paddingTop:0,paddingBottom:6}}),items:d.filter((e=>"import"===e)).map((e=>({key:e,render:n=>(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(Pn().Z,{size:4}),(0,Z.jsx)(Vt().Z,{...n,title:(0,Z.jsx)(fc,{optionType:e,integration:c}),onMouseEnter:o=>{n.onMouseEnter(o),hc(e,s,t)},style:p})]}),action:()=>vc(e,t)})))}];return(0,Z.jsx)(cc().LazyAssistantUnfurlingMenuWithAiSection,{url:u,integration:c,headerStyle:m.header,menuTextStyle:p,updateUnfurlingOptionType:hc,handleDismiss:vc,renderMenu:e=>{let o,{maybeAiActionSection:i}=e;return o=n.isMobile?{menuType:S().o.ActionSheet}:{menuType:S().o.Popup,width:d.includes("import")?260:i?220:200,maxHeight:"40vh",onClickOutside:()=>bc(t)},(0,Z.jsx)(b().Z,{...o,className:Pt().b_f,ref:r,header:(0,Z.jsx)(zt().Z,{style:m.header,isSmall:!n.isMobile,isSecondaryColor:!n.isMobile,children:(0,Z.jsx)(H()._H,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,Z.jsx)(Ot().ZP,{type:Ot().iW.Vertical,sections:i?[...g,i]:g,initialFocus:0,onKeyboardArrow:e=>function(e,t,n,o){const i=uc().Z.state;if(!i.open||void 0===e.indexGlobal)return;const a=i.allOptionTypes.at(e.indexGlobal);if(!a)return void(o&&hc("preview",t,n));hc(a,t,n)}(e,s,t,!!i),priority:1,disallowBackspace:!0})})}})}function fc(e){let{optionType:t,integration:n}=e;return"preview"===t?(0,Z.jsx)(H()._H,{id:"unfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Preview"}):"mention"===t?(0,Z.jsx)(H()._H,{id:"unfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Mention"}):"link"===t?(0,Z.jsx)(H()._H,{id:"unfurlingMenu.actions.pasteAsLink.title",defaultMessage:"URL"}):"drive"===t?(0,Z.jsx)(H()._H,{id:"unfurlingMenu.actions.pasteAsDrive.title",defaultMessage:"Embed"}):"collection"===t?(0,Z.jsx)(H()._H,{id:"unfurlingMenu.actions.pasteAsDatabase.title",defaultMessage:"Database"}):"import"===t?(null==n?void 0:n.id)===lc().mC?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(H()._H,{id:"unfurlingMenu.actions.import.jiraTitle",defaultMessage:"Sync Jira projects and issues"}),(0,Z.jsx)(An().Z,{style:{display:"inline"}})]}):(null==n?void 0:n.id)===lc().aW?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(H()._H,{id:"unfurlingMenu.actions.import.salesforceTitle",defaultMessage:"Sync Reports and Lists"}),(0,Z.jsx)(mc().i,{style:{display:"inline"},newBadgeKey:"salesforce_sync_unfurling_option",didUserEngage:!1})]}):(0,Z.jsx)(H()._H,{id:"unfurlingMenu.actions.import.title",defaultMessage:"Import from {integration}",values:{integration:null==n?void 0:n.name}}):void(0,pe().t1)(t)}function hc(e,t,n){y().createAndCommit({userAction:"UnfurlingMenu.handleMenuListKeyboardArrow",environment:n,canUndo:!1,perform:o=>{En().hJ({environment:n,type:yc(e),useTemporaryRecordCache:!0,transaction:o,intl:t})}})}function vc(e,t){const n=uc().Z.state;dc().kM(t,{unfurl_option_type:e||"default",integration:n.open?n.integration.name:"default"}),"import"===e&&n.open&&En().LE({environment:t,integration:n.integration,url:n.url,blockStore:n.stores.blockStore}),y().createAndCommit({userAction:"UnfurlingMenu.handleDismiss",environment:t,canUndo:!0,perform:n=>{En().xv({environment:t,setType:e?yc(e):void 0,transaction:n})}})}function yc(e){return"import"===e?"link":e}function bc(e){vc(void 0,e)}n(821057);var xc=()=>n(511115),Sc=()=>n(577223),Mc=()=>n(608352),wc=()=>n(306164),Cc=()=>n(110232),jc=()=>n(887430),kc=()=>n(307369),Tc=()=>n(960562),Ic=()=>n(27762),_c=()=>n(797522);const Pc=200,Zc=30,Ac=125,Rc=25;var Bc=function(e){return e[e.Selectable=0]="Selectable",e[e.DropTarget=1]="DropTarget",e}(Bc||{});function Lc(e){return e.type===Bc.Selectable?{type:Tc().D.Selectable,store:e.target.props.store,direction:e.direction}:{type:Tc().D.DropTarget,key:e.target.props.dropTargetKey,direction:e.direction}}function Dc(e){const{target:t,device:n,direction:o,points:i}=e;return o===Tc().v.Onto||!n.isPhone||t.props.dropzoneShouldNeverUseOrigin?i.mousePoint:{x:i.originPoint.x,y:i.mousePoint.y}}function Vc(e){return(0,kc().u)(e)?{type:Bc.Selectable,target:e}:{type:Bc.DropTarget,target:e}}function Oc(e){if(!e||!(0,kc().u)(e))return!1;let t=e;const n=Tc().default.state;if(!n.isDragging)return!1;const{draggedStores:o}=n;for(;t;){if(o.indexOf(t.props.store)>=0)return!0;t=t.getContextClosestSelectable()}return!1}function Uc(e){const{dropzoneMustBeWithinHorizontalBound:t,device:n}=e;return t?0:n.isPhone?9999:0}function Nc(e){switch(e.direction){case Tc().v.Onto:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:a,priority:r,canAcceptDrop:s}=e,l=Tc().v.Onto,d=Dc({device:t,target:i,direction:l,points:a});if((n?i.props.canNativeDropOnto:i.props.canDropOnto)&&Hc(d,o)&&!Oc(i)&&s(i,l))return{...Vc(i),direction:l,left:o.left,top:o.top,width:o.width,height:o.height,priority:r}}(e);case Tc().v.Left:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:a,priority:r,optionKeyDown:s,canAcceptDrop:l}=e,d=Tc().v.Left,c=Dc({device:t,target:i,direction:d,points:a});if((n?i.props.canNativeDropLeft:i.props.canDropLeft)&&o&&c.y>=o.top&&c.y<=o.bottom&&Math.abs(c.x-o.left)<=Pc&&(s||!Oc(i))&&l(i,d))return{...Vc(i),direction:d,left:o.left,top:o.top,width:0,height:o.height,priority:r}}(e);case Tc().v.Right:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:a,priority:r,optionKeyDown:s,canAcceptDrop:l}=e,d=Tc().v.Right,c=Dc({device:t,target:i,direction:d,points:a});if((n?i.props.canNativeDropRight:i.props.canDropRight)&&o&&c.y>=o.top&&c.y<=o.bottom&&Math.abs(c.x-o.right)<=Pc&&(s||!Oc(i))&&l(i,d))return{...Vc(i),direction:d,left:o.right,top:o.top,width:0,height:o.height,priority:r}}(e);case Tc().v.Above:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:a,priority:r,optionKeyDown:s,canAcceptDrop:l}=e,d=i.props.verticalDropZoneExtraLeftEdgeOffset??Zc,c=Uc({dropzoneMustBeWithinHorizontalBound:i.props.dropzoneMustBeWithinHorizontalBound,device:t}),u=Tc().v.Above,m=Dc({device:t,target:i,direction:u,points:a});if((n?i.props.canNativeDropAbove:i.props.canDropAbove)&&o&&m.x>=o.left-d-c&&m.x<=o.right+c&&(s||!Oc(i))&&Math.abs(m.y-o.top)<=Ac&&(o.height<=2*Rc||m.y<=o.top+Rc)&&l(i,u))return{...Vc(i),direction:u,left:o.left,top:o.top,width:o.width,height:0,priority:r}}(e);case Tc().v.Below:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:a,priority:r,optionKeyDown:s,canAcceptDrop:l}=e,d=i.props.verticalDropZoneExtraLeftEdgeOffset??Zc,c=Uc({dropzoneMustBeWithinHorizontalBound:i.props.dropzoneMustBeWithinHorizontalBound,device:t}),u=Ac,m=i.props.isLastItem?Number.MAX_SAFE_INTEGER:Ac,p=Tc().v.Below,g=Dc({device:t,target:i,direction:p,points:a});if((n?i.props.canNativeDropBelow:i.props.canDropBelow)&&o&&g.x>=o.left-d-c&&g.x<=o.right+c&&o.bottom-g.y<=u&&g.y-o.bottom<=m&&(o.height<=2*Rc||g.y>=o.bottom-Rc)&&(s||i.props.isLastItem||!Oc(i))&&l(i,Tc().v.Below))return{...Vc(i),direction:Tc().v.Below,left:o.left,top:o.bottom,width:o.width,height:0,priority:r}}(e)}}function Fc(e){const{device:t,rect:n,target:o,points:i,optionKeyDown:a}=e;return Hc(Dc({device:t,target:o,direction:Tc().v.Onto,points:i}),n)&&Oc(o)&&!a}function Hc(e,t){return Boolean(t&&e.x>=t.left&&e.x<=t.right&&e.y>=t.top&&e.y<=t.bottom)}var Kc=()=>n(590162),Ec=()=>n(605067),Wc=()=>n(906591),zc=()=>n(884310),Gc=()=>n(677556),qc=()=>n(972079),Yc=()=>n(352761),$c=()=>n(32969),Jc=()=>n(644235),Qc=()=>n(169523),Xc=()=>n(645805);const eu=2,tu=20,nu=7;function ou(){const e=(0,o.useRef)(!1),t=(0,o.useRef)(!1),n=(0,o.useRef)(void 0),a=(0,i().Fy)(),r=(0,i().O7)(),s=(0,xs().l)(),l=(0,xc().z)((e=>Ui().Z.withListenerIgnored((()=>(e=>{const o=Xc().default.state;if(!(e&&e.target instanceof Element)||o.isOpen&&o.menuIsOpen||(n.current={target:e.target,x:e.clientX,y:e.clientY}),t.current)return void(t.current=!1);const{isDragging:i}=Tc().default.state;if(i)g();else{if(!n.current)return;ru(r,n.current.target,n.current.x,n.current.y)}})(e)))),60),d=(0,o.useCallback)((()=>{e.current||l(void 0)}),[l]),c=f().P2((()=>{const{isDragging:e}=Tc().default.state;qn().default.afterNextFlush((()=>{n.current&&!e&&ru(r,n.current.target,n.current.x,n.current.y)}))}),60),u=(0,o.useMemo)((()=>new WeakMap),[]),m=(0,o.useCallback)((e=>{const t=u.get(e);if(u.has(e))return t??!1;const n=(0,od().OOI)({environment:r,blocks:e,publicEditMode:s&&s.publicEditModeStore.state});return u.set(e,n),n??!1}),[r,s,u]),p=(0,o.useCallback)((()=>{const e=Tc().default.state;if(!e.isDragging)return;const{draggedStores:t,currentX:n,currentY:o,offsetX:i,offsetY:a,isNativeDrag:l}=e,d=function(e){const{points:t,draggingStore:n,isNativeDrag:o,environment:i,pageContext:a,canDragFn:r}=e,{device:s}=i,l=Kc().y(),d=function(){const{selectableRectMap:e}=_c().default.state,{dropTargetRectMap:t}=Ic().default.state,n=new Map;return e.forEach(((e,t)=>{n.set(t,e)})),t.forEach(((e,t)=>{n.set(t,e)})),n}(),c=d.keys();let u=c.next();const m=$c().C.findSelectableFromStore(n),p=m?m.getContextSelectableContainer():void 0;let g=[];for(;!u.done;){const e=u.value;u=c.next();const n=d.get(e),m=e.getContextSelectableContainer();if(s.isPhone&&m!==p)continue;if(!m||m.getProps().disable)continue;const h=au(m),v={device:s,isNativeDrag:o,rect:n,target:e,points:t,priority:h,optionKeyDown:l.option,canAcceptDrop:(e,t)=>mu({target:e,direction:t,optionKeyDown:l.option,environment:i,pageContext:a,canDragFn:r})};if(Fc(v))return{ontoDropZone:void 0,verticalDropZone:void 0,horizontalDropZones:[]};g.push(...f().oA([Nc({...v,direction:Tc().v.Onto}),Nc({...v,direction:Tc().v.Left}),Nc({...v,direction:Tc().v.Right}),Nc({...v,direction:Tc().v.Above}),Nc({...v,direction:Tc().v.Below})]))}g=function(e){const t=lu(f().UT(e,lu));return e.filter((e=>lu(e)===t))}(g);const h=g.filter((e=>e.direction===Tc().v.Above||e.direction===Tc().v.Below)),v=f().F(h,(e=>Math.abs(e.top-su(e,t,i).y)));if(v&&v.target===m)return{ontoDropZone:void 0,verticalDropZone:void 0,horizontalDropZones:[]};let y=h.filter((e=>{let{top:t}=e;return Math.abs(t-(v?v.top:0))<=eu}));if(y.length>1){y=y.filter((e=>{const n=su(e,t,i).x,o=Uc({device:s});return n>=e.left-o&&n<=e.left+e.width+o})),y=f().MR(y,(e=>{let{left:t}=e;return t}));let e=0;for(;e<y.length-1;e++){const n=y[e+1],o=su(n,t,i).x;if(n.left>o)break}y=y.slice(0,e+1),y.reverse()}const b=y.map(Lc);let x;const S=g.filter((e=>e.direction===Tc().v.Onto)),M=f().F(S,(e=>e.height));if(M){h.some((e=>{const n=su(e,t,i).y;return Math.abs(e.top-n)<nu}))||(x=Lc(M))}let w;const C=g.filter((e=>e.direction===Tc().v.Left||e.direction===Tc().v.Right)).sort(((e,t)=>e.height-t.height));let j=f().F(C,(e=>{const n=su(e,t,i).x;return Math.abs(e.left-n)}));if(j){const e=j,t=C.filter((t=>Math.abs(t.left-e.left)<tu));t.length>0&&(j=f().F(t,(e=>e.left)))}if(j){const e=j;h.some((t=>t.top>=e.top&&t.top+t.height<=e.top+e.height))||(w=Lc(j))}return{ontoDropZone:x,verticalDropZone:w,horizontalDropZones:b}}({points:{mousePoint:{x:n,y:o},originPoint:{x:n-i,y:o-a}},draggingStore:t[0],isNativeDrag:l,environment:r,pageContext:s,canDragFn:m});if(d.ontoDropZone)Tc().default.setState({...e,currentDropZone:d.ontoDropZone,currentHintDropZones:[],currentParentStore:void 0});else if(d.verticalDropZone)Tc().default.setState({...e,currentDropZone:d.verticalDropZone,currentHintDropZones:[],currentParentStore:void 0});else{if(d.horizontalDropZones.length>0){const t=d.horizontalDropZones[0],n=f().Gb(d.horizontalDropZones);if(t.type===Tc().D.Selectable){const o=$c().C.findSelectableFromStore(t.store);if(o){const i=o.getContextClosestSelectable();let a;return i&&i.props.store!==t.store&&i.props.shouldShowParentHalo&&(a=i.props.store),void Tc().default.setState({...e,currentDropZone:t,currentHintDropZones:n,currentParentStore:a})}}else{if(Gc().Z.findDropTargetFromKey(t.key))return void Tc().default.setState({...e,currentDropZone:t,currentHintDropZones:n,currentParentStore:void 0})}}Tc().default.setState({...e,currentDropZone:void 0,currentHintDropZones:[],currentParentStore:void 0})}}),[r,m,s]),g=(0,o.useCallback)((()=>{if(e.current)throw new Error("Assertion failure, updateDragState() called when isUpdatingDragState === true!");e.current=!0;try{p()}finally{e.current=!1}}),[p]),h=(0,o.useCallback)((()=>{const{isDragging:e}=Tc().default.state;e&&g()}),[g]),v=(0,o.useCallback)((()=>{t.current=!0}),[]);(0,o.useEffect)((()=>(window.addEventListener("mousemove",l),Dt().default.addListener(c),a.isIOS&&window.addEventListener("touchend",v),window.addEventListener("keydown",h),window.addEventListener("keyup",h),Tc().default.addListener(d),window.addEventListener("scroll",du,!0),window.addEventListener("resize",cu),_t().kw.addListener(uu),uo().Jy(),()=>{window.removeEventListener("mousemove",l),Dt().default.removeListener(c),a.isIOS&&window.removeEventListener("touchend",v),window.removeEventListener("keydown",h),window.removeEventListener("keyup",h),Tc().default.removeListener(d),window.removeEventListener("scroll",du,!0),window.removeEventListener("resize",cu),_t().kw.removeListener(uu)})),[a.isIOS,d,c,h,l,v])}function iu(){const e=Xc().default.state;e.isOpen&&!e.menuIsOpen&&Xc().default.reset()}function au(e){return(Dt().default.state.droppableContainerStack||[]).indexOf(e)}function ru(e,t,n,o){var i,a;const r=Xc().default.state;if(r.isOpen&&r.menuIsOpen)return;const s=function(e){const{environment:t,target:n,x:o,y:i,rightMarginCommentActionsEnabled:a}=e;if(Qc().Z.state.isResizing||Tc().default.state.isDragging||we().default.state.isActive||_t().kw.state)return;const{selectableRectMap:r}=_c().default.state,s=Yc().Z.getMembersByDOMOrder({filter:e=>{const t=e.getNode();return Boolean(t&&t.contains(n))}})[0];if(!s)return;const l=r.keys();let d=l.next();const c=[],u=[];for(;!d.done;){const e=d.value,n=r.get(e),m=Jc().WA({environment:t,store:e.props.store,selectableBoundingRect:n}),p=Jc().nl({store:e.props.store,selectableBoundingRect:n,containerWidth:m}),g=Jc().ld(e);if((e.props.shouldShowHoverMenu||e.props.shouldShowCommentMenu)&&e.getContextSelectableContainer()===s&&n&&Es().uh((0,Xc().getExpandedSelectableRect)(n,a,m,p,g),o,i)){for(const t of Xc().HOVER_REGIONS)Es().uh((0,Xc().getHoverRegionOfRect)(n,t,m,p,g),o,i)&&u.push({selectable:e,hoveredRegion:t});Es().uh((0,Xc().getExactSelectableRect)(n,a),o,i)&&c.push(e)}d=l.next()}const m=f().MR(c,(e=>{const t=r.get(e);return t?-t.left:1/0})),p=m.find((e=>{const t=e.getNode();return!t||!m.find((n=>{if(n!==e){const e=n.getNode();return Boolean(e&&t.contains(e))}return!1}))}));return p?{exactSelectable:p,nearbySelectables:u,container:s}:{nearbySelectables:u,container:s}}({environment:e,target:t,x:n,y:o,rightMarginCommentActionsEnabled:!0});if(!s)return void Xc().default.reset();const l=!r.isOpen||(null===(i=s.exactSelectable)||void 0===i?void 0:i.props.store)!==r.currentStore,d=r.isOpen&&(null===(a=s.exactSelectable)||void 0===a?void 0:a.props.store)===r.currentStore;var c,u;l?Xc().default.setState({...r,isOpen:!0,menuIsOpen:!1,container:s.container,nearbySelectables:s.nearbySelectables,currentStore:null===(c=s.exactSelectable)||void 0===c?void 0:c.props.store,selectableBoundingRect:null===(u=s.exactSelectable)||void 0===u||null===(u=u.getNode())||void 0===u?void 0:u.getBoundingClientRect(),mouseX:n,mouseY:o}):d&&Xc().default.setState({...r,nearbySelectables:s.nearbySelectables,mouseX:n,mouseY:o})}function su(e,t,n){return Dc({device:n.device,target:e.target,points:t})}function lu(e){return(null==e?void 0:e.priority)??0}function du(){uo().Ch(),iu()}function cu(){uo().Ch(),iu()}function uu(){const e=Xc().default.state,t=_t().kw.state;e.isOpen&&!e.menuIsOpen&&t&&Xc().default.reset()}function mu(e){const{target:t,direction:n,optionKeyDown:o,environment:i,pageContext:a,canDragFn:r}=e;if(Se().Z.state.isOpen&&!nr().default.state.open)return!1;if(Me().Z.state.isOpen)return!1;const s=Tc().default.state,l=s.isDragging?s.draggedStores:[],d=!!s.isDragging&&s.isNativeDrag;let c,u,m,p=!1,g=!1;l.find((e=>{const t=qc().Z.findOutlinerItemFromStore(e);return!!t&&(c=t,u=t.type,p=t.isTopLevelItem,!0)}));const f=(0,kc().u)(t)?qc().Z.findOutlinerItemFromStore(t.props.store):void 0,h=null==f?void 0:f.parentStore;var v;f&&(m=f.type,g=f.isTopLevelItem||"team"===(null===(v=f.parentStore)||void 0===v?void 0:v.table));if(function(e){var t;const{draggingOutlinerItem:n,selectableOutlinerItemParent:o,direction:i}=e;if(n&&"team"===n.type&&n.isTopLevelItem&&(null===(t=n.parentStore)||void 0===t?void 0:t.pointer.table)===wc().e0){const e=n.parentStore;if(!(n.store.getParentId()===e.pointer.id||o&&o.pointer.id===e.pointer.id&&i!==Tc().v.Onto))return!0}return!1}({draggingOutlinerItem:c,selectableOutlinerItemParent:h,direction:n}))return!1;if(!(0,kc().u)(t))return t.props.canAcceptDrop({direction:n,draggingStores:l,isNativeDrag:d});const y=t.props.store;if(y.pathIsDead())return!1;if((0,Ws().Eo)(y))return!1;if("suggest"===zs().MT.getMode(y))return!1;const b=(0,jc().fm)(y);if(b&&b.isInTrashStore.state)return!1;const x=y.getAssociatedCollectionStore();if(n===Tc().v.Onto&&x){const e=x.id,t=(0,jc().fm)(y),n=null==t?void 0:t.collectionViewBlockStore(),o=null==t?void 0:t.collectionViewStore();if(n&&o&&"page"!==o.getType()){if(l.find((o=>{const i=o.getAssociatedCollectionStore(),a=(0,jc().fm)(o);return Boolean(o instanceof ee().G&&i&&i.id===e)||Boolean(a===t&&y.id!==n.id)})))return!1}}if(n!==Tc().v.Onto){const e=(0,jc().fm)(y);if("collectionTypedView"===(null==e?void 0:e.contextType)&&e.databaseType){if(!l.find((t=>{const n=(0,jc().fm)(t);return(null==n?void 0:n.databaseType)===e.databaseType})))return!1}}if(t.props.groupsPointer){var S;const e=null===(S=y.getCollectionStore())||void 0===S?void 0:S.getSchema();if(Boolean(t.props.groupsPointer.find((t=>!(0,Sc().WL)(t,(null==x?void 0:x.getSchema())??e))))){if(l.find((e=>{var n;const o=$c().C.findSelectableFromStore(e);return(null==o||null===(n=o.props)||void 0===n?void 0:n.groupsPointer)&&t.props.groupsPointer&&!(0,Mc().HH)(o.props.groupsPointer,t.props.groupsPointer)})))return!1}}if((0,Ec().ru)({targets:l,destination:y,direction:n,draggingOutlinerType:u}))return!1;if(o&&l.find((e=>e.isTypedCollectionViewBlock()||(0,Cc().h7)(e))))return!1;if(f&&n!==Tc().v.Onto&&!g&&!(0,od().MaU)({environment:i,blocks:[f.store],publicEditMode:null==a?void 0:a.publicEditModeStore.state}))return!1;if(m&&d)return!1;if("bookmarks"===u&&p&&("bookmarks"!==m||!g||n===Tc().v.Onto))return!1;if("bookmarks"===m&&g&&n!==Tc().v.Onto&&("bookmarks"!==u||!p))return!1;if(c&&c.isTopLevelItem&&"team"===c.type&&c.parentStore&&c.parentStore.table===wc().e0){const e=c.parentStore,t=ee().zX.createChildStore(e,{...e.pointer,table:wc().e0});if(t&&!(0,Wc().si)({teamStore:t,environment:i}))return!1}if(f&&f.isTopLevelItem&&"team"===f.type&&f.parentStore&&f.parentStore.table===wc().e0){const e=f.parentStore,t=ee().zX.createChildStore(e,{...e.pointer,table:wc().e0});if(t&&!(0,Wc().si)({teamStore:t,environment:i}))return!1}const{currentSpaceViewStore:M}=Q().default.state,w=m?Wc().TM[m]:void 0;if(M&&f&&c&&w&&f.isTopLevelItem&&n!==Tc().v.Onto&&c.type!==m){const{sortOption:e}=(0,Wc().S4)({spaceViewStore:M,type:w});if("lastEdited"===e)return!1}if("shared"===m&&g&&n!==Tc().v.Onto&&("shared"!==u||!p))return!1;if(m&&g&&n!==Tc().v.Onto){if(l.find((e=>{const t=e.getType();return Boolean(!t||!Ye().Z7[t])})))return!1}const{device:C}=i;if(m&&C.isMobile&&n===Tc().v.Onto&&g)return!1;if(l.some((e=>Boolean(zc().Z.findCollectionTemplatePickerItemFromStore(e))))!==Boolean(zc().Z.findCollectionTemplatePickerItemFromStore(y)))return!1;if(n===Tc().v.Onto&&y&&!(0,od().J5S)({environment:i,blocks:[y],publicEditMode:null==a?void 0:a.publicEditModeStore.state}))return!1;if(!r(l))return!1;if(l.some((e=>e.isTransclusionType()))){if(y.findRecordStoreUIAncestor((e=>{if(e===y)return!1;const t=e.isTable("block")&&e.isPath([])&&e.getKeyStore("type").getValue();return Boolean(t&&(0,Ye().nq)(t))})).ancestor)return!1}return!0}function pu(){const e=(0,i().Fy)(),t=(0,i().O7)(),{isMobile:n,isElectron:d}=e;(0,o.useEffect)((()=>{if(n){function e(e){e.preventDefault()}return document.addEventListener("gesturestart",e),()=>{document.removeEventListener("gesturestart",e)}}}),[n]);const c=(0,a().VK)((()=>Q().default.state.currentSpaceStore),[]);(0,o.useEffect)((()=>{function e(e){e.preventDefault()}return window.addEventListener("dragstart",e),()=>{window.removeEventListener("dragstart",e)}}),[]),(0,o.useEffect)((()=>{function e(e){we().default.state.isActive&&(e.preventDefault(),r().MZ({environment:t,currentX:we().default.state.currentX,currentY:we().default.state.currentY,toggle:e.shiftKey}))}function n(e){we().default.state.isActive&&(e.preventDefault(),r().MZ({environment:t,currentX:e.clientX,currentY:e.clientY,toggle:e.shiftKey}))}function o(e){we().default.state.isActive&&((0,D().N9)(e)||e.preventDefault(),r().qw(t))}return window.addEventListener("keydown",e),window.addEventListener("keyup",e),window.addEventListener("mousemove",n),window.addEventListener("mouseup",o),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",e),window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",o)}}),[t]);const g=t.currentUser.isLoggedIn();return ne(c,g),ou(),(0,Z.jsxs)(o.Fragment,{children:[(0,Z.jsx)(pt,{}),(0,Z.jsx)(l().zI,{}),(0,Z.jsx)(l().y4,{}),(0,Z.jsx)(ce,{}),(0,Z.jsx)(Te().Z,{priority:-1,capture:!0,debugName:"AppComponents"}),g&&!n&&(0,Z.jsx)(Vl,{}),g&&(0,Z.jsx)(be().AuthSyncListener,{}),g&&(0,Z.jsx)(nc,{}),g&&(0,Z.jsx)(en,{}),g&&(0,Z.jsx)(nn,{}),g&&(0,Z.jsx)(ke,{}),g&&(0,Z.jsx)(zn,{}),g&&(0,Z.jsx)(ve,{}),(0,Z.jsx)(Jt().Z,{}),(0,Z.jsx)($r,{}),(0,Z.jsx)(m().i4,{}),(0,Z.jsx)(hs,{}),(0,Z.jsx)(ss,{}),(0,Z.jsx)(Ro,{}),(0,Z.jsx)(Gt,{}),!n&&(0,Z.jsx)(ml,{}),(0,Z.jsx)(Xo,{}),(0,Z.jsx)(ns,{}),(0,Z.jsx)(di().Z,{}),(0,Z.jsx)(Yt().Z,{store:Se().Z}),(0,Z.jsx)(Yt().Z,{store:Me().Z}),(0,Z.jsx)(s()._,{}),(0,Z.jsx)(qr,{}),(0,Z.jsx)(xe().KS,{}),(0,Z.jsx)(A,{}),(0,Z.jsx)(Dn,{}),(0,Z.jsx)(ye().Qi,{}),(0,Z.jsx)(pc,{}),(0,Z.jsx)(li,{}),(0,Z.jsx)(rc,{}),(0,Z.jsx)(Ft,{}),(0,Z.jsx)(Nl().Z,{}),(0,Z.jsx)(re,{}),d&&(0,Z.jsx)(u,{}),(0,Z.jsx)(fn,{}),(0,Z.jsx)($t().v,{}),g&&(0,Z.jsx)(Dd,{}),(0,Z.jsx)(qo().s6,{}),(0,Z.jsx)(Ke,{}),(0,Z.jsx)(Qt().ek,{}),g&&(0,Z.jsx)(dn,{}),(0,Z.jsx)(p().Z,{})]})}},874226:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Ie});n(667294);var o=()=>n(219727),i=()=>n(142735),a=()=>n(306164),r=()=>n(788860),s=()=>n(513670),l=()=>n(696459),d=()=>n(20919),c=()=>n(388284),u=n(785893);const m=[{key:"block in comment menu primary",render:e=>(0,u.jsx)(c().Z,{...e}),actions:[n(83110).G,d().yN,d().TH]}];var p=()=>n(116926),g=()=>n(182008);const f=[{key:"page mention context menu primary",render:e=>(0,u.jsx)(c().Z,{isTitleUppercase:!1,...e}),actions:[...n(998244).ej,g().Kk,g().Hs]}];var h=()=>n(491927),v=()=>n(242619),y=()=>n(718959),b=()=>n(861026),x=()=>n(352230),S=()=>n(148126),M=()=>n(465371),w=()=>n(466970),C=()=>n(10271),j=()=>n(772529),k=(n(241792),()=>n(827282));const T={viewBox:"0 0 20 20",svg:(0,u.jsx)("path",{d:"M2.411 9.79a.6.6 0 0 1 .147-.232l5.4-5.4a.625.625 0 1 1 .884.884L4.509 9.375H17a.625.625 0 1 1 0 1.25H4.509l4.333 4.333a.625.625 0 1 1-.884.884l-5.4-5.4a.62.62 0 0 1-.147-.651"})},I=(0,k().IU)("arrowStraightLeft",T),_={viewBox:"0 0 20 20",svg:(0,u.jsx)("path",{d:"m17.442 9.558-5.4-5.4a.625.625 0 0 0-.884.884l4.333 4.333H3a.625.625 0 1 0 0 1.25h12.491l-4.333 4.333a.625.625 0 1 0 .884.884l5.4-5.4a.62.62 0 0 0 0-.884"})},P=(0,k().IU)("arrowStraightRight",_);var Z=()=>n(453953),A=()=>n(200962),R=()=>n(434383);const B={viewBox:"0 0 20 20",svg:(0,u.jsx)("path",{d:"M10 2.375a7.625 7.625 0 1 0 0 15.25 7.625 7.625 0 0 0 0-15.25m2.817 4.808a.625.625 0 0 1 0 .884L10.884 10l1.933 1.933a.625.625 0 1 1-.884.884L10 10.884l-1.933 1.933a.625.625 0 1 1-.884-.884L9.116 10 7.183 8.067a.625.625 0 1 1 .884-.884L10 9.116l1.933-1.933a.625.625 0 0 1 .884 0"})},L=(0,k().IU)("xMarkCircleFill",B);var D=()=>n(568017),V=()=>n(313351),O=()=>n(421654),U=()=>n(269299),N=()=>n(421797),F=()=>n(527278),H=()=>n(156958);const K=(0,r().vU)({simpleTableHeaderColumn:{id:"action.rowHeader.title",defaultMessage:"Header column"},simpleTableHeaderRow:{id:"action.columnHeader.title",defaultMessage:"Header row"},simpleTableInsertColumnLeft:{id:"action.insertColumnLeft.title",defaultMessage:"Insert Left"},simpleTableInsertColumnRight:{id:"action.insertColumnRight.title",defaultMessage:"Insert Right"},simpleTableClearContents:{id:"action.clearContents.title",defaultMessage:"Clear Contents"},simpleTableInsertRowAbove:{id:"action.insertRowAbove.title",defaultMessage:"Insert Above"},simpleTableInsertRowBelow:{id:"action.insertRowBelow.title",defaultMessage:"Insert Below"},textColorSection:{id:"action.section.textColor",defaultMessage:"Text Color"},backgroundColorSection:{id:"action.section.backgroundColor",defaultMessage:"Background Color"}}),E=(0,V().N$)({key:"simple table header column",displayName:K.simpleTableHeaderColumn,label:F().Z.formatMessage(K.simpleTableHeaderColumn),svg:n(897615).s,validators:[N().J5S,N().ffD(N().b47),N().W5_,N().p4X],isEnabled:e=>Boolean(e.getFormat().table_block_row_header),action:(e,t,n)=>O().FH({stores:[t],update:{table_block_row_header:!t.getFormat().table_block_row_header},transaction:n})}),W=(0,V().N$)({key:"simple table header row",displayName:K.simpleTableHeaderRow,label:F().Z.formatMessage(K.simpleTableHeaderRow),svg:n(274697).f,validators:[N().J5S,N().ffD(N().b47),N().zOn],isEnabled:e=>{const t=e.getParentBlockStore();return!(null==t||!t.isType("table"))&&Boolean(t.getFormat().table_block_column_header)},action:(e,t,n)=>{const o=t.getParentBlockStore();null!=o&&o.isType("table")&&O().FH({stores:[o],update:{table_block_column_header:!o.getFormat().table_block_column_header},transaction:n})}}),z=(0,V().cN)({key:"insert column left",displayName:K.simpleTableInsertColumnLeft,analyticsName:K.simpleTableInsertColumnLeft.defaultMessage,svg:I,validators:[N().J5S,N().ffD(N().OPg),N().W5_,N().z22],closeParentMenu:!0,action:e=>{let{environment:t}=e;U().createAndCommit({userAction:"actionRegistry.insertColumnLeft",environment:t,canUndo:!0,perform:e=>{H().uM({environment:t,transaction:e})}})}}),G=(0,V().cN)({key:"insert column right",displayName:K.simpleTableInsertColumnRight,analyticsName:K.simpleTableInsertColumnRight.defaultMessage,svg:P,validators:[N().J5S,N().ffD(N().OPg),N().W5_,N().z22],closeParentMenu:!0,action:e=>{let{environment:t}=e;U().createAndCommit({userAction:"actionRegistry.insertColumnRight",environment:t,canUndo:!0,perform:e=>{H().xy({environment:t,transaction:e})}})}}),q=(0,V().cs)({key:"duplicate columns",displayName:V().RE.duplicateName,analyticsName:V().RE.duplicateName.defaultMessage,svg:A().a,validators:[N().J5S,N().ffD(N().OPg),N().W5_,N().z22],shortcuts:["duplicate"],closeParentMenu:!0,action:e=>{let{environment:t}=e;U().createAndCommit({userAction:"actionRegistry.duplicateColumns",environment:t,canUndo:!0,perform:e=>{H().Hh({transaction:e})}})}}),Y=(0,V().cs)({key:"delete columns",displayName:V().RE.deleteName,analyticsName:V().RE.deleteName.defaultMessage,svg:R().y,validators:[N().J5S,N().ffD(N().OPg),N().W5_,N().OTA,N().z22],shortcuts:["delete","backspace"],closeParentMenu:!0,action:e=>{let{environment:t}=e;U().createAndCommit({userAction:"actionRegistry.deleteColumns",environment:t,canUndo:!0,perform:e=>{H().ih({environment:t,transaction:e})}})}}),$=(0,V().cN)({key:"clear column contents",displayName:K.simpleTableClearContents,analyticsName:K.simpleTableClearContents.defaultMessage,svg:L,validators:[N().J5S,N().ffD(N().OPg),N().W5_,N().z22],closeParentMenu:!0,action:e=>{let{environment:t}=e;U().createAndCommit({userAction:"actionRegistry.clearColumnContents",environment:t,canUndo:!0,perform:e=>{H().WO({environment:t,transaction:e})}}),H().MO()}}),J=(0,V().cN)({key:"insert row above",displayName:K.simpleTableInsertRowAbove,analyticsName:K.simpleTableInsertRowAbove.defaultMessage,svg:n(702041).R,validators:[N().J5S,N().ffD(N().OPg),N().EJd],closeParentMenu:!0,action:e=>{let{environment:t}=e;U().createAndCommit({userAction:"actionRegistry.insertRowAbove",environment:t,canUndo:!0,perform:e=>{H().co({environment:t,transaction:e})}})}}),Q=(0,V().cN)({key:"insert row below",displayName:K.simpleTableInsertRowBelow,analyticsName:K.simpleTableInsertRowBelow.defaultMessage,svg:n(79685).j,validators:[N().J5S,N().ffD(N().OPg),N().EJd],closeParentMenu:!0,action:e=>{let{environment:t}=e;U().createAndCommit({userAction:"actionRegistry.insertRowBelow",environment:t,canUndo:!0,perform:e=>{H().Qs({environment:t,transaction:e})}})}}),X=(0,V().cs)({key:"duplicate rows",displayName:V().RE.duplicateName,analyticsName:V().RE.duplicateName.defaultMessage,svg:A().a,validators:[N().J5S,N().ffD(N().OPg),N().EJd],shortcuts:["duplicate"],closeParentMenu:!0,action:e=>{let{environment:t}=e;U().createAndCommit({userAction:"actionRegistry.duplicateRows",environment:t,canUndo:!0,perform:e=>{H().Fi({environment:t,transaction:e})}})}}),ee=(0,V().cs)({key:"delete rows",displayName:V().RE.deleteName,analyticsName:V().RE.deleteName.defaultMessage,svg:R().y,validators:[N().J5S,N().ffD(N().OPg),N().W3A,N().EJd],shortcuts:["delete","backspace"],closeParentMenu:!0,action:e=>{let{environment:t}=e;U().createAndCommit({userAction:"actionRegistry.deleteRows",environment:t,canUndo:!0,perform:e=>{H().M5({environment:t,transaction:e})}})}}),te=(0,V().cN)({key:"clear row contents",displayName:K.simpleTableClearContents,analyticsName:K.simpleTableClearContents.defaultMessage,svg:L,validators:[N().J5S,N().ffD(N().OPg),N().EJd],closeParentMenu:!0,action:e=>{let{environment:t}=e;U().createAndCommit({userAction:"actionRegistry.clearRowContents",environment:t,canUndo:!0,perform:e=>{H().WO({environment:t,transaction:e})}}),H().MO()}}),ne=[N().J5S,N().ffD(N().OPg),N().W5_,N().z22],oe=[N().J5S,N().ffD(N().OPg),N().EJd];function ie(e,t,o,i){const a=i||(0,n(527511).qf)(e),r=(0,V().cN)({key:`color ${o||e}`,displayName:a,analyticsName:a.defaultMessage,fuzzySearchKeywords:(0,V().CJ)(e),validators:"column"===t?ne:oe,action:t=>{let{blocks:n,environment:o}=t;U().createAndCommit({userAction:"actionRegistry.createSimpleTableColorAction",environment:o,canUndo:!0,perform:t=>{H().vk(o,e,t)}})},closeParentMenu:!0,render:t=>(0,u.jsx)(n(406496).ZP,{...t,color:e,overrideDisplayName:r.displayName}),nativeImageReference:t=>{let{environment:n}=t;return(0,V().q7)(n,e,o)}});return r}const ae=(0,V().$J)({key:"simple table column background color actions",title:V().RE.backgroundSection,overrideSearchTitle:V().RE.backgroundSectionKeywords,render:e=>(0,u.jsx)(c().Z,{...e}),actions:[...D()._K.map((e=>ie(e,"column")))]}),re=(0,V().$J)({key:"simple table column text color actions",title:V().RE.colorSection,overrideSearchTitle:V().RE.colorSection,render:e=>(0,u.jsx)(c().Z,{...e}),actions:[...D().CY.map((e=>ie(e,"column")))]}),se=(0,V().$J)({key:"simple table row background color actions",title:V().RE.backgroundSection,overrideSearchTitle:V().RE.backgroundSectionKeywords,render:e=>(0,u.jsx)(c().Z,{...e}),actions:[...D()._K.map((e=>ie(e,"row")))]}),le=(0,V().$J)({key:"simple table row text color actions",title:V().RE.colorSection,overrideSearchTitle:V().RE.colorSection,render:e=>(0,u.jsx)(c().Z,{...e}),actions:[...D().CY.map((e=>ie(e,"row")))]}),de=(0,V().MV)({key:"set column color",displayName:V().RE.colorName,analyticsName:V().RE.colorName.defaultMessage,svg:Z().U,validators:ne,subActions:()=>[{key:0,title:F().Z.formatMessage(K.textColorSection),render:e=>(0,u.jsx)(c().Z,{...e}),actions:re.actions},{key:1,title:F().Z.formatMessage(K.backgroundColorSection),render:e=>(0,u.jsx)(c().Z,{...e}),actions:ae.actions}]}),ce=(0,V().MV)({key:"set row color",displayName:V().RE.colorName,analyticsName:V().RE.colorName.defaultMessage,svg:Z().U,validators:oe,subActions:()=>[{key:0,title:F().Z.formatMessage(K.textColorSection),render:e=>(0,u.jsx)(c().Z,{...e}),actions:le.actions},{key:1,title:F().Z.formatMessage(K.backgroundColorSection),render:e=>(0,u.jsx)(c().Z,{...e}),actions:se.actions}]}),ue=[(0,V().$J)({key:"column section",render:e=>(0,u.jsx)(c().Z,{...e}),actions:[E,de,z,G,q,$,Y]}),(0,V().$J)({key:"row section",render:e=>(0,u.jsx)(c().Z,{...e}),actions:[W,ce,J,Q,X,te,ee]})];var me=()=>n(998901),pe=()=>n(104088),ge=()=>n(876822),fe=()=>n(340819),he=()=>n(826955),ve=()=>n(965903),ye=()=>n(8881),be=()=>n(985523),xe=()=>n(149809),Se=()=>n(740046),Me=()=>n(94967),we=()=>n(198829),Ce=()=>n(470386),je=()=>n(967092),ke=()=>n(409318),Te=()=>n(508181);function Ie(){const e=(0,o().Fy)();return e.isMobileNative&&e.isIOS&&e.isPhone?(0,u.jsx)(_e,{}):(0,u.jsx)(Pe,{})}function _e(){const e=(0,i().Kw)(fe().Z);return(0,C().Z)({shouldPreserveTextSelection:e.isActive,shouldPreserveBlockSelection:!1,shouldRestoreSelection:!0}),(0,u.jsx)(Pe,{})}function Pe(){const e=(0,o().Fy)(),t=(0,i().Kw)(fe().Z),n=(0,w().E)("mobile_use_bottom_sheet_popup_container");return(0,u.jsx)(je().ZP,{popupType:e.isPhone?n?pe().k.BottomSheet:pe().k.SlideUp:pe().k.Popup,open:t.isActive,originRect:t.isActive?t.originBlockRect:void 0,onDismiss:Le,placementToOrigin:me().Placement.Bottom,alignmentToOrigin:me().Alignment.Start,originGap:0,preventScaleTransition:!0,render:()=>(0,u.jsx)(Ze,{}),preventBlockRenderQueueOnEnter:e.isMobile,trapFocus:!0})}function Ze(){var e;const t=(0,o().O7)(),n=(0,o().MO)(),c=(0,ke().L)(),g=(0,i().Kw)(fe().Z),y=null===(e=g.stores)||void 0===e?void 0:e[0],S=(0,i().VK)((()=>null==y?void 0:y.isCollectionView()),[y]),w=(0,i().VK)((()=>g.isActive?function(e){switch(e){case"default":return d().Qi;case"simple_table":return ue;case"page_mention":return f;case"sidebar_outliner":return p().Oq;case"comment_media":return m;case"block_in_collection_timeline_view":return d().KC;case"block_in_collection":return d().p0;default:(0,l().t1)(e)}}(null==g?void 0:g.actionSectionGroupKey):[]),[g]);if(!g.isActive||!y)return null;const{originBlockRect:C,inputValue:j,publicEditMode:k}=g||{},T={environment:t,blocks:g.stores,originRect:C,publicEditMode:k},I=g.showInput&&(0,u.jsx)(Be,{}),_=n?{menuType:x().o.Modal,title:(0,u.jsx)(r()._H,{defaultMessage:"Actions",id:"blockMenu.actionButton.label"}),right:c?void 0:(0,u.jsx)(Ce().DoneMenuText,{}),onClickRight:Le,header:I}:{menuType:x().o.Popup,width:265,header:I};return(0,u.jsx)(Me().Z,{debugName:"BlockMenu",capture:!0,onBackspace:s().yR,children:(0,u.jsxs)(we().Z,{..._,children:[(0,u.jsx)(xe().Z,{filter:j,context:T,sections:w,onAccept:e=>function(e,t){const n=fe().Z.state;if(!n.isActive)return;const{stores:o}=ve().default.state,{analyticsFrom:i,collectionContextStore:r}=n,s=o[0];if(s){const n=s.getParentTable(),o=s.getType();if(o&&n){let l;if(n===a().e0){const e=s.getParentId(),{currentSpaceStore:t}=ge().default.getState();t&&void 0!==e&&(l=he().zX.createChildStore(t,{table:a().e0,id:e}))}const d=(0,b().Pn)(r)||{};h().dh(t,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:i,block_id:s.id,block_type:o,parentTeamStore:l,is_toggleable:(0,M()._A)(o,s.getFormat()),parent_collection_id:s.getParentCollectionIdUpToTwoLevels(),...d})}}e.closeParentMenu&&v().xv()}(e,t),initialFocus:j?0:void 0}),!j&&(0,u.jsx)(Re,{}),!j&&(0,u.jsx)(ye().Z,{store:y}),!j&&S&&(0,u.jsx)(Ae,{})]})})}function Ae(){const[e,t]=(0,i().VK)((()=>{const e=fe().Z.state;if(!e.isActive)return[!1,!1];const t=e.stores[0];return[!0,(0,y().qG)(t.id)]}),[]);return e?t?(0,u.jsx)(c().Z,{topBorder:!0,children:(0,u.jsx)(Te().Z,{title:(0,u.jsx)(r()._H,{defaultMessage:"Learn about tasks",id:"myTasks.helpTooltip.title"}),href:j().su,analyticsFrom:"block_menu"})}):(0,u.jsx)(c().Z,{topBorder:!0,children:(0,u.jsx)(Te().Z,{title:(0,u.jsx)(r()._H,{defaultMessage:"Learn about databases",id:"blocks.blockMenu.collectionHelpButton"}),href:(0,S().UY)("guides.database"),analyticsFrom:"block_menu"})}):null}function Re(){const e=(0,o().O7)(),t=(0,i().Kw)(fe().Z),n=(0,i().VK)((()=>e.currentUser.isLoggedIn()),[e]),a=(0,i().VK)((()=>t.isActive&&1===t.stores.length&&(0,y().qG)(t.stores[0].id)),[t]);return n?!t.isActive||t.stores.length>1||a?null:(0,u.jsx)(be().y,{store:t.stores[0],isPageMoreButton:!1}):null}function Be(){const e=(0,r().YB)(),t=(0,o().MO)(),n=(0,i().Kw)(fe().Z);if(!n.isActive||t)return null;const{inputValue:a}=n;return(0,u.jsx)(c().Z,{isInput:!0,children:(0,u.jsx)(Se().ZP,{value:a,onChange:De,focus:!0,focusAfterAnimation:!0,placeholder:e.formatMessage({defaultMessage:"Search actions…",id:"blockMenu.filterForActions.placeholder"}),preventCaptureDeleteWhenEmpty:!0})})}function Le(){v().xv()}function De(e){fe().Z.state.isActive&&fe().Z.setState({...fe().Z.state,inputValue:e.target.value})}},931928:(e,t,n)=>{n.r(t),n.d(t,{CollectionTypedDatabaseMigrationModal:()=>re});var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(846550),s=()=>n(926724),l=()=>n(788860),d=()=>n(530261),c=(n(241792),()=>n(714230)),u=n(785893);const m=(0,n(827282).IU)("drawing",{viewBox:"0 0 12 12",svg:(0,u.jsx)("path",{d:"M2.606 9.98a6.714 6.714 0 01-1.162-1.538A6.54 6.54 0 01.8 6.752a5.933 5.933 0 01-.132-1.698c.042-.557.17-1.081.38-1.573.216-.494.512-.932.89-1.313a4.043 4.043 0 011.347-.898A4.761 4.761 0 014.887.928a5.48 5.48 0 011.68.185c.56.15 1.09.381 1.591.694l-.845.83a4.757 4.757 0 00-1.152-.435 4.372 4.372 0 00-1.23-.127c-.41.013-.804.093-1.182.24-.374.146-.71.367-1.006.664a3.09 3.09 0 00-.796 1.352 4.196 4.196 0 00-.117 1.646c.068.576.236 1.14.503 1.694.27.553.63 1.055 1.08 1.504.276.28.564.516.863.708a6 6 0 00.884.469c.287.123.552.22.796.288.247.071.456.127.625.166a.784.784 0 01.4.215c.092.1.136.23.132.39-.006.186-.078.322-.215.41-.136.091-.314.12-.532.088a6.388 6.388 0 01-.698-.151 7.184 7.184 0 01-1.997-.903 6.64 6.64 0 01-1.065-.875zm1.968-1.523L5.8 7.988a3.6 3.6 0 00.874.635c.329.17.669.282 1.02.337.352.055.694.039 1.026-.049a2.03 2.03 0 00.903-.542 1.85 1.85 0 00.537-1.035 2.906 2.906 0 00-.083-1.294 4.542 4.542 0 00-.64-1.348l.826-.82c.341.475.599.962.771 1.46.176.495.27.978.283 1.45.013.472-.055.913-.205 1.323a2.913 2.913 0 01-.678 1.075c-.3.3-.647.52-1.04.664-.391.14-.804.208-1.24.205-.434 0-.867-.064-1.3-.19a5.255 5.255 0 01-1.24-.547 4.715 4.715 0 01-1.04-.855zM5.6 7.48l-1.177.445c-.085.032-.165.014-.24-.054a.21.21 0 01-.053-.244l.459-1.162 4.443-4.439 1.011 1.011L5.6 7.48zm4.819-4.814l-1.01-1.01.468-.47a.716.716 0 01.44-.21.481.481 0 01.414.142l.176.171a.551.551 0 01.171.45.703.703 0 01-.205.453l-.454.474z"})});var p=()=>n(101486),g=()=>n(707513),f=()=>n(527278),h=()=>n(957001),v=()=>n(533845),y=()=>n(643051),b=()=>n(396439),x=()=>n(67961);const S=(0,l().vU)({dummyTask1:{id:"MyTasksWidgetPreview.dummyTask1",defaultMessage:"Set up sync with Lisa"},dummyTask2:{id:"MyTasksWidgetPreview.dummyTask2",defaultMessage:"Review design docs"},dummyTask3:{id:"MyTasksWidgetPreview.dummyTask3",defaultMessage:"Create color palette"},dummyTask4:{id:"MyTasksWidgetPreview.dummyTask4",defaultMessage:"Book flight to New York"},dummyTask5:{id:"MyTasksWidgetPreview.dummyTask5",defaultMessage:"Fix broken links"},dummyTask6:{id:"MyTasksWidgetPreview.dummyTask6",defaultMessage:"Upgrade database"},Blocked:{id:"MyTasksWidgetPreview.blockedStatus",defaultMessage:"Blocked"},"In Progress":{id:"MyTasksWidgetPreview.inProgressStatus",defaultMessage:"In Progress"},"Not Started":{id:"MyTasksWidgetPreview.notStartedStatus",defaultMessage:"Not Started"},locationIndicator:{id:"MyTasksWidgetPreview.locationIndicator",defaultMessage:"In"}}),M=[{icon:"📅",taskName:f().Z.formatMessage(S.dummyTask1),status:"Blocked",teamspace:"Eng",location:(0,p().T)({width:13,fill:"#448361"})},{icon:"📚",taskName:f().Z.formatMessage(S.dummyTask2),status:"In Progress",teamspace:"Design",location:m({width:13,fill:"#CB912F"})},{icon:"🎨",taskName:f().Z.formatMessage(S.dummyTask3),status:"In Progress",teamspace:"Design",location:m({width:13,fill:"#CB912F"})},{icon:"🛫",taskName:f().Z.formatMessage(S.dummyTask4),status:"Not Started",teamspace:"Eng",location:(0,p().T)({width:13,fill:"#448361"})},{icon:"🚧",taskName:f().Z.formatMessage(S.dummyTask5),status:"Not Started",teamspace:"Design",location:m({width:13,fill:"#CB912F"})},{icon:"👩‍💻",taskName:f().Z.formatMessage(S.dummyTask6),status:"Not Started",teamspace:"Eng",location:(0,p().T)({width:13,fill:"#448361"})}],w={Blocked:"red","In Progress":"blue","Not Started":"gray"};function C(){const e=T();return(0,u.jsx)(h().Z,{title:(0,u.jsx)(l()._H,{id:"CollectionTypedDatabaseMigrationModal.AssignedToMePreview.Title",defaultMessage:"My tasks"}),tooltip:void 0,icon:(0,u.jsx)("div",{style:{paddingLeft:4},children:(0,u.jsx)(y().Z,{type:"app_package_asset",size:18,icon:c().Z.images.appPackages.taskDbIconSvg})}),children:(0,u.jsx)("div",{style:e.dummyAssignedToMe,children:(0,u.jsx)(j,{})})})}function j(){const e=M.map(((e,t)=>(0,u.jsx)(k,{row:e},t)));return(0,u.jsx)("div",{style:{display:"flex",marginTop:4,paddingRight:16,flexDirection:"column"},children:e})}function k(e){let{row:t}=e;const n=T();return(0,u.jsxs)("div",{style:n.eachTask,children:[(0,u.jsxs)("div",{style:n.taskName,children:[(0,u.jsx)("span",{style:n.taskIcon,children:t.icon}),(0,u.jsx)(x().Z,{style:n.taskTitle,children:t.taskName})]}),(0,u.jsx)("div",{style:n.taskStatus,children:(0,u.jsx)(v().J,{type:"status",value:f().Z.formatMessage(S[t.status]),color:w[t.status],groupColor:void 0})}),(0,u.jsx)(b().Z,{size:8}),(0,u.jsxs)("div",{style:n.location,children:[(0,u.jsx)("span",{style:n.locationIndicator,children:f().Z.formatMessage(S.locationIndicator)}),(0,u.jsx)("div",{style:{...n.locationIcon,..."Design"===t.teamspace?{...n.designTeamspace}:{...n.engTeamspace}},children:t.location})]})]})}function T(){return(0,r().yK)((e=>({dummyAssignedToMe:{width:"60%",maxHeight:270,minHeight:90,paddingBottom:10},eachTask:{display:"flex",alignItems:"center",padding:4},taskName:{width:220,display:"flex",...g().Yu},taskIcon:{fontSize:14,marginRight:8},taskTitle:{color:e.regularTextColor,fontSize:14,fontWeight:500},taskStatus:{display:"flex",width:130},location:{display:"flex",alignItems:"center"},locationIndicator:{color:e.mediumTextColor,marginRight:4,maxWidth:48,...g().Yu},locationIcon:{display:"flex",justifyContent:"center",fontSize:14,height:18,width:18,borderRadius:4},designTeamspace:{backgroundColor:"light"===e.mode?"#FBF3DB":"#5c3b23"},engTeamspace:{backgroundColor:"light"===e.mode?"#E5F2E2":"#243d30"}})),[])}n(267602),n(653476),n(30005),n(228244);var I=()=>n(506347),_=()=>n(197874),P=()=>n(766933),Z=()=>n(374289),A=()=>n(159732),R=()=>n(568017),B=()=>n(250303),L=()=>n(102182),D=()=>n(269299),V=()=>n(360746),O=()=>n(2971),U=()=>n(110232),N=()=>n(360240),F=()=>n(478824),H=()=>n(352230),K=()=>n(772529),E=()=>n(128119),W=()=>n(584989),z=()=>n(209264),G=()=>n(827973),q=()=>n(448419),Y=()=>n(198829),$=()=>n(255577),J=()=>n(906651),Q=()=>n(388284),X=()=>n(360964);function ee(e){const{collectionContextStore:t,databaseType:n,containerStyle:c}=e,m=(0,i().O7)(),p=(0,l().YB)(),{isPhone:g,isMobileNative:f}=(0,i().Fy)(),h=(0,a().VK)((()=>g&&f),[g,f]),v=function(e){return(0,r().yK)((t=>({formTitle:{display:"inline-flex"},emojiTitle:{fontSize:36,marginRight:8},perPropertyInstruction:{color:t.mediumTextColor,fontSize:e?14:12,marginBottom:8},requiredPropertyError:{color:R().ZP.red,fontSize:e?14:12,marginRight:e?8:6},propertyMappingInstructions:{marginTop:6,marginBottom:24,fontSize:e?16:14,fontWeight:e?500:400},propertyMappingDropdown:{display:"flex",alignItems:"center"},chevronDownIconEnabled:{width:e?14:10,fill:t.lightIconColor},propertyMappingTitle:{fontSize:e?16:14,color:t.lightTextColor},propertyMappingMenu:{borderRadius:6,border:`1px solid ${t.tableDividerColor}`,boxShadow:"none"},propertyConversionCallout:{display:"flex",alignItems:"center",marginLeft:4,marginTop:3,color:t.lightTextColor},a:{color:"white",cursor:"pointer"},propertyIcon:{fill:t.darkTextColor},buttons:{marginBlockStart:e?"auto":void 0},submitMigrationButton:{display:"flex",height:e?36:32,fontSize:e?16:14},learnMore:{display:"flex",justifyContent:"center",marginTop:8,marginLeft:0,width:"100%"},learnMoreButton:{display:"inline-flex",justifyContent:"center",width:"100%",height:26},closeButton:{width:"100%",height:36,marginTop:8,display:"inline-flex",justifyContent:"center",fontSize:16,color:t.lightTextColor}})),[e])}(g),y=(0,r().Fg)(),[S,M]=(0,o.useState)(!1),w=(0,a().VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema()}),[t]),C=(0,a().VK)((()=>U().ck((0,O().appConfigs)(),n)),[n]),j=(0,a().VK)((()=>{if(w&&C)return U().Au(C,w)}),[C,w]),k=(0,o.useCallback)(((e,t)=>{const n=t.type;return U().fm(e,t,w??{}).map((e=>{let[t,o]=e;return{key:t,title:null==o?void 0:o.name,icon:(0,u.jsx)(P().ZP,{size:16,style:v.propertyIcon,theme:y,icon:null==o?void 0:o.icon,type:(null==o?void 0:o.type)||n})}}))}),[y,v.propertyIcon,w]),T=(0,a().VK)((()=>{const e=Object.keys(C||{}).filter((e=>void 0!==(null==C?void 0:C[e])&&e.startsWith("notion://"))),t=Object.fromEntries(e.map((e=>[e,void 0])));return Object.entries(C||{}).forEach((e=>{let[n,o]=e;if(!o)return;const i=null==j?void 0:j[n];if(i)return void(t[n]=i);0===k(n,o).length&&(t[n]=_().bK)})),t}),[C,j,k]),[ee,oe]=(0,o.useState)(T),ie=(0,o.useMemo)((()=>Object.entries(ee).some((e=>{let[t,n]=e;if(t===s().Es.Status){const e=null==w?void 0:w[n||""];if("checkbox"===(null==e?void 0:e.type)||"select"===(null==e?void 0:e.type))return!0}}))),[w,ee]),ae=(0,o.useCallback)((e=>{const t=null==C?void 0:C[e],n={width:16,height:16,marginRight:10};if(!t)return null;const o=[...k(e,t),{key:_().bK,title:p.formatMessage(te.createNew),icon:(0,A().R)({width:n.width,fill:v.propertyIcon.fill}),type:void 0}],i=ee[e],a=null==w?void 0:w[i||""],r=!i&&S,d=e===s().Es.Status;let c=null;return i===_().bK?c=(0,A().R)(n):a&&(c=P().wG[null==a?void 0:a.type](n)),(0,u.jsx)(q().ZP,{popupType:g?q().Z4.SlideUp:q().Z4.Popup,renderOrigin:t=>(0,u.jsxs)("div",{style:{marginBottom:24},children:[(0,u.jsx)(x().Z,{isMultiline:!0,style:v.perPropertyInstruction,children:(0,u.jsx)(l()._H,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.PerPropertyInstructions",defaultMessage:"Pick the property that represents {propertyDescription}",values:{propertyDescription:p.formatMessage(ne[e])}})}),(0,u.jsx)(G().Z,{disabled:1===o.length,disabledFeedback:!0,focused:!1,right:(0,u.jsxs)("div",{style:v.propertyMappingDropdown,children:[r?(0,u.jsx)("span",{style:v.requiredPropertyError,children:(0,u.jsx)(l()._H,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.RequiredPropertyError",defaultMessage:"Required"})}):void 0,(0,Z().i)({...v.chevronDownIconEnabled,...r?{fill:R().ZP.red}:{}})]}),rightStyle:{marginRight:g?14:8},title:(0,u.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[c,i===_().bK?p.formatMessage(te.createNew):a?a.name:p.formatMessage(te.select)]}),titleStyle:i?{display:"flex",alignItems:"center"}:v.propertyMappingTitle,itemMarginLeft:8,style:{...v.propertyMappingMenu,...r?{borderColor:R().ZP.red}:{}},buttonStyle:{margin:0,width:"100%"},...t}),d&&ie&&(0,u.jsx)(x().Z,{isSmall:!0,isMultiline:!0,children:(0,u.jsx)("div",{style:v.propertyConversionCallout,children:(0,u.jsx)(l()._H,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CheckboxSelectMappingInfo",defaultMessage:"This property will be converted to a Status property type."})})})]}),placementToOrigin:E().Iw.Bottom,alignmentToOrigin:E().lU.Start,render:t=>{const n=[{key:"propertyOptions",render:e=>(0,u.jsx)(Q().Z,{...e,topBorder:0!==e.index}),items:o.map((n=>{const o={key:n.key,render:t=>(0,u.jsx)(G().Z,{...t,icon:n.icon,title:n.title,checkState:ee[e]===n.key}),action:()=>{oe({...ee,[e]:n.key}),M(!1),t.close()}};return o}))}],i=g?{menuType:H().o.ActionSheet}:{menuType:H().o.Popup,width:250};return(0,u.jsx)(Y().Z,{...i,children:(0,u.jsx)($().ZP,{type:$().iW.Vertical,initialFocus:void 0,sections:n})})}},e)}),[C,k,p,v,ee,w,S,ie,g]),re=(0,o.useCallback)((()=>{var e,o;const i=t.collectionStore(),a=t.collectionViewBlockStore();if(!i||!a)return;const r=(0,K().J2)("main"),c=null==r||null===(e=r.getModel())||void 0===e?void 0:e.getRenderUrl({getRecordModel:null==r?void 0:r.getRecordModel,pageVisitSource:I().tY.TypedDBConversionToast}),g=(0,K().J2)("myTasks"),f=null==g||null===(o=g.getModel())||void 0===o?void 0:o.getRenderUrl({getRecordModel:null==g?void 0:g.getRecordModel,pageVisitSource:I().tY.TypedDBConversionToast});!function(e){return!Object.values(e).includes(void 0)}(ee)?M(!0):D().createAndCommit({userAction:"CollectionTypedDatabaseMigrationModal.migrateDatabase",environment:m,canUndo:!0,perform:e=>{V().vD({environment:m,collectionViewBlockStore:a,collectionStore:i,databaseType:n,propertyMapping:{...ee},typedPropertySchemas:{...C},transaction:e}),d().Z.setState({isModalOpen:!1,collectionContextStore:void 0}),n===s().Ym&&(F().y.locallyMutatedTasksDatabase=!0),B().g2({environment:m,database_type:n,property_mapping:ee,collectionContextStore:t});const o=h?(0,u.jsx)(l()._H,{defaultMessage:"<span>{databaseName} has been turned into a {singularType} database. You will now be able to see your assigned tasks in <a>My tasks</a>.</span>",id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.SuccessfulTypingToastMessage.nativePhone",values:{singularType:(0,N().sN)(n),databaseName:i.getName()||p.formatMessage(te.defaultCollectionName),span:e=>(0,u.jsx)("span",{children:e}),a:e=>(0,u.jsx)("a",{style:v.a,href:f,children:e})}}):(0,u.jsx)(l()._H,{defaultMessage:"<span>{databaseName} has been turned into a {singularType} database. You will now be able to see your assigned tasks in <a>Home</a>.</span>",id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.SuccessfulTypingToastMessage",values:{singularType:(0,N().sN)(n),databaseName:i.getName()||p.formatMessage(te.defaultCollectionName),span:e=>(0,u.jsx)("span",{children:e}),a:e=>(0,u.jsx)("a",{style:v.a,href:c,children:e})}});L().d4({item:{label:o,durationMs:W().JY},undoFunc:()=>{D().createAndCommit({environment:m,userAction:"CollectionTypedDatabaseMigrationModal.TypedDBConversionToast.Undo",canUndo:!0,perform:e=>{V().RQ({environment:m,collectionContextStore:t,transaction:e})}})}})}})}),[t,ee,m,n,C,h,p,v.a]);return(0,u.jsxs)("div",{style:c,children:[(0,u.jsxs)("div",{style:v.formTitle,children:[g?(0,u.jsx)("span",{style:v.emojiTitle,children:"📋"}):null,(0,u.jsx)(x().Z,{style:v.propertyMappingInstructions,isMultiline:!0,children:(0,u.jsx)(l()._H,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.Title",defaultMessage:"Task databases require status, assignee, and due date properties."})})]}),g?(0,u.jsx)(b().Z,{size:16}):null,Object.entries(T).map((e=>{let[t,n]=e;return ae(t)})),(0,u.jsxs)("div",{style:v.buttons,children:[(0,u.jsx)(J().Z,{style:v.submitMigrationButton,onClick:re,children:(0,u.jsx)(l()._H,{defaultMessage:"Turn into {type} database",id:"CollectionTypedDatabaseMigrationModal.ConfirmMigration.Title",values:{type:(0,N().sN)(n)}})}),g?(0,u.jsx)(z().D,{style:v.closeButton,onClick:()=>d().Z.reset(),children:(0,u.jsx)(l()._H,{id:"CollectionTypedDatabaseMigrationModal.Close",defaultMessage:"Close"})}):(0,u.jsx)(X().Z,{title:(0,u.jsx)(l()._H,{id:"CollectionTypedDatabaseMigrationModal.Info",defaultMessage:"Learn about {type} databases",values:{type:(0,N().sN)(n)}}),analyticsFrom:"set_database_type",href:K().su,style:v.learnMore,buttonStyle:v.learnMoreButton})]})]})}const te=(0,l().vU)({createNew:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CreateNew",defaultMessage:"Create new"},select:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.Select",defaultMessage:"Select..."},defaultCollectionName:{id:"CollectionTypedDatabaseMigrationModal.PropertyMappingToastSuccess.DefaultCollectionName",defaultMessage:"This database"},taskStatus:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskStatus",defaultMessage:"status"},taskAssignee:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskAssignee",defaultMessage:"assignee"},taskDueDate:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskDueDate",defaultMessage:"due date"}}),ne={[s().Es.Status]:te.taskStatus,[s().Es.Assign]:te.taskAssignee,[s().Es.DueDate]:te.taskDueDate};var oe=()=>n(708518),ie=()=>n(764767);const ae=32;function re(){const e=ce(),t=(0,i().Fy)(),n=(0,a().Kw)(d().Z);return n.isModalOpen?t.isPhone?(0,u.jsx)(ie().n,{fullscreen:!0,innerStyle:e.phoneInner,renderInner:()=>(0,u.jsx)(de,{collectionContextStore:n.collectionContextStore})}):(0,u.jsx)(oe().Z,{open:!0,onDismiss:()=>d().Z.reset(),innerStyle:e.desktopInner,render:()=>(0,u.jsx)(le,{collectionContextStore:n.collectionContextStore})}):null}const se=450;function le(e){const t=ce();return(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",position:"relative"},children:[(0,u.jsxs)("div",{style:t.title,children:[(0,u.jsx)("span",{style:t.emojiTitle,children:"📋"}),(0,u.jsx)(x().Z,{isMultiline:!0,style:t.previewTitle,children:(0,u.jsx)(l()._H,{id:"CollectionTypedDatabaseMigrationModal.AssignedToMePreview.Description",defaultMessage:"See all your tasks across multiple databases in your personal Home."})})]}),(0,u.jsx)(b().Z,{size:36}),(0,u.jsx)(C,{}),(0,u.jsx)(ee,{collectionContextStore:e.collectionContextStore,databaseType:s().Ym,containerStyle:t.form})]})}function de(e){const t=ce();return(0,u.jsx)(ee,{collectionContextStore:e.collectionContextStore,databaseType:s().Ym,containerStyle:t.phoneForm})}function ce(){return(0,r().yK)((e=>({desktopInner:{width:768,height:se,padding:ae},phoneInner:{width:"100%",height:"100%"},title:{display:"flex",maxWidth:"60%",alignItems:"center"},emojiTitle:{fontSize:36,marginRight:16},previewTitle:{color:e.regularTextColor,width:350,fontSize:17,fontWeight:500},form:{width:"45%",height:se,background:e.surface.wash,position:"absolute",top:-ae,right:-ae,padding:ae,zIndex:1,borderLeft:`1px solid ${e.tableDividerColor}`,overflowY:"auto"},phoneForm:{display:"flex",flexDirection:"column",width:"100%",height:"100%",padding:ae}})),[])}},795879:(e,t,n)=>{n.r(t),n.d(t,{default:()=>S});var o=n(667294),i=()=>n(219727),a=()=>n(846550),r=()=>n(195926),s=()=>n(788860),l=()=>n(707513),d=()=>n(81066),c=()=>n(903591),u=()=>n(997489),m=()=>n(667710),p=()=>n(265640),g=()=>n(906651),f=n(785893);function h(){const e=(0,i().O7)().currentUser.id;(0,o.useEffect)((()=>{if(!e)return;(0,c()._)(e);const t=window.setInterval((()=>{(0,c()._)(e)}),n(326966).A0);return()=>{window.clearInterval(t)}}),[e]);const t=(0,n(142735).VK)((()=>u().Z.state.open),[]),a=x();return(0,f.jsx)(n(840820).Z,{onDismiss:n(513670).ZT,render:()=>(0,f.jsx)("div",{style:a.modal,children:(0,f.jsxs)(n(251932).gq,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,f.jsx)("img",{style:a.image,src:n(714230).Z.images.feedbackThankYouPng}),(0,f.jsx)("div",{style:a.title,children:(0,f.jsx)(s()._H,{id:"cookieModal.requestConsent.title",defaultMessage:"Set your cookie preferences"})}),(0,f.jsx)("div",{style:a.description,children:(0,r().Fd)(d().Tz,"banner")}),(0,f.jsx)(v,{}),(0,f.jsx)(y,{}),(0,f.jsx)(b,{})]})}),isOpen:t})}function v(){const e=x(),t=(0,i().O7)();return(0,f.jsx)(g().Z,{isLarge:!0,style:e.acceptAllButton,onClick:()=>{d().a9(t,{necessary:!0,preference:!0,performance:!0,targeting:!0}),u().Z.setState({open:!1}),d().qo()},children:(0,f.jsx)(s()._H,{...r().ze.acceptAllButtonLabel})})}function y(){const e=x(),t=(0,i().O7)();return(0,f.jsx)(p().D,{size:"lg",isGray:!0,style:e.moreOptionsButton,onClick:()=>{d().a9(t,{necessary:!0,preference:!1,performance:!1,targeting:!1}),u().Z.setState({open:!1}),d().qo()},children:(0,f.jsx)(s()._H,{...r().ze.rejectAllButtonLabel})})}function b(){const e=x();return(0,f.jsx)(m().Z,{hasDismissButton:!0,onDismiss:()=>{u().Z.setState({open:!1})},renderOrigin:t=>(0,f.jsx)(p().D,{...t,size:"lg",isGray:!0,style:e.moreOptionsButton,children:(0,f.jsx)(s()._H,{...r().ze.moreOptionsButtonLabel})})})}function x(){return(0,a().yK)((e=>({modal:{maxWidth:400,padding:24},image:{height:100},title:{marginTop:8,color:e.regularTextColor,fontWeight:l().Ue.semibold,fontSize:18},description:{color:e.mediumTextColor,textAlign:"center",fontSize:14,marginTop:8,marginBottom:18},acceptAllButton:{width:"100%",marginBottom:6},moreOptionsButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"}})),[])}const S=o.memo(h)},55351:(e,t,n)=>{n.r(t),n.d(t,{default:()=>H});var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(593515),s=()=>n(670655),l=()=>n(104088),d=()=>n(876822),c=()=>n(144321),u=()=>n(482162),m=()=>n(846550),p=()=>n(109477),g=()=>n(305580),f=()=>n(843403),h=()=>n(535014),v=()=>n(698763),y=n(785893);const b={viewBox:"0 0 16 16",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("g",{clipPath:"url(#clip0_9208_17165)",children:(0,y.jsx)("path",{d:"M6.75 11.8a.55.55 0 0 1 .55-.55h7.8a.55.55 0 1 1 0 1.1H7.3a.55.55 0 0 1-.55-.55M5.6 7.57a.55.55 0 1 0 0 1.1h7.8a.55.55 0 1 0 0-1.1zm-1.7-3.7a.55.55 0 0 0 0 1.1h7.8a.55.55 0 1 0 0-1.1zm-1.3 3.7a.55.55 0 1 0 0 1.1h1a.55.55 0 1 0 0-1.1zM.35 4.42a.55.55 0 0 1 .55-.55h1a.55.55 0 0 1 0 1.1h-1a.55.55 0 0 1-.55-.55m3.95 6.83a.55.55 0 0 0 0 1.1h1a.55.55 0 1 0 0-1.1z"})}),(0,y.jsx)("defs",{children:(0,y.jsx)("clipPath",{id:"clip0_9208_17165",children:(0,y.jsx)("path",{d:"M16 0v16H0V0z"})})})]})},x=(0,n(827282).IU)("tableOfContentsSmall",b);var S=()=>n(326034),M=()=>n(788860),w=()=>n(707513),C=()=>n(421654),j=()=>n(636340),k=()=>n(269299),T=()=>n(594546),I=()=>n(352230),_=()=>n(57956),P=()=>n(265640),Z=()=>n(18748),A=()=>n(388284),R=()=>n(471645),B=()=>n(706003);const L=function(e){let{store:t,locked:o}=e;const s=(0,i().O7)(),l=(0,M().YB)(),d=(0,a().qz)(void 0,n(385021).Z),{device:c}=s,u=(0,a().VK)((()=>t.isExternalObjectInstancePageBlockStore()),[t]);let m;m=c.isMobile?{menuType:I().o.Modal,right:(0,y.jsx)(n(470386).DoneMenuText,{}),onClickRight:r().xv,title:l.formatMessage({id:"customizePageMenu.mobileHeader.label",defaultMessage:"Customize page"})}:{menuType:I().o.Popup,minWidth:300};const f=(0,a().VK)((()=>function(e,t){const n=e.getFormat();if(!t)return{};const o=(0,g().i)(n,t,void 0,p().j5.Collection);return o}(t,t.getSchema())),[t]),h=(0,a().VK)((()=>d.state.justUnlocked),[d]);return(0,y.jsxs)(n(198829).Z,{...m,children:[(o||h)&&(0,y.jsx)(F,{lockStore:d}),(0,y.jsx)(D,{store:t,locked:o,lockStore:d,format:f,isSyncedCollection:u,device:c})]})};function D(e){let{format:t,isSyncedCollection:n,store:o,locked:i,lockStore:r,device:l}=e;const d=(0,a().VK)((()=>o.getSchema()),[o]),c=function(e){return{propertyVisibility:e.property_visibility,pageSectionVisibility:e.page_section_visibility}}(t),{pageSectionVisibility:u}=c,m=(0,a().VK)((()=>(0,s().Fl)(u)),[u]),p=(0,a().VK)((()=>o.isCollectionView()),[o]),g=!l.isMobile&&!p;if(!d||!o)return null;if(!c)return null;if(!u)return null;const f={topLevelDiscussions:!n,backLinks:!0,floatingTableOfContents:g,pageComments:!n},h={locked:i,store:o,format:t},v=(0,y.jsxs)(y.Fragment,{children:[f.backLinks&&(0,y.jsx)(O,{...h}),f.topLevelDiscussions&&(0,y.jsx)(V,{pageVisibility:u.comments,...h}),f.floatingTableOfContents&&(0,y.jsx)(U,{pageVisibility:u.comments,...h,store:o}),f.pageComments&&(0,y.jsx)(N,{pageVisibility:m,...h})]});return(0,y.jsx)(A().Z,{style:{opacity:i?.5:1},children:(0,y.jsx)("div",{style:{marginLeft:8},children:v})})}function V(e){let{pageVisibility:t,locked:n,store:a,format:s}=e;const l=(0,i().O7)(),d="section_show"===t,c=(0,o.useCallback)((()=>{const e="section_show"===t?"section_hide":"section_show";r().W4({environment:l,pageSection:"comments",visibility:e,store:a,format:s})}),[l,s,t,a]),u=(0,m().yK)((()=>({switcherButtonContainer:{marginRight:4}})),[]);return(0,y.jsx)(Z().ZP,{title:(0,y.jsx)(M()._H,{id:"customizePageMenu.pageSections.pageCommentsSwitcherTitle",defaultMessage:"Page discussions"}),icon:(0,v().s)({height:16,width:16}),right:(0,y.jsx)("div",{style:u.switcherButtonContainer,children:(0,y.jsx)(R().Z,{disabled:n,on:d,onClick:c})})})}function O(e){let{locked:t,store:n,format:o}=e;const{backlinksVisibility:i,updateBacklinksVisibility:a}=(0,_().F6)({store:n,format:o});return(0,y.jsx)(Z().ZP,{title:(0,y.jsx)(M()._H,{id:"customizePageMenu.pageSections.backlinksSwitcherTitle",defaultMessage:"Backlinks"}),icon:(0,f().J)({height:16,width:16,transform:"rotate(180deg)"}),right:(0,y.jsx)(B().nm,{currentVisibility:i,onSelect:a,disabled:t})})}function U(e){let{pageVisibility:t,locked:n,store:r,format:s}=e;const l=(0,m().yK)((()=>({switcherButtonContainer:{marginRight:4}})),[]),d=(0,i().O7)(),c=(0,a().VK)((()=>{var e;return"off"!==(null===(e=r.getModel())||void 0===e?void 0:e.getFloatingTableOfContentsState())}),[r]),u=(0,o.useCallback)((()=>{k().createAndCommit({userAction:"CustomizePageMenu.handleToggleLockClick",environment:d,canUndo:!0,perform:e=>{j().sW({store:r.getFormatStore(),data:{page_floating_table_of_contents:{state:c?"off":"minimal"}},transaction:e})}}),(0,T().j)({environment:d,event:{eventName:"edit_page_table_of_contents_toggle",eventProperties:{is_table_of_contents_on:!c}}})}),[r,d,c]);return(0,y.jsx)(Z().ZP,{title:(0,y.jsx)(M()._H,{id:"action.floatingTableOfContents.name",defaultMessage:"Table of contents"}),icon:x({height:16,width:16}),right:(0,y.jsx)("div",{style:l.switcherButtonContainer,children:(0,y.jsx)(R().Z,{disabled:n,on:c,onClick:u})})})}function N(e){let{pageVisibility:t,locked:n,store:o,format:a}=e;const s=(0,i().O7)();return(0,y.jsx)(Z().ZP,{title:(0,y.jsx)(M()._H,{id:"customizePageMenu.pageSections.inlineCommentsTitle",defaultMessage:"Inline comments"}),icon:(0,v().s)({height:16,width:16}),right:(0,y.jsx)(B().k7,{currentVisibility:t,disabled:n,onSelect:e=>{r().W4({environment:s,pageSection:"margin_comments",visibility:e,store:o,format:a})}})})}function F(e){let{lockStore:t}=e;const n=(0,m().Fg)(),r=(0,i().O7)(),l=(0,o.useCallback)((()=>function(e,t){const n=s().$0();if(!n)return!1;const o=n.getParentBlockStore();o&&(k().createAndCommit({userAction:"CustomizePageMenu.handleToggleLockClick",environment:e,canUndo:!0,perform:t=>{C().Wq({environment:e,store:o,isLocked:!s().p1(),transaction:t})}}),t.setState({justUnlocked:!t.state.justUnlocked}))}(r,t)),[r,t]),d=(0,a().VK)((()=>t.state.justUnlocked),[t]);return(0,y.jsxs)("div",{style:{fontSize:12,display:"flex",justifyContent:"center",alignItems:"center",borderTop:`1px solid ${n.regularDividerColor}`,borderBottom:`1px solid ${n.regularDividerColor}`,background:n.surface.wash,color:n.mediumTextColor,paddingTop:6,paddingBottom:6},children:[(0,y.jsx)("span",{style:{display:"inline-block",verticalAlign:"middle",paddingRight:6},children:d?(0,S().U)({height:12,width:12,fill:n.mediumIconColor}):(0,h().b)({height:12,width:12,fill:n.mediumIconColor})}),d?(0,y.jsx)(M()._H,{id:"customizePageMenu.unlocked.header",defaultMessage:"Settings unlocked on parent database."}):(0,y.jsx)(M()._H,{id:"customizePageMenu.locked.header",defaultMessage:"Settings locked on parent database."}),(0,y.jsx)(P().D,{style:{fontSize:12,color:n.mediumTextColor,fontWeight:w().Ue.semibold,marginLeft:2,paddingLeft:4,paddingRight:4,height:20},onClick:l,children:d?(0,y.jsx)(M()._H,{id:"customizePageMenu.lock.label",defaultMessage:"Re-lock"}):(0,y.jsx)(M()._H,{id:"customizePageMenu.unlock.label",defaultMessage:"Unlock"})})]})}const H=function(){const e=(0,i().O7)(),{device:t}=e,o=(0,a().Kw)(c().Z);return(0,y.jsx)(n(967092).ZP,{popupType:t.isMobile?l().k.SlideUp:l().k.Popup,alignmentToOrigin:n(998901).Alignment.Center,open:o.isOpen,render:()=>(0,y.jsx)(K,{}),originRect:o.isOpen?o.rect:void 0,onDismiss:()=>r().xv()})};function K(){const e=(0,a().Kw)(c().Z),t=(0,a().VK)((()=>u().default.state.open&&u().default.state.targetStore||d().default.state.mainEditorCurrentBlockStore),[]),n=(0,a().VK)((()=>s().p1()),[]);return e.isOpen&&t?(0,y.jsx)(L,{store:t,locked:n}):null}},277650:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Se});var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(846550),s=()=>n(874459),l=()=>n(998411),d=()=>n(788860),c=()=>n(352230),u=()=>n(10271),m=()=>n(793504),p=()=>n(69870),g=()=>n(206352),f=()=>n(198829),h=()=>n(388284),v=()=>n(730120),y=()=>n(146947),b=()=>n(803021),x=()=>n(568017),S=()=>n(696459),M=()=>n(933696),w=()=>n(312117),C=()=>n(963979),j=()=>n(589024);const k=Object.freeze({backgroundColor:x().ZP.blue,color:x().ZP.white}),T=Object.freeze({backgroundColor:x().ZP.blueWithAlpha(.43)});function I(e,t){switch(e){case m().pd.InvalidDate:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateError.tooltip",defaultMessage:"Invalid date"});case m().pd.InvalidRange:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateOrTimeRangeError.tooltip",defaultMessage:"Invalid range"});case m().pd.InvalidTime:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidTimeError.tooltip",defaultMessage:"Invalid time"});default:return}}function _(e,t,n){return void 0===e||"relative"===e||"ll"===e?b().oq(L(n,t)):b().jG(e)}function P(e,t){return e&&(e!==b().n3||t)?b()._F(e):b().Sc}function Z(){return(0,C().E)(y().locale).time}function A(e,t,n){return(0,w().$v)(e,P(t,!1),n)}function R(e,t,n,o,i){return o.device.isMobile?(0,w().f_)(e,s().Iq,t):(0,w().f_)(e,_(n,t,i),t)}function B(e,t,n,o){return!e||"number"==typeof e&&isNaN(e)?t&&(0,j().xE)(t)?function(e,t){var n,o;const i=(null==t||null===(n=t.getPropertyTypeSpecificConfig("date"))||void 0===n?void 0:n.endDate)??!1,a=(null==t||null===(o=t.getPropertyTypeSpecificConfig("date"))||void 0===o?void 0:o.includeTime)??!1,r=s().kT({timezone:(0,l().r)()});if(i&&a)return s().iC(r.startOf("day").valueOf(),r.startOf("day").valueOf(),(0,l().r)());if(i)return s().fZ(r.valueOf(),r.valueOf(),(0,l().r)());if(a)return s().LH(r.startOf("day"));return e}(n,o):n:e}function L(e,t){return e||t.locale}function D(e,t,n){return"date"===e.type?{...e,type:"daterange",end_date:t||e.start_date}:"datetime"===e.type?{...e,type:"datetimerange",end_date:t||e.start_date,end_time:n||e.start_time}:void(0,S().t1)(e)}var V=n(785893);function O(e){let{store:t,dateValue:n,disabled:i,firstDayOfWeek:r,onChangeValue:d}=e;const{focus:c,currentMonth:u}=(0,a().VK)((()=>({focus:t.state.focus,currentMonth:t.state.currentMonth})),[t]),p=s().NK(n,(0,l().r)()),g=u||p.start,f=p.start.toJSDate(),h=c===m().Hv.StartDate||c===m().Hv.StartTime,w=(0,o.useCallback)(((e,o,a)=>{if(i)return;const r=v().ou.fromJSDate(e).setLocale(b().ah).toFormat(s().Iq);if(a.shiftKey&&("date"===n.type||"datetime"===n.type)){const e=D(n,r);return null==d||d(e),void t.setState({...t.state,focus:m().Hv.EndDate})}let u;if(b().h(n)||b().qg(n)){c===m().Hv.StartDate||c===m().Hv.StartTime?u={...n,start_date:r}:c===m().Hv.EndDate||c===m().Hv.EndTime?u={...n,end_date:r}:(0,S().t1)(c);const e=s().NK(u,(0,l().r)());e.end<e.start&&(b().h(u)?u={...u,start_date:u.end_date,end_date:u.start_date}:b().qg(u)?u={...u,start_date:u.end_date,start_time:u.end_time,end_date:u.start_date,end_time:u.start_time}:(0,S().t1)(u),t.setState({...t.state,focus:c===m().Hv.StartDate||c===m().Hv.StartTime?m().Hv.EndDate:m().Hv.StartDate})),t.setState({...t.state,focus:c===m().Hv.StartDate||c===m().Hv.StartTime?m().Hv.EndDate:m().Hv.StartDate})}else u={...n,start_date:r};t.setState({...t.state,error:{...t.state.error,[c]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[c]:void 0}}),null==d||d(u)}),[n,i,c,d,t]),C=(0,o.useCallback)((e=>{t.setState({...t.state,currentMonth:v().ou.fromJSDate(e)})}),[t]),j=(0,o.useMemo)((()=>{if(p.end){const e=p.end.toJSDate();return{modifiers:{range:{from:f,to:e},...h?{end:e,start:f}:{start:f,end:e}},modifiersStyles:{range:{backgroundColor:x().ZP.blueWithAlpha(.15)},start:h?k:T,end:h?T:k}}}return{selected:f,modifiers:{start:f},modifiersStyles:{start:k}}}),[p.end,f,h]);return(0,V.jsx)(M().y,{className:"notion-date-property-menu notranslate",numberOfMonths:1,weekStartsOn:r,defaultMonth:g.toJSDate(),month:g.toJSDate(),locale:y().locale,showOutsideDays:!0,fixedWeeks:!0,onDayClick:w,onMonthSelected:C,...j})}var U=()=>n(827973);function N(e){let{onChangeValue:t}=e;const n=(0,o.useCallback)((()=>{null==t||t(void 0)}),[t]);return(0,V.jsx)(U().Z,{focused:!1,onClick:n,title:(0,V.jsx)(d()._H,{defaultMessage:"Clear",id:"LuxonDatePropertyMenu.clearButton.label"})})}var F=()=>n(471645);function H(e){let{dateValue:t,onChangeValue:n}=e;const i=(0,o.useCallback)((()=>{if("date"===t.type){const e={type:"datetime",start_date:t.start_date,start_time:"00:00",time_zone:(0,l().r)(),reminder:t.reminder&&b().AE(t.reminder)};null==n||n(e)}else if("daterange"===t.type){const e={type:"datetimerange",start_date:t.start_date,start_time:"00:00",end_date:t.end_date,end_time:"00:00",time_zone:(0,l().r)(),reminder:t.reminder&&b().AE(t.reminder)};null==n||n(e)}else if("datetime"===t.type){const e={type:"date",start_date:t.start_date,reminder:t.reminder&&b().wg(t.reminder,(0,l().r)())};null==n||n(e)}else{const e={type:"daterange",start_date:t.start_date,end_date:t.end_date,reminder:t.reminder&&b().wg(t.reminder,(0,l().r)())};null==n||n(e)}}),[t,n]);return(0,V.jsx)(U().Z,{focused:!1,onClick:i,title:(0,V.jsx)(d()._H,{defaultMessage:"Include time",id:"LuxonDatePropertyMenu.menuItem.includeTime.label"}),right:(0,V.jsx)(F().Z,{on:"date"!==t.type&&"daterange"!==t.type,onClick:i})})}function K(e){let{dateValue:t,onChangeValue:n}=e;const i=(0,o.useCallback)((()=>{if("datetimerange"===t.type){const e={type:"datetime",start_date:t.start_date,start_time:t.start_time,time_zone:t.time_zone,reminder:t.reminder};null==n||n(e)}else if("daterange"===t.type){const e={type:"date",start_date:t.start_date,reminder:t.reminder};null==n||n(e)}else{const e=D(t);null==n||n(e)}}),[t,n]);return(0,V.jsx)(U().Z,{focused:!1,onClick:i,title:(0,V.jsx)(d()._H,{defaultMessage:"End date",id:"LuxonDatePropertyMenu.menuItem.endDate.label"}),right:(0,V.jsx)(F().Z,{on:"daterange"===t.type||"datetimerange"===t.type,onClick:i})})}n(241792);const E=(0,d().vU)({none:{defaultMessage:"None",id:"dateFormatHelpers.reminderMenuItems.none"},onTheDay:{defaultMessage:"On day of event {formattedTimeText}",id:"dateFormatHelpers.reminderMenuItems.onTheDayOfEvent"},hoursBefore:{defaultMessage:"{numberOfHours, plural, one {{numberOfHours} hour before} other {{numberOfHours} hours before}}",id:"dateFormatHelpers.reminderMenuItems.hoursBefore"},minutesBefore:{defaultMessage:"{numberOfMinutes, plural, one {{numberOfMinutes} minute before} other {{numberOfMinutes} minutes before}}",id:"dateFormatHelpers.reminderMenuItems.minutesBefore"},yearsBefore:{defaultMessage:"{numberOfYears, plural, one {{numberOfYears} year before {formattedTimeText}} other {{numberOfYears} years before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.yearsBefore"},daysBefore:{defaultMessage:"{numberOfDays, plural, one {{numberOfDays} day before {formattedTimeText}} other {{numberOfDays} days before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.daysBefore"},monthsBefore:{defaultMessage:"{numberOfMonths, plural, one {{numberOfMonths} month before {formattedTimeText}} other {{numberOfMonths} months before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.monthsBefore"},weeksBefore:{defaultMessage:"{numberOfWeeks, plural, one {{numberOfWeeks} week before {formattedTimeText}} other {{numberOfWeeks} weeks before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.weeksBefore"},atTimeOf:{defaultMessage:"At time of event",id:"dateFormatHelpers.reminderMenuItems.atTimeOfEvent"}});function W(e){const{reminder:t,shouldShowTime:n,intl:o,formatTime:i}=e;if(!t)return o.formatMessage(E.none);if(b().vJ(t)){const{unit:e,value:a,time:r}=t,s=i({start_time:r,time_format:"LT",humanReadable:!0,intl:o}),l=n?`(${s})`:"";return 0===a?o.formatMessage(E.onTheDay,{formattedTimeText:l}):"day"===e?o.formatMessage(E.daysBefore,{formattedTimeText:l,numberOfDays:a}):"year"===e?o.formatMessage(E.yearsBefore,{formattedTimeText:l,numberOfYears:a}):"month"===e?o.formatMessage(E.monthsBefore,{formattedTimeText:l,numberOfMonths:a}):o.formatMessage(E.weeksBefore,{formattedTimeText:l,numberOfWeeks:a})}{const{unit:e,value:n}=t;return 0===n?o.formatMessage(E.atTimeOf):"hour"===e?o.formatMessage(E.hoursBefore,{numberOfHours:n}):o.formatMessage(E.minutesBefore,{numberOfMinutes:n})}}var z=()=>n(646574),G=()=>n(471500),q=()=>n(491927),Y=()=>n(448419),$=()=>n(431652),J=()=>n(255577);function Q(e){let{dateValue:t,onChangeValue:n}=e;const a=(0,i().O7)(),{device:r}=a,s=(0,d().YB)(),u=(0,o.useCallback)((e=>{e?b().vJ(e)?null==n||n({...t,reminder:{...e,defaultTimeZone:(0,l().r)()}}):"datetime"!==t.type&&"datetimerange"!==t.type||null==n||n({...t,reminder:e}):null==n||n({...t,reminder:e}),q().IM(a,{date:t,reminder:e})}),[t,a,n]),m=(0,o.useCallback)((e=>(0,V.jsx)($().X,{...e,icon:(0,G().m)({width:14}),title:(0,V.jsx)(d()._H,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.menuItem.remind.label"}),focused:!1,showExtensionArrow:r.isMobile,right:W({reminder:t.reminder,intl:s,formatTime:z().mr})})),[t.reminder,r.isMobile,s]),p=(0,o.useCallback)((e=>{let n;n=r.isMobile?{menuType:c().o.Modal,title:(0,V.jsx)(d()._H,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.mobileRemindModal.title"}),right:(0,V.jsx)(d()._H,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneReminderButton.label"}),onClickRight:e.close}:{menuType:c().o.Popup,width:250};const o=("date"===t.type||"daterange"===t.type?b().PI:b().dG).map((t=>{const n=W({reminder:t,shouldShowTime:!0,intl:s,formatTime:z().mr});return{key:n,action:()=>{u(t),e.close()},render:e=>(0,V.jsx)(U().Z,{...e,title:n})}}));return(0,V.jsx)(f().Z,{...n,children:(0,V.jsx)(J().ZP,{type:J().iW.Vertical,sections:[{key:"reminder section",render:e=>(0,V.jsx)(h().Z,{...e}),items:o}],initialFocus:void 0})})}),[t.type,r.isMobile,s,u]);return(0,V.jsx)(Y().ZP,{popupType:r.isMobile?Y().Z4.SlideUp:Y().Z4.Popup,placementToOrigin:Y().pO.Right,renderOrigin:m,render:p})}function X(e){let{dateValue:t,shouldShowReminder:n,shouldShowEndDateControl:o,shouldShowAllDayControl:a,onChangeValue:r}=e;return(0,i().Fy)().isMobile?n||o||a?(0,V.jsxs)(h().Z,{topBorder:!0,children:[n&&(0,V.jsx)(Q,{dateValue:t,onChangeValue:r}),o&&(0,V.jsx)(K,{dateValue:t,onChangeValue:r}),a&&(0,V.jsx)(H,{dateValue:t,onChangeValue:r})]}):null:(0,V.jsxs)(V.Fragment,{children:[n&&(0,V.jsx)(h().Z,{topBorder:!0,children:(0,V.jsx)(Q,{dateValue:t,onChangeValue:r})}),(o||a)&&(0,V.jsxs)(h().Z,{topBorder:!0,children:[o&&(0,V.jsx)(K,{dateValue:t,onChangeValue:r}),a&&(0,V.jsx)(H,{dateValue:t,onChangeValue:r})]})]})}var ee=()=>n(91253),te=()=>n(397540);function ne(e){let{dateFormat:t,onChangeDateFormat:n}=e;const i=(0,d().YB)(),a=t||b().sF,r=(0,o.useCallback)((e=>e),[]),s=(0,o.useCallback)((e=>{null==n||n(e)}),[n]),l=(0,o.useCallback)((e=>(0,V.jsx)(U().Z,{...e,title:i.formatMessage(b().fy[e.value])})),[i]),c=(0,o.useCallback)((e=>(0,V.jsx)($().X,{...e,focused:!1,title:(0,V.jsx)(d()._H,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.menuItem.format.label"}),right:a?i.formatMessage(b().fy[a]):(0,V.jsx)(d()._H,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.formatMenu.emptyButton.label"})})),[a,i]),u=(0,o.useMemo)((()=>({menuTitle:i.formatMessage({defaultMessage:"Date format",id:"LuxonDatePropertyMenu.dateFormatDropdownButton.label"}),items:b().Zy,getKey:r,selectedItem:a,onSelect:s,renderItem:l,renderOrigin:c})),[a,r,i,s,l,c]);return(0,V.jsx)(te().Z,{...u})}function oe(e){let{dateValue:t,timeFormat:n,onChangeTimeFormat:i}=e;const a=(0,d().YB)(),r="date"===t.type||"daterange"===t.type,s=P(n,!0),l=function(e){const t=P(e,!0),n=Z();for(const o in n)if(n[o]===t)return o;return"12h"}(n),c=Z(),u=(0,o.useCallback)((e=>e),[]),m=(0,o.useCallback)((e=>{const t=c[e];null==i||i(t)}),[i,c]),p=(0,o.useCallback)((e=>(0,V.jsx)(U().Z,{...e,title:a.formatMessage(b().Fi[e.value])})),[a]),g=(0,o.useCallback)((e=>(0,V.jsx)($().X,{...e,focused:!1,title:(0,V.jsx)(d()._H,{defaultMessage:"Time format",id:"LuxonDatePropertyMenu.menuItem.timeFormat.label"}),disabled:r,right:!r&&(s?a.formatMessage(b().Fi[l]):(0,V.jsx)(d()._H,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.timeFormatMenu.emptyButton.label"}))})),[a,r,l,s]),f=(0,o.useMemo)((()=>({menuTitle:a.formatMessage({defaultMessage:"Time format",id:"LuxonDatePropertyMenu.timeFormatMenu.title"}),items:b().L7,selectedItem:l,disabled:r,getKey:u,onSelect:m,renderItem:p,renderOrigin:g})),[u,a,r,m,p,g,l]);return(0,V.jsx)(te().Z,{...f})}function ie(e){const{dateValue:t,dateFormat:n,timeFormat:a,onChangeDateFormat:r,onChangeTimeFormat:u,onChangeValue:m}=e,p=(0,i().Fy)(),g=!C().S.includes(y().locale),v="date"===t.type||"daterange"===t.type,b="datetime"===t.type||"datetimerange"===t.type?t.time_zone:(0,l().r)(),x=(0,o.useCallback)((e=>{if("datetime"===t.type||"datetimerange"===t.type){const n={...t,time_zone:e};null==m||m(n)}}),[t,m]);return(0,V.jsxs)(V.Fragment,{children:[!v&&(0,V.jsx)(ee().X,{enableRecents:!0,placementToOrigin:Y().pO.Right,currentValue:b,onSelect:x,renderOrigin:e=>(0,V.jsx)($().X,{...e,title:(0,V.jsx)(d()._H,{defaultMessage:"Timezone",id:"datePropertyMenuFormatAndTimezone.timezone.label"}),focused:!1,right:!v&&s().er(b),chevronType:"right"})}),(0,V.jsx)(Y().ZP,{popupType:p.isMobile?Y().Z4.SlideUp:Y().Z4.Popup,placementToOrigin:Y().pO.Right,renderOrigin:e=>(0,V.jsx)(U().Z,{...e,title:(0,V.jsx)(d()._H,{defaultMessage:"Date format",id:"datePropertyMenuFormatAndTimezone.dateFormat.label"}),focused:!1,showExtensionArrow:!0}),render:e=>{let o;return o=p.isMobile?{menuType:c().o.Modal,title:(0,V.jsx)(d()._H,{defaultMessage:"Date format",id:"datePropertyMenuFormatAndTimezone.dateFormat.title"}),right:(0,V.jsx)(d()._H,{defaultMessage:"Done",id:"datePropertyMenuFormatAndTimezone.dateFormat.doneButton"}),onClickRight:e.close}:{menuType:c().o.Popup,width:250},(0,V.jsx)(f().Z,{...o,children:(0,V.jsxs)(h().Z,{children:[(0,V.jsx)(ne,{dateFormat:n,onChangeDateFormat:r}),g&&(0,V.jsx)(oe,{dateValue:t,timeFormat:a,onChangeTimeFormat:u})]})})}})]})}var ae=()=>n(326966),re=()=>n(998901),se=()=>n(291198),le=()=>n(654133);const de=12;function ce(e){let{store:t,disabled:n,locale:c,format:u,dateFormat:p,timeFormat:g,dateValue:f,formQuestionStore:h,onChangeValue:v}=e;const y=(0,i().O7)(),{device:x,WindowSizeStore:M}=y,w=(0,d().YB)(),{focus:C,inputTemporaryValue:k,error:T}=(0,a().VK)((()=>({focus:t.state.focus,inputTemporaryValue:t.state.inputTemporaryValue,error:t.state.error})),[t]),{formQuestionHasEndDate:I,formQuestionIncludesTime:_}=(0,a().VK)((()=>{var e,t;return{formQuestionHasEndDate:(null==h||null===(e=h.getPropertyTypeSpecificConfig("date"))||void 0===e?void 0:e.endDate)??!1,formQuestionIncludesTime:(null==h||null===(t=h.getPropertyTypeSpecificConfig("date"))||void 0===t?void 0:t.includeTime)??!1}}),[h]),P=(0,o.useMemo)((()=>s().NK(f,(0,l().r)(),L(c,w))),[f,c,w]),Z=u&&(0,j().xE)(u)?_:"datetime"===f.type||"datetimerange"===f.type,B=u&&(0,j().xE)(u)?I:"daterange"===f.type||"datetimerange"===f.type,D=(0,o.useCallback)((()=>{const e=t.state.inputTemporaryValue.startDate;if(!e)return;const n=R(e,w,p,y,c);if(!n)return m().pd.InvalidDate;const o={...f,start_date:n},i=s().XI(o);if(!i)return m().pd.InvalidRange;t.setState({...t.state,currentMonth:i.start,error:{...t.state.error,[m().Hv.StartDate]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[m().Hv.StartDate]:void 0}}),null==v||v(o)}),[p,f,y,w,c,v,t]),O=(0,o.useCallback)((()=>{const e=t.state.inputTemporaryValue.startTime;if(!e)return;const n=A(e,g,w);if(!n)return m().pd.InvalidTime;if(b().qg(f)){const{newDate:e,currentMonth:o}=s().vz({previous:f,updatedStartTime:n});t.setState({...t.state,currentMonth:o,error:{...t.state.error,[m().Hv.StartTime]:void 0,[m().Hv.EndDate]:void 0,[m().Hv.EndTime]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[m().Hv.StartTime]:void 0}}),null==v||v(e)}else{if(!b().v9(f))return m().pd.InvalidTime;{const e={...f,start_time:n},o=s().XI(e);t.setState({...t.state,currentMonth:o.start,error:{...t.state.error,[m().Hv.StartTime]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[m().Hv.StartTime]:void 0}}),null==v||v(e)}}}),[f,w,v,t,g]),U=(0,o.useCallback)((()=>{const e=t.state.inputTemporaryValue.endDate;if(!e)return;const n=R(e,w,p,y,c);if(!n)return m().pd.InvalidDate;if(!b().h(f)&&!b().qg(f))return;const o={...f,end_date:n},i=s().XI(o);if(!i)return m().pd.InvalidRange;t.setState({...t.state,currentMonth:i.end,error:{...t.state.error,[m().Hv.EndDate]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[m().Hv.EndDate]:void 0}}),null==v||v(o)}),[p,f,y,w,c,v,t]),N=(0,o.useCallback)((()=>{const e=t.state.inputTemporaryValue.endTime;if(!e)return;const n=A(e,g,w);if(!n)return m().pd.InvalidTime;if(!b().qg(f))return;const o={...f,end_time:n},i=s().XI(o);if(!i)return m().pd.InvalidRange;t.setState({...t.state,currentMonth:i.end,error:{...t.state.error,[m().Hv.EndTime]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[m().Hv.EndTime]:void 0}}),null==v||v(o)}),[f,w,v,t,g]),F=(0,o.useCallback)((()=>{t.setState({...t.state,focus:m().Hv.StartDate,inputIsFocused:!0,currentMonth:P.start})}),[P.start,t]),H=(0,o.useCallback)((()=>{t.setState({...t.state,focus:m().Hv.StartTime,inputIsFocused:!0,currentMonth:P.start})}),[P.start,t]),K=(0,o.useCallback)((()=>{P.end&&t.setState({...t.state,focus:m().Hv.EndDate,inputIsFocused:!0,currentMonth:P.end})}),[P.end,t]),E=(0,o.useCallback)((()=>{P.end&&t.setState({...t.state,focus:m().Hv.EndTime,inputIsFocused:!0,currentMonth:P.end})}),[P.end,t]),W=(0,o.useCallback)((()=>{let e;if(t.state.focus===m().Hv.StartDate)e=D();else if(t.state.focus===m().Hv.StartTime)e=O();else if(t.state.focus===m().Hv.EndDate)e=U();else{if(t.state.focus!==m().Hv.EndTime)return(0,S().t1)(t.state.focus);e=N()}e?t.setState({...t.state,error:{...t.state.error,[t.state.focus]:e}}):t.setState({...t.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},inputIsFocused:!1,error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})}),[U,N,D,O,t]),z=(0,o.useCallback)((e=>{t.setState({...t.state,inputTemporaryValue:{...t.state.inputTemporaryValue,[t.state.focus]:e.target.value||""}}),x.isAndroid&&W()}),[x.isAndroid,W,t]),[G,q]=(0,a().VK)((()=>[x.isMobile?M.getSafePaddingLeftCSS(16):14,x.isMobile?M.getSafePaddingRightCSS(16):14]),[x.isMobile,M]),Y=(0,r().yK)((e=>({container:{paddingTop:x.isMobile?16:8,paddingBottom:x.isMobile?16:8,paddingLeft:G,paddingRight:q,display:Z?"block":"flex",...x.isMobile&&{boxShadow:`\n\t\t\t\t\t\t\t0 1px 0 ${e.regularDividerColor}\n\t\t\t\t\t\t`,position:"relative",zIndex:2},background:x.isMobile?e.popoverBackground:void 0}})),[x.isMobile,G,q,Z]);return(0,V.jsxs)("div",{style:Y.container,children:[(0,V.jsx)(ue,{inputDateValue:k.startDate,inputTimeValue:k.startTime,rangeValue:P.start,disabled:n,dateError:T.startDate,timeError:T.startTime,isDateFocused:C===m().Hv.StartDate,isTimeFocused:C===m().Hv.StartTime,hasTime:Z,hasEndDate:B,locale:c,dateFormat:p,timeFormat:g,onChange:z,onDateFocus:F,onTimeFocus:H,onBlur:W,onSubmit:W}),B&&(0,V.jsx)("div",{style:{width:12,height:8}}),P.end&&(0,V.jsx)(ue,{inputDateValue:k.endDate,inputTimeValue:k.endTime,rangeValue:P.end,disabled:n,dateError:T.endDate,timeError:T.endTime,isDateFocused:C===m().Hv.EndDate,isTimeFocused:C===m().Hv.EndTime,hasTime:Z,hasEndDate:B,locale:c,dateFormat:p,timeFormat:g,onChange:z,onDateFocus:K,onTimeFocus:E,onBlur:W,onSubmit:W})]})}function ue(e){let{inputDateValue:t,inputTimeValue:n,rangeValue:a,disabled:l,dateError:c,timeError:u,isDateFocused:m,isTimeFocused:p,hasTime:g,hasEndDate:f,locale:h,dateFormat:v,timeFormat:y,onChange:x,onDateFocus:M,onTimeFocus:w,onBlur:C,onSubmit:j}=e;const k=(0,i().Fy)(),T=(0,d().YB)(),Z=(0,S().$K)(c)||(0,S().$K)(u),A=m||p,R=(0,r().yK)((e=>({input:me(k,e,Z,A,f),separator:{height:14,width:1,background:e.regularDividerColor,marginLeft:6,marginRight:12,flexShrink:0}})),[k,Z,A,f]),B=(0,o.useCallback)((()=>I(c,T)),[c,T]),L=(0,o.useCallback)((()=>I(u,T)),[u,T]),D=(0,o.useCallback)((()=>{if(k.isMobile){const e=(0,ae().z4)(t)?a.toFormat(s().Iq):t;return(0,V.jsx)(se().Z,{type:"date",format:se().B.Transparent,value:e,onChange:x,onFocus:M,onBlur:C,onSubmit:j,disabled:l,size:1})}{const e=(0,ae().z4)(t)?a.toFormat(_(v,T,h)):t;return(0,V.jsx)(se().Z,{selectAll:!0,format:se().B.Transparent,value:e,focusInitial:m,onChange:x,onFocus:M,onBlur:C,onSubmit:j,disabled:l,size:1})}}),[v,k.isMobile,l,C,x,M,j,t,T,m,h,a]),O=(0,o.useCallback)((()=>{if(k.isMobile){const e=(0,ae().z4)(n)?a.toFormat(b().jK):n;return(0,V.jsx)(se().Z,{type:"time",format:se().B.Transparent,value:e,onChange:x,onFocus:w,onBlur:C,onSubmit:j,size:1,disabled:l})}{const e=(0,ae().z4)(n)?a.toFormat(P(y,!1)):n;return(0,V.jsx)(se().Z,{format:se().B.Transparent,value:e,focusInitial:p,onChange:x,onFocus:w,onBlur:C,onSubmit:j,size:1,disabled:l})}}),[k.isMobile,l,C,x,j,w,n,p,a,y]);return(0,V.jsxs)("div",{style:R.input,children:[(0,V.jsx)(le().Z,{renderTooltip:B,originGap:de,forceVisibleState:(0,S().$K)(c),placement:re().Placement.Left,render:D}),g&&(0,V.jsx)("div",{style:R.separator}),g&&(0,V.jsx)(le().Z,{renderTooltip:L,originGap:de,forceVisibleState:(0,S().$K)(u),placement:re().Placement.Right,render:O})]})}function me(e,t,n,o,i){return{display:"flex",alignItems:"center",borderRadius:6,height:28,lineHeight:1.2,paddingLeft:8,paddingRight:8,flexBasis:"50%",flexGrow:1,fontSize:e.isMobile?16:14,...n?{background:x().ZP.redWithAlpha(.15),boxShadow:`inset 0 0 0 2px ${x().ZP.red}`}:o&&i?{background:x().ZP.blueWithAlpha(.15),boxShadow:`inset 0 0 0 2px ${x().ZP.blue}`}:{background:t.inputBackground,boxShadow:t.inputBoxShadow}}}var pe=()=>n(148126),ge=()=>n(508181),fe=()=>n(641481);function he(){return(0,i().Fy)().isMobile?(0,V.jsx)(fe().Z,{href:(0,pe().UY)("guides.reminders"),analyticsFrom:"date_selector"}):(0,V.jsx)(ge().Z,{title:(0,V.jsx)(d()._H,{defaultMessage:"Learn about reminders",id:"LuxonDatePropertyMenu.learnMore.helpButton.label"}),href:(0,pe().UY)("guides.reminders"),analyticsFrom:"date_selector"})}var ve=()=>n(727207),ye=()=>n(682518);function be(e){const{onChangeValue:t}=e,n=(0,d().YB)();return(0,V.jsx)(h().Z,{title:(0,V.jsx)(d()._H,{defaultMessage:"Shortcuts",id:"DatePropertyMenu.menuItem.shortcuts.label"}),children:["now","today"].map((e=>(0,V.jsx)(U().Z,{title:(0,V.jsx)(ye().w,{templateVariableType:e}),caption:(0,ve().Z0)(e,n),inline:!0,onClick:()=>{null==t||t(e)},focused:!1},`relative-date-shortcut-${e}`)))})}function xe(e){let{store:t,value:n,header:u,isTemplatePage:m,shouldShowReminder:g,shouldShowAllDayControl:v=!0,shouldShowEndDateControl:y=!0,shouldShowDateFormatControl:b=!0,canConfigureCollection:x,disabled:S,format:M,dateFormat:w,timeFormat:C,firstDayOfWeek:j,locale:k,formQuestionStore:T,onChangeValue:I,onChangeDateFormat:_,onChangeTimeFormat:P,onDismiss:Z}=e;const A=(0,i().Fy)(),R=(0,o.useMemo)((()=>s().Lg((0,l().r)())),[]),L=(0,a().VK)((()=>B(n,M,R,T)),[n,M,R,T]),D=(0,a().VK)((()=>t.state.inputIsFocused),[t]),U=(0,r().yK)((e=>({calendar:{padding:A.isMobile?"16px 14px 16px":"4px 0 4px",textAlign:"center",...A.isMobile&&{borderBottom:`1px solid ${e.regularDividerColor}`,background:e.popoverBackground}}})),[A.isMobile]),F=(0,o.useMemo)((()=>A.isMobile?{menuType:c().o.Modal,title:(0,V.jsx)(d()._H,{defaultMessage:"Date",id:"LuxonDatePropertyMenu.mobileDate.title"}),right:(0,V.jsx)(d()._H,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneButton.label"}),left:g?(0,V.jsx)(he,{}):void 0,onClickRight:Z,header:(0,V.jsx)(ce,{store:t,disabled:S,locale:k,format:M,dateFormat:w,timeFormat:C,dateValue:L,formQuestionStore:T,onChangeValue:I})}:{menuType:c().o.Popup,maxHeight:"none",width:270,header:u}),[A.isMobile,u,g,Z,t,S,k,M,w,C,L,T,I]);return(0,V.jsxs)(f().Z,{...F,children:[(0,V.jsx)(p().Z,{show:D}),m&&(0,V.jsx)(be,{onChangeValue:I}),(0,V.jsxs)(h().Z,{topBorder:!0,children:[!A.isMobile&&(0,V.jsx)(ce,{store:t,disabled:S,locale:k,format:M,dateFormat:w,timeFormat:C,dateValue:L,formQuestionStore:T,onChangeValue:I}),(0,V.jsx)("div",{style:U.calendar,children:(0,V.jsx)(O,{store:t,dateValue:L,firstDayOfWeek:j,disabled:S,onChangeValue:I})})]}),!S&&(0,V.jsx)(X,{dateValue:L,shouldShowReminder:g,shouldShowEndDateControl:y,shouldShowAllDayControl:v,onChangeValue:I}),!S&&x&&b&&(0,V.jsx)(h().Z,{topBorder:!0,children:(0,V.jsx)(ie,{dateValue:L,dateFormat:w,timeFormat:C,onChangeDateFormat:_,onChangeTimeFormat:P,onChangeValue:I})}),!S&&(0,V.jsx)(h().Z,{topBorder:!0,children:(0,V.jsx)(N,{onChangeValue:I})}),!S&&!A.isMobile&&g&&(0,V.jsx)(h().Z,{topBorder:!0,children:(0,V.jsx)(he,{})})]})}function Se(e){const t=(0,a().qz)(void 0,m().ZP),n=(0,a().VK)((()=>t.state.inputIsFocused),[t]);return(0,u().Z)({shouldPreserveTextSelection:!0,shouldPreserveBlockSelection:!0,shouldRestoreSelection:!0}),(0,V.jsx)(g().Z,{debugName:"DatePropertyMenu",capture:n,allowEsc:!0,children:(0,V.jsx)(g().Z,{debugName:"DatePropertyMenu",allowEsc:!0,capture:!0,allowUndo:!0,children:(0,V.jsx)(xe,{store:t,...e})})})}},810201:(e,t,n)=>{n.d(t,{Z:()=>E});n(267602),n(653476),n(470928),n(241792);var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(788860),s=()=>n(513670),l=()=>n(308186),d=()=>n(762478),c=()=>n(109757),u=()=>n(527278),m=()=>n(352230),p=()=>n(37405),g=()=>n(292612),f=()=>n(119891),h=()=>n(206352),v=()=>n(198829),y=()=>n(470386),b=()=>n(388284),x=(n(670560),()=>n(846550)),S=()=>n(455530),M=()=>n(225339),w=()=>n(72539),C=()=>n(494782),j=()=>n(351972),k=()=>n(64880),T=()=>n(611253),I=()=>n(469753);class _ extends(()=>n(263184))().default{getInitialState(){return{open:!1}}}const P=_;var Z=()=>n(145873),A=()=>n(827973),R=()=>n(448419),B=()=>n(291198),L=()=>n(255577),D=()=>n(967092),V=()=>n(135499),O=n(785893);function U(e){const{disabled:t,store:n,name:r,url:s,onChange:l,onDelete:d}=e,c=S().SR({url:e.url}),u=(0,o.useRef)(null),m=(0,i().O7)(),{device:p}=m,g=(0,a().qz)(void 0,P),f=(0,a().Kw)(g),h=(0,o.useCallback)((e=>{if(!f.open)return;g.setState({...f,inputValue:e});const t=M().rF({title:e,source:s});l({url:s,name:t})}),[g,f,l,s]),v=(0,o.useCallback)((()=>{g.setState({open:!0,inputValue:r})}),[g,r]),y=(0,o.useCallback)((()=>{g.setState({open:!1})}),[g]),b=(0,o.useCallback)((()=>{d(s)}),[d,s]),_=(0,o.useCallback)((()=>{const e=()=>{j().Uk(m,{url:s,from:"FilePropertyMenuItem"}),k().ji(m,{url:s,download:!0,downloadName:r,permissionRecord:n.pointer})};n.getCreatedById()===w().gd.id?(0,I().TG)({propertyType:"file",onConfirm:e}):e()}),[m,r,s,n]),Z=(0,o.useCallback)((()=>{k().Wl(m,{url:s,type:"file",from:"view_original",downloadName:r,permissionRecord:n.pointer})}),[m,r,n.pointer,s]),B=(0,o.useCallback)((()=>{if(!u.current)return;const e=u.current.getBoundingClientRect(),t=e.width/e.height;T().ui({environment:m,renderFullScreenNode:()=>(0,O.jsx)(V().Z,{url:s,isAuthenticated:!0,permissionRecord:n.pointer,width:window.innerWidth,render:(e,t)=>(0,O.jsx)("img",{src:t,style:{position:"relative",maxHeight:"100%",maxWidth:"100%",margin:0,alignSelf:"center",width:"100%"}})}),fullScreenNodeRect:e,contentAspectRatio:t,blockStore:n,imageUrl:s})}),[m,n,s]),L=(0,o.useCallback)((()=>{if(f.open)return(0,O.jsx)(H,{url:e.url,inputValue:f.inputValue,isOpen:f.open,handleFileRename:h,handleCloseRenamePopover:y})}),[f,y,h,e.url]),U=(0,x().yK)((()=>({imageInner:{display:"block",maxWidth:"100%",maxHeight:180,cursor:"zoom-in"},imageInnerWrapper:{flex:"auto",overflow:"hidden"}})),[]),F=(0,O.jsx)(N,{fileIsImage:c,fileUrl:s,disabled:t,handleOpenFullscreenPreviewOfFile:B,handleDownloadFile:_,handleViewOriginalFile:Z,handleOpenRenamePopover:v,handleDeleteFile:b});return c?(()=>{const n=(0,O.jsx)(V().Z,{url:s,isAuthenticated:!0,permissionRecord:e.store.pointer,width:300,render:(e,t)=>(0,O.jsx)("div",{style:U.imageInnerWrapper,children:(0,O.jsx)("img",{src:t,style:U.imageInner,onClick:B,ref:u})})}),o={paddingTop:p.isMobile?12:8,paddingBottom:p.isMobile?12:8,alignItems:"flex-start"};return(0,O.jsx)(A().Z,{focused:!1,showDragHandle:!t&&!p.isMobile,style:o,title:n,right:F,dontShrinkRight:!0})})():(()=>{const t=(0,O.jsx)(A().Z,{focused:!1,showDragHandle:!e.disabled&&!p.isMobile,onClick:Z,title:r,icon:(0,O.jsx)("div",{style:{width:p.isMobile?16:14},children:(0,C().R)()}),right:F,dontShrinkRight:!0});return(0,O.jsx)(D().ZP,{open:f.open,popupType:p.isMobile?R().Z4.SlideUp:R().Z4.Popup,origin:t,render:L,onDismiss:y})})()}function N(e){const{disabled:t,fileIsImage:n,fileUrl:a,handleOpenFullscreenPreviewOfFile:r,handleDownloadFile:s,handleViewOriginalFile:l,handleOpenRenamePopover:d,handleDeleteFile:c}=e,u=(0,i().O7)(),{isMobile:m}=u.device,p=(0,o.useCallback)((e=>(0,O.jsx)(Z().Z,{isMobile:m,...e})),[m]),g=(0,o.useCallback)((e=>(0,O.jsx)(F,{fileIsImage:n,fileUrl:a,disabled:t,parent:e,handleOpenFullscreenPreviewOfFile:r,handleDownloadFile:s,handleViewOriginalFile:l,handleOpenRenamePopover:d,handleDeleteFile:c})),[n,a,t,r,s,l,d,c]);return(0,O.jsx)(R().ZP,{popupType:m?R().Z4.SlideUp:R().Z4.Popup,renderOrigin:p,render:g})}function F(e){const{parent:t,disabled:n,fileUrl:a,fileIsImage:s,handleOpenFullscreenPreviewOfFile:l,handleDownloadFile:d,handleViewOriginalFile:c,handleOpenRenamePopover:u,handleDeleteFile:p}=e,g=(0,i().O7)(),{isMobile:f,isNative:h}=g.device,y=(0,o.useMemo)((()=>{const e=[];s&&e.push({key:"fullscreen",render:e=>(0,O.jsx)(A().Z,{...e,title:(0,O.jsx)(r()._H,{defaultMessage:"Full screen",id:"database.actionMenu.fileProperty.fullscreen.title"})}),action:l});return(M().iS(a)||h)&&e.push({key:"download",render:e=>(0,O.jsx)(A().Z,{...e,title:(0,O.jsx)(r()._H,{defaultMessage:"Download",id:"database.actionMenu.fileProperty.download.title"})}),action:d}),e.push({key:"original",render:e=>(0,O.jsx)(A().Z,{...e,title:(0,O.jsx)(r()._H,{defaultMessage:"View original",id:"database.actionMenu.fileProperty.viewOriginal.title"})}),action:()=>c()}),n||s||e.push({key:"rename",render:e=>(0,O.jsx)(A().Z,{...e,title:(0,O.jsx)(r()._H,{defaultMessage:"Rename",id:"database.actionMenu.fileProperty.rename.title"})}),action:u}),n||e.push({key:"delete",render:e=>(0,O.jsx)(A().Z,{...e,title:(0,O.jsx)(r()._H,{defaultMessage:"Delete",id:"database.actionMenu.fileProperty.delete.title"})}),action:p}),e}),[n,s,a,p,l,u,c,d,h]),x=(0,o.useMemo)((()=>[{key:"section",render:e=>(0,O.jsx)(b().Z,{...e}),items:y}]),[y]),S=f?{menuType:m().o.ActionSheet}:{menuType:m().o.Popup,width:200};return(0,O.jsx)(v().Z,{...S,children:(0,O.jsx)(L().ZP,{type:L().iW.Vertical,initialFocus:0,onAccept:t.close,sections:x})})}function H(e){const{url:t,handleFileRename:n,handleCloseRenamePopover:a,isOpen:r,inputValue:s}=e,l=(0,i().O7)(),{device:d}=l,c=(0,o.useCallback)((e=>{const t=e.target.value;n(t)}),[n]),u=(0,x().yK)((e=>({renameInputWrapper:{display:"flex",alignItems:"center",color:e.regularTextColor,fontSize:"13px",padding:"4px 8px"},renameInput:{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}})),[]),p=d.isMobile?{menuType:m().o.ActionSheet}:{menuType:m().o.Popup,width:380};return r?(0,O.jsx)(v().Z,{...p,children:(0,O.jsx)("div",{style:u.renameInputWrapper,children:(0,O.jsx)(B().Z,{style:u.renameInput,value:s,placeholder:M().w2(t),onChange:c,onSubmit:a,focusInitial:!0,selectAll:!0})})}):null}const K=function(e){return(0,O.jsx)(n(18748).ZP,{title:(0,O.jsxs)("div",{style:{display:"flex"},children:[(0,O.jsx)(n(312578).Z,{style:{marginTop:1,marginRight:6}}),(0,O.jsx)(n(410184).Z,{percentage:e.progressPercent})]})})};function E(e){const{store:t,uploadFiles:n,value:s,disabled:f,onChange:x,onDismiss:S}=e,M=W(s),w=(0,i().O7)(),C=(0,o.useRef)(),j=(0,o.useRef)(null),k=(0,a().qz)(void 0,p().Z),{isLoading:T,progressPercent:I}=(0,a().Kw)(k),_=(0,o.useCallback)((e=>{k.setState({isLoading:!0,progressPercent:0}),C.current=e}),[k]),P=(0,o.useCallback)((e=>{const{progressPercent:t}=e;k.setState({...k.state,progressPercent:t})}),[k]),Z=(0,o.useCallback)((e=>{if(!C.current)return;const t=C.current.map(((t,n)=>{const o=e[n];return{name:t.name||o,url:o}}));x({value:[...t,...s]}),k.reset()}),[k,x,s]),A=(0,o.useCallback)((()=>{k.reset(),l().UW((0,O.jsx)(r()._H,{id:"filePropertyMenu.uploadFileFailedError.message",defaultMessage:"Upload failed."}))}),[k]),R=(0,o.useCallback)((e=>{d().Z(),k.setState({isLoading:!0,progressPercent:0}),C.current=[e]}),[k]),B=(0,o.useCallback)((e=>{if(!C.current)return;const t=C.current[0];if(!t)return;const n={name:t.name||e,url:e};x({value:[...s,n]}),k.reset(),d().Z()}),[k,x,s]),L=(0,o.useCallback)((e=>{const t={name:e,url:e};x({value:[...s,t]}),k.reset(),d().Z()}),[k,x,s]),D=(0,o.useCallback)((()=>{const e=j.current;if(!(e&&e instanceof Element))return;const n=u().Z.getIntl();d().$(w,{originRect:e.getBoundingClientRect(),originGap:3,isSmallWidth:!0,showArrow:!0,title:n.formatMessage({id:"filePropertyMenu.header",defaultMessage:"File"}),currentTab:"file",tabs:[{type:"file",fileUpload:!0,imageUpload:!1,videoUpload:!1,onUpload:e=>{c().cT({environment:w,file:e[0],bucket:"secure",record:t.pointer,onStart:R,onProgress:P,onComplete:B,onError:A})}},{type:"embed",onChange:L}]})}),[w,L,B,R,A,P,t.pointer]),V=(0,o.useCallback)((()=>{D()}),[D]),U=()=>{d().Z()};(0,o.useEffect)((()=>((()=>{const{device:e}=w;n?c().IL({environment:w,files:n,bucket:"secure",record:t.pointer,onBatchStart:_,onBatchProgress:P,onBatchComplete:Z,onBatchError:A}):W(s)&&!e.isMobile&&D()})(),U)),[]);const N=w.device.isMobile?{menuType:m().o.Modal,title:(0,O.jsx)(r()._H,{defaultMessage:"File property",id:"database.fileProperty.mobileMenu.title"}),right:(0,O.jsx)(y().DoneMenuText,{}),onClickRight:S}:{menuType:m().o.Popup};return(0,O.jsx)(h().Z,{debugName:"FilePropertyMenu",capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!0,children:(0,O.jsxs)(v().Z,{...N,children:[(0,O.jsx)(Y,{value:s,disabled:f,store:t,onChange:x}),(0,O.jsxs)(b().Z,{topBorder:!M&&!f,desktopStyle:{...M&&{paddingTop:3,paddingBottom:3}},children:[T&&(0,O.jsx)(K,{progressPercent:I}),!T&&!f&&(0,O.jsx)(g().Z,{focused:!1,onClick:V,title:(0,O.jsx)(r()._H,{id:"database.fileProperty.focusedLabel",defaultMessage:"Add a file or image"}),ref:j})]})]})})}function W(e){return 0===e.length}function z(e,t,n){n({value:t.map((t=>t.url===e.url?{name:e.name,url:e.url}:t))})}function G(e,t,n){n({value:t.filter((t=>t.url!==e))})}function q(e){let{url:t,value:n,disabled:o,store:a,onChange:r}=e;const s=(0,i().O7)(),{device:l}=s,d=n.find((e=>e.url===t));if(d){const e=d.url,t=d.name;return l.isMobile?(0,O.jsx)(b().Z,{children:(0,O.jsx)(U,{store:a,name:t,url:e,onDelete:e=>G(e,n,r),onChange:e=>z(e,n,r),disabled:o})}):(0,O.jsx)(U,{store:a,name:t,url:e,onDelete:e=>G(e,n,r),onChange:e=>z(e,n,r),disabled:o})}return null}function Y(e){let{value:t,disabled:n,store:a,onChange:r}=e;const l=(0,i().O7)(),{device:d}=l,c=s().oA(t.map((e=>e.url)));return 0===c.length?null:d.isMobile||n?(0,O.jsx)(o.Fragment,{children:c.map((e=>(0,O.jsx)(q,{url:e,value:t,disabled:n,store:a,onChange:r},e)))}):(0,O.jsx)(b().Z,{children:(0,O.jsx)(f().ZP,{direction:"vertical",keys:c,renderKey:e=>(0,O.jsx)(q,{url:e,value:t,disabled:n,store:a,onChange:r}),onDrop:e=>function(e,t,n){t({value:s().MR(n,(t=>{const n=t.url;return n?e.indexOf(n):1/0}))})}(e,r,t)})})}},720940:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M,getSpaceViewMenuItems:()=>w});n(670560),n(667294);var o=()=>n(219727),i=()=>n(142735),a=()=>n(788860),r=()=>n(291338),s=()=>n(234049),l=(n(267602),n(653476),()=>n(513670));var d=()=>n(352230),c=()=>n(345918),u=()=>n(341691),m=()=>n(104088),p=()=>n(876822),g=()=>n(722116),f=()=>n(827973),h=()=>n(198829),v=()=>n(255577),y=()=>n(470386),b=()=>n(943620),x=()=>n(388284),S=n(785893);const M=function(){const e=(0,o().O7)(),{device:t}=e,a=(0,i().Kw)(g().Z);return(0,S.jsx)(n(967092).ZP,{popupType:t.isMobile?m().k.SlideUp:m().k.Popup,open:a.open,render:()=>(0,S.jsx)(C,{}),originGap:8,onDismiss:r().sC,originRect:a.originRect,enableRounding:!0})};function w(e,t){const{device:n}=e,{currentUserRootStore:o}=p().default.state;if(!o)return[];const{editableStores:i}=function(e){const t=l().mN(e.getSpaceViewStores(),(e=>e.getSpaceId())),n=t.filter((e=>{const t=e.getSpaceStore();return e.isReady()&&(null==t?void 0:t.isReady())})),o=n.filter((e=>{const t=e.getSpaceStore();return e.isReady()&&(null==t?void 0:t.isReady())&&t.canEdit()}));return{total:t.length,loaded:n.length,editable:o.length,editableStores:o}}(o),a=[];for(const r of i){const o=r.getSpaceStore();if(null!=o&&o.isReady()&&o.canEdit()){const i=(0,c().rn)(e,o),l=(0,c().Wd)(e,o);a.push({key:r.id,action:async()=>{await s().JI({environment:e,blockStore:t,spaceStore:o,spaceViewStore:r})},render:e=>(0,S.jsx)(f().Z,{title:i,icon:(0,S.jsx)(b().Z,{icon:l,isEmptyPage:!1,title:i,size:n.isMobile?24:20,disabled:!0}),...e})})}}return a}function C(){const e=(0,o().O7)(),{device:t}=e,n=(0,i().Kw)(g().Z),s=(0,i().VK)((()=>p().default.state.currentUserRootStore),[]),l=(0,i().VK)((()=>n.store?w(e,n.store):[]),[e,n]);if(!n.open||!s)return null;const c=[{key:"spaces",render:e=>(0,S.jsx)(x().Z,{title:t.isMobile?void 0:(0,S.jsx)(a()._H,{defaultMessage:"Choose a workspace",id:"duplicatePagePopup.chooseWorkspace.menuItem.title"}),isTitleUppercase:!0,...e}),items:l},{key:"logout",render:e=>(0,S.jsx)(x().Z,{...e,topBorder:!0}),items:[{key:"logout",action:()=>u().logout(e),render:e=>(0,S.jsx)(j,{...e})}]}];let m;return m=t.isMobile?{menuType:d().o.Modal,title:(0,S.jsx)(a()._H,{defaultMessage:"Choose a workspace",id:"duplicatePagePopup.choooseWorkspaceMobileMenu.title"}),right:(0,S.jsx)(y().CancelMenuText,{}),onClickRight:r().sC}:{menuType:d().o.Popup},(0,S.jsx)(h().Z,{...m,children:(0,S.jsx)(v().ZP,{type:v().iW.Vertical,sections:c,initialFocus:1})})}function j(e){const t=(0,i().VK)((()=>{const{currentUserStore:e}=p().default.state;return(null==e?void 0:e.getEmail())||""}),[]);return(0,S.jsx)(f().Z,{caption:(0,S.jsx)(a()._H,{defaultMessage:"Log out ({email})",id:"duplicatePagePopup.buttonMenuItem.logoutButton.label",values:{email:t}}),...e})}},119963:(e,t,n)=>{n.r(t),n.d(t,{GenerateSocialMediaPreviewImageWrapper:()=>u});var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(955620),s=()=>n(513670),l=()=>n(136343),d=()=>n(749826),c=()=>n(127519);function u(e){const{store:t}=e;return function(e){const t=(0,i().O7)(),[n,u]=(0,o.useState)("uninitialized"),[m,p,g,f,h]=(0,a().VK)((()=>{var n,o;return e.pathIsDead()||"on"!==d().default.getEligibleGroup({experimentId:"dynamic_social_preview_image",defaultGroup:"unassigned"})||e.inMemoryRecordCache.recordHasOverride({pointer:e.pointer,userId:t.currentUser.id})?[!1]:[e.isReady(),r().QaF(e.getTitleValue()),null===(n=e.getIcon())||void 0===n?void 0:n.icon,null===(o=e.getCover())||void 0===o?void 0:o.cover,e.getFormat().page_font]}),[t.currentUser.id,e]);(0,o.useEffect)((()=>{"storeReady"===n?u("generateImage"):m&&u("storeReady")}),[m,p,g,f,h]);const v=(0,o.useMemo)((()=>(0,s().Ds)((()=>{u("storeReady"),l().O({environment:t,store:e})}),5e3)),[t,e]);(0,a().VK)((()=>{"generateImage"===n&&(c().default.state,v())}),[n,v])}(t),null}},743405:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});n(667294);var o=()=>n(219727),i=()=>n(142735),a=()=>n(846550),r=()=>n(714230),s=()=>n(788860),l=()=>n(707513),d=()=>n(454393),c=()=>n(384510),u=()=>n(201696),m=()=>n(708518),p=()=>n(906651),g=()=>n(777346),f=n(785893);function h(){const e=(0,o().Fy)(),t=(0,i().VK)((()=>u().Z.state.open),[]),n=()=>{u().Z.state.open&&u().Z.state.onDecline&&u().Z.state.onDecline(),u().Z.setState({open:!1})},h=()=>{u().Z.state.open&&u().Z.state.onConfirm(),u().Z.setState({open:!1})},v=()=>{n(),d().r$({currentTab:"connected_apps"})},y=(0,a().yK)((e=>({wrap:{padding:"24px 36px 24px",minWidth:300,maxWidth:400},modalHeaderWrap:{textAlign:"center",marginTop:8,marginBottom:18,justifyContent:"space-between"},modalMessage:{fontSize:16,lineHeight:1.5,fontWeight:l().Ue.medium,marginTop:15,marginBottom:20,color:e.mediumTextColor}})),[]);return(0,f.jsx)(m().Z,{open:t,innerStyle:y.wrap,preventHideChildrenWhileOpening:!0,render:()=>(0,f.jsxs)("div",{style:y.modalHeaderWrap,children:[(0,f.jsx)("img",{src:r().Z.images.googleDriveLogoPng,style:{width:50,display:"inline-block"}}),(0,f.jsx)("div",{style:y.modalMessage,children:(0,f.jsx)(s()._H,{defaultMessage:"Notion cannot access the Google Drive file you are trying to embed.",id:"googleAuthPromptModal.noAccessFile.errorMessage"})}),e.isMobileNative?(0,f.jsx)("div",{style:y.modalMessage,children:(0,f.jsx)(s()._H,{defaultMessage:"Please use Notion on desktop to connect a new account.",id:"googleAuthPromptModal.mobileUseDesktopPrompt.errorMessage"})}):(0,f.jsx)(p().Z,{isLarge:!0,onClick:h,children:(0,f.jsx)(s()._H,{defaultMessage:"Connect to Google",id:"googleAuthPromptModal.connectToGoogleButton.label"})}),!e.isMobile&&(0,f.jsx)("div",{style:{display:"block",marginTop:c().Z.vertical.tiny},children:(0,f.jsx)(g().Z,{underlined:!0,onClick:v,children:(0,f.jsx)(s()._H,{defaultMessage:"See my connected accounts",id:"googleAuthPromptModal.seeConnectedAccountsButton.label"})})})]}),onDismiss:n})}},732171:(e,t,n)=>{n.r(t),n.d(t,{HorizontalTemplatePicker:()=>Q});n(267602),n(916054),n(653476),n(241792);var o=n(667294),i=()=>n(492788),a=()=>n(219727),r=()=>n(657320),s=()=>n(142735),l=()=>n(846550),d=()=>n(64272),c=()=>n(644602),u=()=>n(641772),m=()=>n(825886),p=()=>n(491040),g=()=>n(788860),f=()=>n(513670),h=()=>n(696459),v=()=>n(808828),y=()=>n(8101),b=()=>n(132156),x=()=>n(421654),S=()=>n(332542),M=()=>n(279830),w=()=>n(990966),C=()=>n(269299),j=()=>n(869211),k=()=>n(785673),T=()=>n(259801),I=()=>n(654493),_=()=>n(965865),P=()=>n(632775),Z=()=>n(23338),A=()=>n(982855),R=()=>n(527278),B=()=>n(191586),L=()=>n(714966),D=()=>n(466970),V=()=>n(821227),O=()=>n(998901),U=()=>n(104088),N=()=>n(749826),F=()=>n(692304),H=()=>n(807230),K=()=>n(58836),E=()=>n(78078),W=()=>n(255577),z=()=>n(967092),G=()=>n(67961),q=()=>n(69255),Y=()=>n(710999),$=n(785893);const J=8;function Q(e){const{store:t,context:n,menuListStore:D,editorWidth:F}=e,Q=te(),ie=(0,B().OZ)(n),ae=(0,l().yK)((e=>({root:{background:ie?e.peekModalBackground:e.contentBackground,paddingBottom:"min(48px, 5vh)",pointerEvents:"all"}})),[ie]),[re,se]=function(e){const t=(0,a().O7)(),n=(0,s().VK)((()=>"editor"===e.getRole()),[e]),o=(0,q().b6)(I().I,["table"]),u=function(e){const{environment:t,store:n}=e,o=(0,g().YB)(),i=(0,r().l)(),a=(0,s().VK)((()=>null==i?void 0:i.publicEditModeStore.state),[null==i?void 0:i.publicEditModeStore]),l=(0,s().VK)((()=>(0,A().GD)(a)),[a]);return{name:(0,s().VK)((()=>{const e=N().default.getEligibleGroup({experimentId:"ai_new_page_pills"});return e&&"control"!==e?"help_me_write"===e?o.formatMessage(ee.helpMeWrite):"write_with_ai"===e?o.formatMessage(ee.writeWithAi):(0,h().t1)(e):o.formatMessage(ee.askAi)}),[o]),type:"ai",iconFn:e=>(0,$.jsx)(k().D_,{}),shouldShow:()=>l,onClick:()=>{C().createAndCommit({userAction:"HorizontalTemplatePicker.genericHelpMeWriteNewPageWithAI",environment:t,canUndo:!0,perform:e=>{M().e({environment:t,store:n,transaction:e,preventTextSelection:!1,onTextSelection(){(0,j().openHelpMeWriteGenericPopup)({environment:t,title:""})}})}})}}}({environment:t,store:e}),y=function(e){const t=(0,g().YB)(),n=(0,l().Fg)(),o=(0,s().VK)((()=>(0,Z().d)()),[]),i=te();return{name:e?"":t.formatMessage(ee.dictate),type:"dictation",iconFn:t=>(0,m().q)({...t,width:10,...e?{height:16,marginTop:"2px",marginBottom:"2px",marginLeft:"2px",marginRight:"-6px"}:{},fill:i?n.icon.primary:"dark"===n.mode?n.accentColors.red[700]:n.accentColors.red[400]}),shouldShow:()=>o,onClick:async(e,t)=>{const{dictationActions:n}=await P().Xb.load();n.startDictation({environment:e,blockStore:t,from:"horizontal_template_picker"})}}}(!0),_=function(e){const t=(0,a().O7)(),n=(0,g().YB)(),o=(0,l().Fg)();return{name:n.formatMessage(ee.formTemplateTitle),type:"quick-form",iconFn:e=>(0,d().E)({...e,fill:o.regularIconColor}),shouldShow:()=>!0,onClick:async()=>{await(0,T().N)({environment:t,store:e})}}}(e),B=function(e,t){const n=(0,a().O7)(),o=(0,g().YB)(),r=(0,l().Fg)(),s=te(),d=function(e){const{store:t,debugName:n,action:o}=e,r=(0,a().O7)(),s=(0,g().YB)(),l=e=>{const{store:t,isPreviewing:i}=e;C().createAndCommit({userAction:n,environment:r,canUndo:!0,perform:e=>{const n=t.getContentStores();for(const t of n)S().zo({blockStore:t,transaction:e});o({store:t,intl:s,environment:r,isPreviewing:i,transaction:e})}})};return async()=>{l({store:t,isPreviewing:!1}),await i().default.afterNextFlush();const e=t.getRenderableContentStores()[0],n=null==e?void 0:e.getTitleStore();n&&w().setSelectionAtEnd({store:n})}}({store:e,type:"quick-table",debugName:"HorizontalTemplatePicker.createInlineTableView",action:t=>{if(t.isPreviewing)!function(e){let{store:t,environment:n,transaction:o}=e;const i=b().f({environment:n,createBlockItem:v().Nc,inMemoryRecordCache:t.inMemoryRecordCache,from:"quick_templates",transaction:o,selection:[]});S().jG({parentStore:t,childStore:i,transaction:o});const a=i.getCollectionViewStores();x().FH({stores:a,transaction:o,update:{hide_linked_collection_name:!0}})}(t);else{(0,T().U)({environment:n,store:e,viewType:"table",transaction:t.transaction});const o=e.getCollectionViewStores()[0];o&&(0,L().u)(o.id,{viewType:"table"})}}});return{name:o.formatMessage(ee.tableTemplateTitle),type:"quick-table",iconFn:e=>(0,c().t)({...e,fill:r.regularIconColor}),shouldShow:()=>s,onClick:d}}(e,o[0]),D=f().zu(I().I,...o),O=function(e){const{isTablet:t}=(0,a().Fy)();return{name:R().Z.formatMessage(q().HB.templates),type:"templates",iconFn:e=>(0,p().U)(e),shouldShow:()=>!t,onClick:e=>{(0,V().C)({environment:e})}}}(),U=[y,u,B,...n?[_]:[],O].filter((e=>e.shouldShow(t))),F=[...D,ne,q().pd];return[U,F]}(t),[le,de]=function(e){const{store:t,editorWidth:n,initialVisible:i,initialOverflow:r}=e,s=(0,a().O7)(),d=(0,g().YB)(),c=te(),m=(0,l().yK)((e=>({icon:{width:16,marginLeft:2,marginRight:2,fill:e.lightIconColor}})),[]),[p,f]=o.useState(void 0),[v,b]=o.useState([]),[x,S]=o.useState(void 0),[M,w]=o.useState(i.length);(0,o.useEffect)((()=>{if(!(n&&v.every(h().$K)&&x))return;let e=0,t=0;for(;t<i.length&&(e+=v[t]+J,!(e+x>n+24));)t++;w(t)}),[v,n,i.length,x]);const C=i.slice(0,M).map(((e,n)=>{const o={key:"ai-skill"===e.type?`${e.type}-${n}`:e.type,render:o=>{var i;let{ref:a,...r}=o;return(0,$.jsx)(_().n4,{onSizeChange:e=>{if(v[n]===e.width)return;const t=[...v];t[n]=e.width,b(t)},children:(0,$.jsx)("div",{children:(0,$.jsx)(Y().Z,{...r,focused:p===n,onMouseEnter:o=>{var i;null===(i=e.onMouseEnter)||void 0===i||i.call(e,s,t),f(n)},onMouseLeave:n=>{var o;null===(o=e.onMouseLeave)||void 0===o||o.call(e,s,t),f(void 0)},format:"horizontal-new-page",title:(0,$.jsx)(G().Z,{children:e.name}),type:e.type,icon:null===(i=e.iconFn)||void 0===i?void 0:i.call(e,m.icon),locked:!1})})})},action:n=>{(0,H().ww)(s)&&(y().rN(s,{is_keyboard:"keydown"===n.event.type,from:"horizontal_template_picker",template_type:e.type}),e.onClick(s,t))}};return o})),[j,k]=o.useState(!1),T=M,I={key:"more",render:e=>{let{ref:n,...o}=e;return(0,$.jsx)(z().ZP,{origin:(0,$.jsx)(_().n4,{onSizeChange:e=>S(e.width),children:(0,$.jsx)("div",{children:(0,$.jsx)(Y().Z,{...o,focused:p===T,onMouseEnter:e=>{f(T)},onMouseLeave:e=>{f(void 0)},format:"horizontal-new-page",title:c?null:(0,$.jsx)(G().Z,{children:d.formatMessage(ee.more)}),type:"more",icon:(0,u().o)(m.icon),locked:!1})})}),alignmentToOrigin:O().Alignment.Start,placementToOrigin:O().Placement.Top,originGap:4,open:j,popupType:U().k.Popup,onDismiss:()=>k(!1),render:()=>(0,$.jsx)(oe,{store:t,items:[...i.slice(M),...r]})})},action:e=>{y().rN(s,{is_keyboard:"keydown"===e.event.type,from:"horizontal_template_picker",template_type:"more"}),k(!0)}};return[C,I]}({store:t,editorWidth:F,initialVisible:re,initialOverflow:se});return(0,$.jsx)(K().p,{allowSelectionWithin:!1,children:(0,$.jsx)(W().ZP,{type:W().iW.Horizontal,store:D,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,isEnterOnHoverEmpty:!0,disableKeyboard:!0,sections:[{key:"Get started",render:e=>(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(X,{isInPeekView:ie}),(0,$.jsx)("div",{style:ae.root,children:(0,$.jsxs)(E().sg,{gap:12,children:[(0,$.jsx)(G().Z,{isSmall:!0,isSecondaryColor:!0,style:{fontWeight:500},children:Q?(0,$.jsx)(g()._H,{defaultMessage:"Get started with",id:"PageEditor.horizontalTemplatePicker.getStarted.label.new"}):(0,$.jsx)(g()._H,{defaultMessage:"Get started",id:"PageEditor.horizontalTemplatePicker.getStarted.label"})}),(0,$.jsx)("div",{style:{cursor:"pointer"},children:(0,$.jsx)(E().X2,{gap:J,children:e.children})})]},e.key)})]}),items:[...le,de]}]})})}function X(e){const t=(0,l().yK)((t=>({fade:{background:`linear-gradient(0deg, ${e.isInPeekView?t.peekModalBackground:t.contentBackground} 0%, ${t.contentBackgroundTransparent} 100%)`,height:140,width:"100%"}})),[e.isInPeekView]);return(0,$.jsx)("div",{style:t.fade})}const ee=(0,g().vU)({askAi:{defaultMessage:"Ask AI",id:"newpage.templates.writeWithAiCondensed"},helpMeWrite:{defaultMessage:"Help me write",id:"newpage.templates.helpMeWrite"},writeWithAi:{defaultMessage:"Write with AI",id:"newpage.templates.writeWithAi"},dictate:{defaultMessage:"Dictate",id:"newpage.templates.dictateIntoNewPage"},more:{defaultMessage:"More",id:"newpage.templates.more"},quickTemplatePlaceholder:{defaultMessage:"...",id:"newpage.templates.quickTemplatePlaceholder"},tableTemplateTitle:{defaultMessage:"Database",id:"newpage.templates.table"},formTemplateTitle:{defaultMessage:"Form",id:"newpage.templates.form"}});function te(){const e=(0,a().O7)(),{isTablet:t}=(0,a().Fy)(),n=(0,D().E)("tablet_refresh_template_pills_gate");return!(!t||!n)||!e.device.isMobile}const ne={name:"",type:"divider",iconFn:e=>null,shouldShow:()=>!0,onClick:()=>{}};function oe(e){const{store:t,items:n}=e,i=(0,a().O7)(),r=(0,o.useMemo)((()=>new(F().Z)),[]),s=(0,l().yK)((e=>({menu:{width:200,cursor:"pointer",padding:"6px 4px"},icon:{width:16,marginLeft:2,marginRight:2,fill:e.regularIconColor},divider:{height:1,background:e.stroke.primary,margin:"6px -6px"}})),[]),d=n.filter((e=>e.shouldShow(i))).map((e=>{const n={key:e.name,render:t=>{var n;let{ref:o,...i}=t;return"divider"===e.type?(0,$.jsx)("div",{style:s.divider}):(0,$.jsx)(Y().Z,{...i,format:"horizontal-new-page-submenu",title:(0,$.jsx)(G().Z,{children:e.name}),type:e.type,icon:null===(n=e.iconFn)||void 0===n?void 0:n.call(e,s.icon),locked:!1})},action:n=>{(0,H().ww)(i)&&(y().rN(i,{is_keyboard:"keydown"===n.event.type,from:"horizontal_template_picker",template_type:e.type}),e.onClick(i,t))}};return n}));return(0,$.jsx)(W().ZP,{type:W().iW.Vertical,store:r,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,isEnterOnHoverEmpty:!0,disableKeyboard:!0,sections:[{key:"Items",render:e=>(0,$.jsx)("div",{style:s.menu,children:(0,$.jsx)(E().sg,{children:e.children},e.key)}),items:d}]})}},969016:(e,t,n)=>{n.r(t),n.d(t,{ImportIntoNewPageModal:()=>m,default:()=>p});n(667294);var o=()=>n(142735);const i=(0,n(827282).CZ)("importIntoNewFile",{default:{loader:()=>n.e(89389).then(n.bind(n,689389))},small:{loader:()=>n.e(98419).then(n.bind(n,398419))},mini:{loader:()=>n.e(12182).then(n.bind(n,212182))},large:{loader:()=>n.e(20929).then(n.bind(n,420929))}});var a=()=>n(788860),r=()=>n(825137),s=()=>n(838266),l=()=>n(830581),d=()=>n(921981),c=n(785893);function u(){r().Z.setState({open:!1})}function m(){const e=(0,o().Kw)(r().Z);return(0,c.jsx)(d().c,{isOpen:e.open,onDismiss:u,onClosed:u,areaConstraint:{width:{type:"fixed",length:300}},render:()=>(0,c.jsx)(l().sR,{header:(0,c.jsx)(l().vI,{iconAndTitle:(0,c.jsx)(l().kC,{iconGroup:i,title:(0,c.jsx)(a()._H,{defaultMessage:"Import into new page?",id:"importIntoNewPageModal.title"})}),description:(0,c.jsx)(a()._H,{id:"importIntoNewPageModal.description",defaultMessage:"Since this page already has content, we’ll need to create a new page for you and import contents there."})}),footer:(0,c.jsx)(l().a6,{layout:"vertical",primaryButtons:[{buttonType:"primary",label:(0,c.jsx)(a()._H,{defaultMessage:"Yes, continue",id:"importIntoNewPageModal.importButton"}),onClick:()=>{s().default.setState({open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0,openedFrom:"collection"}),u()}}],secondaryButtons:[{buttonType:"secondary",label:"Cancel",onClick:u}]})})})}const p=m},11070:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(506347),s=()=>n(456681),l=()=>n(788860),d=()=>n(407391),c=()=>n(47443),u=()=>n(148126),m=()=>n(876822);class p extends(()=>n(263184))().default{getInitialState(){return{open:!1}}}const g=new p;var f=()=>n(265640),h=()=>n(108714),v=()=>n(667413),y=n(785893);const b={fontSize:24,lineHeight:1.2,marginBottom:6,fontWeight:n(707513).Ue.bold,marginRight:"auto"},x={display:"flex",alignItems:"center",marginTop:8,marginBottom:18},S={padding:"24px 36px 24px",minWidth:300};const M=function(){const e=(0,a().Kw)(g);return(0,y.jsx)(n(708518).Z,{open:e.open,innerStyle:S,preventHideChildrenWhileOpening:!0,render:()=>(0,y.jsxs)(o.Fragment,{children:[(0,y.jsxs)("div",{style:x,children:[(0,y.jsx)("div",{style:b,children:(0,y.jsx)(l()._H,{id:"importModal.importButton.label",defaultMessage:"Import"})}),(0,y.jsx)(w,{})]}),(0,y.jsx)("div",{children:(0,y.jsx)(j,{modalState:e})})]}),onDismiss:C})};function w(){const e=(0,i().O7)();return(0,y.jsx)(h().Z,{href:(0,u().UY)("guides.import"),onClick:()=>d().Fs(e,{from:"import"}),external:!0,children:(0,y.jsx)(f().D,{size:"sm",icon:s().m,isGray:!0,children:(0,y.jsx)(l()._H,{id:"importModal.helpButton.label",defaultMessage:"Learn about importing"})})})}function C(){g.setState({open:!1})}function j(e){let{modalState:t}=e;const n=(0,i().O7)(),{mainEditorCurrentBlockStore:o,currentSpaceStore:s,currentSpaceViewStore:l,currentUserSettingsStore:d}=(0,a().VK)((()=>{const{mainEditorCurrentBlockStore:e,currentSpaceStore:t,currentSpaceViewStore:n,currentUserSettingsStore:o}=m().default.state;return{mainEditorCurrentBlockStore:e,currentSpaceStore:t,currentSpaceViewStore:n,currentUserSettingsStore:o}}),[]);return o&&s&&l&&d?(0,y.jsx)(v().Z,{pageStore:t.open&&t.pageStore?t.pageStore:o,spaceStore:s,spaceViewStore:l,userSettingsStore:d,analyticsFrom:"modal",onComplete:e=>function(e,t){g.setState({open:!1}),c()._c({environment:t,store:e,pageVisitSource:r().tY.Import})}(e,n),readOnlyCreditButton:!1}):null}},719542:(e,t,n)=>{n.d(t,{Z:()=>l});n(667294);var o=()=>n(513670),i=()=>n(762478),a=()=>n(998901),r=()=>n(104088),s=n(785893);const l=function(){const e=(0,n(219727).O7)(),{device:t}=e,i=(0,n(142735).Kw)(n(145702).Z);return(0,s.jsx)(n(967092).ZP,{popupType:t.isMobile?r().k.SlideUp:r().k.Popup,open:i.isActive,originRect:i.isActive?i.originRect:void 0,originGap:i.isActive?i.originGap:void 0,placementToOrigin:a().Placement.Bottom,alignmentToOrigin:a().Alignment.Center,preventScaleTransition:!0,onDismiss:d,render:()=>{if(i.isActive)return(0,s.jsx)(n(94967).Z,{debugName:"MediaMenu",capture:!0,onUp:o().yR,onDown:o().yR,children:(0,s.jsx)(n(691752).ZP,{...i,onCancel:d})})},trapFocus:!0})};function d(){i().Z()}},176866:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Z});var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(846550),s=()=>n(565630),l=n(785893);const d=(0,n(827282).IU)("appDownload",{viewBox:"0 0 23 16",svg:(0,l.jsx)("path",{clipRule:"evenodd",d:"m23 11.4338c0 2.5317-2.1591 4.5662-4.922 4.5662h-12.59789c-3.12888 0-5.48011-2.2739-5.48011-4.9804 0-2.2463 1.28998-4.10591 3.3576-4.43732.04574-2.57768 2.49761-4.2992 4.74821-3.63637 1.09785-1.61104 2.86359-2.94591 5.34289-2.94591 3.7418 0 6.6786 2.96433 6.6603 7.0702 1.784.75489 2.891 2.43038 2.891 4.3636zm-17.51989 3.084h12.59789c1.9487 0 3.449-1.3717 3.449-3.084 0-1.66625-1.0704-2.89065-2.7354-3.25889-.1098-.02761-.1556-.09206-.1464-.21173.0366-.43269.064-.92981.0366-1.35328-.1555-2.73418-2.2323-5.12774-5.2331-5.12774-2.3695 0-3.73271 1.30725-4.62014 2.89989-.05489.10126-.11893.12888-.22872.09206-1.8755-.6168-3.90652.22094-3.90652 3.05638 0 .11968-.04575.18412-.17383.18412-1.93954 0-3.04654 1.46376-3.04654 3.30499 0 1.878 1.70167 3.4982 4.00716 3.4982zm7.19089-9.49502c0-.39047-.3145-.70701-.7026-.70701-.388 0-.7026.31654-.7026.70701v4.89196l-1.61105-1.62112c-.27439-.27611-.71927-.27611-.99366 0-.2744.27611-.2744.72377 0 .99987l2.81051 2.82811c.2744.2761.7193.2761.9936 0l2.8106-2.82811c.2743-.2761.2743-.72376 0-.99987-.2744-.27611-.7193-.27611-.9937 0l-1.6111 1.62112z",fillRule:"evenodd"})});var c=()=>n(205248),u=()=>n(54193),m=()=>n(788860),p=()=>n(707513),g=()=>n(319615),f=()=>n(824462),h=()=>n(497065),v=()=>n(656573),y=()=>n(440434),b=()=>n(341643),x=()=>n(355435),S=()=>n(998901),M=()=>n(876822),w=()=>n(522323),C=()=>n(715139),j=()=>n(1910),k=()=>n(108714),T=()=>n(967092),I=()=>n(906651),_=()=>n(777346),P=()=>n(67961);function Z(){const e=(0,i().O7)(),t=(0,m().YB)(),[n,Z]=(0,o.useState)(!0),{isDesktopBrowser:A,os:R}=(0,i().Fy)(),B=(0,a().VK)((()=>e.RouterStore.state.route.name in u().c$),[e]),L=(0,a().VK)((()=>M().default.state.inAppCalloutStore),[]),D=(0,a().VK)((()=>L.getCalloutVisibility("desktop_preference_popup").canShow),[L]),V=e.currentUser.isLoggedIn(),O=(0,a().Kw)(w().Z),[U,N]=(0,o.useState)(!1),F=(0,a().VK)((()=>w().Z.canPersistToLocalStorage()),[]),H=!U&&V&&void 0===O&&A&&("mac"===R||"windows"===R)&&B&&F&&D,[K,E]=(0,o.useState)(!1),W=H&&K,z=(0,o.useRef)(!1);(0,o.useEffect)((()=>{H&&!z.current&&(async function(e,t){const n=await f().callApi({eventName:"getDesktopAppRegistration",environment:e,data:{os:t}});return"data"in n&&n.data.isRegistered}(e,R).then((e=>{E(e)})),z.current=!0)}),[H,E,e,R]);const G=(0,s().D9)(W);(0,o.useEffect)((()=>{W&&!G&&(g().wW(e),L.updateCalloutStatus({calloutId:"desktop_preference_popup",visible:!0,validateCanShow:!0}))}),[W,G,e,L]);const q=(0,b().J4)(),Y=(0,y().e)(),$=(0,r().yK)((()=>({origin:{position:"fixed",left:"50%",top:"100%"},container:{bottom:20,padding:"8px 12px 12px",minWidth:300},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},headerText:{fontSize:14,fontWeight:p().Ue.medium},appDownloadButton:{fontSize:14,marginLeft:-5},appDownloadIcon:{width:14,height:14,marginRight:6},actions:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8},alwaysOpenLinks:{display:"flex",alignItems:"center"},alwaysOpenLinksLabel:{marginLeft:6},alwaysOpenLinksButton:{paddingLeft:12,paddingRight:12,height:34,marginLeft:12}})),[]);return(0,l.jsx)(T().ZP,{popupType:T().kQ.Popup,placementToOrigin:S().Placement.Bottom,origin:(0,l.jsx)("div",{style:$.origin}),originGap:q?-x().tL/2:0,disableMouseCapture:!0,open:W,style:$.container,render:()=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{style:$.header,children:[(0,l.jsx)(P().Z,{style:$.headerText,children:(0,l.jsx)(m()._H,{id:"openInDesktopAppPopup.header",defaultMessage:"Open in Notion's desktop app?"})}),(0,l.jsx)(j().Z,{ariaLabel:t.formatMessage({id:"openInDesktopAppPopup.closeButton",defaultMessage:"Dismiss"}),icon:c().D,onClick:()=>{w().Z.setState("never"),N(!0),g().Zy(e)}})]}),(0,l.jsx)(k().Z,{external:!0,onClick:()=>{Y.current&&(h().c4({environment:e,url:Y.current,openInNew:"tab"}),g().iD(e))},children:(0,l.jsxs)(_().Z,{style:$.appDownloadButton,children:[d($.appDownloadIcon),(0,l.jsx)("span",{children:(0,l.jsx)(m()._H,{id:"openInDesktopAppPopup.appDownloadButton",defaultMessage:"Don't have the app? Download"})})]})}),(0,l.jsxs)("div",{style:$.actions,children:[(0,l.jsxs)("div",{style:$.alwaysOpenLinks,children:[(0,l.jsx)(C().Z,{checked:n,size:16,onClick:()=>{Z(!n)}}),(0,l.jsx)(P().Z,{isInline:!0,style:$.alwaysOpenLinksLabel,children:(0,l.jsx)(m()._H,{id:"openInDesktopAppPopup.alwaysOpenLinksLabel",defaultMessage:"Always open in app",values:{strongtext:e=>(0,l.jsx)("strong",{children:e})}})})]}),(0,l.jsx)(I().Z,{style:$.alwaysOpenLinksButton,onClick:()=>{w().Z.setState(n?"always":"never"),N(!0),h().RX({url:(0,v().W)(window.location.href),environment:e}),g().LC(e,{always_open_in_app:n})},children:(0,l.jsx)(m()._H,{id:"openInDesktopAppPopup.openInAppButton",defaultMessage:"Open in app",values:{strongtext:e=>(0,l.jsx)("strong",{children:e})}})})]})]}),onClosed:()=>{L.updateCalloutStatus({calloutId:"desktop_preference_popup",visible:!1})}})}},831951:(e,t,n)=>{n.r(t),n.d(t,{OutlinerDropdownMenuButton:()=>G,useSortActions:()=>$});n(241792);var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(846550),s=()=>n(827282),l=n(785893);const d={viewBox:"0 0 20 20",svg:(0,l.jsx)("path",{d:"M14.075 3.45a.625.625 0 0 0-.884 0l-3.497 3.5a.625.625 0 0 0 .883.884l2.431-2.431v10.705a.625.625 0 0 0 1.25 0V5.402l2.431 2.43a.625.625 0 1 0 .884-.883zM2.427 12.167a.625.625 0 0 1 .884 0l2.43 2.431V3.893a.625.625 0 0 1 1.25 0v10.705l2.431-2.43a.625.625 0 0 1 .884.883L6.81 16.55a.625.625 0 0 1-.884 0l-3.498-3.498a.625.625 0 0 1 0-.884"})},c=(0,s().IU)("arrowUpDown",d),u={viewBox:"0 0 20 20",svg:(0,l.jsx)("path",{d:"M15.784 4.002a.625.625 0 0 1 .214.857L9.445 15.784a.625.625 0 0 1-1.01.085l-4.37-5.098a.625.625 0 0 1 .948-.814l3.806 4.44 6.109-10.181a.625.625 0 0 1 .857-.214"})},m=(0,s().IU)("checkmark",u);var p=()=>n(641772);const g={viewBox:"0 0 20 20",svg:(0,l.jsx)("path",{d:"M8.848 3.084c.34.06.567.384.507.724l-.61 3.467h3.42l.65-3.684a.625.625 0 0 1 1.23.217l-.61 3.467h2.435a.625.625 0 1 1 0 1.25h-2.655l-.52 2.95h2.435a.625.625 0 1 1 0 1.25h-2.655l-.65 3.683a.625.625 0 0 1-1.23-.217l.61-3.466h-3.42l-.65 3.683a.625.625 0 0 1-1.23-.217l.61-3.466H4.13a.625.625 0 1 1 0-1.25h2.605l.52-2.95H4.87a.625.625 0 1 1 0-1.25h2.605l.65-3.684a.625.625 0 0 1 .723-.507m2.578 8.39.52-2.95H8.523l-.52 2.95z"})},f=(0,s().IU)("number",g),h={viewBox:"0 0 20 20",svg:(0,l.jsx)("path",{d:"M10.625 3.75a.625.625 0 1 0-1.25 0v5.625H3.75a.625.625 0 1 0 0 1.25h5.625v5.625a.625.625 0 1 0 1.25 0v-5.625h5.625a.625.625 0 1 0 0-1.25h-5.625z"})},v=(0,s().IU)("plus",h);var y=()=>n(993407),b=()=>n(625230),x=()=>n(788860),S=()=>n(313351),M=()=>n(381140),w=()=>n(636340),C=()=>n(269299),j=()=>n(221662),k=()=>n(286338),T=()=>n(352230),I=()=>n(906591),_=()=>n(91502),P=()=>n(466970),Z=()=>n(79685),A=()=>n(702041),R=()=>n(855238),B=()=>n(746324),L=()=>n(876822),D=()=>n(711112);const V=(0,x().vU)({move:{id:"useMoveSidebarAction.title.moveSection",defaultMessage:"Move section"},moveUp:{id:"useMoveSidebarAction.option.moveUp",defaultMessage:"Move up"},moveDown:{id:"useMoveSidebarAction.option.moveDown",defaultMessage:"Move down"}});var O=()=>n(959005),U=()=>n(764189),N=()=>n(44556),F=()=>n(149809),H=()=>n(154186),K=()=>n(448419),E=()=>n(198829),W=()=>n(388284);const z=(0,x().vU)({manual:{id:"outlinerDropdownMenuButton.sort.manual",defaultMessage:"Manual"},lastEdited:{id:"outlinerDropdownMenuButton.sort.lastEdited",defaultMessage:"Last edited"}});function G(e){const{type:t,spaceViewStore:n}=e,a=(0,i().O7)(),s=(0,r().yK)((e=>({button:{display:"flex",alignItems:"center",justifyContent:"center",height:20,width:20,borderRadius:4},icon:{fill:e.mediumIconColor,height:14,width:14}})),[]),d=(0,o.useCallback)((()=>{O().Z.setState({open:!0}),M().Mk(a,{outliner_type:I().iE[t]})}),[a,t]),c=(0,o.useCallback)((()=>{O().Z.setState({open:!1})}),[]),u=(0,x().YB)().formatMessage({id:"outlinerDropdownMenuButton.ariaLabel",defaultMessage:"Open menu"});return(0,l.jsx)(K().ZP,{popupType:K().Z4.Popup,alignmentToOrigin:K().vR.Start,renderOrigin:e=>(0,l.jsx)(H().Z,{style:s.button,ariaLabel:u,...e,children:(0,p().o)(s.icon)}),onClick:d,onClose:c,render:e=>(0,l.jsx)(Y,{type:t,spaceViewStore:n,onClose:()=>{e.close()}}),originGap:2})}const q=(0,x().vU)({sort:{id:"outlinerDropdownMenu.sort",defaultMessage:"Sort"},truncationLimit:{id:"outlinerDropdownMenu.truncationLimit",defaultMessage:"Show"},addTeam:{id:"outlinerDropdownMenu.addTeam",defaultMessage:"New teamspace"}});function Y(e){const{type:t,spaceViewStore:n,onClose:o}=e,s=(0,i().O7)(),d=(0,x().YB)(),u=(0,r().yK)((e=>({rightText:{fontSize:12,color:e.text.secondary}})),[]),p=(0,a().VK)((()=>(0,k().mq)(s)),[s]),g=(0,a().VK)((()=>(0,I().S4)({spaceViewStore:n,type:t})),[n,t]),h=g.sortOption,j=g.truncationLimit,P="shared"===t&&p||"private"===t||"teamspaces"===t,O="private"===t||"shared"===t&&p,H=(0,a().VK)((()=>!U().n.state),[]),K=(0,a().VK)((()=>{const{currentSpaceStore:e}=L().default.state;return!!e&&(0,_().Xq)({environment:s,spaceStore:e})}),[s]),G=H&&"teamspaces"===t&&K,Y=$({type:t,onSelect:o,spaceViewStore:n,outlinerLocation:"sidebar"}),Q=function(e){const{type:t,spaceViewStore:n,onSelect:o}=e,s=(0,i().O7)(),d=(0,r().yK)((()=>({icon:{width:16,height:16},right:{width:16}})),[]),c=(0,a().VK)((()=>(0,I().S4)({type:t,spaceViewStore:n}).truncationLimit),[t,n]);return y().Wy.map((e=>(0,S().cN)({key:e.toString(),displayName:void 0,analyticsName:e.toString(),validators:[],closeParentMenu:!0,action:()=>{C().createAndCommit({userAction:"OutlinerDropdownMenuButton.setTruncationLimit",environment:s,canUndo:!0,perform:o=>{const i=n.getSettingsStore().getKeyStore("sidebar_section_menu").getKeyStore("truncationLimit").getKeyStore(t);w().sO({transaction:o,store:i,value:e})}}),b().j({name:"update_sidebar_section_option",args:{option:"show",type:t}}),M().hH(s,{outliner_type:I().iE[t],option:e}),o()},render:t=>(0,l.jsx)(R().Z,{...t,title:(0,l.jsx)(J,{limit:e,withItems:!0}),right:c===e&&m(d.icon),rightStyle:d.right})})))}({type:t,onSelect:o,spaceViewStore:n}),X=function(e){const{type:t,onSelect:n}=e,o=(0,a().VK)((()=>L().default.state.currentSpaceStore),[]),r=(0,a().VK)((()=>L().default.state.currentSpaceViewStore),[]),s=(0,a().VK)((()=>L().default.state.currentUserRootStore),[]),d=(0,x().YB)(),c=(0,i().O7)(),u=(0,B().Q)(),m=(0,D().f)(),p=(0,a().VK)((()=>(0,k().Tg)({environment:c,spaceStore:o,userRootStore:s})),[c,o,s]),g=(0,I().DP)({sidebarOrder:m,sidebarState:u,showLockedSidebar:p});if(!r)return[];const f=g.indexOf(t),h=0===f,v=f===g.length-1,y=(null==u?void 0:u.shownSidebarSectionCount)??0;return["moveUp","moveDown"].map((e=>{const o=V[e];return(0,S().cN)({key:e,displayName:void 0,analyticsName:o.defaultMessage,validators:[()=>y>1],closeParentMenu:!0,action:o=>{let{environment:i}=o;const a=function(e){let{sidebarSection:t,selectedMoveOption:n,sidebarOrder:o,visibleSidebarOrder:i}=e;const a=[...o],r=o.indexOf(t),s=i.indexOf(t);if("moveUp"===n&&s>0){const e=i[s-1];a[o.indexOf(e)]=t,a[r]=e}if("moveDown"===n&&s<i.length-1){const e=i[s+1];a[o.indexOf(e)]=t,a[r]=e}return a}({sidebarSection:t,selectedMoveOption:e,sidebarOrder:m,visibleSidebarOrder:g});C().createAndCommit({userAction:`useMoveSidebarAction.${e}`,environment:i,canUndo:!0,perform:e=>{w().sW({store:r,data:{sidebar_order:a},transaction:e})}}),M().mv(i,{section:t,previous_order:m,new_order:a,from:"outliner_section_menu"}),n()},render:t=>{const n="moveUp"===e&&h||"moveDown"===e&&v,i="moveUp"===e?A().R:Z().j;return(0,l.jsx)(R().Z,{...t,disabled:n,disabledFeedback:n,title:d.formatMessage(o),svg:i})}})}))}({type:t,onSelect:o}),ee=[(0,S().MV)({key:"sort",displayName:q.sort,analyticsName:q.sort.defaultMessage,validators:[()=>O],svg:c,right:d.formatMessage(z[h]),rightStyle:u.rightText,subActions:()=>[(0,S().$J)({key:"sort",render:e=>(0,l.jsx)(W().Z,{...e}),actions:Y})]}),(0,S().MV)({key:"truncationLimit",displayName:q.truncationLimit,analyticsName:q.truncationLimit.defaultMessage,validators:[()=>P],svg:f,right:(0,l.jsx)(J,{limit:j}),rightStyle:u.rightText,subActions:()=>[(0,S().$J)({key:"truncationLimit",render:e=>(0,l.jsx)(W().Z,{...e}),actions:Q})]}),...X],te=[(0,S().$J)({key:"all",render:e=>(0,l.jsx)(W().Z,{...e}),actions:ee}),(0,S().$J)({key:"addTeam",render:e=>(0,l.jsx)(W().Z,{...e}),actions:[(0,S().cN)({key:"addTeam",displayName:q.addTeam,analyticsName:q.addTeam.defaultMessage,validators:[()=>G],svg:v,closeParentMenu:!0,action:()=>{(0,N().lo)("sidebar_team_section"),o()}})]})];return(0,l.jsx)(E().Z,{menuType:T().o.Popup,minWidth:220,children:(0,l.jsx)(F().Z,{context:{blocks:[],environment:s,publicEditMode:void 0},sections:te,initialFocus:void 0})})}function $(e){const{type:t,spaceViewStore:n,onSelect:o,outlinerLocation:s}=e,d=(0,i().O7)(),c=(0,x().YB)(),{currentSpaceStore:u}=(0,a().Kw)(L().default),p=d.currentUser.id,g=(0,P().E)("sidebar_add_new_pages_to_bottom"),f=(0,a().VK)((()=>(0,I().S4)({type:t,spaceViewStore:n}).sortOption),[t,n]),h=(0,r().yK)((()=>({icon:{width:16,height:16},right:{width:16}})),[]);return["manual","lastEdited"].map((e=>{const i=z[e];return(0,S().cN)({key:e,displayName:void 0,analyticsName:i.defaultMessage,validators:[],closeParentMenu:!0,action:async()=>{C().createAndCommit({userAction:"OutlinerDropdownMenuButton.setSortOption",environment:d,canUndo:!0,perform:o=>{const i=n.getSettingsStore().getKeyStore("sidebar_section_menu").getKeyStore("sortOption").getKeyStore(t);w().sO({transaction:o,store:i,value:e})}}),"manual"===e&&"shared"===t&&!g&&p&&u&&await j().l({environment:d,spaceId:u.id,userId:p}),b().j({name:"update_sidebar_section_option",args:{option:"sort",type:t}}),M().NQ(d,{outliner_type:I().iE[t],outliner_location:s,option:e}),o()},render:t=>(0,l.jsx)(R().Z,{...t,title:c.formatMessage(i),right:f===e&&m(h.icon),rightStyle:h.right})})}))}function J(e){const{limit:t,withItems:n}=e;return t===y().Ng?(0,l.jsx)(x()._H,{id:"outlinerDropdownMenuButton.truncationLimit.noTruncation",defaultMessage:"All"}):n?(0,l.jsx)(x()._H,{id:"outlinerDropdownMenuButton.truncationLimit",defaultMessage:"{limit} items",values:{limit:t}}):(0,l.jsx)("span",{children:t})}},293660:(e,t,n)=>{n.r(t),n.d(t,{CloseTemplatesPopupComponent:()=>ve,default:()=>le});var o=()=>n(629756),i=n(667294),a=()=>n(219727),r=()=>n(142735),s=()=>n(846550),l=()=>n(793331),d=()=>n(984478),c=()=>n(328714),u=()=>n(788860),m=()=>n(18610),p=()=>n(707513),g=()=>n(799454),f=()=>n(308186),h=()=>n(241516),v=()=>n(102182),y=()=>n(770455),b=()=>n(943184),x=()=>n(374327);function S(){return"web-mobile"===(0,a().Fy)().deviceType}var M=()=>n(518172),w=()=>n(851898),C=()=>n(876822),j=()=>n(21688),k=()=>n(482162),T=()=>n(263184);class I extends T().default{getInitialState(){return{inMemoryRecordCache:new(n(66077).Z)({name:"TemplateRecordCacheStore"})}}}var _=()=>n(38812),P=()=>n(154186),Z=()=>n(1910),A=()=>n(312578),R=(n(122556),n(582845),n(250570),n(533019),n(721473),n(788208),n(22624),n(241792),()=>n(217465)),B=()=>n(54193),L=()=>n(396136),D=()=>n(696056),V=()=>n(81954),O=()=>n(989478),U=()=>n(955620),N=()=>n(824462),F=()=>n(430310),H=()=>n(844085),K=()=>n(694389),E=()=>n(205228),W=()=>n(41340),z=()=>n(718959),G=()=>n(886970);class q extends T().default{getInitialState(){return{}}}const Y=q;var $=()=>n(311562),J=()=>n(826955),Q=()=>n(18281),X=()=>n(897257),ee=()=>n(842574),te=()=>n(778447),ne=()=>n(299519),oe=n(785893);const ie=function(e){let{style:t,disabled:o,disablePointerEvents:s,previewRootId:l,isPaidTemplate:d,requiresEmailCapture:c,userHasAcquiredTemplate:m,templateRecordCacheStore:p}=e;const g=(0,a().O7)(),f=(0,r().qz)(p,I),h=(0,r().qz)(void 0,Y),v=(0,r().Kw)(n(804217).default),y=(0,i.useCallback)(((e,n)=>(0,oe.jsx)(re,{err:e,store:n,style:t,disabled:o,disablePointerEvents:s,isPaidTemplate:d,requiresEmailCapture:c,userHasAcquiredTemplate:m,pageTemplatePreviewStore:h})),[t,o,s,h,d,c,m]),b=(0,i.useCallback)((e=>async function(e,t,n,o){if(o){return new(J().G)(t,{table:L().iU,id:e})}const i=await N().callApi({eventName:"loadBlockSubtree",environment:t,data:{block:{id:e,spaceId:(0,V().J)(void 0)},shallow:!1}});if("failed"===i.type)throw i.error;const{currentSpaceStore:a}=C().default.state,r=X().subscriptionDataStoreInstance.state,{inMemoryRecordCache:s}=n.state;s.clearCache(),s.isTemplatePreview=!0;const l=new Set,d=new Set,c=R().RecordMapWithRole.create(i.data.subtreeRecordMap);for(const f of c){const{pointer:e,model:n,role:o}=f;if(!o)return;if(s.setModelAndRole({pointer:e,userId:t.currentUser.id},n,"editor"),(null==n?void 0:n.table)===L().iU){const e=n.getProperties();for(const t of Object.keys(e)){const n=(0,U().lcG)(e[t]);for(const e of n)l.add(e);const o=(0,U().zyy)(e[t]);for(const e of o)d.add(e)}n.created_by_table&&n.created_by_id&&(n.created_by_table===O().KJ?l.add(n.created_by_id):d.add(n.created_by_id)),n.last_edited_by_table&&n.last_edited_by_id&&(n.last_edited_by_table===O().KJ?l.add(n.last_edited_by_id):d.add(n.last_edited_by_id))}}if(r)for(const f of(0,Q().CM)(r))l.add(f.userId);const u=await Promise.all(Array.from(l).map((async e=>{if(a){const t=J().U6.createChildStore(a,{table:O().KJ,id:e});await t.load();return t.getValue()}{const n=await(0,F().Y)(t,{pointer:{table:O().KJ,id:e},userId:t.currentUser.id,version:-1});return n&&n.value}})));for(const f of u)f&&s.setRecord({pointer:{table:O().KJ,id:f.id},userId:t.currentUser.id},{role:"reader",value:f});const m=await Promise.all(Array.from(d).map((async e=>{if(a){const t=(0,J().Kv)(a,{table:D().cZ,id:e,spaceId:a.id});await t.load();return t.getValue()}{const n=await(0,F().Y)(t,{pointer:{table:D().cZ,id:e},userId:t.currentUser.id,version:-1});return n&&n.value}})));for(const f of m)f&&s.setRecord({pointer:{table:D().cZ,id:f.id,spaceId:f.space_id},userId:t.currentUser.id},{role:"reader",value:f});const{currentUserStore:p}=C().default.state;p&&(await p.load(),s.setRecord({pointer:p.pointer,userId:t.currentUser.id},{role:"editor",value:p.getValue()}));const g=new(J().G)(t,{table:L().iU,id:e},{inMemoryRecordCache:s});return g}(e,g,f,o)),[g,f,o]),x=(0,i.useCallback)((e=>function(e,t,n){const{device:o}=t,i=(0,B().parseRoute)({url:e,isMobile:o.isMobile,baseUrl:E().default.domainBaseUrl,publicDomainName:E().default.publicDomainName,protocol:E().default.protocol,currentUrl:window.location.href});"page"===i.name&&(i.peekViewBlockId?n.setState({...n.state,navigatedRootId:i.peekViewBlockId}):n.setState({...n.state,navigatedRootId:i.blockId}))}(e,g,h)),[g,h]);return v.online?(0,oe.jsx)(W().L,{value:x,children:(0,oe.jsx)(n(154439).Z,{request:l,performRequest:b,render:y})}):(0,oe.jsx)(W().L,{value:x,children:(0,oe.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",...t},children:(0,oe.jsx)(n(67961).Z,{isSmall:!0,children:(0,oe.jsx)(u()._H,{defaultMessage:"Please go online to view this template.",id:"pageTemplatePreview.offline.message"})})})})};function ae(e){const{device:t}=e;return{flex:1,...t.isSafari&&{zIndex:1}}}function re(e){let{store:t,style:n,disabled:o,disablePointerEvents:s,isPaidTemplate:l,requiresEmailCapture:d,userHasAcquiredTemplate:c,pageTemplatePreviewStore:m}=e;const p=(0,a().O7)(),g=(0,r().qz)(m,Y),f=(0,r().VK)((()=>g.state.navigatedRootId),[g]),h=S(),y=(0,r().VK)((()=>t&&(0,z().Zy)({environment:p,store:t})),[p,t]);if((0,i.useEffect)((()=>{const e=l&&!h,t=!l&&d&&!c;e&&v().oV({label:(0,oe.jsx)(u()._H,{defaultMessage:"Purchase is unavailable on this platform",id:"pageTemplatePreview.paidTemplate.message"}),durationMs:"keep"}),t&&v().oV({label:(0,oe.jsx)(u()._H,{defaultMessage:"Unable to get template on this platform",id:"pageTemplatePreview.requiresEmailCapture.message"}),durationMs:"keep"}),e||t||v().rN()}),[p,l,d,h,c]),t&&y){let e;return e=f?J().G.createChildStore(t,{table:L().iU,id:f}):t,(0,oe.jsx)("div",{style:n,children:(0,oe.jsx)(ne().Z,{store:e,isDefaultContainer:!0,droppable:!0,render:t=>{let{selectableEvents:n,selectableHoverMenuOverlay:i}=t;return(0,oe.jsx)(ee().T,{style:ae(p),type:y,store:G().Z,preventType:H().Q7(p),...n,children:s?(0,oe.jsxs)("section",{inert:"",children:[i,(0,oe.jsx)(te().ZP,{store:e,context:$().S.InAppTemplatePreview,paddingBottom:(0,te().EA)(p),disabled:o})]}):(0,oe.jsxs)(oe.Fragment,{children:[i,(0,oe.jsx)(te().ZP,{store:e,context:$().S.InAppTemplatePreview,paddingBottom:(0,te().EA)(p),disabled:o})]})},e.id)}},e.id)})}return(0,oe.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",...n},children:(0,oe.jsx)(A().Z,{legacySize:K().T})})}const se={width:"100%",flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",overflow:"hidden"};const le=function(){const e=(0,a().O7)(),t=(0,r().qz)(void 0,I),o=(0,i.useCallback)((()=>pe(e,t)),[e,t]),s=(0,i.useCallback)((()=>(0,oe.jsx)(ge,{templateRecordCacheStore:t})),[t]),{device:l}=e,d=(0,r().Kw)(j().Z),c=(0,r().VK)((()=>C().default.state.currentSpaceViewStore),[]);return(0,i.useEffect)((()=>{d.open&&c&&n(269299).createAndCommit({userAction:"PageTemplateModal.willMountOrUpdate",environment:e,canUndo:!0,perform:e=>{h().setTemplateVisited({item:d.item,spaceViewStore:c,transaction:e})}})}),[c,e,d.item,d.open]),l.isMobile?(0,oe.jsx)(n(967092).ZP,{open:d.open,render:s,forceFullScreenSlideUp:!0,onDismiss:o,popupType:n(104088).k.SlideUp}):null};function de(){return new Promise(((e,t)=>{f().vC({message:(0,oe.jsx)(u()._H,{id:"pageTemplateModal.modifiedTemplateDialog.prompt",defaultMessage:"It looks like you've modified the template. Would you like to save your edits?"}),showCancel:!1,keepFocus:!0,items:[{label:(0,oe.jsx)(u()._H,{id:"pageTemplateModal.modifiedTemplateDialog.saveButton.label",defaultMessage:"Save edits"}),onAccept:()=>{e(!0)}},{label:(0,oe.jsx)(u()._H,{id:"pageTemplateModal.modifiedTemplateDialog.discardEditsButton.label",defaultMessage:"Discard"}),color:"red",onAccept:()=>{e(!1)}}]})}))}function ce(e){h().close(e),g().LZ()}function ue(e){var t,n,o;let{modalState:i,templateRecordCacheStore:a}=e;const s=(0,r().qz)(a,I);return(0,oe.jsx)(ie,{disablePointerEvents:i.disablePointerEvents,previewRootId:i.item.previewRootId,isPaidTemplate:!(null===(t=i.item.marketplaceTemplateMetadata)||void 0===t||!t.isPaidTemplate),requiresEmailCapture:!(null===(n=i.item.marketplaceTemplateMetadata)||void 0===n||!n.requiresEmailCapture),userHasAcquiredTemplate:!(null===(o=i.item.marketplaceTemplateMetadata)||void 0===o||!o.userHasAcquiredTemplate),style:se,templateRecordCacheStore:s,disabled:!0},i.item.previewRootId)}function me(e,t,n){const{inMemoryRecordCache:o}=n.state,i=j().Z.state,{currentSpaceViewStore:a,currentSpaceStore:r,mainEditorCurrentBlockStore:s}=C().default.state;if(i.open&&a&&r){const n=s&&s.isEmptyPage()?s:void 0,l=k().default.state.open&&k().default.state.targetStore&&k().default.state.targetStore.isEmptyPage()?k().default.state.targetStore:void 0;h().accept({environment:t,item:i.item,spaceStore:r,spaceViewStore:a,useRecordCache:e?o:void 0,initializeStore:i.createNewPage?void 0:n||l,isPrivate:i.isPrivate,acceptFrom:i.createNewPage?"sidebar":"newPage"})}}async function pe(e,t){const{inMemoryRecordCache:n}=t.state;if(v().rN(),n.appliedTransaction){await de()?me(!0,e,t):ce(e)}else ce(e)}function ge(e){var t,n,d,c;let{templateRecordCacheStore:p}=e;const g=(0,a().O7)(),f=(0,u().YB)(),h=(0,s().Fg)(),k=S(),T=(0,r().VK)((()=>{var e;return(null===(e=C().default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.preferred_locale)||m().al}),[]),I=(0,i.useCallback)((()=>async function(e,t){var n,o,i,a;const{inMemoryRecordCache:r}=t.state;if(r.appliedTransaction)return void me(!!(await de()),e,t);const s=null===(n=j().Z.state.item)||void 0===n||null===(n=n.marketplaceTemplateMetadata)||void 0===n?void 0:n.isPaidTemplate,l=null===(o=j().Z.state.item)||void 0===o||null===(o=o.marketplaceTemplateMetadata)||void 0===o?void 0:o.marketplaceListingId,d=null===(i=j().Z.state.item)||void 0===i||null===(i=i.marketplaceTemplateMetadata)||void 0===i?void 0:i.userHasAcquiredTemplate,c=null===(a=j().Z.state.item)||void 0===a?void 0:a.id;if(j().Z.state.open&&s&&l&&c&&!d)return M().Z.setState({...M().Z.state,from:"mobileApp",marketplaceListingId:l,templateId:c}),void j().Z.setState({...j().Z.state,isCheckout:!0});!d&&s||me(!1,e,t)}(g,p)),[g,p]),P=(0,i.useCallback)((()=>pe(g,p)),[g,p]),Z=(0,i.useCallback)((()=>{v().rN(),j().Z.state.open&&j().Z.setState({...j().Z.state,isCheckout:!1}),M().Z.setState({...M().Z.state,isModalOpen:!1,from:void 0,marketplaceListingId:void 0,templateId:void 0,creatorId:void 0,customerId:void 0})}),[]),R=(0,r().Kw)(j().Z),B=(0,r().VK)((()=>w().Z.state.duplicationStatus),[]);if(!R.open)return null;const L="duplicating"===B,D=null===(t=R.item.marketplaceTemplateMetadata)||void 0===t?void 0:t.isPaidTemplate,V=null===(n=R.item.marketplaceTemplateMetadata)||void 0===n?void 0:n.paidTemplatePrice,O=null===(d=R.item.marketplaceTemplateMetadata)||void 0===d?void 0:d.requiresEmailCapture,U=null===(c=R.item.marketplaceTemplateMetadata)||void 0===c?void 0:c.userHasAcquiredTemplate,N=(0,x().IK)(h,T);return(0,oe.jsx)(y().rZ,{title:R.isCheckout?(0,oe.jsx)(u()._H,{defaultMessage:"Complete checkout",id:"pageTemplateModal.mobileModal.checkoutTitle"}):void 0,left:R.isCheckout?(0,oe.jsx)(he,{handleClick:Z}):(0,oe.jsx)(ve,{handleClick:P,style:{marginLeft:20}}),right:R.isLoading?(0,oe.jsx)(A().Z,{style:{marginRight:40}}):R.isCheckout?null:(0,oe.jsx)(fe,{handleClick:I,isDisabled:L||D&&!k||!D&&!!O&&!U,label:U?(0,oe.jsx)(u()._H,{id:"inApp.marketplace.template.addAgain",defaultMessage:"Add again"}):D&&V?(0,oe.jsx)(u()._H,{id:"inApp.marketplace.template.buyTemplate",defaultMessage:"Buy for <money></money>",values:{money:()=>(0,oe.jsx)(l().W,{cost:{amount:100*V,currencyCode:"USD"},intl:f,trailingZeroDisplay:"auto"})}}):void 0}),shouldRenderLeftDirectly:!0,shouldRenderRightDirectly:!0,onCancel:P,disableHeaderShadow:!0,forceFullScreenSlideUp:!0,children:R.isCheckout?(0,oe.jsx)(o().Elements,{stripe:(0,_().getStripe)(),options:N,children:(0,oe.jsx)(b().n,{})}):(0,oe.jsx)(ue,{templateRecordCacheStore:p,modalState:R})})}function fe(e){let{handleClick:t,isDisabled:n,label:o}=e;const i=(0,s().yK)((e=>({doneButton:{display:"flex",alignItems:"center",height:34,paddingLeft:14,paddingRight:14,marginRight:20,fontWeight:p().Ue.medium,color:n?e.text.secondary:e.text.primary,background:e.tint.regular,borderRadius:17}})),[n]);return(0,oe.jsx)(P().Z,{mobileFeedback:!0,style:i.doneButton,onClick:t,disabled:n,children:o||(0,oe.jsx)(u()._H,{defaultMessage:"Use template",id:"pageTemplateModal.mobileModal.useTemplateButton.label"})})}function he(e){let{handleClick:t}=e;const n=(0,u().YB)(),o=(0,s().yK)((e=>({iconButton:{borderRadius:17,width:34,height:34,marginLeft:20},icon:{width:20,height:20}})),[]);return(0,oe.jsx)(Z().Z,{icon:e=>(0,d().f)(o.icon),style:o.iconButton,isDarkIconColor:!0,onClick:t,ariaLabel:n.formatMessage({defaultMessage:"Back",id:"pageTemplateModal.mobileModal.checkout.backButton.label"})})}function ve(e){let{handleClick:t,style:n,disabled:o}=e;const i=(0,s().Fg)(),a=(0,u().YB)(),r={background:i.tint.regular,borderRadius:17,width:34,height:34,...n};return(0,oe.jsx)(Z().Z,{disabled:o,icon:e=>(0,c().U)({width:20,height:20}),style:r,isDarkIconColor:!0,onClick:t,ariaLabel:a.formatMessage({defaultMessage:"Close",id:"pageTemplateModal.mobileModal.closeButton.label"})})}},407291:(e,t,n)=>{n.d(t,{Z:()=>u});n(241792);var o=n(667294),i=()=>n(142735),a=()=>n(788860),r=()=>n(88476),s=()=>n(852465),l=()=>n(301741),d=()=>n(122671),c=n(785893);const u=function(e){const{origin:t,permissionsInviteStore:u,store:m,handleClickRemoveToken:p,handleInputChange:g,handleInputSubmit:f,defaultRoleForNonBot:h,right:v,focus:y,handleFocus:b}=e,x=(0,i().VK)((()=>0!==(0,n(122479).eL)()),[]),S="share_menu"===t||"add_members"===t,M="add_members"===t,[w,C]=(0,i().AF)(u),j=(0,n(219727).O7)(),{device:k}=j,T=(0,a().YB)(),{tokenQuery:I}=w,_=(0,n(551861).S)(m),P=w.inviteTargets.map((e=>{const t="newUser"===e.type?e.value.email:`${e.type}-${e.value.id}`,i=(0,r().OA)(e),s="newUser"===e.type||"existingUser"===e.type?e.value.email:void 0,d=i?_:void 0,u={key:t,target:e,onClickRemove:p,role:w.inviteRole,shouldWrap:S,showInfoIcon:Boolean(d)};return S&&s?(0,c.jsx)(n(654133).Z,{placement:n(998901).Placement.Top,disableTooltip:M,renderTooltip:()=>i?d||(0,c.jsx)(a()._H,{defaultMessage:"{email} will be invited as a guest",id:"ContextualInvite.permissions_invites.guest.tooltip",values:{email:s}}):s,render:n=>(0,o.createElement)("span",{...n,key:t},(0,c.jsx)(l().Z,{...u,backgroundColor:(0,r().gQ)(e)}))},t):(0,o.createElement)(l().Z,{...u,key:t})}));return(0,c.jsx)(d().ZP,{focus:k.isMobile?void 0:y,focusInitial:k.isMobile,focusAfterAnimation:!0,onClick:()=>{k.isMobile||null==b||b()},format:d().UR.Share,value:I,onChange:g,type:"email",tokens:P,disabled:!1,autoComplete:"off",placeholder:S?x?T.formatMessage({defaultMessage:"Add people, groups, or emails…",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithTeams"}):T.formatMessage({defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots"}):(0,s().Mm)(m)||(0,s().R$)(m)?T.formatMessage({id:"inviteUserModal.searchInput.placeholder",defaultMessage:"Search name or emails"}):T.formatMessage({id:"permissionsInvite.searchInput.placeholder",defaultMessage:"Search emails, names, or groups"}),onRemoveLastToken:()=>{const e={...w};e.inviteTargets=e.inviteTargets.slice(0,-1),0===e.inviteTargets.length&&(e.isInviteTargetsEmpty=!0,e.inviteRole=h),C(w)},right:v,inputFullWidth:!0,inputAndTokenWrapRightStyle:{paddingTop:j.device.isMobile?0:w.isInviteTargetsEmpty?7:6,paddingBottom:j.device.isMobile||S?0:4},onEmptySubmit:()=>f(),dontShowBorderBottom:k.isAndroid,showBorder:S,...!S&&{style:{padding:"10px  9px 4px 9px"}},...S&&{style:{borderRadius:4,paddingTop:w.isInviteTargetsEmpty?3:0,paddingBottom:0,...y&&{background:"none"}}}})}},88556:(e,t,n)=>{n.r(t),n.d(t,{PermissionsInviteWithModal:()=>ve});var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(846550),s=()=>n(714230),l=()=>n(788860),d=()=>n(696459),c=()=>n(930085),u=()=>n(912732),m=()=>n(849129),p=()=>n(88476),g=()=>n(852465),f=()=>n(732811),h=()=>n(247724),v=()=>n(576387),y=()=>n(906651),b=()=>n(807463),x=n(785893);const S=function(e){const{permissionsInviteStore:t,onInviteClick:r,onInviteComplete:s,inviteOrigin:d,sudoModeStore:c}=e,u=(0,i().O7)(),p=(0,l().YB)(),g=(0,n(228772).r)(),f=(0,a().qz)(void 0,b().ZP),h=(0,a().VK)((()=>t.state.inviteTargets.length>0),[t]),v=(0,o.useCallback)((async()=>{g&&await m().qg({environment:u,store:g,sudoModeStore:c,permissionsInviteStore:t,contextualInviteStore:f,onInviteClick:r,onInviteComplete:s,inviteOrigin:d,intl:p})}),[f,u,p,d,r,s,t,g,c]);return(0,x.jsx)(y().Z,{onClick:v,disabled:!h,children:(0,x.jsx)(l()._H,{id:"spacePermissionsInviteButton.label",defaultMessage:"Send invite"})})};var M=()=>n(661641),w=()=>n(697623);const C=function(e){const{permissionsInviteStore:t}=e,i=(0,a().VK)((()=>(0,w().QM)()),[]),s=(0,o.useCallback)((()=>{t.reset()}),[t]),d=(0,r().yK)((()=>({container:{display:"flex",flexDirection:"column",gap:8},header:{display:"flex",justifyContent:"space-between"}})),[]);return(0,x.jsxs)("div",{style:d.container,children:[(0,x.jsxs)("div",{style:d.header,children:[(0,x.jsx)(M().q,{styleName:"Heading-17px/Semibold",children:(0,x.jsx)(l()._H,{id:"spacePermissionsInviteHeader.title",defaultMessage:"Invite members"})}),(0,x.jsx)(n(507159).Z,{onClose:s})]}),(0,x.jsx)(n(67961).Z,{isSecondaryColor:!0,isMultiline:!0,children:i?(0,x.jsx)(l()._H,{id:"spacePermissionsInviteHeader.freeDescription",defaultMessage:"Type or paste in emails below, separated by commas"}):(0,x.jsx)(l()._H,{id:"spacePermissionsInviteHeader.billedDescription",defaultMessage:"Type or paste in emails below, separated by commas. Your workspace will be billed by members."})})]})};n(670560),n(241792);var j=()=>n(374289),k=()=>n(827973),T=()=>n(448419),I=()=>n(198829),_=()=>n(255577),P=()=>n(967092),Z=()=>n(388284),A=()=>n(777814),R=()=>n(73478),B=()=>n(352230),L=()=>n(164079),D=()=>n(122479),V=()=>n(998901),O=()=>n(965014),U=()=>n(239823),N=()=>n(18281);function F(e){const{permissionsInviteStore:t}=e,n=(0,i().O7)(),s=(0,a().VK)((()=>{const e=(0,w().zt)();return(0,N().o9)(e)}),[]);(0,f().K)((()=>{s||t.setState({...t.state,isInviteTargetsEmpty:!0,inviteTargets:[],inviteRole:"read_and_write"})}));const d=(0,a().VK)((()=>t.state.inviteRole?t.state.inviteRole:s?"editor":"read_and_write"),[s,t]),c=(0,a().VK)((()=>{const e=["editor"];return(0,D().U7)()&&e.push("membership_admin"),s||e.push("read_and_write"),e}),[s]),u=(0,o.useCallback)((e=>{m().XC({environment:n,newRole:e,permissionsInviteStore:t})}),[n,t]),p=(0,r().yK)((e=>({menuItem:{width:"100%",backgroundColor:e.inputBackground,borderRadius:6,boxShadow:"rgba(15, 15, 15, 0.1) 0px 0px 0px 1px inset"},dropdownButton:{display:"flex",minHeight:34,margin:0,width:"100%"},dropdownButtonContent:{display:"flex",alignItems:"center"},selectedRole:{width:"100%",color:e.mediumTextColor},downIcon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]);function g(e){const t=c.map((t=>({key:t,render:e=>{var n;const o=(0,A().M)({type:"space_permission",table:"space",role:t,isRemovable:!1,isCurrentUser:!1});return(0,x.jsx)(k().Z,{title:o.label.defaultMessage,caption:null===(n=o.caption)||void 0===n?void 0:n.defaultMessage,shouldWrapCaption:!0,...e})},action:()=>{u(t),e.close()}})));return s&&t.push({key:"read_and_write",render:e=>(0,x.jsx)(H,{menuListItemProps:e}),action:()=>{e.close()}}),t}return(0,x.jsx)(T().ZP,{popupType:P().kQ.Popup,sameWidthAsOrigin:!0,render:e=>(0,x.jsx)(I().Z,{menuType:B().o.Popup,children:(0,x.jsx)(_().ZP,{type:_().iW.Vertical,initialFocus:void 0,sections:[{key:"roles",render:e=>(0,x.jsx)(Z().Z,{...e}),items:g(e)}]})}),renderOrigin:e=>(0,x.jsx)(k().Z,{style:p.menuItem,buttonStyle:p.dropdownButton,title:(0,x.jsxs)("div",{style:p.dropdownButtonContent,children:[(0,x.jsx)("div",{style:p.selectedRole,children:(0,x.jsx)(M().q,{styleName:"UIRegular-14px/Regular",children:(0,x.jsx)(l()._H,{...(0,A().M)({type:"space_permission",table:"space",role:d,isRemovable:!1,isCurrentUser:!1}).label})})}),(0,j().i)(p.downIcon)]}),focused:!1,...e})})}function H(e){let{menuListItemProps:t}=e;const n=(0,i().O7)(),a=(0,r().yK)((()=>({titleContainer:{display:"flex",alignItems:"center"},titleLabel:{marginRight:6}})),[]),d="space_permission_settings",c="plus",u=(0,o.useCallback)((()=>{(0,O().y)(n,{from:d,upsell:{type:"product",product:c,limit:{type:"none"}}})}),[n]),m=(0,x.jsx)(R().Z,{imageURL:s().Z.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:(0,x.jsx)(l()._H,{defaultMessage:"Members cannot change workspace settings or invite new members.",id:"spacePermissionsInviteRoleSection.spaceReadAndWriteUpgradeTooltip.caption"}),title:(0,x.jsx)(l()._H,{defaultMessage:"Upgrade to add non-admin members",id:"spacePermissionsInviteRoleSection.spaceReadAndWriteUpgradeTooltip.title"})});return(0,x.jsx)(U().Z,{requireUpgradeToTier:c,renderUpgradeTooltip:()=>m,analyticsName:d,tooltipPlacement:V().Placement.Left,render:(e,n)=>{var o;const{focused:i,...r}=(0,L().Z)(t,e),s=(0,A().M)({type:"space_permission",table:"space",role:"read_and_write",isRemovable:!1,isCurrentUser:!1});return(0,x.jsx)(k().Z,{...r,title:(0,x.jsxs)("div",{style:a.titleContainer,children:[(0,x.jsx)("div",{style:a.titleLabel,children:s.label.defaultMessage}),n]}),caption:null===(o=s.caption)||void 0===o?void 0:o.defaultMessage,shouldWrapCaption:!0,focused:i})},onClick:u})}const K=function(e){const t=(0,r().yK)((e=>({container:{display:"flex",flexDirection:"column",width:"100%",gap:8},roleText:{color:e.mediumTextColor}})),[]);return(0,x.jsxs)("div",{style:t.container,children:[(0,x.jsx)(M().q,{styleName:"UISmall-12px/Medium",customStyles:t.roleText,children:(0,x.jsx)(l()._H,{id:"spacePermissionsInviteRoleSection.label",defaultMessage:"Role"})}),(0,x.jsx)(F,{...e})]})};const E=function(e){const{inviteOrigin:t,onInviteClick:a,permissionsInviteStore:s}=e,l=(0,i().O7)();(0,f().K)((async()=>{await v().bi(l)}));const d=(0,o.useCallback)((()=>{s.setState({...s.state,inputFocus:"none"})}),[s]),c=(0,r().yK)((()=>({container:{maxWidth:460},body:{display:"flex",flexDirection:"column",gap:20,width:"100%"},footer:{display:"flex",justifyContent:"end"},description:{}})),[]);return(0,x.jsx)("div",{style:c.container,onClick:d,className:h().FJA,children:(0,x.jsx)(n(830581).sR,{header:(0,x.jsx)(C,{permissionsInviteStore:s}),footer:(0,x.jsx)("div",{style:c.footer,children:(0,x.jsx)(S,{inviteOrigin:t,onInviteClick:a,permissionsInviteStore:s})}),children:(0,x.jsxs)("div",{style:c.body,children:[(0,x.jsx)(n(335058).Z,{permissionsInviteStore:s}),(0,x.jsx)(K,{permissionsInviteStore:s})]})})})};var W=()=>n(873175),z=()=>n(620218),G=()=>n(897257),q=()=>n(923550),Y=()=>n(568017),$=()=>n(513670),J=()=>n(148126),Q=()=>n(345918),X=()=>n(356140),ee=()=>n(896014),te=()=>n(826955),ne=()=>n(661769),oe=()=>n(508181),ie=()=>n(370005),ae=()=>n(407291),re=()=>n(711658);function se(e){const{store:t,permissionsInviteStore:s,membersOnly:d,onUpgradeButtonClick:c,upgradeButtonName:u,inviteOrigin:p,onInviteClick:y}=e,b=(0,i().O7)();(0,f().K)((async()=>{await v().bi(b)}));const S=(0,a().VK)((()=>(0,g().Mm)(t)),[t]),M=(0,o.useCallback)((async()=>{await m().kL({environment:b,permissionsInviteStore:s,from:"share_menu"})}),[b,s]),w=(0,r().yK)((()=>({right:{color:Y().ZP.blue}})),[]);return(0,x.jsxs)(I().Z,{menuType:B().o.Modal,title:S?(0,x.jsx)(l()._H,{id:"inviteUserModal.addMemberMenu.title",defaultMessage:"Add members"}):(0,x.jsx)(l()._H,{id:"inviteUserModal.invitePersonMenu.title",defaultMessage:"Invite a person"}),right:(0,x.jsx)("div",{style:w.right,children:(0,x.jsx)(l()._H,{id:"inviteUserModal.mobile.inviteButton.label",defaultMessage:"Invite"})}),left:(0,x.jsx)(n(470386).CancelMenuText,{}),onClickLeft:M,onClickRight:y,header:(0,x.jsx)(le,{...e,inviteOrigin:p,onInviteClick:y}),className:h().FJA,children:[(0,x.jsx)(Z().Z,{title:(0,x.jsx)(l()._H,{id:"inviteUserModal.permissionLevel.title",defaultMessage:"Permission level"}),children:(0,x.jsx)(ue,{store:t,onUpgradeButtonClick:c,upgradeButtonName:u,permissionsInviteStore:s})}),(0,x.jsx)("div",{children:(0,x.jsx)(de,{store:t,permissionsInviteStore:s,membersOnly:d})}),(0,x.jsx)(ce,{})]})}function le(e){const{store:t,isSubscribed:n,onInviteClick:r,permissionsInviteStore:s,inviteOrigin:l}=e,d=(0,i().O7)(),u=(0,a().VK)((()=>p().xT({environment:d,store:t,isSubscribed:n})),[d,t,n]),g=(0,a().VK)((()=>{const e=s.state.inputFocus;return"invitee"===e||"invitee-popup-closed"===e}),[s]),f=(0,X().W)(),h=(0,ne().nL)({spaceId:f}),v=(0,o.useMemo)((()=>$().Ds((()=>{c().UW(d,{invite_flow_id:s.state.flowId,billingData:h,invite_origin:l})}),1e3)),[d,s,l,h]),y=(0,o.useCallback)((async e=>{v(),await m().jC({environment:d,event:e,permissionsInviteStore:s})}),[v,d,s]),b=(0,o.useCallback)((e=>{m().PV({targetToRemove:e,permissionsInviteStore:s,defaultRoleForNonBot:u})}),[u,s]);return(0,x.jsx)(ae().Z,{permissionsInviteStore:s,store:t,handleClickRemoveToken:b,handleInputChange:y,handleInputSubmit:r,origin:"share_modal",defaultRoleForNonBot:u,focus:g,handleFocus:()=>{}})}function de(e){const{store:t,permissionsInviteStore:n,membersOnly:o}=e,i=(0,a().VK)((()=>(0,g().OY)(t)),[t]),r=(0,a().VK)((()=>t instanceof te().G&&(0,Q().Q6)(t.getSpaceStore())),[t]);return(0,x.jsx)(re().Z,{permissionsInviteStore:n,store:t,defaultRoleForSpaceBot:"editor",shouldShowBots:i,shouldShowGroups:i,sectionRenderLimit:10,membersOnly:o,guestsMustBeRequested:r})}function ce(){return(0,x.jsx)(Z().Z,{topBorder:!0,disableDesktopPadding:!0,children:(0,x.jsx)(oe().Z,{title:(0,x.jsx)(l()._H,{id:"inviteUserModal.helpButton.caption",defaultMessage:"Learn how to invite people and set permissions"}),href:(0,J().UY)("guides.invitePerson"),analyticsFrom:"invite_person"})})}function ue(e){const t=(0,i().O7)(),{store:n,onUpgradeButtonClick:s,upgradeButtonName:l,permissionsInviteStore:d}=e,{inviteRole:c,table:u}=(0,a().VK)((()=>{const{inviteRole:e}=d.state;return{inviteRole:e,table:n.table}}),[d,n.table]),p=(0,a().VK)((()=>(0,ee().ow)(d.state)),[d]),f=(0,a().VK)((()=>(0,g().OY)(n)?n.getType():void 0),[n]),h=(0,a().VK)((()=>(0,g().Mm)(n)&&!n.canAdmin()),[n]),v=(0,o.useCallback)((e=>{m().XC({environment:t,newRole:e,permissionsInviteStore:d})}),[t,d]),y=(0,r().yK)((()=>({button:{display:"flex",whiteSpace:"nowrap",height:26,color:Y().ZP.uiGray}})),[]);return p||!c?null:(0,x.jsx)(ie().ZP,{disabled:h,role:c,table:u,type:"user_permission",blockType:f,isInvite:!0,onUpgradeButtonClick:s,upgradeButtonName:l,buttonStyle:y.button,isMenuItem:!0,onChange:v})}const me=o.memo(se);var pe=()=>n(542401),ge=()=>n(189265);function fe(e){const{store:t,origin:c,sudoModeStore:u,onInviteComplete:f,onInviteClick:h}=e,y=(0,i().O7)(),{isMobile:S}=y.device,M=(0,l().YB)(),C=(0,a().VK)((()=>{var e;return null===(e=n(876822).default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),j=(0,n(595976).p)({spaceId:C}),k=(0,a().qz)(e.permissionsInviteStore,n(223023).Z),T=(0,a().VK)((()=>k.state.modalOpen),[k]),I=e.analyticsFrom,_=(0,a().qz)(void 0,b().ZP),P=(0,o.useCallback)((async()=>{const e=z().default.DO_NOT_USE_markLegacy("share_menu.invite_user_lag");await m().qg({environment:y,store:t,sudoModeStore:u,permissionsInviteStore:k,contextualInviteStore:_,onInviteClick:h,onInviteComplete:f,inviteOrigin:I,intl:M}),z().default.DO_NOT_USE_measureLegacy(e,{environment:y})}),[y,t,u,k,_,h,f,I,M]);(0,o.useEffect)((()=>{T&&!(0,d().$K)(G().subscriptionDataStoreInstance.state)&&v().bi(y)}),[y,T]);const Z=(0,a().VK)((()=>Boolean(t.canEditMembership())),[t]),A=(0,a().VK)((()=>Z&&(0,g().Mm)(t)&&(0,d().$K)(G().subscriptionDataStoreInstance.state)&&!w().Mk()),[Z,t]),B=(0,a().VK)((()=>function(e){let{store:t,canEditMembership:n,showUpgrade:o}=e;if(!n&&(0,g().Mm)(t))return(0,x.jsx)(l()._H,{id:"inviteUserButton.tooltip.adminsOnlyMessage",defaultMessage:"Only admins can add members."});if(!n)return(0,x.jsx)(l()._H,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."});if(o)return(0,x.jsx)(R().Z,{imageURL:s().Z.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:(0,x.jsx)(l()._H,{defaultMessage:"Members are teammates you invite to your workspace. They can access and add pages for all members to see, or be added to pages with permissions for private collaboration.",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.caption"}),title:(0,x.jsx)(l()._H,{defaultMessage:"Upgrade to add members",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.title"})});return null}({store:t,canEditMembership:Z,showUpgrade:A})),[Z,A,t]),L=(0,o.useCallback)((()=>async function(e,t,n,o){const i=await(0,p().Aw)({environment:e,permissionsInviteStoreState:n.state,from:o??((0,g().Mm)(t)?"space_share_modal":"page_share_modal")});i||n.reset()}(y,t,k,e.analyticsFrom)),[y,t,k,e.analyticsFrom]),D=(0,o.useCallback)((()=>S?(0,x.jsx)(me,{...e,onInviteClick:P,inviteOrigin:I,permissionsInviteStore:k,billingData:j}):(0,x.jsx)(E,{inviteOrigin:I,onInviteClick:P,permissionsInviteStore:k})),[S,e,P,I,k,j]),V=(0,r().yK)((()=>({modal:{display:"flex",alignSelf:"center",top:0}})),[]);return(0,g().Mm)(t)?(0,x.jsx)(q().Z,{open:T,onDismiss:L,renderContent:D,modalStyle:V.modal,origin:(0,x.jsx)(n(654133).Z,{renderTooltip:()=>B,disableTooltip:Z,render:t=>(0,x.jsx)(he,{permissionsInviteStore:k,tooltipEvents:t,actionEnabled:Z,showUpgrade:A,buttonInner:c,...e,...t})})}):(0,x.jsx)(q().Z,{open:T,onDismiss:L,renderContent:D,origin:null})}function he(e){let{tooltipEvents:t,showUpgrade:n,actionEnabled:a,store:s,isSubscribed:d,enableInviteDropdown:m,onInviteClick:g,onInviteComplete:f,upgradeButtonName:h,onUpgradeButtonClick:v,shouldGrow:b,buttonStyle:S,permissionsInviteStore:M,buttonInner:w}=e;const C=(0,i().O7)(),j=(0,r().yK)((()=>({dropdownButton:{flex:b?1:0,...S},importListButton:{height:28,borderRadius:4,border:void 0,width:"100%"},importListButtonContainer:{padding:"0 6px",alignItems:"center"}})),[S,b]),k=(0,o.useCallback)((()=>function(e,t,n,o){(0,p().z5)({environment:e,permissionsInviteStore:o,store:t,renderInShareModal:!1,isSubscribed:n}),u().L7(e,{type:"invite"}),c().G(e,{type:"invite",from:"settings_modal"})}(C,s,d,M)),[C,s,d,M]),I=(0,o.useCallback)((()=>n?function(e,t,n){O().y(t,{from:e,upsell:{type:"product",product:"plus",limit:{type:"none"}}}),n&&n(),u().L7(t,{type:"upgrade"})}(h,C,v):k()),[C,k,v,n,h]);if(w)return(0,x.jsx)("div",{onClick:k,children:w});const _=(0,W().S)({onInviteClick:g,onInviteComplete:f,buttonStyle:j.importListButton,buttonContainerStyle:j.importListButtonContainer});return m?(0,x.jsx)(T().ZP,{popupType:P().kQ.Popup,alignmentToOrigin:T().vR.End,placementToOrigin:T().pO.Bottom,render:()=>(0,x.jsx)(ge().Z,{importListItems:_}),originGap:12,renderOrigin:e=>(0,x.jsx)(pe().Z,{disabled:!a&&!n,style:j.dropdownButton,title:(0,x.jsx)(l()._H,{id:"inviteUserButton.addMemberLabel",defaultMessage:"Add members"}),onClick:I,onDropdownClick:e.onClick,color:"blue"})}):(0,x.jsx)(y().Z,{isLarge:!0,onClick:I,disabled:!a&&!n,style:j.dropdownButton,...t,children:(0,x.jsx)(l()._H,{id:"inviteUserButton.addMemberLabel",defaultMessage:"Add members"})})}const ve=o.memo(fe)},956530:(e,t,n)=>{n.r(t),n.d(t,{PublicTopbarMoreMenu:()=>ee});n(267602),n(653476),n(241792);var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(506347),s=()=>n(396136),l=()=>n(195926),d=()=>n(159253),c=()=>n(591514),u=()=>n(827282),m=n(785893);const p=(0,u().IU)("loginArrow",{viewBox:"0 0 16 12",svg:(0,m.jsx)("path",{d:"M8.65 11.116a.615.615 0 00.444-.184l4.546-4.54a.66.66 0 00.205-.39v4.526c0 .349.253.588.608.588.356 0 .615-.239.615-.588V1.361a.59.59 0 00-.615-.608.585.585 0 00-.608.608v4.512a.698.698 0 00-.205-.396L9.094.944a.623.623 0 00-.445-.191.58.58 0 00-.594.588c0 .164.054.328.164.437L9.75 3.33l2.242 2.05-1.456-.054h-9.01c-.355 0-.601.253-.601.609 0 .355.246.615.601.615h9.01L12 6.495 9.75 8.54l-1.531 1.559a.616.616 0 00-.164.43c0 .342.26.588.594.588z"})});const g=(0,u().IU)("reportPage",{viewBox:"0 0 13 14",svg:(0,m.jsx)("path",{d:"M.832 13.846c.349 0 .636-.28.636-.636V9.47a4.696 4.696 0 011.634-.273c2.488 0 4.156 1.244 6.562 1.244 1.053 0 1.538-.13 2.065-.376.492-.218.779-.622.779-1.25v-6.81c0-.45-.349-.73-.814-.73-.39 0-1.005.26-2.098.26C7.216 1.534 5.515.29 3.033.29 2.001.29 1.53.42.976.666.49.892.189 1.247.189 1.869V13.21c0 .349.294.636.643.636zm8.805-4.703c-2.215 0-3.931-1.238-6.508-1.238-.663 0-1.265.075-1.627.212v-6.07c.123-.198.629-.465 1.552-.465 2.33 0 4.047 1.244 6.514 1.244.657 0 1.21-.075 1.627-.191v6.05c-.116.198-.635.458-1.558.458z",fill:"#ED6A5F"})});var f=()=>n(788860),h=()=>n(155056),v=()=>n(855238),y=()=>n(388284),b=()=>n(421797),x=()=>n(429725),S=()=>n(876822),M=()=>n(182008),w=()=>n(313351);const C=(0,f().vU)({reportPageName:{id:"action.reportPage.name",defaultMessage:"Report page"}}),j=(0,w().cN)({key:"action report page",displayName:C.reportPageName,analyticsName:C.reportPageName.defaultMessage,validators:[b().Ggh,b().iKo,b().Id2,b().ffD(b().jBR)],closeParentMenu:!0,render:e=>(0,m.jsx)(v().Z,{...e,style:{color:n(568017).ZP.red},svg:g,title:(0,m.jsx)(f()._H,{...C.reportPageName})}),action:e=>{let{blocks:t,environment:o}=e;n(405129).l1()}}),k=(0,f().vU)({signUpOrLogInName:{id:"action.signUpOrlogIn.name",defaultMessage:"Sign up or log in"},shareLinkName:{id:"action.shareLink.name",defaultMessage:"Share link"},editPageName:{id:"action.editPage.name",defaultMessage:"Edit"},commentPageName:{id:"action.commentPage.name",defaultMessage:"Comment"},duplicatePageName:{id:"action.duplicatePage.name",defaultMessage:"Duplicate"},backtoNotionName:{id:"action.backtoNotion.name",defaultMessage:"Back to Notion"},topbarMobileMoreActionsMenu:{id:"action.topBarSiteMoreMobileActions.name",defaultMessage:"More"},search:{id:"topbar.publicPage.searchButton.label",defaultMessage:"Search"},reportFormName:{id:"action.reportForm.name",defaultMessage:"Report form"},viewOriginalPageName:{id:"action.viewOriginalPage.name",defaultMessage:"View original page"}}),T=(0,w().cN)({key:"log in",displayName:k.signUpOrLogInName,analyticsName:k.signUpOrLogInName.defaultMessage,svg:p,validators:[b().ffD(b().jlf),b().J6K,b().ffD(b().eCK)],closeParentMenu:!0,action:async e=>{let{environment:t}=e;n(438793).RK(t),await n(579358).yF(t,{utmContent:"sign_up_or_log_in",nextRoute:n(836273)._j.login})}}),I=(0,w().cN)({key:"view original page",displayName:k.viewOriginalPageName,analyticsName:k.viewOriginalPageName.defaultMessage,svg:n(600166).h,validators:[b().eCK],closeParentMenu:!0,action:e=>{let{blocks:t}=e;const n=(0,x().ZP)({store:t[0],preferPublicLink:!0,pageVisitSource:r().tY.EmbedPublicPageViewOriginal,disableSlug:!0,embedded:!1});window.open(`${n}`,"_blank")}}),_=(0,w().cN)({key:"report form",displayName:k.reportFormName,analyticsName:k.reportFormName.defaultMessage,svg:g,validators:[b().iKo,b().jBR],closeParentMenu:!0,action:e=>{let{environment:t,blocks:n}=e;h().pj(t,n[0].id)}}),P=(0,w().cN)({key:"ios share link",displayName:k.shareLinkName,analyticsName:k.shareLinkName.defaultMessage,svg:c().s,validators:[b().U7o,b().Fxc,b().gnQ],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;const o=t[0],i=o.getNavigableBlockStore();if(i){const e=(0,x().ZP)({store:i,scrollToBlockId:i.id===o.id?void 0:o.id,fullyQualified:!0,pageVisitSource:r().tY.NativeShareLink,embedded:!1});n.mobileNative&&n.mobileNative.share(e)}}}),Z=(0,w().cN)({key:"web share link",displayName:k.shareLinkName,analyticsName:k.shareLinkName.defaultMessage,svg:c().s,validators:[b().U7o,b().K1d],closeParentMenu:!0,action:async e=>{let{blocks:t}=e;const n=t[0],o=n.getNavigableBlockStore();if(o){const e=(0,x().ZP)({store:o,scrollToBlockId:o.id===n.id?void 0:n.id,fullyQualified:!0,pageVisitSource:r().tY.NativeShareLink,embedded:!1});try{await navigator.share({url:e})}catch{}}}}),A=(0,w().cN)({key:"android share link",displayName:k.shareLinkName,analyticsName:k.shareLinkName.defaultMessage,svg:n(95317).Q,validators:[b().U7o,b().Fxc,b().DtP],closeParentMenu:P.closeParentMenu,action:P.action}),R=(0,w().cs)({key:"copy link",displayName:w().RE.copyLinkName,analyticsName:w().RE.copyLinkName.defaultMessage,svg:n(237874).N,shortcuts:["copyLinkToBlock"],validators:[b().jlf,b().U7o,b().ffD(b().Fxc),b().ffD(b().DFt)],closeParentMenu:!0,action:(e,t)=>{const{lazyDependencies:{clipboardActions:n}}=e;n&&n.copyLinkToBlock({...e,event:t})}}),B=(0,w().cN)({key:"edit page",displayName:k.editPageName,analyticsName:k.editPageName.defaultMessage,svg:n(519454).R,validators:[b().U7o,b().DFt,b().Zk8,b().ffD(b().eMw),b().tqC],closeParentMenu:!0,action:e=>{let{environment:t,blocks:n}=e;h().qc(t,n[0].id)}}),L=(0,w().cN)({key:"comment page",displayName:k.commentPageName,analyticsName:k.commentPageName.defaultMessage,svg:n(698763).s,validators:[b().U7o,b().DFt,n(78449).SO,b().ffD(b().jlf),b().tqC],closeParentMenu:!0,action:e=>{let{environment:t,blocks:n}=e;h().TX(t,n[0].id)}}),D=(0,w().cN)({key:"fork page",displayName:k.duplicatePageName,analyticsName:k.duplicatePageName.defaultMessage,svg:n(44037).a,validators:[b().U7o,b().tqC,b().DFt,b().S4z],closeParentMenu:!0,action:e=>{let{blocks:t,originRect:o,environment:i}=e;n(291338).S({environment:i,store:t[0],originRect:o})}});function V(e){return(0,w().cN)({key:"more actions menu",displayName:k.topbarMobileMoreActionsMenu,analyticsName:k.topbarMobileMoreActionsMenu.defaultMessage,svg:d().O,validators:[b().U7o,b().tqC,b().DFt],closeParentMenu:!0,action:e})}const O=(0,w().cN)({key:"back to my content",displayName:k.backtoNotionName,analyticsName:k.backtoNotionName.defaultMessage,svg:n(968061).h,validators:[b().jlf,b().tqC],closeParentMenu:!0,action:(e,t)=>{let{environment:o}=e;const{currentUserRootStore:i,currentUserSettingsStore:a}=S().default.state;i&&a&&n(224597).L5({environment:o,userRootStore:i,userSettingsStore:a,pageVisitSource:r().tY.SwitchSpace})}}),U=(0,w().cN)({key:"cookie settings",displayName:l().ze.cookieSettingsLabel,analyticsName:l().ze.cookieSettingsLabel.defaultMessage,validators:[b().ffD(b().tYA)],closeParentMenu:!1,render:e=>(0,m.jsx)(n(667710).Z,{hasDismissButton:!1,renderOrigin:t=>{const{onClick:o,...i}=e;return(0,m.jsx)(v().Z,{...i,...t,title:n(527278).Z.formatMessage(l().ze.cookieSettingsLabel),svg:n(168741).H})}}),action:()=>{}}),N=(0,w().cN)({key:"search page",displayName:k.search,analyticsName:k.search.defaultMessage,svg:n(899548).R,validators:[b().U7o,b().tqC,b().DFt,b().m1H],closeParentMenu:!0,action:e=>{let{environment:t}=e;n(278275).UT({environment:t,analyticsFrom:"public-page-topbar",isPublicPageSearch:!0})}});const F=[(0,w().$J)({key:"user",render:e=>(0,m.jsx)(y().Z,{...e}),actions:[O,T,I]}),(0,w().$J)({key:"report page actions",render:e=>(0,m.jsx)(y().Z,{...e}),actions:[j,_,U]})];var H=()=>n(491927),K=()=>n(497065),E=()=>n(352230),W=()=>n(465371),z=()=>n(772084),G=()=>n(658096),q=()=>n(890324),Y=()=>n(826955),$=()=>n(149809),J=()=>n(198829),Q=()=>n(943620),X=()=>n(384241);function ee(e){let{blockStore:t,onDismiss:n}=e;const l=(0,i().O7)(),{isMobile:d}=l.device,c=(0,a().VK)((()=>q().Z.getMode(l,t)),[l,t]),u=(0,a().VK)((()=>t.isFormBlock()),[t]),[p,g]=(0,o.useState)(d&&!u?"initialActions":"more"),f={environment:l,blocks:[t],publicEditMode:c};let h;h=d?{menuType:E().o.ActionSheet}:{menuType:E().o.Popup,width:210,maxHeight:"80vh"};const b=(0,o.useCallback)((e=>{const{mainEditorCurrentBlockStore:t}=S().default.state;if(t){const n=t.getType();var o;if(n)H().dh(l,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"public_topbar_more_menu",block_id:t.id,block_type:n,is_toggleable:(0,W()._A)(n,t.getFormat()),collection_id:null===(o=t.getCollectionStore())||void 0===o?void 0:o.id,parent_collection_id:t.getParentCollectionIdUpToTwoLevels()})}e.closeParentMenu&&n()}),[l,n]),C=(0,a().VK)((()=>{var e;if(!d)return;const n=t.getSpaceStore();if(!n)return;const o=z().gR(t),i=null==o||null===(e=o.getSiteStore())||void 0===e||null===(e=e.getHeader())||void 0===e?void 0:e.customItems;if(!i)return;return{key:"custom nav",render:e=>(0,m.jsx)(y().Z,{...e}),actions:i.filter((e=>"block"===e.type)).map((e=>{const o=Y().G.createChildStore(n,{table:s().iU,id:e.blockId}),i=o.getIcon(),a=(0,x().ZP)({store:o,preferPublicLink:!0,pageVisitSource:r().tY.SiteCustomHeader});return{key:e.blockId,analyticsName:e.blockId,displayName:e.blockId,searchName:e.blockId,render:e=>(0,m.jsx)(v().Z,{...e,left:i&&(0,m.jsx)(Q().Z,{icon:i,store:t,disabled:!0,isEmptyPage:o.isEmptyPage(),size:18,emojiSize:18,disableShrinking:!0}),title:(0,m.jsx)(X().Z,{store:o,maxLength:30})}),action:()=>{K().c4({environment:l,url:a})},closeParentMenu:!0}}))}}),[l,d,t]),j=(k=()=>{g("more")},(0,w().$J)({key:"page",render:e=>(0,m.jsx)(y().Z,{...e}),actions:[N,D,L,B,R,M().Kk,P,A,V(k)]}));var k;const T=function(e){return(0,w().$J)({key:"page",render:e=>(0,m.jsx)(y().Z,{...e}),actions:[Z,P,A,V(e)]})}((()=>{g("more")})),I=(0,a().VK)((()=>{var e;return(null===(e=G().default.state.publicPageData)||void 0===e?void 0:e.isPublicShareLink)&&!l.currentUser.isLoggedIn()}),[l]);if("initialActions"===p){const e=C?[C,j]:[j];return(0,m.jsx)(J().Z,{...h,children:(0,m.jsx)($().Z,{sections:I?[T]:e,onAccept:b,context:f})})}return(0,m.jsx)(J().Z,{...h,children:(0,m.jsx)($().Z,{sections:F,context:f})})}},363806:(e,t,n)=>{n.r(t),n.d(t,{default:()=>V});n(667294);var o=()=>n(219727),i=()=>n(142735),a=()=>n(846550),r=n(785893);const s=(0,n(827282).IU)("thanksShield",{viewBox:"0 0 27 32",svg:(0,r.jsx)("path",{d:"M13.5 31.672c.281 0 .672-.125 1.031-.328 8.75-5.063 11.64-6.969 11.64-12.344V7.125c0-1.672-.624-2.219-2.062-2.797-2.218-.89-7.14-2.719-9.375-3.484-.406-.14-.828-.235-1.234-.235-.422 0-.844.11-1.25.235-2.219.719-7.156 2.61-9.375 3.484C1.437 4.891.812 5.453.812 7.125V19c0 5.375 2.922 7.234 11.641 12.344.36.203.75.328 1.047.328zm0-2.14c-.266 0-.547-.126-.922-.36-7.25-4.5-9.844-5.797-9.844-10.547V7.485c0-.782.141-1.063.735-1.298 2.078-.828 7.187-2.656 9.281-3.468.281-.125.547-.188.75-.188.188 0 .438.078.75.188 2.078.812 7.156 2.703 9.266 3.469.593.218.734.515.734 1.296v11.141c0 4.75-2.625 6.016-9.844 10.547-.375.234-.656.36-.906.36zm-1.688-6.75c.391 0 .72-.188.954-.548l7.593-11.859c.141-.234.282-.5.282-.75 0-.531-.485-.906-.985-.906-.312 0-.61.203-.843.547L11.75 20.437 8.156 16c-.281-.375-.562-.484-.89-.484a.944.944 0 00-.938.953c0 .265.11.531.281.765l4.188 5c.297.391.61.547 1.015.547z",fill:"#636363"})});var l=()=>n(788860);const d=["dmca_no_action"],c=(0,l().vU)({phishing_or_spam:{id:"reportPage.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"},inappropriate_content:{id:"reportPage.reportReasons.inappropriate_content",defaultMessage:"Inappropriate content"},other_content_policy_violation:{id:"reportPage.reportReasons.other_content_policy_violation",defaultMessage:"Other"},dmca_no_action:{id:"reportPage.reportReasons.dmca_no_action",defaultMessage:"DMCA takedown request"}});var u=()=>n(568017),m=()=>n(513670),p=()=>n(707513),g=()=>n(824462),f=()=>n(308186),h=()=>n(405129),v=()=>n(718959),y=()=>n(500174),b=()=>n(527278),x=()=>n(352230),S=()=>n(148126),M=()=>n(804217),w=()=>n(201023),C=()=>n(610146),j=()=>n(573357),k=()=>n(291198),T=()=>n(198829),I=()=>n(18748),_=()=>n(255577),P=()=>n(699347),Z=()=>n(661297),A=()=>n(388284),R=()=>n(360964),B=()=>n(765513),L=()=>n(29090);const D=(0,l().vU)({additionalInformationPlaceholder:{id:"reportPage.additionalInformation.placeholder",defaultMessage:"Please describe how this content violates our Content & Use Policy ({otherSelected, select, true {required} other {optional}})"},dialogLabel:{id:"reportPage.dialogLabel",defaultMessage:"Report page"}});const V=function(){const e=(0,i().VK)((()=>w().default.state.open),[]);return(0,r.jsx)(n(840820).Z,{ariaLabel:b().Z.formatMessage(D.dialogLabel),onDismiss:G,render:()=>(0,r.jsx)(J,{}),isOpen:e})};function O(e){const{reason:t,additionalInformation:n}=e;return void 0!==t&&(!d.includes(t)&&!("other_content_policy_violation"===t&&!n))}function U(){const{state:e}=w().default;if(e.open){const{reason:t,additionalInformation:n}=e;return O({reason:t,additionalInformation:n})}return!1}function N(e){let{modalState:t}=e;const{reason:n}=t;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(P().Z,{title:(0,r.jsx)(l()._H,{id:"reportPageModal.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"}),isSelected:"phishing_or_spam"===n,onClick:()=>w().default.setState({...t,reason:"phishing_or_spam"}),name:"report-page-modal"},"phishing_or_spam"),(0,r.jsx)(P().Z,{title:b().Z.formatMessage(c.inappropriate_content),isSelected:"inappropriate_content"===n,onClick:()=>w().default.setState({...t,reason:"inappropriate_content"}),name:"report-page-modal"},"inappropriate_content"),(0,r.jsx)(P().Z,{title:b().Z.formatMessage(c.dmca_no_action),isSelected:"dmca_no_action"===n,onClick:()=>w().default.setState({...t,reason:"dmca_no_action"}),name:"report-page-modal"},"dmca_no_action"),(0,r.jsx)(P().Z,{title:(0,r.jsx)(l()._H,{id:"reportPageModal.reportReasons.other_content_policy_violation",defaultMessage:"Other"}),isSelected:"other_content_policy_violation"===n,onClick:()=>w().default.setState({...t,reason:"other_content_policy_violation"}),name:"report-page-modal"},"other_content_policy_violation")]})}async function F(e){const t=w().default.getState();if(!t.open)return;const{additionalInformation:n,reason:o}=t,i=(0,v().Fv)();if(null==i||!i.id||!o||!O({reason:o,additionalInformation:n}))return void f().UW((0,r.jsx)(l()._H,{defaultMessage:"Something went wrong.",id:"reportPageModal.somethingWentWrong.label"}));const a=await g().callApi({eventName:"reportPage",environment:e,data:{reason:o,page:i,additionalInformation:n}});"failed"===a.type?f().x2(a):(w().default.setState({open:!1}),f().PV({message:(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[s({width:32}),(0,r.jsx)("div",{style:{paddingTop:12,paddingBottom:8,textAlign:"center"},children:(0,r.jsx)(l()._H,{id:"reportPageModal.thanksForReporting",defaultMessage:"Thanks for reporting this page, our team will take a look."})})]})}))}function H(e){return{width:360,padding:24,fontSize:14,color:e.mediumTextColor}}function K(e,t){const{device:n}=e;return{width:"100%",background:t.popoverBackground,display:"block",padding:n.isMobile?16:"10px 12px",height:n.isMobile?150:130,marginTop:17,marginBottom:17,fontSize:n.isMobile?16:14}}function E(e){let{isMobile:t=!1}=e;return(0,r.jsx)(l()._H,{defaultMessage:"This page is hosted by Notion. Use this form to submit a report if you believe this page violates <contentpolicylink>Notion's content policy</contentpolicylink>.{br}{br}<clarification>This is not a contact form for the person or organization that authored this page</clarification>.",id:"reportPageModal.reportButton.description",values:{br:(0,r.jsx)("br",{}),contentpolicylink:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(0,r.jsx)(R().Z,{title:n,href:(0,S().UY)("contentPolicy"),analyticsFrom:"report_page",style:{display:"inline",marginLeft:void 0},buttonStyle:{alignItems:"baseline",height:t?p().Nv.UISmall.mobile:p().Nv.UISmall.desktop,paddingLeft:"3px",paddingRight:"2px"},iconStyle:{alignSelf:"center",marginRight:"3px"},textSize:"small",isMobile:t})},clarification:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.jsx)("i",{children:t})}}})}function W(){return(0,r.jsx)(l()._H,{defaultMessage:"To submit a formal DMCA takedown request, please follow the instructions detailed in <dmcapolicylink>Notion's official DMCA policy</dmcapolicylink>.",id:"reportPageModal.reportButton.dmcaInstructions",values:{dmcapolicylink:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.jsx)(B().Z,{external:!0,href:"https://www.notion.so/notion/DMCA-Policy-69d880bd37fe496a9b7c64ccc65e024d",children:t})}}})}function z(){const e=(0,a().Fg)();return(0,r.jsx)("div",{style:H(e),children:(0,r.jsx)(l()._H,{defaultMessage:"Please go online to make a report.",id:"reportPageModal.offlineMessage.description"})})}function G(){h().q$()}function q(){return(0,a().yK)((e=>({reportPageExplanation:{color:e.lightTextColor,background:e.contentBackground,border:`1px solid ${e.stroke.input}`},reportPageBanner:{justifyContent:void 0,whiteSpace:"normal",display:"block",paddingTop:"7px",paddingBottom:"7px",marginBottom:"15px"},mobileDescription:{color:u().ZP.lightTextColor,padding:"5px",fontSize:p().JB.UISmall.mobile},modalTitle:{fontSize:16,marginBottom:12,fontWeight:p().Ue.medium}})),[])}function Y(e){let{modalState:t}=e;const n=(0,a().Fg)(),i=(0,o().O7)(),s=q();if(!t.open)return null;const{reason:c}=t,p={menuType:x().o.Modal,title:(0,r.jsx)(l()._H,{id:"reportPageModal.mobile.title",defaultMessage:"Report page"}),right:(0,r.jsx)(l()._H,{id:"reportPageModal.closeButton.label",defaultMessage:"Close"}),onClickRight:G};return(0,r.jsx)(T().Z,{...p,children:(0,r.jsx)(_().ZP,{type:_().iW.Vertical,initialFocus:void 0,sections:m().oA([{key:"help",render:e=>{let{children:t,...n}=e;return(0,r.jsx)(A().Z,{...n,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:t})},items:[{key:"help",render:()=>(0,r.jsx)(I().ZP,{title:(0,r.jsx)(E,{isMobile:!0}),textWrapperStyle:s.mobileDescription,shouldWrapTitle:!0,right:(0,r.jsx)(r.Fragment,{}),onClick:()=>{}}),action:()=>{}}]},{key:"reportOptions",render:e=>{let{children:t,...n}=e;return(0,r.jsx)(A().Z,{...n,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:t})},items:[{key:"options",render:()=>(0,r.jsx)(N,{modalState:t}),action:()=>{}},{key:"additionalInfo",render:()=>c&&!d.includes(c)&&(0,r.jsx)(k().Z,{textarea:!0,style:K(i,n),focus:Boolean(t.reason),value:t.additionalInformation,placeholder:b().Z.formatMessage(D.additionalInformationPlaceholder,{otherSelected:"other_content_policy_violation"===c}),onChange:e=>{w().default.setState({...t,additionalInformation:e.target.value})}}),action:()=>{}}]},"dmca_no_action"===c?{key:"explain_dmca",render:e=>{let{children:t,...n}=e;return(0,r.jsx)(A().Z,{...n,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:t})},items:[{key:"explain_dmca",render:()=>"dmca_no_action"===c&&(0,r.jsx)(I().ZP,{title:(0,r.jsx)(W,{}),textWrapperStyle:{...s.mobileDescription,background:n.accentColors.yellow[100],color:n.accentColors.yellow[600],margin:"0px",padding:"10px 20px"},style:{display:"block"},shouldWrapTitle:!0,right:(0,r.jsx)(r.Fragment,{}),onClick:()=>{}}),action:()=>{}}]}:void 0,{key:"actions",render:e=>{let{children:t,...n}=e;return(0,r.jsx)(A().Z,{...n,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},isSubmitButton:!0,...n,children:t})},items:[{key:"submit",render:e=>{const{onClick:t,...n}=e,o=U();return(0,r.jsx)(L().Z,{...n,disabled:!o,title:(0,r.jsx)("div",{style:{color:o?u().ZP.red:u().ZP.uiGray},children:(0,r.jsx)(l()._H,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})}),onClick:t||F})},action:()=>F(i)}]}])},"main list")})}function $(e){let{modalState:t}=e;const n=(0,a().Fg)(),i=(0,o().O7)(),s=q();if(!t.open)return null;const{reason:c}=t,u="dmca_no_action"===c;return(0,r.jsx)(j().Z,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:()=>(0,r.jsxs)("div",{style:{width:360,padding:24,fontSize:14},children:[(0,r.jsx)("div",{style:s.modalTitle,children:(0,r.jsx)(l()._H,{id:"reportPageModal.title",defaultMessage:"Why are you reporting this page?"})}),(0,r.jsx)(C().Z,{isMobile:!1,textSize:"small",styleKey:y().v.Yellow,style:u?s.reportPageBanner:{...s.reportPageExplanation,...s.reportPageBanner},children:u?(0,r.jsx)(W,{}):(0,r.jsx)(E,{})}),(0,r.jsx)("div",{children:(0,r.jsx)(N,{modalState:t})}),c&&!d.includes(c)&&(0,r.jsx)(k().Z,{textarea:!0,style:K(i,n),focus:Boolean(t.reason),value:t.additionalInformation,placeholder:b().Z.formatMessage(D.additionalInformationPlaceholder,{otherSelected:"other_content_policy_violation"===c}),onChange:e=>{w().default.setState({...t,additionalInformation:e.target.value})}}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:18},children:[(0,r.jsx)(Z().Z,{size:"lg",onClick:G,style:{marginRight:12},children:(0,r.jsx)(l()._H,{id:"reportPageModal.cancelButton.label",defaultMessage:"Cancel"})}),(0,r.jsx)(Z().Z,{color:"uiRed",size:"lg",onClick:()=>F(i),disabled:!U(),disabledFeedback:!0,children:(0,r.jsx)(l()._H,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})})]})]})})}function J(){const e=(0,o().O7)(),{device:t}=e,n=(0,i().VK)((()=>M().default.state.online),[]),a=(0,i().Kw)(w().default);return n?a.open?t.isMobile?(0,r.jsx)(Y,{modalState:a}):(0,r.jsx)($,{modalState:a}):null:(0,r.jsx)(z,{})}},468193:(e,t,n)=>{n.d(t,{Z:()=>B});n(670560),n(267602),n(653476),n(470928),n(241792),n(228244);var o=n.n(n(443261)),i=n(667294),a=()=>n(219727),r=()=>n(226413),s=()=>n(532850),l=()=>n(38883),d=()=>n(956057),c=()=>n(752778),u=()=>n(788860),m=()=>n(513670),p=()=>n(543172),g=()=>n(696459),f=()=>n(491927),h=()=>n(887430),v=()=>n(125659),y=()=>n(861026),b=()=>n(352230),x=()=>n(692304),S=()=>n(827973),M=()=>n(119891),w=()=>n(198829),C=()=>n(255577),j=()=>n(838367),k=()=>n(470386),T=()=>n(388284),I=()=>n(949842),_=()=>n(246471),P=n(785893);const Z=i.forwardRef((function(e,t){var o;const{locked:i,option:r,actionMenuOpen:s,property:d,collectionId:c,analyticsFrom:u,onChange:p,onCloseActionMenu:g,focused:f,propertySchema:h,onOpenActionMenu:v}=e,y=(0,n(846550).Fg)(),b=(0,a().O7)();return(0,P.jsx)(n(94967).Z,{debugName:"SelectPropertyMenuItem",capture:s,onEnter:m().yR,children:(0,P.jsx)(n(654133).Z,{renderTooltip:e=>(0,P.jsxs)("div",{...e,style:n(514).F6,children:[(0,P.jsx)("div",{children:r.value}),(0,P.jsx)("div",{style:{color:y.mediumInvertedTextColor},children:r.description})]}),placement:n(998901).Placement.Left,disableTooltip:!(null!==(o=r.description)&&void 0!==o&&o.length),render:o=>(0,P.jsx)(S().Z,{...(0,n(164079).Z)(o,e),ref:t,title:(0,P.jsx)(_().a,{format:b.device.isMobile?l().lo.Large:l().lo.Medium,value:r.value,color:r.color,hideTooltip:!0,showRemoveButton:!1,isSingle:!0,showEllipsis:!0}),desktopTitleStyle:{marginRight:6},isTokenTitle:!0,right:!i&&(0,P.jsx)(A,{property:d,collectionId:c,analyticsFrom:u,onChange:p,onCloseActionMenu:g,actionMenuOpen:s,focused:f,option:r,propertySchema:h,onOpenActionMenu:v})})})})}));function A(e){let{property:t,collectionId:o,analyticsFrom:i,onChange:r,onCloseActionMenu:s,actionMenuOpen:l,focused:d,option:c,propertySchema:u,onOpenActionMenu:m}=e;const p=(0,a().O7)(),{device:g}=p;return(0,P.jsx)(n(277443)._,{open:l,origin:(0,P.jsx)(n(145873).Z,{onClick:e=>function(e,t,n){(0,I().ZP)({event:e,context:I().Af.MenuListClick,callback:()=>t(n.value)})}(e,m,c),isMobile:g.isMobile,style:{opacity:d||g.isMobile?1:0}}),option:c,propertySchema:u,property:t,collectionId:o,analyticsFrom:i,onChange:r,onClose:s})}var R=()=>n(122671);function B(e){const{allowMultiple:t,analyticsFrom:n,autofillExplanation:p,bulkAutofillButton:S,canConfigureCollection:M,collectionId:I,disabled:Z,insertChar:A,onAccept:B,onChange:D,onDismiss:O,property:N,schema:K,value:E}=e,W=(0,a().O7)(),{device:z}=W,G=(0,u().YB)(),q=(0,i.useRef)(void 0),Y=(0,v().Y$)(),$=(0,i.useMemo)((()=>new(x().Z)),[]),[J,Q]=(0,i.useState)(""),[X,ee]=(0,i.useState)(void 0);(0,i.useEffect)((()=>{F(K,N,q),A&&Q(A)}),[A,N,K]);const te=(0,i.useCallback)((e=>function(e){const{change:t,allowMultiple:n,analyticsFrom:o,collectionContextStore:i,collectionId:a,createSelectColorRef:s,environment:l,onChange:u,property:m,schema:p,setInputValue:v}=e;v("");const b=p[m];if(!b)return;if(!r().cu(b))return;const x=b.options||[];let S;if("removeToken"===t.type)S={type:"selectPropertyMenuUpdateRemoveOption",removeOption:t.removedToken};else if("addTokens"===t.type){let e;n?(e=t.newTokens,S={type:"selectPropertyMenuUpdateAddOptions",addOptions:e}):(e=t.newTokens.length>0?[t.newTokens[t.newTokens.length-1]]:[],S={type:"selectPropertyMenuUpdateReplaceOptions",options:e});const r=e.find((e=>!x.find((t=>t.value===e))));if(r){const e={id:d().Il(),value:r,color:s.current};let t;t="alphabetical"===b.auto_sort_options||"reverse_alphabetical"===b.auto_sort_options?[(0,h().Ch)({collectionId:a,property:m,propertySchema:b,newOption:e,isAscending:"alphabetical"===b.auto_sort_options})]:[{pointer:{table:c().vF,id:a},command:"keyedObjectListAfter",path:["schema",m,"options"],args:{value:e}}],S.schemaOperations=t,F(p,m,s),f().$q(l,{...(0,y().Pn)(i),property_type:b.type,action:"select_add_option",from:o})}}else(0,g().t1)(t);u(S)}({allowMultiple:t,analyticsFrom:n,collectionContextStore:Y,collectionId:I,createSelectColorRef:q,environment:W,onChange:D,property:N,schema:K,setInputValue:Q,...e})),[t,n,Y,I,W,D,N,K]),ne=(0,i.useCallback)((e=>m().oA(E.map((t=>{const n=(0,s().i7)(e,t);if(n)return(0,P.jsx)(_().a,{value:n.value,color:n.color,showRemoveButton:!Z,isSingle:!1,format:z.isMobile?l().lo.Large:l().lo.Medium,shouldShrink:!0,onClickRemove:()=>{te({change:{type:"removeToken",removedToken:t}})},showEllipsis:!0},n.id)})))),[z.isMobile,Z,te,E]),oe=(0,i.useCallback)((e=>{ee(e)}),[]),ie=K[N];if(!ie)return null;if(!r().cu(ie))return null;const ae=ie.options||[],re=function(e,t,n){const i=t.map((e=>e.value));let a;if(e){a=o().filter(e,i).map((e=>e.original));!t.find((t=>t.value===e))&&e.trim().length>0&&n&&a.push(e.trim().replace(/,/g,""))}else a=i;return a}(J,ae,M),se=ne(ae),le=ie.select_ai_inference,de=0===re.length,ce=(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(R().ZP,{focus:z.isMobile?void 0:!X,focusAfterAnimation:!0,format:R().UR.Select,tokens:se,placeholder:null!=le&&le.auto_update_on_edit?G.formatMessage({id:"database.selectPropertyEditMenu.searchPlaceholder.aiAutoUpdate",defaultMessage:"Empty"}):G.formatMessage({id:"database.selectPropertyEditMenu.searchPlaceholder",defaultMessage:"Search for an option..."}),onRemoveLastToken:()=>{E.length>0&&te({change:{type:"removeToken",removedToken:E[E.length-1]}})},value:J,disabled:Z,hideInput:!1,onChange:e=>Q(e.target.value),dontShowBorderBottom:z.isAndroid}),p]});let ue;return ue=z.isMobile?{menuType:b().o.Modal,title:ie.name,right:(0,P.jsx)(k().DoneMenuText,{}),onClickRight:O,header:ce,footer:S}:{menuType:b().o.Popup,header:ce,tokenInputHeader:!0,footer:S},Z?(0,P.jsx)(w().Z,{...ue}):(0,P.jsx)(w().Z,{...ue,children:de?(0,P.jsx)(T().Z,{title:M?(0,P.jsx)(V,{}):(0,P.jsx)(L,{}),children:z.isMobileNative&&(0,P.jsx)(j().Z,{title:(0,P.jsx)(L,{})})}):(0,P.jsx)(C().ZP,{type:C().iW.Vertical,initialFocus:J.length>0?0:void 0,sections:[{key:1,render:e=>(0,P.jsx)(U,{collectionId:I,property:N,schema:K,onChange:D,canConfigureCollection:M,menuListStore:$,args:e,tokens:re}),items:H({analyticsFrom:n,canConfigureCollection:M,collectionId:I,createSelectColorRef:q,handleOnTokenInputChange:te,handleSetOpenPropertyActionMenu:oe,onChange:D,openPropertyActionMenu:X,options:ae,property:N,schema:K,tokens:re,value:E})}],onAccept:(e,t,n)=>{B(n)},store:$})})}function L(){return(0,P.jsx)(u()._H,{id:"database.selectPropertyEditMenu.noResults",defaultMessage:"No options found"})}function D(){return(0,P.jsx)(u()._H,{id:"database.selectPropertyEditMenu.selectOnlyPrompt",defaultMessage:"Select an option"})}function V(){return(0,P.jsx)(u()._H,{id:"database.selectPropertyEditMenu.selectOrCreatePrompt",defaultMessage:"Select an option or create one"})}function O(e){let{props:t,newOption:n,token:o}=e;const i=(0,a().O7)(),{device:r}=i;return(0,P.jsx)(S().Z,{...t,title:(0,P.jsxs)("div",{style:{display:"flex",minWidth:0},children:[(0,P.jsx)("div",{style:{marginRight:6,lineHeight:1.3},children:(0,P.jsx)(u()._H,{id:"database.selectPropertyEditMenu.createLabel",defaultMessage:"Create"})}),(0,P.jsx)(_().a,{value:n.value,color:n.color,showRemoveButton:!1,isSingle:!0,format:r.isMobile?l().lo.Large:l().lo.Medium,showEllipsis:!0})]}),isTokenTitle:!0})}function U(e){let{args:t,tokens:n,collectionId:o,property:a,schema:s,onChange:l,canConfigureCollection:d,menuListStore:u}=e;const m=(0,i.useCallback)((e=>function(e,t,n,o,i,a){const s=(0,h().YL)({newOptions:e,collectionId:t,property:n,schema:o});if(s){const e=o[n];e&&r().cu(e)&&"manual"!==(e.auto_sort_options||"manual")&&s.push({pointer:{table:c().vF,id:t},command:"update",path:["schema",n],args:{auto_sort_options:"manual"}}),i({type:"selectPropertyMenuUpdateSchema",schemaOperations:s})}a.reset()}(e,o,a,s,l,u)),[o,a,s,l,u]);return d?(0,P.jsx)(T().Z,{...t,title:(0,P.jsx)(V,{}),children:(0,P.jsx)(M().ZP,{direction:"vertical",keys:n,renderKey:e=>t.children[n.indexOf(e)],onDrop:m})}):(0,P.jsx)(T().Z,{...t,title:(0,P.jsx)(D,{}),children:t.children})}function N(e){let{analyticsFrom:t,canConfigureCollection:n,collectionId:o,handleSetOpenPropertyActionMenu:s,onChange:l,openPropertyActionMenu:d,option:c,property:u,props:p,schema:g,value:f}=e;const h=(0,a().Fy)(),v=(0,i.useMemo)((()=>c.value===d),[d,c.value]),y=g[u];return y&&r().cu(y)?(0,P.jsx)(Z,{...p,option:c,showDragHandle:n&&!h.isMobile,locked:!n,property:u,analyticsFrom:t,collectionId:o,onChange:e=>function(e,t,n,o,i){const a=n[t];if(!a)return;if(!r().cu(a))return;const s=a.options||[],l=[...s];let d;const c=o.filter((e=>{const t=s.find((t=>t.value===e));return!t||l.some((e=>e.id===t.id))}));d=m().Xy(c,o)?{type:"selectPropertyMenuUpdateSchema",schemaOperations:e}:{type:"selectPropertyMenuUpdateReplaceOptions",options:c,schemaOperations:e};i(d)}(e,u,g,f,l),actionMenuOpen:v,propertySchema:y,onCloseActionMenu:s,onOpenActionMenu:s}):null}function F(e,t,n){const o=e[t];if(!o)return;if(!r().cu(o))return;const i=o.options||[],a=(0,r().TL)(i);n.current=a}function H(e){const{analyticsFrom:t,canConfigureCollection:n,collectionId:o,createSelectColorRef:i,handleOnTokenInputChange:a,handleSetOpenPropertyActionMenu:r,onChange:s,openPropertyActionMenu:l,options:d,property:c,schema:u,tokens:m,value:g}=e;return m.map((e=>{const m=d.find((t=>t.value===e));return{key:e,render:a=>{if(m)return(0,P.jsx)(N,{analyticsFrom:t,canConfigureCollection:n,collectionId:o,handleSetOpenPropertyActionMenu:r,onChange:s,openPropertyActionMenu:l,option:m,property:c,props:a,schema:u,value:g});{const t={id:(0,p().ZP)(),value:e,color:i.current};return(0,P.jsx)(O,{props:a,newOption:t,token:e})}},action:()=>{g.includes(e)||a({change:{type:"addTokens",newTokens:[e]}})}}}))}},807883:(e,t,n)=>{n.r(t),n.d(t,{MembersTabTitle:()=>wn,PeopleRow:()=>Sn,SettingToggle:()=>Cn,SidebarTeamModal:()=>Mn});n(241792);var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(846550),s=()=>n(788860),l=()=>n(513670),d=()=>n(696459),c=()=>n(707513),u=()=>n(465755),m=()=>n(247724),p=()=>n(91502),g=()=>n(270895),f=()=>n(520849),h=()=>n(876822),v=()=>n(826955),y=()=>n(965014),b=()=>n(840821),x=()=>n(707581),S=(n(670560),n(785893));const M=(0,n(827282).IU)("leaveArrow",{viewBox:"0 0 16 12",svg:(0,S.jsx)("path",{d:"M8.65 11.116a.615.615 0 00.444-.184l4.546-4.54a.66.66 0 00.205-.39v4.526c0 .349.253.588.608.588.356 0 .615-.239.615-.588V1.361a.59.59 0 00-.615-.608.585.585 0 00-.608.608v4.512a.698.698 0 00-.205-.396L9.094.944a.623.623 0 00-.445-.191.58.58 0 00-.594.588c0 .164.054.328.164.437L9.75 3.33l2.242 2.05-1.456-.054h-9.01c-.355 0-.601.253-.601.609 0 .355.246.615.601.615h9.01L12 6.495 9.75 8.54l-1.531 1.559a.616.616 0 00-.164.43c0 .342.26.588.594.588z"})});var w=()=>n(568017),C=()=>n(102182),j=()=>n(269299),k=()=>n(573357),T=()=>n(291198),I=()=>n(906651),_=()=>n(654133),P=()=>n(67961),Z=()=>n(527278),A=()=>n(423557),R=()=>n(998901),B=()=>n(44556),L=()=>n(428097),D=()=>n(936968);function V(e){return!(0,D().q)(e)}var O=()=>n(1038),U=()=>n(132222),N=()=>n(12875),F=()=>n(586270),H=()=>n(383694),K=()=>n(838983),E=()=>n(345918),W=()=>n(408491);const z=(0,s().vU)({editor:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsFull",defaultMessage:"Teamspace members have full access"},read_and_write:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsEdit",defaultMessage:"Teamspace members can edit"},comment_only:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsComment",defaultMessage:"Teamspace members can comment"},reader:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsView",defaultMessage:"Teamspace members can view"}}),G=(0,s().vU)({editor:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsFull",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} has full access"},read_and_write:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsEdit",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can edit"},comment_only:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsComment",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can comment"},reader:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsView",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can view"},none:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsNone",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} does not have access"}});function q(e){let{teamStore:t}=e;const n=(0,r().yK)((()=>({listItem:{padding:0,margin:0},spacer:{height:20,width:"100%"},accessLevelButton:{border:"none"}})),[]),o=g().a.Members,i=(0,a().VK)((()=>t.getTeamAccessLevel()),[t]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{style:n.spacer}),(0,S.jsx)(K().Ph,{title:(0,S.jsx)(s()._H,{id:"TeamSettingsGeneral.generalSettings.permissions",defaultMessage:"Permissions"}),rows:[(0,S.jsx)(W()._,{currentAccessLevel:i,teamStore:t,disabledWithRightChevron:!0,style:n.accessLevelButton},"visibility"),(0,S.jsx)(Y,{teamStore:t},"permissions")],onClick:()=>{g().default.state.open&&g().default.setState({...g().default.state,tab:o})},itemStyle:n.listItem})]})}function Y(e){let{teamStore:t}=e;const n=(0,a().VK)((()=>h().default.state.currentSpaceStore),[]),o=(0,i().O7)(),s=(0,r().yK)((e=>({label:{color:e.regularTextColor,whiteSpace:"normal"},row:{display:"inline-flex",alignItems:"center",marginTop:12,marginBottom:12,paddingRight:15,paddingLeft:15},icon:{marginRight:15}})),[]),l=(0,a().VK)((()=>t.getTeamPermission()),[t]),d=(0,a().VK)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),{spaceIcon:c,spaceName:u}=(0,a().VK)((()=>{if(!n)return{spaceIcon:void 0,spaceName:void 0};const e=(0,E().rn)(o,n);return{spaceIcon:(0,S.jsx)(H().p,{disabled:!0,store:n,size:20,style:s.icon}),spaceName:e}}),[n,o,s.icon]),m=(0,a().VK)((()=>(0,S.jsx)(H().p,{disabled:!0,store:t,size:20,style:s.icon})),[t,s.icon]),p=(null==l?void 0:l.role)??"none",g=!(p===d.role),f=g?m:c,v=Z().Z.formatMessage(G[d.role],{showTeam:g,spaceName:u}),y=Z().Z.formatMessage(z[p]);return(0,S.jsxs)("div",{style:s.row,children:[f,(0,S.jsxs)(P().Z,{isSmall:!0,style:s.label,children:[g&&(0,S.jsxs)(S.Fragment,{children:[y,(0,S.jsx)("span",{style:{marginLeft:5,marginRight:5},children:"•"})]}),v]})]})}var $=()=>n(297565),J=()=>n(265640),Q=()=>n(454598),X=()=>n(223160),ee=()=>n(188296),te=()=>n(617111),ne=(n(267602),n(470928),()=>n(374289)),oe=()=>n(933868),ie=(n(653476),()=>n(528514));const ae=["none","reader","comment_only","read_and_write","editor"],re=["reader","comment_only","read_and_write"],se=["reader","comment_only","read_and_write","editor"],le=["editor"];function de(e){const t=function(e){var t,n;let{teamId:o,permissions:i}=e;const a=(null===(t=i.find((e=>(0,oe().Ir)(e))))||void 0===t?void 0:t.role)??"none",r=(null===(n=i.find((e=>(0,oe().zU)(e)&&e.team_id===o)))||void 0===n?void 0:n.role)??a,s=i.find((e=>(0,oe().bm)(e)));return{spacePermission:{type:"space_permission",role:a},teamMemberPermission:{type:"explicit_team_permission",team_id:o,role:r},teamOwnerPermission:{type:"explicit_team_owner_permission",team_id:o,role:"editor"},...s&&{teamGuestPermission:{type:"explicit_team_guest_permission",team_id:o,role:s.role}}}}({teamId:e.id,permissions:e.permissions??[]}),{spacePermission:n,teamMemberPermission:o}=t,i={visibility:["team_members","space_members"],space_member_join_access:["invite_only","self_join"],invite_access:["team_members","team_owners"]},a={spacePermission:ue({roles:ae,currentRole:o.role}),teamGuestPermission:re,teamMemberPermission:ce({roles:se,currentRole:n.role}),teamOwnerPermission:le},{visibility:r,space_member_join_access:s}=e.settings;return"team_members"===r&&(i.space_member_join_access=["invite_only"],a.spacePermission=["none"]),"self_join"===s&&(i.visibility=["space_members"],i.invite_access=["team_members"],a.spacePermission=a.spacePermission.filter((e=>"none"!==e))),e.is_default&&(a.teamMemberPermission=[o.role],a.spacePermission=[o.role]),{settingsOptions:i,permissionItemRoleOptions:a,currentTeamPermissionItems:t}}function ce(e){let{roles:t,currentRole:n}=e;return t.filter((e=>(0,ie().IF)(e,n)))}function ue(e){let{roles:t,currentRole:n}=e;return t.filter((e=>(0,ie().SL)(e,n)))}var me=()=>n(827973),pe=()=>n(448419),ge=()=>n(198829),fe=()=>n(255577),he=()=>n(388284),ve=()=>n(471645),ye=()=>n(352230),be=()=>n(164079);function xe(e){let{teamStore:t}=e;const n=(0,a().VK)((()=>t.getSettingsStore().getValue()),[t]),o=(0,a().VK)((()=>{const e=t.getSettingsStore().getValue();if(e)return de({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t]);if(!n||!o)return null;const i=[(0,S.jsx)(Me,{teamStore:t,hasMultiInviteAccessOptions:1===o.settingsOptions.invite_access.length,inviteAccess:n.invite_access},"invite"),(0,S.jsx)(Se,{teamStore:t,disablePageEdits:n.disable_team_page_edits},"editSidebar"),(0,S.jsx)(we,{teamStore:t},"toggleInviteLink")];return(0,S.jsx)(K().Ph,{title:(0,S.jsx)(s()._H,{id:"TeamSettingsSecurity.teamspaceSettingsTitle",defaultMessage:"Teamspace Security"}),rows:i,hideDividers:!0})}function Se(e){const{teamStore:t,disablePageEdits:n}=e,r=(0,i().O7)(),l=V(t),d=(0,a().VK)((()=>{var e;return(null===(e=t.getTeamPermission())||void 0===e?void 0:e.role)??"none"}),[t]),c=(0,o.useCallback)((e=>{j().createAndCommit({userAction:"teamsHelpers.changeTeamSetting",environment:r,canUndo:!0,perform:n=>{B().$x({environment:r,store:t,update:{disable_team_page_edits:e},transaction:n})}})}),[r,t]),u=(0,oe().J5)(d),m=[{option:!0,label:(0,S.jsx)(s()._H,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>c(!0)}];return u&&m.push({option:!1,label:(0,S.jsx)(s()._H,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>c(!1)}),(0,S.jsx)(Ce,{title:(0,S.jsx)(s()._H,{id:"TeamSettingsPermissions.whoCanEditTeamPages.title",defaultMessage:"Who can edit teamspace sidebar"}),caption:(0,S.jsx)(s()._H,{id:"TeamSettingsPermissions.whoCanEditTeamPages.caption",defaultMessage:"Adding, removing, or re-ordering sidebar pages"}),disabled:l||!u,currentOption:!u||Boolean(n),allOptions:m,optionTooltip:u?void 0:(0,S.jsx)(s()._H,{id:"TeamSettingsPermissions.settingSelect.whoCanEditTeamPages.teamMemberPermissionTooltip",defaultMessage:"Change member permissions to Can edit or Full access to allow teamspace members to edit the sidebar"})})}function Me(e){const{teamStore:t,hasMultiInviteAccessOptions:n,inviteAccess:a}=e,r=(0,D().q)(t),l=(0,i().O7)(),d=(0,o.useCallback)((e=>{j().createAndCommit({userAction:"team.setInviteAccess",environment:l,canUndo:!0,perform:n=>{B().$x({environment:l,store:t,update:{invite_access:e},transaction:n})}})}),[l,t]),c=!r||n;return(0,S.jsx)(Ce,{title:(0,S.jsx)(s()._H,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.title",defaultMessage:"Who can invite or remove teamspace members"}),disabled:c,optionTooltip:c&&r&&(0,S.jsx)(s()._H,{id:"TeamSettingsPermissions.whoCanInviteTeamMembersDisabled.caption",defaultMessage:"Change access level to Closed or Private to restrict who can invite teamspace members"}),currentOption:a,allOptions:[{option:"team_members",label:(0,S.jsx)(s()._H,{id:"TeamSettingsPermissions.whoCanInviteTeamspaceMembers.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>d("team_members")},{option:"team_owners",label:(0,S.jsx)(s()._H,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>d("team_owners")}]})}function we(e){const{teamStore:t}=e,n=(0,i().O7)(),o=(0,a().VK)((()=>(0,p().U2)(t)),[t]),l=V(t),d=(0,r().yK)((()=>({container:{display:"flex",justifyContent:"space-between"},subtitle:{marginBottom:5},switcher:{marginTop:5}})),[]);return(0,S.jsxs)("div",{style:d.container,children:[(0,S.jsxs)("div",{children:[(0,S.jsx)(P().Z,{children:(0,S.jsx)(s()._H,{id:"TeamsecuritySection.inviteLink.label",defaultMessage:"Invite Link"})}),(0,S.jsx)(P().Z,{isSmall:!0,style:d.subtitle,children:(0,S.jsx)(s()._H,{id:"TeamsecuritySection.inviteLink.description",defaultMessage:"Only users who can invite members can see the invite link"})})]}),(0,S.jsx)("div",{style:d.switcher,children:(0,S.jsx)(ve().Z,{disabled:l,on:!o,onClick:()=>{j().createAndCommit({userAction:"team.setInviteAccess",environment:n,canUndo:!0,perform:e=>{B().$x({environment:n,store:t,update:{disable_invite_link:!o},transaction:e})}})}})})]})}function Ce(e){const{title:t,caption:n,currentOption:o,allOptions:a,disabled:s,optionTooltip:l}=e,d=(0,i().Fy)(),c=(0,r().yK)((e=>({root:{display:"flex",alignItems:"center",width:"100%"},title:{fontSize:14,marginRight:8,flexGrow:1},divider:{marginTop:14,marginBottom:14},chevron:{width:10,marginLeft:4,fill:e.lightIconColor},buttonStyle:{fontSize:12.5,color:e.mediumTextColor},tooltipWidth:{width:300}})),[]),u=a.find((e=>e.option===o));return u?(0,S.jsxs)("div",{style:c.root,children:[(0,S.jsxs)("div",{style:c.title,children:[t,n&&(0,S.jsx)(P().Z,{isSmall:!0,isMultiline:!0,style:{marginTop:1,width:"95%",marginBottom:5},children:n})]}),(0,S.jsx)(_().Z,{style:c.tooltipWidth,placement:R().Placement.Top,alignment:R().Alignment.Start,textWrap:!0,disableTooltip:!l,renderTooltip:()=>l,render:e=>(0,S.jsx)(pe().ZP,{...e,disablePopup:s,popupType:d.isMobile?pe().Z4.SlideUp:pe().Z4.Popup,alignmentToOrigin:pe().vR.End,renderOrigin:t=>(0,S.jsxs)(J().D,{style:c.buttonStyle,disabled:s,...(0,be().Z)(e,t),children:[u.label,!s&&(0,ne().i)(c.chevron)]}),render:e=>{let t;t=d.isMobile?{menuType:ye().o.ActionSheet}:{menuType:ye().o.Popup,minWidth:150};const n=[{key:"options",render:e=>(0,S.jsx)(he().Z,{...e}),items:a.map((t=>{const n={key:t.option.toString(),render:e=>(0,S.jsx)(me().Z,{...e,title:t.label,caption:t.caption,checkState:o===t.option}),action:()=>{t.action(),e.close()}};return n}))}];return(0,S.jsx)(ge().Z,{...t,children:(0,S.jsx)(fe().ZP,{type:fe().iW.Vertical,initialFocus:void 0,sections:n})})}})})]}):null}function je(e){let{teamStore:t}=e;const n=(0,r().yK)((e=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},spacer:{height:20,width:"100%"}})),[]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(xe,{teamStore:t}),(0,S.jsx)("div",{style:n.spacer}),(0,S.jsx)(ke,{teamStore:t}),(0,S.jsx)(F().Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_security",containerStyle:n.learnMoreLinkContainer,message:(0,S.jsx)(s()._H,{id:"teamSettingsSecurity.learnMore",defaultMessage:"Learn about teamspace security"})})]})}function ke(e){let{teamStore:t}=e;const n=(0,a().VK)((()=>h().default.state.currentSpaceStore),[]),o=(0,i().O7)(),l=(0,te().z)(),d="enterprise",{organizationOverrides:c}=(0,Q().u)({spaceId:null==n?void 0:n.id}),u=o.currentUser.id,m=(0,a().VK)((()=>({disable_public_access:{spaceIsDisabled:(null==n?void 0:n.getDisablePublicAccess())??!1,teamIsDisabled:t.getDisablePublicAccess(),isControlledByOrganization:Boolean(c.disable_public_access)},disable_export:{spaceIsDisabled:(null==n?void 0:n.getDisableExport())??!1,teamIsDisabled:t.getDisableExport(),isControlledByOrganization:Boolean(c.disable_export)},disable_guests:{spaceIsDisabled:(null==n?void 0:n.getDisableGuests())??!1,teamIsDisabled:t.getDisableGuests(),isControlledByOrganization:Boolean(c.disable_guests)},disable_team_page_edits:{spaceIsDisabled:void 0,teamIsDisabled:t.getDisableTeamPageEdits(),isControlledByOrganization:!1}})),[n,t,c]),p=(0,D().q)(t),g=(0,a().VK)((()=>(null==n?void 0:n.canAdmin())??!1),[n]),f=(0,r().yK)((()=>({switcher:{marginRight:0}})),[]);if(!n)return null;if(!u)return null;const v=e=>l||m[e].teamIsDisabled,y=e=>{if(!v(e))return!1;if(!p)return!1;if(m[e].isControlledByOrganization)return!1;const t=(e=>m[e].spaceIsDisabled&&m[e].teamIsDisabled)(e);return!t||g},b=e=>!v(e)&&g,x=e=>{const{teamIsDisabled:n,spaceIsDisabled:i}=m[e],a=!n;B().d({environment:o,store:t,settingName:e,newTeamSettingValue:_e(a),spaceSettingValue:void 0===i?void 0:_e(i)})},M=e=>{if((e=>m[e].spaceIsDisabled)(e))return(e=>m[e].teamIsDisabled)(e)?(0,S.jsx)(s()._H,{id:"teamSettingsSecurity.basedOnWorkspaceSettings",defaultMessage:"Based on <underline>workspace settings</underline>",values:{underline:e=>(0,S.jsx)("span",{style:{textDecoration:"underline"},children:e})}}):(0,S.jsx)(s()._H,{id:"teamSettingsSecurity.overridesWorkspaceSettings",defaultMessage:"Overriding <underline>workspace setting</underline>",values:{underline:e=>(0,S.jsx)("span",{style:{textDecoration:"underline"},children:e})}})},w=(0,S.jsx)(ee().Z,{subscriptionTier:d,analyticsName:"team_security_settings",desktopStyle:{display:"inline-block",marginLeft:8,marginTop:-3}}),C=(0,S.jsx)(s()._H,{id:"teamSettingsSecurity.setting.enterpriseGateToggleTooltip",defaultMessage:"Upgrade to Enterprise Plan to change security settings"}),j=[(0,S.jsx)(Cn,{switcherStyle:f.switcher,upsellTier:d,on:m.disable_public_access.teamIsDisabled,disabled:!y("disable_public_access"),onChange:()=>x("disable_public_access"),shouldTriggerUpsell:b("disable_public_access"),secondCaption:M("disable_public_access"),title:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(s()._H,{id:"teamSettingsSecurity.setting.shareTitle",defaultMessage:"Disable publishing sites and forms"}),!v("disable_public_access")&&w]}),tooltip:!v("disable_public_access")&&C,isLocked:m.disable_public_access.isControlledByOrganization,lockedTooltip:(0,X().g)()}),(0,S.jsx)(Cn,{switcherStyle:f.switcher,upsellTier:d,on:m.disable_guests.teamIsDisabled,disabled:!y("disable_guests"),onChange:()=>x("disable_guests"),shouldTriggerUpsell:b("disable_guests"),secondCaption:M("disable_guests"),title:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(s()._H,{id:"teamSettingsSecurity.setting.guestTitle",defaultMessage:"Disable guests"}),!v("disable_guests")&&w]}),tooltip:!v("disable_guests")&&C,isLocked:m.disable_guests.isControlledByOrganization,lockedTooltip:(0,X().g)()}),(0,S.jsx)(Cn,{switcherStyle:f.switcher,upsellTier:d,on:m.disable_export.teamIsDisabled,disabled:!y("disable_export"),onChange:()=>x("disable_export"),shouldTriggerUpsell:b("disable_export"),secondCaption:M("disable_export"),title:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(s()._H,{id:"teamSettingsSecurity.setting.exportTitle",defaultMessage:"Disable export"}),!v("disable_export")&&w]}),tooltip:!v("disable_export")&&C,isLocked:m.disable_export.isControlledByOrganization,lockedTooltip:(0,X().g)()})],k=(0,S.jsx)(s()._H,{id:"TeamSettingsSecurity.pageSettingsTitle",defaultMessage:"Page Security"});return(0,S.jsx)(K().Ph,{title:k,rows:j,hideDividers:!0})}function Te(e){const t=(0,i().O7)(),n=(0,a().VK)((()=>(0,p().VB)(e.teamStore)),[e.teamStore]);return(0,S.jsx)(J().D,{style:e.style,icon:e=>(0,$().H)({...e,margin:"2px 17px 2px 2px",width:16,height:16}),onClick:async()=>await(async e=>{let{teamStore:n,teamName:o}=e;await B().YH({environment:t,teamStore:n,teamName:o,from:"sidebar_team_modal"})})({teamName:e.teamName,teamStore:e.teamStore}),disabled:!n,children:(0,S.jsxs)("div",{children:[(0,S.jsx)(P().Z,{children:(0,S.jsx)(s()._H,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamButton",defaultMessage:"Restore teamspace"})}),(0,S.jsx)(P().Z,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,S.jsx)(s()._H,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamCaption",defaultMessage:"Restoring this teamspace will add it to the sidebar for all teamspace members that were previously added."})})]})})}function Ie(e){const t=(0,i().O7)(),n=(0,r().yK)((()=>({archiveLabel:{color:w().ZP.red}})),[]);return(0,S.jsx)(J().D,{style:e.style,isRed:!0,icon:e=>(0,$().H)({...e,margin:"2px 17px 2px 2px",width:16,height:16}),disabled:e.disabled,disabledFeedback:e.disabled,onClick:async()=>{e.disabled||await B().aQ({environment:t,teamStore:e.teamStore,from:"sidebar_team_modal"})},...e.tooltipEvents,children:(0,S.jsxs)("div",{children:[(0,S.jsx)(P().Z,{style:n.archiveLabel,children:(0,S.jsx)(s()._H,{id:"teamSettingsSecurity.dangerZone.archiveTeamButton",defaultMessage:"Archive teamspace"})}),(0,S.jsx)(P().Z,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,S.jsx)(s()._H,{id:"sidebarTeamModalSettingsScreen.dangerZone.archiveTeamDescription",defaultMessage:"Removes teamspace from the sidebar for all members"})})]})})}function _e(e){return e?"disable":"allow"}const Pe=(0,s().vU)({noDescription:{id:"TeamSettingsGeneral.generalSettings.noDescription",defaultMessage:"No description"}});function Ze(e){let{teamStore:t}=e;const n=(0,i().O7)(),l=(0,a().VK)((()=>h().default.state.currentSpaceStore),[]),d=V(t),[c,u]=(0,o.useState)(void 0),[m,p]=(0,o.useState)(void 0),g=(0,r().yK)((()=>({container:{maxWidth:"none",marginLeft:4},nameAndIconWrap:{display:"flex",alignItems:"center",marginBottom:0,marginTop:4},icon:{marginRight:7},name:{height:20,background:"none",boxShadow:"none",padding:"0 8px"},description:{minHeight:20,background:"none",boxShadow:"none",padding:"0 8px",margin:"0 -8px"},updateButton:{marginTop:14},learnMoreLinkContainer:{marginTop:15,marginBottom:15}})),[20]),[f,v]=(0,a().VK)((()=>[t.getName(),t.getDescription()]),[t]);if(void 0===f)return null;const y=f||"",b=v??"",x=b.length>0,M=null==c?void 0:c.trim(),w=null==m?void 0:m.trim(),k=""===M||(void 0===m||w===b.trim())&&(void 0===c||M===y.trim()),T=(0,S.jsx)(s()._H,{id:"TeamSettingsGeneral.generalSettings.iconAndName.title",defaultMessage:"Icon and name"}),_=(0,S.jsxs)("div",{style:g.nameAndIconWrap,children:[(0,S.jsx)(H().p,{disabled:d,store:t,style:g.icon,size:20,onChange:e=>{j().createAndCommit({userAction:"TeamSettingsGeneral.updateIcon",environment:n,canUndo:!0,perform:n=>{B().fs({store:t,update:{icon:e},transaction:n})}})}}),d?(0,S.jsx)(P().Z,{children:y}):(0,S.jsx)(Ae,{value:c??y,style:g.name,onBlur:e=>{u(e)},onChange:e=>{u(e)},disabled:d,placeholder:"Acme Labs"})]}),R=(0,S.jsx)(s()._H,{id:"TeamSettingsGeneral.generalSettings.description.title",defaultMessage:"Description"}),L=Z().Z.formatMessage(Pe.noDescription),D=d?(0,S.jsx)(P().Z,{isMultiline:!0,isSecondaryColor:!x,children:x?b:L}):(0,S.jsx)(Ae,{value:void 0===m?b:m,onBlur:e=>{p(e)},onChange:e=>{p(e)},disabled:d,textarea:!0,autosize:!0,placeholder:L,style:g.description}),O=[(0,S.jsxs)(o.Fragment,{children:[(0,S.jsx)(P().Z,{isSmall:!0,children:T}),_]},"name"),(0,S.jsxs)(o.Fragment,{children:[(0,S.jsx)(P().Z,{isSmall:!0,children:R}),D]},"description")];return(0,S.jsxs)("div",{style:g.container,children:[(0,S.jsx)(K().Ph,{title:(0,S.jsx)(s()._H,{id:"TeamSettingsGeneral.generalSettings.details",defaultMessage:"Details"}),rows:O}),!d&&(0,S.jsx)(I().Z,{style:g.updateButton,disabled:k,isLarge:!0,onClick:async()=>{if(k)return;if(M&&M!==y.trim()){if(!(await(0,A().Xg)({environment:n,spaceStore:l,teamName:M})))return}const{performResult:e,serverCommitResult:o}=j().createAndCommit({userAction:"TeamSettingsGeneral.updateNameAndDescription",environment:n,canUndo:!0,perform:e=>{B().fs({store:t,update:{name:M??y,description:w??b},transaction:e})}});try{await Promise.all([e,o])}catch(i){return}C().oV({label:(0,S.jsx)(s()._H,{id:"TeamSettingsGeneral.settingsChanged",defaultMessage:"Updated teamspace details"})})},children:(0,S.jsx)(s()._H,{id:"teamsWorkspaceSettings.updateButton.label",defaultMessage:"Update"})}),(0,S.jsx)("br",{}),(0,S.jsx)(q,{teamStore:t}),(0,S.jsx)(Re,{teamStore:t}),(0,S.jsx)(F().Z,{helpCenterLocation:"bestPractices",analyticsFrom:"teams_learn_more_team_settings_general",containerStyle:g.learnMoreLinkContainer})]})}function Ae(e){const{value:t,style:n,onBlur:i,onChange:a,placeholder:r,disabled:s}=e,[l,d]=(0,o.useState)(!1);return(0,S.jsx)(k().Z,{capture:l,render:o=>(0,S.jsx)(T().Z,{textarea:e.textarea,autosize:e.autosize,onFocus:e=>{d(!0)},onBlur:e=>{d(!1),i(e.target.value)},onChange:e=>{d(!1),a&&a(e.target.value)},onSubmit:e=>{e.target.blur()},placeholder:r,disabled:s,value:t,style:n,...o})})}function Re(e){let{teamStore:t}=e;const n=(0,r().yK)((()=>({buttonStyle:{alignItems:"center",height:"auto",width:"100%",paddingTop:K().MQ,paddingBottom:K().MQ,paddingLeft:K().oM,paddingRight:K().oM}})),[]),[o,i]=(0,a().VK)((()=>[t.getName(),t.isArchived()]),[t]),l=(0,D().q)(t),d=(0,U().e)(t),c=(0,O().y)(t.id),u=(0,L().n)(),m=c&&!u;if(void 0===o||!d)return null;const p=[],g=(0,S.jsx)(N().Z,{buttonInternals:(0,S.jsx)(Be,{isTeamOwner:l}),teamStore:t,placement:R().Placement.Bottom,alignment:R().Alignment.Start,from:"sidebar_team_modal",style:n.buttonStyle,icon:e=>M({...e,margin:"2px 17px 2px 2px",width:16,height:16}),isRed:!l});if(p.push(g),l)if(i)p.push((0,S.jsx)(Te,{teamStore:t,teamName:o,style:n.buttonStyle}));else{const e=(0,S.jsx)(_().Z,{disableTooltip:!m,placement:R().Placement.Bottom,alignment:R().Alignment.Start,renderTooltip:()=>(0,S.jsx)(s()._H,{id:"sidebarTeamModalSettingsScreen.dangerZone.cannotArchive",defaultMessage:"Cannot archive this teamspace because it is the only default teamspace in this workspace."}),render:e=>(0,S.jsx)(Ie,{disabled:m,teamStore:t,tooltipEvents:e,style:n.buttonStyle})});p.push(e)}return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{style:{height:20,width:"100%"}}),(0,S.jsx)(K().Ph,{title:(0,S.jsx)(s()._H,{id:"sidebarTeamModalSettingsScreen.dangerZone.title",defaultMessage:"Danger zone"}),rows:p,itemStyle:{padding:0,margin:0}})]})}function Be(e){let{isTeamOwner:t}=e;const n=(0,r().yK)((()=>({label:{color:t?"inherit":w().ZP.red}})),[t]);return(0,S.jsxs)("div",{children:[(0,S.jsx)(P().Z,{style:n.label,children:(0,S.jsx)(s()._H,{id:"teamBrowser.teamCard.button.leaveTeam",defaultMessage:"Leave teamspace"})}),(0,S.jsx)(P().Z,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,S.jsx)(s()._H,{id:"teamBrowser.teamCard.button.leaveTeamDescription",defaultMessage:"Removes teamspace from your sidebar"})})]})}var Le=()=>n(899548),De=()=>n(966296),Ve=()=>n(296631),Oe=()=>n(558999),Ue=()=>n(669200);function Ne(e){let{teamStore:t}=e;const n=(0,r().yK)((e=>({container:{display:"flex",justifyContent:"space-between",alignItems:"center",position:"sticky",top:0,background:e.modalBackground,zIndex:10,paddingBottom:8},input:{boxShadow:e.inputBoxShadow,borderRadius:100,fontSize:12,width:"45%",maxWidth:260,marginRight:2},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor}})),[]),o=(0,s().YB)(),i=(0,a().VK)((()=>g().default.state.memberFilterQuery),[]),l=(0,a().qz)(void 0,Ve().Z),d=(0,Oe().e)(t),c=(0,a().VK)((()=>d&&!(0,p().U2)(t)),[t,d]);return(0,S.jsxs)("div",{style:n.container,children:[(0,S.jsxs)("div",{children:[(0,S.jsx)(De().B,{store:t,permissionsInviteStore:l,origin:(0,S.jsx)(_().Z,{placement:R().Placement.Left,alignment:R().Alignment.Start,textWrap:!0,renderTooltip:()=>d?(0,S.jsx)("div",{style:{width:"max-content",maxWidth:150},children:(0,S.jsx)(s()._H,{id:"teamPermissionsInviteWithModal.addMembers.tooltip",defaultMessage:"Add members and groups"})}):(0,S.jsx)("div",{style:{width:220},children:(0,S.jsx)(s()._H,{id:"teamPermissionsInviteWithModal.addMembersNoPermissions.tooltip",defaultMessage:"You do not have permissions to add members to this teamspace"})}),render:e=>(0,S.jsx)(I().Z,{disabled:!d,isLarge:!0,onClick:()=>{l.setState({...l.state,modalOpen:!0})},...e,children:(0,S.jsx)(s()._H,{id:"teamPermissionsInviteWithModal.openModal",defaultMessage:"Add members"})})})}),c&&(0,S.jsx)(Ue().u,{store:t,isSmall:!0})]}),(0,S.jsx)(T().Z,{placeholder:o.formatMessage({id:"teamPermissionsInviteWithModal.filterGroupsAndMembersInput.placeholder",defaultMessage:"Search for members or groups…"}),style:n.input,value:i,onChange:e=>{g().default.setState({...g().default.state,memberFilterQuery:e.target.value,limitMembers:!0})},left:(0,Le().R)(n.searchIcon),showClearButton:!0,format:T().B.Small})]})}n(122556),n(582845),n(250570),n(533019),n(721473),n(788208),n(22624);var Fe=()=>n(619186),He=()=>n(801812),Ke=()=>n(777346),Ee=()=>n(677559),We=()=>n(828946),ze=()=>n(18281),Ge=()=>n(255933),qe=()=>n(499110),Ye=()=>n(207917),$e=()=>n(98991),Je=()=>n(943620),Qe=()=>n(981583),Xe=()=>n(743790),et=()=>n(591914),tt=()=>n(467806),nt=(n(821057),()=>n(286977)),ot=()=>n(308186),it=()=>n(666414),at=()=>n(286338),rt=()=>n(616433),st=()=>n(529048),lt=()=>n(128119),dt=()=>n(815277),ct=()=>n(697623),ut=()=>n(741381),mt=()=>n(463807),pt=(n(228244),()=>n(306164)),gt=()=>n(542487),ft=()=>n(370005),ht=()=>n(122479);function vt(e){const{teamStore:t,memberInfo:n,permissionItem:l,memberName:d,style:c,onMenuItemClicked:u,isPermissionOverridden:m}=e,p=(0,i().O7)(),g=(0,s().YB)(),f=(0,o.useMemo)((()=>new(st().Z)),[]),v=(0,a().VK)((()=>t.getTeamPermission()),[t]),y=(0,a().VK)((()=>h().default.state.currentSpaceStore),[]),b=(0,a().VK)((()=>!("enterprise"===(null==y?void 0:y.getSubscriptionTier()))&&!m),[y,m]),x=(0,D().q)(t),M=b||!x,w=(0,a().VK)((()=>{if(null==t||!t.isDefined())return;const e=g.formatMessage({id:"teamMemberPermissionRoleSelect.member.permissionitem.description",defaultMessage:"You can't give less access than the teamspace default. Lower teamspace members‘ access to enable this option."}),n=(0,S.jsx)(s()._H,{id:"teamMemberPermissionRoleSelect.permissionItem.defaultTag",defaultMessage:"default"});return["editor","read_and_write","comment_only","reader"].map((function(o){const i=(null==v?void 0:v.role)===o?n:void 0;return(0,ie().bk)({teamValue:{id:t.id,permissions:t.getPermissionItems()},permissionRole:o})?{role:o,disabledInfo:{isDisabled:!0,disabledMessage:e},tag:i}:{role:o,tag:i}}))}),[v,g,t]);const C=(0,r().yK)((e=>({header:{display:"flex",flexDirection:"column",backgroundColor:e.sidebarSecondaryBackground,fontSize:12,color:e.mediumTextColor,alignItems:"flex-start",paddingTop:10,paddingLeft:12,paddingRight:12,paddingBottom:10},overrideTitle:{display:"flex",alignItems:"center",justifyContent:"space-between",height:28},overrideLabel:{paddingLeft:8,color:e.mediumTextColor},roleSelectButton:{marginRight:0,fontSize:12,color:e.mediumTextColor,visibility:m?void 0:"hidden"},disabledItem:{...c,color:e.lightTextColor}})),[c,m]),k=(0,S.jsxs)("div",{style:C.overrideTitle,children:[(0,S.jsx)(s()._H,{id:"TeamMemberOwnerSelect.permissionsOverride",defaultMessage:"Custom permissions"}),b?(0,S.jsx)(ee().Z,{subscriptionTier:"enterprise",analyticsName:"team_member_permission_override",desktopStyle:{marginLeft:8,marginRight:12}}):(0,S.jsx)(ft().ZP,{role:"owner"===n.type?"none":l.role,table:pt().e0,type:"user"===n.entity_type?"user_permission":"group_permission",upgradeButtonName:"user"===n.entity_type?"user_permission_item":"group_permission_item",disabled:M,buttonStyle:C.roleSelectButton,availableRoleItems:w,header:(0,S.jsx)(P().Z,{isSmall:!0,isSecondaryColor:!0,style:{fontWeight:600,marginLeft:16,marginTop:8},children:(0,S.jsx)(s()._H,{id:"teamMemberPermissionRoleSelect.permissionOverride.menuHeader",defaultMessage:"Select custom role"})}),onChange:e=>{"none"!==e&&(!function(e){ot().vC({message:(0,S.jsx)(s()._H,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.message",defaultMessage:"Are you sure you want to change {name}'s role to {role}?",values:{name:d,role:(0,ht().r_)(e).toLowerCase()}}),description:(0,S.jsx)(s()._H,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.description",defaultMessage:"This change won't apply to any restricted pages in the teamspace."}),showCancel:!0,keepFocus:!1,handleCancel:ot().lo,items:[{label:(0,S.jsx)(s()._H,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:async()=>{const{serverCommitResult:o}=j().createAndCommit({userAction:"TeamMemberPermissionRoleSelect.handleRoleSelect",environment:p,canUndo:!0,perform:o=>{B().jg({memberInfo:n,teamStore:t,transaction:o,environment:p,permissionRole:e})}});await o,t.isDefault()&&(t.getMembershipDefinedOnTeam().some((e=>(0,gt().ah)(e,n)))||await B().Uj({environment:p,teamStore:t,teamMemberInfos:[n],isSettingDefaultTeam:!0,createNewTeamFlowId:void 0}))}}]})}(e),u&&u())},buttonPopupStore:f,placementToOrigin:lt().Iw.Right,alignmentToOrigin:lt().lU.End})]});return(0,S.jsx)(_().Z,{placement:M?R().Placement.Right:R().Placement.Left,textWrap:!0,renderTooltip:()=>M&&!x?(0,S.jsx)(s()._H,{id:"teamMemberPermissionRoleSelect.permissionOverride.buttonTooltip.disabled",defaultMessage:"You must be a teamspace owner to set custom permission level"}):(0,S.jsx)(s()._H,{id:"teamMemberPermissionRoleSelect.permissionOverride.buttonTooltip",defaultMessage:"Set a custom permission level for all pages in this teamspace"}),render:e=>(0,S.jsx)(me().Z,{...e,focused:!1,disabled:M,style:M?C.disabledItem:c,textWrapperStyle:{marginRight:0},onClick:()=>f.setState({open:!0}),title:k,icon:m?(0,S.jsx)("div",{style:{marginTop:8},children:(0,nt().e)({width:14})}):void 0})})}function yt(e){let{teamStore:t,memberInfo:n,permissionItem:o,memberName:r,isPermissionOverridden:l,disabled:c}=e;const u=(0,a().qz)(void 0,st().Z),m=(0,i().O7)(),g=(0,a().VK)((()=>h().default.state.currentSpaceStore),[]),f=(0,a().VK)((()=>h().default.state.currentUserStore),[]),v=(0,a().VK)((()=>{const e=null==f?void 0:f.userId;return"user"===n.entity_type&&n.user_id===e}),[null==f?void 0:f.userId,n]),y=()=>u.setState({...u.state,open:!1}),b=(0,D().q)(t),x=(0,dt().VX)({name:"team_self_promotion",spaceId:null==g?void 0:g.id,userId:null==f?void 0:f.userId}),M=(0,a().VK)((()=>{const{currentSpaceStore:e}=h().default.state;return Boolean(null==e?void 0:e.canAdmin())}),[]),w=(0,a().VK)((()=>{const{ownerUserIds:e,ownerGroupIds:n}=t.getAllOwnerIds();return e.length+n.length}),[t]),C=(0,mt().l)(t),k=0===w,T=async e=>{y();const o="owner"===e?(0,S.jsx)(s()._H,{defaultMessage:"owner",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelOwner"}):(0,S.jsx)(s()._H,{defaultMessage:"member",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelMember"});if("team_level_guest"!==n.type||"owner"!==e&&"member"!==e)if("owner"===e){if("user"===n.entity_type||"group"===n.entity_type){const e=async()=>{const{serverCommitResult:e}=j().createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:m,canUndo:!0,perform:e=>{B().W8({environment:m,memberInfo:n,teamStore:t,transaction:e})}});await e},o=async()=>{await B().wT({environment:m,teamStore:t,currentSpaceStore:g,from:"team_settings_members",action:"upgradeToOwner"})};k&&v?ot().vC({message:(0,S.jsx)(s()._H,{id:"teamMemberPermissionSettings.upgradeOwnerForUnownedTeamConfirmation.message",defaultMessage:"Are you sure you want to become a teamspace owner? You can become the teamspace owner since there are no other owners and you are a workspace admin."}),showCancel:!0,keepFocus:!1,handleCancel:ot().lo,items:[{label:(0,S.jsx)(s()._H,{id:"teamMemberPermissionSettings.upgradeOwnerForUnownedTeamConfirmation.accept",defaultMessage:"Become teamspace owner"}),color:"blue",onAccept:async()=>{await e()}}]}):v&&x&&M?await o():await e()}}else v&&b?ot().vC({message:(0,S.jsx)(s()._H,{id:"teamMemberPermissionSettings.removeSelfTeamOwner.confirmation.message",defaultMessage:"Are you sure you want to remove yourself as a teamspace owner? You'll no longer be able to edit teamspace settings and permissions."}),showCancel:!0,keepFocus:!1,handleCancel:ot().lo,items:[{label:(0,S.jsx)(s()._H,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:I}]}):await I();else{const i=(0,p().s4)(n.user_id).length;ot().vC({message:(0,S.jsx)(S.Fragment,{children:i>1?(0,S.jsx)(s()._H,{id:"teamMemberPermissionSettings.upgradeGuestConfirmationWithOtherTeamspaces.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member, and they will become a member in {numberOfOtherTeams, plural, one {{numberOfOtherTeams} other teamspace} other {{numberOfOtherTeams} other teamspaces}}.",values:{memberOrOwner:o,numberOfOtherTeams:i-1}}):(0,S.jsx)(s()._H,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member.",values:{memberOrOwner:o}})}),showCancel:!0,keepFocus:!1,handleCancel:ot().lo,items:[{label:(0,S.jsx)(s()._H,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.accept",defaultMessage:"Add to workspace"}),color:"blue",onAccept:async()=>{if(g){const{serverCommitResult:o}=j().createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:m,canUndo:!0,perform:o=>{B().Ce({environment:m,userId:n.user_id,teamStore:t,transaction:o,spaceStore:g,newTeamRole:e})}});await o}}}]})}},I=async()=>{if("owner"!==n.type||"user"!==n.entity_type&&"group"!==n.entity_type){if("member"===n.type){const{serverCommitResult:e}=j().createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:m,canUndo:!0,perform:e=>{B().X0({environment:m,memberInfo:n,teamStore:t,transaction:e})}});await e}}else{const{serverCommitResult:e}=j().createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:m,canUndo:!0,perform:e=>{B().mX({memberInfo:n,teamStore:t,transaction:e,environment:m})}});await e}},_=async()=>{var e;const{entity_type:o}=n;switch(y(),o){case"group":const i=null===(e=tt().Z.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===n.group_id)))||void 0===e?void 0:e.group;if(!i)throw new Error("Permission group not found in space.");B().mN({environment:m,teamStore:t,group:i});break;case"user":await B().WO({environment:m,teamStore:t,userId:n.user_id,from:"team_settings_member_table",userGroupsInTeam:C});break;default:(0,d().t1)(o)}};return(0,S.jsx)(pe().ZP,{buttonPopupStore:u,placementToOrigin:lt().Iw.Bottom,renderOrigin:e=>(0,S.jsx)(xt,{buttonPopupEvents:e,isPermissionOverridden:l,permissionItem:o,memberInfo:n,disabled:c}),render:()=>(0,S.jsx)(bt,{teamStore:t,isPermissionOverridden:l,memberInfo:n,permissionItem:o,memberName:r,numberOfOwners:w,isMemberCurrentUser:v,onMenuItemClicked:T,onRemoveClicked:_,onSubMenuItemClicked:y}),popupType:pe().Z4.Popup})}function bt(e){let{teamStore:t,isPermissionOverridden:n,memberInfo:o,permissionItem:i,memberName:s,numberOfOwners:d,isMemberCurrentUser:u,onRemoveClicked:p,onMenuItemClicked:g,onSubMenuItemClicked:f}=e;const v=(0,a().VK)((()=>{const{currentSpaceStore:e}=h().default.state;return!Boolean(null==e?void 0:e.getSettingsStore().getKeyStore("disable_team_guests").getValue())&&(0,at().F$)()}),[]),y=(0,a().VK)((()=>t.isDefault()),[t]),b=(0,rt().J)(),x=(0,a().VK)((()=>{const{currentSpaceStore:e}=h().default.state;return Boolean((null==e?void 0:e.canAdmin())&&(0,ct().wP)())}),[]),M=(0,D().q)(t),w=(0,Oe().e)(t),C=1===d,j=0===d,k=(0,r().yK)((e=>{const t={paddingTop:5,paddingBottom:5},n={...t,width:280,alignItems:"flex-start"};return{actionMenu:{marginTop:-4},removeButton:{...t,color:e.errorText},menuItem:n,indentedMenuItem:{...n,paddingLeft:20},overrideLabel:{paddingLeft:10,color:e.mediumTextColor,fontSize:12,fontWeight:c().Ue.regular}}}),[]),T=(e,t,n)=>(0,ut().o)({isCurrentUserTeamOwner:M,role:e,isDefaultTeam:y,userIsSpaceAdmin:Boolean(b),userIsEnterpriseWorkspaceOwner:x,originalTeamMemberInfo:t,onlyHasOneOwner:C,isUnowned:j,isMemberCurrentUser:u,canCurrentUserAddTeamMembers:n}),I=(e,t)=>{const{isDisabled:o,disabledReason:i}=T(e,t,w);return{key:e,action:()=>g(e),render:a=>{const r=!n&&t.type===e;return(0,S.jsx)(_().Z,{disableTooltip:!o,placement:R().Placement.Right,textWrap:!0,renderTooltip:()=>i,render:t=>(0,S.jsx)("span",{...t,children:(0,S.jsx)(me().Z,{...a,style:r?k.menuItem:k.indentedMenuItem,disabled:o,disabledFeedback:o,title:(0,S.jsx)(St,{type:e}),caption:wt(e),shouldWrapCaption:!0,icon:r?(0,nt().e)({width:14}):void 0})})})}}},P=y&&"user"===o.entity_type,Z="group"!==o.entity_type&&v,A=[{key:"teamRoles",items:l().oA([I("owner",o),I("member",o),Z?I("team_level_guest",o):void 0,Ct({onRemoveClicked:p,styles:k,...T("none",o,w),isMemberInDefaultTeam:P}),..."owner"===o.type||j?[]:[{key:"divider",action:()=>{},render:()=>(0,S.jsx)(it().Z,{size:10})},{key:"permissions_override",action:()=>{},render:e=>(0,S.jsx)("span",{...e,children:(0,S.jsx)(vt,{teamStore:t,memberInfo:o,permissionItem:i,memberName:s,onMenuItemClicked:f,isPermissionOverridden:n,style:n?k.menuItem:k.indentedMenuItem})})}]]),render:e=>(0,S.jsx)(he().Z,{...e,topBorder:0!==e.index})}];return(0,S.jsx)(ge().Z,{className:m().a6i,menuType:ye().o.Popup,children:(0,S.jsx)(fe().ZP,{type:fe().iW.Vertical,initialFocus:void 0,sections:A})})}function xt(e){let{buttonPopupEvents:t,disabled:n,isPermissionOverridden:o,permissionItem:i,memberInfo:a}=e;const l=(0,r().yK)((e=>({label:{color:e.regularTextColor,fontSize:12.5,fontWeight:c().Ue.regular},overrideLabel:{color:e.mediumTextColor,fontSize:12,fontWeight:c().Ue.regular},chevron:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),u=function(e,t,n){if(t&&n)return function(e){switch(e){case"none":return(0,S.jsx)(s()._H,{id:"TeamMemberOwnerSelect.roleName.none",defaultMessage:"No access"});case"reader":return(0,S.jsx)(s()._H,{id:"TeamMemberOwnerSelect.roleName.reader",defaultMessage:"Can view"});case"comment_only":return(0,S.jsx)(s()._H,{id:"TeamMemberOwnerSelect.roleName.comment_only",defaultMessage:"Can comment"});case"content_only_editor":return(0,S.jsx)(s()._H,{id:"TeamMemberOwnerSelect.roleName.content_only_editor",defaultMessage:"Can edit content"});case"membership_admin":case"read_and_write":return(0,S.jsx)(s()._H,{id:"TeamMemberOwnerSelect.roleName.read_and_write",defaultMessage:"Can edit"});case"editor":return(0,S.jsx)(s()._H,{id:"TeamMemberOwnerSelect.roleName.editor",defaultMessage:"Full access"});default:(0,d().t1)(e)}}(n);return Mt(e)}(a.type,o,i.role);return(0,S.jsxs)(J().D,{disabled:n,...t,children:[o&&(0,S.jsxs)("span",{style:l.overrideLabel,children:[(0,S.jsx)(s()._H,{id:"TeamMemberOwnerSelect.roleName.custom",defaultMessage:"Custom"}),(0,S.jsx)("span",{style:{marginLeft:5,marginRight:5},children:"•"})]}),(0,S.jsx)("span",{style:l.label,children:u}),!n&&(0,ne().i)(l.chevron)]})}function St(e){let{type:t}=e;const n=Mt(t);return(0,S.jsx)("div",{children:(0,S.jsx)("span",{children:n})})}function Mt(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,S.jsx)(s()._H,{...p().q9[e].label});case"none":return;default:(0,d().t1)(e)}}function wt(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,S.jsx)(s()._H,{...p().q9[e].caption});case"none":return;default:(0,d().t1)(e)}}function Ct(e){let{styles:t,isDisabled:n,disabledReason:o,onRemoveClicked:i,isMemberInDefaultTeam:a}=e;return{key:"remove",action:i,render:e=>(0,S.jsx)(_().Z,{disableTooltip:!n,placement:R().Placement.Right,textWrap:!1,renderTooltip:()=>o,render:o=>(0,S.jsx)("span",{...o,children:(0,S.jsx)(me().Z,{...e,style:{...t.removeButton,...t.indentedMenuItem},disabled:n,disabledFeedback:!0,title:(0,S.jsx)(s()._H,{id:"TeamMemberOwnerSelect.remove",defaultMessage:"Remove"})})})})}}var jt=()=>n(469203);function kt(e){const{icon:t,label:n,name:o,tag:i,style:a}=e,s=(0,r().yK)((e=>({container:{display:"flex",flexDirection:"row",alignItems:"center",gap:10,...a},labelContainer:{display:"flex",flexDirection:"column",...c().Yu,marginLeft:5},name:{minWidth:30},nameContainer:{display:"flex",flexDirection:"row",alignItems:"center"}})),[a]);return(0,S.jsxs)("div",{style:s.container,children:[t,(0,S.jsxs)("div",{style:s.labelContainer,children:[(0,S.jsxs)("div",{style:s.nameContainer,children:[(0,S.jsx)(jt().s,{style:s.name,children:o}),i]}),n&&(0,S.jsx)(P().Z,{isSmall:!0,isSecondaryColor:!1,isMultiline:!0,children:(0,S.jsx)(jt().s,{children:n})})]})]})}function Tt(e){const{iconComponent:t,label:n,name:o,permissionRoleSelectComponent:i,tag:a,tooltip:s,style:l}=e,d=(0,r().yK)((e=>({permissionRow:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:36,justifyContent:"space-between",alignItems:"center",...l}})),[l]);return(0,S.jsxs)("div",{style:d.permissionRow,children:[(0,S.jsx)(kt,{icon:t,name:o,tag:a,label:n,style:{minWidth:200,marginRight:6}}),(0,S.jsx)(_().Z,{textWrap:!0,style:{width:210},disableTooltip:!s,placement:R().Placement.Left,renderTooltip:()=>s,render:e=>(0,S.jsx)("span",{...e,children:i})})]})}function It(e){const{type:t,store:n,permissionItem:o,memberInfo:l}=e,c=(0,i().O7)(),u=(0,s().YB)(),m="group"===t?e.permissionGroup:void 0,g="user"===t?e.userStore:void 0,f=(0,a().VK)((()=>h().default.state.currentSpaceStore),[]),v=(0,a().VK)((()=>{var e;switch(t){case"group":return"none";case"user":const n=l.user_id;return(null===(e=(0,et()._P)(f,n))||void 0===e?void 0:e.getMembershipTypeAsRoleOrNone())??"none";default:(0,d().t1)(t)}}),[t,l,f]),y=(0,D().q)(n),b=(0,Oe().e)(n),x=(0,a().VK)((()=>{const{currentSpaceStore:e}=h().default.state;return null==e?void 0:e.canEditMembership()}),[]),M=(0,a().VK)((()=>{const e=c.currentUser.id,t=n.getSettingsStore().getValue();return!!(null!=f&&f.isDefined()&&n.isDefined()&&t&&e)&&(0,p().W9)({environment:c,teamStore:n,spaceStore:f})}),[c,f,n]),w=(0,a().VK)((()=>{const e=n.getPermissionItems()||[];switch(l.entity_type){case"group":return!!e.find((e=>(0,oe().hV)(e)&&e.group_id===l.group_id));case"user":return!!e.find((e=>(0,oe().jg)(e)&&e.user_id===l.user_id));default:return!1}}),[l,n]),{name:C,label:j,icon:k,isSelfUserPermission:T}=(0,a().VK)((()=>{const e=c.currentUser.id;switch(t){case"group":return Pt({permissionGroup:m,spaceId:null==f?void 0:f.id});case"user":return function(e){var t;let{intl:n,userStore:o,currentUserId:i}=e;const a=void 0!==i&&(null==o||null===(t=o.getModel())||void 0===t?void 0:t.id)===i;return{name:(0,qe().Nz)(n,null==o?void 0:o.getModel()),label:null==o?void 0:o.getEmail(),icon:(0,S.jsx)(Qe().Z,{avatarShouldShowShadow:!0,userStore:o,size:32}),isSelfUserPermission:a}}({intl:u,userStore:g,currentUserId:e});default:(0,d().t1)(t)}}),[c.currentUser.id,t,m,null==f?void 0:f.id,u,g]),I=(0,S.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,S.jsx)(yt,{teamStore:n,memberInfo:l,memberName:C,permissionItem:o,isPermissionOverridden:w,disabled:b&&"member"===l.type?!y&&w:!y&&!M||"team_level_guest"===l.type&&!x})}),_=(0,r().yK)((e=>({row:{minHeight:52},pill:{marginLeft:6,height:17},titleYouIndicator:{color:e.mediumTextColor}})),[]),P=(0,S.jsxs)("div",{style:{display:"flex",gap:4},children:[C,T&&(0,S.jsx)("span",{style:_.titleYouIndicator,children:(0,S.jsx)(s()._H,{id:"specificTeamMemberPermissionRow.displayName.youIndicator",defaultMessage:"(You)"})})]});return(0,S.jsx)(Tt,{style:_.row,tag:(0,oe().Bc)(v)?(0,S.jsx)(Ye().Z,{desktopStyle:_.pill,mobileStyle:_.pill,role:_t(v)}):"group"===t?(0,S.jsx)("div",{style:_.pill,children:k}):void 0,permissionRoleSelectComponent:I,iconComponent:"group"===t?(0,S.jsx)($e().Z,{size:32}):k,name:P,label:j})}function _t(e){switch(e){case"editor":return"admin";case"membership_admin":return"membership_admin";default:(0,d().t1)(e)}}function Pt(e){var t;let{spaceId:n,permissionGroup:o}=e;const{name:i,icon:a}=o,r=(null===(t=tt().Z.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===o.group_id)))||void 0===t?void 0:t.memberCount)??0;return{name:i||(0,S.jsx)(s()._H,{id:"teamPermissionSettings.untitled",defaultMessage:"Untitled"}),label:(0,S.jsx)(_().Z,{placement:R().Placement.Bottom,alignment:R().Alignment.Start,disableTooltip:0===r,renderTooltip:()=>(0,S.jsx)(Xe().Y,{group:o,limit:10,noMembersMessage:void 0}),render:e=>(0,S.jsxs)("div",{...e,children:[(0,S.jsx)(s()._H,{id:"teamPermissionSettings.group",defaultMessage:"Group"})," • ",(0,S.jsx)(s()._H,{id:"teamPermissionSettings.numberOfMembers",defaultMessage:"{groupSize, plural, one {{groupSize} member} other {{groupSize} members}}",values:{groupSize:r}})]})}),icon:a&&(0,S.jsx)(Je().Z,{bucket:"public",disabled:!0,onChange:()=>{},isEmptyPage:!1,title:i,size:18,icon:a&&n?{icon:a,pointer:{table:Ge().bx,id:n}}:void 0}),isSelfUserPermission:!1}}var Zt=()=>n(159732),At=()=>n(576387);function Rt(e){let{teamStore:t,...n}=e;const l=(0,i().O7)(),d=(0,a().VK)((()=>{var e;return null===(e=h().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),c=(0,s().YB)(),u=(0,r().yK)((()=>({container:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:52,justifyContent:"space-between",alignItems:"center"},pill:{marginLeft:6,height:17}})),[]),m=(0,o.useCallback)((e=>{C().oV({label:(0,S.jsx)(s()._H,{id:"SpecificTeamMemberToAddRow.team_invite_failure",defaultMessage:"Failed to add {userOrGroupName}",values:{userOrGroupName:e}})})}),[]),p=(0,o.useCallback)((async(e,n)=>{await B().Uj({environment:l,teamMemberInfos:[e],teamStore:t,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})?await At().bi(l):m(n)}),[l,m,t]),g=(0,o.useCallback)(((e,t)=>p({type:"member",entity_type:"user",user_id:e.id},t)),[p]),f=(0,o.useCallback)(((e,t)=>p({type:"member",entity_type:"group",group_id:e.group_id},t)),[p]),v=(0,a().VK)((()=>{if("groupToAdd"in n)return Pt({spaceId:d,permissionGroup:n.groupToAdd})}),[d,n]);if("memberToAdd"in n){const{memberToAdd:e}=n,t=(0,qe().Nz)(c,e);return(0,S.jsxs)("div",{style:u.container,children:[(0,S.jsx)(kt,{icon:(0,S.jsx)(Qe().Z,{userValue:e,size:32}),name:t,label:e.email}),Bt((()=>{g(e,t)}))]})}{if(!d||!v)return(0,S.jsx)(S.Fragment,{});const{groupToAdd:e}=n;return(0,S.jsxs)("div",{style:u.container,children:[(0,S.jsx)(kt,{icon:(0,S.jsx)($e().Z,{size:32}),name:v.name,label:v.label,tag:(0,S.jsx)("div",{style:u.pill,children:v.icon})}),Bt((()=>{f(e,v.name)}))]})}}function Bt(e){return(0,S.jsx)(J().D,{isBlue:!0,onClick:e,icon:Zt().R,children:(0,S.jsx)(s()._H,{id:"SpecificTeamMemberToAddRow.addMemberButton.text",defaultMessage:"Add"})})}var Lt=()=>n(682890),Dt=()=>n(214993);function Vt(e){let{sortType:t,onChangeSortType:n}=e;const o=(0,r().yK)((e=>({container:{width:"100%",display:"flex",justifyContent:"space-between",borderBottom:`1px solid ${e.regularDividerColor}`}})),[]),i=e=>e===t.column?t.sortedAscending?"ascending":"descending":"none",a=e=>{const o=e===t.column&&!t.sortedAscending;n({column:e,sortedAscending:o})};return(0,S.jsxs)("div",{style:o.container,children:[(0,S.jsx)(Ot,{title:(0,S.jsx)(s()._H,{id:"TeamPermissionsListHeader.nameColumn",defaultMessage:"Name"}),sortedType:i("name"),onClick:()=>a("name")}),(0,S.jsx)(Ot,{title:(0,S.jsx)(s()._H,{id:"TeamPermissionsListHeader.roleColumn",defaultMessage:"Role"}),sortedType:i("role"),onClick:()=>a("role")})]})}function Ot(e){let{sortedType:t,title:n,onClick:o}=e;const i=(0,r().yK)((e=>({button:{color:e.mediumTextColor,fontSize:12,padding:0},buttonHover:{background:"unset"},sortIcon:{width:14,height:14,marginRight:5,fill:e.mediumIconColor}})),[]);return(0,S.jsxs)(J().D,{style:i.button,hoveredStyle:i.buttonHover,onClick:o,children:["ascending"===t&&(0,Dt().Z)(i.sortIcon),"descending"===t&&(0,Lt().M)(i.sortIcon),n]})}function Ut(e){let{store:t}=e;const n=(0,i().O7)(),l=(0,r().yK)((e=>({container:{display:"block",overflow:"hidden"},membersHeader:{marginBottom:8},noResult:{fontSize:c().JB.UIRegular.desktop,color:e.mediumTextColor,marginTop:8},showMore:{marginBottom:24,width:"max-content"}})),[]),u=(0,s().YB)(),[m,f]=(0,o.useState)({column:"role",sortedAscending:!1}),v=(0,Oe().e)(t),y=(0,a().VK)((()=>t.getMemberInfoUsingSpaceMembers((0,ze().Io)())??[]),[t]),b=(0,a().VK)((()=>h().default.state.currentSpaceStore),[]),x=(0,a().VK)((()=>h().default.state.currentUserStore),[]),{permissionRowInfos:M,numNotShown:w}=(0,a().VK)((()=>{const e=function(e){let{permissionRowInfos:t,memberFilterQuery:n,intl:o}=e;if(""===n)return t;return(0,Fe().ZP)(n,t,(e=>{const{type:t}=e;switch(t){case"group":return e.permissionGroup.name||"";case"user":const{userStore:n}=e;return n.getSearchName(o);default:(0,d().t1)(t)}}))}({permissionRowInfos:(0,p().tu)({currentUserStore:x,currentSpaceStore:b,teamStore:t,members:y}),memberFilterQuery:g().default.state.memberFilterQuery,intl:u}),n=function(e){let{permissionRowInfos:t,sortType:n,intl:o}=e;const{column:i,sortedAscending:a}=n,r={permissionRowInfos:t,sortedAscending:a};if("role"===i)return function(e){let{permissionRowInfos:t,sortedAscending:n}=e;const o=["owner","member","team_level_guest"],i=["group","user"];return[...t].sort(((e,t)=>{const n=e.memberInfo.entity_type,o=t.memberInfo.entity_type;return i.indexOf(n)-i.indexOf(o)})).sort(((e,t)=>{const i=e.memberInfo.type,a=t.memberInfo.type,r=o.indexOf(i)-o.indexOf(a);return n?-r:r}))}(r);if("name"===i)return function(e){let{permissionRowInfos:t,sortedAscending:n,intl:o}=e;return[...t].sort(((e,t)=>{const i=Nt(e,o)??"",a=Nt(t,o)??"";if(i===a)return 0;const r=i<a?-1:1;return n?-r:r}))}({...r,intl:o});(0,d().t1)(i)}({permissionRowInfos:e,sortType:m,intl:u}),o=g().default.state.limitMembers?n.slice(0,50):n;return{permissionRowInfos:o,numNotShown:e.length-o.length}}),[b,x,y,t,m,u]),C=(0,Ee().XJ)(We().x.searchActions),j=(0,a().VK)((()=>g().default.state.memberFilterQuery),[]),[k]=(0,He().r5)((async()=>{if(!v||null==j||!j.trim().length||"resolved"!==C.status)return[];const e=C.value;return[...(await e.searchVisibleSpaceUsers({environment:n,query:j,membersOnly:!0})).map((e=>({type:"user",value:e}))),...e.searchSpaceGroups({query:j,intl:u}).map((e=>({type:"group",value:e})))]}),[v,j,C.status,C.value,n,u]),T=(0,a().VK)((()=>{if("resolved"!==k.status)return[];const e=new Set(M.map(Ht));return k.value.filter((t=>!e.has("user"===t.type?t.value.id:t.value.group_id))).slice(0,5)}),[k.status,k.value,M]),I=Boolean(null==j?void 0:j.trim().length),_=M.length>0;return(0,S.jsxs)("div",{style:l.container,children:[(0,S.jsx)(Ft,{title:I?(0,S.jsx)(s()._H,{id:"TeamPermissionsList.search.inThisTeam",defaultMessage:"In this teamspace"}):(0,S.jsx)(Vt,{sortType:m,onChangeSortType:f}),rows:M,renderRow:e=>(0,S.jsx)(It,{store:t,...e})}),w>0&&(0,S.jsx)(Ke().Z,{style:l.showMore,onClick:()=>{g().default.update((e=>({...e,limitMembers:!1})))},children:(0,S.jsx)(s()._H,{defaultMessage:"Show {numNotShown} more",id:"teamPermissionSettings.member.showMore",values:{numNotShown:w}})}),T.length>0&&(0,S.jsx)(Ft,{title:(0,S.jsx)(s()._H,{id:"TeamPermissionsList.search.notInTeam",defaultMessage:"Not in teamspace"}),rows:T,renderRow:e=>"user"===e.type?(0,S.jsx)(Rt,{teamStore:t,memberToAdd:e.value}):(0,S.jsx)(Rt,{teamStore:t,groupToAdd:e.value})}),!_&&0===T.length&&(0,S.jsx)("div",{style:l.noResult,children:(0,S.jsx)(s()._H,{id:"TeamPermissionsList.search.zeroState",defaultMessage:"No members or groups found"})})]})}function Nt(e,t){const{type:n}=e;if("user"===n){const{userStore:n}=e;return n.getDisplayName(t)}if("group"===n){const{permissionGroup:t}=e;return t.name}(0,d().t1)(n)}function Ft(e){let{rows:t,renderRow:n,title:i}=e;const a=(0,r().yK)((e=>({membersList:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",width:"100%",marginBottom:12},memberDivider:{borderBottom:`1px solid ${e.regularDividerColor}`}})),[]);return t.length?(0,S.jsxs)(S.Fragment,{children:[i&&(0,S.jsx)(P().Z,{isSmall:!0,children:i}),(0,S.jsx)("div",{style:a.membersList,children:t.map(((e,t)=>(0,S.jsxs)(o.Fragment,{children:[t>0&&(0,S.jsx)("div",{style:a.memberDivider}),n(e)]},t)))})]}):null}function Ht(e){switch(e.type){case"user":return e.memberInfo.user_id;case"group":return e.memberInfo.group_id;default:(0,d().t1)(e)}}function Kt(e){let{teamStore:t}=e;const n=(0,r().yK)((()=>({content:{display:"grid",gridAutoFlow:"row",rowGap:6}})),[]);return(0,S.jsxs)("div",{style:n.content,children:[(0,S.jsx)(Ne,{teamStore:t}),(0,S.jsx)(Ut,{store:t})]})}var Et=()=>n(890085);function Wt(e){const{teamStore:t}=e,n=(0,i().O7)(),o=(0,s().YB)(),{teamGuestPermissionItem:l,teamPermissions:d}=(0,a().VK)((()=>({teamGuestPermissionItem:t.getTeamGuestsPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),c=V(t),u=(0,a().VK)((()=>[{role:"editor",disabledInfo:{isDisabled:!0,disabledMessage:o.formatMessage({id:"teamPermissionsSettings.teamspace.guest.disabledPermissionitem.description",defaultMessage:"Teamspace guests can't have full access."})}},{role:"read_and_write",disabledInfo:void 0},{role:"comment_only",disabledInfo:void 0},{role:"reader",disabledInfo:void 0}]),[o]),m=(0,r().yK)((e=>({button:{fontSize:12.5,marginRight:0,color:e.mediumTextColor}})),[]),p=l&&(0,S.jsx)(ft().ZP,{role:l.role,table:pt().e0,type:"explicit_team_guest_permission",upgradeButtonName:"team_permission_item",disabled:c,buttonStyle:m.button,availableRoleItems:u,onChange:async e=>{if(d.filter((t=>((0,oe().jg)(t)||(0,oe().hV)(t))&&(0,ie().xO)(e,t.role))).length>0){if(!(await(0,A().Bt)()))return}j().createAndCommit({userAction:"TeamGuestsPermissionRow.permissionComponent",environment:n,canUndo:!0,perform:o=>{B().$J({environment:n,teamStore:t,newRole:e,transaction:o,permissionsToClear:[]})}})}}),g=(0,a().VK)((()=>t.getName()),[t]),f=(0,a().VK)((()=>t.getIcon()),[t]),h=f&&Et().V2(f.icon)?Et().mk(f.icon):"gray",v=f?{...f,icon:`/icons/user-circle_${h}.svg`}:void 0,y=(0,S.jsx)(H().p,{disabled:!0,store:t,size:K().Kt,icon:v});return p?(0,S.jsx)(Tt,{permissionRoleSelectComponent:p,iconComponent:y,name:zt(g)}):null}function zt(e){return e?(0,S.jsx)(s()._H,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessTeamSpaceName",values:{teamName:e}}):(0,S.jsx)(s()._H,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessWithoutTeamspaceName"})}function Gt(e){const{teamStore:t}=e,n=(0,i().O7)(),o=(0,r().Fg)(),l=(0,s().YB)(),{teamPermissionItem:d,teamPermissions:c}=(0,a().VK)((()=>({teamPermissionItem:t.getTeamPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),u=V(t),m=(0,a().VK)((()=>{var e;const n=null===(e=t.getPermissionItems())||void 0===e?void 0:e.find((e=>"space_permission"===e.type)),o=l.formatMessage({id:"teamPermissionsSettings.teamspace.disabledPermissionitem.description",defaultMessage:"Teamspace members can't have lower permissions than workspace members"});function i(e){return n&&e!==n.role&&(0,ie().nl)(e,n.role)===n.role&&!t.isDefault()?{role:e,disabledInfo:{isDisabled:!0,disabledMessage:o}}:{role:e,disabledInfo:void 0}}return[i("editor"),i("read_and_write"),i("comment_only"),i("reader")]}),[l,t]),p=d&&(0,S.jsx)(ft().ZP,{role:d.role,table:pt().e0,type:(0,oe().zU)(d)?"explicit_team_permission":"team_permission",upgradeButtonName:"team_permission_item",disabled:u,buttonStyle:{fontSize:12.5,marginRight:0,color:o.mediumTextColor},availableRoleItems:m,onChange:async e=>{const o=c.filter((t=>((0,oe().jg)(t)||(0,oe().hV)(t))&&(0,ie().xO)(e,t.role)));if(o.length>0){if(!(await(0,A().Bt)()))return}j().createAndCommit({userAction:"TeamMembersPermissionRow.permissionComponent",environment:n,canUndo:!0,perform:i=>{B().xI({environment:n,teamStore:t,newRole:e,transaction:i,permissionsToClear:o})}})}}),{teamName:g}=(0,a().VK)((()=>({teamName:t.getName()})),[t]),f=(0,S.jsx)(H().p,{disabled:!0,store:t,size:K().Kt});return(0,S.jsx)(Tt,{permissionRoleSelectComponent:p,iconComponent:f,name:qt(g)})}function qt(e){return e?(0,S.jsx)(s()._H,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessTeamSpaceName",values:{teamName:e}}):(0,S.jsx)(s()._H,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutTeamspaceName"})}var Yt=()=>n(989478),$t=()=>n(634015);function Jt(e){const{teamStore:t,teamOwnerIds:n}=e,o=(0,r().Fg)(),i=(0,a().VK)((()=>t.getName()),[t]),l=(0,a().VK)((()=>t.getTeamOwnerPermission()),[t]),d=(0,a().VK)((()=>h().default.state.currentUserStore),[]),c=(0,a().VK)((()=>d?n.map((e=>v().U6.createChildStore(d,{table:Yt().KJ,id:e}))):[]),[d,n]);return(0,S.jsx)(Tt,{tooltip:(0,S.jsx)(s()._H,{id:"TeamOwnersPermissionRow.teamspaceOwnersRowTooltip",defaultMessage:"Teamspace owners have full access to teamspace pages by default"}),permissionRoleSelectComponent:(0,S.jsx)(ft().ZP,{role:"editor",table:pt().e0,type:l&&(0,oe().LW)(l)?"explicit_team_owner_permission":"team_owner_permission",upgradeButtonName:"team_owner_permission_item",disabled:!0,buttonStyle:{fontSize:12.5,color:o.mediumTextColor,marginRight:0},availableRoleItems:[]}),iconComponent:(0,S.jsx)($t().n,{teamStore:t,ownerStores:c,isSmall:!0}),name:Qt(i)})}function Qt(e){return e?(0,S.jsx)(s()._H,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleName",values:{teamName:e}}):(0,S.jsx)(s()._H,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleNameWithoutTeamName"})}var Xt=()=>n(667067),en=()=>n(784234);function tn(e){const{teamStore:t}=e,n=(0,i().O7)(),o=(0,a().VK)((()=>h().default.state.currentSpaceStore),[]),{iconComponent:r,spaceName:s}=(0,a().VK)((()=>{if(!o)return{iconComponent:void 0,spaceName:void 0};const e=(0,E().rn)(n,o);return{iconComponent:(0,S.jsx)(H().p,{disabled:!0,store:o,size:K().Kt}),spaceName:e}}),[o,n]);return(0,S.jsx)(Tt,{permissionRoleSelectComponent:(0,S.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:(0,S.jsx)(on,{teamStore:t})}),iconComponent:r,name:nn(s)})}function nn(e){return e?(0,S.jsx)(s()._H,{defaultMessage:"Everyone else in {spaceName}",id:"TeamMembersTopSection.permissionItem.defaultAccessSpaceName",values:{spaceName:e}}):(0,S.jsx)(s()._H,{defaultMessage:"Everyone else in the workspace",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutSpaceName"})}function on(e){const{teamStore:t}=e,n=(0,i().O7)(),o=(0,r().Fg)(),d=(0,a().VK)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),c=V(t),u=(0,a().VK)((()=>{const e=t.getSettingsStore().getValue();if(e)return de({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t],{useDeepEqual:!0});if(!u)return null;const m=u.permissionItemRoleOptions.spacePermission;if(1===m.length&&"none"===m[0])return(0,S.jsx)(_().Z,{renderTooltip:()=>(0,S.jsx)(s()._H,{id:"teamPermissionsSettings.privateTeam.noAccessTooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>(0,S.jsxs)("div",{style:{display:"flex",alignItems:"center",maxWidth:170},...e,children:[(0,Xt().Q)({width:14,height:14,fill:o.timelineRed,marginRight:4}),(0,S.jsx)("div",{style:{fontSize:12.5,color:o.timelineRed,marginRight:8},children:(0,S.jsx)(s()._H,{id:"teamPermissionsSettings.privateTeam.noAccessLabel",defaultMessage:"No access • Invite only"})})]})});{const e=l().MR(m,(e=>-oe().xm[e])).map((e=>({role:e})));return(0,S.jsx)(ft().ZP,{role:d.role,table:pt().e0,type:"space_permission",upgradeButtonName:"space_permission_item",disabled:c||1===m.length,buttonStyle:{fontSize:12.5,marginRight:0,color:o.mediumTextColor},availableRoleItems:e,onChange:e=>{const o={...d,role:e};j().createAndCommit({userAction:"TeamSpacePermissionRow.permissionComponent",environment:n,canUndo:!0,perform:e=>{en().$G({environment:n,store:t,permissionItems:[o],transaction:e})}})}})}}function an(e){let{teamStore:t}=e;const n=(0,a().VK)((()=>t.isDefault()),[t]),o=(0,a().VK)((()=>t.getOwnerUserIds()),[t]),i=(0,a().VK)((()=>{const e=h().default.state.currentSpaceStore;if(!e)return!1;return!(null==e?void 0:e.getDisableTeamGuests())&&(!n&&(0,at().F$)())}),[n]),s=(0,r().yK)((()=>({container:{marginLeft:15,marginRight:7,paddingBottom:4,paddingTop:4}})),[]);return(0,S.jsxs)("div",{style:s.container,children:[(0,S.jsx)(Jt,{teamStore:t,teamOwnerIds:o},"0"),(0,S.jsx)(Gt,{teamStore:t},"1"),i&&(0,S.jsx)(Wt,{teamStore:t},"2"),!n&&(0,S.jsx)(tn,{teamStore:t},"3")]})}var rn=()=>n(53484);function sn(e){let{teamStore:t}=e;const n=(0,r().yK)((()=>({spacer:{width:"100%",height:20},heading:{marginBottom:10}})),[]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ln,{teamStore:t}),(0,S.jsx)("div",{style:n.spacer}),(0,S.jsx)(rn().z,{title:(0,S.jsx)(s()._H,{id:"TeamSettingsMembers.memberSettings.membersTitle",defaultMessage:"Members"}),style:n.heading}),(0,S.jsx)(Kt,{teamStore:t})]})}function ln(e){let{teamStore:t}=e;const n=(0,i().O7)(),l=(0,a().VK)((()=>t.getName()),[t]),d=(0,r().yK)((()=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},teamSettingsListItems:{padding:0,margin:0},accessButton:{border:"none"}})),[]),c=(0,o.useCallback)(((e,o)=>{B().Ju({environment:n,accessLevel:e,isDefault:o,store:t,teamName:l,from:"sidebar_team_modal"})}),[n,t,l]),u=(0,a().VK)((()=>t.getTeamAccessLevel()),[t]),m=[(0,S.jsx)(W()._,{teamStore:t,currentAccessLevel:u,onChange:c,style:d.accessButton},"visibility"),(0,S.jsx)(an,{teamStore:t},"permissions")];return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(K().Ph,{title:(0,S.jsx)(s()._H,{id:"TeamSettingsMembers.memberSettings.permissionsTitle",defaultMessage:"Permissions"}),rows:m,itemStyle:d.teamSettingsListItems}),(0,S.jsx)(F().Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_permissions",message:(0,S.jsx)(s()._H,{id:"teamSettingsPermissions.learnMore",defaultMessage:"Learn about teamspace permissions"}),containerStyle:d.learnMoreLinkContainer})]})}var dn=()=>n(983135),cn=()=>n(94967),un=()=>n(708518),mn=()=>n(384241),pn=()=>n(842574),gn=()=>n(239444),fn=()=>n(167830),hn=()=>n(539245),vn=()=>n(946563);function yn(e){return(0,S.jsx)(vn().Z,{...e,children:(0,S.jsx)(s()._H,{id:"sidebarTeamModalTab.unownedBadge",defaultMessage:"Unowned"})})}function bn(e){const{teamStore:t}=e,n=(0,a().VK)((()=>g().default.state.tab),[]);if(void 0===n)return null;switch(n){case g().a.General:return(0,S.jsx)(Ze,{teamStore:t});case g().a.Members:return(0,S.jsx)(sn,{teamStore:t});case g().a.Security:return(0,S.jsx)(je,{teamStore:t});default:(0,d().t1)(n)}}function xn(e){const{userId:t,currentSpaceStore:n}=e,{userStore:o,isDefined:i}=(0,a().VK)((()=>{const e=v().U6.createChildStore(n,{table:"notion_user",id:t,spaceId:n.id});return{userStore:e,isDefined:e.isDefined()}}),[n,t]);return i?(0,S.jsx)(gn().Z,{avatarShouldShowShadow:!0,userStore:o,style:{paddingRight:6,minHeight:34,lineHeight:1.2,fontSize:14,width:"100%"},avatarSize:24}):null}function Sn(e){const{userIds:t,label:n,hasMarginTop:o}=e,i=(0,a().VK)((()=>h().default.state.currentSpaceStore),[]);return i?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(fn().Z,{hasMarginTop:o,children:n}),t.map((e=>(0,S.jsx)(xn,{userId:e,currentSpaceStore:i},e)))]}):null}function Mn(){const e=(0,i().O7)(),t=(0,a().VK)((()=>h().default.state.currentSpaceStore),[]),n=(0,a().VK)((()=>h().default.state.currentSpaceViewStore),[]),o=(0,i().Fy)(),v=(0,r().yK)((e=>({modal:{width:o.isMobile?"auto":630,height:o.isMobile?"auto":640,maxWidth:"calc(100vw - 100px)",maxHeight:"calc(100vh - 100px)",borderRadius:5,overflow:"auto"},modalWrap:{userSelect:"none",WebkitUserSelect:"none",height:"100%"},innerWrap:{width:"100%",height:"100%",display:"flex",flexDirection:"column",paddingTop:20},header:{display:"flex",alignItems:"center",flexGrow:0,flexShrink:0,margin:"0px 36px"},tabBar:{display:"flex",width:void 0,flexGrow:0,flexShrink:0,margin:"0px 36px 20px"},scroller:{flexGrow:1},contentWrap:{margin:"0px 36px"},lockIcon:{width:16,marginLeft:6,marginBottom:1,fill:e.mediumIconColor},icon:{marginRight:8,fontWeight:c().Ue.medium},unownedPill:{marginLeft:6,height:17},unownedPillInner:{display:"flex",height:"100%",alignItems:"center",color:e.regularTextColor,fontWeight:c().Ue.regular,textTransform:"unset",fontSize:11}})),[o.isMobile]),{open:y,tab:M,teamStore:w}=(0,a().VK)((()=>{const{open:e,tab:t}=g().default.state;return{open:e,tab:t,teamStore:g().default.getTeamStore()}}),[]),C=(0,a().VK)((()=>null==w?void 0:w.getSettings()),[w]),j=(0,D().q)(w);if(!t||!n||!w)return null;const k=[g().a.General,g().a.Members,g().a.Security];return(0,S.jsx)(un().Z,{open:y,innerStyle:v.modal,onDismiss:()=>{g().default.reset()},render:()=>y?(0,S.jsx)("div",{className:m().rIj,style:{height:"100%"},children:(0,S.jsx)("div",{style:v.modalWrap,children:(0,S.jsx)(cn().Z,{debugName:"SidebarTeamModal",capture:!0,onBackspace:l().yR,onLeft:l().yR,onRight:l().yR,onSelectAll:l().yR,onRedo:l().yR,onUndo:l().yR,onCut:l().yR,onCopy:l().yR,onPaste:l().yR,onKeypress:l().yR,onDelete:l().yR,onTab:l().yR,children:(0,S.jsxs)("div",{style:v.innerWrap,children:[(0,S.jsxs)("div",{style:v.header,children:[(0,S.jsx)(H().p,{disabled:!0,store:w,size:24,style:v.icon}),(0,S.jsx)(mn().Z,{store:w,style:{fontSize:16,fontWeight:c().Ue.semibold}}),(0,p().C2)(C)&&(0,S.jsx)(x().Z,{iconStyle:v.lockIcon}),(0,p().Hu)({membership:w.getRawMembership()})&&(0,S.jsx)("div",{style:{gap:5,display:"flex"},children:(0,S.jsx)(yn,{desktopStyle:v.unownedPill,mobileStyle:v.unownedPill,innerStyle:v.unownedPillInner})}),(0,S.jsx)("div",{style:{flexGrow:1}}),(0,S.jsx)(b().M,{teamStore:w,onLeavingTeam:()=>g().default.reset(),from:"sidebar_team_modal",navigateToTeamHomeOnJoin:!1})]}),(0,S.jsx)(hn().ZP,{tabs:k.map((e=>function(e,t){switch(e){case g().a.General:return(0,S.jsx)(s()._H,{id:"sidebarTeamModalTab.option.general",defaultMessage:"General"});case g().a.Members:return(0,S.jsx)(wn,{teamStore:t});case g().a.Security:return(0,S.jsx)(s()._H,{id:"sidebarTeamModalTab.option.security",defaultMessage:"Security"});default:(0,d().t1)(e)}}(e,w))),selectedIndex:(0,d().$K)(M)?k.indexOf(M):1,onChange:t=>{y&&(u().rF(e,{store:w,tab_old_value:M??g().a.General,tab_new_value:k[t]}),g().default.update((e=>e.open?{...e,tab:k[t]}:e)))},tabStyle:{marginLeft:-8},style:v.tabBar,tabTitleStyle:{marginLeft:8,marginRight:8}}),(0,S.jsx)(pn().T,{type:f().Z.Y,style:v.scroller,children:(0,S.jsx)("div",{style:v.contentWrap,children:(0,S.jsx)(bn,{currentSpaceStore:t,teamStore:w,userIsTeamOwner:j})})})]})})})}):null})}function wn(e){let{teamStore:t}=e;const n=(0,dn().K)(t),o=(0,r().Fg)();return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(s()._H,{id:"sidebarTeamModalTab.option.members",defaultMessage:"Members"}),(0,S.jsx)("span",{children:" "}),(0,S.jsx)("div",{style:{color:o.lightTextColor},children:n})]})}function Cn(e){let{title:t,caption:n,secondCaption:o,on:a,disabled:s,tooltip:l,style:d,switcherStyle:c,onChange:u,shouldTriggerUpsell:m,upsellTier:p,isLocked:g,lockedTooltip:f}=e;const h=(0,i().O7)(),v=(0,r().yK)((()=>({root:{display:"flex",alignItems:"center",width:"100%",marginTop:0,marginBottom:0,cursor:m?"pointer":void 0,...d},title:{fontSize:14,marginRight:8,flexGrow:1},switcherWrap:{marginTop:5,marginRight:18,...c}})),[m,d,c]);return(0,S.jsxs)("div",{style:v.root,onClick:()=>{if(m)return y().y(h,{from:"team_security_settings",upsell:{type:"product",product:p,limit:{type:"none"}},dontOpenPlansOnCancel:!0})},children:[(0,S.jsxs)("div",{style:v.title,children:[t,n&&(0,S.jsx)(P().Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"95%"},children:n}),o&&(0,S.jsx)(P().Z,{isSmall:!0,children:o})]}),(0,S.jsx)("div",{style:v.switcherWrap,children:(0,S.jsx)(_().Z,{disableTooltip:!l,renderTooltip:()=>l,render:e=>(0,S.jsx)("div",{...e,children:(0,S.jsx)(ve().Z,{on:a,disabled:s,onClick:u,isLocked:g,lockedTooltip:f})})})})]})}},708232:(e,t,n)=>{n.d(t,{Z:()=>r});n(267602),n(653476),n(241792);var o=n(667294),i=n(785893);function a(){const[e,t]=(0,o.useReducer)(((e,t)=>{switch(t.type){case"push":return[...e.map((e=>({...e,isAnimatingOut:!0}))),{item:t.item,isAnimatingOut:!1}];case"delete":return e.filter((e=>e.item.key!==t.key));case"clear":return e.map((e=>({...e,isAnimatingOut:!0})));default:return e}}),[]);return(0,o.useEffect)((()=>{const e=new(n(435308).default)((()=>n(584989).ZP.state.currentItem),{debugName:"currentItemStore"});let o=null;function i(){const n=e.state;n&&o!==n.key?(t({type:"push",item:n}),o=n.key):n||t({type:"clear"})}return e.addListener(i),()=>{e.removeListener(i)}}),[]),(0,i.jsx)(n(748621).Z,{open:e.length>0,zIndex:201,children:e.map((e=>(0,o.createElement)(s,{...e,key:e.item.key,dispatch:t})))})}const r=o.memo(a),s=o.memo((function(e){let{dispatch:t,isAnimatingOut:a,item:r}=e;const s=(0,n(846550).Fg)(),l=(0,n(894787).k)(),d=(0,o.useCallback)((()=>{t({type:"delete",key:r.key})}),[t,r.key]),c=(0,o.useRef)(a);(0,o.useEffect)((()=>{if(!c.current&&a){const e=setTimeout(d,270);return()=>{d(),clearTimeout(e)}}c.current=a}),[a,d]);const u=r.position??"bottom",m="top"===u?{top:24}:{bottom:l};return(0,i.jsx)("div",{style:{...m,position:"fixed",left:0,width:"100%",display:"flex",zIndex:n(492522).E,padding:4,pointerEvents:"none"},children:(0,i.jsxs)("div",{"aria-live":"polite",style:{background:s.tooltipBackground,color:s.regularInvertedTextColor,borderRadius:8,padding:"11px 16px",boxShadow:s.shadowLG,margin:"0 auto",fontSize:14,display:"flex",alignItems:"center",pointerEvents:"auto",...r.style,animationName:`snackbar-slide-in-${u}`,animationDuration:"270ms",animationTimingFunction:"ease",transitionProperty:"transform, opacity",transitionDuration:"270ms",transitionTimingFunction:"ease",transform:a?"scale(0.95)":"scale(1)",opacity:a?0:1},onTransitionEnd:a?d:void 0,children:[r.label,r.helpUrl&&(0,i.jsx)(n(729775).Z,{href:r.helpUrl,external:!0,style:{marginLeft:8,width:16,height:16,color:s.regularInvertedTextColor},children:(0,n(456681).m)({fill:s.mediumInvertedTextColor})}),(0,i.jsx)("div",{style:{marginLeft:4,marginRight:-4},children:r.right})]})})}))},251228:(e,t,n)=>{n.d(t,{G:()=>v});var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(926724),s=()=>n(331540),l=()=>n(998411),d=()=>n(801812),c=()=>n(605974),u=()=>n(788860),m=()=>n(824462),p=()=>n(125659),g=()=>n(793396),f=n(785893);const h=(0,u().vU)({cannotSetSprintToCurrentTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToCurrentTooltip",defaultMessage:"Current sprint already exists"},cannotSetSprintToNextTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToNextTooltip",defaultMessage:"Next sprint already exists"},cannotSetSprintToLastTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToLastTooltip",defaultMessage:"Last sprint already exists"}});function v(e){const{blockPropertyValueOverlayStore:t}=e,n=(0,i().O7)(),v=(0,p().Y$)(),y=(0,a().Kw)(v.normalizedSchemaStore),b=function(e){let{sprintCollectionStore:t,environment:n,normalizedBlockSchema:o}=e;const[{value:i,status:a}]=(0,d().r5)((async()=>{var e;if(!t)return;const i=t.getSchema(),a=t.getFormat().app_config_uri;if(!a||a!==s().p$)return;const d=(0,c().Zv)(i,a).includes("last"),u=c().qB[a],p=u.current.reducer.get(o),g=u.next.reducer.get(o),f=u.last.reducer.get(o);if(!p||!g)return;const h={userId:n.currentUser.id,userTimeZone:(0,l().r)(),searchQuery:void 0,reducers:{[r().SF]:p,[r().YE]:g,...d&&f?{[r().Rw]:f}:{}},currentPageInRelatedCollection:void 0},v=null===(e=t.getParentBlockStore())||void 0===e?void 0:e.getCollectionViewStores()[0],y=t.getSpaceId();if(!v)return;const b=await m().callApi({eventName:"queryCollection",environment:n,data:{source:{type:"collection",id:t.id,spaceId:y},collectionView:{id:v.id,spaceId:y},loader:h},tracking:{src:"sprint_status_overlay_check"}});if("success"!==b.type)return;const x=b.data.result.reducerResults[r().SF],S=b.data.result.reducerResults[r().YE];if("results"!==x.type||"results"!==S.type)return;const M=x.blockIds.length>0,w=S.blockIds.length>0;if(!d)return{hasCurrentSprint:M,hasNextSprint:w,hasLastSprint:!1};const C=b.data.result.reducerResults[r().Rw];if("results"!==C.type)return;return{hasCurrentSprint:M,hasNextSprint:w,hasLastSprint:C.blockIds.length>0}}),[n,o,t]);if("resolved"!==a||!i)return;return i}({sprintCollectionStore:(0,a().VK)((()=>{const e=t.state;if(e.isOpen)return e.store.getAssociatedCollectionStore()}),[t]),environment:n,normalizedBlockSchema:y}),x=(0,u().YB)(),S=(0,o.useCallback)((e=>void 0===b&&[r().YE,r().SF,r().Rw].includes(e)?{disabled:!0}:e===r().YE&&null!=b&&b.hasNextSprint?{disabled:!0,disableReasonMessage:x.formatMessage(h.cannotSetSprintToNextTooltip)}:e===r().SF&&null!=b&&b.hasCurrentSprint?{disabled:!0,disableReasonMessage:x.formatMessage(h.cannotSetSprintToCurrentTooltip)}:e===r().Rw&&null!=b&&b.hasLastSprint?{disabled:!0,disableReasonMessage:x.formatMessage(h.cannotSetSprintToLastTooltip)}:{disabled:!1}),[b,x]);return(0,f.jsx)(g().x,{...e,shouldDisableOption:S})}},793396:(e,t,n)=>{n.d(t,{x:()=>Z});n(267602),n(653476),n(470928),n(241792);var o=n.n(n(443261)),i=n(667294),a=()=>n(219727),r=()=>n(142735),s=()=>n(846550),l=()=>n(532850),d=()=>n(38883),c=()=>n(199264),u=()=>n(788860),m=()=>n(513670),p=()=>n(696459),g=()=>n(139224),f=()=>n(552009),h=()=>n(589024),v=()=>n(514),y=()=>n(352230),b=()=>n(164079),x=()=>n(998901),S=()=>n(709917),M=()=>n(827973),w=()=>n(198829),C=()=>n(255577),j=()=>n(470386),k=()=>n(388284),T=()=>n(654133),I=()=>n(246471),_=()=>n(122671),P=n(785893);function Z(e){var t;const{propertySchema:n,blockPropertyValueOverlayStore:Z,onChange:A}=e,{device:R}=(0,a().O7)(),[B,L]=i.useState(e.initialValue??""),[D,V]=i.useState(""),O=(0,s().Fg)(),U=(0,u().YB)(),N=(0,r().VK)((()=>{const e=Z.state;if(e.isOpen)return e.collectionContextStore}),[Z]),F=(0,r().VK)((()=>(null==N?void 0:N.permissionScopesStore.state.canConfigureCollection)&&"collectionPage"!==(null==N?void 0:N.contextType)),[N]),H=(0,r().VK)((()=>{const e=Z.state;return!!e.isOpen&&(0,h().aJ)({store:e.store,additionalStores:e.additionalStores,collectionContextStore:e.collectionContextStore})}),[Z]),K=H?[]:n.options??[],E=(0,l().i7)(K,B),W=n.groups??[],z=E&&W.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(E.id)})),G=E?[(0,P.jsx)(I().F,{value:E.value,color:E.color,groupColor:null==z?void 0:z.color,isSingle:!1,format:R.isMobile?d().lo.Large:d().lo.Medium,onClickRemove:()=>{L(""),A(void 0,void 0)},showRemoveButton:void 0===n.defaultOption,shouldShrink:!0,showEllipsis:!0,tooltipPlacement:x().Placement.Left,hideTooltip:!(null===(t=E.description)||void 0===t||!t.length)},"status")]:[],q=H?null:(0,P.jsx)(_().ZP,{focus:!R.isMobile||void 0,focusAfterAnimation:!0,format:_().UR.Select,tokens:G,placeholder:U.formatMessage({id:"database.selectPropertyEditMenu.searchStatusPlaceholder",defaultMessage:"Search for an option"}),onRemoveLastToken:m().ZT,value:D,disabled:e.disabled,hideInput:e.disabled,onChange:e=>{V(e.target.value)},dontShowBorderBottom:R.isAndroid});let Y;if(Y=R.isMobile?{menuType:y().o.Modal,title:n.name,right:(0,P.jsx)(j().DoneMenuText,{}),onClickRight:e.onDismiss,header:q}:{menuType:y().o.Popup,header:q,tokenInputHeader:!0},e.disabled)return(0,P.jsx)(w().Z,{...Y});let $=K;if(""!==D){const e=o().filter(D,K.map((e=>e.value))).map((e=>e.original));$=K.filter((t=>e.includes(t.value)))}const J=W.map((e=>{const t=$.filter((t=>{var n;return null===(n=e.optionIds)||void 0===n?void 0:n.includes(t.id)}));if(0!==t.length)return{group:e,groupOptions:t}})).filter(p().$K),Q=J.length>1,X=H?[{items:W.map((t=>({key:t.name,render:e=>(0,P.jsx)(M().Z,{...e,disabledFeedback:!0,focused:e.focused,title:(0,P.jsx)(S().r_,{style:{fontWeight:500,marginTop:2},group:t,showIcon:!0,showColor:!0})}),action:()=>{e.onChange(void 0,t.name)}}))),key:"all-groups",render:e=>(0,P.jsx)(k().Z,{...e})}]:J.map(((t,n)=>{let{group:o,groupOptions:i}=t;return{items:i.map((t=>{const n=e.shouldDisableOption?e.shouldDisableOption(t.id):{disabled:!1};return{key:t.value,render:e=>{var i;return(0,P.jsx)(T().Z,{disableTooltip:n.disabled&&!(null!==(i=t.description)&&void 0!==i&&i.length),placement:x().Placement.Left,renderTooltip:e=>n.disabled?n.disableReasonMessage:(0,P.jsxs)("div",{...e,style:v().F6,children:[(0,P.jsx)("div",{children:t.value}),(0,P.jsx)("div",{style:{color:O.mediumInvertedTextColor},children:t.description})]}),render:i=>{var a;return(0,P.jsx)(M().Z,{...(0,b().Z)(i,e),disabled:n.disabled,disabledFeedback:!0,focused:e.focused,title:(0,P.jsx)(I().F,{...i,value:t.value,color:t.color,hideTooltip:!(null===(a=t.description)||void 0===a||!a.length),tooltipPlacement:x().Placement.Left,groupColor:o.color,showRemoveButton:!1,isSingle:!0,format:R.isMobile?d().lo.Large:d().lo.Medium}),isTokenTitle:!0})}})},action:()=>{e.onChange(t.value,void 0)}}})),key:`group-${n}`,render:e=>(0,P.jsx)(k().Z,{...e,topBorder:e.index>0,title:Q&&(0,P.jsx)(S().r_,{group:o,showColor:!1,style:{fontSize:12}})})}})),ee=N&&F?{items:[{key:"edit property",render:e=>(0,P.jsx)(M().Z,{...e,title:(0,P.jsx)(u()._H,{defaultMessage:"Edit property",id:"database.tableHeaderCell.editProperty"}),icon:(0,c().W)({width:14})}),action:()=>{const t=N.settingsStore;N.collectionStore()&&(e.onDismiss(),(0,f().n)({collectionContextStore:N}),g().r$({collectionContextStore:N,collectionSettingsStore:t}),g().H4({collectionSettingsStore:t,item:{type:"property",formatKey:N.getPropertyFormatKey(),property:e.property}}))}}],key:"edit-property",render:e=>(0,P.jsx)(k().Z,{...e,topBorder:e.index>0})}:void 0;return(0,P.jsx)(w().Z,{...Y,children:(0,P.jsx)(C().ZP,{type:C().iW.Vertical,initialFocus:D.length>0?0:void 0,sections:m().oA([...X,ee]),onAccept:(t,n,o)=>{e.onAccept(o)}})})}},995744:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});n(267602),n(258429);var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(846550),s=()=>n(456681),l=()=>n(836273),d=()=>n(788860),c=()=>n(568017),u=()=>n(707513),m=()=>n(824462),p=()=>n(718959),g=()=>n(838266),f=()=>n(737244),h=()=>n(291198),v=()=>n(906651),y=()=>n(765513),b=n(785893);const x={padding:"24px 36px 24px",minWidth:300,maxWidth:400},S=n(263184).default.createClass(void 0,{name:"PromoErrorStore"});const M=function(){const e=(0,a().VK)((()=>f().Z.state.open),[]);return(0,b.jsx)(n(708518).Z,{open:e,innerStyle:x,preventHideChildrenWhileOpening:!0,render:()=>(0,b.jsx)(I,{}),onDismiss:C})};function w(){const e=(0,r().Fg)();return(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",color:e.lightTextColor,borderTop:`1px solid ${e.regularDividerColor}`,paddingTop:14},children:[(0,s().m)({width:14,marginTop:1,marginRight:6,fill:e.lightIconColor})," ",(0,b.jsx)("div",{children:(0,b.jsx)(d()._H,{defaultMessage:"Have questions about this? <inlinelink>More info & FAQs</inlinelink>.",id:"studentNotEligibleModal.contactUsSection.message",values:{inlinelink:e=>(0,b.jsx)(y().Z,{href:"https://www.notion.so/Notion-for-students-teachers-adc631df15ee4ab9a7a33dd50f4c16fe",external:!0,children:e})}})})]})}function C(){f().Z.setState({open:!1})}function j(){C(),g().default.setState({open:!0,openedFrom:"student_not_eligible_modal",currentTab:"profile",defaultSubtab:void 0,highlightedSetting:void 0})}function k(){const e=(0,r().Fg)(),t=(0,i().O7)(),n=(0,a().VK)((()=>(0,p().B7)(t)),[t]),o=(0,a().VK)((()=>null==n?void 0:n.getEmail()),[n]);return(0,b.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,b.jsx)("div",{style:{width:18,flexShrink:0,color:e.mediumTextColor},children:(0,b.jsx)(d()._H,{defaultMessage:"1.",id:"studentNotEligibleModal.numberedList.firstItem"})}),(0,b.jsxs)("div",{style:{flexGrow:1},children:[(0,b.jsx)("div",{style:{color:e.mediumTextColor},children:(0,b.jsx)(d()._H,{defaultMessage:"Your current email is:",id:"studentNotEligibleModal.numberedList.changeEmailItem.message"})}),(0,b.jsx)("div",{style:{fontWeight:u().Ue.medium,marginTop:0},children:o}),(0,b.jsx)("div",{style:{color:e.mediumTextColor,marginTop:4},children:(0,b.jsx)(d()._H,{defaultMessage:"Thousands of university, college, and post-secondary school domains are already eligible, not just .edu emails!",id:"studentNotEligibleModal.numberedList.changeEmailItem.message2"})}),(0,b.jsx)(v().Z,{style:{marginTop:12},onClick:j,isLarge:!0,children:(0,b.jsx)(d()._H,{defaultMessage:"Change email",id:"studentNotEligibleModal.numberedList.changeEmailItem.button.label"})})]})]})}function T(){const e=(0,d().YB)(),t=(0,r().Fg)(),n=(0,i().O7)(),s=(0,a().qz)(void 0,S),[l,u]=(0,o.useState)(""),p=(0,o.useCallback)((()=>async function(e,t,n,o){if(n){const i=await m().callApi({eventName:"getPromoCode",environment:e,data:{code:n}});"failed"!==i.type&&i.data.promo?f().Z.state.open&&(await f().Z.state.handlePromoCode(n),C()):o.setState(t.formatMessage({defaultMessage:"Promo code {code} does not exist",id:"studentNotEligibleModal.numberedList.item2.promocode.errorMessage"},{code:n}))}}(n,e,l,s)),[n,e,l,s]),g=(0,o.useCallback)((e=>function(e,t,n){t(e.target.value.toUpperCase()),n.setState(void 0)}(e,u,s)),[u,s]),y=(0,a().Kw)(s),x=e.formatMessage({defaultMessage:"Enter code…",id:"studentNotEligibleModal.numberedList.item2.promocodePlaceholder"});return(0,b.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,b.jsx)("div",{style:{width:18,flexShrink:0,color:t.mediumTextColor},children:(0,b.jsx)(d()._H,{defaultMessage:"2.",id:"studentNotEligibleModal.numberedList.secondItem"})}),(0,b.jsxs)("div",{style:{flexGrow:1},children:[(0,b.jsx)("div",{style:{color:t.mediumTextColor},children:(0,b.jsx)(d()._H,{defaultMessage:"Have a student promo code?",id:"studentNotEligibleModal.numberedList.promoCodeItem.message"})}),(0,b.jsxs)("div",{style:{display:"flex",marginTop:12},children:[(0,b.jsx)(h().Z,{style:{marginRight:8,height:32},value:l,onChange:g,onSubmit:p,placeholder:x}),(0,b.jsx)(v().Z,{onClick:p,disabled:!l,isLarge:!0,children:(0,b.jsx)(d()._H,{defaultMessage:"Submit",id:"studentNotEligibleModal.numberedList.promoCodeItem.submitButton"})})]}),(0,b.jsx)("div",{style:{color:c().ZP.red,fontSize:12,marginTop:4,marginLeft:8,height:20},children:y})]})]})}function I(){return(0,b.jsxs)("div",{style:{fontSize:14},children:[(0,b.jsx)("div",{children:(0,b.jsx)(d()._H,{defaultMessage:"<p>Unfortunately you are not eligible for a free Education plan if you use this email address.</p><p>K-12 students, K-12 educators, and personal email addresses such as Gmail and Outlook are not eligible to receive the <pricinglink>Education Plan</pricinglink> for free, but anyone is welcome to use the <pricinglink>Free Plan</pricinglink> for free with unlimited storage.</p>",id:"studentNotEligibleModal.header",values:{br:(0,b.jsx)("br",{}),p:e=>(0,b.jsx)("p",{style:{marginTop:0,marginBottom:8},children:1===e.length?e[0]:o.Children.toArray(e)}),pricinglink:e=>(0,b.jsx)(y().Z,{external:!0,href:l().AR.pricing,children:e})}})}),(0,b.jsx)(k,{}),(0,b.jsx)(T,{}),(0,b.jsx)(w,{})]})}},69255:(e,t,n)=>{n.d(t,{HB:()=>d,K0:()=>m,b6:()=>h,dQ:()=>c,pd:()=>p,re:()=>u,ss:()=>f});n(670560),n(267602),n(241792),n(731107);var o=()=>n(788860),i=()=>n(279830),a=()=>n(269299),r=()=>n(527278),s=()=>n(821227),l=()=>n(838266);const d=(0,o().vU)({emptyWithIcon:{defaultMessage:"Empty page with icon",id:"templatePickerHelpers.basicTemplateItems.emptyWithIcon"},empty:{defaultMessage:"Empty page",id:"templatePickerHelpers.basicTemplateItems.empty"},templates:{defaultMessage:"Templates",id:"templatePickerHelpers.basicTemplateItems.templates"},import:{defaultMessage:"Import",id:"templatePickerHelpers.basicTemplateItems.import"}}),c={name:r().Z.formatMessage(d.empty),iconFn:n(169352).a,type:"empty_page",shouldShow:()=>!0,onClick:(e,t)=>{a().createAndCommit({userAction:"templatePickerHelpers.emptyTemplateItems",environment:e,canUndo:!0,perform:n=>{i().e({environment:e,store:t,transaction:n})}})}},u={name:r().Z.formatMessage(d.templates),type:"templates",iconFn:e=>(0,n(66782).i)(e),shouldShow:()=>!0,onClick:e=>{(0,s().C)({environment:e})}},m={name:r().Z.formatMessage(d.templates),type:"templates",iconFn:e=>(0,n(749166).w)(e),shouldShow:()=>!0,onClick:e=>{(0,s().C)({environment:e})}},p={name:r().Z.formatMessage(d.import),type:"import",iconFn:n(1723).l,shouldShow:()=>!0,onClick:(e,t)=>{const o=n(956057).Il();n(623521).Z.setState({flowId:o}),n(286310).Sy(e,{from:"new_page",flowId:o}),l().default.setState({...l().default.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0})}},g=(0,o().vU)({pageWithIcon:{defaultMessage:"Page with icon",id:"templatePickerHelpers.mobileBasicTemplateItems.pageWithIcon"},emptyPage:{defaultMessage:"Empty page",id:"templatePickerHelpers.mobileBasicTemplateItems.emptyPage"}}),f=[{name:r().Z.formatMessage(g.pageWithIcon),type:"page_with_icon",shouldShow:()=>!0,onClick:(e,t)=>{a().createAndCommit({userAction:"templatePickerHelpers.mobileBasicTemplateItems",environment:e,canUndo:!0,perform:n=>{i().T({environment:e,store:t,transaction:n})}})}},{name:r().Z.formatMessage(g.emptyPage),type:"empty_page",shouldShow:()=>!0,onClick:(e,t)=>{a().createAndCommit({userAction:"templatePickerHelpers.mobileBasicTemplateItems",environment:e,canUndo:!0,perform:n=>{i().e({environment:e,store:t,transaction:n})}})}}];function h(e,t){const n=new Map(e.map((e=>[e.type,e])));return t.reduce(((e,t)=>(n.has(t)&&e.push(n.get(t)),e)),[])}},710999:(e,t,n)=>{n.d(t,{Z:()=>y});var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(846550),s=n(785893);const l=(0,n(827282).IU)("repeatDisabled",{viewBox:"0 0 16 14",svg:(0,s.jsxs)("svg",{children:[(0,s.jsx)("path",{d:"M1.11621 8.32422C0.888346 8.32422 0.69694 8.24674 0.541992 8.0918C0.391602 7.93685 0.316406 7.74772 0.316406 7.52441V6.77246C0.316406 6.08431 0.469076 5.49186 0.774414 4.99512C1.08431 4.49837 1.51953 4.11784 2.08008 3.85352C2.64518 3.58464 3.31283 3.4502 4.08301 3.4502H9.23047V1.95312C9.23047 1.76628 9.28288 1.62272 9.3877 1.52246C9.49251 1.41764 9.63607 1.36523 9.81836 1.36523C9.90495 1.36523 9.9847 1.37891 10.0576 1.40625C10.1305 1.43359 10.1966 1.47233 10.2559 1.52246L13.0107 3.83301C13.1566 3.9515 13.2272 4.09277 13.2227 4.25684C13.2227 4.4209 13.152 4.56217 13.0107 4.68066L10.2559 6.99121C10.1966 7.03678 10.1305 7.07552 10.0576 7.10742C9.9847 7.13477 9.90495 7.14844 9.81836 7.14844C9.63607 7.14844 9.49251 7.09603 9.3877 6.99121C9.28288 6.88639 9.23047 6.74284 9.23047 6.56055V5.00195H3.98047C3.34245 5.00195 2.83659 5.17741 2.46289 5.52832C2.09375 5.87923 1.90918 6.35319 1.90918 6.9502V7.52441C1.90918 7.74772 1.83171 7.93685 1.67676 8.0918C1.52181 8.24674 1.33496 8.32422 1.11621 8.32422ZM14.8906 7.54492C15.1094 7.54492 15.2962 7.6224 15.4512 7.77734C15.6061 7.92773 15.6836 8.11686 15.6836 8.34473V9.09668C15.6836 9.78483 15.5286 10.3773 15.2188 10.874C14.9134 11.3708 14.4782 11.7536 13.9131 12.0225C13.348 12.2868 12.6803 12.4189 11.9102 12.4189H6.7627V13.9229C6.7627 14.1051 6.71029 14.2464 6.60547 14.3467C6.50521 14.4515 6.36393 14.5039 6.18164 14.5039C6.09505 14.5039 6.01302 14.4902 5.93555 14.4629C5.86263 14.4355 5.79655 14.3968 5.7373 14.3467L2.98242 12.0361C2.84115 11.9222 2.77051 11.7832 2.77051 11.6191C2.77051 11.4505 2.84115 11.307 2.98242 11.1885L5.7373 8.87793C5.79655 8.8278 5.86263 8.78906 5.93555 8.76172C6.01302 8.73438 6.09505 8.7207 6.18164 8.7207C6.36393 8.7207 6.50521 8.77311 6.60547 8.87793C6.71029 8.97819 6.7627 9.12174 6.7627 9.30859V10.8604H12.0127C12.6553 10.8604 13.1611 10.6872 13.5303 10.3408C13.904 9.98991 14.0908 9.51595 14.0908 8.91895V8.34473C14.0908 8.11686 14.166 7.92773 14.3164 7.77734C14.4714 7.6224 14.6628 7.54492 14.8906 7.54492Z",fill:"#C7C6C4"}),(0,s.jsx)("path",{d:"M4 2L12 14",stroke:"white",strokeWidth:"3",strokeLinecap:"round"}),(0,s.jsx)("path",{d:"M4 2L12 14",stroke:"#C7C6C4",strokeLinecap:"round"})]})});var d=()=>n(788860),c=()=>n(707513),u=()=>n(348141),m=()=>n(876822);function p(){const[e,t]=(0,o.useState)(!1),r=(0,i().O7)(),s=(0,a().VK)((()=>m().default.state.currentUserSettingsStore),[]);return[(0,a().VK)((()=>{const t=n(749826).default.checkGate({gateName:"dictation_new_page_nux"}),o=null==s?void 0:s.getSettings(),i=Boolean(null==o?void 0:o.dismissed_dictation_new_page_nux);return t&&!i&&!e}),[s,e]),(0,o.useCallback)((()=>{s&&(t(!0),u().B1({environment:r,userSettingsStore:s,dismissed:!0}))}),[r,s,t])]}(0,n(947115).exposeDebugValue)("resetDictationTooltip",(e=>{const t=m().default.state.currentUserSettingsStore;t&&u().B1({environment:e,userSettingsStore:t,dismissed:!1})}));var g=()=>n(998901),f=()=>n(944993),h=()=>n(827973),v=()=>n(78078);const y=(0,o.forwardRef)((function(e,t){const{format:n,className:o,icon:i,title:a,isDefault:r,recurrence:l,recurrenceDisabled:d,right:c,focused:u,onClick:m,onMouseMove:p,onMouseEnter:g,onMouseLeave:f,locked:h,type:v}=e;return"collection-overlay"===n?(0,s.jsx)(x,{ref:t,className:o,icon:i,format:n,title:a,isDefault:r,recurrence:l,recurrenceDisabled:d,right:c,focused:u,onClick:m,onMouseMove:p,onMouseEnter:g,onMouseLeave:f,locked:h,type:v}):"phone-modal"===n?(0,s.jsx)(S,{ref:t,icon:i,format:n,title:a,isDefault:r,recurrence:l,focused:u,onClick:m}):"horizontal-new-page"===n?"dictation"===v?(0,s.jsx)(T,{ref:t,focused:u,onClick:m,onMouseMove:p,onMouseEnter:g,onMouseLeave:f,icon:i,title:a,type:v}):(0,s.jsx)(j,{ref:t,focused:u,onClick:m,onMouseMove:p,onMouseEnter:g,onMouseLeave:f,icon:i,title:a,type:v}):"horizontal-new-page-submenu"===n?(0,s.jsx)(k,{ref:t,focused:u,onClick:m,onMouseMove:p,onMouseEnter:g,onMouseLeave:f,icon:i,title:a}):(0,s.jsx)(w,{ref:t,focused:u,onClick:m,onMouseMove:p,onMouseEnter:g,onMouseLeave:f,icon:i,format:n,title:a,isDefault:r,recurrence:l,recurrenceDisabled:d,right:c})}));function b(e){let{format:t,title:o,isDefault:i,recurrenceDisabled:a}=e;const u=(0,r().Fg)();return"collection-overlay"!==t?(0,s.jsx)(s.Fragment,{children:o}):(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o,(0,s.jsxs)("span",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i&&(0,s.jsx)("span",{style:{fontSize:12,fontWeight:c().Ue.medium,color:u.mediumTextColor},children:(0,s.jsx)(d()._H,{defaultMessage:"DEFAULT",id:"database.templatePickerMenuItem.default"})}),a&&l({width:14,height:12.25,color:n(568017).ZP.lightIconColor,marginLeft:8})]})]})}const x=(0,o.forwardRef)((function(e,t){let{className:n,icon:o,format:a,title:r,isDefault:l,recurrence:d,recurrenceDisabled:c,right:u,focused:m,onClick:p,onMouseMove:g,onMouseEnter:f,onMouseLeave:v,locked:y,type:x}=e;const S=(0,i().O7)(),{device:M}=S;return(0,s.jsx)(h().Z,{ref:t,className:n,icon:o,title:(0,s.jsx)(b,{format:a,title:r,isDefault:l,recurrence:d,recurrenceDisabled:c}),right:u,focused:m,onClick:p,onMouseMove:g,onMouseEnter:f,onMouseLeave:v,showDragHandle:!M.isMobile&&!y,dragHandleDisabled:"empty_page"===x})})),S=(0,o.forwardRef)((function(e,t){let{icon:n,format:o,title:i,isDefault:a,recurrence:r,focused:l,onClick:d}=e;return(0,s.jsx)(h().Z,{ref:t,icon:n?(0,s.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24},children:n}):null,title:(0,s.jsx)(b,{format:o,title:i,isDefault:a,recurrence:r}),focused:l,onClick:d,showDragHandle:!1})}));function M(e,t,o){const{device:i}=e;return{...n(494488).ZD,display:"flex",alignItems:"center",flexGrow:1,height:i.isMobile?36:32,fontSize:16,borderRadius:4,paddingLeft:8,marginBottom:2,color:o?t.mediumTextColor:t.lightTextColor}}const w=(0,o.forwardRef)((function(e,t){let{focused:o,onClick:l,onMouseMove:d,onMouseEnter:c,onMouseLeave:u,icon:m,format:p,title:g,isDefault:f,recurrence:h,recurrenceDisabled:v,right:y}=e;const x=(0,r().Fg)(),S=(0,i().O7)(),w=(0,n(657320).l)(),C=(0,a().VK)((()=>{const e=null==w?void 0:w.publicEditModeStore.state;return(0,n(982855).GD)(e)}),[w]);return(0,s.jsxs)(n(154186).Z,{style:M(S,x,C),hovered:o,onClick:l,onMouseMove:d,onMouseEnter:c,onMouseLeave:u,hoveredStyle:{background:x.buttonHoveredBackground,color:x.regularTextColor},pressedStyle:{background:x.buttonPressedBackground},children:[(0,s.jsx)("div",{style:{display:"flex",alignItems:"center",width:24,height:24,marginRight:10},children:m}),(0,s.jsx)(b,{format:p,title:g,isDefault:f,recurrence:h,recurrenceDisabled:v}),y&&(0,s.jsx)("div",{style:{marginLeft:"auto",marginRight:4},children:y})]})})),C=(0,d().vU)({horizontalNewPageDictationItemTooltip:{id:"TemplatePickerMenuItem.dictationCallout.tooltip",defaultMessage:"Use your voice to write"},dictationCalloutHeader:{id:"TemplatePickerMenuItem.dictationCallout.Header",defaultMessage:"Use your voice to write with high-quality speech-to-text"}}),j=(0,o.forwardRef)((function(e,t){let{focused:n,onClick:o,onMouseMove:l,onMouseEnter:d,onMouseLeave:u,icon:m,title:p,type:g,tooltipEvents:f}=e;const h=(0,i().O7)(),y=(0,r().yK)((e=>({item:{display:"flex",alignItems:"center",padding:"6px 14px 6px 10px",background:e.assistantTintedActionButtonBackground,borderRadius:100,fontSize:13,fontWeight:c().Ue.medium},moreItem:{width:32,height:32,padding:0,justifyContent:"center"},itemFocused:{background:e.tint.regular},itemFilled:{borderColor:e.tint.regular,background:e.assistantTintedActionButtonBackground},itemFilledAndFocused:{background:e.tint.regular}})),[]),b=(0,a().VK)((()=>!h.device.isMobile&&("ai"===g||"dictation"===g)),[h.device.isMobile,g]);return(0,s.jsx)("div",{ref:t,onClick:o,onMouseMove:l,onMouseEnter:d,onMouseLeave:u,...f||{},style:{...y.item,..."more"===g?y.moreItem:{},...b?y.itemFilled:{},...n?y.itemFocused:{},...b&&n?y.itemFilledAndFocused:{}},children:(0,s.jsxs)(v().X2,{gap:4,alignItems:"center",children:[m,p]})})})),k=(0,o.forwardRef)((function(e,t){let{focused:n,onClick:o,onMouseMove:i,onMouseEnter:a,onMouseLeave:l,icon:d,title:c}=e;const u=(0,r().yK)((e=>({item:{display:"flex",alignItems:"center",padding:"4px 10px 4px 8px"},itemFocused:{background:e.tint.regular}})),[]);return(0,s.jsx)("div",{ref:t,onClick:o,onMouseMove:i,onMouseEnter:a,onMouseLeave:l,style:{...u.item,...n?u.itemFocused:{}},children:(0,s.jsxs)(v().X2,{gap:8,alignItems:"center",children:[d,c]})})})),T=(0,o.forwardRef)((function(e,t){const i=(0,o.useRef)(null),[a,l]=p(),c=(0,r().yK)((e=>({tooltipContainer:{display:"flex",flexDirection:"row",gap:"6px",padding:"0px 0",alignItems:"center",marginLeft:"-4px"},badge:{background:e.accentColors.translucentGray[300],color:e.mediumInvertedTextColor,marginLeft:0,width:"fit-content"}})),[]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n(577741).g,{shouldShow:a,calloutId:"dictation_new_page_origin_element_tooltip",children:(0,s.jsx)(n(905263).U,{style:{width:200},pointerLength:25,pointerPosition:"50%",origin:i,placementToOrigin:"top",alignmentToOrigin:g().Alignment.Center,header:(0,s.jsx)(f().Z,{style:c.badge}),content:(0,s.jsx)(d()._H,{...C.dictationCalloutHeader}),shouldDismissUponOutsideClick:!0,onCloseClick:l})}),(0,s.jsx)(n(654133).Z,{disableTooltip:a,renderTooltip:()=>(0,s.jsxs)("div",{style:c.tooltipContainer,children:[(0,s.jsx)(f().Z,{style:c.badge}),(0,s.jsx)(d()._H,{...C.horizontalNewPageDictationItemTooltip})]}),originGap:6,placement:g().Placement.Top,render:n=>(0,s.jsx)("div",{ref:i,children:(0,s.jsx)(j,{...e,ref:t,tooltipEvents:n})})})]})}))},255453:(e,t,n)=>{n.d(t,{W:()=>a,Z:()=>s});n(267602),n(749411);var o=n(667294),i=n(785893);const a={"en-US":"en","ja-JP":"ja","ko-KR":"ko","fr-FR":"fr","de-DE":"de","pt-BR":"pt-BR","es-ES":"es-ES"};function r(e){return e.src?(0,i.jsx)("img",{style:e.style,src:e.src}):null}const s=o.forwardRef((function(e,t){const a=(0,n(846550).Fg)(),s=o.useRef(e);s.current=e,o.useEffect((()=>{const t=document.createElement("script");t.src="https://player.vimeo.com/api/player.js",document.body.appendChild(t);const n=window.Vimeo;if(!n)return()=>{};const o=document.getElementById(e.src),i=new n.Player(o);return i?(i.on("play",(e=>{var t,n;null===(t=(n=s.current).onPlay)||void 0===t||t.call(n,e)})),i.on("pause",(e=>{var t,n;null===(t=(n=s.current).onPause)||void 0===t||t.call(n,e)})),i.on("ended",(e=>{var t,n;null===(t=(n=s.current).onEnd)||void 0===t||t.call(n,e)})),()=>{i.off("play"),i.off("pause"),i.off("ended")}):()=>{}}),[e.src,s.current.src]);const l=function(e,t){const o=(0,n(696459).qP)(t).flatMap((e=>{let[t,n]=e;return`${t}=${n}`})).join("&");return`${e}&${o}`}(s.current.src,{texttrack:s.current.defaultTextTrack,playsinline:!1,...s.current.options}),d={position:"absolute",top:0,left:0,width:"100%",height:"100%",borderStyle:"solid",borderColor:a.tableDividerColor,borderWidth:"0 0 1px 0"};return(0,i.jsxs)(n(728048).Z,{ratio:s.current.aspectRatioOverride??9/16,children:[(0,i.jsx)(r,{style:d,src:s.current.preloadThumbnailSrc}),(0,i.jsx)("iframe",{ref:t,id:s.current.src,className:s.current.className,allowFullScreen:!0,src:l,style:{...d,...s.current.style}})]})}))},189265:(e,t,n)=>{n.d(t,{Z:()=>l});n(667294);var o=()=>n(846550),i=()=>n(788860),a=()=>n(255577),r=()=>n(388284),s=n(785893);const l=function(e){const{importListItems:t}=e,l=(0,n(142735).qz)(void 0,n(692304).Z),d=(0,o().yK)((e=>({InviteDropdownMenu:{background:e.cardContentBackground,width:265,borderRadius:8},helpIcon:{width:14,height:14,fill:e.icon.secondary},helpSection:{color:e.text.secondary,fontSize:12,padding:"0 8px",width:"100%"}})),[]),c={key:"all_import_sections",render:e=>(0,s.jsx)(r().Z,{...e,title:(0,s.jsx)(i()._H,{id:"spacePermissionsSettings.inviteLinkRefreshModal.inviteDropdownMenu.title",defaultMessage:"Import from"})}),items:t},u={key:"help_section",render:e=>(0,s.jsx)(r().Z,{...e,topBorder:!0}),items:[{key:"help_section",render:e=>m,action:()=>{}}]},m=(0,s.jsx)(n(108714).Z,{style:{display:"flex",padding:"0 4px"},className:"notion-print-ignore",href:(0,n(148126).UY)("guides.publicAPI"),external:!0,children:(0,s.jsx)(n(265640).D,{icon:n(456681).m,iconStyle:d.helpIcon,style:d.helpSection,children:(0,s.jsx)(i()._H,{id:"spacePermissionsSettings.inviteLinkRefreshModal.inviteDropdownMenu.learnMore",defaultMessage:"Learn more"})})});return(0,s.jsx)(n(198829).Z,{menuType:n(352230).o.Popup,children:(0,s.jsx)(a().ZP,{type:a().iW.Vertical,store:l,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,sections:[c,u],style:d.InviteDropdownMenu})})}},264524:(e,t,n)=>{n.r(t),n.d(t,{TopbarMoreButton:()=>I});var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(846550),s=n(785893);const l=(0,n(827282).IU)("mobileQuickCaptureMore",{viewBox:"0 0 26 26",svg:(0,s.jsxs)("svg",{width:"26",height:"26",viewBox:"0 0 26 26",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M4.56552 14.857C5.59119 14.857 6.42266 14.0255 6.42266 12.9999C6.42266 11.9742 5.59119 11.1427 4.56552 11.1427C3.53985 11.1427 2.70837 11.9742 2.70837 12.9999C2.70837 14.0255 3.53985 14.857 4.56552 14.857Z"}),(0,s.jsx)("path",{d:"M20.2917 14.8571C21.3174 14.8571 22.1489 14.0257 22.1489 13C22.1489 11.9743 21.3174 11.1429 20.2917 11.1429C19.2661 11.1429 18.4346 11.9743 18.4346 13C18.4346 14.0257 19.2661 14.8571 20.2917 14.8571Z"}),(0,s.jsx)("path",{d:"M12.4283 14.8571C13.454 14.8571 14.2855 14.0257 14.2855 13C14.2855 11.9743 13.454 11.1429 12.4283 11.1429C11.4027 11.1429 10.5712 11.9743 10.5712 13C10.5712 14.0257 11.4027 14.8571 12.4283 14.8571Z"})]})});var d=()=>n(788860),c=()=>n(491927),u=()=>n(879952),m=()=>n(677559);const p=new(m().Ss)("topbarMoreMenu",(async()=>await Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(39938),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(94556),n.e(78701),n.e(38804),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(71641),n.e(23006),n.e(72646),n.e(10553),n.e(74879),n.e(67601),n.e(37239),n.e(40692),n.e(20683),n.e(22467),n.e(27039),n.e(97083),n.e(52065),n.e(18534),n.e(39179),n.e(77555),n.e(38632),n.e(78856),n.e(19592),n.e(47559),n.e(22371),n.e(73230),n.e(25911),n.e(54843),n.e(76540),n.e(22337),n.e(93536),n.e(53936),n.e(23721),n.e(32175),n.e(66283),n.e(22154),n.e(58586)]).then(n.bind(n,566139)))),g=(0,m().kF)(p,(e=>e.TopbarMoreMenu));var f=()=>n(465371),h=()=>n(466970),v=()=>n(880885),y=()=>n(876822),b=()=>n(570065),x=()=>n(825350),S=()=>n(577741),M=()=>n(905263);function w(e){const{originRef:t}=e,n=(0,r().yK)((e=>({aiTranslateIcon:{height:18,width:18,fill:e.text.uiBluePrimary}})),[]);return(0,s.jsx)(S().P,{calloutId:"ai_page_translation",children:(0,s.jsx)(M().U,{origin:t,placementToOrigin:"bottom",header:(0,s.jsxs)("div",{style:{display:"flex",fontSize:14,gap:12,paddingLeft:4,paddingRight:4},children:[(0,x().Q)(n.aiTranslateIcon),(0,s.jsx)(d()._H,{id:"aiPageTranslationTooltip.header",defaultMessage:"You can always find translation in the top right menu"})]}),content:null,onCloseClick:()=>{v().H.reset()},pointerPosition:"98%",pointerLength:24,pointerOffset:-3,style:{width:300},onPrimaryButtonClick:()=>{v().H.reset()},nextButtonContent:(0,s.jsx)(d()._H,{id:"aiPageTranslationTooltip.dismiss",defaultMessage:"Got it"})})})}var C=()=>n(448419),j=()=>n(542649);function k(e){let{originRef:t}=e;return(0,s.jsx)(S().P,{calloutId:"wiki_promo",children:(0,s.jsx)(M().U,{origin:t,placementToOrigin:"bottom",header:"Upgrade your existing wikis",content:"Look for the Turn into wiki action here",onCloseClick:()=>{b().E.reset()},pointerPosition:"98%",pointerLength:24,pointerOffset:-3,style:{width:j().G5}})})}var T=()=>n(265456);function I(e){let{buttonPopupStore:t,store:n,isLastButton:l,styling:d}=e;const m=(0,i().O7)(),{device:p}=m,[x,S]=(0,o.useState)(void 0),M=(0,o.useRef)(null),j=(0,o.useCallback)((()=>{b().E.reset(),v().H.reset(),u().ZH({environment:m});const e=M.current;e&&S(e.getBoundingClientRect()),c().kq(m)}),[M,m]),T=(0,a().VK)((()=>b().E.state.showConvertTooltip),[]),I=(0,a().Kw)(v().H),_=(0,r().yK)((e=>({mobilePopupStyle:{borderRadius:12,backgroundColor:e.surface.wash}})),[]),P=(0,h().E)("mobile_use_bottom_sheet_popup_container");return(0,s.jsxs)(s.Fragment,{children:[T?(0,s.jsx)(k,{originRef:M}):I?(0,s.jsx)(w,{originRef:M}):null,(0,s.jsx)(C().ZP,{popupType:p.isMobile?P?C().Z4.BottomSheet:C().Z4.SlideUp:C().Z4.Popup,buttonPopupStore:t,renderOrigin:e=>(0,s.jsx)(A,{ref:M,buttonPopupEvents:e,isLastButton:l,styling:d}),onClick:j,render:()=>(0,s.jsx)(g,{blockStore:n,onClickOriginRect:x,handleAccept:e=>function(e,t,n){const{mainEditorCurrentBlockStore:o}=y().default.state;if(o){const t=o.getType();var i;if(t)c().dh(n,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"topbar_more_menu",block_id:o.id,block_type:t,is_toggleable:(0,f()._A)(t,o.getFormat()),collection_id:null===(i=o.getCollectionViewSourceCollectionStore())||void 0===i?void 0:i.id,parent_collection_id:o.getParentCollectionIdUpToTwoLevels(),form_id:o.getFirstFormIdInCollectionViewBlock()})}e.closeParentMenu&&Z(t)}(e,t,m),handleDismiss:()=>Z(t)}),originGap:p.isElectronWindows?12:8,forceInitialInbound:!0,style:p.isMobile?_.mobilePopupStyle:{width:240,maxHeight:"80vh"}})]})}const _=(0,d().vU)({actions:{defaultMessage:"Actions",id:"topbar.actions"}});function P(e,t,o,i){const{device:a}=e;if(!a.isMobile){const{iconButton:{width:e,height:o}}=(0,n(596986).F_)(t);return{display:"flex",alignItems:"center",justifyContent:"center",width:e,height:o,borderRadius:6}}if("mobile_horizon1_quick_capture_circle_icons"===i)return(0,T().Tg)(t).iconContainer;{const e=(0,T().$d)(t).iconContainer;return o?{...e,marginRight:0}:e}}function Z(e){e.setState({...e.state,open:!1})}const A=o.forwardRef((function(e,t){let{buttonPopupEvents:o,isLastButton:a,styling:c}=e;const u=(0,r().Fg)(),m=(0,i().O7)(),{device:p}=m,g=(0,d().YB)(),f=(0,T().Kh)(u);return(0,s.jsx)(n(654133).Z,{renderTooltip:()=>m.currentUser.isLoggedIn()?(0,s.jsx)(d()._H,{defaultMessage:"Style, export, and more…",id:"topbarMoreButton.tooltip"}):(0,s.jsx)(d()._H,{defaultMessage:"More…",id:"topbarMoreButton.loggedOut.tooltip"}),placement:n(998901).Placement.Bottom,originGap:p.isElectronWindows?10:void 0,delayThreshold:400,render:e=>(0,s.jsx)(n(154186).Z,{ref:t,style:P(m,u,a,c),mobileFeedback:p.isMobile,className:n(247724).mSZ,ariaLabel:g.formatMessage(_.actions),...(0,n(164079).Z)(o,e),children:p.isMobile?l("mobile_horizon1_quick_capture_circle_icons"===c?f[c].iconStyle:{height:26,width:26,fill:u.icon.primary}):(0,n(641772).o)({width:18,height:18,fill:u.regularIconColor})})})}))},566139:(e,t,n)=>{n.r(t),n.d(t,{TopbarMoreMenu:()=>cn});var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(846550),s=()=>n(899548),l=()=>n(788860),d=()=>n(707513),c=(n(821057),n(492176),n(7961),n(267602),n(470928),n(241792),n(228244),()=>n(146947)),u=()=>n(506347),m=()=>n(156642),p=()=>n(799891),g=()=>n(827282),f=n(785893);const h={viewBox:"0 0 20 20",svg:(0,f.jsx)("path",{d:"M5.393 6.022a.625.625 0 0 1 0 .884L2.924 9.375h5.662a.625.625 0 1 1 0 1.25H2.924l2.469 2.469a.625.625 0 0 1-.884.883L.974 10.442a.625.625 0 0 1 0-.884l3.535-3.536a.625.625 0 0 1 .884 0m6.026 3.353a.625.625 0 1 0 0 1.25h5.648l-2.469 2.469a.625.625 0 1 0 .884.883l3.535-3.535a.625.625 0 0 0 0-.884l-3.535-3.536a.625.625 0 0 0-.884.884l2.469 2.469z"})},v=(0,g().IU)("arrowExpandHorizontal",h);var y=()=>n(844409);const b={viewBox:"0 0 20 20",svg:(0,f.jsx)("path",{d:"M3.75 3.125c.345 0 .625.28.625.625v7.097l3.016-2.639a.625.625 0 0 1 .854.028l3.036 3.037 3.485-3.485H12.75a.625.625 0 1 1 0-1.25h3.5c.345 0 .625.28.625.625v3.5a.625.625 0 1 1-1.25 0V8.696l-3.902 3.902a.625.625 0 0 1-.884 0L7.774 9.534l-3.399 2.974v2.242c0 .483.392.875.875.875h11a.625.625 0 1 1 0 1.25h-11a2.125 2.125 0 0 1-2.125-2.125v-11c0-.345.28-.625.625-.625"})},x=(0,g().IU)("chartLineUptrend",b),S={viewBox:"0 0 20 20",svg:(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("path",{d:"M10.625 5.725a.625.625 0 1 0-1.25 0v3.65H6.4a.625.625 0 1 0 0 1.25H10c.345 0 .625-.28.625-.625z"}),(0,f.jsx)("path",{d:"M10 2.375a7.625 7.625 0 1 0 0 15.25 7.625 7.625 0 0 0 0-15.25M3.625 10a6.375 6.375 0 1 1 12.75 0 6.375 6.375 0 0 1-12.75 0"})]})},M=(0,g().IU)("clock",S);const w=(0,g().IU)("fontStyleMono",{viewBox:"0 0 16 16",svg:(0,f.jsx)("g",{children:(0,f.jsx)("path",{d:"M6.817 12 6.08 9.513H3.017L2.28 12H1.192l2.675-8.725h1.388L7.93 12zM4.605 4.388h-.113L3.267 8.6H5.83zm10.008 7.399q0 1.338-.75 2.1-.75.763-2.088.763-1.45 0-2.313-.888l.588-.687q.676.7 1.737.7 1.825 0 1.825-1.925v-1.075h-.05q-.625 1.2-1.987 1.2-1.175 0-1.85-.875-.675-.888-.675-2.412t.675-2.4q.675-.888 1.85-.888 1.361 0 1.988 1.2h.05V5.55h1zm-2.65-.7q.7 0 1.175-.35t.475-.974v-2.15q0-.626-.476-.975-.474-.35-1.175-.35-.862 0-1.35.525-.487.524-.487 1.412v.925q0 .888.488 1.412.487.526 1.35.526Z"})})}),C=(0,g().IU)("fontStyleSans",{viewBox:"0 0 16 16",svg:(0,f.jsx)("g",{children:(0,f.jsx)("path",{d:"m.76 12 3.248-8.807h.842v1.422h-.348L1.914 12H.761Zm1.472-2.52.341-.935h3.98l.342.934H2.232ZM7.188 12 4.6 4.615V3.193h.494L8.341 12zm4.557 2.32q-.793 0-1.385-.226a2.26 2.26 0 0 1-.947-.63 1.86 1.86 0 0 1-.433-.94l.012-.005h1.099l.006.006q.085.373.513.61.427.244 1.135.244.885 0 1.38-.402.5-.398.5-1.123v-1.331h-.098a2.24 2.24 0 0 1-1.22 1.007q-.39.128-.843.128-.848 0-1.47-.403a2.7 2.7 0 0 1-.953-1.123q-.336-.714-.336-1.635v-.013q0-.922.336-1.635.342-.72.964-1.13.623-.415 1.484-.415.464 0 .854.147t.69.415q.305.269.506.64h.074V5.42h1.062v6.488q0 .733-.36 1.276a2.27 2.27 0 0 1-1.014.836q-.66.3-1.556.3m-.049-3.602q.61 0 1.044-.28.44-.288.671-.788.238-.5.238-1.153v-.013q0-.653-.238-1.16a1.84 1.84 0 0 0-.671-.793q-.434-.287-1.044-.287t-1.037.287a1.83 1.83 0 0 0-.647.794 2.9 2.9 0 0 0-.22 1.16v.012q0 .653.22 1.153.225.5.646.787.428.282 1.038.281"})})}),j=(0,g().IU)("fontStyleSerif",{viewBox:"0 0 16 16",svg:(0,f.jsx)("g",{children:(0,f.jsx)("path",{d:"M.29 12v-.416l.753-.299 3.16-7.982.441-.065.455-.13 2.99 8.177.884.286V12h-3.34v-.429l1.104-.299-.793-2.275H2.772l-.754 2.119 1.248.455V12zm4.08-7.462L3.058 8.217h2.613L4.384 4.538h-.013Zm10.764 2.106-1.482-.078-.013.039c.325.273.663.754.663 1.443 0 1.417-1.287 2.327-2.587 2.327q-.488 0-.936-.156c-.3.234-.455.455-.455.65 0 .182.182.429.48.442l2.458.143c1.287.078 1.859.65 1.859 1.456 0 1.079-1.391 2.405-3.81 2.405-1.234 0-2.352-.52-2.352-1.469 0-.481.325-1.027.949-1.365l.312-.169v-.026l-.923-.884c.26-.663.546-.988 1.027-1.391C9.726 9.647 9.297 9.01 9.297 8.1c0-1.417 1.105-2.379 2.496-2.379.598 0 1.014.143 1.534.325l1.807-.195zM11.87 9.816c.689 0 1.248-.611 1.248-1.599 0-1.391-.624-1.989-1.404-1.989-.767 0-1.222.572-1.222 1.56 0 1.274.533 2.028 1.378 2.028m1.274 2.691-2.457-.156c-.195.208-.56.689-.56 1.157 0 .481.43 1.157 1.795 1.157 1.599 0 2.262-.767 2.262-1.365 0-.455-.3-.741-1.04-.793"})})});var k=()=>n(968061),T=()=>n(429617),I=()=>n(47100);const _={viewBox:"0 0 20 20",svg:(0,f.jsx)("path",{d:"M7.3 1.995a.55.55 0 1 0 0 1.1h5.4a.55.55 0 0 0 0-1.1zm-2.35 2.8a.55.55 0 0 1 .55-.55h9a.55.55 0 0 1 0 1.1h-9a.55.55 0 0 1-.55-.55m-1.987 3.75c0-1.173.951-2.125 2.125-2.125h9.825c1.174 0 2.125.952 2.125 2.125v6.45a2.125 2.125 0 0 1-2.125 2.125H5.088a2.125 2.125 0 0 1-2.125-2.125zm2.125-.875a.875.875 0 0 0-.875.875v6.45c0 .483.392.875.875.875h9.825a.875.875 0 0 0 .875-.875v-6.45a.875.875 0 0 0-.875-.875z"})},P=(0,g().IU)("stack",_),Z={viewBox:"0 0 20 20",svg:(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("g",{clipPath:"url(#clip0_9208_17166)",children:(0,f.jsx)("path",{d:"M8.125 14.9c0-.345.28-.625.625-.625h10.1a.625.625 0 1 1 0 1.25H8.75a.625.625 0 0 1-.625-.625M7 9.525a.625.625 0 0 0 0 1.25h10.1a.625.625 0 1 0 0-1.25zm-1.75-4.75a.625.625 0 0 0 0 1.25h10.1a.625.625 0 1 0 0-1.25zM2.9 9.525a.625.625 0 0 0 0 1.25h1.5a.625.625 0 1 0 0-1.25zM.525 5.4c0-.345.28-.625.625-.625h1.5a.625.625 0 0 1 0 1.25h-1.5A.625.625 0 0 1 .525 5.4m4.125 8.875a.625.625 0 1 0 0 1.25h1.5a.625.625 0 1 0 0-1.25z"})}),(0,f.jsx)("defs",{children:(0,f.jsx)("clipPath",{id:"clip0_9208_17166",children:(0,f.jsx)("path",{d:"M20 0v20H0V0z"})})})]})},A=(0,g().IU)("tableOfContents",Z),R={viewBox:"0 0 20 20",svg:(0,f.jsx)("path",{d:"m8.965 12.538 1.125 3.077a.625.625 0 1 0 1.174-.43L7.526 4.961a.987.987 0 0 0-1.854 0L1.934 15.185a.625.625 0 1 0 1.174.43l1.125-3.078zm-.457-1.25H4.69l1.909-5.223zm7.334 4.554a.625.625 0 0 1-.884 0l-2.475-2.475a.625.625 0 0 1 .884-.884l1.408 1.408V4.994a.625.625 0 1 1 1.25 0v8.897l1.408-1.408a.625.625 0 1 1 .884.884z"})},B=(0,g().IU)("textSmall",R),L=(0,g().IU)("textStyleIcon",{viewBox:"0 0 16 16",svg:(0,f.jsx)("g",{children:(0,f.jsx)("path",{d:"M.74 13.097c-.355 0-.574-.212-.574-.554 0-.116.02-.226.075-.37l3.206-8.55q.226-.625.862-.623c.437 0 .717.212.875.629l3.206 8.538a1 1 0 0 1 .075.37c0 .34-.233.56-.595.56-.355 0-.533-.137-.663-.52l-.882-2.413H2.292l-.882 2.413c-.13.383-.307.52-.67.52m1.887-3.972h3.356l-1.66-4.6h-.035zm9.604 4.02c-1.449 0-2.454-.875-2.454-2.181 0-1.272.964-2.071 2.694-2.167l2.208-.123v-.588c0-.957-.636-1.552-1.702-1.552-.89 0-1.47.37-1.853 1.162-.103.192-.267.274-.479.274-.293 0-.519-.199-.519-.5 0-.143.055-.307.13-.478.39-.882 1.463-1.449 2.748-1.449 1.736 0 2.83.964 2.83 2.454v4.56c0 .369-.232.594-.56.594-.322 0-.554-.225-.554-.567v-.902h-.028c-.423.888-1.408 1.463-2.46 1.463Zm.28-.95c1.204 0 2.168-.855 2.168-1.942v-.725l-2.065.13c-1.073.069-1.654.554-1.654 1.279 0 .752.629 1.257 1.552 1.257Z"})})});var D=()=>n(269309),V=()=>n(496205),O=()=>n(568017),U=()=>n(513670),N=()=>n(244540),F=()=>n(421654),H=()=>n(518370),K=()=>n(332542),E=()=>n(636340),W=()=>n(47443),z=()=>n(497065),G=()=>n(269299),q=()=>n(887430),Y=()=>n(855238),$=()=>n(989377),J=()=>n(388284),Q=()=>n(164079),X=()=>n(998901),ee=()=>n(154186),te=()=>n(654133),ne=()=>n(67961);function oe(e,t){return e.isFiltering?function(e){return(0,f.jsx)(Y().Z,{...e,title:e.caption,caption:void 0})}(e):function(e,t){let{id:n,caption:o,focused:a,isActive:s,onClick:l,onMouseDown:d,onMouseEnter:c,onMouseLeave:u,role:m,style:p,tooltip:g,ignoreLocalHoverState:h,disallowTabbing:v}=e;const y=(0,i().Fy)(),b=(0,r().yK)((()=>({optionItem:{display:"flex",flexDirection:"column",alignItems:"center",minWidth:34,justifyContent:"flex-end"},button:{width:"100%",...y.isMobile?{padding:16,paddingTop:20,transition:"color 300ms, border 300ms",lineHeight:1}:{padding:6,paddingTop:10,borderRadius:4,transition:"color 300ms, border 300ms",lineHeight:1},justifyContent:"center",color:s?O().ZP.blue:"inherit"}})),[s,y]);return(0,f.jsx)(te().Z,{renderTooltip:()=>g,placement:X().Placement.Bottom,delayThreshold:80,render:e=>{const i=(0,Q().Z)(e,{onMouseEnter:c,onMouseLeave:u}),{onMouseDown:r,...s}=i;return(0,f.jsx)(ee().Z,{...s,id:n,role:m,ref:t,mobileFeedback:y.isMobile,onClick:l,onMouseDown:i.onMouseDown||d,hovered:a,style:b.button,ignoreLocalHoverState:h,disallowTabbing:v,className:"notranslate",children:(0,f.jsxs)("div",{style:b.optionItem,children:[(0,f.jsx)("div",{style:{...p,height:25},children:"Ag"}),(0,f.jsx)(ne().Z,{isSmall:!0,style:{marginTop:4},children:o})]})})}})}(e,t)}const ie=o.forwardRef(oe);const ae=function(e){const{children:t}=e,n=(0,i().O7)(),{mobileStyle:o,desktopStyle:a}=(0,r().yK)((e=>({mobileStyle:{display:"flex",justifyContent:"space-around",boxShadow:`0 1px 0 ${e.regularDividerColor}`,background:e.popoverBackground},desktopStyle:{display:"flex",justifyContent:"space-between",marginLeft:14,marginRight:14}})),[]);return(0,f.jsx)(J().Z,{...e,children:(0,f.jsx)("div",{style:n.device.isMobile?o:a,children:t})})};var re=()=>n(251932),se=()=>n(501274),le=()=>n(696459),de=()=>n(90065);function ce(e){const{intl:t,blockStore:n}=e,o=(0,de().T7)(n);if("none"!==o.type){if("expired"===o.type)return t.formatMessage(ue.expiredVerification);if("verified"===o.type){if(o.isIndefinite)return t.formatMessage(ue.indefiniteVerification);{const e=o.dateTimeRange.end,n=(0,se().mb)({dateTime:e,intl:t,shortenDateAndRange:!0});return t.formatMessage(ue.verificationWithEndDate,{date:n})}}(0,le().t1)(o)}}const ue=(0,l().vU)({expiredVerification:{defaultMessage:"Expired",id:"verificationHelpers.mobileAction.subtitle.expiredVerification"},indefiniteVerification:{defaultMessage:"No expiration",id:"verificationHelpers.mobileAction.subtitle.indefiniteVerification"},verificationWithEndDate:{defaultMessage:"Until {date}",id:"verificationHelpers.mobileAction.subtitle.datedVerification"}});var me=()=>n(61882);const pe={viewBox:"0 0 20 20",svg:(0,f.jsx)("path",{d:"M13.9 4.649c.344 0 .624.28.624.625v1.475H18.1a.625.625 0 1 1 0 1.25h-3.576v.871c1.603.108 2.658.635 3.319 1.368.73.812.882 1.772.882 2.388 0 .58-.236 1.13-.479 1.548a5 5 0 0 1-.754.994.625.625 0 0 1-.884-.884c.14-.14.368-.412.558-.738.195-.335.309-.66.309-.92 0-.396-.091-.94-.447-1.412l-.028.12a7.8 7.8 0 0 1-.573 1.571c-.573 1.146-1.66 2.446-3.578 2.446-.98 0-1.755-.416-2.252-1.065-.486-.634-.681-1.454-.602-2.247a3.44 3.44 0 0 1 1.104-2.206c.548-.498 1.278-.839 2.175-.947V8H10.75a.625.625 0 0 1 0-1.25h2.525V5.274c0-.345.28-.625.625-.625m-.626 5.5c-.587.096-1.023.326-1.334.609-.418.38-.65.89-.701 1.405-.052.52.081 1.012.35 1.362.257.336.664.576 1.26.576q.23 0 .438-.036a.6.6 0 0 1-.013-.126zm1.25 3.292c.323-.302.58-.684.785-1.095a6.5 6.5 0 0 0 .572-1.75l.019-.116.004-.028v-.005l.128.017c-.381-.165-.873-.29-1.508-.34zM8.462 14.94l-.933-2.552H3.64l-.933 2.553a.625.625 0 0 1-1.174-.43l3.176-8.686a.933.933 0 0 1 1.751 0l3.176 8.687a.625.625 0 0 1-1.174.429M5.584 7.07l-1.487 4.068h2.975z"})},ge=(0,g().IU)("textTranslate",pe);var fe=()=>n(313351),he=()=>n(676922),ve=()=>n(358122),ye=()=>n(234478),be=()=>n(352230),xe=()=>n(524434),Se=()=>n(804217),Me=()=>n(279386),we=()=>n(944993),Ce=()=>n(198829),je=()=>n(470386),ke=()=>n(868744),Te=()=>n(902569);function Ie(e){const{blockStore:t,menuListItemProps:n,title:s,onFocus:d,closeParentMenu:c,shouldRenderMobileRefresh:u}=e,m=(0,i().O7)(),p=(0,r().Fg)(),g=(0,a().VK)((()=>xe().KR.isFullPageTranslateEnabled()),[]),h=(0,ye().w)({pageStore:t,enabled:g}),v=(0,ve().J)(),[y,b]=(0,o.useState)(void 0),x=y??h??v,{isTranslating:S,editorModeConfigTranslateState:M}=(0,a().VK)((()=>{const e=Me().MT.getTranslateModeForBlock(t.id);return e?{isTranslating:!0,editorModeConfigTranslateState:e}:{isTranslating:!1,editorModeConfigTranslateState:{mode:"translate_unlocked",status:"pre_activation",sourceLanguage:x}}}),[t,x]),w=(0,a().VK)((()=>!Se().default.state.online),[]),C=(0,o.useCallback)((e=>{const{sourceLanguage:t}=e;b(t)}),[]),j=(0,o.useCallback)((e=>{const{targetLanguage:n}=e;he().V8({pageStore:t,environment:m}),he().LI({pageStore:t,targetLanguage:n,sourceLanguage:x,environment:m,triggeredFrom:"action_menu"}),c()}),[t,x,m,c]),k=(0,a().VK)((()=>(0,fe().Sy)(p,S)),[S,p]);return"pre_activation"!==M.status||w?(0,f.jsx)(Y().Z,{...n,title:s,badge:(0,f.jsx)(we().Z,{}),svg:ge,right:k,onClick:()=>{he().lR({pageStore:t,environment:m,triggeredFrom:"action_menu"}),c()},disabled:w,disabledFeedback:w,tooltipText:w?(0,f.jsx)(l()._H,{...fe().RE.unavailableOfflineTooltip}):void 0}):(0,f.jsx)(ke().Z,{...n,disableDefaultClick:!0,onFocus:d,focused:n.focused,disableCloseOnEnter:!0,renderExtension:(e,n)=>{const o=m.device.isMobile?{menuType:be().o.Modal,right:u?void 0:(0,f.jsx)(je().DoneMenuText,{}),onClickRight:u?void 0:n.close,onClickLeft:n.close,shouldRenderMobileRefresh:u,isExtensionMenu:u,paddingTop:u?10:void 0,title:s,...e}:{menuType:be().o.Popup,...e};return(0,f.jsx)(Ce().Z,{...o,onClick:e=>{e.stopPropagation()},children:(0,f.jsx)(Te().I,{onSelectTargetLanguage:j,onSelectSourceLanguage:C,editorModeConfigTranslateState:M,sourceLanguage:x,detectedPageLanguage:h,preferredLanguage:v,shouldRenderMobileRefresh:u,subMenuPlacement:X().Placement.Left,pageId:t.id})})},renderOrigin:(e,t)=>(0,f.jsx)(Y().Z,{...e,ref:t,title:s,badge:(0,f.jsx)(we().Z,{}),svg:ge,right:k})})}var _e=()=>n(214924),Pe=()=>n(364052),Ze=()=>n(29904),Ae=()=>n(283848),Re=()=>n(396136),Be=()=>n(145284),Le=()=>n(205228),De=()=>n(872308),Ve=()=>n(234049),Oe=()=>n(594546),Ue=()=>n(527278),Ne=()=>n(314169),Fe=()=>n(333023),He=()=>n(998470),Ke=()=>n(876822),Ee=()=>n(749826),We=()=>n(785738),ze=()=>n(102182),Ge=()=>n(369637);const qe="template_translation_toast",Ye="Template size too large";async function $e(e){const{environment:t,pageStore:n,targetLanguage:o,sourceLanguage:i}=e,{currentSpaceStore:a}=Ke().default.state;if(!Ee().default.checkGate({gateName:"translate_template_top_bar"}))throw new Error("Translate template is not enabled");if(!o||!i||null==a||!a.id)return;const r=Ue().Z.getIntl(),s=await(0,Ve().LL)(t,n.id),l=null==s?void 0:s.name,d=performance.now();!function(e){const{intl:t,toastProps:n={},isMobile:o=!1}=e;if(o)return void ze().oV({label:t.formatMessage({id:"inApp.template.translation.started.toast.mobile.message",defaultMessage:"Template is being translated. We will let you know when it's ready to use."}),position:"bottom",style:{maxWidth:"calc(100% - 40px)",justifyContent:"center",textAlign:"center"}});Ge().m2({id:qe,title:t.formatMessage({id:"inApp.template.translation.started.toast.title",defaultMessage:"Template is being translated"}),message:t.formatMessage({id:"inApp.template.translation.started.toast.message",defaultMessage:"We will let you know when it's ready to access"}),presentationType:"transient",icon:Ze().r,...n})}({intl:r});const c=We().h.getStateForBlock(n.id),m=await new Promise((e=>{G().createAndCommit({userAction:"translateTemplateActions.translateTemplateBlock",environment:t,canUndo:!0,perform:s=>{const d=n.getParentStore();if(!d)throw new Error("Cannot duplicate with no parent store found");const m=s.getUserActionForAnalyticsPurposesOnly();p().log({level:"info",from:"translateTemplateActions",type:"translateTemplateBlockStart",data:{miscDataToConvertToString:{pageStoreId:n.id,spaceId:n.getSpaceId(),parentStoreId:n.getParentId(),targetLanguage:o,sourceLanguage:i}}}),(0,Oe().j)({environment:t,event:{eventName:"translate_template_block",eventProperties:{duplicate_to:"parent",page_id:n.id,source_language:i,target_language:o,triggered_from:"topbar_more_action"}}}),We().h.setStateForBlock(n.id,{...c,mode:"translate",status:"loading",sourceLanguage:i,targetLanguage:o});const[g,f]=De().duplicateBlock({environment:t,stores:[n],addCopyName:!1,transaction:s,deepCopyTransclusionContainers:!0,targetSpaceId:null==a?void 0:a.id,resolveTemplateVariables:!n.isInsideTemplate(),baseUrl:Le().default.domainBaseUrl,publicDomainName:Le().default.publicDomainName,preferDuplicateLocation:"server",shouldTranslate:!0,targetLanguage:o,sourceLanguage:i}),h=g[0];return"block"===d.table?K().jG({parentStore:d,childStore:h,transaction:s,after:n.id}):"space"===d.table&&Ke().default.state.currentSpaceViewStore&&Be().Hj({environment:t,spaceStore:a,spaceViewStore:Ke().default.state.currentSpaceViewStore,pageStore:h,isPrivate:!0,location:{type:"append",after:n.id},transaction:s}),f.then((a=>{var s,d;"error"===a.status?(Je({intl:r,templateName:l,blockLimitError:null===(s=a.error)||void 0===s?void 0:s.message.includes(Ye)}),We().h.clearStateForBlock(n.id),p().log({level:"error",from:"translateTemplateActions",type:"translateTemplateBlockError",data:{miscDataToConvertToString:{pageStoreId:n.id,spaceId:n.getSpaceId(),parentStoreId:n.getParentId(),targetLanguage:o,sourceLanguage:i,errorMessage:null===(d=a.error)||void 0===d?void 0:d.message}}}),e({success:!1,userAction:m})):(!function(e){const{sourceLanguage:t,targetLanguage:n,intl:o,environment:i,blockStores:a,toastProps:r={},isMobile:s=!1,templateName:l}=e,d=(0,Ae().E)(t),c=(0,Ae().E)(n);if(s)return ze().rN(),void ze().d8({blockToOpenStore:a[0],onOpenBlock:()=>{W()._c({environment:i,store:a[0],pageVisitSource:u().tY.Duplicate})},item:{label:o.formatMessage({id:"inApp.template.translation.finished.toast.mobile.message",defaultMessage:"Template is ready"}),position:"bottom",style:{maxWidth:"calc(100% - 40px)",justifyContent:"center",textAlign:"center"}}});Ge().m2({id:qe,title:o.formatMessage({id:"inApp.template.translation.finished.toast.title",defaultMessage:"Template is ready"}),message:d&&c&&l?o.formatMessage({id:"inApp.template.translation.finished.toast.templateName.message",defaultMessage:"''{templateName}'' has been translated from {sourceLanguage} to {targetLanguage}. View your template to continue editing."},{sourceLanguage:d,targetLanguage:c,templateName:l}):o.formatMessage({id:"inApp.template.translation.finished.toast.message",defaultMessage:"Template has been added to your workspace"}),presentationType:"persistent",iconGroup:Pe().F,iconGroupColorName:"greenPrimary",iconGroupVariant:"default",actions:{primary:{title:o.formatMessage({id:"inApp.template.translation.finished.toast.seeTemplate.button",defaultMessage:"See template"}),onAction:()=>{W()._c({environment:i,store:a[0],pageVisitSource:u().tY.Duplicate}),Ge().Xd(qe)}}},...r})}({environment:t,blockStores:g,sourceLanguage:i,targetLanguage:o,intl:r,templateName:l}),We().h.clearStateForBlock(n.id),p().log({level:"info",from:"translateTemplateActions",type:"translateTemplateBlockSuccess",data:{miscDataToConvertToString:{pageStoreId:n.id,spaceId:n.getSpaceId(),parentStoreId:n.getParentId(),targetLanguage:o,sourceLanguage:i}}}),e({success:!0,duplicateStore:h,userAction:m}))})).catch((t=>{Je({intl:r,templateName:l}),We().h.clearStateForBlock(n.id),p().log({level:"error",from:"translateTemplateActions",type:"translateTemplateBlockError",data:{miscDataToConvertToString:{pageStoreId:n.id,spaceId:n.getSpaceId(),parentStoreId:n.getParentId(),targetLanguage:o,sourceLanguage:i,error:t}}}),e({success:!1,userAction:m})})),{duplicateStore:h,onComplete:f}}})}));if(m.success&&m.duplicateStore){var g;Qe({environment:t,success:!0,time:performance.now()-d,user_action:m.userAction,page_block_id:m.duplicateStore.id,source_language:i,target_language:o});const e=Fe().mk({store:m.duplicateStore,environment:t}).mostPermissivePublicItem,{permissionItem:n,from:a}=e,r=a.table===Re().iU?a.blockId:a.teamId,s=!(null===(g=Ke().default.state.currentSpaceStore)||void 0===g?void 0:g.getDisableMoveToSpace())&&n.allow_duplicate;He().Fo({environment:t,type:"site",store:m.duplicateStore}),await(0,Ne().iK)({oldPermissionItem:n,newPermissionItem:{...n,role:"reader",allow_duplicate:s},wasInherited:r!==m.duplicateStore.id,environment:t,store:m.duplicateStore,sudoModeStore:void 0})}else!1===m.success&&Qe({environment:t,success:!1,time:performance.now()-d,user_action:m.userAction})}function Je(e){const{intl:t,toastProps:n={},isMobile:o=!1,templateName:i,blockLimitError:a}=e;o?ze().oV({label:t.formatMessage({id:"inApp.template.translation.error.toast.mobile.message",defaultMessage:"Template translation failed. Please try again."}),position:"bottom",style:{maxWidth:"calc(100% - 40px)",justifyContent:"center",textAlign:"center"}}):Ge().m2({id:qe,title:t.formatMessage({id:"inApp.template.translation.error.toast.title",defaultMessage:"Template translation failed"}),message:i?a?t.formatMessage({id:"inApp.template.translation.blockLimitError.toast.templateName.message",defaultMessage:"Unable to translate ''{templateName}'' – template size exceeds limit"},{templateName:i}):t.formatMessage({id:"inApp.template.translation.error.toast.templateName.message",defaultMessage:"Unable to translate ''{templateName}''. Please try again."},{templateName:i}):t.formatMessage({id:"inApp.template.translation.error.toast.message",defaultMessage:"Please try again."}),presentationType:"transient",icon:Ze().r,...n})}function Qe(e){(0,Oe().j)({environment:e.environment,event:{eventName:"translate_template_duration",eventProperties:{time:e.time,success:e.success,user_action:e.user_action,total_blocks:e.total_blocks,page_block_id:e.page_block_id,source_language:e.source_language,target_language:e.target_language}}})}var Xe=()=>n(466970);function et(e){const{blockStore:t,menuListItemProps:n,title:r,onFocus:s,closeParentMenu:l,shouldRenderMobileRefresh:d}=e,c=(0,i().O7)(),u=(0,Xe().E)("translate_template_top_bar"),m=(0,ye().w)({pageStore:t,enabled:u}),p=(0,ve().J)(),[g,h]=(0,o.useState)(void 0),v=g??m??p,{translateState:y}=(0,a().VK)((()=>{const e=We().h.getStateForBlock(t.id);return"translate"===(null==e?void 0:e.mode)?{isTranslating:!0,translateState:e}:{isTranslating:!1,translateState:{mode:"translate",status:"pre_activation",sourceLanguage:v}}}),[t,v]),b=(0,o.useCallback)((e=>{const{sourceLanguage:t}=e;h(t)}),[]),x=(0,o.useCallback)((async e=>{const{targetLanguage:n}=e;await $e({pageStore:t,targetLanguage:n,sourceLanguage:v,environment:c}),l()}),[t,v,c,l]);return(0,f.jsx)(ke().Z,{...n,disableDefaultClick:!0,onFocus:s,focused:n.focused,disableCloseOnEnter:!0,renderExtension:(e,n)=>{const o=c.device.isMobile?{menuType:be().o.Modal,right:d?void 0:(0,f.jsx)(je().DoneMenuText,{}),onClickRight:d?void 0:n.close,onClickLeft:n.close,shouldRenderMobileRefresh:d,isExtensionMenu:d,paddingTop:d?10:void 0,title:r,...e}:{menuType:be().o.Popup,...e};return(0,f.jsx)(Ce().Z,{...o,onClick:e=>{e.stopPropagation()},children:(0,f.jsx)(Te().I,{onSelectTargetLanguage:x,onSelectSourceLanguage:b,editorModeConfigTranslateState:y,sourceLanguage:v,detectedPageLanguage:m,preferredLanguage:p,shouldRenderMobileRefresh:d,subMenuPlacement:X().Placement.Left,pageId:t.id})})},renderOrigin:(e,t)=>(0,f.jsx)(Y().Z,{...e,ref:t,title:r,badge:void 0,svg:_e().W})})}var tt=()=>n(421797),nt=()=>n(656573),ot=()=>n(429725),it=()=>n(326264),at=()=>n(793935),rt=()=>n(590972),st=()=>n(838266),lt=()=>n(374469);const dt=(0,l().vU)({aiCoEditingName:{id:"action.aiCoEditing.name",defaultMessage:"AI Co-editing"}}),ct=(0,fe().N$)({key:"ai_co_editing",displayName:dt.aiCoEditingName,label:Ue().Z.formatMessage(dt.aiCoEditingName),svg:I().t,isEnabled:e=>"ai_co_editing"===Me().MT.getMode(e),validators:[tt().ffD(tt().YGm),tt().J5S,tt().ffD(tt().uY7),tt().ffD(tt().p1d),()=>xe().KR.isAiEnabled(),tt().QLY("ai_co_editing")],action:(e,t,n)=>{const o="ai_co_editing"===Me().MT.getMode(t)?"default":"ai_co_editing";N().t_({environment:e,navigableBlockStore:t,mode:o,location:"page_more_actions"})}});var ut,mt,pt=()=>n(20919),gt=()=>n(478558),ft=()=>n(717538),ht=()=>n(58991),vt=()=>n(609967),yt=()=>n(929626),bt=()=>n(116926),xt=()=>n(222670),St=()=>n(523709);const Mt=(0,l().vU)({customizePageLabel:{id:"action.customizePage.label",defaultMessage:"Customize page"},exportName:{id:"action.export.name",defaultMessage:"Export"},exportCaption:{id:"action.export.caption",defaultMessage:"PDF, HTML, Markdown & CSV"},fontDefaultName:{id:"action.setPageFont.default.fuzzySearchKeywords",defaultMessage:"Font Default"},fontDefaultCaption:{id:"action.setPageFont.default.caption",defaultMessage:"Default"},fontDefaultTooltip:{id:"action.setPageFont.default.tooltip",defaultMessage:"The default sans-serif workhorse"},fontSerifName:{id:"action.setPageFont.serif.fuzzySearchKeywords",defaultMessage:"Font Serif"},fontSerifCaption:{id:"action.setPageFont.serif.caption",defaultMessage:"Serif"},fontSerifTooltip:{id:"action.setPageFont.serif.tooltip",defaultMessage:"Good for publishing"},fontMonoName:{id:"action.setPageFont.mono.fuzzySearchKeywords",defaultMessage:"Font Mono"},fontMonoCaption:{id:"action.setPageFont.mono.caption",defaultMessage:"Mono"},fontMonoTooltip:{id:"action.setPageFont.mono.tooltip",defaultMessage:"Good for drafting and notes"},fontComicName:{id:"action.setPageFont.comic.fuzzySearchKeywords",defaultMessage:"Font Comic"},fontComicCaption:{id:"action.setPageFont.comic.caption",defaultMessage:"Comic"},fontComicTooltip:{id:"action.setPageFont.comic.tooltip",defaultMessage:"Playful but cringe"},fontSmallTextKeywords:{id:"action.fontSmallText.fuzzySearchKeywords",defaultMessage:"Font Small Text"},fontSmallTextLabel:{id:"action.fontSmallText.label",defaultMessage:"Small text"},fontStyleSection:{id:"action.section.fontStyle",defaultMessage:"Style"},fullWidthLabel:{id:"action.fullWidth.label",defaultMessage:"Full width"},getNotifiedFor:{defaultMessage:"Get notified",id:"topbar.moreButton.getNotified"},importName:{id:"action.import.name",defaultMessage:"Import"},lockPageName:{id:"action.lockPage.name",defaultMessage:"Lock page"},floatingTableOfContents:{id:"action.floatingTableOfContents.name",defaultMessage:"Table of contents"},notifyMe:{id:"action.notifyMe.name",defaultMessage:"Notify me"},pageVerification:{id:"action.pageVerification.name",defaultMessage:"Page verification"},openAIAssistant:{id:"action.openMobileAIAssistant.name",defaultMessage:"Open AI Assistant"},openinMacAppName:{id:"action.openinMacApp.name",defaultMessage:"Open in Mac app"},openinWindowsAppName:{id:"action.openinWindowsApp.name",defaultMessage:"Open in Windows app"},openiniOSAppName:{id:"action.openiniOSApp.name",defaultMessage:"Open in iOS app"},openinAndroidAppName:{id:"action.openinAndroidApp.name",defaultMessage:"Open in Android app"},pageAnalyticsName:{id:"action.pageAnalytics.name",defaultMessage:"Page analytics"},pageHistoryName:{id:"action.pageHistory.name",defaultMessage:"View edit history"},pageHistoryNewName:{id:"action.pageHistoryNew.name",defaultMessage:"Version history"},pageUpdates:{id:"action.pageUpdates.title",defaultMessage:"Page updates"},privacySettingsName:{id:"action.privacySettings.name",defaultMessage:"Privacy settings"},unlockPageName:{id:"action.unlockPageName.name",defaultMessage:"Unlock page"},textFontStyle:{id:"action.textFontStyle.name",defaultMessage:"Text style"},suggestEditsName:{id:"action.suggestEdits.name",defaultMessage:"Suggest edits"},viewAnalyticsName:{id:"action.viewAnalytics.name",defaultMessage:"View analytics"},viewUpdatesAndAnalyticsName:{id:"action.updatesAndAnalytics.name",defaultMessage:"Updates & analytics"},openPageLayoutEditor:{id:"action.layoutEditor.open",defaultMessage:"Customize layout"},translate:{id:"action.translate",defaultMessage:"Translate"},customizeAIWorkflow:{id:"action.customizeAIWorkflow.open",defaultMessage:"Customize workflow"},translateTemplate:{id:"action.translateTemplate",defaultMessage:"Localize template"}});function wt(e){const{environment:t,intl:n,context:o,isFiltering:i}=e,{device:a}=t,r=o.blocks[0],s=r.getFollowSettingsKey(),l=it().Zk({followSettingsKey:s,environment:t,blockStore:r,from:"more_menu"});return[i?It(t,r.getFormat().page_font||"default"):kt({shouldRenderMobileRefresh:!0}),(0,fe().$J)({key:"page style and layout",render:e=>(0,f.jsx)(J().Z,{...e,topBorder:!1,shouldRenderMobileRefresh:!0}),actions:(0,U().oA)([_t,Pt,Rt,a.isMobile?void 0:en,a.isMobile?void 0:tn,Vt])}),(0,fe().$J)({key:"viewing of page content",render:e=>(0,f.jsx)(J().Z,{...e,shouldRenderMobileRefresh:!0}),actions:[yt().n,ct,Zt,pt().CU,pt().Bj,pt().fK]}),(0,ht().KE)({shouldRenderMobileRefresh:!0}),(0,fe().$J)({key:"editing of page content",render:e=>(0,f.jsx)(J().Z,{...e,shouldRenderMobileRefresh:!0}),actions:[Bt,gt().gz,Lt({shouldRenderMobileRefresh:!0}),Dt({shouldRenderMobileRefresh:!0})]}),(0,fe().$J)({key:"undo",render:e=>(0,f.jsx)(J().Z,{...e,shouldRenderMobileRefresh:!0}),actions:[St().Yw]}),(0,fe().$J)({key:"topbar primary actions",render:e=>(0,f.jsx)(J().Z,{...e,shouldRenderMobileRefresh:!0}),actions:[pt().q6,pt().hS,Et({environment:t,intl:n,blockStore:r}),St().aU,Ot,Ut,ft().m7,ft().nh,ft().fI,ft().MI,vt().A,bt().t0]}),(0,fe().$J)({key:"topbar import actions",render:e=>(0,f.jsx)(J().Z,{...e,shouldRenderMobileRefresh:!0}),actions:[Qt,pt().mS,Xt]}),(0,fe().$J)({key:"topbar wiki actions",render:e=>(0,f.jsx)(J().Z,{...e,shouldRenderMobileRefresh:!0}),actions:(0,U().oA)([xt().bV,xt().R$])}),Jt(),$t(t,l,!0),(0,me().Z)(o),(0,fe().$J)({key:"topbar view options",render:e=>(0,f.jsx)(J().Z,{...e,shouldRenderMobileRefresh:!0}),actions:[Nt,Ft,Ht,Kt]})]}function Ct(e){return(0,fe().cN)({key:`font ${e.font||"default"}`,displayName:e.displayName,analyticsName:e.displayName.defaultMessage,validators:[tt().or([tt().ffD(tt().YGm),tt().f7f]),tt().J5S,tt().ffD(tt().uY7),...e.extraValidators],render:(t,n)=>{const o=n.blocks[0].getFormat().page_font,i=e.font===o||!e.font&&!o;return(0,f.jsx)(ie,{...t,isActive:i,font:e.font,tooltip:e.tooltip,style:e.style,caption:e.caption,isFiltering:e.isFiltering,checkState:e.checkStatus,svg:e.svg})},closeParentMenu:!!e.isFiltering,action:(t,n)=>{let{blocks:o,environment:i}=t;G().createAndCommit({userAction:"actionRegistry.createFontAction",environment:i,canUndo:!0,perform:t=>{F().FH({stores:o,update:{page_font:e.font},transaction:t}),function(e,t){Oe().K4(e,"change_font_type",t)}(i,{type:e.font||"default"})}})}})}const jt=[{font:"default",action:function(e){const{isFiltering:t,pageFont:n}=e;return Ct({displayName:Mt.fontDefaultName,caption:(0,f.jsx)(l()._H,{...Mt.fontDefaultCaption}),font:void 0,tooltip:(0,f.jsx)(l()._H,{...Mt.fontDefaultTooltip}),style:t?{}:{fontSize:24,fontFamily:d().F5(c().locale).sans,position:"relative",top:-2},extraValidators:[],isFiltering:t,checkStatus:"default"===n,svg:C})}},{font:"serif",action:function(e){const{isFiltering:t,pageFont:n}=e;return Ct({displayName:Mt.fontSerifName,caption:(0,f.jsx)(l()._H,{...Mt.fontSerifCaption}),font:"serif",tooltip:(0,f.jsx)(l()._H,{...Mt.fontSerifTooltip}),style:t?{}:{fontSize:25,fontFamily:d().F5(c().locale).serif},extraValidators:[],isFiltering:t,checkStatus:"serif"===n,svg:j})}},{font:"mono",action:function(e){const{isFiltering:t,pageFont:n}=e;return Ct({displayName:Mt.fontMonoName,caption:(0,f.jsx)(l()._H,{...Mt.fontMonoCaption}),font:"mono",tooltip:(0,f.jsx)(l()._H,{...Mt.fontMonoTooltip}),style:t?{}:{fontSize:26,fontFamily:d().F5(c().locale).mono,position:"relative",top:-3,letterSpacing:-1},extraValidators:[],isFiltering:t,checkStatus:"mono"===n,svg:w})}},{font:"comic",action:function(e){const{isFiltering:t,pageFont:n}=e;return Ct({displayName:Mt.fontComicName,caption:(0,f.jsx)(l()._H,{...Mt.fontComicCaption}),font:"comic",tooltip:(0,f.jsx)(l()._H,{...Mt.fontComicTooltip}),style:{fontSize:t?14:26,fontFamily:d().F5(c().locale).comic,position:"relative",top:-3,letterSpacing:-1},extraValidators:[tt().or([tt().QLY("comic_sans"),e=>e.blocks.some((e=>"comic"===e.getFormatStore().getKeyStore("page_font").getValue()))])],isFiltering:t,checkStatus:"comic"===n})}}];function kt(e){const{shouldRenderMobileRefresh:t}=e;return(0,fe().$J)({key:"font section",title:void 0,render:e=>(0,f.jsx)(ae,{...e,shouldRenderMobileRefresh:t}),actions:jt.map((e=>e.action({isFiltering:!1})))})}function Tt(e){return(0,fe().$J)({key:"font extension menu",render:e=>(0,f.jsx)(J().Z,{...e,isFiltering:!0}),actions:jt.map((t=>t.action({isFiltering:!0,pageFont:e})))})}function It(e,t){const n=(0,O().gh)({theme:e.ThemeModeStore.state}),o=jt.map((e=>e.font)).findIndex((e=>e===t))??0;return(0,fe().$J)({key:"textStyleAction",render:e=>(0,f.jsx)(J().Z,{...e}),actions:[(0,fe().MV)({key:"font style section",displayName:Mt.textFontStyle,analyticsName:Mt.textFontStyle.defaultMessage,svg:L,right:(0,f.jsx)(f.Fragment,{children:t.charAt(0).toUpperCase()+t.slice(1)}),rightStyle:{color:n.lightTextColor,marginRight:5},width:300,validators:[tt().or([tt().ffD(tt().YGm),tt().f7f]),tt().J5S,tt().ffD(tt().uY7)],subActions:()=>[Tt(t)],initialFocus:o,hideSubActions:!0,fuzzySearchKeywordsArray:[Mt.fontDefaultName,Mt.fontSerifName,Mt.fontMonoName]})]})}const _t=(0,fe().N$)({key:"small text",displayName:Mt.fontSmallTextKeywords,label:Ue().Z.formatMessage(Mt.fontSmallTextLabel),svg:B,isEnabled:e=>Boolean(e.getFormat().page_small_text),validators:[tt().ffD(tt().tqC),tt().or([tt().ffD(tt().YGm),tt().f7f]),tt().J5S,tt().ffD(tt().uY7)],action:(e,t,n)=>F().FH({stores:[t],update:{page_small_text:!t.getFormat().page_small_text},transaction:n}),afterAction:(e,t)=>{Oe().K4(t,"change_font_size",{type:e?"small":"large"})}}),Pt=(0,fe().N$)({key:"full width",displayName:Mt.fullWidthLabel,svg:v,label:Ue().Z.formatMessage(Mt.fullWidthLabel),isEnabled:e=>e.isFullWidth(),validators:[tt().ffD(tt().Mnk),tt().ffD(tt().YGm),tt().J5S,tt().ffD(tt().uY7)],action:(e,t,n)=>{F().FH({stores:[t],update:{page_full_width:!t.isFullWidth()},transaction:n})},afterAction:(e,t)=>{Oe().K4(t,"change_page_width",{type:e?"full_width":"default_width"})}}),Zt=(0,fe().N$)({key:"page lock",displayName:Mt.lockPageName,label:Ue().Z.formatMessage(Mt.lockPageName),svg:n(19296).Y,isEnabled:e=>e.isLocked(),validators:[tt().ffD(tt().YGm),tt().J5S,tt().ffD(tt().uY7)],action:(e,t,n)=>E().sW({store:t.getFormatStore(),data:{block_locked:!t.isLocked(),block_locked_by:e.currentUser.id},transaction:n}),afterAction:()=>null}),At=[tt().ffD(tt().YGm),tt().J5S,tt().ffD(tt().uY7),tt().ffD(tt().tqC),tt().or([tt().iBZ])],Rt=(0,fe().N$)({key:"floating table of contents",displayName:Mt.floatingTableOfContents,svg:A,label:Ue().Z.formatMessage(Mt.floatingTableOfContents),isEnabled:e=>{var t;return"off"!==(null===(t=e.getModel())||void 0===t?void 0:t.getFloatingTableOfContentsState())},validators:At,action:(e,t,n)=>{var o;const i="off"!==(null===(o=t.getModel())||void 0===o?void 0:o.getFloatingTableOfContentsState());E().sW({store:t.getFormatStore(),data:{page_floating_table_of_contents:{state:i?"off":"minimal"}},transaction:n})},afterAction:(e,t)=>{(0,Oe().j)({environment:t,event:{eventName:"edit_page_table_of_contents_toggle",eventProperties:{is_table_of_contents_on:e}}})}}),Bt=(0,fe().cN)({key:"suggest edits",displayName:Mt.suggestEditsName,analyticsName:Mt.suggestEditsName.defaultMessage,badge:(0,f.jsx)($().i,{newBadgeKey:"suggested_edits_topbar_more_actions",didUserEngage:Boolean(null===(ut=Ke().default.state.currentUserSettingsStore)||void 0===ut||null===(ut=ut.getSettings())||void 0===ut?void 0:ut.dismissed_suggest_mode_tooltip)}),validators:[tt().ffD(tt().p1d),tt().ffD(tt().tqC),tt().or([tt().ffD(tt().YGm),tt().f7f]),tt().iR0,tt().ffD(tt().uY7)],render:(e,t)=>{const o="suggest"===Me().MT.getMode(t.blocks[0]),i=(0,O().gh)({theme:t.environment.ThemeModeStore.state});return(0,f.jsx)(Y().Z,{...e,title:(0,f.jsx)(l()._H,{...Mt.suggestEditsName}),svg:n(478518).I,right:(0,fe().Sy)(i,o)})},action:e=>{const t="suggest"===Me().MT.getMode(e.blocks[0])?"default":"suggest";"suggest"===t&&lt().Z.reset(),N().t_({environment:e.environment,navigableBlockStore:e.blocks[0],mode:t,location:"page_more_actions"})},closeParentMenu:!0});function Lt(e){const{shouldRenderMobileRefresh:t}=e;return(0,fe().cN)({key:"translate",displayName:Mt.translate,analyticsName:"open_translate_bar_from_topbar",validators:[tt().tpq,tt().tIA],closeParentMenu:!0,render:(e,n,o)=>{let{onFocus:i}=o;const a=n.blocks.at(0);if(a)return(0,f.jsx)(Ie,{onFocus:i,closeParentMenu:()=>{lt().Z.reset()},blockStore:a,menuListItemProps:e,title:(0,f.jsx)(l()._H,{...Mt.translate}),shouldRenderMobileRefresh:t})},action:()=>{}})}function Dt(e){const{shouldRenderMobileRefresh:t}=e;return(0,fe().cN)({key:"translate template",displayName:Mt.translateTemplate,analyticsName:"open_translate_template_bar_from_topbar",validators:[tt().S0S,tt().or([tt().tIA,tt().YGm]),tt().ffD(tt().uY7),tt().ffD(tt().NB0)],closeParentMenu:!0,render:(e,n,o)=>{let{onFocus:i}=o;const a=n.blocks.at(0);if(a)return(0,f.jsx)(et,{onFocus:i,closeParentMenu:()=>{lt().Z.reset()},blockStore:a,menuListItemProps:e,title:(0,f.jsx)(l()._H,{...Mt.translateTemplate}),shouldRenderMobileRefresh:t})},action:()=>{}})}const Vt=(0,fe().cN)({key:"customize page",displayName:Mt.customizePageLabel,analyticsName:Mt.customizePageLabel.defaultMessage,svg:T().m,validators:[tt().ffD(tt().iBZ),tt().U_8,tt().ffD(tt().uY7),tt().or([tt().ffD(tt().YGm),tt().f7f]),tt().or([tt().tqC,tt().ffD(tt().xks),tt().sVB]),tt().ffD(tt().NB0)],closeParentMenu:!0,render:e=>(0,f.jsx)(Y().Z,{...e,title:(0,f.jsx)(l()._H,{...Mt.customizePageLabel}),svg:T().m}),action:e=>{n(593515).bA({originRect:e.originRect})}}),Ot=(0,fe().cs)({key:"copy link to block non-desktop",displayName:fe().RE.copyLinkNavigableTypeName,analyticsName:fe().RE.copyLinkNavigableTypeName.defaultMessage,svg:n(680093).N,shortcuts:["copyCurrentPageLinkifiedBlockTitle"],validators:[tt().jlf,tt().U7o,tt().ffD(tt().daU),tt().ffD(tt().uY7),tt().ffD(tt().NB0)],closeParentMenu:!0,action:(e,t)=>{const{lazyDependencies:{clipboardActions:n}}=e;n?n.copyLinkToBlock({...e,event:t}):p().log({data:{miscDataToConvertToString:{actionKey:"copy link to block non-desktop"}},from:"topbarMoreActionRegistry",level:"info",type:"lazyDependencies:missingClipboardActions"})}}),Ut=(0,fe().cs)({key:"duplicate",displayName:fe().RE.duplicateName,analyticsName:fe().RE.duplicateName.defaultMessage,svg:n(200962).a,validators:[tt().DFt,tt().J5S,tt().KEd,tt().xks,tt().ffD(tt().P99(m().Ti.externalObjectInstancePage)),tt().ffD(tt().sVB),tt().ffD(tt().Q_M),tt().ffD(tt().uY7)],shortcuts:["duplicate"],closeParentMenu:!0,action:async(e,t)=>{let{environment:o}=e;const i=n(718959).np();if(!i)return;const a=i.getAssociatedCollectionStore();if(a&&(0,n(807230).ww)(o)){const e=new(n(985866).Z)(o);if(e.setContext({type:"collectionPage",collectionViewBlockStore:void 0,collectionStore:a}),(0,n(582835).vJ)(i,e))await n(236087).h5({environment:o,blocks:[i],collectionContextStore:e});else{const{duplicateBlock:e}=await(0,n(577041).dF)();G().createAndCommit({userAction:"actionRegistry.duplicateToCollection",environment:o,canUndo:!0,perform:t=>{const[r,s]=e({environment:o,stores:[i],addCopyName:(0,n(924390).Z)(i),transaction:t,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!i.isInsideTemplate(),targetSpaceId:(0,n(81954).J)(a.pointer.spaceId),baseUrl:Le().default.domainBaseUrl,publicDomainName:Le().default.publicDomainName,preferDuplicateLocation:"local"}),l=r[0];K().zw({childStore:l,parentStore:a,transaction:t}),i.isTemplate()&&n(282662).R3({parentStore:a.getTemplatePagesStore(),appendStore:l,transaction:t}),W()._c({environment:o,store:l,pageVisitSource:u().tY.Duplicate})}})}}}}),Nt=(0,fe().cN)({key:"open in mac app",displayName:Mt.openinMacAppName,analyticsName:Mt.openinMacAppName.defaultMessage,svg:k().h,validators:[tt().U7o,tt().ffD(tt().tYA),tt().ffD(tt().tqC),tt().V5r,tt().ffD(tt().NB0)],closeParentMenu:!0,action:(e,t)=>{let{blocks:n,environment:o}=e;const i=(0,ot().ZP)({store:n[0],fullyQualified:!1,pageVisitSource:u().tY.AppRedirect,embedded:!1});z().RX({url:(0,nt().W)(i),environment:o})}}),Ft=(0,fe().cN)({key:"open in windows app",displayName:Mt.openinWindowsAppName,analyticsName:Mt.openinWindowsAppName.defaultMessage,svg:k().h,validators:[tt().U7o,tt().ffD(tt().tYA),tt().ffD(tt().tqC),tt().EDF,tt().ffD(tt().NB0)],closeParentMenu:!0,action:(e,t)=>{let{blocks:n,environment:o}=e;const i=(0,ot().ZP)({store:n[0],fullyQualified:!1,pageVisitSource:u().tY.AppRedirect,embedded:!1});z().RX({url:(0,nt().W)(i),environment:o})}}),Ht=(0,fe().cN)({key:"open in ios app",displayName:Mt.openiniOSAppName,analyticsName:Mt.openiniOSAppName.defaultMessage,svg:k().h,validators:[tt().U7o,tt().ffD(tt().tYA),tt().gnQ,tt().ffD(tt().NB0)],closeParentMenu:!0,action:(e,t)=>{let{blocks:n,environment:o}=e;const i=(0,ot().ZP)({store:n[0],fullyQualified:!1,pageVisitSource:u().tY.AppRedirect,embedded:!1});z().RX({url:i,environment:o})}}),Kt=(0,fe().cN)({key:"open in android app",displayName:Mt.openinAndroidAppName,analyticsName:Mt.openinAndroidAppName.defaultMessage,svg:k().h,validators:[tt().U7o,tt().ffD(tt().tYA),tt().DtP,tt().ffD(tt().NB0)],closeParentMenu:!0,action:(e,t)=>{let{blocks:n,environment:o}=e;const i=(0,ot().ZP)({store:n[0],fullyQualified:!1,pageVisitSource:u().tY.AppRedirect,embedded:!1});z().RX({url:i,environment:o})}});function Et(e){const{environment:t,intl:n,blockStore:o}=e,i=(0,O().gh)({theme:t.ThemeModeStore.state});return(0,fe().cN)({key:"open page verification menu",analyticsName:"Open page verification",displayName:Mt.pageVerification,render:e=>(0,f.jsx)(Y().Z,{...e,svg:D().A,title:(0,f.jsx)(l()._H,{...Mt.pageVerification}),right:(0,f.jsx)("div",{style:{color:i.lightTextColor,marginRight:0},children:ce({intl:n,blockStore:o})}),rightStyle:{marginRight:5},showExtensionArrow:!0}),validators:[tt().tqC,tt().QLY("page_verification"),e=>tt().J5S(e),()=>{var e;const t=null===(e=Ke().default.state.currentSpaceStore)||void 0===e?void 0:e.getModel();return Boolean(t&&(0,V().$T)(t))}],closeParentMenu:!1,action:()=>{H().b()}})}const Wt=(0,fe().cN)({key:"open page updates",analyticsName:"Open page updates",displayName:Mt.pageUpdates,svg:M,validators:[n(78449).SO,tt().tqC],closeParentMenu:!0,action:()=>{n(452002).Z.setState({open:!0})},disabled:()=>!Se().default.state.online}),zt=(0,fe().cN)({key:"action page history",displayName:Mt.pageHistoryName,analyticsName:Mt.pageHistoryName.defaultMessage,svg:P,validators:[tt().or([tt()._Tt,tt().k5s]),tt().DFt,tt().jlf,tt().ffD(tt().YO6),tt().ffD(tt().Q_M),tt().ffD(tt().Jtb),tt().ffD(tt().NB0)],closeParentMenu:!0,action:e=>{let{environment:t,blocks:o}=e;return n(932005).jN({environment:t,blockStore:o[0],from:"topbar"})},render:(e,t)=>{let{onClick:o,key:i,...a}=e,{environment:r}=t;return(0,f.jsx)(n(239823).Z,{requireUpgradeToTier:!1,analyticsName:"history_modal",onClick:o,alwaysAllowClick:!0,render:(e,t)=>{const n=!Se().default.state.online;return(0,f.jsx)(Y().Z,{...(0,Q().Z)(a,e),title:Ue().Z.formatMessage(Mt.pageHistoryNewName),svg:P,dontShrinkRight:!0,right:t,tooltipText:n?Ue().Z.formatMessage(fe().RE.unavailableOfflineTooltip):void 0,disabled:n,disabledFeedback:n})},renderUpgradeTooltip:()=>{}},i)}}),Gt=(0,fe().cN)({key:"view analytics",displayName:Mt.viewAnalyticsName,analyticsName:Mt.viewAnalyticsName.defaultMessage,svg:x,validators:[tt().cFU,tt().ffD(tt().NB0)],closeParentMenu:!0,action:e=>{at().handleSidebarButtonClick(e.environment,e.blocks[0],rt().gY.Updates,"more_menu"),rt().default.setState({...rt().default.state,currentSubTab:rt().uF.Analytics})},disabled:()=>!Se().default.state.online,renderTooltip:()=>Ue().Z.formatMessage(fe().RE.unavailableOfflineTooltip),disableTooltip:()=>Se().default.state.online}),qt=(0,fe().cN)({key:"view updates and analytics",displayName:Mt.viewUpdatesAndAnalyticsName,analyticsName:Mt.viewUpdatesAndAnalyticsName.defaultMessage,validators:[tt().cFU,tt().ffD(tt().NB0)],svg:M,closeParentMenu:!0,badge:(0,f.jsx)($().i,{newBadgeKey:"new_updates_top_bar_entrypoint",didUserEngage:Boolean(null===(mt=Ke().default.state.currentUserSettingsStore)||void 0===mt||null===(mt=mt.getSettings())||void 0===mt?void 0:mt.opened_new_top_bar_updates_entrypoint)}),action:e=>{const{currentUserSettingsStore:t}=Ke().default.state;t&&G().createAndCommit({environment:e.environment,userAction:"topbarMoreActonRegistry.openUpdatesAndAnalytics",canUndo:!0,perform:e=>{n(348141).d2({userSettingsStore:t,transaction:e,data:{opened_new_top_bar_updates_entrypoint:!0}})}}),at().handleSidebarButtonClick(e.environment,e.blocks[0],rt().gY.Updates,"more_menu")},disabled:()=>!Se().default.state.online,renderTooltip:()=>Ue().Z.formatMessage(fe().RE.unavailableOfflineTooltip),disableTooltip:()=>Se().default.state.online});function Yt(e,t,n){var o;const i=(0,O().gh)({theme:e.ThemeModeStore.state});return(0,fe().MV)({key:"notifications",displayName:Mt.notifyMe,analyticsName:Mt.notifyMe.defaultMessage,svg:y().t,right:(0,f.jsx)(f.Fragment,{children:null===(o=t.find((e=>e.isSelectedOption)))||void 0===o?void 0:o.action.displayName}),rightStyle:{color:i.lightTextColor,marginRight:5},width:300,initialFocus:t.findIndex((e=>e.isSelectedOption))??0,validators:[tt().ffD(tt().uY7),tt().ffD(tt().NB0)],subActions:()=>[(0,fe().$J)({key:"notifications",render:e=>(0,f.jsx)(J().Z,{...e,shouldRenderMobileRefresh:!0}),actions:t.map((e=>{let{action:t}=e;return t}))})],hideSubActions:!0,shouldRenderMobileRefresh:n,fuzzySearchKeywordsArray:(0,U().oA)(t.map((e=>{let{action:t}=e;return t.displayName?it().bf(t.displayName):void 0})))})}function $t(e,t,n){return(0,fe().$J)({key:"notifyMe",render:e=>(0,f.jsx)(J().Z,{...e,shouldRenderMobileRefresh:n}),actions:[Yt(e,t,n)]})}function Jt(){const e="on"===Ee().default.getEligibleGroup({experimentId:"remove_updates_topbar_button_v2",defaultGroup:"control",disableExposureLogging:!0});return(0,fe().$J)({key:"editorActions",render:e=>(0,f.jsx)(J().Z,{...e,shouldRenderMobileRefresh:!0}),actions:(0,U().oA)([Wt,e?qt:Gt,zt])})}const Qt=(0,fe().cN)({key:"open import modal",displayName:Mt.importName,analyticsName:Mt.importName.defaultMessage,svg:n(934590).s,validators:[tt().YZb,tt().J5S,tt().ffD(tt().P99(m().Ti.externalObjectInstancePage)),tt().ffD(tt().Q_M),tt().ffD(tt().uY7)],closeParentMenu:!0,action:e=>{let{blocks:t}=e,o=!1;if(1===t.length){const[e]=t;o=e.isCollectionView()}o?n(825137).Z.setState({open:!0}):st().default.setState({...st().default.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0,openedFrom:"topbar"})},disabled:()=>!Se().default.state.online,renderTooltip:()=>Ue().Z.formatMessage(fe().RE.unavailableOfflineTooltip),disableTooltip:()=>Se().default.state.online}),Xt=(0,fe().cN)({key:"export block",displayName:Mt.exportName,analyticsName:Mt.exportName.defaultMessage,validators:[tt().jlf,tt().KbU,tt().ffD(tt().NB0)],closeParentMenu:!0,render:e=>{const t=!Se().default.state.online;return(0,f.jsx)(Y().Z,{...e,svg:n(32618).D,title:(0,f.jsx)(l()._H,{...Mt.exportName}),tooltipText:t?(0,f.jsx)(l()._H,{...fe().RE.unavailableOfflineTooltip}):(0,f.jsx)(l()._H,{...Mt.exportCaption}),disabled:t,disabledFeedback:t})},action:e=>{let{blocks:t,environment:o}=e;const i=t[0];if(!i.isDefined())return;let a=!0;const r=(0,q().fm)(t[0]);if(r){const e=null==r?void 0:r.collectionStore();null!=e&&e.isPageTreeCollection()&&(a=!1)}n(174912).q$({environment:o,root:{id:i.id,table:"block",spaceId:i.getSpaceId()},isCollectionViewExportTypeSupported:a})}}),en=(0,fe().cN)({key:"open page layout editor",displayName:Mt.openPageLayoutEditor,analyticsName:Mt.openPageLayoutEditor.defaultMessage,validators:[tt().iBZ],closeParentMenu:!0,render:function(e){return(0,f.jsx)(Y().Z,{...e,svg:n(967925).J,title:(0,f.jsx)(re().gq,{children:(0,f.jsx)(l()._H,{...Mt.openPageLayoutEditor})})})},action:function(e){let t,o,i,a,{environment:r,blocks:s}=e;for(const n of s)if(n.isCollectionView()){const e=n.getCollectionStore();if(e){t=n,o=e;const r=(0,q().fm)(n);i=null==r?void 0:r.collectionViewStore(),a="customize_database_button_in_three_dot_menu";break}}else{const e=n.getAssociatedCollectionStore();if(e&&!e.isPageTreeCollection()){t=n,o=e,a="customize_page_button_in_three_dot_menu";break}}if(!o||!t||!a)throw new Error("Could not edit page layout: Could not find collection");n(142730).IR({environment:r,blockStore:t,collectionStore:o,collectionViewStore:i,from:a})}});const tn=(0,fe().cN)({key:"customize AI workflow",displayName:Mt.customizeAIWorkflow,analyticsName:Mt.customizeAIWorkflow.defaultMessage,validators:[tt().fAV,tt().YGm,tt().J5S,tt().ffD(tt().p1d),tt().ffD(tt().f7f)],closeParentMenu:!0,render:function(e){return(0,f.jsx)(Y().Z,{...e,svg:I().t,title:(0,f.jsx)(re().gq,{children:(0,f.jsx)(l()._H,{...Mt.customizeAIWorkflow})})})},action:function(e){let{environment:t,blocks:o}=e;const i=o[0];i.isCollectionView()&&n(452435).openEditor({environment:t,store:i})}});var nn=()=>n(148126),on=()=>n(985523),an=()=>n(149809),rn=()=>n(740046),sn=()=>n(18748),ln=()=>n(508181),dn=()=>n(912826);function cn(e){const{blockStore:t,onClickOriginRect:n,handleAccept:c,handleDismiss:u}=e,m=(0,i().O7)(),p=(0,i().Fy)(),g=(0,l().YB)(),[h,v]=(0,o.useState)(""),[y,b]=o.useState(!1),[x,S]=(0,o.useState)(),M=(0,a().VK)((()=>({environment:m,blocks:[t],originRect:n,publicEditMode:void 0})),[m,t,n]),{initialSections:w,filterSections:C}=(0,a().VK)((()=>({initialSections:wt({environment:m,intl:g,context:M,isFiltering:!1}),filterSections:wt({environment:m,intl:g,context:M,isFiltering:!0})})),[m,g,M]),j=(0,a().VK)((()=>0===h.length&&!t.isCollectionView()&&t.canEdit()&&t.hasContent()),[t,h]),k=(0,a().VK)((()=>0===h.length&&t.canEdit()),[t,h.length]),T=(0,a().VK)((()=>t.canEdit()&&t.isCollectionView()),[t]),I=(0,r().yK)((e=>({caption:{color:e.lightTextColor},icon:{color:e.icon.secondary,width:16,height:16},menuPropIcon:{color:e.accentColors.gray[500]}})),[]),_=(0,f.jsxs)(f.Fragment,{children:[j&&!k&&(0,f.jsx)(sn().ZP,{caption:(0,f.jsx)("span",{style:I.caption,children:(0,f.jsx)(l()._H,{id:"pageMoreButton.wordCount.caption",defaultMessage:"Word count: {count}",values:{count:(0,f.jsx)(dn().Z,{store:t})}})})}),k&&(0,f.jsx)("div",{style:{marginBottom:1},children:(0,f.jsx)(on().y,{store:t,isPageMoreButton:!0,showWordCount:j,shouldRenderMobileRefresh:!0})})]}),P=p.isMobile?{menuType:be().o.Modal,title:(0,f.jsx)(l()._H,{defaultMessage:"Actions",id:"topbarMoreButton.mobileActionsMenu.title"}),right:y&&(0,f.jsx)(je().MobileModalExitButton,{}),leftRightButtonStyle:I.menuPropIcon,onClickRight:u,titleOuterStyle:{fontSize:17,fontWeight:d().Ue.bold},onSwipeDown:y?()=>b(!1):u,paddingTop:10,shouldRenderMobileRefresh:!0,isFullScreen:y,setIsFullScreen:b}:{menuType:be().o.Popup,maxHeight:"80vh"};return(0,f.jsxs)(Ce().Z,{...P,children:[!p.isMobile&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(J().Z,{isInput:!0,style:{marginBottom:4,marginTop:4},children:(0,f.jsx)(rn().ZP,{value:h,onChange:e=>v(e.target.value),focus:!0,focusAfterAnimation:!0,placeholder:g.formatMessage({defaultMessage:"Search actions…",id:"topbarMenu.filterForActions.placeholder"}),preventCaptureDeleteWhenEmpty:!0,inputLeft:(0,s().R)({...I.icon}),showClearButton:!0,inputElementAttributes:x})}),(0,f.jsx)(J().Z,{style:{paddingTop:0,paddingBottom:0},children:(0,f.jsx)(an().Z,{sections:w,filterSections:C,onAccept:c,context:M,filter:h,showNoResultsMessage:!0,initialFocus:h.length>0?0:void 0,setComboboxAriaProps:S})})]}),p.isMobile&&(0,f.jsx)(an().Z,{sections:w,onAccept:c,context:M}),(j||k)&&(p.isMobile?(0,f.jsx)(f.Fragment,{children:_}):(0,f.jsx)(J().Z,{topBorder:!0,children:_})),T&&(0,f.jsx)(un,{})]})}function un(){return(0,f.jsx)(J().Z,{topBorder:!0,children:(0,f.jsx)(ln().Z,{title:(0,f.jsx)(l()._H,{defaultMessage:"Learn about databases",id:"topbar.moreButton.collectionHelpButton"}),href:(0,nn().UY)("guides.database"),analyticsFrom:"topbar_more_button"})})}},83340:(e,t,n)=>{n.r(t),n.d(t,{PageAnalyticsPageOptOut:()=>y,TopbarPageAnalyticsOptOutMenu:()=>v,TopbarPageAnalyticsOptOutMenuStore:()=>h});n(667294);var o=()=>n(219727),i=()=>n(142735),a=()=>n(788860),r=()=>n(261930),s=()=>n(148126),l=()=>n(998901),d=()=>n(104088),c=()=>n(876822),u=()=>n(78078),m=()=>n(967092),p=()=>n(765513),g=()=>n(579807),f=n(785893);const h=n(263184).default.createValue({isOpen:!1,rect:void 0},{name:"TopbarPageAnalyticsOptOutMenuStore"});function v(){const e=(0,o().O7)(),t=(0,i().VK)((()=>h.state.isOpen),[]),n=(0,i().VK)((()=>h.state.rect),[]),r=(0,i().VK)((()=>c().default.state.mainEditorCurrentBlockStore),[]);return r?(0,f.jsx)(m().ZP,{popupType:e.device.isMobile?d().k.SlideUp:d().k.Popup,alignmentToOrigin:l().Alignment.Center,open:t,render:()=>(0,f.jsx)("div",{style:{minWidth:360,padding:16},children:(0,f.jsxs)(u().sg,{gap:16,children:[(0,f.jsx)("div",{style:{fontSize:16,fontWeight:500},children:(0,f.jsx)(a()._H,{id:"TopbarPageAnalyticsOptOutMenu.heading",defaultMessage:"Privacy settings"})}),(0,f.jsx)(y,{store:r})]})}),originRect:n,onDismiss:()=>h.setState({isOpen:!1,rect:void 0})}):null}function y(e){const t=(0,o().O7)(),n=(0,i().VK)((()=>{const e=c().default.state.currentSpaceViewStore;return null==e?void 0:e.getSettings()}),[]),l=(0,i().VK)((()=>{const t=null==n?void 0:n.page_analytics_opt_out_list;return null==t?void 0:t.includes(e.store.id)}),[n,e.store.id]);return(0,f.jsx)(g().Z,{type:"dropdown",currentOption:l?"do_not_record":"record",options:[{key:"record",label:(0,f.jsx)(a()._H,{id:"page_analytics.opt_out.record",defaultMessage:"Record"})},{key:"do_not_record",label:(0,f.jsx)(a()._H,{id:"page_analytics.opt_out.do_not_record",defaultMessage:"Don't record"})}],onSelectOption:n=>{"do_not_record"===n?r().kY(t,e.store.id):r().pu(t,e.store.id)},isMobile:t.device.isMobile,title:(0,f.jsx)(a()._H,{id:"page_analytics.opt_out.title",defaultMessage:"My view history"}),caption:(0,f.jsx)(a()._H,{id:"page_analytics.opt_out.caption",defaultMessage:"Page editors can see my view history for this page. <inlinelink>Learn more</inlinelink>.",values:{inlinelink:e=>(0,f.jsx)(p().Z,{external:!0,href:(0,s().UY)("guides.pageAnalytics"),children:e})}}),captionStyle:{maxWidth:270}})}},884607:(e,t,n)=>{n.r(t),n.d(t,{TopbarShareButton:()=>N});var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(846550),s=()=>n(591514),l=n(785893);const d=(0,n(827282).IU)("mobileQuickCaptureShare",{viewBox:"0 0 14 17",svg:(0,l.jsx)("path",{d:"M3.05566 15.8516C2.29915 15.8516 1.72266 15.6556 1.32617 15.2637C0.934245 14.8763 0.738281 14.3066 0.738281 13.5547V6.89648C0.738281 6.14453 0.934245 5.57487 1.32617 5.1875C1.72266 4.79557 2.29915 4.59961 3.05566 4.59961H4.9834V6.12402H3.17871C2.87793 6.12402 2.64779 6.2015 2.48828 6.35645C2.33333 6.50684 2.25586 6.73926 2.25586 7.05371V13.3975C2.25586 13.7119 2.33333 13.9466 2.48828 14.1016C2.64779 14.2565 2.87793 14.334 3.17871 14.334H10.8145C11.1107 14.334 11.3385 14.2565 11.498 14.1016C11.6576 13.9466 11.7373 13.7119 11.7373 13.3975V7.05371C11.7373 6.73926 11.6576 6.50684 11.498 6.35645C11.3385 6.2015 11.1107 6.12402 10.8145 6.12402H9.0166V4.59961H10.9443C11.7008 4.59961 12.2751 4.79557 12.667 5.1875C13.0635 5.57943 13.2617 6.14909 13.2617 6.89648V13.5547C13.2617 14.3021 13.0635 14.8717 12.667 15.2637C12.2751 15.6556 11.7008 15.8516 10.9443 15.8516H3.05566ZM6.99316 10.335C6.80176 10.335 6.6377 10.2666 6.50098 10.1299C6.36426 9.99316 6.2959 9.83138 6.2959 9.64453V2.84961L6.35742 1.84473L5.96094 2.35742L5.05859 3.32129C4.93555 3.45345 4.7806 3.51953 4.59375 3.51953C4.42513 3.51953 4.2793 3.46484 4.15625 3.35547C4.03776 3.24154 3.97852 3.09798 3.97852 2.9248C3.97852 2.7653 4.04232 2.61947 4.16992 2.4873L6.45312 0.292969C6.54883 0.201823 6.63997 0.140299 6.72656 0.108398C6.81315 0.0719401 6.90202 0.0537109 6.99316 0.0537109C7.08887 0.0537109 7.18001 0.0719401 7.2666 0.108398C7.35775 0.140299 7.44889 0.201823 7.54004 0.292969L9.82324 2.4873C9.95085 2.61947 10.0146 2.7653 10.0146 2.9248C10.0146 3.09798 9.95312 3.24154 9.83008 3.35547C9.70703 3.46484 9.56348 3.51953 9.39941 3.51953C9.21712 3.51953 9.06445 3.45345 8.94141 3.32129L8.03223 2.35742L7.64258 1.84473L7.69727 2.84961V9.64453C7.69727 9.83138 7.62891 9.99316 7.49219 10.1299C7.36003 10.2666 7.19368 10.335 6.99316 10.335Z"})});var c=()=>n(788860),u=()=>n(358414),m=()=>n(247724),p=()=>n(164079),g=()=>n(803728),f=()=>n(878797),h=()=>n(365872),v=()=>n(845465),y=()=>n(681832),b=()=>n(547046),x=()=>n(998901),S=()=>n(804217),M=()=>n(265640),w=()=>n(448419),C=()=>n(64260),j=()=>n(967092),k=()=>n(654133),T=()=>n(328714),I=()=>n(568017),_=()=>n(628370),P=()=>n(1910),Z=()=>n(577741);function A(e){const{visible:t,onDismiss:n}=e,o=(0,r().yK)((e=>({overlayContainer:{position:"relative",width:240,height:140,paddingTop:0,paddingBottom:20,paddingLeft:20,paddingRight:20},container:{fontSize:12,color:I().ZP.white,position:"absolute",top:13,background:I().ZP.blue,borderRadius:6,padding:"8px 12px 12px 12px",width:200,boxShadow:e.shadowMD,zIndex:9999},circle:{position:"absolute",top:-12,left:"calc(50% - 2.5px)",background:I().ZP.blue,width:5,height:5,borderRadius:5,boxShadow:`0 0 0 1.5px ${e.contentBackground}`},verticalLine:{position:"absolute",top:-12,left:"calc(50% - 1px)",background:I().ZP.blue,width:2,height:12},textContainer:{width:"90%",fontWeight:500},iconButton:{position:"absolute",top:4,right:4,opacity:.8},iconStyle:{width:12,fill:I().ZP.white}})),[]);return(0,l.jsx)("div",{style:o.overlayContainer,children:(0,l.jsx)(_().Z,{visible:t,animate:{opacity:1},initial:{opacity:0},exit:{opacity:0},style:o.container,children:(0,l.jsxs)(Z().P,{calloutId:"share_button_tooltip",children:[(0,l.jsx)("div",{style:o.circle}),(0,l.jsx)("div",{style:o.verticalLine}),(0,l.jsx)("div",{style:o.textContainer,children:(0,l.jsx)(c()._H,{defaultMessage:"You can share your content with your teammates here",id:"shareButtonIntroTooltip.title"})}),(0,l.jsx)(P().Z,{icon:T().U,style:o.iconButton,iconStyle:o.iconStyle,onClick:()=>n()})]})})})}var R=()=>n(265456),B=()=>n(596986);const L=(0,c().vU)({share:{defaultMessage:"Share",id:"topbar.share"}});function D(e){let{store:t,buttonPopupStore:s,styling:d}=e;const c=(0,i().O7)(),{isMobile:m,isTablet:p}=(0,a().VK)((()=>({isMobile:c.device.isMobile,isTablet:c.device.isTablet})),[c]),g=(0,a().qz)(void 0,n(136765).Z),f=(0,a().qz)(void 0,n(257934).ZP),b=(0,a().qz)(void 0,n(885414).Z),x=(0,a().VK)((()=>function(e,t){if(t.shouldUserHaveAccessToPrivatePageBlock()&&t.state.changePermissionsEnabled&&t.state.privatePageStore&&t.state.privatePageStore.id===e.id)return t.state.privatePageStore;return e}(t,b)),[t,b]),S=(0,a().VK)((()=>(0,n(779733).wZ)({disableLogging:!0})),[]),M=(0,a().VK)((()=>t.canAdmin()),[t]),C=(0,a().VK)((()=>!m&&function(e,t){const{permissionsInviteStore:n}=e.state;return n.state.inviteTargets.length>0||t.state.inviteTargets.length>0}(g,f)),[f,m,g]),{isPrivatePageInfoGateEnabled:j,sudoModeStoreId:k}=(0,a().VK)((()=>{var e;const t=null===(e=b.state.privatePageStore)||void 0===e?void 0:e.id;return{isPrivatePageInfoGateEnabled:n(749826).default.checkGate({gateName:"enable_get_private_page_info_endpoint"}),sudoModeStoreId:t}}),[b]),T=(0,a().VK)((()=>n(876822).default.state.currentSpaceStore),[]);(0,o.useEffect)((()=>{!function(e){var t;let{environment:n,store:o,sudoModeStore:i,canAdmin:a,currentSpaceStore:r}=e;null!==(t=i.state.privatePageStore)&&void 0!==t&&t.id&&i.state.privatePageStore.id!==o.id&&i.reset();a||u().i({environment:n,sudoModeStore:i,pageBlockId:o.id,currentSpaceStore:r})}({environment:c,sudoModeStore:b,store:t,canAdmin:M,currentSpaceStore:T})}),[M,c,t,b,j,k,T]),(0,o.useEffect)((()=>{y().default.setState({...y().default.state,isInitialized:!0})}));const I=(0,o.useCallback)((()=>{s.reset()}),[s]),_=(0,o.useCallback)((()=>{U({buttonPopupStore:s,universalMemberInviteStore:g,inviteTargetsStore:f}),n(879952).ZH({environment:c}),h().lG(c),c.currentUser.isLoggedIn()&&n(576387).bi(c)}),[s,g,f,c]),P=(0,o.useCallback)((e=>(0,l.jsx)(V,{buttonPopupEvents:e,styling:d,handleClick:_})),[_,d]),Z=(0,o.useCallback)((async()=>{if(f.state.inviteTargets.length>0){return void(await h().zd({environment:c,inviteTargetsStore:f})&&(h().a6(c),U({buttonPopupStore:s,universalMemberInviteStore:g,inviteTargetsStore:f})))}const{permissionsInviteStore:e}=g.state;"invitee"===e.state.inputFocus&&e.setState({...e.state,inputFocus:"none"});await(0,n(88476).Aw)({environment:c,permissionsInviteStoreState:e.state,from:"share_menu"})||(h().a6(c),U({buttonPopupStore:s,universalMemberInviteStore:g,inviteTargetsStore:f}))}),[s,c,f,g]),A=(0,r().yK)((e=>({buttonPopup:{...m?{width:"100%"}:p?{width:460}:{width:S?v().SD:500,overflow:"hidden",...S&&{borderRadius:v().q5,boxShadow:e.shadowMD,..."dark"===e.mode&&{border:`1px solid ${e.largePopupBorder}`}}}}})),[m,S,p]);return(0,l.jsx)(w().ZP,{popupType:m?w().Z4.SlideUp:w().Z4.Popup,forceInitialInbound:!0,buttonPopupStore:s,renderOrigin:P,originGap:m?void 0:8,style:A.buttonPopup,onClick:_,render:()=>(0,l.jsx)(n(886123)._,{buttonPopupStore:s,sudoModeStore:b,store:x,inviteTargetsStore:f,universalMemberInviteStore:g,onUpgradeButtonClick:I,location:m?"topbar_mobile":"topbar_share_button",onClose:Z}),persistOnClose:C,onDismiss:Z,onClose:Z})}function V(e){let{buttonPopupEvents:t,styling:n,handleClick:s}=e;const{isMobile:d}=(0,i().Fy)(),u=(0,a().VK)((()=>!S().default.state.online),[]),m=(0,a().VK)((()=>(0,b().C)()),[]),g=(0,r().yK)((e=>({shortcut:{color:e.mediumInvertedTextColor}})),[]),f=(0,o.useCallback)((()=>u?(0,l.jsx)(c()._H,{defaultMessage:"Unavailable while offline",id:"topbar.shareButton.offlineTooltip"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{children:m?(0,l.jsx)(c()._H,{defaultMessage:"Share",id:"topbar.shareButton.tooltipAWTL"}):(0,l.jsx)(c()._H,{defaultMessage:"Share or publish to the web",id:"topbar.shareButton.tooltip"})}),(0,l.jsx)(C().Z,{style:g.shortcut,name:"openShareMenu"})]})),[u,m,g.shortcut]);return(0,l.jsx)(k().Z,{disableTooltip:d,renderTooltip:f,placement:x().Placement.Bottom,delayThreshold:400,render:e=>(0,l.jsx)(O,{events:(0,p().Z)(e,t),styling:n,handleClick:s,disabled:u})})}function O(e){let{events:t,styling:n,handleClick:u,disabled:h}=e;const v=(0,i().O7)(),{isMobile:y}=(0,i().Fy)(),b=(0,c().YB)(),S=(0,r().yK)((e=>{const t=(0,R().Kh)(e),o=(0,B().F_)(e);return{mobileIconStyle:t[n??"mobile_horizon1_quick_capture"].iconStyle,shareButton:{...y?t[n??"mobile_horizon1_quick_capture"].iconContainer:{marginRight:o.iconButton.marginRight,marginLeft:o.iconButton.marginRight}},popup:{boxShadow:"none",backgroundColor:"rgba(0, 0, 0, 0)"}}}),[y,n]);const w=y?"mobile_horizon1_quick_capture_circle_icons"===n?d(S.mobileIconStyle):(0,s().s)(S.mobileIconStyle):(0,l.jsx)(c()._H,{defaultMessage:"Share",id:"topbar.shareButton.title"});(0,o.useEffect)((()=>{g().yM(v,"share_button_tooltip")}),[v]);const C=(0,a().VK)((()=>f().default.isVisible("share_button_tooltip")),[]),k=(0,o.useCallback)((()=>{g().Gi(v,"share_button_tooltip")}),[v]),T=(0,o.useCallback)((()=>(0,l.jsx)(A,{visible:!0,onDismiss:k})),[k]),I=(0,l.jsx)(M().D,{id:void 0,className:m().MD7,...(0,p().Z)(t,{onClick:k}),mobileFeedback:y,style:S.shareButton,"aria-label":b.formatMessage(L.share),disabled:h,disabledFeedback:h,children:w});return C?(0,l.jsx)(j().ZP,{popupType:j().kQ.Popup,open:!0,origin:I,placementToOrigin:x().Placement.Bottom,alignmentToOrigin:x().Alignment.Center,preventScaleTransition:!0,preventOpacityTransition:!0,viewportPadding:4,preventCaptureEsc:!0,preventPointerEvents:!1,disableMouseCapture:!0,render:T,style:S.popup}):I}function U(e){let{buttonPopupStore:t,universalMemberInviteStore:n,inviteTargetsStore:o}=e;t.reset(),n.reset(),o.reset()}const N=o.memo(D)},496669:(e,t,n)=>{n.r(t),n.d(t,{TopbarStopSuggestModeButton:()=>C});var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(846550),s=()=>n(205248),l=()=>n(13654),d=()=>n(788860),c=()=>n(244540),u=()=>n(348141),m=()=>n(442531),p=()=>n(45909),g=()=>n(677559),f=()=>n(590972),h=()=>n(998901),v=()=>n(876822),y=()=>n(725751),b=()=>n(154186),x=()=>n(905263),S=n(785893);const M=(0,d().vU)({stopSuggestRole:{defaultMessage:"Turn off suggesting",id:"topbar.stopsuggestmodel."},tooltip:{defaultMessage:"You’re suggesting",id:"topbarStopSuggestModeButton.tooltip"},tooltipCommentOnlyContent:{defaultMessage:"Suggest edits or add comments",id:"topbarStopSuggestModeButton.tooltipCommentOnlyContent"}});function w(e){let{store:t,isVisible:n,compact:u,framerMotion:m}=e;const g=(0,i().O7)(),h=(0,d().YB)(),v=(0,a().VK)((()=>Boolean(y().default.state.isShowingTabBar)),[]),x=(0,a().VK)((()=>f().default.state.expanded),[]),w=(0,r().yK)((e=>({button:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:256,color:e.text.uiBluePrimary,gap:0,height:28,background:e.accentColors.uiBlue[100],...(0,p().X)({noDrag:g.device.isElectron&&!v})},hoveredButton:{background:e.accentColors.uiBlue[200]},pressedButton:{background:e.accentColors.uiBlue[300]},suggestionIcon:{height:18,width:18,marginLeft:9,marginRight:7},text:{fontSize:14,lineHeight:1.428,marginRight:7},closeIcon:{height:14,width:14,fill:e.text.uiBlueSecondary,marginRight:9}})),[g.device.isElectron,v]),C=(0,o.useCallback)((()=>{c().t_({environment:g,navigableBlockStore:t,mode:"default",location:"stop_suggest_pill"})}),[g,t]),k=(0,o.useRef)(null),{AnimatePresence:T,motion:I}=m;return(0,S.jsx)(T,{children:n&&(0,S.jsxs)(I.div,{ref:k,initial:{opacity:0,x:30},animate:{opacity:1,x:0},transition:{duration:.1},children:[(0,S.jsxs)(b().Z,{style:w.button,hoveredStyle:w.hoveredButton,pressedStyle:w.pressedButton,onClick:C,ariaLabel:h.formatMessage(M.stopSuggestRole),children:[(0,l().I)(w.suggestionIcon),(0,S.jsx)(T,{initial:x,children:!u&&!x&&(0,S.jsx)(I.div,{initial:{width:0},exit:{width:0},animate:{width:"auto"},transition:{duration:.1},style:w.text,children:(0,S.jsx)(d()._H,{id:"topbar.stopsuggestmodel.label",defaultMessage:"Suggesting"})})}),(0,s().D)(w.closeIcon)]},"button"),!u&&!x&&(0,S.jsx)(j,{store:t,origin:k})]})})}function C(e){const{value:t}=(0,g().XJ)(m().io);return t?(0,S.jsx)(w,{...e,framerMotion:t}):null}function j(e){const{store:t,origin:n}=e,r=(0,d().YB)(),s=(0,i().O7)(),l=(0,a().VK)((()=>t.isCommentOnly()),[t]),c=(0,a().VK)((()=>{var e;return null===(e=v().default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.dismissed_suggest_mode_tooltip}),[]),m=l||!c,[p,g]=(0,o.useState)(m);return p?(0,S.jsx)(x().U,{origin:n,alignmentToOrigin:h().Alignment.Center,placementToOrigin:"bottom",header:(0,S.jsx)(S.Fragment,{children:r.formatMessage(M.tooltip)}),content:l?r.formatMessage(M.tooltipCommentOnlyContent):null,headerStyle:{marginBottom:-2,width:"max-content",maxWidth:240},contentStyle:{width:"max-content",maxWidth:240},hideCloseButton:!0,shouldDismissUponOutsideClick:!0,onCloseClick:()=>{g(!1),u().g2({environment:s,dismissed:!0})},pointerPosition:"50%",pointerLength:24}):null}},902569:(e,t,n)=>{n.d(t,{I:()=>v});n(267602),n(653476),n(241792);var o=n(667294),i=()=>n(219727),a=()=>n(846550),r=()=>n(235605),s=()=>n(283848),l=()=>n(416403),d=()=>n(594546),c=()=>n(352230),u=()=>n(827973),m=()=>n(198829),p=()=>n(255577),g=()=>n(388284),f=()=>n(868744),h=n(785893);function v(e){const{onSelectTargetLanguage:t,onSelectSourceLanguage:n,editorModeConfigTranslateState:v,sourceLanguage:y,detectedPageLanguage:b,preferredLanguage:x,subMenuPlacement:S,subMenuAlignment:M,shouldRenderMobileRefresh:w,pageId:C}=e,j=(0,i().O7)(),k=(0,i().Fy)(),T="loading"===v.status,I=(0,a().yK)((e=>({menuItemSectionBottomBorder:{boxShadow:`${e.regularDividerColor} 0px 1px 0px`},button:{color:T?e.lightTextColor:e.regularTextColor}})),[T]),_=(0,o.useMemo)((()=>{const e=[...l().RY];if(b){const t=e.indexOf(b);t>=0&&e.splice(t,1),e.unshift(b)}return e}),[b]);return(0,o.useEffect)((()=>{if("pre_activation"===v.status){const e=setTimeout((()=>{(0,d().j)({environment:j,event:{eventName:"translate_page_interaction",eventProperties:{type:"action_menu_rendered",page_id:C}}})}),750);return()=>clearTimeout(e)}}),[v.status,C,j]),(0,h.jsx)(p().ZP,{initialFocus:void 0,type:p().iW.Vertical,sections:[{key:"sourceLanguage",render:e=>(0,h.jsx)(g().Z,{...e,title:"From",desktopTitleStyle:{marginLeft:2,marginRight:2},style:I.menuItemSectionBottomBorder,shouldRenderMobileRefresh:w}),items:[{key:y,render:(e,t)=>{let{onFocus:o}=t;return(0,h.jsx)(f().Z,{...e,onFocus:o,disableDefaultClick:!0,placementToOrigin:S,alignmentToOrigin:M,renderOrigin:(e,t)=>(0,h.jsx)(u().Z,{...e,disabled:T,buttonStyle:I.button,ref:t,title:(0,s().E)(y),caption:y===b?"Detected language":y===x?"Preferred language":void 0}),renderExtension:(e,t)=>{const o=k.isMobile?{menuType:c().o.ActionSheet,...e}:{menuType:c().o.Popup,width:200,...e};return(0,h.jsx)(m().Z,{...o,onClick:e=>{e.preventDefault()},children:(0,h.jsx)(p().ZP,{initialFocus:void 0,type:p().iW.Vertical,sections:[{key:"originalLanguage",render:e=>(0,h.jsx)(g().Z,{...e}),items:_.filter((e=>void 0===v.targetLanguage||v.targetLanguage!==e)).map((e=>({key:e,render:(t,n)=>(0,h.jsx)(u().Z,{...t,disabled:T,buttonStyle:I.button,title:(0,s().E)(e),right:y===e?(0,r().k)({width:14,height:14}):void 0}),action:()=>{T||n({sourceLanguage:e})}})))}]})})}})},action:()=>{}}]},{key:"selectLanguage",render:e=>(0,h.jsx)(g().Z,{...e,title:"To",desktopTitleStyle:{marginLeft:2,marginRight:2},shouldRenderMobileRefresh:w}),items:l().Gx.filter((e=>e!==y)).map((e=>({key:e,render:(t,n)=>(0,h.jsx)(u().Z,{...t,buttonStyle:I.button,disabled:T,title:(0,s().E)(e),right:v.targetLanguage===e?(0,r().k)({width:14,height:14}):void 0}),action:()=>{T||t({targetLanguage:e})}})))}]})}},259098:(e,t,n)=>{n.d(t,{IR:()=>p,Rc:()=>d,Wc:()=>s,eN:()=>u,nL:()=>a});var o=()=>n(788860);const i=(0,o().vU)({expanded:{id:"customizePageMenuVisibilitySelect.expanded.label",defaultMessage:"Expanded"},off:{id:"customizePageMenuVisibilitySelect.off.label",defaultMessage:"Off"}}),a={section_show:i.expanded,section_collapsed:i.expanded,section_hide:i.off},r=(0,o().vU)({default:{id:"customizePageMenuVisibilitySelect.default.label",defaultMessage:"Default"},minimal:{id:"customizePageMenuVisibilitySelect.minimal.label",defaultMessage:"Minimal"}}),s={inline:r.default,minimal:r.minimal},l=(0,o().vU)({showOnHover:{id:"visibilityLevelMessages.backlinksPageSection.showOnHover",defaultMessage:"Show on hover"},alwaysShow:{id:"visibilityLevelMessages.backlinksPageSection.alwaysShow",defaultMessage:"Always show"},off:{id:"customizePageMenuVisibilitySelect.off.label",defaultMessage:"Off"}}),d={always_show:l.alwaysShow,section_show:l.showOnHover,section_collapsed:l.showOnHover,section_hide:l.off,inline:l.off,minimal:l.off},c=(0,o().vU)({asPageSection:{id:"customizePageMenuVisibilitySelect.section.label",defaultMessage:"As page section"},minimal:{id:"visibilityLevelMessages.propertyPageSection.minimal",defaultMessage:"Minimal"}}),u={inline:c.asPageSection,minimal:c.minimal},m=(0,o().vU)({alwaysShow:{id:"customizePageMenuVisibilitySelect.show.label",defaultMessage:"Always show"},alwaysHide:{id:"customizePageMenuVisibilitySelect.hide.label",defaultMessage:"Always hide"},hideWhenEmpty:{id:"customizePageMenuVisibilitySelect.hideIfEmpty.label",defaultMessage:"Hide when empty"},asPageSection:{id:"customizePageMenuVisibilitySelect.section.label",defaultMessage:"As page section"}}),p={show:m.alwaysShow,hide:m.alwaysHide,hide_if_empty:m.hideWhenEmpty,section:m.asPageSection}},550757:(e,t,n)=>{n.d(t,{K1:()=>v,Xv:()=>x,YV:()=>h,h9:()=>b,pb:()=>y});n(267602),n(653476),n(241792),n(667294);var o=()=>n(219727),i=()=>n(846550),a=()=>n(109477),r=()=>n(286977),s=()=>n(788860),l=()=>n(670655),d=()=>n(352230),c=()=>n(827973),u=()=>n(198829),m=()=>n(255577),p=()=>n(388284),g=()=>n(259098),f=n(785893);function h(e){const{currentVisibility:t,propertySchema:n,onSelect:o,onClose:i}=e;let r=[...a().AX];r=r.filter((e=>"section"!==e)),(0,l().kq)({propertySchema:n})||(r=r.filter((e=>"hide_if_empty"!==e)));const d=r.map((e=>({visibility:e,label:(0,f.jsx)(s()._H,{...g().IR[e]})})));return(0,f.jsx)(S,{currentVisibility:t,visibilityLevelsWithLabels:d,onSelect:o,onClose:i})}function v(e){const{currentVisibility:t,onSelect:n,onClose:o}=e,i=(0,l().AN)(t),a=["always_show","section_collapsed","section_hide"].map((e=>({visibility:e,label:(0,f.jsx)(s()._H,{...g().Rc[e]})})));return(0,f.jsx)(S,{currentVisibility:i,visibilityLevelsWithLabels:a,onSelect:n,onClose:o})}function y(e){const{currentVisibility:t,onSelect:n,onClose:o}=e,i=a().UR.filter((e=>"section_hide"!==e)).map((e=>({visibility:e,label:(0,f.jsx)(s()._H,{...g().eN[e]})}))),r="section_hide"===t?void 0:t;return(0,f.jsx)(S,{currentVisibility:r,visibilityLevelsWithLabels:i,onSelect:n,onClose:o})}function b(e){const{currentVisibility:t,onSelect:n,onClose:o}=e,i=a().uH.filter((e=>"section_collapsed"!==e)).map((e=>({visibility:e,label:(0,f.jsx)(s()._H,{...g().nL[e]})}))),r="section_collapsed"===t?"section_show":t;return(0,f.jsx)(S,{currentVisibility:r,visibilityLevelsWithLabels:i,onSelect:n,onClose:o})}function x(e){const{currentVisibility:t,onSelect:n,onClose:o}=e,i=a().iK.map((e=>({visibility:e,label:(0,f.jsx)(s()._H,{...g().Wc[e]})})));return(0,f.jsx)(S,{currentVisibility:t,visibilityLevelsWithLabels:i,onSelect:n,onClose:o})}function S(e){const{currentVisibility:t,visibilityLevelsWithLabels:n,onSelect:i,onClose:a}=e,r=(0,o().Fy)(),l=n.map((e=>{let{visibility:n,label:o}=e;return{key:n,render:e=>(0,f.jsx)(M,{buttonMenuItemProps:e,isChecked:n===t,label:o}),action:()=>{i(n),a&&a()}}})),c=[{key:"visibilityLevels",render:e=>(0,f.jsx)(p().Z,{...e,topBorder:0!==e.index}),items:l}];let g;return g=r.isMobile?{menuType:d().o.Modal,title:(0,f.jsx)(s()._H,{id:"customizePageMenuVisibilitySelect.mobile.title",defaultMessage:"Select visibility"}),right:(0,f.jsx)(s()._H,{id:"customizePageMenuVisibilitySelect.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:()=>a&&a()}:{menuType:d().o.Popup,width:"auto",maxWidth:360},(0,f.jsx)(u().Z,{...g,children:(0,f.jsx)(m().ZP,{type:m().iW.Vertical,initialFocus:void 0,sections:c})})}function M(e){const{buttonMenuItemProps:t,label:n,isChecked:a}=e,{isMobile:s}=(0,o().Fy)(),l=(0,i().yK)((()=>({title:{display:"flex",alignItems:"center",width:150},checkedIcon:{width:s?16:14}})),[s]),d=(0,f.jsx)("div",{style:l.title,children:n}),u=(0,f.jsx)("div",{style:l.checkedIcon,children:(0,r().e)()});return(0,f.jsx)(c().Z,{...t,textWrapperStyle:{marginRight:0},title:d,right:a?u:void 0})}},706003:(e,t,n)=>{n.d(t,{GY:()=>p,k7:()=>g,nm:()=>m});n(667294);var o=()=>n(219727),i=()=>n(846550),a=()=>n(374289),r=()=>n(788860),s=()=>n(265640),l=()=>n(448419),d=()=>n(259098),c=()=>n(550757),u=n(785893);function m(e){const{buttonPopupStore:t,disabled:n,currentVisibility:o}=e,i=(0,u.jsx)(r()._H,{...d().Rc[o]});return(0,u.jsx)(f,{disabled:n,buttonPopupStore:t,currentVisibilityLabel:i,renderVisibilityLevelsMenu:t=>(0,u.jsx)(c().K1,{...e,onClose:()=>{var n;null===(n=e.onClose)||void 0===n||n.call(e),t.close()}})})}function p(e){const{buttonPopupStore:t,disabled:n,currentVisibility:o}=e,i=(0,u.jsx)(r()._H,{...d().nL[o]});return(0,u.jsx)(f,{disabled:n,buttonPopupStore:t,currentVisibilityLabel:i,renderVisibilityLevelsMenu:t=>(0,u.jsx)(c().h9,{...e,onClose:()=>{var n;null===(n=e.onClose)||void 0===n||n.call(e),t.close()}})})}function g(e){const{buttonPopupStore:t,disabled:n,currentVisibility:o}=e,i=(0,u.jsx)(r()._H,{...d().Wc[o]});return(0,u.jsx)(f,{disabled:n,buttonPopupStore:t,currentVisibilityLabel:i,renderVisibilityLevelsMenu:t=>(0,u.jsx)(c().Xv,{...e,onClose:()=>{var n;null===(n=e.onClose)||void 0===n||n.call(e),t.close()}})})}function f(e){const t=(0,o().Fy)(),{buttonPopupStore:n,currentVisibilityLabel:r,renderVisibilityLevelsMenu:d,disabled:c}=e,m=t.isMobile?l().Z4.SlideUp:l().Z4.Popup,p=(0,i().yK)((e=>({chevronDownIcon:{width:10,marginLeft:4,marginRight:4,fill:e.lightIconColor},currentVisibilityLabel:{color:e.mediumTextColor,paddingRight:4,height:t.isMobile?32:22}})),[t.isMobile]);return(0,u.jsx)(l().ZP,{popupType:m,buttonPopupStore:n,renderOrigin:e=>(0,u.jsxs)(s().D,{style:p.currentVisibilityLabel,disabled:c,...e,children:[r,(0,a().i)(p.chevronDownIcon)]}),render:d})}},542649:(e,t,n)=>{n.d(t,{EZ:()=>i,FD:()=>a,G5:()=>o,rK:()=>r});const o=220,i=24,a=-7,r=-3},562219:(e,t,n)=>{n.d(t,{J:()=>a});var o=()=>n(677559);const i=new(o().Ss)("UpdateSidebarTabInfo",(async()=>await Promise.all([n.e(39938),n.e(18216),n.e(23006),n.e(60895)]).then(n.bind(n,931656)))),a=(0,o().kF)(i,(e=>e.UpdateSidebarTabInfo))},675393:(e,t,n)=>{n.d(t,{DG:()=>f,Di:()=>i,F7:()=>d,Lq:()=>c,Q3:()=>l,ZH:()=>m,aL:()=>s,aP:()=>v,db:()=>a,gS:()=>S,i4:()=>g,lG:()=>b,mN:()=>x,oC:()=>p,op:()=>h,pn:()=>u,q4:()=>r,w3:()=>y});var o=()=>n(677559);const i=new(o().Ss)("menus",(async()=>{const[{default:e},{TopbarPageAnalyticsOptOutMenu:t},{default:o},{default:i},{default:a},{default:r},{default:s},{default:l},{default:d},{default:c},{default:u},{SidebarTeamModal:m},{SidebarCreateTeamModal:p},{CreateTeamFromPageConfirmModal:g},{CollectionTypedDatabaseMigrationModal:f},{default:h},{default:v},{default:y}]=await Promise.all([Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(39938),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(94556),n.e(78701),n.e(38804),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(71641),n.e(23006),n.e(72646),n.e(10553),n.e(74879),n.e(67601),n.e(37239),n.e(40692),n.e(20683),n.e(22467),n.e(27039),n.e(97083),n.e(52065),n.e(18534),n.e(39179),n.e(77555),n.e(38632),n.e(78856),n.e(19592),n.e(47559),n.e(22371),n.e(73230),n.e(25911),n.e(54843),n.e(76540),n.e(22337),n.e(93536),n.e(53936),n.e(23721),n.e(32175),n.e(66283),n.e(22154),n.e(58586)]).then(n.bind(n,55351)),Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(39938),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(94556),n.e(78701),n.e(38804),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(71641),n.e(23006),n.e(72646),n.e(10553),n.e(74879),n.e(67601),n.e(37239),n.e(40692),n.e(20683),n.e(22467),n.e(27039),n.e(97083),n.e(52065),n.e(18534),n.e(39179),n.e(77555),n.e(38632),n.e(78856),n.e(19592),n.e(47559),n.e(22371),n.e(73230),n.e(25911),n.e(54843),n.e(76540),n.e(22337),n.e(93536),n.e(53936),n.e(23721),n.e(32175),n.e(66283),n.e(22154),n.e(58586)]).then(n.bind(n,83340)),Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(39938),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(94556),n.e(78701),n.e(38804),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(71641),n.e(23006),n.e(72646),n.e(10553),n.e(74879),n.e(67601),n.e(37239),n.e(40692),n.e(20683),n.e(22467),n.e(27039),n.e(97083),n.e(52065),n.e(18534),n.e(39179),n.e(77555),n.e(38632),n.e(78856),n.e(19592),n.e(47559),n.e(22371),n.e(73230),n.e(25911),n.e(54843),n.e(76540),n.e(22337),n.e(93536),n.e(53936),n.e(23721),n.e(32175),n.e(66283),n.e(22154),n.e(58586)]).then(n.bind(n,11070)),Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(39938),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(94556),n.e(78701),n.e(38804),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(71641),n.e(23006),n.e(72646),n.e(10553),n.e(74879),n.e(67601),n.e(37239),n.e(40692),n.e(20683),n.e(22467),n.e(27039),n.e(97083),n.e(52065),n.e(18534),n.e(39179),n.e(77555),n.e(38632),n.e(78856),n.e(19592),n.e(47559),n.e(22371),n.e(73230),n.e(25911),n.e(54843),n.e(76540),n.e(22337),n.e(93536),n.e(53936),n.e(23721),n.e(32175),n.e(66283),n.e(22154),n.e(58586)]).then(n.bind(n,487974)),Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(39938),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(94556),n.e(78701),n.e(38804),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(71641),n.e(23006),n.e(72646),n.e(10553),n.e(74879),n.e(67601),n.e(37239),n.e(40692),n.e(20683),n.e(22467),n.e(27039),n.e(97083),n.e(52065),n.e(18534),n.e(39179),n.e(77555),n.e(38632),n.e(78856),n.e(19592),n.e(47559),n.e(22371),n.e(73230),n.e(25911),n.e(54843),n.e(76540),n.e(22337),n.e(93536),n.e(53936),n.e(23721),n.e(32175),n.e(66283),n.e(22154),n.e(58586)]).then(n.bind(n,293660)),Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(39938),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(94556),n.e(78701),n.e(38804),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(71641),n.e(23006),n.e(72646),n.e(10553),n.e(74879),n.e(67601),n.e(37239),n.e(40692),n.e(20683),n.e(22467),n.e(27039),n.e(97083),n.e(52065),n.e(18534),n.e(39179),n.e(77555),n.e(38632),n.e(78856),n.e(19592),n.e(47559),n.e(22371),n.e(73230),n.e(25911),n.e(54843),n.e(76540),n.e(22337),n.e(93536),n.e(53936),n.e(23721),n.e(32175),n.e(66283),n.e(22154),n.e(58586)]).then(n.bind(n,743405)),Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(39938),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(94556),n.e(78701),n.e(38804),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(71641),n.e(23006),n.e(72646),n.e(10553),n.e(74879),n.e(67601),n.e(37239),n.e(40692),n.e(20683),n.e(22467),n.e(27039),n.e(97083),n.e(52065),n.e(18534),n.e(39179),n.e(77555),n.e(38632),n.e(78856),n.e(19592),n.e(47559),n.e(22371),n.e(73230),n.e(25911),n.e(54843),n.e(76540),n.e(22337),n.e(93536),n.e(53936),n.e(23721),n.e(32175),n.e(66283),n.e(22154),n.e(58586)]).then(n.bind(n,995744)),Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(39938),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(94556),n.e(78701),n.e(38804),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(71641),n.e(23006),n.e(72646),n.e(10553),n.e(74879),n.e(67601),n.e(37239),n.e(40692),n.e(20683),n.e(22467),n.e(27039),n.e(97083),n.e(52065),n.e(18534),n.e(39179),n.e(77555),n.e(38632),n.e(78856),n.e(19592),n.e(47559),n.e(22371),n.e(73230),n.e(25911),n.e(54843),n.e(76540),n.e(22337),n.e(93536),n.e(53936),n.e(23721),n.e(32175),n.e(66283),n.e(22154),n.e(58586)]).then(n.bind(n,795879)),Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(39938),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(94556),n.e(78701),n.e(38804),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(71641),n.e(23006),n.e(72646),n.e(10553),n.e(74879),n.e(67601),n.e(37239),n.e(40692),n.e(20683),n.e(22467),n.e(27039),n.e(97083),n.e(52065),n.e(18534),n.e(39179),n.e(77555),n.e(38632),n.e(78856),n.e(19592),n.e(47559),n.e(22371),n.e(73230),n.e(25911),n.e(54843),n.e(76540),n.e(22337),n.e(93536),n.e(53936),n.e(23721),n.e(32175),n.e(66283),n.e(22154),n.e(58586)]).then(n.bind(n,720940)),Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(39938),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(94556),n.e(78701),n.e(38804),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(71641),n.e(23006),n.e(72646),n.e(10553),n.e(74879),n.e(67601),n.e(37239),n.e(40692),n.e(20683),n.e(22467),n.e(27039),n.e(97083),n.e(52065),n.e(18534),n.e(39179),n.e(77555),n.e(38632),n.e(78856),n.e(19592),n.e(47559),n.e(22371),n.e(73230),n.e(25911),n.e(54843),n.e(76540),n.e(22337),n.e(93536),n.e(53936),n.e(23721),n.e(32175),n.e(66283),n.e(22154),n.e(58586)]).then(n.bind(n,277650)),Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(39938),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(94556),n.e(78701),n.e(38804),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(71641),n.e(23006),n.e(72646),n.e(10553),n.e(74879),n.e(67601),n.e(37239),n.e(40692),n.e(20683),n.e(22467),n.e(27039),n.e(97083),n.e(52065),n.e(18534),n.e(39179),n.e(77555),n.e(38632),n.e(78856),n.e(19592),n.e(47559),n.e(22371),n.e(73230),n.e(25911),n.e(54843),n.e(76540),n.e(22337),n.e(93536),n.e(53936),n.e(23721),n.e(32175),n.e(66283),n.e(22154),n.e(58586)]).then(n.bind(n,363806)),Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(39938),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(94556),n.e(78701),n.e(38804),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(71641),n.e(23006),n.e(72646),n.e(10553),n.e(74879),n.e(67601),n.e(37239),n.e(40692),n.e(20683),n.e(22467),n.e(27039),n.e(97083),n.e(52065),n.e(18534),n.e(39179),n.e(77555),n.e(38632),n.e(78856),n.e(19592),n.e(47559),n.e(22371),n.e(73230),n.e(25911),n.e(54843),n.e(76540),n.e(22337),n.e(93536),n.e(53936),n.e(23721),n.e(32175),n.e(66283),n.e(22154),n.e(58586)]).then(n.bind(n,807883)),Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(39938),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(94556),n.e(78701),n.e(38804),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(71641),n.e(23006),n.e(72646),n.e(10553),n.e(74879),n.e(67601),n.e(37239),n.e(40692),n.e(20683),n.e(22467),n.e(27039),n.e(97083),n.e(52065),n.e(18534),n.e(39179),n.e(77555),n.e(38632),n.e(78856),n.e(19592),n.e(47559),n.e(22371),n.e(73230),n.e(25911),n.e(54843),n.e(76540),n.e(22337),n.e(93536),n.e(53936),n.e(23721),n.e(32175),n.e(66283),n.e(22154),n.e(58586)]).then(n.bind(n,216867)),Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(39938),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(94556),n.e(78701),n.e(38804),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(71641),n.e(23006),n.e(72646),n.e(10553),n.e(74879),n.e(67601),n.e(37239),n.e(40692),n.e(20683),n.e(22467),n.e(27039),n.e(97083),n.e(52065),n.e(18534),n.e(39179),n.e(77555),n.e(38632),n.e(78856),n.e(19592),n.e(47559),n.e(22371),n.e(73230),n.e(25911),n.e(54843),n.e(76540),n.e(22337),n.e(93536),n.e(53936),n.e(23721),n.e(32175),n.e(66283),n.e(22154),n.e(58586)]).then(n.bind(n,253032)),Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(39938),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(94556),n.e(78701),n.e(38804),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(71641),n.e(23006),n.e(72646),n.e(10553),n.e(74879),n.e(67601),n.e(37239),n.e(40692),n.e(20683),n.e(22467),n.e(27039),n.e(97083),n.e(52065),n.e(18534),n.e(39179),n.e(77555),n.e(38632),n.e(78856),n.e(19592),n.e(47559),n.e(22371),n.e(73230),n.e(25911),n.e(54843),n.e(76540),n.e(22337),n.e(93536),n.e(53936),n.e(23721),n.e(32175),n.e(66283),n.e(22154),n.e(58586)]).then(n.bind(n,931928)),Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(39938),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(94556),n.e(78701),n.e(38804),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(71641),n.e(23006),n.e(72646),n.e(10553),n.e(74879),n.e(67601),n.e(37239),n.e(40692),n.e(20683),n.e(22467),n.e(27039),n.e(97083),n.e(52065),n.e(18534),n.e(39179),n.e(77555),n.e(38632),n.e(78856),n.e(19592),n.e(47559),n.e(22371),n.e(73230),n.e(25911),n.e(54843),n.e(76540),n.e(22337),n.e(93536),n.e(53936),n.e(23721),n.e(32175),n.e(66283),n.e(22154),n.e(58586)]).then(n.bind(n,176866)),Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(39938),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(94556),n.e(78701),n.e(38804),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(71641),n.e(23006),n.e(72646),n.e(10553),n.e(74879),n.e(67601),n.e(37239),n.e(40692),n.e(20683),n.e(22467),n.e(27039),n.e(97083),n.e(52065),n.e(18534),n.e(39179),n.e(77555),n.e(38632),n.e(78856),n.e(19592),n.e(47559),n.e(22371),n.e(73230),n.e(25911),n.e(54843),n.e(76540),n.e(22337),n.e(93536),n.e(53936),n.e(23721),n.e(32175),n.e(66283),n.e(22154),n.e(58586)]).then(n.bind(n,874226)),Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(39938),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(94556),n.e(78701),n.e(38804),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(71641),n.e(23006),n.e(72646),n.e(10553),n.e(74879),n.e(67601),n.e(37239),n.e(40692),n.e(20683),n.e(22467),n.e(27039),n.e(97083),n.e(52065),n.e(18534),n.e(39179),n.e(77555),n.e(38632),n.e(78856),n.e(19592),n.e(47559),n.e(22371),n.e(73230),n.e(25911),n.e(54843),n.e(76540),n.e(22337),n.e(93536),n.e(53936),n.e(23721),n.e(32175),n.e(66283),n.e(22154),n.e(58586)]).then(n.bind(n,969016))]);return{CustomizePageMenuRenderer:e,TopbarPageAnalyticsOptOutMenu:t,ImportModal:o,ExportModal:i,PageTemplateModal:a,GoogleAuthPromptModal:r,StudentNotEligibleModal:s,CookieModal:l,ForkPagePopup:d,DatePropertyMenu:c,ReportPageModal:u,SidebarCreateTeamModal:p,SidebarTeamModal:m,CreateTeamFromPageConfirmModal:g,CollectionTypedDatabaseMigrationModal:f,OpenInDesktopAppPopup:h,BlockMenu:v,ImportIntoNewPageModal:y}})),a=(0,o().kF)(i,(e=>e.CustomizePageMenuRenderer)),r=(0,o().kF)(i,(e=>e.TopbarPageAnalyticsOptOutMenu)),s=(0,o().kF)(i,(e=>e.PageTemplateModal)),l=(0,o().kF)(i,(e=>e.ImportModal)),d=(0,o().kF)(i,(e=>e.ExportModal)),c=(0,o().kF)(i,(e=>e.ReportPageModal)),u=(0,o().kF)(i,(e=>e.GoogleAuthPromptModal)),m=(0,o().kF)(i,(e=>e.StudentNotEligibleModal)),p=(0,o().kF)(i,(e=>e.CookieModal)),g=(0,o().kF)(i,(e=>e.BlockMenu)),f=(0,o().kF)(i,(e=>e.ForkPagePopup)),h=(0,o().kF)(i,(e=>e.CollectionTypedDatabaseMigrationModal)),v=(0,o().kF)(i,(e=>e.SidebarCreateTeamModal)),y=(0,o().kF)(i,(e=>e.SidebarTeamModal)),b=(0,o().kF)(i,(e=>e.CreateTeamFromPageConfirmModal)),x=(0,o().kF)(i,(e=>e.OpenInDesktopAppPopup)),S=(0,o().kF)(i,(e=>e.ImportIntoNewPageModal))},966296:(e,t,n)=>{n.d(t,{B:()=>a});var o=()=>n(677559);const i=new(o().Ss)("teamPermissionsInviteWithModal",(async()=>await Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(39938),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(94556),n.e(78701),n.e(38804),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(71641),n.e(23006),n.e(72646),n.e(10553),n.e(74879),n.e(67601),n.e(37239),n.e(40692),n.e(20683),n.e(22467),n.e(27039),n.e(97083),n.e(52065),n.e(18534),n.e(39179),n.e(77555),n.e(38632),n.e(78856),n.e(19592),n.e(47559),n.e(22371),n.e(73230),n.e(25911),n.e(54843),n.e(76540),n.e(22337),n.e(93536),n.e(53936),n.e(23721),n.e(32175),n.e(66283),n.e(22154),n.e(58586)]).then(n.bind(n,824033)))),a=(0,o().kF)(i,(e=>e.TeamPermissionsInviteWithModal))},81821:(e,t,n)=>{n.d(t,{Z:()=>i});class o extends(()=>n(442))().Z{}const i=new o},328939:(e,t,n)=>{n.d(t,{G:()=>i});n(267602),n(916054);var o=()=>n(275200);function i(e){const{element:t,extraBottomSpacing:n=0}=e;let i=t.getBoundingClientRect();i=DOMRect.fromRect({x:i.x,y:i.y,width:i.width,height:i.height+n});return(0,o().hI)(t).every((e=>{const t=e.getBoundingClientRect();return i.top>=t.top&&i.bottom<=t.bottom&&i.left>=t.left&&i.right<=t.right}))}},688293:(e,t,n)=>{n.d(t,{N:()=>p,t:()=>g});n(670560);var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(799891),s=(n(821057),()=>n(386616)),l=()=>n(826955),d=()=>n(269299);var c=()=>n(109083),u=()=>n(910135),m=()=>n(142109);function p(e,t){let{canUndo:n,shouldPersistOperation:p}=t;const g=(0,i().O7)(),f=(0,o.useRef)([]).current,h=(0,o.useCallback)((e=>{f.push(...e)}),[f]),v=(0,o.useCallback)((e=>{p&&!p(e)||h([e])}),[h,p]),y=(0,m().$)(e,{cacheFallback:g.defaultRecordCache.inMemoryRecordCache,isTemporaryData:!0,onOperationCallback:v});(0,o.useEffect)((()=>{c().Z.initializeCache(e,y)}),[e,y]);const b=(0,o.useCallback)((()=>{u().default.reset(),c().Z.clearCache(e)}),[e]);(0,o.useEffect)((()=>(u().default.reset(),()=>{u().default.reset(),c().Z.expire(e)})),[e]);const x=(0,a().VK)((()=>u().default.state.undoStack.length>0),[]);(0,o.useEffect)((()=>{c().Z.updateUnsavedCacheState(e,x)}),[e,x]);const S=(0,o.useCallback)((async e=>{if(0===f.length)return void 0;y.assertUnexpired(),function(e){for(const t of u().default.state.undoStack)for(const n of t.transactions)for(const t of n.stores)if(t.inMemoryRecordCache!==e&&!t.inMemoryRecordCache.isMockTextStore){const o=n.getUserActionForAnalyticsPurposesOnly(),i=t.inMemoryRecordCache.name,a=e.name,s=`Undoable user action "${o}" was applied to cache "${i}", but only operations in the cache "${a}" should be in the undo stack!`;(0,r().log)({from:"useLocalDraft",type:"invalidStoreInRevisionStack",level:"error",data:{message:s,miscDataToConvertToString:{userAction:o,inMemoryRecordCacheName:i,expectedInMemoryRecordCacheName:a}}})}}(y);const{serverCommitResult:t}=d().createAndCommit({environment:g,userAction:e,perform(e){!function(e){let{environment:t,transaction:n,operationsWithStores:o}=e;for(const{operation:i,store:a}of o){if(!(a instanceof l().ST))continue;const e=a.clone(t.defaultRecordCache.inMemoryRecordCache);(0,s().Qf)(i)?d().applyCrdtTextOperation({store:a,operation:i,transaction:n,invertedOperation:void 0}):d().applyOperation({transaction:n,store:e,operation:i})}}({environment:g,transaction:e,operationsWithStores:f}),e.postSubmitCallbacks.push((e=>{e||(y.expire(),u().default.reset())}))},canUndo:n});return t}),[e,n,g,f,y]);return(0,o.useMemo)((()=>({cache:y,hasChanges:x,persist:S,reset:b})),[x,S,b,y])}function g(e,t){return(0,a().VK)((()=>t.clone(e.cache)),[t,e.cache])}},746324:(e,t,n)=>{n.d(t,{Q:()=>r});var o=()=>n(219727),i=()=>n(142735),a=()=>n(718959);function r(){const e=(0,o().O7)();return(0,i().Kw)((0,a().k_)(e))}},738740:(e,t,n)=>{n.d(t,{k:()=>x});var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(846550),s=()=>n(61951),l=()=>n(317924),d=()=>n(879952),c=()=>n(990966),u=()=>n(573357),m=()=>n(708518),p=()=>n(764767),g=()=>n(205228),f=()=>n(148126),h=()=>n(838266),v=()=>n(110372),y=()=>n(878797),b=n(785893);function x(e){const{messageKey:t,desktopRenderInner:n,desktopInnerStyle:o,desktopOnDismiss:d,phoneRenderInner:c,phoneInnerStyle:p}=e,x=(0,i().O7)(),M=(0,i().Fy)(),w=(0,r().yK)((e=>({modalStyle:{background:e.surface.wash,borderRadius:12,...o}})),[o]),C=(0,a().VK)((()=>{var e;const t=(0,l().w_)(x.TabbedRouterStore.state);return"web"===t.type&&((null===(e=t.redirectedTo)||void 0===e?void 0:e.route)||t.route)}),[x.TabbedRouterStore]),j=(0,a().VK)((()=>!(M.isPhone&&(0,f().__)(x)&&(!C||"page"!==C.name))&&!g().default.isAdminMode&&!h().default.state.open),[M.isPhone,x,C]),k=(0,a().VK)((()=>y().default.isVisible(t)),[t])&&j;return(0,s().Z)((()=>{v().gF(x,{callout_key:t,is_forced:y().default.isForced(t)})}),k),k?M.isPhone?(0,b.jsx)(S,{messageKey:t,renderInner:c,innerStyle:p}):(0,b.jsx)(m().Z,{open:!0,preventHideChildrenWhileOpening:!0,onDismiss:d,innerStyle:w.modalStyle,render:()=>(0,b.jsx)(u().Z,{capture:!0,allowEsc:!0,render:n})}):null}function S(e){const{renderInner:t,innerStyle:n,messageKey:a}=e,r=(0,i().O7)(),s=(0,o.useCallback)((()=>{v().bl(r,{callout_key:a,dismiss_type:"modal_background_clicked"})}),[r,a]),l=(0,o.useCallback)((()=>{v().bl(r,{callout_key:a,dismiss_type:"modal_dismiss_clicked"})}),[r,a]);return(0,o.useEffect)((()=>{d().ZH({environment:r}),c().blurActiveElement()}),[r]),(0,b.jsx)(p().n,{renderInner:t,innerStyle:n,onDismiss:s,onClosed:l})}},620770:(e,t,n)=>{n.d(t,{p:()=>k});var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(61951),s=()=>n(573357),l=()=>n(708518),d=()=>n(838266),c=()=>n(803728),u=()=>n(110372),m=()=>n(878797),p=()=>n(846550),g=()=>n(605305),f=()=>n(707513),h=()=>n(212493),v=()=>n(779300),y=()=>n(408478),b=()=>n(729775),x=()=>n(661641),S=n(785893);function M(e){const{src:t}=e,n=(0,p().yK)((()=>({container:{width:480,height:294,marginLeft:-16,marginTop:-16,overflow:"hidden"},img:{width:480}})),[]);return(0,S.jsx)("div",{style:n.container,children:t?(0,S.jsx)("img",{src:t,style:n.img}):void 0})}function w(e){const{title:t,body:n,badge:o}=e,i=(0,p().yK)((e=>({container:{paddingRight:8,paddingBottom:12,paddingLeft:8,paddingTop:24},body:{maxWidth:380}})),[]);return(0,S.jsxs)(h().jX,{style:i.container,gap:4,children:[(0,S.jsxs)(h().jX,{direction:"row",align:"center-left",width:"hug",gap:8,children:[(0,S.jsx)(x().q,{styleName:"UITitle-26px/Bold",colorName:"primary",children:t}),o]}),(0,S.jsx)(x().q,{styleName:"UIRegular-14px/Regular",colorName:"secondary",customStyles:i.body,children:n})]})}function C(e){const{link:t,secondary:n,primary:o}=e,i=(0,p().yK)((e=>({container:{marginTop:16,height:40},link:{color:e.text.secondary,borderRadius:6,padding:"4px 8px",display:"flex",alignItems:"center"},externalLinkIcon:{width:16},secondary:{color:e.text.secondary,padding:"0 12px",borderRadius:6,height:32,display:"flex",alignItems:"center"},primary:{padding:"0 12px",borderRadius:6,height:32,fontSize:f().JB.UIRegular.desktop,fontWeight:f().Ue.semibold}})),[]);let a=(0,S.jsx)("div",{});t&&(a=(0,S.jsxs)(b().Z,{onClick:t.onClick,style:i.link,external:t.external,children:[(0,S.jsx)(x().q,{styleName:"UIRegular-14px/Regular",colorName:"secondary",children:t.text}),t.external?(0,g().K)(i.externalLinkIcon):void 0]}));const r=n?(0,S.jsx)(b().Z,{onClick:n.onClick,style:i.secondary,external:n.external,children:(0,S.jsx)(x().q,{styleName:"UIRegular-14px/Regular",colorName:"secondary",children:n.text})}):void 0,s=o?(0,S.jsx)(v().h,{styles:i.primary,onClick:o.onClick,children:o.text}):void 0;return(0,S.jsxs)(h().jX,{style:i.container,direction:"row",align:"center",gap:"auto",children:[a,(0,S.jsxs)(h().jX,{direction:"row",gap:8,align:"center",width:"hug",children:[r,s]})]})}function j(e){const{title:t,body:n,primary:o,secondary:i,link:a,imageSrc:r,onDismiss:s,badge:l}=e,d=(0,p().yK)((e=>({container:{width:480,padding:16,position:"relative",backgroundColor:e.surface.wash}})),[]);return(0,S.jsxs)(h().jX,{style:d.container,direction:"column",children:[(0,S.jsx)(M,{src:r}),(0,S.jsx)(w,{title:t,body:n,badge:l}),(0,S.jsx)(C,{primary:o,secondary:i,link:a}),(0,S.jsx)(y().Z,{onClick:s})]})}function k(e){const{message:t}=e,n=(0,i().O7)(),p=(0,a().VK)((()=>!d().default.state.open&&!n.device.isMobile),[n]),g=(0,a().VK)((()=>p&&m().default.isVisible(t.key)),[t,p]);(0,r().Z)((()=>{u().gF(n,{callout_key:t.key})}),g);const f=(0,o.useCallback)((()=>{u().bl(n,{callout_key:t.key,dismiss_type:"modal_dismiss_clicked"}),c().pl(n,t)}),[n,t]),h=(0,o.useCallback)(((e,o)=>()=>{u().lZ(n,{callout_key:t.key,click_type:e}),null==o||o()}),[n,t]);let v;var y;e.primary&&(v={...e.primary,onClick:h("primary_cta",null===(y=e.primary)||void 0===y?void 0:y.onClick)});let b;var x;e.secondary&&(b={...e.secondary,onClick:h("secondary_cta",null===(x=e.secondary)||void 0===x?void 0:x.onClick)});let M;var w;e.link&&(M={...e.link,onClick:h("learn_more",null===(w=e.link)||void 0===w?void 0:w.onClick)});return g?(0,S.jsx)(l().Z,{open:!0,preventHideChildrenWhileOpening:!0,onDismiss:f,render:()=>(0,S.jsx)(s().Z,{capture:!0,allowEsc:!0,render:()=>(0,S.jsx)(j,{...e,onDismiss:f,primary:v,secondary:b,link:M})})}):null}},264305:(e,t,n)=>{n.r(t),n.d(t,{DummyModal:()=>d});n(667294);var o=()=>n(714230),i=()=>n(788860),a=()=>n(620770),r=n(785893);function s(e){const{messageKey:t}=e,n={id:"",key:t,type:"static",props:{}};return(0,r.jsx)(a().p,{...e,message:n})}const l=(0,i().vU)({title:{id:"dummyModal.title",defaultMessage:"Dummy Modal"},body:{id:"dummyModal.body",defaultMessage:"This is the body for the dummy modal."},primaryButton:{id:"dummyModal.primaryButton",defaultMessage:"Primary"},secondaryButton:{id:"dummyModal.secondaryButton",defaultMessage:"Secondary"},learnMore:{id:"dummyModal.learnMore",defaultMessage:"Learn More"}});function d(){const e=(0,i().YB)();return(0,r.jsx)(s,{messageKey:"dummy_modal",title:e.formatMessage(l.title),body:e.formatMessage(l.body),imageSrc:o().Z.images.sites.sitesLaunchModalPng,primary:{text:e.formatMessage(l.primaryButton)},secondary:{text:e.formatMessage(l.secondaryButton)},link:{text:e.formatMessage(l.learnMore),external:!0}})}},873175:(e,t,n)=>{n.d(t,{S:()=>l,e:()=>d});n(667294);var o=()=>n(123398),i=()=>n(884749),a=()=>n(602137),r=()=>n(681832),s=n(785893);function l(e){const{onInviteClick:t,onInviteComplete:n,buttonStyle:a,buttonContainerStyle:r}=e;return[{key:"slack_imports",render:()=>(0,s.jsx)(i()._,{inviteOrigin:"space_setting_slack_dropdown",canEditPermission:!0,onInviteClick:t,onInviteComplete:n,buttonLabel:(0,s.jsx)(o().ai,{type:"slack"}),buttonStyle:a,buttonContainerStyle:r}),action:()=>{}},{key:"google_imports",render:()=>(0,s.jsx)(o().ZY,{inviteOrigin:"space_setting_google_dropdown",canEditPermission:!0,onInviteClick:t,onInviteComplete:n,buttonLabel:(0,s.jsx)(o().ai,{type:"google"}),buttonStyle:a,buttonContainerStyle:r}),action:()=>{}}]}function d(e){const{onClickAuthenticated:t,hideChevronIcon:n,containerStyle:i,buttonStyle:l,flowId:d}=e;return[{key:"slack_imports",render:()=>(0,s.jsx)(a().hF,{onClickAuthenticated:()=>t(r().T5.Slack),title:(0,s.jsx)(o().ai,{type:"slack"}),containerStyle:i,buttonStyle:l,from:"share_menu",inviteOrigin:"page_share_modal",flowId:d,loadContacts:!0,hideChevronIcon:n}),action:()=>{}},{key:"google_imports",render:()=>(0,s.jsx)(a().oI,{onClickAuthenticated:()=>t(r().T5.Google),containerStyle:i,buttonStyle:l,from:"share_menu",inviteOrigin:"page_share_modal",flowId:d,loadContacts:!0,hideChevronIcon:n,buttonLabel:(0,s.jsx)(o().ai,{type:"google"})}),action:()=>{}}]}},638445:(e,t,n)=>{n.d(t,{Z:()=>i});class o extends(()=>n(263184))().default{getInitialState(){return{open:!1}}}const i=new o},745624:(e,t,n)=>{n.d(t,{B:()=>r});n(241792),n(667294);var o=()=>n(846550),i=()=>n(668001),a=n(785893);function r(e){let t=Math.floor(e.areaHeight/124);0===t&&(t=1);const n=(0,o().yK)((e=>({skeletonRect:{height:8,borderRadius:4,margin:10,backgroundColor:e.lightDividerColor},skeletonCircle:{display:"flex",width:28,height:28,marginRight:8,backgroundColor:e.lightDividerColor,borderRadius:20},skeletonSection:{display:"flex",width:"100%",margin:20,flexDirection:"row"}})),[8,10,20]),r=[...Array(t)].map(((e,t)=>(0,a.jsxs)("div",{style:n.skeletonSection,children:[(0,a.jsx)(i().Z,{style:n.skeletonCircle}),(0,a.jsxs)("div",{style:{width:"80%"},children:[(0,a.jsx)(i().Z,{style:{width:"80%",...n.skeletonRect,marginTop:0}}),(0,a.jsx)(i().Z,{style:{width:"50%",...n.skeletonRect}}),(0,a.jsx)(i().Z,{style:{width:"60%",...n.skeletonRect}}),(0,a.jsx)(i().Z,{style:{width:"50%",...n.skeletonRect}})]})]},t)));return(0,a.jsx)("div",{children:r})}},326264:(e,t,n)=>{n.d(t,{SZ:()=>b,Zk:()=>h,bf:()=>f,t0:()=>y});n(667294);var o=()=>n(926724),i=()=>n(235605),a=()=>n(788860),r=()=>n(696459),s=()=>n(313351),l=()=>n(942834),d=()=>n(102182),c=()=>n(855238),u=()=>n(876822),m=()=>n(603332),p=n(785893);const g=(0,a().vU)({repliesAndMentions:{id:"pageNotificationSettings.repliesAndMentions.displayName",defaultMessage:"Mentions"},comments:{id:"pageNotificationSettings.comments.displayName",defaultMessage:"Comments"},allUpdates:{id:"pageNotificationSettings.allUpdates.displayName",defaultMessage:"All"},importantUpdates:{id:"pageNotificationSettings.importantUpdates.displayName",defaultMessage:"Important"}});function f(e){switch(e){case"Mentions":return g.repliesAndMentions;case"Comments":return g.comments;case"All":return g.allUpdates;case"Important":return g.importantUpdates;default:return}}function h(e){const{followSettingsKey:t,environment:n,blockStore:i,from:r}=e,s=v({key:"none",selectedKey:t,title:(0,p.jsx)(a()._H,{id:"GetNotifiedDropdown.repliesAndMentions.label",defaultMessage:"Replies and @mentions"}),displayName:g.repliesAndMentions,environment:n,blockStore:i,from:r}),l=v({key:"comments",selectedKey:t,title:(0,p.jsx)(a()._H,{id:"GetNotifiedDropdown.allComments.label",defaultMessage:"All comments"}),displayName:g.comments,environment:n,blockStore:i,from:r}),d=v({key:"all",selectedKey:t,title:(0,p.jsx)(a()._H,{id:"GetNotifiedDropdown.allUpdates.label",defaultMessage:"All updates"}),caption:(0,p.jsx)(a()._H,{id:"GetNotifiedDropdown.simpleAllUpdates.caption",defaultMessage:"All comments and property changes"}),displayName:g.allUpdates,environment:n,blockStore:i,from:r}),c=i.getAssociatedCollectionStore();if(!c)return[l,s];const u=c.getDatabaseType();if(u===o().Ym){return[d,v({key:"important",selectedKey:t,title:(0,p.jsx)(a()._H,{id:"GetNotifiedDropdown.importantUpdatesTasks.label",defaultMessage:"Important updates"}),caption:(0,p.jsx)(a()._H,{id:"GetNotifiedDropdown.importantUpdatesTasks.caption",defaultMessage:"All comments and changes to Status, Assignee, or Due Date"}),displayName:g.importantUpdates,environment:n,blockStore:i,from:r}),s]}if(u===o().wW){return[d,v({key:"important",selectedKey:t,title:(0,p.jsx)(a()._H,{id:"GetNotifiedDropdown.importantUpdatesProjects.label",defaultMessage:"Important updates"}),caption:(0,p.jsx)(a()._H,{id:"GetNotifiedDropdown.importantUpdatesProjects.caption",defaultMessage:"All comments and changes to Status or Date"}),displayName:g.importantUpdates,environment:n,blockStore:i,from:r}),s]}return[d,v({key:"comments",selectedKey:t,title:(0,p.jsx)(a()._H,{id:"GetNotifiedDropdown.onlyCommentsAllComments.label",defaultMessage:"All comments"}),displayName:g.comments,environment:n,blockStore:i,from:r}),s]}function v(e){const{key:t,title:n,caption:o,selectedKey:a,environment:r,blockStore:g,from:f,displayName:h}=e,v=y({key:t,userSelectedKey:a}),b={icon:{width:14,height:14},rightWrapper:o?{alignSelf:"flex-start",paddingTop:2}:{}};return{action:(0,s().cN)({key:t,displayName:h,analyticsName:t,validators:[],closeParentMenu:!0,action:()=>{const{currentUserRootStore:e}=u().default.state;if(e){const{following:n,followSettings:o}=(0,m().Z)(t),i=e.id,s=g.id,c=g.getSpaceId();l().k({environment:r,following:n,followSettings:o,navigableBlockId:s,spaceId:c,userId:i,from:f,key:t,selectedKey:a}),"inbox"!==f&&"more_menu"!==f||d().d4({item:{label:x(t)},undoFunc:()=>{const{following:e,followSettings:n}=(0,m().Z)(a);l().k({environment:r,following:e,followSettings:n,navigableBlockId:s,spaceId:c,userId:i,from:f,key:t,selectedKey:a})}})}},render:e=>(0,p.jsx)(c().Z,{...e,title:n,caption:o,shouldWrapCaption:!0,right:v?(0,i().k)(b.icon):(0,p.jsx)("div",{style:b.icon}),rightStyle:b.right})}),title:n,isSelectedOption:v}}function y(e){const{key:t,userSelectedKey:n}=e;return"important"===n||"comments"===n?"important"===t||"comments"===t:t===n}function b(e){switch(e){case"subscribed":return(0,p.jsx)(a()._H,{id:"GetNotifiedDropdown.followedFeedSettingSuccess.snackbarMessage",defaultMessage:"Followed the feed"});case"unsubscribed":return(0,p.jsx)(a()._H,{id:"GetNotifiedDropdown.unfollowedFeedSettingSuccess.snackbarMessage",defaultMessage:"Unfollowed the feed"});default:(0,r().t1)(e)}}function x(e){switch(e){case"none":return(0,p.jsx)(a()._H,{id:"GetNotifiedDropdown.subscribedRepliesAndMentionsSuccess.snackbarMessage",defaultMessage:"Subscribed to replies and @mentions"});case"comments":return(0,p.jsx)(a()._H,{id:"GetNotifiedDropdown.subscribedAllCommentsSuccess.snackbarMessage",defaultMessage:"Subscribed to all comments"});case"important":return(0,p.jsx)(a()._H,{id:"GetNotifiedDropdown.subscribedImportantUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to important updates"});case"all":return(0,p.jsx)(a()._H,{id:"GetNotifiedDropdown.subscribedAllUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to all updates"});default:(0,r().t1)(e)}}},603332:(e,t,n)=>{n.d(t,{Z:()=>a});var o=()=>n(431143),i=()=>n(696459);function a(e,t){switch(e){case"all":return{following:!0,followSettings:{...(0,o().yI)({explicitly_set_by_user:!0}),feed_setting:t}};case"important":return{following:!0,followSettings:{...(0,o().GC)({explicitly_set_by_user:!0}),feed_setting:t}};case"comments":return{following:!0,followSettings:{...(0,o().r$)({explicitly_set_by_user:!0}),feed_setting:t}};case"none":return{following:!1,followSettings:{...(0,o().vU)({explicitly_set_by_user:!0}),feed_setting:t}};default:(0,i().t1)(e)}}},885607:(e,t,n)=>{n.d(t,{Z:()=>p,v:()=>m});var o=n(667294),i=()=>n(142735),a=()=>n(788860),r=()=>n(231077),s=()=>n(906651),l=()=>n(205228),d=()=>n(876822),c=()=>n(827510),u=n(785893);const m=(0,a().vU)({continueWithGoogle:{id:"notionCalendarLaunchButton.continueWithGoogle",defaultMessage:"Continue with Google"},downloadApp:{id:"notionCalendarLaunchButton.downloadApp",defaultMessage:"Download app"},openCalendar:{id:"notionCalendarLaunchButton.openCalendar",defaultMessage:"Open Calendar"}});const p=function(e){let{style:t,openCalendarFrom:p,continueWithGoogleFrom:g,onOpenCalendarClick:f,onContinueWithGoogleClick:h,onDownloadClick:v}=e;const y=(0,n(219727).O7)(),b=(0,n(846550).yK)((e=>({button:{height:32,marginLeft:8,fontSize:14,whiteSpace:"nowrap",...t},googleLogoIcon:{width:14,height:14,marginRight:8}})),[t]),x=(0,i().VK)((()=>(0,n(909859).tE)()),[]),S=(0,i().VK)((()=>d().default.state.currentSpaceStore&&(0,n(345918).XY)({env:"production",spaceStore:d().default.state.currentSpaceStore})),[]),[{value:M}]=(0,n(801812).r5)((async()=>{var e;return!(null===(e=r().electronApi)||void 0===e||!e.isProtocolRegistered)&&r().electronApi.isProtocolRegistered(l().default.calendar.desktopProtocol)}),[]),w=(0,o.useCallback)((()=>{c().sh({environment:y,spaceStore:void 0,collectionViewStore:void 0,from:p}),null==f||f()}),[y,p,f]),C=(0,o.useCallback)((()=>{const{currentUserSettingsStore:e,currentSpaceStore:t}=d().default.state;e&&t&&(c().sh({environment:y,spaceStore:t,collectionViewStore:void 0,from:g}),null==h||h())}),[y,g,h]),j=(0,o.useCallback)((()=>{n(752127).D({environment:y,url:l().default.calendar.downloadUrl}),null==v||v()}),[y,v]);return y.device.isElectron?M?(0,u.jsx)(s().Z,{style:b.button,onClick:w,children:(0,u.jsx)(a()._H,{...m.openCalendar})}):(0,u.jsx)(s().Z,{style:b.button,onClick:j,children:(0,u.jsx)(a()._H,{...m.downloadApp})}):x||S?(0,u.jsx)(s().Z,{style:b.button,onClick:w,children:(0,u.jsx)(a()._H,{...m.openCalendar})}):(0,u.jsxs)(n(779300).h,{styles:b.button,onClick:C,children:[(0,n(36205).R)(b.googleLogoIcon),(0,u.jsx)(a()._H,{...m.continueWithGoogle})]})}},707165:(e,t,n)=>{n.r(t),n.d(t,{NotionCalendarLaunchModal:()=>R});var o=n(667294),i=()=>n(146947),a=()=>n(219727),r=()=>n(142735),s=()=>n(846550),l=()=>n(782137),d=()=>n(140353),c=()=>n(323218),u=()=>n(788860),m=()=>n(707513),p=()=>n(880026),g=()=>n(752127),f=()=>n(423402),h=()=>n(666414),v=()=>n(729775),y=()=>n(906651),b=()=>n(67961),x=()=>n(255453),S=()=>n(205228),M=()=>n(916095),w=()=>n(148126),C=()=>n(803728),j=()=>n(110372),k=()=>n(738740),T=()=>n(876822),I=()=>n(660293),_=()=>n(827510),P=()=>n(942625),Z=()=>n(885607),A=n(785893);function R(){const e=(0,a().O7)(),t=(0,s().yK)((e=>({container:{maxWidth:442},closeButton:{position:"absolute",top:12,right:12,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.outlineButtonPressedBackground,width:18,height:18},closeButtonHovered:{background:e.outlineButtonPressedBackground},content:{padding:24,display:"flex",flexDirection:"column"},title:{fontWeight:m().Ue.bold,fontSize:25,display:"flex",marginBottom:6},divider:{backgroundColor:e.tableLightDividerColor,opacity:.5},footer:{padding:"20px 24px",display:"flex",alignItems:"center",justifyContent:"space-between"},learnMoreLink:{display:"flex",alignItems:"center",fontSize:12,color:e.mediumTextColor,padding:"0 4px",marginLeft:-4},inlineLearnMoreLink:{display:"inline-flex",fontSize:"inherit",marginLeft:0,padding:0},externalLinkIcon:{width:14,height:14,marginLeft:2},inlineExternalLinkIcon:{width:16,height:16},successCheckmark:{width:50,height:50,display:"flex",alignItems:"center",justifyContent:"center"},successCheckmarkIcon:{width:32,height:32,color:e.mediumTextColor},successTitle:{fontSize:25,fontWeight:m().Ue.bold,margin:"8px 0"},downloadContainer:{display:"flex",padding:"16px 20px",marginTop:28,borderRadius:12,background:e.cardBackground},downloadContent:{display:"flex",flexDirection:"column",paddingRight:8},downloadTitle:{fontSize:16,fontWeight:m().Ue.semibold,marginBottom:4},downloadButtonContainer:{display:"flex"},downloadButton:{height:32,marginTop:12},notionCalendarLogo:{display:"flex",alignSelf:"end"},notionCalendarLogoIcon:{width:56,height:58}})),[]);(0,o.useEffect)((()=>{const t=()=>{I().Z.state.isVisible&&P().Z.state.isConnectingCalendar&&(P().Z.setState({isConnectingCalendar:!1}),f().pJ({environment:e}))};return I().Z.addListener(t),()=>{I().Z.removeListener(t)}}),[e]);const n=(0,r().VK)((()=>P().Z.state.signupCtaAttribution||"onboardingModalSignIn"),[]),R=(0,o.useCallback)((()=>{const{currentUserSettingsStore:t}=T().default.state;t&&(j().bl(e,{callout_key:"notion_calendar_launch_promo",dismiss_type:"modal_dismiss_clicked"}),C().Gi(e,"notion_calendar_launch_promo"),_().tE({environment:e,userSettingsStore:t}),P().Z.setState({signupCtaAttribution:void 0}))}),[e]),L=(0,o.useCallback)((()=>{const{currentUserSettingsStore:t,currentSpaceStore:n}=T().default.state;t&&n&&(j().lZ(e,{callout_key:"notion_calendar_launch_promo",click_type:"primary_cta"}),C().Gi(e,"notion_calendar_launch_promo"),_().WS(e,{phase:"dismissed_completely",transactionUserAction:"NotionCalendarLaunchModal.openCalendar",userSettingsStore:t}))}),[e]),D=(0,o.useCallback)((()=>{const{currentUserSettingsStore:t,currentSpaceStore:n}=T().default.state;t&&n&&(j().lZ(e,{callout_key:"notion_calendar_launch_promo",click_type:"secondary_cta"}),C().Gi(e,"notion_calendar_launch_promo"),_().WS(e,{phase:"dismissed_completely",transactionUserAction:"NotionCalendarLaunchModal.existingNotionCalendarUser",userSettingsStore:t}),_().sh({environment:e,spaceStore:n,collectionViewStore:void 0,from:"onboardingModalExistingUser"}))}),[e]),V=(0,o.useCallback)((()=>{const{currentUserSettingsStore:t,currentSpaceStore:n}=T().default.state;t&&n&&(j().lZ(e,{callout_key:"notion_calendar_launch_promo",click_type:"primary_cta"}),e.device.isElectron&&C().Gi(e,"notion_calendar_launch_promo"),_().WS(e,{phase:"connected_notion_calendar",transactionUserAction:"NotionCalendarLaunchModal.continueWithGoogle",userSettingsStore:t}))}),[e]),O=(0,o.useCallback)((()=>{const{currentUserSettingsStore:t}=T().default.state;t&&(j().lZ(e,{callout_key:"notion_calendar_launch_promo",click_type:"primary_cta"}),C().Gi(e,"notion_calendar_launch_promo"),_().WS(e,{phase:"dismissed_completely",transactionUserAction:"NotionCalendarLaunchModal.clickDownload",userSettingsStore:t}))}),[e]),U=(0,r().VK)((()=>T().default.state.currentUserSettingsStore),[]),N=(0,r().VK)((()=>{const e=null==U?void 0:U.getSettings();return null==e?void 0:e.notion_calendar_launch_modal_phase}),[U]),F=()=>(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(M().U4,{onClick:R}),(0,A.jsxs)("div",{style:t.content,children:[(0,A.jsx)("div",{style:t.successCheckmark,children:(0,l().e)(t.successCheckmarkIcon)}),(0,A.jsx)("div",{style:t.successTitle,children:(0,A.jsx)(u()._H,{defaultMessage:"Success!",id:"notionCalendarLaunchModal.successTitle"})}),(0,A.jsx)(b().Z,{isSecondaryColor:!0,isMultiline:!0,children:(0,A.jsx)(u()._H,{defaultMessage:"You can now view Notion docs, projects, tasks, and timelines alongside calendar events on Notion Calendar",id:"notionCalendarLaunchModal.successCaption"})}),(0,A.jsxs)("div",{style:t.downloadContainer,children:[(0,A.jsxs)("div",{style:t.downloadContent,children:[(0,A.jsx)("div",{style:t.downloadTitle,children:(0,A.jsx)(u()._H,{defaultMessage:"Get the desktop app",id:"notionCalendarLaunchModal.downloadTitle"})}),(0,A.jsx)(b().Z,{isSecondaryColor:!0,isMultiline:!0,children:(0,A.jsx)(u()._H,{defaultMessage:"See notifications, view your schedule, and join meetings from anywhere",id:"notionCalendarLaunchModal.downloadCaption"})}),(0,A.jsx)("div",{style:t.downloadButtonContainer,children:(0,A.jsx)(y().Z,{style:t.downloadButton,onClick:()=>{p().G(e,{cta:"download"}),g().D({environment:e,url:S().default.calendar.downloadUrl}),O()},children:(0,A.jsx)(u()._H,{...Z().v.downloadApp})})})]}),(0,A.jsx)("div",{style:t.notionCalendarLogo,children:(0,d().D)(t.notionCalendarLogoIcon)})]})]})]}),H=()=>(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(x().Z,{src:"https://player.vimeo.com/video/900939588?h=187435ef3c",defaultTextTrack:x().W[i().locale]||"en",options:{muted:!0,autoplay:!0,loop:!0,background:!0,playsinline:!0}}),(0,A.jsx)(M().U4,{style:t.closeButton,hoveredStyle:t.closeButtonHovered,onClick:R}),(0,A.jsxs)("div",{style:t.content,children:[(0,A.jsx)("div",{style:t.title,children:(0,A.jsx)(u()._H,{defaultMessage:"Meet Notion Calendar",id:"notionCalendarLaunchModal.title"})}),(0,A.jsxs)(b().Z,{isSecondaryColor:!0,isMultiline:!0,children:[(0,A.jsx)(u()._H,{defaultMessage:"The beautifully designed calendar for your life and work. Integrated and synced with all your Google Calendar events.",id:"notionCalendarLaunchModal.caption"})," ",(0,A.jsxs)(v().Z,{external:!0,href:(0,w().UY)("blog.notionCalendarLaunch"),style:{...t.learnMoreLink,...t.inlineLearnMoreLink},children:[(0,A.jsx)(u()._H,{defaultMessage:"Learn more",id:"notionCalendarLaunchModal.learnMore"}),(0,c().g)({...t.externalLinkIcon,...t.inlineExternalLinkIcon})]})]})]}),(0,A.jsx)(h().Z,{size:1,style:t.divider}),(0,A.jsxs)("div",{style:t.footer,children:[(0,A.jsx)(v().Z,{external:!0,onClick:D,style:t.learnMoreLink,children:(0,A.jsx)(u()._H,{defaultMessage:"I already use Notion Calendar",id:"notionCalendarLaunchModal.alreadyUseNotionCalendar"})}),(0,A.jsx)(Z().Z,{openCalendarFrom:"onboardingModalOpenCalendar",continueWithGoogleFrom:n,onOpenCalendarClick:()=>{p().Et(e,{cta:"open_calendar"}),L()},onContinueWithGoogleClick:()=>{p().Et(e,{cta:"continue_with_google"}),V()},onDownloadClick:()=>{p().Et(e,{cta:"download"}),O()}})]})]});return(0,A.jsx)(k().k,{messageKey:"notion_calendar_launch_promo",desktopRenderInner:()=>(0,A.jsx)(B,{launchModalPhase:N,renderChild:()=>"connected_notion_calendar"===N?F():H()}),desktopInnerStyle:t.container,desktopOnDismiss:R,phoneRenderInner:()=>null})}function B(e){let{launchModalPhase:t,renderChild:n}=e;const i=(0,a().O7)();return(0,o.useEffect)((()=>{"connected_notion_calendar"===t?p().Wy(i):p().QL(i)}),[i,t]),n()}},707235:(e,t,n)=>{n.r(t),n.d(t,{createRelationViewsModule:()=>p});var o=()=>n(226413),i=()=>n(956057),a=()=>n(396136),r=()=>n(139978),s=()=>n(543172),l=()=>n(332542),d=()=>n(636340),c=()=>n(269299),u=()=>n(487270),m=()=>n(826955);function p(e){const{environment:t,layoutStore:n,collectionStore:p,relationPropertyId:g}=e,f=p.getSchema(),h=g?f[g]:void 0;if(!h||!(0,o().p_)(h))return;const v=h.collection_pointer;if(!v)return;const y=h.property;if(!y)return;const b=m().NW.createChildStore(p,v);if(!b)return;const x=b.getParentBlockStore();if(!x)return;const{performResult:S}=c().createAndCommit({environment:t,perform:e=>{const{inMemoryRecordCache:o}=x,m=d().j4({environment:t,type:"collection_view",inMemoryRecordCache:o,transaction:e}),p=x.getSpaceId(),g=(0,s().ZP)(),f=(0,u().$x)({environment:t,table:r().np,spaceId:p}).id,v=m.pointer,S={id:f,type:"table",parent_id:v.id,parent_table:a().iU,space_id:p,alive:!0,name:h.name,format:{collection_pointer:b.pointer,property_filters:[{id:i().Il(),filter:{property:y,filter:{operator:"relation_contains",value:{type:"relative",value:{type:"current_page_in_related_collection"}}}}}],subitem_display_mode:"disabled",hide_linked_collection_name:!0}};c().applyOperation({store:m,operation:{pointer:m.pointer,path:["view_ids"],command:"listAfter",args:{id:f}},transaction:e}),l().jG({childStore:m,parentStore:n,transaction:e}),d().ae({environment:t,table:r().np,value:S,inMemoryRecordCache:o,transaction:e});return{id:g,type:"views",collection_view_block_pointer:{...v,spaceId:p}}},canUndo:!0,userAction:"viewsModuleActions.createRelationViewsModule"});return S}},905865:(e,t,n)=>{n.r(t),n.d(t,{PageLayoutEditor:()=>eo});var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(846550),s=()=>n(696459),l=()=>n(628370),d=()=>n(842574),c=()=>n(439320),u=()=>n(251932),m=()=>n(949842),p=()=>n(520849),g=()=>n(655260),f=()=>n(893695),h=()=>n(267553),v=()=>n(367933),y=()=>n(26796),b=()=>n(714230),x=()=>n(109477),S=()=>n(305580),M=()=>n(409873),w=()=>n(788860),C=()=>n(707513),j=()=>n(593515),k=()=>n(421654),T=()=>n(269299),I=()=>n(411094),_=()=>n(18748),P=()=>n(471645),Z=()=>n(654133),A=()=>n(259098),R=()=>n(706003),B=()=>n(677559),L=()=>n(466970),D=()=>n(998901);const V={switchFromSimpleToTabbedLayoutActions:new(B().Ss)("switchFromSimpleToTabbedLayoutActions",(async()=>n.e(23656).then(n.bind(n,588533)))),switchFromTabbedToSimpleLayoutActions:new(B().Ss)("switchFromTabbedToSimpleLayoutActions",(async()=>n.e(40284).then(n.bind(n,238198)))),createRelationViewsModuleActions:new(B().Ss)("createRelationViewsModuleActinos",(async()=>Promise.resolve().then(n.bind(n,707235)))),deleteViewsModuleDependenciesActions:new(B().Ss)("deleteViewsModuleDependenciesActions",(async()=>Promise.resolve().then(n.bind(n,772669))))};n(670560),n(241792);var O=()=>n(226413),U=()=>n(766933),N=()=>n(827282),F=n(785893);const H=(0,N().IU)("propertyText",{viewBox:"0 0 26 17",svg:(0,F.jsx)("path",{d:"M0.066 16V15.296L1.342 14.79L6.688 1.282L7.436 1.172L8.206 0.952L13.266 14.79L14.762 15.274V16H9.108V15.274L10.978 14.768L9.636 10.918H4.268L2.992 14.504L5.104 15.274V16H0.066ZM6.974 3.372L4.752 9.598H9.174L6.996 3.372H6.974ZM18.5422 16.33C17.3762 16.33 15.9022 15.516 15.9022 13.756C15.9022 11.996 17.1782 11.204 19.4442 10.61L21.7102 10.016V8.872C21.6662 7.178 20.7862 6.298 19.6202 6.298C18.9602 6.298 18.4102 6.584 18.2342 6.694L18.1462 8.872C18.1462 8.872 17.5962 8.938 17.2662 8.938C16.5622 8.938 16.2102 8.586 16.2102 7.992C16.2102 6.98 18.1462 5.374 20.4122 5.374C22.6342 5.374 23.6022 6.386 23.6022 8.564V14.504C23.6022 14.944 23.7122 15.098 24.3282 15.098H25.4282V15.714C25.4282 15.714 24.1522 16.264 23.3382 16.264C22.2162 16.264 21.7542 15.494 21.7542 14.548H21.6882C20.4562 15.714 19.9282 16.33 18.5422 16.33ZM19.7082 14.834C20.7642 14.834 21.4462 14.042 21.7102 13.646V10.742L19.5982 11.446C18.5642 11.798 17.9042 12.216 17.9042 13.14C17.9042 14.262 18.7622 14.834 19.7082 14.834Z"})});var K=()=>n(899548),E=()=>n(827973),W=()=>n(740046),z=()=>n(255577),G=()=>n(388284),q=()=>n(125659),Y=()=>n(561933),$=()=>n(162178),J=()=>n(712185),Q=()=>n(543172),X=()=>n(99537);function ee(e){const{propertyId:t,propertyType:n,environment:o,transaction:i,layoutStore:a,collectionStore:r,currentModuleSelection:s,sessionId:l,isPropertyCreation:d}=e,c=a.getModel(),u=r.getModel();if(!c||!u||"new_module"!==(null==s?void 0:s.type))return;const m={id:(0,Q().ZP)(),type:"property",propertyId:t,style:"expanded"};if("person"===n||"created_by"===n||"last_edited_by"===n?m.config={property_person:{style:"compact"}}:"number"===n&&(m.config={property_number:{style:"large"}}),"form_conditional_modules"===s.area)return;const p=(0,J().bf)({collectionModel:u,module:m});return(0,X().sW)({environment:o,transaction:i,layoutStore:a,position:"views_main_tab_modules"===s.area?{type:"area_relative",area:s.area,viewId:s.viewsMainTabId,location:"end_moveable"}:{type:"area_relative",area:s.area,location:"end_moveable"},module:p,sessionId:l,isPropertyCreation:d}),m}function te(){const e=(0,i().O7)(),{layoutStore:t,currentModuleSelection:a,setModuleSelection:r,sessionId:s}=(0,$().J9)(),{collectionStore:l}=(0,$().PP)();return(0,o.useCallback)((o=>{let{propertyType:i,isPropertyCreation:d}=o;const{performResult:c}=T().createAndCommit({userAction:"AddPageLayoutModuleEditorSidebar.handleCreateNewStandardProperty",environment:e,canUndo:!0,perform:o=>{const r=t.getModel(),c=l.getModel();if(!r||!c||"new_module"!==(null==a?void 0:a.type))return;return ee({propertyId:n(984871).G3({environment:e,collectionStore:l,collectionViewArgs:void 0,propertyName:Y().SO[i],propertyType:i,transaction:o}),propertyType:i,environment:e,transaction:o,layoutStore:t,collectionStore:l,currentModuleSelection:a,sessionId:s,isPropertyCreation:d})}});c&&r({type:"existing_module",moduleId:c.id,isDragging:!1})}),[e,r,t,l,a,s])}function ne(){const e=(0,i().O7)(),{layoutStore:t,currentModuleSelection:n,setModuleSelection:a,sessionId:r}=(0,$().J9)(),{collectionStore:s}=(0,$().PP)();return(0,o.useCallback)((o=>{const{propertyId:i,propertyType:l}=o,{performResult:d}=T().createAndCommit({userAction:"AddPageLayoutModuleEditorSidebar.AddPropertyAsNewModule",environment:e,canUndo:!0,perform:o=>ee({propertyId:i,propertyType:l,environment:e,transaction:o,layoutStore:t,collectionStore:s,currentModuleSelection:n,sessionId:r,isPropertyCreation:!1})});return d?(a({type:"existing_module",moduleId:d.id,isDragging:!1}),d):null}),[e,a,t,s,n,r])}n(122556),n(582845),n(250570),n(533019),n(721473),n(788208),n(22624),n(267602),n(653476);var oe=()=>n(532850),ie=()=>n(639708),ae=()=>n(579012);function re(e){return void 0!==e[1]}function se(e){let{propertySortPriority:t,defaultCount:i,moreButtonStyle:r,moreButtonTitleStyle:l,isSearching:d}=e;const{layoutStore:c}=(0,$().J9)(),{collectionStore:u}=(0,$().PP)(),m=(0,ae().K)(),p=(0,a().VK)((()=>{const e=c.getModules();return new Set((0,n(318220).i)(e).filter(ie().f).map((e=>e.propertyId)))}),[c]),[g,f]=o.useState(!1);return(0,a().VK)((()=>{const e=u.getSchema();if(!c.getModel())return[];const o=(0,s().qP)(e).filter(re).sort(((e,n)=>{const o=e[1],i=n[1];return(t[o.type]??1/0)-(t[i.type]??1/0)})).map((e=>{let[t,o]=e;if(t!==O().iw&&!p.has(t))return(0,O().U8)(o)?{id:(0,Q().ZP)(),type:`property_${o.type}`,propertyId:t,style:"compact"}:(0,O().G$)(o)?{id:(0,Q().ZP)(),type:`property_${o.type}`,propertyId:t,style:"large"}:"formula"===o.type?{id:(0,Q().ZP)(),type:`property_${o.type}`,propertyId:t,style:(0,n(834458).isNumberFormulaPropertySchema)(o)?"large":"small"}:"file"===o.type?{id:(0,Q().ZP)(),type:`property_${o.type}`,propertyId:t,style:"landscape"}:{id:(0,Q().ZP)(),type:`property_${o.type}`,propertyId:t}})).filter(s().$K).map((t=>{const o=(0,oe().Qm)({schema:e,property:t.propertyId});if(o)return{key:t.id,keywords:[o.name,Y().SO[o.type]],render:e=>{let{ref:o,...i}=e;return(0,F.jsx)(n(204927).R,{...i,propertyId:t.propertyId})},action:()=>{m({layoutModule:t})}}})).filter(s().$K),a={keywords:[],key:"use-existing-property-show-more",render:e=>(0,F.jsx)(E().Z,{...e,buttonStyle:r,desktopTitleStyle:l,title:g?(0,F.jsx)(w()._H,{defaultMessage:"Less",id:"layoutBuilderProperties.less.buttonTitle"}):(0,F.jsx)(w()._H,{defaultMessage:"More",id:"layoutBuilderProperties.more.buttonTitle"})}),action:()=>f((e=>!e))};return o.length>i&&!d?[...g?o:o.slice(0,i),a]:o}),[m,u,c,p,t,i,g,r,l,d])}var le=()=>n(72766);function de(e){const{propertyId:t}=e,{collectionStore:n}=(0,$().PP)(),o=(0,r().Fg)(),i=(0,a().VK)((()=>{const e=n.getSchema();return(0,oe().Qm)({schema:e,property:t})}),[n,t]);return i?(0,F.jsx)(le().z,{...e,icon:(0,F.jsx)(U().ZP,{size:16,theme:o,icon:i.icon,type:i.type}),name:i.name}):null}function ce(){const{layoutStore:e,currentModuleSelection:t}=(0,$().J9)(),{collectionStore:r}=(0,$().PP)(),l=(0,L().E)("collection_view_module"),d=(0,i().O7)(),c=(0,ae().K)(),u=(0,o.useCallback)((t=>{const o=(0,n(707235).createRelationViewsModule)({environment:d,collectionStore:r,relationPropertyId:t,layoutStore:e});o&&c({layoutModule:o})}),[c,r,e,d]),m=(0,a().VK)((()=>"new_module"===(null==t?void 0:t.type)&&"page_details"===t.area),[t]);return(0,a().VK)((()=>{if(!l||m)return[];const t=r.getSchema();if(!e.getModel())return[];return Object.keys(t).filter((e=>{const n=null==t?void 0:t[e];return n&&(0,O().p_)(n)&&(0,s().$K)(n.property)})).map((e=>{const n=(0,oe().Qm)({schema:t,property:e});if(n)return{key:e,keywords:[n.name],render:t=>{let{ref:n,...o}=t;return(0,F.jsx)(de,{...o,propertyId:e})},action:()=>{u(e)}}})).filter(s().$K)}),[l,m,r,e,u])}const ue=(0,w().vU)({addToPage:{id:"AddPageLayoutModuleEditorSidebar.addToPage",defaultMessage:"Add to page"},addToPanel:{id:"AddPageLayoutModuleEditorSidebar.addToPanel",defaultMessage:"Add to panel"},suggestedModulesSectionTitle:{defaultMessage:"Suggested",id:"AddPageLayoutModuleEditorSidebar.suggestedModulesSectionTitle"},existingPropertiesSectionTitle:{defaultMessage:"Use an existing property",id:"AddPageLayoutModuleEditorSidebar.existingPropertiesSectionTitle"},relatedCollectionPropertiesSectionTitle:{defaultMessage:"Add a database view",id:"AddPageLayoutModuleEditorSidebar.relatedCollectionPropertiesSectionTitle"},createNewPropertyModuleSectionTitle:{defaultMessage:"Create new property",id:"AddPageLayoutModuleEditorSidebar.createNewPropertyModuleSectionTitle"},closeAddModulesMenu:{defaultMessage:"Close add modules menu",id:"AddPageLayoutModuleEditorSidebar.closeAddModulesMenu"},searchInputPlaceholder:{defaultMessage:"Search...",id:"AddPageLayoutModuleEditorSidebar.searchInputPlaceholder"},propertyFileCaption:{id:"AddPageLayoutModuleButton.tooltip.files.caption",defaultMessage:"Add images, videos, or files"},propertyAiSummaryCaption:{id:"AddPageLayoutModuleButton.tooltip.aiSummary.caption",defaultMessage:"Use AI to summarize the page"},propertyPersonCaption:{id:"AddPageLayoutModuleButton.tooltip.person.caption",defaultMessage:"Add anyone in your workspace"},propertyTextCaption:{id:"AddPageLayoutModuleButton.tooltip.text.caption",defaultMessage:"Just start writing with plain text"},propertyNumberCaption:{id:"AddPageLayoutModuleButton.tooltip.number.caption",defaultMessage:"Display numbers with rings or bars"}}),me={file:{icon:b().Z.images.layouts.configuration.propertyFilesMediaPreviewJpg,tooltip:{image:b().Z.images.layouts.configuration.propertyFilesMediaPreviewLargePng,caption:ue.propertyFileCaption}},ai_summary:{icon:b().Z.images.layouts.configuration.propertyAiSummaryPreviewPng,tooltip:{image:b().Z.images.layouts.configuration.propertyAiSummaryPreviewLargePng,caption:ue.propertyAiSummaryCaption}},person:{icon:b().Z.images.layouts.configuration.propertyPersonPreviewPng,tooltip:{image:b().Z.images.layouts.configuration.propertyPersonPreviewLargePng,caption:ue.propertyPersonCaption}},text:{icon:H,tooltip:{image:b().Z.images.tooltips.blocks.textPng,caption:ue.propertyTextCaption}},number:{icon:b().Z.images.layouts.configuration.propertyNumberPreviewPng,tooltip:{image:b().Z.images.layouts.configuration.propertyNumberPreviewLargePng,caption:ue.propertyNumberCaption}}},pe={file:1,ai_summary:2,number:3,text:4,person:5},ge=o.memo((function(){const e=(0,i().O7)(),t=(0,r().Fg)(),s=(0,w().YB)(),{currentModuleSelection:l,isPropertyTypeSearchInputDirtyStore:d}=(0,$().J9)(),c=(0,q().Y$)(),m="new_module"===(null==l?void 0:l.type)&&"page_details"===l.area,p=(0,a().VK)((()=>[...(0,Y().TP)({collectionContextStore:c,environment:e}),"ai_summary"].sort(((e,t)=>(pe[e]??1/0)-(pe[t]??1/0)))),[c,e]),g=ce(),[f,h]=(0,o.useState)(!1),[v,y]=(0,o.useState)(),b=(0,o.useCallback)((e=>{d.setState(!0),y(e.target.value)}),[d]);o.useEffect((()=>()=>{d.setState(!1)}),[d]);const x=te(),S=ne(),M=(0,o.useMemo)((()=>({actionHandler:e=>x({propertyType:e,isPropertyCreation:!0}),tooltip:e=>{const t=me[e];return null==t?void 0:t.tooltip},renderIcon:e=>{const n=me[e],o="dark"===t.mode&&null!=n&&n.darkModeIcon?null==n?void 0:n.darkModeIcon:null==n?void 0:n.icon;return o&&"string"!=typeof o?o({width:20,fill:"light"===t.mode?"rgba(79, 79, 79, 1)":(0,U().RE)(t)}):(0,F.jsx)(U().ZP,{size:o?36:16,theme:t,type:e,icon:o,style:{fill:(0,O().XU)(e)?t.aiPurpleColor:void 0}})},propertySettingsPopupProps:e=>"relation"!==e?null:{settingsViewToOpen:{property:void 0,type:"selectRelationSource",formatKey:"page_view_properties"},isPropertyEditComplete:e=>Boolean((0,O().p_)(e)&&e.collection_id),onPropertyEditComplete:t=>{S({propertyId:t,propertyType:e})},rollbackIfEditIncomplete:!0}})),[x,t,S]),j=(0,n(285645).c)(M),k=(0,r().yK)((e=>({sidebarHeading:{fontSize:16,lineHeight:"24px",fontWeight:C().Ue.medium,marginLeft:8,paddingBottom:2},closeButton:{marginLeft:"auto",marginRight:4},searchInputContainer:{marginTop:8,marginBottom:14,marginLeft:6},searchInput:{background:e.contentBackground},searchInputIcon:{fill:e.mediumIconColor,width:10},moreButton:{marginLeft:0},moreButtonTitle:{margin:0,color:e.lightTextColor,fontSize:12,padding:"0 0 0 6px"},sectionTitle:{padding:"0 0 0 6px"}})),[]),T=(0,a().VK)((()=>{const e=v||f,t={keywords:[],key:"create-new-property-more",render:e=>(0,F.jsx)(E().Z,{...e,buttonStyle:k.moreButton,desktopTitleStyle:k.moreButtonTitle,title:f?(0,F.jsx)(w()._H,{defaultMessage:"Less",id:"layoutBuilderProperties.less.buttonTitle"}):(0,F.jsx)(w()._H,{defaultMessage:"More",id:"layoutBuilderProperties.more.buttonTitle"})}),action:()=>h((e=>!e))};return[...p.slice(0,e?void 0:5).map(j),...v?[]:[t]]}),[p,f,j,v,k.moreButton,k.moreButtonTitle]),I=se({propertySortPriority:pe,defaultCount:4,moreButtonStyle:k.moreButton,moreButtonTitleStyle:k.moreButtonTitle,isSearching:Boolean(v)}),_=(0,o.useMemo)((()=>{const e=[];return I.length>0&&e.push({key:"existing-properties",render:e=>(0,F.jsx)(G().Z,{title:s.formatMessage(ue.existingPropertiesSectionTitle),desktopTitleStyle:k.sectionTitle,...e}),items:I}),e.push({key:"create-new-properties",render:e=>(0,F.jsx)(G().Z,{title:s.formatMessage(ue.createNewPropertyModuleSectionTitle),desktopTitleStyle:k.sectionTitle,...e}),items:T}),g.length>0&&e.push({key:"related-collection-properties",render:e=>(0,F.jsx)(G().Z,{title:s.formatMessage(ue.relatedCollectionPropertiesSectionTitle),desktopTitleStyle:k.sectionTitle,...e}),items:g}),e}),[T,I,s,g,k.sectionTitle]);return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(u().gq,{style:k.sidebarHeading,alignItems:"center",children:(0,F.jsx)(w()._H,{...m?ue.addToPanel:ue.addToPage})}),(0,F.jsx)(W().ZP,{focusInitial:!0,onChange:b,placeholder:s.formatMessage(ue.searchInputPlaceholder),showClearButton:!0,value:v||"",style:k.searchInputContainer,inputOuterStyle:k.searchInput,inputLeft:(0,K().R)(k.searchInputIcon),itemMarginLeft:0}),(0,F.jsx)(n(320123).f,{filterQuery:v,initialFocus:0,type:z().iW.Vertical,sections:_})]})}));var fe=()=>n(844650),he=(n(30005),()=>n(293836)),ve=()=>n(177610),ye=()=>n(763058),be=(n(749411),n.n(n(443261))),xe=()=>n(263184),Se=()=>n(565630),Me=()=>n(509917),we=()=>n(328939),Ce=()=>n(275200);function je(e){const{propertyGroups:t,propertyIdsToExclude:n,mergedPropertiesMap:r}=e,s=o.useMemo((()=>xe().default.createValue("")),[]),[l,d]=o.useState([]),[c,u]=o.useState({}),[m,p]=o.useState(null),g=o.useMemo((()=>{let e=t?t.flatMap((e=>e.propertyIds||[])):Object.keys(r);return n&&(e=e.filter((e=>!n.has(e)))),e}),[r,t,n]),f=(0,a().Kw)(s),h=(0,Se().Kt)(f,100,((e,t)=>e===t));o.useEffect((()=>{const e=[],t={};if(""!==h)for(const n of g){const o=r[n];o&&null!==be().match(h,o.name)&&(e.push(n),t[n]=e.length-1)}(l.length!==e.length||e.some(((e,t)=>e!==l[t])))&&(d(e),u(t))}),[g,l,h,r]),o.useEffect((()=>{if(0===l.length)return void p(null);const e=null!==m?l[m]:null;e&&void 0!==c[e]?p(c[e]):p(0)}),[m,l,c]);const v=(0,i().O7)(),y=null!==m?l[m]:null;return o.useEffect((()=>{const e=document.getElementsByClassName(Me().qp).item(0);e&&!(0,we().G)({element:e})&&(0,Ce().Oc)({el:e,environment:v,windowHeight:window.innerHeight,minEdgeDist:16})}),[v,y]),{searchInputValueStore:s,searchMatchesMap:c,searchMatches:l,activeSearchMatchIndex:m,moveToNextSearchMatch:()=>{if(null===m||l.length<=1)return;const e=m+1;p(e<=l.length-1?e:0)},moveToPreviousSearchMatch:()=>{if(null===m||l.length<=1)return;const e=m-1;p(e>=0?e:l.length-1)}}}var ke=()=>n(686929);function Te(e){let{propertyGroupId:t,pagePropertiesStore:n}=e;const{collectionStore:o}=(0,$().PP)(),i=(0,r().yK)((e=>({button:{color:e.text.secondary,paddingLeft:8,height:34},buttonIcon:{fill:e.icon.secondary,marginRight:8}})),[]);return(0,F.jsx)(ke().le,{style:i.button,iconStyle:i.buttonIcon,collectionStore:o,isInPeekRenderer:!1,propertyGroupId:t,pagePropertiesStore:n})}const Ie=o.memo(Te);n(821057);var _e=()=>n(682890),Pe=()=>n(214993),Ze=()=>n(957744),Ae=()=>n(95886),Re=()=>n(955620),Be=()=>n(513670),Le=()=>n(265640),De=()=>n(448419),Ve=()=>n(9641),Oe=()=>n(206352),Ue=()=>n(291198),Ne=()=>n(198829),Fe=()=>n(967092),He=()=>n(906651),Ke=()=>n(352230),Ee=()=>n(529048),We=()=>n(170075);class ze extends xe().default{getInitialState(){return{}}isRenameInputForcedOpenForGroup(e){var t;return(null===(t=this.getState())||void 0===t?void 0:t.forceOpenRenameInputForGroupId)===e}resetForceRenameInputOpen(){const e=this.getState();return this.setState({...e,forceOpenRenameInputForGroupId:void 0})}}const Ge=new ze;function qe(e){const{title:t,propertyGroupId:n,isFirstPropertyGroup:s,isLastPropertyGroup:l,styles:d}=e,c=(0,a().qz)(void 0,Ee().Z),u=(0,a().VK)((()=>Ge.isRenameInputForcedOpenForGroup(n)),[n]),[m,p]=(0,o.useState)(u);(0,o.useEffect)((()=>{c.setState({...c.state,open:u})}),[c,u]);const g=(0,o.useCallback)((()=>{p(!1),Ge.resetForceRenameInputOpen()}),[]),f=function(){const{collectionStore:e}=(0,$().PP)(),t=(0,i().O7)();return(0,o.useCallback)((n=>{T().createAndCommit({environment:t,perform(t){(0,We().Xh)({collectionStore:e,groupId:n,transaction:t})},canUndo:!0,userAction:"ConfigurePropertyGroupModuleGroupHeading.deleteCollectionPropertyGroup"})}),[e,t])}(),h=function(){const{collectionStore:e}=(0,$().PP)(),t=(0,i().O7)();return(0,o.useCallback)((n=>{T().createAndCommit({environment:t,perform(t){(0,We().CE)({collectionStore:e,groupId:n,transaction:t})},canUndo:!0,userAction:"ConfigurePropertyGroupModuleGroupHeading.deleteCollectionPropertyGroup"})}),[e,t])}(),v=function(){const{collectionStore:e}=(0,$().PP)(),t=(0,i().O7)();return(0,o.useCallback)((n=>{T().createAndCommit({environment:t,perform(t){(0,We().D_)({collectionStore:e,groupId:n,transaction:t})},canUndo:!0,userAction:"ConfigurePropertyGroupModuleGroupHeading.deleteCollectionPropertyGroup"})}),[e,t])}(),y=(0,r().yK)((e=>({container:{display:"flex",alignItems:"center",padding:"0 2px",...(null==d?void 0:d.container)||{}},titleContainer:{display:"flex",alignItems:"center",marginRight:"auto",paddingLeft:5,borderRadius:4,height:"auto",width:"100%"},label:{fontSize:"12px",lineHeight:"24px",color:e.mediumTextColor,fontWeight:500,padding:"0 8px 0 5px",display:"block",...C().Yu},menuIcon:{width:16,height:16},dragIcon:{fill:e.icon.secondary}})),[d]);return(0,F.jsx)("div",{style:y.container,children:(0,F.jsx)(De().ZP,{style:{width:268},onClose:g,popupType:Fe().kQ.Popup,renderOrigin:e=>(0,F.jsxs)(Le().D,{...e,style:y.titleContainer,children:[(0,F.jsx)(Ve().Z,{iconSize:12,iconStyle:y.dragIcon}),(0,F.jsx)("div",{style:y.label,children:t})]}),buttonPopupStore:c,alignmentToOrigin:D().Alignment.Start,render:e=>{return m?(0,F.jsx)(Ye,{propertyGroupId:n,value:t||"",afterSubmit:e.close}):(0,F.jsx)(Ne().Z,{menuType:Ke().o.Popup,children:(0,F.jsx)(z().ZP,{type:z().iW.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,F.jsx)(G().Z,{...e}),items:(o=e.close,(0,Be().oA)([{key:"rename",render:e=>(0,F.jsx)(E().Z,{...e,icon:(0,Ze().E)(y.menuIcon),title:(0,F.jsx)(w()._H,{defaultMessage:"Rename",id:"ConfigurePropertyGroupModuleGroupHeading.rename"})}),action:()=>{p(!0)}},!s&&{key:"move-up",render:e=>(0,F.jsx)(E().Z,{...e,icon:(0,Pe().Z)(y.menuIcon),title:(0,F.jsx)(w()._H,{defaultMessage:"Move up",id:"ConfigurePropertyGroupModuleGroupHeading.moveUp"})}),action:()=>{h(n),o()}},!l&&{key:"move-down",render:e=>(0,F.jsx)(E().Z,{...e,icon:(0,_e().M)(y.menuIcon),title:(0,F.jsx)(w()._H,{defaultMessage:"Move down",id:"ConfigurePropertyGroupModuleGroupHeading.moveDown"})}),action:()=>{v(n),o()}},{key:"delete",render:e=>(0,F.jsx)(E().Z,{...e,icon:(0,Ae().y)({width:16,height:16}),title:(0,F.jsx)(w()._H,{defaultMessage:"Delete",id:"ConfigurePropertyGroupModuleGroupHeading.delete"}),caption:(0,F.jsx)(w()._H,{defaultMessage:"No properties will be deleted",id:"ConfigurePropertyGroupModuleGroupHeading.deleteCaption"})}),action:()=>{f(n),o()}}]))}]})});var o}})})}function Ye(e){let{propertyGroupId:t,afterSubmit:n,value:a}=e;const[s,l]=(0,o.useState)(a),d=(0,r().yK)((()=>({container:{display:"flex",padding:"6px"},input:{marginRight:4,flexGrow:1},button:{}})),[]),c=function(){const{collectionStore:e}=(0,$().PP)(),t=(0,i().O7)();return(0,o.useCallback)(((n,o)=>{const i=e.getNormalizedPropertyGroups();if(void 0===i)throw new Error("Error renaming property group. Collection Does not have property groups.");const a=i.map((e=>e.id===n?{...e,title:o}:e));T().createAndCommit({environment:t,perform(t){k().FH({stores:[e],update:{property_groups:a},transaction:t})},canUndo:!0,userAction:"ConfigurePropertyExplorerModule.renameCollectionPropertyGroup"})}),[e,t])}(),u=(0,o.useCallback)((()=>{const e=(0,Re().vJ3)(s).trim();0!==e.length&&(c(t,e),n())}),[n,c,s,t]),m=(0,o.useCallback)((e=>{l(e.target.value)}),[]);return(0,F.jsx)(Oe().Z,{debugName:"ConfigurePropertyGroupHeader",capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!0,children:(0,F.jsxs)("div",{style:d.container,children:[(0,F.jsx)(Ue().Z,{style:d.input,onSubmit:u,selectAll:!0,value:s,onChange:m,focusInitial:!0}),(0,F.jsx)(He().Z,{style:d.button,onClick:u,children:(0,F.jsx)(w()._H,{id:"ConfigurePropertyGroupModuleGroupHeading.updatePropertyGroupTitle",defaultMessage:"Done"})})]})})}var $e=()=>n(601521),Je=()=>n(119891),Qe=()=>n(845991);function Xe(e){const{collectionFormat:t,mergedProperties:n,renderPropertyRow:i}=e,{collectionStore:r}=(0,$().PP)(),s=(0,a().VK)((()=>null==n?void 0:n.map((e=>e.property))),[n]),l=(0,o.useCallback)(((e,t)=>i({propertyId:e,rowIndex:t})),[i]),d=(0,ve().G_)({collectionStore:r,format:t});return s?(0,F.jsx)(Je().ZP,{keys:s,onDrop:d,direction:"vertical",renderKey:l}):null}function et(e){const{renderPropertyRow:t,renderPropertyGroupRow:n,renderAddPropertyButton:r}=e,l=(0,i().O7)(),{collectionStore:d}=(0,$().PP)(),c=(0,a().VK)((()=>d.getNormalizedPropertyGroups()??[]),[d]),u=(0,o.useMemo)((()=>Object.fromEntries(c.map((e=>[e.id,e])))),[c]),m=(0,a().VK)((()=>c.map((e=>{var t;return{key:{key:e.id,draggable:!0},items:[...(null===(t=e.propertyIds)||void 0===t?void 0:t.map((e=>({key:e,draggable:!0}))))??[],(0,$e().zR)(e.id)]}}))),[c]),p=(0,o.useCallback)((e=>{let{flattenedKeys:t,isSection:n}=e;return n?new Set(t.flatMap(((e,t)=>(0,s().$K)(u[e])?[]:[t]))):new Set(t.flatMap(((e,t)=>(0,$e().h)(e)?[t+1]:[])))}),[u]),g=(0,o.useCallback)((e=>{var o;return e.isSection?n({groupId:e.key,groupTitle:null===(o=u[e.key])||void 0===o?void 0:o.title,rowIndex:e.sectionIndex}):(0,$e().h)(e.key)?r((0,$e().Dw)(e.key)):t({propertyId:e.key,rowIndex:e.sectionIndex})}),[u,r,n,t]),f=(0,o.useCallback)((e=>{const t=e.newSections.map((e=>{var t;const n=e.items.map((e=>"string"==typeof e?e:e.key)).filter((e=>!(0,$e().h)(e))),o="string"==typeof e.key?e.key:e.key.key;return{id:o,title:null===(t=u[o])||void 0===t?void 0:t.title,propertyIds:n}}));T().createAndCommit({environment:l,perform(e){(0,We().N7)({collectionStore:d,newGroups:t,transaction:e})},canUndo:!0,userAction:"ConfigurePropertyExplorerModule.onDrop"})}),[d,l,u]);return(0,F.jsx)(Qe().Z,{direction:"vertical",sections:m,renderKey:g,onDrop:f,getInvalidDropIndices:p})}var tt=()=>n(94250),nt=()=>n(81739);const ot=(0,N().IU)("eyelash",{viewBox:"0 0 16 16",svg:(0,F.jsx)("path",{fillRule:"evenodd",d:"M2.1488 5.12366C1.94088 4.76541 1.48191 4.64354 1.12366 4.85145C0.76541 5.05937 0.643537 5.51833 0.851451 5.87659C1.05856 6.23345 1.30425 6.56012 1.58188 6.85746L0.46967 7.96967C0.176777 8.26256 0.176777 8.73744 0.46967 9.03033C0.762563 9.32322 1.23744 9.32322 1.53033 9.03033L2.73804 7.82262C3.18107 8.11266 3.66308 8.35645 4.17017 8.55584L3.30384 10.7217C3.15001 11.1062 3.33707 11.5427 3.72166 11.6966C4.10624 11.8504 4.54272 11.6633 4.69656 11.2787L5.61111 8.99235C6.14972 9.11164 6.70058 9.18864 7.25 9.22519V11.5C7.25 11.9142 7.58579 12.25 8 12.25C8.41421 12.25 8.75 11.9142 8.75 11.5V9.2252C9.29955 9.18866 9.85054 9.11164 10.3893 8.99232L11.3038 11.2787C11.4577 11.6633 11.8942 11.8504 12.2787 11.6966C12.6633 11.5427 12.8504 11.1062 12.6966 10.7217L11.8302 8.55579C12.3372 8.35643 12.8191 8.11269 13.2621 7.82272L14.4697 9.03033C14.7626 9.32322 15.2374 9.32322 15.5303 9.03033C15.8232 8.73744 15.8232 8.26256 15.5303 7.96967L14.4182 6.85759C14.6959 6.56021 14.9417 6.2335 15.1488 5.87659C15.3567 5.51833 15.2348 5.05937 14.8766 4.85145C14.5183 4.64354 14.0594 4.76541 13.8515 5.12366C12.883 6.79244 10.5428 7.75012 8.00012 7.75012C5.45748 7.75012 3.11728 6.79244 2.1488 5.12366Z"})});var it=()=>n(1910),at=()=>n(663221);function rt(e){let{collectionStore:t,pageStore:n,layoutModule:i,pagePropertiesStore:s,propertyId:l,draggable:d,rightButton:c,searchHighlighted:u}=e;const m=(0,a().VK)((()=>n.isNonEditableState()),[n]),{collectionSchema:p,collectionFormat:g,canEditCollection:f}=(0,a().VK)((()=>({collectionSchema:t.getSchema(),collectionFormat:t.getFormat(),canEditCollection:t.canEdit()})),[t]),h=(0,r().yK)((()=>({propertyRowContainer:{width:"100%",minWidth:"100%",display:"grid",alignItems:"center",gridTemplateColumns:"1fr auto",gap:2,paddingLeft:2}})),[]),v=(0,o.useMemo)((()=>({color:"primary",size:"medium",fontWeight:"regular",width:{variant:"fixed",widthDesktop:"100%",widthMobile:"100%"}})),[]),y=Boolean(u),b=Boolean(u&&u.active);return(0,F.jsxs)("div",{style:h.propertyRowContainer,children:[(0,F.jsx)(at().Z,{schema:p,styleVariants:v,format:g,property:l,collectionStore:t,disabled:!1,locked:m,canConfigureCollection:f,isInPeekRenderer:!1,hideDragHandle:!d,showDragHandleAsIcon:!0,dragHandleStyle:{width:16,marginRight:2},blockStore:n,pagePropertiesStore:s,layoutModule:i,forceHighlight:y,forceFocusedHighlight:b}),c?c():null]})}function st(e){const{propertyId:t,propertyFormat:n,pagePropertiesStore:r,collectionStore:s,pageStore:l,searchHighlighted:d}=e,c=(0,w().YB)(),u=(0,i().O7)(),m=(0,a().VK)((()=>s.getSchema()),[s]),p=(0,a().VK)((()=>(0,S().i)(s.getFormat(),m,void 0,x().j5.Collection)),[s,m]),g=m[t],f=(0,o.useCallback)((e=>{T().createAndCommit({environment:u,userAction:"LayoutBuilder.propertiesConfiguration.toggleVisibility",canUndo:!0,perform:n=>{j().M0({property:t,visibility:e,store:s,format:p,transaction:n})}})}),[p,s,u,t]),h="show"===(null==n?void 0:n.visibility)?tt().c:"hide_if_empty"===(null==n?void 0:n.visibility)?nt().C:ot,v="show"===(null==n?void 0:n.visibility)||"hide_if_empty"===(null==n?void 0:n.visibility);if(!g)return null;return(0,F.jsx)(rt,{pageStore:l,collectionStore:s,propertyId:t,pagePropertiesStore:r,draggable:!0,rightButton:()=>(0,F.jsx)(De().ZP,{popupType:Fe().kQ.Popup,renderOrigin:e=>(0,F.jsx)(it().Z,{ariaLabel:c.formatMessage(dt.visibilityToggleIconAriaLabel,{propertyName:g.name}),icon:h,isDarkIconColor:v,...e}),alignmentToOrigin:D().Alignment.Start,render:e=>(0,F.jsx)(lt,{parentClose:e.close,setVisibilityOfProperty:f})}),searchHighlighted:d,layoutModule:e.layoutModule})}function lt(e){const{setVisibilityOfProperty:t,parentClose:n}=e,i=(0,o.useMemo)((()=>[{key:0,render:e=>(0,F.jsx)(G().Z,{...e}),items:[{key:"always_show",render:e=>(0,F.jsx)(E().Z,{...e,icon:(0,tt().c)({width:16,height:16}),title:(0,F.jsx)(w()._H,{defaultMessage:"Always show",id:"ConfigurePropertiesPropertyRow.visibility.alwaysShow"})}),action:()=>{t("show"),n()}},{key:"hide_if_empty",render:e=>(0,F.jsx)(E().Z,{...e,icon:(0,nt().C)({width:16,height:16}),title:(0,F.jsx)(w()._H,{defaultMessage:"Hide when empty",id:"ConfigurePropertiesPropertyRow.visibility.hide_when_empty"})}),action:()=>{t("hide_if_empty"),n()}},{key:"hide",render:e=>(0,F.jsx)(E().Z,{...e,icon:ot({width:16,height:16}),title:(0,F.jsx)(w()._H,{defaultMessage:"Always hide",id:"ConfigurePropertiesPropertyRow.visibility.alwaysHide"})}),action:()=>{t("hide"),n()}}]}]),[n,t]);return(0,F.jsx)(Ne().Z,{menuType:Ke().o.Popup,children:(0,F.jsx)(z().ZP,{type:z().iW.Vertical,initialFocus:0,sections:i})})}const dt=(0,w().vU)({visibilityToggleIconAriaLabel:{id:"pageLayout.configureProperties.visibilityToggleIconAriaLabel",defaultMessage:"Toggle the visibility {propertyName}"}}),ct=(0,w().vU)({filterPropertiesInputPlaceholder:{id:"layouts.configurePropertiesModule.filterProperties.input.placeholder",defaultMessage:"Search..."},notFound:{id:"layouts.configurePropertiesModule.filterProperties.input.notFound",defaultMessage:"Not Found"},arrowButtonDownAriaLabel:{id:"layouts.configurePropertiesModule.filterProperties.input.arrowButtonDown.ariaLabel",defaultMessage:"Button to navigate to the next result"},arrowButtonUpAriaLabel:{id:"layouts.configurePropertiesModule.filterProperties.input.arrowButtonUp.ariaLabel",defaultMessage:"Button to navigate to the previous result"}});function ut(e){const{searchInputValueStore:t,activeSearchMatchIndex:n,searchMatches:i,moveToNextSearchMatch:s,moveToPreviousSearchMatch:l}=e,d=(0,a().Kw)(t),c=(0,w().YB)(),m=o.useCallback((e=>{"Enter"===e.key?(e.preventDefault(),s()):"ArrowUp"===e.key?l():"ArrowDown"===e.key&&s()}),[s,l]),p=(0,r().yK)((e=>({searchMatchCount:{fontSize:".8rem",color:e.text.tertiary,userSelect:"none",cursor:"default",flexShrink:0,marginRight:4},searchMatchArrowButton:{padding:3,width:void 0,height:void 0,cursor:"pointer"},searchMatchArrowIcon:{width:12,height:12,color:e.icon.secondary,strokeWidth:.4,stroke:"currentcolor"},searchInputIcon:{fill:e.mediumIconColor,width:10},searchInputOuter:{background:e.white}})),[]),g=o.useMemo((()=>{if(""!==d)return(0,F.jsxs)(u().gq,{alignItems:"center",gap:8,children:[(0,F.jsx)("div",{children:null!==n?`${n+1} of ${i.length}`:c.formatMessage(ct.notFound)}),null!==n&&(0,F.jsxs)(u().gq,{gap:0,alignItems:"center",children:[(0,F.jsx)(it().Z,{icon:_e().M,iconStyle:p.searchMatchArrowIcon,style:p.searchMatchArrowButton,ariaLabel:c.formatMessage(ct.arrowButtonDownAriaLabel),onClick:s}),(0,F.jsx)(it().Z,{icon:Pe().Z,iconStyle:p.searchMatchArrowIcon,style:p.searchMatchArrowButton,ariaLabel:c.formatMessage(ct.arrowButtonUpAriaLabel),onClick:l})]})]})}),[d,n,i.length,c,p,s,l]);return(0,F.jsx)(W().ZP,{focusInitial:!0,itemMarginLeft:0,itemMarginRight:0,onChange:e=>{t.setState(e.target.value.trim())},onKeyDown:m,placeholder:c.formatMessage(ct.filterPropertiesInputPlaceholder),showClearButton:!0,value:d,inputLeft:(0,K().R)(p.searchInputIcon),inputOuterStyle:p.searchInputOuter,inputRightStyle:p.searchMatchCount,inputRight:g})}function mt(e){const{module:t}=e,{layoutStore:n}=(0,$().J9)(),{collectionStore:i,pageStore:l}=(0,$().PP)(),c=(0,a().VK)((()=>n.getModules()),[n]),m=(0,a().VK)((()=>i.getSchema()),[i]),g=(0,a().VK)((()=>(0,S().i)(i.getFormat(),m,void 0,x().j5.Collection)),[i,m]),f=(0,o.useMemo)((()=>new Set((0,he().m)({modulesByArea:c,collectionSchema:m,collectionFormat:g}))),[g,c,m]),h=(0,o.useMemo)((()=>new(ye().pB)),[]),v=(0,a().VK)((()=>i.getNormalizedPropertyGroups()),[i]),y=(0,a().VK)((()=>{const e={};return null==v||v.forEach(((t,n)=>{e[t.id]=n})),e}),[v]),b=(0,ve().nd)({store:l,format:g,schema:m,collectionStore:i}),M=(0,o.useMemo)((()=>{const e={};return b.forEach((t=>e[t.property]=t)),e}),[b]),{searchInputValueStore:w,searchMatches:C,searchMatchesMap:j,activeSearchMatchIndex:k,moveToNextSearchMatch:T,moveToPreviousSearchMatch:I}=je({mergedPropertiesMap:M,propertyGroups:v,propertyIdsToExclude:f}),_=(0,o.useCallback)((e=>{let{propertyId:n}=e;if(f.has(n))return null;const o=void 0!==j[n]&&null!==k?{active:n===C[k]}:void 0;return(0,F.jsx)(st,{propertyId:n,propertyFormat:M[n],collectionStore:i,pagePropertiesStore:h,pageStore:l,searchHighlighted:o,layoutModule:t})}),[k,i,M,t,h,l,f,C,j]),P=(0,o.useCallback)((e=>{let{groupId:t,groupTitle:n}=e;const o=y[t],i=0===o,a=(0,s().$K)(v)&&o===v.length-1,r={container:i?void 0:{marginTop:20}};return(0,F.jsx)(qe,{title:n,propertyGroupId:t,isFirstPropertyGroup:i,isLastPropertyGroup:a,styles:r})}),[y,v]),Z=(0,o.useCallback)((e=>(0,F.jsx)(Ie,{propertyGroupId:e,pagePropertiesStore:h})),[h]),A=Boolean(b.length&&b.length>f.size),R=(0,r().yK)((e=>({addPropertyButtonContainer:{marginLeft:2,paddingBottom:8},container:{marginTop:A?4:8,height:"100%",overflow:"visible hidden",marginLeft:-Jt,width:`calc(100% + ${2*Jt}px)`},searchInputContainer:{marginRight:Jt,marginLeft:Jt,flexShrink:0,paddingTop:2,overflow:"visible",marginBottom:14,paddingLeft:6,paddingRight:6},listContainer:{padding:`0 ${Jt}px 56px`}})),[A]);return(0,F.jsxs)(u().Ht,{style:R.container,children:[A&&(0,F.jsx)("div",{style:R.searchInputContainer,children:(0,F.jsx)(ut,{searchInputValueStore:w,activeSearchMatchIndex:k,searchMatches:C,moveToNextSearchMatch:T,moveToPreviousSearchMatch:I})}),(0,F.jsx)(d().T,{type:p().Z.Y,style:R.listContainer,children:Boolean(v)?(0,F.jsx)(et,{renderPropertyRow:_,renderPropertyGroupRow:P,renderAddPropertyButton:Z}):(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(Xe,{collectionFormat:g,mergedProperties:b,renderPropertyRow:_}),(0,F.jsx)("div",{style:R.addPropertyButtonContainer,children:(0,F.jsx)(Ie,{pagePropertiesStore:h})})]})})]})}var pt=()=>n(490670),gt=()=>n(641506);const ft=(0,w().vU)({addSection:{id:"NewCollectionPropertyGroupButton.label",defaultMessage:"Add section"},newSection:{id:"NewCollectionPropertyGroupButton.newItemName",defaultMessage:"New section"}});function ht(){const{collectionStore:e}=(0,$().PP)(),t=(0,i().O7)(),n=(0,w().YB)(),a=(0,r().yK)((e=>({button:{fontSize:(0,gt().yv)(t,"UISmall"),color:e.text.secondary,padding:8,fontWeight:C().Ue.medium},icon:{fill:e.icon.secondary,marginRight:4}})),[t]),s=(0,o.useCallback)((()=>{const o=n.formatMessage(ft.newSection),{performResult:i}=T().createAndCommit({environment:t,perform:t=>(0,We().xN)({collectionStore:e,newGroupTitle:o,transaction:t}),canUndo:!0,userAction:"ConfigurePropertyExplorerModule.onDrop"});i&&Ge.setState({forceOpenRenameInputForGroupId:i})}),[e,t,n]);return(0,F.jsx)(Le().D,{icon:pt().f,onClick:s,style:a.button,iconStyle:a.icon,children:(0,F.jsx)(w()._H,{...ft.addSection})})}function vt(e){const{title:t}=e;return(0,F.jsxs)(u().gq,{justifyContent:"space-between",children:[t,(0,F.jsx)(ht,{})]})}var yt=()=>n(139224),bt=()=>n(765458),xt=()=>n(347577);function St(e){return(0,F.jsx)("div",{style:{marginLeft:-8,marginRight:-8},children:e.children})}function Mt(e){let{module:t}=e;const{collectionStore:n}=(0,$().PP)(),i=(0,q().Y$)(),r=(0,a().VK)((()=>n.getSchema()),[n]),s=(0,a().VK)((()=>{if((0,ie().f)(t))return t}),[t]),l=(0,a().VK)((()=>s&&r[s.propertyId]),[s,r]);if((0,o.useEffect)((()=>{if(s)return yt().r$({collectionContextStore:i,collectionSettingsStore:i.settingsStore,closeOnEscape:!1}),yt().FK({collectionSettingsStore:i.settingsStore,item:{type:"property",property:s.propertyId,formatKey:void 0}}),()=>{yt().E3({collectionSettingsStore:i.settingsStore})}}),[i,s]),!l||!s)return null;const d=(0,F.jsx)("span",{style:{fontSize:16,lineHeight:"24px",fontWeight:C().Ue.medium},children:Y().SO[l.type]});return(0,F.jsx)(St,{children:(0,F.jsx)(bt().PJ,{collectionContextStore:i,collectionSettingsStore:i.settingsStore,context:xt().HV.ViewSettings,collectionSettingsPropertyTitleOverride:d,fullHeight:!0})})}n(470928);var wt=()=>n(421551);function Ct(e){let{module:t}=e;const{collectionStore:n,pageStore:o}=(0,$().PP)(),i=(0,r().yK)((e=>({configureContainer:{display:"flex",flexDirection:"column",justifyContent:"flex-start",gap:12,marginTop:16},configureDescription:{fontSize:C().JB.UISmall.desktop,fontWeight:C().Ue.regular,color:e.text.secondary,marginLeft:8}})),[]);return(0,F.jsxs)("div",{style:i.configureContainer,children:[(0,F.jsx)("div",{style:i.configureDescription,children:(0,F.jsx)(w()._H,{defaultMessage:"Relations can be shown as either minimal or responsive page sections",id:"pageLayout.ConfigureRelationsGroupModule.moduleDescription"})}),(0,F.jsx)(jt,{layoutModule:t,pageStore:o,collectionStore:n})]})}function jt(e){let{collectionStore:t,pageStore:n,layoutModule:r}=e;const s=(0,i().O7)(),l=(0,o.useMemo)((()=>new(ye().pB)),[]),{collectionPagePropertySections:d}=(0,a().VK)((()=>{const e=t.getSchema(),n=t.getFormat();return{collectionPagePropertySections:(0,wt().n)({format:n,schema:e,visibilityLevels:["inline","minimal"]})}}),[t]),c=d.map((e=>e.section)),u=(0,o.useCallback)((e=>{if(!d)return;const n=e.map((e=>{const t=d.find((t=>t.section===e));if(!t)throw Error("collection does not have a section corresponding to one of the dropped keys");return t}));T().createAndCommit({userAction:"ConfigureRelationsGroupModule.onDraggablePageSectionsDrop",environment:s,canUndo:!0,perform:e=>{j().Do({environment:s,pageSectionFormats:n,store:t,transaction:e})}})}),[d,t,s]);return d.length?(0,F.jsx)(Je().ZP,{direction:"vertical",keys:c,renderKey:e=>(0,F.jsx)(rt,{pageStore:n,collectionStore:t,propertyId:e,pagePropertiesStore:l,layoutModule:r,draggable:!0}),onDrop:e=>u(e)}):null}var kt=()=>n(179633),Tt=()=>n(142677),It=()=>n(839212),_t=()=>n(142730),Pt=()=>n(356117);function Zt(e){const{environment:t,layoutModule:n,collectionStore:o,layoutStore:i,propertyId:a}=e,r=o.getSchema(),s=i.getModel(),l=null==s?void 0:s.getPageModuleAreaById(n.id);if(!l||!s||"normalizedTitleWithIcon"!==n.type)return;const{pinnedPropertyIds:d}=function(e,t,n){let o,i=[...t??[]];return i.includes(e)?(i=i.filter((t=>t!==e)),o=!1):(i.push(e),i.length>It().c&&(i=(0,oe().bQ)(i,n)),o=!0),{isNowPinned:o,pinnedPropertyIds:i}}(a,n.propertyIds,r),c={...n,propertyIds:d};T().createAndCommit({environment:t,perform(e){(0,_t().iQ)({environment:t,transaction:e,property:a,layoutStore:i}),(0,Pt().Uq)({environment:t,transaction:e,layoutStore:i,position:{area:l,moduleId:n.id},updatedModule:c})},canUndo:!0,userAction:"titleWithIconActions.togglePinnedProperty"})}var At=()=>n(57956);function Rt(e){let{module:t}=e;const{collectionStore:n,pageStore:l}=(0,$().PP)(),d=(0,i().O7)(),{layoutStore:c}=(0,$().J9)(),m=(0,a().VK)((()=>n.getSchema()),[n]),p=(0,a().VK)((()=>(0,S().i)(n.getFormat(),m,void 0,x().j5.Collection)),[n,m]),g=(0,L().E)("layout_view_module"),f=(0,o.useMemo)((()=>new(ye().pB)),[]),h=(0,o.useMemo)((()=>"normalizedTitleWithIcon"!==t.type?[]:(0,oe().bQ)(t.propertyIds,m)),[t,m]),v=(0,o.useMemo)((()=>new Set(h)),[h]),y=(0,a().VK)((()=>{var e;return null===(e=p.property_visibility||[])||void 0===e?void 0:e.map((e=>e.property)).filter((e=>!(0,O().pn)(e)&&!v.has(e)))}),[p.property_visibility,v]),b=(0,a().VK)((()=>(0,s().Yd)(m)),[m]),M=(0,ve().nd)({store:l,format:p,schema:m,collectionStore:n,propertyIds:b}),j=(0,o.useMemo)((()=>{const e={};for(const t of M)e[t.property]=t;return e}),[M]),{searchInputValueStore:k,searchMatches:I,activeSearchMatchIndex:A,moveToNextSearchMatch:B,moveToPreviousSearchMatch:V,searchMatchesMap:U}=je({mergedPropertiesMap:j,propertyGroups:void 0,propertyIdsToExclude:void 0}),N=function(e){const t=(0,i().O7)(),{layoutStore:n}=(0,$().J9)();return(0,o.useCallback)((o=>{const i=n.getModel(),a=null==i?void 0:i.getPageModuleAreaById(e.id);if(!a||!i)return;const r={...e,propertyIds:o};T().createAndCommit({environment:t,perform(o){(0,Pt().Uq)({environment:t,transaction:o,layoutStore:n,position:{area:a,moduleId:e.id},updatedModule:r})},canUndo:!0,userAction:"ConfigureTitleAndIconModule.handlePinnedPropertyReorderDrop"})}),[t,e,n])}(t),H=(0,r().yK)((e=>{const t={fontSize:C().JB.UISmall.desktop,lineHeight:"24px",color:e.mediumTextColor,fontWeight:500};return{container:{height:"100%",overflow:"visible hidden",gap:14,marginLeft:-Jt,width:`calc(100% + ${2*Jt}px)`},propertySearchInputContainer:{flexShrink:0,margin:`10px ${Jt+6}px 0`},scrollableContainer:{padding:`0 ${Jt}px 56px`,flexGrow:1,overflow:"hidden auto"},pinnedPropertiesLabel:{...t,marginLeft:8},popoverMessage:{color:e.lightTextColor,fontSize:C().JB.UISmall.desktop,marginTop:10},optionsContainer:{marginTop:24},optionsLabel:{...t,marginLeft:6,marginBottom:6},switcherButton:{marginRight:0},textWrapperStyle:{marginLeft:6},addPropertyButton:{color:e.text.secondary,height:34},addPropertyButtonIcon:{color:e.text.secondary}}}),[]),K=h.length?(0,F.jsx)(Je().ZP,{keys:h,onDrop:N,direction:"vertical",renderKey:e=>(0,F.jsx)(Lt,{layoutModule:t,propertyId:e,isPinned:!0,draggable:!0,pinButtonDisabled:!1,pagePropertiesStore:f,searchHighlighted:null!==A&&void 0!==U[e]?{active:e===I[A]}:void 0})}):null,E=h.length>=It().c,W=y.map((e=>(0,F.jsx)(Lt,{layoutModule:t,propertyId:e,isPinned:!1,draggable:!1,pinButtonDisabled:E,pagePropertiesStore:f,searchHighlighted:null!==A&&void 0!==U[e]?{active:e===I[A]}:void 0},e))),z=Bt(t),G=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,F.jsx)(ke().le,{...e,style:H.addPropertyButton,iconStyle:H.addPropertyButtonIcon,collectionStore:n,isInPeekRenderer:!1,pagePropertiesStore:f,onPropertyAdded:z,disabled:E})},{backlinksVisibility:q,updateBacklinksVisibility:Y}=(0,At().F6)({store:n,format:p}),J=(0,w().YB)(),Q=(0,o.useCallback)((()=>{const e="show"===t.propertyLabels||!t.propertyLabels;T().createAndCommit({environment:d,perform(n){var o;const i=null===(o=c.getModel())||void 0===o?void 0:o.getPageModuleAreaById(t.id);i&&(0,Pt().Uq)({environment:d,transaction:n,layoutStore:c,position:{area:i,moduleId:t.id},updatedModule:{...t,propertyLabels:e?"hide":"show"}})},canUndo:!0,userAction:"ConfigureTitleAndIconModule.handleShowPropertyLabels"})}),[t,d,c]),X=(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)("div",{style:{...H.pinnedPropertiesLabel},children:(0,F.jsx)(w()._H,{...Dt.pinnedPropertiesLabel})}),K,(0,F.jsx)("div",{style:{marginLeft:2},children:E?(0,F.jsx)(Z().Z,{placement:D().Placement.Left,render:e=>G(e),renderTooltip:()=>J.formatMessage(Dt.maxPinnedPropertiesAddPropertyTooltip,{br:(0,F.jsx)("br",{})})}):G()}),W.length>0&&(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)("div",{style:{...H.pinnedPropertiesLabel,marginTop:24},children:(0,F.jsx)(w()._H,{...Dt.unpinnedPropertiesLabel})}),W]})]});return(0,F.jsxs)(u().Ht,{style:H.container,children:[(0,F.jsx)("div",{style:H.propertySearchInputContainer,children:(0,F.jsx)(ut,{activeSearchMatchIndex:A,searchMatches:I,moveToNextSearchMatch:B,moveToPreviousSearchMatch:V,searchInputValueStore:k})}),(0,F.jsxs)("div",{style:H.scrollableContainer,children:[X,(0,F.jsxs)("div",{style:H.optionsContainer,children:[(0,F.jsx)("div",{style:H.optionsLabel,children:(0,F.jsx)(w()._H,{...Dt.optionsLabel})}),g&&(0,F.jsx)(_().ZP,{title:(0,F.jsx)(w()._H,{id:"PageLayoutConfigurationSidebar.showPropertyLabels",defaultMessage:"Property labels"}),onClick:Q,right:(0,F.jsx)(P().Z,{on:"show"===t.propertyLabels||void 0===t.propertyLabels}),rightStyle:H.switcherButton,textWrapperStyle:H.textWrapperStyle}),(0,F.jsx)(_().ZP,{right:(0,F.jsx)(R().nm,{currentVisibility:q,onSelect:Y}),textWrapperStyle:H.textWrapperStyle,rightStyle:H.switcherButton,title:(0,F.jsx)(w()._H,{...Dt.showBacklinksOption})})]})]})]})}function Bt(e){const{layoutStore:t}=(0,$().J9)(),{collectionStore:n}=(0,$().PP)(),a=(0,i().O7)();return(0,o.useCallback)((o=>{Zt({environment:a,layoutModule:e,collectionStore:n,layoutStore:t,propertyId:o})}),[a,e,n,t])}function Lt(e){let{layoutModule:t,propertyId:n,isPinned:o,pinButtonDisabled:i,...s}=e;const l=(0,w().YB)(),d=(0,r().Fg)(),{collectionStore:c,pageStore:u}=(0,$().PP)(),m=(0,a().VK)((()=>c.getSchema()),[c])[n],p=Bt(t);if(!m)return null;const g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,F.jsx)(it().Z,{...e,disabled:i,ariaLabel:o?l.formatMessage(Dt.toggleUnpinnedAriaLabel,{propertyName:m.name}):l.formatMessage(Dt.togglePinnedAriaLabel,{propertyName:m.name}),icon:o?Tt()._:kt().P,iconStyle:{fill:d.icon.primary},onClick:()=>p(n)})};return(0,F.jsx)(rt,{pageStore:u,collectionStore:c,propertyId:n,layoutModule:t,rightButton:()=>i?(0,F.jsx)(Z().Z,{placement:D().Placement.Left,render:e=>g(e),renderTooltip:()=>l.formatMessage(Dt.maxPinnedPropertiesTooltip,{br:(0,F.jsx)("br",{})})}):g(),...s})}const Dt=(0,w().vU)({togglePinnedAriaLabel:{id:"pageLayout.configurePinnedProperties.togglePinnedAriaLabel",defaultMessage:"Show {propertyName} as pinned"},toggleUnpinnedAriaLabel:{id:"pageLayout.configurePinnedProperties.toggleUnpinnedAriaLabel",defaultMessage:"Do not show {propertyName} as pinned"},pinnedPropertiesLabel:{id:"pageLayout.configurePinnedProperties.pinnedPropertiesLabel",defaultMessage:"Pinned properties"},unpinnedPropertiesLabel:{id:"pageLayout.configurePinnedProperties.unpinnedPropertiesLabel",defaultMessage:"Unpinned properties"},noUnpinnedPropertiesMessage:{id:"pageLayout.configurePinnedProperties.noUnpinnedPropertiesMessage",defaultMessage:"No properties to pin"},maxPinnedPropertiesTooltip:{id:"pageLayout.configurePinnedProperties.maxPinnedPropertiesTooltip",defaultMessage:"Maximum number of pinned properties reached. {br} Unpin a property to pin another."},maxPinnedPropertiesAddPropertyTooltip:{id:"pageLayout.configurePinnedProperties.maxPinnedPropertiesAddPropertyTooltip",defaultMessage:"Maximum number of pinned properties reached. {br} Unpin a property to create a new pinned property."},optionsLabel:{id:"pageLayout.configurePinnedProperties.optionsLabel",defaultMessage:"Options"},showBacklinksOption:{id:"pageLayout.configurePinnedProperties.showBacklinksOption",defaultMessage:"Backlinks"},showPropertyLabelsOption:{id:"pageLayout.configurePinnedProperties.showPropertyLabelsOption",defaultMessage:"Show property labels"}});var Vt=()=>n(159732),Ot=()=>n(427886),Ut=()=>n(716025),Nt=()=>n(887430),Ft=()=>n(895513);function Ht(e){let{module:t}=e;const{moduleStateByIdStore:n}=(0,$().PP)(),i=(0,a().VK)((()=>{var e;return null===(e=n.get(t.id))||void 0===e?void 0:e.collectionContextStore}),[n,t.id]),s=(0,a().VK)((()=>{var e;return null==i||null===(e=i.collectionViewStore())||void 0===e?void 0:e.id}),[i]),l=(0,a().VK)((()=>null==i?void 0:i.settingsStore),[i]),d=(0,r().yK)((()=>({titleWrapper:{...Gt,marginBottom:6,display:"flex"},viewsContainer:{marginTop:8,width:"100%",display:"flex",flexDirection:"column"}})),[]);(0,o.useEffect)((()=>{i&&yt().r$({collectionContextStore:i,collectionSettingsStore:i.settingsStore,closeOnEscape:!1})}),[i]);const c=(0,a().VK)((()=>{var e;return null==i||null===(e=i.settingsStore)||void 0===e?void 0:e.getState().open}),[i]);return"viewsMain"===t.type&&i&&l&&c?(0,F.jsx)(St,{children:(0,F.jsx)(q().cu.Provider,{value:i,children:(0,F.jsx)(bt().PJ,{collectionContextStore:i,collectionSettingsStore:l,context:xt().HV.ViewSettings})})}):(0,F.jsxs)("div",{children:[(0,F.jsx)("div",{style:d.titleWrapper,children:(0,F.jsx)(w()._H,{...fe().B.viewsMain})}),(0,F.jsxs)("div",{style:d.viewsContainer,children:[(0,F.jsx)(Kt,{collectionContextStore:i,currentViewId:s,module:t}),"viewsMain"===t.type&&(0,F.jsx)(Ft().ConfigureViewsMainModuleAddNewViewButtonWrapper,{renderOrigin:e=>(0,F.jsx)(Le().D,{icon:Vt().R,isGray:!0,...e,children:(0,F.jsx)(w()._H,{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView"})})})]})]})}function Kt(e){let{collectionContextStore:t,currentViewId:n,module:o}=e;const r=(0,i().O7)(),s=(0,a().VK)((()=>{if(!t)return[];const e=t.collectionViewBlockStore(),n=null==e?void 0:e.getCollectionViewStores();return null==n?void 0:n.map((e=>{var t;return{id:e.id,icon:null===(t=e.getFormat())||void 0===t?void 0:t.collection_view_icon,type:e.getType(),name:e.getName(),pointer:e.pointer}}))}),[t]);return"editor"===o.type?(0,F.jsx)(Le().D,{children:(0,F.jsx)("div",{style:{fontWeight:600},children:(0,F.jsx)(w()._H,{...fe().B.editor})})},"editor"):s&&t?(0,F.jsx)(F.Fragment,{children:s.map((e=>(0,F.jsx)(Le().D,{icon:t=>(0,F.jsx)(Ut().F,{viewIcon:e.icon,viewType:e.type,color:"regular",style:t}),onClick:()=>{(0,Ot().f)({environment:r,collectionContextStore:t,collectionViewId:e.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1}),yt().r$({collectionContextStore:t,collectionSettingsStore:t.settingsStore})},children:(0,F.jsx)("div",{style:{fontWeight:e.id===n?600:void 0},children:void 0!==e.type?(0,Nt().Cc)({collectionViewName:e.name,collectionViewType:e.type}):(0,F.jsx)(w()._H,{...Et.newView})})},e.id)))}):null}const Et=(0,w().vU)({newView:{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView"},back:{defaultMessage:"Back",id:"collectionsSettingsMenu.back"}});function Wt(e){let{module:t}=e;const{moduleStateByIdStore:n}=(0,$().PP)(),o=(0,a().VK)((()=>{var e;return null===(e=n.get(t.id))||void 0===e?void 0:e.collectionContextStore}),[n,t.id]),i=(0,a().VK)((()=>null==o?void 0:o.settingsStore),[o]);return t&&o&&i?(0,F.jsx)(St,{children:(0,F.jsx)(q().cu.Provider,{value:o,children:(0,F.jsx)(bt().PJ,{collectionContextStore:o,collectionSettingsStore:i,context:xt().HV.ViewSettings})})}):null}function zt(e){let{moduleId:t}=e;const{layoutStore:n}=(0,$().J9)(),o=(0,a().VK)((()=>n.getModuleById(t)),[n,t]),i=(0,r().yK)((()=>({container:{display:"flex",flexDirection:"column",..."properties"!==(null==o?void 0:o.type)&&"normalizedTitleWithIcon"!==(null==o?void 0:o.type)?{paddingBottom:80}:{height:"100%"}}})),[null==o?void 0:o.type]);return o?(0,F.jsxs)("div",{style:i.container,children:[(s=o,"viewsMain"!==s.type&&"editor"!==s.type&&!(0,ie().f)(s)&&(0,F.jsx)(qt,{module:o})),(0,F.jsx)(Yt,{module:o})]}):null;var s}const Gt={fontWeight:C().Ue.medium,marginBottom:0,marginLeft:6,fontSize:16,lineHeight:"24px"};function qt(e){const{module:t}=e,n=(0,F.jsx)("div",{style:Gt,children:(0,F.jsx)(w()._H,{...fe().B[t.type]})});return"properties"===t.type?(0,F.jsx)(vt,{title:n}):n}function Yt(e){const{module:t}=e;if((0,ie().f)(t))return(0,F.jsx)(Mt,{module:t});const{type:n}=t;switch(n){case"properties":return(0,F.jsx)(mt,{module:t});case"normalizedTitleWithIcon":return(0,F.jsx)(Rt,{module:t});case"relationsGroup":return(0,F.jsx)(Ct,{module:t});case"views":return(0,F.jsx)(Wt,{module:t});case"viewsMain":case"editor":return(0,F.jsx)(Ht,{module:t});case"deleted_property":case"cover":case"inlinePageSections":case"expandedBacklinks":case"discussions":case"bottomControls":case"transcript":case"formQuestion":case"formTitle":case"formSubmit":case"placeholder":return null;default:(0,s().t1)(n)}return null}const $t=290,Jt=16;function Qt(){const{currentModuleSelection:e,layoutStore:t,sessionId:n}=(0,$().J9)(),{collectionStore:o,pageStore:i}=(0,$().PP)(),s=(0,L().E)("layout_view_module"),l=s,c=!s,u=s,m=s,g=(0,a().VK)((()=>{const e=o.getFormat(),t=o.getSchema();return(0,S().i)(e,t,void 0,x().j5.Collection)}),[o]),f=(0,r().yK)((t=>({container:{padding:`8px ${Jt}px ${"existing_module"===(null==e?void 0:e.type)?"0":"24px"}`,minWidth:$t,width:$t,maxWidth:$t},title:{fontSize:16,lineHeight:"24px",fontWeight:C().Ue.medium,margin:"0px 8px 0px 8px"},label:{fontSize:C().JB.UISmall.desktop,fontWeight:C().Ue.medium,margin:"24px 8px 6px 8px",color:t.text.secondary},switcherButton:{marginRight:0},textWrapperStyle:{marginLeft:8}})),[e]),h=(0,a().VK)((()=>Boolean(o.getFormat().external_object_id)),[o]);return e?(0,F.jsxs)(d().T,{type:p().Z.Y,style:f.container,children:["existing_module"===e.type&&(0,F.jsx)(zt,{moduleId:e.moduleId}),"new_module"===e.type&&(0,F.jsx)(ge,{})]}):(0,F.jsxs)("div",{style:f.container,children:[(0,F.jsx)("div",{style:f.title,children:(0,F.jsx)(w()._H,{id:"PageLayoutConfigurationSidebar.title",defaultMessage:"Page settings"})}),l&&(0,F.jsx)(Xt,{collectionStore:o,layoutStore:t,sessionId:n,styles:f}),c&&(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(tn,{disabled:h,collectionStore:o,normalizedCollectionFormat:g,styles:f}),(0,F.jsx)(en,{disabled:h,collectionStore:o,normalizedCollectionFormat:g,styles:f})]}),(0,F.jsx)("div",{style:f.label,children:(0,F.jsx)(w()._H,{id:"PageLayoutConfigurationSidebar.options",defaultMessage:"Options"})}),u&&(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(on,{disabled:h,collectionStore:o,normalizedCollectionFormat:g,styles:f}),(0,F.jsx)(nn,{disabled:h,collectionStore:o,normalizedCollectionFormat:g,styles:f})]}),(0,F.jsx)(an,{layoutStore:t,styles:f}),m&&(0,F.jsx)(rn,{pageStore:i,layoutStore:t,styles:f})]})}function Xt(e){const{collectionStore:t,layoutStore:n,sessionId:r,styles:l}=e,d=(0,i().O7)(),c=(0,a().VK)((()=>n.isTabbedPageLayout()),[n]),{value:u}=(0,B().XJ)(V.switchFromSimpleToTabbedLayoutActions),{value:m}=(0,B().XJ)(V.switchFromTabbedToSimpleLayoutActions),p=!u||!m,f=c?"tabbed":"simple",h=(0,o.useMemo)((()=>({available:["simple","tabbed"],appearance:{simple:{label:(0,F.jsx)(w()._H,{id:"PageLayoutConfigurationSidebar.structure.simple",defaultMessage:"Simple"}),image:{src:b().Z.images.layouts.configuration.simplePageLayoutStructurePng,width:112,height:80}},tabbed:{label:(0,F.jsx)(w()._H,{id:"PageLayoutConfigurationSidebar.structure.tabbed",defaultMessage:"Tabbed"}),image:{src:b().Z.images.layouts.configuration.tabbedPageLayoutStructurePng,width:112,height:80}}}})),[]),v=(0,o.useCallback)((e=>{u&&m&&("simple"===e?m.switchFromTabbedToSimpleLayout({environment:d,layoutStore:n}):"tabbed"===e?u.switchFromSimpleToTabbedLayout({environment:d,layoutStore:n}):(0,s().t1)(e),(0,g().d7)({environment:d,layoutId:n.id,collectionId:t.id,sessionId:r,structure:e}))}),[u,m,d,n,t.id,r]);return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)("div",{style:l.label,children:(0,F.jsx)(w()._H,{id:"PageLayoutConfigurationSidebar.structure",defaultMessage:"Structure"})}),(0,F.jsx)(I().Z,{disabled:p,options:h,selectedOption:f,onOptionSelected:v,height:"tall"})]})}function en(e){var t;const{disabled:n,collectionStore:a,normalizedCollectionFormat:r,styles:s}=e,l=(0,i().O7)(),d="section_hide"===(null===(t=r.page_section_visibility)||void 0===t?void 0:t.comments)?"section_hide":"section_show",c=(0,o.useMemo)((()=>({available:["section_show","section_hide"],appearance:{section_show:{label:(0,F.jsx)(w()._H,{...A().nL.section_show}),image:{src:b().Z.images.layouts.configuration.pageCommentsExpandedPng,width:112,height:80}},section_hide:{label:(0,F.jsx)(w()._H,{...A().nL.section_hide}),image:{src:b().Z.images.layouts.configuration.pageCommentsOffPng,width:112,height:80}}}})),[]),u=(0,o.useCallback)((e=>{const t=a.getFormat(),n=a.getSchema(),o=(0,S().i)(t,n,void 0,x().j5.Collection);j().W4({environment:l,pageSection:"comments",visibility:e,store:a,format:o})}),[a,l]);return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)("div",{style:s.label,children:(0,F.jsx)(w()._H,{id:"PageLayoutConfigurationSidebar.pageDiscussions",defaultMessage:"Page discussions"})}),(0,F.jsx)(Z().Z,{placement:D().Placement.Bottom,disableTooltip:!n,renderTooltip:()=>(0,F.jsx)(w()._H,{id:"PageLayoutConfigurationSidebar.pageDiscussions.tooltip.pageDiscussionSettingNotAvailable",defaultMessage:"This setting is not available for synced databases"}),render:e=>(0,F.jsx)("div",{...e,children:(0,F.jsx)(I().Z,{disabled:!!n,options:c,selectedOption:d,onOptionSelected:u,height:"tall"})})})]})}function tn(e){var t;const{disabled:n,collectionStore:a,normalizedCollectionFormat:r,styles:s}=e,l=(0,i().O7)(),d="minimal"===(null===(t=r.page_section_visibility)||void 0===t?void 0:t.margin_comments)?"minimal":"inline",c=(0,o.useMemo)((()=>({available:["inline","minimal"],appearance:{inline:{label:(0,F.jsx)(w()._H,{...A().Wc.inline}),image:{src:b().Z.images.layouts.configuration.inlineDefaultPng,width:112,height:80}},minimal:{label:(0,F.jsx)(w()._H,{...A().Wc.minimal}),image:{src:b().Z.images.layouts.configuration.inlineMinimalPng,width:34,height:24}}}})),[]),u=(0,o.useCallback)((e=>{const t=a.getFormat(),n=a.getSchema(),o=(0,S().i)(t,n,void 0,x().j5.Collection);j().W4({environment:l,pageSection:"margin_comments",visibility:e,store:a,format:o})}),[a,l]);return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)("div",{style:s.label,children:(0,F.jsx)(w()._H,{id:"PageLayoutConfigurationSidebar.inlineComments",defaultMessage:"Inline comments"})}),(0,F.jsx)(Z().Z,{placement:D().Placement.Bottom,disableTooltip:!n,renderTooltip:()=>(0,F.jsx)(w()._H,{id:"PageLayoutConfigurationSidebar.inlineComments.tooltip.inlineCommentSettingNotAvailable",defaultMessage:"This setting is not available for synced databases"}),render:e=>(0,F.jsx)("div",{...e,children:(0,F.jsx)(I().Z,{disabled:!!n,options:c,selectedOption:d,onOptionSelected:u,height:"tall"})})})]})}function nn(e){var t;const{disabled:n,collectionStore:a,normalizedCollectionFormat:r,styles:s}=e,l=(0,i().O7)(),d="section_hide"===(null===(t=r.page_section_visibility)||void 0===t?void 0:t.comments)?"section_hide":"section_show",c=(0,o.useCallback)((e=>{const t=a.getFormat(),n=a.getSchema(),o=(0,S().i)(t,n,void 0,x().j5.Collection);j().W4({environment:l,pageSection:"comments",visibility:e,store:a,format:o})}),[a,l]);return(0,F.jsx)(_().ZP,{title:(0,F.jsx)(w()._H,{id:"PageLayoutConfigurationSidebar.pageDiscussions",defaultMessage:"Page discussions"}),right:(0,F.jsx)(R().GY,{disabled:n,currentVisibility:d,onSelect:c}),rightStyle:s.switcherButton,textWrapperStyle:s.textWrapperStyle})}function on(e){var t;const n=(0,i().O7)(),{disabled:a,collectionStore:r,normalizedCollectionFormat:s,styles:l}=e,d="minimal"===(null===(t=s.page_section_visibility)||void 0===t?void 0:t.margin_comments)?"minimal":"inline",c=(0,o.useCallback)((e=>{const t=r.getFormat(),o=r.getSchema(),i=(0,S().i)(t,o,void 0,x().j5.Collection);j().W4({environment:n,pageSection:"margin_comments",visibility:e,store:r,format:i})}),[r,n]);return(0,F.jsx)(_().ZP,{title:(0,F.jsx)(w()._H,{id:"PageLayoutConfigurationSidebar.inlineComments",defaultMessage:"Inline comments"}),right:(0,F.jsx)(R().k7,{disabled:a,currentVisibility:d,onSelect:c}),rightStyle:l.switcherButton,textWrapperStyle:l.textWrapperStyle})}function an(e){const{layoutStore:t,styles:n}=e,r=(0,i().O7)(),s=(0,a().VK)((()=>{var e;return"show"===((null===(e=t.getFormat())||void 0===e?void 0:e.property_icons_visibility)??"show")}),[t]),l=(0,o.useCallback)((()=>{T().createAndCommit({environment:r,userAction:"pageLayoutActions.handleShowPropertyIcons",canUndo:!0,perform:e=>{var n;k().FH({stores:[t],update:{property_icons_visibility:"hide"===(null===(n=t.getFormat())||void 0===n?void 0:n.property_icons_visibility)?"show":"hide"},transaction:e})}})}),[t,r]);return(0,F.jsx)(_().ZP,{title:(0,F.jsx)(w()._H,{id:"PageLayoutConfigurationSidebar.showPropertyIcons",defaultMessage:"Property icons"}),onClick:l,right:(0,F.jsx)(P().Z,{on:s}),rightStyle:n.switcherButton,textWrapperStyle:n.textWrapperStyle})}function rn(e){const{pageStore:t,layoutStore:n,styles:s}=e,l=(0,i().O7)(),d=(0,a().VK)((()=>n.getFormatStore().getKeyValue("page_full_width")),[n]),c=(0,o.useCallback)((()=>{T().createAndCommit({environment:l,userAction:"pageLayoutActions.handleShowFullWidth",canUndo:!0,perform:e=>{const o=!n.getFormatStore().getKeyValue("page_full_width");k().FH({stores:[n],update:{page_full_width:o},transaction:e}),void 0!==t.getFormatStore().getKeyValue("page_full_width")&&k().FH({stores:[t],update:{page_full_width:void 0},transaction:e})}})}),[n,l,t]),u=(0,r().yK)((e=>({icon:{height:14,width:14,color:e.icon.secondary},title:{display:"flex",alignItems:"center",gap:"4px"},tooltip:{maxWidth:240,width:"max-content",overflowWrap:"break-word",textWrap:"wrap"}})),[]);return(0,F.jsx)(_().ZP,{title:(0,F.jsxs)("div",{style:u.title,children:[(0,F.jsx)(w()._H,{id:"PageLayoutConfigurationSidebar.showFullWidth",defaultMessage:"Full width"}),(0,F.jsx)(Z().Z,{placement:D().Placement.Bottom,renderTooltip:()=>(0,F.jsx)(w()._H,{id:"PageLayoutConfigurationSidebar.showFullWidth.tooltip",defaultMessage:"Page width can be overwritten on individual pages."}),render:e=>(0,F.jsx)("div",{...e,children:(0,M().D)(u.icon)}),style:u.tooltip})]}),onClick:c,right:(0,F.jsx)(P().Z,{on:Boolean(d)}),rightStyle:s.switcherButton,textWrapperStyle:s.textWrapperStyle})}var sn=()=>n(8564),ln=()=>n(583824),dn=()=>n(857719),cn=()=>n(947115),un=()=>n(215134),mn=()=>n(396136),pn=()=>n(688293);function gn(e){var t;const{layoutStore:o,tabToFocus:i,moduleStateByIdStore:a,environment:r}=e,l=o.pointer,d=o.getModules(),c=(0,un().h7)(d,(e=>"viewsMain"===e.type));if(!c||!(0,ie().aJ)(c.module))return;const{module:u}=c,m=null==a||null===(t=a.get(u.id))||void 0===t?void 0:t.collectionContextStore;if(!m)return;const p=n(128076).G.createChildStore(o,u.collection_view_block_pointer).getCollectionViewStores();let g;"viewId"===(null==i?void 0:i.type)?g=null==p?void 0:p.find((e=>{var t;return(null===(t=e.getFormat().page_layout_pointer)||void 0===t?void 0:t.views_main_tab_id)===i.viewId})):"contentTab"===(null==i?void 0:i.type)?g=null==p?void 0:p.find((e=>{var t;if("page"!==e.getType())return!1;return(null===(t=e.getFormat().page_layout_pointer)||void 0===t?void 0:t.id)===l.id})):(0,s().t1)(i),g&&(0,Ot().f)({environment:r,collectionContextStore:m,collectionViewId:g.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1})}const fn=o.memo((function(e){let{children:t,collectionStore:r,pageStore:s,sessionId:l,layoutBuilderModuleSelectionStore:d}=e;const c=(0,i().O7)(),u=(0,a().VK)((()=>{var e;return null===(e=n(876822).default.state.currentUserStore)||void 0===e?void 0:e.userId}),[]),m=(0,a().VK)((()=>r.getSpaceId()),[r]),p=(0,o.useMemo)((()=>(null==s?void 0:s.id)??(0,n(487270).TS)({environment:c,table:mn().iU,spaceId:m})),[c,null==s?void 0:s.id,m]),g=(0,o.useCallback)((e=>{var t;if(e.operation.pointer.id===p)return!1;if((null===(t=e.operation)||void 0===t||null===(t=t.args)||void 0===t?void 0:t.parent_id)===p)throw new Error("Unexpected operation on temporary page.");return!0}),[p]),f=(0,pn().N)(n(473244).he,{canUndo:!1,shouldPersistOperation:s?void 0:g}),h=(0,a().VK)((()=>{if(s)return s.clone(f.cache);return T().createAndCommit({environment:c,perform(e){const t=n(636340).j4({environment:c,type:"page",id:p,inMemoryRecordCache:f.cache,transaction:e});return T().applyOperation({store:t,operation:n(481529).op.update({pointer:{id:t.pointer.id,table:mn().iU,spaceId:t.pointer.spaceId},path:[],args:{parent_id:r.id,parent_table:r.table}}),transaction:e}),t},userAction:"PageLayoutEditorContext.createEmptyPageStore",canUndo:!1}).performResult}),[r,f.cache,c,s,p]),v=function(e,t){const r=(0,i().O7)(),s=(0,o.useMemo)((()=>new(n(985866).Z)(r)),[r]),l=(0,pn().t)(e,t),d=(0,a().VK)((()=>null==t?void 0:t.getParentBlockStore()),[t]);return(0,o.useEffect)((()=>{s.setContext({type:"collectionPage",collectionViewBlockStore:d,collectionStore:l})}),[s,l,d]),s}(f,r),{unpersistedCollectionStore:y,unpersistedLayoutStore:b,modulesByArea:x}=(0,a().VK)((()=>{const e=v.collectionStore(),t=null==e?void 0:e.getLayoutStore();return{unpersistedCollectionStore:e,unpersistedLayoutStore:t,modulesByArea:null==t?void 0:t.getModules()}}),[v]),[S,M]=(0,o.useState)(void 0);(0,n(61951).Z)((()=>{M((0,Be().Xh)(x))}),!!x);const w=(0,a().qz)(void 0,n(560801).Z),C=o.useRef(!1);(0,a().VK)((()=>{u&&y&&!b&&(T().createAndCommit({environment:c,perform:e=>_t().m2({environment:c,transaction:e,collectionStore:y,userId:u}),userAction:"PageLayoutEditorContext.initCollectionLayout",canUndo:!1}),C.current=!0)}),[c,y,b,u]);const j=(0,o.useCallback)((async()=>{if(u&&b)return f.persist("PageLayoutEditorContext.updateLayout")}),[f,b,u]),k=(0,o.useCallback)((()=>{f.reset();const e=r.getLayoutStore();return!!e&&(T().createAndCommit({environment:c,perform(t){Pt().Wb({environment:c,transaction:t,layoutStore:e,collectionStore:r})},userAction:"PageLayoutEditorContext.resetLayoutToDefault",canUndo:!1}),!0)}),[r,f,c]),I=(0,a().VK)((()=>d.getState()),[d]),_=(0,a().VK)((()=>h.isReady()&&(null==b?void 0:b.isReady())),[b,h]),[P,Z]=(0,o.useState)([]),A=(0,o.useMemo)((()=>new(n(623361).p)),[]),R=(0,o.useCallback)((e=>{if(d.setState(e),b&&e&&"existing_module"===e.type&&e.moduleId){const t=null==b?void 0:b.getModules();if(!t)return;const n=(0,un().h7)(t,(t=>t.id===e.moduleId));n&&"views_main_tab_modules"===n.position.area&&gn({tabToFocus:{type:"contentTab"},layoutStore:b,moduleStateByIdStore:A,environment:c})}}),[c,d,A,b]),B=xe().default.createValue(!1),L=(0,o.useMemo)((()=>b&&{layoutStore:b,collectionStore:y,currentModuleSelection:I,setModuleSelection:R,sessionId:l,addModuleHoverMenuStore:w,canEditLayout:!0,isPropertyTypeSearchInputDirtyStore:B,layoutBuilderModuleSelectionStore:d}),[b,y,I,R,l,w,B,d]),D=(0,o.useMemo)((()=>y&&{pageStore:h,hasUnsavedChanges:f.hasChanges,saveChanges:j,moduleIdsMovedFromSidebar:P,setModuleIdsMovedFromSidebar:Z,isNewLayout:C.current,initialLayoutModulesByArea:S,resetLayoutToDefault:k,moduleStateByIdStore:A,collectionContextStore:v,collectionStore:y}),[y,h,f.hasChanges,j,P,S,k,A,v]);return _&&b&&L&&D?(0,F.jsx)(q().L1,{value:v,children:(0,F.jsx)($().Dt.Provider,{value:L,children:(0,F.jsxs)($().eK.Provider,{value:D,children:[(0,cn().isConsoleEnabled)()&&(0,F.jsx)(hn,{}),t]})})}):null}));function hn(){return(0,o.useEffect)((()=>()=>{(0,cn().exposeDebugValue)("baseLayoutEditorContext",void 0),(0,cn().exposeDebugValue)("pageLayoutEditorContext",void 0)}),[]),(0,cn().exposeDebugValue)("baseLayoutEditorContext",(0,$().J9)()),(0,cn().exposeDebugValue)("pageLayoutEditorContext",(0,$().PP)()),null}var vn=n.n(n(294184)),yn=()=>n(328714),bn=()=>n(467171),xn=()=>n(308186),Sn=()=>n(943620),Mn=()=>n(384241),wn=()=>n(247724),Cn=()=>n(725751),jn=()=>n(286977),kn=()=>n(374289),Tn=()=>n(899133),In=()=>n(312578),_n=()=>n(838367),Pn=()=>n(231219),Zn=()=>n(527278),An=()=>n(164079),Rn=()=>n(766463);function Bn(e){let{collectionStore:t}=e;const n=(0,o.useRef)(null),[i,r]=o.useState(""),{pageStore:s}=(0,$().PP)(),{results:l,isResultsLoading:d}=(0,Rn().s)({type:Tn().n8.BlocksInCollection,source:"layout_builder_page_selector",limit:10,disable:!1,filters:{parentId:t.id},searchQuery:i}),c=(0,a().VK)((()=>d?[{key:"loading",action:()=>{},render:e=>(0,F.jsx)(_n().Z,{...e,title:(0,F.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,F.jsx)(In().Z,{})})})}]:0===l.length?[{key:"no_results",action:()=>{},render:e=>(0,F.jsx)(_n().Z,{...e,title:(0,F.jsx)(w()._H,{id:"pageLayoutEditor.pagePicker.noResults",defaultMessage:"No results."})})}]:l.map((e=>{const t=(null==s?void 0:s.id)===e.id;return{key:e.id,render:n=>(0,F.jsx)(Pn().Z,{...n,store:e.store,hidePath:!0,right:t?(0,jn().e)({width:10}):null}),action:()=>{if(t)return;if(!y().Z.state.isOpen||!y().Z.state.collectionStore)throw new Error("Expected page layout editor to be open.");const n={isOpen:y().Z.state.isOpen,mode:"layout-editor",pageStore:e.store,sessionId:y().Z.state.sessionId,collectionStore:y().Z.state.collectionStore};y().Z.setState(n)}}}))),[null==s?void 0:s.id,d,l]),u=(0,F.jsx)(G().Z,{isInput:!0,style:{paddingBottom:0},desktopTitleStyle:{paddingBottom:0,marginBottom:0},children:(0,F.jsx)(W().ZP,{ref:n,value:i,placeholder:Zn().Z.formatMessage(Dn.searchPlaceholder),focusAfterAnimation:!0,showClearButton:!0,style:{marginBottom:10},onChange:e=>{r(e.target.value)},focusInitial:l.length>0||void 0})}),m=(0,F.jsx)(Ne().Z,{menuType:Ke().o.Popup,header:u,width:300,children:(0,F.jsx)(z().ZP,{type:z().iW.Vertical,style:{marginBottom:0},sections:[{key:"results",items:c,render:e=>(0,F.jsx)(G().Z,{...e})}],initialFocus:l.length>0?0:void 0})});return(0,F.jsx)(De().ZP,{popupType:De().Z4.Popup,renderOrigin:e=>(0,F.jsx)(Ln,{...e,pageStore:s}),originGap:2,render:()=>m,onClose:()=>r("")})}function Ln(e){const{pageStore:t,...n}=e,o=(0,r().yK)((e=>({previewButton:{color:e.text.secondary,fontWeight:C().Ue.medium,display:"flex",gap:6,alignItems:"center",justifyContent:"center",padding:"3px 6px",height:void 0,fontSize:12,overflow:"hidden",maxWidth:"100%"},recordTitle:{...C().Yu,flexGrow:1},previewLabelContainer:{display:"flex",gap:3,minWidth:0},previewLabel:{flexShrink:0},chevronDownIcon:{flexShrink:0,width:10}})),[]);return(0,F.jsx)(Z().Z,{placement:D().Placement.Right,renderTooltip:()=>(0,F.jsx)(w()._H,{defaultMessage:"Choose page to preview",id:"PageLayoutEditorHeader.pagePicker.title"}),render:e=>(0,F.jsxs)(Le().D,{...(0,An().Z)(e,n),style:o.previewButton,children:[(0,F.jsxs)("div",{style:o.previewLabelContainer,children:[(0,F.jsx)("div",{style:o.previewLabel,children:(0,F.jsx)(w()._H,{defaultMessage:"Preview:",id:"PageLayoutEditorHeader.pagePicker.titlePrefix"})}),(0,F.jsx)(Mn().Z,{store:t,style:o.recordTitle})]}),(0,kn().i)(o.chevronDownIcon)]})})}const Dn=(0,w().vU)({searchPlaceholder:{id:"pageLayoutEditor.pagePicker.searchPlaceholder",defaultMessage:"Search pages..."}}),Vn=(0,N().IU)("settingsNotificationsAndPersonal",{viewBox:"0 0 20 20",svg:(0,F.jsx)("path",{d:"M12.5361 7.54883C13.2744 7.54883 13.9033 7.09082 14.1631 6.44141H16.4258C16.7607 6.44141 17.0479 6.14746 17.0479 5.79199C17.0479 5.43652 16.7676 5.14258 16.4258 5.14258H14.1699C13.9102 4.49316 13.2744 4.03516 12.5361 4.03516C11.7979 4.03516 11.1621 4.49316 10.9023 5.14258H3.59473C3.23242 5.14258 2.95215 5.43652 2.95215 5.79199C2.95215 6.14746 3.23926 6.44141 3.59473 6.44141H10.9023C11.1621 7.09082 11.7979 7.54883 12.5361 7.54883ZM12.5361 6.62598C12.0713 6.62598 11.6953 6.25684 11.6953 5.79199C11.6953 5.31348 12.0713 4.95117 12.5361 4.95117C13.0078 4.95117 13.3701 5.31348 13.3701 5.79199C13.3701 6.25684 13.0078 6.62598 12.5361 6.62598ZM3.56738 9.40137C3.23242 9.40137 2.95215 9.68848 2.95215 10.0508C2.95215 10.3994 3.23926 10.6934 3.56738 10.6934H5.91211C6.16504 11.3428 6.80078 11.8076 7.5459 11.8076C8.27734 11.8076 8.91309 11.3428 9.17285 10.6934H16.4053C16.7607 10.6934 17.0479 10.4062 17.0479 10.0508C17.0479 9.68848 16.7676 9.40137 16.4053 9.40137H9.17285C8.91309 8.75195 8.27734 8.29395 7.5459 8.29395C6.80762 8.29395 6.17188 8.75195 5.91211 9.40137H3.56738ZM7.5459 10.8848C7.07422 10.8848 6.70508 10.5156 6.70508 10.0508C6.70508 9.57227 7.07422 9.20996 7.5459 9.20996C8.01758 9.20996 8.37988 9.57227 8.37988 10.0508C8.37988 10.5156 8.01758 10.8848 7.5459 10.8848ZM12.5361 16.0596C13.2744 16.0596 13.9102 15.6016 14.1699 14.9521H16.4258C16.7607 14.9521 17.0479 14.6582 17.0479 14.3027C17.0479 13.9404 16.7676 13.6533 16.4258 13.6533H14.1631C13.9102 13.0039 13.2744 12.5459 12.5361 12.5459C11.7979 12.5459 11.1621 13.0039 10.9023 13.6533H3.59473C3.23242 13.6533 2.95215 13.9473 2.95215 14.3027C2.95215 14.6582 3.23926 14.9521 3.59473 14.9521H10.9023C11.1621 15.6016 11.7979 16.0596 12.5361 16.0596ZM12.5361 15.1436C12.0713 15.1436 11.6953 14.7676 11.6953 14.3027C11.6953 13.8311 12.0713 13.4619 12.5361 13.4619C13.0078 13.4619 13.3701 13.8311 13.3701 14.3027C13.3701 14.7676 13.0078 15.1436 12.5361 15.1436Z"})});const On=function(){const e=(0,w().YB)(),t=(0,i().O7)(),{setModuleSelection:n,currentModuleSelection:a,layoutStore:s,sessionId:l}=(0,$().J9)(),d=void 0===a,c=(0,o.useCallback)((()=>{var e;null==n||n(void 0),(0,g().mV)({environment:t,layoutId:s.id,collectionId:null===(e=s.getCollectionModel())||void 0===e?void 0:e.id,sessionId:l,from:"page_settings_button_click"})}),[n,t,s,l]),u=(0,r().yK)((e=>({button:{...d&&{background:e.state.hover}},icon:{width:18,height:18}})),[d]);return n?(0,F.jsx)(Le().D,{"aria-label":e.formatMessage({id:"pageLayoutEditorPageSettingsButton.ariaLabel",defaultMessage:"Page settings"}),icon:Vn,iconStyle:u.icon,onClick:c,style:u.button,size:"lg",children:(0,F.jsx)(w()._H,{id:"pageLayoutEditorPageSettingsButton.label",defaultMessage:"Page settings"})}):null},Un=(0,N().CZ)("arrowUTurnLeft",{default:{loader:()=>n.e(44621).then(n.bind(n,444621))},small:{loader:()=>n.e(42147).then(n.bind(n,42147))},mini:{loader:()=>n.e(28244).then(n.bind(n,822827))},large:{loader:()=>n.e(1168).then(n.bind(n,701168))}});var Nn=()=>n(242550),Fn=()=>n(366825),Hn=()=>n(830581),Kn=()=>n(921981),En=()=>n(542401),Wn=()=>n(181758),zn=()=>n(104088);const Gn={id:"pageLayoutAreas.page_main",defaultMessage:"main page",description:"Name for the main area of the page"},qn={id:"pageLayoutAreas.page_details",defaultMessage:"sidebar",description:"Name for the details sidebar"},Yn={id:"pageLayoutAreas.form_layout_schema",defaultMessage:"form",description:"Name for the form area"},$n=(0,w().vU)({page_main:Gn,page_layout_schema:Gn,page_details:qn,page_info_layout_schema:qn,form_layout_schema:Yn,form_conditional_modules:Yn,views_main_tab_modules:{id:"pageLayoutAreas.views_main_tab_modules",defaultMessage:"views main tab",description:"Name for the views main tab"},generic:{id:"pageLayoutEditor.generic",defaultMessage:"area"}});function Jn(){const{collectionStore:e,hasUnsavedChanges:t,saveChanges:n,isNewLayout:s,initialLayoutModulesByArea:l,resetLayoutToDefault:d}=(0,$().PP)(),{sessionId:c,layoutStore:m}=(0,$().J9)(),p=(0,i().O7)(),f=(0,w().YB)(),h=(0,a().VK)((()=>m.getModules()),[m]),v=(0,r().yK)((e=>({saveButton:{height:32},saveButtonCheckMarkIcon:{width:14,height:14},saveButtonInner:{lineHeight:1.2,fontSize:14,fontWeight:C().Ue.medium},saveButtonRevertItemTitle:{fontSize:C().JB.UIRegular.desktop,lineHeight:"20px",color:e.text.primary},saveButtonRevertItemSubtitle:{fontSize:C().JB.UISmall.desktop,lineHeight:"16px",color:e.text.secondary},saveButtonRevertItemIcon:{width:16,height:16,marginTop:2,fill:e.primaryBlack},saveButtonRevertItem:{margin:"4px",padding:"0 4px 4px"},saveButtonSectionMenuItem:{minWidth:254,padding:0}})),[]),y=(0,o.useCallback)((t=>{_t().gm({environment:p}),g().tV({environment:p,sessionId:c,collectionId:e.id,existingLayoutId:s?void 0:m.id,layoutSaved:t,context:"layout",initialLayoutModulesByArea:l,finalModulesByArea:h})}),[e.id,p,l,s,m.id,c,h]),b=(0,o.useCallback)((async()=>{if(t)try{await n(),y(!0)}catch(e){if(!(e instanceof Wn().x7))throw e;{const t=e.clientData;if("cannot_move_unmoveable_module"===(null==t?void 0:t.type))xn().UW(f.formatMessage({id:"layoutBuilder.saveButton.error.moduleCannotBeMoved",defaultMessage:"The {moduleType} module cannot be moved."},{moduleType:f.formatMessage(fe().B[t.moduleType]).toLowerCase()}));else if("cannot_remove_undeletable_module"===(null==t?void 0:t.type))xn().UW(f.formatMessage({id:"layoutBuilder.saveButton.error.moduleCannotBeDeleted",defaultMessage:"The {moduleType} module cannot be removed."},{moduleType:f.formatMessage(fe().B[t.moduleType]).toLowerCase()}));else{if("unallowed_module_in_area"!==(null==t?void 0:t.type)){const e=f.formatMessage({id:"layoutBuilder.saveButton.error.fallback",defaultMessage:"Something went wrong while saving layout."});return void xn().UW(e)}{const e={moduleType:f.formatMessage(fe().B[t.moduleType]).toLowerCase(),area:"page_layout_schema"===t.area?f.formatMessage($n.page_main):"page_info_layout_schema"===t.area?f.formatMessage($n.page_details):f.formatMessage($n.generic)};xn().UW(f.formatMessage({id:"layoutBuilder.saveButton.error.unallowedModuleInArea",defaultMessage:"The {moduleType} module is not allowed in {area}."},e))}}}}else y(!1)}),[y,t,f,n]),x=(0,o.useCallback)((()=>{d(),g().Kv({environment:p,context:"layout",sessionId:c,collectionId:e.id,layoutId:s?void 0:m.id}),M(!1),y(!0)}),[y,e.id,p,s,m.id,d,c]),[S,M]=o.useState(!1);return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(De().ZP,{popupType:zn().k.Popup,alignmentToOrigin:D().Alignment.End,originGap:4,render:e=>(0,F.jsx)(G().Z,{style:v.saveButtonSectionMenuItem,children:(0,F.jsx)(E().Z,{onClick:()=>{M(!0),e.close()},focused:!1,itemMarginLeft:0,itemMarginRight:0,style:v.saveButtonRevertItem,body:(0,F.jsxs)(u().gq,{gap:10,children:[(0,Fn().s)(v.saveButtonRevertItemIcon),(0,F.jsxs)(u().Ht,{children:[(0,F.jsx)("div",{style:v.saveButtonRevertItemTitle,children:(0,F.jsx)(w()._H,{id:"pageLayoutEditor.revertToOriginalLayout",defaultMessage:"Reset to original page layout"})}),(0,F.jsx)("div",{children:(0,F.jsx)(w()._H,{id:"pageLayoutEditor.revertToOriginalLayoutSubtitle",defaultMessage:"No properties will be deleted"})})]})]})})}),renderOrigin:e=>(0,F.jsx)(En().Z,{style:v.saveButton,mainButtonStyle:v.saveButtonInner,title:(0,F.jsx)(w()._H,{id:"pageLayoutEditor.saveAndClose",defaultMessage:"Apply to all pages"}),color:"blue",onClick:b,disableDropdown:!1,icon:Nn().A,iconStyle:v.saveButtonCheckMarkIcon,onDropdownClick:e.onClick})}),S&&(0,F.jsx)(Kn().c,{isOpen:!0,showCloseIcon:!0,allowDismissByEscape:!0,onDismiss:()=>M(!1),areaConstraint:{width:{type:"min",length:300}},render:e=>{let{sizeRange:t}=e;return(0,F.jsx)(Hn().sR,{header:(0,F.jsx)(Hn().vI,{iconAndTitle:(0,F.jsx)(Hn().kC,{iconGroup:Un,title:(0,F.jsx)(w()._H,{id:"pageLayoutEditor.revertToOriginalLayout.modal.title",defaultMessage:"Reset to original page layout?"})}),description:(0,F.jsx)(w()._H,{id:"pageLayoutEditor.revertToOriginalLayout.modal.subtitle",defaultMessage:"No properties will be deleted."})}),footer:(0,F.jsx)(Hn().a6,{layout:"vertical",primaryButtons:[{buttonType:"destructive",label:(0,F.jsx)(w()._H,{id:"pageLayoutEditor.revertToOriginalLayout.modal.revertButton",defaultMessage:"Reset"}),onClick:x}],secondaryButtons:[{buttonType:"dismiss",label:(0,F.jsx)(w()._H,{id:"pageLayoutEditor.revertToOriginalLayout.modal.cancelButton",defaultMessage:"Cancel"})}]}),sizeRange:t})}})]})}function Qn(){const e=(0,i().O7)(),{device:t}=e,{isElectron:n,isElectronMac:s}=t,{sessionId:l,layoutStore:d}=(0,$().J9)(),{collectionStore:c,hasUnsavedChanges:m,isNewLayout:p,initialLayoutModulesByArea:f}=(0,$().PP)(),h=(0,a().VK)((()=>d.getModules()),[d]),v=(0,a().VK)((()=>!!n&&!Cn().default.state.isShowingTabBar),[n]),y=(0,a().VK)((()=>(0,bn().R6)(s)),[s]),b=(0,o.useCallback)((async()=>{g().tV({environment:e,sessionId:l,collectionId:c.id,existingLayoutId:p?void 0:d.id,layoutSaved:!1,context:"layout",initialLayoutModulesByArea:f,finalModulesByArea:h});const t=()=>_t().gm({environment:e});if(!m)return void t();const{accept:n}=await xn().gt({message:(0,F.jsx)(w()._H,{id:"pageLayoutEditor.closeConfirmModal.content",defaultMessage:"Discard all layout changes?"}),acceptLabel:(0,F.jsx)(w()._H,{id:"pageLayoutEditor.closeConfirmModal.discard",defaultMessage:"Discard"})});n&&t()}),[e,l,c.id,p,d.id,f,h,m]),x=(0,r().yK)((e=>{const t={pointerEvents:"auto"};return{header:{zIndex:1},headerContent:{display:"flex",position:"relative",margin:"8px 16px 8px 16px"},topbarPlaceholder:{minHeight:y,background:e.onboardingPreviewBackground,borderBottom:`1px solid ${e.stroke.primary}`},sideButtonsContainer:{display:"flex",justifyContent:"space-between",width:"100%",height:"100%",gap:"6px",position:"absolute",left:0,top:0,pointerEvents:"none"},rightButtons:{...t},pageSettingsButtonContainer:{display:"flex",...t},subtitle:{fontSize:C().JB.UISmall.desktop,fontWeight:C().Ue.regular,color:e.text.secondary,alignSelf:"center"},titlePreviewContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",flexGrow:1,position:"relative",...C().Yu},titlePreviewElementContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",maxWidth:400,overflow:"hidden"}}}),[y]);return(0,F.jsxs)("header",{style:x.header,children:[v?(0,F.jsx)("div",{style:x.topbarPlaceholder,className:vn()({[wn().lIT]:!0,[wn().pMC]:!0})}):null,(0,F.jsxs)("div",{style:x.headerContent,children:[(0,F.jsx)("div",{style:x.titlePreviewContainer,children:(0,F.jsxs)("div",{style:x.titlePreviewElementContainer,children:[(0,F.jsx)(Xn,{collectionStore:c}),(0,F.jsx)(Bn,{collectionStore:c})]})}),(0,F.jsxs)(u().gq,{style:x.sideButtonsContainer,alignItems:"center",justifyContent:"space-between",children:[(0,F.jsx)("div",{style:x.pageSettingsButtonContainer,children:(0,F.jsx)(On,{})}),(0,F.jsxs)(u().gq,{gap:8,alignItems:"center",style:x.rightButtons,children:[(0,F.jsx)(Le().D,{onClick:b,icon:yn().U,size:"lg",children:(0,F.jsx)(w()._H,{id:"pageLayoutEditor.close",defaultMessage:"Cancel"})}),(0,F.jsx)(Jn,{})]})]})]})]})}function Xn(e){let{collectionStore:t}=e;const n=(0,r().yK)((e=>({container:{display:"flex",alignItems:"center",justifyContent:"center",gap:4,color:e.text.primary,fontWeight:C().Ue.medium,width:"100%",...C().Yu}})),[]),o=(0,a().VK)((()=>t.getIcon()),[t]);return(0,F.jsxs)("div",{style:n.container,children:[(0,F.jsx)(Sn().Z,{icon:o,size:20,isEmptyPage:!1,disabled:!0}),(0,F.jsx)(Mn().Z,{store:t})]})}function eo(e){const t=(0,r().yK)((e=>({container:{width:"100%",backgroundColor:e.surface.wash,cursor:"default"},innerContainer:{overflowY:"auto",padding:"20px 0 0 24px",height:"100%",marginTop:-20,minWidth:h().DJ,zIndex:0,position:"relative"}})),[]),n=(0,a().VK)((()=>y().Z.getState()),[]),i=n.isOpen&&"layout-editor"===n.mode?n.initialSelectedModuleId:void 0,s=(0,a().qz)(e.layoutBuilderModuleSelectionStore,v().Z),d=n.isOpen&&"layout-editor"===n.mode;return(0,o.useEffect)((()=>{d&&s.setState(i?{type:"existing_module",moduleId:i,isDragging:!1}:void 0)}),[i,d,s]),n.isOpen&&"layout-editor"===n.mode?(0,F.jsxs)(fn,{...n,layoutBuilderModuleSelectionStore:s,children:[e.debugChildForTestsOnly,(0,F.jsxs)(l().Z,{tag:u().Ht,initial:{translateY:5,opacity:0},animate:{translateY:0,opacity:1},config:{duration:650,timingFunction:"ease-in-out"},style:t.container,children:[(0,F.jsx)(Qn,{}),(0,F.jsxs)(u().gq,{style:t.innerContainer,children:[(0,F.jsx)(to,{}),(0,F.jsx)(Qt,{})]})]})]}):null}function to(){const{pageStore:e}=(0,$().PP)(),{setModuleSelection:t,layoutBuilderModuleSelectionStore:n,layoutStore:o,sessionId:l}=(0,$().J9)(),u=(0,i().O7)(),v=(0,a().VK)((()=>{var e;return Boolean(null===(e=n.state)||void 0===e?void 0:e.isDragging)}),[n]),y=(0,a().VK)((()=>{const t=(0,h().f8)(u);switch(t){case"xSmall":case"small":return"layout-editor-narrow";case"medium":case"large":case"xLarge":return e.isFullWidth()?"layout-editor-wide":"layout-editor";default:(0,s().t1)(t)}}),[u,e]),b=(0,a().VK)((()=>(0,f().h)(u).totalWidth),[u]),x=(0,a().VK)((()=>e.hasCover()),[e]),S=(0,r().yK)((e=>({container:{height:"100%",background:e.contentBackground,flexGrow:3,borderRadius:"12px 12px 0 0",boxShadow:"0px 9px 12px 0px rgba(15, 15, 15, 0.1)",borderColor:e.accentColors.gray[75],borderWidth:1,overflowY:"auto",display:"flex",...v?{cursor:"grabbing"}:{}},mainPage:{flex:3,paddingTop:x?void 0:24},sidebarScroller:{borderLeft:`solid 1px ${e.outlineBlueButtonPressedBackground}`,height:"100%"},mainPageContainer:{flex:1,height:"100%"},mainPageScrollContainer:{height:"100%"},sidebar:{padding:f().i,marginBottom:100,flex:1,minWidth:b,maxWidth:b,width:b,transition:"width 0.1s, min-width 0.1s, max-width 0.1s"}})),[v,x,b]);return(0,F.jsxs)("div",{role:"presentation",style:S.container,onClick:e=>{(0,m().ZP)({event:e,context:m().Af.EditorClick,callback:()=>{var e;t(void 0),(0,g().mV)({environment:u,layoutId:o.id,collectionId:null===(e=o.getCollectionModel())||void 0===e?void 0:e.id,sessionId:l,from:"background_click"})}})},children:[(0,F.jsx)(ln().E,{area:"page_main",style:S.mainPageContainer,children:(0,F.jsx)(c().F,{children:(0,F.jsx)(d().T,{type:p().Z.Y,style:S.mainPageScrollContainer,children:(0,F.jsx)("div",{style:S.mainPage,children:(0,F.jsx)(dn().Xg,{type:y,children:(0,F.jsx)(sn().v,{area:"page_main"})})})})})}),(0,F.jsx)(ln().E,{area:"page_details",children:(0,F.jsx)(d().T,{type:p().Z.Y,style:S.sidebarScroller,children:(0,F.jsx)("div",{style:S.sidebar,children:(0,F.jsx)(sn().v,{area:"page_details"})})})})]})}},895513:(e,t,n)=>{n.r(t),n.d(t,{ConfigureViewsMainModuleAddNewViewButtonWrapper:()=>A});n(267602),n(653476),n(241792);var o=n(667294),i=()=>n(492788),a=()=>n(219727),r=()=>n(142735),s=()=>n(846550),l=()=>n(263184),d=()=>n(226413),c=()=>n(766933),u=()=>n(752778),m=()=>n(788860),p=()=>n(696459),g=()=>n(250303),f=()=>n(139224),h=()=>n(888686),v=()=>n(427886),y=()=>n(716025),b=()=>n(827973),x=()=>n(448419),S=()=>n(198829),M=()=>n(255577),w=()=>n(967092),C=()=>n(388284),j=()=>n(347577),k=()=>n(352230),T=()=>n(998901),I=()=>n(104088),_=()=>n(754664),P=()=>n(162178),Z=n(785893);function A(e){let{renderOrigin:t,onClose:n}=e;const[i,s]=(0,o.useState)(!1),c=(0,o.useRef)(null),m=(0,a().O7)(),{layoutStore:g}=(0,P().J9)(),h=(0,o.useContext)(P().eK),y=null==h?void 0:h.moduleStateByIdStore,b=(0,r().VK)((()=>{var e;const t=g.getModuleByType("viewsMain");if(t)return null==y||null===(e=y.get(t.id))||void 0===e?void 0:e.collectionContextStore}),[g,y]),S=(0,o.useCallback)(((e,t)=>{b&&((0,v().f)({environment:m,collectionContextStore:b,collectionViewId:e.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1}),f().r$({collectionContextStore:b,collectionSettingsStore:b.settingsStore,closeOnEscape:!1}))}),[m,b]),M=(0,r().VK)((()=>{var e;const t=null===(e=g.getParentStore())||void 0===e?void 0:e.getModel();if((null==t?void 0:t.table)===u().vF)return t}),[g]),w=(0,r().VK)((()=>{const e=null==M?void 0:M.getNormalizedSchema();return Object.entries(e??{}).filter((e=>{let[t,n]=e;return(0,p().$K)(n)&&(0,d().p_)(n)&&n.property}))}),[M]),C=(0,o.useCallback)((()=>{s(!1),null==n||n()}),[n]),j=(0,o.useCallback)((()=>{s(!0)}),[s]),k=(0,o.useMemo)((()=>l().default.createValue({open:!1,stack:[]},{name:"newViewsCreationMenuCollectionSettingsStore"})),[]),_=(0,o.useCallback)((()=>{const e=null==b?void 0:b.viewsModuleContextStore.getViewsModule();e&&f().wl({collectionSettingsStore:k,item:{type:"selectViewsModuleSource",module:e}})}),[null==b?void 0:b.viewsModuleContextStore,k]),A=(0,o.useCallback)((()=>{f().E3({collectionSettingsStore:k})}),[k]),L=(0,o.useCallback)((()=>(0,Z.jsx)(R,{setIsOpen:s,onClose:n,relations:w,setCurrentViewPointer:S,collectionModel:M,viewsMainModuleCollectionContextStore:b,openViewsCreationPopup:_})),[n,w,S,M,b,_]),D=(0,o.useCallback)((e=>t(e)),[t]);return b&&M?(0,Z.jsxs)("div",{ref:c,children:[(0,Z.jsx)(x().ZP,{alignmentToOrigin:T().Alignment.Center,popupType:I().k.Popup,onClose:C,onClick:j,open:i,render:L,renderOrigin:D,disablePopup:!0}),(0,Z.jsx)(B,{buttonRef:c,viewsMainModuleCollectionContextStore:b,viewsCreationMenuCollectionSettingsStore:k,openViewsCreationPopup:_,closeViewsCreationPopup:A})]}):null}function R(e){let{setIsOpen:t,onClose:n,relations:r,setCurrentViewPointer:l,collectionModel:d,viewsMainModuleCollectionContextStore:u,openViewsCreationPopup:p}=e;const{layoutStore:f,setModuleSelection:h}=(0,P().J9)(),v=(0,a().O7)(),x=(0,s().Fg)(),w=(0,o.useMemo)((()=>{if(0!==r.length)return{key:0,items:[],render:e=>(0,Z.jsx)(C().Z,{...e,title:(0,Z.jsx)(m()._H,{...L.relatedToDatabase,values:{database:null==d?void 0:d.getName()}}),children:r.map((e=>{let[t,o]=e;return(0,Z.jsx)(b().Z,{title:null==o?void 0:o.name,icon:(0,Z.jsx)(c().ZP,{size:16,theme:x,icon:null==o?void 0:o.icon,type:"relation"}),focused:!1,onClick:()=>{if(!u)return;const{viewsMainModule:e,collectionViewPointer:a}=(0,_().pd)({environment:v,layoutStore:f,relationPropertyId:(null==o?void 0:o.property)??t,targetCollectionPointer:(null==o?void 0:o.collection_pointer)??(null==d?void 0:d.pointer),viewName:null==o?void 0:o.name,viewIcon:null==o?void 0:o.icon});e&&h({type:"existing_module",moduleId:e.id,isDragging:!1}),a&&(i().default.afterNextFlush((()=>{l(a,null==e?void 0:e.id),null==n||n()})),u&&g().xb({environment:v,view_type:"table",collectionContextStore:u}))}},t)}))})}}),[u,d,v,f,n,r,l,h,x]),j=(0,o.useMemo)((()=>{const e=r.length>0;return{key:1,items:[],render:t=>(0,Z.jsx)(C().Z,{...t,topBorder:e,children:(0,Z.jsx)(b().Z,{title:(0,Z.jsx)(m()._H,{...L.linkExistingDatabase}),icon:(0,Z.jsx)(y().F,{color:"regular",viewType:"table"}),onClick:()=>{p()},focused:!1},"link_existing_database")})}}),[p,r.length]);return(0,Z.jsx)(S().Z,{menuType:k().o.Popup,onClick:()=>t(!1),width:270,paddingBottom:2,children:(0,Z.jsx)(M().ZP,{initialFocus:void 0,sections:[w,j].filter((e=>void 0!==e)),type:M().iW.Vertical})})}function B(e){var t;let{buttonRef:n,viewsMainModuleCollectionContextStore:o,viewsCreationMenuCollectionSettingsStore:i,closeViewsCreationPopup:a}=e;const s=(0,r().VK)((()=>i.state.open),[i]);return(0,Z.jsx)(w().ZP,{open:s,popupType:I().k.Popup,render:()=>(0,Z.jsx)(h().A,{context:j().HV.TopbarFilterPopup,collectionContextStore:o,collectionSettingsStore:i,hideDesktopHeader:!0}),originRect:null===(t=n.current)||void 0===t?void 0:t.getBoundingClientRect(),alignmentToOrigin:T().Alignment.Center,placementToOrigin:T().Placement.Bottom,enableOutsideClickDismiss:!0,originGap:4,onDismiss:()=>{a()}})}const L=(0,m().vU)({relatedToDatabase:{defaultMessage:"Related to {database}",id:"pageLayout.configureViews.relatedToDatabase"},linkExistingDatabase:{defaultMessage:"Link existing database",id:"pageLayout.configureViews.linkAnExistingDatabase"},newView:{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView"},newRelation:{defaultMessage:"New relation",id:"pageLayout.configureViews.newRelation"},back:{defaultMessage:"Back",id:"collectionsSettingsMenu.back"}})},274707:(e,t,n)=>{n.d(t,{Z4:()=>r,yP:()=>a});var o=()=>n(677559);const i={TopbarLayoutInfoButtonEducationTooltip:new(o().Ss)("TopbarLayoutInfoButtonEducationTooltip",(()=>Promise.all([n.e(62743),n.e(36815)]).then(n.bind(n,811418)))),BuilderAddModuleButtonEducationTooltip:new(o().Ss)("BuilderAddModuleButtonEducationTooltip",(()=>n.e(41103).then(n.bind(n,737690))))},a=(0,o().kF)(i.TopbarLayoutInfoButtonEducationTooltip,(e=>e.default),{renderLoading:(e,t)=>t.children}),r=(0,o().kF)(i.BuilderAddModuleButtonEducationTooltip,(e=>e.default))},8564:(e,t,n)=>{n.d(t,{v:()=>W});n(821057),n(241792);var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(846550),s=()=>n(66006),l=()=>n(766537),d=()=>n(628370),c=()=>n(119891),u=()=>n(796408),m=()=>n(275200),p=()=>n(280977),g=()=>n(99537),f=()=>n(294630),h=()=>n(602801),v=()=>n(896641),y=(n(492176),n(7961),n(267602),n(653476),()=>n(842631)),b=()=>n(210349),x=()=>n(788860),S=()=>n(1910),M=()=>n(654133),w=()=>n(247724),C=()=>n(466970),j=()=>n(75433),k=()=>n(998901),T=()=>n(243144),I=()=>n(274860),_=()=>n(162178),P=n(785893);const Z=(0,x().vU)({formLayoutAddModule:{id:"addModuleHoverMenu.formLayout.add",defaultMessage:"Add question"},pageLayoutAddModule:{id:"addModuleHoverMenu.pageLayout.add",defaultMessage:"Add"}}),A=32;function R(e){if("views_main_tab_modules"===e.area)throw new Error("[ViewsMain Not Implemented] AddModuleHoverMenu not implemented for views_main_tab_modules");const t=(0,x().YB)(),{layoutStore:n,addModuleHoverMenuStore:o,currentModuleSelection:i}=(0,_().J9)(),s=(0,a().VK)((()=>{if(o.state.isOpen)return o.state.moduleId}),[o]),l=(0,a().VK)((()=>{if(!s)return;const e=j().Z.findModuleContainer({layoutStore:n,moduleId:s});return e?e.getNode():void 0}),[s,n]),c=(0,a().VK)((()=>{if(!i||"new_module"===i.type)return!1;const e=n.getModuleById(i.moduleId);return"placeholder"===(null==e?void 0:e.type)}),[i,n]),u=(0,C().E)("layout_view_module"),m=(0,a().VK)((()=>{var t;if("views_main_tab_modules"===e.area)throw new Error("[ViewsMain Not Implemented] AddModuleHoverMenu not implemented for views_main_tab_modules");if("form_conditional_modules"===e.area)return!1;const i=n.getModules()[e.area].filter((e=>(0,b().s)(e,{isLayoutViewModuleEnabled:u}))),a=0===i.length||(null===(t=i.at(-1))||void 0===t?void 0:t.id)===s;return o.state.isOpen&&!c&&!a}),[o,s,c,u,n,e.area]),p=(0,I().G)({area:e.area,afterModuleId:s}),g=(0,T().F)(),f=(0,r().yK)((e=>({bigRoundButton:{...g.button,width:A,height:A,borderTopLeftRadius:"100%",borderTopRightRadius:"100%",borderBottomLeftRadius:"100%",transform:"rotate(-45deg)"},bigRoundButtonHovered:{...g.buttonHovered},bigRoundButtonPressed:{...g.buttonPressed}})),[g]),h="form"===(0,a().VK)((()=>{var e;return null===(e=n.getModel())||void 0===e?void 0:e.getLayoutType()}),[n])?t.formatMessage(Z.formLayoutAddModule):t.formatMessage(Z.pageLayoutAddModule),v=l?l.offsetLeft-40:void 0,R=l?l.offsetTop+l.offsetHeight-4:void 0;return(0,P.jsx)(d().Z,{visible:m,animate:{opacity:1,scale:1,transformOrigin:"center right"},initial:{opacity:0,scale:.3,transformOrigin:"center right"},exit:{opacity:0,scale:.3,transformOrigin:"center right"},style:{position:"absolute",left:v,top:R},children:(0,P.jsx)(M().Z,{placement:k().Placement.Left,renderTooltip:()=>h,render:e=>(0,P.jsx)(S().Z,{...e,style:f.bigRoundButton,hoveredStyle:f.bigRoundButtonHovered,className:w().AWi,pressedStyle:f.bigRoundButtonPressed,onClick:p,icon:y().A,iconStyle:{width:16,height:16,transform:"rotate(45deg)"},isBlue:!0,ariaLabel:h})})})}var B=()=>n(251932),L=()=>n(42392),D=()=>n(857719);const V=(0,x().vU)({addPageModule:{id:"pageLayout.builder.addModuleToPage.button.ariaLabel",defaultMessage:"Add page module"},addQuestionModuleTooltip:{id:"pageLayout.builder.addModuleToPage.button.addQuestionModuleTooltip",defaultMessage:"Add question"},addModuleToPanelButton:{id:"pageLayout.builder.addModuleToPanel.button.label",defaultMessage:"Add to panel"}}),O=o.forwardRef((function(e,t){const{area:o}=e,{layoutStore:i}=(0,_().J9)(),s=(0,a().VK)((()=>i.getLayoutType()),[i]),l=(0,x().YB)(),d=(0,T().F)(),c=(0,r().yK)((e=>({bigRoundButton:{...d.button,width:32,height:32,borderRadius:"100%"},bigRoundButtonHovered:{...d.buttonHovered},bigRoundButtonPressed:{...d.buttonPressed},emptyModuleAreaAddButton:{cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 16px 8px 12px",fontSize:14,lineHeight:"20px",fontWeight:500,background:"light"===e.mode?e.accentColors.uiBlue[100]:e.accentColors.uiBlue[200],color:e.accentColors.uiBlue[600],borderRadius:28,transition:"background 0.2s"},emptyModuleAreaAddButtonHover:{...d.buttonHovered},emptyModuleAreaAddButtonPressed:{...d.buttonPressed}})),[d]),u=(0,I().G)("views_main_tab_modules"===o?{area:o,viewsMainTabId:e.viewsMainTabId}:{area:o});if("form_conditional_modules"===o)throw new Error("[Forms Conditional Logic Not Implemented] AddPageLayoutModuleButton not implemented for form_conditional_modules yet.");const m=(0,a().VK)((()=>{var t;const n=i.getModules();return("views_main_tab_modules"===o?(null===(t=n[o])||void 0===t?void 0:t[e.viewsMainTabId])||[]:n[o]).length>0}),[i,o,e.viewsMainTabId]);return"page_details"!==o||m?(0,P.jsx)(M().Z,{renderTooltip:()=>l.formatMessage(V.addQuestionModuleTooltip),disableTooltip:"form"!==s,placement:k().Placement.Bottom,render:e=>(0,P.jsx)(S().Z,{style:c.bigRoundButton,hoveredStyle:c.bigRoundButtonHovered,pressedStyle:c.bigRoundButtonPressed,onClick:u,icon:y().A,iconStyle:{width:16,height:16},isBlue:!0,className:w().AWi,ariaLabel:l.formatMessage(V.addPageModule),ref:t,...e})}):(0,P.jsxs)(n(745740).Z,{style:c.emptyModuleAreaAddButton,onClick:u,hoveredStyle:c.emptyModuleAreaAddButtonHover,pressedStyle:c.emptyModuleAreaAddButtonPressed,ref:t,children:[(0,n(490670).f)({width:12,marginRight:4}),(0,P.jsx)(x()._H,{...V.addModuleToPanelButton})]})})),U=o.memo((function(e){var t;const{shouldShowTooltip:i}=(0,n(946650).w)(),{area:r}=e,s=i&&"page_main"===r,l=i&&"form_layout_schema"!==r,d=o.useRef(null),{currentModuleSelection:c,layoutStore:u,setModuleSelection:m,isPropertyTypeSearchInputDirtyStore:p}=(0,_().J9)(),g=(0,a().VK)((()=>"existing_module"===(null==c?void 0:c.type)?u.getModuleById(c.moduleId):void 0),[c,u]),f=(0,a().VK)((()=>{var t;if("form_conditional_modules"===r)throw new Error("[Forms Conditional Logic Not Implemented] AddPageLayoutModuleButton not implemented for form_conditional_modules yet.");const n=u.getModules();return("views_main_tab_modules"===r?(null===(t=n[r])||void 0===t?void 0:t[e.viewsMainTabId])||[]:n[r]).length>0}),[u,r,e.viewsMainTabId]),[h,v]=o.useState(!1),y=o.useCallback((()=>{p.state||m(void 0)}),[p,m]);return"new_module"===(null==c?void 0:c.type)&&c.area===e.area?(0,P.jsx)(n(94967).Z,{onUndo:y,capture:!0,priority:1,debugName:"AddPageLayoutModuleButton",children:(0,P.jsx)(N,{})}):"placeholder"===(null==g?void 0:g.type)?null:s||l?(0,P.jsxs)(B().gq,{justifyContent:"center",style:null===(b=e.styles)||void 0===b?void 0:b.buttonContainer,className:D().Vc,children:[(0,P.jsx)(L().p,{shape:"page_main"===e.area?"circle":"pill",size:"page_main"===e.area||f?32:34,onDependencyLoaded:()=>v(!0),children:(0,P.jsx)(O,{isEducationCalloutVisible:s,...e,ref:d})}),s&&h&&(0,P.jsx)(n(274707).Z4,{buttonRef:d})]}):(0,P.jsx)(B().gq,{justifyContent:"center",style:null===(t=e.styles)||void 0===t?void 0:t.buttonContainer,className:D().Vc,children:(0,P.jsx)(O,{isEducationCalloutVisible:!1,ref:d,...e})});var b}));function N(){const e=(0,r().yK)((e=>({ghostPageModuleContainer:{paddingBottom:12},ghostPageModule:{width:"100%",height:160,background:e.accentColors.uiBlue[75],borderRadius:12,boxShadow:`0px 0px 0px 0px ${e.stroke.uiBlueSecondary}, inset 0px 0px 0px 1px ${e.stroke.uiBlueSecondary}`}})),[]);return(0,P.jsx)("div",{style:e.ghostPageModuleContainer,className:D().Vc,children:(0,P.jsx)(L().p,{shape:"square",borderRadius:e.ghostPageModule.borderRadius,width:e.ghostPageModule.width,height:e.ghostPageModule.height,children:(0,P.jsx)("div",{style:e.ghostPageModule})})})}var F=()=>n(513670);const H=12;function K(){const{addModuleHoverMenuStore:e}=(0,_().J9)(),t=(0,h().j)(),n=(0,o.useCallback)((n=>{const o=j().Z.getMembersByDOMOrder({filter:e=>"cover"!==e.moduleType&&"form_conditional_modules"!==e.area});let i=null;for(const e of o){const o=e.getNode();if(!o)continue;const a=o.getBoundingClientRect();if(n.clientX>a.right||n.clientX<a.left&&a.left-n.clientX>300)continue;if(n.clientY<=a.bottom&&a.bottom-n.clientY<H||n.clientY>a.bottom&&n.clientY-a.bottom<H+t){i=e;break}}if(i)e.setState({isOpen:!0,moduleId:i.moduleId,menuIsOpen:!1});else{const t=e.getState();t.isOpen&&!t.menuIsOpen&&e.setState({isOpen:!1})}}),[e,t]),i=F().P2(n,30);return(0,o.useEffect)((()=>(window.addEventListener("mousemove",i),()=>{window.removeEventListener("mousemove",i)})),[i]),null}var E=()=>n(547559);function W(e){const{area:t}=e;if("form_conditional_modules"===t)throw new Error("[Forms Conditional Logic] Can't render builder layout modules for nested form_conditional_modules directly.");const n=(0,i().O7)(),{sessionId:y,layoutStore:b,currentModuleSelection:x,setModuleSelection:S,canEditLayout:M,layoutBuilderModuleSelectionStore:w}=(0,_().J9)(),C=(0,o.useRef)(null),j=(0,v().L)({layoutStore:b,pageStoreId:void 0}),k=(0,a().VK)((()=>b.isTabbedPageLayout()),[b]),T=(0,h().j)(),{nonMoveableHeaderModules:I,moveableModules:Z,nonMoveableFooterModules:A}=(0,a().VK)((()=>{var n;const o="views_main_tab_modules"===t?(null===(n=j[t])||void 0===n?void 0:n[null==e?void 0:e.viewsMainTabId])||[]:j[t];return(0,l().Lk)(t,o)}),[t,j,null==e?void 0:e.viewsMainTabId]),B=(0,a().VK)((()=>{const e=w.state;if(null!=e&&e.isDragging){const n=e.draggingModuleInitialArea,o=e.draggingModuleFinalArea;return{isDraggingIntoThisArea:n.area!==t&&o.area===t,isDraggingFromThisAreaToOtherArea:n.area===t&&o.area!==t,isDraggingAnyModuleList:!0,dragArea:o}}return{isDraggingIntoThisArea:!1,isDraggingFromThisAreaToOtherArea:!1,isDraggingAnyModuleList:!1,dragArea:void 0}}),[t,w]),L=Z.map((e=>"form_layout_schema"===t?{key:e.id,draggable:"placeholder"!==e.type}:{key:e.id,draggable:!0})),V=(0,o.useMemo)((()=>new(p().Z)),[]),O=(0,a().VK)((()=>V.state.isDragging),[V]),N=(0,a().VK)((()=>{var e;return null===(e=b.getModel())||void 0===e?void 0:e.getLayoutType()}),[b]);(0,o.useEffect)((()=>{C.current&&B.isDraggingIntoThisArea&&(0,m().n5)({element:C.current,environment:n,additionalPadding:{top:200,bottom:200}})}),[B.isDraggingIntoThisArea,n]);const F=(0,o.useCallback)((n=>{const o="views_main_tab_modules"===t?{area:"views_main_tab_modules",viewsMainTabId:e.viewsMainTabId}:{area:t};S({type:"existing_module",moduleId:n,isDragging:!0,draggingModuleInitialArea:o,draggingModuleFinalArea:o})}),[t,e.viewsMainTabId,S]),H=(0,o.useCallback)((e=>{e&&S({type:"existing_module",moduleId:e,isDragging:!1})}),[S]),W=(0,o.useCallback)((()=>{const e=w.state,t=b.getLayoutType();t&&(0,s().K)(t)?S(void 0):null!=e&&e.isDragging&&w.setState({...e,isDragging:!1,draggingModuleInitialArea:void 0,draggingModuleFinalArea:void 0})}),[w,S,b]),z=(0,o.useCallback)((e=>{const o=w.state,i=null!=o&&o.isDragging?o.draggingModuleFinalArea:void 0;"form_conditional_modules"!==(null==i?void 0:i.area)&&(null!=e&&e.key&&i&&i.area!==t&&((0,g().ST)({environment:n,position:{type:"area_relative",location:"end_moveable",..."views_main_tab_modules"===i.area?{area:i.area,viewId:i.viewsMainTabId}:{area:i.area}},moduleId:e.key,layoutStore:b,sessionId:y}),(0,f().O)({moduleId:e.key,layoutStore:b,environment:n})),W())}),[w,t,W,n,b,y]),G=(0,o.useCallback)((o=>{let{key:i,endPosition:a,startPosition:r}=o;if(B.isDraggingFromThisAreaToOtherArea)return;const s=I.length,l="views_main_tab_modules"===t?{area:"views_main_tab_modules",viewId:e.viewsMainTabId}:{area:t};(0,g().ST)({environment:n,layoutStore:b,position:{type:"absolute",index:s+a,...l},moduleId:i,sessionId:y}),(0,f().O)({moduleId:i,layoutStore:b,environment:n})}),[B.isDraggingFromThisAreaToOtherArea,I.length,t,e.viewsMainTabId,n,b,y]),q=(0,r().yK)((e=>({draggableList:{display:"flex",flexDirection:"column",gap:T,marginBottom:T},addButtonContainer:{paddingTop:"page_in_collection"===N?8:0,marginBottom:"form"===N?0:12,width:"100%"},dropzoneHalo:{background:u().e2,height:u().D0,marginTop:-u().D0},hiddenModuleStyle:{display:"none"}})),[T,N]),Y=(0,o.useCallback)((e=>{const n="existing_module"===(null==x?void 0:x.type)&&x.moduleId===e,o=n&&O;return(0,P.jsx)(E().x,{active:n,pageModuleId:e,isDragging:o,area:t,style:o&&B.isDraggingFromThisAreaToOtherArea?q.hiddenModuleStyle:void 0},e)}),[B.isDraggingFromThisAreaToOtherArea,x,O,q.hiddenModuleStyle,t]),$=(0,o.useMemo)((()=>I.length?I.map((e=>Y(e.id))):null),[I,Y]),J=(0,o.useMemo)((()=>A.length?A.map((e=>Y(e.id))):null),[A,Y]),Q=(0,o.useMemo)((()=>({enter:{opacity:0},animate:{opacity:1},exit:{opacity:0}})),[]),X=(0,o.useMemo)((()=>({buttonContainer:q.addButtonContainer})),[q.addButtonContainer]);if(!b)return null;let ee;return ee=!!M&&(!k||("views_main_tab_modules"===t||"page_details"===t)),(0,P.jsxs)(P.Fragment,{children:[$,!!L.length&&(0,P.jsx)(c().ZP,{forceDragKeyIndex:B.isDraggingFromThisAreaToOtherArea?L.length-1:void 0,className:D().Vc,store:V,keys:L,direction:"vertical",onDraggingKeyChanged:F,onDrop:(e,t)=>{G(t)},onDragCancel:W,onDragEnd:z,onClick:H,style:q.draggableList,draggingStyle:{display:void 0},draggingStyleForNonDraggedItems:{display:void 0},renderKey:Y,disabled:!M,...k?{}:{hoverCursorStyleOverride:B.isDraggingAnyModuleList?"grabbing":void 0}}),(0,P.jsx)(d().Z,{visible:B.isDraggingIntoThisArea,initial:Q.enter,animate:Q.animate,exit:Q.exit,skip:!B.isDraggingAnyModuleList,className:"layout-content",ref:C,style:q.dropzoneHalo}),ee&&(0,P.jsx)(U,{...e,styles:X}),"form"===N&&M&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(K,{}),(0,P.jsx)(R,{area:t})]}),J]})}},583824:(e,t,n)=>{n.d(t,{E:()=>r});var o=n(667294),i=()=>n(582025),a=n(785893);const r=o.memo((function(e){let{area:t,viewsMainTabId:r,children:s,className:l,style:d}=e;const{layoutBuilderModuleSelectionStore:c,layoutStore:u}=(0,n(162178).J9)(),m=(0,o.useCallback)((()=>{const e=c.state;if(null==e||!e.isDragging)return;const n=e.moduleId,o=u.getModuleById(n);o&&(0,i().B)(o,t)&&("page_main"===t&&u.isTabbedPageLayout()||c.setState({...e,draggingModuleFinalArea:{..."views_main_tab_modules"===t?{area:t,viewsMainTabId:r}:{area:t}}}))}),[t,c,u,r]),p=(0,o.useCallback)((()=>{const e=c.state;if(null==e||!e.isDragging)return;const n=e.moduleId,o=u.getModuleById(n);o&&(0,i().B)(o,t)&&c.setState({...e,draggingModuleFinalArea:e.draggingModuleInitialArea})}),[t,c,u]);return(0,a.jsx)("div",{onMouseEnter:m,onMouseLeave:p,className:l,style:d,children:s})}))},560801:(e,t,n)=>{n.d(t,{Z:()=>o});class o extends(()=>n(263184))().default{getInitialState(){return{isOpen:!1}}}},367933:(e,t,n)=>{n.d(t,{Z:()=>o});class o extends(()=>n(263184))().default{getInitialState(){}}},776958:(e,t,n)=>{n.d(t,{W:()=>a,Z:()=>s});var o=n(667294),i=n(785893);const a=16;function r(e){let{icon:t,style:o,size:r=a}=e;return(0,i.jsx)(n(643051).Z,{type:"notion_icon",size:r,icon:`/icons/${t}_lightgray.svg`,largeIcon:!0,style:o})}const s=o.memo(r)},957001:(e,t,n)=>{n.d(t,{Z:()=>x});var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(846550),s=()=>n(707513),l=()=>n(654133),d=()=>n(641506),c=()=>n(998901),u=()=>n(170210),m=()=>n(263184);class p extends m().default{getInitialState(){}}class g extends m().default{getInitialState(){return!1}}var f=()=>n(696459),h=n(785893);const v=function(e){let{additionalStyles:t,transitionMs:o,force:i,children:a}=e;const s=(0,n(187784).f)(),l=(0,r().yK)((()=>{let e;switch(i){case"forceShow":e=1;break;case"forceHide":e=0;break;case void 0:e=s?1:0;break;default:(0,f().t1)(i)}return{hoverStyle:{opacity:e,transition:`opacity ${(0,f().$K)(o)?o:200}ms ease-in`,...t}}}),[t,i,s,o]);return(0,h.jsx)("div",{style:l.hoverStyle,children:a})};var y=()=>n(776958);function b(e){let{icon:t,title:n,tooltip:o,hasRightElement:a,iconContainerStyle:u}=e;const m=(0,i().O7)(),p=(0,r().yK)((e=>({panelTitleAndIcon:{display:"flex",alignItems:"center",fontSize:(0,d().yv)(m,"UISmall"),fontWeight:s().Ue.medium,color:e.text.secondary,fill:e.mediumIconColor,flexShrink:0,maxWidth:a?200:"100%"},title:{...s().Yu},panelIconContainer:{display:"flex",alignItems:"center",justifyContent:"center",width:y().W,height:y().W,marginRight:8,marginTop:1,...u}})),[m,u,a]);return n?(0,h.jsx)(l().Z,{renderTooltip:()=>o,disableTooltip:!o,placement:c().Placement.Top,alignment:c().Alignment.Start,render:e=>(0,h.jsxs)("div",{style:p.panelTitleAndIcon,...e,children:[(0,h.jsx)("div",{style:p.panelIconContainer,children:t}),(0,h.jsx)("span",{style:p.title,children:n})]})}):null}const x=function(e){let{children:t,title:s,icon:l,tooltip:d,iconContainerStyle:c,panelStyle:m,headerStyle:f,rightStyle:y,actions:x,right:S,disableRightFadeIn:M,disableActionsFadeIn:w,hideWrapStyle:C,actionsGap:j}=e;const k=(0,i().MO)(),T=Boolean(s),I=Boolean(S),_=(0,a().qz)(void 0,g),P=(0,a().qz)(void 0,p),Z=(0,o.useMemo)((()=>({isHoveredOnPanelStore:_,sizeStore:P})),[_,P]),A=(0,o.useCallback)((()=>_.setState(!0)),[_]),R=(0,o.useCallback)((()=>_.setState(!1)),[_]),B=(0,o.useCallback)((e=>{e.width<u().d_?P.setState("narrow"):P.setState("wide")}),[P]),L=(0,r().yK)((e=>({tile:{userSelect:"none",WebkitUserSelect:"none"},panel:C?{}:{paddingLeft:12,paddingRight:12,...(0,u().KI)({isPhone:k,theme:e}),...m},headerContainer:{flexShrink:0,display:"flex",justifyContent:"space-between",alignItems:"center",height:n(706363).Ct,marginLeft:u().pW,...f},rightActions:{display:"flex",flexDirection:"row",alignItems:"center"},actions:{display:"flex",alignItems:"center",gap:j??6,paddingLeft:6}})),[k,C,m,f,j]),D=(T||I)&&(0,h.jsxs)("div",{style:L.headerContainer,children:[(0,h.jsx)(b,{title:s,icon:l,tooltip:d,hasRightElement:I,iconContainerStyle:c}),(I||x)&&(0,h.jsxs)("div",{style:L.rightActions,children:[I&&(0,h.jsx)(v,{force:M?"forceShow":void 0,additionalStyles:y,children:S}),x&&(0,h.jsx)(v,{force:w?"forceShow":void 0,additionalStyles:L.actions,children:x})]})]});return(0,h.jsx)(n(38160).u.Provider,{value:Z,children:(0,h.jsxs)("div",{style:L.tile,onMouseEnter:A,onMouseLeave:R,children:[D,(0,h.jsx)(n(965865).n4,{onSizeChange:B,children:(0,h.jsx)("div",{style:L.panel,children:t})})]})})}},187784:(e,t,n)=>{n.d(t,{f:()=>r});var o=n(667294),i=()=>n(142735),a=()=>n(38160);function r(){var e;const t=null===(e=(0,o.useContext)(a().u))||void 0===e?void 0:e.isHoveredOnPanelStore;return(0,i().VK)((()=>Boolean(null==t?void 0:t.getState())),[t])}},38160:(e,t,n)=>{n.d(t,{u:()=>o});const o=(0,n(667294).createContext)({isHoveredOnPanelStore:void 0,sizeStore:void 0});o.displayName="HomePanelContext"},436094:(e,t,n)=>{n.d(t,{O:()=>r});n(122556),n(582845),n(250570),n(533019),n(721473),n(788208),n(22624);var o=()=>n(890085),i=()=>n(321160),a=()=>n(338530);function r(e){let{icon:t,theme:n}=e;if(t)return(0,i().Z)(t)?a().Z.state.emojiByColorProcessed[t]:(0,o().V2)(t)?function(e){var t;let{uri:n,theme:i}=e;const a=null===(t=n.match(/\/icons\/[\w\-]*_(.+)\.svg/))||void 0===t?void 0:t[1];if(!function(e){if(!e)return!1;return s.has(e)}(a))return;return o().Lr[i.mode][a]}({uri:t,theme:n}):void 0}const s=new Set((0,n(696459).Yd)(o().Lr.light))},884310:(e,t,n)=>{n.d(t,{Z:()=>i});n(267602),n(470928);class o extends(()=>n(442))().Z{findCollectionTemplatePickerItemFromStore(e){if(e)return this.find((t=>(null==t?void 0:t.templateStore)===e))}}const i=new o},915914:(e,t,n)=>{n.r(t),n.d(t,{default:()=>p});var o=n(667294),i=()=>n(142735),a=()=>n(645805),r=()=>n(127519),s=(n(267602),n(470928),()=>n(8208)),l=()=>n(250625),d=()=>n(275200),c=n(785893);const u=o.forwardRef((function(e,t){var r;const u=(0,n(219727).O7)(),{exactTargetBlockStore:m,container:p}=e,{targetSelectable:g,targetBlockStore:f}=(0,i().VK)((()=>({targetSelectable:n(32969).C.findSelectablesFromStore(m).find((e=>Boolean(e.props.shouldShowHoverMenu||e.props.shouldShowCommentMenu))),targetBlockStore:m})),[m]),[h,v]=(0,o.useState)(null==g||null===(r=g.getNode())||void 0===r?void 0:r.getBoundingClientRect()),y=(0,i().VK)((()=>{if(!m)return!1;if(null!=m&&m.pathIsDead())return!0;const e=n(239482).Dg(m);return e&&(0,n(95718).xR)(e.id)}),[m]);(0,o.useEffect)((()=>{if(!g)return;const e=g.getNode();if(!e)return;const t=()=>{v(e.getBoundingClientRect())},n=(0,d().VW)(e);n&&(0,l().lj)(n,"scroll",t);const o=(0,d().xH)(e);return o&&o!==n&&(0,l().lj)(o,"scroll",t),t(),()=>{n&&(0,l().ZV)(n,"scroll",t),o&&(0,l().ZV)(o,"scroll",t)}}),[g]);const b=(0,i().VK)((()=>"suggest"===n(279386).MT.getMode(f)),[f]),x=(0,i().VK)((()=>(0,n(345918).Fn)(u)),[u]),S=(0,i().VK)((()=>{var e;return a().default.state.isOpen&&(null===(e=a().default.state.currentStore)||void 0===e?void 0:e.id)===f.id}),[f]),M=(0,i().VK)((()=>{if(!a().default.isRightMarginCommentHovered())return!1;const e=f.getNavigableBlockStore();return!Boolean((null==e?void 0:e.isPost())&&!(null!=e&&e.isPublishedPost()))}),[f]),w=!M&&(null==g?void 0:g.props.shouldShowHoverMenu)&&S,C=w;(0,o.useEffect)((()=>{!M&&s().Z.state.isHovered&&s().Z.resetHoverSource("right_margin_button")}),[M]);const j=null==p?void 0:p.getBoundingClientRect(),k=(0,i().VK)((()=>(0,n(273444).WA)({marginItemType:"selectable_hover_menu_overlay_item",store:f,nodeRect:h,containerRect:j,environment:u})),[f,h,j,u]),T=(0,n(846550).yK)((()=>({container:{position:"absolute",top:k,...e.style},commentMenu:{marginLeft:3}})),[e.style,k]);return y?null:(0,n(84080).Z)((e=>(0,c.jsxs)("div",{style:T.container,ref:t,...e,children:[M&&(0,c.jsx)("div",{style:T.commentMenu,children:(0,c.jsx)(n(88409).Z,{selectable:g,store:f,containerRect:j})}),w&&(0,c.jsx)(n(22819).Z,{selectable:g,store:f,disableDrag:b,isWorkspaceAdmin:x,nodeRect:h,containerRect:j}),C&&(0,c.jsx)(n(860489).ZP,{store:f,nodeRect:h,containerRect:j,selectable:g})]})))}));const m={position:"absolute",top:0,left:0,zIndex:n(492522).Mo};const p=function(e){const t=(0,o.useRef)(null),s=(0,n(644235).hq)(),l=(0,i().Kw)(a().default),d=(0,i().VK)((()=>!(!l.isOpen||l.container!==e.selectableContainer)&&((!n(591051).Z.state.isActive||"editing"!==r().default.state.mode||!(0,n(191003).qS)(r().default.state.multiSelection))&&"closed"===n(845622).default.state.type)),[l,e.selectableContainer]),p=(0,i().VK)((()=>{if(l.isOpen&&l.container===e.selectableContainer)return l.currentStore}),[l,e.selectableContainer]);return s&&d&&l.isOpen?(0,c.jsx)("div",{style:m,ref:t,children:(0,c.jsx)(n(773398).sT,{container:t.current??void 0,state:l})}):(0,c.jsx)("div",{style:m,ref:t,children:(0,c.jsx)(n(372353).Z,{className:n(247724).$Ot,render:()=>d&&p?[(0,c.jsx)(n(628370).Z,{tag:u,animate:{opacity:1},initial:{opacity:0},exit:{opacity:0},exactTargetBlockStore:p,container:t.current??void 0,config:{timingFunction:"ease-out"}},p.id)]:[]})})}},622026:(e,t,n)=>{n.r(t),n.d(t,{ShareMenuContainer:()=>vi});var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(846550),s=()=>n(788860),l=()=>n(879952),d=()=>n(990966),c=()=>n(206352),u=()=>n(198829),m=()=>n(470386),p=()=>n(67961),g=()=>n(641481),f=()=>n(247724),h=()=>n(352230),v=()=>n(148126),y=()=>n(677559),b=()=>n(228772),x=()=>n(591914),S=()=>n(707513),M=()=>n(539245),w=()=>n(641506),C=()=>n(82541),j=()=>n(388944),k=()=>n(529048),T=n(785893);function I(e){const{store:t,calculatedPermissions:n,permissionItemArgs:o,onClose:l}=e,d=(0,i().Fy)(),g=(0,a().VK)((()=>d.isMobile),[d.isMobile]),v=function(e){return(0,r().yK)((t=>({title:{fontSize:16},topbarStyle:{paddingTop:15,paddingBottom:15,height:"auto",background:e?t.surface.page:void 0}})),[e])}(g),y=(0,a().qz)(void 0,k().Z),b=d.isMobile?{menuType:h().o.Modal,disableHeaderShadow:!0,title:(0,T.jsx)(p().Z,{isMobile:d.isMobile,style:v.title,children:(0,T.jsx)(s()._H,{defaultMessage:"Share",id:"loggedOutShareMenu.title"})}),topbarStyle:v.topbarStyle,right:(0,T.jsx)(m().DoneMenuText,{}),onClickRight:l,whiteBackground:!0}:{menuType:h().o.Popup,maxHeight:"90vh"};return(0,T.jsx)(u().Z,{...b,className:f().B8p,children:(0,T.jsx)(c().Z,{debugName:"LoggedOutShareMenuContainer",capture:!0,allowEsc:!0,children:(0,T.jsx)(_,{store:t,isMobile:g,calculatedPermissions:n,permissionItemArgs:o,buttonPopupStore:y})})})}function _(e){let{store:t,isMobile:n,calculatedPermissions:a,permissionItemArgs:c,buttonPopupStore:u}=e;const m=(0,i().O7)(),p=function(e){const t=(0,i().O7)();return(0,r().yK)((n=>({tabStyle:{color:n.lightTextColor,...e&&{width:"50%",textAlign:"center"}},selectedTabStyle:{fontWeight:S().Ue.medium},tabTitleStyle:{color:"inherit",fontSize:(0,w().yv)(t,"UIRegular"),fontWeight:S().Ue.medium},style:e?{marginBottom:8,justifyContent:"space-between"}:{marginBottom:16,paddingLeft:16},tabBorderStyle:{left:0,right:0}})),[t,e])}(n),g=[(0,T.jsx)(o.Fragment,{children:(0,T.jsx)(s()._H,{defaultMessage:"Share",id:"shareMenu.shareTab.title"},"share")},"title")];return(0,o.useEffect)((()=>{l().ZH({preventDismissMobileKeyboard:!0,environment:m}),d().clear({preventDismissMobileKeyboard:!0,environment:m})}),[m]),(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(M().ZP,{...p,tabs:g,selectedIndex:0,onChange:()=>{}}),(0,T.jsx)(j().X,{store:t,calculatedPermissions:a,permissionItemArgs:c}),(0,T.jsx)(C().Z,{store:t,buttonPopupStore:u,calculatedPermissions:a,permissionItemArgs:c})]})}var P=()=>n(547046),Z=()=>n(834758),A=()=>n(807463),R=()=>n(136765),B=()=>n(428241),L=()=>n(779733),D=()=>n(333023),V=()=>n(681832),O=()=>n(930085),U=()=>n(303858),N=()=>n(345918),F=()=>n(696459),H=()=>n(174896);async function K(e,t,n,o,i){if(i.state.inviteStage===A().TG.closed||i.state.inviteStage===A().TG.share_page)return;const{selection:a}=i.state;switch(a){case A().uq.request_workspace_member:O().d(e,{...U().Oh(e,i),from:"share_menu"}),await U().fC({environment:e,spaceStore:t,originId:n.id,originType:"share_menu",reasonMessage:void 0,contextualInviteStore:i,intl:o});break;case A().uq.workspace_member:if(O().E0(e,U().Oh(e,i)),!t.isTeamsEnabled()){i.setState({...i.state,inviteStage:A().TG.closed});if(!(await H().HD({environment:e,flowId:i.state.flowId??"",trackCreateTeamComplete:!1})))return}await U().j_({environment:e,spaceStore:t,contextualInviteStore:i,from:"page_contextual_invite",intl:o});break;case A().uq.page_guest:case A().uq.unselected:case A().uq.closed:i.reset();break;default:(0,F().t1)(a)}}n(241792);var E=()=>n(667067),W=()=>n(934935),z=()=>n(923398),G=()=>n(530980),q=()=>n(989478),Y=()=>n(212493),$=()=>n(661641),J=()=>n(661297),Q=()=>n(916095),X=()=>n(267844),ee=()=>n(981583);function te(e){let{users:t}=e;const n=(0,r().yK)((e=>({avatarsContainer:{marginLeft:"16px",display:"flex"},avatarWrapper:{marginLeft:"-16px"},upgradeWrapper:{alignSelf:"end",marginLeft:"-14px",borderRadius:"50%",background:e.surface.wash},upgradeIcon:{height:16,width:16,fill:e.icon.uiBluePrimary}})),[]);return(0,T.jsxs)("div",{style:n.avatarsContainer,children:[t.slice(0,10).map(((e,t)=>(0,T.jsx)("div",{style:n.avatarWrapper,children:(0,T.jsx)(ee().Z,{userValue:e,size:40})},t))),(0,T.jsx)("div",{style:n.upgradeWrapper,children:(0,X().r)(n.upgradeIcon)})]})}function ne(e){const{guestEmails:t,spaceStore:n,contextualInviteStore:o,blockStore:l,paysPerSeat:d}=e,c=(0,i().O7)(),u=(0,s().YB)(),m=(0,a().VK)((()=>o.state.inviteStage===A().TG.request_workspace),[o]),p=(0,a().VK)((()=>t.map((e=>{const t=o.state.invitedEmailToUserIdMap[e];return G().kk5.fromValue(q().KJ,{id:t,email:e,version:1})}))),[o,t]),g=(0,r().yK)((e=>({icon:{width:16,height:16,fill:e.icon.secondary},cta:{flex:1},facepileContainer:{display:"flex",justifyContent:"center"}})),[]);return(0,T.jsxs)("div",{className:f().B8p,children:[(0,T.jsx)(Q().U4,{onClick:()=>o.reset()}),(0,T.jsxs)(Y().jX,{padding:"24px 22px 18px 22px",gap:24,children:[(0,T.jsxs)(Y().jX,{gap:20,children:[(0,T.jsx)("div",{style:g.facepileContainer,children:(0,T.jsx)(te,{users:p})}),(0,T.jsxs)(Y().jX,{gap:8,children:[(0,T.jsx)($().q,{styleName:"Heading-17px/Semibold",children:(0,T.jsx)(s()._H,{id:"ContextualInvite.variantD.header",defaultMessage:"{inviteCount, plural, one {Upgrade guest to member?} other {Upgrade {inviteCount} guests to members?}}",values:{inviteCount:t.length}})}),(0,T.jsxs)(Y().jX,{gap:20,children:[(0,T.jsx)($().q,{styleName:"UIRegular-14px/Regular",colorName:"secondary",children:d?m?(0,T.jsx)(s()._H,{id:"ContextualInvite.variantD.description.request",defaultMessage:"{otherInviteCount, plural, =0 {{firstGuest} will have access to these features.} one {{firstGuest} and 1 other will have access to these features.} other {{firstGuest} and {otherInviteCount} others will have access to these features.}} A workspace admin will review your request.",values:{firstGuest:t[0],otherInviteCount:t.length-1}}):(0,T.jsx)(s()._H,{id:"ContextualInvite.variantD.description",defaultMessage:"{otherInviteCount, plural, =0 {{firstGuest} will have access to these features} one {{firstGuest} and 1 other will have access to these features} other {{firstGuest} and {otherInviteCount} others will have access to these features}} and {totalInviteCount, plural, one {this workspace will be billed for 1 member} other {this workspace will be billed for {totalInviteCount} members}}",values:{firstGuest:t[0],totalInviteCount:t.length,otherInviteCount:t.length-1}}):(0,T.jsx)(s()._H,{id:"ContextualInvite.variantD.description.free",defaultMessage:"{otherInviteCount, plural, =0 {{firstGuest} will have access to these features} one {{firstGuest} and 1 other will have access to these features} other {{firstGuest} and {otherInviteCount} others will have access to these features}}",values:{firstGuest:t[0],otherInviteCount:t.length-1}})}),(0,T.jsxs)(Y().jX,{gap:14,children:[(0,T.jsxs)(Y().jX,{gap:8,direction:"row",align:"center-left",children:[(0,E().Q)(g.icon),(0,T.jsx)($().q,{styleName:"UIRegular-14px/Regular",children:(0,T.jsx)(s()._H,{id:"ContextualInvite.variantD.memberBenefits.private",defaultMessage:"Create private pages and drafts"})})]}),(0,T.jsxs)(Y().jX,{gap:8,direction:"row",align:"center-left",children:[(0,W().S)(g.icon),(0,T.jsx)($().q,{styleName:"UIRegular-14px/Regular",children:(0,T.jsx)(s()._H,{id:"ContextualInvite.variantD.memberBenefits.public",defaultMessage:"Access all public pages in the workspace"})})]}),(0,T.jsxs)(Y().jX,{gap:8,direction:"row",align:"center-left",children:[(0,z().O)(g.icon),(0,T.jsx)($().q,{styleName:"UIRegular-14px/Regular",children:(0,T.jsx)(s()._H,{id:"ContextualInvite.variantD.memberBenefits.collaboration",defaultMessage:"Unlimited collaboration with others"})})]})]})]})]})]}),(0,T.jsxs)(Y().jX,{direction:"row",gap:10,children:[(0,T.jsx)(J().Z,{size:"lg",style:g.cta,onClick:async()=>{!function(e){e.setState({...e.state,selection:A().uq.page_guest})}(o),await K(c,n,l,u,o)},children:(0,T.jsx)(s()._H,{id:"contextualInvite.skip.button",defaultMessage:"Skip for now"})}),(0,T.jsx)(J().Z,{size:"lg",style:g.cta,onClick:async()=>{o.state.inviteStage===A().TG.share_workspace&&function(e){e.setState({...e.state,selection:A().uq.workspace_member})}(o),o.state.inviteStage===A().TG.request_workspace&&function(e){e.setState({...e.state,selection:A().uq.request_workspace_member})}(o),await K(c,n,l,u,o)},children:m?(0,T.jsx)(s()._H,{id:"ContextualInvite.variantD.request",defaultMessage:"Request upgrade"}):(0,T.jsx)(s()._H,{id:"ContextualInvite.variantD.upgrade",defaultMessage:"Upgrade to member"})})]})]})]})}function oe(e){const{spaceStore:t,blockStore:o}=e,r=(0,i().O7)(),s=(0,n(595976).p)({spaceId:t.id}),l=(0,a().VK)((()=>(0,n(91502).$)(r,s)),[r,s]),d=(0,a().qz)(e.contextualInviteStore,A().ZP),c=(0,a().VK)((()=>n(629719).uh(null==s?void 0:s.subscription)),[s]),u=(0,a().VK)((()=>d.getGuestEmails()),[d]),m=(0,a().VK)((()=>(0,N().Q6)(t)),[t]);return(0,n(732811).K)((()=>{!function(e,t){t&&e.setState({...e.state,selection:A().uq.page_guest})}(d,l),O().$2(r,U().Oh(r,d))})),u.length?(0,T.jsx)(ne,{contextualInviteStore:d,spaceStore:t,blockStore:o,useZeroTeamsExperience:l,paysPerSeat:c,guestEmails:u,useGuestInviteRequestExperience:m}):null}const ie=o.memo(oe);var ae=()=>n(827282);const re=(0,ae().IU)("wifiSlash",{viewBox:"0 0 32 32",svg:(0,T.jsx)("path",{d:"M5.33984 5.32812L8.04688 8.04688C6.17969 8.8125 4.50781 9.97656 3.03125 11.5391C2.90625 11.6719 2.75781 11.7422 2.58594 11.75C2.42188 11.75 2.27734 11.6836 2.15234 11.5508L0.5 9.89844C0.390625 9.78125 0.332031 9.65625 0.324219 9.52344C0.324219 9.38281 0.371094 9.25391 0.464844 9.13672C1.08984 8.39453 1.8125 7.70312 2.63281 7.0625C3.46094 6.41406 4.36328 5.83594 5.33984 5.32812ZM13.6719 6.91016L10.3203 3.54688C10.9688 3.42187 11.5938 3.32812 12.1953 3.26562C12.8047 3.20313 13.4023 3.17188 13.9883 3.17188C15.8086 3.17188 17.5703 3.42969 19.2734 3.94531C20.9844 4.46094 22.5469 5.17188 23.9609 6.07812C25.375 6.97656 26.5625 7.99609 27.5234 9.13672C27.6172 9.25391 27.6641 9.38281 27.6641 9.52344C27.6641 9.65625 27.6016 9.78125 27.4766 9.89844L25.8359 11.5391C25.7109 11.6719 25.5664 11.7422 25.4023 11.75C25.2383 11.75 25.0977 11.6914 24.9805 11.5742C23.543 10.0898 21.9141 8.94531 20.0938 8.14062C18.2812 7.33594 16.2852 6.91016 14.1055 6.86328C14.0352 6.86328 13.9609 6.86719 13.8828 6.875C13.8125 6.88281 13.7422 6.89453 13.6719 6.91016ZM10.6016 10.5781L13.7773 13.7656C13.0273 13.7812 12.2969 13.9023 11.5859 14.1289C10.875 14.3555 10.207 14.6641 9.58203 15.0547C8.96484 15.4375 8.42188 15.8828 7.95312 16.3906C7.82031 16.5312 7.67188 16.6094 7.50781 16.625C7.34375 16.6328 7.19141 16.5703 7.05078 16.4375L5.21094 14.6328C5.10156 14.5234 5.03906 14.4023 5.02344 14.2695C5.01562 14.1367 5.0625 14.0117 5.16406 13.8945C5.78906 13.1602 6.56641 12.5039 7.49609 11.9258C8.43359 11.3398 9.46875 10.8906 10.6016 10.5781ZM22.0859 15.3242L17.3398 10.5781C18.4492 10.8594 19.4922 11.2969 20.4688 11.8906C21.4453 12.4844 22.2344 13.1523 22.8359 13.8945C22.9219 14.0117 22.9609 14.1367 22.9531 14.2695C22.9531 14.4023 22.8945 14.5234 22.7773 14.6328L22.0859 15.3242ZM14 16.9531C14.8281 16.9531 15.5898 17.1367 16.2852 17.5039C16.9805 17.8711 17.5312 18.3125 17.9375 18.8281C18.0312 18.9453 18.0703 19.0742 18.0547 19.2148C18.0391 19.3555 17.9766 19.4766 17.8672 19.5781L15.0078 22.3438C14.7734 22.5703 14.582 22.7227 14.4336 22.8008C14.293 22.8867 14.1484 22.9297 14 22.9297C13.8594 22.9297 13.7188 22.8867 13.5781 22.8008C13.4375 22.7227 13.2461 22.5703 13.0039 22.3438L10.1328 19.5781C10.0312 19.4844 9.96484 19.3789 9.93359 19.2617C9.91016 19.1367 9.93359 19.0234 10.0039 18.9219C10.4102 18.375 10.9688 17.9102 11.6797 17.5273C12.3906 17.1445 13.1641 16.9531 14 16.9531ZM23.8906 21.7812L4.09766 2C3.91797 1.82812 3.82812 1.60938 3.82812 1.34375C3.82812 1.07812 3.91797 0.855469 4.09766 0.675781C4.26953 0.496094 4.48828 0.410156 4.75391 0.417969C5.01953 0.417969 5.24219 0.507813 5.42188 0.6875L25.2031 20.4688C25.3906 20.6484 25.4844 20.8672 25.4844 21.125C25.4844 21.3828 25.3906 21.6016 25.2031 21.7812C25.0312 21.9609 24.8164 22.0508 24.5586 22.0508C24.3008 22.0508 24.0781 21.9609 23.8906 21.7812Z"})});var se=()=>n(257934),le=()=>n(897257),de=()=>n(714022),ce=()=>n(201565);function ue(e){const{store:t,mostPermissivePublicItem:n,permissionItemArgs:o}=e,{permissionItem:i}=n;return(0,a().VK)((()=>(0,ce().L)(i)),[i])?(0,T.jsx)(Z().D7,{store:t,mostPermissivePublicItem:n,sudoModeStore:o.sudoModeStore,location:o.location,showManageAllDomains:!0,showAllPublishedSites:!0,shouldAskForConfirmationOnPublish:!1}):(0,T.jsx)(Z().vk,{store:t,mostPermissivePublicItem:n,sudoModeStore:o.sudoModeStore,location:o.location})}n(267602),n(653476);var me=()=>n(446866),pe=()=>n(703976),ge=()=>n(259408),fe=()=>n(94967),he=()=>n(512220),ve=()=>n(594777),ye=()=>n(581356),be=()=>n(239482),xe=()=>n(466970),Se=()=>n(692304),Me=()=>n(749826);function we(e){const{featureGateId:t,whenEnabled:n,whenDisabled:o,disableExposureLogging:i}=e,r=function(e){const{featureGateId:t,disableExposureLogging:n}=e;return(0,a().VK)((()=>Me().default.checkGate({gateName:t,disableExposureLogging:n})),[t,n])}({featureGateId:t,disableExposureLogging:i});return r?n:o}var Ce=()=>n(815277),je=()=>n(367246);function ke(e){const{currentMembersAndGuests:t,inviteTarget:n}=e,o=Te(n);if(!o)return;const i=function(e){const{email:t,currentMembersAndGuests:n}=e;return n.memberEmails.has(t)?"member":n.guestEmails.has(t)?"guest":void 0}({email:o,currentMembersAndGuests:t});return{email:o,currentRole:i}}function Te(e){const{type:t}=e;switch(t){case"newUser":case"existingUser":return e.value.email;case"invalidUser":case"group":return;default:(0,F().t1)(t)}}var Ie=()=>n(845465),_e=()=>n(429490);var Pe=()=>n(963588),Ze=()=>n(557876),Ae=()=>n(681941),Re=()=>n(661727),Be=()=>n(209264),Le=()=>n(603692),De=()=>n(847354),Ve=()=>n(838266),Oe=()=>n(19072);function Ue(e){const{spaceId:t,userId:n,spaceModel:o,spaceUserModel:i,teamModel:l,domains:d,blockStore:c}=e,u=(0,s().YB)(),m=(0,Ce().oo)({name:"internal_guests",spaceId:t,userId:n,amount:1}),p=(0,De().u)({blockStore:c}),g=(0,Ce().VX)({name:"non_admin_members",spaceId:t,userId:n}),f=(0,r().yK)((e=>{const t=m&&!(0,ge()._e)(m),n=t?20:5,o=t?e.accentColors.orange[100]:"transparent",i=t?e.accentColors.orange[400]:e.fill.uiBlue;return{container:{borderImage:`repeating-linear-gradient(-45deg, ${o}, ${o} ${n}px, ${i} ${n}px, ${i} ${2*n}px) 5 0`,borderWidth:"4px 0 0 0",borderStyle:"solid",background:t?(0,Re().Fq)(e.accentColors.orange[400],.15):(0,Re().Fq)(e.fill.uiBlue,.15),position:"relative",padding:10,zIndex:5},fill:{background:e.surface.elevated,border:`1px solid ${e.stroke.secondary}`},button:{height:"auto",width:"calc(100% + 16px)",padding:8,margin:-8}}}),[m]),h=(0,a().VK)((()=>{var e;const t=(0,Ae().KE)((null===(e=le().subscriptionDataStoreInstance.state)||void 0===e?void 0:e.subscriptionTier)??"free");return Oe().i$[t].label}),[]),v=(0,a().VK)((()=>null==i?void 0:i.isWorkspaceOwner()),[i]),y=(0,a().VK)((()=>null==i?void 0:i.isMember()),[i]);let b;b=v?"You are a workspace owner":y?"You are a member":"You are a guest";const x=(0,a().VK)((()=>[{label:"Disable members inviting guests to pages",isEnabled:(null==o?void 0:o.getDisableGuests())??!1},{label:"Allow members to request adding guests",isEnabled:(null==o?void 0:o.getSettings().enable_guest_invite_requests)??!1},{label:"Allow members to request adding other members",isEnabled:!(null!=o&&o.getSettings().disable_membership_requests)}]),[o]),S=(0,a().VK)((()=>[{label:"Disable guests",isEnabled:(null==l?void 0:l.getSettings().disable_guests)??!1}]),[l]),M=(0,a().VK)((()=>{if(!o||!d||!i)return;const{autojoinDomains:e}=(0,Ze().tV)({space:o,spaceUser:i,domains:d});return e}),[o,i,d]),w=(0,a().VK)((()=>{if(!o||!i)return;const{type:e}=(0,Ze().tX)({space:o,spaceUser:i,team:l,publicPageDataGuestSetting:p});switch(e){case"can_add":return"You can add guests.";case"can_request":return"You can request to add guests.";case"cannot_add":return"You can't add or request to add guests.";default:(0,F().t1)(e)}}),[o,i,l,p]),C=(0,a().VK)((()=>{if(!o||!d||!i)return;const{type:e}=(0,Ze().tV)({space:o,spaceUser:i,domains:d});switch(e){case"can_add":return"You can add members.";case"can_request":return"You can request to add members.";case"cannot_add":return"You can't add or request to add members.";default:(0,F().t1)(e)}}),[o,i,d]),j=(0,a().VK)((()=>{if(!o||!i||!d)return!1;return"can_add"===(0,Ze().tV)({space:o,spaceUser:i,domains:d}).type}),[o,i,d]),k=(0,a().VK)((()=>{if(!m)return;const e=m.type;switch(e){case"available":return"You can add an internal guest.";case"blocked":case"upsell":return j?g?"Internal guests will be added to the space with member access.":"Internal guests will be added to the space with workspace owner access.":"You can't add internal guests.";default:(0,F().t1)(e)}}),[m,g,j]),I=(0,a().VK)((()=>{if(!m)return"Guest limit data is unavailable";if("cumulative"===m.limit.type){const{current:e,total:t}=m.limit;return"unlimited"===t?"No guest limit":`Space has ${e} of ${t} guests`}}),[m]),_=e=>{Ve().default.setState({open:!0,openedFrom:"misc",currentTab:e,defaultSubtab:void 0,highlightedSetting:void 0})};return(0,T.jsxs)(Y().jX,{gap:10,style:f.container,children:[(0,T.jsxs)(Y().jX,{gap:12,borderRadius:6,padding:10,style:f.fill,children:[(0,T.jsx)(Be().D,{onClick:()=>_("security"),style:f.button,children:(0,T.jsxs)(Y().jX,{gap:4,children:[(0,T.jsx)($().q,{styleName:"UISmall-12px/Medium",children:"Space security settings"}),x.map(((e,t)=>(0,T.jsxs)(Y().jX,{direction:"row",gap:4,align:"center-left",children:[(0,T.jsx)(Ne,{isEnabled:e.isEnabled}),(0,T.jsx)($().q,{colorName:e.isEnabled?"secondary":"tertiary",styleName:"UISmall-12px/Regular",children:e.label})]},t)))]})}),(0,T.jsxs)(Y().jX,{gap:4,children:[(0,T.jsx)($().q,{styleName:"UISmall-12px/Medium",children:"Team security settings"}),S.map(((e,t)=>(0,T.jsxs)(Y().jX,{direction:"row",gap:4,align:"center-left",children:[(0,T.jsx)(Ne,{isEnabled:e.isEnabled}),(0,T.jsx)($().q,{colorName:e.isEnabled?"secondary":"tertiary",styleName:"UISmall-12px/Regular",children:e.label})]},t)))]}),(0,T.jsx)(Be().D,{onClick:()=>_("billing"),style:f.button,children:(0,T.jsxs)(Y().jX,{gap:4,children:[(0,T.jsx)($().q,{styleName:"UISmall-12px/Medium",children:"Subscription"}),(0,T.jsx)($().q,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:`${u.formatMessage(h)} plan`}),(0,T.jsx)($().q,{colorName:"secondary",styleName:"UISmall-12px/Regular",children:I})]})}),(0,T.jsx)(Be().D,{onClick:()=>_("settings"),style:f.button,children:(0,T.jsxs)(Y().jX,{gap:4,children:[(0,T.jsx)($().q,{styleName:"UISmall-12px/Medium",children:"Allowed email domains"}),null==M?void 0:M.map((e=>(0,T.jsx)($().q,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:e},e))),0===(null==M?void 0:M.length)&&(0,T.jsx)($().q,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:"None"})]})})]}),(0,T.jsxs)(Y().jX,{gap:4,borderRadius:6,padding:10,style:f.fill,children:[(0,T.jsx)($().q,{styleName:"UISmall-12px/Medium",children:b}),(0,T.jsx)($().q,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:C}),(0,T.jsx)($().q,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:w}),(0,T.jsx)($().q,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:k})]})]})}function Ne(e){const{isEnabled:t}=e,n=(0,r().yK)((e=>({circle:{width:10,height:10,borderRadius:"50%",border:`1px solid ${e.icon.quaternary}`}})),[]);return t?(0,T.jsx)(Le().y,{iconGroup:Pe().K,variantName:"mini",colorName:"secondary"}):(0,T.jsx)(Y().jX,{width:14,height:14,align:"center",children:(0,T.jsx)("div",{style:n.circle})})}var Fe=()=>n(714230),He=()=>n(235484);const Ke=(0,ae().IU)("squareAndArrowDown",{viewBox:"0 0 20 20",svg:(0,T.jsx)("g",{children:(0,T.jsx)("path",{d:"M6.063 16.817c-.739 0-1.297-.186-1.675-.56-.379-.374-.568-.928-.568-1.661V7.869c0-.729.19-1.28.568-1.654.378-.378.936-.568 1.675-.568h1.866v1.347H6.145c-.32 0-.563.084-.732.253-.164.164-.246.413-.246.745v6.487c0 .333.082.582.246.746.169.168.413.252.732.252h7.704c.314 0 .556-.084.724-.252.173-.165.26-.413.26-.745V7.991c0-.332-.087-.58-.26-.745-.168-.169-.41-.253-.724-.253h-1.77V5.647h1.858c.739 0 1.297.19 1.675.568.379.374.568.925.568 1.654v6.727c0 .729-.19 1.28-.568 1.654-.378.378-.936.567-1.675.567H6.064ZM10 12.387a.715.715 0 0 1-.24-.04.832.832 0 0 1-.245-.171L7.218 9.96a.567.567 0 0 1-.171-.403c0-.16.052-.29.157-.39.11-.1.244-.15.403-.15a.54.54 0 0 1 .424.184l.957 1.019.445.499L9.364 9.7V2.62c0-.168.062-.314.185-.437A.629.629 0 0 1 10 1.997c.173 0 .321.062.444.185a.588.588 0 0 1 .192.437v7.082l-.069 1.019.438-.5.957-1.018a.554.554 0 0 1 .424-.184c.155 0 .287.05.396.15.114.1.171.23.171.39 0 .15-.06.284-.178.403l-2.296 2.215a.758.758 0 0 1-.24.17.715.715 0 0 1-.239.042Z"})})});var Ee=()=>n(602137),We=()=>n(824462),ze=()=>n(265640),Ge=()=>n(448419),qe=()=>n(643051),Ye=()=>n(842574),$e=()=>n(189265),Je=()=>n(286338),Qe=()=>n(873175),Xe=()=>n(842576),et=()=>n(520849),tt=()=>n(104088),nt=()=>n(876822),ot=()=>n(138912),it=()=>n(365872),at=()=>n(293338),rt=()=>n(291198);function st(e){const{shouldShowLengthWarning:t,shouldShowLinkWarning:n,value:o,maxLength:i}=e,a=(0,r().yK)((e=>({container:{position:"absolute",top:0,display:"flex",justifyContent:"center",fontSize:12,color:e.lightTextColor,width:"100%"},warning:{display:"flex",justifyContent:"center",width:"calc(100% - 36px)",backgroundColor:e.modalBackground,marginTop:1}})),[]);return(0,T.jsx)("div",{style:a.container,children:(0,T.jsxs)("div",{style:a.warning,children:[t&&(0,T.jsx)(s()._H,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:o.length,maxCharacters:i}}),t&&n&&" · ",n&&(0,T.jsx)(s()._H,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"})]})})}const lt=100;function dt(e){const{open:t,focus:n,value:o,maxLength:i,onFocus:a,onChange:l,onCancel:d}=e,c=(0,s().YB)(),u=o.length/i>=.8,m=(0,at().TQ)(o),p=u||m,g=(0,r().yK)((e=>({container:{maxHeight:t?lt:0,position:"absolute",bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:t?"all":"none",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",overflow:"hidden",zIndex:1},input:{maxHeight:t?100:0,borderTop:1,borderTopStyle:"solid",borderTopColor:e.regularDividerColor,padding:18,fontSize:14,transitionProperty:"max-height",transitionDuration:"0.3s"}})),[t]),f=c.formatMessage({id:"shareMenu.emailMessageInput.placeholder",defaultMessage:"Add a message to your invite..."});return(0,T.jsxs)("div",{style:g.container,children:[p&&(0,T.jsx)(st,{value:o,maxLength:i,shouldShowLengthWarning:u,shouldShowLinkWarning:m}),(0,T.jsx)(rt().Z,{textarea:!0,focusInitial:!1,format:rt().B.Transparent,placeholder:f,maxlength:i,focus:n,value:o,onFocus:a,onChange:l,inputStyle:g.input,onCancel:d})]})}n(670560),n(122556),n(582845),n(250570),n(533019),n(721473),n(788208),n(22624),n(470928),n(30005),n(731107),n(228244);var ct=()=>n(619186),ut=()=>n(801812),mt=()=>n(440424),pt=()=>n(674462),gt=()=>n(357808),ft=()=>n(165940),ht=()=>n(78615),vt=()=>n(280742),yt=()=>n(741633),bt=()=>n(933868),xt=()=>n(396136),St=()=>n(243225),Mt=()=>n(306164),wt=()=>n(542487),Ct=()=>n(912732),jt=()=>n(849129),kt=()=>n(827973),Tt=()=>n(255577),It=()=>n(838367),_t=()=>n(943620),Pt=()=>n(384241),Zt=()=>n(388284),At=()=>n(654133),Rt=()=>n(777814),Bt=()=>n(64131),Lt=()=>n(98148),Dt=()=>n(164079),Vt=()=>n(122479),Ot=()=>n(88476),Ut=()=>n(17922),Nt=()=>n(745624),Ft=()=>n(998901),Ht=()=>n(245845),Kt=()=>n(826955),Et=()=>n(969243),Wt=()=>n(18281),zt=()=>n(697623),Gt=()=>n(495712),qt=()=>n(65404),Yt=()=>n(81979);function $t(e){const{publicPermission:t}=e,n=(0,r().yK)((e=>({banner:{...(0,Ie().S2)({theme:e,inheritanceBannerEnabled:!1}),display:"flex",flexDirection:"row",alignItems:"center",gap:8},content:{display:"flex",alignItems:"flex-start",gap:2,flex:"1 0 0"},label:{fontSize:14,lineHeight:"20px",color:e.text.secondary,flex:"1 0 0",paddingLeft:4},icon:{height:16,width:16,color:e.icon.secondary},iconContainer:{height:20,width:20,display:"flex",alignItems:"center",justifyContent:"center"},manageButton:{color:e.text.uiBluePrimary,fontWeight:S().Ue.medium}})),[]),o=t.permissionItem.role;return bt().YX(o)?(0,T.jsxs)("div",{style:n.banner,children:[(0,T.jsxs)("div",{style:n.content,children:[(0,T.jsx)("div",{style:n.iconContainer,children:(0,Yt().o)(n.icon)}),(0,T.jsx)(p().Z,{style:n.label,isMultiline:!0,children:(0,T.jsx)(Jt,{role:o})})]}),(0,T.jsx)(ze().D,{size:"sm",style:n.manageButton,onClick:()=>V().default.setState({...V().default.state,display:V().wV.Publish,tab:V().XF.Publish}),children:(0,T.jsx)(s()._H,{id:"shareMenu.managePublishSettingsButton.label",defaultMessage:"Settings"})})]}):null}function Jt(e){const{role:t}=e;switch(t){case"read_and_write":return(0,T.jsx)(s()._H,{id:"shareMenu.publicPermissionBanner.canEdit",defaultMessage:"This page allows edits from anyone on the web"});case"comment_only":return(0,T.jsx)(s()._H,{id:"shareMenu.publicPermissionBanner.canComment",defaultMessage:"This page allows comments from anyone on the web"});case"reader":return(0,T.jsx)(s()._H,{id:"shareMenu.publicPermissionBanner.canRead",defaultMessage:"This page can be viewed by anyone on the web"});case"editor":case"membership_admin":case"content_only_editor":case"none":return null;default:(0,F().t1)(t)}}var Qt=()=>n(421736),Xt=()=>n(907099);function en(e){let{inviteTarget:t,isRedesignEnabled:o,isMobile:i,captionOverride:l}=e;const d=(0,s().YB)(),c=(0,a().VK)((()=>nt().default.state.currentSpaceStore),[]),u=(0,a().VK)((()=>(0,Xt().kF)({groupName:t.value.name,intl:d})),[t,d]),m=(0,a().VK)((()=>{if(c&&t.value.icon)return{pointer:{table:c.table,id:c.id},icon:t.value.icon}}),[c,t]),g=(0,a().VK)((()=>(0,Xt().c7)({groupId:t.value.group_id})),[t]),f=(0,r().yK)((()=>({container:(0,Ie().u0)({isRedesignEnabled:o,isMobile:i}),titleContainer:{display:"flex",alignItems:"center",paddingTop:o?void 0:8,paddingBottom:o?void 0:8,marginLeft:o?void 0:2,minHeight:36},groupInfoContainer:{display:"flex",flexDirection:"column"},nameAndIconContainer:{display:"flex",alignItems:"center"},groupNameLabel:{marginLeft:10,marginRight:4},groupMembersLabel:{marginLeft:10}})),[i,o]);return(0,T.jsxs)("div",{style:f.titleContainer,children:[(0,T.jsx)(n(724902).Z,{groupIcon:null==m?void 0:m.icon,isRedesignEnabled:o,spaceId:t.value.space_id}),(0,T.jsxs)("div",{style:f.groupInfoContainer,children:[(0,T.jsxs)("div",{style:f.nameAndIconContainer,children:[(0,T.jsx)(p().Z,{style:f.groupNameLabel,children:u}),!o&&Boolean(null==m?void 0:m.icon)&&(0,T.jsx)(_t().Z,{disabled:!0,bucket:"public",title:u,icon:m,size:18,isEmptyPage:!1})]}),(0,T.jsx)(p().Z,{isSmall:!0,style:f.groupMembersLabel,children:l||(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(s()._H,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",(0,T.jsx)(s()._H,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:g}})]})})]})]})}const tn=o.memo(en);var nn=()=>n(286977),on=()=>n(568017),an=()=>n(154186),rn=()=>n(277533);function sn(e,t){let{blockStore:n,isInvited:o,isRedesignEnabled:i,disabled:a,spaceVisibleUserMap:s,inviteTarget:l,id:d,focused:c,onClick:u,onAuxClick:m,onMouseEnter:p,role:g,disallowTabbing:f,ignoreLocalHoverState:h,isMobile:v}=e;const y=(0,r().yK)((()=>({container:(0,Ie().u0)({isRedesignEnabled:i,isMobile:v}),titleStyle:i?{marginLeft:Ie().gf}:{}})),[v,i]);return(0,T.jsx)(kt().Z,{ref:t,textWrapperStyle:y.titleStyle,buttonStyle:y.container,title:"group"===l.type?(0,T.jsx)(tn,{inviteTarget:l,isRedesignEnabled:i,isMobile:v}):(0,T.jsx)(ln,{blockStore:n,inviteTarget:l,isRedesignEnabled:i,spaceVisibleUserMap:s,isMobile:v}),disabled:a,right:!a&&(0,T.jsx)(dn,{onClick:u,checked:o,isRedesignEnabled:i}),id:d,focused:c,onClick:u,onAuxClick:m,onMouseEnter:p,role:g,disallowTabbing:f,ignoreLocalHoverState:h})}function ln(e){let{blockStore:t,inviteTarget:n,isRedesignEnabled:i,isMobile:s,spaceVisibleUserMap:l}=e;const d=(0,a().VK)((()=>"existingUser"===n.type?(0,Lt().B)({spaceVisibleUserMap:l,userId:n.value.id,blockStore:t}):void 0),[n,l,t]),c=(0,o.useMemo)((()=>"existingUser"===n.type?{actorStore:rn().U.createChildStore(t,{table:q().KJ,id:n.value.id}),avatar:void 0}:"newUser"===n.type?{actorStore:void 0,avatar:{email:n.value.email,..."slack"===n.source||"google"===n.source?{name:n.value.name,avatarUrl:n.value.avatar_url}:{name:void 0,avatarUrl:void 0}}}:void(0,F().t1)(n)),[n,t]),u=(0,r().yK)((()=>({container:(0,Ie().u0)({isRedesignEnabled:i,isMobile:s}),cellMemberAvatarContainer:i?{}:{paddingTop:8,paddingBottom:8},iconBox:{position:"absolute",bottom:-3,right:-3},iconBoxImage:{background:"white",padding:2,borderRadius:"100%"}})),[s,i]);return(0,T.jsx)(Qt().Z,{isLarge:!0,...c,containerStyle:u.cellMemberAvatarContainer,avatarBadge:(()=>{const e=(()=>{if("newUser"!==n.type)return null;switch(n.source){case"slack":return Fe().Z.images.externalIntegrations.slackIconPng;case"google":return Fe().Z.images.externalIntegrations.googleGIconPng;default:return null}})();return e?(0,T.jsx)(qe().Z,{type:"image_url",imageURL:e,size:18,style:u.iconBox,imageStyle:u.iconBoxImage}):null})(),spaceRole:d})}function dn(e){const{checked:t,isRedesignEnabled:n}=e,o=(0,r().yK)((e=>{const o=o=>{if(!n)return t?{background:on().ZP.blue,borderColor:on().ZP.blue}:{background:"transparent",borderColor:e.buttonPressedBackground};switch(o){case"default":return{background:t?e.checkboxBackground:"transparent",borderColor:t?e.checkboxBackground:e.icon.tertiary};case"hovered":return{background:t?e.checkboxHoveredBackground:e.uncheckedCheckboxHoveredBackground,borderColor:t?e.checkboxHoveredBackground:e.icon.tertiary};case"pressed":return{background:t?e.checkboxPressedBackground:e.uncheckedCheckboxPressedBackground,borderColor:t?e.checkboxPressedBackground:e.icon.tertiary};default:return(0,F().P)(o),{}}};return{circleCheckmark:{display:"flex",justifyContent:"center",alignItems:"center",width:n?18:22,height:n?18:22,borderRadius:"50%",borderStyle:"solid",borderWidth:1.75,...o("default"),marginRight:6},hovered:o("hovered"),pressed:o("pressed"),checkIcon:{height:n?9:12,width:n?9:12,color:"white"}}}),[t,n]);return(0,T.jsx)(an().Z,{onClick:e.onClick,style:o.circleCheckmark,hoveredStyle:o.hovered,pressedStyle:o.pressed,children:t&&(0,nn().e)(o.checkIcon)})}const cn=o.memo(o.forwardRef(sn));var un=()=>n(487780),mn=()=>n(331404),pn=()=>n(564256),gn=()=>n(302656),fn=()=>n(874977);function hn(e){var t,n;const{store:o,shouldShowSlackOnly:l,shouldShowGoogleOnly:d,calculatedPermissions:c,permissionItemArgs:u,tokenQuery:m,showShimmer:g,error:f,ready:h,result:v}=e,y=c.pagePermissionUIModel,b=(0,i().O7)(),x=(0,a().qz)(e.inviteTargetsStore,se().ZP),S=(0,a().VK)((()=>V().default.state.display===V().wV.Invite&&V().default.state.focus&&"message"===V().default.state.focus),[]),M=(0,a().qz)(e.menuListStore,Se().Z),w=(0,a().VK)((()=>(0,Lt().v)()),[]),C=(0,a().VK)((()=>Je().Rv()),[]),j=(0,a().VK)((()=>(0,L().wZ)()),[]),k=(0,r().yK)((e=>({sectionMenuItem:{paddingTop:0,display:"flex",flexDirection:"column",gap:2},sectionMenuItemTitle:j?{paddingLeft:Ie().J4,paddingRight:Ie().J4}:{},keepTypingMessage:{paddingLeft:Ie().J4,paddingRight:Ie().J4,marginTop:6,marginBottom:8,fontWeight:500},zeroState:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",color:e.mediumTextColor,fontSize:14,position:"relative",pointerEvents:"auto",paddingTop:10,marginTop:40,marginBottom:40},zeroStateText:{width:"70%",alignSelf:"center"},zeroStateIcon:{height:36,width:36,marginBottom:12,fill:e.mediumIconColor},arrowUpLeftIcon:{width:12,height:12,marginRight:3,marginTop:3,color:e.text.quaternary}})),[j]),[{value:I}]=(0,ut().r5)((async()=>{if(void 0===(null==v?void 0:v.inviteUsers))return{};const e=await We().callApi({eventName:"getSpacePermissionGroupIdsContainingMembers",environment:b,data:{spaceId:o.getSpaceId(),userIds:null==v?void 0:v.inviteUsers.map((e=>e.value.id)).filter((e=>void 0!==e))},headers:(0,yt().Bb)({cellId:void 0,spaceId:o.getSpaceId()})});return"success"===e.type?e.data.userToGroupMap:{}}),[b,o,v],{debugName:"userToPermissionGroupIds",debounce:300,throttle:1e3}),{inPageTargets:_,notInPageTargets:P,filteredImportedContacts:Z}=(0,a().VK)((()=>{const{inviteUsers:e,inviteGroups:t,importedContacts:n=[]}=v??{inviteUsers:[],inviteGroups:[],importedContacts:[]},i=[...e,...t],a=[],r=[],s=new Set;i.forEach((e=>{"group"!==e.type&&s.add(e.value.email.toLowerCase());const t=Boolean(Ot().Zp({store:o,target:e})),n=function(e){const{inviteTarget:t,blockStore:n,spacePermission:o,teamMemberPermission:i,groupPermission:a,userPermissionGroupIds:r}=e,s=t.type;if("newUser"===s)return{role:"none",type:"user_permission",user_id:t.value.email};if("existingUser"===s)return Vt().uY({userId:t.value.id,store:n,userPermissionGroupIds:r??new Set});if("group"===s){const e={role:"none",type:"group_permission",group_id:t.value.group_id},r=(0,be().VP)(n),s=null==r?void 0:r.getRawMembership().find((e=>(0,wt().lF)({groupId:t.value.group_id,teamMember:e})));return[o,...r&&i&&s?[i]:[],a||{permissionItem:e,from:{table:xt().iU,blockId:n.id}}].sort(((e,t)=>bt().xm[t.permissionItem.role]-bt().xm[e.permissionItem.role]))}(0,F().t1)(s)}({inviteTarget:e,blockStore:o,spacePermission:c.mostPermissiveSpaceItem,teamMemberPermission:c.mostPermissiveAncestorTeamMemberItem,groupPermission:"group"===e.type?y.mostPermissiveGroupPermissions.find((t=>t.permissionItem.group_id===e.value.group_id)):void 0,userPermissionGroupIds:"existingUser"===e.type?new Set((null==I?void 0:I[e.value.id])??[]):void 0});if("existingUser"===e.type&&!Boolean(e.spaceRole)){let t;if(Ht().Z.state.shouldUseEdgeCache){var i;const n=null===(i=Et().r.getData(b,{userId:e.value.id,spaceId:o.getSpaceId()}))||void 0===i?void 0:i.membership_type;t=n?(0,St().h5)(n):void 0}else{var l;t=null===(l=w.get(e.value.id))||void 0===l?void 0:l.role}e.spaceRole=t||"not_in_space"}const d=Array.isArray(n)?n[0].permissionItem:n,u=function(e,t){const n="existingUser"===t.type?"user_permission":"group"===t.type?"group_permission":void 0;if(Array.isArray(e)){const t=e.filter((e=>e.permissionItem.type===n));if(t.length>0)return t[0].permissionItem}else if(e.type===n)return e}(n,e),m=j?!!u&&(t||bt().YX(u.role??"none")):t||bt().YX(d.role??"none"),p=j?u:d;m&&"newUser"!==e.type?p&&a.push({inviteTarget:e,permissionItem:p,mostPermissivePermissions:Array.isArray(n)?n:void 0}):"newUser"!==e.type&&r.push(e)}));const l=n.filter((e=>!s.has(e.value.email.toLowerCase())));return{inPageTargets:a,notInPageTargets:r,filteredImportedContacts:l}}),[v,o,c.mostPermissiveSpaceItem,c.mostPermissiveAncestorTeamMemberItem,y.mostPermissiveGroupPermissions,I,j,b,w]),{isValidEmail:A,isEmailInTargets:R}=(0,a().VK)((()=>{const e=(0,me().H3)(m);return{isValidEmail:(0,me().oH)(e),isEmailInTargets:[..._.map((e=>{let{inviteTarget:t}=e;return t})),...P].some((t=>"group"!==t.type&&t.value.email===e))}}),[m,_,P]),B=(0,a().VK)((()=>x.state.inviteTargets.length>0),[x]),D=A&&!R,O=c.showRestrictedPermissionBanner,U=!l&&!d&&P.length>0&&(0===m.length||0===(null==v?void 0:v.tokenQuery.length)),N=!l&&!d&&m.length>0&&Boolean(null==v||null===(t=v.tokenQuery)||void 0===t?void 0:t.length)&&_.length>0,H=!l&&!d&&P.length>0&&m.length>0&&Boolean(null==v||null===(n=v.tokenQuery)||void 0===n?void 0:n.length),K=Z.filter((e=>"slack"===e.source)),E=Z.filter((e=>"google"===e.source)),W=C&&K.length>0,z=E.length>0,G={key:"imported slack contacts",render:e=>(0,T.jsx)(Zt().Z,{...e,style:k.sectionMenuItem,title:(0,T.jsx)(s()._H,{id:"shareMenuSearchRequest.importedSlackContactsSection.title",defaultMessage:"From Slack"}),loading:!h}),items:vn({filteredContacts:K,isRedesignEnabled:j,environment:b,inviteTargetsStore:x,blockStore:o,spaceVisibleUserMap:w,tokenQuery:m,menuListStore:M,importContactType:"slack"})},Y={key:"imported google contacts",render:e=>(0,T.jsx)(Zt().Z,{...e,style:k.sectionMenuItem,title:(0,T.jsx)(s()._H,{id:"shareMenuSearchRequest.importedGoogleContactsSection.title",defaultMessage:"From Google"}),loading:!h}),items:vn({filteredContacts:E,isRedesignEnabled:j,environment:b,inviteTargetsStore:x,blockStore:o,spaceVisibleUserMap:w,tokenQuery:m,menuListStore:M,importContactType:"google"})},$=D||!U&&!N&&!H&&!W&&!z&&!l&&!d&&m.length>0,J=(0,a().VK)((()=>{const e=le().subscriptionDataStoreInstance.state,{currentSpaceStore:t}=nt().default.state;return t&&e?Wt().hn(e).map((n=>{if(("unsubscribed_admin"===e.type||"unsubscribed_member"===e.type||"subscribed_admin"===e.type)&&e.joinedMemberIds.includes(n.userId)){const e=Kt().U6.createChildStore(t,{table:q().KJ,id:n.userId}).getEmail();return e&&(0,me().Gd)(e)}})).reduce(((e,t)=>(t&&!e.includes(t)&&e.push(t),e)),[]):[]}),[]),Q=(0,Ut().Z)(o);if(f)return(0,T.jsx)(Bt().l,{loading:!h,children:(0,T.jsx)(It().Z,{title:(0,T.jsx)(s()._H,{id:"inviteUserModal.searchInput.errorMessage",defaultMessage:"Something went wrong"})})});if(!h&&g)return(0,T.jsx)(Nt().B,{areaHeight:window.innerHeight});const X={key:"user results",render:e=>(0,T.jsx)(Zt().Z,{...e,style:k.sectionMenuItem,loading:!h,title:(0,T.jsx)(s()._H,{id:"shareMenuSearchRequest.suggestedEmail.title",defaultMessage:"Keep typing an email to invite"})}),items:In({tokenQuery:m,possibleDomains:J,shouldShowAutoFillEmail:$,isGuestInviteRequestRequired:Q.isGuestRequestRequired,environment:b,inviteTargetsStore:x,menuListStore:M,store:o,styles:k})},ee={key:"suggested",render:e=>(0,T.jsx)(Zt().Z,{...e,style:k.sectionMenuItem,desktopTitleStyle:k.sectionMenuItemTitle,title:(0,T.jsx)(s()._H,{id:"shareMenuSearchRequest.suggestedSection.title",defaultMessage:"Suggested"}),loading:!h}),items:P.map(((e,t)=>({key:"newUser"===e.type?e.value.email:e.value.id,render:t=>{const n=ye().H({target:e,inviteTargetsStore:x});return(0,T.jsx)(cn,{...t,isRedesignEnabled:j,isMobile:b.device.isMobile,disabled:!1,inviteTarget:e,isInvited:n,blockStore:o,spaceVisibleUserMap:w})},action:()=>bn({inviteTarget:e,inviteTargetsStore:x,menuListStore:M,rank:t,tokenQuery:m,environment:b,type:"suggested"})})))},te={key:"in page",render:e=>(0,T.jsx)(Zt().Z,{...e,style:k.sectionMenuItem,title:j?(0,T.jsx)(s()._H,{id:"shareMenuSearchRequest.inPageSection.titleRedesign",defaultMessage:"Already invited"}):(0,T.jsx)(s()._H,{id:"shareMenuSearchRequest.inPageSection.title",defaultMessage:"In page"}),loading:!h}),items:_.map(((e,t)=>{const{inviteTarget:n,permissionItem:i,mostPermissivePermissions:a}=e,{type:r}=n;if("existingUser"===r){if(!!a&&a.length>1)return{key:n.value.id,render:e=>(0,T.jsx)(Mn,{...e,isRedesignEnabled:j,blockStore:o,inviteTarget:n,permissionItem:i,mostPermissivePermissions:a,spaceVisibleUserMap:w,permissionItemArgs:u,rank:t,tokenQuery:m,isRestricted:O}),action:()=>{}};{const e=y.mostPermissiveUserPermissions.find((e=>e.permissionItem.user_id===n.value.id));return e?{key:n.value.id,render:a=>j?(0,T.jsx)(Mn,{...a,isRedesignEnabled:j,blockStore:o,inviteTarget:n,permissionItem:i,spaceVisibleUserMap:w,permissionItemArgs:u,rank:t,tokenQuery:m,isRestricted:O}):(0,T.jsx)(kt().Z,{...a,itemMarginLeft:0,itemMarginRight:0,title:(0,T.jsx)(qt().Z,{store:o,userPermission:e,showInherited:!0,ignoreLocalHoverState:!0,spaceVisibleUserMap:w,permissionItemArgs:u})}),action:()=>{}}:{key:n.value.id,render:e=>(0,T.jsx)(Mn,{...e,isRedesignEnabled:j,blockStore:o,inviteTarget:n,permissionItem:i,spaceVisibleUserMap:w,permissionItemArgs:u,rank:t,tokenQuery:m,isRestricted:O}),action:()=>bn({inviteTarget:n,inviteTargetsStore:x,menuListStore:M,rank:t,tokenQuery:m,environment:b,type:"in_page"})}}}if("group"===r){if(!!a&&a.length>1)return{key:n.value.id,render:a=>(0,T.jsx)(Mn,{...a,isRedesignEnabled:j,blockStore:o,inviteTarget:n,permissionItem:i,mostPermissivePermissions:e.mostPermissivePermissions,spaceVisibleUserMap:w,permissionItemArgs:u,rank:t,tokenQuery:m,isRestricted:O}),action:()=>{}};{const e=y.mostPermissiveGroupPermissions.find((e=>e.permissionItem.group_id===n.value.group_id));return e?{key:n.value.id,render:t=>(0,T.jsx)(kt().Z,{...t,itemMarginLeft:0,itemMarginRight:0,title:(0,T.jsx)(Gt().Z,{store:o,groupPermission:e,spaceId:o.getSpaceId(),showInherited:!0,permissionItemArgs:u})}),action:()=>{}}:{key:n.value.id,render:e=>(0,T.jsx)(Mn,{...e,isRedesignEnabled:j,blockStore:o,inviteTarget:n,permissionItem:i,spaceVisibleUserMap:w,permissionItemArgs:u,rank:t,tokenQuery:m,isRestricted:O}),action:()=>bn({inviteTarget:n,inviteTargetsStore:x,menuListStore:M,rank:t,tokenQuery:m,environment:b,type:"in_page"})}}}(0,F().t1)(r)}))},ne={key:"not in page",render:e=>(0,T.jsx)(Zt().Z,{...e,style:k.sectionMenuItem,title:m.length>0&&(j?(0,T.jsx)(s()._H,{id:"shareMenuSearchRequest.notInPageSection.titleRedesign",defaultMessage:"Not invited to page"}):(0,T.jsx)(s()._H,{id:"shareMenuSearchRequest.notInPageSection.title",defaultMessage:"Not in page"})),loading:!h}),items:P.map(((e,t)=>({key:"newUser"===e.type?e.value.email:e.value.id,render:t=>(0,T.jsx)(cn,{...t,disabled:!1,isRedesignEnabled:j,isMobile:b.device.isMobile,inviteTarget:e,isInvited:ye().H({target:e,inviteTargetsStore:x}),blockStore:o,spaceVisibleUserMap:w}),action:()=>bn({inviteTarget:e,inviteTargetsStore:x,menuListStore:M,rank:t,tokenQuery:m,environment:b,type:"not_in_page"})})))};let oe=[];if(D&&oe.push(X),U&&oe.push(ee),N&&oe.push(te),H&&oe.push(ne),W&&oe.push(G),z&&oe.push(Y),l&&(oe=[G],0===G.items.length))return(0,T.jsx)(jn,{styles:k,importContactType:"slack"});if(d&&(oe=[Y],0===Y.items.length))return(0,T.jsx)(jn,{styles:k,importContactType:"google"});if(0===oe.length){if(oe=[X],0===m.length&&!B)return(0,T.jsx)(kn,{styles:k});if(0===m.length&&B)return(0,T.jsx)("div",{style:k.keepTypingMessage,children:(0,T.jsx)(p().Z,{isSecondaryColor:!0,isSmall:!0,children:(0,T.jsx)(s()._H,{id:"shareMenuSearchRequest.suggestedEmail.title",defaultMessage:"Keep typing an email to invite"})})})}return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)($t,{publicPermission:c.mostPermissivePublicItem}),(0,T.jsx)(Tt().ZP,{type:Tt().iW.Vertical,initialFocus:m.length>0?0:void 0,sections:oe,store:M,disableKeyboard:S})]})}function vn(e){const{filteredContacts:t,isRedesignEnabled:n,environment:o,inviteTargetsStore:i,blockStore:a,spaceVisibleUserMap:r,tokenQuery:s,menuListStore:l,importContactType:d}=e;return t.map(((e,t)=>({key:e.value.email,render:t=>(0,T.jsx)(cn,{...t,isRedesignEnabled:n,isMobile:o.device.isMobile,disabled:!1,inviteTarget:e,isInvited:ye().H({target:e,inviteTargetsStore:i}),blockStore:a,spaceVisibleUserMap:r}),action:()=>{ye().H({target:e,inviteTargetsStore:i})?i.setState({...i.state,inviteTargets:i.state.inviteTargets.filter((t=>"newUser"!==t.type||e.value.email!==t.value.email))}):(O().hE(o,{invite_token_query:s,selected_user_token:e,selected_user_token_rank:t,from:"share_modal_invite",subscription_tier:(0,zt().zt)(),type:yn(d)}),i.setState({inviteTargets:[...i.state.inviteTargets,e],tokenQuery:""}),l.unsetFocus())}})))}function yn(e){return"google"===e?"google_contacts":"slack"===e?"slack":void(0,F().t1)(e)}function bn(e){const{inviteTarget:t,inviteTargetsStore:n,menuListStore:o,rank:i,tokenQuery:a,environment:r,type:s}=e;if(ye().H({target:t,inviteTargetsStore:n})){const e=n.state.inviteTargets.filter((e=>"group"===t.type&&"group"===e.type?t.value.group_id!==e.value.group_id:"existingUser"===t.type&&"existingUser"===e.type?t.value.id!==e.value.id:"newUser"!==t.type||"newUser"!==e.type||t.value.email!==e.value.email));return n.setState({...n.state,inviteTargets:e}),void o.unsetFocus()}O().hE(r,{invite_token_query:a,selected_user_token:t,selected_user_token_rank:i,from:"share_modal_invite",subscription_tier:(0,zt().zt)(),type:s}),n.setState({inviteTargets:[...n.state.inviteTargets,t],tokenQuery:""}),o.unsetFocus()}const xn=o.forwardRef((function(e,t){const{blockStore:n,inviteTarget:s,permissionItem:l,mostPermissivePermissions:d,permissionItemArgs:c,isRedesignEnabled:u}=e,m=(0,i().O7)(),[p,g]=(0,o.useState)(!1),f=(0,a().VK)((()=>n.getSpaceId()),[n]),h=(0,a().VK)((()=>d&&d.length>0),[d]),v=(0,o.useCallback)((()=>{if(h){const e=!1===p;g(!p),e&&Ct().dS(m,{share_menu_session_id:V().default.state.sessionId,type:"group",group_id:s.value.group_id})}}),[m,h,p,g,s]),y=(0,r().yK)((e=>({buttonMenuItem:(0,Ie().u0)({isRedesignEnabled:u,isMobile:m.device.isMobile}),permissionRoleButton:{marginRight:-6,color:e.mediumTextColor,fontSize:12},container:{whiteSpace:"nowrap",fontWeight:S().Ue.bold},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"},tooltip:{maxWidth:180},expandablePermissionList:{paddingLeft:16},roundedPermissionItem:{borderRadius:4,overflow:"hidden",marginRight:4}})),[m.device.isMobile,u]);return(0,T.jsx)(At().Z,{delayThreshold:0,placement:Ft().Placement.Left,textWrap:!0,style:y.tooltip,renderTooltip:()=>(0,T.jsx)(wn,{blockStore:n,blockPermissionItem:l}),render:o=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{...o,children:(0,T.jsx)(kt().Z,{...e,buttonStyle:y.buttonMenuItem,...(0,Dt().Z)(e,{onClick:v}),ref:t,title:(0,T.jsx)(tn,{inviteTarget:s,isRedesignEnabled:u,isMobile:m.device.isMobile,captionOverride:h&&p?(0,T.jsx)(Cn,{}):void 0}),right:(0,T.jsx)(Rt().d,{type:l.type,table:xt().iU,disabled:!0,icon:h?p?ft().R:ht().P:void 0,role:l.role??"none",isCurrentUser:!1,buttonStyle:y.permissionRoleButton})})}),h&&p&&(0,T.jsx)("div",{style:y.expandablePermissionList,children:null==d?void 0:d.map(((t,o)=>{const i=t.permissionItem.type;let a=null;switch(i){case"space_permission":a=(0,T.jsx)(mn().Z,{store:n,spacePermission:t,showTrustedDomainPermission:!1,trustedDomainPermission:void 0,permissionItemArgs:c,fromPermissionWrapper:"expandable_permission",isRestricted:e.isRestricted});break;case"explicit_team_permission":a=(0,T.jsx)(gn().Z,{store:n,blockTeamPermission:t,isExternalTeam:!0,permissionItemArgs:c,fromPermissionWrapper:"expandable_permission"});break;case"group_permission":a=(0,T.jsx)(Gt().Z,{spaceId:f,store:n,groupPermission:t,permissionItemArgs:c,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"user_permission":case"explicit_team_owner_permission":case"explicit_team_guest_permission":case"public_permission":case"bot_permission":case"deleted_permission":case"restricted_permission":case"exclusive_user_permission":case"trusted_domain_permission":case"team_owner_permission":case"team_permission":break;default:(0,F().t1)(i)}return(0,T.jsx)("div",{style:y.roundedPermissionItem,children:a},o)}))})]})})})),Sn=o.forwardRef((function(e,t){const{blockStore:n,inviteTarget:s,permissionItem:l,mostPermissivePermissions:d,spaceVisibleUserMap:c,permissionItemArgs:u}=e,m=(0,i().O7)(),[p,g]=(0,o.useState)(!1),f="existingUser"===s.type?Kt().U6.createChildStore(n,{table:q().KJ,id:s.value.id}):void 0,h=(0,a().VK)((()=>"none"===s.spaceRole?(0,Lt().B)({spaceVisibleUserMap:c,userId:s.value.id,blockStore:n}):(0,Qt().K)(s.spaceRole)),[s,c,n]),v=(0,a().VK)((()=>n.getSpaceId()),[n]),y=(0,a().VK)((()=>d&&d.length>0),[d]),b=(0,o.useCallback)((()=>{const e=!1===p;g(!p),e&&Ct().dS(m,{share_menu_session_id:V().default.state.sessionId,type:"user",userId:s.value.id})}),[m,p,g,s]),x=(0,r().yK)((e=>({permissionRoleButton:{marginRight:-6,color:e.mediumTextColor,fontSize:12},container:{whiteSpace:"nowrap",fontWeight:S().Ue.bold},cellMemberAvatarContainer:{paddingTop:8,paddingBottom:8},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"},tooltip:{maxWidth:180},expandablePermissionList:{paddingLeft:Ie().w5},roundedPermissionItem:{borderRadius:4,overflow:"hidden",marginRight:4}})),[]);return(0,T.jsx)(At().Z,{delayThreshold:0,placement:Ft().Placement.Left,textWrap:!0,style:x.tooltip,renderTooltip:()=>(0,T.jsx)(wn,{blockStore:n,blockPermissionItem:l}),render:o=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{...o,children:(0,T.jsx)(kt().Z,{...e,...(0,Dt().Z)(e,{onClick:b}),ref:t,title:(0,T.jsx)(Qt().Z,{isLarge:!0,actorStore:f,containerStyle:x.cellMemberAvatarContainer,spaceRole:h,caption:y&&p?(0,T.jsx)(Cn,{}):void 0}),right:(0,T.jsx)(Rt().d,{type:l.type,table:xt().iU,disabled:!0,icon:y?p?ft().R:ht().P:void 0,role:l.role??"none",isCurrentUser:!1,buttonStyle:x.permissionRoleButton})})}),y&&p&&(0,T.jsx)("div",{style:x.expandablePermissionList,children:null==d?void 0:d.map(((t,o)=>{const i=t.permissionItem.type;let a=null;switch(i){case"space_permission":a=(0,T.jsx)(mn().Z,{store:n,spacePermission:t,showTrustedDomainPermission:!1,trustedDomainPermission:void 0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission",isRestricted:e.isRestricted});break;case"explicit_team_owner_permission":a=(0,T.jsx)(fn().Z,{store:n,blockTeamOwnerPermission:t,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_permission":a=(0,T.jsx)(gn().Z,{store:n,blockTeamPermission:t,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_guest_permission":a=(0,T.jsx)(pn().Z,{store:n,blockTeamGuestPermission:t,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"group_permission":a=(0,T.jsx)(Gt().Z,{store:n,spaceId:v,groupPermission:t,permissionItemArgs:u,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"user_permission":a=(0,T.jsx)(qt().Z,{store:n,userPermission:t,permissionItemArgs:u,spaceVisibleUserMap:c,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"public_permission":case"bot_permission":case"deleted_permission":case"restricted_permission":case"exclusive_user_permission":case"trusted_domain_permission":case"team_owner_permission":case"team_permission":break;default:(0,F().t1)(i)}return(0,T.jsx)("div",{style:x.roundedPermissionItem,children:a},o)}))})]})})})),Mn=o.forwardRef((function(e,t){const{inviteTarget:n}=e,o=n.type,i=(0,a().VK)((()=>(0,L().wZ)()),[]);switch(o){case"group":return i?(0,T.jsx)(un().ZP,{...e,inviteTarget:n}):(0,T.jsx)(xn,{...e,ref:t,inviteTarget:n});case"existingUser":return i?(0,T.jsx)(un().ZP,{...e,inviteTarget:n}):(0,T.jsx)(Sn,{...e,ref:t,inviteTarget:n});default:(0,F().t1)(o)}}));function wn(e){const{blockStore:t,blockPermissionItem:n}=e,o=(0,i().O7)(),l=(0,a().VK)((()=>nt().default.state.currentSpaceStore),[]),d=(0,a().VK)((()=>{if(l)return(0,N().Wd)(o,l)}),[o,l]),c=(0,a().VK)((()=>{const e=n.type;if("explicit_team_permission"===e||"explicit_team_owner_permission"===e||"explicit_team_guest_permission"===e){return Kt().zX.createChildStore(t,{table:Mt().e0,id:n.team_id})}}),[t,n]),u=(0,a().VK)((()=>null==c?void 0:c.getIcon()),[c]),m=(0,r().yK)((()=>({container:{fontWeight:S().Ue.bold,...S().Yu},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"}})),[]),p=n.type;return"space_permission"===p?(0,T.jsx)(s()._H,{id:"shareMenu.searchResult.spacePermission.tooltip",defaultMessage:"Everyone at {spaceIconAndName} has access.",values:{spaceIconAndName:(0,T.jsxs)("span",{style:m.container,children:[d&&(0,T.jsx)(_t().Z,{disabled:!0,icon:d,isEmptyPage:!1,size:12,style:m.recordIcon}),l&&(0,T.jsx)(Pt().Z,{store:l,style:m.recordTitle})]})}}):"explicit_team_owner_permission"===p?(0,T.jsx)(s()._H,{id:"shareMenu.searchResult.teamPermission.tooltip",defaultMessage:"Teamspace owners of {teamIconAndName} have access.",values:{teamIconAndName:(0,T.jsxs)("span",{style:m.container,children:[u&&(0,T.jsx)(_t().Z,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:m.recordIcon}),c&&(0,T.jsx)(Pt().Z,{store:c,style:m.recordTitle})]})}}):"explicit_team_permission"===p?(0,T.jsx)(s()._H,{id:"shareMenu.searchResult.teamMemberPermission.tooltip",defaultMessage:"Teamspace members of {teamIconAndName} have access.",values:{teamIconAndName:(0,T.jsxs)("span",{style:m.container,children:[u&&(0,T.jsx)(_t().Z,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:m.recordIcon}),c&&(0,T.jsx)(Pt().Z,{store:c,style:m.recordTitle})]})}}):"explicit_team_guest_permission"===p?(0,T.jsx)(s()._H,{id:"shareMenu.searchResult.teamGuestPermission.tooltip",defaultMessage:"Teamspace guests of {teamIconAndName} have access.",values:{teamIconAndName:(0,T.jsxs)("span",{style:m.container,children:[u&&(0,T.jsx)(_t().Z,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:m.recordIcon}),c&&(0,T.jsx)(Pt().Z,{store:c,style:m.recordTitle})]})}}):"group_permission"===p?(0,T.jsx)(s()._H,{id:"shareMenu.searchResult.groupPermission.tooltip",defaultMessage:"This group has access."}):"user_permission"===p||"exclusive_user_permission"===p||"public_permission"===p||"trusted_domain_permission"===p||"restricted_permission"===p||"deleted_permission"===p||"team_permission"===p||"team_owner_permission"===p||"bot_permission"===p?(0,T.jsx)(T.Fragment,{children:bt().YX(n.role??"none")&&(0,T.jsx)(s()._H,{id:"shareMenu.searchResult.userPermission.tooltip",defaultMessage:"This user has access"})}):void(0,F().t1)(p)}function Cn(){return(0,T.jsx)(s()._H,{id:"shareMenu.inPageSearchResult.caption",defaultMessage:"Permission from"})}function jn(e){const{styles:t,importContactType:n}=e,o="google"===n?"Google account":"Slack workspace";return(0,T.jsxs)("div",{style:t.zeroState,children:[(0,vt()._)(t.zeroStateIcon),(0,T.jsxs)("div",{style:t.zeroStateText,children:[(0,T.jsx)("div",{style:{fontWeight:S().Ue.semibold,marginBottom:4},children:(0,T.jsx)(s()._H,{id:"shareMenuSearchRequest.noImportedContacts.title",defaultMessage:"No contacts found"})}),(0,T.jsx)("div",{children:(0,T.jsx)(s()._H,{id:"shareMenuSearchRequest.noImportedContacts.text",defaultMessage:"Try connecting a different {externalIntegrationCopy} or typing an email address",values:{externalIntegrationCopy:o}})})]})]})}function kn(e){const{styles:t}=e;return(0,T.jsxs)("div",{style:t.zeroState,children:[(0,pt().C)(t.zeroStateIcon),(0,T.jsxs)("div",{style:t.zeroStateText,children:[(0,T.jsx)("div",{style:{fontWeight:S().Ue.semibold,marginBottom:4},children:(0,T.jsx)(s()._H,{id:"shareMenuSearchRequest.noSuggestions.title",defaultMessage:"Members and guests will appear here"})}),(0,T.jsx)("div",{children:(0,T.jsx)(s()._H,{id:"shareMenuSearchRequest.noSuggestions.text",defaultMessage:"Try inviting someone with their email address or importing contacts"})})]})]})}function Tn(e){let{tokenQuery:t,possibleDomains:n,shouldShowAutoFillEmail:o}=e;const i=(0,ct().ZP)(t,function(e,t,n){return n?Array.from(new Set([...t,"gmail.com","yahoo.com","outlook.com","hotmail.com"])).map(((t,n)=>({tokenQuery:`${e.split("@")[0]}@${t}`,weight:n}))).slice(0,3):[{tokenQuery:e,weight:0}]}(t,n,o),(e=>e.tokenQuery));return 0===i.length?[{tokenQuery:t,weight:0}]:i}function In(e){let{tokenQuery:t,possibleDomains:n,isGuestInviteRequestRequired:o,shouldShowAutoFillEmail:i,environment:a,inviteTargetsStore:r,menuListStore:l,store:d,styles:c}=e;return Tn({tokenQuery:t,possibleDomains:n,shouldShowAutoFillEmail:i}).map(((e,n)=>({key:e.tokenQuery,render:t=>(0,T.jsx)(kt().Z,{icon:(0,mt().a)({width:24,height:24}),title:(0,T.jsx)(_n,{tokenQuery:e.tokenQuery,shouldShowAutofillEmail:i,isGuestInviteRequestRequired:o}),caption:o?(0,T.jsx)(s()._H,{id:"shareMenuSearchRequest.requestNewUser.buttonItem.caption",defaultMessage:"Workspace owners are required to view and approve guest invites"}):void 0,right:(0,T.jsx)(T.Fragment,{children:i?(0,gt().y)(c.arrowUpLeftIcon):null}),rightStyle:{marginRight:4},...t}),action:async()=>{const o=(0,me().H3)(e.tokenQuery);if(!(0,me().oH)(o)){const t={type:"invalidUser",value:{text:e.tokenQuery}};return void(ye().H({target:t,inviteTargetsStore:r})||r.setState({inviteTargets:[...r.state.inviteTargets,t],tokenQuery:""}))}const i=await jt().M5(a,[o]);if(!i.length)return;const s=i[0];ye().H({target:s,inviteTargetsStore:r})||(O().hE(a,{invite_token_query:t,selected_user_token:s,selected_user_token_rank:n,from:"share_modal_invite",subscription_tier:(0,zt().zt)(),type:"autofill"}),r.setState({inviteTargets:[...r.state.inviteTargets,s],tokenQuery:""}),l.unsetFocus())}})))}function _n(e){const{tokenQuery:t,shouldShowAutofillEmail:n,isGuestInviteRequestRequired:o}=e;return o?(0,T.jsx)(s()._H,{id:"shareMenuSearchRequest.requestNewUser.buttonItem",defaultMessage:"Request {tokenQuery} as a guest",values:{tokenQuery:t}}):n?(0,T.jsx)(s()._H,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem.v1",defaultMessage:"”{tokenQuery}”",values:{tokenQuery:t}}):(0,T.jsx)(s()._H,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem",defaultMessage:"Invite {tokenQuery}",values:{tokenQuery:t}})}const Pn=function(e){const t=(0,i().O7)(),n=(0,s().YB)(),[r,l]=(0,o.useState)(!0),d=(0,a().VK)((()=>e.inviteTargetsStore.state.tokenQuery),[e.inviteTargetsStore]),c=(0,a().VK)((()=>{if(e.shouldShowSlackOnly||e.shouldShowGoogleOnly)return{userLimit:0,botLimit:0,groupLimit:0,importContactLimit:e.sectionRenderLimit};const t=ot().default.completeSlackAuthentications.state.length>0&&Je().Rv(),n=ot().default.externalAuthentications.state.filter((e=>e.integration_id===He().lT)).length>0;return{userLimit:e.sectionRenderLimit,botLimit:0,groupLimit:e.shouldShowGroups?e.sectionRenderLimit:0,importContactLimit:t||n?e.sectionRenderLimit:0}}),[e.sectionRenderLimit,e.shouldShowGroups,e.shouldShowSlackOnly,e.shouldShowGoogleOnly]),[{value:u,status:m}]=(0,ut().r5)((async()=>({...await jt().jL({query:d,sectionLimit:c,membersOnly:e.membersOnly,environment:t,intl:n}).finally((()=>l(!1))),tokenQuery:d})),[t,n,e.membersOnly,d,c],{debounce:40});return(0,T.jsx)(hn,{...e,tokenQuery:d,showShimmer:r,ready:"pending"!==m&&"idle"!==m,error:"rejected"===m,result:u})};function Zn(e){const t=(0,i().O7)(),n=(0,a().qz)(e.inviteTargetsStore,se().ZP),r=(0,a().VK)((()=>n.state.inviteTargets),[n]),{display:s,source:l,focus:d,emailMessage:c}=(0,a().VK)((()=>{const{display:e}=V().default.state;return e===V().wV.Invite?V().default.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),u=(0,a().VK)((()=>nt().default.state.currentSpaceStore),[]),m=s===V().wV.Invite&&r.length>0,p=(0,a().VK)((()=>l===V().T5.Notion&&0===r.length&&(0,Je().Rv)()),[r.length,l]),g=(0,a().Kw)(ot().default.completeSlackAuthentications),f=(0,a().VK)((()=>l===V().T5.Notion&&0===r.length&&(0,Je().rd)(!0)),[r.length,l]),h=(0,a().VK)((()=>ot().default.externalAuthentications.state.filter((e=>e.integration_id===He().lT))),[]),v=(0,a().VK)((()=>(0,L().wZ)()),[]),[y,b]=(0,o.useState)(!1),x=m&&!p,S=(0,o.useCallback)((()=>{n.reset()}),[n]);(0,o.useEffect)((()=>{if(u&&!y&&(p||f)){if(p)for(const e of g)We().callApi({eventName:"loadContacts",environment:t,data:{botId:e.id,spaceId:u.id,integrationId:He().nO,importContactType:"slack"}}).catch((e=>{}));if(f)for(const e of h)We().callApi({eventName:"loadContacts",environment:t,data:{botId:e.id,spaceId:u.id,integrationId:He().lT,importContactType:"google"}}).catch((e=>{}));b(!0)}}),[p,f]);const M=Ln({scrollerMarginBottom:x?lt:0});return s!==V().wV.Invite?null:(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Ye().T,{type:et().Z.Y,style:M.scroller,children:(0,T.jsx)(Pn,{inviteTargetsStore:n,store:e.store,menuListStore:e.menuListStore,shouldShowGroups:!0,shouldShowSlackOnly:l===V().T5.Slack,shouldShowGoogleOnly:l===V().T5.Google,membersOnly:!1,sectionRenderLimit:10,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs})}),(0,T.jsx)(An,{shouldShowSlackImportContactsButton:p,shouldShowGoogleImportContactsButton:f,emailMessage:c,inviteTargetsStore:n,isRedesignEnabled:v,emailMessageOpen:x,flowId:e.flowId}),(0,T.jsx)(dt,{open:m&&!p,focus:d===V().Sw.Message,value:c,onFocus:()=>{l&&s===V().wV.Invite&&V().default.setState({...V().default.state,focus:V().Sw.Message,tab:V().XF.Share,display:s,source:l,emailMessage:c})},onChange:e=>{V().default.setState({...V().default.state,focus:d,tab:V().XF.Share,display:s,source:l,emailMessage:e.target.value})},onCancel:async()=>{await it().zd({environment:t,inviteTargetsStore:n})&&(it().a6(t),S())},maxLength:1e3})]})}function An(e){const{shouldShowSlackImportContactsButton:t,shouldShowGoogleImportContactsButton:n,emailMessage:o,inviteTargetsStore:i,isRedesignEnabled:a,emailMessageOpen:r,flowId:s}=e,l=Ln({scrollerMarginBottom:r?lt:0}),d=(0,Xe().ph)(),c=e=>{V().default.setState({...V().default.state,tab:V().XF.Share,display:V().wV.Invite,focus:V().Sw.Search,source:e,emailMessage:o}),i.setState({...i.state,tokenQuery:""})};if(t&&n){const e=(0,Qe().e)({onClickAuthenticated:c,hideChevronIcon:a,containerStyle:d.importListButtonContainer,buttonStyle:d.importListButton,flowId:s});return(0,T.jsx)(Ge().ZP,{popupType:tt().k.Popup,alignmentToOrigin:Ge().vR.Start,placementToOrigin:Ge().pO.Left,render:()=>(0,T.jsx)($e().Z,{importListItems:e}),originGap:12,renderOrigin:e=>(0,T.jsx)("div",{style:l.importContactsContainer,children:(0,T.jsx)(ze().D,{style:l.importContactsButton,onClick:e.onClick,children:(0,T.jsx)("div",{style:d.labelContainer,children:a?(0,T.jsx)(Rn,{}):(0,T.jsx)(Bn,{})})})})})}return t?(0,T.jsx)(Ee().hF,{onClickAuthenticated:()=>c(V().T5.Slack),title:a?(0,T.jsx)(Rn,{}):(0,T.jsx)(Bn,{}),containerStyle:l.importContactsContainer,buttonStyle:a?l.importContactsButtonV2:l.importContactsButton,from:"share_menu",inviteOrigin:"page_share_modal",flowId:s,loadContacts:!0,hideChevronIcon:a}):null}function Rn(){const e=(0,r().yK)((e=>({integrationName:{display:"flex"},importContactsButtonTitle:{display:"flex",alignItems:"center",color:e.regularTextColor,gap:8},arrowDownIcon:{height:20,width:20}})),[]);return(0,T.jsxs)("div",{style:e.importContactsButtonTitle,children:[(0,T.jsx)("div",{style:e.integrationName,children:Ke(e.arrowDownIcon)}),(0,T.jsx)(s()._H,{defaultMessage:"Import contacts",id:"importContactsButton.importContacts.label"})]})}function Bn(){const e=(0,r().yK)((()=>({integrationName:{display:"flex"},integrationIcon:{marginRight:4}})),[]),t=(0,T.jsxs)("div",{style:e.integrationName,children:[(0,T.jsx)(qe().Z,{type:"image_url",imageURL:Fe().Z.images.externalIntegrations.slackIconPng,size:18,imageStyle:e.integrationIcon}),(0,T.jsx)(s()._H,{defaultMessage:"Slack",id:"importContactsButton.integrationName"})]});return(0,T.jsx)(s()._H,{defaultMessage:"Add contacts from {integrationNameWithLogo}",id:"importContactsButton.integrationButton.label",values:{integrationNameWithLogo:t}})}function Ln(e){let{scrollerMarginBottom:t}=e;return(0,r().yK)((e=>({scroller:{flexGrow:1,marginBottom:t},importContactsContainer:{height:36,bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:"all",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",padding:3},importContactsButton:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9,gap:8},importContactsButtonV2:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9,gap:8,fill:e.regularTextColor}})),[t])}var Dn=()=>n(370005),Vn=()=>n(480089),On=()=>n(921981),Un=()=>n(631842),Nn=()=>n(754918),Fn=()=>n(830581),Hn=()=>n(906651),Kn=()=>n(779522),En=()=>n(983653);function Wn(e){const{email:t}=e;return(0,T.jsx)(ee().Z,{avatar:{email:t},size:28})}function zn(e){const{children:t}=e,n=(0,r().yK)((()=>({wrapper:{position:"relative"},shield:{position:"absolute",left:17,top:18}})),[]);return(0,T.jsxs)("div",{style:n.wrapper,children:[t,(0,T.jsx)("div",{style:n.shield,children:(0,T.jsx)(Le().y,{iconGroup:En().t,colorName:"secondary",variantName:"mini"})})]})}function Gn(e){const{rows:t,internalDomains:n}=e,o=(0,r().yK)((e=>({inviteTargetList:{background:e.surface.wash,borderRadius:12,maxHeight:227,overflowY:"auto",padding:"12px 16px",width:"100%"}})),[]);return(0,T.jsx)(Ye().T,{type:et().Z.Y,style:o.inviteTargetList,children:(0,T.jsx)(Y().jX,{gap:16,children:t.map((e=>{const{type:t}=e;switch(t){case"new":return(0,T.jsx)(qn,{email:e.email,internalDomains:n},e.email);case"existing":return(0,T.jsx)(Yn,{userStore:e.userStore,internalDomains:n},e.userStore.id);default:(0,F().t1)(t)}}))})})}function qn(e){const{email:t,internalDomains:n}=e,o=(0,pe().is)(t,n);return(0,T.jsx)($n,{avatar:o?(0,T.jsx)(zn,{children:(0,T.jsx)(Wn,{email:t})}):(0,T.jsx)(Wn,{email:t}),name:t,email:t})}function Yn(e){const{userStore:t,internalDomains:n}=e,o=(0,s().YB)(),{name:i,email:r}=(0,a().VK)((()=>({name:t.getDisplayName(o),email:t.getEmail()})),[t,o]);if(!i||!r)return null;const l=(0,pe().is)(r,n);return(0,T.jsx)($n,{avatar:l?(0,T.jsx)(zn,{children:(0,T.jsx)(ee().Z,{userStore:t,size:28})}):(0,T.jsx)(ee().Z,{userStore:t,size:28}),name:i,email:r})}function $n(e){const{avatar:t,name:n,email:o}=e;return(0,T.jsxs)(Y().jX,{direction:"row",gap:10,align:"center-left",children:[t,(0,T.jsxs)(Y().jX,{gap:2,children:[(0,T.jsx)($().q,{styleName:"Body-14px/Medium",children:n}),(0,T.jsx)($().q,{styleName:"Caption-12px/Regular",colorName:"secondary",children:o})]})]})}function Jn(e){const{type:t}=e;switch(t){case"new":return e.email;case"existing":return e.userStore.getEmail();default:(0,F().t1)(t)}}function Qn(e){const{inviteUserListRows:t,spaceStore:n,spaceUserStore:r,onClickAddMembers:l,onClickManageGuests:d}=e,c=(0,i().O7)(),u=(0,s().YB)(),[m,p]=(0,a().VK)((()=>[n.id,n.getName()]),[n]),g=(0,a().VK)((()=>null==r?void 0:r.getUserId()),[r]),f=(0,a().VK)((()=>{var e;return(null===(e=Kn().Z.getData(c,{spaceId:m}))||void 0===e?void 0:e.filter((e=>e.hasGuests)).map((e=>e.domain)))??[]}),[c,m]),h=(0,Ce().oo)({name:"internal_guests",spaceId:m,userId:g,amount:0}),v=(0,o.useCallback)((()=>{const e=t.map(Jn).filter(F().$K);l(e)}),[t,l]);return h&&f?(0,T.jsx)(fe().Z,{debugName:"AddAsMembersModalContent",capture:!0,onEnter:v,children:(0,T.jsx)(Fn().sR,{header:(0,T.jsx)(Fn().vI,{iconAndTitle:(0,T.jsx)(Fn().kC,{iconGroup:Nn().G,iconColorName:"secondary",title:u.formatMessage(eo.title,{spaceName:p,guestLimit:h.limit.total})}),description:u.formatMessage(eo.description,{domain:f[0].url,p:e=>(0,T.jsx)($().q,{colorName:"uiBluePrimary",children:(0,T.jsx)("p",{children:e})})})}),footer:(0,T.jsx)(Xn,{rowCount:t.length,onClickAddMembers:v,onClickManageGuests:d}),children:(0,T.jsx)(Gn,{rows:t,internalDomains:f})})}):null}function Xn(e){const{rowCount:t,onClickAddMembers:n,onClickManageGuests:o}=e,i=(0,s().YB)(),a=i.formatMessage(eo.addMember,{rowCount:t});return(0,T.jsxs)(Y().jX,{gap:16,children:[(0,T.jsxs)(Y().jX,{gap:8,children:[(0,T.jsx)(Hn().Z,{"aria-label":a,onClick:n,style:{height:32},children:a}),(0,T.jsx)(J().Z,{"aria-label":i.formatMessage(eo.manageGuestsInSettings),onClick:o,children:i.formatMessage(eo.manageGuestsInSettings)})]}),(0,T.jsx)("div",{style:{textAlign:"center"},children:(0,T.jsx)($().q,{styleName:"Caption-12px/Regular",colorName:"secondary",children:i.formatMessage(eo.billingNotice)})})]})}const eo=(0,s().vU)({title:{id:"addAsMembersModal.title",defaultMessage:"{spaceName} is over the guest limit of {guestLimit}"},description:{id:"addAsMembersModal.description",defaultMessage:"Shares to work email domains ending with ‘@{domain}’ must be added as members with access to your entire workspace."},upgradeButton:{id:"addAsMembersModal.addMembersButton",defaultMessage:"{guestCount, plural, one {Add as member} other {Add as {guestCount} members}}"},addMember:{id:"addAsMembersModal.addMember",defaultMessage:"Add {rowCount, plural, one {member} other {{rowCount} members}}"},manageGuestsInSettings:{id:"addAsMembersModal.manageGuestsInSettings",defaultMessage:"Manage guests in settings"},billingNotice:{id:"addAsMembersModal.billingNotice",defaultMessage:"Each new member will be billed as an additional seat"}});n(821057);var to=()=>n(839002),no=()=>n(102182),oo=()=>n(799891),io=()=>n(578292),ao=()=>n(720866),ro=()=>n(308186),so=()=>n(784234),lo=()=>n(527278);const co=(0,s().vU)({nonAdminCannotEditPermissions:{defaultMessage:"You cannot give this person access to this page. Ask your admin to do this for you.",id:"permissions.nonAdminCannotEditPermissions.message"}});async function uo(e){const{environment:t,email:n}=e,o=await We().callApi({eventName:"findUser",environment:t,data:{email:n}});if("success"===o.type){const e=o.data;if(e.value)return e.value.value.id}return await async function(e){const{environment:t,email:n}=e,o=await We().callApi({eventName:"createEmailUser",environment:t,data:{email:n,preferredLocaleOrigin:"inferred_from_inviter",preferredLocale:(0,io().E2)(lo().Z.getIntl())}});if("failed"===o.type)throw o.error;return o.data.userId}({environment:t,email:n})}async function mo(e){const{blockPermissionItem:t,blockStore:n,environment:o,metadata:i,sudoModeStore:a}=e;await so().pk({environment:o,store:n,sudoModeStore:a,permissionItems:[t],invite:i,skipGuestLimitValidation:!0})}var po=()=>n(343308);async function go(e){const{environment:t,intl:n,internalDomains:o,destination:i,invites:a,metadata:r,sudoModeStore:s,contextualInviteStore:l}=e,d=await async function(e){const{environment:t,invites:n,destination:o,metadata:i,sudoModeStore:a,contextualInviteStore:r}=e,s=(await(0,to().qd)(n,20,(e=>async function(e){const{invite:t}=e,{defaultAddability:n}=t;switch(n.type){case"none":break;case"member":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i}=e,{invitee:a,defaultAddability:r}=n;if(void 0===a)throw new Error("Expected invite.invitee to be defined");const{email:s}=a,{blockRole:l,blockStore:d,spaceRole:c,spaceStore:u}=o,{inviteOrigin:m}=i,p=await uo({environment:t,email:s});if(!p)return;const g={type:"user_permission",role:c,user_id:p},f={type:"user_permission",role:l,user_id:p},h=await async function(e){const{blockPermissionItem:t,blockStore:n,environment:o,inviteOrigin:i,spacePermissionItem:a,spaceStore:r,sudoModeStore:s}=e;if(t.user_id!==a.user_id)throw new Error("User IDs for block and space permission items must match");if(!r.isTeamsEnabled()&&!(await H().HD({environment:o,flowId:"",trackCreateTeamComplete:!1})))return!1;try{await so().pk({environment:o,store:r,sudoModeStore:s,permissionItems:[a],invite:{inviteOrigin:i}}),await so().pk({environment:o,store:n,sudoModeStore:s,permissionItems:[t],skipGuestLimitValidation:!0,invite:{inviteOrigin:i}})}catch(l){return(0,ao().t)(l).message.toLowerCase().includes("non-admin cannot edit permissions")&&(ro().UW(lo().Z.formatMessage(co.nonAdminCannotEditPermissions)),oo().log({level:"info",from:"createMember",type:"nonAdminCannotEditPermissionsButInviteSent",data:{miscDataToConvertToString:{message:"Member invited a previously removed member to a page, invite was sent but access to space and page not granted.",spaceId:r.id,blockId:n.id,actorId:o.currentUser.id,inviteeId:a.user_id}}})),!1}return!0}({blockPermissionItem:f,blockStore:d,environment:t,inviteOrigin:m,spacePermissionItem:g,spaceStore:u});if(!h)return;const v="member"===r.type&&"over_internal_guest_limit"===r.reason;return{type:"createdMember",invite:n,inviteeUserId:p,spacePermissionItem:g,blockPermissionItem:f,wasInternalDomainEnforced:v}}(e);case"member_request":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i}=e,{invitee:a,internalDomain:r}=n;if(void 0===a)throw new Error("Expected invite.invitee to be defined");const{email:s}=a,{spaceStore:l}=o,{inviteMessage:d}=i,c=await uo({environment:t,email:s});if(!c)return;await async function(e){const{environment:t,spaceStore:n,inviteeUserId:o,inviteMessage:i}=e;if(n.canAdmin())throw new Error("This operation is not valid for workspace owners, because member requests are immediately approved when created by a workspace owner. Use createMember instead.");const a=await We().callApi({eventName:"requestAccess",environment:t,data:{type:"actor-to-space",forActorId:o,spaceId:n.id,message:i}});if("failed"===a.type)throw a.error}({environment:t,inviteeUserId:c,inviteMessage:d,spaceStore:l});const u=void 0!==r;return{type:"createdMemberRequest",invite:n,wasInternalDomainEnforced:u}}(e);case"guest":case"guest_page_add":case"member_page_add":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i,sudoModeStore:a}=e,{invitee:r}=n;if(void 0===r)throw new Error("Expected invite.invitee to be defined");const{email:s}=r,{blockRole:l,blockStore:d}=o,c=await uo({environment:t,email:s});if(!c)return;const u={type:"user_permission",role:l,user_id:c};return await mo({blockPermissionItem:u,blockStore:d,environment:t,metadata:i,sudoModeStore:a}),{type:"addedUserPermission",invite:n,inviteeUserId:c,blockPermissionItem:u}}(e);case"guest_request":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i}=e;if(void 0===n.invitee)throw new Error("Expected invite.invitee to be defined");const{email:a}=n.invitee,{blockRole:r,blockStore:s,spaceStore:l}=o,{inviteMessage:d}=i,c={id:s.id,spaceId:l.id},u=await uo({environment:t,email:a});if(!u)return;return await async function(e){const{block:t,blockRole:n,environment:o,inviteeUserId:i,inviteMessage:a}=e,r=await We().callApi({eventName:"requestAccess",environment:o,data:{type:"guest-invite-request",block:t,forActorId:i,message:void 0,attributes:{role:n,inviteMessage:a}}});if("failed"===r.type)throw r.error}({block:c,blockRole:r,environment:t,inviteeUserId:u,inviteMessage:d}),{type:"createdGuestRequest",invite:n}}(e);case"group":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i,sudoModeStore:a}=e,{blockRole:r,blockStore:s}=o;if("group"!==n.inviteTarget.type)throw new Error("Expected invite.inviteTarget to be a group");const l=n.inviteTarget.value,d={type:"group_permission",role:r,group_id:l.group_id};return await mo({blockPermissionItem:d,blockStore:s,environment:t,metadata:i,sudoModeStore:a}),{type:"addedGroupPermission",invite:n,group:l,blockPermissionItem:d}}(e);default:(0,F().t1)(n)}}({environment:t,invite:e,destination:o,metadata:i,sudoModeStore:a})))).filter(F().$K);if(r){const e={};for(const t of s)"addedUserPermission"!==t.type&&"createdMember"!==t.type||"group"===t.invite.inviteTarget.type||(e[t.invite.inviteTarget.value.email]=t.inviteeUserId);r.setState({...r.state,invitedEmailToUserIdMap:e})}return s}({destination:i,environment:t,invites:a,metadata:r,sudoModeStore:s,contextualInviteStore:l});(0,po().CC)({destination:i,environment:t,internalDomains:o,inviteResults:d,metadata:r});const c=(0,L().wZ)();d.length>0&&(c?no().oV({label:fo({invites:a,intl:n})}):no().oV({label:n.formatMessage({id:"shareMenu.inviteResultsToast.label",defaultMessage:"Successfully sent"})}))}function fo(e){var t;const{invites:n,intl:o}=e,i=null===(t=n[0].invitee)||void 0===t?void 0:t.email;i||o.formatMessage({id:"shareMenu.inviteResultsToast.label",defaultMessage:"Successfully sent"});const a=n.length-1;return n.filter((e=>{var t;return"member"!==(null===(t=e.invitee)||void 0===t?void 0:t.currentRole)})).length===n.length?a<=0?o.formatMessage({id:"shareMenu.inviteResultsToast.inviteGuest.label",defaultMessage:"Invite sent to {firstInvitee}"},{firstInvitee:i}):o.formatMessage({id:"shareMenu.inviteResultsToast.inviteGuests.label",defaultMessage:"Invite sent to {firstInvitee} and {numAdditionalInvites, plural, one {{numAdditionalInvites} other person} other {{numAdditionalInvites} others}}"},{firstInvitee:i,numAdditionalInvites:a}):a<=0?o.formatMessage({id:"shareMenu.inviteResultsToast.shareWithMember.label",defaultMessage:"Shared with {firstInvitee}"},{firstInvitee:i}):o.formatMessage({id:"shareMenu.inviteResultsToast.shareWithMultiple.label",defaultMessage:"Shared with {firstInvitee} and {numAdditionalInvites, plural, one {{numAdditionalInvites} other person} other {{numAdditionalInvites} others}}"},{firstInvitee:i,numAdditionalInvites:a})}function ho(e){e.reset(),V().default.setState({...V().default.state,tab:V().XF.Share,display:V().wV.MainShareMenu,source:V().Xd.ShareTopbarButton})}async function vo(e){const{addAsMembersResult:t,destination:n,environment:o,internalDomains:i,intl:a,invites:r,inviteTargetsStore:s,metadata:l}=e;var d;t&&("manageGuests"===t?(d="members",Ve().default.setState({currentTab:d,defaultSubtab:void 0,highlightedSetting:void 0,open:!0,openedFrom:"share_menu"})):"addMembers"===t?(ho(s),await go({destination:n,environment:o,internalDomains:i,invites:r,intl:a,metadata:l})):(0,F().t1)(t))}async function yo(e){const{destination:t,contextualInviteStore:n,defaultAddabilities:o,metadata:i,invites:a,environment:r,internalDomains:s,intl:l,inviteTargetsStore:d,spaceStore:c,spaceUserStore:u,sudoModeStore:m}=e,p=a.map((e=>e.defaultAddability)).some((e=>"member"===e.type&&"over_internal_guest_limit"===e.reason)),g=a.map((e=>e.defaultAddability)).some((e=>["guest","guest_request","guest_page_add"].includes(e.type)));if(p){const e=a.map((e=>function(e){const{inviteTarget:t,environment:n}=e,{type:o}=t;switch(o){case"existingUser":return{type:"existing",userStore:new(Kt().U6)(n,{table:q().KJ,id:t.value.id})};case"newUser":return{type:"new",email:t.value.email};case"group":return;default:(0,F().t1)(o)}}({environment:r,inviteTarget:e.inviteTarget}))).filter(F().$K),n=await async function(e){const{inviteUserListRows:t,spaceStore:n,spaceUserStore:o}=e;return await Un().o.showAsyncModal((e=>(0,T.jsx)(On().c,{isOpen:e.isOpen,onDismiss:e.onDismiss,onClosed:e.onClosed,areaConstraint:{width:{type:"fixed",length:400}},render:()=>(0,T.jsx)(Qn,{inviteUserListRows:t,spaceStore:n,spaceUserStore:o,onClickAddMembers:()=>{e.resolve("addMembers")},onClickManageGuests:()=>{e.resolve("manageGuests")}})})))}({inviteUserListRows:e,spaceStore:c,spaceUserStore:u});await vo({addAsMembersResult:n,destination:t,environment:r,internalDomains:s,intl:l,invites:a,inviteTargetsStore:d,metadata:i})}else{ho(d),await go({destination:t,environment:r,internalDomains:s,intl:l,invites:a,metadata:i,sudoModeStore:m,contextualInviteStore:n});const e=a.map((e=>e.invitee)).filter(F().$K);g&&function(e){const{contextualInviteStore:t,defaultAddabilities:n,environment:o,invitees:i,spaceStore:a}=e,r=i.filter((e=>function(e){const t=e.type;return["guest","guest_request","guest_page_add"].includes(t)}(n[e.email]))).map((e=>({email:e.email,isGuest:"member"!==(null==e?void 0:e.currentRole)})));t.setState({...t.state,invitedUsers:r}),U().fr({environment:o,spaceStore:a,contextualInviteStore:t})}({contextualInviteStore:n,environment:r,spaceStore:c,defaultAddabilities:o,invitees:e})}}function bo(e){const{tooltip:t,disabled:n,onClick:o}=e,i=(0,a().VK)((()=>(0,L().wZ)()),[]);return(0,T.jsx)(At().Z,{disableTooltip:!Boolean(t),renderTooltip:()=>t,render:e=>(0,T.jsx)(Hn().Z,{isLarge:!0,style:{marginLeft:8,...i&&{borderRadius:6,paddingLeft:12,paddingRight:12}},disabled:n,onClick:o,...e,children:(0,T.jsx)(s()._H,{id:"shareMenu.inviteButton.invite",defaultMessage:"Invite"})})})}var xo=()=>n(513670),So=()=>n(429394),Mo=()=>n(122671),wo=()=>n(189783),Co=()=>n(364052),jo=()=>n(311988),ko=()=>n(770708),To=()=>n(981219);const Io=(0,s().vU)({autojoinMember:{defaultMessage:"{email} will automatically be added to the workspace since @{domain} is an allowed email domain",id:"inviteTargetToken.autojoinMember.tooltip"},guestsDisabledMember:{defaultMessage:"Since guests are disabled, {email} will automatically be added to the workspace as a member",id:"inviteTargetToken.guestsDisabledMember.tooltip"},guest:{defaultMessage:"{email} will be invited as a guest",id:"inviteTargetToken.guest.tooltip"},guestV2:{defaultMessage:"Invite {email} as a guest",id:"inviteTargetToken.guest.tooltipV2"},guestRequest:{id:"inviteTargetToken.guestRequest.tooltip",defaultMessage:"This guest must be approved by a workspace owner first"},invalidUser:{defaultMessage:"{text} is not a valid email",id:"inviteTargetToken.invalidUser.tooltip"},overInternalGuestLimit:{id:"inviteTargetToken.overInternalGuestLimit.tooltip",defaultMessage:"This workspace has reached its internal guest limit"},overGeneralGuestLimit:{id:"inviteTargetToken.overGeneralGuestLimit.tooltip",defaultMessage:"This workspace has reached its guest limit"},disabledByAdmins:{id:"inviteTargetToken.disabledByAdmins.tooltip",defaultMessage:"Inviting users has been disabled by admins for this page"},notAuthorizedDomain:{id:"inviteTargetToken.notAuthorizedDomain.tooltip",defaultMessage:"{email} does not belong to an allowed email domain"}});function _o(e){const{inviteTarget:t,defaultAddability:n,onClickRemove:i}=e,r=function(e,t){if("group"===e.type)return"gray";if("invalidUser"===e.type)return"red";if("existingUser"!==e.type&&"newUser"!==e.type)return(0,F().t1)(e);if(void 0===t)return"red";if("member"===t.type)return"autojoin_domain"===t.reason||"guests_disabled"===t.reason?"green":"over_internal_guest_limit"===t.reason?"yellow":(0,F().t1)(t.reason);if("member_request"===t.type)return"yellow";if("member_page_add"===t.type)return"gray";if("guest"===t.type)return"yellow";if("guest_request"===t.type)return"yellow";if("guest_page_add"===t.type)return"yellow";if("none"===t.type){if("must_upgrade"===t.reason)return"yellow";if("over_internal_guest_limit"===t.reason)return"red";if("over_general_guest_limit"===t.reason)return"red";if("disabled_by_admins"===t.reason)return"red";if("not_authorized_domain"===t.reason)return"red";if("invalid_email"===t.reason)return"red";if("other"===t.reason)return"red";(0,F().t1)(t.reason)}else(0,F().t1)(t)}(t,n),l=(0,s().YB)(),d=Zo(r),c=(0,o.useCallback)((()=>{i(t)}),[t,i]),u=(0,a().VK)((()=>(0,L().wZ)()),[]),m=function(e){const{inviteTarget:t,defaultAddability:n,intl:o,isRedesignEnabled:i}=e,a=Te(t),r=t.type;if("group"===r)return;if("invalidUser"===r)return o.formatMessage(Io.invalidUser,{text:t.value.text});if(!a)return;if("existingUser"!==r&&"newUser"!==r)return(0,F().t1)(r);if(void 0===n)return;if("none"===n.type){if("must_upgrade"===n.reason)return;if("other"===n.reason)return;if("over_internal_guest_limit"===n.reason)return o.formatMessage(Io.overInternalGuestLimit);if("over_general_guest_limit"===n.reason)return o.formatMessage(Io.overInternalGuestLimit);if("disabled_by_admins"===n.reason)return o.formatMessage(Io.disabledByAdmins);if("not_authorized_domain"===n.reason)return o.formatMessage(Io.notAuthorizedDomain,{email:a});if("invalid_email"===n.reason)return o.formatMessage(Io.invalidUser,{text:"unknown"});(0,F().t1)(n.reason)}if("member"===n.type)return"autojoin_domain"===n.reason?o.formatMessage(Io.autojoinMember,{email:a,domain:(0,me().Gd)(a)}):"guests_disabled"===n.reason?o.formatMessage(Io.guestsDisabledMember,{email:a}):"over_internal_guest_limit"===n.reason?a:(0,F().t1)(n.reason);if("member_request"===n.type)return a;if("member_page_add"===n.type)return a;if("guest"===n.type)return i?o.formatMessage(Io.guestV2,{email:a}):o.formatMessage(Io.guest,{email:a});if("guest_request"===n.type)return o.formatMessage(Io.guestRequest);if("guest_page_add"===n.type)return i?o.formatMessage(Io.guestV2,{email:a}):o.formatMessage(Io.guest,{email:a});(0,F().t1)(n)}({inviteTarget:t,defaultAddability:n,intl:l,isRedesignEnabled:u});return(0,T.jsx)(At().Z,{placement:Ft().Placement.Top,renderTooltip:()=>m,disableTooltip:!m,render:e=>(0,T.jsx)("div",{style:{maxWidth:"100%"},...e,children:(0,T.jsxs)(Y().jX,{gap:2,style:d.token,borderRadius:u?4:3,padding:"2px 4px",width:"hug",children:[(0,T.jsxs)(Y().jX,{align:"center-left",borderRadius:3,direction:"row",gap:4,width:"hug",children:[(0,T.jsx)(Po,{inviteTarget:t,tokenColor:r}),(0,T.jsx)($().q,{colorName:Ao(r),styleName:"UIRegular-14px/Regular",customStyles:d.label,children:Do(t,l)}),(0,T.jsx)(an().Z,{hoveredStyle:d.removeButtonHovered,pressedStyle:d.removeButtonPressed,onClick:c,children:(0,T.jsx)(Le().y,{iconGroup:To().U,colorName:"secondary",variantName:"mini"})})]}),(0,T.jsx)(we,{featureGateId:"guest_limit_debug_ui",whenEnabled:(0,T.jsx)("div",{style:{marginLeft:24,paddingBottom:2},children:(0,T.jsx)($().q,{colorName:"secondary",styleName:"UISmall-12px/Medium",children:null==n?void 0:n.type})}),whenDisabled:null})]})})})}function Po(e){const{inviteTarget:t,tokenColor:n}=e,o=Zo(n);switch(n){case"green":return(0,T.jsx)(Le().y,{iconGroup:Co().F,colorName:"greenPrimary",variantName:"default"});case"yellow":return(0,T.jsx)(Le().y,{iconGroup:ko().U,colorName:"yellowPrimary",variantName:"default"});case"red":return(0,T.jsx)(Le().y,{iconGroup:jo().x,colorName:"uiRedPrimary",variantName:"default"});case"gray":return"existingUser"===t.type?(0,T.jsx)(Y().jX,{align:"center",width:20,height:20,children:(0,T.jsx)(ee().Z,{userValue:t.value,size:16})}):(0,T.jsx)("div",{style:o.iconCircle,children:(0,z().O)(o.icon)});default:(0,F().t1)(n)}}function Zo(e){return(0,r().yK)((t=>({token:Ro(e,t),iconCircle:{alignItems:"center",backgroundColor:t.white,borderRadius:"50%",display:"flex",height:16,justifyContent:"center",width:16},icon:{color:t.icon.secondary,height:12,width:12},label:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},removeButtonHovered:{background:"transparent",opacity:.8},removeButtonPressed:{background:"transparent",opacity:.6}})),[e])}function Ao(e){switch(e){case"green":return"greenPrimary";case"yellow":return"yellowPrimary";case"red":return"uiRedPrimary";case"gray":return"grayPrimary";default:(0,F().t1)(e)}}function Ro(e,t){return{background:Bo(e,t),border:Lo(e,t)}}function Bo(e,t){switch(e){case"green":return t.fill.greenPrimary;case"yellow":return t.fill.yellowSecondary;case"red":return t.tint.uiRed;case"gray":return t.legacyDefaultSelectColor;default:(0,F().t1)(e)}}function Lo(e,t){switch(e){case"red":return`1px dashed ${t.stroke.uiRedPrimary}`;case"green":case"yellow":case"gray":return;default:(0,F().t1)(e)}}function Do(e,t){const{type:n}=e;switch(n){case"newUser":return e.value.email.trim();case"invalidUser":return e.value.text.trim();case"existingUser":return G().kk5.fromValue(q().KJ,e.value).getDisplayName(t);case"group":return(0,Xt().kF)({intl:t,groupName:e.value.name});default:(0,F().t1)(n)}}function Vo(e){const{addabilities:t,disabled:n,metadata:s,focus:l,onFocus:d,onInputChanged:c,onSubmit:u,placeholder:m,right:p,showEmptyError:g,setAutoFocusInput:f}=e,h=(0,i().O7)(),v=(0,i().Fy)(),y=function(e){const{focus:t,disabled:n,tokens:o}=e,i=(0,a().VK)((()=>(0,L().wZ)()),[]);return(0,r().yK)((e=>({tokenSpan:{maxWidth:"100%"},inputRightItemStyle:i?{alignSelf:"flex-start"}:{},tokenInputMenuItem:{paddingTop:o.length>0||i?4:6,paddingLeft:4,paddingRight:4,paddingBottom:4,borderRadius:i?6:4,minHeight:32,...t&&!i&&{background:"none"},...n&&{background:e.inputBackground,color:e.mediumTextColor,fill:on().ZP.white,opacity:.4},...i&&{alignItems:"center"}},inputAndTokenWrapRight:{gap:2},tokenInputMenuItemInput:{paddingTop:0},warningMessage:{color:"#DE5550"}})),[o.length,i,t,n])}({focus:l,disabled:n,tokens:[]}),b=(0,a().qz)(e.inviteTargetsStore,se().ZP),x=(0,a().VK)((()=>b.state.inviteTargets),[b]),S=(0,a().VK)((()=>b.state.tokenQuery),[b]),M=(0,a().VK)((()=>(0,L().wZ)()),[]),{inputFieldText:w}=(0,a().VK)((()=>({inputFieldText:b.state.tokenQuery.trim()})),[b]),C=(0,o.useCallback)((e=>{So().P({inviteTargetsStore:b,targetToRemove:e})}),[b]);return x?(0,T.jsx)(Mo().ZP,{focus:l,focusAfterAnimation:!0,onClick:()=>{v.isMobile||null==d||d()},format:Mo().UR.Share,value:S,onChange:e=>{if(M&&0===w.length){const e=V().default.state;V().default.setState({...e,tab:V().XF.Share,display:V().wV.Invite,focus:V().Sw.Search,source:e.display===V().wV.Invite?e.source:V().T5.Notion,emailMessage:e.display===V().wV.Invite?e.emailMessage:""}),null==f||f(!1)}So().j({environment:h,event:e,inviteTargetsStore:b,inviteOrigin:s.inviteOrigin,flowId:s.inviteFlowId,onInputChanged:c})},type:"email",tokens:x.map(((e,n)=>(0,T.jsx)(_o,{inviteTarget:e,onClickRemove:C,defaultAddability:Oo(e,t)},n))),disabled:n,autoComplete:"off",placeholder:m,onRemoveLastToken:()=>{b.setState({...b.state,inviteTargets:b.state.inviteTargets.slice(0,-1)})},right:p,rightWrapStyle:y.inputRightItemStyle,showBorder:!0,inputStyle:y.tokenInputMenuItemInput,inputAndTokenWrapRightStyle:y.inputAndTokenWrapRight,style:y.tokenInputMenuItem,onSubmit:u,inputFullWidth:!0,message:(0,T.jsx)(wo().z,{invalidInvites:(0,xo().oA)(x.map((e=>"invalidUser"===e.type?e:void 0))),showEmptyError:g,styles:y.warningMessage})}):null}function Oo(e,t){const n=Te(e);if(n)return null==t?void 0:t[n]}var Uo=()=>n(356380);function No(e){const{onClick:t,featureAvailability:n}=e;return(0,T.jsx)(At().Z,{disableTooltip:!1,renderTooltip:()=>(0,T.jsx)(Uo().e,{featureAvailability:n}),render:e=>(0,T.jsx)(Hn().Z,{isLarge:!0,style:{marginLeft:8},onClick:t,...e,children:(0,T.jsx)(s()._H,{id:"shareMenu.inviteButton.upgrade",defaultMessage:"Upgrade"})})})}const Fo=1e3;function Ho(e){const{blockStore:t,contextualInviteStore:n,defaultAddabilities:l,internalDomains:d,inviteTargetsStore:c,invites:u,metadata:m,spaceRole:p,spaceStore:g,spaceUserStore:f,sudoModeStore:h}=e,v=(0,i().O7)(),y=(0,s().YB)(),b=(0,r().yK)((()=>({permissionsRoleSelectButton:{display:"flex",whiteSpace:"nowrap",height:20,margin:2,borderRadius:4,color:on().ZP.uiGray}})),[]),[x,S]=(0,o.useState)("editor"),[M,w]=(0,o.useState)(!1),C=(0,a().VK)((()=>(0,L().wZ)()),[]),{source:j,focus:k,emailMessage:I,display:_}=(0,a().VK)((()=>{const{display:e}=V().default.state;return e===V().wV.Invite?V().default.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),P=(0,a().VK)((()=>t.getType()),[t]),{inviteTargets:Z,inputFieldText:A}=(0,a().VK)((()=>({inviteTargets:(0,ye().B)({inviteTargetsStore:c,includeInputFieldText:!0}),inputFieldText:c.state.tokenQuery.trim()})),[c]),R=async()=>{if(!M&&l&&d)if(0===Z.length&&C){const e=V().default.state;V().default.setState({...e,tab:V().XF.Share,display:V().wV.Invite,focus:V().Sw.Search,source:e.display===V().wV.Invite?e.source:V().T5.Notion,emailMessage:e.display===V().wV.Invite?e.emailMessage:""})}else{w(!0);try{const e={blockRole:x,blockStore:t,spaceRole:p,spaceStore:g};await yo({contextualInviteStore:n,defaultAddabilities:l,destination:e,environment:v,internalDomains:d,intl:y,invites:u,inviteTargetsStore:c,metadata:m,spaceStore:g,spaceUserStore:f,sudoModeStore:h})}finally{w(!1)}}},B=(0,Ze().I2)(u.map((e=>e.invitee)).filter(F().$K)),D=(0,a().VK)((()=>f.getUserId()),[f]),U=(0,Ce().oo)({name:"guests",spaceId:g.id,userId:D,amount:B}),N=(0,a().VK)((()=>t.canEditMembership()),[t]),H=(0,Vn().cR)(t),K=(0,Vn().xb)(t),E=Object.values(l??{}).some((e=>"none"===e.type)),W=I.length>Fo,z=M||!N||H||K,[G,q]=(0,o.useState)(!z);return(0,T.jsx)(At().Z,{disableTooltip:N&&!H&&!K,placement:Ft().Placement.Left,renderTooltip:()=>N?H?(0,T.jsx)(s()._H,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.pageInTrash",defaultMessage:"Restore page from trash to add people"}):K?(0,T.jsx)(s()._H,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.hasAIEdits",defaultMessage:"Resolve pending edits to add people"}):void 0:C?(0,T.jsx)(s()._H,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.needFullAccessRedesign",defaultMessage:"Request full access to share with others"}):(0,T.jsx)(s()._H,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.needFullAccess",defaultMessage:"Only those with full access can add people"}),render:e=>(0,T.jsxs)("div",{style:{display:"flex"},...e,children:[(0,T.jsx)(Vo,{inviteTargetsStore:c,metadata:m,focus:k===V().Sw.Search||C&&_===V().wV.MainShareMenu&&G,setAutoFocusInput:q,addabilities:l,disabled:z,onFocus:()=>{V().default.setState({...V().default.state,tab:V().XF.Share,display:V().wV.Invite,focus:V().Sw.Search,source:j||V().T5.Notion,emailMessage:I||""}),O().yE(v,{source:j||V().T5.Notion})},onSubmit:()=>{A.length>0||R()},placeholder:y.formatMessage({id:"shareMenu.inviteTargetsInput.placeholder.exp",defaultMessage:"Email or group, separated by commas"}),right:C&&A.length>0&&V().default.getState().display===V().wV.Invite||Z.length>0?(0,T.jsx)(Dn().ZP,{disabled:!N||H||K,role:x,table:"block",type:"user_permission",blockType:P,isInvite:!0,upgradeButtonName:"invite_permission_block",buttonStyle:b.permissionsRoleSelectButton,isMenuItem:!1,onChange:e=>S(e)}):void 0}),U&&(0,Ce().V5)(U,{available:()=>(0,T.jsx)(bo,{tooltip:I.length>Fo?(0,T.jsx)(s()._H,{id:"shareMenu.inviteButton.emailOverMaxLength.tooltip",defaultMessage:"Message exceeds the limit of 1000 characters."}):void 0,disabled:!N||H||K||E||W,onClick:R}),unavailable:e=>(0,T.jsx)(No,{featureAvailability:e,onClick:()=>{V().default.setState({...V().default.state,tab:V().XF.Share,display:V().wV.Invite,focus:void 0,source:j||V().T5.Notion,emailMessage:I||""}),jt().Vu({environment:v,upgradeButtonName:"user_permission_item"})}})})]})})}var Ko=()=>n(837341);const Eo=function(e){const{store:t}=e,{isMobile:o}=(0,i().Fy)(),l=(0,a().VK)((()=>t.canEditMembership()),[t]),d=(0,a().VK)((()=>(0,L().wZ)()),[]),c=(0,Vn().cR)(t),u=(0,Vn().xb)(t),m=(0,r().yK)((e=>({buttonContainer:{display:"flex",alignItems:"center",gap:at().p_},inputButton:{flex:1,justifyContent:"flex-start",height:30,overflow:"hidden",...d?{background:e.tint.regular,borderRadius:10,color:e.text.tertiary,boxShadow:"none",height:o?36:30}:{}},inputContent:{display:"flex",alignItems:"center",fontSize:16,fontWeight:400,...S().Yu},iconContainer:{fill:e.icon.secondary,marginRight:8},blueButton:{minWidth:at().UF}})),[o,d]);return(0,T.jsx)(At().Z,{renderTooltip:()=>u?(0,T.jsx)(s()._H,{id:"inviteUserButton.tooltip.resolveAIEditsMessage",defaultMessage:"Resolve pending edits to add people"}):(0,T.jsx)(s()._H,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."}),disableTooltip:l&&!c&&!u,render:t=>(0,T.jsxs)("div",{style:m.buttonContainer,...t,children:[(0,T.jsx)(n(576978).Z,{onClick:e.onClick,disabled:!l||c||u,style:m.inputButton,children:(0,T.jsx)("div",{style:m.inputContent,children:o&&d?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{style:m.iconContainer,children:(0,n(899548).R)({height:16,width:16})}),(0,T.jsx)(s()._H,{defaultMessage:"Invite people, emails, groups...",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots.mobile"})]}):(0,T.jsx)(s()._H,{defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots"})})}),!o&&(0,T.jsx)(Hn().Z,{isLarge:!0,onClick:e.onClick,disabled:!l||c||u,style:m.blueButton,children:(0,T.jsx)(s()._H,{id:"inviteUserButton.invitePersonLabel",defaultMessage:"Invite"})})]})})};function Wo(e){const{store:t,permissionItemArgs:n}=e,{onUpgradeButtonClick:l}=n,d=(0,i().O7)(),c=(0,i().MO)(),u=(0,a().qz)(void 0,R().Z),m=(0,a().VK)((()=>u.state.permissionsInviteStore),[u]),p=(0,a().VK)((()=>u.stage),[u]),g=(0,a().VK)((()=>m.state.modalOpen),[m]),f=(0,a().VK)((()=>(0,L().wZ)()),[]),h=(0,a().VK)((()=>t.canAdmin()),[t]),v=(0,a().VK)((()=>{const e=le().subscriptionDataStoreInstance.state;return Boolean(e&&Wt().YK(e))}),[]),y=(0,a().VK)((()=>(0,D().pR)({store:t})),[t]),b=(0,r().yK)((e=>({button:{display:"flex",alignItems:"center",minHeight:f?0:52,marginBottom:f?16:void 0},buttonInner:{width:"100%"},modalButton:{height:36},requestedUsersToast:{marginBottom:96}})),[f]),x=(0,o.useCallback)(((e,t)=>{e&&t>0&&no().oV({label:(0,T.jsx)(s()._H,{id:"mobileInviteSection.onInviteComplete.toastMessage.requestedUsers",defaultMessage:"Sent request to invite {numRequests, plural, one {a guest} other {{numRequests} guests}}",values:{numRequests:t}}),style:c?b.requestedUsersToast:void 0})}),[c,b.requestedUsersToast]);return p!==A().TG.closed||c&&!h?null:(0,T.jsx)(an().Z,{mobileFeedback:!0,disabled:!0,style:b.button,children:(0,T.jsxs)("div",{style:b.buttonInner,children:[g&&(0,T.jsx)(Ko().r,{store:t,disabled:!h,membersOnly:y,isSubscribed:v,onUpgradeButtonClick:l,upgradeButtonName:"invite_permission_block",shouldGrow:!0,buttonStyle:b.modalButton,permissionsInviteStore:m,onInviteComplete:x,analyticsFrom:"mobile_invite"}),(0,T.jsx)(Eo,{store:t,onClick:()=>(0,Ot().z5)({environment:d,permissionsInviteStore:m,store:t,isSubscribed:v,renderInShareModal:!1})})]})})}var zo=()=>n(489434);function Go(e){const{spaceName:t,domainUrl:n}=e,o=(0,s().YB)();return(0,T.jsx)(zo().j,{tint:"gray",iconGroup:Nn().G,label:o.formatMessage(qo.label,{spaceName:t}),description:o.formatMessage(qo.description,{domain:n}),display:"inline"})}const qo=(0,s().vU)({label:{id:"shareMenu.overLimitBanner.label",defaultMessage:"{spaceName} is over the guest limit"},description:{id:"shareMenu.overLimitBanner.description",defaultMessage:"If you share this page to a ‘@{domain}‘ email, the invite will be sent to your workspace owners as a request to add them as a member with full access to the workspace."}});var Yo=()=>n(499110),$o=()=>n(467806),Jo=()=>n(98774),Qo=()=>n(387454),Xo=()=>n(729775),ei=()=>n(718959),ti=()=>n(383694),ni=()=>n(447475);const oi=(0,s().vU)({fullAccess:{id:"permissionsLevelBanner.fullAccess.label",defaultMessage:"You have full access to this page {hasAttribution, select, true {via {attribution}} other {}}"},editor:{id:"permissionsLevelBanner.editor.label",defaultMessage:"You have edit access to this page {hasAttribution, select, true {via {attribution}} other {}}"},contentEditor:{id:"permissionsLevelBanner.contentEditor.label",defaultMessage:"You have edit access to content on this page {hasAttribution, select, true {via {attribution}} other {}}"},commenter:{id:"permissionsLevelBanner.commenter.label",defaultMessage:"You have comment access to this page {hasAttribution, select, true {via {attribution}} other {}}"},reader:{id:"permissionsLevelBanner.reader.label",defaultMessage:"You have view access to this page {hasAttribution, select, true {via {attribution}} other {}}"}});function ii(e){let{store:t}=e;const n=(0,i().O7)(),l=(0,a().VK)((()=>(0,ei().B7)(n)),[n]),d=(0,a().VK)((()=>t.canEditContentOnly()),[t]),{role:c,attribution:u}=(0,a().VK)((()=>{if(!l)return{role:"none",attribution:null};const e=(0,Vt().Dt)({userId:l.id,store:t}),o=function(e){let{environment:t,calculatedPermission:n,store:o}=e;const i=(0,be().Pj)(o)||nt().default.state.currentSpaceStore;if(!i)return null;if((0,bt().hV)(n)){const e=(0,N().TC)({groupId:n.group_id}),t=null==e?void 0:e.name;return t?(0,T.jsxs)(T.Fragment,{children:[(0,Qo().x)({width:18,marginRight:5}),t]}):null}if((0,bt().fG)(n)){var a;const e=n.team_id||(null===(a=(0,be().VP)(o))||void 0===a?void 0:a.id);if(!e)return null;const t=Kt().zX.createChildStore(i,{table:Mt().e0,id:e,spaceId:i.id});return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(ti().p,{disabled:!0,store:t,size:18,style:{marginRight:5}}),(0,T.jsx)(ni().q,{navigableParentStore:t,showUnderline:!0,maxLength:30})]})}if((0,bt().Ir)(n))return(0,bt().tx)(n)?(0,T.jsx)(s()._H,{defaultMessage:"the link",id:"permissionsLevelBanner.spacePermission.attribution"}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(ti().p,{disabled:!0,store:i,size:18,style:{marginRight:5}}),(0,N().rn)(t,i)]});if((0,bt().$D)(n))return(0,T.jsx)(Xo().Z,{underline:!0,inline:!0,onClick:()=>{V().default.setState({...V().default.state,display:V().wV.Publish,tab:V().XF.Publish})},children:(0,T.jsx)(s()._H,{defaultMessage:"the published site",id:"permissionsLevelBanner.publicPermission.attribution"})});return null}({environment:n,calculatedPermission:e,store:t});return{role:e.role,attribution:o}}),[l,t,n]),{userId:m,spaceId:g}=(0,a().VK)((()=>({userId:t.userId,spaceId:t.getSpaceId()})),[t]),f=(0,Ce().VX)({name:"block_read_and_write_role",spaceId:g,userId:m}),h=(0,a().VK)((()=>!!c&&(f&&!(0,bt().J5)(c))),[c,f]);(0,o.useEffect)((()=>{c&&Ct().hY(n,{share_menu_session_id:V().default.state.sessionId,role:c})}),[]);const v=(0,r().yK)((e=>({container:{background:e.surface.wash,border:1,borderStyle:"solid",borderColor:e.accentColors.gray[75],borderRadius:4,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingTop:10,paddingBottom:10,paddingLeft:12,paddingRight:12,display:"flex",alignItems:"center",justifyContent:"space-between"},bannerBodyContainer:{display:"flex",alignItems:"center"},icon:{marginRight:8},bannerLabel:{fontSize:12,display:"flex",flexDirection:h?"column":"row"},attribution:{display:"inline-flex",alignItems:"center",fill:e.regularIconColor,marginLeft:h?0:5},requestAccessContainer:{fontSize:12,flexShrink:0},pendingAccessRequestButton:{color:e.lightTextColor},accessRequestButton:{color:e.blueColor,padding:5,borderRadius:4}})),[h]),[y,b]=(0,o.useState)(!1),[x,S]=(0,o.useState)(!1),M=(0,o.useCallback)((async()=>{var e;if("reader"!==c&&"comment_only"!==c)return;const o=await We().callApi({eventName:"requestAccess",environment:n,data:{type:"current-actor-to-block",block:{id:t.id,spaceId:t.getSpaceId()},attributes:{origin_type:"share_menu",add_permissions_on_approval:!1,role:"read_and_write",existing_permissions:c},message:void 0}});"success"===o.type&&o.data.request?(b(!0),Ct().dU(n,{request_access_type:"page",previous_access_level:c,requested_access_level:"read_and_write",requestId:o.data.requestId})):"failed"===o.type&&"UserRateLimitResponse"===(null===(e=o.body)||void 0===e?void 0:e.name)&&S(!0)}),[n,c,t]);if(!(0,bt().iC)(c))return null;const w=function(e){switch(e){case"editor":return oi.fullAccess;case"read_and_write":return oi.editor;case"content_only_editor":return oi.contentEditor;case"comment_only":return oi.commenter;case"reader":return oi.reader;case"none":case"membership_admin":return null;default:(0,F().t1)(e)}}(c);return w?(0,T.jsx)(At().Z,{delayThreshold:0,renderTooltip:()=>(0,T.jsx)(s()._H,{defaultMessage:"Content editors can edit pages, but cannot change view and database settings.",id:"database.viewSettings.mainTab.contentOnlyEditorPill.subtitle"}),disableTooltip:!d,textWrap:!0,style:{maxWidth:180},render:e=>(0,T.jsxs)("div",{style:v.container,...e,children:[(0,T.jsxs)("div",{style:v.bannerBodyContainer,children:[(0,T.jsx)(ee().Z,{userStore:l,size:20,style:v.icon}),(0,T.jsx)(p().Z,{style:v.bannerLabel,isMultiline:!0,children:(0,T.jsx)(s()._H,{...w,values:{hasAttribution:Boolean(u),attribution:(0,T.jsx)("span",{style:v.attribution,children:u})}})})]}),h&&(0,T.jsx)("div",{style:v.requestAccessContainer,children:(0,T.jsx)(an().Z,{style:y||x?v.pendingAccessRequestButton:v.accessRequestButton,onClick:M,disabled:y||x,children:y?(0,T.jsx)(s()._H,{defaultMessage:"Edit access requested",id:"permissionsLevelBanner.requestPermission.accessRequested"}):x?(0,T.jsx)(s()._H,{defaultMessage:"Try again later",id:"permissionsLevelBanner.requestPermission.rateLimited"}):(0,T.jsx)(s()._H,{defaultMessage:"Request edit access",id:"permissionsLevelBanner.requestPermission.requestEdit"})})})]}),placement:Ft().Placement.Left}):null}var ai=()=>n(899018),ri=()=>n(17571),si=()=>n(564735);function li(e){const{store:t,permissionItemArgs:n}=e,{showTeamPermission:o,showSpacePermission:i,mostPermissiveAncestorTeamOwnerItem:a,mostPermissiveAncestorTeamMemberItem:r,mostPermissiveAncestorTeamGuestItem:s,mostPermissiveTrustedDomainItem:l,mostPermissiveSpaceItem:d,pagePermissionUIModel:c,mostPermissivePublicItem:u,showSitePublicPermission:m,showTrustedDomainPermission:p,showRestrictedPermissionBanner:g}=e.calculatedPermissions,f=Number(o)+Number(i)+Number(m);return(0,T.jsxs)(T.Fragment,{children:[m&&u&&(0,T.jsx)(ri().W,{store:t,publicPermissionItem:u,permissionItemArgs:n}),o&&a&&r&&(0,T.jsx)(si().Z,{store:t,blockTeamOwnerPermission:a,blockTeamMemberPermission:r,blockTeamGuestPermission:s,permissionItemArgs:n}),i&&(0,T.jsx)(mn().Z,{store:t,spacePermission:d,publicPermission:u,trustedDomainPermission:l,showTrustedDomainPermission:p,permissionItemArgs:n,fromPermissionWrapper:"permission_list",isRestricted:g}),(0,T.jsx)(di,{store:t,pagePermissions:c,numberPermissionsAlreadyRendered:f,permissionItemArgs:n})]})}function di(e){const t=(0,s().YB)(),n=(0,a().VK)((()=>{const e=nt().default.state.currentSpaceStore;return null!=e&&e.isDefined()?e.id:""}),[]),{store:o,pagePermissions:i,numberPermissionsAlreadyRendered:r,permissionItemArgs:l,showHeader:d}=e,{showUserPermissions:c,mostPermissiveGroupPermissions:u,mostPermissiveTeamPermissions:m,mostPermissiveUserPermissions:p}=i,g=(0,a().VK)((()=>(0,Lt().v)()),[]),f=(0,a().VK)((()=>{const e=c?function(e){const{mostPermissiveUserPermissions:t,spaceVisibleUserMap:n}=e,o={};return t.forEach((t=>{o[t.permissionItem.user_id]=(0,T.jsx)(qt().Z,{store:e.store,userPermission:t,showInherited:!1,permissionItemArgs:e.permissionItemArgs,spaceVisibleUserMap:n,fromPermissionWrapper:"permission_list"},t.permissionItem.user_id)})),o}({store:o,mostPermissiveUserPermissions:p,permissionItemArgs:l,spaceVisibleUserMap:g}):[];return xo().oA(Object.keys(e).map((n=>{const i=Kt().U6.createChildStore(o,{table:q().KJ,id:n}),a=i.getModel();if(!i.isReady()||a)return{title:(0,Yo().Nz)(t,a),permissionItem:e[n]}})))}),[c,p,l,o,t,g]),h=function(e){const{store:t,mostPermissiveTeamPermissions:n,permissionItemArgs:o}=e;return n.map((e=>bt().LW(e.permissionItem)?(0,T.jsx)(fn().Z,{store:t,blockTeamOwnerPermission:e,isExternalTeam:!0,permissionItemArgs:o,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.owner`):bt().bm(e.permissionItem)?(0,T.jsx)(pn().Z,{store:t,blockTeamGuestPermission:e,isExternalTeam:!0,permissionItemArgs:o,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.teamGuest`):(0,T.jsx)(gn().Z,{store:t,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:o,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.member`)))}({store:o,mostPermissiveTeamPermissions:m,permissionItemArgs:l}),v=(0,a().VK)((()=>{const e=n?function(e){const{spaceId:t,mostPermissiveGroupPermissions:n}=e,o={},i=new Set($o().Z.state.permissionGroupsAndMemberCounts.map((e=>e.group.group_id)));return n.forEach((n=>{const a=n.permissionItem.group_id;i.has(a)&&(o[a]=(0,T.jsx)(Gt().Z,{store:e.store,groupPermission:n,spaceId:t,showInherited:!1,permissionItemArgs:e.permissionItemArgs,fromPermissionWrapper:"permission_list"}))})),o}({store:o,spaceId:n,mostPermissiveGroupPermissions:u,permissionItemArgs:l}):{};return Object.entries(e).map((e=>{let[n,o]=e;const i=$o().Z.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===n));return{title:i?(0,Xt().kF)({intl:t,groupName:i.group.name}):"",permissionItem:o}}))}),[t,u,l,n,o]),y=[...f,...v];y.sort(((e,t)=>e.title.localeCompare(t.title)));const b=h.concat(y.map((e=>e.permissionItem))),x=b.length;if(0===x)return null;if(x>5-r){const e=Math.max(2-r,0);return(0,T.jsxs)(T.Fragment,{children:[d&&(0,T.jsx)(ai().GE,{}),b.slice(0,e),(0,T.jsx)(Jo().Z,{permissions:b.slice(e,-1)}),b[x-1]]})}return(0,T.jsxs)(T.Fragment,{children:[d&&(0,T.jsx)(ai().GE,{}),b]})}function ci(e,t){return e.from.table===xt().iU&&e.from.blockId===t.id}const ui=function(e){const t=(0,i().O7)(),{device:s}=t,{store:l,permissionItemArgs:d,calculatedPermissions:c}=e,{sudoModeStore:u}=d,{permissionItemsCount:m,pagePermissionUIModel:p,showRestrictedPermissionBanner:g}=c,f=(0,a().VK)((()=>{const e=nt().default.state.currentSpaceStore;if(!e)return!0;if(l.isTopLevelPrivatePage({spaceStore:e,environment:t}))return!0;const o=(0,be().uJ)(l);for(const i of o)if((0,n(852465).OY)(i)&&i.isTopLevelPrivatePage({spaceStore:e,environment:t}))return!0;return!1}),[l,t]);let h=null;const v=(0,a().VK)((()=>(0,D().up)({store:l,showRestrictedPermissionBanner:g})),[l,g]),{canAccessParent:y}=(0,a().VK)((()=>(0,D().HB)({store:l})),[l]),b={...c};if(!v&&y){const[e,t]=function(e,t){const{mostPermissiveGroupPermissions:n,mostPermissiveTeamPermissions:o,mostPermissiveUserPermissions:i}=t,[a,r]=xo().uK(n,(t=>ci(t,e))),[s,l]=xo().uK(o,(t=>ci(t,e))),[d,c]=xo().uK(i,(t=>ci(t,e))),u={...t,mostPermissiveGroupPermissions:r,mostPermissiveTeamPermissions:l,mostPermissiveUserPermissions:c},m={...t,mostPermissiveGroupPermissions:a,mostPermissiveTeamPermissions:s,mostPermissiveUserPermissions:d};return[u,m]}(l,p);b.pagePermissionUIModel=e,h=(0,T.jsx)(di,{store:l,pagePermissions:t,numberPermissionsAlreadyRendered:0,permissionItemArgs:d,showHeader:!0})}const x=(0,a().VK)((()=>!(0,D().gi)({store:l})),[l]),S=s.isMobile?et().Z.None:et().Z.Y,M=(0,r().yK)((e=>({scroller:{paddingBottom:10,minHeight:s.isMobile||0===m?void 0:1===m?60:90}})),[s,m]);return(0,o.useEffect)((()=>{Ct().oE({environment:t,calculatedPermissions:c})}),[]),(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(Ye().T,{style:M.scroller,type:S,children:[!f&&(0,T.jsx)(ii,{store:l}),(0,T.jsx)(n(417235).Z,{store:l,showRestrictedPermissionBanner:g,showPermissionInheritanceBanner:!1,sudoModeStore:u}),!v&&m>0&&(0,T.jsx)(ai().ZP,{store:l}),(0,T.jsx)(li,{store:l,calculatedPermissions:b,permissionItemArgs:d}),h,x&&(0,T.jsx)(n(995114).Z,{store:l})]}),!s.isMobile&&(0,T.jsx)(C().Z,{store:l,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:b,permissionItemArgs:d})]})};function mi(e){const{blockStore:t,contextualInviteStore:n,inviteTargetsStore:s,permissionItemArgs:l,spaceStore:d,spaceUserStore:c,subscriptionDataStore:u}=e,m=(0,i().Fy)(),p=m.isMobile,{spaceId:g,spaceName:f,userId:h,spaceModel:v}=(0,a().VK)((()=>({spaceId:d.getSpaceId(),spaceName:d.getName(),userId:c.getUserId(),spaceModel:d.getModel()})),[d,c]),y=(0,a().VK)((()=>(0,be().VP)(t)),[t]),[b,x]=(0,a().VK)((()=>[null==c?void 0:c.getModel(),null==y?void 0:y.getModel()]),[c,y]),S=(0,a().VK)((()=>V().default.state.display),[]),M=(0,a().VK)((()=>(0,L().wZ)()),[]),w=function(e,t){return(0,r().yK)((()=>({container:{position:"relative",height:"unset",transition:"all",transitionDuration:"0.3s",display:"flex",flexDirection:"column",maxHeight:t?530:540}})),[t])}(0,M),C=(0,a().qz)(void 0,Se().Z),k=(0,a().VK)((()=>n.state.flowId),[n]),I=function(e){const t=(0,i().Fy)();return(0,o.useCallback)((n=>{n.preventDefault(),t.isMobile||e!==V().wV.MainShareMenu||V().default.setState({...V().default.state,tab:V().XF.Share,display:V().wV.Invite,focus:V().Sw.Search,source:V().T5.Notion,emailMessage:""})}),[t,e])}(S),_=(0,_e().U)(u),P=(0,a().VK)((()=>(0,ye().B)({inviteTargetsStore:s,includeInputFieldText:!0}).map((e=>({inviteTarget:e,invitee:ke({currentMembersAndGuests:_,inviteTarget:e})}))).filter(F().$K)),[s,_]),Z=(0,je().AW)({space:d,spaceUser:c,team:y,invitees:P.map((e=>e.invitee)).filter(F().$K),blockStore:t}),A=(0,ve().U)(d),R=P.map((e=>e.invitee)).filter((e=>void 0!==e&&void 0===e.currentRole&&A&&(0,pe().is)(e.email,A))),B=(0,Ce().oo)({name:"internal_guests",spaceId:g,userId:h,amount:R.length}),D=(0,Ce().VX)({name:"non_admin_members",spaceId:g,userId:h})?"read_and_write":"editor",O=(0,he().IH)({spaceStore:d}),U=(0,a().VK)((()=>{const e=V().default.state,t=e.display===V().wV.Invite?e.emailMessage:"";return{inviteFlowId:n.state.flowId,inviteMessage:t,inviteOrigin:"share_menu",shareMenuSessionId:e.sessionId}}),[n]),N=(0,a().VK)((()=>Z?P.map((e=>{const{inviteTarget:t,invitee:n}=e,o=null==n?void 0:n.email;let i,a;return"group"===t.type?a={type:"group"}:o?(i=(0,pe().TC)(o,A??[]),a=Z[o]??{type:"none",reason:"other"}):a={type:"none",reason:"other"},{defaultAddability:a,internalDomain:i,invitee:n,inviteTarget:t}})):[]),[P,Z,A]),H=(0,ge().Kz)(B,(()=>{if(!f)return;if(O)return;const e=R[0];if(!e)return;const t=(0,me().Gd)(e.email);return t?(0,T.jsx)(Go,{spaceName:f,domainUrl:t}):void 0})),K=(0,xe().E)("share_menu_inheritance_banner");return(0,T.jsx)(fe().Z,{debugName:"ShareMenuShareTab",capture:!0,onTab:I,children:(0,T.jsxs)("div",{style:w.container,children:[(0,T.jsxs)(Y().jX,{direction:"column",gap:16,padding:M?p?`0 ${Ie().gr}px 0px ${Ie().gr}px`:`0 ${Ie().J4}px 8px ${Ie().J4}px`:"0 14px 8px 14px",children:[m.isMobile?(0,T.jsx)(Wo,{store:t,permissionItemArgs:l}):(0,T.jsx)(Ho,{blockStore:t,contextualInviteStore:n,defaultAddabilities:Z,internalDomains:A,invites:N,inviteTargetsStore:s,metadata:U,spaceRole:D,spaceStore:d,spaceUserStore:c,sudoModeStore:l.sudoModeStore}),H]}),S===V().wV.MainShareMenu&&!M&&(0,T.jsx)(ui,{store:t,calculatedPermissions:e.calculatedPermissions,buttonPopupStore:e.buttonPopupStore,permissionItemArgs:l}),S===V().wV.MainShareMenu&&M&&(0,T.jsx)(j().Z,{store:t,calculatedPermissions:e.calculatedPermissions,buttonPopupStore:e.buttonPopupStore,permissionItemArgs:l,showPermissionInheritanceBanner:K}),S===V().wV.Invite&&!m.isMobile&&(0,T.jsx)(Zn,{store:t,inviteTargetsStore:s,menuListStore:C,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs,flowId:k}),(0,T.jsx)(we,{featureGateId:"guest_limit_debug_ui",whenEnabled:(0,T.jsx)(Ue,{domains:A,spaceId:g,spaceModel:v,userId:h,spaceUserModel:b,teamModel:x,blockStore:t}),whenDisabled:null})]})})}const pi=function(e){const{store:t,sudoModeStore:o}=e,i=(0,a().VK)((()=>o.state.changePermissionsEnabled),[o]),l=(0,a().VK)((()=>o&&o.shouldUserHaveAccessToPrivatePageBlock()&&!o.doesUserAlreadyHaveEditorAccessOnBlock(t.id)&&o.state.privatePageStore),[o,t]),d=(0,r().yK)((e=>({container:{background:e.cardBackground,padding:"12px 18px",boxShadow:e.shadow2XS,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"baseline"},button:{fontWeight:S().Ue.medium,justifyContent:"center",marginTop:8,opacity:i?.5:1},icon:{width:16,height:16,marginRight:6,transition:"all 200ms ease",transform:i?"rotate(-90deg)":void 0}})),[i]);return l?(0,T.jsxs)("div",{style:d.container,children:[(0,T.jsx)(p().Z,{isMultiline:!0,children:(0,T.jsx)(s()._H,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessage",defaultMessage:"As a <b>workspace owner</b>, you can change the permissions of this page to add yourself or others. Any changes will appear in the audit log.",values:{b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,T.jsx)("b",{children:t})}}})}),(0,T.jsxs)(J().Z,{disabled:i,style:d.button,onClick:()=>{o.setState({...o.state,changePermissionsEnabled:!0})},children:[(0,n(567319).I)(d.icon),i?(0,T.jsx)(s()._H,{id:"blockPermissionsSettings.workspaceOwner.isChangingPermissionsMessageButton",defaultMessage:"Changing permissions"}):(0,T.jsx)(s()._H,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessageButton",defaultMessage:"Change permissions"})]})]}):null};function gi(e){const t=(0,a().VK)((()=>V().default.state.tab),[]);switch(t){case V().XF.Share:return(0,T.jsx)(mi,{...e,blockStore:e.store,subscriptionDataStore:le().subscriptionDataStoreInstance});case V().XF.Publish:return(0,T.jsx)(ue,{store:e.store,permissionItemArgs:e.permissionItemArgs,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem});default:(0,F().t1)(t)}}function fi(){const e=(0,i().Fy)(),t=(0,r().yK)((e=>({container:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",height:276},offlineMessageHeadline:{fontWeight:S().Ue.medium},iconStyle:{width:32,height:32,marginBottom:10,fill:e.icon.tertiary}})),[]);return(0,T.jsxs)("div",{style:t.container,children:[re(t.iconStyle),(0,T.jsx)("div",{style:t.offlineMessageHeadline,children:(0,T.jsx)(p().Z,{isMobile:e.isMobile,isSecondaryColor:!0,isMultiline:!0,children:(0,T.jsx)(s()._H,{defaultMessage:"You're offline",id:"blockPermissionsSettings.offline.headline"})})}),(0,T.jsx)(p().Z,{isMobile:e.isMobile,isSecondaryColor:!0,isMultiline:!0,children:(0,T.jsx)(s()._H,{defaultMessage:"Go online to share and publish",id:"blockPermissionsSettings.offline.prompt"})})]})}const hi=function(e){const{store:t,permissionItemArgs:o}=e,s=(0,i().Fy)(),l=(0,a().qz)(e.inviteTargetsStore,se().ZP),d=(0,r().yK)((()=>({container:{display:"flex",flexDirection:"column",height:"100%"}})),[]),c=(0,a().VK)((()=>n(804217).default.state.online),[]);return(0,T.jsxs)("div",{style:d.container,children:[o.sudoModeStore&&(0,T.jsx)(pi,{store:t,sudoModeStore:o.sudoModeStore}),!s.isMobile&&(0,T.jsx)(de().Tm,{inviteTargetsStore:l,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem}),c?(0,T.jsx)(gi,{inviteTargetsStore:l,...e}):(0,T.jsx)(fi,{})]})};function vi(e){const{store:t,sudoModeStore:n,onUpgradeButtonClick:l,location:d}=e,S=(0,i().O7)(),M=(0,i().Fy)();(0,y().XJ)(Z().Ug.publishSite),(0,y().XJ)(Z().Ug.publishedSiteSettings);const w=(0,a().qz)(e.universalMemberInviteStore,R().Z),j=(0,a().VK)((()=>w.state.contextualInviteStore),[w]),k=(0,B().u)(),_=(0,b().r)(),O=(0,x().r_)(),U=(0,a().VK)((()=>(0,L().wZ)()),[]),N=(0,a().VK)((()=>D().mk({store:t,environment:S,trustedDomainsStore:k})),[S,t,k]),F=(0,a().VK)((()=>j.state.inviteStage),[j]),H=(0,a().VK)((()=>V().default.state.tab),[]),K=(0,r().yK)((e=>({title:{fontSize:U?16:18},topbarStyle:{paddingTop:15,paddingBottom:15,height:"auto",background:U&&M.isMobile?e.surface.page:void 0},backChevronIcon:{fill:e.icon.primary}})),[M.isMobile,U]),E=(0,o.useMemo)((()=>({onUpgradeButtonClick:l,sudoModeStore:n,location:d})),[l,n,d]),W=(0,a().VK)((()=>(0,P().C)()),[]);if(!_)return W?(0,T.jsx)(I,{calculatedPermissions:N,store:t,permissionItemArgs:E,onClose:e.onClose}):null;if(!M.isMobile&&(F===A().TG.share_workspace||F===A().TG.request_workspace))return(0,T.jsx)(ie,{blockStore:t,spaceStore:_,contextualInviteStore:j});const z=M.isMobile?{menuType:h().o.Modal,disableHeaderShadow:!0,title:U?(0,T.jsx)(p().Z,{isMobile:M.isMobile,style:K.title,children:(0,T.jsx)(s()._H,{defaultMessage:"Share settings",id:"blockPermissionsSettings.mobileShareMenu.titleV2"})}):(0,T.jsx)(p().Z,{isMobile:M.isMobile,style:K.title,children:(0,T.jsx)(s()._H,{defaultMessage:"Share",id:"blockPermissionsSettings.mobileShareMenu.title"})}),additionalTopbarContent:(0,T.jsx)(de().zC,{mostPermissivePublicItem:N.mostPermissivePublicItem}),left:(0,T.jsx)(g().Z,{href:(0,v().UY)("guides.sharing"),analyticsFrom:"sharing"}),footer:H===V().XF.Share&&(0,T.jsx)(C().Z,{store:t,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:N,permissionItemArgs:E}),topbarStyle:K.topbarStyle,right:(0,T.jsx)(m().DoneMenuText,{}),onClickRight:e.onClose,whiteBackground:!0}:{menuType:h().o.Popup,maxHeight:"90vh"};return O?(0,T.jsx)(u().Z,{...z,className:f().B8p,children:(0,T.jsx)(c().Z,{debugName:"ShareMenuContainer",capture:!0,allowEsc:!0,children:(0,T.jsx)(yi,{store:t,spaceStore:_,spaceUserStore:O,permissionItemArgs:E,calculatedPermissions:N,buttonPopupStore:e.buttonPopupStore,inviteTargetsStore:e.inviteTargetsStore,contextualInviteStore:j})})}):null}function yi(e){let{store:t,spaceStore:n,spaceUserStore:a,permissionItemArgs:r,calculatedPermissions:s,buttonPopupStore:c,inviteTargetsStore:u,contextualInviteStore:m}=e;const p=(0,i().O7)();return(0,o.useEffect)((()=>{l().ZH({preventDismissMobileKeyboard:!0,environment:p}),d().clear({preventDismissMobileKeyboard:!0,environment:p})}),[p]),(0,T.jsx)(hi,{store:t,spaceStore:n,spaceUserStore:a,permissionItemArgs:r,calculatedPermissions:s,buttonPopupStore:c,inviteTargetsStore:u,contextualInviteStore:m})}},714022:(e,t,n)=>{n.d(t,{Tm:()=>Z,xE:()=>V,zC:()=>R});var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(846550),s=()=>n(714230),l=()=>n(647439),d=()=>n(573369),c=()=>n(617256),u=()=>n(205248),m=()=>n(956057),p=()=>n(201565),g=()=>n(788860),f=()=>n(696459),h=()=>n(707513),v=()=>n(152862),y=()=>n(643051),b=()=>n(1910),x=()=>n(67961),S=()=>n(539245),M=()=>n(247724),w=()=>n(641506),C=()=>n(314160),j=()=>n(998470),k=()=>n(836756),T=()=>n(779733),I=()=>n(681832),_=n(785893);const P=(0,g().vU)({seo:{defaultMessage:"Search engine indexing",id:"publishSiteSettings.SEO.title"},embed:{defaultMessage:"Embed this page",id:"embedSiteSettings.title"}});function Z(e){let{inviteTargetsStore:t,mostPermissivePublicItem:n}=e;const{display:o,source:i}=(0,a().VK)((()=>{const{display:e}=I().default.state;if(e===I().wV.Invite){const{source:t}=I().default.state;return{display:e,source:t}}return{display:e,source:void 0}}),[]);switch(o){case I().wV.MainShareMenu:case I().wV.Publish:return(0,_.jsx)(R,{mostPermissivePublicItem:n});case I().wV.Invite:if("notion"===i)return(0,_.jsx)(B,{inviteTargetsStore:t});if("slack"===i||"google"===i)return(0,_.jsx)(L,{source:i});throw(0,f().t1)(i);default:(0,f().t1)(o)}}const A=[I().XF.Share,I().XF.Publish];function R(e){let{mostPermissivePublicItem:t}=e;const n=(0,i().O7)(),s=o.useRef(null),{isMobile:l}=n.device,c=(0,a().VK)((()=>(0,p().L)(t.permissionItem)),[t.permissionItem]);(0,o.useEffect)((()=>{const e=I().default.state,t=e.tab===I().XF.Share&&e.display===I().wV.MainShareMenu?e.source:void 0;c&&t!==I().Xd.InviteBackButton&&(I().default.setState({tab:I().XF.Publish,display:I().wV.Publish,sessionId:m().Il(),isInitialized:!0}),(0,C().Jh)(n,{source:"share_button"}))}),[n,c]);const u=(0,a().VK)((()=>I().default.state.tab),[]),f=(0,a().VK)((()=>(0,T().wZ)()),[]),y=(0,r().yK)((e=>({tabStyle:{color:e.lightTextColor,...l&&{width:"50%",textAlign:"center"}},selectedTabStyle:f?{}:{fontWeight:h().Ue.medium},tabTitleStyle:{color:"inherit",...f&&{fontSize:(0,w().yv)(n,"UIRegular"),fontWeight:h().Ue.medium}},style:l?{marginBottom:8,justifyContent:"space-between"}:{marginBottom:f?16:14,paddingLeft:f?16:8},tabBorderStyle:f?{left:0,right:0}:{}})),[n,l,f]),b=(0,r().yK)((e=>({tabStyle:{width:"50%",textAlign:"center",borderRadius:10,color:e.text.secondary,fontWeight:h().Ue.regular,paddingTop:2,paddingBottom:2},tabBorderStyle:{borderBottom:"none"},selectedTabStyle:{borderRadius:8,background:"dark"===e.mode?e.tint.regular:e.surface.elevated},tabTitleStyle:{color:"inherit",fontSize:(0,w().yv)(n,"UIRegular"),fontWeight:h().Ue.regular},selectedTabTitleStyle:{fontWeight:h().Ue.medium},style:{justifyContent:"space-between",padding:2,background:e.tint.regular,borderRadius:10,marginBottom:0,height:34}})),[n]),x=(0,r().yK)((e=>({publishTabContainer:{display:"flex",alignItems:"center"},publishIcon:{height:16,width:16,marginLeft:4,opacity:u===I().XF.Publish?1:.5},tabBarContainer:{paddingLeft:20,paddingRight:20,paddingTop:8,paddingBottom:16,backgroundColor:e.surface.page}})),[u]),P=(0,o.useCallback)((e=>{const t=A[e];t!==u&&(v().Y(n,{tab:t}),t===I().XF.Share&&I().default.setState({...I().default.state,display:I().wV.MainShareMenu,tab:I().XF.Share,source:I().Xd.ShareTab}),t===I().XF.Publish&&I().default.setState({...I().default.state,display:I().wV.Publish,tab:I().XF.Publish}))}),[u,n]),Z=[(0,_.jsx)(o.Fragment,{children:l&&!f?(0,_.jsx)(g()._H,{defaultMessage:"Permissions",id:"shareMenu.permissionsTab.title"},"permissions"):(0,_.jsx)(g()._H,{defaultMessage:"Share",id:"shareMenu.shareTab.title"},"share")},"title"),(0,_.jsxs)("div",{ref:s,style:x.publishTabContainer,className:M().UBk,children:[(0,_.jsx)(g()._H,{defaultMessage:"Publish",id:"shareMenu.publishTab.title"},"publish"),c&&(0,d().v)(x.publishIcon)]},"publishTab")],R=(0,a().VK)((()=>k().Z.state.siteSettingContentType),[]);return"seo"===R?(0,_.jsx)(O,{}):"embed"===R?(0,_.jsx)(U,{handleBackButtonClick:()=>{j().pn("initial")}}):l&&f?(0,_.jsx)("div",{style:x.tabBarContainer,children:(0,_.jsx)(S().ZP,{...b,tabs:Z,selectedIndex:A.indexOf(u),onChange:P,hideTabBorder:!0})}):(0,_.jsx)(S().ZP,{...y,tabs:Z,selectedIndex:A.indexOf(u),onChange:P})}function B(e){let{inviteTargetsStore:t}=e;const n=(0,a().VK)((()=>(0,T().wZ)()),[]),i=(0,r().yK)((e=>({container:n?{display:"flex",paddingLeft:12,paddingRight:12,marginBottom:16,height:40,boxShadow:`inset 0 -1px 0 ${e.regularDividerColor}`}:{display:"flex",margin:"0 12px 6px",height:48}})),[n]),s=(0,o.useCallback)((()=>{t.reset(),I().default.setState({...I().default.state,display:I().wV.MainShareMenu,tab:I().XF.Share,source:I().Xd.InviteBackButton})}),[t]);return(0,_.jsx)("div",{style:i.container,children:(0,_.jsx)(V,{onClick:s,titleMessage:n?(0,_.jsx)(g()._H,{id:"shareMenu.sendInvite.labelV2",defaultMessage:"Invite"}):(0,_.jsx)(g()._H,{id:"shareMenu.sendInvite.label",defaultMessage:"Send invite"})})})}function L(e){const{source:t}=e,n=(0,g().YB)(),i=(0,r().yK)((()=>({container:{display:"flex",justifyContent:"space-between",margin:"0 12px",height:48,alignItems:"center"},titleLabel:{display:"flex",fontSize:12,alignItems:"center",fontWeight:h().Ue.semibold}})),[]),a=(0,o.useCallback)((()=>{I().default.setState({...I().default.state,tab:I().XF.Share,display:I().wV.Invite,source:I().T5.Notion,focus:I().Sw.Search,emailMessage:""})}),[]);return(0,_.jsxs)("div",{style:i.container,children:[(0,_.jsx)(x().Z,{style:i.titleLabel,children:(0,_.jsx)(g()._H,{id:"shareMenu.addFromSlack.label",defaultMessage:"Add people from {integrationNameWithLogo}",values:{integrationNameWithLogo:(0,_.jsx)(D,{source:t})}})}),(0,_.jsx)(b().Z,{ariaLabel:n.formatMessage({id:"shareMenuHeader.goBackToInviteFromNotionMenu.iconButton",defaultMessage:"Close external integration and go back to the main invite flow."}),icon:u().D,style:{borderRadius:"100%"},onClick:a})]})}function D(e){let{source:t}=e;const n=(0,r().yK)((()=>({imageStyle:{marginLeft:4,marginRight:4}})),[]);return t===I().T5.Slack?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(y().Z,{type:"image_url",imageURL:s().Z.images.externalIntegrations.slackIconPng,size:18,imageStyle:n.imageStyle}),(0,_.jsx)(g()._H,{defaultMessage:"Slack",id:"shareMenu.slackIntegrationName.label"})]}):t===I().T5.Google?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(y().Z,{type:"image_url",imageURL:s().Z.images.externalIntegrations.googleGIconPng,size:18,imageStyle:n.imageStyle}),(0,_.jsx)(g()._H,{defaultMessage:"Google",id:"shareMenu.googleContactsIntegrationName.label"})]}):void(0,f().t1)(t)}function V(e){const{onClick:t,titleMessage:n}=e,o=(0,i().O7)(),s=(0,a().VK)((()=>(0,T().wZ)()),[]),d=(0,g().YB)(),u=(0,r().yK)((()=>({topContainer:{display:"flex",alignItems:"center",width:"max-content"},backButtonPressedStyle:{backgroundColor:"transparent"},iconButton:{marginRight:6,height:24,width:24},arrowIcon:{...s?{height:20,width:20}:{height:16,width:16},strokeWidth:h().Ue.semibold},sendInviteLabel:{fontWeight:h().Ue.medium,...s&&{fontSize:(0,w().yv)(o,"UIRegular")}}})),[o,s]);return(0,_.jsxs)("div",{style:u.topContainer,children:[(0,_.jsx)(b().Z,{icon:s?c().k:l().W,iconStyle:u.arrowIcon,style:u.iconButton,onClick:t,ariaLabel:d.formatMessage({id:"shareMenu.backButton.iconButton",defaultMessage:"Go back to main share menu."})}),(0,_.jsx)(x().Z,{style:u.sendInviteLabel,children:n})]})}function O(){const e=(0,r().yK)((e=>({container:{display:"flex",padding:"0 12px 0 8px",height:40,borderBottom:`1px solid ${e.stroke.secondary}`}})),[]),t=(0,o.useCallback)((()=>{j().pn("initial")}),[]);return(0,_.jsx)("div",{style:e.container,children:(0,_.jsx)(V,{onClick:t,titleMessage:(0,_.jsx)(g()._H,{...P.seo})})})}function U(e){const t=(0,r().yK)((e=>({container:{display:"flex",padding:"0 12px 0 8px",height:40,borderBottom:`1px solid ${e.stroke.secondary}`}})),[]);return(0,_.jsx)("div",{style:t.container,children:(0,_.jsx)(V,{onClick:e.handleBackButtonClick,titleMessage:(0,_.jsx)(g()._H,{...P.embed})})})}},616728:(e,t,n)=>{n.r(t),n.d(t,{AuthSyncListener:()=>y});n(267602),n(653476);var o=n(667294),i=()=>n(219727),a=()=>n(142735);const r="initial_handshake";var s=()=>n(989478),l=()=>n(788860),d=()=>n(513670),c=()=>n(839002),u=()=>n(342792),m=()=>n(205228),p=()=>n(826955),g=()=>n(704259),f=()=>n(385875),h=n(785893);const v=1;function y(){const e=(0,i().O7)(),t=(0,l().YB)(),n=`${m().default.identity.domainBaseUrl}/authSync`,y=e.currentUser.isLoggedIn(),[b,x]=(0,o.useState)(null),[S,M]=(0,o.useState)({value:!1,count:0}),w=(0,a().VK)((()=>g().default.getTotalUnreadMentionsCount()),[]),C=(0,a().VK)((()=>f().Z.getAllSpaceViewStores(e)),[e]);(0,o.useEffect)((()=>{const e=t=>{const n=m().default.identity.domainBaseUrl;t.origin===n&&t.ports&&t.ports[0]&&(x(t.ports[0]),window.removeEventListener("message",e))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}),[]),(0,o.useEffect)((()=>{y&&(S.value||0===S.count||null==b||b.postMessage({version:v,name:"unreadCount",source:"notion",unreadCount:w}))}),[y,S.count,S.value,b,w]);const j=(0,o.useCallback)((async()=>{const e=d().mN(C,"userId"),n=await(0,c().qd)(e,10,(async e=>{if(!e.userId)return;const n=p().U6.createChildStore(e,{table:s().KJ,id:e.userId});await n.load();const o=n.getEmail()??"",i=n.getDisplayName(t)??"";return{id:e.userId,displayName:i,emailAddress:o}}));null==b||b.postMessage({version:v,name:"accountSwitcher",source:"notion",accounts:n.filter((e=>void 0!==e)),persistCookie:!0})}),[t,b,C]);(0,o.useEffect)((()=>{y&&b&&(S.value||0===S.count)&&j()}),[y,j,S.count,S.value,b]),(0,o.useEffect)((()=>{e.currentUser.id&&(0,u().e)(e.currentUser.id)&&(null==b||b.postMessage({version:v,name:"setNotionUserID",source:"notion",notionUserID:e.currentUser.id,type:"mutation"}))}),[e.currentUser.id,b]),(0,o.useEffect)((()=>{y||null==b||b.postMessage({version:v,name:"setNotionUserID",source:"notion",notionUserID:"",type:"mutation"})}),[y,b]);const k=(0,o.useCallback)((e=>{if(e.data.version!==v)return;const{source:t}=e.data;if("notion"!==t&&"mailLoaded"===e.data.name)M((e=>({value:!0,count:e.count+1})))}),[]);return(0,o.useEffect)((()=>(x((e=>(e&&(e.onmessage=k),e))),()=>{x((e=>(e&&(e.onmessage=null),e)))})),[k,b]),(0,h.jsx)("iframe",{src:n,style:{display:"none"},onLoad:e=>function(e){const t=e.currentTarget;setTimeout((()=>{var e;null===(e=t.contentWindow)||void 0===e||e.postMessage(r,m().default.identity.domainBaseUrl)}),50)}(e),title:"Notion Identity"})}},711112:(e,t,n)=>{n.d(t,{f:()=>a});var o=()=>n(142735),i=()=>n(906591);function a(){return(0,o().VK)((()=>(0,i().B8)()),[])}},314160:(e,t,n)=>{n.d(t,{Jh:()=>i,Mo:()=>r,O$:()=>l,_F:()=>a,aC:()=>s,mm:()=>d});var o=()=>n(594546);function i(e,t){(0,o().j)({environment:e,event:{eventName:"open_publish_modal",eventProperties:t}})}function a(e,t){(0,o().j)({environment:e,event:{eventName:"change_domain",eventProperties:t}})}function r(e,t){(0,o().j)({environment:e,event:{eventName:"update_seo_settings",eventProperties:t}})}function s(e,t){(0,o().j)({environment:e,event:{eventName:"site_set_link_expiration",eventProperties:t}})}function l(e,t){(0,o().j)({environment:e,event:{eventName:"page_unpublish",eventProperties:t}})}function d(e,t){(0,o().j)({environment:e,event:{eventName:"page_publish",eventProperties:t}})}},998470:(e,t,n)=>{n.d(t,{AB:()=>Z,Au:()=>H,C$:()=>z,DR:()=>I,Fo:()=>j,H2:()=>U,Hl:()=>F,KD:()=>G,Q6:()=>_,QP:()=>L,YU:()=>B,Y_:()=>R,c7:()=>O,cy:()=>Y,dM:()=>T,dU:()=>P,f$:()=>D,gx:()=>K,pn:()=>A,t:()=>V,wt:()=>q,xz:()=>E,y_:()=>N,yr:()=>W});n(821057),n(670560),n(267602),n(653476),n(241792),n(667294);var o=()=>n(396136),i=()=>n(81954),a=()=>n(928833),r=()=>n(899133),s=()=>n(788860),l=()=>n(513670),d=()=>n(342792),c=()=>n(824462),u=()=>n(636340),m=()=>n(752127),p=()=>n(102182),g=()=>n(269299),f=()=>n(205228),h=()=>n(487270),v=()=>n(314169),y=()=>n(663132),b=()=>n(479875),x=()=>n(836756),S=()=>n(759160),M=()=>n(314160),w=()=>n(566245),C=n(785893);function j(e){const{environment:t,store:n,type:o,header:r,domainId:s}=e,l=n.getSiteStore();if(l)return l.id;let d=s;var c;d||(d=null===(c=y().VA(n.getSpaceStore()))||void 0===c?void 0:c.id);const m=(0,h().$x)({environment:t,table:a().Gs,spaceId:(0,i().J)(n.getSpaceId())});g().createAndCommit({userAction:"publishSite.create",environment:t,canUndo:!0,perform:e=>{const i=u().Ue({environment:t,table:m.table,args:{id:m.id,type:o,spaceId:m.spaceId,blockId:n.id,domainId:d,currentUserId:t.currentUser.id,header:r??{}},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:e});return u().sW({store:n.getFormatStore(),data:{site_id:i.id},transaction:e}),i.id}})}function k(e){const{environment:t,siteRootBlockStore:n,domainId:o}=e;let i=n.getSiteStore();if(i||(j({environment:t,type:"site",store:n,domainId:o}),i=n.getSiteStore()),i)return i}function T(e){const{environment:t,domainId:n,resetWatermark:o}=e,i=k(e);i&&i.isDefined()&&(g().createAndCommit({userAction:"publishSite.updatePublicDomain",environment:t,canUndo:!0,perform:e=>{i.getDomainId()!==n&&g().applyOperation({transaction:e,store:i,operation:i.getModel().ops.updatePublicDomainId({domainId:n,currentUserId:t.currentUser.id})})}}),g().createAndCommit({userAction:"publishSite.resetWatermark",environment:t,canUndo:!0,perform:e=>{if(o){const n=i.getHeader();g().applyOperation({transaction:e,store:i,operation:i.getModel().ops.updateHeader({header:{...n,hideWatermark:!1},currentUserId:t.currentUser.id})})}}}),p().oV({label:(0,C.jsx)(s()._H,{id:"publishSiteSettings.publicDomain.confirmation",defaultMessage:"Successfully updated domain for all pages within this site"})}))}function I(e){const{environment:t,siteRootBlockStore:n,isSearchEngineIndexingEnabled:o}=e,a=k(e);if(!a)return;"form"!==a.getType()&&g().createAndCommit({userAction:"publishSite.updateSeoEnabled",environment:t,canUndo:!0,perform:e=>{a&&a.isDefined()&&o!==a.isSearchEngineIndexingEnabled()&&(g().applyOperation({transaction:e,store:a,operation:a.getModel().ops.updateIsSearchEngineIndexingEnabled({isSearchEngineIndexingEnabled:o,currentUserId:t.currentUser.id})}),o&&e.postSubmitCallbacks.push((async e=>{e||await c().callApi({eventName:"enqueueScanContentTask",environment:t,data:{pagePointer:{id:n.id,table:"block",spaceId:(0,i().J)(n.pointer.spaceId)}}})})))}})}function _(e){const{environment:t,store:n,seoTitle:o,seoDescription:i}=e;g().createAndCommit({userAction:"publishSite.create",environment:t,canUndo:!0,perform:e=>{const a=n.getFormat().seo_title,r=n.getFormat().seo_description;a===o&&r===i||(u().sW({store:n.getFormatStore(),data:{seo_title:o,seo_description:i},transaction:e}),(0,M().Mo)(t,{target_block_id:n.id,new_title:o??null,new_description:i??null}),p().oV({label:(0,C.jsx)(s()._H,{id:"siteSettingsEditor.publishSeoChanges.confirmation",defaultMessage:"Successfully updated the SEO settings"})}))}})}function P(e){S().Z.setState({...S().Z.state,settingOpen:e})}function Z(){S().Z.setState({...S().Z.state,settingOpen:"initial"})}function A(e){x().Z.setState({...x().Z.state,siteSettingContentType:e})}function R(e){var t,n,o;const{siteRootBlockStore:i,permissionItem:a,from:r,sudoModeStore:s}=e,l=i.getSiteStore(),d=null==l?void 0:l.getHeader(),c=(null==d||null===(t=d.customItems)||void 0===t?void 0:t.map((e=>e.blockId)))||[];S().Z.setState({settingOpen:"initial",permissionItem:a,from:r,sudoModeStore:s,faviconUrl:(null==l?void 0:l.getFaviconUrl())||null,previewImageUrl:(null==l?void 0:l.getPreviewImageUrl())||null,hideBreadcrumbs:null==d?void 0:d.hideBreadcrumbs,hideSearch:null==d?void 0:d.hideSearch,hideWatermark:null==d?void 0:d.hideWatermark,enableDuplicateAsTemplate:a.allow_duplicate,customHeaderBlockIds:c,googleAnalyticsId:null==l?void 0:l.getGoogleAnalyticsId(),theme:null==l||null===(n=l.getSettings())||void 0===n?void 0:n.theme,enableQna:null==l||null===(o=l.getSettings())||void 0===o?void 0:o.enableQna})}async function B(e){var t;const{environment:n,store:i,siteRootBlockStore:a}=e,r=k({environment:n,siteRootBlockStore:a}),u=null==r?void 0:r.getType();if(!r||"form"===u)return;const m=S().Z.getState();let f=!1;const h={};let b;m.enableQna&&(b=await async function(e){var t,n,o,i;const{environment:a,siteStore:r}=e,s=null===(t=r.getSettings())||void 0===t?void 0:t.siteUserId;if(s)return s;if(!((null===(n=r.getDomainStore())||void 0===n?void 0:n.getDomainName())??(null===(o=y().VA(r.getSpaceStore()))||void 0===o?void 0:o.domain_name)))throw new Error("no domain on site");const l=y().Co({spaceStore:r.getSpaceStore(),domainId:null===(i=r.getDomainStore())||void 0===i?void 0:i.id}).split(":")[0],u=`${(0,d().XR)(r.id)}@${l}`,m=await c().callApi({eventName:"createEmailUser",environment:a,data:{email:u}});if("failed"===m.type)throw new Error("failed to create qna user");return m.data.userId}({environment:n,siteStore:r})),g().createAndCommit({userAction:"publishSite.updateSiteSettingsInEditor",environment:n,canUndo:!0,perform:e=>{if(r&&r.isDefined()){var t,o;(r.getFaviconUrl()||null)!==m.faviconUrl&&(g().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updateFaviconUrl({faviconUrl:m.faviconUrl,currentUserId:n.currentUser.id})}),f=!0,h.favicon=m.faviconUrl);(r.getPreviewImageUrl()||null)!==m.previewImageUrl&&(g().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updatePreviewImageUrl({previewImageUrl:m.previewImageUrl,currentUserId:n.currentUser.id})}),f=!0,h.preview_image=m.previewImageUrl);const i=r.getHeader();let a=i;const s=function(e,t){const n=e.map((e=>({type:"block",blockId:e})));if(!t&&0===n.length)return;if(t&&(0,l().Xy)(n,t))return;return n}(m.customHeaderBlockIds,null==i?void 0:i.customItems);s&&(a={...a,customItems:s},h.custom_headers=s.map((e=>e.blockId))),(null==i?void 0:i.hideBreadcrumbs)!==m.hideBreadcrumbs&&(a={...a,hideBreadcrumbs:m.hideBreadcrumbs},h.hide_breadcrumbs=m.hideBreadcrumbs),(null==i?void 0:i.hideSearch)!==m.hideSearch&&(a={...a,hideSearch:m.hideSearch},h.hide_search=m.hideSearch),(null==i?void 0:i.hideWatermark)!==m.hideWatermark&&(a={...a,hideWatermark:m.hideWatermark},h.hide_watermark=m.hideWatermark),a&&i!==a&&(g().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updateHeader({header:a,currentUserId:n.currentUser.id})}),f=!0);r.getGoogleAnalyticsId()!==m.googleAnalyticsId&&(g().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updateGoogleAnalyticsId({googleAnalyticsId:m.googleAnalyticsId,currentUserId:n.currentUser.id})}),f=!0,h.google_analytics_id=m.googleAnalyticsId);(null===(t=r.getSettings())||void 0===t?void 0:t.theme)!==m.theme&&(g().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updateTheme({theme:m.theme,currentUserId:n.currentUser.id})}),f=!0,h.theme=m.theme);(null===(o=r.getSettings())||void 0===o?void 0:o.enableQna)!==m.enableQna&&(m.enableQna?b&&g().applyOperation({transaction:e,store:r,operation:{pointer:r.pointer,command:"update",path:["settings"],args:{enableQna:m.enableQna,siteUserId:b}}}):g().applyOperation({transaction:e,store:r,operation:{pointer:r.pointer,command:"update",path:["settings"],args:{enableQna:m.enableQna}}}),f=!0)}}});if((null===(t=m.permissionItem)||void 0===t?void 0:t.allow_duplicate)!==m.enableDuplicateAsTemplate&&m.permissionItem&&m.from){const e=m.from.table===o().iU?m.from.blockId:m.from.teamId;(0,v().iK)({oldPermissionItem:m.permissionItem,newPermissionItem:{...m.permissionItem,allow_duplicate:m.enableDuplicateAsTemplate},wasInherited:e!==i.id,environment:n,store:i,sudoModeStore:m.sudoModeStore,location:"published_site_settings"}),f=!0,h.enable_duplicate_as_template=m.enableDuplicateAsTemplate}f&&((0,w().u6)(n,{settings_changed:h}),p().oV({label:(0,C.jsx)(s()._H,{id:"siteSettingsEditor.publishChanges.confirmation",defaultMessage:"Changes published"})}))}function L(e){S().Z.setState({...S().Z.state,faviconUrl:e})}function D(e){S().Z.setState({...S().Z.state,previewImageUrl:e})}function V(e){S().Z.setState({...S().Z.state,hideBreadcrumbs:e})}function O(e){S().Z.setState({...S().Z.state,hideSearch:e})}function U(e){S().Z.setState({...S().Z.state,hideWatermark:e})}function N(e){S().Z.setState({...S().Z.state,enableDuplicateAsTemplate:e})}function F(e){const t=S().Z.state.customHeaderBlockIds.concat([e]);S().Z.setState({...S().Z.state,customHeaderBlockIds:t})}function H(e){const t=S().Z.state.customHeaderBlockIds.filter((t=>t!==e));S().Z.setState({...S().Z.state,customHeaderBlockIds:t})}function K(e){S().Z.setState({...S().Z.state,googleAnalyticsId:e})}function E(e){S().Z.setState({...S().Z.state,theme:e})}async function W(e){const{environment:t,spaceStore:n,query:o,siteRootBlockId:i}=e;if(!n)return;const a=await c().callApi({eventName:"searchPagesInSite",environment:t,data:{query:o,spaceId:n.id,filters:r().u4({isDeletedOnly:!1,navigableBlockContentOnly:!0,excludeTemplates:!0,editedBy:[],ancestors:[i],inTeams:[]}),sort:{field:"relevance"},limit:10}});return"failed"!==a.type?a.data:void 0}async function z(e){const{environment:t,blockStore:n,slug:o}=e,i=await c().callApi({eventName:"updatePublicPageSlug",environment:t,data:{spaceId:n.getSpaceId(),blockId:n.id,slug:o,clientVersion:f().default.version}});if("success"!==i.type)return{error:i};p().oV({label:(0,C.jsx)(s()._H,{id:"customSlugInput.updateSuccess.toast",defaultMessage:"Successfully updated URL for this page"})})}function G(e){S().Z.setState({...S().Z.state,enableQna:e})}function q(e){const{environment:t,store:n,pageVisitSource:o}=e,i=b().$({store:n,pageVisitSource:o});m().D({environment:t,url:i})}function Y(e){const{environment:t,siteStore:n,embedSettings:o}=e;g().createAndCommit({userAction:"embedSite.updateEmbedSettings",environment:t,canUndo:!0,perform:e=>{u().sW({store:n.getSettingsStore(),data:{embedSettings:o},transaction:e})}})}},566245:(e,t,n)=>{n.d(t,{Cx:()=>r,g2:()=>i,u6:()=>a});var o=()=>n(594546);function i(e,t){(0,o().j)({environment:e,event:{eventName:"open_customize_site",eventProperties:t}})}function a(e,t){(0,o().j)({environment:e,event:{eventName:"update_site_customization_settings",eventProperties:t}})}function r(e){(0,o().j)({environment:e,event:{eventName:"close_customize_site",eventProperties:{}}})}},834758:(e,t,n)=>{n.d(t,{D7:()=>a,Ug:()=>i,vk:()=>r});var o=()=>n(677559);const i={publishSite:new(o().Ss)("PublishSite",(async()=>await Promise.all([n.e(39938),n.e(79289),n.e(18216),n.e(23006),n.e(63061)]).then(n.bind(n,760396)))),publishedSiteSettings:new(o().Ss)("PublishedSiteSettings",(async()=>await Promise.all([n.e(62743),n.e(52774),n.e(39938),n.e(37358),n.e(7312),n.e(31189),n.e(69343),n.e(2933),n.e(7678),n.e(52435),n.e(75066),n.e(37317),n.e(79289),n.e(41589),n.e(18216),n.e(23006),n.e(83837),n.e(78421)]).then(n.bind(n,367846))))},a=(0,o().kF)(i.publishedSiteSettings,(e=>e.default)),r=(0,o().kF)(i.publishSite,(e=>e.default))},759160:(e,t,n)=>{n.d(t,{Z:()=>i});class o extends(()=>n(263184))().default{getInitialState(){return{settingOpen:"initial",permissionItem:void 0,from:void 0,sudoModeStore:void 0,location:"",faviconUrl:null,previewImageUrl:null,hideBreadcrumbs:!1,hideSearch:!1,hideWatermark:!1,enableDuplicateAsTemplate:!1,customHeaderBlockIds:[],googleAnalyticsId:void 0,theme:void 0,enableQna:!1}}}const i=new o},880885:(e,t,n)=>{n.d(t,{H:()=>o});const o=n(263184).default.createValue(!1,{name:"AiPageTranslationCalloutStore"})},583352:(e,t,n)=>{n.d(t,{Z:()=>a});var o=()=>n(632314);class i extends(()=>n(263184))().default{getInitialState(){return{automationActionStore:void 0,automationStore:void 0,contextType:void 0,typecheckResult:void 0}}blur(e){void 0!==this.state.automationStore&&(void 0===e||(0,o().Z)(this.state,e))&&this.setState({automationActionStore:void 0,automationStore:void 0,contextType:void 0,typecheckResult:void 0})}focus(e){(0,o().Z)(this.instanceState,e)||this.setState(e)}}const a=new i;(0,n(947115).exposeDebugValue)("AutomationFocusStore",i)},771097:(e,t,n)=>{n.d(t,{CachedTypedDatabasesStore:()=>o,a:()=>i});const o=n(263184).default.createValue(void 0,{name:"CachedTypedDatabasesStore"});function i(e){const t=o.state;t&&o.setState({...t,typedDatabases:[...t.typedDatabases,e]})}},516623:(e,t,n)=>{n.d(t,{default:()=>i});class o extends(()=>n(263184))().default{getInitialState(){return{active:!1,stringValue:""}}}const i=new o},953624:(e,t,n)=>{n.d(t,{Z:()=>i});class o extends(()=>n(263184))().default{getInitialState(){return{open:!1}}}const i=new o},825137:(e,t,n)=>{n.d(t,{Z:()=>i});class o extends(()=>n(263184))().default{getInitialState(){return{open:!1}}}const i=new o},886970:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(561280).Z)},452002:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(529048).Z)},175928:(e,t,n)=>{n.d(t,{k:()=>i});class o extends(()=>n(263184))().default{getInitialState(){return{isOpen:!1}}}const i=new o},201023:(e,t,n)=>{n.d(t,{default:()=>i});class o extends(()=>n(263184))().default{getInitialState(){return{open:!1}}}const i=new o},737244:(e,t,n)=>{n.d(t,{Z:()=>i});class o extends(()=>n(263184))().default{getInitialState(){return{open:!1}}}const i=new o},136765:(e,t,n)=>{n.d(t,{Z:()=>i});class o extends(()=>n(263184))().default{getInitialState(){return{permissionsInviteStore:new(n(223023).Z),contextualInviteStore:new(n(807463).ZP)}}get stage(){return this.state.contextualInviteStore.state.inviteStage}}const i=o},969243:(e,t,n)=>{n.d(t,{r:()=>i});var o=()=>n(143346);const i=new(n(168469).q)((e=>{let{userId:t,spaceId:n}=e;return`${t}-${n}`}),(async function(e,t){var i;let{userId:a,spaceId:r}=t;const[s,l]=await Promise.all([o().bG({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:{table:n(989478).KJ,id:a},userId:a}),o().bG({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:(0,n(243225).v8)({userId:a,spaceId:r}),userId:a})]),d=null===(i=n(876822).default.state.currentSpaceViewStore)||void 0===i||null===(i=i.getModel())||void 0===i?void 0:i.first_joined_space_time,c=null==s?void 0:s.value,u=null==l?void 0:l.value;if(c&&u&&d)return{id:c.id,space_id:u.id,membership_type:u.membership_type,email:c.email,name:c.name,profile_photo:c.profile_photo,onboarding_completed:c.onboarding_completed,first_joined_space_time:d}}));n(947115).exposeDebugValue("UserOnSpaceStore",i)},570065:(e,t,n)=>{n.d(t,{E:()=>o});const o=n(263184).default.createValue({showConvertTooltip:!1,forceShow:!1},{name:"WikiPromoStore"})},768064:(e,t,n)=>{n.d(t,{W_:()=>y,km:()=>S,l_:()=>b,nf:()=>x,yA:()=>C,zW:()=>w});n(267602),n(653476),n(241792);var o=()=>n(875120),i=()=>n(629719),a=()=>n(948505),r=()=>n(681941),s=()=>n(513670),l=()=>n(696459),d=()=>n(824462),c=()=>n(205228),u=()=>n(876822),m=()=>n(145613),p=()=>n(18281),g=()=>n(547526),f=()=>n(46135),h=()=>n(419157),v=()=>n(897257);async function y(e){var t;let{environment:n,billingData:a,billingInterval:s,vatId:c,addOn:g,onlyShowAddOn:f}=e;const y=m().Z.state,b=v().subscriptionDataStoreInstance.state;if(!y.open||!b)return;const x=(null==a?void 0:a.address)??y.temporaryAddress;if(!(0,o().A)(x))return;m().Z.update((e=>({...e,calculatingTax:!0})));const S=s??y.temporaryBillingInterval??"year",w=g??y.addOnFeature,C=f??y.onlyShowAddOn,j=null===(t=u().default.state.currentSpaceStore)||void 0===t?void 0:t.id;if(!j)return;const k=await(0,p().DI)(n,j,b),{planAmount:T,promoInfo:I,accountBalance:_}=(0,p().uN)({memberCount:k,promo:y.appliedPromo,currencyCode:h().Z.selectedCurrencyCode,data:b,addOnFeature:w,onlyShowAddOn:C,subscriptionTier:y.subscriptionTier,taxAmount:y.taxAmount,calculatingTax:y.calculatingTax,billingInterval:S,coupon:y.coupon}),P=Math.max(0,T-I.amount+_),Z=[y.subscriptionTier,y.addOnFeature].map((e=>{switch(e){case void 0:return;case"ai":case"sites_custom_hostnames":return e;default:return(0,r().KE)(e)}})).map((e=>{const t=h().Z.getPrice(n,(t=>t.product===e&&t.billingInterval===s));return null==t?void 0:t.result})).map(M).filter(l().$K),A=await d().callApi({eventName:"calculateTax",environment:n,data:{address:x,lineItems:Z,price:P,vatId:c??y.vatApplicable?y.temporaryVatCode:void 0,customerId:(0,i().KU)(a)}});if("failed"===A.type)m().Z.update((e=>({...e,taxAmount:void 0,calculatingTax:!1})));else{const e=A.data;e.valid?m().Z.update((t=>({...t,taxAmount:e.taxAmount,calculatingTax:!1,taxCalculationError:void 0}))):m().Z.update((t=>({...t,taxAmount:void 0,calculatingTax:!1,taxCalculationError:e.error})))}}async function b(e,t){var n;const r=f().default.state,s=v().subscriptionDataStoreInstance.state;if(!r.open||!s)return;const l=r.temporaryAddress;if(!(0,o().A)(l))return;f().default.update((e=>({...e,calculatingTax:!0})));const c=(null===(n=r.totalUpgradeCost)||void 0===n?void 0:n.amount)||0,u=await d().callApi({eventName:"calculateTax",environment:e,data:{address:l,price:c,vatId:r.vatApplicable?r.temporaryVatCode:void 0,customerId:(0,i().KU)(t)}});if("failed"===u.type)f().default.update((e=>({...e,taxAmount:void 0,calculatingTax:!1})));else{const e=u.data;e.valid?f().default.update((t=>({...t,taxAmount:a().n.fromValue({amount:e.taxAmount,currencyCode:h().Z.selectedCurrencyCode}),calculatingTax:!1,taxCalculationError:void 0}))):f().default.update((t=>({...t,taxAmount:void 0,calculatingTax:!1,taxCalculationError:e.error})))}}async function x(e){const{environment:t,priceForTaxCalculation:n,address:o,customerId:i,vatId:a}=e,r=g().default.state,s=await d().callApi({eventName:"calculateTax",environment:t,data:{address:o,customerId:i,vatId:a,price:n}});if("failed"===s.type);else{const e=s.data;e.valid&&r.open&&g().default.update((t=>({...t,tax:Math.max(0,e.taxAmount)})))}}async function S(e){const{environment:t,billingData:n,stripeData:a,taxableAmount:r,lineItems:s}=e,{address:l}=null!=n&&n.address?{address:null==n?void 0:n.address}:e,c=null==a?void 0:a.vatId;if(!l||!(0,o().A)(l))return;const u=(0,i().KU)(n),m=await d().callApi({eventName:"calculateTax",environment:t,data:{address:l,price:r.amount,vatId:c,customerId:u,lineItems:s}});if("failed"===m.type)return;const p=m.data;return p.valid?p.taxAmount:void 0}function M(e){if(!e)return;if(void 0===e.unitAmount)return;const t=c().default.pricing[e.product];return"productId"in t?{amount:e.unitAmount.amount,productId:t.productId}:void 0}function w(e){const t=c().default.pricing[e.price.product];if("productId"in t)return{amount:e.price.unitAmount.amount*e.quantity,productId:t.productId}}function C(e){let{line:t,defaultProductId:n=c().default.pricing.plus.productId}=e;const o=(0,s().Cn)(t.discount_amounts??[],"amount"),i=t.price?"string"==typeof(a=t.price.product)?a:a.id:n;var a;return{amount:t.amount-o,productId:i}}},662479:(e,t,n)=>{n.r(t),n.d(t,{AddOnUpgradeModal:()=>K,isCancellationStage:()=>re,isConfirmPurchaseStage:()=>ae,isLimitReachedStage:()=>ie});n(821057);var o=n(667294),i=()=>n(146947),a=()=>n(219727),r=()=>n(142735),s=()=>n(846550),l=()=>n(714230),d=()=>n(646574),c=()=>n(205248),u=()=>n(409873),m=()=>n(629719),p=()=>n(976102),g=()=>n(893146),f=()=>n(381348),h=()=>n(788860),v=()=>n(568017),y=()=>n(696459),b=()=>n(707513),x=()=>n(308186),S=()=>n(745740),M=()=>n(312578),w=()=>n(906651),C=()=>n(840820),j=()=>n(765513),k=()=>n(148126),T=()=>n(876822),I=()=>n(518019),_=()=>n(538992),P=()=>n(576387),Z=()=>n(768064),A=()=>n(965014),R=()=>n(178504),B=()=>n(971025),L=()=>n(18281),D=()=>n(661769),V=()=>n(30795),O=()=>n(547526),U=()=>n(419157),N=()=>n(897257),F=()=>n(702548),H=n(785893);function K(e){const{data:t}=e,n=(0,L().GJ)(t),o=oe(),i=(0,r().VK)((()=>T().default.state.currentSpaceStore),[]),s=(0,D().pQ)({spaceId:null==i?void 0:i.id}),l=L().YK(t),d=(0,a().O7)(),{isOpen:u,addOnFeature:m}=(0,r().VK)((()=>{const{state:e}=O().default;return{isOpen:e.open,addOnFeature:e.addOnFeature}}),[]);return d.device.isMobileNative?(0,H.jsx)(C().Z,{innerStyle:o.innerStyle,isOpen:u,onDismiss:()=>_().v5(),render:()=>(0,H.jsx)("div",{style:o.mobileModal,children:(0,H.jsx)("div",{style:o.innerModalPadding,children:(0,H.jsx)(ne,{})})})}):(0,H.jsx)(C().Z,{innerStyle:o.innerStyle,isOpen:u,onDismiss:()=>_().v5(),render:()=>(0,H.jsx)("div",{style:ae()||ie()&&l&&n?o.largeModal:re()?o.cancellationModal:o.modal,children:(0,H.jsxs)("div",{style:re()?o.cancellationInnerModalPadding:o.innerModalPadding,children:[(0,H.jsx)(S().Z,{onClick:()=>{_().v5()},style:o.cancelButton,hoveredStyle:o.hovered,children:(0,c().D)(o.closeIcon)}),ie()&&m&&(0,H.jsx)(E,{addOnFeature:m,canPurchaseAddOn:n,isSubscribed:l}),ae()&&m&&(0,H.jsx)(W,{addOnFeature:m,canPurchaseAddOn:n}),re()&&m&&(0,H.jsx)(te,{addOnFeature:m,canPurchaseAddOn:n,data:t,billingData:s})]})})})}function E(e){const{addOnFeature:t,canPurchaseAddOn:n,isSubscribed:o}=e,i=oe(),r=(0,a().O7)();return n&&o?(0,H.jsx)(W,{addOnFeature:t,canPurchaseAddOn:n}):(0,H.jsxs)(H.Fragment,{children:[(0,u().D)(i.icon),(0,H.jsx)(G,{addOnFeature:t,canPurchaseAddOn:n}),(0,H.jsx)(q,{addOnFeature:t,canPurchaseAddOn:n}),(0,H.jsx)(w().Z,{isLarge:!0,style:i.button,onClick:async()=>n?o?_().Cl(void 0):async function(e,t){await A().y(e,{from:"plans_page",upsell:{type:"product",product:t,limit:{type:"none"}}}),_().v5()}(r,t):_().v5(),children:n?(0,H.jsx)(h()._H,{id:"addOnUpgradeModal.purchase.button.label",defaultMessage:"Purchase"}):(0,H.jsx)(h()._H,{id:"addOnUpgradeModal.gotIt.button.label",defaultMessage:"Got it"})})]})}function W(e){var t;const{addOnFeature:n,canPurchaseAddOn:o}=e,i=(0,a().O7)(),s=oe(),d=(0,r().Kw)(N().subscriptionDataStoreInstance),c=(0,r().VK)((()=>O().default.state.open?O().default.state.coupon:null),[]),u=(0,r().VK)((()=>T().default.state.currentSpaceStore),[]),p=(0,D().pQ)({spaceId:null==u?void 0:u.id});if(!u)return null;if(i.device.isMobileNative||(0,m().gy)(p))return null;let g;if(!d||"unsubscribed_admin"!==d.type&&"subscribed_admin"!==d.type||(g=d),(0,m().TK)(p)){const e=(0,H.jsx)(h()._H,{id:"addOnUpgradeModal.errorMessage.switchPlanFromInAppPurchase",defaultMessage:"You're currently subscribed through an in-app purchase with Apple. To switch plans, cancel your subscription with Apple first."});return x().UW(e),null}const f=(0,H.jsx)(h()._H,{id:"addOnUpgradeModal.errorMessage.notAdmin",defaultMessage:"You don't have permissions to upgrade this workspace to an add-on. If you think this is a mistake please contact your administrator."});if(!(0,L().GJ)(d))return x().UW(f),null;const v=null===(t=g)||void 0===t||null===(t=t.customerData)||void 0===t?void 0:t.stripe;if(!v)return null;const b=(0,m().Tz)(null==p?void 0:p.subscription)??"month",S=c?function(e){if("ai_fifty_percent"===e)return(0,H.jsx)(h()._H,{id:"addOnUpgradeModal.coupon.fiftyPercent.label",defaultMessage:"50% off discount"});(0,y().t1)(e)}(c):"year"===b?(0,H.jsx)(h()._H,{id:"addOnUpgradeModal.coupon.twentyPercent.label",defaultMessage:"20% off discount"}):null;return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)("img",{src:l().Z.images.pricing.aiLogoPng,style:s.aiLogo}),(0,H.jsx)(G,{addOnFeature:n,canPurchaseAddOn:o}),(0,H.jsx)(Y,{addOnFeature:n}),S?z(S):null,(0,H.jsx)($,{addOnFeature:n,interval:b,stripeData:v,spaceStore:u,billingData:p})]})}function z(e){const t=oe();return(0,H.jsx)(S().Z,{style:{...t.sharedStyleForDiscountBadge},disabled:!0,children:(0,H.jsx)("div",{style:{...t.innerStyleForDiscountBadge},children:e})})}function G(e){const{addOnFeature:t,canPurchaseAddOn:n}=e,o=oe();let i;switch(t){case"ai":i=n?(0,H.jsx)(h()._H,{id:"subscriptionUpgradeModal.ai.addOn.title",defaultMessage:"Upgrade to unlimited AI"}):(0,H.jsx)(h()._H,{id:"addOnUpgrade.title.nonAdmin",defaultMessage:"You've used up all free AI responses in your plan"});break;case"sites_custom_hostnames":throw new Error("not implemented");default:(0,y().t1)(t)}return(0,H.jsx)("h3",{style:o.title,children:i})}function q(e){const{addOnFeature:t,canPurchaseAddOn:n}=e;let o;const i=oe();switch(t){case"ai":o=n?(0,H.jsx)(h()._H,{id:"addOnUpgrade.description.admins",defaultMessage:"Your one-time promotion has ran out. To continue using AI features, purchase more AI uses for your workspace"}):(0,H.jsx)(h()._H,{id:"addOnUpgrade.description.nonAdmins",defaultMessage:"Your workspace’s one-time Notion AI promotion is over. Contact a workspace admin to purchase unlimited AI for your team to use."});break;case"sites_custom_hostnames":throw new Error("not implemented");default:(0,y().t1)(t)}return(0,H.jsx)("p",{style:i.paragraph,children:(0,H.jsx)("div",{style:i.text,children:o})})}function Y(e){const{addOnFeature:t}=e;let n;const o=oe();if(!(0,r().VK)((()=>T().default.state.currentSpaceStore),[]))return null;switch(t){case"ai":n=(0,H.jsx)(h()._H,{id:"addOnUpgrade.confirmation.description",defaultMessage:"Generate content, summarize key points, and find info across Notion and your connected apps"});break;case"sites_custom_hostnames":throw new Error("not implemented");default:(0,y().t1)(t)}return(0,H.jsx)("p",{style:o.paragraph,children:(0,H.jsx)("div",{style:o.text,children:n})})}function $(e){const{addOnFeature:t,interval:n,stripeData:i,spaceStore:s,billingData:l}=e,d=oe(),c=(0,a().O7)(),u=(0,r().Kw)(N().subscriptionDataStoreInstance),v=(0,V().V)(u),y=(0,m().YF)(null==l?void 0:l.subscription)??"USD",{tax:b,coupon:x}=(0,r().VK)((()=>({tax:O().default.state.open?O().default.state.tax:0,coupon:O().default.state.open?O().default.state.coupon:void 0})),[]),S=(0,r().VK)((()=>U().Z.getPrice(c,(e=>e.product===t&&e.billingInterval===n&&e.currencyCode===y))),[t,c,n,y]),C=(0,r().VK)((()=>U().Z.getPrice(c,(e=>e.product===t&&"month"===e.billingInterval&&e.currencyCode===y))),[t,y,c]);if((0,o.useEffect)((()=>{!async function(){const e=x?(0,f().Ef)((0,g().I8)(x)):void 0;if(S.result&&i&&null!=l&&l.address){const t=S.result.getCostPerBillingInterval({quantity:v,offer:e}).amount;await Z().nf({environment:c,priceForTaxCalculation:t,address:l.address,customerId:(0,m().KU)(l),vatId:i.vatId})}}()}),[c,i,S,v,x,l]),!S.isLoaded||!C.isLoaded)return(0,H.jsx)(M().Z,{});if(!S.result||!C.result)return null;const T=S.result,A=x?(0,f().Ef)((0,g().I8)(x)):void 0,B=T.getCostPerBillingInterval({quantity:v,offer:A}).withAddedAmount(b),L=C.result,D=L.getMonthlyUnitCost();let K=L.getMonthlyCost({quantity:v});"year"===n&&(K=K.withMultipliedAmount(12));const{addOnCostItem:E,addOnCostItemWithMembers:W}=(0,R().OL)(t,v,n,(0,H.jsx)(F().W,{cost:D.toMoneyValue(),trailingZeroDisplay:"stripIfInteger"}));return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsxs)("p",{style:d.monthlyCostText,children:[(0,H.jsx)("h3",{style:d.title,children:(0,H.jsx)(h()._H,{id:"addOnUpgrade.confirmation.monthlyCost.title",defaultMessage:"Add on"})}),(0,H.jsxs)("div",{style:d.costSectionTitle,children:[(0,H.jsx)("div",{children:E}),(0,H.jsx)("div",{style:d.rightAlign,children:(0,H.jsx)(F().W,{cost:K.toMoneyValue(),trailingZeroDisplay:"auto"})})]}),(0,H.jsx)("div",{style:d.costSection,children:W}),(0,H.jsx)(J,{cost:T.getCostPerBillingInterval({quantity:v}),fullCost:K}),(0,H.jsx)(Q,{price:T,coupon:x,quantity:v}),(0,H.jsxs)("div",{style:d.costSection,children:[(0,H.jsx)(h()._H,{id:"addOnUpgrade.confirmation.costSection.taxes",defaultMessage:"Taxes:"}),(0,H.jsx)("div",{style:d.rightAlign,children:(0,H.jsx)(F().W,{cost:{amount:b,currencyCode:y},trailingZeroDisplay:"auto"})})]}),(0,H.jsxs)("div",{style:d.totalCostSection,children:[(0,H.jsx)("h3",{style:d.title,children:(0,H.jsx)(h()._H,{id:"addOnUpgrade.confirmation.costSection.total",defaultMessage:"Total"})}),(0,H.jsx)("div",{style:d.rightAlign,children:(0,H.jsx)("h3",{style:d.title,children:(0,H.jsx)(F().W,{cost:B.toMoneyValue(),trailingZeroDisplay:"auto"})})})]}),(0,H.jsx)("div",{style:d.perMonth,children:(0,H.jsx)(h()._H,{id:"addOnUpgrade.confirmation.costSection.interval.label",defaultMessage:"{interval, select, month {per month} other {per year}}",values:{interval:n}})})]}),(0,H.jsx)(w().Z,{isLarge:!0,style:d.button,onClick:async()=>{const e=await I().Z.awaitData(c,{spaceId:s.id});if(!e)throw new Error("Billing data not loaded");const t=(0,m().Lg)(e),n=(0,p().AI)(t,{price:T,quantity:v});await P().Mg({environment:c,spaceStore:s,from:"add_on_upgrade_modal",desiredState:n,inAppOffer:x}),_().v5()},children:(0,H.jsx)(h()._H,{id:"addOnUpgradeModal.confirmPurchase.button.label",defaultMessage:"Confirm purchase"})}),(0,H.jsx)("p",{style:d.termsOfService,children:(0,H.jsx)("div",{style:d.text,children:(0,H.jsx)(h()._H,{id:"addOnUpgrade.confirmation.prorated.description",defaultMessage:"Performance subject to <fairUsePolicies>fair use policies</fairUsePolicies>.{br}By clicking Confirm Purchase you agree to the <terms>Notion AI Supplementary Terms</terms>.",values:{br:(0,H.jsx)("br",{}),fairUsePolicies:e=>(0,H.jsx)(j().Z,{href:(0,k().UY)("ai.fairUsePolicies"),children:e}),terms:e=>(0,H.jsx)(j().Z,{href:(0,k().UY)("ai.terms"),children:e})}})})})]})}function J(e){const t=oe(),{cost:n,fullCost:o}=e;if(n.amount===o.amount)return null;const i=o.minus(n),a=Math.floor(i.amount/o.amount*100);return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsxs)("div",{style:t.costSectionTitle,children:[(0,H.jsx)("div",{children:(0,H.jsx)(h()._H,{id:"addOnUpgrade.confirmation.costSection.annual.dynamicDiscountMessage",defaultMessage:"<bold>Annual discount ({discountPercent}%)</bold>",values:{bold:e=>(0,H.jsx)("b",{children:e}),discountPercent:a}})}),(0,H.jsx)("div",{style:t.greenRightAlign,children:(0,H.jsx)(F().W,{cost:i.withMultipliedAmount(-1).toMoneyValue(),trailingZeroDisplay:"auto",currencySign:"standard"})})]}),(0,H.jsx)("div",{style:t.costSection,children:(0,H.jsx)(h()._H,{id:"addOnUpgrade.confirmation.costSection.specialDiscount.annualPlanMessage",defaultMessage:"for being on the annual plan"})})]})}function Q(e){const t=oe(),{price:n,coupon:o,quantity:i}=e;if(!(0,f().pp)(o))return null;const a=n.getDiscountPerBillingInterval({quantity:i,coupon:o}).withMultipliedAmount(-1);return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsxs)("div",{style:t.costSectionTitle,children:[(0,H.jsx)("div",{children:(0,H.jsx)(h()._H,{id:"addOnUpgrade.confirmation.costSection.specialDiscount",defaultMessage:"<bold>Special discount ({percentage})</bold>",values:{bold:e=>(0,H.jsx)("b",{children:e}),percentage:(0,B().ov)(o)}})}),(0,H.jsx)("div",{style:t.greenRightAlign,children:(0,H.jsx)(F().W,{cost:a,trailingZeroDisplay:"auto",currencySign:"standard"})})]}),(0,H.jsx)("div",{style:t.costSection,children:(0,H.jsx)(h()._H,{id:"addOnUpgrade.confirmation.costSection.specialDiscount.threeMonthsMessage",defaultMessage:"for the next 3 months"})})]})}function X(e){const{addOnFeature:t}=e,n=oe(),o=(0,a().O7)();return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)("div",{style:n.buttonWithTopPadding,children:(0,H.jsx)(S().Z,{style:n.redButton,hoveredStyle:{background:v().ZP.redWithAlpha(.8)},onClick:async()=>{const e=(0,H.jsx)(h()._H,{id:"addOnUpgradeModal.cancellationStage.errorMessage",defaultMessage:"Unable to cancel add-on subscription. Please try again later."}),n=T().default.state.currentSpaceStore;if(!n)return x().UW(e);const i=await I().Z.awaitData(o,{spaceId:n.id});if(!i)throw new Error("Billing data not loaded");const a=(0,m().Lg)(i),r=(0,p().t4)(a,t);await P().Mg({environment:o,spaceStore:n,from:"add_on_upgrade_modal",desiredState:r}),_().v5()},children:(0,H.jsx)(h()._H,{id:"addOnUpgradeModal.midterm.yesButton.label",defaultMessage:"Schedule removal"})})}),(0,H.jsx)("div",{style:n.buttonWithTopPadding,children:(0,H.jsx)(S().Z,{style:n.noButton,onClick:()=>_().v5(),children:(0,H.jsx)(h()._H,{id:"addOnUpgradeModal.noButton.label",defaultMessage:"Cancel"})})})]})}function ee(e){var t;const{billingData:n}=e,o=oe(),a=null==n||null===(t=n.subscription)||void 0===t||null===(t=t.currentPeriodEnd)||void 0===t?void 0:t.toMillis();return a?(0,H.jsx)("p",{style:o.paragraph,children:(0,H.jsx)("div",{style:o.text,children:(0,H.jsx)(h()._H,{id:"addOnUpgradeModal.midterm.cancellation.description",defaultMessage:"Thank you for your input! You can continue to enjoy Notion AI until the end of your billing period on <bold>{periodEnd}</bold>. You can resubscribe anytime.",values:{periodEnd:(0,d().Yx)(a,"long",i().locale),bold:e=>(0,H.jsx)("b",{children:e})}})})}):null}function te(e){const{addOnFeature:t,canPurchaseAddOn:n,billingData:o,data:i}=e,a=oe();if(!n)return null;let r;switch(t){case"ai":r=(0,H.jsx)(h()._H,{id:"addOnUpgradeModal.midterm.cancellation.title.ai",defaultMessage:"Remove AI at the end of your billing period?"});break;case"sites_custom_hostnames":r=(0,H.jsx)(h()._H,{id:"addOnUpgradeModal.midterm.cancellation.title.sites",defaultMessage:"Remove Custom domains at the end of your billing period?"});break;default:(0,y().t1)(t)}return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)("h3",{style:a.cancellationTitle,children:r}),(0,H.jsx)(ee,{billingData:o}),(0,H.jsx)(X,{data:i,addOnFeature:t})]})}function ne(){const e=oe(),t=(0,a().O7)();let n=(0,H.jsx)(h()._H,{id:"addOnUpgradeModal.mobileMessage.button.label",defaultMessage:"Use the web or desktop app to add Notion AI to your plan and go unlimited."});return(t.device.isIOS||t.device.isIpad)&&(n=(0,H.jsx)(h()._H,{id:"addOnUpgradeModal.mobileMessage.ios.button.label",defaultMessage:"Unlimited AI cannot be purchased on mobile."})),(0,H.jsxs)(H.Fragment,{children:[(0,u().D)(e.icon),(0,H.jsx)("h3",{style:e.title,children:(0,H.jsx)(h()._H,{id:"addOnUpgrade.title.nonAdmin",defaultMessage:"You've used up all free AI responses in your plan"})}),(0,H.jsx)("p",{style:e.paragraph,children:(0,H.jsx)("div",{style:e.text,children:n})}),(0,H.jsx)(w().Z,{isLarge:!0,style:e.button,onClick:()=>_().v5(),children:(0,H.jsx)(h()._H,{id:"addOnUpgradeModal.gotIt.button.label",defaultMessage:"Got it"})})]})}function oe(){return(0,s().yK)((e=>({modal:{maxWidth:350,padding:24,fontSize:14,textAlign:"center"},largeModal:{maxWidth:420,padding:24,fontSize:14,textAlign:"center"},mobileModal:{padding:24,fontSize:14,textAlign:"center"},cancellationModal:{maxWidth:350,padding:"24px 16px 12px",fontSize:14,textAlign:"center"},innerModalPadding:{padding:"0px 8px"},cancellationInnerModalPadding:{padding:0},innerStyle:{borderRadius:10},title:{margin:0,marginBottom:0},cancellationTitle:{margin:0,marginBottom:0,marginTop:14},monthlyCostText:{textAlign:"left",paddingBottom:16},costSection:{margin:0,marginBottom:8,display:"flex",color:e.mediumTextColor},costSectionTitle:{display:"flex",color:e.mediumTextColor},totalCostSection:{display:"flex"},paymentMethodSection:{marginBottom:8,marginTop:8,display:"flex"},rightAlign:{position:"absolute",right:24},greenRightAlign:{position:"absolute",right:24,color:e.invoiceGreen},paragraph:{lineHeight:1.4,marginTop:4,marginBottom:12},termsOfService:{fontSize:"small",marginTop:8},text:{margin:0,color:e.mediumTextColor,marginBottom:8},icon:{display:"inline",height:24,fill:e.lightIconColor,marginTop:8,marginBottom:8},aiLogo:{height:60},button:{width:"100%"},buttonWithTopPadding:{paddingTop:12},noButton:{width:"100%",height:24,display:"inline-flex",alignItems:"center",justifyContent:"center"},cancelButton:{position:"absolute",top:"10px",right:"10px",background:e.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},redButton:{width:"100%",color:v().ZP.white,background:e.redBadgeBackground,display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,borderRadius:4,lineHeight:1.2,paddingLeft:12,paddingRight:12,fontWeight:b().Ue.medium},closeIcon:{width:14,fill:e.mediumTextColor},hovered:{background:e.buttonPressedBackground},perMonth:{position:"absolute",right:24,display:"flex",color:e.mediumTextColor,marginTop:-4},sharedStyleForDiscountBadge:{display:"inline-flex",alignItems:"center",borderRadius:4},innerStyleForDiscountBadge:{padding:"2px 6px",borderRadius:4,color:e.regularTextColor,background:e.accentColors.gray[75],fontWeight:400,fontSize:14,lineHeight:"16px",letterSpacing:"0.04em",whiteSpace:"nowrap"}})),[])}function ie(){return se("limit_reached")}function ae(){return se("confirm_purchase")}function re(){return se("cancel_plan")}function se(e){const t=O().default.state;if(t.open)return t.stage===e}},46135:(e,t,n)=>{n.d(t,{default:()=>i});class o extends(()=>n(263184))().default{getInitialState(){return{open:!1,succeeded:!1}}close(){this.setState({open:!1,succeeded:!1})}closeWithSuccess(){this.setState({open:!1,succeeded:!0})}open(e){this.setState({open:!0,temporaryBillingInterval:"month",temporaryAddress:{name:"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""},appliedPromo:void 0,error:void 0,vatApplicable:!1,calculatingTax:!1,payButtonState:"disabled",subscriptionTier:"enterprise",targetPlan:void 0,targetSpace:e,totalUpgradeCost:void 0,onlyShowAddOn:!1,sessionId:n(956057).Il(),type:n(145613).U.TargetSpace})}setAddressField(e){this.state.open&&this.setState({...this.state,temporaryAddress:{...this.state.temporaryAddress,...e},taxCalculationError:void 0})}}const i=new o},223248:(e,t,n)=>{n.d(t,{Id:()=>S,Ng:()=>M,Px:()=>b,ow:()=>x,t_:()=>y,um:()=>v});n(267602),n(653476);var o=()=>n(506347),i=()=>n(989478),a=()=>n(465755),r=()=>n(824462),s=()=>n(636340),l=()=>n(102182),d=()=>n(224597),c=()=>n(269299),u=()=>n(527278),m=()=>n(345918),p=()=>n(876822),g=()=>n(44556),f=()=>n(111631);const h=(0,n(788860).vU)({joinTeamSuccessMessage:{id:"teamInviteLinkActions.joinTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},requestTeamSuccessMessage:{id:"teamInviteLinkActions.requestAccess.successMessage",defaultMessage:"Successfully requested membership"},requestTeamFailureMessage:{id:"teamInviteLinkActions.requestAccess.failureMessage",defaultMessage:"Failed to request membership"}});async function v(e){let{environment:t,userId:n,teamStore:o,user:i}=e;const r=o.getSpaceId();if(!r)return;await g().Wi({environment:t,teamId:o.id,spaceId:r,teamUserInfo:i,isSettingDefaultTeam:!1,inviterId:n})&&(a().UD(t,{store:o,joined_role:"member",from:"team_invite_link"}),await y({environment:t,userId:n,teamStore:o}),l().oV({label:u().Z.formatMessage(h.joinTeamSuccessMessage,{teamName:o.getName()})}))}async function y(e){let{environment:t,userId:n,teamStore:i}=e;const a=p().default.state.currentUserRootStore,r=i.getSpaceId();if(!r||!a)return;const s=a.getSpaceViewStores().filter((e=>e.getSpaceId()===r))[0];await d().y3({environment:t,spaceViewStore:s,userSettingsStore:void 0,userRootStore:a,pageVisitSource:o().tY.JoinTeam,navigationType:"switchingToOrLoadingSpace"}),await f().I({environment:t,spaceId:r,userId:n}),g().hI({environment:t,teamStore:i,shouldScroll:!0})}async function b(e){let{environment:t,teamId:n,message:o}=e;if(!t.currentUser.id)return;"success"===(await r().callApi({eventName:"requestAccess",environment:t,data:{type:"current-actor-to-team",teamId:n,message:o}})).type?(a().LB(t,{teamId:n}),await S({environment:t}),new Promise((e=>setTimeout(e,500))).then((()=>{l().oV({label:u().Z.formatMessage(h.requestTeamSuccessMessage)})}))):l().oV({label:u().Z.formatMessage(h.requestTeamFailureMessage)})}async function x(e){let{environment:t,teamStore:n,accessRequestStore:o,status:r}=e;const l=o.getForActorId();if(!l)return;const d=o.getRecordModel({table:i().KJ,id:l});if(d){if("approved"===r){const e=[{type:"member",entity_type:"user",user_id:d.id}];if(!(await g().Uj({environment:t,teamStore:n,teamMemberInfos:e,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})))return}c().createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,canUndo:!0,perform:e=>{s().sW({store:o,transaction:e,data:{resolved_time:Date.now(),resolved_by_table:i().KJ,resolved_by_id:t.currentUser.id,status:r}})}}),a().co(t,{store:n,resolution:r})}}async function S(e){let{environment:t}=e;const{lastVisitedSpaceView:n,userRootStore:i,userSettingsStore:a}=await(0,m().iX)({environment:t,disableRedirectUrl:!1});n?await d().y3({environment:t,spaceViewStore:n,userRootStore:i,userSettingsStore:a,pageVisitSource:o().tY.BackForward,navigationType:"switchingToOrLoadingSpace"}):await d().L5({environment:t,userRootStore:i,userSettingsStore:a,pageVisitSource:o().tY.BackForward})}async function M(e){let{environment:t,teamId:n}=e;const o=await r().callApi({eventName:"getTeamAccessRequestMetadata",environment:t,data:{teamId:n}});if("success"===o.type)return o.data}},253032:(e,t,n)=>{n.r(t),n.d(t,{CreateTeamFromPageConfirmModal:()=>v});n(667294);var o=()=>n(219727),i=()=>n(142735),a=()=>n(846550),r=()=>n(781391),s=()=>n(788860),l=()=>n(707513),d=()=>n(661297),c=()=>n(906651),u=()=>n(840820),m=()=>n(251932),p=()=>n(174896),g=()=>n(853680),f=()=>n(586270),h=n(785893);function v(){const e=(0,o().O7)(),t=(0,s().YB)(),n=(0,a().yK)((e=>({modal:{maxWidth:350,padding:24},loopIcon:{height:28,width:28,fill:e.darkTextColor},infoIcon:{height:16,width:16,fill:e.lightIconColor,marginRight:4},title:{marginTop:16,marginBottom:12,color:e.regularTextColor,fontWeight:l().Ue.semibold,fontSize:18},description:{color:e.darkTextColor,textAlign:"center",fontSize:14,marginBottom:18},confirmButton:{width:"100%",marginBottom:8},cancelButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:14}})),[]),v=(0,i().VK)((()=>g().default.state.open),[]);return(0,h.jsx)(u().Z,{onDismiss:()=>{g().default.setState({open:!1})},render:()=>(0,h.jsx)("div",{style:n.modal,children:(0,h.jsxs)(m().gq,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,r().z)(n.loopIcon),(0,h.jsx)("div",{style:n.title,children:(0,h.jsx)(s()._H,{id:"createTeamFromPage.confirmModal.title",defaultMessage:"Turn into teamspace?"})}),(0,h.jsx)("div",{style:n.description,children:(0,h.jsx)(s()._H,{id:"createTeamFromPage.confirmModal.description",defaultMessage:"This will move this page into a newly created teamspace along with people who already have access to this page."})}),(0,h.jsx)(c().Z,{isLarge:!0,style:n.confirmButton,onClick:()=>{if(g().default.state.open){const{pageStore:n,flowId:o}=g().default.state;p().Sq({environment:e,intl:t,page:n,flowId:o}),g().default.setState({open:!1})}},children:(0,h.jsx)(s()._H,{id:"createTeamFromPage.confirmModal.confirmButton",defaultMessage:"Create teamspace"})}),(0,h.jsx)(d().Z,{size:"lg",style:n.cancelButton,onClick:()=>g().default.setState({open:!1}),children:(0,h.jsx)(s()._H,{id:"createTeamFromPage.confirmModal.cancelButton",defaultMessage:"Cancel"})}),(0,h.jsx)(f().Z,{message:(0,h.jsx)(s()._H,{id:"createTeamFromPage.confirmModal.learnMore",defaultMessage:"Learn more about teamspaces"}),analyticsFrom:"teams_learn_more_turn_page_into_team",helpCenterLocation:"bestPractices"})]})}),isOpen:v})}},840821:(e,t,n)=>{n.d(t,{M:()=>y});var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(846550),s=()=>n(707513),l=()=>n(345918),d=()=>n(91502),c=()=>n(289963),u=()=>n(132222),m=()=>n(788860),p=()=>n(265640),g=n(785893);const f=function(e){const{teamStore:t,from:r,navigateToTeamHomeOnJoin:s,style:l,hoveredStyle:d,icon:c,isRed:u}=e,f=(0,i().O7)(),h=(0,a().VK)((()=>n(876822).default.state.currentSpaceStore),[]),v=(0,o.useCallback)((async()=>{h&&await n(44556).um({environment:f,teamStore:t,currentSpaceStore:h,from:r,andNavigateToTeamHome:s??!1})}),[h,f,t,r,s]);return(0,g.jsx)(p().D,{style:l,hoveredStyle:d,onClick:v,icon:c,isRed:u,children:(0,g.jsx)(m()._H,{id:"outlinerTeamToggleButton.joinTeamButton",defaultMessage:"Join"})})};var h=()=>n(12875);const v=function(e){const{teamStore:t,style:i,hoveredStyle:r}=e,[s,l]=(0,o.useState)(!1),d=(0,a().VK)((()=>t.getName()),[t]);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(p().D,{style:i,hoveredStyle:r,onClick:()=>l(!0),children:(0,g.jsx)(m()._H,{id:"teamRequestButton.requestButton.label",defaultMessage:"Request"})}),(0,g.jsx)(n(450194).Z,{teamStore:t,teamName:d,teamId:t.id,isModalOpen:s,onDismiss:()=>l(!1)})]})};function y(e){const{teamStore:t,style:n,hoveredStyle:o}=e,m=(0,i().O7)(),p=(0,c().Q)(),y=(0,u().e)(t),b=(0,a().VK)((()=>t.getTeamAccessLevel()),[t]),x=(0,r().yK)((e=>({joinTeamButton:{maxHeight:26,marginLeft:10,paddingLeft:10,paddingRight:10,borderRadius:100,fontSize:13,fontWeight:s().Ue.semibold,background:e.buttonHoveredBackground,alignSelf:"center",...n},joinTeamButtonHoveredStyle:{background:e.buttonPressedBackground,...o}})),[n,o]),S=(0,a().VK)((()=>(0,d().Hu)({membership:t.getRawMembership()})&&(0,l().Fn)(m)),[m,t]),M=!y&&"open"===b||S,w=!y&&"closed"===b;return p?null:y?(0,g.jsx)(h().Z,{...e,style:x.joinTeamButton,hoveredStyle:x.joinTeamButtonHoveredStyle}):M?(0,g.jsx)(f,{...e,style:x.joinTeamButton,hoveredStyle:x.joinTeamButtonHoveredStyle}):w?(0,g.jsx)(v,{teamStore:t,style:x.joinTeamButton,hoveredStyle:x.joinTeamButtonHoveredStyle}):null}},12875:(e,t,n)=>{n.d(t,{Z:()=>c});n(241792);var o=n(667294),i=()=>n(219727),a=()=>n(142735),r=()=>n(788860),s=()=>n(513670),l=()=>n(463807),d=n(785893);const c=function(e){const{teamStore:t,from:c,onLeavingTeam:u,style:m,hoveredStyle:p,icon:g,isRed:f,placement:h,alignment:v,buttonInternals:y}=e,b=(0,i().O7)(),x=(0,a().VK)((()=>n(876822).default.state.currentSpaceStore),[]),S=(0,l().l)(t),M=(0,o.useCallback)((async()=>{if(!x)return;await n(44556).s({environment:b,teamStore:t,from:c,userGroupsInTeam:S})&&(null==u||u())}),[x,b,t,c,S,u]),w=(0,d.jsx)(r()._H,{id:"teamJoinLeaveButton.leaveTeam.enabledTooltip",defaultMessage:"Click to leave teamspace"}),C=function(e){let{teamStore:t}=e;const n=(0,i().O7)(),o=n.currentUser.id,{isDefaultTeam:c}=(0,a().VK)((()=>({isDefaultTeam:t.isDefault()})),[t]),u=(0,l().l)(t),m=(0,a().VK)((()=>{if(!t.isReady())return!1;const{ownerUserIds:e,ownerGroupIds:n}=t.getAllOwnerIds();return Boolean(o&&t.isOwner(o)&&e.length+n.length===1)}),[t,o]);return function(e){let{isDefaultTeam:t,isOnlyTeamOwner:n,userGroupsInTeam:o}=e;if(t)return(0,d.jsx)(r()._H,{id:"teamBrowser.teamCard.leaveTeam.defaultTeamTooltip",defaultMessage:"You can’t leave this teamspace because everyone in the workspace must be a member"});if(n)return(0,d.jsx)(r()._H,{id:"teamJoinLeaveButton.leaveTeam.onlyOwnerTooltip",defaultMessage:"Invite another teamspace owner to leave this teamspace"});if(o.length>0)return(0,d.jsx)(r()._H,{id:"teamBrowser.teamCard.leaveTeam.groupTooltip",defaultMessage:"{groupNames, plural, one {You can't leave this teamspace because you're a member of multiple groups, {groupNames}.} other {You can't leave this teamspace because you're a member of the group, {groupNames}.}}",values:{groupNames:s().oA(o.map((e=>e.name))).join()}})}({isDefaultTeam:c,isOnlyTeamOwner:m,userGroupsInTeam:u})}({teamStore:t}),j=Boolean(C),k=j?C:w;return(0,d.jsx)(n(654133).Z,{style:j?{width:240}:void 0,disableTooltip:!Boolean(k),renderTooltip:e=>(0,d.jsx)("div",{...e,children:k}),textWrap:j,placement:h,alignment:v,render:e=>(0,d.jsx)(n(265640).D,{...e,style:m,hoveredStyle:p,onClick:M,disabled:j,disabledFeedback:j,icon:g,isRed:f,children:y||(0,d.jsxs)(d.Fragment,{children:[(0,n(286977).e)({width:12.5,marginRight:4}),(0,d.jsx)(r()._H,{id:"teamBrowser.teamCard.button.joined",defaultMessage:"Joined"})]})})})}},707581:(e,t,n)=>{n.d(t,{Z:()=>l});n(667294);var o=()=>n(667067),i=()=>n(788860),a=()=>n(654133),r=()=>n(998901),s=n(785893);function l(e){let{iconStyle:t}=e;return(0,s.jsx)(a().Z,{textWrap:!0,style:{width:210},placement:r().Placement.Bottom,renderTooltip:()=>(0,s.jsx)(i()._H,{id:"teamLockIcon.tooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>(0,s.jsx)("div",{...e,children:(0,o().Q)(t)})})}},939123:(e,t,n)=>{n.r(t),n.d(t,{TeamPermissionsInvite:()=>L});n(267602),n(653476),n(241792),n(667294);var o=()=>n(219727),i=()=>n(142735),a=()=>n(846550),r=()=>n(446866),s=()=>n(801812),l=()=>n(788860),d=()=>n(198829),c=()=>n(711658),u=()=>n(301741),m=()=>n(122671),p=()=>n(286338),g=()=>n(352230),f=()=>n(88476),h=()=>n(91502),v=()=>n(876822),y=()=>n(296631),b=()=>n(576387),x=()=>n(374289),S=()=>n(513670),M=()=>n(265640),w=()=>n(827973),C=()=>n(448419),j=()=>n(255577),k=()=>n(388284),T=()=>n(654133),I=()=>n(998901),_=()=>n(128119),P=()=>n(741381),Z=()=>n(936968),A=n(785893);function R(e){const{selectedRole:t,allRoles:n,onChange:r,store:s,labelStyle:c}=e,{device:u}=(0,o().O7)(),m=(0,a().Fg)(),p=(0,Z().q)(s),f=(0,i().VK)((()=>{const{currentSpaceStore:e}=v().default.state;return null==e?void 0:e.canEditMembership()}),[]),y=(0,i().VK)((()=>s.isDefault()),[s]);return(0,A.jsx)(C().ZP,{popupType:u.isMobile?C().Z4.SlideUp:C().Z4.Popup,renderOrigin:e=>(0,A.jsxs)(M().D,{style:c,...e,children:[(0,A.jsx)(l()._H,{...h().q9[t].label}),(0,x().i)({width:10,marginLeft:4,fill:m.lightIconColor})]}),placementToOrigin:_().Iw.Bottom,render:e=>{const o=[{key:"roles",render:e=>(0,A.jsx)(k().Z,{...e,topBorder:0!==e.index}),items:n.map((n=>{const{isDisabled:o,disabledReason:i}=(0,P().j)({role:n,isCurrentUserTeamOwner:Boolean(p),userIsSpaceAdmin:Boolean(f),isDefaultTeam:y}),a={key:n,render:e=>(0,A.jsx)(T().Z,{disableTooltip:!o,placement:I().Placement.Right,textWrap:!0,renderTooltip:()=>i,render:i=>(0,A.jsx)("span",{...i,children:(0,A.jsx)(w().Z,{...e,checkState:S().Xy(n,t),disabled:o,disabledFeedback:o,title:(0,A.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,A.jsx)(l()._H,{...h().q9[n].label})}),caption:(0,A.jsx)("span",{style:{color:m.mediumTextColor},children:(0,A.jsx)(l()._H,{...h().q9[n].caption})}),shouldWrapCaption:!0})})}),action:()=>{r(n),e.close()}};return a}))}];let i;return i=u.isMobile?{menuType:g().o.Modal,title:(0,A.jsx)(l()._H,{id:"teamPermissionsMenu.mobile.title",defaultMessage:"Select teamspace role"}),right:(0,A.jsx)(l()._H,{id:"teamPermissionsMenu.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:e.close}:{menuType:g().o.Popup,width:264},(0,A.jsx)(d().Z,{...i,children:(0,A.jsx)(j().ZP,{type:j().iW.Vertical,initialFocus:void 0,sections:o})})}})}const B="member";function L(e){const{store:t,onEmptySubmit:n}=e,r=(0,o().O7)();(0,s().r5)((async()=>{await b().bi(r)}),[]);const l=(0,i().qz)(e.permissionsInviteStore,y().Z),u=(0,i().VK)((()=>Boolean(l.state.isFocused)),[l]),m=(0,i().VK)((()=>l.state.tokenQuery),[l]),p=(0,i().VK)((()=>u&&m.length>0),[u,m]),f=(0,a().yK)((e=>({permissionsInviteSearchRequest:{position:"absolute",width:"100%",borderRadius:4,backgroundColor:e.contentBackground,boxShadow:e.shadowLG,marginTop:4},scroller:{zIndex:1}})),[]);function h(e){l.setState({...l.state,isFocused:e})}return(0,A.jsx)("div",{onFocus:()=>h(!0),onBlur:()=>h(!1),children:(0,A.jsx)(d().Z,{menuType:g().o.Popup,header:(0,A.jsx)(D,{store:t,permissionsInviteStore:l,onEmptySubmit:n}),scrollerStyle:f.scroller,width:"100%",tokenInputHeader:!1,disableScroller:!0,children:p&&(0,A.jsx)("div",{style:f.permissionsInviteSearchRequest,children:(0,A.jsx)(c().Z,{permissionsInviteStore:l,store:t,defaultRoleForSpaceBot:"editor",shouldShowBots:!1,shouldShowGroups:!0,sectionRenderLimit:10,membersOnly:!1,hideUserTypeToken:!0,disableInvitedUsers:!0})})})})}function D(e){const{store:t,permissionsInviteStore:n,onEmptySubmit:o}=e,s=(0,l().YB)(),d=(0,i().VK)((()=>Boolean(n.state.isFocused)),[n]),c=(0,i().VK)((()=>n.state.tokenQuery),[n]),p=(0,i().VK)((()=>n.state.inviteRole),[n]),g=(0,i().VK)((()=>n.state.inviteTargets),[n]),h=(0,a().yK)((e=>({inputTokenVerticalMargin:{marginTop:3,marginBottom:3},tokenMenuItem:{alignItems:"unset",borderRadius:4,paddingTop:5,paddingBottom:5,paddingLeft:8,paddingRight:5,boxShadow:d?e.outlineBlueInputBoxShadow:e.inputBoxShadow,maxHeight:"40vh"},inputDiv:{marginBottom:0}})),[d]);function v(e){if(n.state.isInviteTargetsEmpty)return;const t=n.state.inviteTargets.filter((t=>t!==e));0===g.length?n.setState({...n.state,inviteTargets:[],inviteRole:B,isInviteTargetsEmpty:!0}):n.setState({...n.state,inviteTargets:t})}function y(e){n.setState({...n.state,isFocused:e})}const b=g.map((e=>{const t="newUser"===e.type?e.value.email:`${e.type}-${e.value.id}`;return(0,A.jsx)(u().Z,{target:e,onClickRemove:v,role:p,shouldWrap:!0,style:h.inputTokenVerticalMargin,backgroundColor:(0,f().gQ)(e)},t)}));return(0,A.jsx)(m().ZP,{focus:d,onClick:()=>y(!0),format:m().UR.Share,value:c,onChange:function(e){const t=e.target.value,{extractedEmails:o,newInputValue:i}=(0,r().zI)(t),a=o.map((e=>({type:"newUser",value:{email:e},source:"email"}))).filter((e=>!(0,f().Nd)({target:e,permissionsInviteStore:n}))),s=[...n.state.inviteTargets,...a];s.length>0?(n.setState({...n.state,inviteTargets:s,isInviteTargetsEmpty:!1,tokenQuery:i}),y(!(a.length>0))):n.setState({...n.state,inviteTargets:[],isInviteTargetsEmpty:!0,tokenQuery:i})},onEmptySubmit:o,type:"email",placeholder:s.formatMessage({id:"teamPermissionsInvite.searchInput.placeholder",defaultMessage:"Search people or groups"}),tokens:b,onRemoveLastToken:function(){const e={...n.state};e.inviteTargets=e.inviteTargets.slice(0,-1),0===e.inviteTargets.length&&(e.isInviteTargetsEmpty=!0,e.inviteRole=B),n.setState(e)},focusAfterAnimation:!0,right:(0,A.jsx)(V,{store:t,permissionsInviteStore:n}),style:h.tokenMenuItem,inputStyle:h.inputTokenVerticalMargin,inputDivStyle:h.inputDiv,inputFullWidth:!0})}function V(e){const{store:t,permissionsInviteStore:n}=e,o=(0,i().VK)((()=>{const e=v().default.state.currentSpaceStore;return!(null!=e&&e.getDisableTeamGuests())&&(0,p().F$)()}),[]),r=(0,i().VK)((()=>n.state.inviteRole),[n]),s=(0,a().yK)((()=>({teamRoleLabel:{marginTop:3,marginBottom:3,marginLeft:5}})),[]);function l(e){n.setState({...n.state,inviteRole:e})}return o?(0,A.jsx)(R,{store:t,selectedRole:r,allRoles:h().ZN,onChange:l,labelStyle:s.teamRoleLabel}):(0,A.jsx)(R,{store:t,selectedRole:r,allRoles:h().$r,onChange:l,labelStyle:s.teamRoleLabel})}},824033:(e,t,n)=>{n.r(t),n.d(t,{TeamPermissionsInviteWithModal:()=>l});n(667294);var o=()=>n(142735),i=()=>n(846550),a=()=>n(923550),r=()=>n(669200),s=n(785893);function l(e){let{store:t,permissionsInviteStore:n,origin:l}=e;const d=(0,o().VK)((()=>n.state.modalOpen),[n]),c=()=>{n.reset()},u=(0,i().yK)((()=>({modal:{alignSelf:"center",overflow:"visible",top:0,width:500},overlay:{display:"flex",flexDirection:"column",alignItems:"end",padding:22}})),[]);return(0,s.jsx)(a().Z,{modalStyle:u.modal,open:d,onDismiss:c,renderContent:()=>(0,s.jsx)("div",{style:u.overlay,children:(0,s.jsx)(r().Z,{store:t,permissionsInviteStore:n,isNewlyCreatedTeam:!1,onSubmitSuccessful:c,onDismiss:c})}),origin:l})}},450194:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(667294),i=()=>n(788860),a=n(785893);const r=(0,i().vU)({message_placeholder:{id:"teamInviteLinkRequestPage.message.placeholder",defaultMessage:"Message (optional)"}});const s=function(e){const{teamStore:t,teamName:s,teamId:l,isModalOpen:d,onDismiss:c}=e,[u,m]=(0,o.useState)(""),p=(0,n(219727).O7)(),g=(0,i().YB)(),f=async()=>{await n(223248).Px({environment:p,teamId:l,message:u}),c()},h=(0,n(846550).yK)((()=>({modal:{alignSelf:"center",overflow:"visible",padding:15,width:420},requestTitle:{display:"inline-flex",marginBottom:10},icon:{marginLeft:4,marginRight:4},footer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:15},requestInvitesButton:{marginLeft:20},input:{padding:8}})),[]);return(0,a.jsx)(n(708518).Z,{open:d,onDismiss:c,innerStyle:h.modal,preventHideChildrenWhileOpening:!0,render:()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{style:h.requestTitle,children:(0,a.jsx)(i()._H,{id:"teamInviteLinkRequestModal.reasonForRequest.title",defaultMessage:"Request access to {icon} {teamName}",values:{teamName:s,icon:(0,a.jsx)(n(383694).p,{style:h.icon,store:t,disabled:!0,size:22})}})}),(0,a.jsx)(n(291198).Z,{textarea:!0,style:h.input,value:u,onChange:e=>{m(e.target.value)},placeholder:g.formatMessage(r.message_placeholder)}),(0,a.jsxs)("div",{style:h.footer,children:[(0,a.jsx)(n(67961).Z,{isSecondaryColor:!0,isSmall:!0,isMultiline:!0,children:(0,a.jsx)(i()._H,{id:"teamInviteLinkRequestModal.caption",defaultMessage:"Your teamspace owners will approve or decline your request."})}),(0,a.jsx)(n(906651).Z,{isLarge:!0,style:h.requestInvitesButton,onClick:f,children:(0,a.jsx)(i()._H,{id:"teamInviteLinkRequestModal.requestAccessButton.label",defaultMessage:"Request"})})]})]})})}},741381:(e,t,n)=>{n.d(t,{j:()=>r,o:()=>s});n(667294);var o=()=>n(788860),i=n(785893);const a=(0,o().vU)({addingGuestsToDefaultTeam:{id:"getTeamRoleDisabled.addingGuestsToDefaultTeam",defaultMessage:"Default teams can't contain teamspace guests"},addingGuestsAsNonOwner:{id:"getTeamRoleDisabled.addingGuestsAsNonOwner",defaultMessage:"You must be a workspace owner and a teamspace owner to add teamspace guests"},makingAGroupAnOwner:{id:"getTeamRoleDisabled.makingAGroupAnOwner",defaultMessage:"Groups can’t be teamspace owners"},makingAGroupATeamGuest:{id:"getTeamRoleDisabled.makingAGroupATeamGuest",defaultMessage:"Groups can’t be teamspace guests"},upgradingAnOwnerAsNonOwner:{id:"getTeamRoleDisabled.upgradingAnOwnerAsNonOwner",defaultMessage:"You must be a teamspace owner to add another owner"},downgradeLastUserOwner:{id:"getTeamRoleDisabled.downgradeLastUserOwner",defaultMessage:"Add another teamspace owner to downgrade yourself to member"},downgradeToOwnerAsNonOwner:{id:"getTeamRoleDisabled.downgradeToOwnerAsNonOwner",defaultMessage:"You must be a teamspace owner to downgrade other teamspace owners"},removeLastUserOwner:{id:"getTeamRoleDisabled.removeLastUserOwner",defaultMessage:"Add another teamspace owner to leave the team"},removeLastGroupOwner:{id:"getTeamRoleDisabled.removeLastGroupOwner",defaultMessage:"Add another teamspace owner to remove this group"},downgradeLastMakingAGroupAnOwner:{id:"getTeamRoleDisabled.downgradeLastMakingAGroupAnOwner",defaultMessage:"Add another teamspace owner to make this group a member"},downgradingAMemberToAGuest:{id:"getTeamRoleDisabled.downgradingAMemberToAGuest",defaultMessage:"To change this user to a teamspace guest, first remove them from the workspace."},removingMemberFromDefaultTeam:{id:"getTeamRoleDisabled.removingMemberFromDefaultTeam",defaultMessage:"Members cannot be removed from a default teamspace."},removingMemberAsMember:{id:"getTeamRoleDisabled.removingMemberTeam.noPermission",defaultMessage:"You must be a team owner to remove other team members in this teamspace."},changingTeamRoleAsNonTeamOwner:{id:"getTeamRoleDisabled.changingTeamRoleAsNonMember",defaultMessage:"You must be a teamspace owner to adjust team membership."}});function r(e){let{isCurrentUserTeamOwner:t,role:n,isDefaultTeam:o,userIsSpaceAdmin:i}=e;return t||"owner"!==n?o&&"team_level_guest"===n?l(a.addingGuestsToDefaultTeam):!i&&"team_level_guest"===n||!t&&"team_level_guest"===n?l(a.addingGuestsAsNonOwner):{isDisabled:!1,disabledReason:void 0}:l(a.upgradingAnOwnerAsNonOwner)}function s(e){let{isCurrentUserTeamOwner:t,role:n,isDefaultTeam:o,userIsSpaceAdmin:i,userIsEnterpriseWorkspaceOwner:s,originalTeamMemberInfo:d,onlyHasOneOwner:c,isUnowned:u,isMemberCurrentUser:m,canCurrentUserAddTeamMembers:p}=e;if("team_level_guest"===n&&"team_level_guest"!==d.type)return l(a.downgradingAMemberToAGuest);const g="owner"!==n&&"owner"===d.type;if(g&&!t)return l(a.downgradeToOwnerAsNonOwner);if(g&&c)return l("none"===n?"group"===d.entity_type?a.removeLastGroupOwner:a.removeLastUserOwner:"group"===d.entity_type?a.downgradeLastMakingAGroupAnOwner:a.downgradeLastUserOwner);if("none"===n&&o)return l(a.removingMemberFromDefaultTeam);return"group"===d.entity_type&&"team_level_guest"===n?l(a.makingAGroupATeamGuest):"owner"===n&&i&&"user"===d.entity_type&&u&&m||"owner"===n&&s&&m?{isDisabled:!1,disabledReason:void 0}:"none"===n?t||p&&"member"===d.type?{isDisabled:!1,disabledReason:void 0}:l(a.removingMemberAsMember):t?r({isCurrentUserTeamOwner:t,role:n,isDefaultTeam:o,userIsSpaceAdmin:i}):l(a.changingTeamRoleAsNonTeamOwner)}function l(e){return{isDisabled:!0,disabledReason:(0,i.jsx)(o()._H,{...e})}}},289963:(e,t,n)=>{n.d(t,{Q:()=>l});var o=()=>n(219727),i=()=>n(142735),a=()=>n(345918),r=()=>n(876822),s=()=>n(897257);function l(){const e=function(){const e=(0,o().O7)();return(0,i().VK)((()=>{const t=r().default.state.currentSpaceStore,n=s().subscriptionDataStoreInstance.state;return t?a().Cx(t)?n?{loading:!1,isUserTeamGuestOfSpace:a().di(e,n)}:{loading:!0}:{loading:!1,isUserTeamGuestOfSpace:!1}:{loading:!0}}),[e])}();return(0,i().VK)((()=>e.loading||e.isUserTeamGuestOfSpace),[e])}},132222:(e,t,n)=>{n.d(t,{e:()=>r});var o=()=>n(219727),i=()=>n(142735),a=()=>n(619779);function r(e){const t=(0,o().O7)().currentUser.id;return(0,i().VK)((()=>Boolean(void 0!==t&&e.isNonGuestMember(t,a().Z.state.spacePermissionGroupIds))),[t,e])}},431671:(e,t,n)=>{n.d(t,{F:()=>h});n(241792);var o=()=>n(142735),i=()=>n(331540),a=()=>n(801812),r=()=>n(752778),s=()=>n(826955),l=()=>n(824462);var d=()=>n(384791),c=()=>n(677559),u=()=>n(466970),m=()=>n(828946),p=()=>n(98228),g=()=>n(771097),f=()=>n(241449);function h(e){let{environment:t,spaceStore:n,joinedTeamIds:h,parentStore:v,moveToTargets:y,overrideDatabaseType:b}=e;const x=(0,o().VK)((()=>{const e=null==n?void 0:n.id;if(e)return function(e){if(!g().CachedTypedDatabasesStore.state)return;if(e!==g().CachedTypedDatabasesStore.state.spaceId)return;return g().CachedTypedDatabasesStore.state.typedDatabases}(e)}),[null==n?void 0:n.id]),S=(0,u().E)("typed_move_to_improved_default_results"),M=(0,c().XJ)(m().x.searchActions),[{value:w,status:C}]=(0,a().r5)((async()=>{if(x)return x;if(!n||!v)return;const e=b??f().default.getDatabaseType();if(!e)return;if("resolved"!==M.status)return;const o=M.value;let a=[];if(S){const i=((await o.searchCollectionsWithRecents({environment:t,query:"",limit:20,databaseType:[e],spaceStore:n,parentStore:n,collectionViewBlockStore:void 0,searchSessionId:f().default.state.isOpen?f().default.state.flowId:void 0})).results||[]).map((e=>s().NW.createChildStore(v,{table:r().vF,id:e})));a=(0,d().qJ)({typedDatabases:i,blocksToFilterParents:y})}else{const o=await async function(e){let{environment:t,spaceId:n,databaseType:o,parentStore:i}=e;if(!n)return;const a=await l().callApi({eventName:"getTypedDatabases",environment:t,data:{spaceId:n,databaseType:o}});return"success"===a.type?a.data.result.map((e=>s().NW.createChildStore(i,{table:r().vF,id:e.collectionId}))):void 0}({environment:t,spaceId:n.id,databaseType:e,parentStore:v})??[];a=(0,d().mL)({environment:t,typedDatabases:o,spaceStore:n,joinedTeamIds:h})}return g().CachedTypedDatabasesStore.setState({typedDatabases:a,spaceId:n.id}),f().default.update((e=>({...e,variant:i().ii}))),a}),[x,n,v,b,M.status,M.value,S,t,y,h],{debounce:p().vp,throttle:p().vp});return x?{success:!0,typedDatabases:x}:"resolved"===C&&w?{success:!0,typedDatabases:w}:{success:!1}}},983135:(e,t,n)=>{n.d(t,{K:()=>a});var o=()=>n(142735),i=()=>n(91502);function a(e){return(0,o().VK)((()=>{var t;return void 0===e?0:(null===(t=(0,i().oT)(e))||void 0===t?void 0:t.memberCountWithGuests)??0}),[e])}},463807:(e,t,n)=>{n.d(t,{l:()=>s});n(267602),n(653476),n(241792);var o=()=>n(142735),i=()=>n(542487),a=()=>n(467806),r=()=>n(619779);function s(e){return(0,o().VK)((()=>{if(!e.isDefined())return[];return(0,i().Gr)({rawMembers:e.getRawMembership(),groupsInSpace:a().Z.state.permissionGroupsAndMemberCounts.map((e=>e.group))}).filter((e=>r().Z.state.spacePermissionGroupIds.has(e.getGroupId())))}),[e])}},752348:(e,t,n)=>{n.r(t),n.d(t,{getAllContextValues:()=>v,getContextValueForActionById:()=>b,getContextValuesForAction:()=>y,typecheckAutomation:()=>f,typecheckAutomationAsync:()=>h});n(670560),n(267602),n(241792),n(228244);var o=()=>n(513670),i=()=>n(855741),a=()=>n(696459),r=()=>n(870910),s=()=>n(177634),l=()=>n(440692),d=()=>n(782827),c=()=>n(360517),u=()=>n(750239),m=()=>n(870691),p=()=>n(227666);function*g(e){const{actionModels:t,automationModel:n,contextType:g,formulasModule:f,runtimeStats:h}=e,v={valueTypes:e.valueTypes,actionInputValueTypes:{},actionValidationFailures:{}},y=performance.now();let b,x,S;if("button_block"===g||"button_property"===g){if(!n.isButtonType())return{error:new(c().MO)(`Automation trigger (${n.getTriggerType()}) does not match context type (${g}).`)};const t=n.getTrigger();S=(0,p().o)(n.getTriggerType()).typecheck(e,t)}else if("event"===g){if(!n.isEventType()&&!n.isNotificationType())return{error:new(c().MO)(`Automation trigger (${n.getTriggerType()}) does not match context type (${g}).`)};const t=n.getTrigger();S=(0,p().o)(n.getTriggerType()).typecheck(e,t)}else if("recurrence"===g){if(!n.isRecurrenceType())return{error:new(c().MO)(`Automation trigger (${n.getTriggerType()}) does not match context type (${g}).`)};const t=n.getTrigger();S=(0,p().o)(n.getTriggerType()).typecheck(e,t)}else(0,a().t1)(e);if(i().x.isFail(S))return S;v.valueTypes.push(...o().d9(S.value.valueTypes));for(const a of t){b=void 0,h&&(b=m().Fv.getOrCreateAction(h,a.pointer,a.getType()));const t=(0,l().getActionRegistryItem)(a.getType());if(!t){x={error:new(c().EP)({actionId:a.id,message:`Unsupported action type: ${a.getType()}`})};break}const p=performance.now(),g=(0,d().C)({automationModel:n,formulasModule:f,formulaValueTypes:v.valueTypes}),y=(0,u().xg)(yield*t.resolveExecutionDependencies(g,a));yield*r().R.fetchRecords(y.map((e=>e.pointer))),b&&(b.totalDependencies=y.length,b.getDependenciesDurationMs=Math.trunc(performance.now()-p));const S=t.typecheck(e,a),M=o().d9(v.valueTypes);if(v.actionInputValueTypes[a.id]=M,i().x.isFail(S)){x=S;break}for(const e of S.value.valueTypes??[]){v.valueTypes.some((t=>(0,s().Fl)(e,t)))||v.valueTypes.push(e)}S.value.validationFailures&&S.value.validationFailures.length>0&&(v.actionValidationFailures[a.id]=S.value.validationFailures)}const M=Math.trunc(performance.now()-y);return h&&(h.typecheckStartTime=y,h.typecheckDurationMs=M,h.typecheckSuccess=!(0,a().$K)(x)),x??{value:v}}function f(e){return r().R.runSync(e.getRecordModel,g(e))}async function h(e){return await r().R.runAsync(e.loadRecordModel,g(e))}function v(e){return i().x.isFail(e)?[]:e.value.valueTypes.slice(0)}function y(e,t){return i().x.isFail(e)?[]:e.value.actionInputValueTypes[t]??[]}function b(e,t,n){const o=y(e,t);return(0,s().vx)(o,n)}},309968:(e,t,n)=>{n.d(t,{Hr:()=>c,Nq:()=>M,TW:()=>g,Vl:()=>s,ZH:()=>y,_V:()=>h,lg:()=>S,q6:()=>p,xL:()=>d});var o=()=>n(874459),i=()=>n(92960),a=()=>n(177634);const r=(0,n(788860).vU)({buttonAutomationCurrentUserDescription:{defaultMessage:"The user who clicked this button",id:"automations.contextValue.buttonAutomationCurrentUserDescription"},buttonAutomationCurrentUserName:{defaultMessage:"Whoever clicked",id:"automations.contextValue.buttonAutomationCurrentUserName"},buttonAutomationCurrentUserTooltip:{defaultMessage:"The person who clicked the button",id:"automations.contextValue.buttonAutomationCurrentUserTooltip"},buttonAutomationThisPageDescription:{defaultMessage:"The page containing this button",id:"automations.contextValue.buttonAutomationThisPageDescription"},buttonAutomationThisPageName:{defaultMessage:"This page",id:"automations.contextValue.buttonAutomationThisPageName"},buttonAutomationThisPageTooltip:{defaultMessage:"The page containing this button",id:"automations.contextValue.buttonAutomationThisPageTooltip"},eventAutomationCurrentUserDescription:{defaultMessage:"The user who made the edit that triggered this automation to run.",id:"automations.contextValue.eventAutomationCurrentUserDescription"},eventAutomationCurrentUserName:{defaultMessage:"Whoever triggered",id:"automations.contextValue.eventAutomationCurrentUserName"},eventAutomationCurrentUserTooltip:{defaultMessage:"The person whose action triggered this automation",id:"automations.contextValue.eventAutomationCurrentUserTooltip"},eventAutomationThisPageDescription:{defaultMessage:"The page that was edited to trigger this automation to run.",id:"automations.contextValue.eventAutomationThisPageDescription"},eventAutomationThisPageName:{defaultMessage:"Trigger page",id:"automations.contextValue.eventAutomationThisPageName"},eventAutomationThisPageTooltip:{defaultMessage:"The page that triggered this automation",id:"automations.contextValue.eventAutomationThisPageTooltip"},now:{id:"automations.triggers.now.label",defaultMessage:"Time triggered"},nowDescription:{id:"automations.triggers.now.description",defaultMessage:"The time when this automation begins to run."},nowTooltip:{id:"automations.triggers.now.tooltip",defaultMessage:"The time this automation was triggered"},pageCreator:{id:"automations.triggers.pageCreator.label",defaultMessage:"Page creator"},pageCreatorDescription:{id:"automations.triggers.pageCreator.description",defaultMessage:"The user who created the page that was edited to trigger this automation to run."},pageCreatorTooltip:{id:"automations.triggers.pageCreator.tooltip",defaultMessage:"Person who created page"},today:{id:"automations.triggers.today.label",defaultMessage:"Date triggered"},todayDescription:{id:"automations.triggers.today.description",defaultMessage:"The date when this automation begins to run."},todayTooltip:{id:"automations.triggers.today.tooltip",defaultMessage:"The date this automation was triggered"}});function s(){return(0,a().Kd)({source:"global",global:"button_page"})}function l(e,t,n){return{description:n,name:e,tooltip:t,compile:(o,a)=>({description:n?o.formatMessage(n):void 0,id:s(),kind:i().FormulaContextValueKind.ContextValue,name:o.formatMessage(e),tooltipName:o.formatMessage(t),type:{collection:a,type:"block"}}),evaluate:e=>({kind:i().FormulaContextValueKind.ContextValue,id:s(),value:{type:"block",value:e}})}}const d=l(r.buttonAutomationThisPageName,r.buttonAutomationThisPageTooltip,r.buttonAutomationThisPageDescription),c=l(r.eventAutomationThisPageName,r.eventAutomationThisPageTooltip,r.eventAutomationThisPageDescription);function u(){return(0,a().Kd)({source:"global",global:"current_user"})}function m(e,t,n){return{description:n,name:e,tooltip:t,compile:o=>({description:n?o.formatMessage(n):void 0,id:u(),kind:i().FormulaContextValueKind.ContextValue,name:o.formatMessage(e),tooltipName:o.formatMessage(t),type:{type:"person"}}),evaluate:e=>({id:u(),kind:i().FormulaContextValueKind.ContextValue,value:{type:"person",value:e}})}}const p=m(r.buttonAutomationCurrentUserName,r.buttonAutomationCurrentUserTooltip,r.buttonAutomationCurrentUserDescription),g=m(r.eventAutomationCurrentUserName,r.eventAutomationCurrentUserTooltip,r.eventAutomationCurrentUserDescription);function f(){return(0,a().Kd)({source:"global",global:"now"})}const h={description:r.nowDescription,name:r.now,tooltip:r.nowTooltip,compile(e){return{description:this.description?e.formatMessage(this.description):void 0,id:f(),kind:i().FormulaContextValueKind.ContextValue,name:e.formatMessage(this.name),tooltipName:this.tooltip?e.formatMessage(this.tooltip):void 0,type:{type:"date"}}},evaluate:e=>({id:f(),kind:i().FormulaContextValueKind.ContextValue,value:{type:"date",value:(0,o().CQ)(Date.now(),e)}})};function v(){return(0,a().Kd)({source:"global",global:"today"})}const y={description:r.todayDescription,name:r.today,tooltip:r.todayTooltip,compile(e){return{description:this.description?e.formatMessage(this.description):void 0,id:v(),kind:i().FormulaContextValueKind.ContextValue,name:e.formatMessage(this.name),tooltipName:this.tooltip?e.formatMessage(this.tooltip):void 0,type:{type:"date"}}},evaluate:e=>({id:v(),kind:i().FormulaContextValueKind.ContextValue,value:{type:"date",value:(0,o().hT)(Date.now(),e)}})};function b(){return(0,a().Kd)({source:"global",global:"page_creator"})}function x(e,t){return{description:r.pageCreatorDescription,name:e,tooltip:t,compile(n){return{description:this.description?n.formatMessage(this.description):void 0,id:b(),kind:i().FormulaContextValueKind.ContextValue,name:n.formatMessage(e),tooltipName:n.formatMessage(t),type:{type:"person"}}},evaluate:e=>({id:b(),kind:i().FormulaContextValueKind.ContextValue,value:{type:"person",value:e}})}}const S=x(r.pageCreator,r.pageCreatorTooltip),M=x(r.pageCreator,r.pageCreatorTooltip)},227666:(e,t,n)=>{n.d(t,{o:()=>u});var o=()=>n(513670),i=()=>n(696459),a=()=>n(998411),r=()=>n(752778),s=()=>n(309968);const l={type:"button",getCreatePermissions(e){const{parentPointer:t}=e;return[{minimumRole:"read_and_write",pointer:t,type:"record_permission"}]},getEditPermissions(e){const{automationModel:t}=e;return[{minimumRole:"read_and_write",pointer:t.getParentPointer(),type:"record_permission"}]},getManagePermissions(e){const{automationModel:t}=e;return[{minimumRole:"read_and_write",pointer:t.getParentPointer(),type:"record_permission"}]},getExecutePermissions(e){const{automationModel:t}=e;return[{minimumRole:"reader",pointer:t.getParentPointer(),type:"record_permission"}]},typecheck(e){const{automationModel:t,contextType:a,getRecordModel:l,intl:d}=e,c=s().q6.compile(d),u=s()._V.compile(d),m=s().ZH.compile(d),p=t.getParentPointer();let g,f;if("button_block"===a){if(e.pageBlockModel){const t=(0,n(942275).J2)({block:e.pageBlockModel,getRecordModel:l});t&&(g=s().xL.compile(d,t.pointer),f=s().lg.compile(d))}}else if("button_property"===a){const e=l(p);if((null==e?void 0:e.table)!==r().vF)return{error:new(n(360517).MO)(`Unable to load automation parent: ${n(827370).dr.toKey(p)}`)};g=s().xL.compile(d,e.pointer),f=s().lg.compile(d)}else(0,i().t1)(a);return{value:{valueTypes:(0,o().oA)([c,u,m,g,f])}}},execute(e){const{formulaVariableResolution:t}=e,{executingUserPointer:n,executingUserTimeZone:i,thisPageBlockModel:r}=t??{},l=r?s().xL.evaluate(r.pointer):void 0,d=null==r?void 0:r.getCreatedByPointer(),c=d?s().lg.evaluate(d):void 0,u=n?s().q6.evaluate(n):void 0,m=(0,a().r)(),p=s()._V.evaluate(i??m),g=s().ZH.evaluate(i??m);return{value:{values:(0,o().oA)([l,c,u,p,g])}}},isAvailableForContext:e=>!0};n(670560);const d={type:"event",getCreatePermissions(e){const{parentPointer:t,spacePointer:n}=e;return[{minimumRole:"editor",pointer:t,type:"record_permission"},{minimumRole:"read_and_write",pointer:n,type:"record_permission"}]},getEditPermissions(e){const{automationModel:t}=e,o=[{minimumRole:"editor",pointer:t.getParentPointer(),type:"record_permission"},{minimumRole:"read_and_write",pointer:t.getSpacePointer(),type:"record_permission"}],a=t.getTrigger();if("event"===a.type){const e=a.event;(0,i().$K)(e.source)&&"filter"!==e.source.type&&(e.source.type===r().vF||e.source.type===n(139978).np?o.push({minimumRole:"reader",pointer:e.source.pointer,type:"record_permission"}):(0,i().t1)(e.source))}return o},getManagePermissions(e){const{automationModel:t}=e;return[{minimumRole:"editor",pointer:t.getParentPointer(),type:"record_permission"},{minimumRole:"read_and_write",pointer:t.getSpacePointer(),type:"record_permission"}]},getExecutePermissions(e){const{automationModel:t}=e;return[{minimumRole:"reader",pointer:t.getParentPointer(),type:"record_permission"}]},typecheck(e){const{automationModel:t,intl:n}=e,i=s().TW.compile(n),a=s().Nq.compile(n),l=s()._V.compile(n),d=s().ZH.compile(n),c=t.getParentPointer();let u;return c.table===r().vF&&(u=s().Hr.compile(n,c)),{value:{valueTypes:(0,o().oA)([i,a,l,d,u])}}},execute(e){const{formulaVariableResolution:t}=e,{executingUserPointer:n,executingUserTimeZone:r,thisPageBlockModel:l}=t??{},d=l?s().Hr.evaluate(l.pointer):void 0,c=n?s().TW.evaluate(n):void 0,u=(0,a().r)(),m=s()._V.evaluate(r??u),p=null==l?void 0:l.getCreatedByPointer(),g=(0,i().$K)(p)?s().Nq.evaluate(p):void 0,f=s().ZH.evaluate(r??u);return{value:{values:(0,o().oA)([d,c,m,f,g])}}},isAvailableForContext:e=>!0};const c={button:l,event:d,notification_event:d,recurrence:{type:"recurrence",getCreatePermissions(e){const{parentPointer:t}=e;return[{minimumRole:"read_and_write",pointer:t,type:"record_permission"}]},getEditPermissions(e){const{automationModel:t}=e;return[{minimumRole:"read_and_write",pointer:t.getParentPointer(),type:"record_permission"}]},getManagePermissions(e){const{automationModel:t}=e;return[{minimumRole:"read_and_write",pointer:t.getParentPointer(),type:"record_permission"}]},getExecutePermissions(e){const{automationModel:t}=e;return[{minimumRole:"reader",pointer:t.getParentPointer(),type:"record_permission"}]},typecheck(e){const{intl:t}=e;return{value:{valueTypes:[s()._V.compile(t),s().ZH.compile(t)]}}},execute(e){const{formulaVariableResolution:t}=e,{executingUserTimeZone:n}=t??{},o=(0,a().r)();return{value:{values:[s()._V.evaluate(n??o),s().ZH.evaluate(n??o)]}}},isAvailableForContext(e){const{automation:t,automationActions:o,hasPremiumAutomations:a}=e;if(t.parent_table===n(396136).iU)return!0;if(t.parent_table===r().vF){const e=n(217465).RecordMap.create();for(const t of o)e.addModel(t);return!!t.isCompleteSprintAutomation({getRecordModel:n(530980).omK.fromRecordMap(e)})||a}(0,i().t1)(t.parent_table)}}};function u(e){return c[e]}},442884:(e,t,n)=>{n.d(t,{B:()=>a,X:()=>i});var o=()=>n(955620);function i(e){if(!e)return;const t=o().lzi(e),n=o().hDy(t[0])[0];if(!n||!o().kf_(n))return;const i=n[1];return{lat:i.lat,lon:i.lon}}function a(e){if(!e)return[];const t=o().YOw(e);return[o().YCD(t)]}},159408:(e,t,n)=>{n.d(t,{t:()=>o});const o=(0,n(827282).CZ)("arrowUpCircled",{default:{loader:()=>n.e(1387).then(n.bind(n,301387))},small:{loader:()=>n.e(47737).then(n.bind(n,947737))},mini:{loader:()=>n.e(96178).then(n.bind(n,396178))},large:{loader:()=>n.e(60099).then(n.bind(n,60099))}})},770708:(e,t,n)=>{n.d(t,{U:()=>o});const o=(0,n(827282).CZ)("globe",{default:{loader:()=>n.e(38048).then(n.bind(n,138048))},small:{loader:()=>n.e(66290).then(n.bind(n,366290))},mini:{loader:()=>n.e(39448).then(n.bind(n,339448))},large:{loader:()=>n.e(46293).then(n.bind(n,646293))}})},95317:(e,t,n)=>{n.d(t,{Q:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("androidShare",{viewBox:"0 0 15 15",svg:(0,o.jsx)("path",{d:"M11.9952,10.6024 C11.4229,10.6024 10.9108,10.8283 10.51928,11.1822 L5.15029999,8.05723 C5.18794999,7.88404 5.21806999,7.71084 5.21806999,7.53012 C5.21806999,7.3494 5.18794999,7.1762 5.15029999,7.00301 L10.45904,3.90813 C10.8657,4.28464 11.4003,4.51807 11.9952,4.51807 C13.2452,4.51807 14.2542,3.50904 14.2542,2.25904 C14.2542,1.00904 13.2452,0 11.9952,0 C10.7452,0 9.73614999,1.00904 9.73614999,2.25904 C9.73614999,2.43976 9.76626999,2.61295 9.80391999,2.78614 L4.49517999,5.88102 C4.08854999,5.50452 3.55391999,5.27108 2.95903999,5.27108 C1.70903999,5.27108 0.699999988,6.28012 0.699999988,7.53012 C0.699999988,8.78012 1.70903999,9.78916 2.95903999,9.78916 C3.55391999,9.78916 4.08854999,9.55572 4.49517999,9.17922 L9.85662999,12.3117 C9.81897999,12.4699 9.79638999,12.6355 9.79638999,12.8012 C9.79638999,14.0136 10.7828,15 11.9952,15 C13.2075,15 14.194,14.0136 14.194,12.8012 C14.194,11.5889 13.2075,10.6024 11.9952,10.6024 Z"})})},370668:(e,t,n)=>{n.d(t,{V:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("arrowLeft",{viewBox:"0 0 30 30",svg:(0,o.jsx)("polygon",{points:"29 14 4.813 14 13.406 5.406 12 4 1 15 12 26 13.406 24.594 4.813 16 29 16"})})},32618:(e,t,n)=>{n.d(t,{D:()=>i});n(667294);const o={viewBox:"0 0 20 20",svg:(0,n(785893).jsx)("path",{d:"M15.85 3.65a.625.625 0 1 0 0-1.25H4.15a.625.625 0 1 0 0 1.25zm-1.008 6.692a.625.625 0 0 1-.884 0l-3.333-3.333v9.966a.625.625 0 1 1-1.25 0V7.009l-3.333 3.333a.625.625 0 1 1-.884-.884l4.4-4.4a.625.625 0 0 1 .884 0l4.4 4.4a.625.625 0 0 1 0 .884"})},i=(0,n(827282).IU)("arrowLineUp",o)},702041:(e,t,n)=>{n.d(t,{R:()=>i});n(667294);const o={viewBox:"0 0 20 20",svg:(0,n(785893).jsx)("path",{d:"M9.792 2.41a.6.6 0 0 0-.234.148l-5.4 5.4a.625.625 0 1 0 .884.884l4.333-4.333V17a.625.625 0 1 0 1.25 0V4.509l4.333 4.333a.625.625 0 1 0 .884-.884l-5.4-5.4a.62.62 0 0 0-.65-.147"})},i=(0,n(827282).IU)("arrowStraightUp",o)},337621:(e,t,n)=>{n.d(t,{j:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("bellDisabled",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M7 15.2285C6.48047 15.2285 6.02246 15.11 5.62598 14.873C5.23405 14.6406 4.92188 14.333 4.68945 13.9502C4.46159 13.5719 4.33854 13.1618 4.32031 12.7197H1.51074C1.15072 12.7197 0.868164 12.6331 0.663086 12.46C0.462565 12.2822 0.362305 12.0475 0.362305 11.7559C0.362305 11.5143 0.426107 11.2842 0.553711 11.0654C0.681315 10.8421 0.843099 10.6279 1.03906 10.4229C1.23958 10.2178 1.44466 10.015 1.6543 9.81445C1.8138 9.65951 1.93685 9.45671 2.02344 9.20605C2.11003 8.9554 2.17611 8.67969 2.22168 8.37891C2.26725 8.07812 2.30371 7.77051 2.33105 7.45605C2.34017 7.08691 2.36296 6.73828 2.39941 6.41016C2.44043 6.08203 2.49512 5.77669 2.56348 5.49414L3.73926 6.66992C3.71647 6.8431 3.69596 7.02539 3.67773 7.2168C3.66406 7.4082 3.65495 7.60872 3.65039 7.81836C3.63216 8.12826 3.60482 8.41536 3.56836 8.67969C3.5319 8.94401 3.48405 9.18555 3.4248 9.4043C3.36556 9.62305 3.29264 9.81901 3.20605 9.99219C3.12402 10.1654 3.02604 10.3158 2.91211 10.4434C2.80273 10.571 2.68652 10.6963 2.56348 10.8193C2.44499 10.9378 2.33561 11.0472 2.23535 11.1475C2.13965 11.2477 2.06217 11.3275 2.00293 11.3867V11.4688H8.54492L10.0078 12.9385H9.64551C9.59538 13.3532 9.45182 13.7337 9.21484 14.0801C8.98242 14.4264 8.6748 14.7044 8.29199 14.9141C7.91374 15.1237 7.48307 15.2285 7 15.2285ZM7 14.1348C7.38737 14.1348 7.70866 14.0072 7.96387 13.752C8.21908 13.4967 8.35807 13.1527 8.38086 12.7197H5.6123C5.63965 13.1527 5.78092 13.4967 6.03613 13.752C6.29134 14.0072 6.61263 14.1348 7 14.1348ZM4.01953 2.99902C4.15625 2.89421 4.30208 2.7985 4.45703 2.71191C4.61654 2.62533 4.78516 2.55241 4.96289 2.49316C5.09049 2.04199 5.33431 1.66374 5.69434 1.3584C6.05436 1.05306 6.48958 0.900391 7 0.900391C7.50586 0.900391 7.9388 1.05306 8.29883 1.3584C8.65885 1.66374 8.90495 2.04199 9.03711 2.49316C9.9349 2.81673 10.5889 3.41146 10.999 4.27734C11.4137 5.14323 11.6416 6.2666 11.6826 7.64746C11.7008 7.9209 11.7282 8.17383 11.7646 8.40625C11.8011 8.63411 11.849 8.84603 11.9082 9.04199C11.972 9.2334 12.0518 9.41113 12.1475 9.5752C12.2477 9.73926 12.3685 9.89648 12.5098 10.0469C12.7786 10.3021 13.0293 10.5664 13.2617 10.8398C13.4941 11.1133 13.6104 11.4027 13.6104 11.708C13.6104 11.9587 13.5329 12.166 13.3779 12.3301L10.6641 9.55469C10.5911 9.39518 10.5342 9.22884 10.4932 9.05566C10.4567 8.87793 10.4271 8.68424 10.4043 8.47461C10.3815 8.26497 10.361 8.03027 10.3428 7.77051C10.3245 6.80892 10.222 6.04557 10.0352 5.48047C9.84831 4.91081 9.60449 4.4847 9.30371 4.20215C9.00293 3.9196 8.66569 3.72819 8.29199 3.62793C8.20996 3.6097 8.14616 3.5778 8.10059 3.53223C8.05501 3.4821 8.02767 3.41146 8.01855 3.32031C8.00033 2.97396 7.90007 2.69368 7.71777 2.47949C7.54004 2.2653 7.30078 2.1582 7 2.1582C6.69922 2.1582 6.45768 2.2653 6.27539 2.47949C6.0931 2.69368 5.99284 2.97396 5.97461 3.32031C5.97005 3.41146 5.94271 3.4821 5.89258 3.53223C5.84701 3.5778 5.78548 3.6097 5.70801 3.62793C5.57585 3.66439 5.44824 3.70996 5.3252 3.76465C5.20671 3.81934 5.09277 3.88542 4.9834 3.96289L4.01953 2.99902ZM0.615234 2.35645C0.514974 2.25163 0.464844 2.12402 0.464844 1.97363C0.464844 1.81868 0.514974 1.6888 0.615234 1.58398C0.724609 1.47917 0.854492 1.42676 1.00488 1.42676C1.15983 1.42676 1.28971 1.47917 1.39453 1.58398L13.8086 13.9912C13.9134 14.096 13.9658 14.2236 13.9658 14.374C13.9658 14.5244 13.9134 14.6543 13.8086 14.7637C13.7038 14.8685 13.5739 14.9209 13.4189 14.9209C13.2686 14.9209 13.141 14.8685 13.0361 14.7637L0.615234 2.35645Z"})})},573369:(e,t,n)=>{n.d(t,{v:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("blueCircleDot",{viewBox:"0 0 16 16",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("circle",{cx:"8",cy:"8",r:"8",fill:"none",stroke:"#2383E2",children:[(0,o.jsx)("animate",{attributeName:"r",from:"3",to:"8",dur:"1s",begin:"0s",repeatCount:"indefinite"}),(0,o.jsx)("animate",{attributeName:"opacity",from:"1",to:"0",dur:"1s",begin:"0s",repeatCount:"indefinite"})]}),(0,o.jsx)("circle",{cx:"8",cy:"8",r:"3",fill:"#2383E2"})]})})},782137:(e,t,n)=>{n.d(t,{e:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("checkedRoundedCheckmark",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M7.99617 16C12.3807 16 15.9923 12.3807 15.9923 7.99617C15.9923 3.61167 12.373 0 7.99617 0C3.61167 0 0 3.61167 0 7.99617C0 12.3807 3.61167 16 7.99617 16ZM7.99617 14.2018C4.5605 14.2018 1.80583 11.4319 1.80583 7.99617C1.80583 4.5605 4.55285 1.79818 7.99617 1.79818C11.4319 1.79818 14.1942 4.5605 14.2018 7.99617C14.2018 11.4319 11.4319 14.2018 7.99617 14.2018ZM7.18508 11.6461C7.47585 11.6461 7.73601 11.4931 7.912 11.2329L11.3324 5.96078C11.4395 5.79244 11.5237 5.60115 11.5237 5.42516C11.5237 5.01196 11.1564 4.72119 10.7585 4.72119C10.506 4.72119 10.2841 4.86657 10.1081 5.14969L7.16212 9.84027L5.80775 8.14921C5.6241 7.912 5.43281 7.82783 5.18795 7.82783C4.7824 7.82783 4.45337 8.14921 4.45337 8.56241C4.45337 8.76136 4.52224 8.93735 4.66762 9.12099L6.42755 11.2406C6.6418 11.5084 6.87901 11.6461 7.18508 11.6461Z"})})},81739:(e,t,n)=>{n.d(t,{C:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("eyeHide",{viewBox:"0 0 16 12",svg:(0,o.jsx)("path",{d:"M12.2754 10.9346L3.08545 1.76074C2.91895 1.59424 2.91895 1.3042 3.08545 1.1377C3.25732 0.96582 3.53662 0.971191 3.7085 1.1377L12.8931 10.3169C13.0649 10.4888 13.0703 10.752 12.8931 10.9346C12.7212 11.1172 12.4473 11.1064 12.2754 10.9346ZM8 1.44922C12.4526 1.44922 15.4067 5.02637 15.4067 6.13281C15.4067 6.76123 14.4346 8.20605 12.7588 9.31787L11.8618 8.41553C13.167 7.58301 13.978 6.54102 13.978 6.13281C13.978 5.50977 11.3516 2.62012 8 2.62012C7.43066 2.62012 6.9043 2.70068 6.39404 2.84033L5.42188 1.86816C6.21143 1.61035 7.06006 1.44922 8 1.44922ZM8 10.811C3.60645 10.811 0.587891 7.22852 0.587891 6.13281C0.587891 5.48828 1.6084 4.0166 3.33789 2.89404L4.25635 3.8125C2.87598 4.67725 2.0166 5.77832 2.0166 6.13281C2.0166 6.87402 4.64307 9.64014 8 9.64014C8.6123 9.64014 9.18701 9.54883 9.73486 9.39307L10.707 10.3652C9.88525 10.6445 8.98291 10.811 8 10.811ZM10.6211 7.06201L7.06543 3.50635C7.35547 3.38818 7.66699 3.32373 8 3.32373C9.55762 3.32373 10.8145 4.56445 10.8145 6.12744C10.8145 6.45508 10.7446 6.77734 10.6211 7.06201ZM8 8.93652C6.43164 8.93652 5.18555 7.6582 5.18018 6.13281C5.18018 5.75146 5.26074 5.39697 5.41113 5.08008L9.04199 8.70557C8.7251 8.85059 8.37598 8.93652 8 8.93652Z"})})},36205:(e,t,n)=>{n.d(t,{R:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("googleLogo",{viewBox:"0 0 20 20",svg:(0,o.jsxs)("g",{children:[(0,o.jsx)("path",{d:"M19.9996 10.2297C19.9996 9.54995 19.9434 8.8665 19.8234 8.19775H10.2002V12.0486H15.711C15.4823 13.2905 14.7475 14.3892 13.6716 15.0873V17.586H16.9593C18.89 15.8443 19.9996 13.2722 19.9996 10.2297Z",fill:"#4285F4"}),(0,o.jsx)("path",{d:"M10.2002 20.0003C12.9518 20.0003 15.2723 19.1147 16.963 17.5862L13.6753 15.0875C12.7606 15.6975 11.5797 16.0429 10.2039 16.0429C7.54224 16.0429 5.28544 14.2828 4.4757 11.9165H1.08301V14.4923C2.81497 17.8691 6.34261 20.0003 10.2002 20.0003Z",fill:"#34A853"}),(0,o.jsx)("path",{d:"M4.47227 11.9163C4.04491 10.6743 4.04491 9.32947 4.47227 8.0875V5.51172H1.08333C-0.363715 8.33737 -0.363715 11.6664 1.08333 14.4921L4.47227 11.9163Z",fill:"#FBBC04"}),(0,o.jsx)("path",{d:"M10.2002 3.95756C11.6547 3.93552 13.0605 4.47198 14.1139 5.45674L17.0268 2.60169C15.1824 0.904099 12.7344 -0.0292099 10.2002 0.000185607C6.34261 0.000185607 2.81497 2.13136 1.08301 5.51185L4.47195 8.08764C5.27795 5.71762 7.53849 3.95756 10.2002 3.95756Z",fill:"#EA4335"})]})})},214924:(e,t,n)=>{n.d(t,{W:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("language",{viewBox:"0 0 64 64",svg:(0,o.jsx)("path",{d:"m20,19.24l2.16,5.76h-4.32l2.16-5.76Zm5.95,4.62c2.49-3.27,6.07-5.64,10.5-6.87-2.61-5.68-8.42-8.99-16.45-8.99C8.89,8,2,14.32,2,24.5c0,5.19,1.8,9.37,5.03,12.22l-5.03,5.03,1.5,2.25c4.06,0,7.8-1.36,10.81-3.63,1.74.41,3.64.63,5.69.63.82,0,1.61-.05,2.39-.11-.25-1.39-.39-2.85-.39-4.39,0-2.73.43-5.23,1.22-7.5h-6.88l-1.12,3h-4.22l6-16h6l2.95,7.86Zm18.05,13.46c.99-.9,1.84-1.99,2.4-3.32h-4.79c.56,1.33,1.41,2.42,2.4,3.32Zm12.97,11.4l5.03,5.03-1.5,2.25c-4.06,0-7.8-1.36-10.81-3.63-1.74.41-3.64.63-5.69.63-11.11,0-18-6.32-18-16.5s6.89-16.5,18-16.5,18,6.32,18,16.5c0,5.19-1.8,9.37-5.03,12.22Zm-3.97-18.72h-7v-3h-4v3h-7v4h2.49c.58,1.97,1.68,3.86,3.22,5.52-2.76,1.36-5.38,1.74-5.38,1.74l1.4,3.75c2.78-.5,5.21-1.48,7.26-2.78,2.05,1.3,4.49,2.29,7.26,2.78l1.4-3.75s-2.62-.38-5.38-1.74c1.55-1.66,2.64-3.55,3.22-5.52h2.49v-4Z"})})},967925:(e,t,n)=>{n.d(t,{J:()=>i});n(667294);const o={viewBox:"0 0 20 20",svg:(0,n(785893).jsx)("path",{d:"M3.3 4.825c0-.842.683-1.525 1.525-1.525h3.15c.842 0 1.525.683 1.525 1.525v10.35c0 .842-.683 1.525-1.525 1.525h-3.15A1.525 1.525 0 0 1 3.3 15.175zm1.525-.275a.275.275 0 0 0-.275.275v10.35c0 .152.123.275.275.275h3.15a.275.275 0 0 0 .275-.275V4.825a.275.275 0 0 0-.275-.275zm5.675.275v3.15c0 .842.683 1.525 1.525 1.525h3.15c.842 0 1.525-.683 1.525-1.525v-3.15c0-.842-.683-1.525-1.525-1.525h-3.15c-.842 0-1.525.683-1.525 1.525m1.525-.275h3.15c.152 0 .275.123.275.275v3.15a.275.275 0 0 1-.275.275h-3.15a.275.275 0 0 1-.275-.275v-3.15c0-.152.123-.275.275-.275m0 5.95c-.842 0-1.525.682-1.525 1.525v3.15c0 .842.683 1.525 1.525 1.525h3.15c.842 0 1.525-.683 1.525-1.525v-3.15c0-.843-.683-1.525-1.525-1.525zm-.275 1.525c0-.152.123-.275.275-.275h3.15c.152 0 .275.123.275.275v3.15a.275.275 0 0 1-.275.275h-3.15a.275.275 0 0 1-.275-.275z"})},i=(0,n(827282).IU)("layout",o)},698005:(e,t,n)=>{n.d(t,{$:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("minus",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M3.037 8.844h9.92a.705.705 0 00.368-.103.825.825 0 00.28-.28.73.73 0 000-.773.752.752 0 00-.28-.28.705.705 0 00-.369-.102H3.037a.705.705 0 00-.369.102.824.824 0 00-.28.28.73.73 0 000 .772.914.914 0 00.28.281.705.705 0 00.37.103z"})})},140353:(e,t,n)=>{n.d(t,{D:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("notionCalendarLogo",{viewBox:"0 0 20 21",svg:(0,o.jsxs)("svg",{width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",children:[(0,o.jsxs)("g",{clipPath:"url(#clip0_970_53429)",children:[(0,o.jsx)("path",{d:"M2.17141 17.1924C1.81019 17.1884 1.48919 17.0958 1.23979 16.8633C1.23979 16.8633 1.23899 16.8633 1.23819 16.8617C1.20922 16.8336 1.18187 16.8046 1.15613 16.7756C0.959022 16.5504 0.852023 16.2615 0.852023 15.9494L0.849609 3.0915C0.849609 2.34732 1.47712 1.67957 2.21968 1.63371L15.0636 0.838839C15.0918 0.83723 15.1191 0.836426 15.1473 0.836426C15.4683 0.836426 15.7675 0.952277 15.996 1.16789C16.0274 1.19766 16.0572 1.22823 16.0845 1.26041C16.1585 1.34488 16.2197 1.43821 16.268 1.53877C16.2205 1.43901 16.1585 1.34569 16.0845 1.26121C16.2768 1.48487 16.3822 1.76967 16.3822 2.07861V2.40766C16.3822 2.40766 16.3902 2.67717 16.1231 2.69487L16.1247 2.69648L4.3114 3.43664C3.44494 3.49055 2.741 4.24117 2.741 5.10925C2.741 5.10925 2.73617 16.9768 2.73537 16.9961C2.72652 17.1924 2.56481 17.1924 2.43127 17.1924H2.17141Z",fill:"black"}),(0,o.jsx)("path",{d:"M19.1589 18.1882C19.1589 18.2075 19.1573 18.2269 19.1556 18.2462C19.1275 18.6589 18.7984 19.0225 18.3938 19.0973C18.3857 19.0973 18.3777 19.0998 18.3696 19.0998L4.66812 19.9292H4.62548C4.35758 19.9155 4.10979 19.8126 3.91671 19.6307C3.7003 19.4272 3.57882 19.1488 3.56997 18.8439C3.56997 18.8319 3.56836 18.8198 3.56836 18.8069V5.19278C3.56836 5.17347 3.56836 5.15497 3.56997 5.13566C3.59974 4.6988 3.96498 4.31746 4.40102 4.2724C4.41229 4.2724 4.42355 4.26919 4.43481 4.26838L17.5531 3.44616L18.1436 3.40915C18.1653 3.40754 18.187 3.40674 18.2087 3.40674C18.4557 3.40674 18.6858 3.49604 18.862 3.66097C18.9851 3.77601 19.072 3.92002 19.1186 4.08012C19.1388 4.14851 19.1508 4.22011 19.1556 4.29332V13.1785L19.1589 18.1874V18.1882Z",fill:"black"}),(0,o.jsx)("path",{d:"M20.001 4.36907C20.001 3.86302 19.8023 3.3972 19.4402 3.0577C19.0782 2.71819 18.6011 2.54763 18.0967 2.57981L17.3928 2.62245C17.2166 2.62808 17.2246 2.49212 17.2246 2.49212V2.08583C17.2246 1.49692 16.9929 0.955478 16.5722 0.560458C16.1514 0.165437 15.5955 -0.0324757 15.009 0.00372785L2.16349 0.798596C0.97121 0.872612 0.000976562 1.90482 0.000976562 3.09953L0.00339008 15.9574C0.00339008 16.5455 0.235088 17.0878 0.655844 17.4836C1.04442 17.8488 1.54724 18.0468 2.08465 18.0468C2.12889 18.0468 2.55448 18.0387 2.55448 18.0387C2.70975 18.0387 2.73549 18.1103 2.73549 18.2439V18.9012C2.73549 19.4289 2.94547 19.9157 3.32278 20.2705C3.67113 20.5979 4.12246 20.7749 4.60436 20.7749C4.62366 20.7749 4.64217 20.7733 4.66148 20.7733C4.67113 20.7733 4.67998 20.7749 4.68963 20.7749C4.73147 20.7749 4.7733 20.7733 4.81594 20.7709L18.3477 19.9519C18.4081 19.9478 18.4668 19.9406 18.5255 19.931C19.3461 19.8304 19.9994 19.1071 19.9994 18.2728L19.9978 18.2648C19.9978 18.2415 20.001 18.2181 20.001 18.1948V4.36907ZM2.17153 17.1996C1.81031 17.1956 1.48931 17.1031 1.23991 16.8705C1.23991 16.8705 1.23911 16.8705 1.23831 16.8689C1.20934 16.8408 1.18199 16.8118 1.15625 16.7829C0.959142 16.5576 0.852143 16.2688 0.852143 15.9566L0.84973 3.09873C0.84973 2.35454 1.47724 1.68679 2.2198 1.64093L15.0637 0.846063C15.0919 0.844454 15.1192 0.84365 15.1474 0.84365C15.4684 0.84365 15.7677 0.959501 15.9961 1.17511C16.0275 1.20488 16.0573 1.23545 16.0846 1.26763C16.1587 1.35211 16.2198 1.44543 16.2681 1.546C16.2206 1.44624 16.1587 1.35291 16.0846 1.26844C16.2769 1.49209 16.3823 1.7769 16.3823 2.08583V2.41488C16.3823 2.41488 16.3904 2.6844 16.1233 2.7021L16.1249 2.70371L4.31152 3.44387C3.44506 3.49777 2.74112 4.24839 2.74112 5.11647C2.74112 5.11647 2.73629 16.984 2.73549 17.0033C2.72664 17.1996 2.56493 17.1996 2.43139 17.1996H2.17153ZM19.1635 18.1948C19.1635 18.2141 19.1619 18.2334 19.1603 18.2527C19.1321 18.6654 18.8031 19.0291 18.3984 19.1039C18.3904 19.1039 18.3823 19.1063 18.3743 19.1063L4.67274 19.9358H4.6301C4.3622 19.9221 4.11441 19.8191 3.92133 19.6373C3.70492 19.4338 3.58344 19.1554 3.57459 18.8505C3.57459 18.8384 3.57298 18.8263 3.57298 18.8135V5.19934C3.57298 5.18003 3.57298 5.16152 3.57459 5.14221C3.60436 4.70536 3.9696 4.32402 4.40564 4.27896C4.41691 4.27896 4.42817 4.27574 4.43943 4.27494L17.5577 3.45272L18.1482 3.41571C18.1699 3.4141 18.1916 3.4133 18.2134 3.4133C18.4603 3.4133 18.6904 3.5026 18.8666 3.66752C18.9897 3.78257 19.0766 3.92658 19.1233 4.08668C19.1434 4.15507 19.1554 4.22667 19.1603 4.29988V13.185L19.1635 18.194V18.1948Z",fill:"white"}),(0,o.jsx)("path",{d:"M17.1877 17.7582L5.7163 18.426C5.24727 18.459 4.83215 18.2997 4.84502 17.685V8.11764C4.84502 7.7894 5.11533 7.57942 5.4138 7.56413L17.3398 6.84891C17.6375 6.83362 17.8812 7.04924 17.8812 7.34771V16.932C17.8812 17.2828 17.7935 17.7341 17.1901 17.7574H17.1885L17.1877 17.7582Z",fill:"white"}),(0,o.jsx)("path",{d:"M8.39759 10.4651C7.83685 10.4997 7.64699 10.9277 7.64779 11.5858V11.7016C7.58102 11.7177 7.5247 11.7322 7.45712 11.7362C7.05326 11.7612 6.76203 11.4329 6.76123 10.844C6.76042 9.94293 7.56654 9.09577 9.10234 9.00003C10.47 8.91475 11.3453 9.57607 11.3469 10.7426C11.3469 11.6204 10.6196 12.2439 9.90282 12.4386C11.248 12.5045 11.8095 13.2551 11.8111 14.2141C11.8127 15.8546 10.614 16.7838 8.76445 16.8988L8.71939 16.9012C7.32921 16.9881 6.35334 16.4596 6.35254 15.5472C6.35254 15.0275 6.73227 14.5882 7.30427 14.552C7.34932 14.5488 7.39357 14.5577 7.43862 14.5553C7.55206 15.4837 8.18037 15.8256 8.80789 15.787C9.41288 15.7492 9.83846 15.3413 9.83846 14.7636V14.7403C9.83766 13.8392 9.08625 13.7942 7.9535 13.7491L7.77329 12.6743C8.8272 12.4812 9.35334 12.1369 9.35254 11.5134C9.35254 10.8432 8.98166 10.4273 8.3984 10.4643H8.39759V10.4651Z",fill:"black"}),(0,o.jsx)("path",{d:"M13.4544 10.0227C12.3338 10.3469 12.0868 9.85373 12.2091 9.33803C12.8816 9.18034 14.6298 8.65579 15.2911 8.41846L15.2992 15.3374L16.5212 15.5152C16.5212 15.9657 16.2638 16.2473 15.8044 16.2762C15.4231 16.2996 14.5373 16.3317 14.1117 16.3583C13.4504 16.3993 12.2396 16.4983 12.2396 16.4983C12.2058 16.4082 12.1946 16.3165 12.1946 16.2352C12.1946 16.0156 12.2839 15.7903 12.5751 15.6913L13.4601 15.4049L13.4536 10.0227H13.4544Z",fill:"black"})]}),(0,o.jsx)("defs",{children:(0,o.jsx)("clipPath",{id:"clip0_970_53429",children:(0,o.jsx)("rect",{width:"20",height:"20.7752",fill:"white"})})})]})})},600166:(e,t,n)=>{n.d(t,{h:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("openAsPage",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M3.22605 12.855C3.36623 12.9952 3.55957 13.0822 3.77226 13.0725L8.83802 13.0338C9.04103 13.0338 9.24405 12.9468 9.36973 12.8212C9.67425 12.5166 9.65975 12.1058 9.36973 11.8157C9.21988 11.6659 9.05553 11.6079 8.86702 11.6127L6.79818 11.6417L5.26105 11.7577L6.39215 10.7136L10.7087 6.39712L11.7528 5.26603L11.6319 6.80799L11.6029 8.87683C11.6029 9.06051 11.6561 9.22969 11.8059 9.37954C12.096 9.66956 12.5117 9.67923 12.8162 9.3747C12.9419 9.24902 13.0289 9.04601 13.024 8.84782L13.0675 3.77723C13.0724 3.56938 12.9902 3.3712 12.85 3.23102C12.7098 3.09084 12.5165 3.0135 12.3038 3.0135L7.23805 3.06184C7.03987 3.05701 6.83685 3.14401 6.71117 3.26969C6.40665 3.57422 6.41631 3.98992 6.70634 4.27994C6.85618 4.42979 7.02536 4.48296 7.20905 4.48296L9.27789 4.45396L10.8198 4.33311L9.68392 5.37237L5.36739 9.6889L4.32814 10.8248L4.44415 9.28769L4.47315 7.21886C4.47799 7.03034 4.41998 6.86599 4.27013 6.71615C3.98011 6.42612 3.56924 6.41162 3.26472 6.71615C3.13904 6.84182 3.05203 7.04484 3.05203 7.24786L3.00853 12.3088C3.0037 12.5263 3.08587 12.7148 3.22605 12.855Z"})})},199264:(e,t,n)=>{n.d(t,{W:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("options",{viewBox:"0 0 17 15",svg:(0,o.jsx)("path",{d:"M11.287 4.484c.844 0 1.57-.53 1.875-1.265h2.57c.391 0 .72-.344.72-.758 0-.414-.329-.75-.72-.75h-2.57A2.023 2.023 0 0 0 11.287.437c-.852 0-1.578.532-1.875 1.274H1.045a.744.744 0 0 0-.742.75.75.75 0 0 0 .742.758h8.367a2.044 2.044 0 0 0 1.875 1.265Zm0-1.062c-.539 0-.96-.43-.96-.961 0-.547.421-.969.96-.969.547 0 .961.422.961.969a.95.95 0 0 1-.96.96ZM1.021 6.586c-.39 0-.718.336-.718.75 0 .406.328.75.718.75h2.657A2.03 2.03 0 0 0 5.56 9.359c.843 0 1.57-.523 1.875-1.273h8.273a.744.744 0 0 0 .742-.75.744.744 0 0 0-.742-.75H7.436A2.032 2.032 0 0 0 5.56 5.32c-.852 0-1.579.524-1.883 1.266H1.02Zm4.54 1.719a.964.964 0 0 1-.97-.97c0-.546.43-.96.97-.96.539 0 .96.414.96.96 0 .54-.421.97-.96.97Zm5.726 5.93c.852 0 1.578-.532 1.875-1.274h2.57c.391 0 .72-.336.72-.75a.734.734 0 0 0-.72-.75h-2.57a2.023 2.023 0 0 0-1.875-1.274c-.844 0-1.578.532-1.875 1.274H1.045a.744.744 0 0 0-.742.75c0 .406.328.75.742.75h8.367a2.023 2.023 0 0 0 1.875 1.273Zm0-1.063c-.539 0-.96-.43-.96-.961 0-.547.421-.961.96-.961a.94.94 0 0 1 .961.96.95.95 0 0 1-.96.962Z"})})},233687:(e,t,n)=>{n.d(t,{A:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("pinStrikethrough",{viewBox:"0 0 15 19",svg:(0,o.jsx)("path",{d:"M3.094 1.328c0 .227.094.492.297.758.398.531 1.343 1.266 2.328 1.914l-.055.86 1.149 1.156.156-2.594c.008-.11-.008-.149-.086-.188-1.172-.601-2.078-1.312-2.14-1.468-.063-.102.007-.164.085-.164h6.68c.086 0 .148.062.086.164-.063.156-.961.867-2.14 1.468-.071.04-.087.079-.079.188l.234 3.875a7.12 7.12 0 00-1.437-.14h-.203l1.203 1.226c2.164.219 3.758 1.984 3.758 3.234 0 .04-.008.078-.008.117l.844.97c.257-.157.468-.477.468-.93 0-1.649-1.32-3.313-3.359-4.11L10.617 4c.992-.648 1.93-1.383 2.336-1.914.203-.266.297-.531.297-.758 0-.476-.367-.828-.914-.828H4.008c-.555 0-.914.352-.914.828zM.367 2.656l14.125 14.11a.603.603 0 00.852 0 .597.597 0 000-.852L1.227 1.804a.606.606 0 00-.86 0 .618.618 0 000 .852zm1.735 9.117c0 .665.445 1.102 1.148 1.102h4.234v3.648c0 1.196.493 2.188.688 2.188.195 0 .687-.992.687-2.188V12.97h.446L8.03 11.695H3.562c-.171 0-.257-.101-.226-.312.094-.875.828-1.805 1.984-2.399l-.82-.82c-1.477.867-2.398 2.234-2.398 3.61z"})})},429617:(e,t,n)=>{n.d(t,{m:()=>a});n(667294);var o=n(785893);const i={viewBox:"0 0 20 20",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M3 7.375h6.829a2.501 2.501 0 0 0 4.842 0H17a.625.625 0 1 0 0-1.25h-2.329a2.501 2.501 0 0 0-4.842 0H3a.625.625 0 1 0 0 1.25M12.25 5.5a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5"}),(0,o.jsx)("path",{fillRule:"evenodd",d:"M7.75 15.75a2.5 2.5 0 0 0 2.421-1.875H17a.625.625 0 1 0 0-1.25h-6.829a2.5 2.5 0 0 0-4.842 0H3a.625.625 0 1 0 0 1.25h2.329A2.5 2.5 0 0 0 7.75 15.75m0-1.25a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5",clipRule:"evenodd"})]})},a=(0,n(827282).IU)("sliders",i)},269309:(e,t,n)=>{n.d(t,{A:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("verified",{viewBox:"0 0 20 20",svg:(0,o.jsx)("path",{d:"M18.125 10C18.125 8.73755 17.1875 7.69692 15.9719 7.52817C16.2875 7.10942 16.4781 6.59067 16.4781 6.02505C16.4781 4.6438 15.3594 3.52505 13.9781 3.52505C13.4125 3.52505 12.8938 3.71567 12.475 4.0313C12.3063 2.81567 11.2656 1.87817 10.0031 1.87817C8.74063 1.87817 7.70001 2.81567 7.53126 4.0313C7.11251 3.71567 6.59376 3.52505 6.02813 3.52505C4.64688 3.52505 3.52813 4.6438 3.52813 6.02505C3.52813 6.59067 3.71876 7.10942 4.03438 7.52817C2.81876 7.69692 1.88126 8.73755 1.88126 10C1.88126 11.2625 2.81876 12.3032 4.03438 12.4719C3.71876 12.8907 3.52813 13.4094 3.52813 13.975C3.52813 15.3563 4.64688 16.475 6.02813 16.475C6.59376 16.475 7.11251 16.2844 7.53126 15.9688C7.70001 17.1844 8.74063 18.1219 10.0031 18.1219C11.2656 18.1219 12.3063 17.1844 12.475 15.9688C12.8938 16.2844 13.4125 16.475 13.9781 16.475C15.3594 16.475 16.4781 15.3563 16.4781 13.975C16.4781 13.4094 16.2875 12.8907 15.9719 12.4719C17.1875 12.3032 18.125 11.2625 18.125 10ZM9.06251 13.8251L5.62501 10.3875L6.95001 9.06255L9.06251 11.175L13.3625 6.87505L14.6875 8.20005L9.06251 13.8251Z"})})},283848:(e,t,n)=>{n.d(t,{E:()=>i});const o={aa:"Afar",ab:"Abkhazian",af:"Afrikaans",ak:"Akan",sq:"Albanian",am:"Amharic",ar:"Arabic",an:"Aragonese",hy:"Armenian",as:"Assamese",av:"Avaric",ae:"Avestan",ay:"Aymara",az:"Azerbaijani",ba:"Bashkir",bm:"Bambara",eu:"Basque",be:"Belarusian",bn:"Bengali",bh:"Bihari languages",bi:"Bislama",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan; Valencian",ch:"Chamorro",ce:"Chechen",zh:"Chinese",cu:"Church Slavic; Old Slavonic; Church Slavonic; Old Bulgarian; Old Church Slavonic",cv:"Chuvash",kw:"Cornish",co:"Corsican",cr:"Cree",cs:"Czech",da:"Danish",dv:"Divehi; Dhivehi; Maldivian",nl:"Dutch",dz:"Dzongkha",en:"English",eo:"Esperanto",et:"Estonian",ee:"Ewe",fo:"Faroese",fj:"Fijian",fi:"Finnish",fr:"French",fy:"Western Frisian",ff:"Fulah",ka:"Georgian",de:"German",gd:"Gaelic; Scottish Gaelic",ga:"Irish",gl:"Galician",gv:"Manx",el:"Greek, Modern (1453-)",gn:"Guarani",gu:"Gujarati",ht:"Haitian; Haitian Creole",ha:"Hausa",he:"Hebrew",hz:"Herero",hi:"Hindi",ho:"Hiri Motu",hr:"Croatian",hu:"Hungarian",ig:"Igbo",is:"Icelandic",io:"Ido",ii:"Sichuan Yi; Nuosu",iu:"Inuktitut",ie:"Interlingue; Occidental",ia:"Interlingua (International Auxiliary Language Association)",id:"Indonesian",ik:"Inupiaq",it:"Italian",jv:"Javanese",ja:"Japanese",kl:"Kalaallisut; Greenlandic",kn:"Kannada",ks:"Kashmiri",kr:"Kanuri",kk:"Kazakh",km:"Central Khmer",ki:"Kikuyu; Gikuyu",rw:"Kinyarwanda",ky:"Kirghiz; Kyrgyz",kv:"Komi",kg:"Kongo",ko:"Korean",kj:"Kuanyama; Kwanyama",ku:"Kurdish",lo:"Lao",la:"Latin",lv:"Latvian",li:"Limburgan; Limburger; Limburgish",ln:"Lingala",lt:"Lithuanian",lb:"Luxembourgish; Letzeburgesch",lu:"Luba-Katanga",lg:"Ganda",mk:"Macedonian",mh:"Marshallese",ml:"Malayalam",mi:"Maori",mr:"Marathi",ms:"Malay",mg:"Malagasy",mt:"Maltese",mn:"Mongolian",na:"Nauru",nv:"Navajo; Navaho",nr:"Ndebele, South; South Ndebele",nd:"Ndebele, North; North Ndebele",ng:"Ndonga",ne:"Nepali",nn:"Norwegian Nynorsk; Nynorsk, Norwegian",nb:"Bokmål, Norwegian; Norwegian Bokmål",no:"Norwegian",ny:"Chichewa; Chewa; Nyanja",oc:"Occitan (post 1500)",oj:"Ojibwa",or:"Oriya",om:"Oromo",os:"Ossetian; Ossetic",pa:"Panjabi; Punjabi",fa:"Persian",pi:"Pali",pl:"Polish",pt:"Portuguese",ps:"Pushto; Pashto",qu:"Quechua",rm:"Romansh",ro:"Romanian; Moldavian; Moldovan",rn:"Rundi",ru:"Russian",sg:"Sango",sa:"Sanskrit",si:"Sinhala; Sinhalese",sk:"Slovak",sl:"Slovenian",se:"Northern Sami",sm:"Samoan",sn:"Shona",sd:"Sindhi",so:"Somali",st:"Sotho, Southern",es:"Spanish",sc:"Sardinian",sr:"Serbian",ss:"Swati",su:"Sundanese",sw:"Swahili",sv:"Swedish",ty:"Tahitian",ta:"Tamil",tt:"Tatar",te:"Telugu",tg:"Tajik",tl:"Tagalog",th:"Thai",bo:"Tibetan",ti:"Tigrinya",to:"Tonga (Tonga Islands)",tn:"Tswana",ts:"Tsonga",tk:"Turkmen",tr:"Turkish",tw:"Twi",ug:"Uighur; Uyghur",uk:"Ukrainian",ur:"Urdu",uz:"Uzbek",ve:"Venda",vi:"Vietnamese",vo:"Volapük",cy:"Welsh",wa:"Walloon",wo:"Wolof",xh:"Xhosa",yi:"Yiddish",yo:"Yoruba",za:"Zhuang; Chuang",zu:"Zulu"};(0,n(696459).Yd)(o);function i(e){return o[e]}},201565:(e,t,n)=>{function o(e){return"none"!==e.role&&Boolean(!e.is_public_share_link||e.is_site)}n.d(t,{L:()=>o})},976102:(e,t,n)=>{n.d(t,{AI:()=>d,Zl:()=>s,_D:()=>r,dK:()=>u,dP:()=>c,pc:()=>m,t4:()=>l});n(821057),n(267602),n(653476),n(470928),n(241792),n(228244);var o=()=>n(326966),i=()=>n(629719),a=()=>n(122792);function r(e,t){return u(e.items,t.items).some((e=>{let[t,n]=e;return function(e,t){if(!e)return!1;if(!t)return!0;const n=i().H6(e),o=i().H6(t);if(!n||!o)return!1;return a().rC[n]>a().rC[o]}(t,n)}))}function s(e,t,n){let{trialEnd:o,items:i}=t;const a=i.map((t=>{const o=t.price.product,i=t.price.unitAmount.currencyCode,a=function(e,t){let{interval:n,product:o,currency:i}=t;const a=e.find((e=>e.product===o&&e.billingInterval===n&&e.unitAmount.currencyValue.currencyCode===i));return p(a,`Unable to find price with interval: ${n}, product: ${o}, currency: ${i}`)}(e,{interval:n,product:o,currency:i});return{...t,price:a}}));return{trialEnd:o,items:a}}function l(e,t){const n=e.items.filter((e=>i().tw(e)!==t));return{...e,items:n}}function d(e,t){const n=e.items.filter((e=>i().tw(e)!==i().tw(t)));return{...e,items:n.concat([t])}}function c(e,t,n){const{product:o,interval:a,currency:r}=n,s=function(e){if("personal_free"===e||"team_free"===e)return"free";return e}(o),l=t.items.filter((e=>i().tw(e)!==i().h_(s))),d=function(e,t){let{interval:n,product:o,currency:i}=t;const a=e.find((e=>e.price.product===o&&e.price.billingInterval===n&&e.price.unitAmount.currencyValue.currencyCode===i));return p(a,`Unable to find price with interval: ${n}, product: ${o}, currency: ${i}`)}(e,{interval:a,product:s,currency:r});return{...t,items:l.concat([d])}}function u(e,t){return(0,o().UV)(e,(e=>i().tw(e)),t,(e=>i().tw(e)))}function m(e){const{prices:t,billingData:n,product:o}=e,a=i().YF(n.subscription),r=i().Lg(n),s=i().Tz(r),l=i().Tz(n.subscription),d=s??l;return t.find((e=>e.product===o&&e.billingInterval===d&&e.unitAmount.currencyValue.currencyCode===a))}function p(e,t){if(null==e)throw new Error(t);return e}}}]);