"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[78275],{821444:(e,t,n)=>{n.r(t),n.d(t,{MidtermCheckoutModal:()=>ge});var i=n(667294),r=()=>n(219727),a=()=>n(142735),o=()=>n(629719),s=()=>n(921981),u=()=>n(247724),c=()=>n(661769),l=()=>n(897257),d=()=>n(28886),m=(n(267602),n(653476),n(241792),()=>n(846550)),p=()=>n(714230),f=()=>n(383802),g=(n(821057),n(470928),n(228244),()=>n(513670)),v=()=>n(696459),y=()=>n(326966),h=()=>n(58974),b=()=>n(681941),x=()=>n(122792);function w(e){return"trial"!==e.type&&"prorate_without_invoice"!==e.type&&"update_without_proration"!==e.type&&e.immediate.items.some((e=>e.price.unitAmount.amount>0))}function _(e,t,n,i,r,a){const s=(0,o().iv)(t),u=(0,h().pS)(t),c=a??function(e,t){const n=j(e,t),i=function(e,t){const n=Boolean(e.trialEnd),i=j(e,t);if(n&&!i)return!0;const r=(0,o().Tz)(e),a=(0,o().Tz)(t);if("month"===r&&"year"===a)return!0;if("year"===r&&"month"===a)return!1;const s=e.items.find((e=>(0,o().H6)(e))),u=t.items.find((e=>(0,o().H6)(e))),c=S(s,u),l=u&&0===u.price.unitAmount.amount;if(c&&!l)return!0;if(e.trialEnd&&I(e,t))return!0;return!1}(e,t),r=function(e,t){const n=(0,o().Tz)(e),i=(0,o().Tz)(t);if("month"===n&&"year"===i)return!0;const r=(0,o().dK)(e.items,t.items);return r.some((e=>{let[t,n]=e;const i=!t&&n,r=S(t,n),a=M(t,n)>0,o=n&&n.price.unitAmount.amount>0;return(i||r||a)&&o}))}(e,t);return n?"trial":i?"reset_and_invoice":r?"prorate_and_invoice":"prorate_without_invoice"}(s,n);if("reset_and_invoice"===c)return{type:"reset_and_invoice",immediate:{items:n.items.filter((e=>T(n,e)))},dunningCancellationTime:u};const l=function(e,t,n,i,r,a){const s=(0,o().Tz)(n),u=(0,o().Tz)(i);let c;c="trial"!==t&&"year"===s?"year":u??s;const l=C(n.items,"seats"),d=C(n.items,"public_domain_custom_hostnames"),m=(0,o().dK)(n.items,i.items),p={seats:{actual:r.numSeats,billed:l},public_domain_custom_hostnames:{actual:r.numCustomHostnames,billed:d}};return m.map((t=>{const n=function(e,t){let[n,i]=e;const r=(0,b().Lj)((n??i).price.product),{actual:a,billed:o}=t[r];return Math.max(a,o??0)}(t,p),o=function(e,t,n,i){let r,[a,o]=i;r=o&&S(a,o)?o.price:(a??o).price;return function(e,t,n){if(t.billingInterval===n)return t;const i=e.find((e=>e.product===t.product&&e.unitAmount.currencyCode===t.unitAmount.currencyCode&&e.billingInterval===n));if(!i)throw new Error(`Cannot find PriceData for stripe price id: ${t.externalId} at interval ${n}`);return i}(e,r,n)}(e,0,c,t),[s,u]=t,l=function(e,t){let[n,i]=e;const r=(0,b().Lj)((n??i).price.product);return function(e,t){switch(t){case"seats":return e.numSeats;case"public_domain_custom_hostnames":return e.numCustomHostnames;default:(0,v().t1)(t)}}(t,r)}(t,r),d=function(e,t,n,i){let{}=i;if(!n)return;if(!T(t,n))return;const r=n.price;if(b().Md.includes(r.externalId))return function(e,t){const n=e.find((e=>e.product===t.product&&e.unitAmount.currencyCode===t.unitAmount.currencyCode&&e.billingInterval===t.billingInterval));if(!n)throw new Error(`Cannot find current PriceData for stripe price id: ${t.externalId}`);return n}(e,r);return r}(e,i,u,a);return{immediate:{price:o,quantity:n},pending:(0,v().$K)(d)&&(0,v().$K)(l)&&l>0?{price:d,quantity:l}:void 0}}))}(e,c,s,n,i,r),d={items:(0,g().oA)(l.map((e=>e.immediate)))},m={items:(0,g().oA)(l.map((e=>e.pending)))},p=n.trialEnd??s.trialEnd;if("trial"===c){if(!p)throw new Error("cannot have trial without trialEnd");return{type:"trial",trialEnd:p,immediate:d,pending:m,dunningCancellationTime:u}}return{type:c,immediate:d,pending:m,dunningCancellationTime:u}}function j(e,t){const n=e.items.find((e=>(0,o().H6)(e))),i=S(n,t.items.find((e=>(0,o().H6)(e)))),r=n&&i||I(e,t);return Boolean(t.trialEnd||e.trialEnd)&&!r}function S(e,t){const n=(0,o().H6)(e)??"free",i=(0,o().H6)(t);return!!i&&x().rC[n]<x().rC[i]}function I(e,t){var n;const i=e.items.find((e=>"sites_custom_hostnames"===(0,o().tw)(e))),r=t.items.find((e=>"sites_custom_hostnames"===(0,o().tw)(e))),a=null===(n=r??i)||void 0===n?void 0:n.price;return!(!a||0===a.unitAmount.amount)&&M(i,r)>0}function M(e,t){return null!=e&&e.price.product&&"seats"===(0,b().Lj)(null==e?void 0:e.price.product)||null!=t&&t.price.product&&"seats"===(0,b().Lj)(null==t?void 0:t.price.product)?0:((null==t?void 0:t.quantity)??0)-((null==e?void 0:e.quantity)??0)}function C(e,t){return(0,y().Wo)(e.filter((e=>(0,b().Lj)(e.price.product)===t)).map((e=>e.quantity)),"A subscription should have a consistent quantity across all its items.")}function T(e,t){if("sites_custom_hostnames"!==(0,o().tw)(t))return!0;const n=e.items.find((e=>(0,o().H6)(e)));return(0,x().sX)((0,o().H6)(n))}var D=()=>n(948505),E=()=>n(788860),A=()=>n(785673),P=()=>n(212493),B=()=>n(666414),H=()=>n(518242),L=()=>n(661641),z=()=>n(916095),q=()=>n(768064),k=()=>n(575154),O=()=>n(688862),U=()=>n(565577),V=()=>n(112339),N=()=>n(525043),$=()=>n(92110),K=(n(731107),()=>n(146947)),Z=()=>n(646574),X=()=>n(976102),W=()=>n(824462),Y=()=>n(728779),R=()=>n(576387),F=()=>n(30795),Q=n(785893);function G(e){let{environment:t,currencyValue:n,address:r,lineItems:a,taxableAmount:o,billingData:s}=e;const[u,c]=(0,i.useState)(0),[l,d]=(0,i.useState)(!1);return(0,i.useEffect)((()=>{!async function(){if(!r||0===a.length||0===o.amount)return;d(!0);const e=await(0,q().km)({environment:t,taxableAmount:o,lineItems:a,address:r,billingData:s});c(e??0),d(!1)}()}),[t,o,a,r,s]),{tax:new(D().n)(n,u),isLoading:l}}var J=()=>n(799891),ee=()=>n(979614),te=()=>n(587510),ne=()=>n(498854),ie=()=>n(38812),re=()=>n(939985),ae=()=>n(662037);function oe(e){let{desiredState:t,subscription:n,spaceStore:a,showTrialEndDisclaimer:s,modalId:u,primaryButtonText:c}=e;const l=(0,r().O7)(),m=(0,E().YB)(),[p,f]=i.useState(void 0),[g,v]=i.useState(!1);return(0,Q.jsx)(ae().R,{textAlign:"center",primaryButtons:[{buttonType:"primary",label:c??(0,Q.jsx)(E()._H,{id:"subscriptionUpdateModal.confirmationButton",defaultMessage:"Confirm changes"}),onClick:async()=>{ee().nd(l,{modalId:u}),v(!0);const e=await(0,ie().getStripe)();if(!e)return(0,J().log)({level:"error",from:"MidtermCheckoutModal",type:"StripeError",error:{miscDataString:"Stripe elements not initialized when user tried to upgrade"}}),f(m.formatMessage({id:"spaceSubscriptionUpgradeModal.stripeNotLoaded",defaultMessage:"We could not reach our payment processor. Please reload the page or try again later."})),void v(!1);if((0,te().Pz)({environment:l,currentState:n,desiredState:t})){if(!(await(0,re().D)(l)))return void v(!1)}const i=await async function(e){let{environment:t,spaceStore:n,desiredState:i,stripe:r,coupon:a,intl:o}=e;try{const e=await R().Mg({environment:t,from:"midterm_checkout_modal",spaceStore:n,desiredState:i,inAppOffer:a});await R().KD({paymentIntentData:e,stripe:r,onSuccess:()=>{(0,R().zb)(t,Y().i)}})}catch{return{error:o.formatMessage({id:"spaceSubscriptionUpgradeModal.payment.genericError",defaultMessage:"Your payment could not be processed. Please try again."})}}}({environment:l,spaceStore:a,desiredState:t,stripe:e,intl:m});if(null!=i&&i.error)return f(i.error),void v(!1);(0,d().z)(l,u)},baseStyleOverride:{borderRadius:8},isDisabled:g,isLoading:g}],termsOfService:(0,Q.jsx)(ne().E,{products:(0,o().zq)(t),showTrialEndDisclaimer:s}),error:p})}var se=()=>n(668001),ue=()=>n(632752),ce=()=>n(702548),le=()=>n(724791);function de(e){let{immediate:t,recurring:n,nextBillingDate:a,accountBalance:o,items:s,chargeType:u={chargeType:"immediate"},modalId:c}=e;const l=(0,r().O7)(),[d,p]=(0,i.useState)(!1),g=(0,m().yK)((e=>({summaryContainer:{background:e.surface.wash,padding:16,borderRadius:8}})),[]),v=t.subtotal.plus(t.tax),y=new(D().n)(f().X[n.subtotal.currencyCode],0),h=(0,$().c)({subtotal:n.subtotal,discount:y,balance:o},n.tax),b=0!==h.amount&&0!==v.amount&&h.amount!==v.amount,[x,w,_]="immediate"===u.chargeType?[v,t.subtotal,t.tax]:[h,n.subtotal,n.tax];return(0,Q.jsxs)(P().jX,{gap:8,children:[(0,Q.jsx)(le().Mq,{useNewStyle:!0,isTotalLoading:t.isLoading,total:x,handleToggleExpanded:()=>{d?ee().k1(l,{modalId:c}):ee().y$(l,{modalId:c}),p(!d)},isExpanded:d,discount:y,accountBalance:o,subtitle:"immediate"===u.chargeType?(0,Q.jsx)(me,{recurringTotal:h,periodEnd:a,isNextBillDifferent:b,isLoading:n.isLoading||t.isLoading}):null,...u}),(0,Q.jsx)(le().MA,{isExpanded:d,children:(0,Q.jsxs)(P().jX,{gap:8,style:g.summaryContainer,children:[b?(0,Q.jsx)(L().q,{styleName:"UISmall-12px/Medium",colorName:"secondary",children:(0,Q.jsx)(E()._H,{id:"checkout.orderSummary.title",defaultMessage:"Prorated charge"})}):null,(0,Q.jsxs)(P().jX,{gap:12,children:[(0,Q.jsx)(le().tQ,{items:s,showMonthlyPricing:!1}),(0,Q.jsx)(B().Z,{size:1}),(0,Q.jsx)(le().J0,{subtotal:w,subtotalText:b?(0,Q.jsx)(E()._H,{id:"checkout.orderSummary.subtotalProrated",defaultMessage:"Subtotal (prorated)"}):void 0,discount:y,showDiscountLine:!1,accountBalance:o,tax:_})]})]})})]})}function me(e){let{recurringTotal:t,periodEnd:n,isLoading:i,isNextBillDifferent:r}=e;return i?(0,Q.jsx)(se().Z,{style:{width:180,height:16,borderRadius:4}}):r?(0,Q.jsxs)(P().jX,{direction:"row",gap:4,align:"center-left",children:[(0,Q.jsx)(E()._H,{id:"checkout.orderSummary.estimatedBill",defaultMessage:"Estimated next bill: {price}",values:{price:(0,Q.jsx)(ce().W,{cost:t,trailingZeroDisplay:"stripIfInteger"})}}),(0,Q.jsx)(ue().p,{tooltipTitle:(0,Q.jsx)(E()._H,{id:"checkout.orderSummary.estimatedBillTooltip",defaultMessage:"This is an estimate of your next charge on {date}. If you add/remove members, this amount might change",values:{date:(0,Z().ZW)({value:n,preset:"medium",locale:K().locale})}}),tooltipDescription:(0,Q.jsx)(E()._H,{id:"checkout.orderSummary.estimatedBillTooltipDescription",defaultMessage:"Click to learn more about billing"}),buttonProps:{href:"https://www.notion.com/help/billing-and-payment-info",external:!0},tooltipWidth:240})]}):null}function pe(e){let{desiredProducts:t,desiredInterval:n,billingData:s,subscription:u,subscriptionData:c,spaceStore:l,modalId:d,prices:y}=e;const h=(0,r().O7)(),x=(0,m().yK)((()=>({headerImage:{width:49,height:52}})),[]),j=(0,m().Fg)(),S=(0,o().YF)(u)??"USD",I=f().X[S],M=(0,U().Et)(c,I),{desiredState:C,quantities:T,newItems:Y}=function(e){let{desiredProducts:t,desiredInterval:n,billingData:r,subscriptionData:a,prices:s}=e;const u=(0,o().YF)(r.subscription)??"USD",c=(0,i.useMemo)((()=>(0,o().Lg)(r)),[r]),l=(0,F().V)(a),d=(0,i.useMemo)((()=>{var e;return{numSeats:l,numCustomHostnames:(null===(e=(0,o().a7)(r.subscription,"sites_custom_hostnames"))||void 0===e?void 0:e.quantity)??0}}),[r.subscription,l]),m=(0,i.useMemo)((()=>{const e=(0,g().oA)(t.map((e=>s.find((t=>t.product===e&&t.billingInterval===n)))));return 0===e.length?[]:(0,b().Vj)({prices:e,quantity:d.numSeats,domainsQuantity:d.numCustomHostnames})}),[n,t,s,d]),p=(0,i.useMemo)((()=>t.reduce(((e,t)=>(0,X().dP)(m,e,{interval:n,currency:u,product:t})),c)),[t,c,m,n,u]),f=(0,i.useMemo)((()=>(0,g().mz)(p.items,c.items,"price.externalId")),[p.items,c]);return{desiredState:p,quantities:d,newItems:f}}({desiredProducts:t,desiredInterval:n,billingData:s,subscriptionData:c,prices:y}),R=(0,i.useMemo)((()=>function(e,t){return((null==t?void 0:t.items)??[]).reduce(((e,t)=>{const n=(0,o().uD)(t.price);return e.plus(n.getCostPerBillingInterval({quantity:t.quantity}))}),new(D().n)(e,0))}(I,C)),[I,C]),J=(0,i.useMemo)((()=>C.items.map(q().zW).filter(v().$K)),[C.items]),{tax:ee,isLoading:te}=G({environment:h,currencyValue:I,address:s.address,lineItems:J,taxableAmount:R,billingData:s}),{subtotal:ne,lineItems:ie,isLoading:re}=function(e){const{spaceStore:t,quantities:n,desiredState:o,currencyValue:s}=e,u=(0,a().VK)((()=>t.id),[t]),c=(0,r().O7)(),[l,d]=(0,i.useState)(),[m,p]=(0,i.useState)(),[f,g]=(0,i.useState)(!1);return(0,i.useEffect)((()=>{!async function(){var e;g(!0);const t=await W().callApi({eventName:"getImmediateUpdateCost",environment:c,data:{spaceId:u,quantities:n,desiredState:{items:(null==o?void 0:o.items.map((e=>({id:e.id,quantity:e.quantity,priceData:{external_id:e.price.externalId,product:e.price.product,billing_interval:e.price.billingInterval,currency:e.price.unitAmount.currencyCode,unit_amount:e.price.unitAmount.amount,state:e.price.state}}))))||[],trialEnd:null===(e=o.trialEnd)||void 0===e?void 0:e.toString()}}});g(!1),"success"===t.type&&(d(D().n.fromValue(t.data.total)),p(t.data.lineItems))}()}),[c,null==o?void 0:o.items,n,u,null==o?void 0:o.trialEnd]),{subtotal:l??new(D().n)(s,0),lineItems:m,isLoading:f}}({spaceStore:l,quantities:T,desiredState:C,currencyValue:I}),ae=(0,i.useMemo)((()=>ie&&(0,v().Of)(ie)?ie.map((e=>(0,q().yA)({line:e}))):[]),[ie]),{tax:se,isLoading:ue}=G({environment:h,currencyValue:I,address:s.address,lineItems:ae,taxableAmount:ne??new(D().n)(I,0),billingData:s}),ce=_(y,s,C,T,{}),le=(0,o().lx)(u)&&"reset_and_invoice"===ce.type,me=function(e){let{change:t,interval:n,currentPeriodEnd:i,now:r}=e;return function(e){return"reset_and_invoice"===e.type}(t)&&n?r.plus({months:"month"===n?1:12}):i}({change:ce,interval:(0,o().Tz)(C),currentPeriodEnd:u.currentPeriodEnd,now:s.clock.now}),pe=(0,i.useMemo)((()=>(0,O().ig)(s)?(0,g().mz)(ce.immediate.items,u.items,"price.externalId"):Y),[s,ce.immediate.items,u.items,Y]),fe=t[0],ge=!(0,O().ig)(s)&&n!==(0,o().Tz)(u),ve=ge?function(e){let{interval:t,effectiveDate:n}=e;return{title:(0,Q.jsx)(E()._H,{id:"midtermIntervalChange.title",defaultMessage:"Switch to {interval, select, month {monthly} other {annual}} billing",values:{interval:t}}),subtitle:n?(0,Q.jsx)(E()._H,{id:"midtermIntervalChange.subtitle.nextPeriod",defaultMessage:"Effective {periodEnd}",values:{periodEnd:(0,Z().ZW)({value:n,preset:"medium",locale:K().locale})}}):(0,Q.jsx)(E()._H,{id:"spaceSubscriptionUpgradeModal.effectiveToday.header",defaultMessage:"Effective today"})}}({interval:n,effectiveDate:w(ce)?void 0:me}):(0,$().We)({product:fe});return(0,Q.jsxs)(P().jX,{gap:28,padding:"28px 32px",children:[(0,Q.jsx)(V().M,{...ve,title:(0,Q.jsx)(L().q,{styleName:"Title-Large-26px/Bold",colorName:"primary",children:ve.title}),image:ge?(0,Q.jsx)(H().ZP,{src:"light"===j.mode?p().Z.images.pricing.light.changeBillingPeriodPng:p().Z.images.pricing.dark.changeBillingPeriodPng,style:x.headerImage}):"ai"===fe?(0,Q.jsx)(A().fy,{variant:"medium",style:{}}):(0,Q.jsx)(k().q,{product:fe})}),(0,Q.jsx)(N().r,{billingData:s}),(0,Q.jsxs)(P().jX,{gap:20,children:[(0,Q.jsx)(B().Z,{size:1}),(0,Q.jsx)(de,{immediate:{subtotal:ne,tax:se,isLoading:ue||re},recurring:{subtotal:R,tax:ee,isLoading:te},nextBillingDate:me,accountBalance:M,items:pe,chargeType:w(ce)?{chargeType:"immediate"}:{chargeType:"nextPeriod",periodEnd:me},modalId:d}),(0,Q.jsx)(oe,{desiredState:C,subscription:u,spaceStore:l,showTrialEndDisclaimer:le,modalId:d,primaryButtonText:ge?void 0:(0,Q.jsx)(E()._H,{id:"subscriptionUpgradeModal.upgradeButton.upgradeAi",defaultMessage:"Upgrade now"})})]}),(0,Q.jsx)(z().U4,{style:{top:16,right:16}})]})}var fe=()=>n(563460);function ge(e){let{spaceStore:t}=e;const n=(0,r().O7)(),i=(0,c().pQ)({spaceId:t.id}),m=(0,c().h1)(),p=(0,a().Kw)(l().subscriptionDataStoreInstance),f=(0,a().VK)((()=>fe().Z.state),[]);if(!(i&&i.subscription&&f.open&&p&&0!==m.length))return null;const g=i.subscription,v=(0,o().Lg)(i),y=f.desiredProducts??(0,o().zq)(v),h=f.desiredInterval??(0,o().Tz)(v)??(0,o().Tz)(g)??"month";return(0,Q.jsx)(s().c,{ariaLabelledBy:u().BaY,isOpen:!0,onDismiss:()=>(0,d().z)(n,f.modalId),animateSizeTransition:!1,areaConstraint:{width:{type:"min",length:480},height:{type:"unlimited",scroll:"allow"}},render:()=>(0,Q.jsx)(pe,{desiredProducts:y,desiredInterval:h,billingData:i,subscription:g,subscriptionData:p,spaceStore:t,modalId:f.modalId,prices:m})})}},939985:(e,t,n)=>{n.d(t,{D:()=>v});n(667294);var i=()=>n(824462),r=()=>n(771474),a=()=>n(631842),o=()=>n(594546),s=()=>n(876822),u=()=>n(605716),c=()=>n(788860),l=()=>n(830581),d=()=>n(765513),m=()=>n(148126),p=n(785893);function f(e){let{onAccept:t}=e;return(0,p.jsx)(l().sR,{header:(0,p.jsx)(l().vI,{iconAndTitle:(0,p.jsx)(l().kC,{iconGroup:u().h,iconColorName:"uiRedPrimary",title:(0,p.jsx)(c()._H,{id:"voidOfferModal.title",defaultMessage:"Are you sure?"})}),description:(0,p.jsx)(c()._H,{id:"voidOfferModal.subtitle",defaultMessage:"If you continue, your current discount will no longer be applied. See <terms>terms and conditions</terms> for more information.",values:{terms:e=>(0,p.jsx)(d().Z,{external:!0,href:(0,m().UY)("resurrectionLearnMore"),children:e})}})}),footer:(0,p.jsx)(l().a6,{layout:"vertical",primaryButtons:[{buttonType:"destructive",label:(0,p.jsx)(c()._H,{id:"voidOfferModal.primaryAction",defaultMessage:"Yes and remove discount"}),onClick:t}],secondaryButtons:[{buttonType:"dismiss",label:(0,p.jsx)(c()._H,{id:"voidOfferModal.cancelButton",defaultMessage:"Cancel"})}]})})}const g=406;async function v(e){var t;const n=null===(t=s().default.state.currentSpaceStore)||void 0===t?void 0:t.id;return await a().o.showAsyncModal((t=>(0,p.jsx)(r().c,{isOpen:t.isOpen,onDismiss:()=>{(0,o().j)({environment:e,event:{eventName:"void_offer_modal_dismiss",eventProperties:{}}}),t.onDismiss()},onClosed:t.onClosed,areaConstraint:{width:{type:"min",length:g},height:{type:"unlimited",scroll:"allow"}},render:()=>(0,p.jsx)(f,{onAccept:async()=>{(0,o().j)({environment:e,event:{eventName:"void_offer_modal_accept",eventProperties:{}}}),n&&await i().callApi({eventName:"voidCustomerOffer",environment:e,data:{spaceId:n}}),t.resolve("accepted")}})})))}},976102:(e,t,n)=>{n.d(t,{AI:()=>c,Zl:()=>s,_D:()=>o,dK:()=>d,dP:()=>l,pc:()=>m,t4:()=>u});n(821057),n(267602),n(653476),n(470928),n(241792),n(228244);var i=()=>n(326966),r=()=>n(629719),a=()=>n(122792);function o(e,t){return d(e.items,t.items).some((e=>{let[t,n]=e;return function(e,t){if(!e)return!1;if(!t)return!0;const n=r().H6(e),i=r().H6(t);if(!n||!i)return!1;return a().rC[n]>a().rC[i]}(t,n)}))}function s(e,t,n){let{trialEnd:i,items:r}=t;const a=r.map((t=>{const i=t.price.product,r=t.price.unitAmount.currencyCode,a=function(e,t){let{interval:n,product:i,currency:r}=t;const a=e.find((e=>e.product===i&&e.billingInterval===n&&e.unitAmount.currencyValue.currencyCode===r));return p(a,`Unable to find price with interval: ${n}, product: ${i}, currency: ${r}`)}(e,{interval:n,product:i,currency:r});return{...t,price:a}}));return{trialEnd:i,items:a}}function u(e,t){const n=e.items.filter((e=>r().tw(e)!==t));return{...e,items:n}}function c(e,t){const n=e.items.filter((e=>r().tw(e)!==r().tw(t)));return{...e,items:n.concat([t])}}function l(e,t,n){const{product:i,interval:a,currency:o}=n,s=function(e){if("personal_free"===e||"team_free"===e)return"free";return e}(i),u=t.items.filter((e=>r().tw(e)!==r().h_(s))),c=function(e,t){let{interval:n,product:i,currency:r}=t;const a=e.find((e=>e.price.product===i&&e.price.billingInterval===n&&e.price.unitAmount.currencyValue.currencyCode===r));return p(a,`Unable to find price with interval: ${n}, product: ${i}, currency: ${r}`)}(e,{interval:a,product:s,currency:o});return{...t,items:u.concat([c])}}function d(e,t){return(0,i().UV)(e,(e=>r().tw(e)),t,(e=>r().tw(e)))}function m(e){const{prices:t,billingData:n,product:i}=e,a=r().YF(n.subscription),o=r().Lg(n),s=r().Tz(o),u=r().Tz(n.subscription),c=s??u;return t.find((e=>e.product===i&&e.billingInterval===c&&e.unitAmount.currencyValue.currencyCode===a))}function p(e,t){if(null==e)throw new Error(t);return e}}}]);