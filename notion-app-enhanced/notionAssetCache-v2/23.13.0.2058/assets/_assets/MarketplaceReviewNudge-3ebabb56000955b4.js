"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[76317],{173885:(e,t,i)=>{i.r(t),i.d(t,{MarketplaceReviewNudge:()=>p});var a=i(667294),n=()=>i(846550),s=()=>i(788860),r=()=>i(369637),o=()=>i(348141),d=()=>i(661641),c=()=>i(594546),l=()=>i(749826),u=()=>i(275066),g=i(785893);const m="marketplace_review_modal_toast";function v(e){let{acquisitionId:t,listingId:n}=e;const d=(0,s().YB)(),u=(0,i(219727).O7)(),[v,p]=(0,a.useState)(!1),{onRatingConfirmed:w,onSubmit:f,error:I,isLoading:_}=(0,i(90912).Y)({acquisitionId:t,source:"nudge"});return(0,a.useEffect)((()=>{(0,c().j)({environment:u,event:{eventName:"marketplace_review_nudge",eventProperties:{action:"show"}}}),l().default.logEvent("marketplace_review_nudge","show")}),[u]),(0,a.useEffect)((()=>{v||r().MV({id:m,presentationType:"persistent",title:d.formatMessage({id:"marketplace.reviews.nudge.title",defaultMessage:"Enjoying this template?"}),message:(0,g.jsx)(h,{onRatingConfirmed:w,error:I}),onUserDismiss:()=>{o().ei(u,{listingId:n}),(0,c().j)({environment:u,event:{eventName:"marketplace_review_nudge",eventProperties:{action:"dismiss"}}}),l().default.logEvent("marketplace_review_nudge","dismiss")},actions:{primary:{title:d.formatMessage({id:"marketplace.reviews.nudge.submit",defaultMessage:"Submit"}),onAction:async()=>{try{await f(),p(!0),o().ei(u,{listingId:n}),r().Xd(m),i(367666).Z.openModal({stage:"details",acquisitionId:t,source:"nudge"}),(0,c().j)({environment:u,event:{eventName:"marketplace_review_nudge",eventProperties:{action:"rate"}}}),l().default.logEvent("marketplace_review_nudge","rate")}catch(e){}},isLoading:_,disabled:Boolean(I)}}})}),[d,u,t,n,I,_,f,w,v]),null}const p=(0,a.memo)(v);function h(e){let{onRatingConfirmed:t,error:i}=e;const a=(0,s().YB)(),r=(0,n().yK)((()=>({container:{display:"flex",flexDirection:"column",gap:"8px",alignItems:"center"}})),[]);return(0,g.jsxs)("div",{style:r.container,children:[(0,g.jsx)(d().q,{styleName:"UISmall-12px/Medium",children:a.formatMessage({id:"marketplace.reviews.nudge.body",defaultMessage:"Leave a review for the community!"})}),(0,g.jsx)(u().d,{onRatingConfirmed:t,error:i})]})}},367666:(e,t,i)=>{i.d(t,{Z:()=>s});const a={reviewIdCache:{},isOpen:!1,acquisitionId:"",stage:"rating",rating:0,source:void 0};class n extends(()=>i(263184))().default{getInitialState(){return{...a}}setReviewId(e,t){this.setState({...this.state,reviewIdCache:{...this.state.reviewIdCache,[e]:t}})}getReviewId(e){return this.state.reviewIdCache[e]}openModal(e){let{stage:t,acquisitionId:i,rating:n,source:s}=e;this.setState({...a,reviewIdCache:this.state.reviewIdCache,isOpen:!0,acquisitionId:i,stage:t,rating:n||0,source:s})}closeModal(){this.setState({...a,reviewIdCache:this.state.reviewIdCache})}updateState(e){this.setState({...this.state,...e})}}const s=new n}}]);