"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[44832],{679791:(e,t,o)=>{o.d(t,{m:()=>Xn});var n=o(667294),r=()=>o(142735),i=()=>o(125659),l=()=>o(589024),a=()=>o(219727),s=()=>o(846550),c=()=>o(659089),u=()=>o(532850),d=()=>o(984851),p=()=>o(425803),y=()=>o(96778),m=()=>o(356321),f=()=>o(603885),h=()=>o(991333),x=()=>o(10066),S=o(785893);const v=n.memo((0,n.forwardRef)((function(e,t){const{store:o,collectionStore:i,buttonStyle:l,onContextMenu:a,quickActionButtons:d,property:m}=e,{baseStyles:f}=(0,n.useContext)(y().OU),h=(0,r().VK)((()=>{var e;const t=o.getPropertyValue(m),n=null==i||null===(e=i.getRecordKeyStore())||void 0===e?void 0:e.getRecordKey(),r=(0,u().ah)(t);return void 0===r?"...":(0,c().wf)(n,r)}),[i,m,o]),v=(0,s().yK)((()=>({buttonStyle:{...f.buttonStyle,...l},buttonPressedStyle:f.buttonPressedStyle??{},buttonHoveredStyle:f.buttonHoveredStyle??{}})),[f.buttonHoveredStyle,f.buttonPressedStyle,f.buttonStyle,l]);return(0,S.jsx)(p().e,{ref:t,style:v.buttonStyle,hoveredStyle:v.buttonHoveredStyle,pressedStyle:v.buttonPressedStyle,onContextMenu:a,quickActionButtons:d,editButtonClickProps:void 0,children:(0,S.jsx)(x().Y,{fontColor:"light",children:h})})}))),b=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,l=(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Page].text}})),[]),a=(0,n.useMemo)((()=>(0,S.jsx)(d().q,{store:o,property:r,format:i})),[i,r,o]),c=T(e,t,l);return(0,S.jsx)(v,{...c,quickActionButtons:a})})),g=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l}=(0,a().Fy)(),c=(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Table].text}})),[]),u=(0,n.useMemo)((()=>{if(!l)return(0,S.jsx)(d().q,{store:o,property:r,format:i},"copy")}),[i,l,r,o]),p=T(e,t,c);return(0,S.jsx)(v,{...p,quickActionButtons:u})})),C=(0,n.forwardRef)((function(e,t){const{store:o,property:i,format:l}=e,c=(0,a().Fy)(),u=(0,r().VK)((()=>c.isMobile),[c.isMobile]),p=T(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.CompactPage].text}})),[])),y=(0,n.useMemo)((()=>{if(!u)return(0,S.jsx)(d().q,{store:o,property:i,format:l},"copy")}),[l,u,i,o]);return(0,S.jsx)(v,{...p,quickActionButtons:y})})),k=(0,n.forwardRef)((function(e,t){const o=T(e,t);return(0,S.jsx)(v,{...o})})),w=(0,n.forwardRef)((function(e,t){const o=T(e,t,(0,h().m)(t,e.collectionStore,e.property,"auto_increment_id"));return(0,S.jsx)(v,{...o})})),P=(0,n.forwardRef)((function(e,t){const o=T(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Board].text}})),[]));return(0,S.jsx)(v,{...o})})),j=(0,n.forwardRef)((function(e,t){const o=T(e,t);return(0,S.jsx)(v,{...o})})),_=(0,n.forwardRef)((function(e,t){const o=T(e,t);return(0,S.jsx)(v,{...o})})),R=(0,n.forwardRef)((function(e,t){const o=T(e,t);return(0,S.jsx)(v,{...o})})),B=(0,n.forwardRef)((function(e,t){const o=T(e,t);return(0,S.jsx)(v,{...o})})),M=(0,n.forwardRef)((function(e,t){const o=T(e,t);return(0,S.jsx)(v,{...o})}));function T(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l}=e;return{ref:t,store:n,collectionStore:r,property:i,onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle}}var V=()=>o(788860),E=()=>o(696459),I=()=>o(285755),A=()=>o(141735),O=()=>o(985575),K=()=>o(527278),F=()=>o(677559),U=()=>o(826955),L=()=>o(6254),H=()=>o(661297),W=()=>o(654133);const D=n.memo((0,n.forwardRef)((function(e,t){const{store:i,property:l,collectionStore:c,buttonStyle:u,innerButtonStyle:d,onContextMenu:m,disabled:f}=e,[h,x]=(0,n.useState)(!1),v=(0,a().O7)(),{baseStyles:b,propertySchema:g,collectionContextStore:C}=(0,n.useContext)(y().OU),k=g,w=(null==b?void 0:b.sizing)??"default",{value:P}=(0,F().XJ)(A().F.formulas),{value:j}=(0,F().XJ)(I().Sm.automationTypecheck),{value:_}=(0,F().XJ)(I().Sm.automationActionRegistry),R=(0,r().VK)((()=>null==C?void 0:C.settingsStore),[C]),B=(0,r().VK)((()=>{const e=v.currentUser.id;if(!(P&&j&&_&&C&&"button"===(null==k?void 0:k.type)&&k.automation_id&&i.isPageBlock()))return;const t=U().Mz.createChildStore(c,{table:o(494616).cv,id:k.automation_id,spaceId:c.getSpaceId()});return{type:"button_property",persisted:!0,automationStore:t,collectionContextStore:C,propertyId:l,propertySchema:k,intl:K().Z.getIntl(),parentRecordStore:t,currentUserId:e,pageStore:i,formulasModule:P,isLoggedIn:v.currentUser.isLoggedIn(),automationTypecheckModule:j,automationActionRegistryModule:_}}),[C,c,v.currentUser,P,l,k,i,j,_]),{isDisabled:M,hasError:T}=(0,r().VK)((()=>{if(!B)return{isDisabled:!0,hasError:!1};const e=(0,O().Gb)({environment:v,...B}).state,t="sufficient"===e.executionPermissionStatus;return{isDisabled:f||!t||!i.canEdit()||h,hasError:(0,E().$K)(e.typecheckResult)&&o(855741).x.isSuccess(e.typecheckResult)&&(0,o(473304).wy)(e.typecheckResult.value)}}),[v,f,B,i,h]),D=(0,n.useCallback)((async()=>{if(B)if(T)C&&R&&k&&o(915687).b({environment:v,mode:"edit_button_property",collectionSettingsStore:R,collectionContextStore:C,propertyId:l,propertySchema:k});else try{var e;x(!0);const{automationExecutionActions:t}=await I().Sm.automations.load();await t.executeClientAutomation({environment:v,clientContext:B}),null!==(e=v.mobileNative)&&void 0!==e&&e.buzz?v.mobileNative.buzz():window.navigator.vibrate(20)}finally{x(!1)}}),[B,C,R,v,T,l,k]),Z=(0,r().VK)((()=>(null==B?void 0:B.automationStore.getNameStore().getValue())??(null==k?void 0:k.name)),[null==B?void 0:B.automationStore,null==k?void 0:k.name]),q=(0,r().VK)((()=>{if(!v.device.isMobile)return(0,O().JS)(null==B?void 0:B.automationStore)}),[B,v]),z=!Z||0===Z.length,N=(0,s().yK)((e=>({textStyle:{...b.textStyle,color:e.lightTextColor},buttonStyle:{...b.buttonStyle,...u},buttonPressedStyle:b.buttonPressedStyle??{},buttonHoveredStyle:b.buttonHoveredStyle??{},innerButtonStyle:{pointerEvents:"auto",overflow:"hidden",height:"small"===w?20:24,paddingLeft:6,paddingRight:6,...d},innerButtonLabelStyle:{overflow:"hidden",textOverflow:"ellipsis",color:z?e.lightTextColor:void 0},innerButtonLabelPlaceholderStyle:{color:e.lightTextColor},buttonColors:(0,o(568017).p6)("default",e)})),[b.buttonHoveredStyle,b.buttonPressedStyle,b.buttonStyle,b.textStyle,u,d,z,w]),Q=e=>(0,S.jsx)(H().Z,{backgroundColor:N.buttonColors.background,disabled:M,disabledFeedback:!0,hoveredBackgroundColor:N.buttonColors.hoveredBackground,size:"sm",onClick:D,pressedBackgroundColor:N.buttonColors.pressedBackground,style:N.innerButtonStyle,...e,children:(0,S.jsx)("span",{style:N.innerButtonLabelStyle,children:z?(0,S.jsx)(V()._H,{...L().y.buttonPlaceholder}):Z})});return(0,S.jsx)(p().e,{ref:t,style:N.buttonStyle,hoveredStyle:N.buttonHoveredStyle,pressedStyle:N.buttonPressedStyle,editButtonClickProps:void 0,onContextMenu:m,tooltipHide:(0,E().$K)(q),children:T?(0,S.jsx)(W().Z,{placement:o(998901).Placement.Right,renderTooltip:()=>(0,S.jsx)(I().qG,{content:(0,S.jsx)(V()._H,{...o(475692).Z.buttonPropertyErrorTooltip}),subtitle:(0,S.jsx)(V()._H,{...L().y.clickToEdit})}),render:Q}):q?(0,S.jsx)(I().qH,{parentStore:i,urlToPreview:q,renderOrigin:Q}):Q()})}))),Z=(0,n.forwardRef)((function(e,t){const o=te(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Table].button},innerButtonStyle:{maxWidth:"100%"}})),[]));return(0,S.jsx)(D,{...o})})),q=(0,n.forwardRef)((function(e,t){const o=te(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Page].button}})),[]));return(0,S.jsx)(D,{...o})})),z=(0,n.forwardRef)((function(e,t){const o=te(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.CompactPage].button}})),[]));return(0,S.jsx)(D,{...o})})),N=(0,n.forwardRef)((function(e,t){const o=te(e,t);return(0,S.jsx)(D,{...o})})),Q=(0,n.forwardRef)((function(e,t){const o=te(e,t,(0,h().m)(t,e.collectionStore,e.property,"button"));return(0,S.jsx)(D,{...o})})),G=(0,n.forwardRef)((function(e,t){const o=te(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Board].button}})),[]));return(0,S.jsx)(D,{...o})})),$=(0,n.forwardRef)((function(e,t){const o=te(e,t);return(0,S.jsx)(D,{...o})})),Y=(0,n.forwardRef)((function(e,t){const o=te(e,t);return(0,S.jsx)(D,{...o})})),J=(0,n.forwardRef)((function(e,t){const o=te(e,t,(0,s().yK)((()=>({buttonStyle:{maxWidth:200}})),[]));return(0,S.jsx)(D,{...o})})),X=(0,n.forwardRef)((function(e,t){const o=te(e,t,(0,s().yK)((()=>({buttonStyle:{height:void 0}})),[]));return(0,S.jsx)(D,{...o})})),ee=(0,n.forwardRef)((function(e,t){const o=te(e,t);return(0,S.jsx)(D,{...o})}));function te(e,t,o){const{store:n,collectionStore:r,property:i,disabled:l,onContextMenu:a}=e;return{ref:t,store:n,collectionStore:r,property:i,disabled:l,onContextMenu:a,buttonStyle:null==o?void 0:o.buttonStyle,innerButtonStyle:null==o?void 0:o.innerButtonStyle}}var oe=()=>o(15607),ne=()=>o(250303),re=()=>o(909240),ie=()=>o(269299),le=()=>o(201608),ae=()=>o(523634);const se=n.memo(n.forwardRef((function(e,t){const{store:o,property:i,enablePointerEventsForInteractiveTypes:c,editButtonClickProps:d,onClick:m,onContextMenu:f,buttonStyle:h,showLabel:x,disabled:v}=e,b=(0,a().O7)(),g=(0,r().VK)((()=>u().Ml(o.getPropertyValue(i))),[i,o]),{baseStyles:C,propertySchema:k,format:w,collectionContextStore:P}=(0,n.useContext)(y().OU),j=ce(o,i,v),_=k,R=(0,n.useCallback)((()=>{const e=o.getPropertyStore(i);e&&P&&(ie().createAndCommit({userAction:"BlockPropertyValue.handleEditButtonClick",environment:b,canUndo:!0,perform:e=>{re().vO({stores:[o],property:i,transaction:e})}}),ne().rv({environment:b,collectionContextStore:P,block_id:e.id,property:i,property_type:"checkbox",from:(0,l().Sy)(w),isFromBulkActionsToolbar:!1})),m&&m()}),[P,b,w,m,i,o]),B=(0,s().yK)((()=>({buttonStyle:{...C.buttonStyle,...h},buttonPressedStyle:C.buttonPressedStyle??{},buttonHoveredStyle:C.buttonHoveredStyle??{}})),[C,h]);return(0,S.jsx)(p().e,{ref:t,onContextMenu:f,editButtonClickProps:d,style:B.buttonStyle,hoveredStyle:B.buttonHoveredStyle,pressedStyle:B.buttonPressedStyle,children:(0,S.jsx)(ae().n,{propertyLabel:x?null==_?void 0:_.name:void 0,checked:g,enablePointerEventsForInteractiveTypes:c,onClick:R,disabled:j,store:o,property:i})})})));function ce(e,t,o){return(0,r().VK)((()=>o||!e.canEdit()||(0,oe().w)(t)||e.isNonEditableState()),[o,t,e])}const ue=n.forwardRef((function(e,t){const o=ge(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Table].checkbox}})),[]));return(0,S.jsx)(se,{...o,showLabel:!1})})),de=n.forwardRef((function(e,t){const o=ge(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Page].checkbox}})),[]));return(0,S.jsx)(se,{...o,showLabel:!1,collectionStore:e.collectionStore})})),pe=n.forwardRef((function(e,t){const o=ge(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.CompactPage].checkbox}})),[]));return(0,S.jsx)(se,{...o,showLabel:!1})})),ye=n.forwardRef((function(e,t){const o=ge(e,t,(0,s().yK)((()=>({buttonStyle:{minWidth:"fit-content"}})),[]));return(0,S.jsx)(se,{...o,showLabel:!1})})),me=n.forwardRef((function(e,t){const o=ge(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Board].checkbox,width:"unset"}})),[]));return(0,S.jsx)(se,{...o,showLabel:!0})})),fe=n.forwardRef((function(e,t){const o=ge(e,t);return(0,S.jsx)(se,{...o,showLabel:!0})})),he=n.forwardRef((function(e,t){const o=ge(e,t,(0,s().yK)((()=>({buttonStyle:{width:"unset",minWidth:"unset"}})),[]));return(0,S.jsx)(se,{...o,showLabel:!0})})),xe=n.forwardRef((function(e,t){const o=ge(e,t);return(0,S.jsx)(se,{...o,showLabel:!1})})),Se=n.forwardRef((function(e,t){const o=ge(e,t);return(0,S.jsx)(se,{...o,showLabel:!1})})),ve=n.forwardRef((function(e,t){const o=ge(e,t);return(0,S.jsx)(se,{...o,showLabel:!1})})),be=n.forwardRef((function(e,t){const o=ge(e,t);return(0,S.jsx)(se,{...o,showLabel:!1})}));function ge(e,t,o){const{store:n,disabled:r,collectionStore:i,property:l,enablePointerEventsForInteractiveTypes:a,onClick:s,onContextMenu:c}=e;return{ref:t,store:n,disabled:r,collectionStore:i,property:l,editButtonClickProps:(0,le().Am)(e),enablePointerEventsForInteractiveTypes:a,onClick:s,onContextMenu:c,buttonStyle:null==o?void 0:o.buttonStyle}}var Ce=()=>o(395833);const ke={contactVisitButton:new(F().Ss)("contactVisitButton",(()=>Promise.all([o.e(44832),o.e(48512)]).then(o.bind(o,251074))))},we=(0,F().kF)(ke.contactVisitButton,(e=>e.default));var Pe=()=>o(961415),je=()=>o(168003);const _e=n.memo(n.forwardRef((function(e,t){const{onContextMenu:i,editButtonClickProps:l,property:a,store:c,buttonStyle:u,EmptyComponent:d,quickActionButtons:m=[],showIfEmpty:f,width:h,disableLinkify:v,userExpandable:b}=e,{propertySchema:g,isEmpty:C,baseStyles:k}=(0,n.useContext)(y().OU),w=(0,Ce().$)(g),P=(0,r().VK)((()=>c.getPropertyValue(a)),[a,c]),j=(0,r().VK)((()=>!(!w||"url"!==w.type)&&!w.show_full_url),[w]),_=(0,s().yK)((()=>({buttonStyle:{...k.buttonStyle,...u},buttonPressedStyle:k.buttonPressedStyle??{},buttonHoveredStyle:k.buttonHoveredStyle??{}})),[k.buttonHoveredStyle,k.buttonPressedStyle,k.buttonStyle,u]);return C&&void 0===d?null:(0,S.jsx)(p().e,{ref:t,editButtonClickProps:l,onContextMenu:i,style:_.buttonStyle,pressedStyle:_.buttonPressedStyle,hoveredStyle:_.buttonHoveredStyle,quickActionButtons:m,width:h,userExpandable:b,children:C&&void 0!==d?(0,S.jsx)(d,{}):w?(0,S.jsx)(x().Y,{children:(0,S.jsx)(o(75982).t5,{type:w.type,textValue:P,useShortenedUrl:j,disableLinkify:f||v,store:c,property:a})}):null})}))),Re=n.forwardRef((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l}=(0,a().Fy)(),{shouldWrap:c}=(0,n.useContext)(y().OU),u=(0,n.useMemo)((()=>{if(!l)return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(Pe().U,{},"comment"),(0,S.jsx)(d().q,{store:o,property:r,format:i},"copy")]})}),[i,l,r,o]),p=Ue(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Table].text}})),[]));return(0,S.jsx)(_e,{...p,EmptyComponent:je().q8,quickActionButtons:u,userExpandable:c})})),Be=n.forwardRef((function(e,t){const{store:o,property:r,format:i}=e,l=(0,n.useMemo)((()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(Pe().U,{},"comment"),(0,S.jsx)(d().q,{store:o,property:r,format:i},"copy")]})),[i,r,o]),a=Ue(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Page].text}})),[]));return(0,S.jsx)(_e,{...a,EmptyComponent:je().T$,quickActionButtons:l})})),Me=n.forwardRef((function(e,t){const{store:o,property:r,format:i}=e,l=Ue(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.CompactPage].text}})),[])),a=(0,n.useMemo)((()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(Pe().U,{},"comment"),(0,S.jsx)(d().q,{store:o,property:r,format:i},"copy"),(0,S.jsx)(we,{},"visit")]})),[i,r,o]);return(0,S.jsx)(_e,{...l,EmptyComponent:je().T$,quickActionButtons:a,disableLinkify:!0})})),Te=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=Ue(e,t,(0,h().m)(t,e.collectionStore,e.property,"phone_number"));return(0,S.jsx)(_e,{...n,EmptyComponent:o?je().s3:void 0})})),Ve=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=Ue(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Board].text}})),[]));return(0,S.jsx)(_e,{...n,EmptyComponent:o?je().s3:void 0})})),Ee=n.forwardRef((function(e,t){const o=Ue(e,t);return(0,S.jsx)(_e,{...o})})),Ie=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=Ue(e,t);return(0,S.jsx)(_e,{...n,EmptyComponent:o?je().s3:void 0})})),Ae=n.forwardRef((function(e,t){const o=Ue(e,t);return(0,S.jsx)(_e,{...o})})),Oe=n.forwardRef((function(e,t){const o=Ue(e,t);return(0,S.jsx)(_e,{...o})})),Ke=n.forwardRef((function(e,t){const o=Ue(e,t);return(0,S.jsx)(_e,{...o})})),Fe=n.forwardRef((function(e,t){const o=Ue(e,t);return(0,S.jsx)(_e,{...o,EmptyComponent:je().zX,showIfEmpty:!0})}));function Ue(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l,width:a}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,le().Am)(e),onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle,width:a}}var Le=()=>o(532212),He=(o(241792),()=>o(463212)),We=()=>o(802729),De=()=>o(616978);const Ze=n.memo(n.forwardRef((function(e,t){const{store:i,EmptyComponent:l,onContextMenu:c,buttonStyle:d,selectableStyle:m,property:h,editButtonClickProps:x,quickActionButtons:v,width:b,shouldDisableLinks:g,shouldTruncateToSingleLine:C,shouldLockImageAspectRatio:k,userExpandable:w}=e,P=(0,a().O7)(),{baseStyles:j,collectionContextStore:_,isReadOnly:R}=(0,n.useContext)(y().OU),[B,M]=(0,n.useState)(void 0);(0,n.useEffect)((()=>{M(i.clone())}),[i]);const T=(0,n.useCallback)((e=>{re().bA({environment:P,blockPropertyValueOverlayStore:x.blockPropertyValueOverlayStore,store:i,property:h,format:x.format,uploadFiles:e.files,disableHorizontalEdgeScroll:x.disableHorizontalEdgeScroll,collectionContextStore:_})}),[_,x.blockPropertyValueOverlayStore,x.disableHorizontalEdgeScroll,x.format,P,h,i]),V=(0,r().VK)((()=>{const e=i.getPropertyValue(h);return u().g(e)}),[i,h]),E=(0,s().yK)((()=>{var e;return{buttonStyle:{...j.buttonStyle,...d},buttonPressedStyle:j.buttonPressedStyle??{},buttonHoveredStyle:j.buttonHoveredStyle??{},selectableStyle:{display:"inherit",borderRadius:null===(e=j.buttonStyle)||void 0===e?void 0:e.borderRadius,...m}}}),[j.buttonHoveredStyle,j.buttonPressedStyle,j.buttonStyle,d,m]),I=!V||0===V.length,A=I&&void 0!==l,O=!I;return B&&(A||O)?(0,S.jsx)(o(307369).Z,{store:B,canNativeDropOnto:!R,onNativeDrop:T,analyticsName:"file_property",shouldShowDropZone:!R,style:E.selectableStyle,children:(0,S.jsxs)(p().e,{ref:t,onContextMenu:c,editButtonClickProps:x,style:E.buttonStyle,pressedStyle:E.buttonPressedStyle,hoveredStyle:E.buttonHoveredStyle,quickActionButtons:v,width:b,forceEnableButton:C,userExpandable:w,children:[A&&(0,S.jsx)(l,{}),O&&(0,S.jsx)(qe,{store:i,links:V,property:h,shouldTruncateToSingleLine:C,shouldDisableLinks:g,shouldLockImageAspectRatio:k,tokenFormat:(0,f().jV)(null==j?void 0:j.tokenFormat)})]})}):null}))),qe=n.memo((function(e){let{store:t,links:n,property:r,shouldTruncateToSingleLine:i=!1,shouldDisableLinks:l=!1,shouldLockImageAspectRatio:a=!1,tokenFormat:c}=e;const u=i?3:void 0,d=(0,We().H)({propertyId:r,store:t}),p=Boolean(d),y=(0,s().yK)((e=>({wrapperStyle:{width:"100%",...p?{...(0,He().Y)(e),padding:4,lineHeight:2,...!i&&{flexWrap:"wrap",display:"inline-flex"}}:{}},moreToken:{margin:0,flexShrink:0}})),[p,i]),m=u&&n.length>u?n.slice(0,u):n,f=m.length<n.length?n.length-m.length:0;return(0,S.jsxs)(De().K,{style:y.wrapperStyle,className:d,children:[m.map(((e,n)=>(0,S.jsx)(o(878826).e,{linkValue:e,store:t,shouldDisableLinks:l,shouldLockImageAspectRatio:a},e.url+n))),f>0&&(0,S.jsx)(o(762141).Z,{count:f,format:c,style:y.moreToken,fixedHeight:!0,isCompact:!0})]})})),ze=n.forwardRef((function(e,t){const{shouldWrap:o}=(0,n.useContext)(y().OU),r=(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Table].button,height:"100%"},selectableStyle:{width:"100%"}})),[]),i=(0,n.useMemo)((()=>(0,S.jsx)(Pe().U,{},"comment")),[]),l=rt(e,t,r);return(0,S.jsx)(Ze,{...l,EmptyComponent:je().q8,quickActionButtons:i,userExpandable:o})})),Ne=n.forwardRef((function(e,t){const o=rt(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Page].button,width:"100%"},selectableStyle:{width:"100%"}})),[])),r=(0,n.useMemo)((()=>(0,S.jsx)(Pe().U,{},"comment")),[]);return(0,S.jsx)(Ze,{...o,EmptyComponent:je().T$,quickActionButtons:r})})),Qe=n.forwardRef((function(e,t){const o=(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.CompactPage].button}})),[]),r=(0,n.useMemo)((()=>(0,S.jsx)(Pe().U,{},"comment")),[]),i=rt(e,t,o);return(0,S.jsx)(Ze,{...i,EmptyComponent:je().T$,quickActionButtons:r,shouldDisableLinks:!0,shouldLockImageAspectRatio:!0,shouldTruncateToSingleLine:!0})})),Ge=n.forwardRef((function(e,t){const o=rt(e,t);return(0,S.jsx)(Ze,{...o,EmptyComponent:je().zX,shouldDisableLinks:!0})})),$e=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=rt(e,t,(0,h().m)(t,e.collectionStore,e.property,"file"));return(0,S.jsx)(Ze,{...n,EmptyComponent:o?je().s3:void 0})})),Ye=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=rt(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Board].button,width:"100%"},selectableStyle:{width:"100%"}})),[]));return(0,S.jsx)(Ze,{...n,EmptyComponent:o?je().s3:void 0})})),Je=n.forwardRef((function(e,t){const o=rt(e,t);return(0,S.jsx)(Ze,{...o})})),Xe=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=rt(e,t);return(0,S.jsx)(Ze,{...n,EmptyComponent:o?je().s3:void 0})})),et=n.forwardRef((function(e,t){const o=rt(e,t);return(0,S.jsx)(Ze,{...o})})),tt=n.forwardRef((function(e,t){const o=rt(e,t);return(0,S.jsx)(Ze,{...o})})),ot=n.forwardRef((function(e,t){const o=rt(e,t);return(0,S.jsx)(Ze,{...o})})),nt=n.forwardRef((function(e,t){return(0,S.jsx)(o(384152).Z,{...e,ref:t,children:(0,S.jsx)(o(598645).p,{...e})})}));function rt(e,t,o){const{store:n,onContextMenu:r,property:i,width:l}=e;return{ref:t,store:n,property:i,editButtonClickProps:(0,le().Am)(e),onContextMenu:r,buttonStyle:null==o?void 0:o.buttonStyle,selectableStyle:null==o?void 0:o.selectableStyle,width:l}}var it=()=>o(134418),lt=()=>o(588366),at=()=>o(81954),st=()=>o(955620),ct=()=>o(707513),ut=()=>o(958783),dt=()=>o(718611),pt=()=>o(641702),yt=()=>o(158429);const mt=n.memo((function(e){const{parentStore:t,withComma:i,linkifyUrls:c,disableCommentHighlight:d,disableLinks:p,shouldTruncate:m,clampLines:f}=e,{textValue:h}=e,x=(0,a().O7)(),v=(0,s().Fg)(),b=(0,dt().kw)();(0,n.useEffect)((()=>{void 0!==h&&x.KatexStore.loadIfNeeded((()=>h))}),[x.KatexStore,h]);const{collectionContextStore:g,property:C}=(0,n.useContext)(y().OU),{collectionViewBlockId:k,collectionViewId:w}=(0,r().VK)((()=>{var e,t;return{collectionViewId:null==g||null===(e=g.collectionViewStore())||void 0===e?void 0:e.id,collectionViewBlockId:null==g||null===(t=g.collectionViewBlockStore())||void 0===t?void 0:t.id}}),[g]),P=(0,r().VK)((()=>x.KatexStore.getKatex()),[x.KatexStore]),j=(0,r().VK)((()=>{const e=yt().l.state,o=yt().V.state;if(!e||!C||!h)return h;return pt().cD({textValue:h,blockId:t.id,textProps:{type:"page_property_value_match",collectionViewBlockId:k,collectionViewId:w,propertyId:C},find:e,currentFocusedResult:o})}),[C,h,t.id,k,w]),_=(0,r().VK)((()=>{if(ut().default.getPropertyId()!==C||ut().default.getBlockStore()!==t)return j;const e=ut().default.getMultiSelection();return e?st().WO0({textValue:j,selection:{startIndex:e.start.index,endIndex:e.end.index},annotation:[st().GKr.TemporaryComment]}):h?st().WO0({textValue:j,selection:{startIndex:0,endIndex:st().eeV(h).length},annotation:[st().GKr.TemporaryComment]}):j}),[t,C,h,j]),R=(0,r().VK)((()=>void 0===_?null:pt().IY({environment:x,textValue:_&&{value:_,spaceId:(0,at().J)(t.pointer.spaceId)},parentStore:t,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableCommentAnnotations:d??!1,disabled:!0,theme:v,disableLinks:p??!1,emojiType:b,katex:P,formulaValueTypes:[],stopLinkPropagation:!0,linkTargetBlank:!0})),[_,x,t,d,v,p,b,P]),B=(0,n.useMemo)((()=>{if(!c||void 0===h)return null;const e=(0,st().Jcv)(h);return(0,o(326177).Z)(e)?(0,u().zB)(h):null}),[c,h]),M=(0,s().yK)((e=>({text:{...m&&!f?ct().Yu:void 0,...m&&f?{...(0,o(641506).pd)(f),overflow:"hidden",textOverflow:"ellipsis"}:{}}})),[m,f]);return(0,S.jsxs)("span",{style:M.text,children:[B?(0,S.jsx)(o(108714).Z,{href:B,style:{display:"inline",pointerEvents:"auto",...(0,l().z0)(v)},external:!0,onClick:e=>e.stopPropagation(),children:R}):R,i?", ":null]})})),ft=n.memo((0,n.forwardRef)(((e,t)=>{const{store:o,buttonStyle:i,onContextMenu:l,editButtonClickProps:a,quickActionButtons:c=[],EmptyComponent:u,property:d,width:m,linkifyUrls:f,disableLinks:h,userExpandable:v,clampLines:b,forceBlockPropertyButtonEnable:g=!1}=e,{isEmpty:C,baseStyles:k}=(0,n.useContext)(y().OU),w=(0,r().VK)((()=>o.getPropertyValue(d)),[d,o]),P=(0,s().yK)((()=>({buttonStyle:{...k.buttonStyle,...i},buttonPressedStyle:k.buttonPressedStyle??{},buttonHoveredStyle:k.buttonHoveredStyle??{}})),[k.buttonHoveredStyle,k.buttonPressedStyle,k.buttonStyle,i]);if(C&&void 0===u)return null;const j=!!b;return(0,S.jsx)(p().e,{ref:t,style:P.buttonStyle,hoveredStyle:P.buttonHoveredStyle,pressedStyle:P.buttonPressedStyle,onContextMenu:l,editButtonClickProps:a,quickActionButtons:c,forceEnableButton:g,width:m,userExpandable:v,children:C&&void 0!==u?(0,S.jsx)(u,{}):(0,S.jsx)(x().Y,{children:(0,S.jsx)(mt,{textValue:w,parentStore:o,linkifyUrls:f,disableLinks:h,shouldTruncate:j,clampLines:b})})})}))),ht=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,l=(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Page].text}})),[]),a=(0,n.useMemo)((()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(lt().Z,{store:o,property:r,openOverlay:!0},"autofill"),(0,S.jsx)(Pe().U,{},"comment"),(0,S.jsx)(d().q,{store:o,property:r,format:i},"copy")]})),[i,r,o]),c=_t(e,t,l);return(0,S.jsx)(ft,{...c,EmptyComponent:je().T$,quickActionButtons:a})})),xt=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l}=(0,a().Fy)(),c=(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Table].text}})),[]),u=(0,n.useMemo)((()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(lt().Z,{store:o,property:r,openOverlay:!0},"autofill"),(0,S.jsx)(Pe().U,{},"comment"),l?void 0:(0,S.jsx)(d().q,{store:o,property:r,format:i},"copy")]})),[i,l,r,o]),p=_t(e,t,c);return(0,S.jsx)(ft,{...p,EmptyComponent:je().q8,quickActionButtons:u,userExpandable:!0})})),St=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l}=(0,a().Fy)(),c=(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.CompactPage].text,maxWidth:"300px"}})),[]),u=(0,n.useMemo)((()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(Pe().U,{},"comment"),l?void 0:(0,S.jsx)(d().q,{store:o,property:r,format:i},"copy")]})),[i,l,r,o]),p=_t(e,t,c);return(0,S.jsx)(ft,{...p,EmptyComponent:je().T$,quickActionButtons:u,linkifyUrls:!1,disableLinks:!0})})),vt=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=_t(e,t,(0,h().m)(t,e.collectionStore,e.property,"text"));return(0,S.jsx)(ft,{...n,EmptyComponent:o?je().s3:void 0})})),bt=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=_t(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Board].text}})),[]));return(0,S.jsx)(ft,{...n,EmptyComponent:o?je().s3:void 0})})),gt=(0,n.forwardRef)((function(e,t){const o=_t(e,t);return(0,S.jsx)(ft,{...o})})),Ct=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=_t(e,t);return(0,S.jsx)(ft,{...n,EmptyComponent:o?je().s3:void 0})})),kt=(0,n.forwardRef)((function(e,t){const o=_t(e,t);return(0,S.jsx)(ft,{...o})})),wt=(0,n.forwardRef)((function(e,t){const o=_t(e,t);return(0,S.jsx)(ft,{...o})})),Pt=(0,n.forwardRef)((function(e,t){const o=_t(e,t);return(0,S.jsx)(ft,{...o})})),jt=(0,n.forwardRef)((function(e,t){const o=_t(e,t);return(0,S.jsx)(ft,{...o,EmptyComponent:je().zX})}));function _t(e,t,o){const{store:n,collectionStore:r,property:i,disabled:l,onContextMenu:a,width:s}=e;return{ref:t,store:n,collectionStore:r,property:i,disabled:l,editButtonClickProps:(0,le().Am)(e),onContextMenu:a,buttonStyle:null==o?void 0:o.buttonStyle,width:s}}var Rt=()=>o(554952);const Bt=n.memo(n.forwardRef((function(e,t){const{store:o,EmptyComponent:i,onContextMenu:l,buttonStyle:a}=e,{baseStyles:c,collectionContextStore:u}=(0,n.useContext)(y().OU),d=(0,r().VK)((()=>o.getAssociatedCollectionStore()),[o]),m=(0,s().yK)((()=>({buttonStyle:{...c.buttonStyle,minWidth:32,...a},buttonPressedStyle:c.buttonPressedStyle??{},buttonHoveredStyle:c.buttonHoveredStyle??{}})),[c.buttonHoveredStyle,c.buttonPressedStyle,c.buttonStyle,a]),f=!d||!u;return f&&void 0===i?null:(0,S.jsx)(p().e,{ref:t,onContextMenu:l,editButtonClickProps:void 0,style:m.buttonStyle,pressedStyle:m.buttonPressedStyle,hoveredStyle:m.buttonHoveredStyle,tooltipPropertyValue:(0,S.jsx)(Rt().L,{collectionForLocationStore:d,collectionContextStore:u}),children:f&&void 0!==i?(0,S.jsx)(i,{}):(0,S.jsx)(Rt().Z,{collectionContextStore:u,collectionForLocationStore:d})})}))),Mt=n.forwardRef((function(e,t){const o=Ht(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Table].text}})),[]));return(0,S.jsx)(Bt,{...o,EmptyComponent:je().q8})})),Tt=n.forwardRef((function(e,t){const o=Ht(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Page].text}})),[]));return(0,S.jsx)(Bt,{...o,EmptyComponent:je().T$})})),Vt=n.forwardRef((function(e,t){const o=Ht(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.CompactPage].text}})),[]));return(0,S.jsx)(Bt,{...o,EmptyComponent:je().T$})})),Et=n.forwardRef((function(e,t){const o=Ht(e,t);return(0,S.jsx)(Bt,{...o,EmptyComponent:je().zX})})),It=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=Ht(e,t,(0,h().m)(t,e.collectionStore,e.property,"location"));return(0,S.jsx)(Bt,{...n,EmptyComponent:o?je().s3:void 0})})),At=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=Ht(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Board].text}})),[]));return(0,S.jsx)(Bt,{...n,EmptyComponent:o?je().s3:void 0})})),Ot=n.forwardRef((function(e,t){const o=Ht(e,t);return(0,S.jsx)(Bt,{...o})})),Kt=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=Ht(e,t);return(0,S.jsx)(Bt,{...n,EmptyComponent:o?je().s3:void 0})})),Ft=n.forwardRef((function(e,t){const o=Ht(e,t);return(0,S.jsx)(Bt,{...o})})),Ut=n.forwardRef((function(e,t){const o=Ht(e,t);return(0,S.jsx)(Bt,{...o})})),Lt=n.forwardRef((function(e,t){const o=Ht(e,t);return(0,S.jsx)(Bt,{...o})}));function Ht(e,t,o){const{store:n,onContextMenu:r}=e;return{ref:t,store:n,onContextMenu:r,buttonStyle:null==o?void 0:o.buttonStyle}}var Wt=()=>o(114637),Dt=()=>o(893636);const Zt=n.memo((0,n.forwardRef)((function(e,t){var o,i;const{store:a,buttonStyle:c,onContextMenu:d,editButtonClickProps:m,quickActionButtons:f,EmptyComponent:h,isRightAligned:v,property:b,width:g,userExpandable:C}=e,{isEmpty:k,baseStyles:w,propertySchema:P,shouldRenderTooltip:j}=(0,n.useContext)(y().OU),_=P,R=(0,r().VK)((()=>{const e=a.getPropertyValue(b);return u().VY(e)}),[b,a]),B=(0,l().X7)({numberValue:R,numberFormat:null==_?void 0:_.number_format,numberShowAs:null==_?void 0:_.show_as}),M=(0,s().yK)((()=>({buttonStyle:{...w.buttonStyle,...c},buttonPressedStyle:w.buttonPressedStyle??{},buttonHoveredStyle:w.buttonHoveredStyle??{}})),[w.buttonHoveredStyle,w.buttonPressedStyle,w.buttonStyle,c]);if(k&&void 0===h)return null;const T="bar"===(null==_||null===(o=_.show_as)||void 0===o?void 0:o.type)||"ring"===(null==_||null===(i=_.show_as)||void 0===i?void 0:i.type);return(0,S.jsx)(p().e,{ref:t,style:M.buttonStyle,hoveredStyle:M.buttonHoveredStyle,pressedStyle:M.buttonPressedStyle,onContextMenu:d,editButtonClickProps:m,quickActionButtons:f,quickActionButtonsAlign:v?"left":void 0,tooltipPropertyValue:j?B:void 0,width:g,userExpandable:C,children:k&&void 0!==h?(0,S.jsx)(h,{}):T?(0,S.jsx)(De().K,{isRightAligned:v,children:(0,S.jsx)(Dt().A,{numberValue:R,isRightAligned:v,store:a,property:b})}):(0,S.jsx)(x().Y,{isRightAligned:v,children:(0,S.jsx)(Dt().A,{numberValue:R,isRightAligned:v,store:a,property:b})})})}))),qt=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,l=oo(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Page].text}})),[])),a=(0,n.useMemo)((()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(Pe().U,{},"comment"),(0,S.jsx)(d().q,{store:o,property:r,format:i},"copy")]})),[i,r,o]);return(0,S.jsx)(Zt,{...l,EmptyComponent:je().T$,quickActionButtons:a})})),zt=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l}=(0,a().Fy)(),{shouldWrap:c}=(0,n.useContext)(y().OU),u=(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Table].text}})),[]),p=(0,n.useMemo)((()=>{if(!l)return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(Pe().U,{},"comment"),(0,S.jsx)(d().q,{store:o,property:r,format:i},"copy")]})}),[i,l,r,o]),h=oo(e,t,u);return(0,S.jsx)(Zt,{...h,EmptyComponent:je().q8,quickActionButtons:p,isRightAligned:!0,userExpandable:c})})),Nt=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l}=(0,a().Fy)(),c=oo(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.CompactPage].text}})),[])),u=(0,n.useMemo)((()=>{if(!l)return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(Pe().U,{},"comment"),(0,S.jsx)(d().q,{store:o,property:r,format:i},"copy")]})}),[i,l,r,o]);return(0,S.jsx)(Zt,{...c,EmptyComponent:je().T$,quickActionButtons:u})})),Qt=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=oo(e,t,(0,h().m)(t,e.collectionStore,e.property,"number"));return(0,S.jsx)(Zt,{...n,EmptyComponent:o?je().s3:void 0})})),Gt=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=oo(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Board].text}})),[]));return(0,S.jsx)(Zt,{...n,EmptyComponent:o?je().s3:void 0})})),$t=(0,n.forwardRef)((function(e,t){const o=oo(e,t);return(0,S.jsx)(Zt,{...o})})),Yt=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=oo(e,t);return(0,S.jsx)(Zt,{...n,EmptyComponent:o?je().s3:void 0})})),Jt=(0,n.forwardRef)((function(e,t){const o=oo(e,t);return(0,S.jsx)(Zt,{...o})})),Xt=(0,n.forwardRef)((function(e,t){const o=oo(e,t);return(0,S.jsx)(Zt,{...o})})),eo=(0,n.forwardRef)((function(e,t){const o=oo(e,t);return(0,S.jsx)(Zt,{...o})})),to=(0,n.forwardRef)((function(e,t){const o=oo(e,t);return(0,S.jsx)(Zt,{...o,EmptyComponent:je().zX})}));function oo(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l,width:a}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,le().Am)(e),onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle,width:a}}var no=()=>o(147854),ro=()=>o(154989),io=(o(670560),o(122556),o(582845),o(250570),o(533019),o(721473),o(788208),o(22624),o(267602),o(653476),o(470928),()=>o(552221)),lo=()=>o(226413),ao=()=>o(235819),so=()=>o(646574),co=()=>o(874459),uo=()=>o(998411),po=()=>o(375255),yo=()=>o(271839),mo=()=>o(667247),fo=()=>o(615676),ho=()=>o(584461),xo=()=>o(466970),So=()=>o(749826),vo=()=>o(519454),bo=()=>o(820185),go=()=>o(233417),Co=()=>o(108244);const ko=(0,V().vU)({rollup:{defaultMessage:"Configure rollup",id:"database.editButton.configureRollupTooltip"}});function wo(e){const{type:t,editButtonClickProps:o}=e,i=(0,a().O7)(),{isMobile:l}=(0,a().Fy)(),{containerRef:c,collectionContextStore:u,isReadOnly:d}=(0,n.useContext)(y().OU),p=(0,r().qz)(void 0,go().Z),m=(0,n.useMemo)((()=>K().Z.formatMessage(ko[t])),[t]),f=(0,s().yK)((e=>({iconStyle:{color:e.mediumTextColor,fill:e.mediumTextColor}})),[]),h=(0,n.useCallback)((async e=>{if(void 0===o)return;const{onClick:t,store:n,property:r,format:l,collectionStore:a,blockPropertyValueOverlayStore:s,disableHorizontalEdgeScroll:d}=o;await bo().z({element:c&&"current"in c&&(null==c?void 0:c.current)||void 0,environment:i,onClick:t,store:n,property:a.getMappedProperty(r),format:l,collectionStore:a,blockPropertyValueOverlayStore:s,disableHorizontalEdgeScroll:d,collectionContextStore:u,mouseStore:p})}),[u,c,o,i,p]);return d||l?null:(0,S.jsx)(Co().Z,{icon:vo().R,tooltip:m,onClick:h,style:{height:20,width:20},iconStyle:f.iconStyle})}var Po=()=>o(517084);const jo=n.memo(n.forwardRef((function(e,t){const{store:i,property:l,EmptyComponent:c,collectionStore:d,onContextMenu:h,editButtonClickProps:v,checkboxButtonStyle:b,textButtonStyle:g,buttonButtonStyle:C,quickActionButtons:k,numberRightAlign:w,userExpandable:P}=e,{baseStyles:j,format:_,collectionSchema:R}=(0,n.useContext)(y().OU),B=(0,o(817606)._)(),M=(0,n.useMemo)((()=>{if(!R)return;const{relationPropertySchema:e}=(0,ao().K9)({schema:R,property:l}),t=e?lo().j0(e):void 0;return t?U().NW.createChildStore(i,t):void 0}),[l,R,i]),T=(0,r().VK)((()=>{if(void 0!==R)return(0,ao().gT)({property:l,schema:R,preLoadedTargetCollectionModel:null==M?void 0:M.getModel(),getRecordModel:d.getRecordModel})}),[R,l,d.getRecordModel,M]),{propertySchema:V,targetPropertySchema:E}=T||{},[I,O]=function(e){var t;const{schema:i,property:l,store:a,propertySchema:s,targetPropertySchema:c,numberRightAlign:u,clientFormulaTimeoutMs:d}=e,{value:p}=(0,F().XJ)(A().F.formulas),y=(0,ho().o)(),m=(0,r().VK)((()=>{const e=a.getModel();if(!(null!=s&&s.aggregation&&"show_unique"!==s.aggregation&&e&&null!=c&&c.type&&i))return{rollupAggregationValue:void 0,numberFormat:void 0,numberPrecision:void 0};const t=(0,ao().O0)({block:e,property:l,schema:i,getRecordModel:a.getRecordModel,collectionRequestContext:{userId:void 0,userTimeZone:(0,uo().r)(),depth:0,intl:K().Z.getIntl(),visitedProperties:new Set,resultCache:new Map,regExpCache:new Map,formulaTimeoutTimestampMs:Date.now()+d,experimentService:So().default,collectionFeatureGates:(0,fo().W)()},formulasModule:p});if(!t)return{rollupAggregationValue:void 0,numberFormat:void 0,numberPrecision:void 0};const o=(0,mo().SD)(s.aggregation,"formula"===(null==c?void 0:c.type)||"number"===(null==c?void 0:c.type)?c.number_format:void 0),n=(0,mo().WD)(s.aggregation,"formula"===(null==c?void 0:c.type)||"number"===(null==c?void 0:c.type)?c.number_precision:void 0);if(o){const e=void 0===(null==t?void 0:t.value)||null===(null==t?void 0:t.value)||"number"!=typeof t.value?void 0:Number(t.value);if(void 0!==e&&!isNaN(e))return{rollupAggregationValue:e,numberFormat:o,numberPrecision:n}}const r=(0,mo().Ol)({numberFormat:void 0,dateFormat:c&&"date_format"in c?c.date_format:void 0,aggregationType:s.aggregation,value:t,userTimeZone:(0,uo().r)(),numberPrecision:void 0});return void 0===r||""===r?{rollupAggregationValue:void 0,numberFormat:void 0}:{rollupAggregationValue:r,numberFormat:void 0}}),[a,s,c,i,l,d,p],y),f=m===ho().b,h=(0,n.useMemo)((()=>{if(m===ho().b){const e=!0===u&&(null==s?void 0:s.aggregation)&&void 0!==(0,mo().SD)(null==s?void 0:s.aggregation,"number");return(0,S.jsx)(o(662835).L,{style:{justifyContent:e?"flex-end":void 0}})}const{rollupAggregationValue:e,numberFormat:t,numberPrecision:n}=m;if(void 0===e)return null;if(t){var r,i;return"bar"===(null==s||null===(r=s.show_as)||void 0===r?void 0:r.type)||"ring"===(null==s||null===(i=s.show_as)||void 0===i?void 0:i.type)?(0,S.jsx)(De().K,{isRightAligned:u,children:(0,S.jsx)(Dt().A,{numberFormatOverride:t,numberPrecisionOverride:n,numberValue:e,isRightAligned:u})}):(0,S.jsx)(x().Y,{isRightAligned:u,children:(0,S.jsx)(Dt().A,{numberFormatOverride:t,numberPrecisionOverride:n,numberValue:e,isRightAligned:u})})}return(0,S.jsx)(x().Y,{children:e})}),[u,null==s?void 0:s.aggregation,null==s||null===(t=s.show_as)||void 0===t?void 0:t.type,m]);return[h,f]}({store:i,schema:R,property:l,propertySchema:V,targetPropertySchema:E,numberRightAlign:w,clientFormulaTimeoutMs:B}),L=function(e){const{store:t,rollupPropertyData:i,numberRightAlign:l,clientFormulaTimeoutMs:s,format:c,targetCollectionStore:d}=e,{value:p}=(0,F().XJ)(A().F.formulas),{propertySchema:y,relationPropertySchema:f,targetPropertySchema:h,targetProperty:x,targetCollectionModel:v}=i||{},b=(0,xo().E)("relations_show_deleted"),g=(0,xo().E)("relations_show_invalid_collection"),C=(0,xo().E)("relations_show_no_access"),k=(0,r().VK)((()=>{const e=t.getModel();if(void 0!==(null==y?void 0:y.aggregation)&&"show_unique"!==(null==y?void 0:y.aggregation)||!y||!f||!h||!v||!e||void 0===(null==y?void 0:y.relation_property))return[];return u().j$({relationValue:u().rq(u().wS(e,y.relation_property)),getRecordModel:t.getRecordModel,propertySchema:f,includeDeleted:b,includeInvalidCollection:g,includeNoAccess:C}).map((e=>U().G.createChildStore(t,e))).filter((e=>{var t;return(null===(t=e.getAssociatedCollectionStore())||void 0===t?void 0:t.id)===v.id}))}),[t,y,f,h,v,b,g,C]),w=(0,a().O7)(),P=(0,r().VK)((()=>{if(void 0===f||void 0===d||void 0===h||void 0===x||void 0===y)return[];const e=[],t=new Map,n=new Map;for(const o of k){const r=o.getPropertyValue(x);if(void 0===r&&!["status","person","checkbox","formula","last_edited_time","last_edited_by","created_time","created_by","title"].includes(h.type))continue;const i=Ro({textValue:r,blockStore:o,targetCollectionStore:d,targetPropertySchema:h,targetProperty:x,currentUserId:w.currentUser.id,clientFormulaTimeoutMs:s,resultCache:t,regExpCache:n,formulasModule:p}).map((e=>[e,o]));e.push(...i)}return"show_unique"===y.aggregation?o(513670).mN(e,(e=>{let[t,o]=e;return t.id})):e}),[k,f,y,x,h,d,w.currentUser.id,s,p]);return(0,n.useMemo)((()=>{if(null==P||!P.length||!y)return null;const e=1===P.length,t=P[0][0].type,o=(0,Po().vQ)(t,y);return(0,S.jsx)(Po().E1,{propertyType:t,rootPropertySchema:y,numberRightAlign:l,children:P.map(((t,n)=>{let[r,i]=t;return(0,S.jsx)(Po().gZ,{token:r,targetPropertySchema:h,blockStore:i,withComma:o&&n<P.length-1,numberRightAlign:l,shouldTruncate:e&&c===m().C.CompactPage,disableLinks:c===m().C.CompactPage},`${r.id}-${n}`)}))})}),[c,l,y,P,h])}({store:i,rollupPropertyData:T,numberRightAlign:w,clientFormulaTimeoutMs:B,targetCollectionStore:M,format:_}),H=!I&&!L,W=(0,r().VK)((()=>H||void 0===T?"text":void 0!==(null==V?void 0:V.aggregation)&&"show_unique"!==V.aggregation?void 0!==(0,mo().SD)(V.aggregation,"number")?"number":"text":null!=T&&T.targetPropertySchema?function(e){if("formula"===e.type){if(e.formula2){const t=(0,o(177634).aL)(e.formula2.result_type).type;return"block"===t?"relation":"unknown"===t||"array"===t?"text":t}return"text"}return"rollup"===e.type?"text":e.type}(T.targetPropertySchema):"text"),[H,null==V?void 0:V.aggregation,T]),D=(0,s().yK)((e=>({buttonStyle:{...j.buttonStyle,..."checkbox"===W?b:{},..."title"!==W&&(0,f().A2)(W)?g:{},...(0,f().e4)(W)?C:{}},buttonPressedStyle:j.buttonPressedStyle??{},buttonHoveredStyle:j.buttonHoveredStyle??{}})),[j.buttonHoveredStyle,j.buttonPressedStyle,j.buttonStyle,C,b,W,g]);if(H&&void 0===c)return null;const Z=!0===w&&"number"===W;return(0,S.jsx)(p().e,{ref:t,onContextMenu:h,editButtonClickProps:v,style:D.buttonStyle,pressedStyle:D.buttonPressedStyle,hoveredStyle:D.buttonHoveredStyle,quickActionButtons:!O&&k?(0,S.jsx)(_o,{buttons:k,editButtonClickProps:v}):void 0,quickActionButtonsAlign:Z?"left":void 0,userExpandable:P,children:H?c?(0,S.jsx)(c,{}):null:I??L})})));function _o(e){let{buttons:t,editButtonClickProps:o}=e;const n=t.map((e=>{if("edit"===e)return(0,S.jsx)(wo,{type:"rollup",editButtonClickProps:o},e);(0,E().t1)(e)})).filter(E().K0);return n?(0,S.jsx)(S.Fragment,{children:n}):null}function Ro(e){var t;const{textValue:o,blockStore:n,targetCollectionStore:r,targetPropertySchema:i,targetProperty:l,clientFormulaTimeoutMs:a,resultCache:s,regExpCache:d,formulasModule:p}=e,{type:y}=i;switch(y){case"auto_increment_id":if(void 0===o)return[];const f=null===(t=r.getRecordKeyStore())||void 0===t?void 0:t.getRecordKey(),h=(0,c().wf)(f,u().ah(o));return h?[{id:h,type:"text",value:[[h]]}]:[];case"button":case"rollup":case"location":case"verification":case"geo_point":return[];case"checkbox":{const e=u().Ml(o);return[{id:e,type:"checkbox",value:e}]}case"date":{const e=(0,io().G)(o);if(void 0===e)return[];return[{id:so().ZV({allowRelativeDates:!1,value:e,userTimeZone:(0,uo().r)(),intl:K().Z.getIntl()}),type:"date",value:e}]}case"email":case"phone_number":case"url":return void 0===o?[]:[{id:(0,st().Jcv)(o),type:y,value:o}];case"file":return u().g(o).map((e=>({id:e.url,type:"file",value:e})));case"formula":{const e=n.getModel();if(void 0===e)return[];if(!p)return[];const t=K().Z.getIntl(),o=(0,uo().r)();if("v2"===i.version){var m;if(null===(m=i.formula2)||void 0===m||!m.code)return[];const r=p.evaluateCollectionFormula2({block:e,property:l,formulaCode:i.formula2.code,getRecordModel:n.getRecordModel,intl:t,userTimeZone:o,depth:0,visitedProperties:new Set,formulaTimeoutTimestampMs:Date.now()+a,resultCache:s,regExpCache:d,experimentService:So().default,collectionFeatureGates:(0,fo().W)()});return r?(0,it().$I)(r,n.getRecordModel,o):[]}{const r=p.evaluateFormulaProperty({property:l,schema:n.getSchema(),block:e,getRecordModel:n.getRecordModel,collectionRequestContext:{userId:void 0,userTimeZone:o,depth:0,intl:t,resultCache:s,regExpCache:d,visitedProperties:new Set,formulaTimeoutTimestampMs:Date.now()+a,experimentService:So().default,collectionFeatureGates:(0,fo().W)()}});return(0,it().tT)(r)}}case"select":{const e=u().Sj(o,i.options??[]);if(!i.options||!e)return[];return[{id:e,type:"select",value:e,color:(0,u().wI)(i.options??[],e)}]}case"multi_select":return u().uP(o,i.options??[]).map((e=>({id:e,type:"select",value:e,color:(0,u().wI)(i.options??[],e)})));case"number":{const e=u().VY(o);return void 0===e?[]:[{id:e,type:"number",value:e}]}case"person":return u().DW({textValue:o,propertySchema:i,blockCreatorPointer:n.getCreatedByPointer()}).map((e=>({id:e.id,type:"person",value:e})));case"title":if(void 0===r)return[];return[{id:(0,po().Xh)({textValue:o,getRecordModel:n.getRecordModel,deterministic:!0,userTimeZone:(0,uo().r)(),intl:K().Z.getIntl()}),type:"relation",value:{id:n.id,table:"block",spaceId:r.getSpaceId()}}];case"relation":if(void 0===r)return[];return u().j$({relationValue:u().rq(o),getRecordModel:n.getRecordModel,propertySchema:i,includeDeleted:So().default.checkGate({gateName:"relations_show_deleted"}),includeInvalidCollection:So().default.checkGate({gateName:"relations_show_invalid_collection"}),includeNoAccess:So().default.checkGate({gateName:"relations_show_no_access"})}).map((e=>({id:e.id,type:"relation",value:e})));case"status":{const e=u().ZG(o,i),{options:t,groups:n}=i,r=null==t?void 0:t.find((t=>t.value===e));if(void 0===e||void 0===r)return[];const l=null==n?void 0:n.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(r.id)}));return[{id:e,type:"select",value:e,color:r.color,groupColor:(null==l?void 0:l.color)??"default"}]}case"text":if(void 0===o)return[];const x=(0,po().Xh)({textValue:o,getRecordModel:n.getRecordModel,deterministic:!0,userTimeZone:(0,uo().r)(),intl:K().Z.getIntl()});return 0===x.length?[]:[{id:x,type:"text",value:o}];case"created_by":const S=n.getCreatedByPointer();return S?[{id:S.id,type:"person",value:S}]:[];case"created_time":{const e=n.getCreatedTime();return[{id:e,type:"date",value:(0,co().CQ)(e,(0,uo().r)())}]}case"last_edited_by":{const e=n.getLastEditedByPointer();return e?[{id:e.id,type:"person",value:e}]:[]}case"last_edited_time":{const e=n.getLastEditedTime();return[{id:e,type:"date",value:(0,co().CQ)(e,(0,uo().r)())}]}case"last_visited_time":{const{currentUserId:t}=e;if(!t)return[];const o=(0,yo().Pv)({parent_id:n.id,user_id:t}),r=U().H8.createChildStore(n,{table:yo().UI,id:o,spaceId:n.getSpaceId()}).getModel(),i=null==r?void 0:r.getVisitedAt();if(!i)return[];return[{id:i,type:"date",value:(0,co().CQ)(i,(0,uo().r)())}]}default:(0,E().t1)(y)}}const Bo=n.forwardRef((function(e,t){const{shouldWrap:o}=(0,n.useContext)(y().OU),r=Lo(e,t,(0,s().yK)((()=>({checkboxButtonStyle:{padding:f().sf[m().C.Table].checkbox},textButtonStyle:{padding:f().sf[m().C.Table].text},buttonButtonStyle:{padding:f().sf[m().C.Table].button}})),[]));return(0,S.jsx)(jo,{...r,numberRightAlign:!0,EmptyComponent:je().q8,quickActionButtons:["edit"],userExpandable:o})})),Mo=n.forwardRef((function(e,t){const o=Lo(e,t,(0,s().yK)((()=>({checkboxButtonStyle:{padding:f().sf[m().C.Page].checkbox},textButtonStyle:{padding:f().sf[m().C.Page].text},buttonButtonStyle:{padding:f().sf[m().C.Page].button}})),[]));return(0,S.jsx)(jo,{...o,quickActionButtons:["edit"],EmptyComponent:je().T$})})),To=n.forwardRef((function(e,t){const o=Lo(e,t,(0,s().yK)((()=>({checkboxButtonStyle:{padding:f().sf[m().C.CompactPage].checkbox},textButtonStyle:{padding:f().sf[m().C.CompactPage].text},buttonButtonStyle:{padding:f().sf[m().C.CompactPage].button}})),[]));return(0,S.jsx)(jo,{...o,EmptyComponent:je().T$})})),Vo=n.forwardRef((function(e,t){const o=Lo(e,t);return(0,S.jsx)(jo,{...o,EmptyComponent:je().zX})})),Eo=n.forwardRef((function(e,t){const o=Lo(e,t,(0,h().m)(t,e.collectionStore,e.property,"rollup"));return(0,S.jsx)(jo,{...o})})),Io=n.forwardRef((function(e,t){const o=Lo(e,t,(0,s().yK)((()=>({checkboxButtonStyle:{padding:f().sf[m().C.Board].checkbox},textButtonStyle:{padding:f().sf[m().C.Board].text},buttonButtonStyle:{padding:f().sf[m().C.Board].button}})),[]));return(0,S.jsx)(jo,{...o})})),Ao=n.forwardRef((function(e,t){const o=Lo(e,t);return(0,S.jsx)(jo,{...o})})),Oo=n.forwardRef((function(e,t){const o=Lo(e,t);return(0,S.jsx)(jo,{...o})})),Ko=n.forwardRef((function(e,t){const o=Lo(e,t);return(0,S.jsx)(jo,{...o})})),Fo=n.forwardRef((function(e,t){const o=Lo(e,t);return(0,S.jsx)(jo,{...o})})),Uo=n.forwardRef((function(e,t){const o=Lo(e,t);return(0,S.jsx)(jo,{...o})}));function Lo(e,t,o){const{store:n,onContextMenu:r,property:i,collectionStore:l}=e;return{ref:t,store:n,property:i,collectionStore:l,editButtonClickProps:(0,le().Am)(e),onContextMenu:r,checkboxButtonStyle:null==o?void 0:o.checkboxButtonStyle,textButtonStyle:null==o?void 0:o.textButtonStyle,buttonButtonStyle:null==o?void 0:o.buttonButtonStyle}}var Ho=()=>o(709766);const Wo=n.memo(n.forwardRef((function(e,t){const{store:o,onContextMenu:i,property:l,disabled:a,enablePointerEventsForInteractiveTypes:c,editButtonClickProps:d,selectButtonStyle:m,checkboxButtonStyle:h,checkboxShowLabel:x,EmptyComponent:v,quickActionButtons:b,width:g,userExpandable:C}=e,{baseStyles:k,propertyFormat:w,propertySchema:P,shouldRenderTooltip:j,isEmpty:_}=(0,n.useContext)(y().OU),R=P,B=(0,f().jV)(null==k?void 0:k.tokenFormat),M=(0,r().VK)((()=>o.getPropertyValue(l)),[l,o]),T=(0,n.useMemo)((()=>R?u().ZG(M,R)??"":""),[M,R]),V=(null==w?void 0:w.statusShowAs)??"select",E=(0,s().yK)((()=>({buttonStyle:{...k.buttonStyle,..."select"===V?m:h},buttonPressedStyle:k.buttonPressedStyle??{},buttonHoveredStyle:k.buttonHoveredStyle??{}})),[k.buttonHoveredStyle,k.buttonPressedStyle,k.buttonStyle,m,h,V]);return _&&void 0===v?null:(0,S.jsx)(p().e,{ref:t,onContextMenu:i,editButtonClickProps:d,style:E.buttonStyle,pressedStyle:E.buttonPressedStyle,hoveredStyle:E.buttonHoveredStyle,tooltipPropertyValue:j&&"checkbox"===V?T:void 0,quickActionButtons:b,width:g,userExpandable:C,children:"checkbox"===V?(0,S.jsx)(Zo,{enablePointerEventsForInteractiveTypes:c,showLabel:x,propertyName:null==R?void 0:R.name,propertyValue:M,statusValue:T,editButtonClickProps:d,containerRef:t,store:o,property:l,disabled:a}):_&&void 0!==v?(0,S.jsx)(v,{}):(0,S.jsx)(Do,{statusValue:T,tokenFormat:B,store:o,property:l,propertySchema:R,parentHasTooltip:j})})})));function Do(e){const{statusValue:t,store:r,parentHasTooltip:i,property:l,propertySchema:a}=e,c=(0,s().Fg)(),u=(0,o(535950).g)({blockId:null==r?void 0:r.id,propertyId:l}),d=(0,We().H)({propertyId:l,store:r}),p=Boolean(d),y=(0,s().yK)((()=>({container:{...p||u?{...(0,He().Y)(c),paddingTop:3}:{},maxWidth:"fit-content"}})),[u,c,p]),{foundOption:m,foundGroup:f}=(0,n.useMemo)((()=>{const e=(null==a?void 0:a.options)??[],o=e.find((e=>e.value===t)),n=(null==a?void 0:a.groups)??[],r=o&&n.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(o.id)}));return{options:e,foundOption:o,foundGroup:r}}),[a,t]);return m?(0,S.jsx)(De().K,{style:y.container,className:d,children:(0,S.jsx)(o(533845).J,{type:"status",value:m.value,description:m.description,color:m.color,groupColor:null==f?void 0:f.color,shouldShowTooltip:!i})}):null}function Zo(e){const{propertyName:t,propertyValue:o,statusValue:r,showLabel:i,enablePointerEventsForInteractiveTypes:l,editButtonClickProps:s,containerRef:c,store:d,property:p,disabled:m}=e,{propertySchema:f,shouldRenderTooltip:h}=(0,n.useContext)(y().OU),x=f,v=ce(d,p,m),b=(0,a().O7)(),g=(0,n.useMemo)((()=>!!x&&u().rO(o,x,K().Z.getIntl())),[o,x]),C=(0,n.useCallback)((async e=>{const t=e.altKey;await bo().z({...s,element:c&&"current"in c?(null==c?void 0:c.current)??void 0:void 0,environment:b,statusSetCheckbox:!t})}),[c,s,b]);return(0,S.jsx)(ae().n,{onClick:C,propertyLabel:i?t:void 0,checked:g,enablePointerEventsForInteractiveTypes:l,tooltip:h?void 0:r,disabled:v,store:d,property:p})}const qo=(0,n.forwardRef)((function(e,t){const{shouldWrap:o}=(0,n.useContext)(y().OU),r=(0,s().yK)((()=>({checkboxButtonStyle:{padding:f().sf[m().C.Table].checkbox}})),[]),i=(0,n.useMemo)((()=>(0,S.jsx)(Pe().U,{},"comment")),[]),l=on(e,t,r);return(0,S.jsx)(Wo,{...l,checkboxShowLabel:!1,EmptyComponent:je().q8,collectionStore:e.collectionStore,quickActionButtons:i,userExpandable:o})})),zo=(0,n.forwardRef)((function(e,t){const o=on(e,t,(0,s().yK)((()=>({checkboxButtonStyle:{padding:f().sf[m().C.Page].checkbox}})),[])),r=(0,n.useMemo)((()=>(0,S.jsx)(Pe().U,{},"comment")),[]);return(0,S.jsx)(Wo,{...o,checkboxShowLabel:!1,EmptyComponent:je().T$,collectionStore:e.collectionStore,quickActionButtons:r})})),No=(0,n.forwardRef)((function(e,t){const o=on(e,t,(0,s().yK)((()=>({checkboxButtonStyle:{padding:f().sf[m().C.CompactPage].checkbox}})),[])),r=(0,n.useMemo)((()=>(0,S.jsx)(Pe().U,{},"comment")),[]);return(0,S.jsx)(Wo,{...o,checkboxShowLabel:!1,EmptyComponent:je().T$,quickActionButtons:r})})),Qo=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=on(e,t,(0,h().m)(t,e.collectionStore,e.property,"status"));return(0,S.jsx)(Wo,{...n,checkboxShowLabel:!1,EmptyComponent:o?je().s3:void 0})})),Go=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=on(e,t,(0,s().yK)((()=>({checkboxButtonStyle:{padding:f().sf[m().C.Board].checkbox}})),[]));return(0,S.jsx)(Wo,{...n,checkboxShowLabel:!0,EmptyComponent:o?je().s3:void 0})})),$o=(0,n.forwardRef)((function(e,t){const o=on(e,t);return(0,S.jsx)(Wo,{...o,checkboxShowLabel:!0})})),Yo=(0,n.forwardRef)((function(e,t){const o=on(e,t);return(0,S.jsx)(Wo,{...o,checkboxShowLabel:!0})})),Jo=(0,n.forwardRef)((function(e,t){const o=on(e,t);return(0,S.jsx)(Wo,{...o,checkboxShowLabel:!1})})),Xo=(0,n.forwardRef)((function(e,t){const o=on(e,t);return(0,S.jsx)(Wo,{...o,checkboxShowLabel:!1})})),en=(0,n.forwardRef)((function(e,t){const o=on(e,t);return(0,S.jsx)(Wo,{...o,checkboxShowLabel:!1})})),tn=(0,n.forwardRef)((function(e,t){const o=on(e,t);return(0,S.jsx)(Wo,{...o,checkboxShowLabel:!1,EmptyComponent:je().zX})}));function on(e,t,o){const{store:r,disabled:i,property:l,onContextMenu:a,enablePointerEventsForInteractiveTypes:s,width:c}=e,{propertyFormat:u}=(0,n.useContext)(y().OU),d="checkbox"===(null==u?void 0:u.statusShowAs),p=(0,le().Am)(e,{isStatusCheckbox:d});return{ref:t,store:r,disabled:i,property:l,selectButtonStyle:null==o?void 0:o.selectButtonStyle,checkboxButtonStyle:null==o?void 0:o.checkboxButtonStyle,editButtonClickProps:p,onContextMenu:a,enablePointerEventsForInteractiveTypes:s,width:c}}const nn=n.memo((0,n.forwardRef)(((e,t)=>{const{store:i,buttonStyle:l,onContextMenu:a,editButtonClickProps:c,quickActionButtons:u=[],EmptyComponent:d,property:m,width:f,linkifyUrls:h,disableLinks:v,userExpandable:b,clampLines:g,forceBlockPropertyButtonEnable:C=!1}=e,{isEmpty:k,baseStyles:w}=(0,n.useContext)(y().OU),P=(0,r().VK)((()=>i.getPropertyValue(m)),[m,i]),j=(0,s().yK)((()=>({buttonStyle:{...w.buttonStyle,...l},buttonPressedStyle:w.buttonPressedStyle??{},buttonHoveredStyle:w.buttonHoveredStyle??{}})),[w.buttonHoveredStyle,w.buttonPressedStyle,w.buttonStyle,l]);if(k&&void 0===d)return null;const _=!!g;return(0,S.jsx)(p().e,{ref:t,style:j.buttonStyle,hoveredStyle:j.buttonHoveredStyle,pressedStyle:j.buttonPressedStyle,onContextMenu:a,editButtonClickProps:c,quickActionButtons:u,forceEnableButton:C,width:f,userExpandable:b,children:k&&void 0!==d?(0,S.jsx)(d,{}):(0,S.jsx)(x().Y,{children:(0,S.jsx)(o(9656).A,{textValue:P,parentStore:i,linkifyUrls:h,disableLinks:v,shouldTruncate:_,clampLines:g})})})}))),rn=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,l=(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Page].text}})),[]),a=(0,n.useMemo)((()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(lt().Z,{store:o,property:r,openOverlay:!0},"autofill"),(0,S.jsx)(Pe().U,{},"comment"),(0,S.jsx)(d().q,{store:o,property:r,format:i},"copy")]})),[i,r,o]),c=hn(e,t,l);return(0,S.jsx)(nn,{...c,EmptyComponent:je().T$,quickActionButtons:a})})),ln=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l}=(0,a().Fy)(),{shouldWrap:c}=(0,n.useContext)(y().OU),u=(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Table].text}})),[]),p=(0,n.useMemo)((()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(lt().Z,{store:o,property:r,openOverlay:!0},"autofill"),(0,S.jsx)(Pe().U,{},"comment"),l?void 0:(0,S.jsx)(d().q,{store:o,property:r,format:i},"copy")]})),[i,l,r,o]),h=hn(e,t,u);return(0,S.jsx)(nn,{...h,EmptyComponent:je().q8,quickActionButtons:p,userExpandable:c})})),an=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l}=(0,a().Fy)(),c=(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.CompactPage].text,maxWidth:"300px"}})),[]),u=(0,n.useMemo)((()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(Pe().U,{},"comment"),l?void 0:(0,S.jsx)(d().q,{store:o,property:r,format:i},"copy")]})),[i,l,r,o]),p=hn(e,t,c);return(0,S.jsx)(nn,{...p,EmptyComponent:je().T$,quickActionButtons:u,linkifyUrls:!1,disableLinks:!0})})),sn=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=hn(e,t,(0,h().m)(t,e.collectionStore,e.property,"text"));return(0,S.jsx)(nn,{...n,EmptyComponent:o?je().s3:void 0})})),cn=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=hn(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Board].text}})),[]));return(0,S.jsx)(nn,{...n,EmptyComponent:o?je().s3:void 0})})),un=(0,n.forwardRef)((function(e,t){const o=hn(e,t);return(0,S.jsx)(nn,{...o})})),dn=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=hn(e,t);return(0,S.jsx)(nn,{...n,EmptyComponent:o?je().s3:void 0})})),pn=(0,n.forwardRef)((function(e,t){const o=hn(e,t);return(0,S.jsx)(nn,{...o})})),yn=(0,n.forwardRef)((function(e,t){const o=hn(e,t);return(0,S.jsx)(nn,{...o})})),mn=(0,n.forwardRef)((function(e,t){const o=hn(e,t);return(0,S.jsx)(nn,{...o})})),fn=(0,n.forwardRef)((function(e,t){const o=hn(e,t);return(0,S.jsx)(nn,{...o,EmptyComponent:je().zX})}));function hn(e,t,o){const{store:n,collectionStore:r,property:i,disabled:l,onContextMenu:a,width:s}=e;return{ref:t,store:n,collectionStore:r,property:i,disabled:l,editButtonClickProps:(0,le().Am)(e),onContextMenu:a,buttonStyle:null==o?void 0:o.buttonStyle,width:s}}var xn=()=>o(879952),Sn=()=>o(990966),vn=()=>o(561933),bn=()=>o(582835),gn=()=>o(419380),Cn=()=>o(943620);function kn(e){const{store:t}=e,r=(0,a().O7)(),l=(0,i().DK)(),c=(0,n.useCallback)((()=>{const e=t.getBlockTitleStore();(0,o(191560).v)({store:t}),xn().eP({environment:r,store:t}),Sn().setSelectionAtEnd({store:e}),o(491927).sd(r,"list_item_edit_mode_enter",{...(0,o(861026).Pn)(l),block_id:t.id,from:"click",view_type:"list"})}),[t,r,l]),u=(0,s().yK)((e=>({buttonStyle:{color:e.mediumTextColor,fill:e.mediumTextColor,height:20,width:26},iconStyle:{color:e.mediumTextColor,fill:e.mediumTextColor}})),[]);return(0,S.jsx)(W().Z,{renderTooltip:()=>(0,S.jsx)(V()._H,{defaultMessage:"Edit",id:"collectionViewItem.edit.tooltip"}),render:e=>(0,S.jsx)(o(1910).Z,{icon:vo().R,ariaLabel:"edit",onClick:c,hasBackground:!0,showShadow:!1,style:u.buttonStyle,iconStyle:u.iconStyle,...e})})}var wn=()=>o(827282),Pn=()=>o(497065),jn=()=>o(887430),_n=()=>o(949842);const Rn=(0,V().vU)({openAsPageTitle:{defaultMessage:"Open",id:"database.actionButton.openAsPageTitle"}});function Bn(e){const{store:t,handleOpenPeekPage:c,showLabel:u,showIcon:d}=e,p=(0,a().O7)(),y=(0,i().DK)(),{peekModeProps:m}=(0,r().VK)((()=>{const e=void 0!==y?jn().kr(y):"full_page";return{peekModeProps:(0,l().X9)(e,!1)}}),[y],{useDeepEqual:!0}),f=(0,r().VK)((()=>(0,o(429725).ZP)({store:t,fullyQualified:!1,pageVisitSource:o(506347).tY.LinkInPage})),[t]),h=(0,n.useCallback)((()=>{const{mainEditorCurrentBlockStore:e}=o(876822).default.state;return jn().mb({environment:p,store:t,mainEditorCurrentBlockStore:e,collectionContextStore:y,fullyQualified:!1})}),[p,y,t]),x=(0,n.useCallback)((e=>{if(e.metaKey||e.ctrlKey)Pn().c4({environment:p,url:f,openInNew:"tab"});else{const e=h();e&&(c&&c(),Pn().c4({environment:p,url:e}))}}),[p,h,f,c]),v=(0,n.useCallback)((e=>{1===e.button&&Pn().c4({environment:p,url:f,openInNew:"tab"})}),[p,f]),b=(0,n.useCallback)((e=>{(0,_n().ZP)({event:e,context:_n().Af.EditorMouseDown,callback:()=>{e.preventDefault()}})}),[]),g=(0,s().yK)((e=>({buttonStyle:{color:e.mediumTextColor,fill:e.mediumTextColor,fontFamily:ct().Gl.sans,...!u&&{width:26},background:e.whiteButtonBackground,border:void 0,fontSize:12,fontWeight:ct().Ue.medium,textTransform:"uppercase",letterSpacing:.5,borderRadius:6,height:20,display:"flex",paddingLeft:4,paddingRight:6},buttonHoveredStyle:{background:e.whiteButtonHoveredBackground},buttonPressedStyle:{background:e.whiteButtonPressedBackground},iconStyle:{width:wn().ZG.default,height:wn().ZG.default,color:e.mediumTextColor,fill:e.mediumTextColor,marginRight:4}})),[u]);return(0,S.jsx)(W().Z,{renderTooltip:()=>m.tooltip,render:e=>(0,S.jsx)("div",{onAuxClick:v,onMouseDown:b,children:(0,S.jsx)(H().Z,{onClick:x,icon:d?m.icon:void 0,ariaLabel:m.tooltip,size:"sm",style:g.buttonStyle,iconStyle:g.iconStyle,hoveredStyle:g.buttonHoveredStyle,pressedStyle:g.buttonPressedStyle,...e,children:u?K().Z.formatMessage(Rn.openAsPageTitle):void 0})})})}const Mn=n.memo((0,n.forwardRef)((function(e,t){const{store:i,collectionStore:c,buttonStyle:u,textStyle:d,recordIconStyle:m,format:f,editButtonClickProps:h,onContextMenu:x,quickActionButtons:v,quickActionButtonsStyle:b,onTab:g,onUntab:C,forceMouseEntered:k,iconActionFrom:w,iconSize:P,showIcon:j,titlePropertyType:_,property:R,linkifyText:B,width:M,commentsIndicatorStyle:T,userExpandable:I}=e,A=(0,a().O7)(),{isMobile:O}=(0,a().Fy)(),F=(0,V().YB)(),U=(0,s().Fg)(),{baseStyles:L,collectionContextStore:H,isReadOnly:W,propertySchema:D}=(0,n.useContext)(y().OU),Z=(0,r().VK)((()=>(0,vn().JI)(i)),[i],{useDeepEqual:!0}),q=(0,r().VK)((()=>{var e;return(null===(e=i.getModel())||void 0===e?void 0:e.getEmptyTitlePlaceholder({getRecordModel:i.getRecordModel,intl:F,userTimeZone:(0,uo().r)()}))||F.formatMessage(An.untitledBlock)}),[i,F]),{collectionViewBlockId:z,collectionViewId:N}=(0,r().VK)((()=>{var e,t;return{collectionViewId:null==H||null===(e=H.collectionViewStore())||void 0===e?void 0:e.id,collectionViewBlockId:null==H||null===(t=H.collectionViewBlockStore())||void 0===t?void 0:t.id}}),[H]),Q=(0,r().VK)((()=>{if("inlineEditable"!==_)return;const e=gn().Z.state;return Boolean(e.isActive&&e.store.id===i.id)}),[i.id,_]),{icon:G,iconStore:$,isEmptyPage:Y,recordTable:J,blockType:X,hasError:ee}=(0,r().VK)((()=>{var e;return{icon:i.getIcon(),iconStore:i.getIconStore(),isEmptyPage:i.isEmptyPage(),recordTable:null===(e=i.getIconStore())||void 0===e?void 0:e.table,blockType:i.getType(),hasError:i.hasError()}}),[i],{useDeepEqual:!0}),te=(0,lo().us)(R),oe=(0,r().VK)((()=>{if(!te)return B?l().Hw({store:i,propertySchema:(0,Ce().$)(D),property:R}):void 0;const e=i.getFormatStore().getKeyStore("uri").getValue(),t=e&&o(916673).Nm({str:e,allowNoProtocol:!1});return t&&(0,o(417746).pI)(t,i.pointer.spaceId)}),[te,i,B,D,R]),re=(0,n.useCallback)((()=>{H&&te&&ne().YU({environment:A,collectionContextStore:H,block_id:i.id,property:R,from:l().Sy(f),is_external_title_property_id:!0})}),[H,A,f,R,i.id,te]),le=(0,n.useCallback)((e=>{$&&ie().createAndCommit({userAction:"TitleProperty.handleRecordIconChange",environment:A,canUndo:!0,perform:t=>{o(636340).sO({store:$,value:e,transaction:t})}})}),[A,$]),ae=(0,n.useCallback)((e=>{"Enter"!==(null==e?void 0:e.key)&&(H&&ne().rv({environment:A,collectionContextStore:H,block_id:i.id,property:"title",property_type:"text",from:"list"}),(0,o(864871).I)({store:i}))}),[A,i,H]),se=(0,n.useCallback)((e=>{e.target.scrollLeft=0}),[]),ce=(0,n.useCallback)((()=>{gn().Z.setState({isActive:!1}),Sn().clear({environment:A}),xn().Ys({environment:A,store:i})}),[i,A]),ue=(0,r().VK)((()=>{if(H){const e=H.searchQueryStore.state;return e.length>0?e:void 0}}),[H]),de=(0,r().VK)((()=>yt().l.state??ue),[ue]),pe=(0,n.useMemo)((()=>({type:"page_property_value_match",collectionViewBlockId:z,collectionViewId:N,propertyId:"title"})),[z,N]),ye=(0,r().VK)((()=>{const e=yt().V.state;return(0,o(12512).yy)(e)&&e.id===i.id?e:void 0}),[i.id]),me=(0,s().yK)((()=>({textStyle:{...L.textStyle,display:"inline",fontWeight:ct().Ue.medium,...d,marginRight:O?3:5},buttonStyle:{...L.buttonStyle,...u},quickActionButtonsStyle:{...b},buttonPressedStyle:{...L.buttonPressedStyle,background:"none"},buttonHoveredStyle:{...L.buttonHoveredStyle,background:"none"},recordIconStyle:{display:"inline-flex",verticalAlign:"text-top",...m},link:{display:"inline"},subitemCountIndicator:{display:"inline-flex",alignItems:"center",verticalAlign:"text-top"},parentItemIndicator:{display:"inline-flex",alignItems:"center",verticalAlign:"text-top"},discussionIndicator:{display:"inline-flex",alignItems:"center",color:U.lightTextColor,fontSize:12,fontWeight:ct().Ue.medium,verticalAlign:"text-top"},errorIcon:{display:"inline-block",verticalAlign:"text-top",marginLeft:1,marginRight:7,paddingBottom:4,width:16,fill:U.accentColors.orange[500]}})),[L.buttonHoveredStyle,L.buttonPressedStyle,L.buttonStyle,L.textStyle,u,b,m,d,U,O]),fe=(0,r().VK)((()=>{var e;switch(_){case"inlineEditable":const t=Q?K().Z.formatMessage(An.typeAName):q;return(0,S.jsx)(o(623498).Z,{store:Z,disabled:!Q,disableSlashCommands:!0,disableEmojiCommands:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableEmbedMenu:!0,disableShiftEnter:!0,onEnter:ce,onEsc:ce,onTab:g,onUntab:C,onChange:ae,onBlur:se,placeholder:t,style:me.textStyle,disableSelectAllBlocks:!0,pasteBehavior:"inline",inPageFind:pe});case"hidePlaceholderText":let n=null===(e=i.getTitleStore())||void 0===e?void 0:e.getValue();i.isType("external_object_instance_page")&&(n=i.getPropertyValue(R)),de&&de.length>0&&n&&(n=pt().cD({textValue:n,blockId:i.id,textProps:pe,find:de,currentFocusedResult:ye}));const r=pt().IY({environment:A,textValue:n&&{value:n,spaceId:(0,at().J)(i.pointer.spaceId)},parentStore:i,disableHover:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!0,disabled:!0,theme:U,emojiType:(0,dt().e_)(A),katex:A.KatexStore.getKatex(),formulaValueTypes:[]});return(0,S.jsx)("span",{style:me.textStyle,children:r});case"showPlaceholderAsTitle":return(0,S.jsx)(o(384241).Z,{style:me.textStyle,store:i});default:(0,E().t1)(_)}}),[_,Q,Z,ce,g,C,ae,se,me.textStyle,pe,i,de,A,U,R,ye,q]),he=(0,n.useMemo)((()=>ee?(0,o(521913).t)(me.errorIcon):"never"===j||"withContent"===j&&void 0===G&&Y?null:W?(0,S.jsx)(Cn().Z,{disabled:!0,icon:G,isEmptyPage:Y,size:P,style:me.recordIconStyle}):(0,S.jsx)(Cn().Z,{disabled:!1,bucket:"secure",store:i,icon:G,isEmptyPage:Y,size:P,iconLoggingData:{collection_id:c.id,recordTable:J,source:w,block_type:X},style:me.recordIconStyle,onChange:le})),[X,c.id,le,ee,G,w,Y,W,P,J,j,i,me.errorIcon,me.recordIconStyle]),xe=(0,r().VK)((()=>H&&(0,bn().Cr)({collectionContextStore:H,blockStore:i})&&(0,S.jsx)("span",{style:me.parentItemIndicator,children:(0,S.jsx)(o(596324).O,{blockStore:i,collectionContextStore:H,columnWidth:M})})),[H,i,me.parentItemIndicator,M]),Se=(0,r().VK)((()=>H&&(0,bn().wI)({collectionContextStore:H,blockStore:i})&&(0,S.jsx)("span",{style:me.subitemCountIndicator,children:(0,S.jsx)(o(973509).B,{blockStore:i,collectionContextStore:H})})),[H,i,me.subitemCountIndicator]);return(0,S.jsxs)(p().e,{ref:t,editButtonClickProps:h,onContextMenu:x,style:me.buttonStyle,pressedStyle:me.buttonPressedStyle,hoveredStyle:me.buttonHoveredStyle,quickActionButtons:v,quickActionButtonsStyle:me.quickActionButtonsStyle,quickActionButtonsForceVisible:O?void 0:k,tooltipHide:!0,userExpandable:I,children:[he,!Q&&oe?(0,S.jsx)(o(164809).Z,{href:oe,external:te,onClick:re,style:me.link,children:fe}):fe,xe,Se,(0,S.jsx)(o(280080).s,{store:i,iconStyle:me.discussionIndicator,buttonStyle:T})]})}))),Tn=(0,n.forwardRef)((function(e,t){const{store:o,handleOpenPeekPage:i,width:c}=e,{isMobile:u}=(0,a().Fy)(),{collectionContextStore:d,isReadOnly:p,shouldWrap:h}=(0,n.useContext)(y().OU),x=(0,s().yK)((e=>({buttonStyle:{padding:f().sf[m().C.Table].text},textStyle:{...l().z0(e)},recordIconStyle:{height:22,width:22,margin:"-2px 3px 0px -2px"},dbCommentButton:{position:"relative",top:2,marginTop:-2.8}})),[]),v=(0,r().VK)((()=>(null==d?void 0:d.shouldShowPageIcon())??!0),[d]),b=(0,n.useMemo)((()=>(0,S.jsx)(Bn,{handleOpenPeekPage:i,store:o,showLabel:u||void 0===c||c>100,showIcon:!u})),[i,u,o,c]),g=In(e,t,x);return(0,S.jsx)(Mn,{...g,iconActionFrom:"collection_table_view",showIcon:v?"withContent":"never",iconSize:20,titlePropertyType:"hidePlaceholderText",quickActionButtons:b,linkifyText:p,commentsIndicatorStyle:x.dbCommentButton,userExpandable:h})})),Vn=(0,n.forwardRef)((function(e,t){const{store:i}=e,{isPhone:l,isMobile:c}=(0,a().Fy)(),{isReadOnly:u,collectionContextStore:d}=(0,n.useContext)(y().OU),p=(0,r().VK)((()=>{const e=gn().Z.state;return Boolean(e.isActive&&e.store.id===i.id)}),[i]),m=(0,r().VK)((()=>!!d&&d.isInHomeWidgetStore.state),[d]),f=(0,r().VK)((()=>(null==d?void 0:d.shouldShowPageIcon())??!0),[d]),h=(0,n.useMemo)((()=>!c&&(!u&&!p?(0,S.jsx)(kn,{store:i}):(0,S.jsx)(Bn,{store:i,showLabel:!1,showIcon:!0}))),[p,c,u,i]),x=(0,s().yK)((()=>({buttonStyle:{marginLeft:0,marginRight:0,paddingLeft:m?o(170210).A5/2:void 0,flexGrow:1,flexShrink:1,flexBasis:"auto",maxWidth:void 0,minWidth:l?void 0:240},textStyle:{fontSize:m?14:16,whiteSpace:p?"pre":"nowrap",pointerEvents:p?void 0:"none",cursor:p?"text":void 0,width:"auto",textOverflow:p?void 0:"ellipsis"},recordIconStyle:{marginRight:5},actionButton:{marginLeft:10,marginRight:1,order:3}})),[p,m,l]),v=In(e,t,x);return(0,S.jsx)(Mn,{...v,iconActionFrom:"collection_list_view",showIcon:f?"always":"never",iconSize:m?16:22,editButtonClickProps:void 0,quickActionButtonsStyle:x.actionButton,quickActionButtons:h,titlePropertyType:"inlineEditable"})})),En=(0,n.forwardRef)((function(e,t){o(799891).log({level:"error",from:"BlockPropertyValue",type:"BlockPropertyValue.InvalidTitlePropertyFormat"});const n=In(e,t);return(0,S.jsx)(Mn,{...n,iconActionFrom:"collection_table_view",showIcon:"always",iconSize:20,titlePropertyType:"hidePlaceholderText"})}));function In(e,t,o){const{store:n,collectionStore:r,property:i,disabled:l,onContextMenu:a,format:s,onTab:c,onUntab:u,forceMouseEntered:d,width:p}=e;return{ref:t,store:n,collectionStore:r,property:i,disabled:l,editButtonClickProps:(0,le().Am)(e),onContextMenu:a,buttonStyle:null==o?void 0:o.buttonStyle,textStyle:null==o?void 0:o.textStyle,recordIconStyle:null==o?void 0:o.recordIconStyle,quickActionButtonsStyle:null==o?void 0:o.quickActionButtonsStyle,format:s,onTab:c,onUntab:u,forceMouseEntered:d,width:p}}const An=(0,V().vU)({untitledBlock:{defaultMessage:"Untitled",id:"collectionViewItemTitle.untitledBlock"},typeAName:{defaultMessage:"Type a name",id:"collectionViewItemTitle.itemName.placeholder"}});var On=()=>o(496205);const Kn=n.memo(n.forwardRef((function(e,t){var i;const{property:l,store:a,collectionStore:c,buttonStyle:u,editButtonClickProps:d,EmptyComponent:m}=e,{isReadOnly:f,propertySchema:h,baseStyles:x,collectionSchema:v}=(0,n.useContext)(y().OU),b=h,g=(0,r().VK)((()=>!(!b||!v)&&vn()._W(b,a,v)),[b,v,a]),C=(0,r().VK)((()=>{var e;if(c.isPageTreeCollection())return!0;const t=null==a||null===(e=a.getSpaceStore())||void 0===e?void 0:e.getModel();return!!t&&(0,On().$T)(t)}),[c,a]),k=f||!g||!C,w=(0,s().yK)((e=>({buttonStyle:{...x.buttonStyle,...u,cursor:k?"text":"pointer"},buttonPressedStyle:x.buttonPressedStyle??{},buttonHoveredStyle:x.buttonHoveredStyle??{},secondaryTooltipText:{color:e.mediumInvertedTextColor}})),[x.buttonHoveredStyle,x.buttonPressedStyle,x.buttonStyle,u,k]),P=(0,r().VK)((()=>{const e=a.getPropertyValue(l);return(0,On()._w)(e)}),[l,a]),j=(0,n.useMemo)((()=>(0,On().WN)(P)),[P]),_=(0,n.useMemo)((()=>{if("none"!==j.type)return(0,S.jsx)(o(593067).Z,{verificationState:j,blockStore:a})}),[a,j]),R=(0,n.useMemo)((()=>{var e;if(!(!g||!C)||!v)return;if(!C)return(0,S.jsx)(V()._H,{defaultMessage:"Upgrade plan to edit verification",id:"VerificationPropertyButton.tooltip.nonWikiVerificationRestrictedToBusinessTier"});const t=null==b?void 0:b.verifier_property,o=t?null===(e=v[t])||void 0===e?void 0:e.name:void 0;return(0,S.jsx)(Fn,{verifierPropertyName:o})}),[g,v,C,null==b?void 0:b.verifier_property]),B="none"===j.type;return B&&void 0===m?null:(0,S.jsx)(p().e,{ref:t,editButtonClickProps:k?void 0:d,style:w.buttonStyle,hoveredStyle:w.buttonHoveredStyle,pressedStyle:w.buttonPressedStyle,tooltipPropertyValue:_,tooltipPropertyCaption:R,children:B&&void 0!==m?(0,S.jsx)(m,{}):(0,S.jsx)(o(783901).z,{verificationValue:P,fontSize:null===(i=x.buttonStyle)||void 0===i?void 0:i.fontSize})})})));function Fn(e){const{verifierPropertyName:t}=e;return t?(0,S.jsx)(V()._H,{defaultMessage:"Only people listed in {verifierPropertyName} can verify this page",id:"VerificationPropertyButton.tooltip.editRestrictedToVerifier",values:{verifierPropertyName:(0,S.jsx)("span",{style:{fontWeight:ct().Ue.bold},children:t})}}):(0,S.jsx)(V()._H,{defaultMessage:"Only page owners can verify this page",id:"VerificationPropertyButton.tooltip.editRestrictedToOwner"})}const Un=n.forwardRef((function(e,t){const o=$n(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Table].text}})),[]));return(0,S.jsx)(Kn,{...o,EmptyComponent:je().q8})})),Ln=n.forwardRef((function(e,t){const o=$n(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Page].text}})),[]));return(0,S.jsx)(Kn,{...o,EmptyComponent:je().T$})})),Hn=n.forwardRef((function(e,t){const o=$n(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.CompactPage].text}})),[]));return(0,S.jsx)(Kn,{...o,EmptyComponent:je().T$})})),Wn=n.forwardRef((function(e,t){const o=$n(e,t);return(0,S.jsx)(Kn,{...o,EmptyComponent:je().zX})})),Dn=n.forwardRef((function(e,t){const{collectionStore:o,store:i,showIfEmpty:l}=e,{propertySchema:a}=(0,n.useContext)(y().OU),s=a,c=(0,r().VK)((()=>o.getSchema()),[o]),u=(0,r().VK)((()=>!!s&&vn()._W(s,i,c)),[s,c,i]),d=$n(e,t,(0,h().m)(t,e.collectionStore,e.property,"verification"));return(0,S.jsx)(Kn,{...d,EmptyComponent:l&&u?je().s3:void 0})})),Zn=n.forwardRef((function(e,t){const{collectionStore:o,store:i,showIfEmpty:l}=e,{propertySchema:a}=(0,n.useContext)(y().OU),c=a,u=(0,r().VK)((()=>o.getSchema()),[o]),d=(0,r().VK)((()=>!!c&&vn()._W(c,i,u)),[c,u,i]),p=$n(e,t,(0,s().yK)((()=>({buttonStyle:{padding:f().sf[m().C.Board].text}})),[]));return(0,S.jsx)(Kn,{...p,EmptyComponent:l&&d?je().s3:void 0})})),qn=n.forwardRef((function(e,t){const o=$n(e,t);return(0,S.jsx)(Kn,{...o})})),zn=n.forwardRef((function(e,t){const o=$n(e,t);return(0,S.jsx)(Kn,{...o})})),Nn=n.forwardRef((function(e,t){const o=$n(e,t);return(0,S.jsx)(Kn,{...o})})),Qn=n.forwardRef((function(e,t){const o=$n(e,t);return(0,S.jsx)(Kn,{...o})})),Gn=n.forwardRef((function(e,t){const o=$n(e,t);return(0,S.jsx)(Kn,{...o})}));function $n(e,t,o){const{store:n,collectionStore:r,property:i,onClick:l,onContextMenu:a}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,le().Am)(e),onClick:l,onContextMenu:a,buttonStyle:null==o?void 0:o.buttonStyle}}const Yn=n.memo(n.forwardRef((function(e,t){const{property:o,format:n,propertyType:r,innerProps:i}=e;if(!r)return null;const l=Jn[n][r];return null===l?null:(0,S.jsx)(l,{ref:t,...i,property:o,format:n})}))),Jn={[m().C.Table]:{checkbox:ue,created_by:no().QA,created_time:Le().lQ,date:Le().lQ,email:Re,file:ze,formula:it().n8,last_edited_by:no().QA,last_edited_time:Le().lQ,last_visited_time:Le().lQ,location:Mt,multi_select:Wt().d3,number:zt,person:no().QA,phone_number:Re,relation:ro().z8,rollup:Bo,select:Ho().CQ,status:qo,text:ln,title:Tn,url:Re,verification:Un,auto_increment_id:g,button:Z,geo_point:xt},[m().C.Board]:{checkbox:me,created_by:no().Ss,created_time:Le().Gx,date:Le().Gx,email:Ve,file:Ye,formula:it().mm,last_edited_by:no().Ss,last_edited_time:Le().Gx,last_visited_time:Le().Gx,location:At,multi_select:Wt().dE,number:Gt,person:no().Ss,phone_number:Ve,relation:ro().p5,rollup:Io,select:Ho().aJ,status:Go,text:cn,title:En,url:Ve,verification:Zn,auto_increment_id:P,button:G,geo_point:bt},[m().C.Calendar]:{checkbox:fe,created_by:no().u9,created_time:Le().Vq,date:Le().Vq,email:Ee,file:Je,formula:it().yJ,last_edited_by:no().u9,last_edited_time:Le().Vq,last_visited_time:Le().Vq,location:Ot,multi_select:Wt().vt,number:$t,person:no().u9,phone_number:Ee,relation:ro().Il,rollup:Ao,select:Ho().Rk,status:$o,text:un,title:En,url:Ee,verification:qn,auto_increment_id:j,button:$,geo_point:gt},[m().C.ListView]:{checkbox:ye,created_by:no().l2,created_time:Le().nm,date:Le().nm,email:Te,file:$e,formula:it().p5,last_edited_by:no().l2,last_edited_time:Le().nm,last_visited_time:Le().nm,location:It,multi_select:Wt().qk,number:Qt,person:no().l2,phone_number:Te,relation:ro().G7,rollup:Eo,select:Ho().G5,status:Qo,text:sn,title:Vn,url:Te,verification:Dn,auto_increment_id:w,button:Q,geo_point:vt},[m().C.GalleryView]:{checkbox:he,created_by:no().ht,created_time:Le().T3,date:Le().T3,email:Ie,file:Xe,formula:it().tD,last_edited_by:no().ht,last_edited_time:Le().T3,last_visited_time:Le().T3,location:Kt,multi_select:Wt()._1,number:Yt,person:no().ht,phone_number:Ie,relation:ro().Bn,rollup:Oo,select:Ho().nL,status:Yo,text:dn,title:En,url:Ie,verification:zn,auto_increment_id:_,button:Y,geo_point:Ct},[m().C.Timeline]:{checkbox:xe,created_by:no().WY,created_time:Le().Fm,date:Le().Fm,email:Ae,file:et,formula:it().uS,last_edited_by:no().WY,last_edited_time:Le().Fm,last_visited_time:Le().Fm,location:Ft,multi_select:Wt().hO,number:Jt,person:no().WY,phone_number:Ae,relation:ro().Ck,rollup:Ko,select:Ho().t8,status:Jo,text:pn,title:En,url:Ae,verification:Nn,auto_increment_id:R,button:J,geo_point:kt},[m().C.Page]:{checkbox:de,created_by:no().uH,created_time:Le().JM,date:Le().JM,email:Be,file:Ne,formula:it().wC,last_edited_by:no().uH,last_edited_time:Le().JM,last_visited_time:Le().JM,location:Tt,multi_select:Wt().ps,number:qt,person:no().uH,phone_number:Be,relation:ro().Ey,rollup:Mo,select:Ho().Bx,status:zo,text:rn,title:En,url:Be,verification:Ln,auto_increment_id:b,button:q,geo_point:ht},[m().C.CompactPage]:{checkbox:pe,created_by:no().yM,created_time:Le().wi,date:Le().wi,email:Me,file:Qe,formula:it().lE,last_edited_by:no().yM,last_edited_time:Le().wi,last_visited_time:Le().wi,location:Vt,multi_select:Wt().zu,number:Nt,person:no().yM,phone_number:Me,relation:ro().w4,rollup:To,select:Ho().rf,status:No,text:an,title:En,url:Me,verification:Hn,auto_increment_id:C,button:z,geo_point:St},[m().C.Relation]:{checkbox:Se,created_by:no().ku,created_time:Le().g4,date:Le().g4,email:Oe,file:tt,formula:it().eQ,last_edited_by:no().ku,last_edited_time:Le().g4,last_visited_time:Le().g4,location:Ut,multi_select:Wt().aE,number:Xt,person:no().ku,phone_number:Oe,relation:ro().NY,rollup:Fo,select:Ho().qG,status:Xo,text:yn,title:En,url:Oe,verification:Qn,auto_increment_id:B,button:X,geo_point:wt},[m().C.RelationSection]:{checkbox:ve,created_by:no().bQ,created_time:Le().ct,date:Le().ct,email:Ke,file:ot,formula:it().CJ,last_edited_by:no().bQ,last_edited_time:Le().ct,last_visited_time:Le().ct,location:Lt,multi_select:Wt().Yh,number:eo,person:no().bQ,phone_number:Ke,relation:ro().fU,rollup:Uo,select:Ho().Z,status:en,text:mn,title:En,url:Ke,verification:Gn,auto_increment_id:M,button:ee,geo_point:Pt},[m().C.Mini]:{checkbox:be,created_by:no().Xl,created_time:Le().CJ,date:Le().CJ,email:Fe,file:Ge,formula:it().iM,last_edited_by:no().Xl,last_edited_time:Le().CJ,last_visited_time:Le().CJ,location:Et,multi_select:Wt().ZD,number:to,person:no().Xl,phone_number:Fe,relation:ro().up,rollup:Vo,select:Ho().K7,status:tn,text:fn,title:En,url:Fe,verification:Wn,auto_increment_id:k,button:N,geo_point:jt},[m().C.PropertyModule]:{checkbox:de,created_by:no().HW,created_time:Le().JM,date:Le().JM,email:Be,file:nt,formula:it().wC,last_edited_by:no().HW,last_edited_time:Le().JM,last_visited_time:Le().JM,location:Tt,multi_select:Wt().ps,number:qt,person:no().HW,phone_number:Be,relation:ro().YS,rollup:Mo,select:Ho().Bx,status:zo,text:rn,title:En,url:Be,verification:Ln,auto_increment_id:b,button:q,geo_point:ht}},Xn=n.memo((function(e){const{property:t,collectionStore:a,format:s,formDataStore:c,onTab:u,onUntab:d,onEnter:p,onEsc:m,onBgClick:f,onOpenProperty:h,store:x}=e,v=(0,o(185697).K)({collectionStore:a,property:t}),b=function(e,t,o){const n=(0,i().DK)();return(0,r().VK)((()=>{var r;const i=e.getSchema();return(null==t||null===(r=t.getFormState())||void 0===r||null===(r=r.collectionSchema)||void 0===r?void 0:r[o])??i[o]??(null==n?void 0:n.normalizedSchemaStore.state[o])}),[n,t,e,o],{debugName:"usePropertySchema"})}(a,c,v),g=(0,n.useContext)(o(939513).U),C=(0,n.useRef)(null);return(0,o(98642).c)(o(983993).Z,(()=>({getNode:()=>{const{current:e}=C;return e?"getNode"in e?e.getNode():e:null},props:{onTab:u,onUntab:d,onEnter:p,onEsc:m,onBgClick:f,onOpenProperty:h,property:v,format:s,store:x},getScrollerContext:()=>g})),[g,u,d,p,m,f,h,v,s,x]),null!=b&&b.type?(0,S.jsx)(y().Zj,{innerProps:e,property:v,unmappedProperty:t,propertySchema:b,containerRef:C,children:(0,l().xE)(s)?(0,S.jsx)(o(11593).g,{ref:C,innerProps:e,format:s,property:v,propertyType:null==b?void 0:b.type}):(0,S.jsx)(Yn,{ref:C,innerProps:e,format:s,property:v,propertyType:null==b?void 0:b.type})}):null}))},760536:(e,t,o)=>{o.d(t,{Z:()=>n});const n=32},664136:(e,t,o)=>{o.d(t,{Z:()=>ze});o(492176),o(670560),o(7961),o(267602),o(653476),o(470928),o(241792);var n=o(667294),r=()=>o(492788),i=()=>o(219727),l=()=>o(657320),a=()=>o(142735),s=()=>o(846550),c=()=>o(156642),u=()=>o(15607),d=()=>o(226413),p=()=>o(532850),y=()=>o(216939),m=()=>o(803021),f=()=>o(965800),h=()=>o(442884),x=()=>o(949489),S=()=>o(396136),v=()=>o(752778),b=()=>o(255393),g=()=>o(955620),C=()=>o(788860),k=()=>o(513670),w=()=>o(696459),P=()=>o(326966),j=()=>o(491927),_=()=>o(250303),R=()=>o(286310),B=()=>o(909240),M=()=>o(295274),T=()=>o(332542),V=()=>o(636340),E=()=>o(531515),I=()=>o(970105),A=()=>o(269299),O=()=>o(351763),K=()=>o(23151),F=()=>o(544179),U=()=>o(518645),L=()=>o(612427),H=()=>o(887430),W=()=>o(958783),D=()=>o(125659),Z=()=>o(141735),q=()=>o(589024),z=()=>o(861026),N=()=>o(982855),Q=()=>o(12512),G=()=>o(659234),$=()=>o(148976),Y=()=>o(677559),J=()=>o(620218),X=()=>o(820748),ee=()=>o(998901),te=()=>o(82548),oe=()=>o(826955),ne=()=>o(965903),re=()=>o(897257),ie=()=>o(265640),le=()=>o(78078),ae=()=>o(94967),se=()=>o(292518),ce=()=>o(967092),ue=()=>o(67961),de=()=>o(530671),pe=()=>o(468193),ye=()=>o(623498),me=()=>o(291198),fe=()=>o(932641),he=o(785893);function xe(e){const{disabled:t,value:r,insertChar:i,format:l,onChange:a,isTable:c,size:u}=e,[d,p]=(0,n.useState)(""),y=(0,C().YB)(),m=(0,n.useCallback)((e=>{let t=(0,o(946444).m)(e,y);return"percent"===l&&void 0!==t&&(t/=100),t}),[y,l]),f=(0,n.useRef)(!1);(0,n.useEffect)((()=>{f.current||(p(o(996106).uf(r,l,y)||""),f.current=!0)}),[l,y,r]),(0,n.useEffect)((()=>{i&&(p(i),a(m(i)))}),[i,a,m]);const h=(0,n.useCallback)((e=>{const t=e.target.value;p(t),a(m(t))}),[a,m]),x=(0,s().yK)((()=>({input:{textAlign:c?"right":"left"},inputContainer:{..."large"===u?fe().Ww:fe().FL,display:"block"}})),[c,u]);return(0,he.jsx)(ae().Z,{debugName:"NumberPropertyValue",capture:!t,onDelete:k().yR,onSpace:k().yR,onBackspace:k().yR,onLeft:k().yR,onRight:k().yR,onUp:k().yR,onDown:k().yR,onSelectAll:k().yR,onRedo:k().yR,onUndo:k().yR,onCut:k().yR,onCopy:k().yR,onPaste:k().yR,onKeypress:k().yR,children:(0,he.jsx)(me().Z,{style:x.inputContainer,value:d,format:me().B.Transparent,onChange:h,inputStyle:x.input,focus:!t,disabled:t})})}const Se=n.memo(xe),ve=n.memo((function(e){const{disabled:t,inputType:o,onChange:n,value:r}=e;return(0,he.jsx)(ae().Z,{debugName:"URLPropertyValue",capture:!t,onDelete:k().yR,onSpace:k().yR,onBackspace:k().yR,onLeft:k().yR,onRight:k().yR,onUp:k().yR,onDown:k().yR,onSelectAll:k().yR,onRedo:k().yR,onUndo:k().yR,onCut:k().yR,onCopy:k().yR,onPaste:k().yR,onKeypress:k().yR,children:(0,he.jsx)(me().Z,{type:o,style:{...fe().FL,display:"block"},value:r,format:me().B.Transparent,onChange:e=>function(e){const{onChange:t,e:o}=e,n=o.target.value;t(n)}({e,onChange:n}),focus:!t,disabled:t})})}));var be=()=>o(356321),ge=()=>o(201608),Ce=()=>o(102182),ke=()=>o(195395),we=()=>o(58836);function Pe(e,t){const o=(0,i().O7)(),r=(0,C().YB)(),{value:l}=(0,Y().XJ)(Z().F.formulas),[s,c]=(0,n.useState)(),[u,p]=(0,n.useState)(!1),y=(0,a().VK)((()=>{const n=t&&d().qQ(t)?d().q3(t):void 0;return!(0,ge().bb)({store:e.store,schema:e.store.getSchema(),property:e.property,userId:o.currentUser.id,formulasModule:l})&&(null==n?void 0:n.auto_update_on_edit)&&!u}),[e.property,e.store,t,u,o,l]),m=(0,n.useCallback)((()=>{c(void 0)}),[]),f=(0,a().VK)((()=>{var t;return null===(t=e.store)||void 0===t||null===(t=t.getFormat())||void 0===t||null===(t=t.ai_property_inference_map)||void 0===t||null===(t=t[e.property])||void 0===t?void 0:t.inference_id}),[e]),h=(0,n.useCallback)((e=>{O().submitFeedbackForAiAutofill({environment:o,inferenceId:f,feedbackType:e.type,userContent:e.userContent,shareWithNotion:e.shareWithNotion}),p(!0),Ce().oV({label:r.formatMessage({id:"database.propertyValues.submitAIAutofillFeedbackThanks",defaultMessage:"Thank you for making Notion better!"})})}),[o,r,f]);return{feedbackState:s,setFeedbackState:c,handleFeedbackButtonDismiss:m,handleFeedbackButtonSubmit:h,shouldDisplayFeedbackButtons:Boolean(y)}}function je(e){let{autofillBlockPropertyValueFeedbackButtonsState:t}=e;const o=(0,i().O7)(),r=(0,s().yK)((()=>({iconButtonStyles:{height:o.device.isMobile?24:28,width:o.device.isMobile?24:28}})),[o.device.isMobile]);return(0,he.jsxs)(n.Fragment,{children:[(0,he.jsx)(ke().d,{type:"thumbsup",ariaLabel:"thumbs-up",onClick:()=>{t.setFeedbackState({type:"thumbsup",userContent:"",shareWithNotion:!0})},feedbackState:t.feedbackState,onDismiss:t.handleFeedbackButtonDismiss,onSubmit:t.handleFeedbackButtonSubmit,onUpdate:t.setFeedbackState,showShareDataPopup:!1,onDataShareSubmit:k().ZT,userOptIn:!1,iconButtonStyles:r.iconButtonStyles}),(0,he.jsx)(ke().d,{type:"thumbsdown",ariaLabel:"thumbs-down",onClick:()=>{t.setFeedbackState({type:"thumbsdown",userContent:"",shareWithNotion:!0})},feedbackState:t.feedbackState,onDismiss:t.handleFeedbackButtonDismiss,onSubmit:t.handleFeedbackButtonSubmit,onUpdate:t.setFeedbackState,showShareDataPopup:!1,onDataShareSubmit:k().ZT,userOptIn:!1,iconButtonStyles:r.iconButtonStyles})]})}function _e(e){let{overlayState:t,theme:o,propertySchema:n}=e;const r=(0,a().VK)((()=>te().CollectionsAiAutofillProgressStore.isWriting()),[]),l=(0,i().O7)(),s=Pe(t,n);return l.device.isMobile||r?null:(0,he.jsx)(we().p,{allowSelectionWithin:!1,children:(0,he.jsxs)("div",{style:{position:"absolute",top:-36,right:0,borderRadius:5,fontSize:14,lineHeight:1.2,display:"flex",whiteSpace:"nowrap",background:o.popoverBackground,boxShadow:o.shadowMD,zIndex:-1,padding:2},children:[(0,he.jsx)(Re,{overlayState:t,propertySchema:n}),s.shouldDisplayFeedbackButtons&&(0,he.jsx)(je,{autofillBlockPropertyValueFeedbackButtonsState:s})]})})}function Re(e){let{overlayState:t,propertySchema:o}=e;const n=(0,i().O7)(),r=(0,s().yK)((e=>({buttonStyle:{display:"flex",height:28},iconStyle:{height:16,width:16,fill:e.aiPurpleColor},updateTextStyle:{fontWeight:500,color:e.aiPurpleColor}})),[]);return(0,he.jsx)(ie().D,{style:r.buttonStyle,onClick:()=>{o&&O().autofillPropertyForBlocks({environment:n,stores:[t.store],property:t.property,propertySchema:o,userEventForAnalytics:"generate_from_overlay_button",collectionContextStore:t.collectionContextStore,from:q().Sy(t.format)})},children:(0,he.jsxs)(le().X2,{gap:4,children:[(0,x().y)(r.iconStyle),(0,he.jsx)("span",{style:r.updateTextStyle,children:(0,he.jsx)(C()._H,{defaultMessage:"Update",id:"database.propertyValues.reGenerateAiAutofill"})})]})})}function Be(e){let{overlayState:t,propertySchema:o,showSeparator:n}=e;const r=Pe(t,o),i=(0,s().yK)((e=>({dot:{color:e.lightTextColor}})),[]);return r.shouldDisplayFeedbackButtons?(0,he.jsxs)(he.Fragment,{children:[n?(0,he.jsx)("div",{style:i.dot,children:""}):null,(0,he.jsx)(je,{autofillBlockPropertyValueFeedbackButtonsState:r})]}):null}function Me(e){let{overlayState:t,propertySchema:o,style:n}=e;const r=(0,i().O7)(),l=(0,s().yK)((e=>({linkStyle:{color:e.aiPurpleColor,fontSize:12,...n}})),[n]);return(0,he.jsx)("div",{style:l.linkStyle,onClick:()=>{o&&O().autofillPropertyForBlocks({environment:r,stores:[t.store],property:t.property,propertySchema:o,userEventForAnalytics:"generate_from_overlay_button",collectionContextStore:t.collectionContextStore,from:q().Sy(t.format)})},children:(0,he.jsx)(C()._H,{defaultMessage:"Update",id:"database.propertyValues.reGenerateAiAutofill"})})}function Te(e){const{store:t,additionalStores:o,collectionContextStore:n,collectionSchema:r}=e;return n&&(0,q().aJ)({store:t,additionalStores:o,collectionContextStore:n})?n.normalizedSchemaStore.state:r||t.getSchema()||{}}function Ve(e){if(!(0,q().aJ)({store:e.store,additionalStores:e.additionalStores,collectionContextStore:e.collectionContextStore}))return e.store.getAssociatedCollectionStore()}function Ee(e){const t=Ve(e),o=t?t.getMappedProperty(e.property):e.property;return Te(e)[o]}function Ie(e){let{overlayState:t,pageContext:o}=e;const{store:n}=t,r=Ee(t);return r&&(0,N().RT)(null==o?void 0:o.publicEditModeStore.state,n)&&d().qQ(r)&&d().q3(r)&&!t.collectionsBulkActionsToolbarStore}var Ae=()=>o(194336),Oe=()=>o(822635),Ke=()=>o(843603),Fe=()=>o(352230),Ue=()=>o(1910),Le=()=>o(740046),He=()=>o(198829),We=()=>o(470386),De=()=>o(388284),Ze=()=>o(603885);function qe(e){var t,o;let{propertyName:r,geopointValue:l,onChange:a,onClose:c}=e;const u=(0,i().Fy)(),d=(0,C().YB)(),p=(0,s().yK)((e=>({footerStyle:{borderTop:`1px solid ${e.regularDividerColor}`},icon:{width:20,height:20,fill:e.redBadgeBackground},header:{padding:u.isMobile?10:7,paddingLeft:u.isMobile?20:7,background:u.isMobile?e.popoverBackground:e.tokenInputMenuItemBackground,display:"flex",alignItems:"center",borderBottom:`1px solid ${e.regularDividerColor}`,fontSize:Ze().z6},inputMenuItem:{marginBottom:10}})),[u]),[y,m]=(0,n.useState)(null==l||null===(t=l.lat)||void 0===t?void 0:t.toFixed(2)),[f,h]=(0,n.useState)(null==l||null===(o=l.lon)||void 0===o?void 0:o.toFixed(2)),x=(0,n.useCallback)((()=>{m(void 0),h(void 0),a({value:void 0}),c()}),[a,c]),S=(0,n.useCallback)((e=>{const t=e.target.value;m(t);const o=parseFloat(t),n=!isNaN(o)&&o>=-90&&o<=90,r=f?parseFloat(f):NaN,i=!isNaN(r)&&r>=-180&&r<=180;n&&i&&a({value:{lat:o,lon:r}})}),[a,f]),v=(0,n.useCallback)((e=>{const t=e.target.value;h(t);const o=y?parseFloat(y):NaN,n=!isNaN(o)&&o>=-90&&o<=90,r=parseFloat(t),i=!isNaN(r)&&r>=-180&&r<=180;n&&i&&a({value:{lat:o,lon:r}})}),[a,y]);let b={menuType:Fe().o.Popup};return u.isMobile&&(b={...b,title:r,menuType:Fe().o.Modal,right:(0,he.jsx)(We().DoneMenuText,{})}),(0,he.jsx)(He().Z,{...b,header:l&&(0,he.jsxs)("div",{style:p.header,children:[(0,he.jsx)("div",{style:p.icon,children:(0,Oe().u)({...p.icon})}),(0,he.jsx)("div",{children:(0,Ke().l)({geopointAnnotation:(0,g().YOw)(l),index:0})}),(0,he.jsx)(Ue().Z,{style:{borderRadius:100,marginRight:2},iconStyle:{width:8,height:8},icon:Ae().b,onClick:x,ariaLabel:d.formatMessage({id:"geopointPropertyValueOverlay.clear",defaultMessage:"Clear location field"})})]}),children:(0,he.jsxs)(De().Z,{title:d.formatMessage({id:"geopointPropertyValueOverlay.updateLocation",defaultMessage:"Update Location"}),children:[(0,he.jsx)(Le().ZP,{style:p.inputMenuItem,type:"number",min:"-90",max:"90",left:(0,he.jsx)("div",{children:(0,he.jsx)(C()._H,{id:"geopointPropertyValueOverlay.latitude",defaultMessage:"Latitude"})}),value:y??"",onChange:S}),(0,he.jsx)(Le().ZP,{style:p.inputMenuItem,type:"number",min:"-90",max:"90",left:(0,he.jsx)("div",{children:(0,he.jsx)(C()._H,{id:"geopointPropertyValueOverlay.longitude",defaultMessage:"Longitude"})}),value:f??"",onChange:v})]})})}const ze=n.memo((function(e){const t=(0,i().O7)(),r=(0,i().Fy)(),{store:s}=e,c=(0,l().l)();(0,o(732811).K)((()=>{yt({isFirstRender:!0},s,t)})),o(504008).Z.withListenerIgnored((()=>{yt({isFirstRender:!1},s,t)}));const u=(0,n.useRef)(void 0),y=(0,a().Kw)(s),{originRect:m,mobileStyle:f,style:h,placementToOrigin:x}=(0,a().VK)((()=>{let e,n,i;const l=ee().Placement.Bottom;if(y.isOpen){const l=y.format===be().C.Page,u=Ee(y),m=u?u.type:void 0,f=y.store.canEdit();let h=y.rect.top,x=y.rect.left,S=y.rect.width,v=y.rect.height;if(l?(x-=1,S+=1):(h-=1,x-=1,S+=1,v+=2),("number"===m||p().TN(m))&&r.isMobile){const e=o(302353).default.mobileNativeBottomPadding(t)+24;i={overflowY:"auto",WebkitOverflowScrolling:"touch",width:Math.max(240,S),maxHeight:`calc(100vh - ${e}px)`}}if("number"===m)n={width:Math.max(240,S)};else if("date"===m)h+=v-1,n={};else if("relation"===m){const e=X().NW;n={width:Math.max(e,S),minHeight:f?65:void 0,overflow:"hidden"}}else if("person"===m)n={width:Math.max(240,S)};else if("formula"===m)h+=v-1,n={borderRadius:12};else if("select"===m||"multi_select"===m)n={width:Math.max(300,S),overflow:"visible"};else if("rollup"===m)h+=v-1,n={};else if("file"===m)n={minWidth:Math.max(240,S)};else if("verification"===m)n={width:k().uZ(S,265,270)};else{const e=24+(Ie({overlayState:y,pageContext:c})?28:0);n={width:Math.max(240,S),minHeight:Math.min(v,window.innerHeight-e),maxHeight:window.innerHeight-e,overflow:"visible",display:"flex",flexDirection:"column"},"status"===m&&q().aJ({store:y.store,additionalStores:y.additionalStores,collectionContextStore:y.collectionContextStore})&&(h+=v-1)}const b=y.collectionContextStore;if(b){var a,s;const e=b.subitemTreeStore.state,t=(0,o(426546).DY)(e.children,(e=>e.value.store===y.store)),r=null==t?void 0:t.length,i=null===(a=b.normalizedFormatStore.state)||void 0===a||null===(a=a.table_properties)||void 0===a?void 0:a.filter((e=>e.visible)),l=i&&(null===(s=i[0])||void 0===s?void 0:s.property)===y.property;r&&l&&(n={...n,...m&&d().Yl(m)&&{width:Math.max(90,S)}})}e=new DOMRect(x,h,S,0)}return{originRect:e,style:n,mobileStyle:i,placementToOrigin:l}}),[y,r.isMobile,t,c]),S=(0,a().VK)((()=>{const e=function(e,t){const{device:o}=t;if(o.isMobile){const t=e.state;if(!t.isOpen)return ce().kQ.SlideUp;const o=Ee(t);return o?fe().mZ[o.type]:ce().kQ.SlideUp}return ce().kQ.Popup}(s,t),n=!r.isMobile||e===ce().kQ.Popup,i={borderRadius:6,key:pt(s),popupType:e,open:y.isOpen,originRect:m,style:r.isMobile?f:h,alignmentToOrigin:ee().Alignment.Start,placementToOrigin:x,preventScaleTransition:n,preventOpacityTransition:n,render:()=>function(e){const{overlayState:t,store:o,environment:n}=e;if(t.isOpen)return(0,he.jsx)(ae().Z,{debugName:"BlockPropertyValueOverlay",capture:!0,onTab:e=>St(e,o,n),onUntab:e=>vt(e,o,n),onEnter:()=>bt(o,n),onDelete:k().yR,onBackspace:k().yR,children:(0,he.jsxs)(D().L1,{value:t.collectionContextStore,children:[(0,he.jsx)(Ne,{overlayState:t}),(0,he.jsx)("div",{style:{display:"flex",flexDirection:"column",overflowY:"auto",flexGrow:1,height:"100%"},children:(0,he.jsx)(Qe,{overlayState:t,store:o})})]})},`${t.store.id}${t.property}`)}({overlayState:y,store:s,environment:t}),onDismiss:()=>function(e,t){o(799454).LZ(),B().fG({environment:t,blockPropertyValueOverlayStore:e})}(s,t)};return u.current=i,i}),[r.isMobile,t,f,m,y,x,s,h]);return y.isOpen||!u.current?(0,he.jsx)(ce().ZP,{...S}):(0,he.jsx)(ce().ZP,{...u.current,open:!1})}));function Ne(e){let{overlayState:t}=e;const o=(0,l().l)(),n=(0,s().Fg)(),r=(0,a().VK)((()=>Ie({overlayState:t,pageContext:o})),[t,o]),i=(0,a().VK)((()=>r?Ee(t):void 0),[r,t]);return r?(0,he.jsx)(_e,{theme:n,propertySchema:i,overlayState:t}):null}function Qe(e){let{overlayState:t,store:o}=e;const n=(0,a().VK)((()=>Ee(t)),[t]);if(!n)return null;const r=Ge[n.type];return r?(0,he.jsx)(r,{store:o,overlayState:t,propertySchema:n,propertyType:n.type}):null}const Ge={title:function(e){let{overlayState:t,propertyType:o,store:r}=e;const l=(0,i().O7)(),{clonedStore:s}=t,c=(0,n.useCallback)((()=>bt(r,l)),[r,l]),u=(0,n.useCallback)((()=>xt(r,l)),[r,l]),d=(0,n.useCallback)((e=>St(e,r,l)),[r,l]),p=(0,n.useCallback)((e=>vt(e,r,l)),[r,l]),y=(0,n.useCallback)((()=>wt(t,o,l,r)),[t,o,l,r]),m=(0,a().VK)((()=>s.getTitleStore()||s.getPropertyStore(t.property)),[s,t.property]),f=(0,a().VK)((()=>ft(t,l)),[t,l]);return(0,he.jsx)("div",{style:$e,children:(0,he.jsx)(ye().Z,{store:m,disableSlashCommands:!0,onEnter:c,onEsc:u,onTab:d,onUntab:p,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableShiftEnter:!0,onChange:y,disabled:f,pasteBehavior:"inline",inPageFind:Q().B3.none})})},text:function(e){var t;let{overlayState:o,propertySchema:r,propertyType:l,store:s}=e;const c=(0,i().O7)(),{clonedStore:u}=o;let d;"text"===(null==r?void 0:r.type)&&null!==(t=r.ai_inference)&&void 0!==t&&t.auto_update_on_edit&&(d="Empty");const p=(0,a().VK)((()=>s.state.isOpen&&W().default.getPropertyId()===s.state.property&&W().default.getBlockStore()===s.state.store),[s]),y=(0,n.useCallback)((()=>bt(s,c)),[s,c]),m=(0,n.useCallback)((()=>xt(s,c)),[s,c]),f=(0,n.useCallback)((e=>St(e,s,c)),[s,c]),h=(0,n.useCallback)((e=>vt(e,s,c)),[s,c]),x=(0,n.useCallback)((()=>wt(o,l,c,s)),[o,l,c,s]),S=(0,a().VK)((()=>u.getPropertyStore(o.property)),[u,o.property]),v=(0,a().VK)((()=>ft(o,c)),[o,c]);return(0,he.jsxs)(he.Fragment,{children:[(0,he.jsxs)("div",{style:fe().FL,children:[(0,he.jsx)(ye().Z,{store:S,disableSlashCommands:!0,onEnter:y,onEsc:m,onTab:f,onUntab:h,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onChange:x,disabled:v,pasteBehavior:"inline",placeholder:d,inPageFind:Q().B3.none,hasTemporaryDiscussionOnProperty:p}),(0,he.jsx)(Ye,{overlayState:o,propertySchema:r})]}),(0,he.jsx)(Xe,{overlayState:o,propertySchema:r})]})},relation:function(e){let{overlayState:t,store:r}=e;const l=(0,i().O7)(),s=tt(t),u=(0,a().VK)((()=>p().rq(at(t))),[t]),m=ot(t),h=rt(t),x=(0,a().VK)((()=>t.store.getParentId()),[t]),b=it(t),C=(0,n.useCallback)((()=>ht(r,l)),[r,l]),P=(0,n.useCallback)((e=>async function(e,t,o){const n=o.state;if(!n.isOpen)return;const r=Ee(n);if(!r||"relation"!==r.type)return;const i="relation"===r.type&&d().F0(r),l=i&&new(oe().NW)(t,{table:v().vF,id:i});l&&await l.load();A().createAndCommit({userAction:"BlockPropertyValueOverlay.handleRelationPropertyMenuUpdate",environment:t,canUndo:!0,perform:r=>{if(e.newPage&&i&&l){const o=g().TPx(e.newPage.name),i=l.getRootPagePointer()??l.pointer,a=V().j4({environment:t,id:e.newPage.id,type:c().Ti.page,properties:{title:o},spaceId:e.newPage.spaceId,inMemoryRecordCache:n.store.inMemoryRecordCache,transaction:r});if(i.table===S().iU){const e=new(oe().G)(t,i);T().jG({parentStore:e,childStore:a,transaction:r})}else i.table===v().vF?T().zw({parentStore:l,childStore:a,transaction:r}):(0,w().t1)(i);const s=l.getDefaultTemplatePageStore();s&&M().ob({title:{text:o},environment:t,store:oe().G.createChildStore(l,a.pointer),templateStore:s,isKeyboard:!1,isCreateIn:!1,transaction:r,from:"relation_property_menu_update"})}const a=e.newValues,s=e.oldValues,u=(0,f().q)(s.map(y().dn),a.map(y().dn)),d=k().oA(Array.from(u.removeOps).map((e=>{if(!a.find((t=>(0,y().dn)(t)===e)))return s.find((t=>(0,y().dn)(t)===e))}))),p=[];for(const e in u.beforeOps){const t=a.find((t=>(0,y().dn)(t)===e));if(!t)continue;const o=u.beforeOps[e];if(!o){p.push({relationToAdd:t});continue}const n=a.find((e=>(0,y().dn)(e)===o));p.push({relationToAdd:t,before:n})}for(const e of ct(n)){for(const o of d)E().VG({environment:t,store:e,propertyId:n.property,id:o.id,transaction:r});for(const o of p)o.before?E().Hi({environment:t,store:e,propertyId:n.property,id:o.relationToAdd.id,position:{type:"before",before:o.before.id},transaction:r}):E().Hi({environment:t,store:e,propertyId:n.property,id:o.relationToAdd.id,position:{type:"after"},transaction:r})}Ct(n,t,o)}})}(e,l,r)),[l,r]);if(x)return(0,he.jsx)(o(459217).D,{blockPointers:u,property:t.property,collectionStore:m,collectionId:x,schema:s,isDisabled:b,canConfigureCollection:h,onChange:P,analyticsFrom:st(t),onDismiss:C,blockStore:t.store,blockPropertyValueOverlayStore:r,overlayMode:t.mode,insertChar:t.insertChar,format:t.format,children:(0,he.jsx)(X().ev,{})});return null},rollup:function(e){let{overlayState:t,store:o}=e;const r=(0,i().O7)(),l=(0,a().VK)((()=>Te(t)),[t]),s=et(t),c=(0,a().VK)((()=>ft(t,r)||!dt(t)||s),[t,r,s]),u=(0,n.useCallback)((()=>ht(o,r)),[o,r]),d=(0,n.useCallback)((e=>function(e,t,o){const n=t.state;if(!n.isOpen)return;A().createAndCommit({userAction:"BlockPropertyValueOverlay.handleRollupPropertyMenuUpdate",environment:o,canUndo:!0,perform:r=>{!function(e,t,o,n){const r=o.state;if(!r.isOpen)return;if(r.isOpen){const o=Ve(r);o&&(0,L().x)({environment:n,collectionStore:o,update:e,transaction:t})}}({[n.property]:e.propertySchema},r,t,o)}})}(e,o,r)),[o,r]);return(0,he.jsx)(de().Z,{context:de().t.BlockPropertyOverlay,property:t.property,schema:l,disabled:c,onChange:d,parentStore:t.store,analyticsFrom:st(t),onDismiss:u})},select:function(e){let{overlayState:t,store:o}=e;const r=(0,i().O7)(),l=tt(t),s=ot(t),c=function(e){return(0,a().VK)((()=>Ee(e)),[e])}(t),u=nt(t),d=it(t),y=rt(t),m=(0,n.useCallback)((e=>gt(e,o,r)),[o,r]),f=(0,n.useCallback)((()=>ht(o,r)),[o,r]),h=(0,n.useCallback)((e=>kt(e,r,o)),[r,o]);if(!s||!c||"select"!==c.type)return null;const x=p().Sj(u,c.options||[]);return(0,he.jsx)(pe().Z,{allowMultiple:!1,value:x?[x]:[],property:t.property,collectionId:s.id,schema:l,disabled:d,canConfigureCollection:y,onChange:h,analyticsFrom:st(t),insertChar:t.insertChar,onAccept:m,onDismiss:f,blockStore:t.store,autofillExplanation:(0,he.jsx)(Ye,{overlayState:t,propertySchema:c}),bulkAutofillButton:(0,he.jsx)(Xe,{overlayState:t,propertySchema:c})})},multi_select:function(e){let{overlayState:t,store:o,propertySchema:r}=e;const l=(0,i().O7)(),a=tt(t),s=ot(t),c=nt(t),u=it(t),d=rt(t),y=(0,n.useCallback)((e=>kt(e,l,o)),[l,o]),m=(0,n.useCallback)((e=>gt(e,o,l)),[o,l]),f=(0,n.useCallback)((()=>ht(o,l)),[o,l]);if(!s||!r||"multi_select"!==r.type)return null;const h=p().uP(c,r.options||[]);return(0,he.jsx)(pe().Z,{allowMultiple:!0,value:h,property:t.property,collectionId:s.id,schema:a,disabled:u,canConfigureCollection:d,onChange:y,analyticsFrom:st(t),insertChar:t.insertChar,onAccept:m,onDismiss:f,blockStore:t.store,autofillExplanation:(0,he.jsx)(Ye,{overlayState:t,propertySchema:r}),bulkAutofillButton:(0,he.jsx)(Xe,{overlayState:t,propertySchema:r})})},status:function(e){let{overlayState:t,propertySchema:r,store:l}=e;const a=(0,i().O7)(),s=nt(t),c=it(t),u=(0,n.useMemo)((()=>{if(!r||"status"!==r.type)return;return{initialValue:p().ZG(s,r),property:t.property,propertySchema:r,disabled:c,onDismiss:()=>ht(l,a),onChange:(e,t)=>{e?kt({type:"selectPropertyMenuUpdateReplaceOptions",options:[e]},a,l):t?function(e,t,o){const n=o.state;if(!n.isOpen)return;A().createAndCommit({userAction:"BlockPropertyValueOverlay.handleStatusGroupPropertyMenuUpdate",environment:t,canUndo:!0,perform:r=>{if(e.groupType){for(const o of ct(n)){var i;const l=o.getAssociatedCollectionStore();if(!l)continue;const a=l.getSchema(),s=l.getMappedProperty(n.property),c=a[s];if("status"!==(null==c?void 0:c.type))continue;const u=(c.groups??[]).find((t=>{var o;return t.name.toLowerCase()===(null===(o=e.groupType)||void 0===o?void 0:o.toLowerCase())})),d=null==u||null===(i=u.optionIds)||void 0===i?void 0:i.at(0);if(!d)continue;const p=(c.options??[]).find((e=>e.id===d));if(!p)continue;const y=o.getPropertyStore(s);I().sO({environment:t,store:y,value:[[p.value]],transaction:r})}Ct(n,t,o)}}})}({groupType:t},a,l):r.defaultOption?kt({type:"selectPropertyMenuUpdateReplaceOptions",options:[r.defaultOption]},a,l):kt({type:"selectPropertyMenuUpdateReplaceOptions",options:[]},a,l)},onAccept:e=>gt(e,l,a),blockPropertyValueOverlayStore:l}}),[r,s,c,t,l,a]);if(!r||"status"!==r.type||!u)return null;return t.property===o(926724).b0.StatusV2?(0,he.jsx)(o(251228).G,{...u}):(0,he.jsx)(o(793396).x,{...u})},person:function(e){let{overlayState:t,propertySchema:r,store:l}=e;const s=(0,i().O7)(),c=tt(t),u=nt(t),d=(0,a().VK)((()=>{var e;return null===(e=t.collectionContextStore)||void 0===e?void 0:e.collectionStore()}),[t.collectionContextStore]),y=(0,a().VK)((()=>t.store.isTemplate()),[t]),m=it(t),f=(0,n.useCallback)((()=>ht(l,s)),[l,s]),h=(0,n.useCallback)((e=>function(e,t,o){const n=o.state;if(!n.isOpen)return;A().createAndCommit({userAction:"BlockPropertyValueOverlay.handlePersonPropertyMenuUpdate",environment:t,canUndo:!0,perform:r=>{if(P().z4(e.schema)||mt(e.schema,r,o,t),"personPropertyMenuUpdateAddPerson"===e.type){for(const t of ut(n))for(const o of e.newValues)A().applyOperation({transaction:r,store:t,operation:{path:t.path,pointer:t.pointer,command:"addPersonAfter",args:{pointer:o}}});Ct(n,t,o)}else if("personPropertyMenuUpdateRemovePerson"===e.type){for(const t of ut(n))A().applyOperation({transaction:r,store:t,operation:{path:t.path,pointer:t.pointer,command:"removePerson",args:{pointer:e.removedValue}}});Ct(n,t,o)}else if("personPropertyMenuUpdateReplacePerson"===e.type){const i=p().BY([e.newValue]);for(const e of ut(n))I().sO({environment:t,store:e,value:i,transaction:r});Ct(n,t,o)}else(0,w().t1)(e)}})}(e,s,l)),[s,l]),x=(0,a().VK)((()=>t.store.getCreatedByPointer()),[t]);if(!r||"person"!==r.type)return null;const S=p().BW({value:u,isTemplatePage:y,propertySchema:r,blockCreatorPointer:y||q().xE(t.format)?void 0:x}),v=(0,w().$K)(r.default)&&!u&&1===S.length;return(0,he.jsx)(o(440633).ZP,{value:S,format:t.format,valueIsUnpersistedDefaultValue:v,propertySchema:r,schema:c,disabled:m,onChange:h,insertChar:t.insertChar,onDismiss:f,parentStore:t.store,isTemplatePage:y,formQuestionStore:t.formQuestionStore,collectionStore:d})},number:function(e){let{overlayState:t,store:o,propertySchema:r}=e;const l=(0,i().O7)(),a=nt(t),s=it(t),c=(0,n.useCallback)((e=>function(e,t,o){const n=o.state;if(!n.isOpen)return;(0,ge().eL)(e,t,ut(n)),Ct(n,t,o)}(e,l,o)),[l,o]);if(!r||"number"!==r.type)return null;const u=t.format===be().C.Table,d=p().VY(a),y="large"===(null==t?void 0:t.sizing)?"large":"default";return(0,he.jsx)(Se,{size:y,value:d,isTable:u,format:r.number_format||"number",disabled:s,insertChar:t.insertChar,onChange:c})},date:function(e){let{overlayState:t,store:r,propertySchema:l}=e;const s=(0,i().O7)(),c=nt(t),u=it(t),d=rt(t),p=(0,n.useCallback)((e=>function(e,t,o){const n=o.state;if(!n.isOpen)return;A().createAndCommit({userAction:"BlockPropertyValueOverlay.handleDatePropertyValueChange",environment:t,canUndo:!0,perform:r=>{for(const i of ct(n))!e||m().U3(e)?(K().xD({environment:t,store:i,type:"dateValue",dateValue:e,propertyId:n.property,transaction:r}),e||ht(o,t)):(V().sW({store:i.getPropertiesStore(),transaction:r,data:{[n.property]:[g().YCD(g().WBu({type:e}))]}}),ht(o,t)),Ct(n,t,o)}})}(e,s,r)),[s,r]),y=(0,n.useCallback)((e=>function(e,t,o){const n=t.state;if(!n.isOpen)return;const r=Ee(n);if(!r||"date"!==r.type)return;const i=Te(n),l={...r,date_format:e},a={...i,[n.property]:l};if(A().createAndCommit({userAction:"BlockPropertyValueOverlay.handleDatePropertyDateFormatChange",environment:o,canUndo:!0,perform:e=>{mt(a,e,t,o)}}),l){var s;st(n),j().$q(o,{property_type:l.type,action:"date_change_format",from:st(n),collection_id:null===(s=Ve(n))||void 0===s?void 0:s.id})}}(e,r,s)),[s,r]),f=(0,n.useCallback)((e=>function(e,t,o){const n=t.state;if(!n.isOpen)return;const r=Ee(n);if(!r||"date"!==r.type)return;const i=Te(n),l={...r,time_format:e},a={...i,[n.property]:l};if(A().createAndCommit({userAction:"BlockPropertyValueOverlay.handleDatePropertyTimeFormatChange",environment:o,canUndo:!0,perform:e=>{mt(a,e,t,o)}}),l){var s;st(n),j().$q(o,{property_type:l.type,action:"date_change_format",from:st(n),collection_id:null===(s=Ve(n))||void 0===s?void 0:s.id})}}(e,r,s)),[s,r]),h=(0,n.useCallback)((()=>ht(r,s)),[r,s]),x=(0,a().VK)((()=>t.store.isTemplate()),[t]);if(!l||"date"!==l.type)return null;const S=(0,o(552221).G)(c),v=[be().C.FormEditor,be().C.FormViewer].includes(t.format);return(0,he.jsx)(Y().ev,{dependency:o(675393).Di,children:e=>{let{DatePropertyMenu:n}=e;return(0,he.jsx)(n,{firstDayOfWeek:o(718959).AK.state,value:S,format:t.format,onChangeValue:p,dateFormat:l.date_format,onChangeDateFormat:y,timeFormat:l.time_format,disabled:u,canConfigureCollection:d,onChangeTimeFormat:f,onDismiss:h,shouldShowReminder:!v,shouldShowDateFormatControl:!v,shouldShowAllDayControl:!v,shouldShowEndDateControl:!v,isTemplatePage:x,formQuestionStore:t.formQuestionStore})}})},file:function(e){let{overlayState:t,store:r}=e;const l=(0,i().O7)(),a=tt(t),s=nt(t),c=it(t),u=p().g(s),d=(0,n.useCallback)((()=>ht(r,l)),[r,l]),y=(0,n.useCallback)((e=>A().createAndCommit({userAction:"BlockPropertyValueOverlay.renderFile",environment:l,canUndo:!0,perform:o=>{if(P().z4(e.schema)||mt(e.schema,o,r,l),!P().z4(e.value)){const n=p().CC(e.value);for(const e of ut(t))I().sO({environment:l,store:e,value:n,transaction:o});Ct(t,l,r)}}})),[l,r,t]);return(0,he.jsx)(o(810201).Z,{store:t.store,value:u,property:t.property,schema:a,onDismiss:d,uploadFiles:t.uploadFiles,disabled:c,onChange:y})},url:lt,phone_number:lt,email:lt,formula:function(e){let{overlayState:t,propertySchema:r,store:l}=e;const s=(0,i().O7)(),c=et(t),u=it(t),d=rt(t),p=ot(t),y=(0,a().VK)((()=>t.store.getModel()),[t.store]),m=(0,n.useCallback)((()=>ht(l,s)),[l,s]),f=(0,n.useCallback)((e=>function(e,t){const{newValue:o,newType:n,propertySchema:r,property:i,collectionStore:l}=e,a=o?{...r,formula2:{code:o,result_type:n},version:"v2"}:{...r,formula2:void 0,version:"v2"};A().createAndCommit({userAction:"CollectionSettingsFormulaOptions.handleFormulaChange",environment:t,canUndo:!0,perform:e=>{(0,L().x)({environment:t,collectionStore:l,update:{[i]:a},transaction:e})}})}(e,s)),[s]),h=u||!d||c;if(y&&p&&r&&"formula"===r.type)return(0,he.jsx)(Y().ev,{dependency:Z().F.formulas,children:e=>(0,he.jsx)(o(8225).Z,{handleClose:m,property:t.property,getRecordModel:t.store.getRecordModel,propertySchema:r,collectionStore:p,handleSave:f,formulas:e,disabled:h,blockStore:t.store,analyticsFrom:st(t)})});return null},verification:function(e){let{overlayState:t,propertySchema:r,store:l}=e;const a=(0,i().O7)(),s=nt(t),c=(0,n.useCallback)((e=>{A().createAndCommit({userAction:"BlockPropertyValueOverlay.verification",environment:a,canUndo:!0,perform:o=>{const n=p().Tp(e.value);for(const e of ut(t))I().sO({environment:a,store:e,value:n,transaction:o});Ct(t,a,l)}})}),[a,t,l]),u=(0,n.useCallback)((()=>ht(l,a)),[l,a]),d=(0,o(496205)._w)(s);if("verification"!==(null==r?void 0:r.type))return null;return(0,he.jsx)(o(75283).O,{propertyName:r.name,onChange:c,verificationValue:d,getRecordModel:t.store.getRecordModel,blockId:t.store.id,onClose:u,showTitle:!0,showCurrentStatusHeader:!0,showRemoveVerificationButton:!0,showVerificationFooter:!0,showCustomHeader:!1})},geo_point:function(e){let{overlayState:t,propertySchema:o,propertyType:r,store:l}=e;const a=(0,i().O7)(),s=nt(t),c=(0,n.useCallback)((e=>{const{store:o,property:n}=t;A().createAndCommit({userAction:"BlockPropertyValueOverlay.handleGeoPointChange",environment:a,canUndo:!0,perform:t=>{I().sO({environment:a,store:o.getPropertyStore(n),value:(0,h().B)(e.value),transaction:t})}})}),[a,t]),u=(0,n.useCallback)((()=>{ht(l,a)}),[l,a]);if("geo_point"!==(null==o?void 0:o.type))return null;const d=(0,h().X)(s);return(0,he.jsx)(qe,{geopointValue:d,propertyName:o.name,onChange:c,onClose:u})},checkbox:void 0,created_by:void 0,created_time:void 0,last_edited_by:void 0,last_edited_time:void 0,last_visited_time:void 0,button:void 0,auto_increment_id:void 0,location:void 0},$e={...fe().FL,fontWeight:o(707513).Ue.medium};function Ye(e){let{overlayState:t,propertySchema:o}=e;const n=(0,i().O7)(),r=(0,i().Fy)(),c=(0,l().l)(),u=(0,a().VK)((()=>(0,N().Zt)(n)),[n]),p=(0,a().VK)((()=>te().CollectionsAiAutofillProgressStore.isWriting()),[]),y=o&&d().qQ(o)?(0,d().q3)(o):void 0,m=(0,a().VK)((()=>(0,N().RT)(null==c?void 0:c.publicEditModeStore.state,t.store)),[c,t]),f=(0,s().yK)((e=>({aiWritingLabel:{fontSize:12,color:e.aiPurpleColor,display:"flex",alignItems:"inline",fontWeight:500,marginTop:6,marginBottom:2},editContainer:{display:"flex",alignItems:"center",marginTop:6,marginBottom:2},dot:{color:e.lightTextColor},autoUpdatingLinkContainer:{paddingLeft:2,display:"flex",alignItems:"center"},autoUpdatingMobileLink:{paddingLeft:2,paddingRight:2},editMobileLink:{marginTop:6,marginBottom:2}})),[]);return u?p?(0,he.jsxs)(ue().Z,{isSecondaryColor:!0,style:f.aiWritingLabel,isSmall:!0,isMultiline:!0,children:[(0,he.jsx)(C()._H,{defaultMessage:"AI is writing",id:"BlockPropertyValueOverlay.AIActionText.overlay"}),(0,he.jsx)("div",{style:{marginLeft:4},children:(0,he.jsx)(se().Z,{})})]}):null!=y&&y.auto_update_on_edit?(0,he.jsxs)("div",{style:f.editContainer,children:[(0,he.jsx)(ue().Z,{isSecondaryColor:!0,style:{fontSize:12},isSmall:!0,isMultiline:!0,children:(0,he.jsx)(C()._H,{defaultMessage:"Auto-updated by AI",id:"BlockPropertyValueOverlay.helpText.overlay"})}),r.isMobile&&m&&(0,he.jsxs)("div",{style:f.autoUpdatingLinkContainer,children:[(0,he.jsx)("div",{style:f.dot,children:""}),(0,he.jsx)(Me,{overlayState:t,propertySchema:o,style:f.autoUpdatingMobileLink}),(0,he.jsx)(Be,{overlayState:t,propertySchema:o,showSeparator:!0})]})]}):r.isMobile&&y&&m?(0,he.jsx)(Me,{overlayState:t,propertySchema:o,style:f.editMobileLink}):null:null}const Je=5;function Xe(e){let{overlayState:t,propertySchema:o}=e;const{store:r}=t,c=null==o?void 0:o.name,u=(0,i().O7)(),p=(0,l().l)(),y=(0,a().VK)((()=>(0,N().RT)(null==p?void 0:p.publicEditModeStore.state,r)),[p,r]),m=(0,a().VK)((()=>{var e;return Math.max((null===(e=t.collectionsBulkActionsToolbarStore)||void 0===e?void 0:e.getNumberOfTextStoresBeingEdited())??0,ne().default.state.stores.length)}),[t]),f=(0,s().yK)((e=>({button:{width:"100%",height:"auto",borderTop:`1px solid ${e.regularDividerColor}`},magicWandIcon:{width:18,fill:e.aiPurpleColor},titleContainer:{fontSize:14,whiteSpace:"normal"},descriptionContainer:{fontSize:12,color:e.mediumTextColor,whiteSpace:"normal",lineHeight:"1.4em"}})),[]),h=(0,a().VK)((()=>{var e;const t=(null===(e=re().subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return(0,b().de)(t)||m<=Je}),[m]),S=(0,n.useCallback)((()=>function(e,t,o){const{collectionsBulkActionsToolbarStore:n}=e;if(!n)return;if(t){let t=n.state.textStoresBeingEdited;if(0===t.length&&(t=ne().default.state.stores),!(0,w().Of)(t))return;const r=Ee(e);if(!r)return;O().autofillPropertyForBlocks({environment:o,stores:t,property:e.property,propertySchema:r,userEventForAnalytics:"generate_from_overlay_button",isBulkAction:!0,from:q().Sy(e.format),collectionContextStore:e.collectionContextStore})}else O().triggerAiAutofillUpsell({environment:o,from:"ai_autofill_bulk_fill"})}(t,h,u)),[t,h,u]);return o&&y&&d().qQ(o)&&(0,d().q3)(o)?0===m?null:(0,he.jsx)(ie().D,{style:f.button,onClick:S,children:(0,he.jsxs)(le().X2,{gap:8,padding:"8px 0px",alignItems:"start",children:[(0,x().y)(f.magicWandIcon),(0,he.jsxs)(le().sg,{gap:4,children:[(0,he.jsx)("div",{style:f.titleContainer,children:c?(0,he.jsx)(C()._H,{defaultMessage:'Update "{propertyName}" with AI',id:"BlockPropertyValueOverlay.bulkAiAutofillButton.titleWithPropertyName",values:{propertyName:c}}):(0,he.jsx)(C()._H,{defaultMessage:"Update with AI",id:"BlockPropertyValueOverlay.bulkAiAutofillButton.title"})}),(0,he.jsx)("div",{style:f.descriptionContainer,children:h?(0,he.jsx)(C()._H,{defaultMessage:"{numPages, select, 1 {Update {numPages} page} other {Update {numPages} pages}}",id:"BlockPropertyValueOverlay.bulkAiAutofillButton.countAndDescription",values:{numPages:m}}):(0,he.jsx)(C()._H,{defaultMessage:"Get the AI add-on to update more than {maxItems} pages at once",id:"BlockPropertyValueOverlay.bulkAiAutofillButton.largeBulkFillUpsellMessage",values:{maxItems:Je}})})]})]})}):null}function et(e){return(0,a().VK)((()=>{var t;if(!e.isOpen)return!1;const o=null===(t=e.collectionContextStore)||void 0===t?void 0:t.collectionStore();if(!o)return!1;const n=e.property;return Boolean(o.getDatabaseType()&&o.isTypedProperty(n))}),[e])}function tt(e){return(0,a().VK)((()=>Te(e)),[e])}function ot(e){return(0,a().VK)((()=>Ve(e)),[e])}function nt(e){return(0,a().VK)((()=>at(e)),[e])}function rt(e){return(0,a().VK)((()=>dt(e)),[e])}function it(e){const t=(0,i().O7)();return(0,a().VK)((()=>ft(e,t)),[e,t])}function lt(e){let{overlayState:t,propertyType:o,store:r}=e;const l=nt(t),a=g().Jcv(l),s=it(t),c=(0,i().O7)(),u=(0,n.useCallback)((e=>function(e,t,o){const n=o.state;if(!n.isOpen)return;const r=p().iD(e);A().createAndCommit({userAction:"BlockPropertyValueOverlay.handleURLValueChange",environment:t,canUndo:!0,perform:e=>{for(const o of ut(n))I().sO({environment:t,store:o,value:r,transaction:e})}}),Ct(n,t,o),R().bO(t,{pastedText:e,source:"url_property"})}(e,c,r)),[c,r]),d=(0,n.useCallback)((()=>ht(r,c)),[r,c]);let y="url";return"phone_number"===o?y="tel":"email"===o&&(y="email"),(0,he.jsx)(ve,{value:a,inputType:y,disabled:s,onChange:u,onDismiss:d})}function at(e){return e.store.getPropertyValue(e.property)}function st(e){return q().Sy(e.format)}function ct(e){return[e.store,...e.additionalStores]}function ut(e){return ct(e).map((t=>{const o=t.getAssociatedCollectionStore(),n=o?o.getMappedProperty(e.property):e.property;return t.getPropertyStore(n)}))}function dt(e){const t=Ve(e),o=null==t?void 0:t.getParentBlockStore();return H().eD({collectionStore:t,collectionViewBlockStore:o,checkNavigableAncestorLocked:!1})}function pt(e){const t=e.state;if(!t.isOpen)return"ignore";const o=Ee(t);return o?o.type:"ignore"}function yt(e,t,o){let{isFirstRender:n}=e;const r=t.state;if(!r.isOpen||!r.collectionContextStore)return;const i=J().default.DO_NOT_USE_markLegacy("collections.block_property_value_overlay_render");J().default.DO_NOT_USE_measureAfterNextFlushLegacy(i,{environment:o,getData:()=>{var e;return{...z().vS(r.collectionContextStore),is_first_render:n,property_type:null===(e=Ee(r))||void 0===e?void 0:e.type,from:q().Sy(r.format)}}})}function mt(e,t,o,n){const r=o.state;if(r.isOpen&&r.isOpen){const o=Ve(r);o&&(0,U().R)({environment:n,collectionStore:o,update:{schema:e},transaction:t})}}function ft(e,t){const o=Ee(e),n=o&&d().qQ(o)&&(0,d().q3)(o);if(n&&n.auto_update_on_edit&&(0,N().Zt)(t))return!0;const r=Ve(e);return!(null==r||!r.isExternallyImportedAndSyncedCollection()||!(0,$().K6)()||(0,$().Uo)()&&"read_write"===(null==o?void 0:o.synced_permissions))||(e.readOnly||(0,G().N)(t,e.store)||(0,u().w)(e.property))}function ht(e,t){B().xv({environment:t,blockPropertyValueOverlayStore:e})}function xt(e,t){B().i2({environment:t,blockPropertyValueOverlayStore:e})}function St(e,t,o){e.preventDefault(),B().$o({environment:o,blockPropertyValueOverlayStore:t})}function vt(e,t,o){e.preventDefault(),B().RX({environment:o,blockPropertyValueOverlayStore:t})}function bt(e,t){B().gT({environment:t,blockPropertyValueOverlayStore:e})}function gt(e,t,o){const n=t.state;if(!n.isOpen)return;const i=Ee(n);!i||"select"!==i.type&&"status"!==i.type||r().default.afterNextFlush((()=>{e?B().gT({environment:o,blockPropertyValueOverlayStore:t}):B().i2({environment:o,blockPropertyValueOverlayStore:t})}))}function Ct(e,t,o){const n=e.store.getType(),r=e.store.getAssociatedCollectionId(),i=Ee(e),{collectionContextStore:l}=e;if(n&&i&&l){const n=st(e);_().rv({environment:t,collectionContextStore:l,block_id:e.store.id,property:e.property,property_type:i.type,from:n,collection_id:r,isFromBulkActionsToolbar:q().VM(o),value_count:p().mx(e.store.getModel(),e.property,i)})}}function kt(e,t,o){const n=o.state;n.isOpen&&A().createAndCommit({userAction:"BlockPropertyValueOverlay.handleSelectPropertyMenuUpdate",environment:t,canUndo:!0,perform:r=>{if(P().z4(e.schemaOperations)||function(e,t,o,n){const r=o.state;if(r.isOpen&&r.isOpen){const o=Ve(r);if(o){const r=o.getSchema();for(const n of e)A().applyOperation({store:(0,oe().Kv)(o,n.pointer),operation:n,transaction:t});const i=o.getSchema();(0,F().C)({environment:n,collectionStore:o,oldSchema:r,newSchema:i,transaction:t})}}}(e.schemaOperations,r,o,t),"selectPropertyMenuUpdateReplaceOptions"===e.type){const i=p().zq(e.options);for(const e of ut(n))I().sO({environment:t,store:e,value:i,transaction:r});Ct(n,t,o)}else if("selectPropertyMenuUpdateAddOptions"===e.type){for(const t of ut(n))for(const o of e.addOptions)A().applyOperation({transaction:r,store:t,operation:{path:t.path,pointer:t.pointer,command:"addSelectOptionAfter",args:{option:o}}});Ct(n,t,o)}else if("selectPropertyMenuUpdateRemoveOption"===e.type){for(const t of ut(n))A().applyOperation({transaction:r,store:t,operation:{path:t.path,pointer:t.pointer,command:"removeSelectOption",args:{option:e.removeOption}}});Ct(n,t,o)}else"selectPropertyMenuUpdateSchema"===e.type||(0,w().t1)(e)}})}function wt(e,t,o,n){!function(e,t,o){const n=J().default.DO_NOT_USE_markLegacy("collections.property_overlay_typing_lag");J().default.DO_NOT_USE_measureAfterNextFlushLegacy(n,{environment:o,getData:()=>({...z().vS(e.collectionContextStore),property_type:t,from:q().Sy(e.format)})})}(e,t,o);const{store:r,property:i,additionalStores:l}=e,a=r.getPropertyStore(i).getValue();A().createAndCommit({userAction:"BlockPropertyValueOverlay.handleTextChange",environment:o,canUndo:!0,perform:e=>{for(const t of l)I().sO({environment:o,store:t.getPropertyStore(i),value:a,transaction:e})}}),Ct(e,o,n)}},459217:(e,t,o)=>{o.d(t,{D:()=>l,m:()=>i});var n=o(667294),r=o(785893);const i=(0,n.createContext)({blockPointers:[],collectionStore:void 0,collectionId:"",property:"",schema:{},analyticsFrom:void 0,isDisabled:!0,canConfigureCollection:!1,onChange:()=>{},onDismiss:()=>{},blockStore:void 0,blockPropertyValueOverlayStore:void 0,overlayMode:void 0,insertChar:void 0,format:o(356321).C.Table});function l(e){const{children:t,blockPointers:o,collectionStore:l,collectionId:a,property:s,schema:c,analyticsFrom:u,isDisabled:d,canConfigureCollection:p,blockStore:y,blockPropertyValueOverlayStore:m,overlayMode:f,insertChar:h,onChange:x,onDismiss:S,format:v}=e,b=(0,n.useMemo)((()=>({blockPointers:o,collectionStore:l,collectionId:a,property:s,schema:c,analyticsFrom:u,isDisabled:d,canConfigureCollection:p,blockStore:y,blockPropertyValueOverlayStore:m,overlayMode:f,insertChar:h,onChange:x,onDismiss:S,format:v})),[o,l,a,s,c,u,d,p,y,m,f,h,x,S,v]);return(0,r.jsx)(i.Provider,{value:b,children:t})}i.displayName="BlockPropertyValueOverlayContext"},932641:(e,t,o)=>{o.d(t,{FL:()=>a,Ww:()=>s,mZ:()=>i});var n=()=>o(967092),r=()=>o(603885);const i={title:n().kQ.Popup,text:n().kQ.Popup,number:n().kQ.Popup,url:n().kQ.Popup,phone_number:n().kQ.Popup,email:n().kQ.Popup,relation:n().kQ.SlideUp,rollup:n().kQ.SlideUp,select:n().kQ.SlideUp,multi_select:n().kQ.SlideUp,status:n().kQ.SlideUp,person:n().kQ.SlideUp,date:n().kQ.SlideUp,file:n().kQ.SlideUp,formula:n().kQ.SlideUp,checkbox:n().kQ.SlideUp,created_by:n().kQ.SlideUp,created_time:n().kQ.SlideUp,last_edited_by:n().kQ.SlideUp,last_edited_time:n().kQ.SlideUp,last_visited_time:n().kQ.SlideUp,button:n().kQ.SlideUp,auto_increment_id:n().kQ.Popup,location:n().kQ.Popup,verification:n().kQ.SlideUp,geo_point:n().kQ.SlideUp},l=Object.freeze({paddingLeft:9,paddingRight:9,paddingTop:6,paddingBottom:6,minHeight:34,display:"flex",height:"100%",flexDirection:"column",justifyContent:"space-between",flexGrow:1}),a=Object.freeze({...l,fontSize:r().z6}),s=Object.freeze({...l,fontSize:r().Ec,fontWeight:o(707513).Ue.medium})},280080:(e,t,o)=>{o.d(t,{s:()=>m});var n=o(667294),r=()=>o(219727),i=()=>o(142735),l=()=>o(846550),a=()=>o(698763),s=()=>o(799454),c=()=>o(852465),u=()=>o(687647),d=()=>o(265640),p=o(785893);const y=14;function m(e){let{store:t,iconStyle:o,size:m,buttonStyle:f}=e;const h=(0,r().O7)(),x=(0,n.useRef)(null),S=(0,i().VK)((()=>c().Xp(t,{recursivelyLoadAllDiscussions:!1})),[t]),{menuOpen:v,menuStoreId:b}=(0,i().VK)((()=>{const e=u().Z.state.open;return{menuOpen:e,menuStoreId:e?u().Z.state.blockStore.id:void 0}}),[]),g=(0,n.useCallback)((()=>{var e;v&&b===t.id?s().LZ():(s().LZ(),s().Ib({environment:h,blockStore:t,shouldFocusDiscussion:!0,analyticsFrom:"db_page_comments",rect:null===(e=x.current)||void 0===e?void 0:e.getBoundingClientRect(),recursivelyLoadAllDiscussions:!1}))}),[v,b,h,t]),C=(0,l().yK)((e=>({iconStyle:{fill:e.mediumIconColor}})),[]);return 0===S?null:(0,p.jsx)(d().D,{"aria-label":"Open comments",ref:x,size:"sm",style:f,onClick:g,children:(0,p.jsxs)("div",{style:o,children:[(0,a().s)({width:m??y,height:m??y,marginRight:3,fill:C.iconStyle.fill}),S]})})}},532212:(e,t,o)=>{o.d(t,{CJ:()=>V,Fm:()=>B,Gx:()=>j,JM:()=>C,T3:()=>R,Vj:()=>g,Vq:()=>_,ct:()=>T,g4:()=>M,lQ:()=>k,nm:()=>P,wi:()=>w});var n=o(667294),r=()=>o(219727),i=()=>o(142735),l=()=>o(846550),a=()=>o(552221),s=()=>o(874459),c=()=>o(998411),u=()=>o(271839),d=()=>o(826955),p=()=>o(961415),y=()=>o(984851),m=()=>o(96778),f=()=>o(356321),h=()=>o(201608),x=()=>o(603885),S=()=>o(168003),v=o(785893);const b=n.memo((0,n.forwardRef)((function(e,t){const{store:i,onContextMenu:a,editButtonClickProps:s,quickActionButtons:c,EmptyComponent:u,buttonStyle:d,property:p,width:y,formQuestionStore:f,userExpandable:x}=e,{isEmpty:S,baseStyles:b,propertySchema:C,propertyFormat:k}=(0,n.useContext)(m().OU),w=(0,h().oW)(i,p,C),P=(0,r().O7)(),j=C,_=g(i,null==j?void 0:j.type,p,P.currentUser.id),R=(0,l().yK)((e=>({buttonStyle:{...b.buttonStyle,...d},buttonPressedStyle:b.buttonPressedStyle??{},buttonHoveredStyle:b.buttonHoveredStyle??{}})),[b.buttonHoveredStyle,b.buttonPressedStyle,b.buttonStyle,d]);if(S&&void 0===u&&void 0===w)return null;let B;if(w)B=(0,v.jsx)(o(682518).P,{templateVariableType:w.templateVariable});else if(S&&void 0!==u)B=(0,v.jsx)(u,{});else{const e=(null==k?void 0:k.date_format)??(null==j?void 0:j.date_format),t=(null==k?void 0:k.time_format)??(null==j?void 0:j.time_format);B=(0,v.jsx)(o(10066).Y,{children:(0,v.jsx)(o(281875).z,{dateValue:_,dateFormat:e,timeFormat:t,store:i,property:p})})}return(0,v.jsx)(o(425803).e,{ref:t,style:R.buttonStyle,hoveredStyle:R.buttonHoveredStyle,pressedStyle:R.buttonPressedStyle,onContextMenu:a,editButtonClickProps:s,quickActionButtons:c,width:y,formQuestionStore:f,userExpandable:x,children:B})})));function g(e,t,o,n){return(0,i().VK)((()=>{switch(t){case"created_time":const t=e.getCreatedTime();return t?s().CQ(t,(0,c().r)()):void 0;case"last_edited_time":const r=e.getLastEditedTime();return r?s().CQ(r,(0,c().r)()):void 0;case"last_visited_time":if(!n)return;const i=d().H8.createChildStore(e,{table:u().UI,id:(0,u().Pv)({parent_id:e.id,user_id:n}),spaceId:e.getSpaceId()}).getVisitedAt();return i?s().CQ(i,(0,c().r)()):void 0;default:const l=e.getPropertyValue(o);return(0,a().G)(l)}}),[o,e,t,n])}const C=(0,n.forwardRef)((function(e,t){const{store:o,property:i,format:a}=e,{isMobile:s}=(0,r().Fy)(),c=(0,l().yK)((()=>({buttonStyle:{padding:x().sf[f().C.Page].text}})),[]),u=(0,n.useMemo)((()=>{if(!s)return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(p().U,{},"comment"),(0,v.jsx)(y().q,{store:o,property:i,format:a},"copy")]})}),[a,s,i,o]),d=E(e,t,c);return(0,v.jsx)(b,{...d,EmptyComponent:S().T$,quickActionButtons:u})})),k=(0,n.forwardRef)((function(e,t){const{store:o,property:i,format:a}=e,{isMobile:s}=(0,r().Fy)(),{shouldWrap:c}=(0,n.useContext)(m().OU),u=(0,l().yK)((()=>({buttonStyle:{padding:x().sf[f().C.Table].text}})),[]),d=(0,n.useMemo)((()=>{if(!s)return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(p().U,{},"comment"),(0,v.jsx)(y().q,{store:o,property:i,format:a},"copy")]})}),[a,s,i,o]),h=E(e,t,u);return(0,v.jsx)(b,{...h,EmptyComponent:S().q8,quickActionButtons:d,userExpandable:c})})),w=(0,n.forwardRef)((function(e,t){const{store:o,property:i,format:a}=e,s=E(e,t,(0,l().yK)((()=>({buttonStyle:{padding:x().sf[f().C.CompactPage].text}})),[])),{isMobile:c}=(0,r().Fy)(),u=(0,n.useMemo)((()=>{if(!c)return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(p().U,{},"comment"),(0,v.jsx)(y().q,{store:o,property:i,format:a},"copy")]})}),[a,c,i,o]);return(0,v.jsx)(b,{...s,EmptyComponent:S().T$,quickActionButtons:u})})),P=(0,n.forwardRef)((function(e,t){const{showIfEmpty:n}=e,r=E(e,t,(0,o(991333).m)(t,e.collectionStore,e.property,"date"));return(0,v.jsx)(b,{...r,EmptyComponent:n?S().s3:void 0})})),j=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=E(e,t,(0,l().yK)((()=>({buttonStyle:{padding:x().sf[f().C.Board].text}})),[]));return(0,v.jsx)(b,{...n,EmptyComponent:o?S().s3:void 0})})),_=(0,n.forwardRef)((function(e,t){const o=E(e,t);return(0,v.jsx)(b,{...o})})),R=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=E(e,t);return(0,v.jsx)(b,{...n,EmptyComponent:o?S().s3:void 0})})),B=(0,n.forwardRef)((function(e,t){const o=E(e,t);return(0,v.jsx)(b,{...o})})),M=(0,n.forwardRef)((function(e,t){const o=E(e,t);return(0,v.jsx)(b,{...o})})),T=(0,n.forwardRef)((function(e,t){const o=E(e,t);return(0,v.jsx)(b,{...o})})),V=(0,n.forwardRef)((function(e,t){const o=E(e,t);return(0,v.jsx)(b,{...o,EmptyComponent:S().zX})}));function E(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l,width:a}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,h().Am)(e),onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle,width:a}}},168003:(e,t,o)=>{o.d(t,{T$:()=>y,q8:()=>m,s3:()=>f,zX:()=>h});var n=o(667294),r=()=>o(142735),i=()=>o(846550),l=()=>o(570270),a=()=>o(766933),s=()=>o(788860),c=()=>o(96778),u=()=>o(10066),d=o(785893);const p="20px";function y(){return(0,d.jsx)(u().Y,{fontColor:"light",style:{lineHeight:p},isEmpty:!0,children:(0,d.jsx)(s()._H,{defaultMessage:"Empty",id:"database.pageProperty.emptyTitle"})})}function m(){return null}function f(){const e=(0,i().Fg)(),{store:t,property:o,collectionContextStore:p}=(0,n.useContext)(c().OU),y=(0,r().VK)((()=>{const e=null==p?void 0:p.normalizedSchemaStore.state,n=null==t?void 0:t.getAssociatedCollectionStore();if(!e||!n||!o)return;return e["collectionTypedView"===p.contextType?l().aQ.derivePropertyUri(o,n.getPropertyMapping())??o:o]}),[p,o,t]),m=(0,i().yK)((()=>({textContainer:{display:"inline-flex",alignItems:"center"},propertyIcon:{marginRight:6}})),[]);return y?(0,d.jsxs)(u().Y,{fontColor:"light",style:m.textContainer,children:[(0,d.jsx)(a().ZP,{type:y.type,icon:y.icon,size:14,theme:e,style:m.propertyIcon}),(0,d.jsx)(s()._H,{defaultMessage:"Add {propertyName}",id:"database.boardProperty.fillProperty",values:{propertyName:y.name}})]}):null}function h(){const e=(0,i().Fg)(),{propertySchema:t,baseStyles:o,collectionContextStore:l}=(0,n.useContext)(c().OU),s=(0,r().VK)((()=>{var e;return"hide"===(null==l||null===(e=l.collectionStore())||void 0===e||null===(e=e.getLayoutStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.property_icons_visibility)}),[l]),u=(0,i().yK)((e=>({container:{...null==o?void 0:o.textStyle,display:"inline-flex",alignItems:"center",overflow:"hidden",color:e.lightTextColor},text:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},icon:{marginRight:4}})),[o]);return t?(0,d.jsxs)("div",{style:u.container,children:[!s&&(0,d.jsx)(a().ZP,{type:t.type,icon:t.icon,size:14,theme:e,style:u.icon}),(0,d.jsx)("div",{style:u.text,children:t.name})]}):null}},134418:(e,t,o)=>{o.d(t,{$I:()=>G,CJ:()=>z,eQ:()=>q,iM:()=>U,lE:()=>F,mm:()=>H,n8:()=>I,p5:()=>L,tD:()=>D,tT:()=>Q,uS:()=>Z,wC:()=>O,yJ:()=>W});o(122556),o(582845),o(250570),o(533019),o(721473),o(788208),o(22624),o(267602),o(653476),o(749411),o(241792);var n=o(667294),r=()=>o(219727),i=()=>o(142735),l=()=>o(846550),a=()=>o(834458),s=()=>o(803021),c=()=>o(646574),u=()=>o(455222),d=()=>o(998411),p=()=>o(375255),y=()=>o(788860),m=()=>o(720866),f=()=>o(855741),h=()=>o(696459),x=()=>o(141735),S=()=>o(615676),v=()=>o(57687),b=()=>o(527278),g=()=>o(584461),C=()=>o(677559),k=()=>o(749826),w=()=>o(96778),P=()=>o(356321),j=()=>o(603885),_=()=>o(517084),R=()=>o(168003),B=o(785893);const M=n.memo(n.forwardRef((function(e,t){var r,s;const{store:c,property:p,EmptyComponent:h,collectionStore:b,onContextMenu:j,editButtonClickProps:R,checkboxButtonStyle:M,textButtonStyle:E,quickActionButtons:I,checkboxShowLabel:A,userExpandable:O}=e,{baseStyles:K,propertySchema:F,format:U}=(0,n.useContext)(w().OU),L=F,H="v2"===(null==L?void 0:L.version)?null==L||null===(r=L.formula2)||void 0===r?void 0:r.result_type.type:null==L||null===(s=L.formula)||void 0===s?void 0:s.result_type,W=!0===e.numberRightAlign&&"number"===(0,a().getFormulaPropertySchemaBaseResultType)(L),D=(0,C().XJ)(x().F.formulas),[Z,q]=function(e){var t,r;const{store:l,collectionStore:s,property:c,formulas:p,checkboxShowLabel:h,numberRightAlign:b}=e,j=(0,y().YB)(),{value:R}=(0,C().XJ)(x().F.formulas),{propertySchema:M,format:T,collectionSchema:E}=(0,n.useContext)(w().OU),I=M,A=(0,o(817606)._)(),O=(0,g().o)(),K=(0,i().VK)((()=>{if("v2"!==(null==I?void 0:I.version)&&E&&l.isDefined()&&R)return R.evaluateFormulaProperty({property:c,schema:E,block:l.getModel(),getRecordModel:l.getRecordModel,collectionRequestContext:{userId:void 0,userTimeZone:(0,d().r)(),depth:0,intl:j,resultCache:new Map,regExpCache:new Map,visitedProperties:new Set,formulaTimeoutTimestampMs:Date.now()+A,experimentService:k().default,collectionFeatureGates:(0,S().W)()}})}),[null==I?void 0:I.version,E,l,c,j,A,R],{debugName:`legacyFormulaEvaluation${l.id}`,...O}),F=(0,i().VK)((()=>{var e;const t=l.getModel(),n=null==I||null===(e=I.formula2)||void 0===e?void 0:e.code;if(v().il||!t||!p||!n||!R)return;const r=s.getModel();if(r){const e=R.getFormula2Thunk(t,r,c);if(e)return e}const i=new(o(435308).default)((()=>{const e=o(658096).default.state.publicPageData,r=R.evaluateCollectionFormula2WithoutCache({block:t,property:c,formulaCode:n,getRecordModel:l.getRecordModel,intl:j,userTimeZone:(0,d().r)(),depth:0,visitedProperties:new Set,formulaTimeoutTimestampMs:Date.now()+A,resultCache:new Map,regExpCache:new Map,publicPageDataCollection:{id:null==e?void 0:e.collectionId,schema:null==e?void 0:e.collectionSchema},experimentService:k().default,collectionFeatureGates:(0,S().W)()});return r?f().x.isFail(r)?{type:r.error.type,error:r.error}:{value:r.value}:{error:{type:u().FY.UnexpectedError,error:(0,m().t)(void 0)}}}),{debugName:`formula2Evaluation${l.id}`,useDeepEqual:!0,...O});return r&&R.setFormula2Thunk(t,r,c,(()=>{const e=i.getState();return e===g().b?{value:{type:"undefined"}}:e})),i.getState()}),[l,null==I||null===(t=I.formula2)||void 0===t?void 0:t.code,p,s,O,c,j,A,R]),U=(0,i().VK)((()=>{var e,t;if("v2"===(null==I?void 0:I.version)){var o;if(void 0===F||F===g().b)return[[],"formula"];if(f().x.isFail(F))return V.includes(F.error.type)?[[{id:"error",type:"error",value:F.error}],"error"]:[[],"formula"];const e=G(!(t=F)||f().x.isFail(t)?{type:"undefined"}:t.value,l.getRecordModel,(0,d().r)());return[e,(null===(o=e[0])||void 0===o?void 0:o.type)??"text"]}return K&&K!==g().b?[Q(K),(null==I||null===(e=I.formula)||void 0===e?void 0:e.result_type)??"text"]:[[],"formula"]}),[null==I?void 0:I.version,null==I||null===(r=I.formula)||void 0===r?void 0:r.result_type,K,F,l.getRecordModel]),L="v2"===(null==I?void 0:I.version)?F===g().b:K===g().b,H=(0,i().VK)((()=>{const[e,t]=U;if(L)return(0,B.jsx)(o(662835).L,{style:{justifyContent:b?"flex-end":void 0}});if(0===e.length)return null;const n=h&&"checkbox"===(0,a().getFormulaPropertySchemaResultType)(I)&&1===e.length?null==I?void 0:I.name:void 0,r=!!I&&(0,_().vQ)(t,I),i=1===e.length;return I&&(0,B.jsx)(_().E1,{propertyType:t,rootPropertySchema:I,numberRightAlign:b,store:l,property_id:c,children:e.map(((t,o)=>(0,B.jsx)(_().gZ,{token:t,targetPropertySchema:I,blockStore:l,checkboxPropertyLabel:n,withComma:r&&o<e.length-1,numberRightAlign:b,shouldTruncate:i&&T===P().C.CompactPage,disableLinks:T===P().C.CompactPage},`${t.id}-${o}`)))})}),[h,T,I,U,L,b,c,l]);return[H,L]}({store:c,collectionStore:b,property:p,numberRightAlign:W,checkboxShowLabel:A,formulas:D}),z=(0,l().yK)((e=>({buttonStyle:{...K.buttonStyle,..."checkbox"===H?M:{},..."number"===H||"date"===H||"text"===H?E:{}},buttonPressedStyle:K.buttonPressedStyle??{},buttonHoveredStyle:K.buttonHoveredStyle??{}})),[K.buttonHoveredStyle,K.buttonPressedStyle,K.buttonStyle,M,H,E]),N=(0,o(802729).H)({propertyId:p,store:c});if(v().il)return(0,B.jsx)("div",{style:{padding:"5px 8px"},children:(0,B.jsx)(o(10066).Y,{fontColor:"light",children:(0,B.jsx)(y()._H,{defaultMessage:"Disabled",id:"database.pageProperty.disableFormulas"})})});const $=null===Z;return $&&void 0===h?null:(0,B.jsxs)(o(425803).e,{ref:t,className:N,onContextMenu:j,editButtonClickProps:R,style:z.buttonStyle,pressedStyle:z.buttonPressedStyle,hoveredStyle:z.buttonHoveredStyle,quickActionButtons:!q&&I?(0,B.jsx)(T,{buttons:I,store:c,collectionStore:b,property:p,format:U,isEmpty:$}):void 0,quickActionButtonsAlign:W?"left":void 0,userExpandable:O,children:[$&&h&&(0,B.jsx)(h,{}),!$&&Z]})})));function T(e){const{buttons:t,store:n,property:r,format:i,isEmpty:l}=e;if(l)return null;const a=t.map((e=>{switch(e){case"copy":return(0,B.jsx)(o(984851).q,{store:n,property:r,format:i},"copy");case"comment":return(0,B.jsx)(o(961415).U,{},"comment");default:(0,h().t1)(e)}})).filter(h().K0);return a?(0,B.jsx)(B.Fragment,{children:a}):null}const V=[u().FY.MaxEvaluationTimeExceeded,u().FY.DepthExceeded,u().FY.CycleDetected];const E=["comment","copy"],I=n.forwardRef((function(e,t){const{isMobile:o}=(0,r().Fy)(),{shouldWrap:i}=(0,n.useContext)(w().OU),a=N(e,t,(0,l().yK)((()=>({checkboxButtonStyle:{padding:j().sf[P().C.Table].checkbox},textButtonStyle:{padding:j().sf[P().C.Table].text}})),[]));return(0,B.jsx)(M,{...a,numberRightAlign:!0,EmptyComponent:R().q8,quickActionButtons:o?void 0:E,userExpandable:i})})),A=["comment","copy"],O=n.forwardRef((function(e,t){const o=N(e,t,(0,l().yK)((()=>({checkboxButtonStyle:{padding:j().sf[P().C.Page].checkbox},textButtonStyle:{padding:j().sf[P().C.Page].text}})),[]));return(0,B.jsx)(M,{...o,EmptyComponent:R().T$,quickActionButtons:A})})),K=["comment","copy"],F=n.forwardRef((function(e,t){const{isMobile:n}=(0,r().Fy)(),i=N(e,t,(0,l().yK)((()=>({checkboxButtonStyle:{padding:j().sf[P().C.CompactPage].checkbox},textButtonStyle:{padding:j().sf[P().C.CompactPage].text,width:"100%",...o(707513).Yu}})),[]));return(0,B.jsx)(M,{...i,EmptyComponent:R().T$,quickActionButtons:n?void 0:K})})),U=n.forwardRef((function(e,t){const o=N(e,t);return(0,B.jsx)(M,{...o,EmptyComponent:R().zX})})),L=n.forwardRef((function(e,t){const n=N(e,t,(0,o(991333).m)(t,e.collectionStore,e.property,"formula"));return(0,B.jsx)(M,{...n})})),H=n.forwardRef((function(e,t){const o=N(e,t,(0,l().yK)((()=>({checkboxButtonStyle:{padding:j().sf[P().C.Board].checkbox},textButtonStyle:{padding:j().sf[P().C.Board].text}})),[]));return(0,B.jsx)(M,{...o,checkboxShowLabel:!0})})),W=n.forwardRef((function(e,t){const o=N(e,t);return(0,B.jsx)(M,{...o,checkboxShowLabel:!0})})),D=n.forwardRef((function(e,t){const o=N(e,t);return(0,B.jsx)(M,{...o,checkboxShowLabel:!0})})),Z=n.forwardRef((function(e,t){const o=N(e,t);return(0,B.jsx)(M,{...o})})),q=n.forwardRef((function(e,t){const o=N(e,t);return(0,B.jsx)(M,{...o})})),z=n.forwardRef((function(e,t){const o=N(e,t);return(0,B.jsx)(M,{...o})}));function N(e,t,n){const{store:r,onContextMenu:i,property:l,collectionStore:a}=e;return{ref:t,store:r,property:l,collectionStore:a,editButtonClickProps:(0,o(201608).Am)(e),onContextMenu:i,checkboxButtonStyle:null==n?void 0:n.checkboxButtonStyle,textButtonStyle:null==n?void 0:n.textButtonStyle}}function Q(e){if(void 0===e)return[];if("string"==typeof e)return 0===e.length?[]:[{id:e,type:"text",value:[[e]]}];if("number"==typeof e)return[{id:e,type:"number",value:e}];if((0,s().U3)(e)){return[{id:c().ZV({allowRelativeDates:!1,value:e,userTimeZone:(0,d().r)(),intl:b().Z.getIntl()}),type:"date",value:e}]}if("boolean"==typeof e)return[{id:e,type:"checkbox",value:e}];(0,h().t1)(e)}function G(e,t,o){if(void 0===e)return[];switch(e.type){case"text":const n=(0,p().Xh)({textValue:e.value,getRecordModel:t,userTimeZone:o,intl:b().Z.getIntl(),deterministic:!0});return 0===n.length?[]:[{id:n,type:"text",value:e.value}];case"block":return[{id:e.value.id,type:"relation",value:e.value}];case"date":return[{id:c().ZV({allowRelativeDates:!1,value:e.value,userTimeZone:(0,d().r)(),intl:b().Z.getIntl()}),type:"date",value:e.value}];case"checkbox":return[{id:e.value,type:"checkbox",value:e.value}];case"number":return[{id:e.value,type:"number",value:e.value}];case"person":return[{id:e.value.id,type:"person",value:e.value}];case"array":return e.values.flatMap((e=>G(e,t,o)));case"undefined":case"function":return[];default:(0,h().t1)(e)}}},114637:(e,t,o)=>{o.d(t,{Yh:()=>P,ZD:()=>j,_1:()=>C,aE:()=>w,d3:()=>h,dE:()=>b,hO:()=>k,ps:()=>x,qk:()=>v,vt:()=>g,zu:()=>S});o(241792);var n=o(667294),r=()=>o(846550),i=()=>o(532850),l=()=>o(998901),a=()=>o(588366),s=()=>o(961415),c=()=>o(96778),u=()=>o(533845),d=()=>o(168003),p=o(785893);const y=[],m=n.memo((0,n.forwardRef)((function(e,t){const{buttonStyle:l,editButtonClickProps:a,property:s,EmptyComponent:u,onContextMenu:d,tokenLimit:m,store:h,quickActionButtons:x,width:S,limitTokensToSingleTruncatedLine:v,userExpandable:b}=e,{propertySchema:g,isEmpty:C,baseStyles:k,shouldRenderTooltip:w}=(0,n.useContext)(c().OU),P=(0,o(603885).jV)(null==k?void 0:k.tokenFormat),j=g,_=(null==j?void 0:j.options)??y,R=null==j?void 0:j.type,B=(0,o(142735).VK)((()=>h.getPropertyValue(s)),[h,s]),[M,T]=(0,n.useMemo)((()=>{let e=[];if("select"===R){const t=i().P4(B,_);e=t?[t]:[]}else e=i().ib(B,_);return[m?e.slice(0,m):e,m?e.slice(m):[]]}),[R,m,B,_]),V=(0,r().yK)((e=>({buttonStyle:{...k.buttonStyle,...l},buttonPressedStyle:k.buttonPressedStyle??{},buttonHoveredStyle:k.buttonHoveredStyle??{},overflowIndicator:{marginRight:4,color:e.mediumTextColor},tooltip:{padding:8},remainderPropertiesContainer:{display:"flex",flexWrap:"wrap",fontWeight:"normal",width:"max-content",maxWidth:"240px",gap:4},selectToken:{margin:0},tokenContainer:v?{display:"flex",flexWrap:"nowrap",...o(707513).Yu}:{},moreToken:{margin:0,...v?{flexShrink:0}:{}}})),[k.buttonHoveredStyle,k.buttonPressedStyle,k.buttonStyle,l,v]);return C&&void 0===u?null:(0,p.jsx)(o(425803).e,{ref:t,editButtonClickProps:a,onContextMenu:d,style:V.buttonStyle,hoveredStyle:V.buttonHoveredStyle,pressedStyle:V.buttonPressedStyle,quickActionButtons:x,width:S,userExpandable:b,children:C&&void 0!==u?(0,p.jsx)(u,{}):(0,p.jsx)(f,{shownOptions:M,hiddenOptions:T,tokenLimit:m,tokenFormat:P,styles:V,store:h,property:s,parentHasTooltip:w})})})));function f(e){let{shownOptions:t,hiddenOptions:n,tokenLimit:i,styles:a,tokenFormat:s,store:c,property:d,parentHasTooltip:y}=e;const m=(0,r().Fg)(),f=(0,o(535950).g)({blockId:null==c?void 0:c.id,propertyId:d}),h=(0,o(802729).H)({propertyId:d,store:c}),x=Boolean(h),S=(0,r().yK)((()=>{const e=x||f?{...(0,o(463212).Y)(m),paddingTop:4,paddingBottom:4,flexWrap:"wrap",lineHeight:2,display:"inline"}:{},t=x||f?{marginLeft:3,marginRight:3,maxWidth:"fit-content",display:"inline-flex"}:{};return{tokenContainer:{...e,...a.tokenContainer},selectTokenHighlightStyle:t}}),[f,a.tokenContainer,m,x]);return(0,p.jsxs)(o(616978).K,{style:S.tokenContainer,className:h,children:[t.map((e=>(0,p.jsx)(u().J,{type:"select",value:e.value,description:e.description,color:e.color,shouldShrink:!!i,style:S.selectTokenHighlightStyle,shouldShowTooltip:!y},e.id))),n.length>0&&(0,p.jsx)(o(654133).Z,{style:a.tooltip,renderTooltip:()=>(0,p.jsx)("div",{style:a.remainderPropertiesContainer,children:n.map((e=>(0,p.jsx)(u().J,{type:"select",value:e.value,color:e.color,shouldShrink:!1},e.id)))}),isLightBackground:!0,textWrap:!0,alignment:l().Alignment.Center,placement:l().Placement.Bottom,render:e=>(0,p.jsx)("div",{...e,children:(0,p.jsx)(o(762141).Z,{count:n.length,format:s,fixedHeight:!1,style:a.moreToken,isCompact:!0})})})]})}const h=(0,n.forwardRef)((function(e,t){const{store:o,property:r}=e,{shouldWrap:i}=(0,n.useContext)(c().OU),l=(0,n.useMemo)((()=>(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(a().Z,{store:o,property:r,openOverlay:!0},"autofill"),(0,p.jsx)(s().U,{},"comment")]})),[r,o]),u=_(e,t);return(0,p.jsx)(m,{...u,EmptyComponent:d().q8,quickActionButtons:l,userExpandable:i})})),x=(0,n.forwardRef)((function(e,t){const o=_(e,t),{store:r,property:i}=e,l=(0,n.useMemo)((()=>(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(a().Z,{store:r,property:i,openOverlay:!0},"autofill"),(0,p.jsx)(s().U,{},"comment")]})),[i,r]);return(0,p.jsx)(m,{...o,EmptyComponent:d().T$,quickActionButtons:l})})),S=(0,n.forwardRef)((function(e,t){const o=_(e,t),{store:r,property:i}=e,l=(0,n.useMemo)((()=>(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(a().Z,{store:r,property:i,openOverlay:!0},"autofill"),(0,p.jsx)(s().U,{},"comment")]})),[i,r]);return(0,p.jsx)(m,{...o,EmptyComponent:d().T$,tokenLimit:1,quickActionButtons:l,limitTokensToSingleTruncatedLine:!0})})),v=(0,n.forwardRef)((function(e,t){const{showIfEmpty:n}=e,r=_(e,t,(0,o(991333).m)(t,e.collectionStore,e.property,"multi_select"));return(0,p.jsx)(m,{...r,EmptyComponent:n?d().s3:void 0})})),b=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=_(e,t);return(0,p.jsx)(m,{...n,EmptyComponent:o?d().s3:void 0})})),g=(0,n.forwardRef)((function(e,t){const o=_(e,t);return(0,p.jsx)(m,{...o})})),C=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=_(e,t);return(0,p.jsx)(m,{...n,EmptyComponent:o?d().s3:void 0})})),k=(0,n.forwardRef)((function(e,t){const o=_(e,t);return(0,p.jsx)(m,{...o})})),w=(0,n.forwardRef)((function(e,t){const o=_(e,t);return(0,p.jsx)(m,{...o})})),P=(0,n.forwardRef)((function(e,t){const o=_(e,t);return(0,p.jsx)(m,{...o})})),j=(0,n.forwardRef)((function(e,t){const o=_(e,t);return(0,p.jsx)(m,{...o,EmptyComponent:d().zX,tokenLimit:1})}));function _(e,t,n){const{store:r,collectionStore:i,property:l,onContextMenu:a,width:s}=e;return{ref:t,store:r,collectionStore:i,property:l,editButtonClickProps:(0,o(201608).Am)(e),onContextMenu:a,buttonStyle:null==n?void 0:n.buttonStyle,width:s}}},147854:(e,t,o)=>{o.d(t,{Ss:()=>R,u9:()=>B,yM:()=>w,ht:()=>M,l2:()=>_,Xl:()=>P,uH:()=>k,s0:()=>v,HW:()=>j,ku:()=>V,bQ:()=>E,QA:()=>C,WY:()=>T,cQ:()=>I});o(821057),o(267602),o(653476),o(749411),o(241792);var n=o(667294),r=()=>o(219727),i=()=>o(142735),l=()=>o(846550),a=()=>o(816512),s=()=>o(38883),c=()=>o(696459),u=()=>o(826955),d=()=>o(961415),p=()=>o(96778),y=()=>o(201608),m=()=>o(168003),f=()=>o(998901),h=o(785893);function x(e){let{renderOrigin:t,actors:n,placement:i=f().Placement.Bottom,alignment:a=f().Alignment.Start}=e;const s=(0,r().MO)(),c=(0,l().yK)((()=>({scrollContainer:{maxHeight:"min(50vh, 300px)",overflowY:"auto"},listContainer:{display:"flex",flexDirection:"column",gap:6,paddingTop:6,paddingBottom:6},tooltip:{maxWidth:300,paddingTop:0,paddingBottom:0}})),[]);return(0,h.jsx)(o(654133).Z,{placement:i,alignment:a,disableTooltip:s||n.length<1,render:t,style:c.tooltip,allowHover:!0,renderTooltip:e=>(0,h.jsx)("div",{...e,style:c.scrollContainer,children:(0,h.jsx)("div",{style:c.listContainer,children:n.map((e=>e instanceof u().U6?(0,h.jsx)(o(239444).Z,{userStore:e,avatarSize:20,inline:!0,hasTooltip:!1},e.id):e instanceof u().Qx?(0,h.jsx)(o(51620).Z,{botStore:e,avatarSize:20},e.id):null))})})})}const S=n.memo(x),v=n.memo(n.forwardRef((function(e,t){const{buttonStyle:r,onContextMenu:i,editButtonClickProps:a,property:c,store:u,EmptyComponent:d,tokenLimit:m,quickActionButtons:f,width:x,formQuestionStore:S,collectionSchema:v,limitTokensToSingleTruncatedLine:C,userExpandable:k}=e,{propertySchema:w,baseStyles:P,format:j}=(0,n.useContext)(p().OU),_=(0,y().oW)(u,c,w),R=(0,o(603885).jV)(null==P?void 0:P.tokenFormat),B=g({store:u,property:c,propertySchema:w,format:j}),M=0===B.length,T=(0,l().yK)((()=>({buttonStyle:{...P.buttonStyle,...r},buttonPressedStyle:P.buttonPressedStyle??{},buttonHoveredStyle:P.buttonHoveredStyle??{},tokensContainer:{...R===s().lo.Inline?{gap:0}:{},...C&&{display:"flex",...o(707513).Yu}},actorTokenOverlap:{...R===s().lo.Inline?{margin:o(793041).wS[R].margin}:{}},moreToken:{margin:0,...C&&{flexShrink:0}}})),[P.buttonHoveredStyle,P.buttonPressedStyle,P.buttonStyle,r,C,R]);return M&&void 0===d?null:(0,h.jsx)(o(425803).e,{ref:t,editButtonClickProps:a,onContextMenu:i,style:T.buttonStyle,pressedStyle:T.buttonPressedStyle,hoveredStyle:T.buttonHoveredStyle,tooltipHide:R===s().lo.Inline,quickActionButtons:f,width:x,formQuestionStore:S,collectionSchema:v,userExpandable:k,children:M&&void 0!==d&&!_?(0,h.jsx)(d,{}):(0,h.jsx)(b,{values:B,tokenLimit:m,tokenFormat:R,styles:T,store:u,property:c,limitTokensToSingleTruncatedLine:C??!1})})})));function b(e){let{values:t,tokenLimit:n,tokenFormat:r,styles:s,store:u,property:d,limitTokensToSingleTruncatedLine:p}=e;const y=t.slice(0,n),m=(0,l().Fg)(),f=(0,i().VK)((()=>{if(u)return(0,o(852465).vV)(u,{includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===d))}),[u,d]),x=(0,o(535950).g)({blockId:null==u?void 0:u.id,propertyId:d}),S=f&&(null==f?void 0:f.length)>0||x,v=(0,l().yK)((()=>({personTokenHighlightStyle:S?{marginLeft:3,marginRight:3,maxWidth:"fit-content",display:"inline-block"}:{},wrapperStyle:{...s.tokensContainer,...S?{...(0,o(463212).Y)(m),paddingTop:9,paddingBottom:0,lineHeight:2,...p?{display:"flex"}:{flexWrap:"wrap",display:"inline"}}:{}}})),[S,p,s.tokensContainer,m]),b=(0,o(802729).H)({propertyId:d,store:u});return(0,h.jsxs)(o(616978).K,{className:b,style:v.wrapperStyle,children:[y.map(((e,n)=>(0,a().Wk)(e)?(0,h.jsx)(o(923768).H,{actorPointer:e,style:{...n<t.length-1&&s.actorTokenOverlap,...v.personTokenHighlightStyle,...p&&{width:"100%",flexShrink:1}}},e.id):(0,o(955620).D4X)(e)?(0,h.jsx)(o(682518).w,{templateVariableType:e},`person-property-value-${e}`):void(0,c().P)(e))),n&&t.length>n&&(0,h.jsx)(o(762141).Z,{count:t.length-n,format:r,style:s.moreToken,fixedHeight:!0,isCompact:!0})]})}function g(e){let{property:t,store:n,propertySchema:r,format:l}=e;return(0,i().VK)((()=>{const e=null==r?void 0:r.type;switch(e){case"created_by":{const e=n.getCreatedByPointer();if(e)return[e];break}case"last_edited_by":{const e=n.getLastEditedByPointer();if(e)return[e];break}case"person":{const e=n.isTemplate();return(0,o(532850).BW)({value:n.getPropertyValue(t),isTemplatePage:e,propertySchema:r,blockCreatorPointer:e||(0,o(589024).xE)(l)?void 0:n.getCreatedByPointer()})}case void 0:return[];default:(0,c().t1)(e)}return[]}),[t,r,n,l])}const C=n.forwardRef((function(e,t){const{shouldWrap:o}=(0,n.useContext)(p().OU),r=(0,n.useMemo)((()=>(0,h.jsx)(d().U,{},"comment")),[]),i=I(e,t);return(0,h.jsx)(v,{...i,EmptyComponent:m().q8,collectionStore:e.collectionStore,quickActionButtons:r,userExpandable:o})})),k=n.forwardRef((function(e,t){const o=I(e,t),r=(0,n.useMemo)((()=>(0,h.jsx)(d().U,{},"comment")),[]);return(0,h.jsx)(v,{...o,EmptyComponent:m().T$,collectionStore:e.collectionStore,quickActionButtons:r})})),w=n.forwardRef((function(e,t){var o;const l=I(e,t),s=(0,r().O7)(),{propertySchema:c}=(0,n.useContext)(p().OU),y=c,f=g({store:e.store,property:e.property,propertySchema:y,format:e.format}),x=(0,i().VK)((()=>{var t;const o=null===(t=e.store)||void 0===t?void 0:t.getRecordModel;return o?f.flatMap((e=>{if(!(0,a().Wk)(e))return[];const t=(0,a().Hl)({pointer:e,getRecordModel:o});return t&&t.asActor?[u().t1.createUniqueRootStore(s,t.pointer)]:[]})):[]}),[s,f,null===(o=e.store)||void 0===o?void 0:o.getRecordModel]),b=(0,n.useMemo)((()=>(0,h.jsx)(d().U,{},"comment")),[]);return(0,h.jsx)(S,{actors:x,renderOrigin:e=>(0,h.jsx)("div",{...e,children:(0,h.jsx)(v,{...l,EmptyComponent:m().T$,tokenLimit:1,quickActionButtons:b,limitTokensToSingleTruncatedLine:!0})})})})),P=n.forwardRef((function(e,t){const o=I(e,t);return(0,h.jsx)(v,{...o,EmptyComponent:m().zX,tokenLimit:1})})),j=n.forwardRef((function(e,t){const{store:r,property:i}=I(e,t),{propertySchema:l,propertyModule:a,format:s}=(0,n.useContext)(p().OU),c=l,u=g({store:r,property:i,propertySchema:c,format:s});return a&&(0,o(639708).xV)(a)?(0,h.jsx)(o(384152).Z,{ref:t,store:r,property:i,children:(0,h.jsx)(o(968459).r,{store:r,property:i,propertyValues:u,propertySchema:c,module:a,format:e.format})}):((0,o(363936).q)({from:"PropertyModulePersonProperty",type:"invalidModule",throttleSeconds:60,error:new Error("Expected to find a property_person module."),data:{blockId:r.id,propertyId:i,miscDataToConvertToString:{moduleType:null==a?void 0:a.type}}}),null)})),_=n.forwardRef((function(e,t){const n=I(e,t,(0,o(991333).m)(t,e.collectionStore,e.property,"person"));return(0,h.jsx)(v,{...n,EmptyComponent:e.showIfEmpty?m().s3:void 0})})),R=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=I(e,t);return(0,h.jsx)(v,{...n,EmptyComponent:o?m().s3:void 0})})),B=n.forwardRef((function(e,t){const o=I(e,t);return(0,h.jsx)(v,{...o})})),M=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=I(e,t);return(0,h.jsx)(v,{...n,EmptyComponent:o?m().s3:void 0})})),T=n.forwardRef((function(e,t){const o=I(e,t);return(0,h.jsx)(v,{...o})})),V=n.forwardRef((function(e,t){const o=I(e,t);return(0,h.jsx)(v,{...o})})),E=n.forwardRef((function(e,t){const o=I(e,t);return(0,h.jsx)(v,{...o})}));function I(e,t,o){const{store:n,property:r,onContextMenu:i,width:l}=e;return{ref:t,store:n,property:r,editButtonClickProps:(0,y().Am)(e),onContextMenu:i,buttonStyle:null==o?void 0:o.buttonStyle,width:l}}},154989:(e,t,o)=>{o.d(t,{Bn:()=>Z,Ck:()=>q,Ey:()=>U,G7:()=>H,Il:()=>D,L3:()=>T,NY:()=>z,S9:()=>M,YS:()=>G,cQ:()=>J,fU:()=>N,p5:()=>W,up:()=>Y,w4:()=>L,z8:()=>F});o(670560),o(267602),o(653476),o(241792);var n=o(667294),r=()=>o(219727),i=()=>o(142735),l=()=>o(846550),a=()=>o(331540),s=()=>o(226413),c=()=>o(532850),u=()=>o(38883),d=()=>o(463212),p=()=>o(909240),y=()=>o(589024),m=()=>o(466970),f=()=>o(998901),h=()=>o(826955),x=()=>o(154186),S=()=>o(255577),v=()=>o(654133),b=()=>o(103462),g=()=>o(203571),C=()=>o(96778),k=()=>o(356321),w=()=>o(762141),P=()=>o(201608),j=()=>o(511584),_=()=>o(616978),R=()=>o(168003),B=o(785893);function M(e){const{store:t,property:o,propertySchema:n}=e,r=(0,m().E)("relations_show_deleted"),l=(0,m().E)("relations_show_invalid_collection"),a=(0,m().E)("relations_show_no_access");return(0,i().VK)((()=>{const e=t.getPropertyValue(o);return n?c().j$({relationValue:c().rq(e),propertySchema:n,getRecordModel:t.getRecordModel,includeDeleted:r,includeInvalidCollection:l,includeNoAccess:a}):void 0}),[t,o,n,r,l,a])}function T(e){const{store:t,relationValue:o,propertySchema:n}=e;return(0,i().VK)((()=>{const e=null!=n&&n.limit&&o?o.slice(0,n.limit):o;return e?e.map((e=>({pointer:e,pageStore:h().G.createChildStore(t,e)}))):[]}),[n,o,t])}const V=n.memo((0,n.forwardRef)((function(e,t){const{collectionStore:r,buttonStyle:a,editButtonClickProps:c,property:u,EmptyComponent:d,onContextMenu:p,blockPropertyValueOverlayStore:y,store:m,format:f,renderAs:x,quickActionButtons:S,width:v,formQuestionStore:b,userExpandable:g}=e,{propertySchema:w,isReadOnly:P,baseStyles:j,collectionContextStore:_}=(0,n.useContext)(C().OU),R=w,V=(0,o(603885).jV)(null==j?void 0:j.tokenFormat),O=(0,i().qz)(void 0,o(692304).Z),K=M({store:m,propertySchema:R,property:u}),F=(0,o(535950).g)({blockId:null==m?void 0:m.id,propertyId:u}),U=(0,o(802729).H)({propertyId:u,store:m}),L=Boolean(U),H=(0,n.useMemo)((()=>{const e=R?s().j0(R):void 0;return e?h().NW.createChildStore(m,e):void 0}),[R,m]),W=T({store:m,propertySchema:R,relationValue:K}),D=0===W.length,Z="rows"===x&&!D,q=(0,l().yK)((e=>({buttonStyle:{...j.buttonStyle,...a,...Z&&{padding:0}},buttonPressedStyle:j.buttonPressedStyle??{},buttonHoveredStyle:j.buttonHoveredStyle??{},overflowIndicator:{marginRight:4,color:e.mediumTextColor},relationItemsWrapper:{width:"100%"},openPageButton:{width:20,height:20}})),[j.buttonHoveredStyle,j.buttonPressedStyle,j.buttonStyle,a,Z]),z=(0,n.useMemo)((()=>H?"rows"===x?R&&K&&(0,B.jsx)(E,{relationItemPointers:W,relationValue:K,collectionStore:r,menuListStore:O,store:m,targetCollectionStore:H,property:u,disabled:P,buttonContainerRef:t,blockPropertyValueOverlayStore:y,format:f,propertySchema:R,collectionContextStore:_}):"inline"===x?(0,B.jsx)(I,{relationItemPointers:W,relationPropertySchema:R,store:m,tokenFormat:V,hasUnresolvedDiscussion:L,hasDraftComment:F}):"singleWithOverflow"===x?(0,B.jsx)(A,{relationItemPointers:W,relationPropertySchema:R,store:m,tokenFormat:V,hasUnresolvedDiscussion:L,hasDraftComment:F,buttonContainerRef:t,blockPropertyValueOverlayStore:y,property:u,format:f,collectionContextStore:_}):void(0,o(696459).t1)(x):null),[H,x,R,K,W,r,O,m,u,P,t,y,f,_,V,L,F]),N=n.useCallback((e=>z||[k().C.PropertyModule,k().C.Page].includes(f)?(0,B.jsx)("div",{style:q.relationItemsWrapper,className:U,children:e.children}):(0,B.jsx)(B.Fragment,{children:e.children})),[U,f,z,q.relationItemsWrapper]);return D&&void 0===d?null:(0,B.jsx)(o(425803).e,{ref:t,editButtonClickProps:Z?void 0:c,forceEnableButton:"singleWithOverflow"===x,onContextMenu:p,style:q.buttonStyle,hoveredStyle:q.buttonHoveredStyle,pressedStyle:q.buttonPressedStyle,quickActionButtons:S,width:v,formQuestionStore:b,userExpandable:g,children:(0,B.jsx)(N,{children:D&&void 0!==d?(0,B.jsx)(d,{}):z})})})));function E(e){const{collectionStore:t,targetCollectionStore:s,relationItemPointers:c,relationValue:d,property:m,store:f,disabled:h,menuListStore:v,buttonContainerRef:b,blockPropertyValueOverlayStore:g,format:k,propertySchema:P,collectionContextStore:j}=e,_=(0,r().O7)(),{collectionSchema:R}=(0,n.useContext)(C().OU),M=(0,n.useCallback)(((e,t)=>{p().bA({environment:_,blockPropertyValueOverlayStore:g,store:f,property:m,rect:null==t?void 0:t.getBoundingClientRect(),format:k,mode:e,collectionContextStore:j})}),[g,j,_,k,m,f]),T=(0,n.useCallback)(((e,t)=>{if(!j)return;const n=e.filter((e=>e.id!==t.id));o(269299).createAndCommit({userAction:"RelationBlockPropertyValue.handleRemoveRelationClick",environment:_,canUndo:!0,perform:e=>{o(917881).sf({store:f,propertyId:m,value:n,environment:_,relatedPageId:t.id,propertySchema:P,transaction:e,collectionContextStore:j,analyticsData:{isFromBulkActionsToolbar:y().VM(g),analyticsFrom:y().Sy(k)},isUnthrottled:!1})}})}),[g,j,_,k,m,P,f]),V=(0,i().VK)((()=>s.getFormatStore().getKeyStore("app_config_uri").getValue()===a().p$),[s]),E=(0,l().yK)((()=>({moreMenuItem:{width:"100%",display:"flex",alignItems:"center",justifyItems:"center",borderRadius:4,fontSize:14,minHeight:32,margin:0,padding:"6px 8px"},moreMenuItemLabel:{lineHeight:"normal",margin:0}})),[]);if(!R)return null;const I=c.slice(0,5).map(((e,n)=>{let{pageStore:r}=e;return{key:r.id,render:e=>{let{ref:i,...l}=e;return(0,B.jsx)(o(320197).a,{...l,canDrag:!1,collectionStore:t,collectionId:t.id,schema:R,propertySchema:P,targetCollectionStore:s,relatedPageStore:r,disabled:h,isSelected:!0,pageStore:f,property:m,rowType:"inline",onActionButtonClick:()=>{T(d,r)},onMouseLeave:()=>v.unsetFocus(),onSecondaryButtonClick:e=>{M({type:V?"view":"add",index:n+1},e)},onOpenPageButtonClick:()=>{o(463058).O({relationPointers:d,relatedPageStore:r,environment:_,from:"relation_property"})}})},action:()=>{}}}));return c.length>5&&I.push({key:"add",render:e=>(0,B.jsx)(x().Z,{...e,style:E.moreMenuItem,onClick:e=>M({type:"view"},b&&"current"in b?b.current:void 0),children:(0,B.jsx)(w().Z,{style:E.moreMenuItemLabel,count:c.length-5,format:u().lo.Medium,fixedHeight:!1,isCompact:!1})}),action:()=>{M({type:"add",index:d.length},void 0)}}),(0,B.jsx)(S().ZP,{type:S().iW.Vertical,store:v,initialFocus:void 0,disableKeyboard:!0,style:{width:"100%"},sections:[{key:"results",render:e=>(0,B.jsx)(o(388284).Z,{...e,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,children:e.children}),items:I}]})}function I(e){const{relationItemPointers:t,relationPropertySchema:o,store:n,tokenFormat:r,hasUnresolvedDiscussion:i,hasDraftComment:l}=e;return(0,B.jsx)(K,{limit:10,store:n,linkify:"whenReadOnly",relationItemPointers:t,relationPropertySchema:o,tokenFormat:r,hasUnresolvedDiscussion:i,hasDraftComment:l,wrapTokens:!0})}function A(e){const{relationItemPointers:t,relationPropertySchema:o,store:i,tokenFormat:a,hasUnresolvedDiscussion:s,hasDraftComment:c,buttonContainerRef:u,blockPropertyValueOverlayStore:d,property:y,format:m,collectionContextStore:f}=e,h=(0,l().yK)((()=>({relationTokenStyle:{overflow:"hidden",width:"100%"}})),[]),S=(0,r().O7)(),v=(0,n.useCallback)((()=>{var e;p().bA({environment:S,blockPropertyValueOverlayStore:d,store:i,property:y,rect:null===(e=u&&"current"in u?u.current:void 0)||void 0===e?void 0:e.getBoundingClientRect(),format:m,mode:{type:"view",index:0},collectionContextStore:f})}),[d,u,f,S,m,y,i]),{isReadOnly:b}=(0,n.useContext)(C().OU),g=(0,B.jsx)(K,{relationTokenStyle:h.relationTokenStyle,limit:1,store:i,linkify:"never",relationItemPointers:t,relationPropertySchema:o,tokenFormat:a,hasUnresolvedDiscussion:s,hasDraftComment:c,wrapTokens:!1});return b?(0,B.jsx)(x().Z,{...e,ignoreLocalHoverState:!0,onClick:v,children:g}):g}function O(e){let{pageStore:t}=e;const o=(0,n.useRef)(null);return(0,B.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,B.jsx)(b().Z,{blockStore:t,format:u().lo.ExtraSmall}),(0,B.jsx)(g().Z,{blockStore:t,noUnderline:!0,shouldWrap:!1,titleStyle:{fontSize:12},recordTitleRef:o,disableTooltip:!0})]},t.id)}function K(e){let{linkify:t,limit:o,hasUnresolvedDiscussion:r,hasDraftComment:i,relationItemPointers:a,relationPropertySchema:s,tokenFormat:c,store:u,relationTokenStyle:p,wrapTokens:y}=e;const m=(0,l().yK)((e=>({moreToken:{margin:0},commentHighlightWrapperStyle:r||i?{...(0,d().Y)(e),padding:4,flexWrap:"wrap",lineHeight:2,display:"inline-flex"}:{},relationTokenHighlightStyle:r||i?{marginLeft:2,marginRight:2,maxWidth:"fit-content",display:"inline-flex"}:{}})),[i,r]),h=a.length>o,x=a.slice(0,o).map((e=>{let{pointer:o}=e;return(0,B.jsx)("div",{style:p,children:(0,B.jsx)(j().Z,{recordPointer:o,parentStore:u,relationPropertySchema:s,style:m.relationTokenHighlightStyle,linkify:t,noWrap:!y,disableTooltip:h})},o.id)}));h&&x.push((0,B.jsx)(w().Z,{style:m.moreToken,count:a.length-o,format:c,fixedHeight:!1,isCompact:!0},"more"));const S=(0,n.useCallback)((e=>(0,B.jsx)("div",{...e,style:{marginTop:2,marginBottom:2,display:"flex",flexDirection:"column",gap:1,width:"max-content",maxWidth:320},children:a.map((e=>{let{pointer:t,pageStore:o}=e;return(0,B.jsx)(O,{pageStore:o},t.id)}))})),[a]),b=(0,B.jsx)(_().K,{style:m.commentHighlightWrapperStyle,children:x});return h?(0,B.jsx)(v().Z,{renderTooltip:S,delayThreshold:500,placement:f().Placement.Bottom,originGap:8,render:e=>(0,B.jsx)("div",{...e,children:b})}):b}const F=(0,n.forwardRef)((function(e,t){const{shouldWrap:r}=(0,n.useContext)(C().OU),i=J(e,t),l=(0,n.useMemo)((()=>(0,B.jsx)(o(961415).U,{},"comment")),[]);return(0,B.jsx)(V,{...i,EmptyComponent:R().q8,renderAs:"inline",quickActionButtons:l,userExpandable:r})})),U=(0,n.forwardRef)((function(e,t){const o=J(e,t);return(0,B.jsx)(V,{...o,EmptyComponent:R().T$,renderAs:"rows"})})),L=(0,n.forwardRef)((function(e,t){const o=J(e,t);return(0,B.jsx)(V,{...o,EmptyComponent:R().T$,renderAs:"singleWithOverflow"})})),H=(0,n.forwardRef)((function(e,t){const{showIfEmpty:n}=e,r=J(e,t,(0,o(991333).m)(t,e.collectionStore,e.property,"relation"));return(0,B.jsx)(V,{...r,EmptyComponent:n?R().s3:void 0,renderAs:"inline"})})),W=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=J(e,t);return(0,B.jsx)(V,{...n,EmptyComponent:o?R().s3:void 0,renderAs:"inline"})})),D=(0,n.forwardRef)((function(e,t){const o=J(e,t);return(0,B.jsx)(V,{...o,renderAs:"inline"})})),Z=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=J(e,t);return(0,B.jsx)(V,{...n,EmptyComponent:o?R().s3:void 0,renderAs:"inline"})})),q=(0,n.forwardRef)((function(e,t){const o=J(e,t);return(0,B.jsx)(V,{...o,renderAs:"inline"})})),z=(0,n.forwardRef)((function(e,t){const o=J(e,t);return(0,B.jsx)(V,{...o,renderAs:"inline"})})),N=(0,n.forwardRef)((function(e,t){const o=J(e,t);return(0,B.jsx)(V,{...o,renderAs:"inline"})}));function Q(){}const G=(0,n.forwardRef)((function(e,t){const{store:r,collectionStore:l,property:c,blockPropertyValueOverlayStore:u,isInPeekRenderer:d}=J(e,t),{isReadOnly:p,propertyModule:y,propertySchema:m,collectionSchema:f}=(0,n.useContext)(C().OU),x=(0,i().VK)((()=>r.isNonEditableState()),[r]),S=(0,n.useMemo)((()=>new(o(763058).pB)),[]),v=(0,i().VK)((()=>l.getFormat()),[l]),b=(0,i().VK)((()=>null==l?void 0:l.getParentStore()),[l]),g=(0,i().VK)((()=>!(!l||!b||"block"!==b.table)&&(0,o(887430).eD)({collectionStore:l,collectionViewBlockStore:b,checkNavigableAncestorLocked:!1})),[l,b]),k=(0,o(206658).E)(r),w=(0,i().VK)((()=>{var e;return"hide"===(null==k||null===(e=k.getFormat())||void 0===e?void 0:e.property_icons_visibility)}),[k]),P=(0,n.useMemo)((()=>{if("relation"!==(null==m?void 0:m.type))return;const e=m?s().j0(m):void 0;return e?h().NW.createChildStore(r,e):void 0}),[m,r]),j=(0,i().VK)((()=>(null==P?void 0:P.getDatabaseType())===a().p$),[P]);if(!m||!f)return null;const _=(0,B.jsx)(o(663221).Z,{schema:f,format:v,hideDragHandle:!0,property:c,blockStore:r,collectionStore:l,pagePropertiesStore:S,disabled:p,locked:x,canConfigureCollection:g,isInPeekRenderer:d??!1,styleVariants:$,layoutModule:y,hideIcon:w});return(0,B.jsx)(o(384152).Z,{store:r,property:c,ref:t,children:(0,B.jsx)(o(225385).Z,{store:r,collectionStore:l,disabled:p,locked:x,property:c,schema:f,handleMouseMove:Q,handleMouseLeave:Q,handleContextMenu:Q,blockPropertyValueOverlayStore:u,format:v,visibility:j?"inline":e.propertyVisibility??"inline",isInPeekRenderer:Boolean(d),topBorder:!1,showIcon:!1,propertyRowName:_,pagePropertiesStore:S})})})),$={width:{variant:"hug-content"},height:{variant:"small"},fontWeight:"medium",size:"small"},Y=(0,n.forwardRef)((function(e,t){const o=J(e,t);return(0,B.jsx)(V,{...o,EmptyComponent:R().zX,renderAs:"inline"})}));function J(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l,blockPropertyValueOverlayStore:a,format:s,isInPeekRenderer:c,width:u,formQuestionStore:d}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,P().Am)(e),onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle,blockPropertyValueOverlayStore:a,format:s,isInPeekRenderer:c,width:u,formQuestionStore:d}}},709766:(e,t,o)=>{o.d(t,{Bx:()=>a,CQ:()=>l,G5:()=>c,K7:()=>h,Rk:()=>d,Z:()=>f,aJ:()=>u,c3:()=>x,nL:()=>p,qG:()=>m,rf:()=>s,t8:()=>y});var n=o(667294),r=()=>o(114637),i=o(785893);const l=(0,n.forwardRef)((function(e,t){return(0,i.jsx)(r().d3,{...e,ref:t})})),a=(0,n.forwardRef)((function(e,t){return(0,i.jsx)(r().ps,{...e,ref:t})})),s=(0,n.forwardRef)((function(e,t){return(0,i.jsx)(r().zu,{...e,ref:t})})),c=(0,n.forwardRef)((function(e,t){const n=(0,o(991333).m)(t,e.collectionStore,e.property,"multi_select"),l={...e,styles:n};return(0,i.jsx)(r().qk,{...l,ref:t})})),u=(0,n.forwardRef)((function(e,t){return(0,i.jsx)(r().dE,{...e,ref:t})})),d=(0,n.forwardRef)((function(e,t){return(0,i.jsx)(r().vt,{...e,ref:t})})),p=(0,n.forwardRef)((function(e,t){return(0,i.jsx)(r()._1,{...e,ref:t})})),y=(0,n.forwardRef)((function(e,t){return(0,i.jsx)(r().hO,{...e,ref:t})})),m=(0,n.forwardRef)((function(e,t){return(0,i.jsx)(r().aE,{...e,ref:t})})),f=(0,n.forwardRef)((function(e,t){return(0,i.jsx)(r().Yh,{...e,ref:t})})),h=(0,n.forwardRef)((function(e,t){return(0,i.jsx)(r().ZD,{...e,ref:t})})),x=(0,n.forwardRef)((function(e,t){return(0,i.jsx)(o(690982).B,{...e,ref:t})}))},523634:(e,t,o)=>{o.d(t,{n:()=>l});o(267602),o(653476);var n=o(667294),r=()=>o(715139),i=o(785893);const l=n.memo((function(e){var t;const{propertyLabel:l,checked:a,enablePointerEventsForInteractiveTypes:s,onClick:c,disabled:u,tooltip:d,withComma:p,store:y,property:m}=e,{baseStyles:f}=(0,n.useContext)(o(96778).OU),h=(null==f?void 0:f.sizing)??"default",x=(0,o(142735).VK)((()=>{if(y)return(0,o(852465).vV)(y,{includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===m))}),[y,m]),S=x&&null!==(t=x[0])&&void 0!==t&&t.id?(0,o(26970).dk)({discussionId:x[0].id}):void 0,v="small"===h?14:16,b="small"===h?10:12,g=(0,o(846550).yK)((()=>({wrapperStyle:{maxWidth:"100%"},cardCheckboxWrapStyle:{display:"flex",alignItems:"center",lineHeight:`${v}px`,height:"100%"},cardCheckboxNameStyle:{marginLeft:"small"===h?5:6,marginRight:2,...o(707513).Yu}})),[h,v]),C={checked:a,disabled:u,style:{...s&&{pointerEvents:"auto"}},onClick:c,size:v,checkSize:b,tooltipHeader:d,withComma:p};return(0,i.jsx)("div",{className:S,style:g.wrapperStyle,children:l?(0,i.jsxs)("div",{style:g.cardCheckboxWrapStyle,children:[(0,i.jsx)(r().Z,{...C}),(0,i.jsx)("div",{style:g.cardCheckboxNameStyle,children:l})]}):(0,i.jsx)(r().Z,{...C})})}))},75982:(e,t,o)=>{o.d(t,{t5:()=>c,tI:()=>u});o(267602),o(653476);var n=o(667294),r=()=>o(142735),i=()=>o(846550),l=()=>o(955620),a=()=>o(589024),s=o(785893);const c=n.memo((function(e){const{textValue:t,type:c,useShortenedUrl:d,disableLinkify:p,withComma:y,store:m,property:f}=e,h=(0,r().VK)((()=>{if(m)return(0,o(852465).vV)(m,{includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===f))}),[m,f]),x=(0,o(535950).g)({blockId:null==m?void 0:m.id,propertyId:f}),S=h&&(null==h?void 0:h.length)>0||x,v=(0,i().yK)((e=>({linkBoxStyle:{pointerEvents:"all",display:"inline",background:void 0,...(0,a().z0)(e),...S&&(0,o(463212).Y)(e)},hoveredLinkBoxStyle:{background:void 0,...(0,a().z0)(e)},pressedLinkBoxStyle:{background:void 0,...(0,a().z0)(e)}})),[S]),{collectionContextStore:b}=(0,n.useContext)(o(96778).OU),g=(0,r().VK)((()=>null==b?void 0:b.searchQueryStore.state),[null==b?void 0:b.searchQueryStore]),C=(0,r().VK)((()=>{if(!g||!t)return!1;const e=(0,l().Jcv)(t);return null==e?void 0:e.toLowerCase().includes(g.toLowerCase())}),[g,t]),{linkHref:k,shouldShowMaliciousContentDialog:w}=(0,r().VK)((()=>(0,o(505521).k)({textValue:t||(f?null==m?void 0:m.getPropertyValue(f):void 0),type:c,store:m})),[f,m,t,c]);let P;return P=t&&"url"===c&&(d||C)?(0,s.jsx)(u,{textValue:t,searchQuery:g}):(0,l().Jcv)(t),!k||p?(0,s.jsx)(s.Fragment,{children:P}):(0,s.jsxs)(o(729775).Z,{href:k,onClick:e=>{(e.metaKey||e.ctrlKey)&&window.open(k,"_blank")},style:v.linkBoxStyle,hoveredStyle:v.hoveredLinkBoxStyle,pressedStyle:v.pressedLinkBoxStyle,external:!0,discussionStore:null==h?void 0:h[0],preNavigationAction:e=>{w?(0,o(469753).TG)({propertyType:"url",onConfirm:()=>{e()}}):e()},children:[P,y?", ":null]})}));function u(e){let{textValue:t,searchQuery:o}=e;const n=(0,i().yK)((e=>({restOfUrl:{color:e.lightTextColor}})),[]),{domain:r,restOfUrl:c}=(0,a().AF)(t);if(!r)return(0,s.jsx)(s.Fragment,{children:(0,l().Jcv)(t)});const u=function(e,t,o){if(!t)return;let n=t,r=!1;if(t&&o){const i=null==t?void 0:t.toLowerCase().indexOf(o.toLowerCase()),l=`${e}${t}`.toLowerCase().indexOf(o.toLowerCase());if(i>=0){let e="";i>0&&(e=`${t.slice(0,1)}`),i>1&&(e+="");let l="";i+o.length<t.length&&(l=""),n=`${e}${t.slice(i,i+o.length)}${l}`,r=!0}else if(l>=0&&l+o.length>e.length){const i=l+o.length-e.length;n=t.slice(0,i),i<t.length&&(n+=""),r=!0}}!r&&t&&t.length>12&&(n=`${t.slice(0,4)}${t.slice(-6)}`);return n}(r,c,o);return(0,s.jsxs)(s.Fragment,{children:[r,u?(0,s.jsx)("span",{style:n.restOfUrl,children:u}):null]})}},281875:(e,t,o)=>{o.d(t,{z:()=>a});o(267602),o(653476);var n=o(667294),r=()=>o(846550),i=()=>o(803021),l=o(785893);const a=n.memo((function(e){var t;const{dateValue:a,dateFormat:s,timeFormat:c,withComma:u,store:d,property:p}=e,y=(0,r().Fg)(),{baseStyles:m,shouldRenderTooltip:f}=(0,n.useContext)(o(96778).OU),h=(0,o(142735).VK)((()=>{if(d)return(0,o(852465).vV)(d,{includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===p))}),[d,p]),x=(0,o(535950).g)({blockId:null==d?void 0:d.id,propertyId:p}),S=(0,r().yK)((()=>({dateBox:{...m.textStyle,display:"inline",...(((null==h?void 0:h.length)??!1)||x)&&(0,o(463212).Y)(y)}})),[m.textStyle,null==h?void 0:h.length,x,y]);let v;var b;h&&null!==(t=h[0])&&void 0!==t&&t.id&&(v=(0,o(26970).dk)({discussionId:null===(b=h[0])||void 0===b?void 0:b.id}));return(0,l.jsx)(o(308252).Z,{value:a,dateFormat:s??i().sF,timeFormat:c??i().c_,style:S.dateBox,disableTooltip:f||"relative"!==s,withComma:u,displayInUserTimezone:!0,discussionStore:null==h?void 0:h[0],className:v})}))},878826:(e,t,o)=>{o.d(t,{e:()=>i});var n=o(667294),r=o(785893);const i=n.memo((function(e){const{linkValue:t,style:i,store:l,shouldDisableLinks:a,shouldLockImageAspectRatio:s}=e,c=l.pointer,{url:u,name:d}=t,{baseStyles:p}=(0,n.useContext)(o(96778).OU),y=(0,o(219727).O7)(),m=y.device.isRetina,f=(0,n.useRef)(null),h="small"===((null==p?void 0:p.sizing)??"default")?20:24,x=(0,o(846550).yK)((e=>({fileTextStyle:{display:"inline-block",height:h,lineHeight:`${h}px`,borderRadius:4,background:e.legacyDefaultSelectColor,fontSize:(0,o(641506).yv)(y,"UISmall"),padding:"0px 6px",maxWidth:120,minWidth:40,...a?{}:{cursor:"zoom-in"},...o(707513).Yu,...i},fileImageStyle:{maxHeight:h,borderRadius:4,...a?{}:{cursor:"zoom-in"},...s?{maxHeight:h,minHeight:h,maxWidth:h,minWidth:h,objectFit:"cover"}:{},...i}})),[a,y,h,s,i]),S=(0,n.useCallback)(((e,t)=>{if(!t)return null;const n=a?void 0:(0,o(330982).t)({imageRef:f,url:u,blockStore:l,environment:y});return(0,r.jsx)("img",{ref:f,src:t,style:x.fileImageStyle,onClick:n},u)}),[a,y,l,x.fileImageStyle,u]);if((0,o(455530).SR)({url:u}))return(0,r.jsx)(o(135499).Z,{url:u,isAuthenticated:!0,permissionRecord:c,width:m?2*h:h,render:S},u);return(0,r.jsx)("span",{style:x.fileTextStyle,onClick:a?void 0:e=>{e.stopPropagation(),o(64880).Wl(y,{url:u,type:"file",from:"view_original",downloadName:d,permissionRecord:c})},children:(0,r.jsx)(o(469203).s,{children:d})},u)}))},511584:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(667294),r=o(785893);const i=n.memo((function(e){const{recordPointer:t,parentStore:i,relationPropertySchema:a,linkify:s,withComma:c,style:u,noUnderline:d,noWrap:p,disableTooltip:y}=e,{isReadOnly:m,shouldWrap:f,baseStyles:h,containerRef:x}=(0,n.useContext)(o(96778).OU),S=(0,o(603885).jV)(null==h?void 0:h.tokenFormat),v=(0,o(846550).yK)((()=>({relationToken:{margin:0,...u}})),[u]);return(0,r.jsxs)(n.Fragment,{children:[(0,r.jsx)(o(328094).Z,{blockId:t.id,isSingle:!1,parentStore:i,relationPropertySchema:a,shouldWrap:f&&!p,format:S,style:v.relationToken,containingParentRef:x,clickTitleBehavior:l({linkify:s,isReadOnly:m}),noUnderline:d,disableTooltip:y,disableLinks:"never"===s},t.id),c?", ":""]})}));function l(e){let{linkify:t,isReadOnly:n}=e;switch(t){case"always":return"peek";case"never":return;case"whenReadOnly":return n?"peek":void 0;default:(0,o(696459).t1)(t)}}},893636:(e,t,o)=>{o.d(t,{A:()=>f});o(267602),o(653476);var n=o(667294),r=()=>o(142735),i=()=>o(846550),l=()=>o(26970),a=()=>o(996106),s=()=>o(463212),c=()=>o(852465),u=()=>o(535950),d=()=>o(466970),p=()=>o(472344),y=()=>o(96778),m=o(785893);function f(e){var t,o;const{numberValue:f,numberFormatOverride:h,numberPrecisionOverride:x,withComma:S,isRightAligned:v,store:b,property:g}=e,{baseStyles:C,propertySchema:k,shouldRenderTooltip:w,shouldWrap:P}=(0,n.useContext)(y().OU),j=(0,i().Fg)(),_=(0,d().E)("improved_progress_bar"),R=k,B=(0,r().VK)((()=>{if(b)return(0,c().vV)(b,{includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===g))}),[b,g]),M=(0,u().g)({blockId:null==b?void 0:b.id,propertyId:g});let T;B&&null!==(t=B[0])&&void 0!==t&&t.id&&(T=(0,l().dk)({discussionId:B[0].id}));const V=B&&B.length>0,E=(null==C?void 0:C.sizing)??"default",I=(0,i().yK)((()=>{var e,t,o,n,r;const i="bar"===(null==R||null===(e=R.show_as)||void 0===e?void 0:e.type)||"ring"===(null==R||null===(t=R.show_as)||void 0===t?void 0:t.type);return{style:{...!i&&{display:void 0},...i?{flex:"1 0 auto",justifyContent:v?"flex-end":void 0}:{},...!P&&{display:i?"inline-flex":"inline",textWrap:"nowrap"},fontSize:null==C||null===(o=C.textStyle)||void 0===o?void 0:o.fontSize,lineHeight:null==C||null===(n=C.textStyle)||void 0===n?void 0:n.lineHeight,...(V||M)&&(0,s().Y)(j),..."large"===E&&"bar"===(null==R||null===(r=R.show_as)||void 0===r?void 0:r.type)&&{flexDirection:"column",alignItems:void 0},...C.textStyle},barStyle:{..."large"===E&&{flexGrow:1,minWidth:48,maxWidth:"min(100%, 250px)",height:10,marginBottom:4},..."small"===E&&{flexGrow:1,minWidth:48,maxWidth:120},..."default"===E&&{flexGrow:1,minWidth:48,maxWidth:_?48:160}}}}),[null==R||null===(o=R.show_as)||void 0===o?void 0:o.type,v,P,C.textStyle,V,M,j,E,_]),[A,O]=(0,n.useMemo)((()=>[h||"number"===(null==R?void 0:R.type)&&(null==R?void 0:R.number_format)||a().dk,x||"number"===(null==R?void 0:R.type)&&(null==R?void 0:R.number_precision)||a().N3]),[h,x,R]);return(0,m.jsx)(p().b,{style:I.style,barStyle:I.barStyle,progressSize:C.textLineHeight,numberValue:f,barHeight:"large"===E?8:4,ringWidth:"large"===E?5:3,numberFormat:A,numberPrecision:O,numberShowAs:null==R?void 0:R.show_as,shouldRenderTooltip:!w,withComma:S,className:T})}},923768:(e,t,o)=>{o.d(t,{H:()=>l});var n=o(667294),r=()=>o(38883),i=o(785893);const l=n.memo((function(e){var t;const{actorPointer:l,style:a,shouldShrink:s,withComma:c}=e,{store:u,baseStyles:d,shouldRenderTooltip:p,propertySchema:y}=(0,n.useContext)(o(96778).OU),m=(0,o(603885).jV)(null==d?void 0:d.tokenFormat),f=(0,o(846550).yK)((()=>({actorStyle:{margin:0,...a,...(null==d?void 0:d.tokenFormat)===r().lo.Inline&&{pointerEvents:"auto"},display:"inline-block"}})),[null==d?void 0:d.tokenFormat,a]),h=(0,o(142735).VK)((()=>{const e=null==u?void 0:u.getRecordModel;if(e)return(0,o(816512).Hl)({pointer:l,getRecordModel:e})}),[l,null==u?void 0:u.getRecordModel]);return void 0===h?null:(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)(o(864832).ZP,{actor:h,showRemoveButton:!1,format:m,isSingle:!1,shouldShrink:s,style:f.actorStyle,hasTooltip:!p||m===r().lo.Inline,tooltipHeader:null==y?void 0:y.name},null===(t=h.asActor)||void 0===t?void 0:t.id),c?", ":""]})}))},517084:(e,t,o)=>{o.d(t,{E1:()=>E,eL:()=>T,gZ:()=>V,vQ:()=>I});o(267602),o(653476);var n=o(667294),r=()=>o(142735),i=()=>o(846550),l=()=>o(756191),a=()=>o(922622),s=()=>o(996106),c=()=>o(463212),u=()=>o(788860),d=()=>o(696459),p=()=>o(707513),y=()=>o(852465),m=()=>o(535950),f=()=>o(998901),h=()=>o(654133),x=()=>o(96778),S=()=>o(603885),v=()=>o(523634),b=()=>o(75982),g=()=>o(281875),C=()=>o(878826),k=()=>o(511584),w=()=>o(893636),P=()=>o(923768),j=()=>o(533845),_=()=>o(10066),R=()=>o(9656),B=()=>o(616978),M=o(785893);const T={id:"empty",type:"empty",value:[["Empty"]]};function V(e){const{token:t,targetPropertySchema:o,blockStore:n,checkboxPropertyLabel:r,withComma:c,numberRightAlign:y,disableLinks:m,shouldTruncate:x}=e,S=(0,i().Fg)(),_=(0,u().YB)(),{type:B,value:T}=t;switch(B){case"url":case"email":case"phone_number":return(0,M.jsx)(b().t5,{textValue:T,type:B,useShortenedUrl:!1,withComma:c,disableLinkify:m});case"checkbox":return(0,M.jsx)(v().n,{checked:T,propertyLabel:r,disabled:!0,withComma:c});case"number":return(0,M.jsx)(w().A,{numberValue:T,numberFormatOverride:o&&"number_format"in o?null==o?void 0:o.number_format:s().dk,numberPrecisionOverride:o&&"number_precision"in o?null==o?void 0:o.number_precision:void 0,withComma:c,isRightAligned:y});case"date":return(0,M.jsx)(g().z,{dateValue:T,dateFormat:o&&"date_format"in o?o.date_format:void 0,timeFormat:o&&"time_format"in o?o.time_format:void 0,withComma:c});case"file":return(0,M.jsx)(C().e,{linkValue:T,store:n,shouldDisableLinks:m});case"person":return(0,M.jsx)(P().H,{actorPointer:T,shouldShrink:x,withComma:c});case"relation":return(0,M.jsx)(k().Z,{recordPointer:T,parentStore:n,relationPropertySchema:void 0,linkify:m?"never":"always",withComma:c,noWrap:x,style:{...x&&{maxWidth:"100%",...p().Yu}}});case"select":return(0,M.jsx)(j().J,{type:t.groupColor?"status":"select",value:T,groupColor:t.groupColor,color:t.color,shouldShrink:x});case"text":return(0,M.jsx)(R().A,{textValue:T,parentStore:n,withComma:c,linkifyUrls:!m,disableCommentHighlight:!0,shouldTruncate:x});case"error":return(0,M.jsx)(h().Z,{render:e=>(0,M.jsxs)("div",{style:{display:"inline-flex",cursor:"help",color:S.text.redPrimary,alignItems:"center",gap:3},...e,children:[(0,a().l)({width:16,height:16,color:S.icon.uiRedPrimary}),(0,M.jsx)(u()._H,{id:"propertyValueToken.error",defaultMessage:"Error"})]}),renderTooltip:()=>(0,M.jsx)(u()._H,{...(0,l().OY)(_,T)}),placement:f().Placement.Top,alignment:f().Alignment.Center});case"empty":return(0,M.jsx)(h().Z,{render:e=>(0,M.jsx)("div",{style:{opacity:.8,cursor:"help"},...e,children:(0,M.jsx)(R().A,{textValue:T,parentStore:n,withComma:c,linkifyUrls:!0})}),renderTooltip:()=>(0,M.jsx)(u()._H,{id:"propertyValueToken.emptyValueTooltip",defaultMessage:"Empty values aren't displayed but affect formula calculations."}),placement:f().Placement.Top,alignment:f().Alignment.Center});default:return(0,d().t1)(B)}}function E(e){let{children:t,propertyType:o,rootPropertySchema:l,numberRightAlign:a,store:s,property_id:u}=e;const{shouldWrap:d}=(0,n.useContext)(x().OU),p="number"===o&&a,f=(0,m().g)({blockId:null==s?void 0:s.id,propertyId:u}),h=(0,r().VK)((()=>{if(s)return(0,y().vV)(s,{includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===u))}),[s,u]),S=(0,i().yK)((e=>({commentHighlightWrapperStyle:(null==h?void 0:h.length)||f?{...(0,c().Y)(e),paddingTop:8,height:"fit-content",paddingLeft:5,display:"inline-flex"}:{}})),[f,null==h?void 0:h.length]);return I(o,l)?(0,M.jsx)(_().Y,{style:{...S.commentHighlightWrapperStyle,...d&&{display:"flex",flexWrap:"wrap"}},isRightAligned:p,children:t}):(0,M.jsx)(B().K,{isRightAligned:p,style:S.commentHighlightWrapperStyle,children:t})}function I(e,t){var o,n;return void 0!==e&&"title"!==e&&(!!(0,S().A2)(e)&&("number"!==e||"bar"!==(null==t||null===(o=t.show_as)||void 0===o?void 0:o.type)&&"ring"!==(null==t||null===(n=t.show_as)||void 0===n?void 0:n.type)))}},692102:(e,t,o)=>{o.d(t,{Z:()=>c});var n=o(667294),r=()=>o(788860),i=()=>o(527278),l=o(785893);const a=(0,r().vU)({openAsPageTitle:{defaultMessage:"Open",id:"database.navigateButton.openAsPageTitle"},openPageSidePeekAriaLabel:{defaultMessage:"Open in side peek",id:"database.relationMenuRow.button.openPageSidePeek.ariaLabel"},openPageCenterPeekAriaLabel:{defaultMessage:"Open in center peek",id:"database.relationMenuRow.button.openPageCenterPeek.ariaLabel"},openPageFullPageAriaLabel:{defaultMessage:"Open as page",id:"database.relationMenuRow.button.openPageFullPage.ariaLabel"}});function s(e){const{hideLabel:t,style:n,peekMode:s,onOpenPageButtonClick:c}=e;let u,d,p;return"side_peek"===s?(u=a.openPageSidePeekAriaLabel,d=o(695296).y,p=(0,l.jsx)(r()._H,{id:"database.relationMenuRow.tooltip.openPageSidePeek.message",defaultMessage:"Open in side peek"})):"center_peek"===s?(u=a.openPageCenterPeekAriaLabel,d=o(483269).Q,p=(0,l.jsx)(r()._H,{id:"database.relationMenuRow.tooltip.openPageCenterPeek.message",defaultMessage:"Open in center peek"})):"full_page"===s?(u=a.openPageFullPageAriaLabel,d=o(330404).Z,p=(0,l.jsx)(r()._H,{id:"database.relationMenuRow.tooltip.openPage.message",defaultMessage:"Open as page"})):(0,o(696459).t1)(s),(0,l.jsx)(o(290950).Z,{caption:t?void 0:i().Z.formatMessage(a.openAsPageTitle),ariaLabel:i().Z.formatMessage(u),onClick:c,style:{width:60,...n},icon:d,tooltipMessage:p})}const c=n.memo(s)},533845:(e,t,o)=>{o.d(t,{J:()=>l});var n=o(667294),r=()=>o(846550),i=o(785893);const l=n.memo((function(e){const{value:t,description:l,color:a,shouldShrink:s,type:c,style:u,shouldShowTooltip:d}=e,p="status"===c?e.groupColor??"default":void 0,y=(0,r().Fg)(),{baseStyles:m}=(0,n.useContext)(o(96778).OU),f=(0,o(603885).jV)(null==m?void 0:m.tokenFormat),h=(0,r().yK)((()=>({token:{margin:0,...o(707513).Yu,...u}})),[u]);if(!t)return null;const{textColor:x,backgroundColor:S}=(0,o(568017).KR)(y,a??p);let v;return"status"===c&&(v=a||(p||"gray")),(0,i.jsx)(o(78014).Z,{format:f,value:(0,i.jsx)(o(827618).Z,{children:t}),description:l,color:x,backgroundColor:S,showRemoveButton:!1,shouldShrink:s,isRound:"status"===c,isSingle:!1,showColoredDot:v,showTooltip:d?"always":"never",tooltipPlacement:o(998901).Placement.Top,style:h.token})}))},682518:(e,t,o)=>{o.d(t,{P:()=>h,w:()=>x});o(667294);var n=()=>o(846550),r=()=>o(38883),i=()=>o(135796),l=()=>o(730388),a=()=>o(549302),s=()=>o(955620),c=()=>o(788860),u=()=>o(696459),d=()=>o(793041),p=()=>o(10066),y=o(785893);const m="20px",f=(0,c().vU)({me:{id:"templateVariablePropertyValueComponent.templateVariables.text.me",defaultMessage:"Person who duplicated page"},now:a().o.nowText,today:a().o.todayText});function h(e){const t=(0,n().yK)((e=>({textWrapper:{lineHeight:m}})),[]);return(0,y.jsx)(p().Y,{fontColor:"light",style:t.textWrapper,children:(0,y.jsx)(x,{templateVariableType:e.templateVariableType})})}function x(e){const{templateVariableType:t,showRemoveButton:o,onRemove:a,style:p}=e,m=(0,c().YB)(),f=(0,n().yK)((e=>({uiToken:{background:e.outlineBlueButtonPressedBackground,color:e.blueColor,padding:"2px 4px",width:"max-content",...p||{}}})),[p]);return(0,y.jsx)(d().ZP,{format:r().lo.Medium,isSingle:!0,title:S(t,m),renderAvatar:()=>function(e){let t;(0,s().pJX)(e)?t=l().f:(0,s().tXA)(e)?t=i().C:(0,u().t1)(e);return t}(t)({width:12,height:12,marginRight:4}),shouldShrink:!0,onClickRemove:a,showRemoveButton:Boolean(o),style:f.uiToken})}function S(e,t){let o;return"me"===e?o=t.formatMessage(f.me):"now"===e?o=t.formatMessage(f.now):"today"===e?o=t.formatMessage(f.today):(0,u().t1)(e),o}},9656:(e,t,o)=>{o.d(t,{A:()=>d});var n=o(667294),r=()=>o(142735),i=()=>o(846550),l=()=>o(955620),a=()=>o(958783),s=()=>o(641702),c=()=>o(158429),u=o(785893);const d=n.memo((function(e){const{parentStore:t,withComma:d,linkifyUrls:p,disableCommentHighlight:y,disableLinks:m,shouldTruncate:f,clampLines:h,textValue:x}=e,S=(0,o(219727).O7)(),v=(0,i().Fg)(),b=(0,o(718611).kw)();(0,n.useEffect)((()=>{void 0!==x&&S.KatexStore.loadIfNeeded((()=>x))}),[S.KatexStore,x]);const{collectionContextStore:g,property:C}=(0,n.useContext)(o(96778).OU),{collectionViewBlockId:k,collectionViewId:w}=(0,r().VK)((()=>{var e,t;return{collectionViewId:null==g||null===(e=g.collectionViewStore())||void 0===e?void 0:e.id,collectionViewBlockId:null==g||null===(t=g.collectionViewBlockStore())||void 0===t?void 0:t.id}}),[g]),P=(0,r().VK)((()=>S.KatexStore.getKatex()),[S.KatexStore]),j=(0,r().VK)((()=>{const e=c().l.state,o=c().V.state;return e&&C&&x?s().cD({textValue:x,blockId:t.id,textProps:{type:"page_property_value_match",collectionViewBlockId:k,collectionViewId:w,propertyId:C},find:e,currentFocusedResult:o}):x}),[C,x,t.id,k,w]),_=(0,r().VK)((()=>{if(a().default.getPropertyId()!==C||a().default.getBlockStore()!==t)return j;const e=a().default.getMultiSelection();return e?l().WO0({textValue:j,selection:{startIndex:e.start.index,endIndex:e.end.index},annotation:[l().GKr.TemporaryComment]}):x?l().WO0({textValue:j,selection:{startIndex:0,endIndex:l().eeV(x).length},annotation:[l().GKr.TemporaryComment]}):j}),[t,C,x,j]),R=(0,r().VK)((()=>void 0===_?null:s().IY({environment:S,textValue:_&&{value:_,spaceId:(0,o(81954).J)(t.pointer.spaceId)},parentStore:t,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableCommentAnnotations:y??!1,disabled:!0,theme:v,disableLinks:m??!1,emojiType:b,katex:P,formulaValueTypes:[],stopLinkPropagation:!0,linkTargetBlank:!0})),[_,S,t,y,v,m,b,P]),B=(0,n.useMemo)((()=>{if(!p||void 0===x)return null;const e=(0,l().Jcv)(x);return(0,o(326177).Z)(e)?(0,o(532850).zB)(x):null}),[p,x]),M=(0,i().yK)((e=>({text:{...f&&!h?o(707513).Yu:void 0,...f&&h?{...(0,o(641506).pd)(h),overflow:"hidden",textOverflow:"ellipsis"}:{}}})),[f,h]);return(0,u.jsxs)("span",{style:M.text,children:[B?(0,u.jsx)(o(108714).Z,{href:B,style:{display:"inline",pointerEvents:"auto",...(0,o(589024).z0)(v)},external:!0,onClick:e=>e.stopPropagation(),children:R}):R,d?", ":null]})}))},10066:(e,t,o)=>{o.d(t,{Y:()=>i});var n=o(667294),r=o(785893);const i=n.forwardRef((function(e,t){let{children:i,fontColor:l,style:a,isRightAligned:s,isEmpty:c}=e;const{baseStyles:u}=(0,n.useContext)(o(96778).OU),d=(0,o(846550).yK)((e=>({textStyle:{...c?u.emptyTextStyle??u.textStyle:u.textStyle,...a,...s?{justifyContent:"right",textAlign:"right"}:{},..."light"===l?{color:e.lightTextColor}:{}}})),[c,u.emptyTextStyle,u.textStyle,a,s,l]);return(0,r.jsx)("div",{ref:t,style:d.textStyle,children:i})}))},616978:(e,t,o)=>{o.d(t,{K:()=>i});var n=o(667294),r=o(785893);const i=n.forwardRef((function(e,t){let{children:i,style:l,isRightAligned:a,className:s}=e;const{baseStyles:c}=(0,n.useContext)(o(96778).OU),u=(0,o(846550).yK)((()=>({tokenWrapStyle:{...c.tokenWrapStyle,...a?{justifyContent:"end"}:void 0,...l}})),[c.tokenWrapStyle,l,a]);return(0,r.jsx)("div",{ref:t,style:u.tokenWrapStyle,className:s,children:i})}))},425803:(e,t,o)=>{o.d(t,{e:()=>C});o(267602),o(228244);var n=o(667294),r=()=>o(219727),i=()=>o(142735),l=()=>o(846550),a=()=>o(949842),s=()=>o(466970),c=o(785893);function u(){const e=(0,l().yK)((e=>({outer:{display:"inline-flex",overflow:"hidden",position:"relative",width:"100%"},inner:{width:"60%",height:10,borderRadius:12,backgroundColor:e.lightDividerColor}})),[]);return(0,c.jsx)("div",{style:e.outer,children:(0,c.jsx)(o(668001).Z,{style:e.inner})})}var d=()=>o(788860);const p=(0,d().vU)({expand_property:{defaultMessage:"Expand",id:"database.ExpandButton"}});function y(e){let{store:t,property:r,showHoverColor:a}=e;const s=(0,d().YB)(),u=(0,o(125659).DK)(),y=null==u?void 0:u.virtualizedModule.getBlockHeightsCache(),m=(0,i().VK)((()=>null==y?void 0:y.propertyCanExpandStore(t.id,r).state),[y,r,t]),f=(0,n.useCallback)((()=>{null==y||y.expandHeightToTallestCached(t.id)}),[y,t.id]),h=(0,l().yK)((e=>({icon:{color:a?e.icon.secondary:e.icon.tertiary,fill:a?e.icon.secondary:e.icon.tertiary,height:16,width:16},iconButton:{height:20,width:20}})),[a]);return u&&m?(0,c.jsx)(o(108244).Z,{onClick:f,icon:o(176796).x,tooltip:s.formatMessage(p.expand_property),iconStyle:h.icon,style:h.iconButton}):null}var m=()=>o(677559);const f=new(m().Ss)("BlockPropertyButtonExternalPropertyTooltip",(()=>Promise.all([o.e(44832),o.e(31078)]).then(o.bind(o,531864)))),h=(0,m().kF)(f,(e=>e.BlockPropertyButtonExternalPropertyTooltip));var x=()=>o(998901),S=()=>o(356321),v=()=>o(96778);function b(e){const{propertyValue:t,propertyCaption:r,render:i}=e,{propertySchema:a,format:s,shouldRenderTooltip:u,isExternallyImportedAndSyncedPage:d,collectionContextStore:p}=(0,n.useContext)(v().OU),y=null==a?void 0:a.name,m=!u,f=s===S().C.Board||s===S().C.GalleryView,b=(null==y?void 0:y.length)&&!m,g=void 0!==t,C=void 0!==r,k=b||g||C,w=(0,l().yK)((e=>({value:{color:b?e.mediumInvertedTextColor:void 0},caption:{color:b||g?e.mediumInvertedTextColor:void 0}})),[b,g]),P=(0,n.useCallback)((()=>{const e=(0,c.jsxs)(c.Fragment,{children:[b&&(0,c.jsx)("div",{children:y}),g&&(0,c.jsx)("div",{style:w.value,children:t}),C&&(0,c.jsx)("span",{style:w.caption,children:r})]});return d&&s===S().C.Page?(0,c.jsx)(h,{collectionContextStore:p,propertySchema:a,baseTooltip:e}):e}),[C,b,g,r,y,t,w,d,s,p,a]);return k?(0,c.jsx)(o(654133).Z,{renderTooltip:P,render:e=>i(e),placement:f?x().Placement.Left:x().Placement.Bottom}):i()}function g(e){let{children:t,blockPropertyValueOverlayStore:r}=e;const i=(0,n.useRef)(null),{collectionContextStore:l,store:a,property:s}=(0,n.useContext)(v().OU),{columnVirtualizer:u}=(0,o(928459).MB)(),d=null==l?void 0:l.virtualizedModule.getBlockHeightsCache(),p=(0,n.useRef)(!1),y=(0,n.useCallback)((e=>{d&&a&&!e.state.isOpen&&(d.expandHeightToTallestCached(a.id),e.removeListener(y),p.current=!1)}),[d,a]),m=(0,n.useCallback)((e=>{if(!(d&&a&&s&&e))return;const t=d.getPropertyHeightStore(a.id,s).state,n=0===e.height?0:e.height+o(603885).o9;d.cachePropertyHeight(a.id,s,n),t!==n&&!1===(null==u?void 0:u.isScrolling)&&(null!=r&&r.state.isOpen&&!p.current?(r.addListener(y),p.current=!0):d.expandHeightToTallestCached(a.id))}),[d,u,s,a,r,y]);return(0,o(965865).c7)(i,m),(0,c.jsx)("div",{ref:i,children:t})}const C=n.memo((0,n.forwardRef)((function(e,t){const{tooltipPropertyValue:o,tooltipPropertyCaption:n,tooltipHide:r}=e,i=o=>(0,c.jsx)(k,{ref:t,...e,tooltipEvents:o});return r?i():(0,c.jsx)(b,{propertyValue:o,propertyCaption:n,render:i})}))),k=(0,n.forwardRef)((function(e,t){var d;const{style:p,quickActionButtons:m,quickActionButtonsAlign:f,quickActionButtonsForceVisible:h,editButtonClickProps:x,width:S,forceEnableButton:b,collectionSchema:C,onContextMenu:k,formQuestionStore:w,userExpandable:P}=e,j=(0,r().O7)(),{isAndroid:_,isMobile:R,isPhone:B}=(0,r().Fy)(),[M,T]=(0,n.useState)(!1),[V,E]=(0,n.useState)(!1),{collectionContextStore:I,format:A,isReadOnly:O,store:K,property:F,baseStyles:U,propertySchema:L}=(0,n.useContext)(v().OU),H=(0,i().VK)((()=>!(null==I||!I.viewsModuleContextStore.state)&&I.viewsModuleContextStore.isInLayoutBuilder()),[I]),W="text"===(null==L?void 0:L.type)&&!(null!=L&&L.ai_inference),D=(0,i().VK)((()=>!!K&&(0,o(852465).vV)(K,{includePropertyDiscussions:!0}).some((e=>e.getPropertyId()===F))),[F,K]),{isLoading:Z,isExternalUpdateInProgress:q}=(0,i().VK)((()=>{var e,t;const n=null==I?void 0:I.collectionStore(),r=!(!(null==n?void 0:n.isSyncedCollection())||null!=K&&null!==(e=K.getFormat())&&void 0!==e&&null!==(e=e.attributes)&&void 0!==e&&e.length||null!=K&&null!==(t=K.getFormat())&&void 0!==t&&t.error);if(null==n||!n.isExternallyImportedAndSyncedCollection()||null==K||!K.id||!F)return{isLoading:r,isExternalUpdateInProgress:!1};const i=o(636228).Z.getState().syncingProperties;return{isLoading:r,isExternalUpdateInProgress:Boolean(n.isExternallyImportedAndSyncedCollection()&&i.has((0,o(338855).b8)({pageId:K.id,propertyId:F})))}}),[I,K,F]),z=(0,l().yK)((()=>({buttonStyle:{position:"relative",...p,display:q?"flex":null==p?void 0:p.display},expandButtonPosition:{position:"relative",left:"left"===f?-2:2,float:"left"===f?"left":"right"}})),[p,q,f]),N=(0,n.useCallback)((()=>{E(!0)}),[]),Q=(0,n.useCallback)((()=>{E(!1)}),[]),G=(0,n.useCallback)((()=>{T(!0)}),[]),$=(0,n.useCallback)((()=>{T(!1)}),[]),Y=(0,n.useCallback)((e=>{_&&B?e.preventDefault():k&&(0,a().ZP)({event:e,context:a().Af.EditorContextMenu,callback:()=>{k(e)}})}),[_,B,k]),J=(0,s().E)("collections_column_virtualization"),X=P&&J,ee=(0,n.useCallback)((async e=>{if(void 0===x)return;const{onClick:t,store:n,property:r,format:i,collectionStore:l,blockPropertyValueOverlayStore:a,disableHorizontalEdgeScroll:s,isStatusCheckbox:c,focusButtonAfterClose:u}=x;await o(820185).z({element:te.current??void 0,environment:j,onClick:t,store:n,property:r,format:i,collectionStore:l,blockPropertyValueOverlayStore:a,disableHorizontalEdgeScroll:s,collectionContextStore:I,collectionSchema:C,setMouseEntered:T,statusSetCheckbox:c?!e.altKey:void 0,sizing:"large"===(null==U?void 0:U.sizing)?"large":"default",formQuestionStore:w,onClose:()=>{var e;u&&(null===(e=te.current)||void 0===e||e.focus())}})}),[x,j,I,C,null==U?void 0:U.sizing,w]),te=(0,n.useRef)(null),oe=(0,n.useCallback)((e=>{te.current=e,"function"==typeof t?t(e):t&&(t.current=e)}),[t]),ne=(0,o(702466).p)({collectionContextStore:I,blockId:null==K?void 0:K.id,property:F,featureEnabled:X}),re=(0,s().E)("collections_accessible_quick_action_buttons"),ie=Boolean(null===(d=(0,o(566937).Dq)())||void 0===d?void 0:d.isPreviewing),le=ie||H,ae=(0,n.useMemo)((()=>{if(le||!m||Array.isArray(m)&&0===m.length)return null;const t=void 0!==h?h||V:(!S||S>80)&&(M||V||R);if(!t&&!re)return ne&&K&&F?(0,c.jsx)("div",{style:z.expandButtonPosition,children:(0,c.jsx)(y,{store:K,property:F})}):null;const n=ne?(0,c.jsxs)(c.Fragment,{children:["left"===f&&K&&F&&(0,c.jsx)(y,{store:K,property:F,showHoverColor:!0}),m,(!f||"right"===f)&&K&&F&&(0,c.jsx)(y,{store:K,property:F,showHoverColor:!0})]}):m;return(0,c.jsxs)(c.Fragment,{children:[!R&&ne&&K&&F&&(0,c.jsx)("div",{style:z.expandButtonPosition,children:(0,c.jsx)(y,{store:K,property:F})}),(0,c.jsx)(o(448593).t,{align:f,style:e.quickActionButtonsStyle,format:A,containerRef:te,visuallyHidden:!t,children:n})]})}),[le,m,S,h,M,V,R,ne,K,F,f,e.quickActionButtonsStyle,A,re,z.expandButtonPosition]);if(Z)return(0,c.jsx)("div",{style:z.buttonStyle,children:(0,c.jsx)(u,{})});const se=(0,o(164079).Z)({onMouseMove:G,onMouseLeave:$},e.tooltipEvents);return!ie&&(b||!O&&void 0!==x||W&&D)&&!H?(0,c.jsxs)(o(154186).Z,{className:e.className,ref:oe,hoveredStyle:e.hoveredStyle,pressedStyle:e.pressedStyle,style:z.buttonStyle,onContextMenu:Y,onClick:ee,onFocus:N,onBlur:Q,testId:"property-value",...se,children:[ae,X?(0,c.jsx)(g,{blockPropertyValueOverlayStore:null==x?void 0:x.blockPropertyValueOverlayStore,children:e.children}):e.children,q?(0,c.jsx)(o(312578).Z,{style:{alignSelf:"center",marginRight:8,marginLeft:8}}):null]}):(0,c.jsxs)("div",{className:e.className,ref:oe,style:z.buttonStyle,onFocus:N,onBlur:Q,...se,children:[ae,X?(0,c.jsx)(g,{children:e.children}):e.children]})}))},531864:(e,t,o)=>{o.r(t),o.d(t,{BlockPropertyButtonExternalPropertyTooltip:()=>y});o(667294);var n=()=>o(142735),r=()=>o(846550),i=()=>o(919758),l=()=>o(788860),a=()=>o(148976),s=()=>o(338855),c=()=>o(876822),u=o(785893);const d=(0,l().vU)({upgrade_to_enterprise:{defaultMessage:"Upgrade to Enterprise to edit this property",id:"BlockPropertyButtonExternalPropertyTooltip.upgradeToEnterprise"},two_way_sync_not_enabled:{defaultMessage:"2-way sync required to edit",id:"BlockPropertyButtonExternalPropertyTooltip.twoWaySyncRequired"},property_not_editable:{defaultMessage:"This property is not editable",id:"BlockPropertyButtonExternalPropertyTooltip.propertyNotEditable"},connect_to_integration:{defaultMessage:"Connection to {integration} required to edit",id:"BlockPropertyButtonExternalPropertyTooltip.connectToIntegration"},full_access:{defaultMessage:"You have full access to this property",id:"BlockPropertyButtonExternalPropertyTooltip.fullAccess"}}),p=(0,l().vU)({clickToGetStarted:{defaultMessage:"Click to get started",id:"BlockPropertyButtonExternalPropertyTooltip.clickToGetStarted"},dataCannotBeEdited:{defaultMessage:"Data synced from {integration} cannot be edited",id:"BlockPropertyButtonExternalPropertyTooltip.dataCannotBeEdited"}});function y(e){let{collectionContextStore:t,propertySchema:o,baseTooltip:y}=e;const m=(0,n().VK)((()=>{var e;return"enterprise"===(null===(e=c().default.getState().currentSpaceStore)||void 0===e?void 0:e.getSubscriptionTier())}),[]),f=(0,r().yK)((e=>({action:{color:e.text.contrastSecondary}})),[]),h=(0,n().VK)((()=>{var e,n,r;const l=null==t||null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat().external_collection_type;if(!(0,s().MW)(l)||!(0,a().Uo)())return{twoWaySyncUserState:void 0,integration:l};if(!m)return{twoWaySyncUserState:(0,i().Ll)({isUserOnEnterprisePlan:m}),integration:l};const c=Boolean(null==t||null===(n=t.collectionStore())||void 0===n||null===(n=n.getFormat())||void 0===n||null===(n=n.sync_state)||void 0===n?void 0:n.enable_two_way_sync);if(!c)return{twoWaySyncUserState:(0,i().Ll)({isUserOnEnterprisePlan:m,twoWaySyncEnabled:c}),integration:l};const u=Boolean(null==t||null===(r=t.externalSyncStore)||void 0===r||null===(r=r.state)||void 0===r?void 0:r.shouldAllowUserToEditSyncedCollection()),d="read_write"===(null==o?void 0:o.synced_permissions);return{twoWaySyncUserState:(0,i().Ll)({isUserOnEnterprisePlan:m,twoWaySyncEnabled:c,canEdit:u,isEditableProperty:d}),integration:l}}),[m,t,o]);if(h.twoWaySyncUserState){if("full_access"===h.twoWaySyncUserState)return y;if("connect_to_integration"===h.twoWaySyncUserState||"two_way_sync_not_enabled"===h.twoWaySyncUserState){const e={...d[h.twoWaySyncUserState],values:{integration:h.integration??"integration"}};return(0,u.jsxs)("div",{children:[(0,u.jsx)(l()._H,{...e}),(0,u.jsx)("div",{style:f.action,children:(0,u.jsx)(l()._H,{...p.clickToGetStarted})})]})}return(0,u.jsx)(l()._H,{...d[h.twoWaySyncUserState]})}{const e={...p.dataCannotBeEdited,values:{integration:h.integration??"integration"}};return(0,u.jsx)(l()._H,{...e})}}},662835:(e,t,o)=>{o.d(t,{L:()=>l});o(667294);var n=()=>o(846550),r=()=>o(668001),i=o(785893);function l(e){const t=(0,n().yK)((t=>({shimmer:{width:"60%",marginTop:6,height:10,flexShrink:0,borderRadius:12,backgroundColor:t.lightDividerColor,...e.style}})),[e.style]);return(0,i.jsx)(r().Z,{style:t.shimmer})}},96778:(e,t,o)=>{o.d(t,{OU:()=>h,Zj:()=>x,yT:()=>S});var n=o(667294),r=()=>o(219727),i=()=>o(142735),l=()=>o(532850),a=()=>o(998411),s=()=>o(141735),c=()=>o(615676),u=()=>o(527278),d=()=>o(677559),p=()=>o(749826),y=()=>o(356321),m=()=>o(201608),f=o(785893);const h=(0,n.createContext)({collectionContextStore:void 0,propertySchema:void 0,property:void 0,propertyFormat:void 0,isEmpty:!1,isReadOnly:!0,canComment:!1,shouldRenderTooltip:!1,shouldWrap:!1,baseStyles:{},format:0,containerRef:null,store:void 0,shouldShowMultiSelectCheckbox:void 0,propertyIndex:void 0,collectionSchema:void 0});h.displayName="BlockPropertyValueContext";const x=n.memo((function(e){const{children:t,unmappedProperty:r,property:a,propertySchema:s,containerRef:c}=e,{format:u,disabled:d,store:p,tableWrap:x,collectionStore:b,shouldSetCellHeight:g,isLast:C,locked:k,showIfEmpty:w,shouldShowMultiSelectCheckbox:P,propertyIndex:j,propertyModule:_,formQuestionStore:R,formDataStore:B,onClose:M}=e.innerProps,T=(0,o(125659).DK)(),V=(0,i().VK)((()=>{var e;const t=null==B||null===(e=B.getFormState())||void 0===e?void 0:e.collectionSchema;return t||b.getSchema()}),[b,B]),E=(0,o(309797).L2)(p),I=S(p,V,a,s),A=function(e){const{store:t,collectionStore:n,property:r,disabled:a,format:s,propertySchema:c,collectionContextStore:u}=e,d=(0,o(466970).E)("jira_2_way_sync");return(0,i().VK)((()=>s===y().C.Calendar||s===y().C.Timeline||(0,o(15607).w)(r)||(0,o(226413).Sm)(c)||(0,m().M$)({collectionStore:n,property:r,propertySchema:c})||null!=u&&u.isUnlistedViewStore.state?{canEdit:!1,canComment:!1}:a||!t.canEdit()||t.isNonEditableState()?{canEdit:!1,canComment:t.canComment()&&!t.isNavigableAncestorNonCommentableState()}:(0,m().z0)({store:t,collectionStore:n,collectionContextStore:u,propertySchema:c,property:r,isJiraTwoWaySyncEnabled:d})||(0,l().f0)(t.getModel(),r,t.getRecordModel)&&!n.isExternallyImportedAndSyncedCollection()?{canEdit:!1,canComment:!1}:{canEdit:!0,canComment:!0}),[a,t,u,r,c,n,s,d],{debugName:"BlockPropertyValueContext.useWriteState"})}({store:p,collectionStore:b,property:a,disabled:d,format:u,propertySchema:s,collectionContextStore:T}),O=(0,i().VK)((()=>null==T?void 0:T.getPropertyFormat(r??a)),[T,a,r]),K=(0,i().VK)((()=>!(!B||!R)&&Boolean(B.getQuestionError(R.id))),[B,R]),F=function(e,t){return e===y().C.Page||e===y().C.Table&&t||e===y().C.Board&&t||e===y().C.GalleryView&&t||e===y().C.FormViewer}(u,x),U=(0,o(603885).uo)({shouldSetCellHeight:g,format:u,shouldWrap:F,isLast:C,locked:k,disabled:d,showIfEmpty:w,isInvalidFormAnswer:K,propertyModule:_}),L=(0,n.useMemo)((()=>({store:p,collectionContextStore:T,property:a,propertySchema:s,propertyFormat:O,isEmpty:I,isReadOnly:!A.canEdit,canComment:A.canComment,shouldRenderTooltip:v(u,E,I),shouldWrap:F,baseStyles:U,format:u,containerRef:c,shouldShowMultiSelectCheckbox:P,propertyIndex:j,isExternallyImportedAndSyncedPage:E,propertyModule:_,onClose:M,collectionSchema:V})),[p,T,a,s,O,I,A.canEdit,A.canComment,u,E,F,U,c,P,j,_,M,V]);return(0,f.jsx)(h.Provider,{value:L,children:t})}));function S(e,t,o,n){const y=(0,r().O7)(),{value:m}=(0,d().XJ)(s().F.formulas);return(0,i().VK)((()=>{if(!o||!e||!e.isDefined())return!1;if(!t)return!1;const r=null==n?void 0:n.type;return"checkbox"!==r&&"button"!==r&&"created_time"!==r&&"created_by"!==r&&"last_edited_time"!==r&&"last_edited_by"!==r&&"formula"!==r&&"rollup"!==r&&"auto_increment_id"!==r&&(0,l().wV)({block:e.getModel(),property:o,schema:t,getRecordModel:e.getRecordModel,userTimeZone:(0,a().r)(),intl:u().Z.getIntl(),userId:y.currentUser.id,experimentService:p().default,collectionFeatureGates:(0,c().W)(),formulasModule:m})}),[t,y.currentUser.id,o,null==n?void 0:n.type,e,m],{debugName:"BlockPropertyValueContext.useIsBPVEmpty"})}function v(e,t,o){return!![y().C.Board,y().C.GalleryView,y().C.ListView,y().C.Relation,y().C.RelationSection].includes(e)||(e===y().C.Mini?!o:!(!t||!y().C.Page))}},356321:(e,t,o)=>{o.d(t,{C:()=>n});let n=function(e){return e[e.Table=0]="Table",e[e.Board=1]="Board",e[e.Calendar=2]="Calendar",e[e.ListView=3]="ListView",e[e.GalleryView=4]="GalleryView",e[e.Timeline=5]="Timeline",e[e.Page=6]="Page",e[e.CompactPage=7]="CompactPage",e[e.Relation=8]="Relation",e[e.RelationSection=9]="RelationSection",e[e.Mini=10]="Mini",e[e.PropertyModule=11]="PropertyModule",e[e.FormEditor=12]="FormEditor",e[e.FormViewer=13]="FormViewer",e}({})},762141:(e,t,o)=>{o.d(t,{Z:()=>a});o(667294);var n=()=>o(38883),r=()=>o(788860),i=o(785893);const l={[n().lo.ExtremeSmall]:{height:12,fontSize:8,margin:"0 4px 0 0"},[n().lo.ExtraSmall]:{height:14,fontSize:12,margin:"0 4px 0 0"},[n().lo.Small]:{height:18,fontSize:12,margin:"0 6px 6px 0"},[n().lo.CompactEssential]:{height:21,fontSize:14,margin:"0 12px 6px 0"},[n().lo.Medium]:{height:21,fontSize:14,margin:"0 12px 6px 0"},[n().lo.Inline]:{height:21,fontSize:14,margin:"0 12px 0 0"},[n().lo.Large]:{height:24,fontSize:16,margin:"0 8px 8px 0"}};const a=function(e){const{count:t,format:n,fixedHeight:a,style:s,isCompact:c}=e,{margin:u,height:d,fontSize:p}=l[n],y=(0,o(846550).yK)((e=>({wrapper:{display:"flex",alignItems:"center",lineHeight:1.2,borderRadius:4,fontSize:p,margin:u,color:e.mediumTextColor,...a&&{height:d},...s},compact:{whiteSpace:"nowrap"}})),[p,d,a,u,s]);return(0,i.jsx)("div",{style:y.wrapper,children:c?(0,i.jsx)("span",{style:y.compact,children:(0,i.jsx)(r()._H,{defaultMessage:"+{thinSpace}{moreItemsCount}",id:"database.tokens.moreItems.message",values:{moreItemsCount:t,thinSpace:(0,i.jsx)("span",{children:""})}})}):(0,i.jsx)("span",{children:(0,i.jsx)(r()._H,{defaultMessage:"{relationMoreItemsCount} more",id:"database.relationPropertyValue.moreItems.message",values:{relationMoreItemsCount:t}})})})}},588366:(e,t,o)=>{o.d(t,{Z:()=>C});var n=o(667294),r=()=>o(219727),i=()=>o(142735),l=()=>o(846550),a=()=>o(226413),s=()=>o(949489),c=()=>o(909240),u=()=>o(106502),d=()=>o(589024),p=()=>o(982855),y=()=>o(527278),m=()=>o(942226),f=()=>o(82548),h=()=>o(121700),x=()=>o(27475),S=()=>o(890324),v=()=>o(96778),b=()=>o(108244),g=o(785893);function C(e){const{store:t,property:o,openOverlay:C}=e,w=(0,r().O7)(),{propertySchema:P,format:j,collectionContextStore:_,isEmpty:R,isReadOnly:B}=(0,n.useContext)(v().OU),M=(0,n.useCallback)((async()=>{if(!P)return;if(C){const e=(0,m().wq)(t)?x().Z:h().Z;c().bA({blockPropertyValueOverlayStore:e,collectionContextStore:_,format:j,environment:w,store:t,property:o,readOnly:!0})}const e=f().CollectionsAiAutofillProgressStore.setIsWriting({propertySchema:P,stores:[t]}),{propertyCompletionsActions:n}=await u().aiDependency.load();n.autofillPropertyForBlocks({environment:w,stores:[t],property:o,propertySchema:P,userEventForAnalytics:"generate_from_action_button",collectionContextStore:_,sessionIdForAnalytics:e,from:d().Sy(j)})}),[_,w,j,C,o,P,t]),T=(0,i().VK)((()=>!B&&P&&(!w.device.isMobile||R)&&(0,p().RT)(S().Z.getMode(w,t),t)&&(0,a().qQ)(P)&&(0,a().q3)(P)),[w,B,R,P,t]),V=(0,l().yK)((e=>({iconStyle:{color:e.mediumTextColor,fill:e.mediumTextColor}})),[]);return T?(0,g.jsx)(b().Z,{icon:s().y,tooltip:y().Z.formatMessage(k.update),onClick:M,iconStyle:V.iconStyle,style:{height:20,width:20}}):null}const k=(0,o(788860).vU)({update:{defaultMessage:"Update",id:"database.editButton.autofillWithAiTooltip"}})},961415:(e,t,o)=>{o.d(t,{U:()=>f});o(267602),o(653476),o(731107);var n=o(667294),r=()=>o(219727),i=()=>o(142735),l=()=>o(698763),a=()=>o(788860),s=()=>o(696459),c=()=>o(799454),u=()=>o(958783),d=()=>o(1910),p=()=>o(356321),y=o(785893);const m=(0,a().vU)({comment_on_property:{defaultMessage:"Comment",id:"database.CommentButton.commentOnPropertyValue"},open_discussion:{defaultMessage:"Open discussion",id:"database.CommentButton.openDiscussion"}}),f=n.memo((function(e){const{style:t,showShadow:f}=e,h=(0,a().YB)(),x=(0,r().O7)(),{isMobile:S}=(0,r().Fy)(),{canComment:v,isEmpty:b,propertySchema:g,format:C,collectionContextStore:k,property:w,store:P}=(0,n.useContext)(o(96778).OU),j=(0,i().VK)((()=>null==k?void 0:k.collectionStore()),[k]),_=(0,i().VK)((()=>o(687647).Z.state.open),[]),R=(0,i().VK)((()=>{if(!w||!P)return 0;return(0,o(852465).vV)(P,{recursivelyLoadAllDiscussions:!1,includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===w&&(0,o(561933).tH)(e,h,P,w))).reduce(((e,t)=>{const o=t.getModel();return o?{comments:e.comments+(o.getComments()||[]).length}:e}),{comments:0}).comments}),[h,w,P]),B=R>99?"99+":`${R}`,M=(0,i().VK)((()=>{var e;return(0,s().$K)(P)&&u().default.state.open&&u().default.isPropertyComment()&&(null===(e=u().default.state)||void 0===e?void 0:e.blockId)===P.id&&u().default.getPropertyId()===w}),[w,P]),T=(0,i().VK)((()=>{if(!j)return!1;const e=C===p().C.CompactPage,t=j.canEditCollection();return!e||!t}),[j,C]),V=(0,n.useMemo)((()=>!(R<=0)&&function(e){switch(e){case p().C.Table:case p().C.Board:case p().C.Calendar:case p().C.ListView:case p().C.GalleryView:case p().C.Timeline:case p().C.Mini:case p().C.FormEditor:case p().C.FormViewer:return!1;case p().C.PropertyModule:case p().C.Page:case p().C.CompactPage:case p().C.Relation:case p().C.RelationSection:return!0;default:(0,s().t1)(e)}}(C)),[R,C]),E=(0,n.useMemo)((()=>R>0?h.formatMessage(m.open_discussion):h.formatMessage(m.comment_on_property)),[h,R]),I=(0,n.useCallback)((async()=>{w&&P&&(_?c().LZ():P.isNavigableAncestorNonCommentableState()||(R>0?await c().Ib({environment:x,blockStore:P,shouldFocusDiscussion:!0,analyticsFrom:"db_quick_action",recursivelyLoadAllDiscussions:!1,property_id:w,openFullPropertyDiscussionOnly:!0,intl:h}):M?o(8208).Z.setActiveWithSource("popover_comments"):await(0,o(267191).y)({environment:x,blockStore:P,rect:o(983993).Z.getRect(P,w),property_id:w})))}),[w,P,_,R,x,h,M]),A=(0,o(846550).yK)((e=>({icon:{color:e.mediumTextColor,fill:e.mediumTextColor},caption:{color:e.mediumTextColor},button:{...t,position:"relative",display:"flex"},iconButton:{height:20}})),[t]),O=(0,n.useCallback)((e=>(0,y.jsxs)("div",{...e,onClick:I,style:A.button,role:"button",tabIndex:0,children:[R>0?(0,y.jsx)(d().Z,{ariaLabel:E,hasBackground:!0,icon:l().s,caption:(0,y.jsx)("span",{children:B}),showShadow:f,iconStyle:A.icon,captionStyle:A.caption,style:A.iconButton},`icon-btn-${R}`):(0,y.jsx)(d().Z,{ariaLabel:E,hasBackground:!0,icon:l().s,showShadow:f,iconStyle:A.icon,style:A.iconButton},`icon-btn-${R}`),M&&(0,y.jsx)(o(211332).Z,{onlyShowDraftDot:!0,customTop:2,customLeft:15})]})),[B,M,R,I,f,A.button,A.caption,A.icon,A.iconButton,E]),K=(0,n.useCallback)((()=>E),[E]);return!g||b||!T||V||S||!v||(0,o(226413).ZY)(g.type)?null:(0,y.jsx)(o(654133).Z,{renderTooltip:K,render:O})}))},251074:(e,t,o)=>{o.r(t),o.d(t,{default:()=>h});var n=o(667294),r=()=>o(142735),i=()=>o(846550),l=()=>o(214993),a=()=>o(694317),s=()=>o(984709),c=()=>o(788860),u=()=>o(696459),d=()=>o(96778),p=o(785893);function y(){var e;const{property:t,propertySchema:l,store:a,collectionContextStore:s}=(0,n.useContext)(d().OU),c=null===(e=(0,o(395833).$)(l))||void 0===e?void 0:e.type,{linkHref:u,shouldShowMaliciousContentDialog:y}=(0,r().VK)((()=>{const e=t?null==a?void 0:a.getPropertyValue(t):void 0;return(0,o(505521).k)({textValue:e,type:c,store:a})}),[t,a,c]),h=(0,r().VK)((()=>{var e;return null==s||null===(e=s.collectionStore())||void 0===e?void 0:e.getSchema()}),[s]),x=(0,d().yT)(a,h,t,l),S=e=>{(e.metaKey||e.ctrlKey)&&window.open(u,"_blank")},v=(0,i().yK)((e=>({container:{width:20,height:20,borderRadius:6,display:"inline-flex",alignItems:"center",justifyContent:"center"}})),[]);return!x&&u&&c?(0,p.jsx)(o(654133).Z,{renderTooltip:()=>(0,p.jsx)(m,{type:c}),placement:o(998901).Placement.Top,render:e=>(0,p.jsx)(o(729775).Z,{href:u,style:v.container,...(0,o(164079).Z)(e,{onClick:S}),external:!0,preNavigationAction:e=>{y?(0,o(469753).TG)({propertyType:"url",onConfirm:()=>{e()}}):e()},children:(0,p.jsx)(f,{type:c})})}):null}function m(e){let{type:t}=e;return"phone_number"===t?(0,p.jsx)(c()._H,{id:"contactVisitButton.tooltip.phone",defaultMessage:"Call number"}):"email"===t?(0,p.jsx)(c()._H,{id:"contactVisitButton.tooltip.email",defaultMessage:"Email"}):"url"===t?(0,p.jsx)(c()._H,{id:"contactVisitButton.tooltip.url",defaultMessage:"Open link"}):void(0,u().t1)(t)}function f(e){let{type:t}=e;const o=(0,i().yK)((e=>{const t={fill:e.icon.secondary,width:16,height:16};return{icon:t,phone:{...t,width:14,height:14},arrowRotated:{...t,transform:"rotate(45deg)"}}}),[]);return"phone_number"===t?(0,s().u)(o.phone):"email"===t?(0,a().f)(o.icon):"url"===t?(0,l().Z)(o.arrowRotated):void(0,u().t1)(t)}const h=n.memo(y)},984851:(e,t,o)=>{o.d(t,{q:()=>c});var n=o(667294),r=()=>o(846550),i=()=>o(173255),l=()=>o(96778),a=o(785893);const s=(0,o(788860).vU)({copy:{defaultMessage:"Copy to Clipboard",id:"database.copyButton.copyToClipboard"}}),c=n.memo((function(e){const{store:t,property:c,style:u,format:d,showShadow:p}=e,y=(0,o(219727).O7)(),m=(0,r().Fg)(),f=(0,o(125659).DK)(),{collectionSchema:h}=(0,n.useContext)(l().OU),{isEmpty:x,propertySchema:S,isReadOnly:v}=(0,n.useContext)(l().OU),b=(0,r().yK)((e=>({buttonStyle:{display:"flex",position:"relative"},iconStyle:{color:e.mediumTextColor,fill:e.mediumTextColor}})),[]),g=d===o(356321).C.Table,C=o(527278).Z.formatMessage(s.copy),k=(0,n.useCallback)((()=>C),[C]),w=(0,n.useCallback)((e=>(0,a.jsx)("div",{onClick:async()=>{if(!h)return;let e;g&&(e=i().Z.getState(),o(435168).MO()),await o(820185).r({environment:y,theme:m,store:t,schema:h,property:c,collectionContextStore:f}),g&&e&&i().Z.setState(e)},style:{...u,...b.buttonStyle},...e,role:"button",tabIndex:0,children:(0,a.jsx)(o(1910).Z,{ariaLabel:C,hasBackground:!0,icon:o(524052).U,showShadow:p,iconStyle:b.iconStyle,style:{height:20,width:20}})})),[f,h,y,g,c,p,t,u,b.buttonStyle,b.iconStyle,m,C]);return void 0===S||x||y.device.isMobile&&!1===v||"checkbox"===(0,o(407589).z6)(S)?null:(0,a.jsx)(o(654133).Z,{renderTooltip:k,render:w})}))},448593:(e,t,o)=>{o.d(t,{G:()=>y,t:()=>m});var n=o(667294),r=()=>o(219727),i=()=>o(846550),l=()=>o(26970),a=()=>o(492522),s=()=>o(641506),c=()=>o(96778),u=()=>o(356321),d=o(785893);const p=4;function y(e){const{children:t,align:o,sticky:n,style:r,height:c,visuallyHidden:u}=e,y=(0,i().yK)((e=>({buttonWrapperStyle:{display:"flex",justifyContent:"right"===o?"end":"start",position:"absolute",top:4,right:0,left:0,zIndex:a().XP,margin:`0 ${p}px`,pointerEvents:"none",...r},innerWrapperStyle:{display:"flex",pointerEvents:"auto",background:e.surface.elevated,padding:"2px",height:c||24,boxShadow:e.shadowSM,borderRadius:6},stickyStyle:{position:"sticky",right:p}})),[o,c,r]);return t?(0,d.jsx)("div",{style:y.buttonWrapperStyle,children:(0,d.jsx)("div",{...(0,l().iv)(y.innerWrapperStyle,n&&y.stickyStyle,u&&s().jy),className:"quickActionContainer",children:t})}):null}function m(e){const{format:t,align:o}=e;switch(t){case u().C.Table:return(0,d.jsx)(v,{...e,align:o??"right"});case u().C.PropertyModule:case u().C.Page:return(0,d.jsx)(h,{...e,align:o??"right"});case u().C.Board:return(0,d.jsx)(f,{...e,align:o??"right"});case u().C.GalleryView:return(0,d.jsx)(x,{...e,align:o??"right"});case u().C.ListView:return(0,d.jsx)(S,{...e,align:o??"right"});default:return(0,d.jsx)(y,{...e,align:o??"right"})}}function f(e){const t=(0,i().yK)((()=>({buttonWrapperStyle:{top:0,...e.style}})),[e.style]);return(0,d.jsx)(y,{...e,style:t.buttonWrapperStyle})}function h(e){const{propertyModule:t}=(0,n.useContext)(c().OU),o=(0,i().yK)((()=>({buttonWrapperStyle:{top:t&&"style"in t&&"large"===t.style?10:5,...e.style}})),[t,e.style]);return(0,d.jsx)(y,{...e,style:o.buttonWrapperStyle})}function x(e){const t=(0,i().yK)((()=>({buttonWrapperStyle:{top:-1,...e.style}})),[e.style]);return(0,d.jsx)(y,{...e,style:t.buttonWrapperStyle})}function S(e){const t=(0,i().yK)((()=>({buttonWrapperStyle:{position:void 0,margin:0,...e.style}})),[e.style]);return(0,d.jsx)(y,{...e,style:t.buttonWrapperStyle})}function v(e){const{align:t="right"}=e,{isMobile:o}=(0,r().Fy)(),{shouldWrap:l,propertyFormat:a}=(0,n.useContext)(c().OU),s=null==a?void 0:a.width,u=(0,n.useMemo)((()=>s&&s<50?2:s&&s<=32?0:p),[s]),m=(0,i().yK)((()=>({buttonWrapperStyle:{...e.style,...o&&l?{position:"sticky",float:t,marginRight:0,marginLeft:2,right:u}:{margin:`0 ${u}px`}}})),[t,u,o,e.style,l]);return(0,d.jsx)(y,{...e,style:m.buttonWrapperStyle,sticky:!0})}},108244:(e,t,o)=>{o.d(t,{Z:()=>l});o(667294);var n=()=>o(1910),r=()=>o(654133),i=o(785893);function l(e){const{href:t,icon:o,iconStyle:l,tooltip:a,externalLink:s,onClick:c,showShadow:u,style:d}=e;return(0,i.jsx)(r().Z,{renderTooltip:()=>a,render:e=>(0,i.jsx)(n().Z,{ariaLabel:a,icon:o,iconStyle:l,href:t,onClick:c,hasBackground:!0,showShadow:u,external:s,...e,style:d})})}},201608:(e,t,o)=>{o.d(t,{Am:()=>g,M$:()=>v,bb:()=>b,eL:()=>k,oW:()=>C,z0:()=>h});var n=o(667294),r=()=>o(142735),i=()=>o(926724),l=()=>o(834458),a=()=>o(226413),s=()=>o(532850),c=()=>o(998411),u=()=>o(955620),d=()=>o(970105),p=()=>o(269299),y=()=>o(615676),m=()=>o(527278),f=()=>o(749826);i().b0.Dates;function h(e){var t,o;const{collectionStore:n,propertySchema:r,collectionContextStore:i,store:l,property:a,isJiraTwoWaySyncEnabled:c}=e;if(!n.isExternallyImportedAndSyncedCollection()||!c)return!1;const u=Boolean(null===(t=n.getFormat())||void 0===t||null===(t=t.sync_state)||void 0===t?void 0:t.syncing);if("read_write"!==(null==r?void 0:r.synced_permissions)||null===(o=n.getFormat().sync_state)||void 0===o||!o.enable_two_way_sync||u)return!0;const d=null==i?void 0:i.externalSyncStore.state;return(null==d||!d.shouldAllowUserToEditSyncedCollection())&&(0,s().f0)(l.getModel(),a,l.getRecordModel)}const x={[i().b0.Dates]:{propertyId:i().b0.Dates,validationCheck:e=>{const{collectionStore:t}=e,o=t.getPropertyMapping(),n=null==o?void 0:o[i().b0.StatusV2];return Boolean(n)}}},S={date:[i().b0.Dates]};function v(e){const{collectionStore:t,property:o,propertySchema:n}=e;if(!n)return!0;const r=t.getPropertyMapping();if(!r)return!1;const i=S[n.type]??[];for(const l of i){const e=x[l];if(!e.validationCheck({collectionStore:t}))continue;const n=null==r?void 0:r[e.propertyId];if(o===e.propertyId||o===n)return!0}return!1}function b(e){const{store:t,schema:o,property:n,userId:r,formulasModule:i}=e,a=o[n],u=null==a?void 0:a.type;return"checkbox"!==u&&"button"!==u&&"checkbox"!==(0,l().getFormulaPropertySchemaResultType)(a)&&(!t.isDefined()||s().wV({block:t.getModel(),property:n,schema:o,getRecordModel:t.getRecordModel,userId:r,userTimeZone:(0,c().r)(),intl:m().Z.getIntl(),experimentService:f().default,collectionFeatureGates:(0,y().W)(),formulasModule:i}))}function g(e,t){let{store:o,property:r,format:i,onClick:l,collectionStore:a,blockPropertyValueOverlayStore:s,disableHorizontalEdgeScroll:c,focusButtonAfterClose:u}=e;return(0,n.useMemo)((()=>({store:o,property:r,format:i,onClick:l,collectionStore:a,blockPropertyValueOverlayStore:s,disableHorizontalEdgeScroll:c,isStatusCheckbox:null==t?void 0:t.isStatusCheckbox,focusButtonAfterClose:u})),[s,a,c,i,null==t?void 0:t.isStatusCheckbox,l,r,o,u])}function C(e,t,o){return(0,r().VK)((()=>{if(!e.isDefined())return;if(!e.isTemplate())return;const n=null==o?void 0:o.type;if(!(0,a().fc)(n))return;const r=e.getPropertyValue(t);if(!r)return;const i=null==r?void 0:r[0];if(i&&u().km_(i)){const e=u().QGY(u().hn0(i)),t=e&&u().fsE(e);return t&&{templateVariable:t.type}}}),[t,o,e],{debugName:"useTemplateVariableContext"})}function k(e,t,o){const n=s().eP(e);p().createAndCommit({userAction:"BlockPropertyValueOverlay.handleNumberValueChange",environment:t,canUndo:!0,perform:e=>{for(const r of o)d().sO({environment:t,store:r,value:n,transaction:e})}})}},603885:(e,t,o)=>{o.d(t,{A2:()=>V,Ac:()=>m,Ec:()=>d,RQ:()=>A,ch:()=>_,e4:()=>I,jV:()=>u,nz:()=>v,o9:()=>B,sf:()=>M,uo:()=>O,z6:()=>p});var n=o(667294),r=()=>o(219727),i=()=>o(846550),l=()=>o(38883),a=()=>o(696459),s=()=>o(707513),c=()=>o(356321);function u(e){return e??l().lo.Medium}const d="28px",p="14px",y="12px",m=1.5,f=1.25,h=35,x=21,S=18,v=32,b=34,g=30,C=28,k=30,w=32,P=24,j=24,_=24,R=30,B=6,M={[c().C.Table]:{default:`${B}px 8px`,text:"6px 8px",checkbox:"8px",button:"4px 8px"},[c().C.Page]:{default:"7px 6px",text:"6px",checkbox:"9px 6px",button:"5px 6px"},[c().C.CompactPage]:{default:"5px 6px",text:"4px 6px",token:"5px 6px",checkbox:"7px 6px",button:"3px 6px"},[c().C.Board]:{default:"5px",text:"5px",checkbox:"5px",button:"4px"}},T=["title","text","email","phone_number","number","url","date","created_time","last_edited_time","auto_increment_id"];function V(e){return"empty"===e||"error"===e||T.includes(e)}const E=["button","file"];function I(e){return E.includes(e)}const A={[l().lo.ExtremeSmall]:void 0,[l().lo.ExtraSmall]:void 0,[l().lo.Small]:{columnGap:6,rowGap:4},[l().lo.CompactEssential]:{columnGap:4,rowGap:6},[l().lo.Medium]:{columnGap:8,rowGap:6},[l().lo.Large]:{columnGap:10,rowGap:10},[l().lo.Inline]:{columnGap:6,rowGap:4}};function O(e){let{shouldSetCellHeight:t,format:o,shouldWrap:u,isLast:B,disabled:T,locked:V,showIfEmpty:E,isInvalidFormAnswer:I,propertyModule:O}=e;const{isPhone:K}=(0,r().Fy)(),F=(0,i().Fg)(),U=O&&"style"in O&&"large"===O.style;return(0,n.useMemo)((()=>{switch(o){case c().C.Table:return{buttonStyle:{display:"block",fontSize:p,overflow:"clip",width:"100%",whiteSpace:u?"normal":"nowrap",height:t?v:void 0,minHeight:v,cursor:T||V?"default":"pointer",padding:M[c().C.Table].default},buttonHoveredStyle:{background:"unset"},buttonPressedStyle:{background:"unset"},textStyle:{lineHeight:m,whiteSpace:u?"pre-wrap":"nowrap",wordBreak:u?"break-word":"normal"},tokenWrapStyle:{display:"flex",flexWrap:u?"wrap":"nowrap",...A[l().lo.Medium]},textLineHeight:x,sizing:"default",tokenFormat:l().lo.Medium};case c().C.GalleryView:return{buttonStyle:{display:"flex",overflow:"hidden",alignItems:"center",borderRadius:5,margin:"0 6px 2px 6px",padding:"0 5px",fontSize:K?p:y,minHeight:j,whiteSpace:u?"normal":"nowrap",minWidth:E?"auto":"fit-content",width:E?"auto":"fit-content"},textStyle:{lineHeight:m,whiteSpace:u?"pre-wrap":"nowrap",wordBreak:u?"break-word":"normal",overflow:"hidden"},tokenWrapStyle:{display:"flex",minWidth:0,flexShrink:0,flexWrap:u?"wrap":"nowrap",width:u?"100%":void 0,...A[K?l().lo.Medium:l().lo.Small]},textLineHeight:K?x:S,sizing:K?"default":"small",tokenFormat:K?l().lo.Medium:l().lo.Small};case c().C.Board:return{buttonStyle:{display:"flex",overflow:"hidden",alignItems:"center",borderRadius:5,fontSize:y,margin:"0 6px 2px 6px",padding:M[c().C.Board].default,minHeight:C,whiteSpace:u?"normal":"nowrap",width:E?"auto":"fit-content"},textStyle:{lineHeight:m,whiteSpace:u?"pre-wrap":"nowrap",wordBreak:u?"break-word":"normal"},tokenWrapStyle:{display:"flex",flexWrap:u?"wrap":"nowrap",...A[l().lo.Small]},textLineHeight:S,sizing:"small",tokenFormat:l().lo.Small};case c().C.RelationSection:return{buttonStyle:{display:"inline-flex",fontSize:y,overflow:"hidden",alignItems:"center",marginLeft:0,minHeight:w,padding:"0 8px",borderRadius:5},tokenWrapStyle:{display:"flex",minWidth:0,...A[l().lo.Small]},textLineHeight:S,sizing:"small",tokenFormat:l().lo.Small};case c().C.Relation:return{buttonStyle:{fontSize:y,overflow:"hidden",alignItems:"center",padding:"0 4px",borderRadius:5,display:"flex",marginLeft:K?0:8,marginRight:K?8:0,height:P,minWidth:20},textStyle:{lineHeight:m,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},tokenWrapStyle:{display:"flex",minWidth:0,...A[l().lo.Small]},textLineHeight:S,sizing:"small",tokenFormat:l().lo.Small};case c().C.ListView:return{buttonStyle:{fontSize:y,overflow:"hidden",alignItems:"center",padding:"0 8px 0 8px",borderRadius:5,display:"flex",flexGrow:0,flexShrink:0,flexBasis:"auto",marginLeft:0,marginRight:K?2:0,minHeight:k,minWidth:20},textStyle:{lineHeight:m,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},tokenWrapStyle:{display:"flex",minWidth:0,...A[l().lo.Inline]},textLineHeight:S,sizing:"small",tokenFormat:l().lo.Inline};case c().C.Page:return{buttonStyle:{fontSize:p,overflow:"hidden",display:"inline-block",borderRadius:4,width:"100%",minHeight:b,padding:M[c().C.Page].default},textStyle:{lineHeight:m,wordBreak:"break-word",whiteSpace:"pre-wrap"},tokenWrapStyle:{display:"flex",flexWrap:"wrap",...A[l().lo.Medium]},textLineHeight:x,sizing:"default",tokenFormat:l().lo.Medium};case c().C.Timeline:return{buttonStyle:{display:"flex",alignItems:"center",fontSize:y,marginRight:B?0:10},buttonHoveredStyle:{background:"unset"},buttonPressedStyle:{background:"unset"},textStyle:{lineHeight:m,wordBreak:"break-word",whiteSpace:"nowrap"},tokenWrapStyle:{display:"flex",minWidth:0,...A[l().lo.Small]},textLineHeight:S,sizing:"small",tokenFormat:l().lo.Inline};case c().C.Calendar:return{buttonStyle:{fontSize:y,display:"flex",alignItems:"center",height:_,whiteSpace:"nowrap",width:"100%"},textStyle:{lineHeight:m,whiteSpace:"nowrap",overflow:"hidden"},tokenWrapStyle:{display:"flex",flexShrink:0,flexWrap:"nowrap",...A[l().lo.Small]},textLineHeight:S,sizing:"small",tokenFormat:l().lo.Small};case c().C.CompactPage:return{buttonStyle:{fontSize:p,overflow:"hidden",alignItems:"center",borderRadius:4,display:"flex",width:"100%",minHeight:g,padding:M[c().C.CompactPage].default},textStyle:{lineHeight:m,wordBreak:"break-word",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},tokenWrapStyle:{display:"flex",flexWrap:"nowrap",overflow:"hidden",alignItems:"center",...A[l().lo.CompactEssential]},textLineHeight:x,sizing:"default",tokenFormat:l().lo.CompactEssential};case c().C.Mini:return{buttonStyle:{fontSize:p,overflow:"hidden",alignItems:"center",borderRadius:4,display:"flex",padding:"0 6px",minWidth:0,height:R,maxWidth:300},textStyle:{lineHeight:m,wordBreak:"break-word",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},tokenWrapStyle:{display:"flex",flexWrap:"nowrap",overflow:"hidden",alignItems:"center",...A[l().lo.Medium]},textLineHeight:x,sizing:"default",tokenFormat:l().lo.Medium};case c().C.PropertyModule:const e={fontSize:U?d:p,overflow:"hidden",display:"block",borderRadius:4,width:"100%",minHeight:b,padding:M[c().C.Page].default};return{buttonStyle:e,emptyButtonStyle:{...e,padding:M[c().C.Page].text},textStyle:{lineHeight:U?f:m,wordBreak:"break-word",whiteSpace:"pre-wrap",...U?{fontWeight:s().Ue.medium}:{}},emptyTextStyle:{fontSize:p,lineHeight:m,wordBreak:"break-word"},tokenWrapStyle:{display:"flex",flexWrap:"wrap",...A[l().lo.Medium]},textLineHeight:U?h:x,sizing:U?"large":"default",tokenFormat:l().lo.Medium};case c().C.FormEditor:case c().C.FormViewer:return{buttonStyle:{borderRadius:6,boxShadow:o===c().C.FormViewer&&I?F.outlineRedInputBoxShadow:`0 0 0 1px ${F.stroke.input} inset`,marginTop:8,padding:"0 10px",minHeight:38,display:"flex",alignItems:"center",fontSize:16,overflowX:"hidden",cursor:"text"},buttonHoveredStyle:{background:"unset"},buttonPressedStyle:{background:"unset"},tokenWrapStyle:{display:"flex",flexWrap:u?"wrap":"nowrap",...A[l().lo.Large]},textLineHeight:x,sizing:"default",tokenFormat:l().lo.Medium};default:(0,a().t1)(o)}}),[o,u,t,T,V,K,E,B,U,I,F])}},991333:(e,t,o)=>{o.d(t,{m:()=>c});o(267602),o(653476),o(241792);var n=o(667294),r=()=>o(142735),i=()=>o(846550),l=()=>o(185697),a=()=>o(96778);const s={title:[240,600],text:[100,300],number:[100,150],select:[100,150],multi_select:[100,200],date:[100,150],person:[100,150],file:[100,150],checkbox:[40,100],phone_number:[100,150],formula:[100,150],relation:[100,150],rollup:[100,150],created_time:[100,150],created_by:[100,150],last_edited_time:[100,150],last_edited_by:[100,150],last_visited_time:[100,150],button:[100,150],status:[100,150],auto_increment_id:[100,150],location:[100,150],verification:[100,150],geo_point:[100,150]};function c(e,t,o,c){const[u,d]=s[c],{collectionContextStore:p}=(0,n.useContext)(a().OU),{isBeforeTitle:y,propertyIndex:m,titleIndex:f,visibleProperties:h}=(0,r().VK)((()=>{var e,n;if(!t)return{isBeforeTitle:!1,propertyIndex:-1,titleIndex:-1,visibleProperties:[]};const r=((null===(n=((null==p||null===(e=p.collectionViewStore())||void 0===e?void 0:e.getFormat())??{}).list_properties)||void 0===n?void 0:n.filter((e=>e.visible)))??[]).map((e=>(0,l().A)({collectionStore:t,collectionContextStore:p,property:e.property})));if(void 0===r)return{isBeforeTitle:!1,propertyIndex:-1,titleIndex:-1,visibleProperties:[]};const i=r.findIndex((e=>"title"===e)),a=r.findIndex((e=>e===o));return-1===i||-1===a?{isBeforeTitle:!1,propertyIndex:-1,titleIndex:-1,visibleProperties:[]}:{isBeforeTitle:a<i,propertyIndex:a,titleIndex:i,visibleProperties:r}}),[p,t,o]),[x,S]=(0,n.useState)(null);return(0,n.useEffect)((()=>{if(!e||!("current"in e)||!e.current)return;const t=e.current,o=new ResizeObserver((e=>{var t;const o=null===(t=e[0])||void 0===t?void 0:t.contentRect.width;o&&S(o)}));return o.observe(t),()=>{o.disconnect()}}),[e]),(0,i().yK)((()=>{if(void 0===o||void 0===c)return{};const e={};0===m?(e.marginLeft=0,e.paddingLeft=0):m===h.length-1&&(e.marginRight=0,e.paddingRight=0);const t=Math.floor(100/h.length),n=f;return m!==f&&y&&n>0?e.maxWidth=`calc((100% - 240px) / ${n})`:(null!==x&&x>=u&&(e.minWidth=u),e.maxWidth=`max(${d}px, ${t}%)`),"rollup"===c?{textButtonStyle:e,buttonButtonStyle:e}:{buttonStyle:e}}),[o,c,m,h.length,f,y,x,u,d])}},802729:(e,t,o)=>{o.d(t,{C:()=>a,H:()=>l});o(267602),o(653476),o(241792);var n=()=>o(142735),r=()=>o(26970),i=()=>o(852465);function l(e){let{store:t,propertyId:o}=e;const l=(0,n().VK)((()=>{var e;return t&&o?null===(e=(0,i().vV)(t,{includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===o)))||void 0===e||null===(e=e[0])||void 0===e?void 0:e.id:void 0}),[t,o]);return l?(0,r().dk)({discussionId:l}):void 0}function a(e){let{store:t,propertyId:o}=e;const l=(0,n().VK)((()=>t&&o?(0,i().vV)(t,{includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===o)).map((e=>e.id)):void 0),[t,o]);return l?l.map((e=>(0,r().dk)({discussionId:e}))):void 0}}}]);