"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[13856,95986,82164,66463],{158792:(e,t,o)=>{o.d(t,{Dw:()=>I,P0:()=>M,RN:()=>L,VG:()=>j,Yw:()=>w,jX:()=>B,k2:()=>D,lz:()=>_,v2:()=>T});o(267602),o(653476),o(30005);var n=()=>o(741633),i=()=>o(528514),r=()=>o(933868),a=()=>o(217465),s=()=>o(396136),l=()=>o(696056),c=()=>o(255933),d=()=>o(989478),u=()=>o(696459),p=()=>o(308186),g=()=>o(577041),m=()=>o(527278),h=()=>o(122479),f=()=>o(826955),y=()=>o(824462),S=()=>o(528918),v=()=>o(784234),b=()=>o(636340),C=()=>o(102182),x=()=>o(269299),P=()=>o(423402);const R=(0,o(788860).vU)({duplicatingTemplate:{id:"botActions.duplicatingTemplate.loadingMessage",defaultMessage:"Duplicating template..."},duplicatingTemplateError:{id:"botActions.duplicateTemplateAndShareWithBot.snackbar.failure",defaultMessage:"Failed to duplicate template for to your workspace"}});function k(e,t){const{environment:o,spaceStore:n,spaceRole:i}=t,r=function(e){const{name:t,spaceStore:o,userId:n,icon:i,type:r}=e,a=Date.now(),s={name:t,created_at:a,created_by_table:d().KJ,created_by_id:n,alive:!0,icon:i,space_id:o.id,last_edited_at:a,last_edited_by_id:n,last_edited_by_table:d().KJ};switch(r){case"guest":return{...s,type:"guest",capabilities:e.capabilities,parent_table:c().bx,parent_id:o.id,integration_id:void 0};case"scim":return{...s,type:"scim",parent_table:d().KJ,parent_id:n};default:(0,u().t1)(r)}}(t),a=b().ae({environment:o,table:l().cZ,value:r,inMemoryRecordCache:o.defaultRecordCache.inMemoryRecordCache,transaction:e});return v().tQ({environment:o,spaceStore:n,permissionItems:[{type:"bot_permission",role:i,bot_id:a.id}],transaction:e}),{botStore:a}}function _(e){const{environment:t}=e,{serverCommitResult:o,performResult:{botStore:n}}=x().createAndCommit({userAction:"botActions.createSpaceBot",environment:t,canUndo:!0,perform:t=>k(t,e)});return{botStore:n,transactionPromise:o}}async function M(e){const{environment:t,botId:o,onSuccess:n}=e,i=await y().callApi({eventName:"deleteBot",environment:t,data:{botId:o}});"failed"===i.type?p().x2(i):"success"===i.type&&n&&(await P().pJ({environment:t}),n())}async function w(e){const{environment:t,table:o,id:i,type:r}=e,a=await y().callApi({eventName:"getBots",environment:t,data:{table:o,id:i,type:r},headers:(0,n().Bb)({spaceId:o===c().bx?i:void 0})});if("failed"===a.type)throw p().x2(a),a;return{botIds:a.data.botIds,recordMap:a.data.recordMap}}async function I(e){const{environment:t,currentSpaceStore:o,botIds:n}=e;if(!o)return;const i=await y().callApi({eventName:"getBotSharedPageIds",environment:t,data:{spaceId:o.id,botIds:n}});if("failed"!==i.type)return i.data;p().x2(i)}async function j(e){const{environment:t,botId:o}=e,n=await y().callApi({eventName:"getBotToken",environment:t,data:{botId:o}});if("failed"!==n.type)return n.data.token;p().x2(n)}function T(e){const{botValue:t,store:o,environment:n}=e,{id:r,parent_id:a,parent_table:s,capabilities:l}=t,c={type:"bot_permission",bot_id:r,parent_id:a,parent_table:s,role:(0,i().uH)(l)};x().createAndCommit({userAction:"TopbarMoreButton.handleAddingConnection",environment:n,canUndo:!0,perform:e=>{v().l3({environment:n,store:o,permissionItems:[c],transaction:e})}})}function L(e){const{botId:t,store:o,environment:n}=e,i=o.getPermissionItems().filter((0,u().AO)((e=>(0,r().FB)(e)?{true:e}:{false:e})));for(const r of i)if(r.bot_id===t){const e={...r,role:"none"};x().createAndCommit({userAction:"TopbarMoreButton.handleRemovingConnection",environment:n,canUndo:!0,perform:t=>{v().l3({environment:n,store:o,permissionItems:[e],transaction:t})}})}}function B(e){const{currentSpaceStore:t,environment:o,pages:n,botStore:i,addPermission:r}=e;if(!t)return;const a=(0,h().zT)({botStore:i,addPermission:r});n.forEach((e=>{const n=f().t1.createChildStore(t,{table:s().iU,id:e});x().createAndCommit({userAction:"botActions.updateBlockPermissionsForBot",environment:o,canUndo:!0,perform:e=>{v().l3({environment:o,store:n,permissionItems:[a],transaction:e})}})}))}async function D(e){const{environment:t,spaceStore:o,spaceViewStore:n,templatePageId:i,botValue:r,pages:s}=e;if(!o)return;const c=f().t1.createChildStore(o,{table:l().cZ,id:r.id});if(i)return await async function(e){const{environment:t,spaceStore:o,spaceViewStore:n,templatePageId:i,botStore:r}=e;if(!o||!n)return;try{S().j({message:R.duplicatingTemplate});const e=await y().callApi({eventName:"loadBlockSubtree",environment:t,data:{block:{id:i,spaceId:o.id},shallow:!1}});if("failed"===e.type)return;const s=a().RecordMapWithRole.create(e.data.subtreeRecordMap),{createAndDuplicatePageInSpace:l}=await(0,g().uP)(),{performResult:c}=x().createAndCommit({userAction:"botActions.duplicateTemplateAndShareWithBot",environment:t,canUndo:!0,perform:e=>{const a=l({environment:t,recordMap:s,copyPageId:i,isPrivate:!0,spaceStore:o,spaceViewStore:n,transaction:e,allowCopyExternalObjectInstances:!1}),c=n.getPrivatePageIds();c.length>0&&b().sW({store:n,data:{private_pages:[a.id,...c]},transaction:e});const d=(0,h().zT)({botStore:r,addPermission:!0});return v().l3({environment:t,store:a,permissionItems:[d],transaction:e}),a}});return c}catch(s){C().oV({label:m().Z.formatMessage(R.duplicatingTemplateError)})}finally{S().x()}}({environment:t,templatePageId:i,botStore:c,spaceStore:o,spaceViewStore:n});B({environment:t,currentSpaceStore:o,botStore:c,pages:s,addPermission:!0})}},86609:(e,t,o)=>{o.d(t,{KV:()=>N,Rh:()=>J,U6:()=>Q,Wu:()=>te,Xx:()=>K,YD:()=>ee,g9:()=>z,jc:()=>q,m8:()=>Y,ys:()=>$,zX:()=>X});o(122556),o(582845),o(250570),o(533019),o(721473),o(788208),o(22624),o(267602),o(30005),o(241792),o(228244);var n=()=>o(730120),i=()=>o(506347),r=()=>o(926724),a=()=>o(271896),s=()=>o(226413),l=()=>o(803021),c=()=>o(874459),d=()=>o(956057),u=()=>o(528514),p=()=>o(494616),g=()=>o(922713),m=()=>o(396136),h=()=>o(752778),f=()=>o(255933),y=()=>o(306164),S=()=>o(856466),v=()=>o(126301),b=()=>o(955620),C=()=>o(253335),x=()=>o(110232),P=()=>o(285755),R=()=>o(23151),k=()=>o(757216),_=()=>o(544903),M=()=>o(594546),w=()=>o(487270),I=()=>o(527278),j=()=>o(876822),T=()=>o(826955),L=()=>o(250303),B=()=>o(824462),D=()=>o(984871),V=()=>o(139224),Z=()=>o(421654),A=()=>o(636340),F=()=>o(511614),H=()=>o(269299),U=()=>o(663366),E=()=>o(348141);const O="week";function K(e){var t;const{environment:o,transaction:n,tasksBlockStore:i,sprintsBlockStore:r}=e,a=null===(t=r.getFormat())||void 0===t?void 0:t.collection_pointer,s=i.getFormat().collection_pointer;if(!a||!s)return;const l=T().NW.createChildStore(r,a),c=l.getRole()??"none";if(!(0,u().yY)(c,"editor"))return;l.getAutomationStores().some((e=>e.isCompleteSprintAutomation()))||W({environment:o,transaction:n,sprintCollectionStore:l,taskCollectionStore:T().NW.createChildStore(i,s),sprintSettingsConfig:S().iZ})}function W(e){const{environment:t,sprintSettingsConfig:o,transaction:n,sprintCollectionStore:i,taskCollectionStore:r}=e,a=i.getSpaceId(),s=(0,w().TS)({environment:t,table:p().cv,spaceId:a}),l=(0,w().TS)({environment:t,table:g().Xj,spaceId:a});A().ae({environment:t,table:p().cv,inMemoryRecordCache:i.inMemoryRecordCache,value:{id:s,parent_id:i.id,parent_table:i.table,alive:!0,space_id:a,status:o.autoCompleteSprints?"active":"disabled",trigger:{id:d().Il(),type:"recurrence",recurrence:ne(o)},action_ids:[l]},transaction:n}),Z().FH({stores:[i],update:{automation_ids:[...i.getFormat().automation_ids??[],s]},transaction:n}),A().ae({environment:t,table:g().Xj,inMemoryRecordCache:i.inMemoryRecordCache,transaction:n,value:{id:l,parent_id:s,parent_table:p().cv,type:"complete_sprint",alive:!0,space_id:a,config:{sprint_collection:i.getSpaceShardedPointer(),task_collection:r.getSpaceShardedPointer(),complete_sprint_action:o.actionConfig.complete_sprint_action}}})}function N(e){const{environment:t,automationStore:o,transaction:n,newDuration:i,currentSprintBlockStore:r}=e;A().sW({store:o.getTriggerStore().getKeyStore("recurrence"),data:{interval:i},transaction:n}),G({environment:t,transaction:n,automationStore:o,currentSprintBlockStore:r})}function z(e){const{environment:t,automationStore:o,transaction:n,newWeekday:i,currentSprintBlockStore:r}=e;A().sW({store:o.getTriggerStore().getKeyStore("recurrence"),data:{weekdays:[i]},transaction:n}),G({environment:t,transaction:n,automationStore:o,currentSprintBlockStore:r})}function q(e){const{environment:t,actionStore:o,automationStore:n,transaction:i,newAutocompleteStatus:r,currentSprintBlockStore:s}=e;A().sW({store:n,data:{status:r?"active":"disabled"},transaction:i}),G({environment:t,transaction:i,automationStore:n,currentSprintBlockStore:s});const l=n.getParentPointer();if(!l||l.table!==h().vF)return;const c=(0,M().mc)(t),d={automation_id:n.id,automation_actions:[{automation_action_id:o.id,type:"complete_sprint"}],automation_triggers:[{type:"recurrence"}],collection_id:l.id};r?(0,a().Rt)(c,d):(0,a().ai)(c,d)}function G(e){const{automationStore:t,currentSprintBlockStore:o,transaction:i,environment:a}=e;if(!t.isActive())return;const s=t.getRecurrence();if(!s)return;const c=(0,v().Su)(s);if(!c)return;const d=o.getPropertyValue(r().b0.Dates);if(!d)return;const u=(0,b().nai)(d)[0];if(!u||"daterange"!==u.type)return;const p=u.start_date,{start_date:g,end_date:m}=(0,v().DW)({currentSprintStartDate:p,sprintSchedule:c});A().sW({store:t.getTriggerStore().getKeyStore("recurrence"),data:{start_date:(0,l().Jh)(n().ou.fromISO(g).plus({minutes:1}).toJSDate())},transaction:i}),R().xD({store:o,propertyId:r().b0.Dates,transaction:i,environment:a,type:"dateValue",dateValue:{type:"daterange",start_date:p,end_date:m}})}function Q(e){const{transaction:t,newRemainingTasksBehavior:o,actionStore:n}=e;A().sW({store:n.getConfigStore(),data:{complete_sprint_action:o},transaction:t})}async function $(e){var t;const{appTemplatesSetupActions:o,appTemplatesSprintBoardActions:n,appConfigs:a}=await _().vF.load(),{environment:s,collectionContextStore:l,from:c}=e,{currentSpaceViewStore:d}=j().default.state,u=l.collectionStore(),p=null==u?void 0:u.getParentBlockStore(),g=null==p?void 0:p.getParentStore(),h=null==u||null===(t=u.getFormat())||void 0===t?void 0:t.app_config_uri,S=h&&(0,x().YB)(a(),h);if(!u||!p||!g||!d||g.table!==f().bx&&g.table!==m().iU&&g.table!==y().e0||!S)return;const v=p.getFormat().app_id,b=v?await B().callApi({eventName:"getCollectionViewBlocksByAppId",environment:s,data:{spaceId:p.getSpaceId(),appId:v}}):void 0,P="success"===(null==b?void 0:b.type)&&b.data.result.length?b.data.result.map((e=>T().G.createChildStore(g,{table:m().iU,id:e.blockId,spaceId:p.getSpaceId()}))):[p];await oe({environment:s,taskCollectionStore:u,executeFn:()=>{const e=H().createAndCommit({userAction:"sprintSettingsActions.handleTurnOnSprints",environment:s,canUndo:!0,perform:e=>{const t=(0,C().eu)(),i=o.applyTypedFeatures({environment:s,spaceViewStore:d,appParentStore:g,appUri:S.uri,features:[{type:"simple",featureUri:t.uri}],transaction:e,createOrModify:"modify",appCollectionViewBlockStores:P}),a=n.createSprintPage({environment:s,spaceViewStore:d,appParentStore:g,transaction:e,blockStores:i,creationEntryPoint:{type:"sprint_settings"}});if(V().E3({collectionSettingsStore:l.settingsStore}),!a)return;const u=c?{feature:{id:r().Es.TaskToSprintRelation,from:c,type:"notion://projects/tasks_with_sprints_feature"}}:{};return L()._H({environment:s,collectionContextStore:l,from:"view_settings",property:r().Es.TaskToSprintRelation,property_type:"relation",is_suggested_property:!0,...u}),a}});e.serverCommitResult.then((()=>{const t=e.performResult;t&&F().r({environment:s,store:t,pageVisitSource:i().tY.Create})}))}})}async function Y(e){const{environment:t,collectionContextStore:o,sprintSettingsContext:n,sprintBoardViewBlockIds:a}=e,{sprintCollectionStore:s,automationContext:l,currentCollectionViewBlockStore:c,sprintCollectionViewBlockStore:d,taskCollectionStore:u,taskCollectionViewBlockStore:p}=n;if(!s||!d||!l)return;const g=p.getSpaceId(),h=[d,...a.map((e=>new(T().G)(t,{id:e,table:m().iU,spaceId:g})))];c.id===p.id?V().E3({collectionSettingsStore:o.settingsStore}):F().r({environment:t,store:p,pageVisitSource:i().tY.LeaveOrRemove});const{automationActions:f}=await P().Sm.automations.load(),{automationStore:y}=l;await oe({environment:t,taskCollectionStore:u,executeFn:()=>{H().createAndCommit({userAction:"sprintSettingsActions.handleTurnOffSprints",environment:t,canUndo:!0,perform:e=>{!function(e){const{transaction:t,blocksToDelete:o,environment:n,taskCollectionStore:i,sprintCollectionStore:a}=e;A().sW({store:a,transaction:t,data:{alive:!1}}),D().E2({environment:n,collectionStore:i,schema:i.getSchema(),property:r().Es.TaskToSprintRelation,transaction:t,permanentlyDelete:!0}),U().y8({environment:n,blocks:o,transaction:t,permanentlyDelete:!0})}({environment:t,transaction:e,blocksToDelete:h,sprintCollectionStore:s,taskCollectionStore:u}),f.disableAutomation({automationStore:y,environment:t,transaction:e}),f.deleteAutomation({automationStore:y,environment:t,transaction:e})}}),L().y9({environment:t,collectionContextStore:o,property_type:"relation",from:"view_settings",property:r().Es.TaskToSprintRelation})}})}function X(e){const{environment:t,userSettingsStore:o}=e;H().createAndCommit({userAction:"sprintSettingsActions.handleSeenSprintsEngagementBanner",environment:t,canUndo:!0,perform:e=>{E().d2({userSettingsStore:o,data:{seen_sprint_settings_engagement_banner:!0},transaction:e})}})}function J(e){e.settingsStore.setState({open:!0,stack:[{type:"main"},{type:"sprintSettings"}]})}function ee(e){const{environment:t,collectionContextStore:o,currentViewBlockStore:n,taskCollectionViewBlockStore:i}=e,a=o.collectionViewStore();if(!a)return;const s=a.getFormat(),l=a.getRawQuery();H().createAndCommit({userAction:"sprintSettingsActions.handleManageSprintFromThisView",environment:t,canUndo:!0,perform:e=>{if((0,k().i)({collectionViewStore:a,transaction:e,update:{name:I().Z.formatMessage(C().sY.tasksCurrentSprintV2ViewName),query2:{...l,filter:void 0},format:{...s,collection_view_icon:"/icons/playback-play-button_gray.svg",property_filters:C().Jt,app_config_uri:r().g3,hide_linked_collection_name:!0}}}),n.id===i.id){var t;const o=(null===(t=n.getFormat())||void 0===t?void 0:t.app_uri_map)??{},l=s.app_config_uri;l&&delete o[l],Z().FH({stores:[i],update:{app_uri_map:{...o,[r().g3]:a.id}},transaction:e})}}})}function te(e){const{environment:t,sprintSettingsContext:o}=e;if(!o)return;const n=o.sprintCollectionStore,i=(null==n?void 0:n.getRole())??"none";n&&(0,u().yY)(i,"editor")&&o.automationContextLoaded&&!o.automationContext&&H().createAndCommit({userAction:"sprintSettingsActions.ensureCompleteSprintAutomation",environment:t,canUndo:!0,perform:e=>{W({environment:t,transaction:e,sprintCollectionStore:n,taskCollectionStore:o.taskCollectionStore,sprintSettingsConfig:S().iZ})}})}async function oe(e){const{executeFn:t,environment:o,taskCollectionStore:n}=e;await async function(e){var t;const{environment:o,taskCollectionStore:n}=e,i=n.getFormat().app_uri_map,a=r().Es.TaskToSprintRelation,l=n.getSchema(),c=(null==i?void 0:i[a])??a,d=l[c];if(!d||!(0,s().p_)(d))return;const u=null===(t=(0,s().j0)(d))||void 0===t?void 0:t.id;if(!u)return;const p=new Set([c]);Object.entries(l).forEach((e=>{var t;let[o,n]=e;n&&(0,s().p_)(n)&&(null===(t=(0,s().j0)(n))||void 0===t?void 0:t.id)===u&&p.add(o)}));const{serverCommitResult:g}=H().createAndCommit({userAction:"sprintSettingsActions.clearSprintRelationDataFromTaskCollection",environment:o,canUndo:!0,perform:e=>{for(const t of p)D().E2({environment:o,transaction:e,permanentlyDelete:!0,collectionStore:n,schema:l,property:t});null==i||delete i[a],i&&Z().FH({stores:[n],transaction:e,update:{app_uri_map:i}})}});await g}({environment:o,taskCollectionStore:n}),t()}function ne(e){return{frequency:O,interval:e.recurrenceConfig.interval,weekdays:e.recurrenceConfig.weekdays,start_date:(0,l().Jh)(n().ou.local().set({hour:0,minute:0,second:0,millisecond:0}).toJSDate()),timezone:(0,c().Sv)(),hour:0,minute:0}}},23151:(e,t,o)=>{o.d(t,{Fv:()=>w,JN:()=>P,QG:()=>j,cQ:()=>M,f$:()=>R,fX:()=>_,td:()=>k,xD:()=>I});o(670560),o(267602),o(30005),o(241792);var n=()=>o(730120),i=()=>o(552221),r=()=>o(532850),a=()=>o(803021),s=()=>o(874459),l=()=>o(998411),c=()=>o(752778),d=()=>o(513670),u=()=>o(696459),p=()=>o(250303),g=()=>o(384667),m=()=>o(366257),h=()=>o(332542),f=()=>o(636340),y=()=>o(970105),S=()=>o(887430),v=()=>o(32969),b=()=>o(35982),C=()=>o(826955),x=()=>o(526243);function P(e){const{environment:t,droppedStores:o,duplicate:r,calendarBy:d,transaction:u,collectionContextStore:m}=e,f=n().ou.fromMillis(e.startOfDay);let y=!0;for(const n of o){const t=e.collectionStore?e.collectionStore:(0,S().Bm)({store:n,collectionContextStore:m});if(n.getParentTable()===c().vF||!t){y=!1;break}h().zw({childStore:n,parentStore:t,transaction:u})||(y=!1)}const v=g().Ab({environment:t,droppedStores:o,duplicate:r,transaction:u,collectionStore:e.collectionStore});for(const n of v){const o=e.collectionStore?e.collectionStore:(0,S().Bm)({store:n,collectionContextStore:m});if(!o)continue;const r=o.getMappedProperty(d),c=n.getPropertyStore(r),h=(0,i().G)(c.getValue())||s().Lg((0,l().r)()),v=s().c$(h,(0,l().r)()),b=f.toFormat(s().Iq);let C;if("date"===v.type||"datetime"===v.type)C={...v,start_date:b};else{const e=s().NK(v,(0,l().r)());if(!e.end)return;const t={...v,start_date:b},o=s().NK(t,(0,l().r)()).start.diff(e.start,"days"),n=e.end.plus(o).toFormat(s().Iq);C={...v,start_date:b,end_date:n}}const x=s().c$(C,a().yw(h)||(0,l().r)());g().mp({environment:t,store:n,collectionStore:o,collectionContextStore:m,shouldCoerce:!0,groupsPointer:[],transaction:u,alreadyMovedToCollection:y}),I({environment:t,type:"dateValue",propertyId:r,store:n,transaction:u,dateValue:x}),p().rv({environment:t,collectionContextStore:m,block_id:n.id,property:r,property_type:"date",from:"calendar"})}}function R(e){const{calendarStore:t,direction:o,targetStore:n}=e;t.setState({...t.state,isDragging:!0,targetStore:n,direction:o,temporaryValue:void 0})}function k(e){const{calendarStore:t,x:o,y:r,calendarBy:c}=e,u=t.state;if(u.isDragging){const e=(0,i().G)(u.targetStore.getPropertyStore(c).getValue());if(!e)return;const p=s().c$(e,(0,l().r)()),g=u.temporaryValue||e,m=s().c$(g,(0,l().r)()),h=[];u.dayStoreMap.forEach(((e,t)=>{h.push({store:e,timestamp:t})}));const f=h.find((e=>{let{store:t}=e;const n=v().C.getRectFromStore(t);return Boolean(n&&b().uh(n,o,r))}));let y;if(f){const e=n().ou.fromMillis(f.timestamp),t=e.endOf("day"),o=e.toFormat(s().Iq);if(p){const i=s().NK(p,(0,l().r)());if(u.direction===x().to.Left)if(n().Xp.fromDateTimes(e,t).contains(i.start))y=p;else{let e;e="datetimerange"===p.type||"daterange"===p.type?{...p,start_date:o,end_date:p.end_date}:"datetime"===p.type?{type:"datetimerange",start_date:o,start_time:p.start_time,end_date:p.start_date,end_time:p.start_time,time_zone:p.time_zone,reminder:p.reminder}:{type:"daterange",start_date:o,end_date:p.start_date,reminder:p.reminder};const t=s().NK(e,(0,l().r)());y=!i.end&&t.start>i.start||i.end&&t.start>i.end?m:e}else if(i.end?n().Xp.fromDateTimes(e,t).contains(i.end):n().Xp.fromDateTimes(e,t).contains(i.start))y=p;else{let e;e="date"===p.type?{...p,type:"daterange",end_date:o}:"datetime"===p.type?{...p,type:"datetimerange",end_date:o,end_time:"00:00"}:{...p,end_date:o};const t=s().NK(e,(0,l().r)());y=t.end&&t.end<t.start?m:e}}}if(y&&!d().Xy(m,y)){const e=s().c$(y,a().yw(g)||(0,l().r)());t.setState({...u,temporaryValue:e})}}}function _(e){const{environment:t,calendarStore:o,calendarBy:n,transaction:i}=e,r=o.state;r.isDragging&&r.temporaryValue&&(I({type:"dateValue",environment:t,dateValue:r.temporaryValue,propertyId:n,store:r.targetStore,transaction:i}),o.setState({...o.state,isDragging:!1}))}function M(e){const{calendarStore:t}=e,o=t.state;o.isDragging&&t.setState({...o,isDragging:!1})}function w(e){const{environment:t,store:o,collectionStore:i,collectionContextStore:a,startDayOfWeek:c,transaction:d}=e,u=a.dateRangeStartStore.state,p=(0,l().r)(),m=a.normalizedQueryStore.state;if(!m||!m.calendar_by)return;const h=(null==i?void 0:i.getMappedProperty(m.calendar_by))??m.calendar_by,y=s().gQ(u,c,p),S=y.startOf("month"),v=y.endOf("month"),b=n().ou.now().startOf("day");let C;return C=n().Xp.fromDateTimes(S,v).contains(b)?s().hT(b.valueOf(),p):s().hT(s().em(u,c,p).valueOf(),p),f().sW({store:o.getPropertiesStore(),data:{[h]:r().d7(C)},transaction:d}),g().mp({environment:t,store:o,collectionStore:i,collectionContextStore:a,shouldCoerce:!0,groupsPointer:[],transaction:d}),o}function I(e){const{environment:t,store:o,propertyId:n,transaction:i}=e;let a;"timestamp"===e.type?a=s().hT(e.timestampMs.valueOf(),(0,l().r)()):"dateValue"===e.type?a=e.dateValue:(0,u().t1)(e);const c=o.getPropertyValue(n),d=r().d7(a);f().sW({store:o.getPropertiesStore(),data:{[n]:d},transaction:i}),m().H({environment:t,store:o,dateProperty:{id:n,oldValue:c,newValue:d}})}function j(e){const{environment:t,collectionStore:o,calendarBy:n,store:i,insertStores:r,collectionContextStore:a,transaction:s}=e,l=i.getPropertyStore(n).getValue();for(const c of r)g().mp({environment:t,store:c,collectionStore:o,collectionContextStore:a,shouldCoerce:!0,groupsPointer:[],transaction:s}),y().sO({environment:t,store:c.getPropertyStore(n),value:l,transaction:s});return r.map((e=>C().G.createChildStore(o,e.pointer)))}},491925:(e,t,o)=>{o.d(t,{Ty:()=>l,hW:()=>a,nI:()=>s,vp:()=>c});o(267602),o(653476),o(241792);var n=()=>o(142735),i=()=>o(696459),r=()=>o(469753);const a=(0,o(788860).vU)({unsupportedPublicQuestionType:{defaultMessage:"This question type cannot be used in public forms.",id:"useNewQuestionPropertyMenuItems.invalidPublicQuestionType"},relatedCollectionNotPublic:{defaultMessage:"Only relations to public databases are supported in public forms.",id:"formEditorQuestion.relatedCollectionNotPublic"},editorPlaceholder:{defaultMessage:"Respondent's answer",id:"formEditorQuestion.editorPlaceholder"},viewerEmptyPlaceholder:{defaultMessage:"Your answer",id:"formEditorQuestion.viewerEmptyPlaceholder"}});function s(e){let{layoutStore:t,collectionStore:o}=e;const a=(0,n().VK)((()=>t.getFormQuestionsForFormLayout()??[]),[t]),s=(0,n().VK)((()=>a.map((e=>{var t;return null===(t=e.getConfig())||void 0===t?void 0:t.propertyId})).filter(i().$K)),[a]);return(0,n().VK)((()=>{if(!o)return[];const e=o.getSchema();if(!t.getModel())return[];return(0,i().qP)(e).map((e=>{let[t,o]=e;if(o&&(0,r().I0)(o)&&!s.includes(t))return t})).filter(i().$K)}),[o,t,s])}function l(e){const t=e.type;return["person","relation","multi_select"].includes(t)}function c(e,t){var o;if(!e||!l(e))return;const n=e.type,i=null==t||null===(o=t.getPropertyTypeSpecificConfig(n))||void 0===o?void 0:o.maxSelectionCount;if("multi_select"===e.type)return i;const r=e.limit;return void 0===i?r:void 0===r||i<r?i:r}},675334:(e,t,o)=>{o.d(t,{Z:()=>d});o(667294);var n=()=>o(219727),i=()=>o(846550),r=()=>o(714230),a=()=>o(788860),s=()=>o(707513),l=()=>o(396439),c=o(785893);function d(e){const t=(0,a().YB)(),o=function(e){const{isMobile:t}=(0,n().Fy)(),o=t?18:14,r=1,a=6,l=20;return(0,i().yK)((t=>({githubContainer:{display:"flex",alignSelf:"center",flexDirection:"column",width:e||"90%",padding:l,border:`${r}px solid ${t.tableDividerColor}`,borderRadius:a,borderBottomRightRadius:6,cursor:"default"},githubPrTitleRow:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",width:`calc(100% + ${l}px)`,overflow:"hidden"},githubPrTitle:{display:"inline-flex",fontSize:o,fontWeight:500,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",background:t.whiteButtonBackground,padding:"2px 4px",borderTopLeftRadius:5,borderBottomLeftRadius:5,borderLeft:`2px solid ${t.blueColor}`,borderTop:`2px solid ${t.blueColor}`,borderBottom:`2px solid ${t.blueColor}`,width:"100%"},githubTask:{background:"light"===t.mode?t.accentColors.blue[50]:t.accentColors.blue[400]},githubPrInfoRow:{display:"inline-flex"},githubPrInfoPill:{display:"flex",flexDirection:"row",alignItems:"center",width:"fit-content",padding:"4px 10px",borderRadius:"2em",background:"#238636",flexShrink:0,...s().Yu},githubPrInfoOpenText:{color:"white",fontSize:o-2,fontWeight:500},githubPrInfoMergeInto:{display:"inline-flex",alignItems:"center",fontSize:o-2,color:t.lightTextColor,...s().Yu},githubPrInfoMain:{padding:"0px 4px",fontFamily:s().Gl.githubMono,background:t.cardPressedBackground,borderRadius:a,color:t.regularTextColor,verticalAlign:"text-bottom",...s().Yu}})),[o,e])}(e.width),d=(0,c.jsx)("div",{id:"github-preview-github-pr-title-row",style:o.githubPrTitleRow,children:(0,c.jsxs)("div",{id:"github-preview-github-pr-title-wrapper",style:o.githubPrTitle,children:[(0,c.jsx)(l().Z,{size:2}),"[",(0,c.jsxs)("div",{id:"github-preview-github-pr-task",style:o.githubTask,children:[e.uniqueIdPrefix||t.formatMessage(u.idPrefix),e.uniqueIdValue?`-${e.uniqueIdValue}`:"-1"]}),"]",(0,c.jsx)(l().Z,{size:2}),t.formatMessage(u.prTitle)]})}),p=(0,c.jsxs)("div",{id:"github-preview-github-pr-info-row",style:o.githubPrInfoRow,children:[(0,c.jsxs)("div",{id:"github-preview-github-open-pr-pill",style:o.githubPrInfoPill,children:[(0,c.jsx)("img",{src:r().Z.images.externalIntegrations.githubPullOpenIconWhitePng,style:{width:16,height:16}}),(0,c.jsx)(l().Z,{size:2}),(0,c.jsx)("div",{style:o.githubPrInfoOpenText,children:t.formatMessage(u.open)})]}),(0,c.jsx)(l().Z,{size:8}),(0,c.jsx)("div",{id:"github-preview-github-merge-into-main",style:o.githubPrInfoMergeInto,children:(0,c.jsxs)("span",{style:o.githubPrInfoMergeInto,children:[t.formatMessage(u.mergeInto),(0,c.jsx)(l().Z,{size:4}),(0,c.jsx)("span",{style:o.githubPrInfoMain,children:t.formatMessage(u.main)})]})})]});return(0,c.jsxs)("div",{id:"github-preview-github-container",style:o.githubContainer,children:[d,(0,c.jsx)(l().Z,{size:12}),p]})}const u=(0,a().vU)({dismissButtonAriaLabel:{defaultMessage:"A button to dismiss the user education preview.",id:"database.viewSettings.githubConfigTab.preview.dismissButtonAriaLabel"},idPrefix:{defaultMessage:"TASK",id:"database.viewSettings.githubConfigTab.preview.idPrefix"},prTitle:{defaultMessage:"GitHub PR Title",id:"database.viewSettings.githubConfigTab.preview.prTitle"},open:{defaultMessage:"Open",id:"database.viewSettings.githubConfigTab.preview.open"},mergeInto:{defaultMessage:"Merge into",id:"database.viewSettings.githubConfigTab.preview.mergeInto"},main:{defaultMessage:"main",id:"database.viewSettings.githubConfigTab.preview.main"}})},632599:(e,t,o)=>{o.d(t,{Z:()=>l});var n=o(667294),i=()=>o(846550),r=()=>o(729201),a=()=>o(312578),s=o(785893);function l(e){let{loadingMessage:t}=e;const o=(0,i().Fg)(),l=(0,r().Z)(!0,400);return(0,s.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:l&&(0,s.jsxs)(n.Fragment,{children:[(0,s.jsx)(a().Z,{}),t&&(0,s.jsx)("div",{style:{marginLeft:8,color:o.text.secondary},children:t})]})})}},178498:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(667294),i=o(785893);function r(e,t){return(0,i.jsx)(o(18748).ZP,{...e,ref:t,style:{background:"none",borderBottom:"none",boxShadow:"",marginTop:2,marginBottom:6,paddingTop:4,paddingBottom:4,minHeight:"none",...e.style}})}const a=(0,n.forwardRef)(r)},249392:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(667294),i=o(785893);function r(e){const{pageName:t,targetCollectionStore:n,...r}=e,a=(0,o(219727).Fy)(),s=(0,o(142735).VK)((()=>n.getIcon()),[n]),l=(0,o(846550).yK)((e=>({medium:{color:e.mediumTextColor},dbName:{display:"flex",alignItems:"center",marginLeft:4},title:{marginLeft:o(820748).Qi*(a.isRetina?.5:1)},icon:{width:16,fill:e.mediumIconColor}})),[a.isRetina]),c=(0,i.jsxs)("div",{style:l.dbName,children:[(0,i.jsx)(o(943620).Z,{disabled:!0,icon:s,isEmptyPage:!1,size:a.isMobile?24:20}),(0,i.jsx)(o(384241).Z,{store:n,style:l.title})]});return(0,i.jsx)(o(827973).Z,{title:(0,i.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,i.jsx)(o(788860)._H,{id:"database.searchRelation.createNewPageFooter",defaultMessage:"<medium>New</medium> {pageName} <medium> in</medium> {databaseNameWithIcon}",values:{medium:e=>(0,i.jsx)("span",{style:l.medium,children:e}),pageName:(0,i.jsx)("span",{style:{marginLeft:4,marginRight:4},children:t}),databaseNameWithIcon:c}})}),icon:(0,o(159732).R)(l.icon),...r})}const a=n.memo(r)},233405:(e,t,o)=>{o.d(t,{Z:()=>i});o(667294);var n=o(785893);const i=function(e){const{style:t}=(0,o(846550).yK)((t=>({style:{display:"inline-block",textAlign:"center",color:e.disabled?t.lightTextColor:t.mediumTextColor,userSelect:"none",WebkitUserSelect:"none",width:8,...e.style}})),[e.disabled,e.style]);return(0,n.jsx)("div",{style:t,children:"·"})}},497459:(e,t,o)=>{o.d(t,{Z:()=>i});o(667294);var n=o(785893);const i=function(){return(0,n.jsx)(o(18748).ZP,{title:(0,n.jsx)(o(312578).Z,{})})}},972544:(e,t,o)=>{o.d(t,{S:()=>r,Z:()=>s});var n=o(667294),i=o(785893);const r=8;function a(e,t){let{isSelected:n}=e;const{radioButtonStyle:a,dotStyle:s}=(0,o(846550).yK)((e=>({radioButtonStyle:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:16,height:16,borderRadius:16,marginRight:r,background:n?e.blueColor:e.whiteButtonBackground,border:n?"none":`1px solid ${e.radioButtonBorder}`,transition:"background 100ms ease-out"},dotStyle:{width:6,height:6,borderRadius:6,background:e.regularInvertedTextColor,transition:"opacity 100ms ease-out",opacity:n?1:0}})),[n]);return(0,i.jsx)("div",{ref:t,style:a,children:(0,i.jsx)("div",{style:s})})}const s=n.forwardRef(a)},903639:(e,t,o)=>{o.d(t,{default:()=>w});o(267602),o(653476),o(470928),o(241792);var n=o(667294),i=()=>o(219727),r=()=>o(142735),a=()=>o(846550),s=()=>o(766933),l=()=>o(94250),c=()=>o(717956),d=()=>o(788860),u=()=>o(513670),p=()=>o(707513),g=()=>o(917881),m=()=>o(421654),h=()=>o(269299),f=()=>o(352230),y=()=>o(129338),S=()=>o(998901),v=()=>o(178498),b=()=>o(356321),C=()=>o(827973),x=()=>o(119891),P=()=>o(1910),R=()=>o(198829),k=()=>o(255577),_=()=>o(388284),M=o(785893);const w=function(e){let{collectionStore:t,targetCollectionStore:s,property:l,disabled:c,rowType:u}=e;const p=(0,a().Fg)(),g=(0,i().O7)(),m=(0,r().qz)(void 0,o(692304).Z),{format:h}=(0,n.useContext)(o(459217).m),f=(0,r().VK)((()=>{const e=y().U1({collectionStore:t,property:l}),o=Object.keys(s.getSchema()).map((t=>e.find((e=>e.property===t))??{property:t,visible:!1})),n=e.map((e=>e.property)),i=e=>{const t=n.indexOf(e);return-1!==t?t:1/0};return o.sort(((e,t)=>i(e.property)-i(t.property))),o}),[t,s,l]),v=(0,n.useCallback)((e=>(0,M.jsx)(L,{parent:e,collectionStore:t,property:l,disabled:c,targetCollectionStore:s,menuListStore:m,allRelatedTargetProperties:f})),[t,l,c,s,m,f]);return(0,i().MO)()&&"section"!==u||h===b().C.FormEditor||h===b().C.FormViewer?null:(0,M.jsx)(o(654133).Z,{renderTooltip:()=>(0,M.jsx)(d()._H,{id:"database.RelationCustomizeLayoutMenu.tooltip.button.message",defaultMessage:"Customize shown properties"}),placement:"section"===u?S().Placement.Top:S().Placement.Right,render:e=>(0,M.jsx)(o(448419).ZP,{popupType:o(967092).kQ.Popup,alignmentToOrigin:S().Alignment.Start,...e,renderOrigin:t=>(0,M.jsx)(P().Z,{icon:o(641772).o,iconStyle:{width:16,color:p.mediumIconColor,fill:p.mediumIconColor},...t,...e}),onClick:()=>{o(491927).gP(g,{from:"section"===u?"relation_section":"configure_relation_modal"})},originGap:16,render:v})})};function I(e){const{props:t,children:o}=e;return(0,M.jsx)(_().Z,{...t,noTextOverflow:!0,isTitleUppercase:!1,title:(0,M.jsx)(d()._H,{defaultMessage:"Hidden in relation",id:"database.relationMenu.hiddenInRelationTitle"}),desktopTitleStyle:{height:19},children:o,disableDesktopPadding:!0})}function j(e,t,o,n,i,r,a){const{properties:d,visibility:m}=e;return u().oA(d.map((e=>function(e,t,o,n,i,r,a){const{propertyFormat:d,visibility:u}=e,m=!u,h=i.getSchema();if(!h)return;const f=h[d.property];return f?{key:d.property,render:e=>(0,M.jsx)(C().Z,{...e,showDragHandle:!a,title:(0,M.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,M.jsx)(s().ZP,{icon:f.icon,type:f.type,size:16,theme:o,style:{fill:o.regularIconColor}}),(0,M.jsx)("span",{style:{marginLeft:8,...p().Yu},children:f.name})]}),right:(0,M.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,M.jsx)(P().Z,{icon:m?c().B:l().c,iconStyle:{width:16,height:16},isDarkIconColor:!m,onClick:()=>{g().qK({propertyFormat:d,visibility:u,collectionStore:n,property:r,environment:t})},disabled:a||"title"===d.property})})}),action:()=>{}}:void 0}({propertyFormat:e,visibility:m},t,o,n,i,r,a))))}function T(e){const t=(0,i().O7)(),{collectionStore:o,property:n,menuListStore:r,disabled:a,visibleProperties:s,hiddenProperties:l,children:c}=e,d=u().oA([...s.map((e=>e.property)),s.length>0&&l.length>0&&{key:"group-header-hidden-property",draggable:!1},...l.map((e=>e.property))]);return(0,M.jsx)(x().ZP,{direction:"vertical",keys:d,renderKey:(e,t)=>c[t],onDrop:e=>{!function(e,t,o,n,i){const{newPropertyKeys:r}=e,a=y().U1({collectionStore:o,property:n}),s=r.indexOf("group-header-hidden-property"),l=u().oA(r.filter((e=>!e.startsWith("group-header-"))).map(((e,t)=>{const o=a.find((t=>t.property===e));return o?s>0?"title"===e&&t>=s?o:{...o,visible:Boolean(t<s)}:o:{property:e,visible:!(s>0)||Boolean(t<s)}}))),c=a.filter((e=>!r.includes(e.property))),d={...y().ZI(o)};d[n]||(d[n]={}),d[n].related_properties=[...l,...c],h().createAndCommit({userAction:"RelationPropertyCustomizeLayoutMenu.handlePropertyReorder",environment:t,canUndo:!0,perform:e=>{m().FH({stores:[o],update:{collection_relation_options:d},transaction:e})}}),i.reset()}({newPropertyKeys:e},t,o,n,r)},disabled:a})}function L(e){let{parent:t,collectionStore:o,property:n,disabled:s,targetCollectionStore:l,menuListStore:c,allRelatedTargetProperties:p}=e;const g=(0,a().Fg)(),m=(0,i().O7)(),h=p.filter((e=>e.visible)),y=p.filter((e=>!e.visible)),S=(0,r().VK)((()=>j({properties:h,visibility:!0},m,g,o,l,n,s)),[h,m,g,o,l,n,s]),b=(0,r().VK)((()=>j({properties:y,visibility:!1},m,g,o,l,n,s)),[y,m,g,o,l,n,s]);return p?(0,M.jsxs)(R().Z,{menuType:f().o.Popup,maxWidth:240,maxHeight:500,children:[0===p.length&&(0,M.jsx)(_().Z,{children:(0,M.jsx)(v().Z,{caption:(0,M.jsx)(d()._H,{defaultMessage:"No properties",id:"database.relationMenu.noProperties"})})}),p.length>0&&(0,M.jsx)(k().ZP,{type:k().iW.Vertical,store:c,initialFocus:void 0,sections:u().oA([h.length>0&&{key:"visible_and_hidden_properties",render:e=>(0,M.jsx)(_().Z,{...e,noTextOverflow:!0,isTitleUppercase:!1,title:(0,M.jsx)(d()._H,{defaultMessage:"Shown in relation",id:"database.relationMenu.shownInRelationTitle"}),desktopTitleStyle:{height:18},children:(0,M.jsx)(T,{collectionStore:o,property:n,disabled:s,menuListStore:c,visibleProperties:h,hiddenProperties:y,children:e.children})}),items:u().oA([...S,y.length>0&&{key:"group-header-hidden-property",render:e=>(0,M.jsx)(I,{props:e,children:(0,M.jsx)(M.Fragment,{})}),action:()=>{}},...b])},0===h.length&&y.length>0&&{key:"hidden_properties",render:e=>(0,M.jsx)(I,{props:e,children:(0,M.jsx)(T,{collectionStore:o,property:n,disabled:s,menuListStore:c,visibleProperties:h,hiddenProperties:y,children:e.children})}),items:b}])})]}):null}},877807:(e,t,o)=>{o.d(t,{mX:()=>y,mo:()=>h,nH:()=>f});o(241792),o(667294);var n=()=>o(142735),i=()=>o(846550),r=()=>o(933868),a=()=>o(788860),s=()=>o(696459),l=()=>o(707513),c=()=>o(779733),d=()=>o(520849),u=()=>o(876822),p=()=>o(842574),g=()=>o(104014),m=o(785893);function h(e){const{openState:t}=e,{mainEditorCurrentBlockStore:o,currentSpaceStore:r}=(0,n().VK)((()=>{const{mainEditorCurrentBlockStore:e,currentSpaceStore:t}=u().default.state;return{mainEditorCurrentBlockStore:e,currentSpaceStore:t}}),[]),a=(0,n().VK)((()=>(0,c().wZ)()),[]),s=(0,i().yK)((e=>({scroller:{display:"flex",flexDirection:"column",maxHeight:290,...a?{border:`1px solid ${e.lightDividerColor}`,borderRadius:6,paddingTop:8,paddingLeft:12,paddingRight:12,paddingBottom:12,marginTop:15,marginBottom:5,marginLeft:-12,marginRight:-12}:{}},editContainer:{marginTop:2,marginBottom:2,color:e.regularTextColor}})),[a]);if(!o||!r)return null;const l=Date.now();return(0,m.jsx)(p().T,{type:d().Z.Y,style:s.scroller,children:t.permissionChanges.map(((e,t)=>{let[n,i]=e;const a={timestamp:l,space_id:r.id,type:"permission-changed",permission_data:{before:n,after:i}};return(0,m.jsx)("div",{style:s.editContainer,children:(0,m.jsx)(g().Z,{rootStore:o,edit:a})},`${n.type}-${t}`)}))})}function f(e,t){return["remove","restrict"].includes(e.type)?t?(0,m.jsx)(a()._H,{id:"restrictedPermissionConfirmationModal.actionButton.restrictAccessV2",defaultMessage:"Change and unlink"}):(0,m.jsx)(a()._H,{id:"restrictedPermissionConfirmationModal.actionButton.restrictAccess",defaultMessage:"Restrict access"}):t?(0,m.jsx)(a()._H,{id:"restrictedPermissionConfirmationModal.actionButton.relink",defaultMessage:"Relink"}):"restoreTeamPermissions"===e.type?(0,m.jsx)(a()._H,{id:"restrictedPermissionConfirmationModal.actionButton.restoreTeamPermissions",defaultMessage:"Reset Permissions"}):(0,m.jsx)(a()._H,{id:"restrictedPermissionConfirmationModal.actionButton.restoreAccess",defaultMessage:"Restore access"})}function y(e,t){switch(e.type){case"remove":return t?(0,m.jsx)(a()._H,{id:"restrictedPermissionConfirmationModal.remove.descriptionV2",defaultMessage:"Change access and unlink share settings from parent page?"}):(0,m.jsx)(a()._H,{id:"restrictedPermissionConfirmationModal.restrict.description",defaultMessage:"Are you sure you want to remove this {permissionGroup} and restrict access? This page will no longer inherit share settings from the parent page.",values:{permissionGroup:S(e)}});case"restrict":return t?(0,m.jsx)(a()._H,{id:"restrictedPermissionConfirmationModal.remove.descriptionV2",defaultMessage:"Change access and unlink share settings from parent page?"}):(0,m.jsx)(a()._H,{id:"restrictedPermissionConfirmationModal.remove.description",defaultMessage:"Are you sure you want to change this role and restrict access? This page will no longer inherit share settings from the parent page."});case"restore":return t?(0,m.jsx)(a()._H,{id:"restrictedPermissionConfirmationModal.relink.description",defaultMessage:"Relink share settings?"}):e.permissionChanges.length>0?(0,m.jsx)(a()._H,{id:"restrictedPermissionConfirmationModal.restore.description",defaultMessage:"Are you sure you want to restore access? This will inherit the following permissions from the parent page:"}):(0,m.jsx)(a()._H,{id:"restrictedPermissionConfirmationModal.restoreNoChanges.description",defaultMessage:"Are you sure you want to restore access?"});case"restoreTeamPermissions":return t?(0,m.jsx)(a()._H,{id:"restrictedPermissionConfirmationModal.relink.description",defaultMessage:"Relink share settings?"}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{style:{fontWeight:l().Ue.semibold,marginBottom:4},children:(0,m.jsx)(a()._H,{id:"restrictedPermissionConfirmationModal.restoreTeamPermissions.mainDescription",defaultMessage:"Are you sure you want to reset permissions to match the teamspace defaults?"})}),(0,m.jsx)(a()._H,{id:"restrictedPermissionConfirmationModal.restoreTeamPermissions.warningMessage",defaultMessage:"Everyone else who is not part of the teamspace will lose access, including guests."})]});default:throw s().t1(e)}}function S(e){return(0,r().jg)(e.permissionItem)?(0,m.jsx)(a()._H,{id:"restrictedPermissionConfirmationModal.permissionGroup.user",defaultMessage:"user"}):(0,r().hV)(e.permissionItem)?(0,m.jsx)(a()._H,{id:"restrictedPermissionConfirmationModal.permissionGroup.group",defaultMessage:"group"}):(0,r().Ir)(e.permissionItem)?(0,m.jsx)(a()._H,{id:"restrictedPermissionConfirmationModal.permissionGroup.space",defaultMessage:"workspace"}):(0,m.jsx)(a()._H,{id:"restrictedPermissionConfirmationModal.permissionGroup.generic",defaultMessage:"permission"})}},504117:(e,t,o)=>{o.d(t,{Um:()=>a,ZP:()=>s,kN:()=>r});o(667294);var n=()=>o(666414),i=o(785893);function r(e){return e?18:60}function a(){return(0,i.jsx)(n().Z,{size:37})}const s=function(e){let{children:t,controlRow:n,bannerText:a,controlRowPaddingTopBottom:s,removeBoxShadow:l,contentPaddingLeftRight:c,controlRowPaddingLeftRight:d,getPaddingTopBottom:u,disableScroller:p,maxWidth:g}=e;const m=(0,o(219727).O7)(),{device:h}=m,f=u?u():h.isMobile?18:36,y=(0,o(846550).yK)((e=>({containerWithScroller:{display:"flex",flexDirection:"column",width:"100%",height:"100%",maxWidth:g??void 0,backgroundColor:e.cardContentBackground},scroller:{flexGrow:1,WebkitOverflowScrolling:"touch",transform:"translateZ(0)",paddingLeft:c??r(h.isMobile),paddingRight:c??r(h.isMobile),paddingTop:a?15:f,paddingBottom:a?22:f},controlRowWithScroller:{flexGrow:0,flexShrink:0,paddingLeft:d??r(h.isMobile),paddingRight:d??r(h.isMobile),paddingTop:s,paddingBottom:s,boxShadow:l?void 0:`0 -1px 0 ${e.regularDividerColor}`},containerWithoutScroller:{paddingLeft:r(h.isMobile),paddingRight:r(h.isMobile)},childrenWithoutScroller:{paddingTop:f,paddingBottom:f},controlRowWithoutScroller:{paddingTop:s,paddingBottom:s,boxShadow:`0 -1px 0 ${e.regularDividerColor}`}})),[g,c,h.isMobile,a,f,d,s,l]);return p?(0,i.jsxs)("div",{style:y.containerWithoutScroller,children:[(0,i.jsx)("div",{style:y.childrenWithoutScroller,children:t}),n&&(0,i.jsx)("div",{style:y.controlRowWithoutScroller,children:n})]}):(0,i.jsxs)("div",{style:y.containerWithScroller,children:[a&&(0,i.jsx)(o(610146).Z,{styleKey:o(500174).v.Blue,isMobile:!1,children:a}),(0,i.jsx)(o(842574).T,{type:o(520849).Z.All,style:y.scroller,children:t}),n&&(0,i.jsx)("div",{style:y.controlRowWithScroller,children:n})]})}},868614:(e,t,o)=>{o.d(t,{Z:()=>i});o(667294);var n=o(785893);const i=function(e){const t=(0,o(846550).Fg)(),{divider:i,large:r,block:a,children:s,hasMarginTop:l,small:c,style:d,smallMarginBottom:u,isCritical:p}=e,g="full"===i;return(0,n.jsx)("div",{style:{borderBottom:g?`1px solid ${t.regularDividerColor}`:0,marginBottom:g?16:u?2:8,marginTop:l?16:0,paddingBottom:g?12:0,fontSize:g?16:r?14:c?12:14,fontWeight:g?o(707513).Ue.medium:400,width:a?"100%":"auto",color:p?o(568017).ZP.red:t.regularTextColor,...d},children:s})}},579807:(e,t,o)=>{o.d(t,{L:()=>H,Z:()=>V});o(670560),o(267602),o(470928),o(241792);var n=o(667294),i=()=>o(219727),r=()=>o(142735),a=()=>o(846550),s=()=>o(286977),l=()=>o(374289),c=()=>o(667067),d=()=>o(788860),u=()=>o(696459),p=()=>o(844085),g=()=>o(939513),m=()=>o(352230),h=()=>o(332504),f=()=>o(439871),y=()=>o(998901),S=()=>o(965014),v=()=>o(188296),b=()=>o(265640),C=()=>o(827973),x=()=>o(448419),P=()=>o(198829),R=()=>o(18748),k=()=>o(255577),_=()=>o(661641),M=()=>o(661297),w=()=>o(388284),I=()=>o(471645),j=()=>o(667637),T=()=>o(654133),L=()=>o(504117),B=()=>o(91253),D=o(785893);function V(e){const{isMobile:t,title:o,caption:s,captionStyle:l,upsellOptions:c,type:d,shouldHighlight:u}=e,m=(0,i().O7)(),{paddingLeftCSS:b,paddingRightCSS:C}=(0,r().VK)((()=>{const{paddingLeftCSS:e,paddingRightCSS:t}=m.WindowSizeStore.state;return{paddingLeftCSS:e,paddingRightCSS:t}}),[m]),[x,P]=(0,n.useState)(!1),R=(0,n.useCallback)((()=>P(!0)),[P]),k=(0,n.useCallback)((()=>P(!1)),[P]),M=(0,n.useContext)(g().U),w=(0,n.useRef)(null);(0,n.useEffect)((()=>{u&&w.current&&p().bx({element:w.current,environment:m,scrollerContext:M,vertical:{reveal:"closest"},horizontal:void 0,animate:!0})}),[m,u,w,M]);const I="toggleToButton"===e.type?e.isOn:void 0,j="custom"===e.type?e.useFlexboxStyle:void 0,B=(0,n.useMemo)((()=>{if(t){if("dropdown"===d)return{display:"flex",flexDirection:"column"};if(I||j)return{}}return{display:"flex",alignItems:"center",justifyContent:"space-between"}}),[t,d,I,j]),V=(0,a().yK)((o=>({container:{...B,paddingLeft:t?b:void 0,paddingRight:t?C:void 0,cursor:x&&!e.disabled?"pointer":e.disabled?"not-allowed":"default",...u?{backgroundColor:o.buttonHoveredBackground,marginLeft:-1*(0,L().kN)(t),marginRight:-1*(0,L().kN)(t),paddingLeft:(0,L().kN)(t),paddingRight:(0,L().kN)(t),marginTop:-1*(0,h().f)(t)/2,marginBottom:-1*(0,h().f)(t)/2,paddingTop:(0,h().f)(t)/2,paddingBottom:(0,h().f)(t)/2}:{}},description:{display:"flex",flexDirection:"column",marginRight:"5%",width:"65%",gap:6},captionStyle:{...l},title:{display:"flex",flexDirection:"row"}})),[t,b,C,u,x,l,e.disabled,B]),A="toggle"===e.type||"toggleToButton"===e.type||"custom"===e.type&&!e.disableSettingsItemClick,F=(0,f().M)(),H=(0,f().M)(),U=(0,D.jsxs)("div",{ref:w,style:V.container,onClick:()=>{if(!(e.disabled||"custom"===e.type&&e.disableSettingsItemClick))return c&&c.shouldUpsell?S().y(m,{from:c.analyticsName,upsell:{type:"product",product:c.subscriptionTier,limit:{type:"none"}}}):void("toggle"===e.type?e.onToggle():"toggleToButton"===e.type?e.onClick():"custom"===e.type&&e.customButton&&n.isValidElement(e.customButton)&&e.customButton.props.onClick&&"function"==typeof e.customButton.props.onClick&&e.customButton.props.onClick())},onMouseEnter:A?R:void 0,onMouseLeave:A?k:void 0,children:[(0,D.jsxs)("div",{style:V.description,children:[(0,D.jsx)(_().q,{styleName:"UIRegular-14px/Regular",colorName:e.isCritical?"uiRedPrimary":"primary",children:(0,D.jsxs)("div",{id:F,style:V.title,children:[o,e.badge,c&&c.shouldUpsell&&(0,D.jsx)(v().Z,{subscriptionTier:c.subscriptionTier,analyticsName:c.analyticsName,onClick:()=>S().y(m,{from:c.analyticsName,upsell:{type:"product",product:c.subscriptionTier,limit:{type:"none"}}}),desktopStyle:{display:"flex",marginLeft:8}})]})}),(0,D.jsx)(_().q,{id:H,styleName:"UIMedium-13px/Regular",colorName:"secondary",customStyles:V.captionStyle,children:s})]}),(0,D.jsx)(Z,{titleId:F,captionId:H,...e})]});return e.tooltipLabel?(0,D.jsx)(T().Z,{placement:y().Placement.Bottom,alignment:y().Alignment.Center,disableTooltip:e.disableTooltip,renderTooltip:()=>e.tooltipLabel,render:e=>(0,D.jsx)("div",{...e,children:U})}):U}function Z(e){const{titleId:t,captionId:o}=e;if("toggle"===e.type)return(0,D.jsx)(I().Z,{"aria-labelledby":t,"aria-describedby":o,on:e.isOn,disabled:e.disabled,isLocked:e.isLocked,lockedTooltip:e.lockedTooltip});if("dropdown"===e.type)return(0,D.jsx)(H,{...e});if("custom"===e.type)return(0,D.jsx)(D.Fragment,{children:e.customButton});if("toggleToButton"===e.type)return e.isOn?(0,D.jsx)("div",{style:{marginTop:12},children:(0,D.jsx)(M().Z,{size:"lg",onClick:e.onClick,style:e.buttonStyle,disabled:e.disabled,children:e.buttonLabel})}):(0,D.jsx)(I().Z,{"aria-labelledby":t,"aria-describedby":o,on:!1,onClick:e.onClick,disabled:e.disabled});if("timezonePicker"===e.type){const{currentTimeZone:t,...o}=e;return(0,D.jsx)(B().X,{...o,currentValue:t,enableRecents:!1})}(0,u().t1)(e)}const A=12,F=4;function H(e){var t;const{title:o,isMobile:n,upsellOptions:i,currentOption:r,options:u,info:p,switcherButtons:g,onSelectOption:h,menuStyle:f,buttonStyle:S,buttonHoverStyle:v,isLocked:_,lockedTooltip:M,placementToOrigin:I}=e,L=null===(t=u.find((e=>{let{key:t}=e;return t===r})))||void 0===t?void 0:t.label,B=(0,a().yK)((e=>({button:{marginTop:A,marginBottom:F,marginRight:n?"auto":void 0,paddingLeft:n?12:8,paddingRight:n?12:8,height:n?44:28,border:n?`1px solid ${e.outlineButtonBorder}`:void 0,...S},icon:{width:10,marginLeft:4,fill:e.lightIconColor},lockedContainer:{display:"flex",alignItems:"center",justifyContent:"center"},lockedIcon:{marginTop:A,marginBottom:F,height:16,width:16,color:e.grayButtonBackground}})),[n,S]),V=Boolean(i&&i.shouldUpsell)||e.disabled||_,Z=(0,D.jsx)(x().ZP,{popupType:n?x().Z4.SlideUp:x().Z4.Popup,placementToOrigin:I??x().pO.Bottom,originGap:8,renderOrigin:e=>(0,D.jsxs)(b().D,{...e,size:"lg",style:{opacity:V?.4:1,...B.button},hoveredStyle:v,disabled:V,children:[L,(0,l().i)(B.icon)]}),render:e=>{let t;t=n?{menuType:m().o.Modal,title:o,right:(0,D.jsx)(d()._H,{defaultMessage:"Done",id:"settingItem.buttonPopup.done.label"}),onClickRight:e.close}:{menuType:m().o.Popup,width:250,maxHeight:400,...f};const i=[],r=u.map((t=>{let{key:o,label:i,caption:r}=t;return{key:o,action:()=>{h(o),e.close()},render:e=>(0,D.jsx)(C().Z,{...e,title:i,caption:r,shouldWrapCaption:!0,right:L===i?(0,D.jsx)("div",{style:{width:n?16:14},children:(0,s().e)()}):void 0})}}));if(i.push({key:"settings-item-section",render:e=>(0,D.jsx)(w().Z,{...e}),items:r}),p){const e=p.map((e=>{let{key:t,label:o}=e;return{key:t,action:()=>{},render:e=>(0,D.jsx)(R().ZP,{...e,shouldWrapCaption:!0,caption:o})}}));i.push({key:"info-item-section",render:e=>(0,D.jsx)(w().Z,{...e,topBorder:!0}),items:e})}if(g&&g.length){const e=g.map((e=>{let{key:t,props:o}=e;return{key:t,action:()=>{},render:()=>(0,D.jsx)(j().Z,{...o})}}));i.push({key:"switcher-item-section",render:e=>(0,D.jsx)(w().Z,{...e,topBorder:!0}),items:e})}return(0,D.jsx)(P().Z,{...t,children:(0,D.jsx)(k().ZP,{type:k().iW.Vertical,sections:i,initialFocus:void 0})})}});return _?(0,D.jsx)(T().Z,{placement:y().Placement.Left,alignment:y().Alignment.Start,disableTooltip:!M,renderTooltip:()=>M,render:e=>(0,D.jsxs)("div",{style:B.lockedContainer,...e,children:[(0,c().Q)(B.lockedIcon),Z]})}):Z}},29090:(e,t,o)=>{o.d(t,{Z:()=>l});o(667294);var n=()=>o(219727),i=()=>o(568017),r=()=>o(154186),a=()=>o(906651),s=o(785893);const l=function(e){let{onClick:t,disabled:n,title:i}=e;return(0,s.jsx)(o(18748).ZP,{title:(0,s.jsx)(c,{onClick:t,disabled:n,title:i})})};function c(e){let{onClick:t,disabled:o,title:l}=e;const c=(0,n().O7)(),{isMobile:d}=c.device,u={width:"100%",color:i().ZP.blue};return d?(0,s.jsx)(r().Z,{onClick:t,mobileFeedback:!0,disabled:o,style:u,children:l}):(0,s.jsx)(a().Z,{onClick:t,disabled:o,style:{width:"100%",maxWidth:300,display:"flex",margin:"auto"},children:l})}},539245:(e,t,o)=>{o.d(t,{Qr:()=>l,ZP:()=>c,pQ:()=>s});o(241792);var n=o(667294),i=()=>o(352230),r=o(785893);function a(e){let{tabs:t,selectedIndex:a,onChange:c,separatorIndexes:d,right:u,style:p,rightStyle:g,tabStyle:m,tabTitleStyle:h,selectedTabTitleStyle:f,tabBorderStyle:y,selectedTabStyle:S,readOnly:v,hideTabBorder:b,idPrefix:C}=e;const x=(0,n.useContext)(i().p),{device:P,WindowSizeStore:R}=(0,o(219727).O7)(),{safePaddingLeft:k,safePaddingRight:_}=(0,o(142735).VK)((()=>({safePaddingLeft:R.getSafePaddingLeftCSS(16),safePaddingRight:R.getSafePaddingRightCSS(16)})),[R]),M=(0,o(846550).yK)((e=>{const t={paddingTop:6,paddingBottom:6,whiteSpace:"nowrap",minWidth:0,flexShrink:0,color:e.mediumTextColor,...m},o=`inset 0 -1px 0 ${e.regularDividerColor}`,n=x.menuType===i().o.Popup,r={fontSize:16,paddingTop:2,paddingLeft:n?16:k,paddingRight:n?16:_,zIndex:2,height:44,background:e.popoverBackground};return{container:{overflowY:"visible",overflowX:"auto",display:"flex",width:"100%",position:"relative",boxShadow:b?void 0:o,...P.isMobile?r:{fontSize:14,paddingLeft:8,paddingRight:8,zIndex:1},...p},separator:{display:"inline-flex",alignItems:"center",margin:"0 4px",paddingBottom:4,whiteSpace:"nowrap",minWidth:0,flexShrink:0,color:e.regularDividerColor},mobile:{},tab:t,selectedTab:{...t,position:"relative",color:e.regularTextColor,...S},border:{borderBottom:`2px solid ${e.regularTextColor}`,position:"absolute",bottom:0,left:8,right:8,...y},rightContainer:{flexGrow:1,display:"flex",alignItems:"center",justifyContent:"flex-end",color:e.mediumTextColor,...g}}}),[x.menuType,P.isMobile,g,k,_,S,p,y,m,b]);return(0,r.jsxs)("div",{className:"hide-scrollbar",style:M.container,role:"tablist",children:[t.map(((e,t)=>{const i=t===a;return(0,r.jsxs)(n.Fragment,{children:[(0,r.jsxs)("div",{style:i?M.selectedTab:M.tab,children:[(0,r.jsx)(o(265640).D,{style:{...h,...i?f:{}},onClick:()=>c(t),disabled:v,mobileFeedback:P.isMobile,isLightGray:!Boolean(i),role:"tab","aria-selected":i,id:s(C,t),"aria-controls":l(C,t),children:e}),i&&(0,r.jsx)("div",{style:M.border})]},`tabButton-${t}`),d&&d.includes(t)&&(0,r.jsx)("div",{style:M.separator,className:"notranslate",children:"|"},`${t}-separator`)]},t)})),u&&(0,r.jsx)("div",{style:M.rightContainer,children:u})]})}function s(e,t){if(e)return`${e}-tab-${t}`}function l(e,t){if(e)return`${e}-tabpanel-${t}`}const c=n.memo(a)},743790:(e,t,o)=>{o.d(t,{Y:()=>h});o(241792),o(667294);var n=()=>o(219727),i=()=>o(142735),r=()=>o(846550),a=()=>o(801812),s=()=>o(788860),l=()=>o(707513),c=()=>o(30238),d=()=>o(824462),u=()=>o(907099),p=()=>o(876822),g=()=>o(239444),m=o(785893);function h(e){const{group:t,limit:o,noMembersMessage:h,color:f,trackHover:y}=e,S=(0,r().yK)((e=>({container:{marginBottom:4,..."white_background"===f?{fontSize:l().JB.UISmall.desktop,color:e.mediumTextColor,padding:"4px 8px"}:{}},userContainer:{display:"flex",alignContent:"flex-end",minWidth:140,width:"100%",marginTop:4},user:{flexGrow:1},moreMessage:{marginLeft:2,marginTop:4,..."white_background"===f?{fontSize:l().JB.UISmall.desktop,color:e.mediumTextColor}:{color:e.mediumInvertedTextColor}}})),[f]),v=(0,i().VK)((()=>p().default.state.currentSpaceStore),[]),b=(0,n().O7)();(0,i().VK)((()=>{y&&c().iH(b,{group_id:t.group_id})}),[y,t,b]);const[{value:C}]=(0,a().r5)((async()=>{if(!v)return;const e=await d().callApi({eventName:"getSpacePermissionGroupMembers",environment:b,data:{groupIds:[t.group_id],spaceId:v.id}});if("success"===e.type){var n;const i=null===(n=e.data.groupUsersMap[t.group_id])||void 0===n?void 0:n.userIds;return(0,u().rm)({userIds:i,limit:o,spaceStore:v})}}),[v,b,t,o]);return 0===(null==C?void 0:C.limitedUserStores.length)?(0,m.jsx)(m.Fragment,{children:h}):(0,m.jsxs)("div",{style:S.container,children:[null==C?void 0:C.limitedUserStores.map((e=>(0,m.jsx)("div",{style:S.userContainer,children:(0,m.jsx)(g().Z,{style:S.user,userStore:e,avatarSize:18})},e.id))),C&&C.countRemainingUsers>0&&(0,m.jsx)("div",{style:S.moreMessage,children:(0,m.jsx)(s()._H,{id:"blockPermissionsSettings.groupPermissionUsers.tooltip",defaultMessage:"{countRemainingUsers} more…",values:{countRemainingUsers:C.countRemainingUsers}})})]})}},140303:(e,t,o)=>{o.d(t,{L:()=>d,V:()=>c});var n=o(667294),i=()=>o(66077),r=()=>o(219727),a=()=>o(217465),s=()=>o(876822),l=o(785893);const c=(0,n.createContext)({organizationOwnerRecordCache:void 0,updateCacheWithRecordMap:e=>{}});function d(e){let{children:t}=e;const o=(0,r().O7)(),[i,d]=(0,n.useState)(void 0);(0,n.useEffect)((()=>{const e=u(o);d(e)}),[o]);const p=(0,n.useCallback)((e=>{var t;const n=null===(t=s().default.state.currentUserStore)||void 0===t?void 0:t.id;if(!n||!e.data.organizationOwnerRecordMap)return;if(!e.data.organizationOwnerRecordMap)return;const i=a().RecordMap.create(e.data.organizationOwnerRecordMap);d((e=>{if(!e)return u(o);for(const{pointer:t,model:o}of i)e.setModelAndRole({pointer:t,userId:n},o,"editor");return u(o,e.data)}))}),[o]);return i?(0,l.jsx)(c.Provider,{value:{organizationOwnerRecordCache:i,updateCacheWithRecordMap:p},children:t}):null}function u(e,t){const o=new(i().Z)({name:"organizationSettingsConsoleCache",data:t});return o.addCacheFallback(e.defaultRecordCache.inMemoryRecordCache),o}c.displayName="OrganizationCacheContext"},560847:(e,t,o)=>{o.d(t,{R:()=>r});var n=o(667294),i=()=>o(949842);function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0;return(0,n.useCallback)((t=>{(0,i().sg)({event:t,context:o,callback:()=>e(t)})}),[...t,o])}},766463:(e,t,o)=>{o.d(t,{s:()=>K});o(670560),o(122556),o(582845),o(250570),o(533019),o(721473),o(788208),o(22624),o(267602),o(653476),o(241792),o(228244);var n=o(667294),i=()=>o(629013),r=()=>o(219727),a=()=>o(142735),s=()=>o(511115),l=()=>o(364402),c=()=>o(565630),d=()=>o(647834),u=()=>o(752778),p=()=>o(899133),g=()=>o(788860),m=()=>o(513670),h=()=>o(855741),f=()=>o(696459),y=()=>o(326966),S=()=>o(824462),v=()=>o(505789),b=()=>o(594546),C=()=>o(43721),x=()=>o(15981),P=()=>o(549813),R=()=>o(8),k=()=>o(90065),_=()=>o(778265),M=()=>o(620218),w=()=>o(828946),I=()=>o(98228),j=()=>o(870391),T=()=>o(876822),L=()=>o(804217),B=()=>o(749826),D=()=>o(63317),V=()=>o(485014),Z=()=>o(21965),A=()=>o(826955);class F extends(()=>o(263184))().default{getInitialState(){return{query:void 0,localResults:[],numTotalLocalResults:0,serverResults:[],numTotalServerResults:0,searchSessionId:(0,o(956057).Il)(),isResultsLoading:!1}}}const H=F;var U=()=>o(677559),E=()=>o(466970),O=()=>o(358565);function K(e){var t;const{searchQuery:o,limit:F,source:K,type:z,disable:q,overrideSpaceStore:G,overrideSearchSessionId:Q,usePrefetch_EXPERIMENTAL:$,isTitleOnly:Y=!0}=e,X=(0,r().O7)(),J=(0,g().YB)(),ee=(0,c().D9)(o),te=(0,c().D9)(e.filters),oe=(0,n.useRef)(0),ne=(0,n.useRef)(!0),ie=(0,a().VK)((()=>L().default.state.online),[]),re=(0,a().VK)((()=>e.isLocalOnlyMode||!ie),[ie,e.isLocalOnlyMode]),ae=(0,_().P)(),se=(0,n.useMemo)((()=>new H),[]),le=(0,a().VK)((()=>Q&&Q!==se.state.searchSessionId?(se.update((e=>({...e,searchSessionId:Q}))),Q):se.state.searchSessionId),[se,Q]),ce=(0,E().E)("search_quickfind_only_show_title_matches"),{searchLocalResults:de,searchServerResults:ue,isResultsLoading:pe,numTotalLocalResults:ge,numTotalServerResults:me}=(0,a().VK)((()=>({searchLocalResults:se.state.localResults,searchServerResults:se.state.serverResults,isResultsLoading:se.state.isResultsLoading,numTotalLocalResults:se.state.numTotalLocalResults,numTotalServerResults:se.state.numTotalServerResults})),[se]),he=(0,a().VK)((()=>{if(re||pe&&ne.current)return de;let e=[];return e="mini_quick_find"===K?function(e){const{localResults:t,serverResults:o,includeNonTitleMatches:n,query:i,environment:r,intl:a}=e,s=t.map((e=>e.store.id)),l=new Set(s),c=o.filter((e=>!l.has(e.store.id))),d=c.filter((e=>{const t=(0,P().V)(e.store,a,r,!1);return(0,j().B)({query:i,resultText:t??"",isLastQueryTermPartialMatchOK:!0})})),u=c.filter((e=>!d.includes(e)));if(n)return[...t,...d,...u];return[...t,...d]}({localResults:de,serverResults:ue,includeNonTitleMatches:!ce,query:o,environment:X,intl:J}):function(e){const{localResults:t,serverResults:o}=e,n=t.map((e=>e.store.id)),i=new Set(n),r=o.filter((e=>!i.has(e.store.id)));return[...t,...r]}({localResults:de,serverResults:ue}),z===p().n8.CollectionsInSpace&&(e=N(e)),e}),[re,pe,de,ue,z,o,K,X,J,ce]),fe=(0,a().VK)((()=>G||T().default.state.currentSpaceStore),[G]),ye=(0,a().VK)((()=>"on"===B().default.getEligibleGroup({experimentId:"search-use-local-reranker-layered",parameter:"shouldUseLocalReranker",defaultGroup:"control"})),[]),Se=(0,a().VK)((()=>re&&ie&&Boolean($)),[re,ie,$]),ve=(0,a().VK)((()=>(0,R().bC)(X).hasPublicAccessPermission),[X]),be=(0,n.useMemo)((()=>{const t={navigableBlockContentOnly:Y,...e.filters};return(0,p().u4)(t)}),[e.filters,Y]),Ce=(0,n.useMemo)((()=>{var t;return function(e){const{blockTypes:t,queryType:o}=e;switch(o){case p().n8.CollectionsInSpace:return["collection_view","collection_view_page"];case p().n8.BlocksInCollection:return["page","collection_view_page"];case p().n8.BlocksInSpace:default:return[...t??[]]}}({blockTypes:null===(t=e.filters)||void 0===t?void 0:t.blockTypes,queryType:z})}),[null===(t=e.filters)||void 0===t?void 0:t.blockTypes,z]),xe=(0,n.useCallback)(((e,t)=>{const{isSuccess:o,totalResultsCount:n,localCacheMetadata:i,query:r}=t;M().default.measure(e,{environment:X,data:{start_time:e.startTime,success:o,surface:K,num_results:n,search_session_id:le,local_cache_metadata:i,local_cache_readiness_timings:V().Z.state.readinessTimings,query_length:r.length}})}),[X,K,le]),Pe=(0,n.useCallback)(((e,t)=>{const{isSuccess:o,totalResultsCount:n,query:i}=t;M().default.measure(e,{environment:X,data:{start_time:e.startTime,success:o,surface:K,num_results:n,search_session_id:le,search_session_flow_number:oe.current,query_length:i.length}})}),[X,K,le]),Re=(0,U().XJ)(w().x.searchActions),ke=(0,n.useCallback)((e=>{const t=M().default.mark("rum.local_quick_search_query"),{query:o,spaceStore:n}=e,i=ae&&!ie&&(0,f().DE)(p().gT,K);if("resolved"!==Re.status)return;const r=z===p().n8.CollectionsInSpace;let a=[];0===o.length&&r&&(a=function(e){const{spaceStore:t,environment:o}=e,n=(0,v().l)({currentUserId:o.currentUser.id,spaceId:t.id}).map((e=>{const o=A().NW.createChildStore(t,{table:u().vF,id:e}).getParentBlockStore();if(null==o?void 0:o.pathIsAccessibleAndAlive())return o}));return(0,m().oA)(n)}({environment:X,spaceStore:n}).map(((e,t)=>({store:e,originalPosition:t,id:e.id,score:0,spaceId:e.getSpaceId(),sources:[p().vp.Local],featureGroups:[],serverEventProperties:void 0}))));const s=V().Z.state.localSearchableBlocksCache,l=(0,C().U)({environment:X,overrideCurrentUserId:X.currentUser.id,overrideSpaceId:n.id,overrideLocalSearchableBlocksCache:s}),c=(0,O().NH)({environment:X,parentStore:n,isOnline:ie,requestInput:{query:{text:o,filters:{...be,blockTypes:Ce,isOfflineOnly:i},sort:{field:"relevance"}},limit:re?F:Math.min(F,5)},localSearchCache:s,shouldUseNewRerankerDebugOverrideEnabled:ye,shouldLimitLocalResultsWhenOnline:!re,hasPublicAccessPermission:ve}),d=Se?W({query:o,serverResults:Ae.current}):[],g=c&&h().x.unwrapOr(c,void 0),y=(null==g?void 0:g.results)??[],S=(null==g?void 0:g.total)??0;let b=m().mN([...a,...y,...d],(e=>e.id));b=r?N(b):b,se.update((e=>e.query!==o?e:(He.current=b.map((e=>e.id)),xe(t,{query:o,isSuccess:Boolean(g),totalResultsCount:S,localCacheMetadata:l}),{...e,localResults:b,isResultsLoading:!re&&e.isResultsLoading,numTotalLocalResults:S})))}),[Ce,X,be,ve,re,ie,ae,F,Re.status,se,ye,z,xe,Se,K]),_e="mini_quick_find"===K?40:I().E5,Me=(0,i().y)(ke,_e),we=(0,n.useCallback)((e=>{const{result:t,isMetaClick:n,context:i}=e,r=(0,P().V)(t.store,J,X,!1),a=(0,j().B)({query:o,resultText:r??"",isLastQueryTermPartialMatchOK:!0});(0,b().j)({environment:X,event:{eventName:"select_search_item",eventProperties:{sources:t.sources,localSources:Array.from(t.localSource||new Set),searchSessionId:le,searchSessionFlowNumber:oe.current,context:i,queryStringLength:o.length,isTitleMatch:a,totalSearchResultCount:ge+me,numLocalResults:de.length,numTotalLocalResults:ge,isMobile:X.device.isMobile,isMetaClick:n,hasFilters:Boolean(be),originalPosition:t.originalPosition,selectedItemIndex:t.originalPosition,selectedSearchResultMetadata:{blockId:t.id,blockType:t.store.getModel().type},searchSource:K,verificationState:(0,k().T7)(t.store)}}})}),[X,ge,me,de,o,le,oe,be,K,J]),Ie=ee===o,je=m().Xy(te,e.filters),Te=Boolean(ee&&!o),Le=je&&Ie,Be=!q&&fe&&!Le,De=Te||!je,Ve=(0,n.useRef)(!1),Ze=(0,n.useRef)([]),Ae=(0,n.useRef)([]),Fe=(0,n.useRef)([]),He=(0,n.useRef)([]),Ue=(0,a().VK)((()=>{if("mention_menu"!==K)return;return Z().Z.getMentionedIds(X.currentUser.id)}),[X.currentUser.id,K]),Ee=(0,n.useCallback)((async e=>{const t=M().default.mark("rum.server_quick_search_query"),{query:o,spaceStore:n,size:i}=e,r=n.id;if(re&&!Se)return;const a=!ne.current&&je?Ze.current:[],s=Se?W({query:o,serverResults:Ae.current}):[];if(Se&&(o.length<=1||s.length>=5||Fe.current.some((e=>e===o))))return;Fe.current.push(o);const c=await S().callApi({eventName:"search",environment:X,data:{type:z,query:o,spaceId:r,collectionId:(null==be?void 0:be.parentId)??"",limit:"mini_quick_find"===K?10:i+1,filters:be,sort:{field:"relevance"},source:K,searchSessionId:le,searchSessionFlowNumber:oe.current,recentlyMentionedPageIds:Ue,recentPagesForBoosting:(0,x().Wk)(D().Z.getWithoutSubscribing(r)),excludedBlockIds:m().jj([...a.map((e=>e.id)),...He.current||[],...Ae.current.map((e=>e.id))]),ignoresHighlight:!0}});if(!c||"failed"===c.type)return;const u=c.data.total,p=(0,y().m8)((0,f().qP)(c.data.trackEventProperties).map((e=>{let[t,o]=e;return[`server-${t}`,o]}))),g=c.data.results.slice(0,i).map(((e,t)=>{const o=A().G.createChildStore(n,{id:e.id,spaceId:e.spaceId,table:"block"}),i=Se?function(e){const{result:t,store:o,environment:n}=e;if(t.terms)return t.terms;const i=o.getModel();if(!i)return[];const r=n.defaultRecordCache.inMemoryRecordCache.makeGetRecordValueFn(n.currentUser.id),a=(0,d().$B)((0,l().ut)({blockValue:i,getRecordValue:r}).text);if(!a)return[];return(0,j().y)(a)}({environment:X,store:o,result:e}):e.terms;return{store:o,originalPosition:t,...e,serverEventProperties:p,terms:i}}));Ve.current=!(u<=i);const h=[...a,...g];Ze.current=h,Ae.current=m().mN([...Se?g:[],...Ae.current],(e=>e.id)),Se||(se.update((e=>e.query!==o?e:(Pe(t,{query:o,isSuccess:"success"===c.type,totalResultsCount:u}),{...e,serverResults:h,isResultsLoading:!1,numTotalServerResults:u}))),oe.current+=1)}),[re,je,X,z,be,K,le,Ue,He,se,Pe,Se]),Oe=(0,n.useCallback)((e=>{!q&&fe&&Ve.current&&!pe&&ie&&(se.update((e=>({...e,isResultsLoading:!0}))),Ve.current=!1,ne.current=!1,Ee({query:o,spaceStore:fe,size:e??20}))}),[fe,q,Ee,ie,pe,o,se]),Ke="mini_quick_find"===K?100:I().rE,We=(0,s().z)(Oe,Ke),Ne=(0,i().y)(Ee,Se?0:I().rE);return(0,n.useEffect)((()=>{if(De){const e=se.getInitialState();se.update((t=>({...e,searchSessionId:t.searchSessionId}))),Ae.current=[],Fe.current=[]}Be&&(ne.current=!0,se.update((e=>({...e,isResultsLoading:!0,query:o}))),Me({query:o,spaceStore:fe}),Ne({query:o,spaceStore:fe,size:F}))}),[fe,Me,Ne,F,o,Be,se,De]),{results:he,isResultsLoading:pe,searchSessionId:le,fetchAdditionalServerResultsOnChange:!q&&!re&&Ve.current&&Le?We:void 0,searchSessionFlowNumber:oe.current,hasMoreResults:Ve.current,searchAnalytics:{trackSelectSearchItem:we}}}function W(e){const{query:t,serverResults:o}=e;return t?o.filter((e=>(0,j().B)({query:t,resultText:(e.terms??[]).join(" "),isLastQueryTermPartialMatchOK:!0}))):[]}function N(e){const t=new Set;return e.filter((e=>{const o=e.store.getCollectionViewSourceCollectionStore();return!(!o||t.has(o.id))&&(t.add(o.id),!0)}))}},439871:(e,t,o)=>{o.d(t,{M:()=>i});var n=o(667294);function i(e){const t=(0,n.useId)();return e??t}},420406:(e,t,o)=>{o.d(t,{$:()=>n});function n(e,t){t.route.name;return!1}},341643:(e,t,o)=>{o.d(t,{DW:()=>S,IG:()=>h,J4:()=>y,hZ:()=>f,q9:()=>m,qq:()=>v,s4:()=>g});var n=o(667294),i=()=>o(219727),r=()=>o(142735),a=()=>o(801812),s=()=>o(677559),l=()=>o(690664),c=()=>o(105649),d=()=>o(291335),u=()=>o(590972),p=()=>o(420406);const g=new(s().Ss)("PerformanceToolbar",(()=>Promise.all([o.e(62743),o.e(5242),o.e(4014),o.e(20919),o.e(93843),o.e(66283),o.e(54194)]).then(o.bind(o,674207)))),m=(0,s().kF)(g,(e=>e.PerformanceToolbar)),h=(0,s().kF)(g,(e=>e.PerformanceToolbarSettings));function f(){const e=(0,i().O7)();return(0,r().VK)((()=>(0,p().$)(e,e.RouterStore.state)),[e])}function y(){const e=(0,i().O7)(),t=b("PerformanceToolbarStore"),o=b("isPerformanceToolbarVisible");return(0,r().VK)((()=>!(!t||!o)&&o(e,e.RouterStore.state,t.state)),[o,e,t])}function S(){const e=b("PerformanceToolbarStore");return(0,r().VK)((()=>!!e&&e.state.isPerformanceToolbarMounted),[e])}function v(){const e=(0,i().O7)(),t=b("createPerformanceToolbarMouseListeners"),o=b("PerformanceToolbarStore"),{sidebarExpanded:a,sidebarWidth:s,secondarySidebarExpanded:p,secondarySidebarWidth:g,updateSidebarExpanded:m,updateSidebarWidth:h}=(0,r().VK)((()=>({sidebarExpanded:d().sidebarExpandedStore.state,sidebarWidth:d().sidebarWidthStore.state,secondarySidebarExpanded:c().default.isOpen(),secondarySidebarWidth:l().default.getWidth(),updateSidebarExpanded:u().default.state.expanded,updateSidebarWidth:u().default.state.width})),[]);return(0,n.useEffect)((()=>{if(o&&t)return t(e,(e=>o.update((t=>({...t,isMouseNearPerformanceToolbar:e})))),a,s,p,g,m,h)}),[t,e,o,a,s,p,g,m,h])}function b(e){const t=f(),[{value:o}]=(0,a().r5)((()=>t?g.load().then((t=>t[e])):Promise.resolve(void 0)),[e,t]);return o}},251997:(e,t,o)=>{o.d(t,{default:()=>Po});o(670560),o(267602),o(653476),o(470928),o(30005),o(241792);var n=o(667294),i=()=>o(219727),r=()=>o(142735),a=()=>o(846550),s=()=>o(506347),l=()=>o(926724),c=()=>o(226413),d=()=>o(532850),u=()=>o(892981),p=()=>o(135857),g=()=>o(235484),m=()=>o(998411),h=()=>o(801812),f=()=>o(159732),y=()=>o(396136),S=()=>o(255933),v=()=>o(899133),b=()=>o(255393),C=()=>o(788860),x=()=>o(491927),P=()=>o(250303),R=()=>o(54512),k=()=>o(824462),_=()=>o(959137),M=()=>o(308186),w=()=>o(463058),I=()=>o(497065),j=()=>o(970105),T=()=>o(269299),L=()=>o(423402),B=()=>o(491925),D=()=>o(459217),V=()=>o(356321),Z=()=>o(827973),A=()=>o(573357),F=()=>o(740046),H=()=>o(198829),U=()=>o(838367),E=()=>o(967092),O=()=>o(943620),K=()=>o(384241),W=()=>o(388284),N=()=>o(641481),z=()=>o(249392),q=o(785893);function G(e){const{targetCollectionStore:t,title:o,onClick:s,focused:l,isSection:c,index:d}=e,u=(0,r().VK)((()=>t.canEdit()),[t]),p=(0,r().VK)((()=>t.isSyncedCollection()),[t]),g=(0,i().Fy)(),m=(0,a().yK)((e=>({wrapper:{borderTop:`1px solid ${e.lightDividerColor}`,paddingTop:4,paddingBottom:4},row:{fontSize:g.isMobile?16:14,minHeight:g.isMobile?44:32}})),[g]),{format:h}=(0,n.useContext)(D().m);if(h===V().C.FormEditor||h===V().C.FormViewer)return null;if(!u)return null;const f=(0,q.jsx)(z().Z,{targetCollectionStore:t,pageName:o,onClick:()=>s(d),style:m.row,focused:l});return p?(0,q.jsx)(q.Fragment,{}):c?(0,q.jsx)(W().Z,{style:m.wrapper,disableDesktopPadding:!0,disableMobilePadding:!0,children:f}):f}var Q=()=>o(125659),$=()=>o(594546),Y=()=>o(589024),X=()=>o(763266),J=()=>o(861026),ee=()=>o(487270),te=()=>o(527278),oe=()=>o(352230),ne=()=>o(129338),ie=()=>o(148126),re=()=>o(8),ae=()=>o(173113),se=()=>o(766463),le=()=>o(466970),ce=()=>o(620218),de=()=>o(98228),ue=()=>o(663132),pe=()=>o(876822),ge=()=>o(749826),me=()=>o(138912),he=()=>o(826955),fe=()=>o(897257);const ye=(0,C().vU)({syncedCollectionInputPlaceholder:{defaultMessage:"Link a page",id:"relationPropertyMenuInput.syncedCollection.searchPlaceholder"},connectedRelationInputPlaceholder:{defaultMessage:"Find a page",id:"relationPropertyMenuInput.connectedRelation.searchPlaceholder"},connectedRelationGoogleDriveInputPlaceholder:{defaultMessage:"Paste in Google Drive or Google Docs link",id:"relationPropertyMenuInput.connectedRelationGoogleDrive.searchPlaceholder"},connectedRelationFigmaInputPlaceholder:{defaultMessage:"Paste in https://figma.com/...",id:"relationPropertyMenuInput.connectedRelationFigma.searchPlaceholder"},connectedRelationGithubInputPlaceholder:{defaultMessage:"Paste in https://github.com/...",id:"relationPropertyMenuInput.connectedRelationGithub.searchPlaceholder"}}),Se=(0,C().vU)({inputPlaceholderEditable:{defaultMessage:"Link or create a page…",id:"relationPropertyMenuInput.placeholder.defaultEditable"},formInputPlaceholderEditable:{defaultMessage:"Search…",id:"relationPropertyMenuInput.placeholder.form"},inputPlaceholderUneditable:{defaultMessage:"Search linked pages…",id:"relationPropertyMenuInput.placeholder.defaultUneditable"}}),ve=(0,C().vU)({inputPlaceholder:{defaultMessage:"Search {propertyName}...",id:"relationPropertyMenuInput.placeholder.sharing"}}),be=(0,C().vU)({inputPlaceholder:{defaultMessage:"Search...",id:"relationPropertyMenuInput.placeholder.sprint"}});function Ce(e){let{intl:t,connectedRelationFlags:o,overlayMode:n,disabled:i,format:r}=e;const a=function(e){const{isSyncedCollectionRelation:t,isGithubPrRelation:o,isGoogleDriveRelation:n,isFigmaRelation:i,isConnectedRelation:r}=e;if(t)return ye.syncedCollectionInputPlaceholder;if(o)return ye.connectedRelationGithubInputPlaceholder;if(n)return ye.connectedRelationGoogleDriveInputPlaceholder;if(i)return ye.connectedRelationFigmaInputPlaceholder;if(r)return ye.connectedRelationInputPlaceholder}(o);return a?t.formatMessage(a):"view"===(null==n?void 0:n.type)||i?t.formatMessage(Se.inputPlaceholderUneditable):r&&(0,Y().xE)(r)?t.formatMessage(Se.formInputPlaceholderEditable):t.formatMessage(Se.inputPlaceholderEditable)}function xe(e,t){return e.formatMessage(ve.inputPlaceholder,t)}o(821057),o(122556),o(582845),o(250570),o(533019),o(721473),o(788208),o(22624);var Pe=()=>o(799891),Re=()=>o(792409),ke=()=>o(828946),_e=()=>o(106128);async function Me(e){let{environment:t,query:o,targetCollectionStore:n,blockPointers:i}=e;try{const e=await ke().x.searchActions.load(),{results:r}=await e.searchPagesInCollection({environment:t,query:o.query,collectionId:n.id,limit:o.limit,spaceId:n.getSpaceId(),excludeTemplates:!0,source:"relation_menu",includePublicPagesWithoutExplicitAccess:!0,boostRecentlyViewedPages:!0,ignoresHighlight:!0});return Ie({results:r,targetCollectionStore:n,blockPointers:i})}catch(r){return Pe().log({level:"error",from:"relationPropertySearchRequest",type:"performDefaultSearchRequest",error:(0,Re().Ui)(r)}),[]}}async function we(e){const{environment:t,query:o,targetCollectionStore:n,blockPointers:i}=e;try{const e=await async function(e){const{environment:t,sprintCollectionStore:o,searchQuery:n}=e,i=o.getPropertyMapping(),r=null==i?void 0:i[l().b0.StatusV2],a=null==i?void 0:i[l().b0.Dates];if(!r||!a)throw new Error("Sprints database does not have the required properties");const s="results",c={userTimeZone:(0,m().r)(),searchQuery:n,sort:[{property:r,direction:"ascending"},{property:a,direction:"ascending"}],reducers:{[s]:{type:"results",limit:100}}},d=o.getParentBlockStore();if(!d)return[];await d.load();const u=d.getCollectionViewStores()[0];if(!u)return[];const p=o.getSpaceId(),g=await k().callApi({eventName:"queryCollection",environment:t,data:{source:{type:"collection",id:o.id,spaceId:p},collectionView:{id:u.id,spaceId:p},loader:c},tracking:{src:"relation_property_menu"}});if("success"!==g.type)return[];const h=g.data.result.reducerResults[s];if("results"!==h.type)return[];return h.blockIds}({environment:t,sprintCollectionStore:n,searchQuery:o.query});return Ie({results:e,targetCollectionStore:n,blockPointers:i})}catch(r){Pe().log({level:"error",from:"relationPropertySearchRequest",type:"performSprintSearchRequest",error:(0,Re().Ui)(r)});return await Me(e)}}function Ie(e){let{results:t,targetCollectionStore:o,blockPointers:n}=e;const i=new Set(n.map((e=>e.id))),r=[];return t.forEach((e=>{const t={spaceId:o.getSpaceId(),id:e,table:y().iU},n=he().G.createChildStore(o,t);if(i.has(e)){const t={key:e,type:_e().Rt.SelectedPage,store:n};r.push(t)}else{const t={key:e,type:_e().Rt.SearchPage,store:n};r.push(t)}})),r}const je=(0,n.createContext)(void 0);function Te(e){const{children:t,relationPropertyMenuStore:o,property:i,targetCollectionStore:r,propertySchema:a,targetParentUrl:s,connectedRelationFlags:l}=e,c=(0,n.useMemo)((()=>({relationPropertyMenuStore:o,property:i,targetCollectionStore:r,propertySchema:a,targetParentUrl:s,connectedRelationFlags:l})),[o,i,r,a,s,l]);return(0,q.jsx)(je.Provider,{value:c,children:t})}je.displayName="RelationPropertyMenuContext";var Le=()=>o(454860),Be=()=>o(707513),De=()=>o(909240),Ve=()=>o(291198),Ze=()=>o(729775);function Ae(e){const{showTargetDatabase:t,inputPlaceholder:o,addPage:s}=e,{analyticsFrom:l,blockPropertyValueOverlayStore:c,blockStore:d,insertChar:u}=(0,n.useContext)(D().m),p=(0,n.useContext)(je),g=(0,i().O7)(),m=(0,i().Fy)(),{searchQuery:h,searchPopupOpen:f}=(0,r().VK)((()=>(null==p?void 0:p.relationPropertyMenuStore.state)??{searchQuery:u??"",searchPopupOpen:!1}),[null==p?void 0:p.relationPropertyMenuStore,u]),y=(0,r().VK)((()=>null==p?void 0:p.targetCollectionStore.getIcon()),[null==p?void 0:p.targetCollectionStore]),S=(0,a().yK)((e=>({regular:{color:e.mediumTextColor,whiteSpace:"nowrap",marginLeft:4},headerWrap:{display:"flex",width:"100%",position:"relative",zIndex:2,padding:"6px 10px",fontSize:14,background:e.inputBackground,boxShadow:`\n\t\t\t\t\t0 1px 0 ${e.darkDividerColor}\n\t\t\t\t`},recordTitle:{fontWeight:Be().Ue.semibold,fontSize:14,marginLeft:_e().Qi*(m.isRetina?.5:1)},searchIcon:{fill:e.mediumIconColor,width:14,height:14,marginRight:10},input:{flexGrow:1},targetDatabase:{display:"flex",marginLeft:10,alignItems:"center"},linkBoxOuterStyle:{marginLeft:_e().Qi},linkBoxInnerStyle:{display:"flex"}})),[m.isRetina]);if(!d||!c||!p)return null;const{relationPropertyMenuStore:v,targetCollectionStore:b,targetParentUrl:P}=p;return(0,q.jsxs)("div",{style:S.headerWrap,children:[(0,q.jsx)(Ve().Z,{style:S.input,value:h,placeholder:o,forceShowClearButton:Boolean(h||f),focus:!0,onChange:e=>{const t=e.target.value;v.setState({...v.state,searchQuery:t,searchPopupOpen:!!t,searchLimit:Le().Z.limitIncrement})},onClearButtonClick:()=>{v.setState(v.getInitialState())},onClick:()=>{v.setState({...v.state,searchQuery:h,searchPopupOpen:!0,searchLimit:Le().Z.limitIncrement})},onKeyDown:e=>{"Escape"===e.key&&v.setState(v.getInitialState())},format:Ve().B.Transparent,onSubmit:()=>{if(!s)return;const e=b.getFormat().integration_id,t=me().default.integrations.state.find((t=>t.id===e)),o=b.getFormat().pattern_name;if(!t||!o)return;(0,ne().DB)({integration:t,patternName:o,url:h})&&s()}}),t&&(0,q.jsx)("div",{style:S.targetDatabase,children:(0,q.jsx)(C()._H,{id:"database.relationProperty.newRelation.targetDatabase",defaultMessage:"<regular>In</regular> {databaseWithIcon}",values:{regular:e=>(0,q.jsx)("span",{style:S.regular,children:e}),databaseWithIcon:(0,q.jsxs)(Ze().Z,{href:P,style:S.linkBoxOuterStyle,innerStyle:S.linkBoxInnerStyle,onClick:()=>{l&&x().ZZ(g,{from:l}),De().xv({environment:g,blockPropertyValueOverlayStore:c})},children:[(0,q.jsx)(O().Z,{disabled:!0,icon:y,isEmptyPage:!1,size:_e().WO}),(0,q.jsx)(K().Z,{store:b,underline:!0,style:S.recordTitle,maxLength:25})]})}})})]})}var Fe=()=>o(565630),He=()=>o(513670),Ue=()=>o(494657),Ee=()=>o(119891),Oe=()=>o(78078),Ke=()=>o(668001),We=()=>o(312578),Ne=()=>o(18748),ze=()=>o(255577),qe=()=>o(906651),Ge=()=>o(842574),Qe=()=>o(906769),$e=()=>o(868744),Ye=()=>o(916539);function Xe(e){const{targetCollectionStore:t,onClick:o,focused:s,isSection:l,index:c,onMouseEnter:d,blockPropertyValueOverlayStore:u}=e,p=(0,r().VK)((()=>t.canEdit()),[t]),g=(0,r().VK)((()=>t.isSyncedCollection()),[t]),m=(0,i().Fy)(),h=(0,a().yK)((e=>({medium:{fontWeight:Be().Ue.medium},wrapper:{borderTop:`1px solid ${e.lightDividerColor}`},icon:{width:14,fill:"#A6A299",marginRight:-2,marginLeft:0},row:{fontSize:m.isMobile?16:14,minHeight:m.isMobile?44:32}})),[m]),f=(0,q.jsx)(Z().Z,{focused:s,onMouseEnter:d,icon:(0,Ye().R)(h.icon),style:h.row,onClick:(0,n.useCallback)((()=>{o(c),u.setState({isOpen:!1})}),[c,o,u]),title:(0,q.jsx)(C()._H,{id:"database.searchRelation.MoveToBacklogFooter",defaultMessage:"<medium>Move to backlog</medium>",values:{medium:e=>(0,q.jsx)("span",{style:h.medium,children:e})}})}),y=l?(0,q.jsx)(W().Z,{style:h.wrapper,disableDesktopPadding:!0,disableMobilePadding:!0,children:f}):f;return p?g?null:y:null}var Je=()=>o(903639),et=()=>o(320197),tt=()=>o(250625),ot=()=>o(899018),nt=()=>o(388944),it=()=>o(333023),rt=()=>o(520849),at=()=>o(428241),st=(o(749411),()=>o(730120)),lt=()=>o(646574),ct=()=>o(874459),dt=()=>o(312117),ut=()=>o(565271),pt=()=>o(490670),gt=()=>o(956057),mt=()=>o(530980),ht=()=>o(463212),ft=()=>o(830968),yt=()=>o(568017),St=()=>o(326966),vt=()=>o(388915),bt=()=>o(518242),Ct=()=>o(654133),xt=()=>o(205228),Pt=()=>o(338530),Rt=()=>o(485569),kt=()=>o(949842),_t=()=>o(164079),Mt=()=>o(852465),wt=()=>o(998901),It=()=>o(56424);function jt(){const e=(0,i().O7)(),t=function(){const e=(0,i().Fy)().isMobile;return(0,a().yK)((t=>({figmaResults:{display:"flex",flexDirection:"column",alignItems:"flex-start",fontSize:e?16:12,padding:16,paddingBottom:4},figmaResultsCopyWrapper:{marginTop:0,color:t.lightTextColor}})),[e])}();return e.device.isMobile?(0,q.jsx)(q.Fragment,{}):(0,q.jsx)("div",{style:t.figmaResults,children:(0,q.jsx)("p",{style:t.figmaResultsCopyWrapper,children:(0,q.jsx)(C()._H,{defaultMessage:"To link, paste the Figma File URL above",id:"connectedRelationPropertyMenuResults.figmaRelationUserEducationPasteUrl.description"})})})}var Tt=()=>o(659089),Lt=()=>o(524052),Bt=()=>o(456681),Dt=()=>o(628191),Vt=()=>o(984871),Zt=()=>o(752127),At=()=>o(360240),Ft=()=>o(675334),Ht=()=>o(154186),Ut=()=>o(666414),Et=()=>o(396439);const Ot=(0,C().vU)({githubCopyIdAria:{defaultMessage:"Copy the ID value.",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducation.copyIdAria"},githubAddIdAria:{defaultMessage:"Add a unique id property to the database.",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducation.addIdAria"},githubLearnMoreAria:{defaultMessage:"Learn more about the GitHub Pull Requests feature.",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducation.learnMoreAria"}});function Kt(e){const{pageBlockStore:t,blockPropertyValueOverlayStore:o}=e,n=(0,i().O7)(),a=(0,C().YB)(),s=Wt(),l=(0,Q().Y$)(),c=(0,r().VK)((()=>l.collectionStore()),[l]),u=(0,r().VK)((()=>l.databaseType),[l]),p=(0,r().VK)((()=>{var e;return c&&(null===(e=c.getRecordKeyStore())||void 0===e?void 0:e.getRecordKey())}),[c]),{uniqueIdPropertyId:m,uniqueIdValue:h}=(0,r().VK)((()=>{const e=t.getSchema(),o=(0,Tt().$z)(e);if(1!==o.length)return{uniqueIdPropertyId:void 0,uniqueIdValue:void 0};const n=t.getPropertyValue(o[0]);return{uniqueIdPropertyId:o[0],uniqueIdValue:(0,d().ah)(n)}}),[t]),y=(0,r().VK)((()=>(0,Tt().wf)(p,h)),[p,h]),S=(0,r().VK)((()=>!Boolean(p)||!Boolean(h)),[p,h]);return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)("div",{style:s.githubResults,children:[(0,q.jsx)(Nt,{}),(0,q.jsx)("p",{style:s.githubResultsCopyWrapper,children:S?(0,q.jsx)(C()._H,{defaultMessage:"Create a prefixed ID property to paste in the GitHub PR title.",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducation.badIdError"}):(0,q.jsx)(C()._H,{defaultMessage:"Copy the {singleItemName} ID and paste it into the title of your PR in GitHub.",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducationLinkPastingOn.description",values:{singleItemName:(0,At().sN)(u)}})}),(0,q.jsx)(Ft().Z,{width:"100%",uniqueIdPrefix:p,uniqueIdValue:h})]}),(0,q.jsxs)("div",{style:s.githubResultsButtonsWrapper,children:[(0,q.jsxs)(Ht().Z,{style:s.githubResultsLearnMore,ariaLabel:a.formatMessage(Ot.githubLearnMoreAria),onClick:e=>{e.preventDefault(),Zt().D({environment:n,url:(0,ie().UY)("guides.githubRelation"),targetSelf:!1})},children:[(0,Bt().m)({width:n.device.isMobile?16:12}),(0,q.jsx)(Et().Z,{size:4}),(0,q.jsx)(C()._H,{defaultMessage:"Learn more",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducation.learnMore"})]}),S?(0,q.jsxs)(Ht().Z,{style:s.githubResultsCTAButton,ariaLabel:a.formatMessage(Ot.githubAddIdAria),onClick:async e=>{e.preventDefault(),c&&(await Dt().K({environment:n,collectionStore:c}),T().createAndCommit({userAction:"CollectionSettingsAutoIncrementIdPropertyCreateNewIdProperty",environment:n,canUndo:!0,perform:e=>{Vt().G3({environment:n,collectionStore:c,collectionViewArgs:void 0,propertyType:"auto_increment_id",transaction:e})}}),P()._H({environment:n,collectionContextStore:l,from:"github_relation_menu",property_type:"auto_increment_id",integration_id:g().U9}))},children:[(0,f().R)({width:n.device.isMobile?16:12}),(0,q.jsx)(Et().Z,{size:4}),(0,q.jsx)(C()._H,{defaultMessage:"Add ID property",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducation.addId"})]}):(0,q.jsxs)(Ht().Z,{style:s.githubResultsCTAButton,ariaLabel:a.formatMessage(Ot.githubCopyIdAria),onClick:async e=>{e.preventDefault();const i=await _().F.clipboardActions.load();await i.copyString({stringValue:y,environment:n,copiedMessage:i.clipboardMessages.copiedPropertyToClipboard}),m&&P().S$(n,l,{block_id:t.id,property:m,property_type:"auto_increment_id",github_relation_menu:!0}),o.setState({isOpen:!1})},children:[(0,Lt().U)({width:n.device.isMobile?16:12}),(0,q.jsx)(Et().Z,{size:4}),(0,q.jsx)(C()._H,{defaultMessage:"Copy {singleItemName} ID",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducation.copyId",values:{singleItemName:(0,At().sN)(u)}})]})]})]})}function Wt(){const e=(0,i().Fy)().isMobile;return(0,a().yK)((t=>({githubResults:{display:"flex",flexDirection:"column",alignItems:"flex-start",fontSize:e?16:12,padding:16,paddingBottom:4},githubResultsCopyWrapper:{marginTop:0,color:t.lightTextColor},githubResultsErrorWrapper:{marginTop:0,color:yt().ZP.red},githubResultsButtonsWrapper:{width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",fontSize:e?16:12,padding:"10px"},githubResultsLearnMore:{display:"flex",flexDirection:"row",alignItems:"center",padding:4,borderRadius:5,color:t.lightTextColor},githubResultsCTAButton:{display:"flex",flexDirection:"row",alignItems:"center",padding:4,borderRadius:5,color:t.blueColor},githubLinkPastingSeparator:{border:t.tableDividerColor,width:"100%"},githubLinkPastingContainer:{width:"100%",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",margin:"8px 0px"},githubLinkPastingSeparatorText:{position:"absolute",backgroundColor:t.popoverBackground,color:t.lightTextColor,padding:"0px 8px"}})),[e])}function Nt(){const e=Wt();return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("p",{style:e.githubResultsCopyWrapper,children:(0,q.jsx)(C()._H,{defaultMessage:"To link, paste the GitHub PR URL above",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducationPasteUrl.description"})}),(0,q.jsxs)("div",{style:e.githubLinkPastingContainer,children:[(0,q.jsx)(Ut().Z,{size:1,style:e.githubLinkPastingSeparator}),(0,q.jsx)("div",{style:e.githubLinkPastingSeparatorText,children:"or"})]}),(0,q.jsx)(Et().Z,{size:8})]})}var zt=()=>o(667009);function qt(e){const t=(0,i().O7)(),o=function(){const e=(0,i().Fy)().isMobile;return(0,a().yK)((t=>({googleDriveResults:{display:"flex",flexDirection:"column",alignItems:"flex-start",fontSize:e?16:12,padding:16,paddingBottom:4,paddingTop:4},googleDriveResultsCopyWrapper:{marginTop:0,color:t.lightTextColor,marginBottom:0},googleDriveResultsLearnMore:{display:"flex",flexDirection:"row",alignItems:"center",padding:4,borderRadius:5},googleDriveResultsAccount:{fontSize:12,margin:0},googleDriveLinkPastingSeparator:{border:t.tableDividerColor,width:"100%"},googleDriveLinkPastingContainer:{width:"100%",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",margin:"8px 0px"},googleDriveLinkPastingSeparatorText:{position:"absolute",backgroundColor:t.cardContentBackground,color:t.lightTextColor,padding:"0px 8px"}})),[e])}(),n=(0,r().VK)((()=>me().default.externalAuthentications.state.filter((e=>{let{integration_id:t}=e;return t===g().f3}))),[]);return t.device.isMobile?(0,q.jsx)(q.Fragment,{}):(0,q.jsxs)("div",{style:o.googleDriveResults,children:[(0,q.jsx)("p",{style:o.googleDriveResultsCopyWrapper,children:(0,q.jsx)(C()._H,{defaultMessage:"To link, paste the Google Drive File URL above",id:"connectedRelationPropertyMenuResults.googleDriveRelationUserEducationPasteUrl.description"})}),(0,q.jsxs)("div",{style:o.googleDriveLinkPastingContainer,children:[(0,q.jsx)(Ut().Z,{size:1,style:o.googleDriveLinkPastingSeparator}),(0,q.jsx)("div",{style:o.googleDriveLinkPastingSeparatorText,children:"or"})]}),(0,q.jsx)(Et().Z,{size:2}),(0,q.jsx)("p",{style:o.googleDriveResultsCopyWrapper,children:(0,q.jsx)(C()._H,{defaultMessage:"Select an account below to browse files on your Google Drive",id:"connectedRelationPropertyMenuResults.googleDriveRelationUserEducationSourcePicker.description"})}),(0,q.jsx)(Et().Z,{size:2}),n.map(((n,i)=>(0,q.jsx)(Ht().Z,{style:o.googleDriveResultsLearnMore,onClick:async o=>{o.preventDefault(),await(async(o,n)=>{const i=await L().jh({environment:t,externalAuthenticationValue:n}),r=me().default.integrations.state.find((e=>e.id===n.integration_id));if(!r)return;const{id:a,name:s,info:l}=r,{icon:c,dark_icon:d,accent_color:u,accent_icon:p}=l,g="dark"===t.ThemeStore.state.mode&&d?d:c;g&&u&&p&&i&&"failed"!==i.type&&await(0,zt().v)({environment:t,accessToken:i.data.access_token,callback:(t,n)=>{e.onFileSelect(o,n)},integration:{id:a,name:s,icon:g,accentColor:u,accentIcon:p},from:"connected_relation_property_value"})})(o,n)},children:(0,q.jsx)("p",{style:o.googleDriveResultsAccount,children:(0,q.jsx)(C()._H,{defaultMessage:"{account}",id:"connectedRelationPropertyMenuResults.googleDriveRelation.googleDriveAccount.description",values:{account:n.account_name}})})},i)))]})}function Gt(){const e=(0,i().O7)(),t=function(){const e=(0,i().Fy)().isMobile;return(0,a().yK)((t=>({salesforceResults:{display:"flex",flexDirection:"column",alignItems:"flex-start",fontSize:e?16:12,padding:16,paddingBottom:4,paddingTop:4},salesforceResultsCopyWrapper:{marginTop:0,color:t.lightTextColor,marginBottom:0},salesforceResultsLearnMore:{display:"flex",flexDirection:"row",alignItems:"center",padding:4,borderRadius:5}})),[e])}();return e.device.isMobile?(0,q.jsx)(q.Fragment,{}):(0,q.jsx)(q.Fragment,{children:(0,q.jsx)("div",{style:t.salesforceResults,children:(0,q.jsx)("p",{style:t.salesforceResultsCopyWrapper,children:(0,q.jsx)(C()._H,{defaultMessage:"To link, paste the Salesforce URL above",id:"connectedRelationPropertyMenuResults.salesforceRelationUserEducationPasteUrl.description"})})})})}function Qt(e){let{patternName:t}=e;const o=(0,i().O7)(),n=function(){const e=(0,i().Fy)().isMobile;return(0,a().yK)((t=>({slackResults:{display:"flex",flexDirection:"column",alignItems:"flex-start",fontSize:e?16:12,padding:16,paddingBottom:4},slackResultsCopyWrapper:{marginTop:0,color:t.lightTextColor}})),[e])}();return o.device.isMobile?null:(0,q.jsx)("div",{style:n.slackResults,children:(0,q.jsx)("p",{style:n.slackResultsCopyWrapper,children:"slack_channel"===t?(0,q.jsx)(C()._H,{defaultMessage:"To link, paste the Slack channel URL above",id:"connectedRelationPropertyMenuResults.slackChannelRelationUserEducationPasteUrl.description"}):(0,q.jsx)(C()._H,{defaultMessage:"To link, paste the Slack URL above",id:"connectedRelationPropertyMenuResults.slackRelationUserEducationPasteUrl.description"})})})}function $t(e){var t;const{sections:o,targetCollectionStore:n,search:s,property:l,propertySchema:c,pageRecordStore:u,blockPropertyValueOverlayStore:p}=e,f=(0,a().yK)((e=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px 16px 16px 8px"},settingsMenuSearchBox:{background:e.contentBackground,marginBottom:10},addPageButton:{width:"100%",display:"flex",justifyContent:"center"},suggestionBox:{display:"flex",alignItems:"center",fontSize:12,color:yt().ZP.white,background:yt().ZP.blue,borderRadius:6,padding:10,boxShadow:e.shadowMD,alignSelf:"center",maxWidth:"80%"},errorMessage:{alignSelf:"center",padding:10,fontSize:14,color:e.errorText},addingPage:{width:"100%",padding:10,display:"flex",justifyContent:"flex-start",fontSize:14,color:e.mediumTextColor},enterText:{color:e.lightTextColor}})),[]),S=d().Kp(c),v=d().gg(c),b=d().ic(c),x=d().R3(c),P=d().RB(c),R=(0,r().VK)((()=>{if(!n)return;const e=n.getFormat().integration_id;return me().default.integrations.state.find((t=>t.id===e))}),[n]),_=(0,r().VK)((()=>R?(0,X().NP)(R.id):[]),[R]),M=(0,i().O7)(),w=(0,C().YB)(),I=(0,a().Fg)(),j=(0,r().VK)((()=>{const e=me().default.state;return e.loaded?e.integrations:[]}),[]),T=(0,r().VK)((()=>{var e;return Boolean(null===(e=pe().default.state.currentSpaceStore)||void 0===e?void 0:e.canAdmin())}),[]),L=(0,r().VK)((()=>{var e;return!(!(null===(e=pe().default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit())||!(0,X().sw)(M))}),[M]),B=(0,r().VK)((()=>{const e=me().default.state;return e.loaded&&R?e.externalAuthentications.filter((e=>e.integration_id===R.id)):[]}),[R]),D=(0,r().VK)((()=>B.length?B[0]:null),[B]),[{value:V,status:A}]=(0,h().r5)((async()=>{if(!D||!R||!(0,g().ok)(R.id))return;const e=D.parent_id;return k().callApi({eventName:"listExternalObjects",environment:M,data:{bot_id:e,query:s}})}),[M,D,s,R],{debounce:1e3}),F=(0,r().VK)((()=>n.getFormat().pattern_name),[n]),H=(0,r().VK)((()=>{if(R&&s)return(0,ne().DB)({integration:R,patternName:F,url:s})}),[F,R,s]),U=(0,Mt().OY)(u)?u:void 0,E=(0,r().VK)((()=>(0,Mt().OY)(u)?u.getPropertyStore(l):void 0),[u,l]),O=(0,r().VK)((()=>null==n?void 0:n.getIcon()),[n]),K=(0,r().VK)((()=>{var e;return null===(e=pe().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),N=(0,Pt().C)(),z={key:"githubPrRelationUserEducation",render:e=>void 0!==U&&(0,q.jsx)(Kt,{pageBlockStore:U,blockPropertyValueOverlayStore:p}),items:[]},G={key:"googleDriveRelation",render:t=>(0,q.jsx)(qt,{onFileSelect:(t,o)=>{(0,kt().ZP)({context:kt().Af.ButtonMouseDown,callback:()=>{e.addPage(o)},event:t})}}),items:[]},Q={key:"figmaRelation",render:e=>(0,q.jsx)(jt,{}),items:[]},$={key:"salesforceRelation",render:e=>(0,q.jsx)(Gt,{}),items:[]},Y={key:"slackRelation",render:e=>(0,q.jsx)(Qt,{patternName:F}),items:[]};if(!E||!R)return(0,q.jsx)(ze().ZP,{type:ze().iW.Vertical,style:{padding:"4px 0px"},initialFocus:0,sections:o});if(!((0,g().Hz)(null==R?void 0:R.id)?null===(t=_[0])||void 0===t?void 0:t.id:null==D?void 0:D.parent_id)){const e=function(e){const{collectionIcon:t,integration:o,environment:n,spaceId:i,isAdmin:r,userAllowedToAuth:a}=e,s=o.id===g().U9,l=()=>{i&&(vt().hM({environment:n,integration:o,spaceId:i,from:"connected_relation_property_menu"}),It().Z.reset())},c=!s&&o.id!==g().Dv;if(c){if(e.environment.device.isMobile)return{key:"askUseBrowserOrDesktopForAuth",render:e=>(0,q.jsx)(W().Z,{...e,disableMobilePadding:!0,title:(0,q.jsx)("div",{style:{whiteSpace:"normal",paddingTop:8},children:(0,q.jsx)(C()._H,{defaultMessage:"Please authorize this integration in the browser or a desktop app.",id:"connectedRelationProperty.mobile.guide.title"})})}),items:[]};if(!a)return{key:"askGuestToGetMemberAccess",render:e=>(0,q.jsx)(W().Z,{...e,disableMobilePadding:!0,title:(0,q.jsx)("div",{style:{whiteSpace:"normal",paddingTop:8},children:(0,q.jsx)(C()._H,{defaultMessage:"To use {integration} integration, request the workspace admin to add you as a member",id:"connectedRelationProperty.guest.auth.guide",values:{integration:o.name}})})}),items:[]}}const d=!s||r&&a?{key:"authenticateButton",render:e=>(0,q.jsx)(Z().Z,{...e,title:(0,q.jsx)(C()._H,{defaultMessage:"Connect to {integration}",id:"connectedRelationPropertyMenuResults.authenticateButton.title",values:{integration:o.name}}),icon:(0,q.jsx)(bt().ZP,{src:null==t?void 0:t.icon,style:{width:14}})}),action:()=>l()}:{key:"askAdminToAuthenticateButton",render:e=>(0,q.jsx)(Z().Z,{...e,title:(0,q.jsx)("div",{style:{whiteSpace:"normal"},children:(0,q.jsx)(C()._H,{defaultMessage:"Ask your workspace admin to configure the GitHub (Workspace) connection.",id:"connectedRelationPropertyMenuResults.askAdminToAuthenticateButton.title"})}),icon:(0,q.jsx)(bt().ZP,{src:null==t?void 0:t.icon,style:{width:14}}),hoveredStyle:{cursor:"default",background:void 0},pressedStyle:{background:void 0}}),action:()=>{}};return{key:"authenticateIntegration",render:e=>(0,q.jsx)(W().Z,{...e,disableMobilePadding:!0,title:(0,q.jsx)(C()._H,{defaultMessage:"Connect to {integration}",id:"connectedRelationPropertyMenuResults.authenticateHeader.title",values:{integration:o.name}})}),items:[d]}}({environment:M,integration:R,collectionIcon:O,spaceId:K,isAdmin:T,userAllowedToAuth:L});return(0,q.jsx)(ze().ZP,{type:ze().iW.Vertical,style:{padding:"4px 0px"},initialFocus:0,sections:[...o,e]})}const J=("success"===(null==V?void 0:V.type)&&"data"in V.data?V.data.data:[]).map((e=>{const t=e.attributes.flatMap((e=>{const t=(0,ft().GY)(e);return(0,ut().nj)(t)?[t]:(console.error(t),[])})),o=(0,St().m8)(t.flatMap((e=>[[e.id,e]])));return{uri:e.uri,attributes:t,attributesById:o}}));function ee(){let e=(0,q.jsx)(C()._H,{id:"connectedRelationPropertyMenuResults.addPageButton.label",defaultMessage:"Link page"});return(null==R?void 0:R.id)===g().f3||(null==R?void 0:R.id)===g().mQ?e=(0,q.jsx)(C()._H,{id:"connectedRelationPropertyMenuResults.addFileButton.label",defaultMessage:"Link file"}):(null==R?void 0:R.id)===g().Nw?e=(0,q.jsx)(C()._H,{id:"connectedRelationPropertyMenuResults.addTicketButton.label",defaultMessage:"Link ticket"}):(null==R?void 0:R.id)===g().U9?e=(0,q.jsx)(C()._H,{id:"connectedRelationPropertyMenuResults.addPRButton.label",defaultMessage:"Link PR"}):(null==R?void 0:R.id)===g().aW?e=(0,q.jsx)(C()._H,{id:"connectedRelationPropertyMenuResults.addObjectButton.label",defaultMessage:"Link Object"}):(null==R?void 0:R.id)===g().nO&&"slack_channel"===F?e=(0,q.jsx)(C()._H,{id:"connectedRelationPropertyMenuResults.addChannelButton.label",defaultMessage:"Link channel"}):(null==R?void 0:R.id)===g().nO&&(e=(0,q.jsx)(C()._H,{id:"connectedRelationPropertyMenuResults.addMessageButton.label",defaultMessage:"Link message"})),e}const te={key:"thirdPartySearchResults",render:e=>(0,q.jsx)(W().Z,{...e,disableMobilePadding:!0}),items:[{key:"addPage",render:e=>(0,q.jsx)(Z().Z,{...e,title:ee(),icon:(0,pt().f)({width:14}),right:(0,q.jsx)(C()._H,{id:"connectedRelationPropertyMenuResults.linkPageButton.enter",defaultMessage:"Enter"}),rightStyle:f.enterText}),action:t=>{(0,kt().ZP)({event:t,context:kt().Af.ButtonMouseDown,callback:()=>{e.addPage()}})}}]},oe={key:"noResultsFoundInThirdParty",render:e=>(0,q.jsx)(W().Z,{...e,disableMobilePadding:!0,title:(0,q.jsx)(C()._H,{defaultMessage:"No results found in {integration}.",id:"connectedRelationPropertyMenuResults.notMatched.help",values:{integration:R.name}})}),items:[]},ie=[];R&&(0,g().ok)(R.id)&&ie.push(...function(e){const{environment:t,intl:o,theme:n,externalIntegrations:i,emojiData:r}=e,a=e.results.flatMap((e=>{const t=e.attributesById.start;if(t&&(0,ft().Gc)(t)){const n=(0,ct().NK)(t.values[0],(0,m().r)(),o.locale);return[{...e,dateTime:n.start}]}return[]})),s=He().vM(a,(e=>e.dateTime.toFormat(ct().Iq))),l=He().MR(Object.keys(s),(e=>st().ou.fromFormat(e,ct().Iq).valueOf())).flatMap((a=>{const l=s[a],c=He().MR(l,(e=>e.dateTime.valueOf())),d=(0,dt().Ki)(a);if(!d)return[];let u;(He().Xy(d,(0,ct().Lg)((0,m().r)()))||He().Xy(d,(0,ct().Ro)((0,m().r)())))&&(u="relative");const p=(0,lt().ZV)({value:d,intl:o,allowRelativeDates:Boolean(u),date_format:u});return[{key:p,items:c.flatMap((a=>{const s=new(he().G)(t,{table:y().iU,id:gt().Il(),spaceId:gt().Il()}),l={id:s.id,type:"external_object_instance",alive:!0,format:{bot_id:"",external_object_id:"",uri:a.uri,attributes:a.attributes},version:0,space_id:"",parent_id:"",parent_table:"block"};let c=null,d=null;const u=a.attributesById.title,p=a.attributesById.start,g=a.attributesById.end;return p&&g&&(0,ft().Gc)(p)&&(0,ft().Gc)(g)&&(c=(0,q.jsx)("div",{children:(0,q.jsxs)("span",{children:[(0,q.jsx)(Rt().r4,{style:{color:void 0,display:"inline"},attribute:p,dateStyle:"exact_time"})," - ",(0,q.jsx)(Rt().r4,{attribute:g,dateStyle:"exact_time",style:{color:void 0,display:"inline"}})]})}),d=(0,q.jsxs)("div",{children:[(0,q.jsx)("span",{children:(0,q.jsx)(Rt().ox,{style:{color:void 0,display:"inline"},store:s,attribute:u})}),c]})),{key:a.uri,render:e=>(0,q.jsx)(Ct().Z,{renderTooltip:()=>d,placement:wt().Placement.Left,textWrap:!0,render:a=>(0,q.jsx)(Z().Z,{...(0,_t().Z)(a||{},e),title:(0,ht().dD)({blockModel:mt().kk5.fromBlock(l),intl:o,index:0,style:{},disableHover:!0,disableLinks:!0,isAndroid:!1,classNames:[],theme:n,baseUrl:xt().default.domainBaseUrl,emojiType:"raw",currentUserId:t.currentUser.id,getRecordModel:s.getRecordModel,externalIntegrations:i,emojiData:r}),caption:c})}),action:t=>{(0,kt().ZP)({event:t.event,context:kt().Af.ButtonMouseDown,callback:()=>{e.addPage(a.uri)}})}}})),render:e=>(0,q.jsx)(W().Z,{...e,disableMobilePadding:!0,title:p})}]}));return l}({environment:M,intl:w,theme:I,externalIntegrations:j,results:J,addPage:e.addPage,emojiData:N}));const re={key:"loadingSpinner",render:t=>(0,q.jsx)(W().Z,{...t,disableMobilePadding:!0,title:(0,q.jsxs)("div",{style:{...f.addingPage,justifyContent:e.addingPage?"center":"flex-start"},children:[(0,q.jsx)(We().Z,{}),(0,q.jsx)("span",{style:{marginLeft:10},children:(0,q.jsx)(C()._H,{id:"connectedRelationPropertyMenuResults.fetchingData",defaultMessage:"Fetching data..."})})]})}),items:[]},ae=[];return"pending"===A||e.addingPage?ae.push(re):H?ae.push(te):ie.length>0?ae.push(...ie):v?ae.push(G):b?ae.push(Q):x?ae.push($):P?ae.push(Y):S&&0===o.length?ae.push(z):S&&o.length>0||ae.push(oe),(0,q.jsx)(ze().ZP,{type:ze().iW.Vertical,style:{padding:"4px 0px"},initialFocus:0,sections:[...o,...ae]})}function Yt(){return(0,q.jsx)("div",{style:{height:"100%",padding:_e().wI,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,q.jsx)(We().Z,{style:{margin:"0 auto"}})})}function Xt(e){const{collectionStore:t,targetCollectionStore:o,schema:n,property:i,showRight:a,disabled:s,style:l}=e,d=(0,r().VK)((()=>o.isSyncedCollection()),[o]),u=(0,r().VK)((()=>{const e=n[i];return Boolean(e&&c().NK(e))}),[n,i]);return(0,q.jsx)(W().Z,{...e,noTextOverflow:!0,isTitleUppercase:!1,right:a&&!d&&!u&&t&&(0,q.jsx)(Je().default,{collectionStore:t,targetCollectionStore:o,property:i,disabled:s}),style:{paddingTop:0,paddingBottom:4,...l},desktopTitleStyle:{height:19,alignItems:"center",marginTop:6,marginBottom:6,paddingLeft:12,paddingRight:9}})}const Jt=function(e){const t=(0,i().Fy)(),a=(0,r().qz)(void 0,o(692304).Z),s=(0,r().qz)(void 0,o(280977).Z),l=(0,Fe().D9)(e.searchQuery);return(0,n.useEffect)((()=>{!e.searchQuery||(0,He().Xy)(l,e.searchQuery)||t.isMobile||a.setState({...a.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}),[t.isMobile,a,l,e.searchQuery]),t.isMobile?(0,q.jsx)(go,{relationPropertyMenuResultProps:e,menuListStore:a,draggableListStore:s}):(0,q.jsx)(co,{relationPropertyMenuResultProps:e,menuListStore:a,draggableListStore:s})};function eo(e,t){const o=t[e];return Boolean(o&&"relation"===o.type&&1===o.limit)}function to(e){const{result:t,pointer:o,environment:n,relationPropertyMenuResultProps:i,canDragRow:r,isSharingEnabled:a,limitReached:s,propertyLimit:l}=e,{disabled:c,parentStore:d,collectionStore:u,collectionId:p,schema:g,targetCollectionStore:m,onAccept:h,property:f,propertySchema:y,blockPropertyValueOverlayStore:S,onClickActionButton:v,disableClickToNavigateToPage:b}=i,C=he().G.createChildStore(d,o);return{key:C.id,render:(e,i)=>{let{ref:h,...x}=e;const P=(0,q.jsx)(et().a,{...x,canDrag:r,limitReached:s,collectionStore:u,collectionId:p,schema:g,targetCollectionStore:m,relatedPageStore:C,disabled:c,isSelected:t.type===_e().Rt.SelectedPage,pageStore:d,property:f,propertySchema:y,rowType:"popup",onActionButtonClick:()=>v(t),blockPropertyValueOverlayStore:S,propertyLimit:l,onOpenPageButtonClick:()=>{w().O({relationPointers:[o],relatedPageStore:C,environment:n,from:"relation_property"})},disableClickToNavigateToPage:b});return a?(0,q.jsx)(oo,{originElement:P,pageStore:C,result:t,focused:x.focused,isSelected:t.type===_e().Rt.SelectedPage,onFocus:i.onFocus,onClickActionButton:v}):P},action:e=>{a&&t.type!==_e().Rt.SelectedPage||h(t,tt().DJ(e.event))}}}function oo(e){let{originElement:t,pageStore:o,result:s,focused:l,onFocus:c,isSelected:d,onClickActionButton:u}=e;const p=(0,i().O7)(),g=(0,i().Fy)(),m=(0,at().u)(),h=(0,r().VK)((()=>it().mk({store:o,environment:p,trustedDomainsStore:m})),[o,p,m]),[f,y]=(0,n.useState)(!1),S=(0,a().yK)((e=>({unselectedHeader:{paddingRight:10,paddingLeft:10,paddingTop:6,paddingBottom:6,borderRadius:6,color:e.text.uiYellowPrimary,backgroundColor:e.tint.uiYellow,fontSize:14,fontWeight:400},selectedHeader:{paddingRight:8,paddingLeft:8,paddingTop:4,color:e.mediumTextColor,fill:e.mediumIconColor,fontSize:14,fontWeight:400},pageTitleWrapper:{display:"inline",padding:2},icon:{display:"inline-block",marginRight:4,width:12,height:12},title:{display:"inline",overflow:"hidden",wordBreak:"break-word",textWrap:"balance",fontWeight:500},popupContainer:{padding:16,display:"flex",flexDirection:"column",height:"100%"},permissionsListContainer:{flex:1,overflow:"auto"},generalAccessPermissionListContainer:{borderTop:`0.5px solid ${e.darkDividerColor}`,paddingTop:8},confirmButton:{width:"100%"}})),[]);return g.isPhone?(0,q.jsxs)("div",{onClick:e=>{d||y(!0)},children:[t,(0,q.jsx)(E().ZP,{popupType:E().kQ.SlideUp,enableOutsideClickDismiss:!0,onDismiss:()=>y(!1),open:f,style:{borderTopLeftRadius:24,borderTopRightRadius:24,maxHeight:"66%"},originRect:new DOMRect(0,0,0,0),render:()=>(0,q.jsxs)("div",{style:S.popupContainer,children:[(0,q.jsx)(ot().Qo,{children:d?(0,q.jsx)("div",{style:S.selectedHeader,children:(0,q.jsx)(C()._H,{id:"relationPropertyMenu.sharingEnabled.permissionsList.selectedHeader",defaultMessage:"This task is currently shared with everyone who has access to {title}",values:{title:(0,q.jsxs)("div",{style:S.pageTitleWrapper,children:[(0,q.jsx)(O().Z,{icon:o.getIcon(),isEmptyPage:!1,size:12,disabled:!0,style:S.icon}),(0,q.jsx)(K().Z,{store:o,style:S.title})]})}})}):(0,q.jsx)("div",{style:S.unselectedHeader,children:(0,q.jsx)(C()._H,{id:"relationPropertyMenu.sharingEnabled.permissionsList.unselectedHeader",defaultMessage:"By selecting this project, only the people below will have access to this task:"})})}),(0,q.jsx)("div",{style:S.permissionsListContainer,children:(0,q.jsx)(nt().Z,{store:o,showFooter:!1,showPermissionInheritanceBanner:!1,calculatedPermissions:{...h,showRestrictedPermissionBanner:!1,showSitePublicPermission:!1,showPublicShareLinkPermission:!1,showTeamPermission:!0,showSpacePermission:!0},buttonPopupStore:void 0,permissionItemArgs:{location:"relation_menu",shouldDisable:!0}})}),(0,q.jsx)("div",{style:S.generalAccessPermissionListContainer,children:(0,q.jsx)(nt().X,{store:o,calculatedPermissions:h,permissionItemArgs:{location:"relation_menu",shouldDisable:!0}})}),(0,q.jsx)(qe().Z,{isLarge:!0,style:S.confirmButton,onClick:()=>u(s),children:(0,q.jsx)(C()._H,{id:"relationPropertyMenu.sharingEnabled.confirmButton",defaultMessage:"Confirm"})})]})})]}):(0,q.jsx)($e().Z,{focused:l,onFocus:c,disableDefaultClick:!0,renderOrigin:(e,o)=>(0,q.jsx)(Ne().ZP,{...e,ref:o,title:t,textWrapperStyle:{margin:0},showExtensionArrow:!1}),renderExtension:e=>(0,q.jsxs)("div",{...e,children:[(0,q.jsx)(ot().Qo,{children:d?(0,q.jsx)("div",{style:S.selectedHeader,children:(0,q.jsx)(C()._H,{id:"relationPropertyMenu.sharingEnabled.permissionsList.selectedHeader",defaultMessage:"This task is currently shared with everyone who has access to {title}",values:{title:(0,q.jsxs)("div",{style:S.pageTitleWrapper,children:[(0,q.jsx)(O().Z,{icon:o.getIcon(),isEmptyPage:!1,size:12,disabled:!0,style:S.icon}),(0,q.jsx)(K().Z,{store:o,style:S.title})]})}})}):(0,q.jsx)("div",{style:S.unselectedHeader,children:(0,q.jsx)(C()._H,{id:"relationPropertyMenu.sharingEnabled.permissionsList.unselectedHeader",defaultMessage:"By selecting this project, only the people below will have access to this task:"})})}),(0,q.jsx)(nt().Z,{store:o,showFooter:!1,showPermissionInheritanceBanner:!1,calculatedPermissions:{...h,showRestrictedPermissionBanner:!1,showSitePublicPermission:!1,showPublicShareLinkPermission:!1,showTeamPermission:!0,showSpacePermission:!0},buttonPopupStore:void 0,permissionItemArgs:{location:"relation_menu",shouldDisable:!0}})]})})}function no(e){const{canDrag:t,property:o,schema:n,totalRelatedPages:i}=e;return t&&!eo(o,n)&&i>1}function io(e){const{numRelatedPages:t,integrationId:o,limit:n}=e;return n&&1===n?(0,q.jsx)(C()._H,{id:"database.relationProperty.relatedPages.limit.subHeader",defaultMessage:"Selected"}):o===g().f3||o===g().mQ?(0,q.jsx)(C()._H,{id:"database.relationProperty.relatedGoogleDriveOrFigmaFiles.subHeader",defaultMessage:"{count, plural, one {{count} linked file} other {{count} linked files}}",values:{count:t}}):o===g().U9?(0,q.jsx)(C()._H,{id:"database.relationProperty.relatedGithubPages.subHeader",defaultMessage:"{count, plural, one {{count} linked PR} other {{count} linked PRs}}",values:{count:t}}):(0,q.jsx)(C()._H,{id:"database.relationProperty.relatedPages.subHeader",defaultMessage:"{count} selected",values:{count:t}})}function ro(e){const{loading:t,numRelatedPages:o,numUnrelatedPages:n,limit:i}=e;if(!t||0!==o||0!==n)return 0===n?(0,q.jsx)(C()._H,{id:"database.relationProperty.noResults.subHeader",defaultMessage:"No results"}):0===o?void 0:i&&1===i?(0,q.jsx)(C()._H,{id:"database.relationProperty.changeSelection.subHeader",defaultMessage:"Change selection"}):(0,q.jsx)(C()._H,{id:"database.relationProperty.selectMore.subHeader",defaultMessage:"Select more"})}const ao=(0,C().vU)({selected:{id:"database.relationProperty.sharing.selected.subHeader",defaultMessage:"Selected"},unselected:{id:"database.relationProperty.sharing.unselected.subHeader",defaultMessage:"Possible choices"}});function so(e){const{targetCollectionStore:t,collectionStore:o,schema:n,property:i,canConfigureCollection:r,numRelatedPages:a,handleClearProperty:s,overlayMode:l,index:c,blockPropertyValueOverlayStore:d}=e;return{key:"backlog",render:e=>(0,q.jsx)(Xt,{...e,collectionStore:o,schema:n,targetCollectionStore:t,property:i,showRight:0===a||"add"===(null==l?void 0:l.type),disabled:!r,style:{paddingBottom:0,paddingTop:0}}),items:[{key:"sprints_backlog",render:e=>(0,q.jsx)(Xe,{focused:e.focused,onMouseEnter:e.onMouseEnter,targetCollectionStore:t,onClick:s,isSection:!1,index:c,blockPropertyValueOverlayStore:d}),action:()=>{s&&s()}}]}}function lo(e){let{relationPropertyMenuResultProps:t,menuListStore:o,draggableListStore:a}=e;const{results:s,onDrag:c,parentStore:d,collectionStore:u,targetCollectionStore:p,property:g,canDrag:m,canConfigureCollection:h,loading:f,onCreatePage:y,overlayMode:S,disabled:v,schema:b,searchQuery:x,index:P,handleClearProperty:R,blockPropertyValueOverlayStore:k,relationPropertyMenuStore:_,addPage:M,addingPage:w}=t,I=(0,i().O7)(),j=(0,n.useCallback)(((e,t)=>function(e,t,o,n){n&&n(e),Ue().sv({store:o,focus:{section:0,indexLocal:t.endPosition,indexGlobal:t.endPosition,footerFocused:!1}})}(e,t,o,c)),[o,c]),{device:T}=I,L=(0,C().YB)(),D=b[g],V=Boolean("relation"===(null==D?void 0:D.type)&&D.connectedRelation),Z=(0,ae().a)(D),A=(0,r().VK)((()=>function(e,t,o){const n=e.getDatabaseType()===l().p$;return t?{getCanDragRow:()=>!1,getRelatedSectionHeaderTitle:()=>o.formatMessage(ao.selected),getUnrelatedSectionHeaderTitle:()=>o.formatMessage(ao.unselected),getFooterSection:()=>{}}:n?{getCanDragRow:()=>!1,getRelatedSectionHeaderTitle:()=>{},getUnrelatedSectionHeaderTitle:()=>{},getFooterSection:so}:{getCanDragRow:no,getRelatedSectionHeaderTitle:io,getUnrelatedSectionHeaderTitle:ro,getFooterSection:()=>{}}}(p,Z,L)),[Z,p,L]),F=(0,r().VK)((()=>{if(k.state.isOpen)return(0,B().vp)(D,k.state.formQuestionStore)}),[D,k]),[H,U]=(0,r().VK)((()=>{const e=[],o=[],n=s.filter((e=>e.type===_e().Rt.SelectedPage)).length;for(const i of s)if(i.type===_e().Rt.SearchPage){const e=i.store,r=Boolean(F&&n>=F);e.isTemplate()||o.push(to({environment:I,isSharingEnabled:Z,result:i,pointer:e.pointer,relationPropertyMenuResultProps:t,canDragRow:!1,limitReached:r,propertyLimit:F}))}else if(i.type===_e().Rt.SelectedPage){const o=A.getCanDragRow({canDrag:m,property:g,schema:b,totalRelatedPages:n});e.push(to({environment:I,result:i,pointer:i.store.pointer,relationPropertyMenuResultProps:t,canDragRow:o,isSharingEnabled:Z}))}return[e,o]}),[s,I,t,A,m,g,b,Z,F]),E=(0,r().VK)((()=>p.getFormat().integration_id),[p]),O=A.getRelatedSectionHeaderTitle({numRelatedPages:H.length,integrationId:E,limit:F}),K=[];if(H.length>0){const e=H.map((e=>e.key.toString()));K.push({key:"results",render:t=>(0,q.jsx)(Xt,{...t,title:O,collectionStore:u,schema:b,targetCollectionStore:p,property:g,showRight:"add"!==(null==S?void 0:S.type),disabled:!h,style:{paddingBottom:void 0===O?0:4},children:m&&!eo(g,b)&&e.length>1?(0,q.jsx)(Ee().ZP,{direction:"vertical",keys:e,renderKey:o=>t.children[e.indexOf(o)],onDrop:j,store:a}):t.children}),items:H})}if(!V&&(0===U.length&&0===H.length||U.length>0)){const e=A.getUnrelatedSectionHeaderTitle({loading:f,numRelatedPages:H.length,numUnrelatedPages:U.length,limit:F}),t=!f&&0===U.length&&!T.isMobile&&!V&&x;let o;t&&U.push({key:"empty",render:e=>(0,q.jsx)(G,{targetCollectionStore:p,title:x||"",focused:e.focused,onClick:y,isSection:!1,index:P}),action:()=>{y&&y()}}),(t||void 0===e)&&(o={paddingBottom:0});const n={key:"unrelated",render:t=>(0,q.jsx)(Xt,{...t,title:e,collectionStore:u,schema:b,targetCollectionStore:p,property:g,showRight:0===H.length||"add"===(null==S?void 0:S.type),disabled:!h,style:o}),items:U};"add"===(null==S?void 0:S.type)?K.unshift(n):K.push(n)}if(!T.isMobile&&H.length>0&&!v){const e=A.getFooterSection({targetCollectionStore:p,collectionStore:u,schema:b,property:g,canConfigureCollection:h,numRelatedPages:H.length,handleClearProperty:R,overlayMode:S,index:P,blockPropertyValueOverlayStore:k});e&&K.push(e)}return V?(0,q.jsx)($t,{blockPropertyValueOverlayStore:k,targetCollectionStore:p,sections:K,propertySchema:D,property:g,pageRecordStore:d,search:x,relationPropertyMenuStore:_,addPage:M,addingPage:w}):(0,q.jsx)(ze().ZP,{type:ze().iW.Vertical,store:o,style:{padding:"4px 0px"},initialFocus:I.device.isMobile?void 0:0,sections:K})}function co(e){let{relationPropertyMenuResultProps:t,menuListStore:o,draggableListStore:n}=e;const{results:i,loading:a,onScrollOffsetChange:s}=t,l=(0,r().VK)((()=>"on"===ge().default.getEligibleGroup({experimentId:"search_surfaces_relation_search",defaultGroup:"unassigned"})&&a),[a]),c=0===i.length;return(0,q.jsxs)(Ge().T,{style:{width:"100%",maxHeight:300,position:"relative",...c&&{marginTop:0}},type:rt().Z.Y,children:[c&&l&&(0,q.jsx)(uo,{}),(0,q.jsx)(lo,{relationPropertyMenuResultProps:t,menuListStore:o,draggableListStore:n}),s&&(0,q.jsx)(Qe().Z,{onChange:s}),a?l?(0,q.jsx)(po,{}):(0,q.jsx)(Yt,{}):null]})}function uo(){const e=(0,a().yK)((e=>({sectionName:{height:12,borderRadius:4,width:"20%",marginTop:15,marginLeft:13,marginBottom:6}})),[]);return(0,q.jsx)(Ke().Z,{style:e.sectionName})}const po=(0,n.memo)((function(e){const{count:t=10}=e,o=(0,a().yK)((e=>({wrapper:{marginRight:8,marginLeft:12},icon:{height:16,width:16,borderRadius:4},pageName:{height:15,borderRadius:4,marginLeft:-1}})),[]),n=Array.from({length:t},(()=>!0));return(0,q.jsx)("div",{style:o.wrapper,children:(0,q.jsx)(Oe().sg,{gap:12,children:n.map(((e,t)=>(0,q.jsx)("div",{children:(0,q.jsxs)(Oe().X2,{gap:8,alignItems:"center",children:[(0,q.jsx)(Ke().Z,{style:o.icon}),(0,q.jsx)(Ke().Z,{style:{...o.pageName,width:He().UP(["30%","40%","43%","45%","48%","50%","54%","55%","60%"])}})]})},`relation-result-shimmer-${t}`)))})})}));function go(e){let{relationPropertyMenuResultProps:t,menuListStore:o,draggableListStore:i}=e;const{results:r,loading:a,resultsType:s,schema:l,property:c,blockPropertyValueOverlayStore:d,targetCollectionStore:u,parentStore:p,searchQuery:g,relationPropertyMenuStore:m,addPage:h,addingPage:f}=t,y=0===r.length,S=l[c];return Boolean("relation"===(null==S?void 0:S.type)&&S.connectedRelation)&&y?(0,q.jsx)("div",{style:{marginTop:20},children:(0,q.jsx)($t,{blockPropertyValueOverlayStore:d,targetCollectionStore:u,sections:[],propertySchema:S,property:c,pageRecordStore:p,search:g,relationPropertyMenuStore:m,addPage:h,addingPage:f})}):(0,q.jsxs)(n.Fragment,{children:[y&&!a&&"existing"===s?void 0:(0,q.jsx)(lo,{relationPropertyMenuResultProps:t,menuListStore:o,draggableListStore:i}),a&&(0,q.jsx)(Yt,{})]})}const mo=(0,o(827282).IU)("questionMarkFilled",{viewBox:"0 0 14 14",svg:(0,q.jsx)("path",{d:"M7 14C6.04379 14 5.14248 13.817 4.29608 13.451C3.45425 13.085 2.71078 12.5794 2.06569 11.9343C1.42059 11.2892 0.915033 10.5458 0.54902 9.70392C0.183007 8.85752 0 7.95621 0 7C0 6.04379 0.183007 5.14477 0.54902 4.30294C0.915033 3.45654 1.4183 2.71078 2.05882 2.06569C2.70392 1.42059 3.44739 0.915033 4.28922 0.54902C5.13562 0.183007 6.03693 0 6.99314 0C7.94935 0 8.85065 0.183007 9.69706 0.54902C10.5435 0.915033 11.2892 1.42059 11.9343 2.06569C12.5794 2.71078 13.085 3.45654 13.451 4.30294C13.817 5.14477 14 6.04379 14 7C14 7.95621 13.817 8.85752 13.451 9.70392C13.085 10.5458 12.5794 11.2892 11.9343 11.9343C11.2892 12.5794 10.5435 13.085 9.69706 13.451C8.85523 13.817 7.95621 14 7 14ZM6.86275 8.46863C7.04118 8.46863 7.18072 8.42059 7.28137 8.32451C7.38203 8.22386 7.43235 8.10261 7.43235 7.96078C7.43235 7.94706 7.43235 7.93333 7.43235 7.91961C7.43235 7.90131 7.43235 7.88758 7.43235 7.87843C7.43235 7.67712 7.49183 7.50556 7.61078 7.36373C7.72974 7.21732 7.91275 7.06405 8.1598 6.90392C8.50294 6.67974 8.78431 6.44412 9.00392 6.19706C9.22811 5.95 9.3402 5.61373 9.3402 5.18824C9.3402 4.79477 9.23497 4.46536 9.02451 4.2C8.81405 3.93007 8.53726 3.72647 8.19412 3.58922C7.85556 3.45196 7.48497 3.38333 7.08235 3.38333C6.46928 3.38333 5.97059 3.50458 5.58627 3.74706C5.20654 3.98954 4.96634 4.27549 4.86569 4.6049C4.84739 4.6598 4.83137 4.71699 4.81765 4.77647C4.8085 4.83595 4.80392 4.89543 4.80392 4.9549C4.80392 5.11046 4.85654 5.2317 4.96176 5.31863C5.06699 5.40098 5.17909 5.44216 5.29804 5.44216C5.41699 5.44216 5.51765 5.41699 5.6 5.36667C5.68235 5.31177 5.75556 5.24314 5.81961 5.16078L5.94314 4.98922C6.03007 4.85196 6.12843 4.73529 6.23824 4.63922C6.34804 4.54314 6.46928 4.46993 6.60196 4.41961C6.73464 4.36928 6.87876 4.34412 7.03431 4.34412C7.35458 4.34412 7.61078 4.42647 7.80294 4.59118C7.99967 4.75588 8.09804 4.9732 8.09804 5.24314C8.09804 5.48562 8.02255 5.68464 7.87157 5.8402C7.72059 5.99118 7.48954 6.17418 7.17843 6.38922C6.9268 6.56765 6.71634 6.76209 6.54706 6.97255C6.37778 7.18301 6.29314 7.46438 6.29314 7.81667C6.29314 7.83039 6.29314 7.84641 6.29314 7.86471C6.29314 7.87843 6.29314 7.89216 6.29314 7.90588C6.29314 8.28105 6.48301 8.46863 6.86275 8.46863ZM6.84216 10.5755C7.04804 10.5755 7.22647 10.5046 7.37745 10.3627C7.53301 10.2209 7.61078 10.0471 7.61078 9.84118C7.61078 9.63529 7.53529 9.46144 7.38431 9.31961C7.23333 9.1732 7.05261 9.1 6.84216 9.1C6.63627 9.1 6.45784 9.1732 6.30686 9.31961C6.15588 9.46601 6.08039 9.63987 6.08039 9.84118C6.08039 10.0471 6.15588 10.2209 6.30686 10.3627C6.46242 10.5046 6.64085 10.5755 6.84216 10.5755Z"})});var ho=()=>o(545914),fo=()=>o(955620),yo=()=>o(348141),So=()=>o(715139),vo=()=>o(1910),bo=()=>o(708518),Co=()=>o(543631);function xo(e){let{onConfirm:t,onClosed:o,currentBlockTitle:s,blockWithExistingRelationTitle:l,canAccessBlockWithExistingRelation:c}=e;const d=s?fo().Jcv(s):void 0,u=c&&l?fo().Jcv(l):void 0,p=(0,i().O7)(),g=(0,r().VK)((()=>{const{currentUserSettingsStore:e}=pe().default.state;return e}),[]),[m,h]=n.useState(!1),f=(0,Fe().Z_)(m,100,((e,t)=>e===t));n.useEffect((()=>{if(!g)return;const e=f?Date.now():null;T().createAndCommit({environment:p,userAction:"twoWayWithLimitAddRelationConfirmationDialog.setDismissModalForever",canUndo:!0,perform:t=>{yo().d2({userSettingsStore:g,transaction:t,data:{relation_limit_confirmation_dialog_dismissed_at:e}})}})}),[f,g,p]);const y=(0,n.useCallback)((()=>{t(),o()}),[t,o]),S=(0,a().yK)((e=>({checkBoxContainer:{display:"flex",flexDirection:"row",alignItems:"center",gap:4,flexGrow:0,alignSelf:"center",marginTop:24,color:e.text.secondary,fontSize:14,lineHeight:"20px"},questionMarkButton:{display:"inline-block",width:14,height:14,marginLeft:4,paddingTop:2},questionMarkIcon:{fill:e.icon.secondary}})),[]),v=(0,C().YB)();return(0,q.jsx)(bo().Z,{open:!0,render:()=>(0,q.jsx)(q.Fragment,{children:(0,q.jsx)(Co().ZP,{width:300,title:(0,q.jsx)(C()._H,{defaultMessage:"Are you sure you want to link this page to {currentBlockTitleText}",id:"twoWayLimitAddRelationConfirmationDialog.title",values:{currentBlockTitleText:d}}),subtitle:(0,q.jsxs)(q.Fragment,{children:[c&&u?(0,q.jsx)(C()._H,{defaultMessage:"This will unlink it from {blockWithExistingRelationTitleText}.",id:"twoWayLimitAddRelationConfirmationDialog.subtitle",values:{blockWithExistingRelationTitleText:u}}):(0,q.jsx)(C()._H,{defaultMessage:"This will unlink it from another page in this database.",id:"twoWayLimitAddRelationConfirmationDialog.subtitleWithNoAccessToOtherPage"}),(0,q.jsx)(Ct().Z,{renderTooltip:()=>(0,q.jsx)(C()._H,{defaultMessage:"Pages from this database can only be linked to one record.",id:"twoWayLimitAddRelationConfirmationDialog.tooltip.noAccess"}),render:e=>(0,q.jsx)(vo().Z,{...e,style:S.questionMarkButton,ariaLabel:v.formatMessage({defaultMessage:"Pages from this database can only be linked to one record.",id:"twoWayLimitAddRelationConfirmationDialog.subtitle.questionMark.ariaLabel"}),icon:mo,iconStyle:S.questionMarkIcon})})]}),confirmText:(0,q.jsx)(C()._H,{defaultMessage:"Continue",id:"twoWayLimitAddRelationConfirmationDialog.primaryButton.text"}),onConfirm:y,onDismiss:o,radioOptions:[],icon:ho().v,footer:(0,q.jsxs)("div",{style:S.checkBoxContainer,children:[(0,q.jsx)(So().Z,{checked:m,onClick:()=>h(!m),size:14,id:"twoWayLimitAddRelationConfirmationDialog.doNotShowAgain"}),(0,q.jsx)("label",{htmlFor:"twoWayLimitAddRelationConfirmationDialog.doNotShowAgain",children:(0,q.jsx)(C()._H,{defaultMessage:"Don't ask again",id:"twoWayLimitAddRelationConfirmationDialog.dontAskAgain.checkbox.label"})})]})})})})}function Po(){const{blockStore:e,schema:t,property:o,format:a}=(0,n.useContext)(D().m),s=(0,i().O7)(),u=(0,n.useMemo)((()=>new(Le().Z)),[]),g=(0,r().VK)((()=>function(e){const{environment:t,blockStore:o,schema:n,property:i}=e;if(!o)return;const r=n[i];if("relation"!==(null==r?void 0:r.type))return;const a=c().j0(r);if(!a)return;const s=he().NW.createChildStore(o,a);if(!s)return;const l=s.getParentId();if(!l)return;const u=he().G.createChildStore(s,{table:y().iU,id:l});if(!u)return;const g=u.isDefined()?ue().Or(t,u):void 0,m=(0,p().Z)({pageId:u.id,pageModel:u.getModel(),baseUrl:g,pageVisitSource:void 0});return{property:i,propertySchema:r,targetCollectionStore:s,targetParentUrl:m,connectedRelationFlags:{isSyncedCollectionRelation:s.isSyncedCollection(),isGithubPrRelation:d().Kp(r),isGoogleDriveRelation:d().gg(r),isFigmaRelation:d().ic(r),isZendeskRelation:d().U8(r),isSalesforceRelation:d().R3(r),isSlackRelation:d().RB(r),isConnectedRelation:c().NK(r)}}}({environment:s,blockStore:e,schema:t,property:o})),[s,e,t,o]),m=(0,ae().a)(t[o]),h=(0,r().VK)((()=>null==g?void 0:g.targetCollectionStore.getDatabaseType()),[null==g?void 0:g.targetCollectionStore]),f=(0,r().VK)((()=>m?"sharing":h===l().p$?"sprint":"default"),[h,m]);return g?(0,q.jsx)(Te,{relationPropertyMenuStore:u,property:g.property,propertySchema:g.propertySchema,targetCollectionStore:g.targetCollectionStore,targetParentUrl:g.targetParentUrl,connectedRelationFlags:g.connectedRelationFlags,children:(0,q.jsx)(A().Z,{capture:!0,allowMenuList:!0,allowEsc:!0,allowUndo:!0,allowTabUntab:!0,render:()=>(0,q.jsx)(Ro,{type:f})})}):(0,q.jsx)(W().Z,{children:(0,Y().xE)(a)?(0,q.jsx)(U().Z,{title:(0,q.jsx)(C()._H,{defaultMessage:"You may not have access to the related database. Contact the form creator.",id:"database.relationPropertyMenu.formViewer.noAccess.message"})}):(0,q.jsx)(U().Z,{title:(0,q.jsx)(C()._H,{defaultMessage:"You may not have access to the related database.",id:"database.relationPropertyMenu.noAccess.message"})})})}function Ro(e){let{type:t}=e;const{blockStore:o,blockPropertyValueOverlayStore:a,overlayMode:s,isDisabled:l,schema:c,property:d,insertChar:u,format:p,onChange:g,analyticsFrom:m}=(0,n.useContext)(D().m),f=(0,n.useContext)(je),y=(0,i().O7)(),b=(0,i().Fy)(),P=(0,C().YB)(),R=(0,r().VK)((()=>null==f?void 0:f.relationPropertyMenuStore),[null==f?void 0:f.relationPropertyMenuStore]),k=Io(),{relationSearchLimit:_,relationSearchQuery:M}=(0,r().VK)((()=>({relationSearchQuery:null==R?void 0:R.state.searchQuery,relationSearchLimit:null==R?void 0:R.state.searchLimit})),[R]);(0,n.useEffect)((()=>{R&&0===k.length&&R.setState({searchPopupOpen:b.isMobile,searchQuery:u??"",searchLimit:Le().Z.limitIncrement,addingPage:!1})}),[]);const w=(0,r().VK)((()=>"on"===ge().default.getEligibleGroup({experimentId:"search_surfaces_relation_search",defaultGroup:"unassigned"})),[]),I=Boolean(w&&M&&M.length>0&&"sprint"!==t&&"sharing"!==t),j=(0,r().VK)((()=>(0,re().bC)(y).hasPublicAccessPermission),[y]),T=(0,r().VK)((()=>{const e=null==f?void 0:f.targetCollectionStore.getSpaceId();if(o&&e)return he().H2.createChildStore(o,{table:S().bx,id:e})}),[o,null==f?void 0:f.targetCollectionStore]),{results:L,isResultsLoading:B,fetchAdditionalServerResultsOnChange:Z,searchSessionId:A,searchSessionFlowNumber:F}=(0,se().s)({disable:!I,searchQuery:M??"",limit:_??20,type:v().n8.BlocksInCollection,source:"relation_menu",overrideSpaceStore:j?T:void 0,filters:{parentId:null==f?void 0:f.targetCollectionStore.id,includePublicPagesWithoutExplicitAccess:p===V().C.FormViewer}}),H="sprint"===t?we:Me,{searchResults:U,searchSessionFlowNumber:E,isSearchLoading:O}=function(e){const{forceDisable:t,getSearchResults:o}=e,{blockPointers:a,isDisabled:s}=(0,n.useContext)(D().m),l=(0,i().O7)(),c=(0,n.useContext)(je),d=(0,n.useRef)(void 0),u=(0,Q().DK)(),p=(0,n.useRef)(0),g=(0,le().E)("collections_cached_relation_search"),{searchQuery:m,searchLimit:f}=(0,r().VK)((()=>({searchQuery:(null==c?void 0:c.relationPropertyMenuStore.state.searchQuery)??"",searchLimit:(null==c?void 0:c.relationPropertyMenuStore.state.searchLimit)??0})),[null==c?void 0:c.relationPropertyMenuStore]),y=(0,r().VK)((()=>m===d.current),[d,m]),[{status:S,value:v}]=(0,h().r5)((async()=>{if(s||t)return[];if(null==c||!c.propertySchema||null==c||!c.targetCollectionStore)return[];if(null!=c&&c.connectedRelationFlags.isGoogleDriveRelation||null!=c&&c.connectedRelationFlags.isFigmaRelation)return[];if(g&&u){const e=u.relationResultsCacheStore.getState(),t=e.get(c.property)??{},n=t[m];if(!n||Date.now()-n.timestamp>Le().Z.resultsCacheTTL||n.results.length<f){const n=await o({environment:l,query:{query:m,limit:f},targetCollectionStore:null==c?void 0:c.targetCollectionStore,propertySchema:null==c?void 0:c.propertySchema,blockPointers:a}),i=n.slice(0,f);return e.set(c.property,{...t,[m]:{timestamp:Date.now(),results:i}}),u.relationResultsCacheStore.emit(),n}return n.results}const e=await o({environment:l,query:{query:m,limit:f},targetCollectionStore:null==c?void 0:c.targetCollectionStore,propertySchema:null==c?void 0:c.propertySchema,blockPointers:a});return y||(d.current=m,p.current+=1),e}),[s,t,null==c?void 0:c.propertySchema,null==c?void 0:c.targetCollectionStore,null==c?void 0:c.connectedRelationFlags.isGoogleDriveRelation,null==c?void 0:c.connectedRelationFlags.isFigmaRelation,null==c?void 0:c.property,g,u,o,l,m,f,a,y],{debounce:de().vp}),b=(0,r().VK)((()=>"pending"===S),[S]);return{searchResults:v,searchSessionFlowNumber:p.current,isSearchLoading:b}}({getSearchResults:H,forceDisable:I}),K=(0,n.useRef)(A),W=(0,n.useRef)(0);W.current=E+F,(0,n.useEffect)((()=>{K.current=A,W.current=F}),[y,A,F]),(0,n.useEffect)((()=>($().j({environment:y,event:{eventName:"collections_relation_property_menu_open",eventProperties:{search_session_id:K.current,using_secondary_search_surfaces_hook:w}}}),()=>{$().j({environment:y,event:{eventName:"collections_relation_property_menu_close",eventProperties:{search_session_id:K.current,search_session_flow_number:W.current}}})})),[y,w]);const N=(0,r().VK)((()=>L.map((e=>({type:_e().Rt.SearchPage,store:e.store,key:e.id})))),[L]),z=(0,r().VK)((()=>(0,ie().Sr)(y)),[y]),G=w&&M&&M.length>0&&"default"===t?N:U,X=(0,n.useRef)(void 0);(0,n.useEffect)((()=>{if(Boolean(null==M?void 0:M.length))return;const e=O;!e||X.current?!e&&X.current&&G&&(ce().default.measure(X.current,{environment:y,data:{search_session_id:A}}),X.current=void 0):X.current=ce().default.mark("collection_relation_search_initial_results_loaded")}),[G,y,A,null==M?void 0:M.length,O]);const ee=!(((0,Y().xE)(p)&&z||(null==f?void 0:f.connectedRelationFlags.isFigmaRelation)||(null==f?void 0:f.connectedRelationFlags.isGoogleDriveRelation))??!1)&&"default"===t,[te,oe]=n.useState(null),ne=(0,Q().DK)(),ae=(0,n.useMemo)((()=>{if(!te)return null;const{blockWithExistingRelationTitle:e,currentBlockTitle:t,canAccessBlockWithExistingRelation:o}=te;return(0,q.jsx)(xo,{onConfirm:()=>{g(te.update),m&&x().eW(y,{from:m,...(0,J().Pn)(ne),target_collection_id:null==f?void 0:f.targetCollectionStore.id}),1===(null==f?void 0:f.propertySchema.limit)&&(null==a||a.setState({isOpen:!1}))},onClosed:()=>{oe(null)},currentBlockTitle:t,blockWithExistingRelationTitle:e,canAccessBlockWithExistingRelation:o})}),[m,a,te,ne,y,null==f?void 0:f.propertySchema.limit,null==f?void 0:f.targetCollectionStore.id,g]);if(!(f&&R&&c&&o&&a))return null;const ue={searchSessionId:A,shouldShowShimmers:w&&(B||O),onScrollSearchHookFn:Z,searchSessionFlowNumber:W.current};if(b.isMobile)return(0,Y().xE)(p)?(0,q.jsx)(wo,{searchResults:G,isDefaultSearchLoading:O,searchHookData:{...ue,shouldShowShimmers:!1},showChangeConfirmationDialog:oe}):(0,q.jsxs)(ko,{showChangeConfirmationDialog:oe,children:[(0,q.jsx)(wo,{searchResults:G,isDefaultSearchLoading:O,searchHookData:{...ue,shouldShowShimmers:!1},showChangeConfirmationDialog:oe}),ae]});let pe;switch(t){case"sharing":pe=xe(P,{propertyName:f.propertySchema.name});break;case"sprint":pe=function(e){return e.formatMessage(be.inputPlaceholder)}(P);break;default:pe=Ce({intl:P,connectedRelationFlags:f.connectedRelationFlags,overlayMode:s,disabled:l,format:p})}return(0,q.jsxs)(_o,{header:(0,q.jsx)(Ae,{inputPlaceholder:pe,showTargetDatabase:ee,addPage:()=>jo({environment:y,menuStore:R,blockPropertyValueOverlayStore:a,blockStore:o,schema:c,property:d,targetCollectionStore:f.targetCollectionStore})}),footer:(0,q.jsx)(Mo,{searchResultsLength:(null==G?void 0:G.length)??0,showFooterInViewMode:"sprint"===t}),children:[(0,q.jsx)(wo,{searchResults:G,isDefaultSearchLoading:O,searchHookData:ue,showChangeConfirmationDialog:oe}),ae]})}function ko(e){const{children:t,showChangeConfirmationDialog:o}=e,{collectionStore:s,property:l,schema:c,blockStore:d,blockPropertyValueOverlayStore:u,isDisabled:p,canConfigureCollection:m,blockPointers:h,analyticsFrom:y,overlayMode:S,onChange:v,onDismiss:b,format:P}=(0,n.useContext)(D().m),R=(0,n.useContext)(je),k=(0,i().O7)(),_=(0,Q().DK)(),M=Io(),w=(0,a().yK)((e=>({input:{color:e.mediumTextColor},menuTitle:{display:"flex"},databaseIcon:{display:"flex",marginLeft:2*_e().Qi},databaseTitle:{marginLeft:_e().Qi},addPageButton:{display:"flex",alignItems:"center"},plusIcon:{marginRight:8,width:16,height:16}})),[]),j=(0,r().VK)((()=>null==R?void 0:R.targetCollectionStore.getIcon()),[null==R?void 0:R.targetCollectionStore]),T=(0,r().VK)((()=>{const e=Boolean(me().default.bots.state.find((e=>e.integration_id===g().U9))),t=Boolean(me().default.bots.state.find((e=>e.integration_id===g().f3))),o=Boolean(me().default.bots.state.find((e=>e.integration_id===g().mQ)));return(null==R?void 0:R.connectedRelationFlags.isGithubPrRelation)&&!e||(null==R?void 0:R.connectedRelationFlags.isGoogleDriveRelation)&&!t||(null==R?void 0:R.connectedRelationFlags.isFigmaRelation)&&!o}),[null==R?void 0:R.connectedRelationFlags.isGithubPrRelation,null==R?void 0:R.connectedRelationFlags.isGoogleDriveRelation,null==R?void 0:R.connectedRelationFlags.isFigmaRelation]),L=(0,r().VK)((()=>Boolean(null==R?void 0:R.relationPropertyMenuStore.state.addingPage)),[null==R?void 0:R.relationPropertyMenuStore]),B=(0,r().VK)((()=>Boolean(null==R?void 0:R.relationPropertyMenuStore.state.searchPopupOpen)),[null==R?void 0:R.relationPropertyMenuStore]),V=(0,ae().a)(c[l]);if(!(s&&d&&u&&R))return null;const{relationPropertyMenuStore:A,propertySchema:F,targetCollectionStore:U,targetParentUrl:N,connectedRelationFlags:{isConnectedRelation:z}}=R,G=(0,q.jsx)("div",{style:w.menuTitle,children:(0,q.jsx)(C()._H,{id:"database.relationProperty.newRelation.targetDatabase",defaultMessage:"<regular>In</regular> {databaseWithIcon}",values:{regular:e=>e,databaseWithIcon:(0,q.jsxs)("div",{style:w.databaseIcon,children:[(0,q.jsx)(O().Z,{disabled:!0,icon:j,isEmptyPage:!1,size:_e().WO}),(0,q.jsx)(K().Z,{store:U,underline:!0,style:w.databaseTitle,maxLength:25})]})}})});return(0,q.jsxs)(H().Z,{menuType:oe().o.Modal,title:F.name,right:(0,q.jsx)(C()._H,{defaultMessage:"Done",id:"relationPropertyMenu.mobileMenuDone.button"}),onClickRight:b,children:[!z&&(0,q.jsx)(W().Z,{disableMobilePadding:!0,children:(0,q.jsx)(Z().Z,{focused:!1,title:G,showExtensionArrow:!1,onClick:()=>function(e){const{environment:t,targetParentUrl:o,analyticsFrom:n}=e;I().c4({environment:t,url:o}),n&&x().ZZ(t,{from:n})}({environment:k,targetParentUrl:N,analyticsFrom:y})})}),!T&&(0,q.jsx)(W().Z,{topBorder:!0,disableMobilePadding:!1,children:(0,q.jsx)(E().ZP,{popupType:E().kQ.SlideUp,open:B,origin:(0,q.jsx)(Z().Z,{focused:!1,title:(0,q.jsxs)("span",{style:w.addPageButton,children:[(0,f().R)(w.plusIcon),V?(0,q.jsx)(C()._H,{defaultMessage:"Select {name}",id:"relationPropertyMenu.add.button",values:{name:F.name}}):(0,q.jsx)(C()._H,{defaultMessage:"Add a page",id:"relationPropertyMenu.addAPage.button"})]}),onClick:()=>{var e;(e=A).setState({...e.state,searchPopupOpen:!0,searchLimit:Le().Z.limitIncrement})},style:w.input}),render:()=>t})}),(0,q.jsx)(Jt,{collectionStore:s,collectionId:s.id,targetCollectionStore:U,results:M,resultsType:"existing",property:l,schema:c,propertySchema:F,parentStore:d,disabled:p,canConfigureCollection:m,loading:!1,canDrag:!1,blockPropertyValueOverlayStore:u,onAccept:(e,t)=>function(e){const{environment:t,analyticsFrom:o,result:n,openInNew:i}=e;n.type===_e().Rt.SelectedPage&&Bo({environment:t,analyticsFrom:o,result:n,openInNew:i})}({environment:k,analyticsFrom:y,result:e,openInNew:t}),onClickActionButton:e=>Lo({environment:k,collectionContextStore:_,blockPropertyValueOverlayStore:u,result:e,blockPointers:h,onChange:v,analyticsFrom:y,overlayMode:S,propertySchema:F,targetCollectionStore:U,showChangeConfirmationDialog:o}),onCreatePage:e=>To({environment:k,collectionContextStore:_,relationPropertyMenuStore:A,blockPointers:h,onChange:v,index:e,propertySchema:F,targetCollectionStore:U}),handleClearProperty:()=>v({newValues:[],oldValues:h}),relationPropertyMenuStore:A,addPage:e=>jo({environment:k,menuStore:A,blockPropertyValueOverlayStore:u,blockStore:d,schema:c,property:l,targetCollectionStore:U,uri:e}),addingPage:L,format:P})]})}function _o(e){const{children:t,header:o,footer:i}=e,s=(0,n.useContext)(je),l=(0,r().VK)((()=>{var e;const t=Boolean(me().default.bots.state.find((e=>e.integration_id===g().U9))),o=(null==s?void 0:s.connectedRelationFlags.isGoogleDriveRelation)||(null==s?void 0:s.connectedRelationFlags.isFigmaRelation)||(null==s?void 0:s.connectedRelationFlags.isZendeskRelation)||(null==s?void 0:s.connectedRelationFlags.isSalesforceRelation)||(null==s?void 0:s.connectedRelationFlags.isSlackRelation),n=null===(e=pe().default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit();return(null==s?void 0:s.connectedRelationFlags.isGithubPrRelation)&&!t||o&&!n}),[null==s?void 0:s.connectedRelationFlags.isGithubPrRelation,null==s?void 0:s.connectedRelationFlags.isGoogleDriveRelation,null==s?void 0:s.connectedRelationFlags.isFigmaRelation,null==s?void 0:s.connectedRelationFlags.isZendeskRelation,null==s?void 0:s.connectedRelationFlags.isSalesforceRelation,null==s?void 0:s.connectedRelationFlags.isSlackRelation]),c=(0,a().yK)((e=>({menuContent:{overflow:"hidden",maxHeight:"70vh"}})),[]);return(0,q.jsx)(H().Z,{menuType:oe().o.Popup,header:!l&&o,footer:i,children:(0,q.jsx)("div",{style:c.menuContent,children:t})})}function Mo(e){const{searchResultsLength:t,showFooterInViewMode:o}=e,a=(0,n.useContext)(je),{blockPointers:s,onChange:l,overlayMode:c,isDisabled:d,insertChar:u}=(0,n.useContext)(D().m),p=(0,i().O7)(),g=(0,Q().DK)(),m=(0,r().VK)((()=>(null==a?void 0:a.relationPropertyMenuStore.state.searchQuery)??u??""),[null==a?void 0:a.relationPropertyMenuStore,u]);if(!o&&"view"===(null==c?void 0:c.type))return null;if(!a)return null;const{relationPropertyMenuStore:h,propertySchema:f,targetCollectionStore:y}=a;return f.connectedRelation||d||!y?null:0!==t&&m?(0,q.jsx)(G,{targetCollectionStore:y,title:m,onClick:e=>To({environment:p,collectionContextStore:g,relationPropertyMenuStore:h,blockPointers:s,onChange:l,index:e,propertySchema:f,targetCollectionStore:y}),focused:!1,isSection:!0,index:"add"===(null==c?void 0:c.type)?null==c?void 0:c.index:void 0}):null}function wo(e){const{searchResults:t,isDefaultSearchLoading:o,searchHookData:{shouldShowShimmers:s,onScrollSearchHookFn:l,searchSessionId:c,searchSessionFlowNumber:d},showChangeConfirmationDialog:p}=e,{blockPointers:g,collectionStore:h,collectionId:f,property:S,schema:v,blockStore:b,blockPropertyValueOverlayStore:P,isDisabled:R,canConfigureCollection:k,analyticsFrom:_,overlayMode:M,onChange:I,insertChar:j,format:T,onDismiss:L}=(0,n.useContext)(D().m),B=(0,n.useContext)(je),V=(0,i().O7)(),Z=(0,i().Fy)(),A=(0,C().YB)(),U=(0,Q().DK)(),E=(0,ae().a)(v[S]),{searchQuery:O,addingPage:K}=(0,r().VK)((()=>(null==B?void 0:B.relationPropertyMenuStore.state)??{searchQuery:j??"",addingPage:!1}),[null==B?void 0:B.relationPropertyMenuStore,j]),W=(0,a().yK)((e=>({inputMenu:{...Z.isAndroid&&{borderBottom:"none"}}})),[Z.isAndroid]),z=Io(),X=(0,r().VK)((()=>b?O?z.filter((e=>{const t=e.store,o=t.getModel();if(o)return(0,u().fY)({block:o,query:O,getRecordModel:t.getRecordModel,userTimeZone:(0,m().r)(),schema:v,intl:te().Z.getIntl(),onlyPropertyIds:["title"]})})):z:[]),[b,v,O,z]),J=(0,r().VK)((()=>!t&&0===X.length||s),[X.length,s,t]),ee=(0,r().VK)((()=>b?b.getSpaceId():void 0),[b]),ne=n.useRef(void 0);if(n.useEffect((()=>{J&&""!==O&&(ne.current=ce().default.mark("rum.relation_search_query"))}),[J,O]),n.useEffect((()=>{!J&&""!==O&&ne.current&&(ce().default.measure(ne.current,{environment:V,data:{search_session_id:c}}),ne.current=void 0)}),[J,V,c,O]),!(b&&ee&&P&&B))return null;const{relationPropertyMenuStore:re,propertySchema:se,targetCollectionStore:le,connectedRelationFlags:de}=B,ue=[...X];t&&t.forEach((e=>{if((e.type===_e().Rt.SelectedPage||e.type===_e().Rt.SearchPage)&&X.find((t=>(t.type===_e().Rt.SelectedPage||t.type===_e().Rt.SearchPage)&&t.store.id===e.store.id)))return;const t=se.limit?g.slice(0,1):g,o=e.type!==_e().Rt.NewPage?t.map((e=>e.id)).includes(e.store.id):void 0;o&&!O&&"add"===(null==M?void 0:M.type)||(e.type===_e().Rt.SearchPage&&o?ue.push({...e,type:_e().Rt.SelectedPage}):e.type!==_e().Rt.SelectedPage||o?ue.push(e):ue.push({...e,type:_e().Rt.SearchPage}))}));const me=ue.filter((e=>e.type===_e().Rt.SearchPage)),he=e=>{if(e.type===_e().Rt.SearchPage){const t=me.indexOf(e);if(-1===t)return;const o=1/(t+1),n={index:t,search_session_id:c,query_length:O.length,reciprocal_rank:o,search_session_flow_number:d};$().j({environment:V,event:{eventName:"collections_relation_search_item_click",eventProperties:n}}),ge().default.logEvent("collections_relation_search_mrr",o,n)}},fe=(0,q.jsx)(Jt,{collectionStore:h,collectionId:f,targetCollectionStore:le,results:ue,resultsType:0===ue.length&&0===z.length?"existing":"search",property:S,schema:v,propertySchema:se,parentStore:b,disabled:R,canConfigureCollection:k,loading:J,canDrag:!R&&0===O.length&&!(0,Y().xE)(T),disableClickToNavigateToPage:(0,Y().xE)(T),blockPropertyValueOverlayStore:P,onAccept:(e,t)=>{!function(e){const{environment:t,collectionId:o,collectionContextStore:n,blockPointers:i,result:r,analyticsFrom:a,isDisabled:s,onChange:l,overlayMode:c,openInNew:d,propertySchema:u,targetCollectionStore:p,blockPropertyValueOverlayStore:g,showChangeConfirmationDialog:m}=e;if(s)return;if(!p||!u)return;const{mainEditorCurrentBlockStore:h}=pe().default.state;if(!h)return;if(r.type===_e().Rt.SearchPage){const e=r.store,s={newValues:u.limit?[r.store.pointer]:"add"===(null==c?void 0:c.type)?[...i.slice(0,c.index),e.pointer,...i.slice(c.index)]:[...i,e.pointer],oldValues:i};w().Q({environment:t,store:g,update:s,collectionStore:null==n?void 0:n.collectionStore(),propertySchema:u}).then((e=>{var i,r;e?m(e):(l(s),a&&x().eW(t,{from:a,collection_id:o,collection_view_id:null==n||null===(i=n.collectionViewStore())||void 0===i?void 0:i.id,collection_view_block_id:null==n||null===(r=n.collectionViewBlockStore())||void 0===r?void 0:r.id,target_collection_id:null==p?void 0:p.id}))})).catch((e=>{console.error(e)}))}else r.type===_e().Rt.SelectedPage&&Bo({environment:t,analyticsFrom:a,result:r,openInNew:d})}({environment:V,collectionId:f,collectionContextStore:U,blockPointers:g,result:e,analyticsFrom:_,isDisabled:R,onChange:I,overlayMode:M,openInNew:t,propertySchema:se,targetCollectionStore:le,showChangeConfirmationDialog:p,blockPropertyValueOverlayStore:P}),he(e)},onClickActionButton:e=>{Lo({environment:V,collectionContextStore:U,blockPropertyValueOverlayStore:P,result:e,blockPointers:g,onChange:I,analyticsFrom:_,overlayMode:M,propertySchema:se,targetCollectionStore:le,showChangeConfirmationDialog:p}),he(e)},onScrollOffsetChange:e=>function(e){const{offsetFromBottom:t,store:o,isLoading:n,searchResults:i,onScrollSearchHookFn:r}=e,a=o.state.searchLimit+Le().Z.limitIncrement;if(t<Le().Z.incrementScrollOffset&&!n&&((null==i?void 0:i.length)??0)>=o.state.searchLimit){if(r)return void r(Le().Z.limitIncrement);o.setState({...o.state,searchLimit:a})}}({offsetFromBottom:e,store:re,isLoading:o,searchResults:t,onScrollSearchHookFn:l}),onDrag:e=>function(e){const{newPageIds:t,blockPointers:o,spaceId:n,onChange:i,analyticsFrom:r,environment:a}=e;i({newValues:t.map((e=>({id:e,spaceId:n,table:y().iU}))),oldValues:o}),r&&x().yT(a,{from:r})}({environment:V,newPageIds:e,blockPointers:g,spaceId:ee,onChange:I,analyticsFrom:_}),onCreatePage:e=>To({environment:V,collectionContextStore:U,relationPropertyMenuStore:re,blockPointers:g,onChange:I,index:e,propertySchema:se,targetCollectionStore:le}),handleClearProperty:()=>I({newValues:[],oldValues:g}),searchQuery:O,overlayMode:M,relationPropertyMenuStore:re,addPage:e=>jo({environment:V,menuStore:re,blockPropertyValueOverlayStore:P,blockStore:b,schema:v,property:S,uri:e,targetCollectionStore:le}),addingPage:K,format:T});if(!Z.isMobile)return fe;let ye;return ye=E?xe(A,{propertyName:se.name}):Ce({connectedRelationFlags:de,overlayMode:M,disabled:R,format:T,intl:A}),(0,q.jsx)(H().Z,{menuType:oe().o.Modal,title:(0,q.jsx)(C()._H,{defaultMessage:"Relation",id:"relationPropertyMenu.mobileRelationMenu.title"}),left:(0,q.jsx)(N().Z,{href:(0,ie().UY)("guides.relations"),analyticsFrom:"relation_menu"}),right:(0,q.jsx)(C()._H,{defaultMessage:"Done",id:"relationPropertyMenu.mobileDoneButton"}),header:(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(F().ZP,{value:O,disabled:R,onChange:e=>{const t=e.target.value;re.setState({...re.state,searchQuery:t,searchLimit:Le().Z.limitIncrement})},placeholder:ye,showClearButton:!0,focusInitial:!0,style:W.inputMenu}),O&&!R&&!de.isConnectedRelation&&(0,q.jsx)(G,{targetCollectionStore:le,title:O,onClick:e=>To({environment:V,collectionContextStore:U,relationPropertyMenuStore:re,blockPointers:g,onChange:I,index:e,propertySchema:se,targetCollectionStore:le}),focused:!1,isSection:!0})]}),onClickRight:()=>(0,Y().xE)(T)?L():re.reset(),children:fe})}function Io(){const e=(0,n.useContext)(je),{blockStore:t,blockPointers:o,overlayMode:i}=(0,n.useContext)(D().m),a=(0,r().VK)((()=>(null==e?void 0:e.relationPropertyMenuStore.state.searchQuery)??""),[null==e?void 0:e.relationPropertyMenuStore]);return(0,r().VK)((()=>t&&null!=e&&e.propertySchema&&null!=e&&e.targetCollectionStore&&(a||"add"!==(null==i?void 0:i.type))?d().j$({relationValue:o,propertySchema:null==e?void 0:e.propertySchema,getRecordModel:t.getRecordModel,includeDeleted:ge().default.checkGate({gateName:"relations_show_deleted"}),includeInvalidCollection:ge().default.checkGate({gateName:"relations_show_invalid_collection"}),includeNoAccess:ge().default.checkGate({gateName:"relations_show_no_access"})}).map((e=>{const o=he().G.createChildStore(t,e);return{key:e.id,type:_e().Rt.SelectedPage,store:o}})):[]),[t,o,i,a,null==e?void 0:e.propertySchema,null==e?void 0:e.targetCollectionStore])}async function jo(e){const{environment:t,menuStore:o,blockPropertyValueOverlayStore:n,blockStore:i,schema:r,property:a,uri:s,targetCollectionStore:l}=e;if(!l)return;const c=await _().F.clipboardActions.load(),u=l.getFormat().integration_id,p=me().default.externalAuthentications.state.filter((e=>e.integration_id===u))[0],m=l.getFormat().pattern_name,h=me().default.integrations.state.find((e=>e.id===u)),f=i instanceof he().G?i:void 0,S=i instanceof he().G?i.getPropertyStore(a):void 0;o.setState({...o.state,addingPage:!0});try{var v,x;if(!h||!f||!S)return;const e=d().rq(S.getValue()),i=s||o.state.searchQuery||"";if(!(0,ne().DB)({integration:h,patternName:m,url:i}))return void M().vC({items:[{label:(0,q.jsx)(C()._H,{id:"connectedRelationPropertyMenuResults.unsupportedUrlErrorDialog.copyDebuggingInformation",defaultMessage:"Copy debugging information"}),color:"blue",onAccept:()=>{c.copyString({environment:t,stringValue:JSON.stringify({botId:null==p?void 0:p.parent_id,url:i},null,2),copiedMessage:c.clipboardMessages.copiedToClipboard})}},{label:(0,q.jsx)(C()._H,{id:"connectedRelationPropertyMenuResults.unsupportedUrlErrorDialog.closeButton",defaultMessage:"Close"}),onAccept:()=>{}}],showCancel:!1,keepFocus:!1,message:(0,q.jsx)(C()._H,{id:"connectedRelationPropertyMenuResults.unsupportedUrlErrorDialog.title",defaultMessage:"This source is currently not supported. Please try a different source."})});const u=r[a],_=d().Kp(u),w=_?S.id:void 0,I=d().gg(u),B=d().ic(u),D=d().U8(u),V=d().A0(u),Z=d().R3(u),A=d().RB(u),F=V&&ge().default.checkGate({gateName:"cron_connected_relation"}),H=D&&ge().default.checkGate({gateName:"zendesk_ai_enabled"}),U=Z&&ge().default.checkGate({gateName:"salesforce_connected_relation"}),E=A&&ge().default.checkGate({gateName:"slack_connected_relation"}),O=(0,X().NP)(h.id),K=(null==h?void 0:h.id)===g().U9?null===(v=O[0])||void 0===v?void 0:v.id:null==p?void 0:p.parent_id,W=_||I||D||F||B||U||E?O.map((e=>e.id)):[K],N=await L().yp({environment:t,url:i,botIds:W,userDefinedExternalCollectionStore:l,relatedPageId:w});if(!N)return;const z=(null===(x=fe().subscriptionDataStoreInstance.state)||void 0===x?void 0:x.addOns)??[];H&&(0,b().de)(z)&&(k().callApi({eventName:"getZendeskTicketConversation",environment:t,data:{ticketUrl:i,spaceId:N.getSpaceId(),botId:W[0],pageId:S.id}}),$().K4(t,"zendesk_unfurl_ai")),T().createAndCommit({userAction:"connectedRelationPropertyMenuResults.createRelationPage",environment:t,canUndo:!0,perform:o=>{const i={id:N.id,table:y().iU,spaceId:N.getSpaceId()},r=null!=u&&u.limit?[i]:[...e,i],s=d().ow(r);j().sO({environment:t,store:S,value:s,transaction:o}),n&&n.state.isOpen&&n.state.collectionContextStore&&(P().rv({environment:t,collectionContextStore:n.state.collectionContextStore,block_id:f.id,property:a,property_type:"relation",from:"relation_section",isFromBulkActionsToolbar:!1,integration_id:h.id,action:"add",value_count:r.length}),R().W(t,{...(0,J().Pn)(n.state.collectionContextStore),from:"relation_menu",type:"page",integration_id:h.id,creating_block_id:f.id}))}}),o.reset()}finally{o.setState({...o.state,addingPage:!1})}}function To(e){const{environment:t,collectionContextStore:o,relationPropertyMenuStore:n,blockPointers:i,onChange:r,index:a,propertySchema:s,targetCollectionStore:l}=e,c=null==l?void 0:l.getSpaceId(),d=null==s?void 0:s.limit,u=(0,ee().Ii)({environment:t,table:y().iU,spaceId:c}),p=u.id,g=d?[u]:a?[...i.slice(0,a),u,...i.slice(a)]:[...i,u];r({newPage:{id:p,spaceId:c,name:n.state.searchQuery},newValues:g,oldValues:i}),R().W(t,{...(0,J().Pn)(o),from:"relation_menu",type:"page",target_collection_id:null==l?void 0:l.id,new_page_id:p,creating_block_id:p})}function Lo(e){const{environment:t,collectionContextStore:o,blockPropertyValueOverlayStore:n,result:i,blockPointers:r,onChange:a,analyticsFrom:s,overlayMode:l,propertySchema:c,targetCollectionStore:d,showChangeConfirmationDialog:u}=e,{mainEditorCurrentBlockStore:p}=pe().default.state;if(!p||!n.state.isOpen)return;const g=e=>{a(e),s&&x().eW(t,{from:s,...(0,J().Pn)(o),target_collection_id:null==d?void 0:d.id}),f&&(null==n||n.setState({isOpen:!1}))},m=null==c?void 0:c.limit,h=(0,Y().xE)(n.state.format),f=h?(0,B().vp)(c,n.state.formQuestionStore):m;if(i.type===_e().Rt.SearchPage){let e;if(1===f)e={newValues:[i.store.pointer],oldValues:r};else if(void 0===f||f&&r.length+1<=f){const t="add"===(null==l?void 0:l.type)?[...r.slice(0,l.index),i.store.pointer,...r.slice(l.index)]:[...r,i.store.pointer];e={newValues:t,oldValues:r}}e&&(h?g(e):w().Q({environment:t,store:n,update:e,collectionStore:null==o?void 0:o.collectionStore(),propertySchema:c}).then((t=>{t?u(t):g(e)})).catch((e=>{console.error(e)})))}else if(i.type===_e().Rt.SelectedPage){const e=r.filter((e=>e.id!==i.store.id));g({newValues:e,oldValues:r})}}function Bo(e){const{environment:t,result:o,openInNew:n,analyticsFrom:i}=e,{mainEditorCurrentBlockStore:r}=pe().default.state;if(!r)return;let a;const l=o.store;if(n){const e=l.isDefined()?ue().Or(t,l):void 0;a=(0,p().Z)({pageId:l.id,pageModel:l.getModel(),baseUrl:e,pageVisitSource:s().tY.LinkInPage})}else{const e=r.isDefined()?ue().Or(t,r):void 0;a=(0,p().Z)({pageId:r.id,pageModel:r.getModel(),baseUrl:e,peekViewBlockId:l.id,pageVisitSource:s().tY.LinkInPage})}I().c4({environment:t,url:a,openInNew:n}),i&&x().XX(t,{from:i,meta_click:Boolean(n)})}},454860:(e,t,o)=>{o.d(t,{Z:()=>i});class n extends(()=>o(263184))().default{getInitialState(){return{searchQuery:"",searchLimit:n.limitIncrement,searchPopupOpen:!1,addingPage:!1}}}n.limitIncrement=20,n.resultsCacheTTL=2*o(326966).hM,n.incrementScrollOffset=200;const i=n},314169:(e,t,o)=>{o.d(t,{L7:()=>b,iK:()=>C,qq:()=>x});o(821057),o(670560),o(667294);var n=()=>o(799891),i=()=>o(60836),r=()=>o(528514),a=()=>o(81954),s=()=>o(788860),l=()=>o(513670),c=()=>o(912732),d=()=>o(824462),u=()=>o(308186),p=()=>o(784234),g=()=>o(269299),m=()=>o(67961),h=()=>o(877807),f=()=>o(620218),y=()=>o(749826),S=()=>o(779733),v=o(785893);async function b(e){let{newRole:t,...o}=e;const n=o.oldPermissionItem,i=(0,l().d9)(n);return i.role=t,await C({newPermissionItem:i,...o})}async function C(e){const{oldPermissionItem:t,newPermissionItem:o,wasInherited:i,environment:s,store:l,sudoModeStore:u,restrictingVisibility:m,fromPermissionWrapper:h,trustedDomainsLoggingData:v}=e,b=(0,S().wZ)();if(!(0,r().Kf)(t,o))throw new Error("Permission type mismatch.");const C=!!u&&u.shouldSaveTransactionWithSudoMode(l),P=(0,r().nl)(t.role,o.role);if(i&&P!==o.role||m){return await x({environment:s,useSudoMode:C,store:l,permissionItem:o,fromPermissionWrapper:h,isRedesignEnabled:b,shouldInherit:!0,trustedDomainsLoggingData:v})}!l.isTopLevel()&&t.role!==o.role&&P!==t.role&&c().SM(s);const R="public_permission"===t.type&&"public_permission"===o.type&&"none"===t.role&&"none"!==o.role,k=("public_permission"===t.type&&"public_permission"===o.type&&!t.allow_search_engine_indexing&&o.allow_search_engine_indexing||R&&Boolean(y().default.checkGate({gateName:"include_nonindexed_public_content_for_scanning"})))&&Boolean(y().default.checkGate({gateName:"enable_public_content_scanning"}));return g().createAndCommit({userAction:"PermissionItem.handlePermissionItemChange",environment:s,canUndo:!0,useSudoMode:C,perform:t=>{const n=f().default.DO_NOT_USE_markLegacy("share_menu.update_page_permission_lag");p().l3({environment:s,store:l,permissionItems:[o],transaction:t,pagePermissionChangeLocation:e.location,metric:n,fromPermissionWrapper:h}),k&&t.postSubmitCallbacks.push((async e=>{e||await d().callApi({eventName:"enqueueScanContentTask",environment:s,data:{pagePointer:{id:l.id,table:"block",spaceId:(0,a().J)(l.pointer.spaceId)}}})}))}}),"trusted_domain_permission"===o.type&&n().log({level:"warning",from:"shareMenu.handlePermissionItemChange",type:"TrustedDomainPermissionChange",spaceId:(0,a().J)(l.pointer.spaceId),data:{miscDataToConvertToString:{message:"shareMenu.handlePermissionItemChange updating trusted domain permission",blockId:l.id,oldPermissionItem:t,newPermissionItem:o,trustedDomainsLoggingData:v}}}),!0}async function x(e){const{environment:t,useSudoMode:o,store:n,permissionItem:r,fromPermissionWrapper:a,isRedesignEnabled:l,shouldInherit:c,trustedDomainsLoggingData:d}=e,f="none"===(null==r?void 0:r.role)?{type:"remove",permissionItem:r}:{type:"restrict"};return!!("user_permission"===(null==r?void 0:r.type)&&(null==r?void 0:r.user_id)===t.currentUser.id||(l?await u().gt({message:(0,h().mX)(f,l),description:(0,v.jsx)(m().Z,{isSmall:!0,isMultiline:!0,children:(0,v.jsx)(s()._H,{id:"restrictedPermissionConfirmationModal.footer.whisperTextV2",defaultMessage:"Changing this will unlink this page from its parent, so it will no longer inherit share settings. Admins can still restore settings on unlinked pages."})}),acceptLabel:(0,h().nH)(f,l),icon:(0,i().Z)({height:24,width:24})}):await u().gt({message:(0,h().mX)(f),acceptLabel:(0,h().nH)(f),cancelLabel:(0,v.jsx)(s()._H,{id:"restrictedPermissionConfirmationModal.actionButton.close",defaultMessage:"Close"}),description:(0,v.jsx)(m().Z,{isSmall:!0,isMultiline:!0,children:(0,v.jsx)(s()._H,{id:"restrictedPermissionConfirmationModal.footer.whisperText",defaultMessage:"Admins will still be able to restore permissions from restricted pages."})})})).accept)&&(g().createAndCommit({userAction:"PermissionItem.onAccept",environment:t,canUndo:!0,useSudoMode:o,perform:e=>{p().Pk({environment:t,store:n,permissionItem:r,shouldInherit:c,transaction:e,fromPermissionWrapper:a,trustedDomainsLoggingData:d})}}),!0)}},960516:(e,t,o)=>{o.d(t,{ZG:()=>T,xF:()=>L,ZP:()=>H});var n=o(667294),i=()=>o(219727),r=()=>o(142735),a=()=>o(846550),s=()=>o(506347),l=()=>o(728670),c=()=>o(528514),d=()=>o(933868),u=()=>o(396136),p=()=>o(306164),g=()=>o(788860),m=()=>o(568017),h=()=>o(525496),f=()=>o(729775),y=()=>o(67961),S=()=>o(370005),v=()=>o(429725),b=()=>o(852465),C=()=>o(314169),x=()=>o(270895),P=()=>o(826955),R=()=>o(44556),k=()=>o(469203),_=()=>o(295334),M=()=>o(779733),w=()=>o(845465),I=o(785893);const j=function(e){const{store:t,isDisabled:o,isCurrentUserPermission:n}=e;return o?n?(0,I.jsx)(g()._H,{defaultMessage:"Your access is based on {inlineIconAndName}",id:"blockPermissionsSettings.restrictedPermissionsCurrentUser.tooltip",values:{inlineIconAndName:(0,I.jsx)(h().Z,{store:t,useInvertedColors:!0})}}):(0,I.jsx)(g()._H,{defaultMessage:"This access is based on {inlineIconAndName}",id:"blockPermissionsSettings.restrictedPermissions.tooltip",values:{inlineIconAndName:(0,I.jsx)(h().Z,{store:t,useInvertedColors:!0})}}):n?(0,I.jsx)(g()._H,{defaultMessage:"Your access is based on {inlineIconAndName}. Changing your access will restrict permissions of this page.",id:"blockPermissionsSettings.restrictedPermissionsCurrentUser.canEdit.tooltip",values:{inlineIconAndName:(0,I.jsx)(h().Z,{store:t,useInvertedColors:!0,maxLength:26})}}):(0,I.jsx)(g()._H,{defaultMessage:"This access is based on {inlineIconAndName}. Changing this access will restrict permissions of this page.",id:"blockPermissionsSettings.restrictedPermissions.canEdit.tooltip",values:{inlineIconAndName:(0,I.jsx)(h().Z,{store:t,useInvertedColors:!0,maxLength:26})}})},T=32,L=40,B=(0,g().vU)({fromLinkBox:{defaultMessage:"From {linkBoxWithPageTitle}",id:"pagePermissionItem.fromInheritedRecordPermissions.setting"}});function D(e){const{from:t,currentBlockStore:s,onClick:l,permissionItem:c,ignoreLocalHoverState:d,nonInheritedTooltip:g,inheritedTooltip:m,shouldDisable:h,isCollapsible:f,openRoleSelectMenuOnRender:y}=e,S=(0,i().Fy)(),v=(0,i().O7)(),b=(0,r().qz)(void 0,o(529048).Z),C=(0,r().VK)((()=>{const e=t.table;return e===u().iU?P().G.createChildStore(s,{table:u().iU,id:t.blockId}):e===p().e0?P().zX.createChildStore(s,{table:p().e0,id:t.teamId}):void(0,o(696459).t1)(e)}),[t,s]),x=(0,r().VK)((()=>(0,M().wZ)()),[]),[R,k]=(0,n.useState)(!1),T=(0,n.useCallback)((()=>{b.setState({...b.state,open:!0}),k(!0)}),[b]),L=(0,n.useCallback)((()=>{k(!1)}),[]);(0,n.useEffect)((()=>{y&&!b.state.open&&requestAnimationFrame((()=>{T()}))}),[y,T,b]);const B=x&&R,D=(0,r().VK)((()=>h||(0,_().zX)({permissionItem:c,store:s})),[h,c,s]),Z=(0,r().VK)((()=>C.id!==s.id),[C,s]),A=(0,o(560847).R)((e=>{l?l(e):D||b.setState({...b.state,open:!0})}),[b,l,D],o(949842).Af.PermissionItemClick),F=(0,r().VK)((()=>{const e=v.currentUser.id;return"user_permission"===c.type&&c.user_id===e}),[v,c]),H=(0,r().VK)((()=>B?null:x?Z?m||(0,I.jsx)(j,{store:C,isDisabled:D,isCurrentUserPermission:F}):g:(0,_().mN)(c)||(0,_().tr)(c)?null:Z?(0,I.jsx)(j,{store:C,isDisabled:D,isCurrentUserPermission:F}):g),[x,c,Z,g,m,C,D,F,B]),U=(0,a().yK)((t=>{const o=x?{...(0,w().ZY)({isMobile:S.isMobile}),...e.menuListItemProps?{width:"unset"}:{}}:{};return{disabledButton:{...o,cursor:"not-allowed"},button:o,pressedButton:{background:t.buttonPressedBackgroundLight},tooltip:{maxWidth:240}}}),[S.isMobile,x,e.menuListItemProps]);return(0,I.jsx)(o(654133).Z,{delayThreshold:0,renderTooltip:()=>H,textWrap:!0,disableTooltip:!Boolean(H)||B,forceRenderTooltipPopupComponent:x&&Boolean(H),style:U.tooltip,render:t=>{const n=(0,o(164079).Z)(t,{onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave});return e.menuListItemProps?(0,I.jsx)(o(827973).Z,{...e.menuListItemProps,onClick:A,disabled:D,ignoreLocalHoverState:d,pressed:!1,buttonStyle:D&&!x?U.disabledButton:U.button,textWrapperStyle:{marginLeft:0,marginRight:0},title:(0,I.jsx)(V,{...e,isDisabled:D,fromBlockStore:C,buttonPopupStore:b,isInherited:Z,onOpenMenu:T,onClose:L}),...n}):(0,I.jsx)(o(154186).Z,{disabled:D&&!f,mobileFeedback:S.isMobile,ignoreLocalHoverState:d,style:D&&!x?U.disabledButton:U.button,pressedStyle:x?U.pressedButton:void 0,onClick:A,...n,children:(0,I.jsx)(V,{...e,isDisabled:D,fromBlockStore:C,buttonPopupStore:b,isInherited:Z,onOpenMenu:T,onClose:L})})},placement:o(998901).Placement.Left})}function V(e){const{permissionItem:t,fromBlockStore:o,isCompact:n,iconStyle:s,icon:l,title:c,tag:d,subtitle:u,showInherited:p,isInherited:g,permissionRoleSelect:m,hideRoleSelectButton:h,renderTitleWithoutUILabelWrapper:f,onClose:S}=e,v=(0,i().O7)(),b=v.device.isMobile,C=(0,r().VK)((()=>function(e){return"user_permission"===e.type}(t)),[t]),x=(0,r().VK)((()=>(0,M().wZ)()),[]),{paddingLeft:P,paddingRight:R}=(0,r().VK)((()=>({paddingLeft:v.WindowSizeStore.getSafePaddingLeftCSS(x?b?0:w().gf:14),paddingRight:v.WindowSizeStore.getSafePaddingRightCSS(x?b?0:w().gf:14)})),[v.WindowSizeStore,b,x]),_=(0,a().yK)((e=>({container:{display:"flex",alignItems:"center",minHeight:n?44:x?void 0:52,...x?{height:b?void 0:w().o8}:void 0,paddingTop:b&&x?12:8,paddingBottom:b&&x?12:8,paddingLeft:P,paddingRight:R},icon:{flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center",width:x&&b?40:32,height:x&&b?40:32,marginRight:(0,w().bY)({isMobile:b}),...s},title:{marginRight:"auto",minWidth:0},labelWrapper:{display:"flex",flexDirection:"row"},label:{fontWeight:400},tag:{marginLeft:4},roleSelect:{display:"flex",alignItems:"center",flexShrink:0,marginLeft:8,...x&&{marginRight:w().gf}},button:{marginRight:-8,color:e.mediumTextColor,fontSize:b?14:12}})),[n,P,R,b,s,x]);return(0,I.jsxs)("div",{className:"notranslate",style:_.container,children:[(0,I.jsx)("div",{style:_.icon,children:l}),(0,I.jsxs)("div",{style:_.title,children:[(0,I.jsxs)("div",{style:_.labelWrapper,children:[f?c:(0,I.jsx)(y().Z,{style:C?void 0:_.label,children:(0,I.jsx)(k().s,{children:c})}),d&&(0,I.jsx)("div",{style:_.tag,children:d})]}),u&&(0,I.jsx)(y().Z,{style:e.subtitleStyle,isSmall:!0,children:u}),p&&g&&(0,I.jsx)(A,{store:o})]}),!h&&(0,I.jsx)("div",{style:_.roleSelect,children:F(t)?m:(0,I.jsx)(Z,{...e,onClose:S,permissionItem:t})})]})}function Z(e){const{isInherited:t,permissionItem:o,currentBlockStore:s,from:p,isDisabled:g,sudoModeStore:m,location:h,fromPermissionWrapper:f,onUpgradeButtonClick:y,onChange:v,onClose:b,onOpenMenu:x,upgradeButtonName:P,buttonPopupStore:R,isRemovableOverride:k,onChangeSuccess:_}=e,j=(0,i().O7)(),T=(0,r().VK)((()=>{var e;const t=s.getModel(),n=null===(e=s.getParentStore())||void 0===e?void 0:e.getModel();return(0,c().Gy)({record:t,parent:n,from:p,permissionItem:o})?(0,c().$5)({ancestors:l().DW(s.pointer,s.getRecordModel),from:p}):o.role}),[p,o,s]),L=(0,r().VK)((()=>(0,M().wZ)()),[]),B=(0,r().VK)((()=>s.getType()),[s]),D=(0,r().VK)((()=>{const e=j.currentUser.id;return d().jg(o)&&o.user_id===e}),[j,o]),V=(0,n.useCallback)((async e=>{let n=!1;const i={...o};i.role=T,n=v?await v(e):await(0,C().L7)({oldPermissionItem:i,newRole:e,wasInherited:t,environment:j,store:s,sudoModeStore:m,location:h,fromPermissionWrapper:f}),n&&(null==_||_(e))}),[o,T,t,j,s,m,h,f,v,_]),Z=(0,a().yK)((e=>({button:{marginRight:-8,color:e.mediumTextColor,fontSize:(0,w().fV)({environment:j,isRedesignEnabled:L})}})),[j,L]);return(0,I.jsx)(S().ZP,{role:T,table:u().iU,blockType:B,type:o.type,disabled:g,isUserPermission:D,onChange:V,onClick:L?x:void 0,onClose:L?b:void 0,onUpgradeButtonClick:y,upgradeButtonName:P,buttonPopupStore:R,buttonStyle:Z.button,showPermissionOverrideWarning:t&&!e.selectFooter,isRemovableOverride:k,footer:e.selectFooter,roleItemOverrides:e.roleItemOverrides,from:"shareMenu",header:e.selectHeader})}function A(e){const{store:t}=e,o=(0,i().O7)(),l=(0,g().YB)(),c=(0,r().VK)((()=>{if(t.table===u().iU)return(0,v().ZP)({store:t,fullyQualified:!1,pageVisitSource:s().tY.LinkInPage})}),[t]),d=(0,r().VK)((()=>(0,b().Y)(t)),[t]),p=(0,n.useCallback)((()=>{R().RF({environment:o,teamId:t.id,tab:x().a.Members,from:"permission_item"})}),[t.id,o]),S=(0,a().yK)((e=>({label:{lineHeight:1.4},linkBox:{display:"inline-flex",alignItems:"center",borderBottom:`0.5px solid ${m().ZP.mediumTextColor}`}})),[]);return(0,I.jsx)(y().Z,{isSmall:!0,style:S.label,children:l.formatMessage(B.fromLinkBox,{linkBoxWithPageTitle:(0,I.jsx)(f().Z,{inline:!0,href:c,onClick:d?p:void 0,innerStyle:S.linkBox,children:(0,I.jsx)(h().Z,{store:t,useInvertedColors:!1})})})})}function F(e){return"display_only_overview_permission"===e.type||"display_only_hidden_permission"===e.type||"display_only_inherited_permission"===e.type||"display_only_group_member_permission"===e.type}const H=n.memo(D)},998306:(e,t,o)=>{o.d(t,{Z:()=>c});var n=o(667294),i=()=>o(846550),r=()=>o(960516),a=o(785893);function s(e){let{type:t,isMobile:n,containerStyle:s,iconSize:c,...d}=e;const u=c??20,p=(0,i().yK)((e=>({container:{display:"flex",alignItems:"center",justifyContent:"center",...(0,o(845465).lw)({theme:e,size:c??(n?r().xF:r().ZG),useLargeBorderRadius:!0,useLightBackgroundColor:!0}),..."circle"===t&&{borderRadius:"100%"},...s}})),[s,n,t,c]);return(0,a.jsx)("div",{style:p.container,children:"function"===d.iconType?(0,a.jsx)(l,{iconFn:d.iconFn,iconStyle:d.iconStyle,innerIconSize:u}):"emoji"===d.iconType?(0,a.jsx)(o(754668).Z,{char:d.emoji,size:u}):"recordIcon"===d.iconType?(0,a.jsx)(o(943620).Z,{icon:d.icon,disabled:!0,isEmptyPage:!1,size:u,defaultIcon:(0,o(491630).C)()}):d.element})}function l(e){let{iconFn:t,iconStyle:o,innerIconSize:n}=e;return t((0,i().yK)((e=>({icon:{width:n,height:n,fill:e.mediumIconColor,...o}})),[o,n]).icon)}const c=n.memo(s)},295334:(e,t,o)=>{o.d(t,{E9:()=>a,ab:()=>c,mN:()=>s,tr:()=>l,zX:()=>r});var n=()=>o(933868),i=()=>o(95718);function r(e){let{permissionItem:t,store:o}=e;return"display_only_inherited_permission"!==t.type&&(!s(t)&&!o.canAdmin()||o.pathIsDead()||(0,i().Eo)(o))}function a(e){let{permissionItem:t,store:o}=e;return"block"!==t.from.table||t.from.blockId!==o.id}function s(e){return"display_only_overview_permission"===e.type}function l(e){return"display_only_inherited_permission"===e.type}function c(e){const t=e&&"from"in e?e.permissionItem:e;if(!t||!(0,n().YX)(t.role))return"private";return(0,n().tx)(t)&&"none"!==t.role?"unlisted":"open"}},845465:(e,t,o)=>{o.d(t,{J4:()=>r,S2:()=>m,SD:()=>d,ZY:()=>y,bY:()=>S,fV:()=>f,gf:()=>s,gr:()=>a,lw:()=>v,o8:()=>g,q5:()=>c,u0:()=>h,w5:()=>u});var n=()=>o(890085),i=()=>o(641506);const r=16,a=20,s=8,l=10,c=12,d=456,u=24,p=24,g=48;function m(e){let{theme:t,inheritanceBannerEnabled:o,isMobile:n}=e;return{background:t.tint.regular,borderRadius:8,paddingTop:8,paddingBottom:8,paddingLeft:8,paddingRight:8,marginLeft:n?0:r,marginRight:n?0:r,marginTop:4,marginBottom:8}}function h(e){let{isRedesignEnabled:t,isMobile:o}=e;return t?{...y({isMobile:o}),width:"unset",height:g,paddingTop:6,paddingBottom:6}:{}}function f(e){let{environment:t,isRedesignEnabled:o}=e;return o?(0,i().yv)(t,t.device.isMobile?"UISmall":"UIRegular"):(0,i().yv)(t,"UISmall")}function y(e){let{isMobile:t}=e;return{marginLeft:t?0:s,marginRight:t?0:s,borderRadius:l,transition:"background 150ms ease-out"}}function S(e){let{isMobile:t}=e;return t?12:10}function v(e){let{theme:t,colorOverride:o,size:i=p,useLargeBorderRadius:r,useLightBackgroundColor:a,icon:s}=e;return{background:o||(s&&(0,n().V2)(s)?(0,n().Pk)({icon:s,mode:t.mode,useLightGrayColor:a}):a?t.lightDividerColor:t.regularDividerColor),width:i,height:i,borderRadius:r?6:"0.25em"}}},877727:(e,t,o)=>{o.d(t,{QZ:()=>a,SV:()=>i,mq:()=>r});var n=()=>o(749826);function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n().default.checkGate({gateName:"workflow_templates_settings_dev",disableExposureLogging:e.disableExposureLogging})&&n().default.checkGate({gateName:"packaging_m3.1",disableExposureLogging:e.disableExposureLogging})}function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n().default.checkGate({gateName:"packaging_m3.1",disableExposureLogging:e.disableExposureLogging})}function a(e){return!e.device.isPhone}},999582:(e,t,o)=>{o.d(t,{Z:()=>r});class n extends(()=>o(263184))().default{getInitialState(){return{}}}const i=new n;o(947115).exposeDebugValue("SpaceWorkflowTemplateInstanceMapStore",i);const r=i},280210:(e,t,o)=>{o.d(t,{U_:()=>x,f6:()=>R,ii:()=>P});o(821057),o(409045),o(453627),o(994774),o(995194),o(520522),o(200082),o(379976),o(724224),o(761121),o(637133),o(241792);var n=o.n(o(402568)),i=()=>o(513670),r=()=>o(326966),a=()=>o(431595),s=()=>o(24945),l=()=>o(255933);const c={version:8,notion_version:0,variant:2},d={version:8,notion_version:1,variant:2},u=0,p=1,g=6,m=8,h=10,f=Date.UTC(2024,0,1);function y(e,t){if(e)return t[u]=255,t[u+1]=240|15&t[u+1],t;const o=Math.floor(((new Date).getTime()-f)/r().A0);if(o>=4096||o<0)throw new Error("Invalid offsetInDays.");return t[u]=o>>4,t[u+1]=o<<4&240|15&t[u+1],t}function S(e,t){if(e>=2**36||e<0)throw new Error("Invalid spaceShortId.");t[p]=240&t[p]|e/2**32&15;for(let o=0;o<4;o++)t[p+1+o]=e/2**(24-8*o)&255;return t}function v(e,t){const o=e?1:0;return t[g]=c.version<<4&240|c.notion_version<<1&14|1&o,t[m]=c.variant<<6&192|63&t[m],t}function b(e,t){if("block"===e)return t[h]=(0,s().ym)(e)|63&t[h],t;const o=(0,s().ym)(e);return t[h]=o>>8&127,t[h+1]=255&o,t}function C(e,t){const o=(0,s().Nq)(e);return t[h]=127&o|128&t[h],t}function x(e,t,o,n){const i=new Uint8Array(16),r=globalThis.crypto.getRandomValues(i);return o!==l().bx&&y(e,r),S(t,r),v(n,r),b(o,r),M(r)}function P(e,t,o,n){return x(e,t,o,n)}function R(e,t,o){return k(e,t,o)}function k(e,t,o){const r=n()(o),l=i().yo(r,2).map((e=>parseInt(e.join(""),16)));if((0,s().LV)(t)){if(void 0===e)throw new(a().D3)(`Deterministic ID for '${t}' must specify a space short id`)}else if(void 0!==e)throw new(a().D3)(`Deterministic ID for '${t}' should not provide a space short id`);const c=new Uint8Array(l);return e&&S(e,c),C(t,c),function(e){e[g]=240&d.version<<4|14&d.notion_version<<1|1&e[g],e[m]=192&d.variant<<6|63&e[m]}(c),M(c)}const _=new Array(256).fill(0).map(((e,t)=>t.toString(16).padStart(2,"0")));function M(e){let t=0;return _[e[t++]]+_[e[t++]]+_[e[t++]]+_[e[t++]]+"-"+_[e[t++]]+_[e[t++]]+"-"+_[e[t++]]+_[e[t++]]+"-"+_[e[t++]]+_[e[t++]]+"-"+_[e[t++]]+_[e[t++]]+_[e[t++]]+_[e[t++]]+_[e[t++]]+_[e[t++]]}},29488:(e,t,o)=>{function n(e){return`${e.table}:${e.id}`}o.d(t,{O:()=>n})},157955:(e,t,o)=>{o.r(t),o.d(t,{DEFAULT_MAX_RECURRENCE_DUPLICATION_PER_TASK:()=>I,MAXIMUM_DAILY_RECURRENCES_IN_PATH:()=>x,MAXIMUM_NESTED_RECURRENCE_LEVEL:()=>C,MAX_RECURRENCE_INTERVAL:()=>f,MAX_RECURRENCE_NUMBER_OF_RUNS:()=>y,RRULE_WEEKDAYS_MAP:()=>h,convertFromUnpersistedRecurrenceConfig:()=>B,convertToUnpersistedRecurrenceConfig:()=>j,getFormattedEndCondition:()=>w,getFormattedNextRecurrenceTime:()=>M,getNewEndTimestamp:()=>T,getNextDateUtc:()=>_,getRecurrenceAfter:()=>R,isRunningBetweenMidnightAnd3AM:()=>k,isValidRecurrenceInterval:()=>S,isValidRecurrenceNumberOfRuns:()=>v,rruleFromRecurrence:()=>b,templateAncestorsViolateRecurrenceNesting:()=>P});o(267602),o(653476),o(241792);var n=()=>o(730120);o(670560);function i(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),n=1;n<t;n++)o[n-1]=arguments[n];if(0===o.length)return e.map((e=>[e]));const r=[];for(const a of e)r.push(...i(o[0],...o.slice(1)).map((e=>[a,...e])));return r}var r=()=>o(696459),a=()=>o(326966),s=()=>o(803021),l=()=>o(646574),c=()=>o(998411),d=()=>o(578292);class u extends(()=>o(484885))().Ci{constructor(e,t){super(e,t)}after(e,t){return super.after(e,t)}}var p=()=>o(494616);const g=(0,o(788860).vU)({dateAtTime:{id:"automations.recurrenceHelpers.dateAtTime",defaultMessage:"{date} at {time}"},dateBetweenMidnightAnd3AM:{id:"automations.recurrenceHelpers.dateBetweenMidnightAnd3AM",defaultMessage:"{date} between 12–3 AM"},numberEndConditionDescription:{id:"automations.recurrenceHelpers.numberEndConditionDescription",defaultMessage:"{number, plural, one {After {number} run} other {After {number} runs}}"},noEndCondition:{id:"automations.recurrenceHelpers.noEndCondition",defaultMessage:"Never"}}),m={day:u.DAILY,week:u.WEEKLY,month:u.MONTHLY,year:u.YEARLY},h={MO:u.MO,TU:u.TU,WE:u.WE,TH:u.TH,FR:u.FR,SA:u.SA,SU:u.SU},f=99,y=999;function S(e){return(0,a().hj)(e)&&Number.isInteger(e)&&e>0&&e<=f}function v(e){return(0,a().hj)(e)&&Number.isInteger(e)&&e>0&&e<=y}function b(e){const{start_date:t,frequency:o,interval:n,weekdays:a,timezone:l,hour:c,minute:d}=e,p="week"===o&&a?a.map((e=>h[e])):void 0,g={};return(0,r().$K)(e.end_condition)&&("date"===e.end_condition.type?g.until=(0,s().pd)(e.end_condition.end_at):"number"===e.end_condition.type?g.count=e.end_condition.number_of_occurrences:(0,r().t1)(e.end_condition)),"month"===e.frequency&&(0,r().$K)(e.monthly_restriction)&&("monthdays"===e.monthly_restriction.type?g.bymonthday=e.monthly_restriction.monthdays:"weekdays_in_month"===e.monthly_restriction.type?g.byweekday=i(e.monthly_restriction.weekdays,e.monthly_restriction.week_numbers).map((e=>{let[t,o]=e;return h[t].nth(o)})):(0,r().t1)(e.monthly_restriction)),new u({freq:m[o],dtstart:(0,s().pd)(t),interval:n,byweekday:p,tzid:l,byhour:c??0,byminute:d??0,bysecond:0,...g})}const C=1,x=1;function P(e){var t;if(0===e.length)return{violatesConstraint:!1,templateNestingExceedsMaxDepth:!1,ancestorHasDailyTemplate:!1,nestedDepthOfAutomationAncestors:void 0,immediateAncestorRecurrenceType:void 0};const o=e.filter((e=>{var t;return"day"===(null===(t=e.getRecurrence())||void 0===t?void 0:t.frequency)})),n=e.length,i=null===(t=e[0].getRecurrence())||void 0===t?void 0:t.frequency,r=n>C,a=o.length>=x;return{violatesConstraint:r||a,templateNestingExceedsMaxDepth:r,ancestorHasDailyTemplate:a,nestedDepthOfAutomationAncestors:n,immediateAncestorRecurrenceType:i}}function R(e){const{recurrence:t,afterDate:o}=e;if((0,p().nA)(t)){const e=(0,s().kq)(o);return t.start_date>=e?new Date(t.start_date):void 0}{const e=b(t).after((0,s().pd)(o));if(!e)return;return(0,s().YL)(e)}}function k(e){return 0===e.hour||1===e.hour||2===e.hour}function _(e){return b(e).after((0,s().pd)((0,s().Jh)()))||void 0}function M(e){const{recurrence:t,intl:o}=e,i=_(B(t));if(!i)return;const r=k(t),a=n().ou.fromJSDate(i).toUTC().setZone("local",{keepLocalTime:!0}).setLocale((0,d().E2)(o)).setZone(t.timezone),s=(0,l().p6)({date:a,dateFormat:"relative",allowRelativeDates:!0,intl:o,shortenDate:!0});if(r)return o.formatMessage(g.dateBetweenMidnightAnd3AM,{date:s});{let e=a.toLocaleString(n().ou.TIME_SIMPLE);return t.timezone!==(0,c().r)()&&(e+=` ${a.toFormat("ZZZZ")}`),o.formatMessage(g.dateAtTime,{date:s,time:e})}}function w(e,t){return(0,r().$K)(e)?"number"===e.type?t.formatMessage(g.numberEndConditionDescription,{number:e.number_of_occurrences}):"date"===e.type?(0,l().p6)({date:n().ou.fromMillis(e.end_at),dateFormat:"relative",allowRelativeDates:!0,intl:t,shortenDate:!0}):void(0,r().t1)(e):t.formatMessage(g.noEndCondition)}const I=100;function j(e){return{...e,start_date:(0,s().kq)(e.start_date),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?{type:"date",end_at:(0,s().kq)(e.end_condition.end_at)}:(0,r().t1)(e.end_condition):void 0}}function T(e,t,o){return e.plus(o-t)}function L(e,t){const o=n().ou.fromMillis(t.end_at).set({hour:e.hour??0,minute:e.minute??0});return{type:"date",end_at:(0,s().Jh)(o.toJSDate())}}function B(e){return{...e,start_date:(0,s().Jh)(new Date(e.start_date)),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?L(e,e.end_condition):(0,r().t1)(e.end_condition):void 0}}},682890:(e,t,o)=>{o.d(t,{M:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("arrowDown",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M8 1.57715C7.5625 1.57715 7.25488 1.88477 7.25488 2.33594V10.8262L7.30957 12.3027L5.50488 10.2861L3.95312 8.75488C3.82324 8.625 3.63184 8.53613 3.42676 8.53613C3.0166 8.53613 2.70898 8.85059 2.70898 9.26758C2.70898 9.46582 2.78418 9.64355 2.94141 9.80762L7.44629 14.3193C7.59668 14.4697 7.79492 14.5586 8 14.5586C8.20508 14.5586 8.40332 14.4697 8.55371 14.3193L13.0586 9.80762C13.2158 9.64355 13.291 9.46582 13.291 9.26758C13.291 8.85059 12.9902 8.53613 12.5801 8.53613C12.3682 8.53613 12.1836 8.625 12.0469 8.75488L10.4951 10.2861L8.69043 12.2959L8.74512 10.8262V2.33594C8.74512 1.88477 8.44434 1.57715 8 1.57715Z"})})},889919:(e,t,o)=>{o.d(t,{k:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("arrowRightSmaller",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M15.383 8.352a.877.877 0 01-.274.64l-5.156 5.14a.864.864 0 01-.617.266.831.831 0 01-.602-.234.795.795 0 01-.234-.586c0-.12.02-.232.063-.336a.912.912 0 01.187-.273l1.75-1.766 2.914-2.656.274.5-2.711.156H1.484c-.26 0-.471-.078-.632-.234a.851.851 0 01-.235-.617c0-.256.078-.461.235-.618a.856.856 0 01.632-.242h9.493l2.71.164-.273.508L10.5 5.5 8.75 3.727a.946.946 0 01-.188-.266.917.917 0 01-.062-.344c0-.234.078-.43.234-.586a.831.831 0 01.602-.234.79.79 0 01.328.07c.104.047.203.117.297.211l5.148 5.133a.877.877 0 01.274.64z"})})},60836:(e,t,o)=>{o.d(t,{Z:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("arrowsDiverging",{viewBox:"0 0 12 12",svg:(0,n.jsx)("path",{d:"M6 11.2891C6.42188 11.2891 6.63281 11.0469 6.63281 10.5625V7.3457C6.63281 7.00586 6.71875 6.64062 6.89062 6.25C7.06641 5.85938 7.29492 5.47266 7.57617 5.08984C7.86133 4.70703 8.16992 4.35547 8.50195 4.03516C8.83789 3.71484 9.16406 3.45312 9.48047 3.25L9.95508 2.94531C10.1621 2.81641 10.2656 2.63281 10.2656 2.39453C10.2656 2.21875 10.2109 2.07227 10.1016 1.95508C9.99219 1.83789 9.8418 1.7793 9.65039 1.7793C9.4668 1.7793 9.29102 1.83398 9.12305 1.94336L8.81836 2.14844C8.51367 2.34766 8.20898 2.58984 7.9043 2.875C7.59961 3.15625 7.31641 3.45508 7.05469 3.77148C6.79297 4.08398 6.56836 4.39258 6.38086 4.69727C6.19727 4.99805 6.07227 5.26953 6.00586 5.51172H5.98828C5.91797 5.26953 5.79102 4.99805 5.60742 4.69727C5.42383 4.39258 5.19922 4.08398 4.93359 3.77148C4.67188 3.45508 4.38867 3.15625 4.08398 2.875C3.7832 2.58984 3.48047 2.34766 3.17578 2.14844L2.87109 1.94336C2.69922 1.83398 2.52344 1.7793 2.34375 1.7793C2.14844 1.7793 1.99609 1.83984 1.88672 1.96094C1.78125 2.08203 1.72852 2.22461 1.72852 2.38867C1.72852 2.62695 1.83203 2.8125 2.03906 2.94531L2.51367 3.25C2.83008 3.45312 3.1543 3.71484 3.48633 4.03516C3.81836 4.35547 4.12695 4.70703 4.41211 5.08984C4.69727 5.47266 4.92773 5.85938 5.10352 6.25C5.2793 6.64062 5.36719 7.00586 5.36719 7.3457V10.5625C5.36719 11.0469 5.57812 11.2891 6 11.2891ZM1.81641 3.9707L3.71484 1.52734C3.85547 1.33984 3.88281 1.17578 3.79688 1.03516C3.71484 0.890625 3.55469 0.814453 3.31641 0.806641L0.808594 0.712891C0.613281 0.705078 0.466797 0.763672 0.369141 0.888672C0.271484 1.00977 0.251953 1.16406 0.310547 1.35156L1.02539 3.75391C1.0918 3.98438 1.20312 4.125 1.35938 4.17578C1.51953 4.22656 1.67188 4.1582 1.81641 3.9707ZM10.0898 3.95898C10.2266 4.1543 10.375 4.23047 10.5352 4.1875C10.6992 4.14062 10.8164 4.00391 10.8867 3.77734L11.6777 1.39258C11.7402 1.20508 11.7246 1.04883 11.6309 0.923828C11.541 0.798828 11.3984 0.736328 11.2031 0.736328L8.68945 0.753906C8.45117 0.753906 8.28711 0.824219 8.19727 0.964844C8.10742 1.10156 8.13086 1.26562 8.26758 1.45703L10.0898 3.95898Z"})})},29248:(e,t,o)=>{o.d(t,{K:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("boltFilled",{svg:(0,n.jsx)("path",{d:"M0 12.117c0 .38.293.664.703.664h5.518l-2.91 7.91c-.381 1.006.664 1.543 1.318.723l8.877-11.094c.166-.205.254-.4.254-.625 0-.371-.293-.664-.703-.664H7.539l2.91-7.91C10.83.115 9.785-.422 9.131.408L.254 11.492c-.166.215-.254.41-.254.625z"}),viewBox:"0 0 14 22"})},414294:(e,t,o)=>{o.d(t,{E:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("chevronDownRounded",{viewBox:"0 0 15 9",svg:(0,n.jsx)("path",{d:"M7.92188 8.65625C8.19531 8.64844 8.44531 8.54688 8.64844 8.32812L14.5859 2.25C14.7578 2.07812 14.8516 1.85938 14.8516 1.60156C14.8516 1.08594 14.4453 0.671875 13.9297 0.671875C13.6797 0.671875 13.4375 0.773438 13.2578 0.953125L7.92969 6.42969L2.58594 0.953125C2.40625 0.78125 2.17188 0.671875 1.91406 0.671875C1.39844 0.671875 0.992188 1.08594 0.992188 1.60156C0.992188 1.85938 1.08594 2.07812 1.25781 2.25L7.20312 8.32812C7.41406 8.54688 7.64844 8.65625 7.92188 8.65625Z"})})},165940:(e,t,o)=>{o.d(t,{R:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("chevronUpRounded",{viewBox:"0 0 15 9",svg:(0,n.jsx)("path",{d:"M1.258 6.5L7.203.422a.946.946 0 01.719-.32.99.99 0 01.726.32L14.586 6.5a.89.89 0 01.266.648c0 .524-.407.93-.922.93a.921.921 0 01-.672-.281L7.93 2.32 2.586 7.797a.926.926 0 01-.672.281.915.915 0 01-.922-.93c0-.25.094-.476.266-.648z"})})},114066:(e,t,o)=>{o.d(t,{H:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("copyPadded",{viewBox:"0 0 24 24",svg:(0,n.jsx)("path",{d:"M4.89062 18.5107C4.89062 19.9873 5.64941 20.7529 7.1123 20.7529H13.5107C14.9736 20.7529 15.7256 19.9805 15.7256 18.5107V17.2461H16.8877C18.3506 17.2461 19.1094 16.4805 19.1094 15.0039V9.58984C19.1094 8.69434 18.9248 8.12012 18.3848 7.56641L14.9736 4.09375C14.4609 3.56738 13.8525 3.36914 13.0664 3.36914H10.4893C9.0332 3.36914 8.26758 4.13477 8.26758 5.61133V6.86914H7.1123C5.64941 6.86914 4.89062 7.6416 4.89062 9.11133V18.5107ZM15.042 11.3262L11.3369 7.55957C10.8105 7.02637 10.3662 6.88281 9.60742 6.87598V5.68652C9.60742 5.05762 9.94238 4.70898 10.6055 4.70898H13.4629V7.97656C13.4629 8.82422 13.9141 9.26172 14.7549 9.26172H17.7695V14.9219C17.7695 15.5576 17.4414 15.9062 16.7715 15.9062H15.7256V13.2539C15.7256 12.3311 15.6162 11.9072 15.042 11.3262ZM14.584 7.80566V5.2627L17.4209 8.14062H14.9189C14.6865 8.14062 14.584 8.04492 14.584 7.80566ZM6.23047 18.4287V9.19336C6.23047 8.56445 6.55859 8.20898 7.22168 8.20898H9.32031V11.9551C9.32031 12.9326 9.80566 13.4111 10.7764 13.4111H14.3857V18.4287C14.3857 19.0645 14.0576 19.4131 13.3945 19.4131H7.22168C6.55859 19.4131 6.23047 19.0645 6.23047 18.4287ZM10.9062 12.2285C10.626 12.2285 10.5029 12.1055 10.5029 11.8252V8.46875L14.2012 12.2285H10.9062Z"})})},78615:(e,t,o)=>{o.d(t,{P:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("expandThin",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M7.992.61c.156 0 .3.033.43.1.13.069.27.16.422.274l5.265 4.25a.948.948 0 01.368.774 1 1 0 01-.149.547c-.099.156-.229.28-.39.375a1.013 1.013 0 01-.508.133 1.07 1.07 0 01-.399-.079 1.6 1.6 0 01-.375-.226L7.992 3.016 3.336 6.758a1.74 1.74 0 01-.383.226 1.056 1.056 0 01-.906-.055 1.145 1.145 0 01-.383-.374 1 1 0 01-.148-.547c0-.318.122-.576.367-.774L7.148.984C7.3.87 7.44.78 7.57.711a.9.9 0 01.422-.102zm0 14.85a.901.901 0 01-.422-.1 2.288 2.288 0 01-.422-.274l-5.265-4.25a.962.962 0 01-.367-.774 1.055 1.055 0 01.531-.914 1.01 1.01 0 01.906-.062c.125.052.253.128.383.226l4.656 3.743 4.664-3.742a1.6 1.6 0 01.375-.227c.13-.052.263-.078.399-.078a.97.97 0 01.508.14 1.036 1.036 0 01.539.915c0 .312-.123.57-.368.773l-5.265 4.258a2.512 2.512 0 01-.422.265.917.917 0 01-.43.102z"})})},94250:(e,t,o)=>{o.d(t,{c:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("eye",{viewBox:"0 0 32 32",svg:(0,n.jsx)("path",{d:"M16.006 25.812c8.863 0 14.994-7.17 14.994-9.406C31 14.16 24.858 7 16.006 7 7.252 7 1 14.16 1 16.406c0 2.236 6.252 9.406 15.006 9.406zm0-3.242a6.194 6.194 0 01-6.197-6.164c-.012-3.452 2.744-6.164 6.197-6.164 3.419 0 6.185 2.711 6.185 6.164 0 3.364-2.766 6.164-6.185 6.164zm0-3.94c1.228 0 2.246-1.007 2.246-2.224 0-1.228-1.018-2.235-2.246-2.235-1.24 0-2.258 1.007-2.258 2.235 0 1.217 1.018 2.224 2.258 2.224z"})})},491630:(e,t,o)=>{o.d(t,{C:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("membersFilled",{viewBox:"0 0 30 30",svg:(0,n.jsx)("path",{d:"M20.31 14.731c2.22 0 4.097-1.967 4.097-4.513 0-2.485-1.887-4.391-4.098-4.391-2.2 0-4.097 1.937-4.087 4.411 0 2.526 1.866 4.493 4.087 4.493zm-11.725.233c1.937 0 3.57-1.724 3.57-3.935 0-2.17-1.653-3.823-3.57-3.823-1.917 0-3.57 1.683-3.56 3.844 0 2.19 1.633 3.914 3.56 3.914zm-5.588 9.21h7.606c-1.085-1.552.082-4.615 2.374-6.42-1.116-.72-2.566-1.248-4.392-1.248-4.533 0-7.464 3.337-7.464 6.085 0 1.004.507 1.582 1.876 1.582zm10.994-.01h12.637c1.673 0 2.251-.508 2.251-1.44 0-2.607-3.316-6.198-8.57-6.198-5.263 0-8.57 3.59-8.57 6.197 0 .933.578 1.44 2.252 1.44z"})})},237010:(e,t,o)=>{o.d(t,{R:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("openTeam",{viewBox:"0 0 28 28",svg:(0,n.jsx)("path",{d:"M3.24121 21.4326C3.24121 22.4082 3.80371 23.0322 4.7002 23.0322H22.4629C23.3506 23.0322 23.9131 22.4082 23.9131 21.4326V10.2178C23.9131 9.24219 23.3506 8.61816 22.4629 8.61816H17.2334V5.89355C17.2334 4.91797 16.6709 4.29395 15.7832 4.29395H4.7002C3.80371 4.29395 3.24121 4.91797 3.24121 5.89355V21.4326ZM4.65625 21.1074V6.21875C4.65625 5.86719 4.81445 5.70898 5.16602 5.70898H15.3174C15.6602 5.70898 15.8184 5.86719 15.8184 6.21875V21.1074C15.8184 21.4502 15.6602 21.6172 15.3174 21.6172H13.2959V19.0244C13.2959 18.2686 12.9619 17.917 12.2412 17.917H8.2334C7.5127 17.917 7.17871 18.2686 7.17871 19.0244V21.6172H5.16602C4.81445 21.6172 4.65625 21.4502 4.65625 21.1074ZM7.31934 9.5498H9.0332C9.24414 9.5498 9.39355 9.40918 9.39355 9.18945V7.52832C9.39355 7.31738 9.24414 7.16797 9.0332 7.16797H7.31934C7.1084 7.16797 6.97656 7.31738 6.97656 7.52832V9.18945C6.97656 9.40918 7.1084 9.5498 7.31934 9.5498ZM11.4414 9.5498H13.1465C13.3574 9.5498 13.5068 9.40918 13.5068 9.18945V7.52832C13.5068 7.31738 13.3574 7.16797 13.1465 7.16797H11.4414C11.2217 7.16797 11.0898 7.31738 11.0898 7.52832V9.18945C11.0898 9.40918 11.2217 9.5498 11.4414 9.5498ZM17.2334 21.4326V10.0332H21.9971C22.3398 10.0332 22.498 10.2002 22.498 10.543V21.1074C22.498 21.4502 22.3398 21.6172 21.9971 21.6172H17.2246C17.2334 21.5557 17.2334 21.4941 17.2334 21.4326ZM7.31934 13.0303H9.0332C9.24414 13.0303 9.39355 12.8896 9.39355 12.6699V11.0088C9.39355 10.7979 9.24414 10.6484 9.0332 10.6484H7.31934C7.1084 10.6484 6.97656 10.7979 6.97656 11.0088V12.6699C6.97656 12.8896 7.1084 13.0303 7.31934 13.0303ZM11.4414 13.0303H13.1465C13.3574 13.0303 13.5068 12.8896 13.5068 12.6699V11.0088C13.5068 10.7979 13.3574 10.6484 13.1465 10.6484H11.4414C11.2217 10.6484 11.0898 10.7979 11.0898 11.0088V12.6699C11.0898 12.8896 11.2217 13.0303 11.4414 13.0303ZM19.1582 13.4521H20.5732C20.749 13.4521 20.8721 13.3291 20.8721 13.1533V11.7822C20.8721 11.6064 20.749 11.4834 20.5732 11.4834H19.1582C18.9736 11.4834 18.8682 11.6064 18.8682 11.7822V13.1533C18.8682 13.3291 18.9736 13.4521 19.1582 13.4521ZM7.31934 16.5107H9.0332C9.24414 16.5107 9.39355 16.3613 9.39355 16.1504V14.4893C9.39355 14.2695 9.24414 14.1289 9.0332 14.1289H7.31934C7.1084 14.1289 6.97656 14.2695 6.97656 14.4893V16.1504C6.97656 16.3613 7.1084 16.5107 7.31934 16.5107ZM11.4414 16.5107H13.1465C13.3574 16.5107 13.5068 16.3613 13.5068 16.1504V14.4893C13.5068 14.2695 13.3574 14.1289 13.1465 14.1289H11.4414C11.2217 14.1289 11.0898 14.2695 11.0898 14.4893V16.1504C11.0898 16.3613 11.2217 16.5107 11.4414 16.5107ZM19.1582 16.8096H20.5732C20.749 16.8096 20.8721 16.6865 20.8721 16.5107V15.1396C20.8721 14.9639 20.749 14.8408 20.5732 14.8408H19.1582C18.9736 14.8408 18.8682 14.9639 18.8682 15.1396V16.5107C18.8682 16.6865 18.9736 16.8096 19.1582 16.8096ZM19.1582 20.167H20.5732C20.749 20.167 20.8721 20.0439 20.8721 19.8682V18.4971C20.8721 18.3213 20.749 18.1982 20.5732 18.1982H19.1582C18.9736 18.1982 18.8682 18.3213 18.8682 18.4971V19.8682C18.8682 20.0439 18.9736 20.167 19.1582 20.167ZM8.33008 19.3496C8.33008 19.165 8.42676 19.0684 8.61133 19.0684H11.8633C12.0566 19.0684 12.1445 19.165 12.1445 19.3496V21.6172H8.33008V19.3496Z"})})},698072:(e,t,o)=>{o.d(t,{M:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("peopleFillCheckmark",{viewBox:"0 0 20 20",svg:(0,n.jsx)("path",{d:"M14.5391 10.3174C14.4115 10.3174 14.2975 10.29 14.1973 10.2354C14.097 10.1807 13.999 10.0964 13.9033 9.98242L12.29 8.01367C12.1715 7.86328 12.1123 7.70833 12.1123 7.54883C12.1123 7.38021 12.1693 7.23665 12.2832 7.11816C12.4017 6.99967 12.5452 6.94043 12.7139 6.94043C12.8141 6.94043 12.9053 6.96322 12.9873 7.00879C13.0739 7.0498 13.1582 7.12272 13.2402 7.22754L14.5117 8.84082L17.2188 4.51367C17.3555 4.28581 17.5309 4.17188 17.7451 4.17188C17.9046 4.17188 18.0482 4.22428 18.1758 4.3291C18.3034 4.42936 18.3672 4.56608 18.3672 4.73926C18.3672 4.81673 18.349 4.89648 18.3125 4.97852C18.2806 5.05599 18.2419 5.12891 18.1963 5.19727L15.1406 9.97559C14.9948 10.2035 14.7943 10.3174 14.5391 10.3174ZM2.85645 16.2441C2.47363 16.2441 2.17285 16.1576 1.9541 15.9844C1.73535 15.8112 1.62598 15.5742 1.62598 15.2734C1.62598 14.8314 1.75814 14.3688 2.02246 13.8857C2.29134 13.4027 2.67643 12.9492 3.17773 12.5254C3.68359 12.1016 4.29199 11.7575 5.00293 11.4932C5.71387 11.2288 6.51139 11.0967 7.39551 11.0967C8.28418 11.0967 9.08398 11.2288 9.79492 11.4932C10.5059 11.7575 11.112 12.1016 11.6133 12.5254C12.1191 12.9492 12.5065 13.4027 12.7754 13.8857C13.0443 14.3688 13.1787 14.8314 13.1787 15.2734C13.1787 15.5742 13.0693 15.8112 12.8506 15.9844C12.6318 16.1576 12.3311 16.2441 11.9482 16.2441H2.85645ZM7.40234 9.87988C6.9056 9.87988 6.44759 9.74544 6.02832 9.47656C5.61361 9.20768 5.27865 8.84538 5.02344 8.38965C4.77279 7.93392 4.64746 7.4235 4.64746 6.8584C4.64746 6.30241 4.77279 5.80111 5.02344 5.35449C5.27865 4.90332 5.61589 4.54557 6.03516 4.28125C6.45443 4.01693 6.91016 3.88477 7.40234 3.88477C7.89909 3.88477 8.3571 4.01465 8.77637 4.27441C9.19564 4.53418 9.5306 4.88965 9.78125 5.34082C10.0365 5.78743 10.1641 6.28874 10.1641 6.84473C10.1641 7.41439 10.0365 7.92936 9.78125 8.38965C9.5306 8.84538 9.19564 9.20768 8.77637 9.47656C8.3571 9.74544 7.89909 9.87988 7.40234 9.87988Z"})})},490670:(e,t,o)=>{o.d(t,{f:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("plusThick",{viewBox:"0 0 14 14",svg:(0,n.jsx)("path",{d:"M2 7.16357C2 7.59692 2.36011 7.95093 2.78735 7.95093H6.37622V11.5398C6.37622 11.9731 6.73022 12.3271 7.16357 12.3271C7.59692 12.3271 7.95093 11.9731 7.95093 11.5398V7.95093H11.5398C11.9731 7.95093 12.3271 7.59692 12.3271 7.16357C12.3271 6.73022 11.9731 6.37622 11.5398 6.37622H7.95093V2.78735C7.95093 2.36011 7.59692 2 7.16357 2C6.73022 2 6.37622 2.36011 6.37622 2.78735V6.37622H2.78735C2.36011 6.37622 2 6.73022 2 7.16357Z"})})},594968:(e,t,o)=>{o.d(t,{x:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("privateTeam",{viewBox:"0 0 28 28",svg:(0,n.jsx)("path",{d:"M20.6455 21.2744C20.9092 21.5469 21.3311 21.5645 21.6035 21.2744C21.8936 20.9844 21.8672 20.5889 21.6035 20.3164L6.9082 5.62988C6.64453 5.36621 6.21387 5.36621 5.94141 5.62988C5.68652 5.88477 5.68652 6.33301 5.94141 6.58789L20.6455 21.2744ZM13.8076 6.13086C12.2783 6.13086 10.8896 6.39453 9.59766 6.8252L10.7578 7.97656C11.7246 7.68652 12.7178 7.51953 13.8076 7.51953C19.5908 7.51953 24.2754 12.6172 24.2754 13.6631C24.2754 14.375 22.7373 16.291 20.3027 17.7852L21.3838 18.8662C24.1611 17.0645 25.8135 14.7002 25.8135 13.6631C25.8135 11.8613 20.9092 6.13086 13.8076 6.13086ZM13.8076 21.1953C15.4424 21.1953 16.9365 20.9053 18.2988 20.4395L17.1475 19.2881C16.1016 19.6133 14.9941 19.8066 13.8076 19.8066C8.01562 19.8066 3.33105 14.9023 3.33105 13.6631C3.33105 13.0479 4.95703 11 7.5498 9.44434L6.45996 8.35449C3.5332 10.165 1.79297 12.5996 1.79297 13.6631C1.79297 15.4561 6.79395 21.1953 13.8076 21.1953ZM18.3164 15.5879C18.5889 14.999 18.7383 14.3398 18.7383 13.6631C18.7383 10.9121 16.541 8.74121 13.8076 8.74121C13.1133 8.74121 12.4629 8.89062 11.874 9.14551L18.3164 15.5879ZM13.8076 18.585C14.5811 18.585 15.3105 18.3916 15.9609 18.0752L9.36914 11.4834C9.04395 12.1338 8.85938 12.8721 8.85938 13.6631C8.86816 16.3438 11.0566 18.585 13.8076 18.585Z"})})},513602:(e,t,o)=>{o.d(t,{u:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("showDeletedPages",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M1.89551 8.5498C1.89551 11.9404 4.61621 14.668 8 14.668C11.3838 14.668 14.1045 11.9404 14.1045 8.5498C14.1045 5.16602 11.4043 2.45898 8.02051 2.45898C7.66504 2.45898 7.31641 2.49316 7.01562 2.55469L8.66992 0.920898C8.78613 0.797852 8.85449 0.640625 8.85449 0.462891C8.85449 0.09375 8.56738 -0.207031 8.20508 -0.207031C8.01367 -0.207031 7.84961 -0.138672 7.7334 -0.00878906L4.93066 2.8418C4.79395 2.97852 4.71875 3.15625 4.71875 3.33398C4.71875 3.51855 4.78711 3.68262 4.93066 3.82617L7.7334 6.65625C7.84961 6.7793 8.00684 6.84082 8.20508 6.84082C8.56738 6.84082 8.85449 6.55371 8.85449 6.17773C8.85449 6 8.78613 5.85645 8.66309 5.72656L6.80371 3.88086C7.15234 3.80566 7.56934 3.77148 8.02051 3.77148C10.666 3.77148 12.7646 5.88379 12.7646 8.5498C12.7646 11.2021 10.6455 13.3281 8 13.3281C5.35449 13.3281 3.23535 11.2021 3.23535 8.5498C3.23535 8.14648 2.97559 7.85938 2.5791 7.85938C2.17578 7.85938 1.89551 8.14648 1.89551 8.5498Z"})})},46581:(e,t,o)=>{o.d(t,{U:()=>a});var n=o.n(o(389539)),i=()=>o(280210),r=()=>o(956057);class a{constructor(e){this.environmentName=void 0,this.mainShortId=void 0,this.getSettings=void 0,this.isServerOriginated=void 0,this.mapSpaceIdToShortId=void 0,this.idCreatorLogger=void 0,this.environmentName=e.environmentName,this.mainShortId=o(631871).jF[this.environmentName],this.getSettings=e.getSettings,this.isServerOriginated=e.isServerOriginated,this.mapSpaceIdToShortId=e.mapSpaceIdToShortId,this.idCreatorLogger=e.idCreatorLogger??(()=>{})}idInMain(e){const{enableTestDateOffset:t,enableIdSchema:n}=this.getSettings();return n&&e!==o(363777).uK?(this.idCreatorLogger(void 0,e,t?"id_schema_test":"id_schema"),(0,i().ii)(t,this.mainShortId,e,this.isServerOriginated)):this.legacyId(e,"disabled")}pointerInMain(e){return{table:e,id:this.idInMain(e)}}async idWithSpaceId(e,t){const{enableTestDateOffset:o,enableIdSchema:r}=this.getSettings();if(!r||"space"===t)return this.legacyId(t,"disabled");const a=this.mapSpaceIdToShortId(e),s=n().types.isPromise(a)?await a:a;return s?(this.idCreatorLogger(e,t,o?"id_schema_test":"id_schema"),(0,i().U_)(o,s,t,this.isServerOriginated)):this.legacyId(t,"missing_short_id")}async pointerWithSpaceId(e,t){return{table:t,spaceId:e,id:await this.idWithSpaceId(e,t)}}idWithSpaceShortId(e,t){const{enableTestDateOffset:o,enableIdSchema:n}=this.getSettings();return n&&"space"!==t?(this.idCreatorLogger(void 0,t,o?"id_schema_test":"id_schema"),(0,i().U_)(o,e,t,this.isServerOriginated)):this.legacyId(t,"disabled")}legacyId(e,t){return this.idCreatorLogger(void 0,e,t),r().Il()}async deterministicIdWithSpaceId(e,t,o){const{enableTestDateOffset:a,enableIdSchema:s}=this.getSettings();if(!s)return this.idCreatorLogger(e,t,"disabled"),r().Ul(o);const l=this.mapSpaceIdToShortId(e),c=n().types.isPromise(l)?await l:l;return c?(this.idCreatorLogger(e,t,a?"id_schema_test":"id_schema"),(0,i().f6)(c,t,o)):(this.idCreatorLogger(e,t,"missing_short_id"),r().Ul(o))}deterministicIdWithSpaceShortId(e,t,o){const{enableTestDateOffset:n,enableIdSchema:a}=this.getSettings();return a?(this.idCreatorLogger(void 0,t,n?"id_schema_test":"id_schema"),(0,i().f6)(e,t,o)):(this.idCreatorLogger(void 0,t,"disabled"),r().Ul(o))}async getSpaceIdCreator(e){if(!e)return new s(e,this.idCreatorLogger);const{enableIdSchema:t}=this.getSettings();if(!t)return new s(e,this.idCreatorLogger);const o=this.mapSpaceIdToShortId(e),i=n().types.isPromise(o)?await o:o;return this.getSpaceShortIdCreator(e,i)}getSpaceIdCreatorSync(e){if(!e)return new s(e,this.idCreatorLogger);const{enableIdSchema:t}=this.getSettings();if(!t)return new s(e,this.idCreatorLogger);const o=this.mapSpaceIdToShortId(e),i=n().types.isPromise(o)?void 0:o;return this.getSpaceShortIdCreator(e,i)}getSpaceShortIdCreator(e,t){const{enableIdSchema:o}=this.getSettings();return o&&t?new l(e,this,t):new s(e,this.idCreatorLogger)}async getSpaceIdCreatorFromModel(e){return e.getShortIdStr()?this.getSpaceShortIdCreator(e.id,Number(e.getShortIdStr())):await this.getSpaceIdCreator(e.id)}}class s{constructor(e,t){this.spaceId=void 0,this.idCreatorLogger=void 0,this.spaceId=e,this.idCreatorLogger=t}idInSavedSpace(e){return this.idCreatorLogger(void 0,e,"disabled"),r().Il()}idInMain(e){return this.idCreatorLogger(void 0,e,"disabled"),r().Il()}deterministicIdInSavedSpace(e,t){return this.idCreatorLogger(void 0,e,"disabled"),r().Ul(t)}pointerInMain(e){return{id:this.idInMain(e),table:e}}pointerInSavedSpace(e){return{id:this.idInSavedSpace(e),table:e,spaceId:this.spaceId}}getSpaceId(){return this.spaceId}}class l{constructor(e,t,o){this.spaceId=void 0,this.idCreator=void 0,this.spaceShortId=void 0,this.spaceId=e,this.idCreator=t,this.spaceShortId=o}idInSavedSpace(e){return this.idCreator.idWithSpaceShortId(this.spaceShortId,e)}idInMain(e){return this.idCreator.idInMain(e)}deterministicIdInSavedSpace(e,t){return this.idCreator.deterministicIdWithSpaceShortId(this.spaceShortId,e,t)}pointerInMain(e){return{id:this.idInMain(e),table:e}}pointerInSavedSpace(e){return{id:this.idInSavedSpace(e),table:e,spaceId:this.spaceId}}getSpaceId(){return this.spaceId}}},856466:(e,t,o)=>{o.d(t,{$X:()=>a,F_:()=>s,iZ:()=>r});o(267602),o(470928);var n=()=>o(926724),i=()=>o(295617);const r={autoCompleteSprints:!1,actionConfig:{complete_sprint_action:"complete_sprint_and_move_incomplete_tasks_to_next_sprint"},recurrenceConfig:{interval:2,weekdays:["MO"]}};function a(e){const{eventTracker:t,properties:o}=e;t.DO_NOT_USE_commonTrackEvent({eventName:"complete_sprint_action",properties:o})}function s(e,t){var o;return null===(o=t.groups)||void 0===o||null===(o=o.find((t=>t.id===n().nl||(null==t?void 0:t.name)===i().RW||(null==t?void 0:t.name)===e.formatMessage(i().ct.statusGroupNameComplete))))||void 0===o?void 0:o.name}},126301:(e,t,o)=>{o.d(t,{DW:()=>s,IX:()=>a,Su:()=>i,rP:()=>r});var n=()=>o(730120);function i(e){if("week"===e.frequency&&e.weekdays&&1===e.weekdays.length)return{weekday:e.weekdays[0],duration:e.interval}}function r(e){const{currentSprintEndDate:t,sprintSchedule:o}=e;return l({startDate:d({dateToAdjust:n().ou.fromISO(t),weekday:o.weekday,wrapForEqualDays:!0}),duration:o.duration})}function a(e){const{userTimeZone:t,sprintSchedule:o}=e;return l({startDate:n().ou.local({zone:t}),duration:o.duration})}function s(e){const{currentSprintStartDate:t,sprintSchedule:o}=e,i=d({dateToAdjust:n().ou.fromISO(t),weekday:o.weekday,wrapForEqualDays:!1}),{end_date:r}=l({startDate:i,duration:o.duration});let a=n().ou.fromISO(r);const s=n().ou.now().startOf("day");for(;a.diff(s,"days").days<0;)a=a.plus({weeks:1});return{type:"daterange",start_date:a.plus({days:1}).minus({weeks:o.duration}).toISODate(),end_date:a.toISODate()}}function l(e){const{startDate:t,duration:o}=e,n=t.plus({weeks:o}).minus({days:1});return{type:"daterange",start_date:t.toISODate(),end_date:n.toISODate()}}const c={SU:0,MO:1,TU:2,WE:3,TH:4,FR:5,SA:6};function d(e){const{dateToAdjust:t,weekday:o,wrapForEqualDays:n}=e,i=u({currentWeekday:t.weekday%7,nextWeekday:c[o],wrapForEqualDays:n});return t.plus({days:i})}function u(e){const{currentWeekday:t,nextWeekday:o,wrapForEqualDays:n}=e,i="number"==typeof t?t:c[t],r="number"==typeof o?o:c[o];if(i===r)return n?7:0;let a=i,s=0;for(;a!==r;)a===c.SA?a=0:a+=1,s+=1;return s}},971095:(e,t,o)=>{o.d(t,{A:()=>n});const n=(0,o(830742).LS)("importEvernote")}}]);