"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[72510,95986,93843],{493843:(e,t,n)=>{n.d(t,{$o:()=>W,Fv:()=>V,IL:()=>j,J4:()=>N,KA:()=>Z,Nf:()=>F,_p:()=>K,cQ:()=>Q,f$:()=>O,fX:()=>q,j2:()=>L,k2:()=>$,mg:()=>G,mz:()=>H,oP:()=>B,tF:()=>Y,td:()=>z,x:()=>X});n(670560),n(267602),n(470928),n(30005),n(241792),n(228244);var o=()=>n(730120),r=()=>n(492788),i=()=>n(506347),a=()=>n(926724),s=()=>n(331540),l=()=>n(874459),c=()=>n(998411),d=()=>n(35980),u=()=>n(513670),m=()=>n(696459),p=()=>n(250303),f=()=>n(384667),v=()=>n(366257),S=()=>n(139224),g=()=>n(421654),h=()=>n(636340),y=()=>n(531515),_=()=>n(47443),b=()=>n(794586),I=()=>n(879952),C=()=>n(970105),w=()=>n(990966),A=()=>n(269299),U=()=>n(715146),k=()=>n(887430),R=()=>n(861026),E=()=>n(804217),x=()=>n(826955),T=()=>n(965903),P=()=>n(807230),D=()=>n(701182),M=()=>n(645843);function L(e){const{collectionViewStore:t,collectionContextStore:n,timelineState:o,environment:r}=e,i=r.currentUser.id,a=(0,D().B8)(t.id),s=(0,D().pQ)(t,r),l=n.permissionScopesStore.state,c=u().Ds((()=>{if(o.destroyed)return;const e={zoomLevel:o.zoomLevel.state,centerTimestamp:(0,D().al)(o)};d().Z.set({userId:i,key:a,value:e})}),1e3),m=u().Ds((()=>{if(o.destroyed||!E().default.state.online||!r.currentUser.isLoggedIn()||!l.canConfigureBlock)return;const e={zoomLevel:o.zoomLevel.state,centerTimestamp:(0,D().al)(o)},n=t.getFormat().timeline_preference;u().Xy(n,e)||A().createAndCommit({userAction:"collectionTimelineViewActions.setRemotePreference",environment:r,canUndo:!0,perform:n=>{g().FH({stores:[t],update:{timeline_preference:e},transaction:n})}})}),5e3);o.savePreference=()=>{c(),m()},F({timelineState:o,environment:r,...s})}function F(e){const{timelineState:t,zoomLevel:n,centerTimestamp:o,environment:i}=e,{savePreference:a}=t,s=i.WindowSizeStore.state.width+2*D().Ge,l=(0,D().x2)(n,s),c=o-l/2,d=o+l/2;t.zoomLevel.setState(n),t.currentRange.setState({startTimestamp:c,endTimestamp:d}),r().default.afterNextFlush((()=>{Z({timelineState:t,centerTimestamp:o}),a&&a()}))}function Z(e){const{timelineState:t,centerTimestamp:n}=e,{horizontalScroller:o,outerSizeObserver:r}=t;if(!o)return;const i=t.zoomLevel.state,{startTimestamp:a,endTimestamp:s}=t.currentRange.state,l=r.rect.state.width;if(l===(0,D().e$)(i,s-a))return;const c=(0,D().e$)(i,n-a)-l/2;o.scrollLeft=c,t.scrollLeft.setState(c)}function B(e){const{environment:t,store:n,query:o,date:r,schema:i,transaction:a}=e,{timeline_by:s}=o;if(!s)return;const l=n.getAssociatedCollectionStore(),c=(null==l?void 0:l.getMappedProperty(s))??s,d=o.timeline_by_end?(null==l?void 0:l.getMappedProperty(o.timeline_by_end))??o.timeline_by_end:void 0,u=(0,D().TW)({store:n,dateValue:r,query:o,schema:(null==l?void 0:l.getSchema())??i}),m=n.getPropertyValue(c),p=d?n.getPropertyValue(d):void 0;return h().sW({store:n.getPropertiesStore(),data:u,transaction:a}),v().H({environment:t,store:n,dateProperty:{id:c,newValue:(null==u?void 0:u[c])??[],oldValue:m},otherDateProperty:d?{id:d,newValue:(null==u?void 0:u[d])??[],oldValue:p}:void 0}),n}function V(e){var t;const{environment:n,timelineState:r,collectionStore:i,collectionContextStore:a,store:s,query:d,groupFormat:u,transaction:m}=e,p=r.zoomLevel.state,v=(0,D().al)(r),{snapUnit:S,getDateRangePlaceholderDuration:g}=D().BJ[p],{timeline_by:h}=d;if(!h)return;const y=null===(t=a.groupsStore.getGroupState(u))||void 0===t?void 0:t.resultsStore.state;if(!y)return;const _=o().ou.fromMillis(v),b=(0,D().DS)(_,S),I=(0,D().DS)(g(_),S),C=(0,D().AZ)({startValue:(0,l().Lg)((0,c().r)()),snapUnit:S,desiredStart:b,desiredEnd:I});return B({environment:n,store:s,query:d,schema:i.getSchema(),date:C,transaction:m}),f().$T({environment:n,collectionStore:i,before:!0,store:y[0],insertStores:[s],collectionContextStore:a,groupsPointer:u?[u]:[],transaction:m}),s}function O(e){const{type:t,timelineState:n,store:o,startX:r,query:i,schema:a,intl:s,environment:l}=e,{horizontalScroller:c}=n,{startTimestamp:d}=n.currentRange.state;if(!c)return;I().Ys({environment:l,store:o});const m=c.scrollLeft,{stores:p}=T().default.state,f=u().oA(p.map((e=>{const t=(0,D().bk)({store:e,query:i,schema:a,userId:l.currentUser.id,intl:s,formulasModule:void 0});if(t)return{startValue:t,store:e}})));n.dragState.setState({type:t,startStore:o,stores:f.map((e=>{let{store:t}=e;return t})),startValues:f.map((e=>{let{startValue:t}=e;return t})),temporaryValues:f.map((e=>{let{startValue:t}=e;return t})),startX:r,startStartTimestamp:d,startScrollLeft:m})}function N(e){const{timelineState:t,store:n,startX:o,startY:r,schema:i,collectionContextStore:a,verticalScroller:s}=e,{horizontalScroller:l}=t,{startTimestamp:c}=t.currentRange.state;if(!l||!s)return;const d=l.scrollLeft,u=s.scrollTop,m=(0,D().YE)(a,n,i);t.drawState.setState({startStore:n,startDependencyRelationPointers:m,temporaryDependencyRelationPointers:[...m],startX:o,startY:r,startScrollLeft:d,startScrollTop:u,startStartTimestamp:c,xOffsetPx:0,yOffsetPx:0,tryToCompleteDrawnArrow:!1})}function z(e){const{timelineState:t,currentX:n}=e,{horizontalScroller:o}=t,r=t.zoomLevel.state,i=t.dragState.state,{startTimestamp:a}=t.currentRange.state;if(!i||!o)return;const{type:s,startStartTimestamp:c,startValues:d,startScrollLeft:p,startX:f,startStore:v,stores:S}=i,g=D().BJ[r],{snapUnit:h}=g,y=o.scrollLeft-p+(n-f)+(0,D().e$)(r,a-c),_=(0,D().x2)(r,y),b=d[S.indexOf(v)];let I;if(s===D().px.LeftResizer){const{start:e}=(0,D().XO)(b,h),t=e.plus(_);I=d.map((e=>{const n=(0,D().AZ)({startValue:e,snapUnit:h,desiredStart:t});return(0,l().gW)(n)}))}else if(s===D().px.RightResizer){const{end:e}=(0,D().XO)(b,h),t=e.plus(_);I=d.map((e=>{const n=(0,D().AZ)({startValue:e,snapUnit:h,desiredEnd:t});return(0,l().Qq)(n)}))}else s===D().px.ItemDrag?I=d.map((e=>{const{start:t,end:n}=(0,D().XO)(e,h),o=t.plus(_),r=o.plus(n.valueOf()-t.valueOf());return(0,D().AZ)({startValue:e,snapUnit:h,desiredStart:o,desiredEnd:r})})):(0,m().t1)(s);u().Xy(i.temporaryValues,I)||t.dragState.setState({...i,temporaryValues:I})}function H(e){const{timelineState:t,currentX:n,currentY:o,verticalScroller:r}=e,i=t.drawState.state,a=t.zoomLevel.state,{startTimestamp:s}=t.currentRange.state,{horizontalScroller:l}=t;if(!i||!l||!r)return;const{startDependencyRelationPointers:c,startStore:d,startX:m,startY:p,startScrollLeft:f,startScrollTop:v,startStartTimestamp:S}=i,g=l.scrollLeft,h=r.scrollTop,y=g-f+(n-m)+(0,D().e$)(a,s-S),_=h-v+(o-p),b=t.hoveredItem.state;if(b&&b!==d&&!c.some((e=>e.id===b.id))){const e=[...c,{table:"block",id:b.id,spaceId:b.getSpaceId()}];u().Xy(i.temporaryDependencyRelationPointers,e)||t.drawState.setState({...i,temporaryDependencyRelationPointers:e,xOffsetPx:void 0,yOffsetPx:void 0})}else t.drawState.setState({...i,temporaryDependencyRelationPointers:[...c],xOffsetPx:y,yOffsetPx:_})}function q(e){const{environment:t,collectionContextStore:n,timelineState:o,query:r,schema:i,transaction:a}=e,s=o.dragState.state,{timeline_by:l}=r;if(!s||!l)return;const{temporaryValues:c,stores:d}=s;c.forEach(((e,o)=>{const s=d[o];B({environment:t,store:s,query:r,schema:i,transaction:a,date:e}),p().rv({environment:t,collectionContextStore:n,block_id:s.id,property:l,property_type:"date",from:"timeline"})})),o.dragState.setState(void 0)}function W(e){var t;const{timelineState:n,environment:o,transaction:r,collectionContextStore:i,isFullScreen:a,isRootChild:s}=e,l=n.drawState.state,c=n.dateRangePlaceholder.state;if(!l)return;const{startStore:d,startDependencyRelationPointers:u,temporaryDependencyRelationPointers:m}=l;if(!d)return void n.drawState.setState(void 0);let f;if(c.active){const{date:e,store:t,parentStore:a,groupFormat:s,newTimelineItemProps:l,existingTimelineItemProps:u}=c;if(t&&u){const{query:n,schema:i}=u;B({environment:o,store:t,query:n,schema:i,date:e,transaction:r}),f={table:"block",id:t.id,spaceId:d.getSpaceId()}}else if(l){const{query:n,schema:c,isFullScreen:u,canEditTimelineItems:m,subitemPath:p}=l,v=G({environment:o,date:e,store:t,parentStore:a,query:n,schema:c,isFullScreen:u,groupFormat:s,canEditTimelineItems:m,collectionContextStore:i,subitemPath:p,transaction:r,from:"timeline_complete_draw"});v&&(f={table:"block",id:v.id,spaceId:d.getSpaceId()})}n.dateRangePlaceholder.setState({active:!1})}else f=m.find((e=>!u.includes(e)));const v=(0,D()._e)(i);if(v){const{property:e}=v;f&&(y().hE({environment:o,propertyWithInverse:v,sourceStore:d,destStore:x().G.createChildStore(d,f),position:{type:"after"},transaction:r}),p().rv({environment:o,collectionContextStore:i,block_id:d.id,property:e,property_type:"relation",from:"timeline",isFromBulkActionsToolbar:!1,isUnthrottled:!0})),n.drawState.setState(void 0)}else S().wl({item:{type:"dependencies",from:"view_options"},collectionSettingsStore:i.settingsStore}),n.drawState.setState({...l,tryToCompleteDrawnArrow:!0});const g=null===(t=f)||void 0===t?void 0:t.id;g&&(0,M().LE)(o,{...(0,R().Pn)(i),...(0,M().Ii)({environment:o,collectionContextStore:i,timelineState:n,isFullScreen:a,isRootChild:s}),dependenciesPropertyID:null==v?void 0:v.property,blockedByStoreID:d.id,blockingStoreID:g})}function Q(e){const{timelineState:t,environment:n}=e;t.dragState.state&&(t.dragState.setState(void 0),I().ZH({environment:n}))}function X(e){const{timelineState:t,environment:n}=e;t.drawState.state&&(t.drawState.setState(void 0),I().ZH({environment:n}))}function $(e){const{stores:t,collectionViewStore:n,schema:o,transaction:r}=e,i=n.getType(),a=n.getQuery(o),s=[];a&&("calendar"===i?a.calendar_by&&s.push(a.calendar_by):"timeline"===i&&(a.timeline_by&&s.push(a.timeline_by),a.timeline_by_end&&s.push(a.timeline_by_end)));for(const l of t)for(const e of s)C().sO({environment:l.environment,store:l.getPropertyStore(e),value:void 0,transaction:r})}function j(e){const{dependency:t,collectionContextStore:n,environment:o,timelineState:r,isFullScreen:i,isRootChild:a}=e,s=(0,D()._e)(n),l=n.collectionStore();if(!s||!l)return;const{property:c}=s,{store:d,relationPointer:u}=t,m=d.getSchema()[c];m&&"relation"===m.type&&(A().createAndCommit({userAction:"CollectionTimelineDependenciesOverlay.handleRemoveRelation",environment:o,canUndo:!0,perform:e=>{y().Bl({environment:o,propertyWithInverse:s,sourceStore:d,destStore:x().G.createChildStore(d,u),transaction:e}),p().rv({environment:o,block_id:u.id,property:c,property_type:m.type,from:"timeline",collectionContextStore:n,isFromBulkActionsToolbar:!1,isUnthrottled:!0})}}),(0,M().lf)(o,{...(0,R().Pn)(n),...(0,M().Ii)({environment:o,collectionContextStore:n,timelineState:r,isFullScreen:i,isRootChild:a}),dependenciesPropertyID:c,blockedByStoreID:d.id,blockingStoreID:u.id}))}function Y(e){const{collectionViewStore:t,newProperty:n,transaction:o}=e;g().FH({stores:[t],update:{timeline_arrows_by:{property:n}},transaction:o})}function K(e){var t;const{collectionContextStore:n,relationPropertyId:o,transaction:r}=e,i=n.collectionStore();if(!i)return;const l=o?i.getSchema()[o]:void 0,c="relation"===(null==l?void 0:l.type)&&l.property&&"relation"===(null===(t=i.getSchema()[l.property])||void 0===t?void 0:t.type)?l.property:void 0;g().FH({stores:[i],update:{collection_default_arrows_by:o,...i.getFormat().app_config_uri===s().iS?{app_uri_map:{...i.getFormat().app_uri_map?i.getFormat().app_uri_map:{},[a().Es.BlockingRelation]:o,[a().Es.BlockedRelation]:c}}:{}},transaction:r})}function G(e){const{environment:t,transaction:n,date:o,parentStore:r,query:a,schema:s,isFullScreen:l,groupFormat:c,canEditTimelineItems:d,collectionContextStore:u,from:m}=e;if(!(0,P().ww)(t))return;const p=c?[c]:[],v=u.groupsStore.getGroupState(p);if(!v)return;if(r)return function(e){const{environment:t,transaction:n,date:o,store:r,parentStore:a,query:s,schema:l,groupFormat:c,canEditTimelineItems:d,collectionContextStore:u,subitemPath:m}=e;if(!r||!a)return;const p=c?[c]:[],v=f().yk({environment:t,collectionContextStore:u,groupsPointer:p,store:r,before:!1,collectionStore:a,transaction:n,subitemPath:m,subitemInsertDirection:"into"});if(v){if(B({environment:t,store:v,query:s,schema:l,date:o,transaction:n}),t.device.isMobile)_()._c({environment:t,store:v,pageVisitSource:i().tY.Create});else if(v&&d){const e=v.getBlockTitleStore();w().setSelectionAtStart({store:e})}return v}}(e);u.searchQueryStore.state&&(0,U().U)({searchQuery:"",collectionContextStore:u,isFullScreen:l});const S=f().IW({environment:t,collectionContextStore:u,groupsPointer:p,shouldCoerce:!0,templateStore:u.defaultPageTemplateStore.state,transaction:n,from:{createBlock:m},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache});if(!S)return;const g=S.coercionSucceeded,h=S.newStore;if(B({environment:t,store:h,query:a,schema:s,date:o,transaction:n}),t.device.isMobile)_()._c({environment:t,store:h,pageVisitSource:i().tY.Create});else if(g&&d){const e=h.getBlockTitleStore();w().setSelectionAtEnd({store:e})}else b().CH({environment:t,store:h,peekMode:(0,k().kr)(u),resultsStore:null==v?void 0:v.resultsStore,collectionContextStore:u,pageVisitSource:i().tY.Create});return h}},645843:(e,t,n)=>{n.d(t,{Al:()=>l,CB:()=>c,H6:()=>s,Ii:()=>f,LE:()=>m,gw:()=>d,iR:()=>i,lf:()=>p,ne:()=>u,zI:()=>a});n(267602),n(653476);var o=()=>n(594546),r=()=>n(701182);function i(e,t){o().lu(e,"timeline_view","timeline_view",5,t)}function a(e,t){o().K4(e,"timeline_zoom_level_update",t)}function s(e,t){o().K4(e,"timeline_today_click",t)}function l(e,t){o().K4(e,"timeline_shift_time_click",t)}function c(e,t){o().K4(e,"timeline_toggle_table_click",t)}function d(e,t){o().K4(e,"timeline_item_scroll_arrow_click",t)}function u(e,t){o().K4(e,"timeline_item_resize",t)}function m(e,t){o().K4(e,"timeline_dependency_arrow_add",t)}function p(e,t){o().K4(e,"timeline_dependency_arrow_delete",t)}function f(e){const{environment:t,collectionContextStore:n,timelineState:o,isFullScreen:i,isRootChild:a}=e,s=o.zoomLevel.state,l=n.normalizedFormatStore.state,c=(0,r().C1)({environment:t,format:l,isFullScreen:i,isRootChild:a}),d=c&&l.timeline_table_properties?l.timeline_table_properties.length:0,u=l.timeline_properties||[],m=u.filter((e=>"title"!==e.property));return{zoom_level:s,show_table:c,show_table_properties_count:d,show_timeline_title:u.length!==m.length,show_timeline_properties_count:m.length}}},715146:(e,t,n)=>{function o(e){const{searchQuery:t,collectionContextStore:n}=e;n.collectionViewStore()&&(n.searchQueryStore.setState(t||""),n.groupsStore.resetAllLimits())}n.d(t,{U:()=>o})},887330:(e,t,n)=>{n.d(t,{C:()=>r,L:()=>i});var o=()=>n(707513);function r(e){const{theme:t,isInHomeWidget:n}=e;return{display:"flex",alignItems:"center",fontSize:14,padding:6,...n?{height:24,width:24,color:t.lightTextColor,fill:t.lightIconColor}:{height:28,width:28,color:t.mediumIconColor,fill:t.mediumIconColor},fontWeight:o().Ue.regular,lineHeight:1,borderRadius:6}}function i(e){const{theme:t}=e;return{display:"flex",alignItems:"center",fontSize:14,height:28,padding:6,color:t.mediumIconColor,fontWeight:o().Ue.regular,lineHeight:1,borderRadius:4}}},681035:(e,t,n)=>{n.d(t,{S:()=>i});var o=()=>n(677559);const r=new(o().Ss)("CollectionItemCover",(async()=>{const{CollectionItemCover:e}=await Promise.all([n.e(62743),n.e(37912)]).then(n.bind(n,682652));return{CollectionItemCover:e}})),i=(0,o().kF)(r,(e=>e.CollectionItemCover))},314160:(e,t,n)=>{n.d(t,{Jh:()=>r,Mo:()=>a,O$:()=>l,_F:()=>i,aC:()=>s,mm:()=>c});var o=()=>n(594546);function r(e,t){(0,o().j)({environment:e,event:{eventName:"open_publish_modal",eventProperties:t}})}function i(e,t){(0,o().j)({environment:e,event:{eventName:"change_domain",eventProperties:t}})}function a(e,t){(0,o().j)({environment:e,event:{eventName:"update_seo_settings",eventProperties:t}})}function s(e,t){(0,o().j)({environment:e,event:{eventName:"site_set_link_expiration",eventProperties:t}})}function l(e,t){(0,o().j)({environment:e,event:{eventName:"page_unpublish",eventProperties:t}})}function c(e,t){(0,o().j)({environment:e,event:{eventName:"page_publish",eventProperties:t}})}},998470:(e,t,n)=>{n.d(t,{AB:()=>T,Au:()=>z,C$:()=>Q,DR:()=>R,Fo:()=>A,H2:()=>V,Hl:()=>N,KD:()=>X,Q6:()=>E,QP:()=>L,YU:()=>M,Y_:()=>D,c7:()=>B,cy:()=>j,dM:()=>k,dU:()=>x,f$:()=>F,gx:()=>H,pn:()=>P,t:()=>Z,wt:()=>$,xz:()=>q,y_:()=>O,yr:()=>W});n(821057),n(670560),n(267602),n(653476),n(241792),n(667294);var o=()=>n(396136),r=()=>n(81954),i=()=>n(928833),a=()=>n(899133),s=()=>n(788860),l=()=>n(513670),c=()=>n(342792),d=()=>n(824462),u=()=>n(636340),m=()=>n(752127),p=()=>n(102182),f=()=>n(269299),v=()=>n(205228),S=()=>n(487270),g=()=>n(314169),h=()=>n(663132),y=()=>n(479875),_=()=>n(836756),b=()=>n(759160),I=()=>n(314160),C=()=>n(566245),w=n(785893);function A(e){const{environment:t,store:n,type:o,header:a,domainId:s}=e,l=n.getSiteStore();if(l)return l.id;let c=s;var d;c||(c=null===(d=h().VA(n.getSpaceStore()))||void 0===d?void 0:d.id);const m=(0,S().$x)({environment:t,table:i().Gs,spaceId:(0,r().J)(n.getSpaceId())});f().createAndCommit({userAction:"publishSite.create",environment:t,canUndo:!0,perform:e=>{const r=u().Ue({environment:t,table:m.table,args:{id:m.id,type:o,spaceId:m.spaceId,blockId:n.id,domainId:c,currentUserId:t.currentUser.id,header:a??{}},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:e});return u().sW({store:n.getFormatStore(),data:{site_id:r.id},transaction:e}),r.id}})}function U(e){const{environment:t,siteRootBlockStore:n,domainId:o}=e;let r=n.getSiteStore();if(r||(A({environment:t,type:"site",store:n,domainId:o}),r=n.getSiteStore()),r)return r}function k(e){const{environment:t,domainId:n,resetWatermark:o}=e,r=U(e);r&&r.isDefined()&&(f().createAndCommit({userAction:"publishSite.updatePublicDomain",environment:t,canUndo:!0,perform:e=>{r.getDomainId()!==n&&f().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updatePublicDomainId({domainId:n,currentUserId:t.currentUser.id})})}}),f().createAndCommit({userAction:"publishSite.resetWatermark",environment:t,canUndo:!0,perform:e=>{if(o){const n=r.getHeader();f().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updateHeader({header:{...n,hideWatermark:!1},currentUserId:t.currentUser.id})})}}}),p().oV({label:(0,w.jsx)(s()._H,{id:"publishSiteSettings.publicDomain.confirmation",defaultMessage:"Successfully updated domain for all pages within this site"})}))}function R(e){const{environment:t,siteRootBlockStore:n,isSearchEngineIndexingEnabled:o}=e,i=U(e);if(!i)return;"form"!==i.getType()&&f().createAndCommit({userAction:"publishSite.updateSeoEnabled",environment:t,canUndo:!0,perform:e=>{i&&i.isDefined()&&o!==i.isSearchEngineIndexingEnabled()&&(f().applyOperation({transaction:e,store:i,operation:i.getModel().ops.updateIsSearchEngineIndexingEnabled({isSearchEngineIndexingEnabled:o,currentUserId:t.currentUser.id})}),o&&e.postSubmitCallbacks.push((async e=>{e||await d().callApi({eventName:"enqueueScanContentTask",environment:t,data:{pagePointer:{id:n.id,table:"block",spaceId:(0,r().J)(n.pointer.spaceId)}}})})))}})}function E(e){const{environment:t,store:n,seoTitle:o,seoDescription:r}=e;f().createAndCommit({userAction:"publishSite.create",environment:t,canUndo:!0,perform:e=>{const i=n.getFormat().seo_title,a=n.getFormat().seo_description;i===o&&a===r||(u().sW({store:n.getFormatStore(),data:{seo_title:o,seo_description:r},transaction:e}),(0,I().Mo)(t,{target_block_id:n.id,new_title:o??null,new_description:r??null}),p().oV({label:(0,w.jsx)(s()._H,{id:"siteSettingsEditor.publishSeoChanges.confirmation",defaultMessage:"Successfully updated the SEO settings"})}))}})}function x(e){b().Z.setState({...b().Z.state,settingOpen:e})}function T(){b().Z.setState({...b().Z.state,settingOpen:"initial"})}function P(e){_().Z.setState({..._().Z.state,siteSettingContentType:e})}function D(e){var t,n,o;const{siteRootBlockStore:r,permissionItem:i,from:a,sudoModeStore:s}=e,l=r.getSiteStore(),c=null==l?void 0:l.getHeader(),d=(null==c||null===(t=c.customItems)||void 0===t?void 0:t.map((e=>e.blockId)))||[];b().Z.setState({settingOpen:"initial",permissionItem:i,from:a,sudoModeStore:s,faviconUrl:(null==l?void 0:l.getFaviconUrl())||null,previewImageUrl:(null==l?void 0:l.getPreviewImageUrl())||null,hideBreadcrumbs:null==c?void 0:c.hideBreadcrumbs,hideSearch:null==c?void 0:c.hideSearch,hideWatermark:null==c?void 0:c.hideWatermark,enableDuplicateAsTemplate:i.allow_duplicate,customHeaderBlockIds:d,googleAnalyticsId:null==l?void 0:l.getGoogleAnalyticsId(),theme:null==l||null===(n=l.getSettings())||void 0===n?void 0:n.theme,enableQna:null==l||null===(o=l.getSettings())||void 0===o?void 0:o.enableQna})}async function M(e){var t;const{environment:n,store:r,siteRootBlockStore:i}=e,a=U({environment:n,siteRootBlockStore:i}),u=null==a?void 0:a.getType();if(!a||"form"===u)return;const m=b().Z.getState();let v=!1;const S={};let y;m.enableQna&&(y=await async function(e){var t,n,o,r;const{environment:i,siteStore:a}=e,s=null===(t=a.getSettings())||void 0===t?void 0:t.siteUserId;if(s)return s;if(!((null===(n=a.getDomainStore())||void 0===n?void 0:n.getDomainName())??(null===(o=h().VA(a.getSpaceStore()))||void 0===o?void 0:o.domain_name)))throw new Error("no domain on site");const l=h().Co({spaceStore:a.getSpaceStore(),domainId:null===(r=a.getDomainStore())||void 0===r?void 0:r.id}).split(":")[0],u=`${(0,c().XR)(a.id)}@${l}`,m=await d().callApi({eventName:"createEmailUser",environment:i,data:{email:u}});if("failed"===m.type)throw new Error("failed to create qna user");return m.data.userId}({environment:n,siteStore:a})),f().createAndCommit({userAction:"publishSite.updateSiteSettingsInEditor",environment:n,canUndo:!0,perform:e=>{if(a&&a.isDefined()){var t,o;(a.getFaviconUrl()||null)!==m.faviconUrl&&(f().applyOperation({transaction:e,store:a,operation:a.getModel().ops.updateFaviconUrl({faviconUrl:m.faviconUrl,currentUserId:n.currentUser.id})}),v=!0,S.favicon=m.faviconUrl);(a.getPreviewImageUrl()||null)!==m.previewImageUrl&&(f().applyOperation({transaction:e,store:a,operation:a.getModel().ops.updatePreviewImageUrl({previewImageUrl:m.previewImageUrl,currentUserId:n.currentUser.id})}),v=!0,S.preview_image=m.previewImageUrl);const r=a.getHeader();let i=r;const s=function(e,t){const n=e.map((e=>({type:"block",blockId:e})));if(!t&&0===n.length)return;if(t&&(0,l().Xy)(n,t))return;return n}(m.customHeaderBlockIds,null==r?void 0:r.customItems);s&&(i={...i,customItems:s},S.custom_headers=s.map((e=>e.blockId))),(null==r?void 0:r.hideBreadcrumbs)!==m.hideBreadcrumbs&&(i={...i,hideBreadcrumbs:m.hideBreadcrumbs},S.hide_breadcrumbs=m.hideBreadcrumbs),(null==r?void 0:r.hideSearch)!==m.hideSearch&&(i={...i,hideSearch:m.hideSearch},S.hide_search=m.hideSearch),(null==r?void 0:r.hideWatermark)!==m.hideWatermark&&(i={...i,hideWatermark:m.hideWatermark},S.hide_watermark=m.hideWatermark),i&&r!==i&&(f().applyOperation({transaction:e,store:a,operation:a.getModel().ops.updateHeader({header:i,currentUserId:n.currentUser.id})}),v=!0);a.getGoogleAnalyticsId()!==m.googleAnalyticsId&&(f().applyOperation({transaction:e,store:a,operation:a.getModel().ops.updateGoogleAnalyticsId({googleAnalyticsId:m.googleAnalyticsId,currentUserId:n.currentUser.id})}),v=!0,S.google_analytics_id=m.googleAnalyticsId);(null===(t=a.getSettings())||void 0===t?void 0:t.theme)!==m.theme&&(f().applyOperation({transaction:e,store:a,operation:a.getModel().ops.updateTheme({theme:m.theme,currentUserId:n.currentUser.id})}),v=!0,S.theme=m.theme);(null===(o=a.getSettings())||void 0===o?void 0:o.enableQna)!==m.enableQna&&(m.enableQna?y&&f().applyOperation({transaction:e,store:a,operation:{pointer:a.pointer,command:"update",path:["settings"],args:{enableQna:m.enableQna,siteUserId:y}}}):f().applyOperation({transaction:e,store:a,operation:{pointer:a.pointer,command:"update",path:["settings"],args:{enableQna:m.enableQna}}}),v=!0)}}});if((null===(t=m.permissionItem)||void 0===t?void 0:t.allow_duplicate)!==m.enableDuplicateAsTemplate&&m.permissionItem&&m.from){const e=m.from.table===o().iU?m.from.blockId:m.from.teamId;(0,g().iK)({oldPermissionItem:m.permissionItem,newPermissionItem:{...m.permissionItem,allow_duplicate:m.enableDuplicateAsTemplate},wasInherited:e!==r.id,environment:n,store:r,sudoModeStore:m.sudoModeStore,location:"published_site_settings"}),v=!0,S.enable_duplicate_as_template=m.enableDuplicateAsTemplate}v&&((0,C().u6)(n,{settings_changed:S}),p().oV({label:(0,w.jsx)(s()._H,{id:"siteSettingsEditor.publishChanges.confirmation",defaultMessage:"Changes published"})}))}function L(e){b().Z.setState({...b().Z.state,faviconUrl:e})}function F(e){b().Z.setState({...b().Z.state,previewImageUrl:e})}function Z(e){b().Z.setState({...b().Z.state,hideBreadcrumbs:e})}function B(e){b().Z.setState({...b().Z.state,hideSearch:e})}function V(e){b().Z.setState({...b().Z.state,hideWatermark:e})}function O(e){b().Z.setState({...b().Z.state,enableDuplicateAsTemplate:e})}function N(e){const t=b().Z.state.customHeaderBlockIds.concat([e]);b().Z.setState({...b().Z.state,customHeaderBlockIds:t})}function z(e){const t=b().Z.state.customHeaderBlockIds.filter((t=>t!==e));b().Z.setState({...b().Z.state,customHeaderBlockIds:t})}function H(e){b().Z.setState({...b().Z.state,googleAnalyticsId:e})}function q(e){b().Z.setState({...b().Z.state,theme:e})}async function W(e){const{environment:t,spaceStore:n,query:o,siteRootBlockId:r}=e;if(!n)return;const i=await d().callApi({eventName:"searchPagesInSite",environment:t,data:{query:o,spaceId:n.id,filters:a().u4({isDeletedOnly:!1,navigableBlockContentOnly:!0,excludeTemplates:!0,editedBy:[],ancestors:[r],inTeams:[]}),sort:{field:"relevance"},limit:10}});return"failed"!==i.type?i.data:void 0}async function Q(e){const{environment:t,blockStore:n,slug:o}=e,r=await d().callApi({eventName:"updatePublicPageSlug",environment:t,data:{spaceId:n.getSpaceId(),blockId:n.id,slug:o,clientVersion:v().default.version}});if("success"!==r.type)return{error:r};p().oV({label:(0,w.jsx)(s()._H,{id:"customSlugInput.updateSuccess.toast",defaultMessage:"Successfully updated URL for this page"})})}function X(e){b().Z.setState({...b().Z.state,enableQna:e})}function $(e){const{environment:t,store:n,pageVisitSource:o}=e,r=y().$({store:n,pageVisitSource:o});m().D({environment:t,url:r})}function j(e){const{environment:t,siteStore:n,embedSettings:o}=e;f().createAndCommit({userAction:"embedSite.updateEmbedSettings",environment:t,canUndo:!0,perform:e=>{u().sW({store:n.getSettingsStore(),data:{embedSettings:o},transaction:e})}})}},566245:(e,t,n)=>{n.d(t,{Cx:()=>a,g2:()=>r,u6:()=>i});var o=()=>n(594546);function r(e,t){(0,o().j)({environment:e,event:{eventName:"open_customize_site",eventProperties:t}})}function i(e,t){(0,o().j)({environment:e,event:{eventName:"update_site_customization_settings",eventProperties:t}})}function a(e){(0,o().j)({environment:e,event:{eventName:"close_customize_site",eventProperties:{}}})}},759160:(e,t,n)=>{n.d(t,{Z:()=>r});class o extends(()=>n(263184))().default{getInitialState(){return{settingOpen:"initial",permissionItem:void 0,from:void 0,sudoModeStore:void 0,location:"",faviconUrl:null,previewImageUrl:null,hideBreadcrumbs:!1,hideSearch:!1,hideWatermark:!1,enableDuplicateAsTemplate:!1,customHeaderBlockIds:[],googleAnalyticsId:void 0,theme:void 0,enableQna:!1}}}const r=new o},877727:(e,t,n)=>{n.d(t,{QZ:()=>a,SV:()=>r,mq:()=>i});var o=()=>n(749826);function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().default.checkGate({gateName:"workflow_templates_settings_dev",disableExposureLogging:e.disableExposureLogging})&&o().default.checkGate({gateName:"packaging_m3.1",disableExposureLogging:e.disableExposureLogging})}function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().default.checkGate({gateName:"packaging_m3.1",disableExposureLogging:e.disableExposureLogging})}function a(e){return!e.device.isPhone}},999582:(e,t,n)=>{n.d(t,{Z:()=>i});class o extends(()=>n(263184))().default{getInitialState(){return{}}}const r=new o;n(947115).exposeDebugValue("SpaceWorkflowTemplateInstanceMapStore",r);const i=r},29488:(e,t,n)=>{function o(e){return`${e.table}:${e.id}`}n.d(t,{O:()=>o})},157955:(e,t,n)=>{n.r(t),n.d(t,{DEFAULT_MAX_RECURRENCE_DUPLICATION_PER_TASK:()=>E,MAXIMUM_DAILY_RECURRENCES_IN_PATH:()=>I,MAXIMUM_NESTED_RECURRENCE_LEVEL:()=>b,MAX_RECURRENCE_INTERVAL:()=>S,MAX_RECURRENCE_NUMBER_OF_RUNS:()=>g,RRULE_WEEKDAYS_MAP:()=>v,convertFromUnpersistedRecurrenceConfig:()=>D,convertToUnpersistedRecurrenceConfig:()=>x,getFormattedEndCondition:()=>R,getFormattedNextRecurrenceTime:()=>k,getNewEndTimestamp:()=>T,getNextDateUtc:()=>U,getRecurrenceAfter:()=>w,isRunningBetweenMidnightAnd3AM:()=>A,isValidRecurrenceInterval:()=>h,isValidRecurrenceNumberOfRuns:()=>y,rruleFromRecurrence:()=>_,templateAncestorsViolateRecurrenceNesting:()=>C});n(267602),n(653476),n(241792);var o=()=>n(730120);n(670560);function r(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if(0===n.length)return e.map((e=>[e]));const i=[];for(const a of e)i.push(...r(n[0],...n.slice(1)).map((e=>[a,...e])));return i}var i=()=>n(696459),a=()=>n(326966),s=()=>n(803021),l=()=>n(646574),c=()=>n(998411),d=()=>n(578292);class u extends(()=>n(484885))().Ci{constructor(e,t){super(e,t)}after(e,t){return super.after(e,t)}}var m=()=>n(494616);const p=(0,n(788860).vU)({dateAtTime:{id:"automations.recurrenceHelpers.dateAtTime",defaultMessage:"{date} at {time}"},dateBetweenMidnightAnd3AM:{id:"automations.recurrenceHelpers.dateBetweenMidnightAnd3AM",defaultMessage:"{date} between 12â€“3 AM"},numberEndConditionDescription:{id:"automations.recurrenceHelpers.numberEndConditionDescription",defaultMessage:"{number, plural, one {After {number} run} other {After {number} runs}}"},noEndCondition:{id:"automations.recurrenceHelpers.noEndCondition",defaultMessage:"Never"}}),f={day:u.DAILY,week:u.WEEKLY,month:u.MONTHLY,year:u.YEARLY},v={MO:u.MO,TU:u.TU,WE:u.WE,TH:u.TH,FR:u.FR,SA:u.SA,SU:u.SU},S=99,g=999;function h(e){return(0,a().hj)(e)&&Number.isInteger(e)&&e>0&&e<=S}function y(e){return(0,a().hj)(e)&&Number.isInteger(e)&&e>0&&e<=g}function _(e){const{start_date:t,frequency:n,interval:o,weekdays:a,timezone:l,hour:c,minute:d}=e,m="week"===n&&a?a.map((e=>v[e])):void 0,p={};return(0,i().$K)(e.end_condition)&&("date"===e.end_condition.type?p.until=(0,s().pd)(e.end_condition.end_at):"number"===e.end_condition.type?p.count=e.end_condition.number_of_occurrences:(0,i().t1)(e.end_condition)),"month"===e.frequency&&(0,i().$K)(e.monthly_restriction)&&("monthdays"===e.monthly_restriction.type?p.bymonthday=e.monthly_restriction.monthdays:"weekdays_in_month"===e.monthly_restriction.type?p.byweekday=r(e.monthly_restriction.weekdays,e.monthly_restriction.week_numbers).map((e=>{let[t,n]=e;return v[t].nth(n)})):(0,i().t1)(e.monthly_restriction)),new u({freq:f[n],dtstart:(0,s().pd)(t),interval:o,byweekday:m,tzid:l,byhour:c??0,byminute:d??0,bysecond:0,...p})}const b=1,I=1;function C(e){var t;if(0===e.length)return{violatesConstraint:!1,templateNestingExceedsMaxDepth:!1,ancestorHasDailyTemplate:!1,nestedDepthOfAutomationAncestors:void 0,immediateAncestorRecurrenceType:void 0};const n=e.filter((e=>{var t;return"day"===(null===(t=e.getRecurrence())||void 0===t?void 0:t.frequency)})),o=e.length,r=null===(t=e[0].getRecurrence())||void 0===t?void 0:t.frequency,i=o>b,a=n.length>=I;return{violatesConstraint:i||a,templateNestingExceedsMaxDepth:i,ancestorHasDailyTemplate:a,nestedDepthOfAutomationAncestors:o,immediateAncestorRecurrenceType:r}}function w(e){const{recurrence:t,afterDate:n}=e;if((0,m().nA)(t)){const e=(0,s().kq)(n);return t.start_date>=e?new Date(t.start_date):void 0}{const e=_(t).after((0,s().pd)(n));if(!e)return;return(0,s().YL)(e)}}function A(e){return 0===e.hour||1===e.hour||2===e.hour}function U(e){return _(e).after((0,s().pd)((0,s().Jh)()))||void 0}function k(e){const{recurrence:t,intl:n}=e,r=U(D(t));if(!r)return;const i=A(t),a=o().ou.fromJSDate(r).toUTC().setZone("local",{keepLocalTime:!0}).setLocale((0,d().E2)(n)).setZone(t.timezone),s=(0,l().p6)({date:a,dateFormat:"relative",allowRelativeDates:!0,intl:n,shortenDate:!0});if(i)return n.formatMessage(p.dateBetweenMidnightAnd3AM,{date:s});{let e=a.toLocaleString(o().ou.TIME_SIMPLE);return t.timezone!==(0,c().r)()&&(e+=` ${a.toFormat("ZZZZ")}`),n.formatMessage(p.dateAtTime,{date:s,time:e})}}function R(e,t){return(0,i().$K)(e)?"number"===e.type?t.formatMessage(p.numberEndConditionDescription,{number:e.number_of_occurrences}):"date"===e.type?(0,l().p6)({date:o().ou.fromMillis(e.end_at),dateFormat:"relative",allowRelativeDates:!0,intl:t,shortenDate:!0}):void(0,i().t1)(e):t.formatMessage(p.noEndCondition)}const E=100;function x(e){return{...e,start_date:(0,s().kq)(e.start_date),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?{type:"date",end_at:(0,s().kq)(e.end_condition.end_at)}:(0,i().t1)(e.end_condition):void 0}}function T(e,t,n){return e.plus(n-t)}function P(e,t){const n=o().ou.fromMillis(t.end_at).set({hour:e.hour??0,minute:e.minute??0});return{type:"date",end_at:(0,s().Jh)(n.toJSDate())}}function D(e){return{...e,start_date:(0,s().Jh)(new Date(e.start_date)),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?P(e,e.end_condition):(0,i().t1)(e.end_condition):void 0}}},29248:(e,t,n)=>{n.d(t,{K:()=>r});n(667294);var o=n(785893);const r=(0,n(827282).IU)("boltFilled",{svg:(0,o.jsx)("path",{d:"M0 12.117c0 .38.293.664.703.664h5.518l-2.91 7.91c-.381 1.006.664 1.543 1.318.723l8.877-11.094c.166-.205.254-.4.254-.625 0-.371-.293-.664-.703-.664H7.539l2.91-7.91C10.83.115 9.785-.422 9.131.408L.254 11.492c-.166.215-.254.41-.254.625z"}),viewBox:"0 0 14 22"})},984478:(e,t,n)=>{n.d(t,{f:()=>r});n(667294);var o=n(785893);const r=(0,n(827282).IU)("chevronLeft",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M3.61816 8.06445C3.61816 8.29688 3.70703 8.49512 3.8916 8.67285L9.22363 13.8887C9.36719 14.0391 9.55859 14.1143 9.77734 14.1143C10.2217 14.1143 10.5703 13.7725 10.5703 13.3213C10.5703 13.1025 10.4814 12.9043 10.3311 12.7539L5.52539 8.06445L10.3311 3.375C10.4814 3.21777 10.5703 3.01953 10.5703 2.80078C10.5703 2.35645 10.2217 2.01465 9.77734 2.01465C9.55859 2.01465 9.36719 2.08984 9.22363 2.24023L3.8916 7.45605C3.70703 7.63379 3.625 7.83203 3.61816 8.06445Z"})})},94250:(e,t,n)=>{n.d(t,{c:()=>r});n(667294);var o=n(785893);const r=(0,n(827282).IU)("eye",{viewBox:"0 0 32 32",svg:(0,o.jsx)("path",{d:"M16.006 25.812c8.863 0 14.994-7.17 14.994-9.406C31 14.16 24.858 7 16.006 7 7.252 7 1 14.16 1 16.406c0 2.236 6.252 9.406 15.006 9.406zm0-3.242a6.194 6.194 0 01-6.197-6.164c-.012-3.452 2.744-6.164 6.197-6.164 3.419 0 6.185 2.711 6.185 6.164 0 3.364-2.766 6.164-6.185 6.164zm0-3.94c1.228 0 2.246-1.007 2.246-2.224 0-1.228-1.018-2.235-2.246-2.235-1.24 0-2.258 1.007-2.258 2.235 0 1.217 1.018 2.224 2.258 2.224z"})})}}]);