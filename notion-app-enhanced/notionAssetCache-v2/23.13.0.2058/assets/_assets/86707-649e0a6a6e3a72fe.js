"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[86707],{768064:(e,t,n)=>{n.d(t,{W_:()=>y,km:()=>I,l_:()=>h,nf:()=>b,yA:()=>j,zW:()=>T});n(267602),n(653476),n(241792);var a=()=>n(875120),r=()=>n(629719),i=()=>n(948505),o=()=>n(681941),s=()=>n(513670),d=()=>n(696459),u=()=>n(824462),l=()=>n(205228),c=()=>n(876822),m=()=>n(145613),p=()=>n(18281),f=()=>n(547526),v=()=>n(46135),x=()=>n(419157),g=()=>n(897257);async function y(e){var t;let{environment:n,billingData:i,billingInterval:s,vatId:l,addOn:f,onlyShowAddOn:v}=e;const y=m().Z.state,h=g().subscriptionDataStoreInstance.state;if(!y.open||!h)return;const b=(null==i?void 0:i.address)??y.temporaryAddress;if(!(0,a().A)(b))return;m().Z.update((e=>({...e,calculatingTax:!0})));const I=s??y.temporaryBillingInterval??"year",T=f??y.addOnFeature,j=v??y.onlyShowAddOn,S=null===(t=c().default.state.currentSpaceStore)||void 0===t?void 0:t.id;if(!S)return;const C=await(0,p().DI)(n,S,h),{planAmount:U,promoInfo:M,accountBalance:w}=(0,p().uN)({memberCount:C,promo:y.appliedPromo,currencyCode:x().Z.selectedCurrencyCode,data:h,addOnFeature:T,onlyShowAddOn:j,subscriptionTier:y.subscriptionTier,taxAmount:y.taxAmount,calculatingTax:y.calculatingTax,billingInterval:I,coupon:y.coupon}),K=Math.max(0,U-M.amount+w),O=[y.subscriptionTier,y.addOnFeature].map((e=>{switch(e){case void 0:return;case"ai":case"sites_custom_hostnames":return e;default:return(0,o().KE)(e)}})).map((e=>{const t=x().Z.getPrice(n,(t=>t.product===e&&t.billingInterval===s));return null==t?void 0:t.result})).map(A).filter(d().$K),Z=await u().callApi({eventName:"calculateTax",environment:n,data:{address:b,lineItems:O,price:K,vatId:l??y.vatApplicable?y.temporaryVatCode:void 0,customerId:(0,r().KU)(i)}});if("failed"===Z.type)m().Z.update((e=>({...e,taxAmount:void 0,calculatingTax:!1})));else{const e=Z.data;e.valid?m().Z.update((t=>({...t,taxAmount:e.taxAmount,calculatingTax:!1,taxCalculationError:void 0}))):m().Z.update((t=>({...t,taxAmount:void 0,calculatingTax:!1,taxCalculationError:e.error})))}}async function h(e,t){var n;const o=v().default.state,s=g().subscriptionDataStoreInstance.state;if(!o.open||!s)return;const d=o.temporaryAddress;if(!(0,a().A)(d))return;v().default.update((e=>({...e,calculatingTax:!0})));const l=(null===(n=o.totalUpgradeCost)||void 0===n?void 0:n.amount)||0,c=await u().callApi({eventName:"calculateTax",environment:e,data:{address:d,price:l,vatId:o.vatApplicable?o.temporaryVatCode:void 0,customerId:(0,r().KU)(t)}});if("failed"===c.type)v().default.update((e=>({...e,taxAmount:void 0,calculatingTax:!1})));else{const e=c.data;e.valid?v().default.update((t=>({...t,taxAmount:i().n.fromValue({amount:e.taxAmount,currencyCode:x().Z.selectedCurrencyCode}),calculatingTax:!1,taxCalculationError:void 0}))):v().default.update((t=>({...t,taxAmount:void 0,calculatingTax:!1,taxCalculationError:e.error})))}}async function b(e){const{environment:t,priceForTaxCalculation:n,address:a,customerId:r,vatId:i}=e,o=f().default.state,s=await u().callApi({eventName:"calculateTax",environment:t,data:{address:a,customerId:r,vatId:i,price:n}});if("failed"===s.type);else{const e=s.data;e.valid&&o.open&&f().default.update((t=>({...t,tax:Math.max(0,e.taxAmount)})))}}async function I(e){const{environment:t,billingData:n,stripeData:i,taxableAmount:o,lineItems:s}=e,{address:d}=null!=n&&n.address?{address:null==n?void 0:n.address}:e,l=null==i?void 0:i.vatId;if(!d||!(0,a().A)(d))return;const c=(0,r().KU)(n),m=await u().callApi({eventName:"calculateTax",environment:t,data:{address:d,price:o.amount,vatId:l,customerId:c,lineItems:s}});if("failed"===m.type)return;const p=m.data;return p.valid?p.taxAmount:void 0}function A(e){if(!e)return;if(void 0===e.unitAmount)return;const t=l().default.pricing[e.product];return"productId"in t?{amount:e.unitAmount.amount,productId:t.productId}:void 0}function T(e){const t=l().default.pricing[e.price.product];if("productId"in t)return{amount:e.price.unitAmount.amount*e.quantity,productId:t.productId}}function j(e){let{line:t,defaultProductId:n=l().default.pricing.plus.productId}=e;const a=(0,s().Cn)(t.discount_amounts??[],"amount"),r=t.price?"string"==typeof(i=t.price.product)?i:i.id:n;var i;return{amount:t.amount-a,productId:r}}},498854:(e,t,n)=>{n.d(t,{E:()=>j});n(267602),n(228244);var a=n(667294),r=()=>n(219727),i=()=>n(142735),o=()=>n(846550),s=()=>n(255393),d=()=>n(381348),u=()=>n(788860),l=()=>n(824462),c=()=>n(661641),m=()=>n(765513),p=()=>n(148126),f=()=>n(876822),v=()=>n(145613),x=()=>n(548812),g=()=>n(144948),y=()=>n(366637),h=()=>n(419157),b=()=>n(897257),I=()=>n(707513),A=n(785893);const T=function(){const e=(0,o().yK)((e=>({discountDescription:{alignItems:"center",color:e.mediumTextColor,fontSize:12,lineHeight:I().Nv.UISmall.desktop}})),[]);return(0,A.jsx)("div",{style:e.discountDescription,children:(0,A.jsx)(u()._H,{id:"spaceSubscriptionSettings.orderOptions.estimatedPriceWarning",defaultMessage:"The final amount due may be impacted by prorations and member changes since your last invoice."})})};function j(e){const{products:t,showTrialEndDisclaimer:n}=e,a=(0,o().yK)((()=>({termsOfService:{display:"flex",flexDirection:"column",gap:12}})),[]),r=(0,i().VK)((()=>h().Z.state.selectedCurrencyCode),[]),s=t.includes("ai"),u=t.some((e=>"ai"!==e)),l=void 0!==r&&"USD"!==r,m=(0,i().VK)((()=>{var e;return v().Z.state.open?null===(e=v().Z.state)||void 0===e?void 0:e.coupon:void 0}),[]),p=(0,g().K)()&&t.includes("plus")&&(0,d().K0)(m);return(0,A.jsx)(c().q,{styleName:"Body-12px/Regular",colorName:"secondary",children:(0,A.jsxs)("div",{style:a.termsOfService,children:[n?(0,A.jsx)(S,{}):null,s&&!u?(0,A.jsx)(C,{}):null,s&&u?(0,A.jsx)(U,{}):null,!s&&u?(0,A.jsx)(M,{}):null,u&&p&&(0,A.jsx)(w,{}),l?(0,A.jsx)(K,{currencyCode:r}):null]})})}function S(){return(0,A.jsx)("div",{children:(0,A.jsx)(u()._H,{id:"spaceSubscriptionUpgradeModal.trialWillEndToday.message",defaultMessage:"Upgrading will end your trial and your workspace will be billed immediately."})})}function C(){const e=(0,r().O7)(),t=function(){const e=(0,r().O7)(),t=(0,i().VK)((()=>{var e;return null===(e=f().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),[n,o]=(0,a.useState)();return(0,a.useEffect)((()=>{async function n(){var n;if(!t)return!1;const a=await l().callApi({eventName:"getSpaceMembershipUpdates",environment:e,data:{spaceId:t}});if("failed"===a.type)return!1;const r=!1===(null===(n=a.data[0])||void 0===n?void 0:n.isProcessed);o(!!r)}n()}),[e,t]),n}(),n=(0,y().b)(),o=(0,i().VK)((()=>{var t;return(0,x().px)(e)&&!(0,s().de)(null===(t=b().subscriptionDataStoreInstance.state)||void 0===t?void 0:t.addOns)&&n}),[n,e]);return(0,A.jsxs)("div",{children:[o?(0,A.jsx)(u()._H,{id:"subscriptionUpgradeModal.confirmation.aiWithDiscount",defaultMessage:"By continuing, you agree to the <aiTerms>Notion AI Product Specific Terms</aiTerms> and agree to receive <bold>50% off Notion AI</bold> for the next 3 months with a paid plan. <terms>See details.</terms>",values:{br:(0,A.jsx)("br",{}),aiTerms:e=>(0,A.jsx)(m().Z,{href:(0,p().UY)("ai.terms"),external:!0,children:e}),bold:e=>(0,A.jsx)("b",{children:e}),terms:e=>(0,A.jsx)(m().Z,{href:(0,p().UY)("terms.discounts.ai.summer.2023"),external:!0,children:e})}}):(0,A.jsx)(u()._H,{id:"subscriptionUpgradeModal.confirmation.aiOnly",defaultMessage:"By continuing, you agree to the <aiTerms>Notion AI Product Specific Terms</aiTerms>.",values:{br:(0,A.jsx)("br",{}),aiTerms:e=>(0,A.jsx)(m().Z,{href:(0,p().UY)("ai.terms"),external:!0,children:e})}}),t?(0,A.jsx)(T,{}):null]})}function U(){return(0,A.jsx)("div",{children:(0,A.jsx)(u()._H,{id:"subscriptionUpgradeModal.confirmation.planWithAi",defaultMessage:"By continuing, you agree to the <terms>Notion Terms and Conditions</terms> and <aiTerms>Notion AI Product Specific Terms</aiTerms>.",values:{br:(0,A.jsx)("br",{}),terms:e=>(0,A.jsx)(m().Z,{href:(0,p().UY)("terms"),external:!0,children:e}),aiTerms:e=>(0,A.jsx)(m().Z,{href:(0,p().UY)("ai.terms"),external:!0,children:e})}})})}function M(){return(0,A.jsx)("div",{children:(0,A.jsx)(u()._H,{id:"subscriptionUpgradeModal.confirmation.planOnly",defaultMessage:"By continuing, you agree to the <terms>Notion Terms and Conditions</terms>.",values:{terms:e=>(0,A.jsx)(m().Z,{href:(0,p().UY)("terms"),external:!0,children:e})}})})}function w(){return(0,A.jsx)("div",{children:(0,A.jsx)(u()._H,{id:"subscriptionUpgradeModal.confirmation.planOnlyResurrection",defaultMessage:"Enjoy 50% off your first 3 months of billing, then standard rates apply. <learnMore>Learn more</learnMore>",values:{learnMore:e=>(0,A.jsx)(m().Z,{href:(0,p().UY)("resurrectionLearnMore"),external:!0,children:e})}})})}function K(e){return(0,A.jsx)("div",{children:(0,A.jsx)(u()._H,{id:"subscriptionUpgradeModal.confirmation.currency",defaultMessage:"<terms>Learn about FX rates</terms>. Rates will refresh throughout the billing period.",values:{terms:e=>(0,A.jsx)(m().Z,{href:(0,p().UY)("terms.currency.fxRates"),external:!0,children:e})}})})}},144948:(e,t,n)=>{n.d(t,{K:()=>x});var a=n(667294),r=()=>n(219727),i=()=>n(142735),o=()=>n(893146),s=()=>n(381348),d=()=>n(824462),u=()=>n(345918),l=()=>n(228772),c=()=>n(876822),m=()=>n(438665),p=()=>n(595976),f=()=>n(629719),v=()=>n(548812);function x(){const e=(0,r().O7)(),t=(0,l().r)(),n=null==t?void 0:t.id,x=(0,p().p)({spaceId:n}),[g,y]=(0,a.useState)(!1),{currentSpaceStore:h}=(0,i().VK)((()=>{const{currentSpaceStore:e}=c().default.state;return{currentSpaceStore:e}}),[]),b=(0,i().VK)((()=>h?(0,u().rn)(e,h):void 0),[h,e]),I=function(e){return(0,i().VK)((()=>(0,v().a7)()&&Boolean("free"===(0,f().wO)(null==e?void 0:e.subscription))),[e])}(x),A=(0,i().VK)((()=>null==t?void 0:t.canAdmin()),[t]);return(0,a.useEffect)((()=>{!async function(){if(I&&n&&A)try{const t=await d().callApi({eventName:"getCustomerOffer",environment:e,data:{spaceId:n,offerCampaign:"resurrection_offer"}});if("failed"===t.type)return;if("offer"in t.data){const n=(0,o().iQ)(t.data.offer);(0,s().K0)(n)&&(y(!0),b&&(0,m().n9)({environment:e,spaceName:b,offerCampaign:"resurrection_offer"}))}}catch(t){return}}()}),[e,n,I,b,A]),g}}}]);