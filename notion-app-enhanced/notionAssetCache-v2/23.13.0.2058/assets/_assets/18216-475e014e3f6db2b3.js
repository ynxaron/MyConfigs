"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[18216],{418216:(e,t,i)=>{i.r(t),i.d(t,{measurePageRenderMetrics:()=>k,setInitialRenderCompleted:()=>S,setSubMetric:()=>f,setSubMetricsAtRenderCallback:()=>T,updateMetricData:()=>v,updateMetricDataWithIsPushTag:()=>b});i(241792),i(398858),i(461318),i(33228);var a=()=>i(469691),r=()=>i(990352),n=()=>i(22648),o=()=>i(594546),s=()=>i(512258),d=()=>i(138892),c=()=>i(410329),m=()=>i(148126),l=()=>i(620218),u=()=>i(860715),_=()=>i(749826),g=()=>i(601952),p=()=>i(235044),h=()=>i(842918);function T(e){const{mainStartTime:t,prefetchInitiatedTime:i,statsigBootupBlockingStartTime:a,renderStartTime:n,renderEndTime:o}=e,s=r().getAppStartTime();if(!s)return;const d={app_start_to_main_start:{startTime:s,endTime:t},main_start_to_prefetch_initiated:{startTime:t,endTime:i},prefetch_initiated_to_statsig_bootup_blocking_start:{startTime:i,endTime:a},statsig_bootup_blocking:{startTime:a,endTime:n},render_start_to_render_end:{startTime:n,endTime:o}};for(const[r,c]of Object.entries(d)){const e=null==c?void 0:c.startTime,t=null==c?void 0:c.endTime;e&&t&&(0,u().b)({name:r,startTime:e,endTime:t})}g().default.state.subMetricsStore.update((e=>({...e,...d})))}function f(e){const{name:t,endTime:i}=e,a=e.startTime(g().default.state.subMetricsStore.state);a&&(g().default.state.subMetricsStore.update((e=>({...e,[t]:{startTime:a,endTime:i}}))),(0,u().b)({name:t,startTime:a,endTime:i}))}function v(e){g().default.state.metricDataStore.update((t=>({...t,...e})))}function S(){g().default.update((e=>({...e,initialRenderCompleted:!0})))}function b(e){const t=e.RouterStore.state;let i;var a;"page"===t.route.name&&(i=t.route.mobileData,v({is_push:null===(a=i)||void 0===a?void 0:a.isPush}))}function k(e){let{environment:t,isEditable:i,isHomePage:n,isWikiHome:d,isPageWithCustomLayout:c,idSchema:u}=e;const{initialRoute:{name:T},route:v}=t.RouterStore.state,{initialRenderCompleted:b,initialRenderAfterLoginCompleted:k}=g().default.state,y=s().isPrewarmedTabInitialRender(t),C=(0,m().Sr)(t);b?k||"login"!==T?function(e,t){const i="page"===t.name?t.mobileData:void 0,a=h().Z.popTimings();if(a){const{navigationStart:t,requestFirstChunkStart:r,requestFirstChunkEnd:n,requestFirstChunkSource:s,pageViewBlockRender:d}=a,c=performance.now();l().default.measure({metricName:"navigation_page_render",startTime:t,endTime:c},{environment:e,data:{is_push:(null==i?void 0:i.isPush)??!1,wasm_sqlite_initialized:g().default.state.metricDataStore.state.wasm_sqlite_initialized,is_load_cached_page_chunk_v2:_().default.checkGate({gateName:"load_cached_page_chunk_multi_cell_enabled"})}}),(0,o().Vi)({eventName:"navigation_page_render_sub_metric",sampling:{behavior:"statsig",fallbackBehavior:"statsig",statsigNotAvailableBehavior:"drop"}}).then((i=>{if(!i)return;const a=t=>({environment:e,data:{type:t,chunk_source:s},sampleDecision:i});r&&l().default.measure({metricName:"navigation_page_render_sub_metric",startTime:t,endTime:r},a("navigation_start_to_request_first_chunk_start")),r&&n&&l().default.measure({metricName:"navigation_page_render_sub_metric",startTime:r,endTime:n},a("request_first_chunk_start_to_request_first_chunk_end")),n&&d&&l().default.measure({metricName:"navigation_page_render_sub_metric",startTime:n,endTime:d},a("request_first_chunk_end_to_pvb_render")),d&&l().default.measure({metricName:"navigation_page_render_sub_metric",startTime:d,endTime:c},a("pvb_render_to_handle_navigation_render"))}))}p().Z.state.isMeasuring&&p().Z.update((e=>({...e,isMeasuring:!1})))}(t,v):function(e){l().default.DO_NOT_USE_measureLegacy("initial_page_render_after_login",{environment:e}),g().default.update((e=>({...e,initialRenderAfterLoginCompleted:!0})))}(t):y?function(e){let{environment:t,initialRoute:i,isEditable:a,isHomePage:r,isWikiHome:n,isPageWithCustomLayout:o,isPublicDomain:s,idSchema:d}=e;S();const c=performance.now();f({name:"await_page_chunk_end_to_browser_repaint_start",startTime:e=>{var t;return null===(t=e.await_page_chunk_start_to_await_page_chunk_end)||void 0===t?void 0:t.endTime},endTime:c});const m=g().default.state.prewarmedTabAppStartTimeOverride;m&&l().default.measure({metricName:"initial_page_render",startTime:m,endTime:c},{environment:t,data:P({initialRoute:i,isEditable:a,isHomePage:r,isWikiHome:n,isPageWithCustomLayout:o,isPublicDomain:s,idSchema:d,isPrewarmedTab:!0,prewarmedTabNavigationStart:m}),shouldSendIfStatsigNotInitialized:!0});p().Z.state.isMeasuring&&p().Z.update((e=>({...e,isMeasuring:!1})))}({environment:t,initialRoute:T,isEditable:i,isHomePage:n,isWikiHome:d,isPageWithCustomLayout:c,isPublicDomain:C,idSchema:u}):function(e){var t;let{environment:i,initialRoute:n,isEditable:s,isHomePage:d,isWikiHome:c,isPageWithCustomLayout:m,isPublicDomain:u,idSchema:p}=e;const{initialLoadCachedPageChunkCalledAt:h}=g().default.state;S();const T=Boolean(null===(t=performance)||void 0===t?void 0:t.mark)?performance.mark("initial_page_render").startTime:performance.now();a().h1.mark("initial_page_render"),f({name:"await_page_chunk_end_to_browser_repaint_start",startTime:e=>{var t;return null===(t=e.await_page_chunk_start_to_await_page_chunk_end)||void 0===t?void 0:t.endTime},endTime:T});const v=r().getAppStartTime(),b=r().getPageOriginTime();v&&b&&b>0&&v>b&&f({name:"page_origin_to_app_start",startTime:()=>b,endTime:v});l().default.measureFromPageOrigin({metricName:"initial_page_render",endTime:T},{environment:i,data:P({initialRoute:n,isEditable:s,isHomePage:d,isWikiHome:c,isPageWithCustomLayout:m,isPublicDomain:u,idSchema:p,prefetchedQueryCollection:w(i),isPrewarmedTab:!1}),shouldSendIfStatsigNotInitialized:!0}),void 0!==h&&l().default.DO_NOT_USE_measureFromPageOriginLegacy({metricName:"load_cached_page_chunk_wait_time",endTime:h},{environment:i,data:{initial_route:n},shouldSendIfStatsigNotInitialized:!0,sendToStatsig:!0});_().default.checkGate({gateName:"beacon_pre_ipr_assets"})&&function(e,t){var i;if(null===(i=performance)||void 0===i||!i.getEntriesByType)return;const a=performance.getEntriesByType("resource"),r={eventName:"pre_ipr_assets",eventProperties:{ipr_end:t,assets:a.map((e=>{let t;try{t=new URL(e.name).pathname}catch{t=e.name}return{url:t,initiator_type:e.initiatorType,time:e.duration,perf_start:e.startTime,perf_end:e.startTime+e.duration,decoded_body_size:e.decodedBodySize,transfer_size:e.transferSize}}))}};(0,o().j)({environment:e,event:r})}(i,T)}({environment:t,initialRoute:T,isEditable:i,isHomePage:n,isWikiHome:d,isPageWithCustomLayout:c,isPublicDomain:C,idSchema:u})}function P(e){const{initialRoute:t,isEditable:i,isHomePage:a,isWikiHome:n,isPageWithCustomLayout:o,isPublicDomain:d,isPrewarmedTab:m,idSchema:l,prefetchedQueryCollection:u}=e;return{...s().getSubMetricsAndMetricDataForTracking(e.isPrewarmedTab?{isPrewarmedTab:!0,prewarmedTabNavigationStart:e.prewarmedTabNavigationStart}:{isPrewarmedTab:!1}),initial_route:t,is_editable:i,is_home_page:a,is_page_with_custom_layout:o,is_public_domain:d,profiling_tool:(0,c().getProfilingToolForSession)(),is_wiki_home:n,time_origin_to_app_start:r().getAppStartTime(),includes_page_origin_to_app_start:!0,is_load_cached_page_chunk_v2:_().default.checkGate({gateName:"load_cached_page_chunk_multi_cell_enabled"}),id_schema:l,prefetched_cvb:u,is_prewarmed_tab:m}}function w(e){var t;const i=e.RouterStore.state.route;if("page"!==i.name||!i.blockId)return!1;const a=n()._x.lookupViewId(i.blockId),r=(0,d().Z)(a),o=null===(t=e.prefetchCache)||void 0===t?void 0:t.getPrefetchAnalytic(r);return"hit-match"===(null==o?void 0:o.type)||"attempted"===(null==o?void 0:o.type)||"hit-mismatch"===(null==o?void 0:o.type)}},22648:(e,t,i)=>{i.d(t,{$W:()=>c,KV:()=>m,_x:()=>d});i(267602),i(30005);var a=()=>i(732811),r=()=>i(70186),n=()=>i(245015),o=()=>i(138892),s=()=>i(466970);const d=new class{constructor(){this.currentPageId=void 0,this.cacheIntoLocalStorage=!1,this._localStorage=void 0}startCachingViewIds(e){this.currentPageId=e,this.cacheIntoLocalStorage=!0}stopCachingViewIds(){this.currentPageId=void 0,this.cacheIntoLocalStorage=!1}registerForCurrentPage(e,t){if(!this.cacheIntoLocalStorage||this.currentPageId!==e)return;const i=this.entryForPage(e);if(this.cacheIntoLocalStorage=!1,i.v.includes(t))return i.t=Date.now(),void this.writeToLocalStorage();i.v=[t],i.t=Date.now(),this.writeToLocalStorage()}lookupViewId(e){const t=this.localStorage[e];return null==t?void 0:t.v[0]}clear(){this.currentPageId=void 0,this.cacheIntoLocalStorage=!1,this._localStorage=void 0}get localStorage(){return this._localStorage??(this._localStorage=n().Z.get(o().q)||Object.create(null))}entryForPage(e){let t=this.localStorage[e];return t||(t={v:[],t:0},this.localStorage[e]=t),t}writeToLocalStorage(){this.limitLocalStorageSize(),n().Z.set(o().q,this.localStorage)}limitLocalStorageSize(){const e=Object.keys(this.localStorage);if(e.length>=100){const t={timestamp:Number.MAX_SAFE_INTEGER,key:void 0};e.forEach((e=>{e!==this.currentPageId&&this.localStorage[e].t<t.timestamp&&(t.timestamp=this.localStorage[e].t,t.key=e)})),t.key&&delete this.localStorage[t.key]}}};function c(e){let{collectionContextStore:t,isFullScreen:i,wasCreatedThisSessionStore:r,environment:n}=e;const o=(0,s().E)("prefetch_inline_collection");(0,a().K)((()=>{var e;if(i||!o||r.state)return;const a=null===(e=t.collectionViewStore())||void 0===e?void 0:e.id,s=n.RouterStore.state.route;if("page"!==s.name)return;const c=s.blockId;c&&a&&d.registerForCurrentPage(c,a)}))}function m(e){let{pageId:t,isFrameContext:i}=e;(0,a().K)((()=>{i&&d.startCachingViewIds(t)})),(0,r().L)((()=>{i&&d.stopCachingViewIds()}))}},860715:(e,t,i)=>{i.d(t,{b:()=>r});var a=()=>i(680146);function r(e){const{name:t,startTime:i,endTime:r}=e;try{performance.measure(t,{start:i,end:r})}catch(n){a().IE(n,{extra:{name:t,startTime:i,endTime:r}})}}}}]);