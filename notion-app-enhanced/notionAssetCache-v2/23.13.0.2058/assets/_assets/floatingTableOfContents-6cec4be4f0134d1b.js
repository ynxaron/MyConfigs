"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[26534],{587262:(e,t,o)=>{o.r(t),o.d(t,{COLLAPSE_THRESHOLD_IN_PIXELS:()=>Z,FloatingTableOfContents:()=>N,FloatingTableOfContentsFullSizeContents:()=>G,FloatingTableOfContentsMiniContents:()=>Q});o(267602),o(470928),o(241792);var n=o(667294),i=()=>o(387934),r=()=>o(219727),a=()=>o(142735),l=()=>o(846550),s=()=>o(494488),d=()=>o(970381),c=()=>o(467171),u=()=>o(492522),g=()=>o(954452),p=()=>o(958783),f=()=>o(58836),h=()=>o(628370),v=()=>o(729775),x=()=>o(384241),S=()=>o(939513),m=()=>o(247724),y=()=>o(942226),b=()=>o(84080),C=()=>o(480089),w=()=>o(333264),R=()=>o(309797),k=()=>o(857719),M=()=>o(639708),T=()=>o(472753),j=()=>o(128076);var K=()=>o(521635),V=()=>o(32969),H=()=>o(589525),O=()=>o(998901),B=()=>o(35982),F=()=>o(252097),I=()=>o(687647),L=()=>o(482162),P=()=>o(797522),A=()=>o(965903),_=()=>o(825559),z=()=>o(846728);class E extends(()=>o(263184))().default{getInitialState(){return{displayState:"collapsed_narrow"}}}var D=o(785893);const Z=310,Y=!1;function N(e){const{store:t}=e,o=(0,r().O7)(),n=(0,a().VK)((()=>o.device.isMobile),[o]),{navigableAncestorStore:i}=(0,_().m)({parentStore:t}),l=(0,a().VK)((()=>(0,y().wq)(t)),[t]),s=(0,a().VK)((()=>{const e=null==i?void 0:i.getModel();return e&&"off"!==e.getFloatingTableOfContentsState()}),[i]),{isSidePeekOpen:d,isCenterPeekOpen:c}=(0,a().VK)((()=>({isSidePeekOpen:L().default.isSidePeekOpen(),isCenterPeekOpen:L().default.isCenterPeekOpen()})),[]),u=(0,a().VK)((()=>(0,H().Sx)(o)),[o]),f=(0,a().VK)((()=>K().Z.getPanelState("peek").isOpen),[]),h=(0,a().VK)((()=>F().d.state.open&&"chat"===F().d.state.currentView),[]),v=(x=t,(0,a().VK)((()=>{var e,t;const o=null===(e=x.getAssociatedCollectionStore())||void 0===e?void 0:e.getLayoutStore();if(!o)return!1;const n=o.firstModuleOfType("viewsMain");if(!n||!(0,M().aJ)(n))return!1;const i=j().G.createChildStore(o,n.collection_view_block_pointer);if(!i)return!1;const r=T().R.findCollectionViewBlockFromId(i.id),a=null==r||null===(t=r.collectionContextStore)||void 0===t?void 0:t.collectionViewStore();return a&&"page"!==a.getType()}),[x]));var x;const S=(0,a().VK)((()=>(0,g().fg)(o,t)&&(I().Z.state.open||p().default.state.open)),[o,t]);return!s||n||v||!l&&(d||u||h||S)||l&&(d||c&&f)?null:(0,D.jsx)(W,{store:e.store})}function W(e){const{store:t}=e,o=(0,n.useRef)(null),s=(0,a().qz)(void 0,E),{verticalScroller:d}=(0,n.useContext)(S().U)??{},{navigableAncestorStore:g,headerStores:p}=(0,_().m)({parentStore:t}),h=(0,r().O7)(),{closestSelectable:v,targetHorizontalRule:x}=(0,a().VK)((()=>{var e;if(!d)return{};const t=(null==d?void 0:d.getStore()).state.clientRect??d.getClientRect(),{selectableRectMap:o}=P().default.state,n=t&&t.top+t.height/4,i=V().C.findScrollToSelectablesFromIds(p.map((e=>e.id))),r=new Map(i.map((e=>[e.props.store.id,e]))),{stores:a,phase:l}=A().default.state,s=l===A().SelectionPhase.Selected?a.find((e=>r.has(e.id))):void 0,c=s&&r.get(s.id),u=c&&o.get(c);if(u&&t&&B().kK(u,t))return{closestSelectable:c,targetHorizontalRule:n};let g;if(void 0!==n)for(const d of i){const e=o.get(d);if(!e)continue;const t=e.top+e.height/2,i=Math.abs(n-t);(!g||i<g.distance)&&(g={distance:i,selectable:d})}return{targetHorizontalRule:n,closestSelectable:null===(e=g)||void 0===e?void 0:e.selectable}}),[p,d]),y=(0,a().VK)((()=>{var e;return null==g||null===(e=g.getModel())||void 0===e?void 0:e.getFloatingTableOfContentsState()}),[g]),b=(0,R().WJ)(t),C=(0,a().VK)((()=>s.state.displayState),[s]);(0,n.useEffect)((()=>{Y&&x&&(0,i().yX)({top:x-3,bottom:x+3,left:0,width:9e3},"active header target")}));const w=(0,l().yK)((()=>({outerContainer:{position:"absolute",top:0,width:"100%",height:`calc(100vh - ${c().R6(h.device.isElectronMac)}px)`,display:"flex",flexDirection:"column",pointerEvents:"none"},viewportHeightContainer:{display:"flex"}})),[h.device.isElectronMac]),[M,T]=function(e){const t=(0,n.useRef)(null),o=(0,a().VK)((()=>{var o;const n=P().default.state.selectableRectMap,i=null===(o=t.current)||void 0===o?void 0:o.getBoundingClientRect();if(!i)return!1;for(const[t,r]of n)if(t.getContextSelectableContainer()===A().default.getCurrentDefaultContainer()&&"collection_view"!==t.props.store.getType()&&!t.props.ignoreForTocSelectionIntersection&&B().kK(r,i)){const o=t.props.store.getRecordStoreUIRoot();return e===o}return!1}),[e]);return[t,o]}(e.store),j={store:t,navigableAncestorStore:g,scrollTargetY:x,activeBlockId:null==v?void 0:v.props.store.id,headerStores:p,floatingTocStore:s};return p.length<2&&"minimal"===y?null:(0,D.jsxs)(k().Vw,{style:{width:"100%",gridRow:"1 / -1",paddingLeft:b,position:"sticky",top:0,right:0,zIndex:u().O9,transition:"opacity 0.2s ease",opacity:T?0:1,visibility:T?"hidden":"visible",pointerEvents:T?"none":"auto"},children:[(0,D.jsx)("div",{style:{width:"100%",height:0},ref:o}),(0,D.jsx)("div",{className:`hide-scrollbar ${m().hBn} ${m().lUC}`,style:w.outerContainer,children:(0,D.jsx)("div",{style:w.viewportHeightContainer,children:(0,D.jsx)(f().p,{allowSelectionWithin:!0,style:{width:"100%"},children:"expanded"===C?(0,D.jsx)(U,{ref:M,...j}):(0,D.jsx)(X,{...j,ref:M})})})})]})}const X=n.forwardRef((function(e,t){const i=(0,r().O7)(),{floatingTocStore:s}=e,d=(0,n.useRef)(null),c=(0,o(527327).sH)(),u=(0,n.useRef)(),g=(0,a().VK)((()=>e=>{var t;(o(819828).Z.setState({isHovered:e}),s.setState({...s.state,displayState:e?"collapsed_full":"collapsed_narrow"}),e)&&(u.current=null===(t=d.current)||void 0===t?void 0:t.getBoundingClientRect(),(0,o(594546).j)({environment:i,event:{eventName:"open_page_table_of_contents",eventProperties:{}}}))}),[i,s]),p=(0,a().VK)((()=>"collapsed_narrow"===s.state.displayState),[s]),f=(0,l().yK)((()=>({miniSizeContainer:{width:56,display:"flex",flexDirection:"column",justifyContent:"center",paddingBottom:12,paddingRight:8}})),[]),{verticalOffsetInPx:v,maxHeightForFullSizeToc:x,maxHeightForCollapsedToc:S}=ie(e.store,s),m=(0,n.useCallback)((e=>({opacity:e?1:0})),[]);return(0,D.jsxs)("div",{style:{maxHeight:x,marginBottom:60,pointerEvents:"auto"},onMouseLeave:()=>g(!1),children:[(0,D.jsx)(h().Z,{animate:m(p),style:{maxHeight:S,display:"flex",flexDirection:"row",position:"absolute",top:v,right:0,overflowY:"hidden"},onMouseMove:b().V,children:(0,D.jsx)("div",{ref:c(d,t),style:f.miniSizeContainer,onMouseOver:()=>{g(!0)},children:(0,D.jsx)(Q,{...e})})}),(0,D.jsx)(h().Z,{tag:$,visible:!p,animate:{translateX:0,opacity:1},initial:{translateX:10,opacity:0},exit:{translateX:10,opacity:0},originRect:u.current,onMouseLeave:()=>g(!1),contentProps:e,maxHeightForFullSizeToc:x})]})})),$=n.forwardRef((function(e,t){let{originRect:n,contentProps:i,maxHeightForFullSizeToc:r,onMouseLeave:a,style:s}=e;const d=(0,l().yK)((e=>({fullSizeContainer:{width:242,display:"flex",flexDirection:"row",alignItems:"center",padding:"12px 12px 0 12px",marginRight:10,backgroundColor:e.contentBackground,boxShadow:e.shadowMD,borderRadius:14,position:"relative",overflowY:"auto"}})),[]);return(0,D.jsx)(o(967092).ZP,{preventCaptureEsc:!0,preventScaleTransition:!0,preventOpacityTransition:!0,popupType:o(104088).k.Popup,originGap:-56,alignmentToOrigin:O().Alignment.Start,open:!0,placementToOrigin:O().Placement.Left,originRect:n,style:{background:void 0,boxShadow:void 0,overflow:void 0,marginTop:-10},render:()=>(0,D.jsx)("div",{style:{display:"flex",flexDirection:"row",width:258,paddingLeft:16,cursor:"default",...s},onMouseMove:e=>{(0,b().V)(e),e.stopPropagation()},onMouseLeave:a,ref:t,children:(0,D.jsx)("div",{style:d.fullSizeContainer,children:(0,D.jsx)(G,{...i,fillBackground:!0,maxHeight:r})})})})})),U=n.forwardRef((function(e,t){const{store:o,floatingTocStore:n}=e,{verticalOffsetInPx:i,maxHeightForFullSizeToc:r}=ie(o,n);return(0,D.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"end",pointerEvents:"auto"},children:(0,D.jsx)("div",{ref:t,onMouseMove:b().V,style:{position:"absolute",top:i,marginRight:60,width:250,overflowY:"auto",maxHeight:r},className:"hide-scrollbar",children:(0,D.jsx)(G,{...e,maxHeight:r})})})}));function q(e){const t=(0,a().VK)((()=>d().y({headerBlockId:e.headerStore.id,headerBlockIds:e.headerStores.map((e=>e.id)),index:e.index,getRecordModel:e.store.getRecordModel})),[e.headerStore.id,e.headerStores,e.index,e.store.getRecordModel]),o=(0,C().rv)(e.store),i=(0,l().yK)((n=>({container:{...o,cursor:"pointer",width:"100%",paddingBottom:e.isLast?12:void 0,color:e.isActive?n.text.uiBluePrimary:n.text.secondary,transition:"color 0.15s ease"},linkBoxHovered:{background:n.tint.regular,borderRadius:4,color:e.isActive?n.text.uiBluePrimary:n.text.primary},nameContainer:{display:"flex",alignItems:"center",marginLeft:12*t},name:{paddingRight:s().ZD.paddingRight,paddingLeft:s().ZD.paddingLeft,fontSize:13,lineHeight:1.3,display:"flex",alignItems:"center",padding:4}})),[o,t,e.isActive,e.isLast]),r=(0,z().R)({pageStore:e.navigableAncestorStore,scrollToBlockId:e.headerStore.id,isFloatingToc:!0}),[c,u]=(0,n.useState)(!1);return e.navigableAncestorStore?(0,D.jsx)(v().Z,{style:{...i.container,...e.style},href:r.href,onClick:r.onClick,external:!1,onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),hovered:!1,pressedStyle:{background:"none"},ignoreLocalHoverState:!0,children:(0,D.jsx)("div",{style:{...i.nameContainer,...c?i.linkBoxHovered:{}},children:(0,D.jsx)("div",{style:i.name,children:(0,D.jsx)(x().Z,{store:e.headerStore,shouldWrap:!0,underline:!1,maxLines:2})})})}):null}function G(e){const{headerStores:t,navigableAncestorStore:o,maxHeight:n}=e,i=(0,l().yK)((e=>({container:{maxWidth:500,maxHeight:n,width:"100%",cursor:"default"},fillContainer:{padding:6,maxWidth:500,maxHeight:n,width:"100%",cursor:"default"}})),[n]);return(0,D.jsx)("div",{onMouseMove:b().V,style:e.fillBackground?i.fillContainer:i.container,children:t.map(((n,i)=>(0,D.jsx)(q,{headerStore:n,index:i,isLast:i===t.length-1,headerStores:t,store:e.store,navigableAncestorStore:o,isActive:n.id===e.activeBlockId,scrollTargetY:e.scrollTargetY},n.id)))})}function J(e){const t=(0,a().VK)((()=>d().y({headerBlockId:e.headerStore.id,headerBlockIds:e.headerStores.map((e=>e.id)),index:e.index,getRecordModel:e.store.getRecordModel})),[e.headerStore.id,e.headerStores,e.index,e.store.getRecordModel]),o=(0,l().yK)((o=>{const n=o.accentColors.gray[800],i="dark"===o.mode&&e.isActive;return{lineContainer:{backgroundColor:e.isActive?n:o.fill.grayPrimary,height:2,width:16-4*t,transition:"background 0.2s ease, box-shadow 0.2s ease",boxShadow:i?`0px 0px 3px ${n}`:"none",borderRadius:2,marginLeft:4*t}}}),[t,e.isActive]);return e.navigableAncestorStore?(0,D.jsx)("div",{children:(0,D.jsx)("div",{style:o.lineContainer})}):null}function Q(e){const{headerStores:t,navigableAncestorStore:o}=e,n=(0,l().yK)((()=>({container:{display:"flex",flexDirection:"column",gap:12,paddingLeft:20,paddingBottom:12,height:"100%"}})),[]);return(0,D.jsx)("div",{style:n.container,onMouseMove:b().V,children:t.map(((n,i)=>(0,D.jsx)(J,{headerStore:n,index:i,headerStores:t,store:e.store,navigableAncestorStore:o,isActive:n.id===e.activeBlockId},n.id)))})}const ee=113,te=600,oe=18,ne=130;function ie(e,t){const{verticalScroller:o}=(0,n.useContext)(S().U)??{},i=null==o?void 0:o.getStore(),r=(0,a().VK)((()=>(null==i?void 0:i.state.elementRef)??{current:null}),[i]),l=(0,w().j)(r),s=(0,w().$0)(r),d=(0,a().VK)((()=>{const t=V().C.findNodeFromBlockId(e.id),o=null==i?void 0:i.state;if(P().default.state.selectableElementRectMap,o&&t)return Math.max(t.offsetTop-l+oe,ne)}),[e,i,l]),c=(0,a().VK)((()=>t.state.displayState),[t]),u=s&&d?s-d-("expanded"!==c?80:0):te;return{maxHeightForFullSizeToc:u,maxHeightForCollapsedToc:Math.min(400,u),verticalOffsetInPx:d||ee}}}}]);