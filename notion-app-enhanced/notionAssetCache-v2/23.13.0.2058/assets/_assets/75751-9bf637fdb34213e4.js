"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[75751],{397174:(e,t,o)=>{o.d(t,{Z:()=>c});o(267602),o(653476),o(241792),o(258429);var i=o(667294),n=()=>o(846550),s=()=>o(26970),r=()=>o(707513),a=()=>o(384510),l=o(785893);function d(e){const{button:t,isLast:o}=e,a=(0,n().yK)((e=>({button:{display:"flex",alignItems:"center",padding:"4px 6px",fontWeight:r().Ue.medium,borderRight:`1px solid ${e.regularDividerColor}`,color:e.actionMenuButtonTextColor,fill:e.actionMenuButtonTextColor},buttonLast:{borderRight:"none"},buttonHovered:{background:e.whiteButtonHoveredBackground},buttonPressed:{background:e.whiteButtonPressedBackground}})),[]);return i.cloneElement(t,{...(0,s().iv)(t.props.style,a.button,o&&a.buttonLast),hoveredStyle:(0,s().iv)(a.buttonHovered,o&&a.buttonLast).style,pressedStyle:a.buttonPressed})}const c=function(e){let{children:t,isVisible:c,position:g,style:u}=e;const h=(0,o(219727).O7)(),p=(0,n().yK)((e=>({container:{color:e.actionMenuButtonTextColor,fill:e.actionMenuButtonTextColor,fontSize:12,background:e.whiteButtonBackground,boxShadow:e.shadowSM,display:"flex",whiteSpace:"nowrap",borderRadius:a().Z.borderRadius,maxWidth:"calc(100% - 16px)",minHeight:24,overflow:"hidden",pointerEvents:h.device.isMobile?"auto":"none",opacity:h.device.isMobile?1:0,fontFamily:r().F5(o(146947).locale).sans,position:"absolute",right:a().Z.horizontal.small,bottom:a().Z.vertical.small,zIndex:2},containerHover:{pointerEvents:"auto",opacity:1},containerTop:{top:a().Z.vertical.small,bottom:void 0}})),[h]),m=i.Children.toArray(t).filter(o(696459).$K),v=m.length;return(0,l.jsx)(o(628370).Z,{animate:{opacity:c?1:0},...(0,s().iv)(p.container,u,c&&p.containerHover,"top"===g&&p.containerTop),children:m.map(((e,t)=>{const n=t===v-1;if(e&&"object"==typeof e&&"type"in e){if(e.type===o(654133).Z&&i.isValidElement(e))return i.cloneElement(e,{render:(t,o)=>{const i=e.props.render(t,o);return(0,l.jsx)(d,{isLast:n,button:i},e.key)}});if(e.type===o(154186).Z&&i.isValidElement(e))return(0,l.jsx)(d,{isLast:n,button:e},e.key)}}))})}},75751:(e,t,o)=>{o.d(t,{Z:()=>x});var i=o(667294),n=()=>o(219727),s=()=>o(142735),r=()=>o(788860),a=()=>o(421654),l=()=>o(839821),d=()=>o(269299),c=()=>o(191586),g=()=>o(685472),u=()=>o(774985),h=()=>o(397174),p=()=>o(628370),m=()=>o(154186),v=()=>o(710706),b=o(785893);const x=function(e){let{store:t,disabled:r,paddingRight:l,paddingLeft:c,height:h,proxyWidth:p}=e;const m=(0,n().O7)(),v=(0,s().qz)(void 0,o(233417).Z),x=(0,s().VK)((()=>r||"suggest"===o(279386).MT.getMode(t)),[r,t]),y=(0,s().VK)((()=>t.getCover()),[t]),k=(0,s().Kw)(u().Z),[R,j]=(0,i.useState)(void 0);if(!y)return null;const w=k.loadingMode!==g().LU&&k.loadingMode!==g().SS;return(0,b.jsx)(o(910293).Z,{mouseStore:v,onFlushTemporaryPosition:e=>function(e,t,o){const{imagePosition:i,reset:n}=e;d().createAndCommit({userAction:"PageCover.handleFlushTemporaryPosition",environment:o,canUndo:!0,perform:e=>{a().Mp({store:t,coverPosition:i,transaction:e}),n()}})}(e,t,m),renderControl:e=>{let{handleRepositionClick:o,handleSavePositionClick:i,handleCancelClick:n,isVisible:s,isRepositioning:r}=e;return(0,b.jsx)(C,{handleRepositionClick:o,handleSavePositionClick:i,handleCancelClick:n,isVisible:s,isRepositioning:r,lastProxiedUrl:R,store:t,disabled:x,paddingRight:l,paddingLeft:c,mouseStore:v})},source:"page",store:t,style:{display:"flex",flexDirection:"column",alignItems:"center",height:h,maxHeight:280,cursor:"default"},render:e=>(0,b.jsxs)(i.Fragment,{children:[(0,b.jsx)(o(135499).Z,{url:y.cover,isAuthenticated:!0,permissionRecord:y.pointer,width:p,onFinishedLoadingProxyUrl:j,render:(t,i)=>{const n={width:"100%",height:h,maxHeight:280,objectFit:"cover",opacity:w?.5:1,objectPosition:`center ${100*(1-(e.imagePosition||0))}%`,borderRadius:0},s={width:"100%",height:h,maxHeight:280};return(0,b.jsx)(o(167499).B,{src:i,placeholderSrc:w?k.dataURL:void 0,placeholderBehavior:w?"force-show-placeholder":"show-placeholder-if-loading-src",containerStyle:s,imageStyle:n,onLoadComplete:f,testId:"pageCover"})}}),w&&(0,b.jsxs)("div",{style:o(518242).IA,children:[(0,b.jsx)(o(312578).Z,{size:"md",style:{marginRight:4}}),(0,b.jsx)("div",{style:{minWidth:30,textAlign:"right"},children:(0,b.jsx)(o(410184).Z,{percentage:k.uploadProgress})})]})]})})};function f(){u().Z.reset()}function C(e){let{isVisible:t,isRepositioning:o,handleCancelClick:a,handleRepositionClick:d,handleSavePositionClick:x,lastProxiedUrl:f,store:C,disabled:y,paddingRight:k,paddingLeft:R,mouseStore:j}=e;const w=(0,n().O7)(),P=(0,r().YB)(),S=(0,i.useCallback)((e=>function(e,t,o,i,n){n.reset();const s=e.target.getBoundingClientRect();l().j({environment:t,intl:o,store:i,rect:s})}(e,w,P,C,j)),[w,P,C,j]),Z=(0,s().VK)((()=>u().Z.state.loadingMode),[]),M=(0,s().VK)((()=>function(e){let t;return t=e.isFullWidth()?"100%":c().zL,t}(C)),[C]);if(y||Z!==g().LU)return null;const{device:L}=w,{isMobile:E}=L;return(0,b.jsx)(p().Z,{animate:{width:M,opacity:t?1:0},style:{position:"absolute",pointerEvents:t?"auto":"none",maxWidth:"100%",top:48},children:(0,b.jsxs)(h().Z,{isVisible:t,position:"bottom",style:{marginRight:k,marginLeft:R},children:[!o&&(0,b.jsx)(m().Z,{style:{borderRight:E?"none":void 0,...v().ar},onClick:S,children:(0,b.jsx)(r()._H,{defaultMessage:"Change cover",id:"pageCover.changeCover.text"})}),!o&&!E&&(0,b.jsx)(m().Z,{style:{...v().ar,borderRight:"none"},onClick:e=>d(e,f),children:(0,b.jsx)(r()._H,{defaultMessage:"Reposition",id:"pageCover.reposition.text"})}),o&&!E&&(0,b.jsx)(m().Z,{style:v().ar,onClick:x,children:(0,b.jsx)(r()._H,{defaultMessage:"Save position",id:"pageCover.savePosition.text"})}),o&&!E&&(0,b.jsx)(m().Z,{style:{...v().ar,borderRight:"none"},onClick:a,children:(0,b.jsx)(r()._H,{defaultMessage:"Cancel",id:"pageCover.reposition.cancelText"})})]})})}},910293:(e,t,o)=>{o.d(t,{Z:()=>v});var i=o(667294),n=()=>o(146947),s=()=>o(219727),r=()=>o(142735),a=()=>o(26970),l=()=>o(788860),d=()=>o(568017),c=()=>o(513670),g=()=>o(707513),u=()=>o(326966),h=()=>o(628370),p=o(785893);const m={isRepositioning:!1};const v=function(e){const t=(0,i.useRef)(null),n=(0,s().O7)(),{isMobile:l}=(0,s().Fy)(),[d,g]=(0,i.useState)(m),h=(0,i.useCallback)((()=>{g(m)}),[]),{renderControl:v,onFlushTemporaryPosition:x,style:f,source:C,store:y}=e,{isRepositioning:k,image:R,startDragRenderedPosition:j,startDragImageScreenHeight:w}=d,P=(0,r().VK)((()=>0===o(965903).default.state.stores.length),[]),[S,Z]=(0,i.useState)(!1),M=(0,r().qz)(e.mouseStore,o(233417).Z),L=(0,r().VK)((()=>M.state.mouseEntered),[M]),E=(0,o(846550).yK)((()=>({dragContainer:{width:"100%",cursor:k?"move":"inherit"},container:{position:"relative",width:"100%",zIndex:1}})),[k]),H=(0,r().VK)((()=>function(e,t,o){return(0,c().hj)(o)?o:function(e,t){if("gallery"===e||"board"===e){const e=t.getFormat().card_cover_position;if((0,c().hj)(e))return e}const o=.5;if(t.isCollectionView()){const e=t.getCollectionStore();if(e){const t=e.getFormat().collection_cover_position;return(0,u().z4)(t)?o:t}}const i=t.getFormat(),n=i.page_cover_position;if((0,c().hj)(n))return n;return o}(e,t)}(C,y,d.temporaryPosition)),[d.temporaryPosition,C,y]);(0,i.useEffect)((()=>{const e=e=>{const o=t.current;o&&!o.contains(e.target)&&k&&x({imagePosition:H,reset:()=>{M.reset(),h()}})};return window.addEventListener("mousedown",e),()=>window.removeEventListener("mousedown",e)}),[H,k,M,x,h]),k&&!P&&h();const D=(0,i.useMemo)((()=>(0,c().P2)((e=>{M.setState({...M.state,mouseEntered:!0})}),100)),[M]),V=(0,i.useMemo)((()=>(0,c().Ds)((e=>{M.setState({...M.state,mouseEntered:!1})}),100)),[M]),B=(0,i.useCallback)(((e,t)=>{o(879952).ZH({environment:n});const i=new Image;i.onload=()=>{g((e=>({...e,isRepositioning:!0,image:i})))},t&&(i.src=t)}),[n]),F=(0,i.useCallback)((e=>{x({imagePosition:H,reset:()=>{h()}})}),[H,x,h]),T=(0,i.useCallback)((e=>{const t=e.target;void 0!==t&&t instanceof HTMLElement&&(0,o(474788).E)(t)&&Z(!0)}),[]),K=(0,i.useCallback)((()=>{Z(!0)}),[]),_=(0,i.useCallback)((e=>{if(R&&k){const e=t.current;if(e&&e instanceof Element){const t=e.getBoundingClientRect().width/R.width*R.height;g((e=>({...e,startDragImageScreenHeight:t,startDragRenderedPosition:H})))}}}),[R,H,k]),I=(0,i.useCallback)((e=>{if(k){const t=e.diffY/(w||0)+(j||0);g((e=>({...e,temporaryPosition:(0,c().NM)((0,o(120420).Z)(t,0,1),4)})))}}),[k,w,j]),z=(0,i.useCallback)((()=>{g((e=>({...e,startDragImageScreenHeight:void 0,startDragRenderedPosition:void 0})))}),[]),A=(0,r().VK)((()=>v({handleRepositionClick:B,handleSavePositionClick:F,handleCancelClick:h,isVisible:l||L||S||k,isRepositioning:k})),[B,F,S,l,k,L,v,h]);return(0,p.jsxs)("div",{ref:t,onFocus:T,onBlur:K,onMouseEnter:D,onMouseMove:D,onMouseLeave:V,...(0,a().iv)(E.container,f),children:[(0,p.jsx)(o(790964).Z,{onDraggableDragStart:_,onDraggableDragMove:I,onDraggableDragEnd:z,onDraggableDragCancel:z,disabled:!k,render:t=>(0,p.jsx)("div",{...(0,a().iv)(E.dragContainer),...t,children:e.render({imagePosition:H,isRepositioning:k})})}),(0,p.jsx)(b,{small:e.small,isRepositioning:k}),A]})};function b(e){let{small:t,isRepositioning:o}=e;if(t)return null;const i={background:d().ZP.blackWithAlpha(.4),borderRadius:4,color:d().ZP.white,fontSize:12,fontFamily:g().F5(n().locale).sans,width:180,left:"calc(50% - 90px)",padding:"0.3em 1.5em 0.3em",pointerEvents:"none",position:"absolute",top:"calc(50% - 10px)",textAlign:"center"};return(0,p.jsx)(h().Z,{visible:o,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:i,children:(0,p.jsx)(l()._H,{defaultMessage:"Drag image to reposition",id:"withImageRepositioning.dragImage.text"})})}}}]);