"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[58658],{250976:(e,o,t)=>{t.r(o),t.d(o,{FormResponseSnapshotModal:()=>K});t(241792);var s=t(667294),n=()=>t(219727),a=()=>t(732811),r=()=>t(142735),i=()=>t(846550),d=()=>t(819418),l=()=>t(788860),p=()=>t(824462),c=()=>t(102182),u=()=>t(708518),m=()=>t(661297),h=()=>t(967092),f=()=>t(906651),g=()=>t(842574),S=()=>t(654133),x=()=>t(998901),y=()=>t(520849),M=()=>t(876822),v=()=>t(732466),j=()=>t(506347),R=()=>t(156642),w=()=>t(955620),T=()=>t(421654),C=()=>t(332542),F=()=>t(636340),P=()=>t(47443),b=()=>t(145284),A=()=>t(269299),k=()=>t(594546),_=()=>t(527278),D=()=>t(469753);function I(e){let{environment:o,inMemoryRecordCache:t,formSnapshotData:s,currentSpaceStore:n,currentSpaceViewStore:a,handleModalClose:r}=e;A().createAndCommit({environment:o,userAction:"FormResponseSnapshot.saveFormResponseAsPage",canUndo:!0,perform:e=>{const i=""!==s.formTitle?(0,w().TPx)(s.formTitle):(0,w().TPx)(_().Z.formatMessage(B.defaultFormResponseTitle)),d=F().j4({environment:o,type:R().Ti.page,properties:{title:i},format:{page_icon:"/icons/drafts_gray.svg"},inMemoryRecordCache:t,transaction:e,spaceId:n.id});s.questionsAndAnswers.map((s=>{const a=""!==s.question?(0,w().TPx)(s.question):(0,w().TPx)(_().Z.formatMessage(B.defaultQuestion)),r=F().j4({environment:o,type:R().Ti.subHeader,properties:{title:a},inMemoryRecordCache:t,transaction:e,spaceId:n.id});C().jG({parentStore:d,childStore:r,transaction:e});const i="checkbox"===s.questionType?(0,D().mJ)(s.answer):s.answer,l=""!==s.answer?(0,w().TPx)(i):(0,w().TPx)(_().Z.formatMessage(B.defaultAnswer)),p=F().j4({environment:o,type:R().Ti.text,properties:{title:l},inMemoryRecordCache:t,transaction:e,spaceId:n.id});C().jG({parentStore:d,childStore:p,transaction:e})})),b().Hj({environment:o,spaceStore:n,spaceViewStore:a,pageStore:d,isPrivate:!0,transaction:e,location:{type:"prepend"}}),T().Wq({environment:o,store:d,isLocked:!0,transaction:e}),(0,k().j)({environment:o,event:{eventName:"form_response_save_page",eventProperties:{page_id:d.id}}}),r(),P()._c({environment:o,store:d,pageVisitSource:j().tY.FormResponseSnapshot})}})}const B=(0,l().vU)({defaultFormResponseTitle:{id:"FormResponseSnapshotModal.saveResponseAsPage.defaultPageTitle",defaultMessage:"Your form response"},defaultAnswer:{id:"FormResponseSnapshotModal.saveResponseAsPage.defaultAnswer",defaultMessage:"(No answer)"},defaultQuestion:{id:"FormResponseSnapshotModal.saveResponseAsPage.defaultQuestion",defaultMessage:"(Untitled question)"}});var q=t(785893);const Z=72,H=72;function K(){const e=(0,n().O7)(),{isPhone:o}=(0,n().Fy)(),t=(0,l().YB)(),[d,m]=(0,s.useState)(void 0),[f,S]=(0,s.useState)(!1),{open:x,formResponseId:M,secretKey:j,formSpaceId:R}=(0,r().Kw)(v().Z),w=(0,r().VK)((()=>e.WindowSizeStore.getSafePaddingTopCSS(24)),[e]),T=(0,i().yK)((e=>({mobilePopup:{display:"flex",flexDirection:"column",alignItems:"center",height:"100%",paddingTop:w,paddingBottom:w},desktopModal:{padding:96,height:"100%",width:"100%",display:"flex",flexDirection:"column",alignItems:"center"}})),[w]);(0,a().K)((async()=>{if(!M||!j||!R)return;const o=e.currentUser.id,t=await p().callApi({eventName:"getFormResponseSnapshot",environment:e,data:{snapshotId:M,secretKey:j,spaceId:R},userId:o});"failed"!==t.type?(m(t.data.snapshotData),S(!0)):c().oV({label:(0,q.jsx)(l()._H,{defaultMessage:"There was an error loading your form response. Please contact the form creator.",id:"FormResponseSnapshotModal.Error"})})}));const C=(0,s.useCallback)((()=>{v().Z.setState({open:!1,formResponseId:void 0,secretKey:void 0,formSpaceId:void 0})}),[]);return!x||f&&!d?null:o?(0,q.jsx)(h().ZP,{popupType:h().kQ.SlideUp,style:T.mobilePopup,open:void 0!==d,onDismiss:C,render:()=>d?(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(g().T,{type:y().Z.Y,style:{marginBottom:50,width:"100%"},children:(0,q.jsx)("div",{style:{padding:20,width:"100%"},children:(0,q.jsx)(W,{formSnapshotData:d})})}),(0,q.jsx)(Y,{handleModalClose:C,formSnapshotData:d})]}):null}):(0,q.jsx)(u().Z,{ariaLabel:t.formatMessage({id:"FormResponseSnapshotModal.ariaLabel",defaultMessage:"Form Response"}),style:{},innerStyle:{height:`calc(100% - ${Z}px*2)`,width:`calc(100% - ${H}px*2)`,maxWidth:960},open:void 0!==d,onDismiss:C,render:()=>d?(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(U,{formSnapshotData:d,handleModalClose:C}),(0,q.jsx)(g().T,{type:y().Z.Y,style:T.desktopModal,children:(0,q.jsx)(W,{formSnapshotData:d})})]}):null})}function V(){const e=`/icons/drafts_gray.svg?mode=${(0,i().Fg)().mode}`;return(0,q.jsx)("img",{src:e,style:{height:75}})}function W(e){let{formSnapshotData:o}=e;const t=(0,i().Fg)(),s=(0,n().Fy)().isPhone,a=(0,r().VK)((()=>o.questionsAndAnswers??[]),[o]);return(0,q.jsxs)("div",{style:{maxWidth:700,wordBreak:"break-word",marginTop:12},children:[(0,q.jsx)(V,{}),(0,q.jsx)("h1",{style:{fontSize:s?28:40,fontWeight:700,marginBottom:42,lineHeight:1.2},children:(0,q.jsx)("span",{children:""===o.formTitle?(0,q.jsx)(l()._H,{id:"FormResponseSnapshotModal.yourResponse",defaultMessage:"Your form response"}):(0,q.jsx)(l()._H,{id:"FormResponseSnapshotModal.yourResponseToTitle",defaultMessage:"Your response to <a>{formTitle}</a>",values:{a:e=>(0,q.jsx)("a",{href:o.formUrl,style:{color:t.grayButtonPressedBackground,cursor:"pointer"},children:e}),formTitle:o.formTitle}})})}),(0,q.jsx)("div",{children:a.map(((e,o)=>(0,q.jsx)(z,{questionAndAnswer:e},o)))})]})}function z(e){let{questionAndAnswer:o}=e;const t=""===o.question?(0,q.jsx)(l()._H,{defaultMessage:"(Untitled question)",id:"FormResponseSnapshotModal.Question.defaultQuestion"}):o.question,s="checkbox"===o.questionType?(0,D().mJ)(o.answer):o.answer;return(0,q.jsxs)("div",{style:{display:"flex",flexDirection:"column",marginBottom:25},children:[(0,q.jsx)("span",{style:{fontSize:24,fontWeight:600},children:t}),(0,q.jsx)("span",{style:{fontSize:16,fontWeight:400,marginTop:6,wordWrap:"break-word"},children:""!==s?s:(0,q.jsx)(l()._H,{defaultMessage:"(No answer)",id:"FormResponseSnapshotModal.Answer.defaultAnswer"})})]})}function U(e){let{formSnapshotData:o,handleModalClose:t}=e;const a=(0,n().O7)(),r=(0,i().yK)((e=>({savePageIcon:{width:16,fill:e.icon.secondary,marginRight:5}})),[]),p=(0,s.useCallback)((()=>{const{currentSpaceStore:e,currentSpaceViewStore:s}=M().default.state;e&&s&&I({environment:a,inMemoryRecordCache:a.defaultRecordCache.inMemoryRecordCache,formSnapshotData:o,currentSpaceStore:e,currentSpaceViewStore:s,handleModalClose:t})}),[a,o,t]);return(0,q.jsx)(S().Z,{placement:x().Placement.Bottom,renderTooltip:()=>(0,q.jsx)(l()._H,{defaultMessage:"Save a copy of your response to your private section",id:"FormResponseSnapshotModal.ActionButtons.SavePage.tooltip"}),render:e=>(0,q.jsx)("div",{style:{position:"absolute",top:10,right:10,zIndex:2},children:(0,q.jsxs)(m().Z,{onClick:p,...e,children:[(0,d().$)(r.savePageIcon),(0,q.jsx)(l()._H,{defaultMessage:"Save page",id:"FormResponseSnapshotModal.ActionButtons.SavePage"})]})})})}function Y(e){let{handleModalClose:o,formSnapshotData:t}=e;const a=(0,n().O7)(),r=(0,s.useCallback)((()=>{const{currentSpaceStore:e,currentSpaceViewStore:s}=M().default.state;e&&s&&I({environment:a,inMemoryRecordCache:a.defaultRecordCache.inMemoryRecordCache,formSnapshotData:t,currentSpaceStore:e,currentSpaceViewStore:s,handleModalClose:o})}),[a,t,o]),d=(0,i().yK)((e=>({actionButtons:{height:47,width:"50%",fontSize:17,borderRadius:12}})),[]);return(0,q.jsxs)("div",{style:{display:"flex",width:"100%",position:"absolute",bottom:10,gap:12,zIndex:2,paddingLeft:10,paddingRight:10,paddingBottom:40},children:[(0,q.jsx)(f().Z,{onClick:r,style:{...d.actionButtons,justifyContent:"center"},children:(0,q.jsx)(l()._H,{defaultMessage:"Save",id:"FormResponseSnapshotModal.Mobile.SavePage"})}),(0,q.jsx)(m().Z,{onClick:o,style:d.actionButtons,children:(0,q.jsx)(l()._H,{defaultMessage:"Close",id:"FormResponseSnapshotModal.Mobile.Close"})})]})}}}]);