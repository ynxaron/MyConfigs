"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[85906,52194],{543573:(e,t,n)=>{n.d(t,{k2:()=>c,l6:()=>s,wk:()=>i});var o=()=>n(998411),r=()=>n(269299),a=()=>n(348141);function i(e){const{environment:t,userSettingsStore:n}=e,r=n.getSettings(),a=null==r?void 0:r.time_zone,i=(0,o().r)();a!==i&&s({environment:t,userSettingsStore:n,timeZone:i})}function s(e){const{environment:t,userSettingsStore:n,timeZone:o}=e;r().createAndCommit({userAction:"checkUserTimeZoneAction.updateTimeZone",environment:t,canUndo:!0,perform:e=>{a().d2({userSettingsStore:n,transaction:e,data:{time_zone:o}})},userId:n.id})}function c(e){const{environment:t,userSettingsStore:n,disableAutoSetTimezone:o}=e;r().createAndCommit({userAction:"checkUserTimeZoneAction.updateDisableAutoSetTimezone",environment:t,canUndo:!0,perform:e=>{a().d2({userSettingsStore:n,transaction:e,data:{disable_auto_set_timezone:o}})},userId:n.id})}},772538:(e,t,n)=>{n.d(t,{Z:()=>Go});var o=n(667294),r=()=>n(146947),a=()=>n(219727),i=()=>n(732811),s=()=>n(698422),c=()=>n(756280),l=()=>n(578292),d=()=>n(146630),u=()=>n(405851),p=()=>n(205228),m=()=>n(677559);const f=new(m().Ss)("thirdPartyScripts",(()=>n.e(39765).then(n.bind(n,679035)))),g=(0,m().kF)(f,(e=>e.InjectThirdPartyScripts));var v=()=>n(594546),h=()=>n(247724);const b={GlobalInAppMessageListener:new(m().Ss)("GlobalInAppMessageListener",(()=>n.e(96982).then(n.bind(n,797111))))},S=(0,m().kF)(b.GlobalInAppMessageListener,(e=>e.GlobalInAppMessageListener));var y=()=>n(595989),w=()=>n(142735),k=()=>n(846550),x=()=>n(788860),I=()=>n(707513),C=()=>n(102182),_=()=>n(718959),T=()=>n(804217),P=()=>n(749826),j=()=>n(991007),E=()=>n(747055),U=n(785893);function M(){const e=(0,x().YB)(),t=(0,k().Fg)(),n=(0,w().VK)((()=>!T().default.state.online),[]),r=(0,w().VK)((()=>(0,_().zj)()),[]),a=(0,o.useRef)(n),i=(0,o.useRef)(r);(0,o.useEffect)((()=>{!n||a.current&&r===i.current||function(e){var t;const{isOffline:n,currentPageId:o,intl:r,theme:a}=e;if(!(E().Z.state.offlinePages&&P().default.checkGate({gateName:"download_for_offline"})&&n&&o&&(0,j()._)(o)))return;const i=null===(t=E().Z.state.offlinePages[o])||void 0===t?void 0:t.lastDownloadedAt,s=i?r.formatDate(i,{day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric"}):void 0;C().oV({label:(0,U.jsxs)("div",{children:[(0,U.jsx)("div",{style:{fontWeight:I().Ue.medium},children:(0,U.jsx)(x()._H,{defaultMessage:"Working offline",id:"offlinePages.snackbar.title"})}),i&&(0,U.jsx)("div",{style:{color:a.text.secondary},children:(0,U.jsx)(x()._H,{defaultMessage:"Last sync on {lastDownloadedAtFormatted}.",id:"offlinePages.snackbar.description",values:{lastDownloadedAtFormatted:s}})})]})})}({isOffline:n,currentPageId:r,intl:e,theme:t}),a.current=n,i.current=r}),[n,r,e,t])}var L=()=>n(342792),R=()=>n(474602);function A(){!function(){const{defaultRecordCache:{persistedRecordCache:e},currentUser:{id:t}}=(0,a().O7)();(0,o.useEffect)((()=>{e&&t&&R().readAndCacheOfflinePagesMemo({userId:t,persistedRecordCache:e})}),[e,t])}();const{publishUpdate:e,onReceiveUpdate:t}=function(){const{defaultRecordCache:{persistedRecordCache:e},currentUser:{id:t}}=(0,a().O7)();return(0,o.useMemo)((()=>{if(!t)return;if(!e)return;const n=(0,L().ZP)();let o;try{o=new BroadcastChannel(`offlinePageUpdates-${t}`)}catch(r){return}return{publishUpdate:()=>{o.postMessage({type:"update",tabId:n})},onReceiveUpdate:e=>{o.onmessage=t=>{"update"===t.data.type&&t.data.tabId!==n&&e()}}}}),[t,e])}()||{};!function(e){const{defaultRecordCache:{persistedRecordCache:t},currentUser:{id:n}}=(0,a().O7)();(0,o.useEffect)((()=>{t&&n&&e&&e((()=>{R().readAndCacheOfflinePages({userId:n,persistedRecordCache:t})}))}),[t,n,e])}(t),function(e){const t=(0,w().VK)((()=>E().Z.state.shouldPublishUpdate),[]);(0,o.useEffect)((()=>{t&&e&&(e(),E().Z.setState({...E().Z.state,shouldPublishUpdate:!1}))}),[t,e])}(e)}var V=()=>n(341643);var Z=()=>n(956057),B=()=>n(876822);const N=6e4;async function O(e){var t,n;void 0!==B().default.state.currentUserStore&&void 0!==B().default.state.currentSpaceStore||await B().default.waitUntil((()=>void 0!==B().default.state.currentUserStore&&void 0!==B().default.state.currentSpaceStore));const o=null===(t=B().default.state.currentUserStore)||void 0===t?void 0:t.id,r=null===(n=B().default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(!document.hasFocus())return;if(!o||!r)return;const a=v().Cd({userId:o,spaceId:r}),i=Date.now();a?v().ci({userId:o,spaceId:r,session:{...a,lastFocusedTime:i}}):v().ci({userId:o,spaceId:r,session:{id:Z().Il(),sessionStartTime:i,lastFocusedTime:i}})}n(122556),n(582845),n(250570),n(533019),n(721473),n(788208),n(22624);const D=(0,n(830742).LS)("extractWebClipperContent");var K=()=>n(971095),q=()=>n(824462),F=()=>n(253038),z=()=>n(782646),W=()=>n(844095),H=()=>n(365609);const $=new(n(871663).Z);var G=()=>n(76254),Y=()=>n(593616);var X=()=>n(22628),Q=()=>n(345918),J=()=>n(458335);function ee(){const e=(0,a().O7)(),t=(0,w().VK)((()=>B().default.state.currentUserRootStore),[]);(0,o.useEffect)((()=>{t&&async function(e,t){await X().w();const n=t.getSpaceViewStores();for(const o of n){const t=o.getBookmarkedPageStores();for(const e of t)te(e);const n=o.getSharedPageStores();for(const e of n)te(e);const r=o.getTeamsStores();for(const e of r){const t=e.getTeamPagesStores();for(const e of t)te(e)}const a=o.getSpaceStore();if(a){J().Z.getData(e,{spaceId:a.id});const t=(0,Q().XD)(e,a);for(const e of t)te(e)}}}(e,t)}),[t,e])}function te(e){e.load();const t=e.getCollectionViewSourceOrLinkCollectionStores();for(const n of t)n.load()}var ne=()=>n(799891),oe=()=>n(245015),re=()=>n(566232),ae=()=>n(127898),ie=()=>n(917801),se=()=>n(308186),ce=()=>n(231077),le=()=>n(500174),de=()=>n(122479),ue=()=>n(9599),pe=()=>n(660293);const me=6e4;function fe(){const e=(0,a().O7)(),t=(0,o.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;t.setState({appUpdate:t.state.appUpdate,electronUpdate:{state:"checking"}})}(e)),[e]),n=(0,o.useCallback)(((t,n)=>function(e,t,n){const{AppUpdateStore:o}=n;o.setState({appUpdate:o.state.appUpdate,electronUpdate:{state:"error",error:t}})}(0,n,e)),[e]),r=(0,o.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;t.setState({appUpdate:t.state.appUpdate,electronUpdate:{state:"no-update",timestamp:Date.now()}})}(e)),[e]),i=(0,o.useCallback)(((t,n)=>function(e,t,n){const{AppUpdateStore:o}=n,r=(0,re().parseVersion)(t.version),a=ce().getDesktopVersion(),i=(0,re().getUpdateType)({currentVersion:a,nextVersion:r,app:"desktop"});o.setState({appUpdate:o.state.appUpdate,electronUpdate:{state:"downloading",type:i,version:r,timestamp:Date.now(),progress:0}})}(0,n,e)),[e]),s=(0,o.useCallback)(((t,n)=>function(e,t,n){const{AppUpdateStore:o}=n,r=o.state;r.electronUpdate&&"downloading"===r.electronUpdate.state&&o.setState({appUpdate:r.appUpdate,electronUpdate:{...r.electronUpdate,progress:t.transferred/t.total}})}(0,n,e)),[e]),c=(0,o.useCallback)(((t,n)=>function(e,t,n){const{device:o}=n,{AppUpdateStore:r}=n,a=oe().Z.get(ae().Tm),i=t.version;if(a===i){if(o.isMac)return r.setState({appUpdate:r.state.appUpdate,electronUpdate:{state:"ready",type:re().UpdateType.Major,version:void 0,versionCreatedTime:0}}),void se().vC({message:(0,U.jsx)(x()._H,{id:"desktopAppUpdater.moveNotionToApplicationsFolderDialog.prompt",defaultMessage:"Please move the Notion app into the Applications folder for the auto-updater to work."}),showCancel:!1,keepFocus:!1,handleCancel:()=>ae().mK(n),items:[{label:(0,U.jsx)(x()._H,{id:"desktopAppUpdater.moveNotionToApplicationsFolderDialog.dismissButton.label",defaultMessage:"OK"}),onAccept:()=>ae().mK(n)}]});ne().log({level:"error",from:"AppUpdateListener",type:"electronUpdateFailed",data:{miscDataToConvertToString:{previousUpdateReady:a,nextUpdateReady:i}}})}const s=ce().getDesktopVersion(),c=(0,re().parseVersion)(t.version),l=(0,re().getUpdateType)({currentVersion:s,nextVersion:c,app:"desktop"});r.setState({appUpdate:r.state.appUpdate,electronUpdate:{state:"ready",type:l,version:c,versionCreatedTime:0}})}(0,n,e)),[e]),l=(0,o.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;if(t.state.appUpdate&&"ready"===t.state.appUpdate.state)return;t.setState({electronUpdate:t.state.electronUpdate,appUpdate:{state:"checking"}})}(e)),[e]),d=(0,o.useCallback)(((t,n)=>he(n,e)),[e]),u=(0,o.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;if(t.state.appUpdate&&"ready"===t.state.appUpdate.state)return;t.setState({electronUpdate:t.state.electronUpdate,appUpdate:{state:"no-update",timestamp:Date.now()}})}(e)),[e]),m=(0,o.useCallback)(((t,n)=>be(n,e)),[e]),f=(0,o.useCallback)(((t,n)=>Se(n,e)),[e]),g=(0,o.useCallback)(((t,n)=>ye(n,e)),[e]),v=(0,o.useCallback)((()=>function(e){const t=e.AppUpdateStore;if(T().default.getState().online&&t.isSilentUpdate()){const n=t.state.appUpdate;ae().hC({environment:e,url:window.location.href,version:n.version,versionCreatedTime:n.versionCreatedTime})}}(e)),[e]);(0,o.useEffect)((()=>{const{device:o}=e;if(o.isElectron){const e=ce().electronUpdateReady.addListener(c),o=ce().electronUpdateError.addListener(n),a=ce().electronUpdateChecking.addListener(t),p=ce().electronUpdateAvailable.addListener(i),h=ce().electronUpdateProgress.addListener(s),b=ce().electronUpdateNotAvailable.addListener(r),S=ce().appUpdateReady.addListener(g),y=ce().appUpdateError.addListener(d),w=ce().appUpdateChecking.addListener(l),k=ce().appUpdateAvailable.addListener(m),x=ce().appUpdateInstall.addListener(v),I=ce().appUpdateProgress.addListener(f),C=ce().appUpdateNotAvailable.addListener(u);return()=>{null==e||e(),null==o||o(),null==a||a(),null==p||p(),null==h||h(),null==b||b(),null==S||S(),null==y||y(),null==w||w(),null==k||k(),null==x||x(),null==I||I(),null==C||C()}}}),[e,l,u,m,d,v,f,g,i,t,n,r,s,c]),(0,o.useEffect)((()=>{const{device:t,mobileNative:n}=e;if(n&&n.updateReceiveApiHandlers({appUpdateReady:t=>ye(t,e),appUpdateError:t=>he(t,e),appUpdateChecking:l,appUpdateAvailable:t=>be(t,e),appUpdateProgress:t=>Se(t,e),appUpdateNotAvailable:u}),function(e){const t=ae().ac(),n=ae().uG();if(!(0,re().isEqualVersion)(t,n)){0;ve((0,re().getUpdateType)({currentVersion:t,nextVersion:n,app:"client"}),n,ae().Ji(),e)}}(e),t.isMobileNative&&n&&n.api.openUpdateSettings){const n=t.osVersion,o=t.isAndroid&&(0,re().isLessThanVersion)(n,[7,0]),r=t.isIOS&&(0,re().isLessThanVersion)(n,[16,0]);(o||r)&&function(e){const{mobileNative:t}=e;if(!t)return;ie().Bw({bannerStore:ue().Z,id:"PlatformUpdateWarning",contentKey:"mobile_platform_unsupported",styleKey:le().v.Red})}(e)}}),[e,l,u]);const h=(0,o.useRef)("");(0,o.useEffect)((()=>{const{device:t,mobileNative:n}=e;if(!n&&!t.isElectron&&!p().default.isAdminMode&&(!p().default.isLocalhost||p().default.offline)){async function o(){if(pe().Z.state.isVisible)try{const t=ae().ac(),n=await q().callApi({eventName:"getAssetsJsonV2",environment:e,data:{hash:h.current}});if("success"===n.type){const o=n.data;if("version"in o){const n=(0,re().parseVersion)(o.version);n&&((0,re().isEqualVersion)(n,t)||ye(o,e))}"hash"in o&&(h.current=o.hash||"")}}catch(t){}}const r=setInterval(o,me);return()=>clearInterval(r)}}),[e])}async function ge(e,t){const n=await async function(e){await B().default.waitUntilRendered();const{mainEditorCurrentBlockStore:t,currentUserStore:n}=B().default.state;return!(!n||!t||(0,de().eV)(e,t))}(e);n&&(ae().gA(e,t,"banner"),ie().Bw({bannerStore:ue().Z,id:"AppUpdate",contentKey:"minor_app_update",styleKey:le().v.Blue}))}function ve(e,t,n,o){e===re().UpdateType.Major||e===re().UpdateType.Minor||ae().KE()?(t&&ae().M0(t)&&ae().D$(t,n),ge(o,e)):ae().TK()?function(e,t){ae().gA(e,t,"modal"),se().vC({message:(0,U.jsx)(x()._H,{defaultMessage:"We just launched new features!",id:"breakingUpdateDialog.title"}),showCancel:!1,keepFocus:!1,handleCancel:()=>ae().mK(e),items:[{label:(0,U.jsx)(x()._H,{defaultMessage:"Update and see what's new",id:"breakingUpdateDialog.updateButtonTitle"}),color:"blue",onAccept:()=>ae().mK(e)}],innerStyle:{width:380}})}(o,e):t&&ae().M0(t)&&ae().D$(t,n)}function he(e,t){const{AppUpdateStore:n}=t;n.state.appUpdate&&"ready"===n.state.appUpdate.state||n.setState({electronUpdate:n.state.electronUpdate,appUpdate:{state:"error",error:e}})}function be(e,t){const{AppUpdateStore:n}=t;if(n.state.appUpdate&&"ready"===n.state.appUpdate.state)return;const o=(0,re().parseVersion)(e.version),r=ae().ac(),a=(0,re().getUpdateType)({currentVersion:r,nextVersion:o,app:"client"});n.setState({electronUpdate:n.state.electronUpdate,appUpdate:{state:"downloading",type:a,version:o,timestamp:Date.now(),progress:0}})}function Se(e,t){const{AppUpdateStore:n}=t,o=n.state;o.appUpdate&&"downloading"===o.appUpdate.state&&n.setState({electronUpdate:o.electronUpdate,appUpdate:{...o.appUpdate,progress:e.downloaded/e.total}})}function ye(e,t){const{AppUpdateStore:n}=t,o=(0,re().parseVersion)(e.version),r=ae().ac(),a=(0,re().getUpdateType)({currentVersion:r,nextVersion:o,app:"client"}),i=e.createdTime;if(!ae().M0(o)){const e={state:"ready",type:a,version:o,versionCreatedTime:i};n.setState({electronUpdate:n.state.electronUpdate,appUpdate:e})}ve(a,o,i,t)}var we=()=>n(54193),ke=()=>n(916673);var xe=()=>n(977481);async function Ie(e){if(e.device.isBrowser&&document.hidden)return;if(e.device.isElectron&&!(await ce().isWindowVisible()))return;if(xe().isConnected())return void Ce(!0);if(!1===navigator.onLine&&!p().default.isLocalhost)return void Ce(!1);"success"===(await q().callApi({eventName:"ping",environment:e,data:{}})).type?Ce(!0):Ce(!1)}function Ce(e){T().default.setState({...T().default.state,online:e,lastOfflineTimestamp:e?T().default.state.lastOfflineTimestamp:Date.now()})}const _e=5e3;var Te=()=>n(100056);n(267602),n(653476),n(470928),n(749411),n(241792);var Pe=()=>n(26970),je=()=>n(955620),Ee=()=>n(463212),Ue=()=>n(661727),Me=()=>n(568017),Le=()=>n(513670),Re=()=>n(524977),Ae=()=>n(574767),Ve=()=>n(8208),Ze=()=>n(958783),Be=()=>n(288981),Ne=()=>n(687647),Oe=()=>n(111124),De=()=>n(645805);function Ke(e){const{discussionId:t,level:n}=e;return`\n\t\t.${(0,Pe().vE)({level:n})}.${(0,Pe().dk)({discussionId:t})}.${Ee().kB} {\n\t\t\tbackground: ${(0,Me().Hu)(e)} !important;\n\t\t\topacity: unset !important;\n\t\t\tborder-bottom: 2px solid ${(0,Me().hI)(e)} !important;\n\t\t}\n\t`}function qe(e){const{level:t}=e;return`\n\t\t.${(0,Pe().vE)({level:t})}.${Ee().Kx}.${Ee().kB} {\n\t\t\tbackground: ${(0,Me().Hu)(e)} !important;\n\t\t\topacity: unset !important;\n\t\t\tborder-bottom: 2px solid ${(0,Me().hI)(e)} !important;\n\t\t}\n\t`}function Fe(e){const t=(0,Me().Hu)({level:1,mode:e.mode,hovered:!1,selected:!1}),n=(0,Ue().Vi)(t).alpha()/2,o=(0,Ue().Vi)(t).alpha(n).toRgbString(),r=(0,Me().hI)({level:1,mode:e.mode,hovered:!1,selected:!1}),a=(0,Ue().Vi)(r).alpha()/2,i=(0,Ue().Vi)(r).alpha(a).toRgbString();return`\n\t\t.${Ee().mJ}.${Ee().kB} {\n\t\t\tbox-shadow: unset !important;\n\t\t\tpadding-bottom: 2px;\n\t\t\tbackground: ${o} !important;\n\t\t\tborder-bottom: 2px solid ${i} !important;\n\t\t\tanimation: commentFadeIn 500ms ease-in;\n\t\t}\n\t`}function ze(e){const{theme:t,selected:n,hovered:o}=e;return`background: ${(0,Me()._o)({annotationType:"update",type:"background",selected:n,hovered:o,overlapping:!1,mode:t.mode})} !important;\n\t\t\tborder-bottom: 2px solid ${(0,Me()._o)({annotationType:"update",type:"underline",selected:!1,hovered:!0,overlapping:!1,mode:t.mode})} !important;`}function We(e){const{discussionId:t,theme:n,selected:o,hovered:r}=e;return`\n\t\t.${(0,Pe().Ws)({type:"update"})}.${(0,Pe().dk)({discussionId:t})}.${Ee().kB} {\n\t\t\t${ze({theme:n,selected:o,hovered:r})}\n\t\t}\n\t\t.${(0,Pe().Ws)({type:"remove"})}.${(0,Pe().dk)({discussionId:t})}.${Ee().kB} {\n\t\t\t${function(e){const{theme:t,selected:n,hovered:o}=e,r=(0,Me()._o)({annotationType:"remove",type:"background",selected:n,hovered:o,overlapping:!1,mode:t.mode}),a=(0,Me()._o)({annotationType:"remove",type:"underline",selected:n,hovered:o,overlapping:!1,mode:t.mode});return`background: ${r} !important;\n\t\t\tcolor: ${t.text.secondary} !important;\n\t\t\ttext-decoration: none !important;\n\t\t\tborder-bottom: 2px solid ${a} !important;`}({theme:n,selected:o,hovered:r})}\n\t\t}\n\t`}function He(e){var t,n,o;const r=(null===(t=Ae().Z.state)||void 0===t?void 0:t.discussionIds)||[],a=null!==(n=Ne().Z.state)&&void 0!==n&&n.open&&(null===(o=Ne().Z.state)||void 0===o?void 0:o.discussionIds)||[];return[...r.flatMap((t=>Le().DZ(Pe().nB).map((n=>Ke({discussionId:t,level:n+1,hovered:!0,selected:!1,mode:e.mode}))))),...a.flatMap((t=>Le().DZ(Pe().nB).map((n=>Ke({discussionId:t,level:n+1,hovered:!1,selected:!0,mode:e.mode})))))].join("\n")}function $e(e){var t,n,o;const r=(null===(t=Ae().Z.state)||void 0===t?void 0:t.discussionIds)||[],a=null!==(n=Ne().Z.state)&&void 0!==n&&n.open&&(null===(o=Ne().Z.state)||void 0===o?void 0:o.discussionIds)||[];return[...r.map((t=>We({theme:e,discussionId:t,selected:!1,hovered:!0}))),...a.map((t=>We({theme:e,discussionId:t,selected:!0,hovered:!1})))].join("\n")}function Ge(e){let t="";const n=Be().Z.getHoveredEdit();n&&(t=`\n\t\t\t.${(0,Pe().EO)({type:"insert",editId:n.editId})} {\n\t\t\t\t${ze({theme:e,selected:!1,hovered:!0})}\n\t\t\t}\n\t\t\t.${(0,Pe().EO)({type:"remove",editId:n.editId})} {\n\t\t\t\t${function(e){return`background: ${(0,Me()._o)({annotationType:"remove",type:"background",selected:!1,hovered:!0,overlapping:!1,mode:e.mode})} !important;\n\t\t\tcolor: ${e.text.secondary} !important;\n\t\t\ttext-decoration-color: rgba(0, 0, 0, 0) !important;`}(e)}\n\t\t\t}\n\t\t`);return`\n\t\t${t}\n\t\t${`\n\t\t.${h().Y3l} .${(0,Pe().jN)("insert")} {\n\t\t\tbackground: initial !important;\n\t\t\tborder-bottom: initial !important;\n\t\t\tcolor: ${e.regularTextColor} !important;\n\t\t}\n\n\t\t.${h().Y3l} .${(0,Pe().jN)("remove")} {\n\t\t\tbackground: initial !important;\n\t\t\tborder-bottom: initial !important;\n\t\t\tcolor: ${e.text.quaternary} !important;\n\t\t}\n\t`}\n\t`}function Ye(e){const t=Re().v.getHoveredEditId();return t?function(e){const{editId:t,theme:n,selected:o,hovered:r}=e;return`\n\t\t.${(0,Pe().Sk)({editId:t})}.${Ee().kB} {\n\t\t\t${ze({theme:n,selected:o,hovered:r})}\n\t\t}\n\t`}({editId:t,theme:e,selected:!1,hovered:!0}):""}function Xe(){const e=(0,k().Fg)(),t=(0,w().VK)((()=>[He(e),$e(e)].join("\n")),[e]),n=(0,w().VK)((()=>function(){var e,t,n;const o=null===(e=Oe().Z.state)||void 0===e?void 0:e.store,r="token"===(null===(t=Oe().Z.state)||void 0===t?void 0:t.type)?null===(n=Oe().Z.state)||void 0===n||null===(n=n.annotations)||void 0===n?void 0:n.find(je().j0F):void 0;if(!r)return"";const a=(0,je().zW$)(r);return"block"!==(null==o?void 0:o.table)?"":`\n\t\t\t.${(0,Pe().S$)({href:a,blockId:o.id})}.${Ee().kB} {\n\t\t\t\ttransition: border-color 100ms ease-in, opacity 100ms ease-in;\n\t\t\t\tborder-color: currentColor !important;\n\t\t\t\topacity: 1 !important;\n\t\t\t}\n\t\t`}()),[]),r=(0,w().VK)((()=>Ge(e)),[e]),a=(0,w().VK)((()=>function(e){var t,n,o;if(!(null===(t=Ze().default.state)||void 0===t?void 0:t.open))return"";let r=[],a=[];return null!==(n=Ve().Z.state)&&void 0!==n&&n.isHovered&&(r=Le().DZ(Pe().nB).map((t=>qe({level:t+1,hovered:!0,selected:!1,mode:e.mode})))),null!==(o=Ve().Z.state)&&void 0!==o&&o.isActivelyComposing&&(a=Le().DZ(Pe().nB).map((t=>qe({level:t+1,hovered:!1,selected:!0,mode:e.mode})))),[...r,...a].join("\n")}(e)),[e]),i=(0,w().VK)((()=>function(e){return De().default.isRightMarginCommentHovered()?[Fe(e)].join("\n"):""}(e)),[e]),s=(0,w().VK)((()=>Ye(e)),[e]),c=(0,o.useMemo)((()=>[t,n,r,a,i,s].filter(Boolean).join("\n")),[r,t,n,a,i,s]),l=(0,o.useRef)(null);(0,o.useLayoutEffect)((()=>{if(!l.current){const e=document.createElement("style");l.current=e,document.head.appendChild(e)}l.current.innerHTML=c}),[c])}var Qe=()=>n(714230),Je=()=>n(659278),et=()=>n(225339),tt=()=>n(743359),nt=()=>n(998411),ot=()=>n(890085),rt=()=>n(321160),at=()=>n(375255),it=()=>n(306164),st=()=>n(497065),ct=()=>n(718611),lt=()=>n(338530),dt=()=>n(421797),ut=()=>n(611382),pt=()=>n(954344);const mt=32;const ft=32;async function gt(e){const t=document.createElement("canvas");t.width=ft,t.height=ft;const n=t.getContext("2d"),o=document.createElement("img");return o.src=e,o.crossOrigin="anonymous",new Promise((e=>{o.onload=()=>{n.drawImage(o,0,0,ft,ft),e(t.toDataURL("image/png"))},o.onerror=()=>{e("")}}))}var vt=()=>n(429725),ht=()=>n(512258),bt=()=>n(527278),St=()=>n(772529),yt=()=>n(704259),wt=()=>n(663132),kt=()=>n(772084),xt=()=>n(524434),It=()=>n(972218),Ct=()=>n(148882),_t=()=>n(235044),Tt=()=>n(826955);const Pt=(0,x().vU)({notionAiDocTitle:{id:"documentTitleListener.notionAi.title",defaultMessage:"Notion AI"}});function jt(){const e=(0,a().O7)(),t=(0,x().YB)(),n=(0,k().Fg)(),r=(0,o.useRef)(),i=(0,w().Kw)(xt().r4),s=(0,w().SI)((()=>{const{RouterStore:n,device:o}=e,r=n.state.route;if("chat"===r.name){return{assetPath:i?Qe().Z.images.assistantStaticFaceFaviconPng:Qe().Z.images.sparklesFavicon2Png,title:t.formatMessage(Pt.notionAiDocTitle)}}if("marketplace"===r.name)return{assetPath:Qe().Z.images.templates.faviconIco};if("settingsConsoleOrganization"===r.name)return{title:"Organization settings"};if("team"===r.name){const t=new(Tt().zX)(e,{table:it().e0,id:r.teamId});if(!t.isReady())return;return{title:t.getName(),icon:t.getIcon()}}const a=B().default.state.mainEditorCurrentBlockStore;if(!a||!a.isReady())return;const s="page"===r.name&&r.blockId===a.id,c=a.getSpaceStore()??B().default.state.currentSpaceStore;let l=!1;if("space"===r.name&&r.requestedOnPublicDomain){const e=wt().rl(c,a.id);l=(null==e?void 0:e.getDomainName())===r.spaceDomain}if(!s&&!l)return;const d=yt().default.getUnreadCountForCurrentSpace().mentions,u=a.getTitleStore();let p;const m=a.getModel(),f=a.getCollectionViewIds(),g=null==u?void 0:u.getRecordModel(u.pointer);if(u&&g){if(p=(0,at().Xh)({intl:bt().Z.getIntl(),textValue:u.getValue(),userTimeZone:(0,nt().r)(),getRecordModel:a.getRecordModel})||g.getEmptyTitlePlaceholder({getRecordModel:u.getRecordModel,userTimeZone:(0,nt().r)(),intl:t}),"block"===u.table&&(0,St().WE)(a)&&c){p=`${c.getName()} - ${t.formatMessage({id:"DocumentTitleListener.personalHomeLabel",defaultMessage:"Home"})}`}if("collection"===u.table&&m&&m.isCollectionView()&&f.length>1){const e=B().default.state.currentCollectionViewStore;e&&e.getName()&&(p=`${p} | ${e.getName()}`)}"block"===u.table&&a.isWorkflowPage()&&(p=a.getRenderTitleForWorkflowPage(t)),o.isElectron||(p=(0,Je().db)(p.slice(0,100),lt().Z.state)),de().eV(e,a)||e.device.isElectron||e.device.isMobileNative||(d>9?p=`(9+) ${p}`:d>0&&(p=`(${d}) ${p}`))}let v;null!=c&&c.getPublicSpaceData()&&(v="page"===r.name?(0,vt().ZP)({store:a,fullyQualified:!1,scrollToBlockId:null==r?void 0:r.scrollToBlockId,peekViewBlockId:r.peekViewBlockId,peekMode:r.peekMode,workflowViewType:r.workflowViewType,workflowViewKey:r.workflowViewKey,chatThreadId:r.chatThreadId,collectionViewId:r.collectionViewId,discussionId:r.discussionId,showMoveTo:r.showMoveTo,saveParent:r.saveParent,templateGalleryItem:r.templateGalleryItem,projectManagementLaunch:r.projectManagementLaunch,pageVisitSource:void 0,embedded:r.embedded}):(0,vt().ZP)({store:a,fullyQualified:!1,pageVisitSource:void 0}));const h=null==m?void 0:m.isNonverifiedContentClassification(),b=h&&m&&It().Z.bypassedPage(a.id),S=(0,dt().Iay)(),y=function(e,t,n){if("space"!==e.name&&"page"!==e.name||!e.requestedOnPublicDomain||!t)return n.getIcon();{const e=kt().gR(n);if(null==e||!e.getSiteId())return n.getIcon();const t=null==e?void 0:e.getSiteStore();if(e&&t&&t.isDefined()){const o=t.getFaviconUrl();return o?{pointer:e.pointer,icon:o}:n.getIcon()}}}(r,c,a);return{title:p,url:v,icon:y,isNonverified:h,hasBypassedContentClassification:b,isMemberOfSpace:S}}),[e,t,i],{useDeepEqual:!0});(0,w().Kw)(s),(0,o.useEffect)((()=>{const o=Le().Ds((function(){const{device:o}=e,a=s.state;if(!a)return;const{url:i,title:c,icon:l}=a;let d,u,m,f;l&&(0,ot().V2)(l.icon)?m=l.icon:l&&(0,rt().Z)(l.icon)?d=l.icon:l&&et().F8(l.icon)?u=l:a.assetPath&&et().LF(a.assetPath)&&(f=a.assetPath);const g=a.isNonverified&&!a.hasBypassedContentClassification&&!a.isMemberOfSpace;c&&document.title!==c&&(g?document.title=t.formatMessage({id:"pageTitle.flaggedContent",defaultMessage:"Flagged Content"}):o.isSafari&&d?document.title=`${d} ${c}`:document.title=c),i&&ke().T1(i)!==ke().T1(window.location.href)&&(window.history.replaceState(window.history.state,void 0,i),st().j7({environment:e,url:window.location.href}));const v=document.querySelector("link[rel='shortcut icon']");if(v){const t=Qe().Z.images.faviconIco;if(g)v.href=t,r.current=t;else if(d)d!==r.current&&(r.current=d,async function(e,t){const n=document.createElement("canvas");n.width=mt,n.height=mt;const o=n.getContext("2d");if(o.font="normal normal normal 32px/32px sans",o.textAlign="center",o.textBaseline="middle","raw"===t)return o.fillText(e,n.width/2,n.height/2+4),n;const r=await pt().F.load(),a=(0,ut().y)(e,r);if(!a)return;const i=document.createElement("img");i.src=(0,Je().bk)(t);const s=(0,Je().G0)(a);return new Promise((e=>{i.onload=()=>{o.drawImage(i,s.x,s.y,s.size,s.size,0,0,mt,mt),e(n)},i.onerror=()=>{e(void 0)}}))}(d,(0,ct().e_)(e)).then((async e=>{await ht().waitForInitialPageRenderToComplete(),await _t().Z.waitUntil((()=>!_t().Z.state.isMeasuring)),v.href=(null==e?void 0:e.toDataURL("image/png"))||""})));else if(m){if(m!==r.current){r.current=m;const e=`${m}?mode=${n.mode}`;o.isFirefox?v.href=e:gt(e).then((e=>{v.href=e}))}}else if(u){const{icon:t,...n}=u;if(window.location.origin!==p().default.domainBaseUrl){const o=tt().EK({url:t,permissionRecord:n.pointer,baseUrl:p().default.domainBaseUrl,fullyQualified:!1,userId:e.currentUser.id,favicon:!0});o!==r.current&&(r.current=o,Ct().transactionQueue.awaitRecordTransaction(n.pointer).then((()=>{v.href=o})))}else{const o=tt().EK({url:t,permissionRecord:n.pointer,baseUrl:p().default.domainBaseUrl,fullyQualified:!1,userId:e.currentUser.id,width:100});o!==r.current&&(r.current=o,Ct().transactionQueue.awaitRecordTransaction(n.pointer).then((()=>gt(o))).then((e=>{v.href=e})))}}else if(f){const t=tt().Q4({url:f,width:100,baseUrl:p().default.domainBaseUrl,fullyQualified:!1,userId:e.currentUser.id});t!==r.current&&(r.current=t,gt(t).then((e=>{v.href=e})))}else t!==r.current&&(v.href=t,r.current=t)}ce().electronApi&&ce().electronApi.setWindowTitle&&c&&ce().electronApi.setWindowTitle(c)}),500,{leading:!0}),a=document.title;return s.state&&o(),s.addListener(o),()=>{s.removeListener(o),document.title=a}}),[e,t,s,n.mode])}n(30005);var Et=()=>n(831842),Ut=()=>n(201741),Mt=()=>n(952864);const Lt=(0,x().vU)({have_local_draft_unsaved_changes:{defaultMessage:"Changes you made to the layout may not be saved.",id:"closeConfirmationMessages.haveLocalDraftUnsavedChanges"}});var Rt=()=>n(793935),At=()=>n(291335),Vt=()=>n(725751),Zt=()=>n(255810),Bt=()=>n(767831);var Nt=()=>n(326966),Ot=()=>n(709344);function Dt(e){(0,Ot().default)({url:`${p().default.secureFileConfig.rootPath}/refresh`,environment:e,method:"GET",format:"text"})}n(916054);var Kt=()=>n(491927),qt=()=>n(897257);const Ft=Le().P2(Kt().XW,5e3);var zt=()=>n(534200),Wt=()=>n(43519);var Ht=()=>n(244222),$t=()=>n(59407);var Gt=()=>n(166569),Yt=()=>n(990352),Xt=()=>n(565630),Qt=()=>n(391216),Jt=()=>n(485014);const en={recentPagesActions:new(m().Ss)("recentPagesActions",(async()=>Promise.resolve().then(n.bind(n,838347)))),userSignalsHelpers:new(m().Ss)("userSignalsHelpers",(async()=>n.e(18638).then(n.bind(n,126621)))),broadcastChannel:new(m().Ss)("broadcastChannel",(async()=>Promise.resolve().then(n.bind(n,755071)))),minisearchDependency:Qt().W};function tn(){(0,o.useEffect)((()=>{Jt().Z.state.readinessTimings={appStart:(0,Yt().getAppStartTime)(),hookStart:performance.now()}}),[]);const e=(0,a().O7)(),{currentUserId:t,currentSpaceId:n}=(0,w().VK)((()=>{var e,t;return{currentUserId:null===(e=B().default.state.currentUserStore)||void 0===e?void 0:e.id,currentSpaceId:null===(t=B().default.state.currentSpaceStore)||void 0===t?void 0:t.id}}),[]),r=(0,Xt().D9)(t),i=(0,Xt().D9)(n);(0,o.useEffect)((()=>{t&&n&&(t!==r||n!==i)&&async function(e){const{spaceId:t,userId:n,environment:o}=e;Jt().Z.state.readinessTimings={appStart:Jt().Z.state.readinessTimings.appStart,hookStart:Jt().Z.state.readinessTimings.hookStart,setupLocalSearchStart:performance.now()};const r=en.recentPagesActions.load().then((async e=>{await e.reinitializeGlobalRecentPagesStoreState(o,n,t)})),a=en.userSignalsHelpers.load(),i=en.broadcastChannel.load(),s=(async()=>{var e,o;await(null===(e=Jt().Z.state)||void 0===e||null===(e=e.elector)||void 0===e?void 0:e.die()),await(null===(o=Jt().Z.state)||void 0===o||null===(o=o.broadcastChannel)||void 0===o?void 0:o.close());const{BroadcastChannel:r,createLeaderElection:a}=await i,s=new r(`local_search_${t}_${n}`),c=a(s);Jt().Z.update((e=>({...e,elector:c,broadcastChannel:s})))})(),c=(await a).initializeAndLoadAllUserSignals({spaceId:t,userId:n,environment:o});await Promise.all([Qt().W,r,c,s])}({spaceId:n,userId:t,environment:e})}),[e,t,n,r,i])}var nn=()=>n(81066);var on=()=>n(492788),rn=()=>n(844085),an=()=>n(302353),sn=()=>n(127519);const cn=new(n(435308).default)((()=>{const e=an().default.state;return e.phase===an().i.willShow?0:e.estimatedKeyboardWebViewOverlap}),{debugName:"estimatedKeyboardWebViewOverlapStore"});var ln=()=>n(517670),dn=()=>n(145990),un=()=>n(620218);const pn=300;var mn=()=>n(990966),fn=()=>n(505462),gn=()=>n(504446);const vn=window.matchMedia("(prefers-color-scheme: dark)");n(670560);var hn=()=>n(282017),bn=()=>n(595380);const Sn=!1,yn=(Sn?1:10)*Nt().C0,wn=5*yn;function kn(){Sn&&console.log(...arguments)}function xn(){(0,o.useEffect)((()=>{if(!window.BroadcastChannel)return;const e=(0,hn().c$)(),t=new Map,n=new BroadcastChannel("notion_tab_tracker");n.onmessage=e=>{const n=e.data;"string"==typeof n&&t.set(n,Date.now())};const o=window.setInterval((()=>{(()=>{const e=[],n=Date.now();for(const[o,r]of t.entries())n-r>wn&&e.push(o);e.length&&kn("Removing tab ids:",e);for(const o of e)t.delete(o)})(),n.postMessage(e);const o=t.size+1;kn("Tab count is",o),(0,bn().$)(o)}),yn);return()=>{n.close(),window.clearInterval(o)}}),[])}var In=()=>n(156958),Cn=()=>n(881688);const _n="loadCachedPageChunk";n(821057);var Tn=()=>n(792409),Pn=()=>n(836842);const jn=function(){const e=(0,a().O7)(),t=(0,o.useCallback)((t=>{(0,v().j)({environment:e,event:{eventName:"statsig_client_init_error",eventProperties:{statsig_init_method:"bootstrap"}}}),ne().log({level:"error",from:"statsig",type:"initialize",error:(0,Tn().Ui)(t),data:{userId:e.currentUser.id}})}),[e]);(0,i().K)((()=>{Pn().StatsigInitializer.initializePromise?Pn().StatsigInitializer.error?t(Pn().StatsigInitializer.error):Pn().StatsigInitializer.isComplete||t(new Error("`statsig.initialize` was not awaited on app bootstrap")):t(new Error("`statsig.initialize` was not called on app bootstrap"))}))};var En=()=>n(269299);var Un=()=>n(801812),Mn=()=>n(274879);const Ln=function(){const e=(0,a().O7)(),t=(0,o.useCallback)((t=>{(0,v().j)({environment:e,event:{eventName:"statsig_client_update_user_error",eventProperties:{statsig_init_method:"bootstrap"}}}),ne().log({level:"error",from:"statsig",type:"updateUser",error:(0,Tn().Ui)(t),data:{nextUserId:e.currentUser.id,err:(0,n(720866).t)(t).message}})}),[e]),[i]=(0,Un().r5)((async()=>await Mn().getExperimentDeviceId(e)),[e]),[s]=(0,Un().r5)((async()=>await Mn().getBrowserId(e)),[e]),c=(0,w().VK)((()=>{var e,t;return!(null===(e=B().default.state.currentUserStore)||void 0===e||!e.isDefined())&&!(null!==(t=B().default.state.currentUserStore)&&void 0!==t&&t.getOnboardingCompleted())}),[]),l=(0,w().VK)((()=>{var e;return null===(e=B().default.state.currentSpaceStore)||void 0===e?void 0:e.isDefined()}),[]),d=(0,w().VK)((()=>{if("resolved"===i.status&&"resolved"===s.status&&n(601952).default.state.initialRenderCompleted)return!e.currentUser.id||l||c?(0,Pn().bG)(n(963332).getDataForStatsigUser({environment:e,deviceId:i.value,browserId:s.value})):void 0}),[e,i,s,l,c],{useDeepEqual:!0}),u=(0,o.useRef)(Pn().StatsigInitializer.statsigStageTwoUser),p=(0,o.useRef)(0);(0,o.useEffect)((()=>{!async function(){if(Pn().StatsigInitializer.isComplete&&d&&!Le().Xy(d,u.current)){u.current=d,p.current++;try{const t=await Pn().statsigClientLoader.getPhaseTwoInstance(),o=async function(a){t.off("initialization_failure",o),ne().log({level:"info",from:"useUpdateStatsigData",type:"updateStatsigUser.failedToReachStatsig",data:{message:"Unable to reach statsig, trying to get latest values from server.",nextUserId:e.currentUser.id}});const i=(0,n(235653).createApiHttpJsonRequestOptions)({environment:e,eventName:"getStatsigResults",data:{...d.customIDs,device:(0,Pn().getDeviceAttributesForStatsigUser)(e.device),locale:r().locale},activeUserId:e.currentUser.id,tracking:void 0,eventListeners:(0,n(565016).getPerformanceEventListeners)({eventName:"getStatsigResults",isPrefetchRequest:!0})}),s=await(0,Ot().default)(i);"success"===s.type?(t.dataAdapter.setData(JSON.stringify(s.data.initialValues)),t.updateUserSync(s.data.statsigUser)):ne().log({level:"error",from:"useUpdateStatsigData",type:"updateStatsigUser.failedToReachStatsigAndServer",data:{message:"Unable to reach statsig and fallback failed",err:(0,Ot().p)(s),nextUserId:e.currentUser.id}})};t.on("initialization_failure",o),await t.updateUserAsync(d)}catch(o){t(o)}p.current--,0===p.current&&P().default.recomputeAllGroupStores()}}()}),[t,d,e])};var Rn=()=>n(312578);var An=()=>n(317924),Vn=()=>n(751052),Zn=()=>n(506347),Bn=()=>n(362154),Nn=()=>n(836273),On=()=>n(396136),Dn=()=>n(899133);const Kn=["compact","regular","unknown"];var qn=()=>n(957042),Fn=()=>n(124199),zn=()=>n(353141),Wn=()=>n(765056),Hn=()=>n(279762),$n=()=>n(525038),Gn=()=>n(207874),Yn=()=>n(824034),Xn=()=>n(511614),Qn=()=>n(96271),Jn=()=>n(278275),eo=()=>n(879952),to=()=>n(224597),no=()=>n(13750),oo=()=>n(306743);var ro=()=>n(429102);var ao=()=>n(271308),io=()=>n(297861),so=()=>n(369320);var co=()=>n(589525);var lo=()=>n(520849),uo=()=>n(230637),po=()=>n(424817);var mo=()=>n(543172);function fo(e){const t=(0,An().w_)(e);switch(t.type){case"native":return;case"web":const e=t.route;switch(e.name){case"page":return e.collectionViewId?"collection":"page";case"nativeTab":switch(e.tab){case"updates":return"updates";case"posts":return"posts";case"assistant":return"assistant";case"trash":return"trash";case"members":return"members";case"help":return"help";case"templates":return"templates";case"offline":return"offline_settings"}break;default:return}}}var go=()=>n(141735),vo=()=>n(233936),ho=()=>n(390886),bo=()=>n(148126),So=()=>n(832924),yo=()=>n(8),wo=()=>n(466970),ko=()=>n(341691),xo=()=>n(76225),Io=()=>n(741636);const Co={MobileNativePerformanceListener:new(m().Ss)("MobileNativePerformanceListener",(async()=>await n.e(93539).then(n.bind(n,623118))))},_o=(0,m().kF)(Co.MobileNativePerformanceListener,(e=>e.MobileNativePerformanceListener));var To=()=>n(828946),Po=()=>n(307853),jo=()=>n(738483),Eo=()=>n(591707),Uo=()=>n(956789),Mo=()=>n(84922),Lo=()=>n(141938),Ro=()=>n(890881),Ao=()=>n(211937),Vo=()=>n(705111),Zo=()=>n(253225),Bo=()=>n(577325),No=()=>n(576387);const Oo=(0,x().vU)({failedToMovePageGeneric:{id:"MobileNativeListener.failedToMovePage",defaultMessage:"Failed to move page"}}),Do=Le().HP((async(e,t)=>(await To().x.searchActions.load()).getLocalCacheFromAppState(e)),((e,t)=>{var n;return`${e.currentUser.id}-${(null===(n=B().default.state.currentSpaceViewStore)||void 0===n?void 0:n.id)??"none"}-${t??"none"}`}));function Ko(e){const{mobileNative:t,TabbedRouterStore:o,device:r}=e();if(r.isMobileNative&&t){var a;t.updateReceiveApiHandlers({toggleAvailableOffline:t=>{const{pageId:n}=t;R().toggleAvailableOffline({store:new(Tt().G)(e(),{table:On().iU,id:n}),environment:e()})},statusBarTap:Fo,backButtonPress:()=>Et().Zm(e(),{type:"backbutton"}),keyboardWillShow:t=>{an().default.updateKeyboardPhase(e(),an().i.willShow,t??0)},keyboardDidShow:t=>{an().default.updateKeyboardPhase(e(),an().i.shown,t??0)},keyboardWillHide:()=>{an().default.updateKeyboardPhase(e(),an().i.willHide,0)},keyboardDidHide:()=>{var t;(an().default.updateKeyboardPhase(e(),an().i.hidden,0),r.isIpad)&&(eo().ZH({environment:e()}),null===(t=e().NativeMobileActionBarStore)||void 0===t||t.clear(!0))},keyboardConfigChanged:e=>{an().default.updateKeyboardConfig(e.packageName,e.activeLocale)},safeAreaConfigChanged:t=>{(0,io().Y)("supportsNativeSafeAreaConfig")?(Vn().iI.update((e=>({...e,supportsNativeSafeAreaConfig:!0,top:t.top,bottom:t.bottom,left:t.left,right:t.right}))),e().WindowSizeStore.updateWindowSize()):Vn().iI.reset()},keyboardShortcut:t=>Et().Zm(e(),t),nativeBottomBarDidChange:e=>{void 0!==e.height&&an().default.update((t=>({...t,nativeBottomBarHeight:e.height})))},pushNotificationTokenRefresh:t=>Hn().handleTokenRefresh(e(),t,"refresh"),resume:Lo().Z.resume,pause:async()=>{Lo().Z.pause();const{stopDictation:t}=await Promise.all([n.e(52183),n.e(5509)]).then(n.bind(n,874023));await t({environment:e(),from:"native_action"})},refreshSubscriptionData:async t=>{await q().callApi({eventName:"invalidateSubscriptionData",environment:e(),data:{spaceId:t,provider:"revenue_cat"}}),await No().bi(e())},refreshSubscriptionDataV2:async()=>{await No().bi(e())},processMobileActionBarAction:e=>{const{componentId:n,action:o}=e;t.componentEvents.dispatch("MobileActionBar",n,"onAction",{action:o})},logout:t=>{ko().logoutSingleAccount({environment:e(),userId:t,logoutOrigin:Bn().F.MobileNativeListener})},logoutV2:t=>{const{userId:n,fcmToken:o}=t;ko().logoutSingleAccount({environment:e(),userId:n,logoutOrigin:Bn().F.MobileNativeListener,fcmToken:o})},logoutAll:()=>{ko().logout(e())},openDestinationV2:t=>{so().Z.closeAll();const n=e(),o=(0,An().w_)(n.TabbedRouterStore.state),{activeTab:r,tabs:a}=n.TabbedRouterStore.state,i=o===a[r].rootPage,s="native"===o.type,c=i&&s;switch((0,bo().__)(n)&&Qn().S({environment:n,tab:n.TabbedRouterStore.state.activeTab,nativeRootPageOverrideEnabled:!1}),t.type){case"moveTo":!function(e,t){const n=new(Tt().G)(t,{table:On().iU,id:e});$n().bA({environment:t,blocks:[n],moveToContext:"home_tab",onAccept:e=>{Xn().r({store:n,environment:t,pageVisitSource:Zn().tY.Move})}})}(t.blockId,n);break;case"trash":Ho({query:t.query});break;case"webSearch":!function(e,t){Jn().UT({environment:e,analyticsFrom:"mobile-bottom-bar",query:t}),zn().nB(e,{itemName:"search",logging_source:"mobile_native"})}(n,t.query);break;case"templates":!function(e,t){$o(e),Zo().Z.setState({open:!0,isFromNativeHome:!0,source:t.source})}(n,{source:t.source});break;case"AIAssistant":!function(e,t,n){Vo().g.update((e=>({query:n.query,searchSessionId:n.searchSessionId,from:n.from??"search",shouldReset:Boolean(n.query&&n.query.trim().length>0)}))),st().c4({environment:e,url:`${Nn().VP.nativeTab}/assistant`,redirect:t})}(n,c,{query:t.query,searchSessionId:t.searchSessionId,from:t.from});break;case"createOrJoinWorkspace":return Wo(n,t.userId)}},openDestination:t=>{so().Z.closeAll();const n=e();switch("closePopup"!==t&&(0,bo().__)(n)&&Boolean(n.TabbedRouterStore.state.tabs[n.TabbedRouterStore.state.activeTab].nativeRootPageOverrideEnabled)&&Qn().S({environment:n,tab:o.state.activeTab,nativeRootPageOverrideEnabled:!1}),t){case"addPage":$o(n);break;case"allUpdates":!function(e){(0,io().Y)("supportsNativeHome")&&e.device.isPhone?(Yn().Hu({RouterStore:e.RouterStore,currentUserId:e.currentUser.id}),st().c4({environment:e,url:`${Nn().VP.nativeTab}/updates`,redirect:!0})):Bo().Z.setState({...Bo().Z.state,open:!0})}(n);break;case"addAccount":Eo().C.setState({...Eo().C.state,open:!0});break;case"createOrJoinWorkspace":return Wo(n);case"notificationAndSettings":jo().Z.setState({open:!0,source:jo().Y.Home});break;case"trash":Ho({});break;case"memberSettings":Ao().Z.setState({...Ao().Z.state,open:!0});break;case"help":Ro().Z.setState({...Ro().Z.state,open:!0});break;case"intercom_messages":!function(e){oo().j_({environment:e,from:"help_button"})}(n);break;case"aiWriter":!function(e){vo().QG(e)}(n)}},setCurrentUserId:async t=>{await zo(t,e())},setCurrentSpace:async t=>{await async function(e,t,n){const o=await no().x({environment:n,newCurrentUserId:e}),{currentUserRootStore:r,currentUserSettingsStore:a}=B().default.state;if(!r)return;await r.load();const i=(0,Q().w3)(t);i&&await to().y3({environment:o,spaceViewStore:i,userSettingsStore:a,userRootStore:r,pageVisitSource:Zn().tY.SwitchSpace,navigationType:"switchingToOrLoadingSpace"})}(t.userId,t.spaceId,e())},updateHorizontalSizeClass:e=>{const n=(0,qn().Gu)(Fn().literals(...Kn),e)?"unknown":e;n!==t.horizontalSizeClass.state&&t.horizontalSizeClass.setState(n)},updateTabbedRouterState:t=>{var n;const o=e(),{TabbedRouterStore:r}=o,a=r.state;if(t.tab!==a.activeTab||null!==(n=t.pages)&&void 0!==n&&n.length||!Le().Xy(t.modal,a.modal)||a.tabs[a.activeTab].pages.length){const n=t.navigationEffect;if(n&&"AIAssistant"===n.type)Vo().g.update((e=>({query:n.query,searchSessionId:n.searchSessionId,from:n.from??"search",shouldReset:Boolean(n.query&&n.query.trim().length>0)})));Qn().S({environment:e(),tab:t.tab,queryParams:t.queryParams,pages:t.pages,modal:t.modal,nativeRootPageOverrideEnabled:t.nativeRootPageOverrideEnabled,navigationAction:t.navigationAction,navigationSource:t.navigationSource})}else Fo();const i=r.state;return[{state:i,topPage:(0,An().w_)(i),webTransitionType:fo(i),updateId:t.updateId??(0,L().ZP)()}]},getLocalSearchResults:async t=>{const n=await Do(e(),t.searchSessionId);if(!n)return[{error:"Local cache does not exist"}];const o=(0,qn().Gu)(Dn().GA,t.sort);if(o)return[{error:`old sort type is unsupported! ${o}`}];const r=t.sort,a=(0,Po().f)({query:{query:{text:t.query??"",filters:t.filters,sort:r},limit:t.limit},localCachedPages:n,includeRecordMap:!1,userId:e().currentUser.id,environment:e()}),i=[{value:{total:0,results:[],recordMap:{},trackEventProperties:void 0}}];if(!a||0===a.results.length)return i;const s=T().default.state.online?yo().g8(e(),a.results):a.results;return[{value:{results:s,total:s.length,recordMap:{},trackEventProperties:{}}}]},customAddCommentMenuItemTapped:async()=>{const t=await go().F.formulas.load();(0,vo().ol)(e(),"custom_add_comment_menu_item",t)},filterValidMoveToBlocks:t=>{const n=t.targets.map((t=>new(Tt().G)(e(),{table:On().iU,id:t}))),o=t.blocks.filter((t=>{const o=new(Tt().G)(e(),{table:On().iU,id:t});return o.canEdit()&&(0,ho().Xk)(o,n)}));return[{value:{targets:t.targets,blocks:o}}]},completeMoveToTransaction:async t=>{const{targets:n,destination:o,moveToContext:r,timeToSelectMs:a,isSearchResult:i,flowId:s}=t,c=n.map((t=>new(Tt().G)(e(),{table:On().iU,id:t}))),l=$n().QF(e(),n,o);if(c&&c.length>0&&!l)try{return await En().createAndCommitAsync({userAction:"MobileNativeListener.completeMoveTo",environment:e(),waitForServerCommit:!1,perform:async t=>{await $n().RL({targets:c,value:o,transaction:t,environment:e(),moveToContext:r,renderType:"native",timeToSelectMs:a,disableSuccessToast:!0,isSearchResult:i,flowId:s})}}),[{value:t}]}catch(d){}return Wn().fW(e(),{type:"moved_to_subpage"}),[{error:bt().Z.formatMessage(Oo.failedToMovePageGeneric)}]},undoRevision:()=>{Gn().Yw(e(),!0)},searchTeams:async e=>{const{query:t}=e,n=B().default.state.currentSpaceStore,o=B().default.state.currentSpaceViewStore;if(!n||!o)return[{error:"SpaceStore or SpaceViewStore was undefined"}];const r=await To().x.searchActions.load();return[{value:{ids:(await r.searchTeams({spaceViewStore:o,query:t,teamStores:o.getTeamsStores()})).map((e=>e.id))}}]}});const s=e().mobileNative;var i;if(null!=s&&null!==(a=s.api)&&void 0!==a&&a.ready)null==s||null===(i=s.api)||void 0===i||i.ready()}}function qo(){const e=(0,a().O7)(),{device:t}=e;(0,o.useEffect)((()=>Ko((()=>e))),[e]),function(){const e=(0,a().O7)(),t=(0,w().VK)((()=>(0,ro().n)(e)),[e]);(0,o.useEffect)((()=>{var n;null===(n=e.mobileNative)||void 0===n||n.toggleBottomBar(t)}),[e.mobileNative,t])}(),function(){const{mobileNative:e}=(0,a().O7)(),t=(0,w().VK)((()=>{const{currentUserStore:e,currentSpaceStore:t}=B().default.state;if(!e||!t)return;const n=xt().KR.isShowingQNAOnMobile(),o=xt().KR.shouldShowAssistantFace();return{userId:e.id,spaceId:t.id,enabled:n,showAssistantFace:o}}),[]);(0,o.useEffect)((()=>{t&&(null==e||e.updateAiAssistantEnabledState(t))}),[e,t])}(),function(){const{mobileNative:e}=(0,a().O7)();(0,o.useEffect)((()=>{null==e||e.updateAiAssistantVisibilityState({enabled:!1})}),[e])}(),function(){const e=(0,a().O7)(),{mobileNative:t,WindowSizeStore:n}=e,r=(0,w().Kw)(n),i=(0,w().VK)((()=>({visible:At().sidebarExpandedStore.state&&!(0,co().YR)(e),width:(0,co().qG)(e)})),[e]);(0,o.useEffect)((()=>{null==t||t.sidebarVisibility(i.visible,i.width)}),[e,t,r,i])}(),function(){const e=(0,a().O7)(),{mobileNative:t,TabbedRouterStore:n}=e,{state:r,previousState:i}=(0,w().VK)((()=>({state:n.state,previousState:n.getPreviousState()})),[n]);(0,o.useEffect)((()=>{const n=null==t?void 0:t.api.handleTabbedRouterStateUpdate;if(n){if(n({state:r,topPage:(0,An().w_)(r),webTransitionType:fo(r),updateId:(0,mo().ZP)()}),!i)return;const t=(0,An().F9)(i),o=(0,An().F9)(r);Le().Xy(t,o)||zn().w3(e,{origin:t,destination:o,from:r.navigationSource,action:r.navigationAction,logging_source:"mobile_native"})}}),[e,t,r,i])}(),function(){const{mobileNative:e,RouterStore:t}=(0,a().O7)(),{isIOS:n}=(0,a().Fy)(),r=(0,o.useRef)(!1),i=(0,w().Kw)(uo().Z),s=(0,w().VK)((()=>"onboarding"===t.state.route.name),[t]);(0,o.useEffect)((()=>{n&&null!=e&&e.setWebViewAllowsNavigationGestures&&(s||At().sidebarOpenStore.state||po().Z.getPreventScrollType()!==lo().Z.None?!1!==r.current&&(r.current=!1,e.setWebViewAllowsNavigationGestures(!1)):!0!==r.current&&(r.current=!0,e.setWebViewAllowsNavigationGestures(!0)))}),[n,s,e,i])}(),function(){const{mobileNative:e,TabbedRouterStore:t}=(0,a().O7)(),n=(0,w().VK)((()=>{var e;if(!(0,io().Y)("supportsCustomAddCommentMenuItem"))return!1;const{currentUserStore:n}=B().default.state;if(!Boolean(null==n?void 0:n.id))return!1;if((0,io().Y)("supportsNativeBottomBarOverlappingWebView")?so().Z.hasOpenMobileSlideUps():so().Z.hasOpenPopups())return!1;const o=(0,An().w_)(t.state),r="web"===o.type&&((null===(e=o.redirectedTo)||void 0===e?void 0:e.route)||o.route);if(!r||"page"!==r.name)return!1;const a=sn().default.state;if("empty"===a.mode)return!1;const i=(0,ao().tp)({multiSelection:a.multiSelection,filterCommonAncestors:!0,focus:void 0});return!(!i||0===i.stores.length)&&i.stores.every((e=>e.canComment()))}),[t]);(0,o.useEffect)((()=>{(0,io().Y)("supportsCustomAddCommentMenuItem")&&(null==e||e.updateCustomAddCommentMenuItemEnabled(n))}),[e,n])}(),(0,xo().aT)();const n=(0,o.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object.keys(e.tabs).forEach((n=>{const o=n;t&&(e.tabs[o].nativeRootPageOverrideEnabled=void 0),o!==e.activeTab?e.tabs[o].pages=[]:e.tabs[o].pages=e.tabs[o].pages.slice(-1)}))}),[]),r=(0,o.useCallback)(((t,o)=>{var r;const{mobileNative:a,TabbedRouterStore:i,currentUser:s}=e,c=B().default.state.currentSpaceStore,l=null==c?void 0:c.id;if(null!=a&&null!==(r=a.api)&&void 0!==r&&r.setCurrentSpaceInfo&&(ne().log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"Web calling nativeAPI setCurrentSpaceInfo",spaceId:l}}),a.api.setCurrentSpaceInfo({spaceId:l,spaceViewId:null==t?void 0:t.id,userId:s.id,editable:(null==c?void 0:c.canEdit())??!0})),(0,bo().__)(e)){const e=e=>{if("web"!==e.type)return;const t={...e.queryParams},n=l&&(0,L().cj)(l);t.spaceId=n,e.queryParams=t,e.route.spaceId=n},t=Le().Xh(i.state);e(t.tabs.updates.rootPage),e(t.tabs.addPage.rootPage),void 0!==(null==o?void 0:o.id)&&n(t),i.setState(t)}Do(e,void 0)}),[n,e]),i=(0,o.useCallback)((t=>{var o;null!==(o=e.mobileNative)&&void 0!==o&&null!==(o=o.api)&&void 0!==o&&o.setCurrentUserInfo&&e.mobileNative.api.setCurrentUserInfo({userId:null==t?void 0:t.id,loggedInUserIds:e.currentUser.loggedInUserIds});const r=!(0,bo().__)(e)||void 0===e.currentUser.id,{TabbedRouterStore:a}=e,i=Le().Xh(a.state);n(i,r),a.setState(i)}),[n,e]),s=(0,w().VK)((()=>B().default.state.currentUserStore),[]),c=(0,Xt().D9)(s);(0,o.useEffect)((()=>{(null==s?void 0:s.id)!==(null==c?void 0:c.id)&&i(s)}),[i,s,c,t.isMobileNative,e.mobileNative]);const l=(0,w().VK)((()=>B().default.state.currentSpaceViewStore),[]),d=(0,Xt().D9)(l);(0,o.useEffect)((()=>{(null==l?void 0:l.id)!==(null==d?void 0:d.id)&&r(l,d)}),[r,l,d,t.isMobileNative,e.mobileNative]);const u=(0,wo().E)("mab_debugging");return(0,o.useEffect)((()=>{vo().zd(u)}),[u]),(0,U.jsx)(_o,{})}function Fo(){var e;if(po().Z.getPreventScrollType()===lo().Z.None)if(At().sidebarOpenStore.state)So().default.SidebarMobileScroller&&(null===(e=So().default.SidebarMobileScroller.getNode())||void 0===e||e.scrollTo({top:0,behavior:"auto"}));else if(So().default.MenuScroller){var t;null===(t=So().default.MenuScroller.getNode())||void 0===t||t.scrollTo({top:0,behavior:"auto"})}else if(So().default.MenuPageScroller){var n;null===(n=So().default.MenuPageScroller.getNode())||void 0===n||n.scrollTo({top:0,behavior:"auto"})}else if(So().default.PageScroller){var o;null===(o=So().default.PageScroller.getNode())||void 0===o||o.scrollTo({top:0,behavior:"auto"})}}async function zo(e,t){return t.currentUser.id===e?t:await no().x({environment:t,newCurrentUserId:e})}async function Wo(e,t){let n=e;t&&(n=await zo(t,e)),await Io().xN(n)}function Ho(e){Uo().Z.setState({open:!0});const{query:t}=e;t&&Mo().default.setState({...Mo().default.state,currentTab:"all_pages",filter:t,limit:Mo().default.startLimit})}function $o(e){(0,io().Y)("supportsNativeHome")&&e.device.isPhone?(Yn().Hu({RouterStore:e.RouterStore,currentUserId:e.currentUser.id}),Rt().quickAddPage({environment:e,from:"mobile_bottom_bar",redirect:!0,quickAddParentOverride:{type:"space-private-pages"}})):Rt().quickAddPage({environment:e,from:"mobile_bottom_bar"}),zn().nB(e,{itemName:"add_page"})}function Go(e){const t=(0,a().O7)();(0,i().K)((()=>{const{device:e,mobileNative:n}=t;if(d().mc(t),u().Yh(t),n&&n.hideSplashscreen(),e.isMobile){const e=document.body.parentElement;e&&e.classList.add(h().aiP)}(0,v().pH)(t),s().rQ({device:e,config:p().default,cookieService:t.cookieService}),l().DM(r().locale),(0,c().yN)(window.location.href)})),function(){const e=(0,a().O7)(),t=(0,a().Fy)();(0,o.useEffect)((()=>{if(t.isMobileNative)return;let e;document.hasFocus()&&(e=setInterval((()=>{O()}),N),O());const n=()=>{e&&clearInterval(e),e=setInterval((()=>{O()}),N),O()},o=()=>{e&&clearInterval(e),e=void 0};return window.addEventListener("focus",n),window.addEventListener("blur",o),()=>{e&&clearInterval(e),window.removeEventListener("focus",n),window.removeEventListener("blur",o)}}),[t.isMobileNative,e])}(),function(){const e=(0,o.useRef)(!1),t=(0,a().O7)(),n=(0,o.useCallback)((async e=>{if(e.currentUser.id&&z().IX.size>0){const t=await q().callApi({eventName:"getTasks",environment:e,data:{taskIds:Array.from(z().IX.values())}});if("success"===t.type){const{results:n}=t.data,o=new Set(z().IX);for(const t of n)o.delete(t.id),t.status&&(0,F().I)({environment:e,eventName:t.eventName,response:t.status,userId:e.currentUser.id}),z().qb.emit(t.id,t),$.emit(t.eventName,t),"failure"!==t.state&&"success"!==t.state&&"dead"!==t.state&&"timeout_before_execution"!==t.state||z().IX.delete(t.id);if(o.size>0)for(const e of o.values())z().IX.delete(e)}}}),[]),r=(0,w().VK)((()=>{var e;return null===(e=B().default.state)||void 0===e||null===(e=e.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),i=(0,o.useCallback)((async e=>{if(e.currentUser.id&&r){const t=await q().callApi({eventName:"getUserTasks",environment:e,data:{spaceId:r}});if("success"===t.type){for(const e of t.data.taskIds)z().IX.add(e);t.data.taskIds.length>0&&n(e)}}}),[n,r]),s=(0,o.useCallback)((()=>{const n=T().default.state.online;n&&!e.current&&i(t),e.current=n}),[t,i]);function c(e){"success"===e.state?W().Z.setStatus(e.request.blockId,void 0):"in_progress"===e.state||"not_started"===e.state?W().Z.setStatus(e.request.blockId,e.status):W().Z.setStatus(e.request.blockId,void 0)}function l(e){"success"===e.state?H().Z.setStatus(e.request.blockId,!1):"in_progress"===e.state||"not_started"===e.state?H().Z.setStatus(e.request.blockId,!0):H().Z.setStatus(e.request.blockId,!1)}(0,o.useEffect)((()=>{e.current=T().default.state.online;const o=setInterval((()=>n(t)),2e3);return i(t),T().default.addListener(s),$.addListener(K().A,c),$.addListener(D,l),()=>{clearInterval(o),T().default.removeListener(s),$.removeListener(K().A,c),$.removeListener(D,l)}}),[t,n,s,i])}(),function(){const e=(0,a().O7)(),t=(0,o.useCallback)((()=>{G().LH(e)}),[e]);(0,o.useEffect)((()=>(t(),Y().Z.addListener(t),()=>{Y().Z.removeListener(t)})),[t])}(),ee(),fe(),function(){const e=(0,a().O7)();(0,o.useEffect)((()=>{const{device:t}=e;"external"===(0,we().parseRoute)({url:window.location.href,isMobile:t.isMobile,baseUrl:p().default.domainBaseUrl,publicDomainName:p().default.publicDomainName,protocol:p().default.protocol,currentUrl:window.location.href}).name&&se().vC({message:"Mismatch between origin and baseUrl (dev).",showCancel:!1,keepFocus:!1,items:[{label:(0,U.jsx)(x()._H,{defaultMessage:"OK",id:"notionAppContainer.dialog.mismatchedOriginURL.okayButton.label"}),onAccept:()=>{const e=ke().O_({relativeUrl:ke().T1(window.location.href),baseUrl:p().default.domainBaseUrl}),t=ke().Qc(e);t.protocol=ke().Qc(window.location.href).protocol,window.location.href=ke().WU(t)}}]})}),[e])}(),function(){const e=(0,a().O7)();(0,o.useEffect)((()=>{Ie(e);const t=window.setInterval((()=>Ie(e)),_e);return()=>window.clearInterval(t)}),[e])}(),function(){const e=(0,a().O7)();(0,o.useEffect)((()=>{(0,Te().setEnvironment)(e)}),[e])}(),Xe(),jt(),function(){const e=(0,a().O7)();(0,o.useEffect)((()=>{Dt(e);const t=window.setInterval((()=>Dt(e)),Nt().U6);return()=>window.clearInterval(t)}),[e])}(),function(){const e=(0,a().O7)(),t=(0,a().Fy)(),n=(0,w().VK)((()=>{const{currentUserStore:n,currentUserSettingsStore:o,currentUserRootStore:r}=B().default.state;if(!(e.currentUser.id&&n&&o&&r))return e.publicDomainUserId?{user_id:e.publicDomainUserId}:void 0;const a=r.getSpaceViewStores(),i=a.length>0&&a.every((e=>e.isReady()));if(!n.isDefined()||!o.isDefined()||!i)return;const s=Le().oA(a.map((e=>e.getSpaceId()))).map((t=>J().Z.getData(e,{spaceId:t})));if(!s.every((e=>Boolean(e)||null===e)))return;const c=(0,v().ls)(s),l=o.getSettings();if(!l)return;if(void 0===qt().subscriptionDataStoreInstance.state)return;const d={user_id:n.id,email:n.getEmail(),user_persona:l.persona,user_team_role:l.team_role,user_use_cases:l.use_cases,user_company_size:l.company_size,user_source:l.source,user_plan_type:c,user_subscription_tier:qt().subscriptionDataStoreInstance.state.subscriptionTier,user_has_at_least_one_free_tier_space:(0,v().nZ)(s),time_zone:l.time_zone,locale:l.locale,preferred_locale:l.preferred_locale,signup_time:l.signup_time,app_version:t.version};return l.signup_time&&(d.created_at=Math.floor(l.signup_time/1e3)),t.desktopAppVersion&&(d.desktop_app_version=t.desktopAppVersion),t.mobileAppVersion&&(d.mobile_app_version=t.mobileAppVersion),l.used_desktop_web_app&&(d.used_desktop_web_app=l.used_desktop_web_app),l.used_mobile_web_app&&(d.used_mobile_web_app=l.used_mobile_web_app),l.used_mac_app&&(d.used_mac_app=l.used_mac_app),l.used_windows_app&&(d.used_windows_app=l.used_windows_app),l.used_ios_app&&(d.used_ios_app=l.used_ios_app),l.used_android_app&&(d.used_android_app=l.used_android_app),d}),[e,t],{useDeepEqual:!0});(0,o.useEffect)((()=>{n&&"none"!==n.user_plan_type&&Ft(e,n)}),[e,n]);const r=void 0!==n;(0,o.useEffect)((()=>{const t=window.setTimeout((()=>{!r&&e.currentUser.id&&Ft(e,{user_id:e.currentUser.id})}),5e3);return()=>{window.clearTimeout(t)}}),[e,r])}(),function(){const e=(0,a().O7)(),t=(0,w().VK)((()=>Wt().default.state.isLoaded),[]),n=(0,w().VK)((()=>Wt().default.state.isLoggingEnabled),[]);(0,o.useEffect)((()=>{t&&async function(){const t=await(0,v().cG)(e);await zt().j2({config:p().default,isEnabled:n,deviceId:t,cookieService:e.cookieService,endpoint:Wt().default.state.endpoint})}()}),[e,t,n])}(),function(){const e=(0,a().O7)();(0,o.useEffect)((()=>{const t=t=>{Et().Zm(e,t)},n=t=>{const n=(0,Ht().x)(e.device),o=Le().w_(n,((n,o)=>(0,$t().Z)(e,t,n)));o&&!{cut:!0,copy:!0,paste:!0}[o]&&Et().dJ(e,t,o)};return window.addEventListener("keydown",n),window.addEventListener("cut",t),window.addEventListener("copy",t),window.addEventListener("paste",t),window.addEventListener("keypress",t),()=>{window.removeEventListener("keydown",n),window.removeEventListener("cut",t),window.removeEventListener("copy",t),window.removeEventListener("paste",t),window.removeEventListener("keypress",t)}}))}(),(0,Gt().Z)(),tn(),function(){const e=(0,a().O7)(),t=(0,a().Fy)();(0,o.useEffect)((()=>{t.isElectron&&ce().setLogglyData(ne().clientLogglyEnvironmentData),e.mobileNative&&e.mobileNative.setLogglyData(ne().clientLogglyEnvironmentData)}),[t.isElectron,e.mobileNative])}(),function(){const e=(0,a().O7)();(0,o.useEffect)((()=>{nn().wk({environment:e})}),[e])}(),function(){const e=(0,a().O7)();(0,o.useEffect)((()=>{if(e.device.isMobile){function t(){on().default.afterNextFlush((()=>{rn().hQ(e)}))}return sn().default.addListener(t),cn.addListener(t),an().default.addListener(t),()=>{sn().default.removeListener(t),cn.removeListener(t),an().default.addListener(t)}}}),[e])}(),(0,ln().Z)(),(0,dn().ZP)(),function(){const e=(0,a().O7)();(0,o.useEffect)((()=>{const{mobileNative:t}=e;t&&t.enableBridgeMetricsCollection(e,un().default,P().default)}),[e])}(),function(){const e=(0,a().O7)();(0,o.useEffect)((()=>{function t(t){Kt().f7(e,{reason:t})}return Mt().showConfirmationDialogEventEmitter.addListener(t),()=>{Mt().showConfirmationDialogEventEmitter.removeListener(t)}}),[e])}(),function(){const e=(0,a().O7)();(0,o.useEffect)((()=>{let t,n=!document.hidden;function o(){e.device.isElectron||pe().Z.setState({...pe().Z.state,isVisible:!document.hidden});const o=!document.hidden;o!==n&&(n=o,pe().X.setState(o),clearTimeout(t),o&&(t=setTimeout((()=>{pe().X.setState(!1)}),pn)));const r=ae().W$(),a=r&&(Date.now()-r)/Nt().A0>=7;if(e.device.isBrowser&&!document.hidden&&(!r||a)&&T().default.getState().online){const t=e.AppUpdateStore;if(t.isSilentUpdate()){const n=t.state.appUpdate;ae().hC({environment:e,url:window.location.href,version:n.version,versionCreatedTime:n.versionCreatedTime})}}}return document.addEventListener("visibilitychange",o),o(),()=>{document.removeEventListener("visibilitychange",o)}}),[e])}(),function(){const{deviceType:e}=(0,a().Fy)(),t=(0,a().O7)(),n=t.currentUser.isLoggedIn();(0,o.useEffect)((()=>{if(!n)return;if("windows-desktop"!==e&&"mac-desktop"!==e)return;const o=async()=>{await ce().isMainTabOrWindow()&&q().callApi({eventName:"registerDesktopApp",environment:t,data:{deviceType:e}})};o();const r=window.setInterval((()=>{o()}),5*Nt().hM);return()=>{window.clearInterval(r)}}),[n,e,t])}(),xn(),function(){const e=(0,a().O7)(),t=(0,o.useRef)(),n=(0,o.useRef)();(0,o.useEffect)((()=>{function o(){const o=sn().default.state,r="empty"===o.mode?void 0:o.multiSelection.start.store,a="empty"===o.mode?void 0:o.multiSelection.end.store;if(t.current===r&&n.current===a)return;if(t.current=r,n.current=a,t.current!==n.current)return;const i=Cn().UQ();if(!i)return;const{rowIndex:s,columnIndex:c,simpleTableStore:l}=i.getProps();In().n5({environment:e,rowIndex:s,columnIndex:c,simpleTableStore:l})}return sn().default.addListener(o),()=>{sn().default.removeListener(o),t.current=void 0,n.current=void 0}}))}(),function(){const e=(0,a().O7)(),t=(0,o.useCallback)((t=>{var n,o;const r={compressed:t.decodedBodySize!==t.encodedBodySize,local_cache_hit:0===t.transferSize,next_hop_protocol:t.nextHopProtocol,did_prefetch:"hit-match"===(null===(n=e.prefetchCache.getPrefetchAnalytic(`loadCachedPageChunk(${null===(o=B().default.state.mainEditorCurrentBlockStore)||void 0===o?void 0:o.id})`))||void 0===n?void 0:n.type)},a={dns_lookup:{startTime:t.domainLookupStart,endTime:t.domainLookupEnd},connection_establish:{startTime:t.connectStart,endTime:t.connectEnd},request_queued:{startTime:t.connectEnd,endTime:t.requestStart},response_wait:{startTime:t.requestStart,endTime:t.responseStart},response_download:{startTime:t.responseStart,endTime:t.responseEnd}};un().default.DO_NOT_USE_measureLegacy({metricName:"load_cached_page_chunk.fetch",startTime:t.fetchStart,endTime:t.responseEnd},{environment:e,data:{...r,sub_metrics:{dns_lookup:a.dns_lookup.endTime-a.dns_lookup.startTime,connection_establish:a.connection_establish.endTime-a.connection_establish.startTime,request_queued:a.request_queued.endTime-a.request_queued.startTime,response_wait:a.response_wait.endTime-a.response_wait.startTime,response_download:a.response_download.endTime-a.response_download.startTime}}});for(const[i,{startTime:s,endTime:c}]of Object.entries(a))un().default.DO_NOT_USE_measureLegacy({metricName:`load_cached_page_chunk.fetch.${i}`,startTime:s,endTime:c},{environment:e,data:r})}),[e]);(0,o.useEffect)((()=>{const e=new PerformanceObserver((n=>{const o=n.getEntries().find((e=>e.name.includes(`${p().default.api.http}/${_n}`)&&!e.name.endsWith("s")));o&&("resource"===o.entryType&&t(o),null==e||e.disconnect())}));return e.observe({type:"resource",buffered:!0}),()=>{e.disconnect()}}),[t])}(),jn(),function(){const e=(0,a().O7)();(0,o.useEffect)((()=>{const t=()=>En().updateConnectionState(e);return t(),T().default.addListener(t),()=>{T().default.removeListener(t)}}),[e])}(),function(){const e=(0,a().O7)();(0,o.useEffect)((()=>{e.defaultRecordCache.persistedRecordCache&&e.defaultRecordCache.persistedRecordCache.setEnvironment(e)}),[e])}(),function(){const e=(0,a().O7)(),t=(0,o.useRef)("none"),n=(0,o.useCallback)((e=>{const n=t.current;e!==n&&(t.current=e,"dragging"===e?gn().Z.setState({isDragging:!0}):"dragging"===n&&gn().Z.setState({isDragging:!1}))}),[]),r=(0,o.useCallback)((()=>{"none"===t.current&&n("touching")}),[n]),i=(0,o.useCallback)((()=>{n("none")}),[n]),s=(0,o.useCallback)((()=>{"touching"===t.current&&fn().isExpanded(fn().get())&&n("dragging")}),[n]);(0,o.useEffect)((()=>{if(e.device.isIOS)return window.addEventListener("touchstart",r),window.addEventListener("touchend",i),window.addEventListener("touchcancel",i),document.addEventListener("selectionchange",s),()=>{window.removeEventListener("touchstart",r),window.removeEventListener("touchend",i),window.removeEventListener("touchcancel",i),document.removeEventListener("selectionchange",s)}}),[e.device.isIOS,r,i,s]);const c=(0,o.useCallback)((()=>{on().default.afterNextFlush((()=>{mn().clearSavedSelectionXPosition()}))}),[]),l=(0,o.useCallback)((()=>{setTimeout((()=>{fn().get()||mn().clear({environment:e})}),0)}),[e]);(0,o.useEffect)((()=>(window.addEventListener("mousedown",c),e.device.isMobileBrowser&&document.addEventListener("focusout",l),()=>{window.removeEventListener("mousedown",c),document.removeEventListener("focusout",l)})),[e,c,l])}(),A(),(0,y().JD)(),M(),function(){const e=(0,a().O7)(),t=(0,a().Fy)(),n=(0,o.useRef)(!1),r=(0,o.useCallback)((()=>{"system"===G().VZ(e)&&Y().Z.emit()}),[e]),i=(0,w().VK)((()=>{var e;return null===(e=B().default.state.mainEditorCurrentBlockStore)||void 0===e?void 0:e.isReady()}),[]);(0,o.useLayoutEffect)((()=>{!n.current&&i&&(r(),n.current=!0)}),[i,r]),(0,o.useEffect)((()=>{if(t.isAndroid&&e.mobileNative)e.mobileNative.updateReceiveApiHandlers({themeChanged:e=>r()});else{if(vn.addEventListener&&vn.removeEventListener)return vn.addEventListener("change",r),()=>{vn.removeEventListener("change",r)};if(vn.addListener&&vn.removeListener)return vn.addListener(r),()=>{vn.removeListener(r)}}}),[t.isAndroid,e,r])}(),Ln(),function(){const e=p().default.isLocalhost||!1;(0,o.useEffect)((()=>{function t(t){if(!e)return;if(!t.data||"string"!=typeof t.data.type)return;const n=t.data.type;"webpackInvalid"===n?C().oV({label:(0,U.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,U.jsx)("span",{style:{paddingRight:10},children:"Webpack Compiling"}),(0,U.jsx)(Rn().Z,{size:"md",onDarkBackground:!0})]}),position:"top",durationMs:"keep"}):"webpackOk"!==n&&"webpackStillOk\t"!==n&&"webpackWarnings"!==n||C().rN()}return window.addEventListener("message",t),()=>{window.removeEventListener("message",t)}}),[e])}();const n=(0,V().hZ)();return(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(qo,{}),t.device.isElectron&&(0,U.jsx)(Yo,{}),n&&(0,U.jsx)(Xo,{}),(0,U.jsx)(g,{}),(0,U.jsx)(S,{})]})}function Yo(){return function(){const e=(0,a().O7)(),t=(0,x().YB)(),n=(0,w().VK)((()=>({observedWidth:At().sidebarSizeObserver.rect.state.width,targetWidth:At().sidebarWidthStore.state,isExpanded:At().sidebarExpandedStore.state,resizing:At().sidebarResizingStore.state,isMouseEntered:At().sidebarMouseEnteredStore.state})),[]),r=e.currentUser.isLoggedIn(),i=(0,re().formatVersion)(ce().getDesktopVersion()),[s,c]=(0,o.useState)(void 0);(0,o.useEffect)((()=>{s&&ce().windowSidebarState.set({isLoggedIn:r,...n})}),[n,r,s]);const l=(0,w().VK)((()=>Ut().default.getState().enabled),[]);(0,o.useEffect)((()=>{ce().setIsMediaActive(l)}),[l]),(0,o.useEffect)((()=>{let e;e=r?n.isExpanded?"expanded":"collapsed":"disabled",ce().sidebarState.set(e)}),[n.isExpanded,r]);const d=(0,w().VK)((()=>{var e,t,n;return{currentUserId:null===(e=B().default.state.currentUserStore)||void 0===e?void 0:e.id,currentSpaceId:null===(t=B().default.state.currentSpaceStore)||void 0===t?void 0:t.getSpaceId(),currentPageId:null===(n=B().default.state.mainEditorCurrentBlockStore)||void 0===n?void 0:n.id}}),[]);(0,o.useEffect)((()=>{ce().setAppStoreState(d)}),[d]);const u=(0,o.useCallback)(((t,n,o)=>{v().K4(e,n,o)}),[e]);(0,o.useEffect)((()=>ce().track.addListener(u)),[u]);const m=(0,o.useCallback)(((t,n)=>{n.forEach((t=>{v().j({environment:e,event:t})}))}),[e]);(0,o.useEffect)((()=>ce().trackBatched.addListener(m)),[m]);const f=(0,o.useCallback)(((e,t)=>{c(t)}),[]);(0,o.useEffect)((()=>{if(void 0===s||window.location.href.includes("blank"))return;const e=()=>{pe().Z.update((e=>({...e,isVisible:!document.hidden&&s})))};return e(),document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}}),[s]),(0,o.useEffect)((()=>(ce().isActiveTab.get().then((e=>{c(e)})),ce().isActiveTab.addListener(f))),[f]);const g=(0,o.useCallback)(((e,t)=>{void 0===t.isShowingTabBar&&(t.isShowingTabBar=!0),Vt().default.setState(t)}),[]);(0,o.useEffect)((()=>{var e;return null===(e=ce().electronAppFeatures.get())||void 0===e||e.then((e=>{Vt().default.setState(e)})),ce().electronAppFeatures.addListener(g)}),[g]);const h=(0,o.useCallback)(((e,t)=>{Zt().default.update((e=>({...e,tabs:t})))}),[]);(0,o.useEffect)((()=>ce().electronTabs.addListener(h)),[h]);const b=(0,o.useCallback)(((e,t)=>{Zt().default.update((e=>({...e,currentTab:t})))}),[]);(0,o.useEffect)((()=>ce().electronCurrentTab.addListener(b)),[b]);const S=(0,o.useCallback)(((e,t)=>{Zt().default.update((e=>{const n=new Set(e.unauthorizedIframeUrls??[]);n.add(t);const o=Array.from(n);return{...e,unauthorizedIframeUrls:o}}))}),[]);(0,o.useEffect)((()=>ce().setUnauthorizedIframeUrls.addListener(S)),[S]);const y=(0,o.useCallback)((t=>{Rt().setExpand({environment:e,isExpanded:!n.isExpanded,from:"electron_listener",saveDetailsSidebarPreference:!1})}),[e,n.isExpanded]);(0,o.useEffect)((()=>ce().sidebarState.addToggleListener(y)),[y]);const k=(0,o.useCallback)(((e,t)=>{t?Rt().open({fromElectron:!0}):Rt().close()}),[]);(0,o.useEffect)((()=>ce().sidebarState.addSetSidebarOpenListener(k)),[k]);const I=(0,o.useCallback)(((e,t)=>{At().sidebarExpandedStore.setState(t.isExpanded),At().sidebarWidthStore.setState(t.targetWidth)}),[]),C=(0,o.useCallback)((e=>{Bt().Z.update((e=>({...e,open:!e.open})))}),[]);(0,o.useEffect)((()=>ce().tabSpacesState.addToggleMenuListener(C)),[C]);const _=(0,o.useCallback)(((e,t)=>{Bt().Z.update((e=>({...e,tabSpacesState:t})))}),[]);(0,o.useEffect)((()=>ce().tabSpacesState.addListener(_)),[_]),(0,o.useEffect)((()=>ce().windowSidebarState.addListener(I)),[I]),(0,o.useEffect)((()=>{!async function(){if(void 0===i)return;const t=await q().callApi({eventName:"isDesktopVersionCompatible",environment:e,data:{desktopVersion:i}});"success"!==t.type||t.data.compatible||window.location.replace(p().default.domainBaseUrl+t.data.redirect)}()}),[i,e]),(0,o.useEffect)((()=>ce().performShortcut.addListener(((t,n)=>{Et().Zm(e,n)}))),[e]);const T=(0,w().VK)((()=>{if(P().default.checkGate({gateName:"desktop_close_confirmation_dialog"})){const e=(0,Mt().getUserControlledCloseConfirmationDialogReason)();if(e)return{analytics_id:e,localized_message:t.formatMessage(Lt[e])}}}),[t]);(0,o.useEffect)((()=>{ce().setCloseConfirmationDialogReason(T)}),[T])}(),null}function Xo(){return(0,V().qq)(),null}},850675:(e,t,n)=>{n.r(t),n.d(t,{default:()=>aa});var o=n(667294),r=()=>n(206489),a=()=>n(340335),i=()=>n(146947),s=()=>n(788860),c=()=>n(76254),l=(n(267602),n(653476),()=>n(565630)),d=()=>n(513670),u=()=>n(708536),p=n(785893);function m(e){const t=(0,o.useRef)(new Map),n=(0,o.useCallback)((()=>{const n=Array.from(t.current.values()).filter((e=>e.isSpawned)),o=n.length-e.maxPreferredIFrames;if(o<=0)return;const r=n.filter((e=>!e.isVisible));r.sort(((e,t)=>e.latestTimestamp-t.latestTimestamp));for(const e of r.slice(0,o))e.isSpawned=!1,e.onVisibilityChange(!1)}),[e.maxPreferredIFrames]),r=(0,o.useCallback)((e=>{for(const n of e){if(!(n.target instanceof HTMLElement))continue;const e=t.current.get(n.target);e&&(e.isVisible=n.isIntersecting,e.latestTimestamp=n.time,e.isVisible&&!e.isSpawned&&(e.isSpawned=!0,e.onVisibilityChange(!0)))}n()}),[n]),a=(0,o.useRef)(void 0!==window.IntersectionObserver?new IntersectionObserver(r):null);(0,o.useEffect)((()=>()=>{a.current&&(a.current.disconnect(),a.current=null)}),[]);const i=(0,l().D9)(e.maxPreferredIFrames);(0,o.useEffect)((()=>{i&&e.maxPreferredIFrames<i&&n()}),[n,e.maxPreferredIFrames,i]);const s=(0,o.useMemo)((()=>({track:(e,n)=>{a.current?(t.current.set(e,{isVisible:!1,isSpawned:!1,latestTimestamp:0,onVisibilityChange:d().Ds(n,50)}),a.current.observe(e)):u().uf.track(e,n)},untrack:e=>{a.current?(a.current.unobserve(e),t.current.delete(e)):u().uf.untrack(e)}})),[]);return(0,p.jsx)(u().Mq.Provider,{value:s,children:e.children})}function f(e){let t=e.isMobile?10:50;return e.ramSizeInGB&&(t=Math.floor(2*e.ramSizeInGB)),{maxPreferredIFrames:t}}var g=()=>n(504008),v=()=>n(219727),h=()=>n(279865),b=()=>n(150266),S=()=>n(205228),y=()=>n(594546),w=()=>n(749826);function k(){return 1}function x(e){let{id:t,targetRenderPhase:n="all",samplePercent:r=k(),children:a}=e;const i=(0,v().O7)(),s=(0,o.useCallback)(((e,t,o,a,s,c)=>{(0,b().lB)(r)&&("all"!==n&&t!==n||y().K4(i,`${h().Pu}.${e}`,{time:o,render_phase:t}))}),[i,n,r]),[c]=(0,o.useState)(g().Z.withListenerIgnored((()=>w().default.checkGate({gateName:"client-performance-profiler"}))));return c?(0,p.jsx)(o.Profiler,{id:t,onRender:s,children:a}):(0,p.jsx)(p.Fragment,{children:a})}var I=()=>n(679387),C=()=>n(718959),_=()=>n(341643);function T(){return(0,_().hZ)()?(0,p.jsx)(_().q9,{}):null}var P=()=>n(732811),j=()=>n(494488),E=()=>n(457861),U=()=>n(568017),M=()=>n(231077),L=()=>n(306743),R=()=>n(906651),A=()=>n(765513),V=()=>n(638533);function Z(e){let{errorId:t}=e;const n=(0,v().O7)();(0,P().Q)((()=>{M().navigationReady(!1)}));const o=()=>{L().j_({environment:n,from:"page_error"})};return(0,p.jsxs)("div",{style:B,children:[(0,E().H)({width:42,height:42}),(0,p.jsxs)("div",{style:N,children:[(0,p.jsx)("div",{children:(0,p.jsx)(s()._H,{defaultMessage:"Oops! Something went wrong.",id:"router.renderErrorPage.message.part1"})}),(0,p.jsx)("div",{children:(0,p.jsx)(s()._H,{defaultMessage:"Please refresh and try again or <textlink>message support</textlink>.",id:"router.renderErrorPage.message.part2",values:{textlink:e=>(0,p.jsx)(A().Z,{onClick:o,children:e})}})}),t&&(0,p.jsx)("div",{style:O,children:(0,p.jsx)(V().s,{errorId:t,showLink:["dev","local"].includes("production")})})]}),(0,p.jsx)(R().Z,{isLarge:!0,onClick:()=>window.location.reload(),children:(0,p.jsx)(s()._H,{defaultMessage:"Refresh",id:"router.renderErrorPage.reloadButton.label"})})]})}const B={width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingBottom:100,...(0,j().N7)(i().locale)},N={fontSize:14,textAlign:"center",marginTop:6,marginBottom:12,color:U().ZP.uiGray},O={fontSize:10,marginTop:8};var D=()=>n(142735),K=()=>n(846550),q=()=>n(758824),F=()=>n(502184),z=()=>n(492522),W=()=>n(417622),H=()=>n(105381),$=()=>n(897606),G=()=>n(312578);const Y=function(){const e=(0,D().Kw)(H().Z);return(0,p.jsx)(n(708518).Z,{open:e.open,render:()=>(0,p.jsx)(J,{}),overlayZIndex:z()._})};function X(e){return{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minWidth:180,padding:"18px 24px 20px",textAlign:"center",maxWidth:e.device.isMobile?"300px":"100%"}}function Q(e){return{display:"flex",alignItems:"center",fontSize:14,color:e.mediumTextColor}}function J(){const e=(0,K().Fg)(),t=(0,v().O7)(),n=(0,D().Kw)(H().Z),{targetRecordId:o}=n,r=(0,D().VK)((()=>function(e){return void 0!==e&&Boolean($().Z.state[e])}(o)),[o]);return n.open?(0,p.jsxs)("div",{style:X(t),children:[(0,p.jsxs)("div",{style:Q(e),children:[n.message,(0,p.jsx)(G().Z,{style:{marginLeft:6}})]}),r&&o&&(0,p.jsx)(W().Z,{targetRecordId:o,style:{marginTop:10}})]}):null}var ee=()=>n(631842),te=()=>n(247724),ne=()=>n(355435),oe=()=>n(725751),re=()=>n(688381);function ae(e){let{children:t}=e;const n=(0,v().O7)(),r=(0,K().Fg)();(0,o.useEffect)((()=>{const{mobileNative:e}=n;null==e||e.markTransitionReady({type:"mount"})}),[n]);const a="light"===r.mode?te().MsS:te().Xj_,s=(0,_().hZ)(),c=(0,_().J4)(),l=(0,_().DW)(),d=(0,D().VK)((()=>{var e;return Boolean(null===(e=oe().default.state.preferences)||void 0===e?void 0:e.isVibrancyEnabled)}),[]),u=(0,D().VK)((()=>!n.device.isMobile&&re().Z.state.openModals.size>0),[n]),m=(0,D().VK)((()=>w().default.checkGate({gateName:"z_indexes_relative"})?"z-indexes-relative":""),[]),f={inert:u?"true":null},g=(0,K().yK)((e=>({root:{...(0,j().N7)(i().locale),color:e.regularTextColor,WebkitFontSmoothing:"auto",backgroundColor:d?"rgba(0, 0, 0, 0)":e.contentBackground,transition:"height 0.1s ease",...s&&c&&l&&{height:`calc(100% - ${ne().tL}px)`}},content:{height:"100%"}})),[s,c,l,d]);return(0,p.jsxs)("div",{style:g.root,className:["notion-app-inner",a,m].join(" "),children:[(0,p.jsx)("div",{style:g.content,...f,children:t}),(0,p.jsx)(F().Z,{}),(0,p.jsx)(q().Z,{}),(0,p.jsx)(Y,{}),(0,p.jsx)(ee().j,{})]})}var ie=()=>n(772538),se=()=>n(698422),ce=()=>n(403721),le=()=>n(331749),de=()=>n(54193),ue=()=>n(836273),pe=()=>n(306164),me=()=>n(282017),fe=()=>n(332087),ge=()=>n(543172),ve=()=>n(448768),he=()=>n(916673),be=()=>n(465755),Se=()=>n(418216),ye=()=>n(454393),we=()=>n(824034),ke=()=>n(488468),xe=()=>n(497065),Ie=()=>n(345957),Ce=()=>n(543573),_e=()=>n(13750),Te=()=>n(348141),Pe=()=>n(632599),je=()=>n(696459),Ee=()=>n(824462);var Ue=()=>n(373701);function Me(e){let{payload:t}=e;const n=(0,v().O7)(),[r,a]=(0,o.useState)(t?{type:"unconfirmed"}:{type:"error"}),i=(0,o.useCallback)((async()=>{if(!t)return void a({type:"error"});a({type:"loading"});const e=await async function(e){let{environment:t,payload:n}=e;const o=await Ee().callApi({eventName:"unsubscribeFromEmails",environment:t,data:{payload:n}});return"success"===o.type?{type:"success",spaceName:o.data.spaceName}:{type:"error"}}({environment:n,payload:t});a("error"===e.type?{type:"error"}:{type:"confirmed",spaceName:e.spaceName})}),[n,t]),c=(0,K().yK)((()=>({confirmUnsubscribeDescription:{marginBottom:10}})),[]);switch(r.type){case"loading":return(0,p.jsx)(Ue().Z,{children:(0,p.jsx)(s()._H,{defaultMessage:"Loading",id:"confirmUnsubscribePage.loadingMessage"})});case"unconfirmed":return(0,p.jsxs)(Ue().Z,{children:[(0,p.jsx)("div",{style:c.confirmUnsubscribeDescription,children:(0,p.jsx)(s()._H,{defaultMessage:"Are you sure you want to unsubscribe from this list?",id:"unsubscribeFromEmails.workspace.confirmUnsubscribeDescription"})}),(0,p.jsx)(R().Z,{isLarge:!0,onClick:i,analyticsName:"unsubscribe_confirm",children:(0,p.jsx)(s()._H,{id:"confirmUnsubscribePage.confirmButton",defaultMessage:"Unsubscribe"})})]});case"confirmed":return(0,p.jsx)(Ue().Z,{children:(0,p.jsx)(s()._H,{defaultMessage:"You have successfully unsubscribed from emails for {workspaceName}",values:{workspaceName:(0,p.jsx)("b",{children:r.spaceName})},id:"unsubscribeFromEmails.workspace.message"})});case"error":return(0,p.jsx)(Ue().Z,{children:(0,p.jsx)(s()._H,{id:"confirmUnsubscribePage.errorMessage",defaultMessage:"Could not unsubscribe."})});default:(0,je().t1)(r)}}var Le=()=>n(677559);const Re=new(Le().Ss)("desktopEmailConfirmPage",(()=>n.e(61500).then(n.bind(n,261778)))),Ae=(0,Le().kF)(Re,(e=>e.default));var Ve=()=>n(580708),Ze=()=>n(416277),Be=()=>n(926410);function Ne(e){const{preventFrontRedirect:t}=e,n=(0,v().O7)(),{pathname:o,search:r,hash:a}=window.location;if(!t&&(0,Be().XR)(n,o)){const e=r.length>0?`${r}&${Ve().AM}=1`:`?${Ve().AM}=1`;return window.location.href=o+e+a,null}return(0,p.jsx)(Ze().TG,{isSignup:!n.currentUser.isLoggedIn()})}var Oe=()=>n(694389);const De=function(e){const t={position:"absolute",top:0,left:0,bottom:0,right:0};return(0,v().O7)().currentUser.isLoggedIn()?(0,p.jsx)("div",{style:t,children:(0,p.jsx)(n(690122).Z,{style:{width:"100%",height:"100%"},legacySpinnerSize:Oe().T,showSpinnerTimeout:500})}):null};var Ke=()=>n(951113),qe=()=>n(729775);const Fe=function(e){let{redirect:t,callbackType:n}=e;const r=(0,K().Fg)(),a=(0,v().O7)();return(0,o.useEffect)((()=>{ze({redirect:t,environment:a,callbackType:n})}),[a,t,n]),(0,p.jsxs)(Ue().Z,{children:[(0,p.jsx)("div",{style:{color:r.regularTextColor},children:"nativemailredirect"===n?(0,p.jsx)(s()._H,{id:"webApp.redirectingToMailDesktop.message",defaultMessage:"Redirecting to your Notion Mail app"}):"nativecalendarredirect"===n?(0,p.jsx)(s()._H,{id:"webApp.redirectingToCalendarDesktop.message",defaultMessage:"Redirecting to your Notion Calendar app"}):(0,p.jsx)(s()._H,{defaultMessage:"Redirecting to your Notion app",id:"webApp.redirectingToDesktop.message"})}),(0,p.jsx)(qe().Z,{onClick:()=>ze({redirect:t,environment:a,callbackType:n}),style:{maxWidth:300,textAlign:"center",textDecoration:"underline",color:r.lightTextColor},children:(0,p.jsx)(s()._H,{defaultMessage:"If you weren't redirected, click here.",id:"webApp.redirectingToDesktop.directLink.message"})}),(0,p.jsx)(qe().Z,{href:t,style:{maxWidth:300,textAlign:"center",textDecoration:"underline",color:U().ZP.uiGray},children:(0,p.jsx)(s()._H,{defaultMessage:"Or, continue in your browser",id:"webApp.redirectingToDesktop.continueInBrowser.message"})})]})};function ze(e){let{redirect:t,environment:n,callbackType:o}=e;xe().RX({url:t,environment:n,callbackType:o})}var We=()=>n(13382),He=()=>n(752127);function $e(){const e=(0,v().O7)();return(0,P().K)((()=>{const t=ve().u5({schemeUrl:window.location.href,baseUrl:S().default.domainBaseUrl});He().D({environment:e,url:t}),We().vq(),xe().c4({environment:e,url:ue()._j.root,redirect:!0})})),null}var Ge=()=>n(985338),Ye=()=>n(772529),Xe=()=>n(170210),Qe=()=>n(876822);function Je(e){let{children:t}=e;const n=(0,v().O7)(),o=(0,K().Fg)(),r=(0,D().VK)((()=>{var e;const{mainEditorCurrentBlockStore:t}=Qe().default.state,r=(0,Ye().WE)(t),a=n.device.isPhone;return{width:"100vw",height:"100%",position:"relative",display:"flex",flex:1,background:Boolean(null===(e=oe().default.state.preferences)||void 0===e?void 0:e.isVibrancyEnabled)?"rgba(0, 0, 0, 0)":r?(0,Xe().$1)({theme:o,isPhone:a}):o.contentBackground}}),[n,o]);return(0,p.jsx)(Ge().Z,{style:r,children:t})}var et=()=>n(929465),tt=()=>n(447317);function nt(){const e=(0,v().O7)(),t=(0,D().VK)((()=>C().Pw(e)),[e]),n=(0,D().VK)((()=>C().h1(e).shouldShowError),[e]),o=(0,D().Kw)(Qe().default),r=C()._O(e);return(0,p.jsxs)(Je,{children:[t&&!n&&r&&(0,p.jsx)(tt().y,{parentStore:t,quickSearchMode:!0}),"rendered"===o.renderPhase&&(0,p.jsx)(et().T,{})]})}const ot=new(Le().Ss)("CreatorProfile",(()=>Promise.all([n.e(62743),n.e(52774),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(27856),n.e(62789),n.e(91036),n.e(45598),n.e(10182),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(80730),n.e(83962),n.e(21862),n.e(53938),n.e(48005),n.e(60613)]).then(n.bind(n,604932)))),rt=(0,Le().kF)(ot,(e=>e.CreatorProfile)),at=new(Le().Ss)("BlankPage",(async()=>Promise.all([n.e(62743),n.e(37358),n.e(25350),n.e(81063),n.e(72646),n.e(86595),n.e(82544),n.e(62949),n.e(43468),n.e(92434)]).then(n.bind(n,365613)))),it=(0,Le().kF)(at,(e=>e.BlankPage));var st=()=>n(449866);const ct=new(Le().Ss)("Onboarding",(async()=>Promise.all([n.e(62743),n.e(84885),n.e(90698),n.e(17100),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(63707),n.e(5006),n.e(74879),n.e(86595),n.e(37554),n.e(66775),n.e(81780),n.e(3955),n.e(67053)]).then(n.bind(n,560111)))),lt=(0,Le().kF)(ct,(e=>e.Onboarding)),dt=new(Le().Ss)("settingsConsole",(async()=>await Promise.all([n.e(62743),n.e(52774),n.e(5242),n.e(90424),n.e(81580),n.e(84325),n.e(11189),n.e(71896),n.e(53335),n.e(46616),n.e(91253),n.e(61171),n.e(4014),n.e(63502),n.e(75377),n.e(99590),n.e(69437),n.e(81063),n.e(88128),n.e(97934),n.e(91e3),n.e(91752),n.e(73207)]).then(n.bind(n,116327)))),ut=(0,Le().kF)(dt,(e=>e.OrganizationSettingsConsole));var pt=()=>n(448755);const mt=new(Le().Ss)("githubStudentPack",(()=>Promise.all([n.e(62743),n.e(54882),n.e(42061)]).then(n.bind(n,555956)))),ft=(0,Le().kF)(mt,(e=>e.default)),gt=new(Le().Ss)("LocalizedTemplates",(async()=>{const{default:e}=await Promise.all([n.e(62743),n.e(31189),n.e(17100),n.e(91036),n.e(11189),n.e(46616),n.e(50471),n.e(77555),n.e(35332),n.e(13459),n.e(53938),n.e(54801)]).then(n.bind(n,12157));return{LocalizedTemplates:e}})),vt=(0,Le().kF)(gt,(e=>e.LocalizedTemplates)),ht={AddAnotherAccountLoginPage:new(Le().Ss)("AddAnotherAccountLoginPage",(async()=>await Promise.all([n.e(62743),n.e(37358),n.e(25350),n.e(72646),n.e(86595),n.e(82544),n.e(62949),n.e(22787)]).then(n.bind(n,688693))))},bt=(0,Le().kF)(ht.AddAnotherAccountLoginPage,(e=>e.default));var St=()=>n(142730),yt=()=>n(616728);const wt=new(Le().Ss)("StartupsApplication",(async()=>Promise.all([n.e(62743),n.e(54882),n.e(25606)]).then(n.bind(n,960766)))),kt=(0,Le().kF)(wt,(e=>e.default)),xt={LennyApplication:new(Le().Ss)("LennyApplication",(()=>Promise.all([n.e(62743),n.e(54882),n.e(1982)]).then(n.bind(n,572282))))},It=(0,Le().kF)(xt.LennyApplication,(e=>e.LennyApplication));var Ct=()=>n(826955);const _t=new(Le().Ss)("StudentGroupSignup",(async()=>Promise.all([n.e(62743),n.e(54882),n.e(16928)]).then(n.bind(n,173134)))),Tt=(0,Le().kF)(_t,(e=>e.default));var Pt=()=>n(223248),jt=()=>n(707513),Et=()=>n(666414),Ut=()=>n(661297),Mt=()=>n(67961),Lt=()=>n(383694);const Rt=function(e){const{teamStore:t}=e,n=(0,v().O7)(),{teamName:o}=(0,D().VK)((()=>({teamName:t.getName()})),[t]),r=(0,K().yK)((e=>({buttonContainer:{marginTop:15,display:"flex",justifyContent:"space-between"},container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},title:{fontWeight:jt().Ue.semibold,fontSize:20,margin:10},subtitle:{color:e.mediumTextColor,fontSize:18,padding:12},divider:{maxWidth:280},rightButton:{fontWeight:jt().Ue.semibold,marginLeft:10}})),[]);return(0,p.jsxs)("div",{style:r.container,children:[(0,p.jsx)(Lt().p,{store:t,disabled:!0,size:55}),(0,p.jsx)("div",{style:r.title,children:(0,p.jsx)(s()._H,{id:"teamInviteLinkJoinPage.page.title",defaultMessage:"You've been invited to join {teamName}",values:{teamName:o}})}),(0,p.jsx)("div",{style:r.subtitle,children:(0,p.jsx)(s()._H,{id:"teamInviteLinkJoinPage.page.subtitle",defaultMessage:"You can access the content in the teamspace if you join the teamspace."})}),(0,p.jsxs)("div",{style:r.buttonContainer,children:[(0,p.jsx)(R().Z,{isLarge:!0,onClick:async()=>{const e=n.currentUser.id;if(!e)return;const o={type:"member",entity_type:"user",user_id:e};await Pt().um({environment:n,userId:e,teamStore:t,user:o}),be().Ph(n,{store:t,selection:"yes"})},children:(0,p.jsx)(s()._H,{id:"teamInviteLinkJoinPage.joinTeam.label",defaultMessage:"Join teamspace"})}),(0,p.jsx)(Ut().Z,{style:r.rightButton,onClick:async()=>{be().Ph(n,{store:t,selection:"no"}),await Pt().Id({environment:n})},children:(0,p.jsx)(s()._H,{id:"teamInviteLinkJoinPage.backToMyContentButton.label",defaultMessage:"Back to my content"})})]}),(0,p.jsx)(Et().Z,{size:48,innerStyle:r.divider}),(0,p.jsx)(Mt().Z,{isSmall:!0,children:(0,p.jsx)(s()._H,{id:"teamInviteLinkJoinPage.contact.message",defaultMessage:"Please contact your workspace owner for any questions."})})]})};function At(e){const{teamStore:t,teamName:n,onRequestClick:o}=e,r=(0,v().O7)(),a=(0,K().yK)((e=>({buttonContainer:{marginTop:15,display:"flex",justifyContent:"space-between"},container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},title:{fontWeight:jt().Ue.semibold,fontSize:20,margin:10},subtitle:{color:e.mediumTextColor,fontSize:18},divider:{maxWidth:280},rightButton:{fontWeight:jt().Ue.semibold,marginLeft:10}})),[]);return(0,p.jsxs)("div",{style:a.container,children:[(0,p.jsx)(Lt().p,{store:t,disabled:!0,size:55}),(0,p.jsx)("div",{style:a.title,children:(0,p.jsx)(s()._H,{id:"teamInviteLinkRequestPage.requestAccess.title",defaultMessage:"Request access to {teamName}",values:{teamName:n??Vt()}})}),(0,p.jsx)("div",{style:a.subtitle,children:(0,p.jsx)(s()._H,{id:"teamInviteLinkRequestPage.requestAccess.subtitle",defaultMessage:"You can access this teamspace if a teamspace owner approves your request."})}),(0,p.jsxs)("div",{style:a.buttonContainer,children:[(0,p.jsx)(R().Z,{isLarge:!0,onClick:o,children:(0,p.jsx)(s()._H,{id:"teamInviteLinkRequestPage.requestAccess.label",defaultMessage:"Request access"})}),(0,p.jsx)(Ut().Z,{size:"lg",style:a.rightButton,onClick:async()=>{await Pt().Id({environment:r})},children:(0,p.jsx)(s()._H,{id:"teamInviteLinkRequestPage.backToMyContentButton.label",defaultMessage:"Back to my content"})})]}),(0,p.jsx)(Et().Z,{size:48,innerStyle:a.divider}),(0,p.jsx)(Mt().Z,{isSmall:!0,children:(0,p.jsx)(s()._H,{id:"teamInviteLinkRequestPage.contact.message",defaultMessage:"Please contact your workspace owner for any questions."})})]})}function Vt(){return(0,p.jsx)(s()._H,{id:"teamInviteLinkRequestPage.privateTeamspace.label",defaultMessage:"Private Teamspace"})}const Zt=function(e){const{teamStore:t}=e,[r,a]=(0,o.useState)(!1),{teamName:i}=(0,D().VK)((()=>({teamName:t.getName()})),[t]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(At,{teamStore:t,teamName:i,onRequestClick:()=>a(!0)}),(0,p.jsx)(n(450194).Z,{teamStore:t,teamName:i??Vt(),teamId:t.id,isModalOpen:r,onDismiss:()=>a(!1)})]})};function Bt(e){const{teamAccessLevel:t,teamStore:n}=e;switch(t){case"open":return(0,p.jsx)(Rt,{teamStore:n});case"closed":case"private":return(0,p.jsx)(Zt,{teamStore:n})}}const Nt=function(e){const{teamId:t}=e,r=(0,v().O7)(),a=(0,D().VK)((()=>new(Ct().zX)(r,{table:pe().e0,id:t})),[r,t]),[{value:i}]=(0,n(801812).r5)((async()=>await Pt().Ng({environment:r,teamId:t})),[r,t]);(0,o.useEffect)((()=>{!0===(null==i?void 0:i.isValidTeamRequest)&&null!=i&&i.isTeamMember&&(async()=>{var e;const t=null===(e=r.currentUser)||void 0===e?void 0:e.id;t&&a&&await Pt().t_({environment:r,userId:t,teamStore:a})})()}),[r,a,i]);const s=(0,K().yK)((()=>({container:{display:"flex",justifyContent:"center",height:"100%"}})),[]);return i?(0,p.jsx)("div",{style:s.container,children:i.isValidTeamRequest?(0,p.jsx)(Bt,{teamStore:a,teamAccessLevel:i.teamAccessLevel}):"nonSpaceMember"===i.invalidRequestReason?(0,p.jsx)(pt().I,{route:{name:"teamsInvite",teamId:t},publicPageData:void 0}):(0,p.jsx)(pt().I,{route:{name:"notFound"},publicPageData:void 0})}):null};var Ot=()=>n(106502);const Dt=new(Le().Ss)("aiInferenceTranscript",(()=>Promise.all([n.e(62743),n.e(52774),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(80730),n.e(83962),n.e(21862),n.e(58548),n.e(77144),n.e(94543)]).then(n.bind(n,939198)))),Kt=(0,Le().kF)(Dt,(e=>e.FullPageAI));var qt=()=>n(650996),Ft=()=>n(743959);function zt(e){return(0,p.jsx)("div",{id:"test-customer-io",style:{width:334,height:200,position:"absolute",bottom:64,right:21,zIndex:1,display:e?void 0:"none"}})}const Wt=function(){const e=(0,v().O7)(),{currentUser:t}=e,n=(0,D().VK)((()=>t.isLoggedIn()),[t]),r=(0,D().VK)((()=>Qe().default.state.inAppCalloutStore),[]),a=(0,D().VK)((()=>"dark"!==e.ThemeStore.state.mode),[e]);(0,o.useEffect)((()=>{n&&(r.getCalloutVisibility("customer_io").canShow?a?Ft().Z.state.suppressReason===Ft().V.IN_APP_CALLOUT_CONFLICT?Ft().Z.setState({...Ft().Z.state,isVisible:!0,suppressReason:void 0}):Ft().Z.setState({...Ft().Z.state,suppressReason:void 0}):Ft().Z.setState({isVisible:!1,suppressReason:Ft().V.DARK_MODE}):Ft().Z.setState({isVisible:!1,suppressReason:Ft().V.IN_APP_CALLOUT_CONFLICT}))}),[r,n,a]);const i=(0,D().VK)((()=>Ft().Z.state.isVisible&&r.getCalloutVisibility("customer_io").canShow),[r]);return(0,o.useEffect)((()=>{if(i)return r.updateCalloutStatus({calloutId:"customer_io",visible:!0}),()=>{r.updateCalloutStatus({calloutId:"customer_io",visible:!1})}}),[r,i]),n?zt(!!i):null};var Ht=()=>n(851990),$t=()=>n(905263);const Gt=(0,s().vU)({pressSlashHeader:{id:"EducationTooltips.pressSlash.header",defaultMessage:"Press {slashkey} for commands"}});function Yt(e){return(0,p.jsx)("div",{style:{background:U().ZP.whiteWithAlpha(.1),padding:3,paddingRight:8,paddingLeft:8,marginRight:6,marginLeft:6,borderRadius:4},children:e.char})}function Xt(){const e=(0,v().O7)(),t=Ht().o();return(0,D().VK)((()=>{const{currentUserSettingsStore:e}=Qe().default.state;var t;return!e||!e.isReady()||Boolean(null===(t=e.getSettings())||void 0===t?void 0:t.pressed_slash_tooltip)}),[])||e.device.isMobile||!t?null:(0,p.jsx)($t().U,{hideCloseButton:!0,origin:()=>t.getNode(),placementToOrigin:"bottom",header:(0,p.jsx)(s()._H,{...Gt.pressSlashHeader,values:{slashkey:(0,p.jsx)(Yt,{char:"/"})}}),content:null,onCloseClick:()=>Ht().q(e)})}const Qt=new(Le().Ss)("InPageFind",(async()=>Promise.all([n.e(52774),n.e(9901)]).then(n.bind(n,876025)))),Jt=(0,Le().kF)(Qt,(e=>e.InPageFind));var en=()=>n(506347),tn=()=>n(285670),nn=()=>n(175113),on=()=>n(82937),rn=()=>n(881266),an=()=>n(887430),sn=()=>n(632775),cn=()=>n(201741),ln=()=>n(982855),dn=()=>n(942226),un=()=>n(242921),pn=()=>n(521635),mn=()=>n(793935),fn=()=>n(520849),gn=()=>n(505121),vn=()=>n(311562),hn=()=>n(660293),bn=()=>n(482162),Sn=()=>n(855249),yn=()=>n(890324),wn=()=>n(965903),kn=()=>n(147861),xn=()=>n(628370),In=()=>n(94967),Cn=()=>n(748621),_n=()=>n(299519),Tn=(n(228244),()=>n(926724)),Pn=()=>n(416593),jn=()=>n(414294),En=()=>n(165940),Un=()=>n(119239),Mn=()=>n(794586),Ln=()=>n(293689),Rn=()=>n(152027),An=()=>n(174939),Vn=()=>n(912701),Zn=()=>n(716228),Bn=()=>n(122479),Nn=()=>n(148126),On=()=>n(467171);function Dn(e){const{theme:t,isSidePeekOpen:n,borderRadius:o,isElectronWindows:r,isShowingTabBar:a,zoomFactor:i}=e;return{zIndex:n?z().LI:z().Bh,background:t.peekModalBackground,borderTopLeftRadius:o??12,borderTopRightRadius:o??12,paddingRight:r&&n&&!a?(0,Pn().RO)(i):void 0}}const Kn=12;function qn(e){const{environment:t}=e,n=t.device.isMobile?4:Kn;return{height:On().R6(t.device.isElectronMac),display:"flex",justifyContent:"space-between",alignItems:"center",paddingLeft:n,paddingRight:n}}var Fn=()=>n(480089),zn=()=>n(528770),Wn=()=>n(790891),Hn=()=>n(779733),$n=()=>n(279386);const Gn=new(n(529048).Z);var Yn=()=>n(791388),Xn=()=>n(61548),Qn=()=>n(114642),Jn=()=>n(844641),eo=()=>n(87098),to=()=>n(1910),no=()=>n(64260),oo=()=>n(654133),ro=()=>n(525038),ao=()=>n(197874),io=()=>n(647295);var so=()=>n(345918),co=()=>n(943620),lo=()=>n(384241),uo=()=>n(981583);const po={display:"flex",alignItems:"center",fontSize:14,minWidth:0};function mo(e,t){return e&&e instanceof Ct().H2&&t&&e.id===t.id}function fo(e){const{parentStore:t,prefixText:n}=e,o=(0,v().O7)(),r=(0,D().VK)((()=>(0,C().B7)(o)),[o]),a=(0,D().VK)((()=>t instanceof Ct().G&&t.isEmptyPage()),[t]),i=(0,D().VK)((()=>t instanceof Ct().H2?(0,so().Wd)(o,t):t.getIcon()),[o,t]),c=(0,D().VK)((()=>t instanceof Ct().H2?(0,so().rn)(o,t):void 0),[o,t]),l=(0,D().VK)((()=>{const{currentSpaceStore:e}=Qe().default.state;return mo(t,e)}),[t]),d=(0,K().yK)((()=>({privatePagesText:{fontWeight:jt().Ue.medium,marginLeft:4,...jt().Yu,overflow:"hidden"},icon:{marginRight:4,marginTop:1},title:{fontWeight:jt().Ue.semibold}})),[]);return(0,p.jsx)(p.Fragment,{children:l?(0,p.jsxs)(p.Fragment,{children:[n,(0,p.jsx)(uo().Z,{size:22,avatarShouldShowShadow:!0,userStore:r}),(0,p.jsx)("span",{style:d.privatePagesText,children:(0,p.jsx)(s()._H,{defaultMessage:"Private pages",id:"peekMoveToMenu.addTo.privatePages"})})]}):(0,p.jsxs)(p.Fragment,{children:[n,(0,p.jsx)(co().Z,{disabled:!0,icon:i,isEmptyPage:a,title:c,size:18,style:d.icon}),(0,p.jsx)(lo().Z,{style:d.title,store:t})]})})}const go=function(e){let{store:t,prefix:r,buttonStyle:a,saveParent:i,pageType:c,forceUntyped:l}=e;const d=(0,K().Fg)(),u=(0,v().O7)(),m=(0,D().VK)((()=>{const e=Qe().default.state.mainEditorCurrentBlockStore;return e&&(0,Ye().WE)(e)?"home_tab":e&&(0,C().qG)(e.id)?"aggregated_type":"quick_add"}),[]),f=(0,D().VK)((()=>t.getParentStore()),[t]),g=(0,o.useRef)(null),h=(0,o.useCallback)((e=>function(e,t,n,o,r,a,i,s){e.preventDefault(),t&&ro().bA({environment:n,blocks:[o],originRect:t.getBoundingClientRect(),moveToContext:a,onAccept:e=>{let{value:t}=e;return function(e,t,n,o){const{currentSpaceStore:r}=Qe().default.state;if(r&&t){let t;!function(e){const{pageType:t,spaceStore:n,currentUserId:o,result:r}=e;(0,io().rq)({currentUserId:o,spaceId:n.id,value:r}),t&&(0,io().ZT)({currentUserId:o,spaceId:n.id,databaseType:ao().wg[t],parent:r})}({pageType:t||o,spaceStore:r,currentUserId:n.currentUser.id,result:e})}}(t,r,n,i)},isAddTo:!0,isDefaultPrivateLocation:vo(o),disableSuccessToast:!0,forceUntyped:s||ho(i)})}(e,g.current,u,t,i,m,c,l)),[g,u,t,i,m,c,l]);if(f&&!(f instanceof Ct().T5)&&!(f instanceof Ct().zq)&&!(f instanceof Ct().Vf)&&!(f instanceof Ct().Xr)&&!(f instanceof Ct().xj)&&!(f instanceof Ct().b4)&&!(f instanceof Ct().uj)){const e=r?(0,p.jsx)("span",{style:{color:d.mediumTextColor,marginRight:4},children:(0,p.jsx)(s()._H,{...r})}):void 0;return(0,p.jsx)(In().Z,{debugName:"PeekMoveToMenu",capture:!0,onMoveTo:h,children:(0,p.jsx)("div",{style:po,children:(0,p.jsx)(oo().Z,{renderTooltip:()=>(0,p.jsxs)("div",{children:[(0,p.jsx)(s()._H,{defaultMessage:"Set the default page or database",id:"peekMoveToMenu.tooltip"}),(0,p.jsx)("br",{}),(0,p.jsx)(no().Z,{style:{color:d.mediumInvertedTextColor},name:"moveTo"})]}),render:t=>(0,p.jsxs)(n(265640).D,{onClick:h,ref:g,shouldShrink:!0,style:a,...t,children:[(0,p.jsx)(fo,{parentStore:f,prefixText:e}),(0,n(374289).i)({width:10,marginLeft:4,fill:d.lightTextColor})]})})})})}return null};function vo(e){const t=e.getParentStore(),{currentSpaceStore:n}=Qe().default.state;return mo(t,n)}function ho(e){return!e||"page"===e}var bo=()=>n(234004),So=()=>n(211009),yo=()=>n(688124),wo=()=>n(447737),ko=()=>n(49489),xo=(n(470928),n(241792),()=>n(429617)),Io=()=>n(827282),Co=()=>n(161002),_o=()=>n(250303),To=()=>n(139224),Po=()=>n(605890),jo=()=>n(429725),Eo=()=>n(527278),Uo=()=>n(352230),Mo=()=>n(239482),Lo=()=>n(827973),Ro=()=>n(448419),Ao=()=>n(108714),Vo=()=>n(198829),Zo=()=>n(255577),Bo=()=>n(967092),No=()=>n(388284);const Oo=(0,s().vU)({changeForThisView:{id:"peekTopbar.changePeekOption.changeForThisView",defaultMessage:"Edit view default"}});const Do=function(e){let{store:t,onClick:o,onDismissPopup:r,onClosePeek:a}=e;const i=(0,K().Fg)(),c=(0,v().O7)();(0,P().K)((()=>{const e=qo(i),t=bn().default.getPeekMode();e.find((e=>d().Xy(e.key,t)))||n(799891).log({level:"warning",from:"TopbarPeekModeButton",type:"InvalidSelectedPeekMode",error:(0,n(792409).Ui)("Selected key is invalid.")})}));const l=(0,v().Fy)(),u=qo(i),m=(0,D().VK)((()=>bn().default.getPeekMode()),[]);return m?(0,p.jsx)(Ro().ZP,{popupType:l.isMobile?Bo().kQ.SlideUp:Bo().kQ.Popup,alignmentToOrigin:Ro().vR.Center,placementToOrigin:Ro().pO.Bottom,style:{minWidth:190},originGap:0,onClick:()=>{!function(e){if(!bn().default.state.open)return;const t=bn().default.state.collectionContextStore;t?_o().nS({environment:e,collectionContextStore:t,from:"peek_topbar",peek_target_id:bn().default.state.targetStore.id,from_peek_mode:bn().default.state.mode}):nn().v2(e,{from:"peek_topbar",peek_target_id:bn().default.state.targetStore.id,from_peek_mode:bn().default.state.mode})}(c),o&&o()},onClose:r,renderOrigin:e=>(0,p.jsx)(oo().Z,{renderTooltip:()=>(0,p.jsx)(s()._H,{defaultMessage:"Switch peek mode",id:"peekTopbar.openPagesAs.button"}),render:t=>(0,p.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:2},children:[(0,p.jsx)(ko().Z,{}),(0,p.jsx)(to().Z,{...e,...t,icon:(0,Po().RO)(m),iconStyle:{width:Io().ZG.default,height:Io().ZG.default,fill:i.mediumIconColor}})]})}),render:e=>(0,p.jsx)(Ko,{parent:e,currentPeekMode:m,options:u,store:t,onClosePeek:a})}):null};function Ko(e){let{currentPeekMode:t,options:n,store:o,onClosePeek:r,parent:a}=e;const i=(0,v().O7)(),s=(0,v().Fy)(),c=(0,K().Fg)();let l;l=s.isMobile?{menuType:Uo().o.ActionSheet}:{menuType:Uo().o.Popup,width:220};const u=(0,D().VK)((()=>{const{RouterStore:e}=i,r=e.state.route;return d().oA([...n.map(((e,n)=>{const s=e.key,c=void 0===s||"full_page"===s?void 0:(0,bn().getUrlParamFromPeekMode)(s),l="full_page"===s?(0,jo().ZP)({store:o,fullyQualified:!1,openInCenterPeek:!o.isPost()&&void 0,pageVisitSource:en().tY.Expand}):"team"===r.name?(0,Co().y)({teamId:r.teamId,peekInfo:c?{peekMode:c,peekViewBlockId:o.id}:void 0}):function(e,t,n){const{mainEditorCurrentBlockStore:o}=Qe().default.state,r=Mo().uJ(n),a=n.isNavigableBlock()?r.slice(1):[...r],i=a.length>0?a[0]:void 0;return(0,an().mb)({environment:e,store:n,mainEditorCurrentBlockStore:i instanceof Ct().G&&!bn().default.state.open?i:o,collectionContextStore:bn().default.state.collectionContextStore,fullyQualified:!1,overridePeekMode:(0,bn().getPeekModeFromCollectionPeekModeFormat)(t)})}(i,s,o);return{key:n,render:n=>(0,p.jsx)(Ao().Z,{href:l,onClick:()=>{var e;nn().UZ(i,{from:"peek_topbar",peek_mode:s,from_peek_mode:t,target_page_id:null===(e=bn().default.peekTargetStore.state)||void 0===e?void 0:e.id}),a.close()},children:(0,p.jsx)(Lo().Z,{...n,disabled:!1,title:e.title,icon:e.icon,caption:e.caption,body:e.body,checkState:d().Xy(e.key,t)})}),action:()=>{}}}))])}),[n,t,i,o,a]),m=(0,D().VK)((()=>bn().default.state.open?bn().default.state.collectionContextStore:void 0),[]),f=(0,D().VK)((()=>bn().default.state.open?bn().default.state.targetStore:void 0),[]),g=(0,D().VK)((()=>Qe().default.state.mainEditorCurrentBlockStore),[]),h=(0,D().VK)((()=>{var e,t,n;const o=g&&g.id===(null==m||null===(e=m.collectionViewBlockStore())||void 0===e?void 0:e.getRecordStoreUIRoot().id);return(null==m||null===(t=m.collectionStore())||void 0===t?void 0:t.id)===(null==f||null===(n=f.getAssociatedCollectionStore())||void 0===n?void 0:n.id)&&(null==m?void 0:m.permissionScopesStore.state.canConfigureBlock)&&o}),[g,m,f]);return(0,p.jsx)(Vo().Z,{...l,children:(0,p.jsx)(Zo().ZP,{type:Zo().iW.Vertical,sections:d().oA([{key:0,render:e=>(0,p.jsx)(No().Z,{enableActionSheetTitle:!0,...e}),items:u},h&&{key:1,render:e=>(0,p.jsx)(No().Z,{enableActionSheetTitle:!0,topBorder:!0,...e}),items:[{key:"change_for_view",render:e=>(0,p.jsx)(Lo().Z,{...e,disabled:!1,title:Eo().Z.formatMessage(Oo.changeForThisView),icon:(0,xo().m)({width:Io().ZG.default,height:Io().ZG.default,fill:c.regularIconColor})}),action:e=>{!function(e,t){const n=bn().default.state.open?bn().default.state.collectionContextStore:void 0;n&&(bn().default.isCenterPeekOpen()&&t&&t(),To().r$({collectionContextStore:n,collectionSettingsStore:n.settingsStore}),To().H4({collectionSettingsStore:n.settingsStore,item:{type:"layout"}}),n.settingsStore.setState({...n.settingsStore.state,openButtonPopup:"peekModeFormat"}))}(0,r),a.close()}}]}]),initialFocus:0})})}function qo(e){return["side_peek","center_peek","full_page"].map((t=>({key:t,type:"button",title:(0,Po().LQ)(t),icon:(0,Po().RO)(t)({width:Io().ZG.default,height:Io().ZG.default,fill:e.mediumTextColor})})))}var Fo=()=>n(259878),zo=()=>n(451102),Wo=()=>n(984766),Ho=()=>n(758210),$o=()=>n(730764);const Go=(0,s().vU)({moveToPrefixText:{id:"peekMoveToMenu.moveTo.moveTo",defaultMessage:"Move to"},addToPrefixText:{id:"peekMoveToMenu.addTo.addTo",defaultMessage:"Add to"},closeButton:{defaultMessage:"Close",id:"peekTopbar.close.button"},previousPageTooltip:{defaultMessage:"Previous page",id:"peekTopbar.peekNavUpArrow.tooltip"},nextPageTooltip:{defaultMessage:"Next page",id:"peekTopbar.peekNavDownArrow.tooltip"},closeLayoutInfoPanelTooltip:{defaultMessage:"Close panel",id:"peekTopbar.closeLayoutInfoPanelButton.tooltip"}});const Yo=function(e){let{store:t,shouldShowMoveToMenu:r,onClose:a,spaceStore:i,spaceViewStore:s,pageVisitStore:c,presenceStore:l}=e;const d=(0,K().Fg)(),u=(0,v().O7)(),m=(0,D().VK)((()=>bn().default.isSidePeekOpen()),[]),f=(0,D().VK)((()=>n(851713).Z.state.banners),[]),g=(0,D().VK)((()=>t.canEdit()),[t]),{isShowingTabBar:h,zoomFactor:b}=(0,D().VK)((()=>({isShowingTabBar:Boolean(oe().default.state.isShowingTabBar),zoomFactor:oe().default.state.zoomFactor||Pn().lO})),[]),S=u.device.isElectron&&!h&&m,y=(0,D().VK)((()=>t.isFormBlock()),[t]),w=(0,D().VK)((()=>pn().Z.getPanelState("peek").isMouseHoveringPanel),[]),k=(0,D().VK)((()=>"static_sidebar"===pn().Z.getPanelState("peek").displayStyle&&pn().Z.getPanelState("peek").isOpen),[]),[x,I]=o.useState(!1),C=(0,D().qz)(void 0,n(385021).Z),_=(0,D().VK)((()=>bn().default.state.topHoverAreaEntered),[]),T=(0,K().yK)((()=>{const e=_||x;return{peekControlsWrapper:{display:"grid",gridAutoFlow:"column",gridColumnGap:2,alignItems:"center"},hoverBtn:{opacity:e?1:0,pointerEvents:e?"auto":"none",transition:"opacity 100ms ease"}}}),[_,x]),P=k&&(_||w);return(0,p.jsx)(_n().Z,{store:t,disableRectangularSelection:!0,disableEditNearestBlock:!0,isPeekRenderer:!0,render:e=>{let{selectableEvents:o}=e;return(0,p.jsxs)("div",{...o,style:{height:y?0:void 0,...Dn({theme:d,isSidePeekOpen:m,isElectronWindows:u.device.isElectronWindows,isShowingTabBar:h,zoomFactor:b})},className:`${te().JiT} ${S?te().pMC:""}`,children:[(0,p.jsxs)("div",{style:qn({environment:u}),children:[(0,p.jsxs)("div",{style:T.peekControlsWrapper,children:[(0,p.jsx)(Jo,{onClose:a}),!y&&(0,p.jsx)(n(659038).Z,{store:t,shouldShowMoveToMenu:r}),(0,p.jsx)(Xo,{store:t,shouldShowMoveToMenu:r}),g&&(0,p.jsx)(n(986520).Z,{store:t,lockStore:C,buttonStyle:{margin:0}}),!y&&(0,p.jsx)("div",{style:T.hoverBtn,children:(0,p.jsx)(Do,{store:t,onClick:()=>I(!0),onDismissPopup:()=>I(!1),onClosePeek:a})}),(0,p.jsx)("div",{style:{...T.hoverBtn,...T.peekControlsWrapper},children:(0,p.jsx)(er,{shouldShowMoveToMenu:r})})]}),(0,p.jsx)(Qo,{store:t,spaceStore:i,spaceViewStore:s,pageVisitStore:c,presenceStore:l,shouldShowLayoutPanelCloseButton:P})]}),(0,p.jsx)(n(188407).t,{banners:f,isMobile:!1,isInPeekRenderer:!0})]})}})};function Xo(e){let{store:t,shouldShowMoveToMenu:n}=e;const{open:o,saveParent:r,pageVisitSource:a,collectionContextStore:i}=(0,D().VK)((()=>({open:bn().default.state.open,saveParent:!!bn().default.state.open&&bn().default.state.saveParent,pageVisitSource:bn().default.state.open?bn().default.state.pageVisitSource:void 0,collectionContextStore:bn().default.state.collectionContextStore})),[]),s=(0,D().VK)((()=>{const e=t.getAssociatedCollectionStore();return(null==e?void 0:e.getDatabaseType())===Tn().Ym?"tasks":void 0}),[t]),c=(0,D().VK)((()=>"collectionTypedView"===(null==i?void 0:i.contextType)),[i]);return o&&n?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(ko().Z,{}),(0,p.jsx)(go,{store:t,saveParent:r,prefix:c?Go.moveToPrefixText:Go.addToPrefixText,pageType:s,forceUntyped:a===en().tY.SidebarQuickAdd})]}):null}function Qo(e){let{store:t,spaceStore:n,spaceViewStore:r,pageVisitStore:a,presenceStore:i,shouldShowLayoutPanelCloseButton:c}=e;const l=(0,v().O7)(),d=(0,v().Fy)(),u=(0,D().VK)((()=>(0,Bn().eV)(l,t)),[l,t]),m=(0,D().VK)((()=>n&&n.id!==t.getSpaceId()),[n,t]),f=(0,D().VK)((()=>C().qG(t.id)),[t]),g=(0,D().VK)((()=>(0,Ye().Kj)(t.id)),[t]),h=(0,D().VK)((()=>(0,Hn().E1)()),[]),b=(0,D().VK)((()=>t.isPost()&&!t.isPublishedPost()),[t]),S=(0,D().VK)((()=>t.isFormBlock()),[t]),y=(0,D().VK)((()=>t.isPageBlock()),[t]),k=(0,D().VK)((()=>t.isExternalObjectInstancePageBlockStore()),[t]),x=!d.isMobile&&n&&r&&!u&&!m&&!g&&!S,I=(0,D().VK)((()=>(0,So().C$)({device:d,isPersonalHomePage:g,isFormBlock:S,store:t})),[d,g,S,t]),_=(0,D().VK)((()=>Boolean(n&&!n.canEdit())),[n]),T=(0,D().VK)((()=>t.canEdit()),[t]),P=(0,D().VK)((()=>t.isRestricted()),[t]),j=(0,D().VK)((()=>{var e;return null===(e=$n().MT.getStateForBlock(t.id))||void 0===e?void 0:e.mode}),[t.id]),{suggestTranslation:E,suggestedPageTranslationLanguage:U,detectedPageLanguage:M,setTranslationSuggestionDismissed:L}=(0,Ho().B)(t),R=(0,D().VK)((()=>!d.isMobile&&(y||k)&&!S),[d.isMobile,y,S,k]),A=(0,Fn().cR)(t),V=n&&r&&!u&&!m&&(0,bo().shouldShowTopbarShareMenu)({isSpaceGuest:_,canEditPage:T,isFormBlock:S,isPersonalHomePage:g,isTranslated:"translate_locked"===j}),Z=n&&r&&!S&&!u&&!m&&!A&&"translate_locked"!==j,B=(0,s().YB)(),N=o.useCallback((()=>{var e;const n=null===(e=t.getAssociatedCollectionStore())||void 0===e?void 0:e.getLayoutStore();n&&(0,zn().n)({environment:l,layoutStore:n,from:"topbar",panelLocation:"peek"})}),[t,l]),O=(0,D().VK)((()=>x&&T&&!b&&"on"!==w().default.getEligibleGroup({experimentId:"remove_updates_topbar_button_v2",defaultGroup:"control"})),[T,x,b]),q=(0,D().VK)((()=>(0,Nn().Sr)(l)),[l]),F=(0,D().VK)((()=>t.isPost()),[t]),z=function(){const e=(0,v().O7)(),t=(0,D().VK)((()=>{const t=e.device.isMobile?void 0:(0,un().rb)({environment:e,isInPeek:!0});return t?t-Kn:void 0}),[e]);return(0,K().yK)((e=>({wrapStyles:{display:"flex",alignItems:"center",flexGrow:0,flexShrink:0,zIndex:1,minWidth:t,paddingLeft:Kn,justifyContent:"flex-end"}})),[t]).wrapStyles}();return(0,p.jsxs)("div",{style:z,children:[c&&(0,p.jsx)(oo().Z,{renderTooltip:()=>(0,p.jsx)("div",{children:B.formatMessage(Go.closeLayoutInfoPanelTooltip)}),render:e=>(0,p.jsx)(to().Z,{...e,ariaLabel:B.formatMessage(Go.closeLayoutInfoPanelTooltip),icon:Un().t,iconStyle:{width:16,height:16},onClick:N})}),q&&(0,p.jsx)("div",{style:{flexGrow:1}}),P&&!h&&(0,p.jsx)(zo().Z,{style:{marginRight:14},onClick:()=>{Qn().Z.setState({open:!0})}}),U&&M&&(0,p.jsx)(eo().PN,{store:t,isVisible:E,setTranslationSuggestionDismissed:()=>L(!0),suggestedPageTranslationLanguage:U,detectedPageLanguage:M}),(0,p.jsx)(Zn().B,{store:t,isVisible:"suggest"===j&&!S,compact:!0}),(0,p.jsx)(Ln().eR,{store:t,isVisible:"ai_co_editing"===j&&!S,compact:!0}),T&&!S&&!F&&(0,p.jsx)(Fo().ZP,{rootStore:t,pageVisitStore:a,presenceStore:i}),V&&(0,p.jsx)(Vn().j,{store:t,buttonPopupStore:Qn().Z}),R&&(0,p.jsx)(wo().a,{blockStore:t,buttonPopupStore:Yn().Z,pageViewBlockContext:vn().S.PeekView}),I&&(0,p.jsx)(So().ZP,{blockStore:t,spaceStore:n,buttonPopupStore:Gn}),O&&(0,p.jsx)(Wo().ZP,{blockStore:t,spaceStore:n,buttonPopupStore:Jn().Z}),Z&&(0,p.jsx)(yo().Z,{store:t,spaceViewStore:r}),S&&(0,p.jsx)(Rn().Z,{formBlockStore:t,inPeekMode:!0}),f&&(0,p.jsx)(Wn().Z,{}),x&&(0,p.jsx)(An().K,{store:t,buttonPopupStore:Xn().Z}),b&&(0,p.jsx)($o().n,{store:t})]})}function Jo(e){let{onClose:t}=e;const n=(0,s().YB)(),o=(0,K().Fg)();return(0,D().VK)((()=>bn().default.isSidePeekOpen()),[])?(0,p.jsx)(oo().Z,{renderTooltip:()=>(0,p.jsxs)("div",{children:[n.formatMessage(Go.closeButton),(0,p.jsx)("br",{}),(0,p.jsx)(no().Z,{style:{color:o.mediumInvertedTextColor},name:"esc"})]}),render:e=>(0,p.jsx)(to().Z,{...e,ariaLabel:n.formatMessage(Go.closeButton),icon:Un().t,iconStyle:{width:16,height:16},onClick:()=>t("close_button")})}):null}function er(e){let{shouldShowMoveToMenu:t}=e;const n=(0,s().YB)(),o=(0,K().Fg)(),r=(0,D().Kw)(bn().default),{resultsStore:a}=r,i=(0,D().VK)((()=>null==a?void 0:a.getState()),[a]);if(!r.open)return null;if(t)return null;const c=r.targetStore.id;return i&&i.length>0&&i.some((e=>e.id===c))?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(ko().Z,{}),(0,p.jsx)(oo().Z,{renderTooltip:()=>(0,p.jsxs)("div",{children:[n.formatMessage(Go.previousPageTooltip),(0,p.jsx)("br",{}),(0,p.jsx)(no().Z,{style:{color:o.mediumInvertedTextColor},name:"peekUp"})]}),render:e=>(0,p.jsx)(to().Z,{...e,ariaLabel:n.formatMessage(Go.previousPageTooltip),disabled:c===i[0].id,icon:En().R,onClick:()=>Mn().Qk(),iconStyle:{fill:o.mediumIconColor}})}),(0,p.jsx)(oo().Z,{renderTooltip:()=>(0,p.jsxs)("div",{children:[n.formatMessage(Go.nextPageTooltip),(0,p.jsx)("br",{}),(0,p.jsx)(no().Z,{style:{color:o.mediumInvertedTextColor},name:"peekDown"})]}),render:e=>(0,p.jsx)(to().Z,{...e,ariaLabel:n.formatMessage(Go.nextPageTooltip),disabled:c===i[i.length-1].id,icon:jn().E,onClick:()=>Mn().OW(),iconStyle:{fill:o.mediumIconColor}})})]}):null}function tr(){const e=(0,D().VK)((()=>bn().default.state.open),[]),t=(0,D().Kw)(gn().Z),n=(0,K().yK)((e=>({containerStyles:{position:"fixed",top:0,right:0,bottom:0,left:0,zIndex:z().Nn,background:e.overlaySmokescreen},contentStyles:{...sr(e),top:bn().PeekModeOuterPadding,left:bn().PeekModeOuterPadding,right:bn().PeekModeOuterPadding,marginRight:"auto",height:`calc(100% - ${bn().PeekModeOuterPadding}px*2)`,maxWidth:bn().CenterPeekModeOuterWidth+t,borderRadius:12,overflow:"hidden"}})),[t]);return(0,p.jsx)(Cn().Z,{open:e,children:(0,p.jsx)(rr,{enableCaptureClick:!0,priority:void 0,showResizer:!1,styles:n})})}function nr(){const e=(0,v().O7)(),t=(0,D().Kw)(bn().default),n=(0,D().VK)((()=>bn().default.getSidePeekWidth(e.WindowSizeStore.state.width)),[e]),r=(0,_().J4)(),a=(0,K().yK)((e=>({containerStyles:{position:"fixed",top:0,right:0,bottom:0,translateX:n,width:n,zIndex:z().YO},contentStyles:{...sr(e),top:0,right:0,width:"100%",height:r?`calc(100% - ${ne().tL}px)`:"100%",borderRadius:0}})),[r,n]),i=(0,D().Kw)(hn().X),s=o.useRef(null);return(0,p.jsx)(xn().Z,{tag:rr,forceCompositeLayer:!0,skip:i,animate:{translateX:t.open&&!t.isClosing?0:n,width:n},initial:{translateX:t.open?0:n},onAnimationStart:()=>{s.current=performance.now()},onAnimationEnd:()=>{const n=s.current?Math.round(performance.now()-s.current):null;if(s.current=null,!t.open)return;const o=t.isClosing?"side_peek_renderer_animation_closing":"side_peek_renderer_animation_opening";t.isClosing?(bn().default.setState({...t,isClosing:!1}),on().ME()):t.isOpening&&bn().default.setState({...t,isOpening:!1}),n&&(0,y().j)({environment:e,event:{eventName:o,eventProperties:{duration_ms:n}}})},enableCaptureClick:!1,priority:-1,showResizer:!0,styles:a})}function or(){const e=(0,v().O7)(),t=(0,D().Kw)(bn().default),{currentSpaceStore:n,currentSpaceViewStore:o}=(0,D().VK)((()=>{const{currentSpaceStore:e,currentSpaceViewStore:t}=Qe().default.state;return{currentSpaceStore:e,currentSpaceViewStore:t}}),[]),r=(0,D().VK)((()=>{var e;return!!t.open&&(t.showMoveTo||"collectionTypedView"===(null===(e=t.collectionContextStore)||void 0===e?void 0:e.contextType))}),[t]);return t.open?(0,p.jsx)(Yo,{store:t.targetStore,spaceStore:n,spaceViewStore:o,pageVisitStore:t.pageVisitStore,presenceStore:t.presenceStore,shouldShowMoveToMenu:r,onClose:t=>{pr(e,t)}}):null}const rr=o.forwardRef((function(e,t){const{priority:r}=e,a=(0,v().O7)(),i=(0,D().Kw)(bn().default),{shouldShowFrame:s}=(0,D().VK)((()=>(0,C().h1)(a)),[a]),c=(0,D().VK)((()=>dn().Tx()),[]),l=(0,D().VK)((()=>i.open&&0===wn().default.state.stores.length&&!wn().default.state.pivot&&"editing"!==n(127519).default.state.mode&&!n(241449).default.state.isOpen),[i.open]),d=(0,o.useCallback)((()=>{mr(a)}),[a]),u=(0,o.useCallback)((()=>{!function(e){bn().default.peekTargetStore.state&&(n(47443)._c({environment:e,store:bn().default.peekTargetStore.state,pageVisitSource:en().tY.Expand}),nn().sx(e,{isNewPage:bn().default.state.open&&bn().default.state.showMoveTo,peek_mode:bn().default.state.mode,from:"command_enter",target_page_id:bn().default.peekTargetStore.state.id}),nn().$C(e,{peek_mode:bn().default.state.mode,from:"command_enter",target_page_id:bn().default.peekTargetStore.state.id,target_parent_id:bn().default.peekTargetStore.state.getParentId()}))}(a)}),[a]);return s?i.open?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(n(685375).Z,{debugName:"PeekRenderer",priority:r,capture:c}),(0,p.jsx)(In().Z,{debugName:"PeekRenderer",innerKey:i.targetStore.id,capture:l,onEsc:d,onCommandEnter:u,children:(0,p.jsx)(ar,{...e,ref:t})})]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(p.Fragment,{}),(0,p.jsx)(In().Z,{debugName:"PeekRenderer",capture:!1,children:(0,p.jsx)(ar,{...e,ref:t})})]}):null})),ar=o.forwardRef((function(e,t){const{enableCaptureClick:r,bottomBar:a,showResizer:i}=e,c=(0,o.useCallback)((e=>{n(832924).default.PeekViewScroller=e??void 0}),[]),l=(0,s().YB)(),d=(0,v().O7)(),u=(0,D().Kw)(bn().default),m=(0,D().SI)((()=>u.open?yn().Z.getMode(d,u.targetStore):yn().m.disabled),[d,u]),f=(0,D().SI)((()=>(0,ln().GD)(m.state)),[m]),g=(0,D().VK)((()=>{if(!u.open)return;const{currentSpaceStore:e,currentSpaceViewStore:t}=Qe().default.state;return{pageStore:u.targetStore,spaceStore:e,spaceViewStore:t,presenceStore:u.presenceStore,pageVisitStore:u.pageVisitStore,publicEditModeStore:m,arePublicEditCompletionsEnabledStore:f}}),[u,m,f]),h=(0,o.useCallback)((()=>{mr(d)}),[d]),b=(0,o.useCallback)((e=>{let{startTime:t,endTime:o}=e;const r=u.open?an().fm(u.targetStore):void 0;n(620218).default.DO_NOT_USE_measureLegacy({metricName:"collections.max_scroll_lag_in_session",startTime:t,endTime:o},{environment:d,data:n(861026).vS(r)})}),[d,u]),S=(0,o.useCallback)((()=>{!function(e){pr(e,"empty_space_click")}(d)}),[d]);(0,o.useEffect)((()=>{u.open&&u.mode===tn().l?M().setOverlay(!0):M().setOverlay(!1)}),[u.open,u.mode]);const y=(0,D().VK)((()=>cn().QH.state),[]),w=(0,n(206658).E)(u.open?u.targetStore:void 0),{modules:k}=(0,n(557161).V)(u.open?u.targetStore:void 0);(0,un().UI)(d,w);const x=(0,D().VK)((()=>(0,un().rb)({environment:d,isInPeek:!0})),[d]),I=(0,D().VK)((()=>(0,un().GH)({environment:d,isInPeek:!0})),[d]),C=(0,D().VK)((()=>bn().default.isSidePeekOpen()&&cn().ht.state),[]),_=(0,D().VK)((()=>pn().Z.getPanelState("peek").isOpen),[]),T=(0,D().VK)((()=>{if(!u.open)return!1;const e=u.targetStore.getAssociatedCollectionStore();return!!e&&(0,un().kJ)({collectionStore:e})}),[u]),P=(0,K().yK)((t=>({...e.styles,containerStyles:{...e.styles.containerStyles,...e.style},layoutStaticSidebar:{width:x,flexShrink:0,paddingBottom:24,borderLeft:`1px solid ${t.stroke.secondary}`}})),[e.styles,e.style,x]),j=(0,n(511115).z)((e=>{const t=e.target;t instanceof Element&&t.closest(`.${te().JiT}`)?bn().default.setTopHoverAreaEntered(!0):bn().default.setTopHoverAreaEntered(!1)}),100),E=(0,kn().xU)();o.useEffect((()=>(window.addEventListener("mousemove",j),()=>window.removeEventListener("mousemove",j))),[j]);const U=(0,D().Kw)(f);return(0,p.jsx)(n(893403).M,{value:g,children:(0,p.jsx)("div",{role:"region","aria-label":l.formatMessage({id:"peekRenderer.ariaLabel",defaultMessage:"Side Peek"}),"aria-hidden":!u.open||void 0,style:P.containerStyles,className:te().p1Q,ref:t,children:u.open&&(0,p.jsxs)(p.Fragment,{children:[r&&(0,p.jsx)("div",{style:{width:"100%",height:"100%"},onClick:S}),(0,p.jsxs)("div",{style:P.contentStyles,children:[C&&(0,p.jsx)("div",{style:{position:"absolute",top:10,transform:"translateX(-100%)",left:-10},children:(0,p.jsx)(sn().at,{rootStore:y})}),i&&(0,p.jsx)(n(123256).Z,{type:"peek"}),(0,p.jsx)(or,{}),E&&(0,p.jsx)(n(243903).K,{}),(0,p.jsx)(_n().Z,{store:u.targetStore,isDefaultContainer:!0,droppable:!0,isPeekRenderer:!0,render:e=>{let{selectableEvents:t,selectableHoverMenuOverlay:r}=e;const a={pageStore:u.targetStore,pageVisitStore:u.pageVisitStore,initialChunkSize:n(526122).OZ,incrementChunkSize:25,render:e=>{let{ready:a,initialRequestCompleted:i,endOfResultsReached:s,isCollectionInPage:l,scrollerRef:m}=e;return(0,p.jsxs)("div",{style:T?{flexGrow:1,display:"flex",maxHeight:"100%",height:"100%"}:{display:"contents"},children:[!a&&(0,p.jsx)("div",{style:{position:"relative",width:"100%",flexGrow:1},children:(0,p.jsx)(rn().Z,{peekMode:bn().default.getPeekMode(),isVisible:!a,store:u.targetStore})}),(0,p.jsxs)(n(842574).T,{ref:e=>{if(c(e),m){const t=null==e?void 0:e.getNode();t instanceof HTMLElement&&(m.current=t)}},onScrollLagMeasure:l?b:void 0,preventType:a?n(844085).Q7(d):fn().Z.All,type:fn().Z.Y,style:a?cr:lr,store:Sn().Z,...t,children:[r,U&&(0,p.jsx)(Ot().GC,{scrollerStore:Sn().Z}),(0,p.jsx)(sn().vo,{scrollerStore:Sn().Z}),i&&(0,p.jsxs)(o.Fragment,{children:[(0,p.jsx)("div",{className:te().JiT,children:(0,p.jsx)(n(83003).g,{blockStore:u.targetStore})}),(0,p.jsx)(n(778447).ZP,{context:vn().S.PeekView,store:u.targetStore,onTitleEsc:h,forceSelectTitleOnMount:!0,paddingBottom:dn().KA,styleOverrides:ir,disabled:!u.open||u.isClosing}),(0,p.jsx)(n(665444).Z,{pageVisitStore:u.pageVisitStore,presenceStore:u.presenceStore,isPeekView:!0})]}),a&&!s&&(0,p.jsx)(G().Z,{style:ur})]}),U&&(0,p.jsx)(Ot().vK,{scrollerKey:"PeekView"}),(0,p.jsx)(xn().Z,{visible:T,forceCompositeLayer:!0,animate:{width:x},initial:{translateX:_?0:x},style:P.layoutStaticSidebar,children:(0,p.jsx)("div",{style:{width:I,height:"100%"},children:(0,p.jsx)(n(562219).J,{store:u.targetStore,context:vn().S.PeekView,disabled:!u.open||u.isClosing||!_,shownAs:"static_sidebar",modules:k})})})]})}};return(0,p.jsx)(o.Suspense,{fallback:(0,p.jsx)(rn().Z,{peekMode:bn().default.getPeekMode(),isVisible:!0,store:u.targetStore}),children:(0,p.jsx)(n(243126).F,{...a,store:u.loadingContainerStore})})}},u.targetStore.id),a]})]})})})})),ir={pageCoverHeight:"20vh"};function sr(e){return{flexDirection:"column",position:"absolute",display:"flex",marginLeft:"auto",background:e.peekModalBackground,boxShadow:e.shadowMD}}const cr={display:"flex",flexDirection:"column",flexGrow:1,position:"relative",transform:"translateZ(0)"},lr={...cr,opacity:0,pointerEvents:"none",height:0},dr="1.375em",ur={zIndex:1,opacity:.5,width:dr,height:dr,marginTop:0,marginBottom:24,marginLeft:"auto",marginRight:"auto"};function pr(e,t){on().xv({environment:e,from:t})}function mr(e){pr(e,"esc")}const fr=function(){const e=(0,v().O7)(),t=(0,D().VK)((()=>{const e=bn().default.state.open?bn().default.state.targetStore:void 0;return null==e?void 0:e.getSystemBlockTypeStore().getValue()}),[]),r=(0,o.useCallback)((()=>{bn().default.state.open&&bn().default.isSidePeekOpen()&&(mn().toggleLeftSidebarByWindowSize(e),bn().default.setState({...bn().default.state,isOpening:!1}))}),[e]);switch((0,o.useEffect)((()=>(e.WindowSizeStore.addListener(r),()=>e.WindowSizeStore.removeListener(r))),[e.WindowSizeStore,r]),(0,o.useEffect)((()=>{(0,n(903680).u7)(t)&&on().xv({environment:e,from:"invalid_peek_page"})}),[e,t]),(0,D().VK)((()=>bn().default.getPeekMode()),[])){case tn().l:return(0,p.jsx)(tr,{});case tn().R:return(0,p.jsx)(nr,{})}},gr=new(Le().Ss)("ForkPageModalWrapper",(async()=>await Promise.all([n.e(62743),n.e(52774),n.e(5242),n.e(81580),n.e(84325),n.e(11189),n.e(71896),n.e(53335),n.e(46616),n.e(50471),n.e(91253),n.e(61171),n.e(4014),n.e(63502),n.e(75377),n.e(99590),n.e(69437),n.e(81063),n.e(88128),n.e(97934),n.e(91e3),n.e(83962),n.e(8129)]).then(n.bind(n,541409)))),vr=(0,Le().kF)(gr,(e=>e.ForkPageModalWrapper)),hr=new(Le().Ss)("SecondarySidebar",(async()=>await Promise.all([n.e(62743),n.e(52774),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(80730),n.e(83962),n.e(21862),n.e(18700),n.e(58633),n.e(46101)]).then(n.bind(n,387736)))),br=(0,Le().kF)(hr,(e=>e.SecondarySidebar)),Sr=new(Le().Ss)("SpaceSettings",(async()=>Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(39938),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(94556),n.e(78701),n.e(38804),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(71641),n.e(23006),n.e(72646),n.e(10553),n.e(74879),n.e(67601),n.e(37239),n.e(40692),n.e(20683),n.e(22467),n.e(27039),n.e(97083),n.e(52065),n.e(18534),n.e(39179),n.e(77555),n.e(38632),n.e(78856),n.e(19592),n.e(47559),n.e(22371),n.e(73230),n.e(25911),n.e(54843),n.e(76540),n.e(22337),n.e(93536),n.e(53936),n.e(23721),n.e(32175),n.e(66283),n.e(22154),n.e(58586)]).then(n.bind(n,139428)))),yr=(0,Le().kF)(Sr,(e=>e.SpaceSettings));var wr=()=>n(616963);const kr=new(Le().Ss)("Marketplace",(async()=>{const{default:e}=await Promise.all([n.e(62743),n.e(31189),n.e(17100),n.e(91036),n.e(11189),n.e(46616),n.e(50471),n.e(77555),n.e(35332),n.e(13459),n.e(53938),n.e(54801)]).then(n.bind(n,919872));return{Marketplace:e}})),xr=(0,Le().kF)(kr,(e=>e.Marketplace));var Ir=()=>n(26796),Cr=()=>n(589525),_r=()=>n(524434),Tr=(n(821057),()=>n(730120)),Pr=()=>n(947115);async function jr(e,t){const n=await Ee().callApi({eventName:"stripeGetTestClock",environment:t,data:{spaceId:e}});if("success"===n.type){if("advancing"===n.data.status)throw new Error("Test clock is advancing. Please try again in a few seconds.");return n.data.epochSeconds}}async function Er(e){const{environment:t,spaceId:n,advanceTestClockArgument:o}=e;if(o)return"number"==typeof o?o:"function"==typeof o?await async function(e){const{environment:t,spaceId:n,callback:o}=e,r=await jr(n,t);if(r)return o(r)}({environment:t,spaceId:n,callback:o}):"object"==typeof o?await async function(e){const{environment:t,spaceId:n,durationLike:o}=e,r=await jr(n,t);if(!r)return;const a=Tr().ou.fromSeconds(r),i=Tr().nL.fromDurationLike(o);return a.plus(i).toSeconds()}({environment:t,spaceId:n,durationLike:o}):void 0}var Ur=()=>n(435308);const Mr=new(Le().Ss)("PageLayoutEditor",(async()=>Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(39938),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(94556),n.e(78701),n.e(38804),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(71641),n.e(23006),n.e(72646),n.e(10553),n.e(74879),n.e(67601),n.e(37239),n.e(40692),n.e(20683),n.e(22467),n.e(27039),n.e(97083),n.e(52065),n.e(18534),n.e(39179),n.e(77555),n.e(38632),n.e(78856),n.e(19592),n.e(47559),n.e(22371),n.e(73230),n.e(25911),n.e(54843),n.e(76540),n.e(22337),n.e(93536),n.e(53936),n.e(23721),n.e(32175),n.e(66283),n.e(22154),n.e(58586)]).then(n.bind(n,905865)))),Lr=(0,Le().kF)(Mr,(e=>e.PageLayoutEditor)),Rr=new(Le().Ss)("SiteSettingsLayoutEditor",(async()=>await Promise.all([n.e(62743),n.e(52774),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(80730),n.e(83962),n.e(21862),n.e(83837),n.e(72510)]).then(n.bind(n,591917)))),Ar=(0,Le().kF)(Rr,(e=>e.SiteSettingsLayoutEditor));function Vr(e){const{mainEditorCurrentBlockStore:t,currentCollectionViewStore:n}=(0,D().Kw)(Qe().default),o=(0,D().VK)((()=>{const o=e.routerState;if("team"===o.route.name)return{store:void 0,collectionViewStore:void 0,routerState:o};return t?{store:t,collectionViewStore:n,routerState:o}:void 0}),[n,t,e.routerState]),r=(0,D().VK)((()=>Zr.getState()),[]),a=(0,D().VK)((()=>Br.getState()),[]);return r?(0,p.jsx)(Lr,{}):o?a?(0,p.jsx)(Ar,{}):(0,p.jsx)(Oe().Z,{...o}):null}const Zr=new(Ur().default)((()=>{const e=Ir().Z.getState();return e.isOpen&&"layout-editor"===e.mode}),{debugName:"isPageLayoutEditorOpenStore"}),Br=new(Ur().default)((()=>{const e=Ir().Z.getState();return e.isOpen&&"site-settings-editor"===e.mode}),{debugName:"isSiteSettingsLayoutEditorOpenStore"});var Nr=()=>n(770455),Or=()=>n(466970),Dr=()=>n(501168),Kr=()=>n(106342),qr=()=>n(853249),Fr=()=>n(297861);function zr(){const e=(0,v().O7)(),{isPhone:t,isTablet:n}=(0,v().Fy)(),o=(0,D().VK)((()=>(0,Cr().in)(e)),[e]),r=(0,Fr().Y)("supportsNativeHome"),a=(0,Or().E)("tablet_refresh_gate");return t||n&&!a?r?(0,p.jsx)(Nr().nP,{}):(0,p.jsx)(Kr().wT,{}):(0,p.jsx)(Wr,{isExpanded:o})}function Wr(e){let{isExpanded:t}=e;const n=(0,v().O7)(),r=n.device.isElectronMac,a=(0,D().VK)((()=>void 0!==C().k_(n).state),[n]),i=(0,D().VK)((()=>(0,Nn().Sr)(n)),[n]),s=(0,D().VK)((()=>(0,Dr().B)(n)),[n]),c=(0,o.useCallback)((()=>(0,p.jsx)(qr().Z,{skipFadeinDelay:!0})),[]),{isTablet:l}=(0,v().Fy)();return(0,p.jsx)(Kr().wU,{isElectronMac:r,isTablet:l,isExpanded:t,renderLoading:c,forceRenderLoading:!a&&!(i||s)})}const Hr=(0,Le().kF)(new(Le().Ss)("NotionBanners",(()=>Promise.all([n.e(62743),n.e(80317),n.e(59185)]).then(n.bind(n,991853)))),(e=>e.default)),$r=new(Le().Ss)("NotionModals",(()=>Promise.all([n.e(62743),n.e(52774),n.e(84885),n.e(90698),n.e(5242),n.e(90424),n.e(81580),n.e(84325),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(5006),n.e(75377),n.e(99590),n.e(69437),n.e(81063),n.e(88128),n.e(97934),n.e(91e3),n.e(18162),n.e(91752),n.e(80730),n.e(83962),n.e(21862),n.e(72646),n.e(74879),n.e(37239),n.e(22467),n.e(18534),n.e(77555),n.e(19592),n.e(54843),n.e(22337),n.e(46422)]).then(n.bind(n,674969)))),Gr=(0,Le().kF)($r,(e=>e.default));const Yr=function(e){let{routerState:t}=e;const r=(0,v().O7)();(0,o.useEffect)((()=>{var e;if(null!==(e=r.mobileNative)&&void 0!==e&&e.api.appComponentMountState)return r.mobileNative.api.appComponentMountState(!0),()=>{var e;null!==(e=r.mobileNative)&&void 0!==e&&e.api.appComponentMountState&&r.mobileNative.api.appComponentMountState(!1)}}),[r]);const{route:a}=t,i=(0,D().VK)((()=>Qe().default.state.mainEditorCurrentBlockStore),[]),s=(0,D().VK)((()=>n(658096).default.state.publicPageData),[]),{shouldShowSidebar:c,shouldShowFrame:l,shouldShowError:d,shouldRedirectFromHome:u}=(0,D().VK)((()=>C().h1(r)),[r]),m=(0,D().VK)((()=>"page"===a.name&&wr().default.state.open&&(0,Bn().S4)(wr().default.state.blockStore)),[a.name]),f=(0,kn().xU)(),g=(0,D().VK)((()=>{const{device:e}=r;return"chat"!==a.name&&("marketplace"!==a.name&&(!Zr.state&&(!Br.state&&(!f&&_r().KR.shouldShowAssistantInCorner(e)))))}),[r,a.name,f]),h=(0,D().VK)((()=>!r.device.isMobile&&!Zr.state),[r.device.isMobile]),b=(0,D().VK)((()=>{if(!r.currentUser.isLoggedIn())return!1;if(r.device.isMobile)return!1;const{mainEditorCurrentBlockStore:e,currentSpaceStore:t}=Qe().default.state;return!(!e||!t)&&(!(0,Bn().eV)(r,e)&&(!g&&(!Zr.state&&!Br.state)))}),[r,g]),S=(0,D().VK)((()=>_r().KR.isFullPageAssistantChatEnabled(r.device)),[r]),y=(0,D().VK)((()=>{const{device:e}=r;return!!e.isMobileNative&&("page"===a.name?_r().KR.isXMLAssistantEnabled():void 0)}),[r,a.name]),w=S&&"chat"===a.name,k=(0,D().VK)((()=>c&&!(0,Cr().Jr)(r)&&n(291335).sidebarOpenStore.state),[r,c]),x=(0,D().VK)((()=>(0,n(390952).u)(r)),[r]),I=(0,D().VK)((()=>(0,ln().GD)(void 0)),[]),_=(0,D().VK)((()=>Qe().default.state.renderPhase),[]),T=(0,D().VK)((()=>Ir().Z.state.isOpen&&"layout-editor"===Ir().Z.state.mode),[]);return function(){const e=["local","staging","development"].includes("production"),t=(0,v().O7)();(0,o.useEffect)((()=>{e&&((0,Pr().exposeDebugValue)("refreshTestClock",(async()=>{var e;const n=null===(e=Qe().default.state.currentSpaceStore)||void 0===e?void 0:e.id;if(n){const e=await jr(n,t);if(e){const t=Tr().ou.fromSeconds(e);console.log(`Test clock time is ${t.toString()} (${e} seconds)`)}}})),(0,Pr().exposeDebugValue)("advanceTestClock",(async e=>{var n;if(!e)throw new Error("advanceTestClock requires an argument. You can pass an epoch timestamp in seconds, a relative DurationLike object like { months: 2 }, or a function that takes the current epoch seconds and returns the new epoch seconds.");const o=null===(n=Qe().default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(!o)return;const r=await Er({environment:t,spaceId:o,advanceTestClockArgument:e});r&&await Ee().callApi({eventName:"stripeAdvanceTestClock",environment:t,data:{spaceId:o,epochSeconds:r}})})))}),[e,t])}(),(0,p.jsxs)(Je,{children:[c&&(0,p.jsx)(zr,{}),l&&(i||T||"team"===t.route.name)&&(0,p.jsx)(Vr,{routerState:t}),w&&"chat"===a.name&&!T&&(0,p.jsx)(qt().LazyAssistantFullPageChat,{}),"marketplace"===a.name&&(0,p.jsx)(xr,{}),"aiInferenceTranscript"===a.name&&(0,p.jsx)(Kt,{threadId:a.threadId,configType:a.configType,defaultUserMessage:a.defaultUserMessage}),c&&(0,p.jsx)(br,{}),m&&(0,p.jsx)(vr,{}),(d||u)&&!m&&"aiInferenceTranscript"!==t.route.name&&(0,p.jsx)(pt().I,{route:t.route,publicPageData:s,shouldRedirectFromHome:u}),k&&(0,p.jsx)(Qr,{}),(0,p.jsx)(Wt,{}),b&&(0,p.jsx)(n(174491).Z,{}),g&&(0,p.jsx)(qt().LazyAssistantMenuPopup,{}),r.device.isMobile&&(0,p.jsx)(sn().wI,{}),y&&(0,p.jsx)(qt().LazyMobileAssistantPendingOperationsCollapsedElement,{}),g&&(0,p.jsx)(qt().LazyAssistantOriginElement,{}),(0,p.jsx)(Jt,{}),I&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(n(169793).u7,{}),(0,p.jsx)(Ot().oF,{})]}),x&&(0,p.jsx)(Xt,{}),!r.device.isMobile&&"nativeTab"!==t.route.name&&(0,p.jsx)(fr,{}),"rendered"!==_||r.device.isMobile?null:(0,p.jsx)(n(604258).r2,{}),h&&i&&(0,p.jsx)(n(657174).$H,{currentBlockStore:i,isElectronMac:r.device.isElectronMac}),(0,p.jsx)(sn().AZ,{}),(0,p.jsx)(Hr,{}),(0,p.jsx)(Gr,{}),!1,(0,p.jsx)(Jr,{})]})};function Xr(){mn().close()}function Qr(){const e=(0,v().O7)(),t=(0,D().VK)((()=>function(e){return{position:"absolute",top:0,left:(0,Cr().qG)(e),right:0,bottom:0,zIndex:z().l6}}(e)),[e]);return(0,p.jsx)("div",{style:t,onClick:Xr})}function Jr(){const{currentSpaceStore:e,currentUserStore:t,renderPhase:n}=(0,D().VK)((()=>{const{currentSpaceStore:e,currentUserStore:t,renderPhase:n}=Qe().default.state;return{currentSpaceStore:e,currentUserStore:t,renderPhase:n}}),[]);return e&&t&&"rendered"===n?(0,p.jsx)(yr,{spaceStore:e,userStore:t},`${e.id}-${null==t?void 0:t.id}`):null}function ea(){const e=(0,v().O7)();(0,o.useEffect)((()=>{!S().default.isAdminMode&&e.currentUser.isLoggedIn()&&Qe().default.waitUntil((()=>{const t=Qe().default.state.currentUserSettingsStore,n=(null==t?void 0:t.isDefined())??!1;if(t&&n){const n=t.getSettings(),o=null==n?void 0:n.disable_auto_set_timezone;n&&!o&&Ce().wk({environment:e,userSettingsStore:t})}return n}))}),[e]),(0,o.useEffect)((()=>{function t(){const{RouterStore:t,currentUser:n}=e,o=n.id;we().Vz({historyId:t.state.id,currentUserId:o}),M().navigationReady(!1)}return window.addEventListener("beforeunload",t),()=>window.removeEventListener("beforeunload",t)}),[e]),(0,o.useEffect)((()=>{async function t(t){const{RouterStore:n}=e,o=window.location.href,r=t.state?t.state.currentUserId:void 0;let a=e;(0,St().L0)({environment:e}),r&&r!==e.currentUser.id&&(a=await _e().x({environment:a,newCurrentUserId:r}));const i=n.state.route,s=de().parseRoute({url:o,isMobile:a.device.isMobile,baseUrl:S().default.domainBaseUrl,publicDomainName:S().default.publicDomainName,protocol:S().default.protocol,currentUrl:window.location.href}),c="page"===i.name&&"page"===s.name&&i.blockId===s.blockId,l="onboarding"!==i.name&&"onboarding"===s.name;we().Vz({historyId:n.state.id,currentUserId:r}),await Ie().ep({environment:a,id:t.state&&t.state.id||(0,ge().ZP)(),action:"pop",href:o}),l&&!e.device.isMobileNative&&xe().c4({environment:a,url:ue()._j.root}),c&&xe().Oj(a)}return window.addEventListener("popstate",t),()=>window.removeEventListener("popstate",t)}),[e]),(0,P().K)((()=>{M().subscribeToProtocolUrl((t=>function(e,t){oa("string"==typeof e?e:e.url,!1,!1,t)}(t,e))),M().subscribeToSettingsMenuItem(na),M().navigationReady(!0),M().onNewWindow(((t,n)=>{xe().c4({environment:e,url:n,openInNew:"tab"})}))})),(0,o.useEffect)((()=>{e.mobileNative&&e.mobileNative.subscribeToOpenLink(((t,n,o)=>oa(t,n,o,e)))}),[e]);const t=(0,D().Kw)(e.RouterStore);(0,o.useEffect)((()=>{var e;"root"===t.route.name||"page"===t.route.name||"space"===t.route.name||"blank"===t.route.name&&0===(null===(e=t.historyState)||void 0===e?void 0:e.index)||(Se().setInitialRenderCompleted(),Qe().default.setState({...Qe().default.state,renderPhase:"rendered"}))}),[t]),(0,o.useEffect)((()=>{e.currentUser.isLoggedIn()||"page"===t.route.name||"space"===t.route.name||se().j({device:e.device,event:{facebook:{eventName:"PageView",data:{content_name:window.location.href}},google:{eventName:"pageView",path:window.location.pathname}},cookieService:e.cookieService})}),[e.cookieService,e.currentUser,e.device,t.route.name]),(0,o.useEffect)((()=>{const t=Qe().default.state.currentUserSettingsStore;e.currentUser.isLoggedIn()&&t&&Te().dM(e,t)}),[e]);const{device:r}=e;if(r.isNative&&de().lQ[t.route.name])return(0,p.jsx)($e,{});if("front"===t.route.name)return(0,p.jsx)(Ne,{preventFrontRedirect:t.route.alreadyRedirected});if("root"===t.route.name)return(0,p.jsx)(De,{route:t.route});if("nativeRedirect"===t.route.name||"nativeMailRedirect"===t.route.name||"nativeCalendarRedirect"===t.route.name)return(0,p.jsx)(Fe,{redirect:t.route.redirect,callbackType:"nativeMailRedirect"===t.route.name?"nativemailredirect":"nativeCalendarRedirect"===t.route.name?"nativecalendarredirect":"nativeredirect"});if("login"===t.route.name||"login/calendar"===t.route.name||"login/mail"===t.route.name)return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(yt().AuthSyncListener,{}),(0,p.jsx)(Ze().R7,{isSignup:!1,email:t.route.email,redirectURL:t.route.redirectURL})]});if("addAnotherAccount"===t.route.name)return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(yt().AuthSyncListener,{}),(0,p.jsx)(bt,{redirectURL:t.route.redirectURL})]});if("desktopEmailConfirm"===t.route.name)return(0,p.jsx)(Ae,{});if("teamsInvite"===t.route.name){const{teamId:n}=t.route;return be().uA(e,{teamId:n}),(0,p.jsx)(Ke().Z,{fetch:async()=>{const t=new(Ct().zX)(e,{table:pe().e0,id:n});await t.load()},render:()=>(0,p.jsx)(Nt,{teamId:n})})}if("signup"===t.route.name||"signup/calendar"===t.route.name||"signup/mail"===t.route.name)return(0,p.jsx)(Ze().R7,{isSignup:!0,email:t.route.email});if("unsubscribe"===t.route.name)return(0,p.jsx)(Me,{payload:t.route.payload});if("onboarding"===t.route.name)return(0,p.jsx)(lt,{});if("upcomingInvoice"===t.route.name)return(0,p.jsx)(st().A,{route:t.route});if("invoiceById"===t.route.name)return(0,p.jsx)(st().A,{route:t.route});if("settingsConsoleOrganization"===t.route.name){if(e.currentUser.isLoggedIn())return(0,p.jsx)(ut,{organizationId:t.route.organizationId,tabRoute:t.route.tabRoute,properties:t.route.properties,params:t.route.params});{const e=(0,fe().a5)({organizationId:t.route.organizationId,tabRoute:t.route.tabRoute,properties:t.route.properties,queryParams:t.route.params}),n=he().bf({url:`${S().default.domainBaseUrl}${ue()._j.login}`,query:{redirectURL:e}});return(0,p.jsx)(ta,{url:n})}}if(t.route.name,t.route.name,"admin"===t.route.name&&S().default.isAdminMode)return(0,p.jsx)(Ke().Z,{fetch:()=>Promise.all([n.e(62743),n.e(40782),n.e(91253),n.e(75377),n.e(41455),n.e(77654),n.e(46596),n.e(12328)]).then(n.bind(n,787721)),render:e=>{let{default:t}=e;return(0,p.jsx)(t,{})}});if("adminListData"===t.route.name){const{category:e}=t.route;if(S().default.isAdminMode)return(0,p.jsx)(Ke().Z,{fetch:()=>Promise.all([n.e(62743),n.e(40782),n.e(91253),n.e(75377),n.e(41455),n.e(77654),n.e(46596),n.e(12328)]).then(n.bind(n,743467)),render:t=>{let{default:n}=t;return(0,p.jsx)(n,{category:e})}})}if("adminSingleRecord"===t.route.name&&S().default.isAdminMode){const{id:e,table:o}=t.route;return(0,p.jsx)(Ke().Z,{fetch:()=>Promise.all([n.e(62743),n.e(40782),n.e(91253),n.e(75377),n.e(41455),n.e(77654),n.e(46596),n.e(33854)]).then(n.bind(n,201798)),render:t=>{let{default:n}=t;return(0,p.jsx)(n,{table:o,id:e})}})}if("oauthAuthorization"===t.route.name){const{responseType:e,redirectUri:o,integrationId:r,state:a,owner:i,userId:s,spaceId:c}=t.route;return(0,p.jsx)(Ke().Z,{fetch:()=>Promise.all([n.e(62743),n.e(52774),n.e(19592),n.e(49818),n.e(3370)]).then(n.bind(n,333890)),render:t=>{let{default:n}=t;return(0,p.jsx)(n,{responseType:e,redirectUri:o,integrationId:r,state:a,owner:i,userId:s,spaceId:c})}})}if("passkeyAuthVerify"===t.route.name){const{callbackType:e}=t.route;return(0,p.jsx)(Ke().Z,{fetch:()=>Promise.all([n.e(82544),n.e(72679)]).then(n.bind(n,187406)),render:t=>{let{VerifyPasskeyRedirectPage:n}=t;return(0,p.jsx)(n,{callbackType:e})}})}if("notionCalendarAuthorization"===t.route.name){const{csrf:e,calendarCsrf:o,redirectUri:r,spaceId:a,state:i}=t.route;return(0,p.jsx)(Ke().Z,{fetch:()=>n.e(7304).then(n.bind(n,29117)),render:t=>{let{default:n}=t;return(0,p.jsx)(n,{csrf:e,calendarCsrf:o,redirectUri:r,spaceId:a,state:i})}})}if("globalOauthPostLogin"===t.route.name){const{clientId:e,redirectUri:o,state:r,responseType:a,scope:i}=t.route;return(0,p.jsx)(Ke().Z,{fetch:()=>Promise.all([n.e(49818),n.e(14464)]).then(n.bind(n,859672)),render:t=>{let{default:n}=t;return(0,p.jsx)(n,{clientId:e,redirectUri:o,csrfState:r,responseType:a,scope:i})}})}if("passkeyRegistrationVerification"===t.route.name){const{callbackType:o,csrfToken:r,attemptId:a,options:i}=t.route;return(0,p.jsx)(Ke().Z,{fetch:()=>n.e(74528).then(n.bind(n,632759)),render:t=>{let{AddPasskeyRedirectPage:n}=t;return(0,p.jsx)(n,{environment:e,callbackType:o,csrfToken:r,attemptId:a,options:i})}})}if("initiateExternalAuthentication"===t.route.name){const{notion_user_id:e,notion_workspace_id:o,notion_last_visited_url:r,notion_authorization_code:a,external_object_instance_block_id:i,callback_type:s,integration_id:c,redirectToAuth:l}=t.route;return(0,p.jsx)(Ke().Z,{fetch:()=>n.e(91023).then(n.bind(n,848398)),render:t=>{let{default:n}=t;return(0,p.jsx)(n,{notion_user_id:e,notion_workspace_id:o,notion_last_visited_url:r,notion_authorization_code:a,external_object_instance_block_id:i,callback_type:s,integration_id:c,redirectToAuth:l})}})}if("initiateExternalAuthenticationFromDesktop"===t.route.name){const{redirectUri:o}=t.route;if(e.currentUser.isLoggedIn())return(0,p.jsx)(Ke().Z,{fetch:()=>n.e(73871).then(n.bind(n,777868)),render:e=>{let{default:t}=e;return(0,p.jsx)(t,{redirectUri:o})}});{const e=he().bf({url:`${S().default.domainBaseUrl}${ue()._j.initiateExternalAuthenticationFromDesktop}`,query:{redirectUri:o}}),t=he().bf({url:`${S().default.domainBaseUrl}${ue()._j.login}`,query:{redirectURL:e}});return me().hw(),(0,p.jsx)(ta,{url:t})}}if("myIntegrations"===t.route.name)return(0,p.jsx)(ta,{url:ue()._j.creatorProfileIntegrations});if("inAppTemplateSubmission"===t.route.name)return(0,p.jsx)(ta,{url:ue()._j.creatorProfileTemplates});if("inAppTemplateCreatorSubmission"===t.route.name)return(0,p.jsx)(ta,{url:ue()._j.creatorProfile});if("creatorProfile"===t.route.name||"creatorProfileTemplates"===t.route.name||"creatorProfileIntegrations"===t.route.name||"creatorProfileAnalytics"===t.route.name||"creatorProfileCoupons"===t.route.name){if(e.currentUser.isLoggedIn())return"pointer"in t.route?(0,p.jsx)(rt,{publish:!!t.route.publish,lab:!!t.route.lab,botOrIntegrationPointer:t.route.pointer}):(0,p.jsx)(rt,{publish:!1,lab:!1,botOrIntegrationPointer:void 0});{const e=he().bf({url:`${ue()._j[t.route.name]}`}),n=he().bf({url:`${S().default.domainBaseUrl}${ue()._j.login}`,query:{redirectURL:e}});return(0,p.jsx)(ta,{url:n})}}if("localizedTemplates"===t.route.name){if(e.currentUser.isLoggedIn())return(0,p.jsx)(vt,{});{const e=he().bf({url:`${ue()._j[t.route.name]}`}),n=he().bf({url:`${S().default.domainBaseUrl}${ue()._j.login}`,query:{redirectURL:e}});return(0,p.jsx)(ta,{url:n})}}if("studentGroupSignup"===t.route.name)return(0,p.jsx)(Tt,{});if("startupsApplication"===t.route.name)return(0,p.jsx)(kt,{formType:"startups"});if("smbsApplication"===t.route.name)return(0,p.jsx)(kt,{formType:"smb"});if("lennyApplication"===t.route.name)return(0,p.jsx)(It,{});if("githubStudentPackHome"===t.route.name)return(0,p.jsx)(ft,{});if("notFound"===t.route.name)return(0,p.jsx)(pt().I,{route:t.route,publicPageData:void 0});if("blank"===t.route.name)return(0,p.jsx)(it,{});if("modal"===t.route.name&&!e.currentUser.isLoggedIn()&&(t.route.templateGalleryItem||t.route.projectManagementLaunch)){const e={};return t.route.projectManagementLaunch?e.tg="gallery":t.route.templateGalleryItem&&(e.tg=t.route.templateGalleryItem),(0,p.jsx)(ta,{url:ue()._j.login,queryParams:e})}if("chat"===t.route.name&&!e.currentUser.isLoggedIn()){const e=(0,ce().u3)(t.route),n=(0,he().bf)({url:`${S().default.domainBaseUrl}${ue()._j.login}`,query:{redirectURL:e}});return(0,p.jsx)(ta,{url:n})}if("marketplace"===t.route.name&&!e.currentUser.isLoggedIn()){const e=(0,le().No)(S().default,t.route),n=(0,he().bf)({url:`${S().default.domainBaseUrl}${ue()._j.login}`,query:{redirectURL:e}});return(0,p.jsx)(ta,{url:n})}return"quickSearch"===t.route.name?(0,p.jsx)(nt,{}):"page"===t.route.name||"space"===t.route.name||"nativeTab"===t.route.name||"modal"===t.route.name||"chat"===t.route.name||"aiInferenceTranscript"===t.route.name||"marketplace"===t.route.name||"team"===t.route.name?(0,p.jsx)(Yr,{routerState:t}):(0,p.jsx)(Pe().Z,{})}function ta(e){let{url:t,queryParams:n}=e;const r=(0,v().O7)(),a=(0,o.useRef)(!1);return(0,o.useEffect)((()=>{a.current||(a.current=!0,n&&ke().j({currentUserId:void 0,params:n}),xe().c4({environment:r,url:t,redirect:!0}))}),[r,n,t]),(0,p.jsx)(Pe().Z,{})}function na(e){ye().r$({currentTab:e})}function oa(e,t,n,o){const{RouterStore:r}=o,a=ve().RD({url:e,protocol:S().default.protocol,baseUrl:S().default.domainBaseUrl}),i=ve().u5({schemeUrl:a,baseUrl:S().default.domainBaseUrl}),s=de().parseRoute({url:i,baseUrl:S().default.domainBaseUrl,publicDomainName:S().default.publicDomainName,isMobile:o.device.isMobile,protocol:S().default.protocol,currentUrl:window.location.href});(o.device.isAndroid||t)&&we().Hu({RouterStore:r,currentUserId:o.currentUser.id}),o.mobileNative&&o.mobileNative.closeInAppBrowser(),"googleAuthCallback"!==s.name&&"samlAuthCallback"!==s.name&&"passkeyAuthCallback"!==s.name?xe().c4({environment:o,url:i,redirect:t,updateMobileTabbedRouterArgs:{clearNativeRootPageOverride:n},queryId:"page"===s.name?s.queryId:void 0}):xe().c4({environment:o,url:i})}const ra=!1;function aa(e){let{environment:t,onMount:n}=e;const l=(0,o.useRef)(!1);(0,o.useEffect)((()=>{l.current||(l.current=!0,null==n||n())}),[n]),(0,o.useEffect)((()=>{C().rq()}),[]);const d="system"===window.notionTheme?c().vn(t):window.notionTheme,u=ra?o.StrictMode:o.Fragment;return(0,p.jsx)(u,{children:(0,p.jsx)(r().B,{value:t,children:(0,p.jsxs)(a().z,{value:{mode:d},children:[(0,p.jsx)(s().Pj,{defaultLocale:"en-US",locale:i().locale,messages:i().s,children:(0,p.jsx)(m,{...f(t.device),children:(0,p.jsx)(I().T,{fallback:e=>{let{errorId:t}=e;return(0,p.jsx)(Z,{errorId:t})},from:"Router",type:"AppCrash",children:(0,p.jsxs)(x,{id:"app",targetRenderPhase:"mount",children:[(0,p.jsx)(ie().Z,{}),(0,p.jsx)(ae,{children:(0,p.jsx)(ea,{})})]})})})}),(0,p.jsx)(T,{})]})})})}},444851:(e,t,n)=>{n.d(t,{En:()=>o,IX:()=>i,Ky:()=>c,_e:()=>s,aH:()=>d,bd:()=>u,fT:()=>l,n4:()=>m,rb:()=>a,tD:()=>r,vi:()=>f,yx:()=>p});const o=8,r=10,a=8,i=24,s=6,c=1.5,l=(i-c)/2,d=i+s,u=`calc(100% + ${a+(o-s)-d}px)`,p=i+8,m=-16;function f(e){return"margin_comments"===e?12:"comment_unfurl"===e?14:16}},685375:(e,t,n)=>{n.d(t,{Z:()=>k});n(267602),n(470928),n(228244);var o=n(667294),r=()=>n(219727),a=()=>n(523709),i=()=>n(491927),s=()=>n(959137),c=()=>n(964433),l=()=>n(542058),d=()=>n(141735),u=()=>n(267629),p=()=>n(465371),m=()=>n(677559),f=()=>n(32969),g=()=>n(340819),v=()=>n(749826),h=()=>n(475335),b=()=>n(645805),S=()=>n(965903),y=()=>n(65344),w=n(785893);function k(e){const t=(0,r().O7)(),{value:n}=(0,m().XJ)(c().p),{value:i}=(0,m().XJ)(l().m),{value:u}=(0,m().XJ)(d().F.formulas),{value:p}=(0,m().XJ)(s().F.clipboardActions),f=(0,o.useRef)(),g=(0,o.useRef)();(0,o.useEffect)((()=>{function e(e){e.clientX===f.current&&e.clientY===g.current||(f.current=e.clientX,g.current=e.clientY,h().default.setKeyboardMode(!1))}return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}}),[]);const v=(0,o.useMemo)((()=>function(e,t,n,o,r){const i={};for(const s of a().L6)for(const a of s.shortcuts)i[a]=i=>I(a,i,e,t,n,o,r);return i}(p,u,n,i,t)),[t,u,n,i,p]);return(0,w.jsx)(y().t,{debugName:e.debugName,priority:e.priority,enable:e.capture,shortcuts:v})}function x(){return!function(){const e=document.querySelector("#intercom-container");return!(!e||!e.contains(document.activeElement))}()&&!(g().Z.state.isActive&&!v().default.checkGate({gateName:"block_menu_shortcut_fix"}))}function I(e,t,n,o,r,s,c){if(!x())return;const l=S().default.state.stores,d=S().default.state.pivot||l[0],m=d&&f().C.getRectFromStore(d),y=a().L6.find((t=>!!t.shortcuts.some((t=>t===e))&&u().vG(t,{environment:c,blocks:l,originRect:m,publicEditMode:void 0})));if(y){"keydown"===t.type&&t.preventDefault&&t.preventDefault();const e=g().Z.state.isActive;y.action({environment:c,blocks:l,originRect:m,publicEditMode:void 0,lazyDependencies:{clipboardActions:n,formulasModule:o,markdownLinkifyIt:r,tinyMceMicrosoftWordPasteFilter:s}},t);const a=l[0];let d,u,f,S;var w;if(a)d=a.getType(),u=d?(0,p()._A)(d,a.getFormat()):void 0,f=null===(w=a.getCollectionStore())||void 0===w?void 0:w.id,S=a.getParentCollectionIdUpToTwoLevels();i().dh(c,{analyticsName:y.analyticsName,action_type:y.analyticsActionType,from:"keyboard_shortcut",block_id:null==a?void 0:a.id,block_type:d,is_toggleable:u,collection_id:f,parent_collection_id:S}),k={resetBlockMenuStore:e},h().default.setKeyboardMode(!0),b().default.reset(),v().default.checkGate({gateName:"block_menu_shortcut_fix"})&&k.resetBlockMenuStore&&g().Z.reset()}var k}},985338:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(667294),r=()=>n(142735),a=()=>n(557576),i=n(785893);const s=function(e){const t=(0,n(219727).Fy)(),s=(0,r().VK)((()=>({initiator:n(158083).Z.state.initiator,isDragging:n(960562).default.state.isDragging})),[]),c=(0,r().VK)((()=>a().default.state.isActive),[]),l=(0,r().VK)((()=>!!a().default.state.isActive&&a().default.state.moved?"default":s.isDragging?"-webkit-grabbing":"text"),[s.isDragging]),d=(0,o.useMemo)((()=>{let e="notion-cursor-listener";return"-webkit-grabbing"===l&&(e+=" notion-disable-local-cursor"),e}),[l]);return(0,o.useEffect)((()=>{t.isIOS&&("touch"===s.initiator||s.isDragging||c?document.body.classList.add("notion-disable-webkit-user-select"):document.body.classList.remove("notion-disable-webkit-user-select"))}),[t.isIOS,s.initiator,s.isDragging,c]),(0,i.jsx)("div",{style:{...e.style,cursor:l},className:d,children:e.children})}},123256:(e,t,n)=>{n.d(t,{Z:()=>_});var o=n(667294),r=()=>n(219727),a=()=>n(142735),i=()=>n(846550),s=()=>n(492522),c=()=>n(788860),l=()=>n(696459),d=()=>n(82937),u=()=>n(879952),p=()=>n(942226),m=()=>n(505462),f=()=>n(815532),g=()=>n(123145),v=()=>n(690664),h=()=>n(105649),b=()=>n(793935),S=()=>n(589525),y=()=>n(291335),w=()=>n(590972),k=()=>n(998901),x=()=>n(482162),I=()=>n(64260),C=n(785893);const _=function(e){let{type:t}=e;const i=(0,r().O7)(),c=(0,a().qz)(void 0,n(233417).Z),p=(0,o.useRef)(!1),h=(0,o.useCallback)((()=>function(e,t){t.setState({...t.state,mousePressed:!1}),T({isResizing:!1},e)}(t,c)),[t,c]),I=(0,o.useCallback)((()=>function(e,t,n,o){if(!o.current){switch(t){case"page":b().setExpand({environment:e,isExpanded:!y().sidebarExpandedStore.state,from:"sidebar_resizer",saveDetailsSidebarPreference:!0}),y().sidebarOpenStore.setState(!1);break;case"update":b().setUpdateExpand({environment:e,isExpanded:!(0,S().Sx)(e),from:"drag",saveDetailsSidebarPreference:!0});break;case"peek":d().xv({environment:e,from:"resizer_click"});break;case"secondary_sidebar":f().TN({environment:e});break;default:(0,l().t1)(t)}n.setState({...n.state,mouseEntered:!1})}n.setState({...n.state,mousePressed:!1}),T({isResizing:!1},t)}(i,t,c,p)),[i,t,c]),_=(0,o.useCallback)((e=>function(e,t,n,o){switch(m().clear(t),o.current=!0,n){case"page":b().setWidth({width:P(e.currentX,n,t),environment:t});break;case"update":b().setUpdateWidth({width:P(e.currentX,n,t),environment:t});break;case"peek":b().setPeekWidth({width:P(e.currentX,n,t),environment:t});break;case"secondary_sidebar":v().default.setWidth(P(e.currentX,n,t));break;default:(0,l().t1)(n)}}(e,i,t,p)),[i,t]),U=(0,o.useCallback)((()=>function(e,t,n,o){u().ZH({environment:e}),n.setState({...n.state,mousePressed:!0}),o.current=!1,T({...y().sidebarResizingStore.state,isResizing:!0},t)}(i,t,c,p)),[i,t,c]),{device:M}=i,L=(0,a().VK)((()=>function(e){const t=function(e){switch(e){case"page":return y().sidebarWidthStore.state;case"secondary_sidebar":const t=y().sidebarExpandedStore.state,n=g().l_();return t?y().sidebarWidthStore.state+n:n;case"update":return w().default.state.width;case"peek":return x().default.state.preferredSidePeekWidth;default:(0,l().t1)(e)}}(e);switch(e){case"page":case"secondary_sidebar":return t;case"peek":case"update":return window.innerWidth-t;default:(0,l().t1)(e)}}(t)),[t]),R=(0,a().Kw)(y().sidebarMouseEnterYStore),A=(0,a().Kw)(n(197666).Z),V=(0,a().VK)((()=>function(e){return{cursor:"col-resize",height:"100%",width:12,marginLeft:"update"===e?-w().default.state.width:-6}}(t)),[t]),Z=(0,a().VK)((()=>function(e,t){const n=(0,S().in)(t);return{position:"absolute",left:"peek"===e?0:void 0,right:"peek"!==e?0:void 0,width:0,flexGrow:0,zIndex:"peek"===e?s().YO:1,top:n?0:-1,bottom:n?0:-1,pointerEvents:"auto"}}(t,i)),[t,i]);return A||M.isChromebook?null:(0,C.jsx)(n(654133).Z,{renderTooltip:()=>(0,C.jsx)(j,{type:t}),originRect:new DOMRect(L,R,0,0),delayThreshold:0,placement:"page"===t||"secondary_sidebar"===t?k().Placement.Right:k().Placement.Left,originGap:10,render:e=>(0,C.jsx)("div",{style:Z,...(0,n(164079).Z)(e,{onMouseMove:()=>function(e){T({isResizerHovered:!0},e)}(t),onMouseLeave:()=>function(e){T({isResizerHovered:!1},e)}(t),onMouseEnter:E}),children:(0,C.jsx)(n(790964).Z,{onDraggableDragStart:U,onDraggableDragMove:_,onDraggableDragEnd:I,onDraggableDragCancel:h,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,render:e=>(0,C.jsx)("div",{style:V,...e})})})})};function T(e,t){switch(t){case"page":y().sidebarResizingStore.update((t=>({...t,...e})));break;case"update":w().default.update((t=>({...t,...e})));break;case"secondary_sidebar":h().default.update((t=>({...t,...e})));break;case"peek":break;default:(0,l().t1)(t)}}function P(e,t,n){let o;switch(t){case"page":o=e;break;case"secondary_sidebar":o=e-(y().sidebarExpandedStore.state?y().sidebarWidthStore.state:0);break;case"peek":case"update":o=window.innerWidth-e;break;default:(0,l().t1)(t)}const r=function(e){const t=window.innerWidth;switch(e){case"page":return 480;case"update":return Math.min(t/2,S().Nc);case"peek":return(0,p().my)();case"secondary_sidebar":return v().o;default:(0,l().t1)(e)}}(t),a=function(e,t){switch(e){case"page":return y().SIDEBAR_MIN_WIDTH;case"update":return w().AO;case"peek":return x().SIDEPEEK_MIN_WIDTH;case"secondary_sidebar":return v().u;default:(0,l().t1)(e)}}(t);return o>r?r:o<a?a:o}function j(e){let{type:t}=e;const n=(0,i().Fg)(),o=(0,r().O7)(),s=(0,a().VK)((()=>function(e,t){switch(e){case"page":return(0,S().in)(t);case"update":return(0,S().Sx)(t);case"peek":return x().default.state.open;case"secondary_sidebar":return h().default.isOpen();default:(0,l().t1)(e)}}(t,o)),[t,o]),d=n.mediumInvertedTextColor,u=(0,C.jsx)(I().Z,{name:"toggleSidebar"}),p="secondary_sidebar"===t||"update"===t?(0,C.jsx)(c()._H,{defaultMessage:"Close <invertedcolor>Click</invertedcolor>",id:"sidebarResizer.tooltip.closeMessage.noShortcut",values:{invertedcolor:e=>(0,C.jsx)("span",{style:{color:d},children:e}),keyboardShortcut:u}}):(0,C.jsx)(c()._H,{defaultMessage:"Close <invertedcolor>Click or {keyboardShortcut}</invertedcolor>",id:"sidebarResizer.tooltip.closeMessage",values:{invertedcolor:e=>(0,C.jsx)("span",{style:{color:d},children:e}),keyboardShortcut:u}});return(0,C.jsxs)(C.Fragment,{children:[s?p:(0,C.jsx)(c()._H,{defaultMessage:"Lock open <invertedcolor>Click or {keyboardShortcut}</invertedcolor>",id:"sidebarResizer.tooltip.lockMessage",values:{invertedcolor:e=>(0,C.jsx)("span",{style:{color:d},children:e}),keyboardShortcut:u}}),(0,C.jsx)("br",{}),(0,C.jsx)(c()._H,{defaultMessage:"Resize <invertedcolor>Drag</invertedcolor>",id:"sidebarResizer.tooltip.resizeMessage",values:{invertedcolor:e=>(0,C.jsx)("span",{style:{color:d},children:e}),keyboardShortcut:u}})]})}function E(e){y().sidebarMouseEnterYStore.setState(e.clientY)}},174491:(e,t,n)=>{n.d(t,{Z:()=>E});var o=n(667294),r=()=>n(219727),a=()=>n(474788),i=()=>n(142735),s=()=>n(846550),c=()=>n(456681),l=()=>n(492522),d=()=>n(788860),u=()=>n(146947),p=()=>n(799891),m=()=>n(814422),f=()=>n(306743),g=()=>n(594546),v=()=>n(177189),h=()=>n(43519);var b=()=>n(247724),S=()=>n(164079),y=()=>n(890881),w=()=>n(406012),k=()=>n(541589),x=()=>n(154186),I=()=>n(448419),C=()=>n(654133),_=()=>n(945634),T=n(785893);const P="?";function j(e){const t=(0,r().O7)(),{isMobile:n}=t.device,u=(0,d().YB)(),p=(0,i().VK)((()=>y().Z.state.open),[]),m={...(0,k().r)({environment:t,rightEdgeDistance:16,isInPeekRenderer:!1}),zIndex:l().hT},f=(0,s().yK)((e=>({helpIcon:{fill:e.mediumIconColor,width:16,height:16},hoveredStyle:{background:e.whiteButtonHoveredBackground},pressedStyle:{background:e.whiteButtonPressedBackground}})),[]),g=(0,o.useCallback)((e=>{const t=e.target;t instanceof HTMLElement&&(0,a().E)(t)&&w().Z.setState(!0)}),[]),v=(0,o.useCallback)((()=>{w().Z.setState(!1)}),[]);if(n)return(0,T.jsx)(x().Z,{hovered:p,testId:b().lmr,mobileFeedback:n,...e,children:(0,T.jsx)(_().Z,{left:(0,c().m)(f.helpIcon),disableMobileBorder:!0,children:(0,T.jsx)(d()._H,{defaultMessage:"Help & support",id:"helpButton.mobileHelpSupportButton.label"})})});const h=u.formatMessage({defaultMessage:"Help, feedback, and keyboard shortcuts",id:"helpButton.desktopHelpButton.ariaLabel"}),I=(0,S().Z)(e,{onFocus:g,onBlur:v});return(0,T.jsx)(C().Z,{renderTooltip:()=>(0,T.jsx)("span",{children:(0,T.jsx)(d()._H,{defaultMessage:"Help, feedback, and {br}keyboard shortcuts",id:"helpButton.desktopHelpButton.tooltip",values:{br:(0,T.jsx)("br",{})}})}),render:e=>(0,T.jsx)(x().Z,{ariaLabel:h,className:b().lmr,testId:b().lmr,style:m,hoveredStyle:f.hoveredStyle,pressedStyle:f.pressedStyle,...(0,S().Z)(I,e),children:P})})}const E=function(){const e=(0,r().O7)(),{isMobile:t}=e.device,a=(0,i().VK)((()=>{var t;return(null===(t=e.mobileNative)||void 0===t?void 0:t.supportsNativeHomeOnPhone())||!1}),[e]),s=(0,o.useCallback)((()=>{n(407391).Ar(e,{from:"corner"}),async function(e){const t=h().default.state;if((0,g().Ug)()&&t.isZendeskEnabled){const{userHighestPlanType:n,isSalesAssistedPlan:o}=(0,v().rf)(e),r=await f().aw({environment:e,isSalesAssistedPlan:o});m().j({type:"decagon",locale:u().locale,analyticsSettings:t,decagonInitializeArgs:r,onError:e=>{p().log({level:"error",from:"decagonHelpers",type:"initializeDecagon",error:{message:e.message}})},userHighestPlanType:n,isSalesAssistedPlan:o,cookieService:e.cookieService})}}(e)}),[e]);return(0,T.jsx)(I().ZP,{popupType:t?I().Z4.SlideUp:I().Z4.Popup,hidesMobileNativeBottomBar:a,preventSlideUpTransition:a,renderOrigin:e=>(0,T.jsx)(j,{...e}),originGap:t?0:12,placementToOrigin:t?I().pO.Right:I().pO.Top,alignmentToOrigin:t?I().vR.Center:I().vR.End,buttonPopupStore:y().Z,onClick:s,render:()=>(0,T.jsx)(n(302485).F,{})})}},929465:(e,t,n)=>{n.d(t,{T:()=>a});var o=()=>n(677559);const r=new(o().Ss)("AppComponents",(async()=>Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(39938),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(94556),n.e(78701),n.e(38804),n.e(17100),n.e(4387),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(71641),n.e(23006),n.e(72646),n.e(10553),n.e(74879),n.e(67601),n.e(37239),n.e(40692),n.e(20683),n.e(22467),n.e(27039),n.e(97083),n.e(52065),n.e(18534),n.e(39179),n.e(77555),n.e(38632),n.e(78856),n.e(19592),n.e(47559),n.e(22371),n.e(73230),n.e(25911),n.e(54843),n.e(76540),n.e(22337),n.e(93536),n.e(53936),n.e(23721),n.e(32175),n.e(66283),n.e(22154),n.e(58586)]).then(n.bind(n,676667)))),a=(0,o().kF)(r,(e=>e.AppComponents))},449866:(e,t,n)=>{n.d(t,{A:()=>a});var o=()=>n(677559);const r=new(o().Ss)("invoice",(async()=>await n.e(15149).then(n.bind(n,959320)))),a=(0,o().kF)(r,(e=>e.Invoice))},448755:(e,t,n)=>{n.d(t,{I:()=>a});var o=()=>n(677559);const r=new(o().Ss)("PageError",(async()=>Promise.all([n.e(62743),n.e(37358),n.e(25350),n.e(81063),n.e(18216),n.e(72646),n.e(86595),n.e(82544),n.e(62949),n.e(43468),n.e(66942)]).then(n.bind(n,306881)))),a=(0,o().kF)(r,(e=>e.PageError))},447317:(e,t,n)=>{n.d(t,{y:()=>a});var o=()=>n(677559);const r=new(o().Ss)("SearchModal",(async()=>Promise.all([n.e(62743),n.e(52774),n.e(44832),n.e(84885),n.e(90698),n.e(37358),n.e(7312),n.e(5242),n.e(31189),n.e(90424),n.e(69343),n.e(81580),n.e(84325),n.e(2933),n.e(11189),n.e(53329),n.e(71896),n.e(72586),n.e(53335),n.e(46616),n.e(54940),n.e(20224),n.e(46546),n.e(98721),n.e(50471),n.e(49498),n.e(2971),n.e(20634),n.e(91253),n.e(63707),n.e(61171),n.e(4014),n.e(63502),n.e(7678),n.e(5006),n.e(20919),n.e(75377),n.e(99590),n.e(52435),n.e(69437),n.e(81063),n.e(75066),n.e(81917),n.e(88128),n.e(97934),n.e(37317),n.e(91e3),n.e(18162),n.e(91752),n.e(78517),n.e(99537),n.e(80730),n.e(11770),n.e(83962),n.e(62084),n.e(79289),n.e(21862),n.e(41589),n.e(45741)]).then(n.bind(n,390960)))),a=(0,o().kF)(r,(e=>e.Search))},562219:(e,t,n)=>{n.d(t,{J:()=>a});var o=()=>n(677559);const r=new(o().Ss)("UpdateSidebarTabInfo",(async()=>await Promise.all([n.e(39938),n.e(18216),n.e(23006),n.e(60895)]).then(n.bind(n,931656)))),a=(0,o().kF)(r,(e=>e.UpdateSidebarTabInfo))},952864:(e,t,n)=>{n.r(t),n.d(t,{getCloseConfirmationDialogReason:()=>d,getUserControlledCloseConfirmationDialogReason:()=>l,setupOnBeforeUnload:()=>p,showConfirmationDialogEventEmitter:()=>s});n(821057);var o=()=>n(696459),r=()=>n(95718),a=()=>n(109083),i=()=>n(338855);const s=new(n(444263).Z);let c;function l(){const e=d();switch(e){case"have_local_draft_unsaved_changes":return e;case void 0:case"transaction_queue_has_tasks":case"uploading_files":case"generating_ai_completions":case"have_pending_ai_edits":case"have_pending_synced_collection_changes":return}(0,o().t1)(e)}function d(){if(!c)throw new Error("beforeUnloadHelpers.setupOnBeforeUnload() was not called!");return c()}const u="Changes you made may not be saved. Are you sure you want to quit?";function p(e){const{TransactionQueue:t,device:n,AppUpdateStore:o,GlobalFileUploadStore:l}=e;c=function(){return!t.hasTasks()||n.isMobileNative||n.isElectron||o.isMajorUpdate()?(0,r().D)()?"have_pending_ai_edits":a().Z.doesAnyCacheHaveUnsavedChanges()?"have_local_draft_unsaved_changes":l.isUploading()?"uploading_files":(0,i().SN)()?"have_pending_synced_collection_changes":void 0:"transaction_queue_has_tasks"},window.onbeforeunload=function(){const e=d();if(e)return s.emit(e),u}}},337314:(e,t,n)=>{n.d(t,{setupTransactionLoadGenerator:()=>c});var o=()=>n(947115),r=()=>n(970105),a=()=>n(269299),i=()=>n(876822),s=()=>n(127519);function c(e){(0,o().exposeDebugValue)("generateTransactionLoad",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const c=i().default.state.mainEditorCurrentBlockStore;if(!c)return void console.info("Cannot generateTransactionLoad: No current block");const l=c.getTitleStore();if(!l)return void console.info("Cannot generateTransactionLoad: block has no title");if("editing"!==s().default.state.mode)return void console.info("not editing anything. Click the page title.");const d=t=>{a().createAndCommit({userAction:"generateTransactionLoad.createTransaction",environment:e,canUndo:!0,perform:o=>{console.info("createAndCommit #",t);for(let a=0;a<n;a++){const n=`This is transaction #${t+1}, op ${a+1}, of load started at ${u}`;r().aS({environment:e,editorMode:"default",store:l,newValue:n,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:o})}}})},u=new Date;if(0===o)for(let e=0;e<t;e++)d(e);else{let e=0;const n=setInterval((()=>{e<t?(d(e),e++):clearInterval(n)}),o)}}))}},552308:(e,t,n)=>{n.r(t),n.d(t,{initialize:()=>s});var o=()=>n(799891),r=()=>n(205228),a=()=>n(749826),i=()=>n(506348);function s(e){"object"==typeof r().default&&r().default.version&&(o().clientLogglyEnvironmentData.version=r().default.version);const{device:t,currentUser:n}=e;t.isMobileNative&&(o().clientLogglyEnvironmentData.isMobileNative=!0),t.isMobile&&(o().clientLogglyEnvironmentData.isMobile=!0),t.isAndroid&&(o().clientLogglyEnvironmentData.isAndroid=!0),t.isIOS&&(o().clientLogglyEnvironmentData.isIOS=!0),t.isElectron&&(o().clientLogglyEnvironmentData.isElectron=!0),t.isChromeExtension&&(o().clientLogglyEnvironmentData.isChromeExtension=!0),o().clientLogglyEnvironmentData.os=t.os,o().clientLogglyEnvironmentData.platform=t.platform,window.navigator.userAgent&&(o().clientLogglyEnvironmentData.userAgent=window.navigator.userAgent),document.referrer&&(o().clientLogglyEnvironmentData.referrer=document.referrer),n.id&&(o().clientLogglyEnvironmentData.userId=n.id),o().clientLogglyEnvironmentData.is_experimental_build="clientExperimental"===r().default.buildTarget,o().clientLogglyEnvironmentData.experiments=a().default.getUsedNonControlExperimentsMap(),a().default.addListener((()=>{o().clientLogglyEnvironmentData.experiments=a().default.getUsedNonControlExperimentsMap()})),(0,i().sK)().then((e=>{e&&(o().clientLogglyEnvironmentData.storageUsageEstimate=e.usage,o().clientLogglyEnvironmentData.storageQuotaEstimate=e.quota)}))}},604258:(e,t,n)=>{n.d(t,{r2:()=>a,s:()=>i});var o=()=>n(677559);const r={Toaster:new(o().Ss)("Toaster",(()=>Promise.all([n.e(8074),n.e(33705)]).then(n.bind(n,408074)))),PerfmarkTrialIneligibleToast:new(o().Ss)("PerfmarkTrialIneligibleToast",(()=>n.e(99724).then(n.bind(n,632179))))},a=(0,o().kF)(r.Toaster,(e=>e.Toaster)),i=(0,o().kF)(r.PerfmarkTrialIneligibleToast,(e=>e.PerfmarkTrialIneligibleToast))},215689:(e,t,n)=>{n.r(t),n.d(t,{mainApp:()=>o});n(821057);async function o(e){const{minimalEnvironment:t,mainStartTime:o,prefetchInitiatedTime:r,prefetchCache:a,initializeStatsigResult:i,currentUserId:s}=e,{device:c}=t,[{setupOnBeforeUnload:l},d,{createClientEnvironment:u},{setupTransactionQueue:p},{default:m},f]=await Promise.all([Promise.resolve().then(n.bind(n,952864)),Promise.resolve().then(n.bind(n,799891)),Promise.resolve().then(n.bind(n,222578)),Promise.resolve().then(n.bind(n,148882)),Promise.resolve().then(n.bind(n,920991)),Promise.resolve().then(n.bind(n,278589))]);let g=await u({minimalEnvironment:t,prefetchCache:a,currentUserId:s});const{ElectronSqlite:v}=g;f.setupRecordCacheDebugging(c);const h=await p(g);l({device:c,TransactionQueue:h,AppUpdateStore:g.AppUpdateStore,GlobalFileUploadStore:m});const[b,{default:S}]=await Promise.all([Promise.resolve().then(n.bind(n,552308)),Promise.resolve().then(n.bind(n,620218))]);if(b.initialize(g),c.isMobileNative){const e=S.DO_NOT_USE_markLegacy("mobilenative.initialize_from_js"),[t,o,r]=await Promise.all([Promise.resolve().then(n.bind(n,279762)),Promise.resolve().then(n.bind(n,265903)),Promise.resolve().then(n.bind(n,148149))]);await t.initializeMobileNativeApp(g),Object.assign(d.clientLogglyEnvironmentData,o.getMobileNativeDeviceInfo(),r.getMobileNativeSessionInfo()),S.DO_NOT_USE_measureLegacy(e,{environment:g,data:{}})}if(c.isElectron){const e=S.mark("desktop.initialize_from_js"),t=await Promise.resolve().then(n.bind(n,231077));await t.initializeElectron({device:c,electronSqlite:v});const o=await Promise.resolve().then(n.bind(n,892306)),r=await o.getDesktopDeviceInfo();Object.assign(d.clientLogglyEnvironmentData,r,{desktopVersion:c.desktopAppVersion}),S.measure(e,{environment:g})}const[y,w,k,x,I,C]=await Promise.all([Promise.resolve().then(n.bind(n,341691)),Promise.resolve().then(n.bind(n,793935)),Promise.resolve().then(n.bind(n,505462)),Promise.resolve().then(n.bind(n,586730)),Promise.resolve().then(n.bind(n,269299)),Promise.resolve().then(n.bind(n,474602))]),{setupTransactionLoadGenerator:_}=await Promise.resolve().then(n.bind(n,337314));_(g),g.currentUser.id&&g.defaultRecordCache.persistedRecordCache&&C.readAndCacheOfflinePagesMemo({userId:g.currentUser.id,persistedRecordCache:g.defaultRecordCache.persistedRecordCache});const[{default:T},P,j,E,{CurrentUser:U},{getGhostAdminUserId:M},{default:L}]=await Promise.all([Promise.resolve().then(n.bind(n,850675)),Promise.resolve().then(n.t.bind(n,667294,19)),Promise.resolve().then(n.t.bind(n,973935,19)),Promise.resolve().then(n.t.bind(n,620745,19)),Promise.resolve().then(n.bind(n,388322)),Promise.resolve().then(n.bind(n,274879)),Promise.resolve().then(n.bind(n,749826))]);k.startListeners(c),g=await y.initialize(g),g.updateCurrentUserId=async e=>{const t=await M(g),n={...e.environment,currentUser:new U({id:e.currentUserId,loggedInUserIds:e.userIds,adminUserId:t})};await X(n),n.idCreator.updateCurrentUserId(e.currentUserId)},x.initialize(g),h.startLoop();const[{maybeClearCookies:R,refreshNotionCookies:A,validateHasPermissionArgs:V,clearNotionCookiesWithNoPermission:Z,clearThirdPartyCookiesAndLocalStorageWithNoPermission:B},{clearNotionLocalStorageWithNoPermission:N},O,D,K,q,{default:F},z]=await Promise.all([Promise.resolve().then(n.bind(n,274879)),Promise.resolve().then(n.bind(n,675987)),Promise.resolve().then(n.bind(n,977481)),Promise.resolve().then(n.bind(n,418216)),Promise.resolve().then(n.bind(n,990352)),Promise.resolve().then(n.bind(n,512258)),Promise.resolve().then(n.bind(n,616643)),Promise.resolve().then(n.bind(n,6333))]);R(),Promise.all([Z(g),B(g)]).then((()=>A(g))),N(),V(g);const[{TransactionQueueDependenciesImpl:W},{waitForStatsigInitialization:H},{isPrewarmedTabInitialRender:$}]=await Promise.all([Promise.resolve().then(n.bind(n,268343)),Promise.resolve().then(n.bind(n,963332)),Promise.resolve().then(n.bind(n,512258))]);let G,Y;async function X(e){const t=performance.now(),{didStatsigBootupTimeout:n}=await H({environment:g,initializeStatsigResult:i});G??=L.checkGate({gateName:"react_18_concurrent_rendering"});const a=performance.now(),s=document.querySelector("#notion-app");if(!s)throw new Error('Could not find element with id "notion-app"');h.updateDependencies(new W(e)),I.updateConnectionState(e),O.updateEnvironment(e),d.clientLogglyEnvironmentData.userId=e.currentUser.id;const c=()=>{const e=document.getElementById("initial-loading-spinner"),i=document.getElementById("skeleton");e&&e.remove(),i&&i.remove();const s=performance.now();D.setSubMetricsAtRenderCallback({mainStartTime:o,prefetchInitiatedTime:r,statsigBootupBlockingStartTime:t,renderStartTime:a,renderEndTime:s});const c=K.getAppStartTime();c&&S.DO_NOT_USE_measureLegacy({metricName:"time_origin_to_app_start",startTime:0,endTime:c},{environment:g,data:{sub_metrics:q.getTimeOriginToAppStartSubMetrics()}}),S.DO_NOT_USE_measureLegacy({metricName:"time_origin_to_prefetch_initiated",startTime:0,endTime:r},{environment:g}),F.state&&S.measure({metricName:"client.migrate_sqlite",startTime:F.state.startTime,endTime:F.state.endTime},{environment:g}),S.measure({metricName:"statsig_bootup_blocking",startTime:t,endTime:a},{environment:g,data:{timed_out:n,is_prewarmed_tab:$(g)}})},l=P.createElement(T,{environment:e,onMount:G?c:void 0});G?(Y??=E.createRoot(s),Y.render(l)):j.render(l,s,c)}w.initialize(g),await X(g);const{startFlushing:Q}=await Promise.resolve().then(n.bind(n,565016));return Q(((e,t)=>{S.measure(e,{environment:g,preboot:!0,shouldSendIfStatsigNotInitialized:!0,shouldExcludeFromTimeline:!0,data:t})})),{transactionQueue:h,environment:g}}},557161:(e,t,n)=>{n.d(t,{V:()=>r});var o=()=>n(142735);function r(e){return{modules:(0,o().VK)((()=>{if(!e)return;const t=e.getAssociatedCollectionStore(),n=null==t?void 0:t.getLayoutStore();return null==n?void 0:n.getModules().page_details}),[e])}}},222578:(e,t,n)=>{n.r(t),n.d(t,{createClientEnvironment:()=>ve});var o=()=>n(66077),r=()=>n(811765),a=()=>n(388322),i=()=>n(758925),s=()=>n(836054),c=()=>n(4312),l=()=>n(317924),d=()=>n(999219),u=()=>n(200568),p=()=>n(751052),m=()=>n(150266),f=()=>n(231077),g=()=>n(76254),v=()=>n(205228);class h extends(()=>n(46581))().U{constructor(e){super({...e,mapSpaceIdToShortId:t=>e.mapSpaceIdToShortId(this.currentUserId,t)}),this.currentUserId=void 0,this.currentUserId=e.currentUserId}updateCurrentUserId(e){this.currentUserId=e}}var b=()=>n(274879),S=()=>n(260169),y=()=>n(263168),w=()=>n(836842),k=(n(821057),n(670560),n(267602),n(749411),n(30005),n(241792),()=>n(799891)),x=()=>n(217465),I=()=>n(396136),C=()=>n(882765),_=()=>n(96642),T=()=>n(513670),P=()=>n(792409),j=()=>n(594546),E=()=>n(619995),U=()=>n(725466),M=()=>n(994883),L=()=>n(81954),R=()=>n(839002),A=()=>n(781105);async function V(e){const{environment:t}=e;return(await R().qd(Object.keys(n(747055).Z.state.offlinePages||{}),100,(e=>async function(e){const{environment:t,pageId:n}=e,o={page:{id:n,spaceId:(0,L().J)(void 0)},limit:1/0,cursor:{stack:[]},verticalColumns:!1},r=[];return await U().z({...o,baseUrl:v().default.domainBaseUrl,publicDomainName:v().default.publicDomainName,shouldTraverseToggleBlocks:!0},M().s.sideEffect((e=>((0,E().t)(e)&&r.push(e.id),Promise.resolve())),M().s.fromMonomorphicFunctionUnsafe((async e=>{const n=await A().Ye({environment:t,pointer:e,useInMemoryCacheOnly:!1,skipAccessWrites:!0});return null==n?void 0:n.model})))),r}({environment:t,pageId:e})))).flat()}var Z=()=>n(620218),B=()=>n(749826),N=()=>n(222685);let O=1;class D{constructor(e){this.connection=void 0,this.maxSize=void 0,this.getEnvironment=void 0,this.getLatency=new(n(265704).s),this.batchReadWorkers=15,this.queuedGetErrors=[],this.pendingWrites=x().RecordMapLegacy.create(),this.getManyFromDisk=async e=>{const t=x().RecordMapLegacy.create();e.forEach(((e,n)=>{let{pointer:o}=e;t.set(o,n)}));const n=await this.doSafeRead((()=>N().Q6(this.connection,e))),o=x().RecordMapLegacy.create();for(const r of n)this.setCachedRecordMap(o,r);return e.map((e=>{let{pointer:t,userId:n}=e;const r=this.getInMemory(t,n);if(r)return r;const a=o.get(t);return a&&a[n]}))},this.diskReadQueue=new(n(973019).Z)({batchSize:Math.floor(n(231522).mz/3)-1,maxWorkers:this.batchReadWorkers>0?this.batchReadWorkers:1,performRequests:this.getManyFromDisk}),this.flushWrites=async()=>{const e=this.pendingWrites;this.pendingWrites=x().RecordMapLegacy.create();const t=Array.from(e).flatMap((e=>{let{value:t}=e;return t?Object.values(t):[]})),n=Z().default.DO_NOT_USE_markLegacy("sqlite_record_cache.flush_writes.duration");try{await this.doSafeWrite((()=>N().Y3(this.connection,t)));const e={status:"success"};j().fW({environment:this.getEnvironment(),eventName:"sqlite_record_cache.flush_writes",eventProperties:e,opts:{preboot:!0,sampling:{behavior:"statsig",fallbackBehavior:"custom",fallbackSampleRate:0}}}),Z().default.DO_NOT_USE_measureLegacy(n,{environment:this.getEnvironment(),data:e,shouldExcludeFromTimeline:!0})}catch(o){k().log({level:"warning",from:"SqliteRecordCache",type:"applyRecordCacheOperationsError",error:(0,P().Ui)(o),data:(0,C().fq)(o,{isBrowser:this.getEnvironment().device.isBrowser})},{forceSuppressConsoleLog:!0});const e={status:"error"};j().fW({environment:this.getEnvironment(),eventName:"sqlite_record_cache.flush_writes",eventProperties:e,opts:{preboot:!0,sampling:{behavior:"statsig",fallbackBehavior:"custom",fallbackSampleRate:0}}}),Z().default.DO_NOT_USE_measureLegacy(n,{environment:this.getEnvironment(),data:e,shouldExcludeFromTimeline:!0})}B().default.checkGate({gateName:"download_for_offline"})||navigator.locks.request("sqliteRecordCacheEviction",{mode:"exclusive",ifAvailable:!0},(async e=>{if(!e)return;const t=await this.getTablesThatNeedEviction();if(0===t.length)return;const n=await V({environment:this.getEnvironment()});await this.evictTables({tables:t,offlineRecordIds:n})}))},this.debouncedFlushWrites=T().Ds(this.flushWrites,500,{maxWait:3e3}),this.throttledLogGetErrorBatched=T().P2(this.logGetErrorBatched,3e3,{leading:!1,trailing:!0}),this.connection=e.connection,this.maxSize=e.maxSize,this.getEnvironment=e.getEnvironment}getDedicatedWorkerConnection_DEBUG_ONLY(){var e,t;return null===(e=(t=this.connection).getDedicatedWorkerConnection_DEBUG_ONLY)||void 0===e?void 0:e.call(t)}set(e){const{pointer:t,value:o,importance:r,maybeStaleRecordMap:a}=e;if(void 0===t||void 0===t.id){const e=new Error("Attempting to set a record with an invalid pointer.");return k().log({level:"error",from:"SqliteRecordCache",type:"SqliteRecordCache.setBadPointer",error:{message:"Attempting to set a record with an invalid pointer.",stack:e.stack},data:{pointer:t}}),void n(680146).IE(e)}const i=e.userId||_().I,s={pointer:t,userId:i,value:o,timestamp:Date.now(),importance:r};this.removePendingWrite(t,i,"delete"),this.enqueueWrite({type:"set",record:s,maybeStaleRecord:a})}async get(e){const{pointer:t,skipAccessWrites:n}=e,o=`get ${O}`,r=e.userId||_().I;let a;O++,this.getLatency.start(o);try{const e=this.getInMemory(t,r);if(e)return n||this.enqueueWrite({type:"access",record:e}),this.getLatency.end(o,"memory"),e.value;a=Z().default.DO_NOT_USE_markLegacy("sqlite_record_cache.get_record.duration");const i=await(this.batchReadWorkers>0?this.diskReadQueue.enqueue({pointer:t,userId:r}):this.getFromDiskUnbatched(t,r));if(i){n||this.enqueueWrite({type:"access",record:i}),this.getLatency.end(o,"disk");const e={status:"success"};return j().fW({environment:this.getEnvironment(),eventName:"sqlite_record_cache.get_record",eventProperties:e,opts:{preboot:!0,sampling:{behavior:"statsig",fallbackBehavior:"custom",fallbackSampleRate:0}}}),Z().default.DO_NOT_USE_measureLegacy(a,{environment:this.getEnvironment(),data:e,shouldExcludeFromTimeline:!0}),i.value}}catch(i){i instanceof C().ZV||i instanceof C().q2?(this.queuedGetErrors.push(i),this.throttledLogGetErrorBatched(),this.getEnvironment().defaultRecordCache.disablePersistedRecordCache()):k().log({level:"warning",from:"SqliteRecordCache",type:"getError",error:(0,P().Ui)(i),data:(0,C().fq)(i,{isBrowser:this.getEnvironment().device.isBrowser})},{forceSuppressConsoleLog:!0});const e={status:"error"};return j().fW({environment:this.getEnvironment(),eventName:"sqlite_record_cache.get_record",eventProperties:e,opts:{preboot:!0,sampling:{behavior:"statsig",fallbackBehavior:"custom",fallbackSampleRate:0}}}),void(a&&Z().default.DO_NOT_USE_measureLegacy(a,{environment:this.getEnvironment(),data:e,shouldExcludeFromTimeline:!0}))}finally{this.getLatency.end(o,"miss")}}deleteRecord(e,t){t=t||_().I,this.removePendingWrite(e,t,"set"),this.enqueueWrite({type:"delete",record:{pointer:e,userId:t}})}async getBlocksWithParent(e){const t=Date.now(),n=e.userId||_().I,o=await this.doSafeRead((()=>N().lR(this.connection,{...e,timestamp:t,userId:n}))),r=x().RecordMapLegacy.create(),a=T().oA(Array.from(this.pendingWrites).map((o=>{const a=o&&o.value&&n&&o.value[n];if(!a||"set"!==a.type)return;const i=a.record.value?a.record.value.value:void 0;if(!i)return;if(a.record.pointer.table!==I().iU)return;const s=i;return s.parent_id===e.parent.id&&s.parent_table===e.parent.table?(r.set(a.record.pointer,!0),a.record.timestamp<t&&(a.record.timestamp=t),a.record.value):void 0})));for(const i of o)r.get(i.pointer)||this.getInMemory(i.pointer,i.userId)||a.push(i.value);return a}async getPageBlocksByParent(e){const t=Date.now(),n=e.userId||_().I,o=await this.doSafeRead((()=>N().GF(this.connection,{...e,timestamp:t,userId:n})));return o.forEach((e=>{this.enqueueWrite({type:"access",record:{pointer:e.pointer,timestamp:t,userId:n,importance:void 0,value:e.value}})})),o}async getOfflinePages(e){const{userId:t,orderBy:n}=e;return await this.doSafeRead((async()=>await N().Xc({connection:this.connection,userId:t,orderBy:n})))}async getExplicitlyOfflinedPages(e){const{userId:t}=e;return await this.doSafeRead((async()=>await N().e1({connection:this.connection,userId:t})))}async isPageAvailableOffline(e){const{pageId:t,userId:n}=e;return await this.doSafeRead((async()=>await N().jL({connection:this.connection,pageId:t,userId:n})))}async addOfflinePage(e){const{userId:t,pageId:n,pageType:o}=e;await this.doSafeWrite((async()=>{await N().OJ({connection:this.connection,userId:t,pageId:n,pageType:o})}))}async addOfflineAction(e){const{userId:t,originPageId:n,impactedPageId:o}=e;await this.doSafeWrite((async()=>{await N().DI({connection:this.connection,userId:t,originPageId:n,impactedPageId:o})}))}async deleteOfflineActionsAndCleanUp(e){const{userId:t,impactedPageIds:n,originPageId:o}=e;await this.doSafeWrite((async()=>{await N().KA({connection:this.connection,userId:t,originPageId:o,impactedPageIds:n})}))}async addOfflinePageAndOfflineAction(e){const{userId:t,impactedPageId:n,originPageId:o,pageType:r}=e;await this.doSafeWrite((async()=>{await N().Tm({connection:this.connection,userId:t,impactedPageId:n,originPageId:o,pageType:r})}))}async updateOfflinePageLastDownloadedMetadata(e){const{pageId:t,userId:n,lastDownloadedAt:o,lastDownloadedVersion:r}=e;await this.doSafeWrite((async()=>{await N().Oo({connection:this.connection,pageId:t,userId:n,lastDownloadedAt:o,lastDownloadedVersion:r})}))}async getImpactedPageIdsByOriginPageId(e){const{originPageId:t,userId:n}=e;return await N().C({connection:this.connection,originPageId:t,userId:n})}async deleteOfflineActionsWithOriginPageIdAndCleanUp(e){const{originPageId:t,userId:n}=e;await this.doSafeWrite((async()=>{await N().ah({connection:this.connection,originPageId:t,userId:n})}))}async isPageExplicitlyToggledOffline(e){const{pageId:t,userId:n}=e;return await this.doSafeRead((async()=>await N().Bh({connection:this.connection,pageId:t,userId:n})))}async getInlineCollectionsInOfflinePage(e){const{pageId:t,userId:n}=e;return await this.doSafeRead((async()=>await N().FG({connection:this.connection,pageId:t,userId:n})))}async reset(){this.pendingWrites=x().RecordMapLegacy.create(),await this.doSafeWrite((()=>N().G$(this.connection)))}setEnvironment(e){this.getEnvironment=()=>e}async flushPendingWrites(){await this.flushWrites()}enqueueWrite(e){this.debouncedFlushWrites();const{pointer:t,userId:n}=e.record,o=this.pendingWrites.get(t),r=o&&o[n];if(r){if("set"===r.type&&"access"===e.type){const t={type:"set",record:{...r.record,timestamp:e.record.timestamp}};return void this.setCacheOperationMap(this.pendingWrites,t)}const t="set"===r.type&&!r.maybeStaleRecord&&r.record.value&&r.record.value.value?r.record.value.value.version:void 0,n="set"===e.type&&e.maybeStaleRecord&&e.record.value&&e.record.value.value?e.record.value.value.version:void 0;if("number"==typeof t&&"number"==typeof n&&t>=n)return}this.setCacheOperationMap(this.pendingWrites,e)}async getFromDiskUnbatched(e,t){const[n]=await this.getManyFromDisk([{pointer:e,userId:t}]);return n}getInMemory(e,t){const n=this.pendingWrites.get(e),o=n&&n[t];if(o&&"set"===o.type)return o.record}setCacheOperationMap(e,t){const n=t,{pointer:o,userId:r}=n.record,a=e.get(o)||{};e.set(o,{...a,[r]:n})}setCachedRecordMap(e,t){const{pointer:n,userId:o}=t,r=e.get(n)||{};e.set(n,{...r,[o]:t})}removePendingWrite(e,t,n){const o=this.pendingWrites.get(e);o&&o[t]&&o[t].type===n&&this.pendingWrites.delete(e)}logGetErrorBatched(){const e=this.getEnvironment(),t=T().vM(this.queuedGetErrors,(e=>(0,P().Ui)(e).message));for(const[n,o]of Object.entries(t)){if(!n)break;k().log({level:"warning",from:"SqliteRecordCache",type:"getErrorBatched",error:(0,P().Ui)(o[0]),data:{batchedData:o.map((t=>(0,C().fq)(t,{isBrowser:e.device.isBrowser})))}},{forceSuppressConsoleLog:!0})}this.queuedGetErrors=[]}async getTablesThatNeedEviction(){try{return await this.doSafeRead((()=>N().b3({connection:this.connection,maxSize:this.maxSize})))}catch(e){return j().j({environment:this.getEnvironment(),event:{eventName:"sqlite_record_cache.eviction.error",eventProperties:{type:"get_tables_failed"}},opts:{preboot:!0}}),k().log({level:"warning",from:"SqliteRecordCache",type:"getTablesThatNeedEvictionFailed",error:(0,P().Ui)(e)}),[]}}async evictTables(e){const{tables:t,offlineRecordIds:n}=e;try{await this.doSafeWrite((()=>N().Hv({connection:this.connection,tables:t,maxSize:this.maxSize,offlineRecordIds:n}))),j().j({environment:this.getEnvironment(),event:{eventName:"sqlite_record_cache.eviction",eventProperties:{}},opts:{preboot:!0}})}catch(o){j().j({environment:this.getEnvironment(),event:{eventName:"sqlite_record_cache.eviction.error",eventProperties:{type:"eviction_failed"}},opts:{preboot:!0}}),k().log({level:"warning",from:"SqliteRecordCache",type:"evictionFailed",error:(0,P().Ui)(o)})}}async doSafeRead(e){return await navigator.locks.request("sqliteRecordCache",{mode:"shared"},e)}async doSafeWrite(e){await navigator.locks.request("sqliteRecordCache",{mode:"exclusive"},e)}}var K=()=>n(956057),q=()=>n(484896),F=()=>n(913017);const z=[WebSocket.OPEN,WebSocket.CONNECTING];class W{constructor(){this.sqliteConnection=void 0,this.requests=new Map}async initialize(){"message-ports"===await this.getConnectionType()?await this.initializeMessagePort():await this.initializeWebSocket()}async getConnectionType(){var e;const{preferences:t}=await f().electronAppFeatures.get()||{};if("message-ports"===(null==t?void 0:t.sqliteConnectionType))return"message-ports";const n=f().getDesktopVersion();return n&&n[0]>=4?"message-ports":null!==(e=f().electronApi)&&void 0!==e&&e.sqliteServerEnabled?"web-sockets":null}async initializeMessagePort(){await this.initializeMessagePortConnection();const e={execSqliteBatchV2:async e=>{let{batch:t,precondition:n}=e;return this.execSqliteBatchInnerMessagePort({id:K().Il(),batch:t,precondition:n})},execSqliteBatch:async e=>this.execSqliteBatchInnerMessagePort({id:K().Il(),batch:e})};this.sqliteConnection=new(F().s)({connection:e,type:"v2",migrations:await(0,q().k)(e)})}async initializeWebSocket(){await this.initializeWebSocketConnection();const e={execSqliteBatchV2:async e=>{const t=K().Il(),{batch:n,precondition:o}=e,r=JSON.stringify({id:t,batch:n,precondition:o,auth:this.authToken});return await this.execSqliteBatchInnerWebSockets(t,r)},execSqliteBatch:async e=>{const t=K().Il(),n=JSON.stringify({id:t,batch:e,auth:this.authToken});return await this.execSqliteBatchInnerWebSockets(t,n)}};this.sqliteConnection=new(F().s)({connection:e,type:"v2",migrations:await(0,q().k)(e)})}async execSqliteBatchInnerWebSockets(e,t){const n=new Promise((t=>{this.requests.set(e,t)}));this.ws.readyState===WebSocket.CLOSED&&await this.initializeWebSocket();try{this.ws.send(t)}catch(r){const e=this.ws;this.ws.onopen=function(n){e.send(t)}}const o=await n;if(o.error)throw new Error("Received SQLite error.");return o.value}async execSqliteBatchInnerMessagePort(e){const t=new Promise((t=>{this.requests.set(e.id,t)}));this.messagePort||await this.initializeMessagePortConnection(),this.messagePort.postMessage(e);const n=await t;if(n.error)throw new Error("Received SQLite error.");return n.value}async initializeMessagePortConnection(){return new Promise((async e=>{var t;if(null===(t=f().electronApi)||void 0===t||!t.getSqliteMeta)return;if(this.messagePort)return;const n=t=>{try{if(!t.ports.length||t.source!==window)return;this.messagePort=t.ports[0],this.messagePort.onclose=()=>{this.messagePort=void 0},this.messagePort.onmessage=e=>{const{id:t,result:n}=e.data,o=this.requests.get(t);o&&(this.requests.delete(t),o({value:n}))},window.removeEventListener("message",n),e()}catch(o){k().log({level:"error",from:"electronSqlite",type:"messagePortError",error:(0,P().Ui)(o)})}};window.addEventListener("message",n);(await f().electronApi.getSqliteMeta()).error}))}async initializeWebSocketConnection(){var e;if(null===(e=f().electronApi)||void 0===e||!e.getSqliteMeta)return;const t=await f().electronApi.getSqliteMeta();if(t.error)return;if(this.ws&&z.includes(this.ws.readyState))return;const{serverProcessPort:n,authToken:o}=t.value;this.authToken=o;const r=`ws://127.0.0.1:${n}`;this.ws=new WebSocket(r),this.ws.onclose=()=>{k().log({level:"warning",from:"electronSqlite",type:"reinitializingWebsocket"}),this.initializeWebSocketConnection()},this.ws.addEventListener("message",(e=>{const t=e.data.toString(),{id:n,result:o}=JSON.parse(t),r=this.requests.get(n);r&&(this.requests.delete(n),r({value:o}))})),await new Promise((e=>{this.ws.onopen=()=>{e()}}))}}n(398858),n(461318),n(33228);var H=()=>n(254375);Error;class ${constructor(e){this.initializePromise=void 0,this.dedicatedWorkerConnection=void 0,this.initializePromise=this.initialize(e)}async waitForInitialize(){await this.initializePromise}async execSqliteBatch(e){return(await this.initializePromise).execSqliteBatch(e)}getDedicatedWorkerConnection_DEBUG_ONLY(){return this.dedicatedWorkerConnection}async initialize(e){const{loadWorker:t,loadSharedWorker:o}=e,r=K().Il(),a=t(),i=o(),s=H().Ud(i.port);var c;this.dedicatedWorkerConnection=H().Ud(a),H().Jj(this.dedicatedWorkerConnection,i.port),await(c=n(432687).G(r),new Promise(((e,t)=>{navigator.locks.request(c,(()=>(e(),new Promise((()=>{}))))).catch(t)}))),await s.initializeNewTab({tabId:r});const l={execSqliteBatch:e=>s.execSqliteBatch(e),execSqliteBatchV2:e=>s.execSqliteBatchV2(e)},d=new(F().s)({connection:l,type:"v2",migrations:await(0,q().k)(l)});try{await d.ensureMigrated()}catch(u){k().log({level:"error",from:"ProxiedWasmSqliteConnectionWrapper",type:"sqliteConnectionEnsureMigratedError",error:(0,P().Ui)(u),data:(0,C().fq)(u,{isBrowser:!0})})}return d.optimize().catch((e=>{k().log({level:"error",from:"ProxiedWasmSqliteConnectionWrapper",type:"sqliteConnectionOptimizeError",error:(0,P().Ui)(e),data:(0,C().fq)(e,{isBrowser:!0})})})),d}}class G{constructor(e){this.sqliteConnection=void 0,this.sqliteConnection=new $({loadWorker:()=>new Worker(new URL(n.p+n.u(27244),n.b)),loadSharedWorker:()=>new SharedWorker(new URL(n.p+n.u(60858),n.b)),currentUserId:e.currentUserId})}static maybeCreateInstance(e){const{device:t,currentUserId:n}=e;if(function(e){var t;return!(!e.isBrowser||void 0===(null===(t=navigator.locks)||void 0===t?void 0:t.request)||"undefined"==typeof SharedWorker||"localhost"===window.location.hostname&&"3003"!==window.location.port||e.isAndroid)}(t)){Y("loading");const e=new G({currentUserId:n});return e.waitForInitialize().then((()=>{Y("success")}),(e=>{Y("error"),k().log({level:"error",from:"clientEnvironment",type:"wasmSqliteInitializeError",error:(0,P().Ui)(e),data:{...(0,C().fq)(e,{isBrowser:!0}),userId:n}})})),e}Y("skipped-unsupported-device")}async waitForInitialize(){return await this.sqliteConnection.waitForInitialize()}}function Y(e){n(601952).default.state.metricDataStore.update((t=>({...t,wasm_sqlite_initialized:e}))),n(944077).setTag("wasm_sqlite_initialized",e)}var X=()=>n(263184);class Q extends X().default{getInitialState(){return{loading:!1,loaded:!1}}async loadIfNeeded(e){if(this.state.loaded||this.state.loading)return;const t=e();if(!t)return;if(0===n(955620).CGe(t).length)return;const o=n(555061).e.load();this.setState({loading:!0,loaded:!1,result:o}),this.setState({loading:!1,loaded:!0,result:await o})}getKatex(){if(this.state.loaded)return this.state.result}}n(122556),n(582845),n(250570),n(533019),n(721473),n(788208),n(22624),n(653476),n(731107),n(228244);var J=()=>n(35980),ee=()=>n(326966),te=()=>n(824462),ne=()=>n(635596),oe=()=>n(148882);class re extends X().default{static getCacheKey(e){return`LocalBacklinkStore2:${e}`}getInitialState(){return{}}initializeBacklinks(e){let{block:t,currentUserId:n,environment:o}=e;if(this.instanceState[t.id])return;const r=this.getCachedBacklinkState({blockId:t.id,currentUserId:n});r?this.setState({...this.instanceState,[t.id]:{state:r,loaded:!0}}):this.setState({...this.instanceState,[t.id]:{state:{backlinks:[],inaccessibleBacklinkCount:0},loaded:!1}}),ae(o,t),this.startMessageListeners(t,o)}awaitLoaded(e){return this.waitUntil((()=>{const t=this.state[e];return Boolean(t&&t.loaded)}))}destroyBacklinks(e,t){this.stopMessageListeners(e,t),delete this.instanceState[e]}getBacklinkState(e){let{blockId:t,currentUserId:n}=e;const o=this.state[t];return o?o.state:this.getCachedBacklinkState({blockId:t,currentUserId:n})||{backlinks:[],inaccessibleBacklinkCount:0}}setBacklinkState(e){let{blockId:t,state:n,currentUserId:o}=e;this.setCachedBacklinkState({blockId:t,state:n,currentUserId:o});const r=this.state[t];r&&this.setState({...this.state,[t]:{...r,state:n,loaded:!0}})}updateBacklinks(e){const{createdBacklinks:t,deletedBacklinks:n,currentUserId:o}=e,r=(0,ee().cf)(t),a=(0,ee().cf)(n),i=r.reduce(((e,t)=>{const{block_id:n}=t;return e[n]=e[n]?[...e[n],t]:[t],e}),{}),s=a.reduce(((e,t)=>{const{block_id:n}=t;return e[n]=e[n]?[...e[n],t]:[t],e}),{}),c=new Set([...Object.keys(i),...Object.keys(s)]);return c.forEach((e=>{const t=i[e]||[],n=s[e]||[],r=this.getBacklinkState({blockId:e,currentUserId:o}),a=t.filter((e=>!r.backlinks.some((t=>T().Xy(e,t))))),c=[...r.backlinks,...a].filter((e=>!n.some((t=>T().Xy(e,t)))));this.setBacklinkState({blockId:e,state:{...r,backlinks:c},currentUserId:o})})),Array.from(c)}resetBacklinkState(e){let{blockIds:t,currentUserId:n}=e;for(const o of t)this.setCachedBacklinkState({blockId:o,state:{backlinks:[],inaccessibleBacklinkCount:0},currentUserId:n})}getCachedBacklinkState(e){let{blockId:t,currentUserId:n}=e;return J().Z.get({userId:n,key:re.getCacheKey(t)})}setCachedBacklinkState(e){let{blockId:t,state:n,currentUserId:o}=e;return J().Z.set({userId:o,key:re.getCacheKey(t),value:n})}async startMessageListeners(e,t){const o=n(827370).dr.fromSpaceShardRecordId(e,I().iU);oe().transactionQueue.isPendingTransactionForRecord(o)&&await oe().transactionQueue.drain();const r=this.instanceState[o.id];if(!r)return;let a,i=!1;const s=T().P2(((n,o)=>{const r=a,s=o||void 0;a=s,i?r!==s&&ae(t,e):i=!0}),1e3),c=(0,n(183922).Mv)(o.id);r.messageStoreListenerReference=ne().ZP.addListener(c,s,void 0,t)}stopMessageListeners(e,t){const n=this.instanceState[e];n&&n.messageStoreListenerReference&&(ne().ZP.removeListener(n.messageStoreListenerReference,t),n.messageStoreListenerReference=void 0)}}async function ae(e,t){await oe().transactionQueue.awaitRecordTransaction({id:t.id,table:I().iU});if(B().default.checkGate({gateName:"multi_cell_backlinks"})){const o=(0,n(631871).v3)(t.id),r=o?{"x-notion-space-short-id":o.toString()}:t.spaceId?{"x-notion-space-id":t.spaceId}:{},a=te().callMultiCellApi({eventName:"getPageBacklinks",environment:e,data:{block:t},headers:r}),i=[];let s=0;for await(const n of a)"failed"!==n.type&&(i.push(...n.data.backlinks),s+=n.data.inaccessibleBacklinkCount,e.LocalBacklinkStore.setBacklinkState({blockId:t.id,state:{backlinks:i,inaccessibleBacklinkCount:s},currentUserId:e.currentUser.id}))}else{const n=await te().callApi({eventName:"getBacklinksForBlock",environment:e,data:{block:t}});"failed"!==n.type&&e.LocalBacklinkStore.setBacklinkState({blockId:t.id,state:{backlinks:n.data.backlinks,inaccessibleBacklinkCount:n.data.inaccessibleBacklinkCount},currentUserId:e.currentUser.id})}}class ie extends X().default{getInitialState(){return{isOpen:!1,isSubMenuOverridden:!1,subMenu:void 0,menu:void 0,shouldRestoreSelectionForMenu:!0,enableShouldShowDebugging:!1,session:void 0}}clear(e){this.update((t=>({...t,menu:void 0,shouldRestoreSelectionForMenu:e})))}async clearNativeActionMenuAndRestoreSelectionIfNecessary(){var e;void 0!==(null===(e=this.state.menu)||void 0===e?void 0:e.type)&&(this.clear(!0),await R().Vs(10))}}function se(e){return`PageDetailsStore:${e.type}:${e.id}`}class ce extends X().default{getInitialState(){return{}}static getDefaultToggleState(e){return"discussion"===e.type||"backlinks"!==e.type&&void(0,n(696459).t1)(e)}getToggleState(e){const t=se(e);if(t in this.state)return this.state[t]}setToggleState(e,t){const n=se(e);this.setState({...this.state,[n]:t})}}var le=()=>n(245015);const de="spellcheckEnabled";class ue{constructor(){this.enabled=void 0,this.currentLanguages=void 0;const e=le().Z.get(de);this.setEnabled(void 0===e||e)}setEnabled(e){var t,n;(this.enabled=e,le().Z.set(de,e),null!==(t=f().electronApi)&&void 0!==t&&t.setSpellCheckerEnabled)&&(null===(n=f().electronApi)||void 0===n||n.setSpellCheckerEnabled(e))}isEnabled(){return this.enabled}getCorrections(e){return e.dictionarySuggestions}addToDictionary(e){var t;null!==(t=f().electronApi)&&void 0!==t&&t.addToDictionary&&f().electronApi.addToDictionary(e)}setLanguages(e){var t;T().Xy(this.currentLanguages,e)||(this.currentLanguages=e,null!==(t=f().electronApi)&&void 0!==t&&t.setSpellCheckerLanguages&&f().electronApi.setSpellCheckerLanguages(0===e.length?[navigator.language]:e))}async getLanguages(){var e;const t=new Intl.DisplayNames([navigator.language],{type:"language"}),n=[];if(null!==(e=f().electronApi)&&void 0!==e&&e.getSpellCheckerLanguages){const e=await f().electronApi.getSpellCheckerLanguages();for(const o of e)n.push({code:o,name:t.of(o)})}return n}async getAvailableLanguages(){var e;const t=new Intl.DisplayNames([navigator.language],{type:"language"}),n=[];if(null!==(e=f().electronApi)&&void 0!==e&&e.getAvailableSpellCheckerLanguages){const e=await f().electronApi.getAvailableSpellCheckerLanguages();for(const o of e)n.push({code:o,name:t.of(o)})}return n}}class pe extends(()=>n(435308))().default{}const me=["nativeRedirect","page","space","nativeTab","onboarding","unsubscribe","unknown","uiDoc","desktopEmailConfirm","root","chat","marketplace","team","gallery","settingsConsoleOrganization"],fe=[...me,"login","login/calendar","signup","quickSearch"];let ge=0;async function ve(e){var t;const{minimalEnvironment:n,prefetchCache:v,currentUserId:k}=e,{device:x,deviceStore:I,mobileNative:C,cookieService:_}=n,T=""+ge++,P=x.isElectron&&Boolean(null===(t=f().electronApi)||void 0===t?void 0:t.sqliteServerEnabled)?await async function(e){var t;if(!e.device.isElectron||null===(t=f().electronApi)||void 0===t||!t.sqliteServerEnabled)return;const n=new W;return await n.initialize(),n}({device:x}):void 0,j=G.maybeCreateInstance({device:x,currentUserId:k}),E=new(c().Z),U=new(l().Xk),M=new(u().Z),L=new ue,R=(null==C?void 0:C.sqliteConnection)||(null==P?void 0:P.sqliteConnection)||(null==j?void 0:j.sqliteConnection),A=R?new D({connection:R,maxSize:x.isDesktop?1e6:1e5,getEnvironment:function(){return q}}):void 0,V=new(r().q)({inMemoryRecordCache:new(o().Z)({name:"default"}),persistedRecordCache:A});j&&j.waitForInitialize().catch((()=>{V.disablePersistedRecordCache()}));const Z=function(e){const{device:t,RouterStore:n,ThemeStore:o}=e;let r=me;return(t.isElectron||t.isElectronCalendar||t.isMobileNative)&&(r=fe),new pe((()=>{const e=n.state.route;return e&&r.includes(e.name)?o.state.mode:"light"}),{debugName:"ThemeModeStore"})}({device:x,RouterStore:E,ThemeStore:M}),B=x.isMobile?new ie:void 0,N=await b().getPublicDomainUserId({device:x,deviceStore:I,mobileNative:C,cookieService:_}),O=new(a().CurrentUser),K=new h({environmentName:"production",getSettings:()=>{const e=(0,w().localUserOnlyGetConfig)("id_schema_dynamic_config_v3"),t=(null==e?void 0:e.get("percent",0))??0;return{enableTestDateOffset:!((null==e?void 0:e.get("real_id",!1))??!1),enableIdSchema:(0,m().lB)(t)}},isServerOriginated:!1,currentUserId:k,mapSpaceIdToShortId:(e,t)=>{const n=(0,S().aV)({defaultRecordCache:V,userId:e,spaceId:t});if(n&&n.short_id_str)return Number(n.short_id_str)}}),q={key:T,AppUpdateStore:new(i().D),device:x,deviceStore:I,WindowSizeStore:new(p().jE)({device:x},window),KeyboardShortcutStackStore:new(s().h),defaultRecordCache:V,mobileNative:C,RouterStore:E,ThemeStore:M,ThemeModeStore:Z,ElectronSqlite:P,KatexStore:new Q,LocalBacklinkStore:new re,PageDetailsStore:new ce,updateCurrentUserId:void 0,currentUser:O,SpellCheckStore:L,NativeMobileActionBarStore:B,TextSelectionCompositionStore:new(d().h),recordSubscriptionActions:y(),prefetchCache:v,TabbedRouterStore:U,cookieService:_,publicDomainUserId:N,idCreator:K};return g().LH(q),q}},616728:(e,t,n)=>{n.r(t),n.d(t,{AuthSyncListener:()=>b});n(267602),n(653476);var o=n(667294),r=()=>n(219727),a=()=>n(142735);const i="initial_handshake";var s=()=>n(989478),c=()=>n(788860),l=()=>n(513670),d=()=>n(839002),u=()=>n(342792),p=()=>n(205228),m=()=>n(826955),f=()=>n(704259),g=()=>n(385875),v=n(785893);const h=1;function b(){const e=(0,r().O7)(),t=(0,c().YB)(),n=`${p().default.identity.domainBaseUrl}/authSync`,b=e.currentUser.isLoggedIn(),[S,y]=(0,o.useState)(null),[w,k]=(0,o.useState)({value:!1,count:0}),x=(0,a().VK)((()=>f().default.getTotalUnreadMentionsCount()),[]),I=(0,a().VK)((()=>g().Z.getAllSpaceViewStores(e)),[e]);(0,o.useEffect)((()=>{const e=t=>{const n=p().default.identity.domainBaseUrl;t.origin===n&&t.ports&&t.ports[0]&&(y(t.ports[0]),window.removeEventListener("message",e))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}),[]),(0,o.useEffect)((()=>{b&&(w.value||0===w.count||null==S||S.postMessage({version:h,name:"unreadCount",source:"notion",unreadCount:x}))}),[b,w.count,w.value,S,x]);const C=(0,o.useCallback)((async()=>{const e=l().mN(I,"userId"),n=await(0,d().qd)(e,10,(async e=>{if(!e.userId)return;const n=m().U6.createChildStore(e,{table:s().KJ,id:e.userId});await n.load();const o=n.getEmail()??"",r=n.getDisplayName(t)??"";return{id:e.userId,displayName:r,emailAddress:o}}));null==S||S.postMessage({version:h,name:"accountSwitcher",source:"notion",accounts:n.filter((e=>void 0!==e)),persistCookie:!0})}),[t,S,I]);(0,o.useEffect)((()=>{b&&S&&(w.value||0===w.count)&&C()}),[b,C,w.count,w.value,S]),(0,o.useEffect)((()=>{e.currentUser.id&&(0,u().e)(e.currentUser.id)&&(null==S||S.postMessage({version:h,name:"setNotionUserID",source:"notion",notionUserID:e.currentUser.id,type:"mutation"}))}),[e.currentUser.id,S]),(0,o.useEffect)((()=>{b||null==S||S.postMessage({version:h,name:"setNotionUserID",source:"notion",notionUserID:"",type:"mutation"})}),[b,S]);const _=(0,o.useCallback)((e=>{if(e.data.version!==h)return;const{source:t}=e.data;if("notion"!==t&&"mailLoaded"===e.data.name)k((e=>({value:!0,count:e.count+1})))}),[]);return(0,o.useEffect)((()=>(y((e=>(e&&(e.onmessage=_),e))),()=>{y((e=>(e&&(e.onmessage=null),e)))})),[_,S]),(0,v.jsx)("iframe",{src:n,style:{display:"none"},onLoad:e=>function(e){const t=e.currentTarget;setTimeout((()=>{var e;null===(e=t.contentWindow)||void 0===e||e.postMessage(i,p().default.identity.domainBaseUrl)}),50)}(e),title:"Notion Identity"})}},853249:(e,t,n)=>{n.d(t,{Z:()=>u});n(241792),n(667294);var o=()=>n(219727),r=()=>n(142735),a=()=>n(846550);const i=[[2,1,3,1],[1,0,2,0],[0,2,0,3],[3,3,0,2],[1,1,2,2]];var s=()=>n(668001),c=()=>n(725751),l=()=>n(291335),d=n(785893);function u(e){let{skipFadeinDelay:t}=e;const n=(0,o().O7)(),u=(0,r().VK)((()=>n.device.isElectronMac&&!Boolean(c().default.state.isShowingTabBar)),[n]),m=(0,r().Kw)(l().sidebarExpandedStore),f=(0,r().VK)((()=>m?l().sidebarWidthStore.state:0),[m]),g=(0,a().yK)((e=>{const t={width:20,height:20,borderRadius:4},n={height:10,minHeight:10,borderRadius:10};return{sidebar:{backgroundColor:e.surface.wash,boxShadow:e.sidebarBoxShadow,display:m?"flex":"none",minWidth:f,flexDirection:"column",padding:"12px 14px",overflow:"hidden"},heroSection:{paddingTop:u?36:0,marginBottom:22,display:"flex",alignItems:"center"},heroSectionIcon:{padding:"1px",...t,width:22,height:22},heroSectionTitle:{width:177,marginLeft:8,...n},toplevelMenu:{marginBottom:20,width:78,...n},toplevelMenuLast:{marginBottom:36,width:135,...n},sectionHeader:{marginBottom:14,width:56,...n},pageRow:{display:"flex",alignItems:"center",marginBottom:11},pageIcon:{...t},pageTitle:{marginLeft:8,...n}}}),[m,f,u]),v=(0,d.jsxs)("div",{style:g.heroSection,children:[(0,d.jsx)(s().Z,{style:g.heroSectionIcon,emphasized:!0}),(0,d.jsx)(s().Z,{style:g.heroSectionTitle,emphasized:!0})]}),h=(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s().Z,{style:g.toplevelMenu,emphasized:!0}),(0,d.jsx)(s().Z,{style:g.toplevelMenu,emphasized:!0}),(0,d.jsx)(s().Z,{style:g.toplevelMenu,emphasized:!0}),(0,d.jsx)(s().Z,{style:g.toplevelMenuLast,emphasized:!0})]}),b=(0,d.jsx)(s().Z,{style:g.sectionHeader,emphasized:!0}),S=i.map(((e,n)=>e.map(((e,o)=>(0,d.jsxs)("div",{style:{...!t&&p(n),...g.pageRow},children:[(0,d.jsx)(s().Z,{style:g.pageIcon,emphasized:!0}),(0,d.jsx)(s().Z,{style:{...g.pageTitle,width:80+20*e},emphasized:!0})]},`${n}-${o}`)))));return(0,d.jsxs)("div",{style:g.sidebar,children:[v,h,b,S]})}function p(e){return 0===e?{}:{animation:`1s ease-in ${e}s 1 normal both running fadein`}}},743959:(e,t,n)=>{n.d(t,{V:()=>o,Z:()=>a});let o=function(e){return e.IN_APP_CALLOUT_CONFLICT="in-app callout conflict",e.DARK_MODE="not shown in dark mode",e}({});class r extends(()=>n(263184))().default{getInitialState(){return{isVisible:!1,suppressReason:void 0}}}const a=new r},767831:(e,t,n)=>{n.d(t,{Z:()=>r});class o extends(()=>n(263184))().default{getInitialState(){return{open:!1}}}const r=new o},211937:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(529048).Z)},705111:(e,t,n)=>{n.d(t,{g:()=>o});const o=n(263184).default.createValue({shouldReset:!1},{name:"MobileAssistantMenuStore"})},223248:(e,t,n)=>{n.d(t,{Id:()=>w,Ng:()=>k,Px:()=>S,ow:()=>y,t_:()=>b,um:()=>h});n(267602),n(653476);var o=()=>n(506347),r=()=>n(989478),a=()=>n(465755),i=()=>n(824462),s=()=>n(636340),c=()=>n(102182),l=()=>n(224597),d=()=>n(269299),u=()=>n(527278),p=()=>n(345918),m=()=>n(876822),f=()=>n(44556),g=()=>n(111631);const v=(0,n(788860).vU)({joinTeamSuccessMessage:{id:"teamInviteLinkActions.joinTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},requestTeamSuccessMessage:{id:"teamInviteLinkActions.requestAccess.successMessage",defaultMessage:"Successfully requested membership"},requestTeamFailureMessage:{id:"teamInviteLinkActions.requestAccess.failureMessage",defaultMessage:"Failed to request membership"}});async function h(e){let{environment:t,userId:n,teamStore:o,user:r}=e;const i=o.getSpaceId();if(!i)return;await f().Wi({environment:t,teamId:o.id,spaceId:i,teamUserInfo:r,isSettingDefaultTeam:!1,inviterId:n})&&(a().UD(t,{store:o,joined_role:"member",from:"team_invite_link"}),await b({environment:t,userId:n,teamStore:o}),c().oV({label:u().Z.formatMessage(v.joinTeamSuccessMessage,{teamName:o.getName()})}))}async function b(e){let{environment:t,userId:n,teamStore:r}=e;const a=m().default.state.currentUserRootStore,i=r.getSpaceId();if(!i||!a)return;const s=a.getSpaceViewStores().filter((e=>e.getSpaceId()===i))[0];await l().y3({environment:t,spaceViewStore:s,userSettingsStore:void 0,userRootStore:a,pageVisitSource:o().tY.JoinTeam,navigationType:"switchingToOrLoadingSpace"}),await g().I({environment:t,spaceId:i,userId:n}),f().hI({environment:t,teamStore:r,shouldScroll:!0})}async function S(e){let{environment:t,teamId:n,message:o}=e;if(!t.currentUser.id)return;"success"===(await i().callApi({eventName:"requestAccess",environment:t,data:{type:"current-actor-to-team",teamId:n,message:o}})).type?(a().LB(t,{teamId:n}),await w({environment:t}),new Promise((e=>setTimeout(e,500))).then((()=>{c().oV({label:u().Z.formatMessage(v.requestTeamSuccessMessage)})}))):c().oV({label:u().Z.formatMessage(v.requestTeamFailureMessage)})}async function y(e){let{environment:t,teamStore:n,accessRequestStore:o,status:i}=e;const c=o.getForActorId();if(!c)return;const l=o.getRecordModel({table:r().KJ,id:c});if(l){if("approved"===i){const e=[{type:"member",entity_type:"user",user_id:l.id}];if(!(await f().Uj({environment:t,teamStore:n,teamMemberInfos:e,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})))return}d().createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,canUndo:!0,perform:e=>{s().sW({store:o,transaction:e,data:{resolved_time:Date.now(),resolved_by_table:r().KJ,resolved_by_id:t.currentUser.id,status:i}})}}),a().co(t,{store:n,resolution:i})}}async function w(e){let{environment:t}=e;const{lastVisitedSpaceView:n,userRootStore:r,userSettingsStore:a}=await(0,p().iX)({environment:t,disableRedirectUrl:!1});n?await l().y3({environment:t,spaceViewStore:n,userRootStore:r,userSettingsStore:a,pageVisitSource:o().tY.BackForward,navigationType:"switchingToOrLoadingSpace"}):await l().L5({environment:t,userRootStore:r,userSettingsStore:a,pageVisitSource:o().tY.BackForward})}async function k(e){let{environment:t,teamId:n}=e;const o=await i().callApi({eventName:"getTeamAccessRequestMetadata",environment:t,data:{teamId:n}});if("success"===o.type)return o.data}},450194:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(667294),r=()=>n(788860),a=n(785893);const i=(0,r().vU)({message_placeholder:{id:"teamInviteLinkRequestPage.message.placeholder",defaultMessage:"Message (optional)"}});const s=function(e){const{teamStore:t,teamName:s,teamId:c,isModalOpen:l,onDismiss:d}=e,[u,p]=(0,o.useState)(""),m=(0,n(219727).O7)(),f=(0,r().YB)(),g=async()=>{await n(223248).Px({environment:m,teamId:c,message:u}),d()},v=(0,n(846550).yK)((()=>({modal:{alignSelf:"center",overflow:"visible",padding:15,width:420},requestTitle:{display:"inline-flex",marginBottom:10},icon:{marginLeft:4,marginRight:4},footer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:15},requestInvitesButton:{marginLeft:20},input:{padding:8}})),[]);return(0,a.jsx)(n(708518).Z,{open:l,onDismiss:d,innerStyle:v.modal,preventHideChildrenWhileOpening:!0,render:()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{style:v.requestTitle,children:(0,a.jsx)(r()._H,{id:"teamInviteLinkRequestModal.reasonForRequest.title",defaultMessage:"Request access to {icon} {teamName}",values:{teamName:s,icon:(0,a.jsx)(n(383694).p,{style:v.icon,store:t,disabled:!0,size:22})}})}),(0,a.jsx)(n(291198).Z,{textarea:!0,style:v.input,value:u,onChange:e=>{p(e.target.value)},placeholder:f.formatMessage(i.message_placeholder)}),(0,a.jsxs)("div",{style:v.footer,children:[(0,a.jsx)(n(67961).Z,{isSecondaryColor:!0,isSmall:!0,isMultiline:!0,children:(0,a.jsx)(r()._H,{id:"teamInviteLinkRequestModal.caption",defaultMessage:"Your teamspace owners will approve or decline your request."})}),(0,a.jsx)(n(906651).Z,{isLarge:!0,style:v.requestInvitesButton,onClick:g,children:(0,a.jsx)(r()._H,{id:"teamInviteLinkRequestModal.requestAccessButton.label",defaultMessage:"Request"})})]})]})})}},118795:(e,t,n)=>{var o=()=>n(677559);const r={WorkflowTemplatesBuilderNotInProd:new(o().Ss)("WorkflowTemplateBuilderNotInProd",(async()=>await Promise.all([n.e(52774),n.e(53329),n.e(72586),n.e(49498),n.e(77289),n.e(6532)]).then(n.bind(n,729728)))),CollectionItemNameConfigMenuItemNotInProd:new(o().Ss)("CollectionItemNameConfigMenuItemNotInProd",(async()=>await n.e(53784).then(n.bind(n,691482))))};(0,o().kF)(r.WorkflowTemplatesBuilderNotInProd,(e=>e.WorkflowTemplatesBuilderNotInProd)),(0,o().kF)(r.CollectionItemNameConfigMenuItemNotInProd,(e=>e.CollectionItemNameConfigMenuItemNotInProd))},457861:(e,t,n)=>{n.d(t,{H:()=>r});n(667294);var o=n(785893);const r=(0,n(827282).IU)("eyes",{viewBox:"0 0 72 72",svg:(0,o.jsx)("path",{d:"M17.0312 64.4375C26.25 64.4375 33.5625 52.9688 33.5625 36.4375C33.5625 19.9062 26.25 8.46875 17.0312 8.46875C7.8125 8.46875 0.5 19.9062 0.5 36.4375C0.5 52.9688 7.8125 64.4375 17.0312 64.4375ZM54.9688 64.4375C64.1875 64.4375 71.5 52.9688 71.5 36.4375C71.5 19.9062 64.1875 8.46875 54.9688 8.46875C45.75 8.46875 38.4375 19.9062 38.4375 36.4375C38.4375 52.9688 45.75 64.4375 54.9688 64.4375ZM10.0625 47.1875C15.125 47.1875 18.4688 43.6562 18.4688 38.3438C18.4688 33.0938 15.125 29.5625 10.0625 29.5625C7.6875 29.5625 5.71875 30.3125 4.25 31.6875C5.375 19.9375 10.6875 11.9375 17.0312 11.9062C24.25 11.875 30.125 22.0312 30.125 36.4375C30.125 50.7812 24.25 60.9688 17.0312 61C11.5312 61.0312 6.78125 54.9688 4.90625 45.5938C6.28125 46.625 8.03125 47.1875 10.0625 47.1875ZM47.9688 47.1875C53 47.1875 56.4062 43.6562 56.4062 38.3438C56.4062 33.0938 53 29.5625 47.9688 29.5625C45.5938 29.5625 43.5938 30.3438 42.1562 31.6875C43.2812 19.9375 48.5938 11.9375 54.9688 11.9375C62.1562 11.9062 68 22.0938 68 36.4375C68 50.7812 62.1562 60.9688 54.9688 60.9688C49.4375 61 44.6875 54.9375 42.7812 45.5938C44.1562 46.5938 45.9375 47.1875 47.9688 47.1875ZM45.5312 37.4062C44.4375 37.25 43.75 35.9688 44.0312 34.6562C44.3125 33.3125 45.3125 32.3438 46.375 32.5312C47.4688 32.75 48.0938 34.0312 47.8438 35.3125C47.5938 36.6562 46.5938 37.5938 45.5312 37.4062ZM7.625 37.4062C6.53125 37.25 5.84375 35.9688 6.09375 34.6562C6.375 33.3125 7.40625 32.3438 8.4375 32.5312C9.5625 32.7812 10.1875 34.0312 9.9375 35.3125C9.6875 36.6562 8.65625 37.5938 7.625 37.4062Z"})})},182068:(e,t,n)=>{n.d(t,{C:()=>r});n(667294);var o=n(785893);const r=(0,n(827282).IU)("notionLogoStroked",{viewBox:"0 0 41 42",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M4.253 2.903h0-.01c-1.02.09-1.806.481-2.322 1.142-.5.642-.671 1.441-.671 2.21v23.228c0 1.267.47 2.316 1.416 3.577h0l.006.008 4.99 6.477h0l.005.005c.465.593.963 1.017 1.617 1.256.63.23 1.33.26 2.138.221h.01l24.652-1.49h.008c1.137-.08 2.038-.396 2.632-1.071.588-.668.746-1.543.746-2.431V9.904c0-.584-.133-1.05-.508-1.486-.27-.311-.669-.602-1.113-.925a54.305 54.305 0 01-.176-.13l-.007-.004-.005-.004-6.772-4.761c-.838-.609-1.516-1.017-2.365-1.21-.824-.187-1.75-.156-3.047-.044L4.253 2.903z",fill:"#fff",stroke:"#fff",strokeWidth:"1.5"}),(0,o.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M25.257 3.158L5.176 4.637c-1.62.14-2.184 1.197-2.184 2.464v21.971c0 .987.352 1.83 1.198 2.959l4.72 6.126c.776.987 1.48 1.198 2.96 1.127l23.32-1.408c1.973-.14 2.537-1.057 2.537-2.606V10.552c0-.801-.316-1.032-1.25-1.714l-.16-.117-6.41-4.507c-1.55-1.126-2.184-1.268-4.65-1.056zM12.4 10.146c-1.904.129-2.337.158-3.418-.72l-2.75-2.183c-.28-.283-.14-.635.565-.705L26.102 5.13c1.62-.141 2.466.423 3.1.916l3.311 2.394c.141.07.493.492.07.492L12.645 10.13l-.245.016zM10.179 35.06V14.074c0-.916.281-1.338 1.126-1.41l22.898-1.337c.777-.07 1.128.423 1.128 1.338v20.844c0 .916-.14 1.691-1.41 1.761l-21.91 1.268c-1.269.07-1.832-.352-1.832-1.48zm21.63-19.86c.141.635 0 1.268-.635 1.34l-1.056.21v15.492c-.916.493-1.761.775-2.466.775-1.128 0-1.41-.352-2.255-1.408l-6.905-10.845v10.493l2.185.493s0 1.267-1.763 1.267l-4.86.282c-.142-.282 0-.986.492-1.127l1.269-.351V17.947l-1.761-.142c-.141-.634.21-1.549 1.197-1.62l5.214-.351 7.187 10.986V17.1l-1.832-.21c-.14-.776.422-1.339 1.127-1.409l4.863-.283z",fill:"#222"})]})})},429617:(e,t,n)=>{n.d(t,{m:()=>a});n(667294);var o=n(785893);const r={viewBox:"0 0 20 20",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M3 7.375h6.829a2.501 2.501 0 0 0 4.842 0H17a.625.625 0 1 0 0-1.25h-2.329a2.501 2.501 0 0 0-4.842 0H3a.625.625 0 1 0 0 1.25M12.25 5.5a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5"}),(0,o.jsx)("path",{fillRule:"evenodd",d:"M7.75 15.75a2.5 2.5 0 0 0 2.421-1.875H17a.625.625 0 1 0 0-1.25h-6.829a2.5 2.5 0 0 0-4.842 0H3a.625.625 0 1 0 0 1.25h2.329A2.5 2.5 0 0 0 7.75 15.75m0-1.25a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5",clipRule:"evenodd"})]})},a=(0,n(827282).IU)("sliders",r)},675987:(e,t,n)=>{n.r(t),n.d(t,{clearNotionLocalStorageWithNoPermission:()=>a});var o=()=>n(767751),r=()=>n(694050);function a(){o().Z.removeAllIfNoPermission(),r().Z.removeAllIfNoPermission()}}}]);