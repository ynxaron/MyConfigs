"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[5086],{568672:(e,t,n)=>{n.d(t,{Y:()=>i});var o=n(667294);function i(e,t){const n=(0,o.useRef)(),i=(0,o.useRef)(null),[r,a]=(0,o.useState)(t),l=(0,o.useCallback)((()=>a((e=>null===e?t:null))),[t]);function s(){var e;null===(e=n.current)||void 0===e||e.call(n)}const d=(0,o.useCallback)((()=>{i.current&&clearInterval(i.current)}),[]),c=(0,o.useCallback)((()=>{d(),i.current=setInterval(s,t)}),[d,t]);return(0,o.useEffect)((()=>{n.current=e}),[e]),(0,o.useEffect)((()=>(i.current&&clearInterval(i.current),null!==r&&(i.current=setInterval(s,r)),d)),[r,d]),{toggle:l,clear:d,reset:c}}},338215:(e,t,n)=>{n.d(t,{H:()=>m});n(267602),n(653476),n(470928),n(241792);var o=n(667294),i=()=>n(142735),r=()=>n(846550),a=()=>n(235665),l=()=>n(80122),s=()=>n(707513),d=()=>n(154186),c=()=>n(466970),u=()=>n(10986),g=()=>n(741543),f=()=>n(832770),p=()=>n(401848),h=n(785893);function x(e){const t=(0,r().yK)((e=>({codeContainer:{fontFamily:"monospace",background:e.codeBlockBackground,margin:0,marginBottom:12,fontSize:12,padding:16,borderRadius:12,maxHeight:404,overflow:"auto"},line:{display:"flex",gap:16},lineNumber:{color:e.lightTextColor,textAlign:"right",userSelect:"none",minWidth:24,flexShrink:0},codeContent:{whiteSpace:"pre-wrap",wordWrap:"break-word",color:e.lightTextColor,flex:1}})),[]),n=e.value.split("\n");return(0,h.jsx)("div",{style:t.codeContainer,children:n.map(((e,n)=>(0,h.jsxs)("div",{style:t.line,children:[(0,h.jsx)("div",{style:t.lineNumber,children:n+1}),(0,h.jsx)("div",{style:t.codeContent,children:e})]},n)))})}function m(e){const{functionKey:t,hideTitle:n}=e,{saveFunction:a,workflowStore:l,clientStore:s,threadStore:d}=(0,g().dP)(),{workflow:m,functionValue:v}=(0,i().VK)((()=>{var e;const n=(0,u().jI)({workflowStore:l,clientStore:s,threadStore:d});return{workflow:n,functionValue:null==n||null===(e=n.functions)||void 0===e?void 0:e.find((e=>e.key===t))}}),[l,t,d,s]),w=(0,o.useCallback)((e=>{if(!v)return;const t={...v,value:e||void 0};a(t)}),[v,a]),k=(0,o.useCallback)((e=>{const t=JSON.parse(e);a(t)}),[a]),[C,j]=(0,o.useState)(!1),b=(0,c().E)("workflows_debug_tools"),S=(0,r().yK)((e=>({container:{position:"relative"},debugButtonContainer:{position:"absolute",right:n?0:24,top:n?-26:0,zIndex:1},description:{marginBottom:12,color:e.lightTextColor}})),[n]);return m&&v?(0,h.jsxs)("div",{style:S.container,children:[!n&&(0,h.jsx)(p().z,{title:v.name,debugComponent:(0,h.jsx)(f().c,{value:JSON.stringify(v,null,2),onSave:k,language:"json"})}),b&&(0,h.jsx)("div",{style:S.debugButtonContainer,children:(0,h.jsx)(p().l,{isDebugging:C,onClick:()=>j((e=>!e))})}),v.description&&(0,h.jsx)("div",{style:S.description,children:v.description}),C?(0,h.jsx)(f().c,{value:v.value||"",onSave:w,language:"typescript"}):(0,h.jsx)(x,{value:v.value||""}),(0,h.jsx)(y,{fn:v,workflow:m,functionKey:t})]}):null}function y(e){var t,n,o;const{fn:i,functionKey:a}=e,l=(0,r().yK)((e=>({container:{display:"flex",flexDirection:"column",gap:4,marginTop:12,paddingTop:8},titleContainer:{display:"flex",alignItems:"center",gap:8},titleText:{fontSize:14,fontWeight:s().Ue.semibold},testStatus:{fontSize:13,color:e.lightTextColor}})),[]),d=(null===(t=i.tests)||void 0===t?void 0:t.length)||0,c=(null===(n=i.tests)||void 0===n?void 0:n.filter((e=>{var t;return null===(t=e.result)||void 0===t?void 0:t.passed})).length)||0;return(0,h.jsxs)("div",{style:l.container,children:[(0,h.jsxs)("div",{style:l.titleContainer,children:[(0,h.jsx)("span",{style:l.titleText,children:"Tests"}),(0,h.jsx)("span",{style:l.testStatus,children:`${c} / ${d} passed`})]}),null===(o=i.tests)||void 0===o?void 0:o.map((e=>(0,h.jsx)(v,{test:e,functionKey:a},e.description.name)))]})}function v(e){var t;const{test:n,functionKey:i}=e,[u,p]=(0,o.useState)(!1),x=(0,r().yK)((e=>({container:{display:"flex",flexDirection:"column",gap:4},titleButton:{display:"flex",alignItems:"flex-start",gap:8,padding:"4px 8px",margin:"8px 0px",borderRadius:6},textContainer:{display:"flex",flexDirection:"column",gap:4,flex:1},titleText:{fontSize:13,fontWeight:s().Ue.medium},subtitleText:{fontSize:13,color:e.lightTextColor},sideContainer:{display:"flex",alignItems:"center",gap:8},passedIcon:{marginTop:2,width:16,height:16,fill:e.accentColors.green[400]},failedIcon:{marginTop:2,width:16,height:16,fill:e.accentColors.red[400]}})),[]),{saveTest:m}=(0,g().dP)(),y=(0,o.useCallback)((e=>{const t=JSON.parse(e);m({test:t,functionKey:i})}),[i,m]),v=(0,o.useCallback)((()=>p((e=>!e))),[]),w=(0,c().E)("workflows_debug_tools"),k=(0,h.jsxs)(h.Fragment,{children:[null!==(t=n.result)&&void 0!==t&&t.passed?(0,a().$)(x.passedIcon):(0,l().X)(x.failedIcon),(0,h.jsxs)("div",{style:x.textContainer,children:[(0,h.jsx)("div",{style:x.titleText,children:n.description.name}),(0,h.jsx)("div",{style:x.subtitleText,children:n.description.description})]})]});return(0,h.jsxs)("div",{style:x.container,children:[w?(0,h.jsx)(d().Z,{onClick:v,style:x.titleButton,children:k}):(0,h.jsx)("div",{style:x.titleButton,children:k}),u&&(0,h.jsx)(f().c,{value:JSON.stringify(n,null,2),onSave:y,language:"json"})]})}},39736:(e,t,n)=>{n.d(t,{ti:()=>se,BT:()=>de,Ll:()=>ae,DV:()=>le});n(267602),n(470928),n(241792);var o=n(667294),i=()=>n(219727),r=()=>n(142735),a=()=>n(846550),l=()=>n(641772),s=()=>n(293996),d=()=>n(361929),c=()=>n(269672),u=()=>n(594860),g=()=>n(788860),f=()=>n(513670),p=()=>n(269299),h=()=>n(114087),x=()=>n(827973),m=()=>n(448419),y=()=>n(1910),v=()=>n(198829),w=()=>n(255577),k=()=>n(661297),C=()=>n(967092),j=()=>n(388284),b=()=>n(352230),S=()=>n(187435),I=()=>n(452435),T=()=>n(401806),M=()=>n(10986),D=()=>n(735167),K=()=>n(741543),H=()=>n(887554),W=()=>n(832770),B=()=>n(993662),A=()=>n(401848),R=(n(821057),n(653476),n.n(n(452027))),_=()=>n(766933),V=()=>n(843403),L=()=>n(146007),O=()=>n(374289),P=()=>n(335696),F=()=>n(783190),N=()=>n(265640),Z=()=>n(507159),U=()=>n(708518),z=()=>n(661641),E=()=>n(906651),J=()=>n(590058),$=()=>n(826955);const G=["database","workflow"],q=(0,g().vU)({database:{id:"syncChangesModal.source.database",defaultMessage:"Update the database"},databaseCaption:{id:"syncChangesModal.source.database.caption",defaultMessage:"Update the connected database with the schema defined in this workflow. May cause data loss."},databaseDiff:{id:"syncChangesModal.source.database.diff",defaultMessage:"Apply these changes to the database:"},workflow:{id:"syncChangesModal.source.workflow",defaultMessage:"Update this workflow"},workflowCaption:{id:"syncChangesModal.source.workflow.caption",defaultMessage:"Pull the latest schema from the database."},workflowDiff:{id:"syncChangesModal.source.workflow.diff",defaultMessage:"Apply these changes to the workflow:"}});function Y(e){return"database"===e?{label:q.database,caption:q.databaseCaption,diff:q.databaseDiff}:{label:q.workflow,caption:q.workflowCaption,diff:q.workflowDiff}}var Q=n(785893);function X(e){const{store:t,workflowStore:n,module:r,open:l,onOpenChange:s}=e,d=(0,i().O7)(),[c,u]=(0,o.useState)("workflow"),f=(0,o.useCallback)((()=>{u("workflow"),s(!1)}),[s]),{threadStore:h,clientStore:x}=(0,K().dP)(),m=(0,o.useCallback)((()=>{var e,o,i;if("database"!==r.type||null===(e=r.state)||void 0===e||!e.pointer)throw new Error("Invalid module");const a=(0,M().a5)({workflowStore:n,threadStore:h,clientStore:x}),l=(0,D()._4)({store:t,workflowValue:a,databaseModule:r}),s=(0,D().VI)({workflowValue:a,databaseModule:r,getCollectionSchema:(0,D().ge)(t)}),d=null===(o=$().NW.createChildStore(t,r.state.pointer))||void 0===o?void 0:o.getSchema(),c=(null===(i=(0,M().xI)(n).modules)||void 0===i?void 0:i.filter((e=>"database"===e.type)))||[],u=(0,S().v8)(c),g=(0,P().c1)({notionSchema:d,databaseKey:r.key,databaseKeyMap:u}),f=(0,P().yr)({databaseKey:r.key,databaseKeyMap:u,workflowSchema:r.state.schema,notionSchema:d,connectedRelationCollections:g,databaseModules:c});console.log({workflowDiff:l,notionDiff:s,mergeToNotion:f})}),[r,t,n,h,x]),v=(0,o.useCallback)((()=>{"database"===c?p().createAndCommit({userAction:"DatabaseModuleControls.handlePushToDatabases",environment:d,canUndo:!0,perform:e=>{(0,S().pX)({environment:d,workflowStore:n,transaction:e,store:t})}}):p().createAndCommit({userAction:"DatabaseModuleControls.handlePullFromDatabases",environment:d,canUndo:!0,perform:e=>(0,S().tO)({workflowStore:n,transaction:e})}),f()}),[c,d,n,f,t]),w=(0,a().yK)((e=>({container:{padding:16,display:"flex",flexDirection:"column",gap:8,minWidth:460,maxWidth:460,maxHeight:565},headerContainer:{display:"flex",flexDirection:"column",gap:8},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},footer:{display:"flex",justifyContent:"end"},dropdownButtonContainer:{display:"flex",flexDirection:"column",width:"100%",gap:8},selectedDataSourceLabel:{color:e.mediumTextColor},debugButton:{height:22,width:22,flexShrink:0,borderRadius:"50%"},debugButtonIcon:{width:14,height:14,fill:e.lightIconColor}})),[]);return"database"!==r.type?null:(0,Q.jsx)(U().Z,{open:l,onDismiss:f,render:()=>(0,Q.jsxs)("div",{style:w.container,children:[(0,Q.jsxs)("div",{style:w.headerContainer,children:[(0,Q.jsxs)("div",{style:w.header,children:[(0,Q.jsx)(z().q,{styleName:"Heading-17px/Semibold",children:(0,Q.jsx)(g()._H,{id:"syncChangesModal.title",defaultMessage:"Sync database changes"})}),(0,Q.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,Q.jsx)(y().Z,{ariaLabel:"Report bug",hasBackground:!0,icon:L().r,iconStyle:w.debugButtonIcon,style:w.debugButton,onClick:m}),(0,Q.jsx)(Z().Z,{onClose:f})]})]}),(0,Q.jsx)(ee,{selectedSource:c,setSelectedSource:u})]}),(0,Q.jsx)("div",{style:w.dropdownButtonContainer,children:(0,Q.jsx)(z().q,{styleName:"UIRegular-14px/Regular",color:"mediumTextColor",children:(0,Q.jsx)(g()._H,{...Y(c).diff})})}),(0,Q.jsx)(te,{selectedSource:c,store:t,workflowStore:n,databaseModule:r}),(0,Q.jsx)("div",{style:w.footer,children:(0,Q.jsx)(E().Z,{onClick:v,children:"database"===c?(0,Q.jsx)(g()._H,{id:"syncChangesModal.button.updateDatabase",defaultMessage:"Update database"}):(0,Q.jsx)(g()._H,{id:"syncChangesModal.button.updateWorkflow",defaultMessage:"Update workflow"})})})]})})}function ee(e){const{selectedSource:t,setSelectedSource:n}=e,o=(0,a().yK)((e=>({menu:{width:"100%",backgroundColor:e.inputBackground,borderRadius:6,boxShadow:"rgba(15, 15, 15, 0.1) 0px 0px 0px 1px inset"},button:{display:"flex",minHeight:34,margin:0,width:"100%"},content:{display:"flex",alignItems:"center"},selected:{width:"100%",color:e.mediumTextColor},downIcon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]);return(0,Q.jsx)(m().ZP,{popupType:C().kQ.Popup,sameWidthAsOrigin:!0,render:e=>(0,Q.jsx)(v().Z,{menuType:b().o.Popup,children:(0,Q.jsx)(w().ZP,{type:w().iW.Vertical,initialFocus:void 0,sections:[{key:"sources",render:e=>(0,Q.jsx)(j().Z,{...e}),items:G.map((t=>({key:t,render:e=>{const{label:n,caption:o}=Y(t);return(0,Q.jsx)(x().Z,{...e,title:n.defaultMessage,caption:null==o?void 0:o.defaultMessage,shouldWrapCaption:!0})},action:()=>{n(t),e.close()}})))}]})}),renderOrigin:e=>(0,Q.jsx)(x().Z,{style:o.menu,buttonStyle:o.button,title:(0,Q.jsxs)("div",{style:o.content,children:[(0,Q.jsx)("div",{style:o.selected,children:(0,Q.jsx)(z().q,{styleName:"UIRegular-14px/Regular",children:(0,Q.jsx)(g()._H,{...Y(t).label})})}),(0,O().i)(o.downIcon)]}),focused:!1,...e})})}function te(e){var t;const{selectedSource:n,store:i,workflowStore:l,databaseModule:s}=e,{threadStore:d,clientStore:c}=(0,K().dP)(),u=(0,r().VK)((()=>{const e=(0,M().a5)({workflowStore:l,threadStore:d,clientStore:c});return(0,D().N6)({store:i,workflowValue:e,databaseModule:s})}),[i,l,s,d,c]),[g,f]=(0,o.useState)(!1),p=(0,a().yK)((e=>({container:{display:"flex",flexDirection:"column",overflowX:"auto",overflowY:"auto",flexGrow:1,gap:4},propertyChangesContainer:{display:"flex",flexDirection:"column",gap:8},propertyChangeContainer:{padding:"2px 6px",borderRadius:4,backgroundColor:e.accentColors.yellow[100],color:e.accentColors.yellow[600],fontSize:12}})),[]),h="workflow"===n?null==u?void 0:u.addedProperties:null==u?void 0:u.removedProperties,x="workflow"===n?null==u?void 0:u.removedProperties:null==u?void 0:u.addedProperties;return(0,Q.jsxs)("div",{style:p.container,children:[(0,Q.jsxs)("div",{style:p.propertyChangesContainer,children:[null==h?void 0:h.map((e=>(0,Q.jsx)(ne,{name:e.name,type:e.type,change:"added"},e.name))),null==x?void 0:x.map((e=>(0,Q.jsx)(ne,{name:e.name,type:e.type,change:"removed"},e.name))),null==u||null===(t=u.changedProperties)||void 0===t?void 0:t.map((e=>(0,Q.jsx)(ne,{name:e.name,type:e.type,change:"changed"},e.name)))]}),(null==u?void 0:u.propertyMapChanged)&&(0,Q.jsx)("div",{style:p.propertyChangeContainer,children:"Metadata changed"}),g?(0,Q.jsx)(re,{selectedSource:n,store:i,workflowStore:l,databaseModule:s}):(0,Q.jsx)(N().D,{onClick:()=>f(!0),isGray:!0,children:"View details"})]})}function ne(e){const{name:t,type:n,change:o}=e,i=(0,a().yK)((e=>({container:{display:"flex",alignItems:"center",gap:8},name:{marginRight:4}})),[]);return(0,Q.jsxs)("div",{style:i.container,children:[(0,Q.jsx)(oe,{type:n}),(0,Q.jsx)("div",{style:i.name,children:t}),(0,Q.jsx)(ie,{status:o})]})}function oe(e){const{type:t}=e,n=(0,a().Fg)();return"content"===t?null:"external_relation"===t?(0,V().J)({width:16,height:16,padding:2,marginRight:6}):(0,Q.jsx)(_().ZP,{type:t,icon:void 0,size:16,theme:n})}function ie(e){const{status:t}=e,n=(0,a().yK)((e=>({container:{padding:"2px 4px",borderRadius:4,backgroundColor:"added"===t?e.accentColors.green[100]:"removed"===t?e.accentColors.red[100]:e.accentColors.yellow[100],color:"added"===t?e.accentColors.green[600]:"removed"===t?e.accentColors.red[600]:e.accentColors.yellow[600],fontSize:10,fontWeight:500}})),[t]);return(0,Q.jsx)("div",{style:n.container,children:"added"===t?"Added":"removed"===t?"Deleted":"Updated"})}function re(e){const{selectedSource:t,store:n,workflowStore:o,databaseModule:i}=e,{threadStore:l,clientStore:s}=(0,K().dP)(),d=(0,r().VK)((()=>{let e=null,r=null;const a=(0,M().a5)({workflowStore:o,threadStore:l,clientStore:s});if("workflow"===t){const t=(0,D()._4)({store:n,workflowValue:a,databaseModule:i});if(!t)return null;e=(0,F().qq)(t.moduleState,!0),r=(0,F().qq)(t.notionState,!0)}else{const t=(0,D().VI)({workflowValue:a,databaseModule:i,getCollectionSchema:(0,D().ge)(n)});if("needs-create"===t||"loading-database"===t)return null;e=(0,F().qq)(t.notionSchema,!0),r=(0,F().qq)(t.workflowSchema,!0)}const d=new(R()),c=d.diff_linesToChars_(e,r),u=d.diff_main(c.chars1,c.chars2,!1);return d.diff_charsToLines_(u,c.lineArray),u}),[t,n,o,i,l,s]),c=(0,a().yK)((e=>({container:{display:"flex",flexDirection:"column",padding:8,backgroundColor:e.inputBackground,borderRadius:4},pre:{lineHeight:1,margin:0,padding:0},diffNone:{fontFamily:"monospace"},diffDelete:{fontFamily:"monospace",background:e.accentColors.red[100],color:e.accentColors.red[500]},diffInsert:{fontFamily:"monospace",background:e.accentColors.green[100],color:e.accentColors.green[500]}})),[]);return(0,Q.jsx)("div",{style:c.container,children:(0,Q.jsx)("pre",{style:c.pre,children:null==d?void 0:d.map(((e,t)=>{let[n,o]=e;return(0,Q.jsx)("span",{style:n===J().NL?c.diffDelete:n===J().D$?c.diffInsert:c.diffNone,children:o},t)}))})})}function ae(e){var t,n;const{moduleKey:l}=e,d=(0,g().YB)(),{saveModule:c,workflowStore:f,store:p,clientStore:h,threadStore:x}=(0,K().dP)(),m=(0,r().VK)((()=>{var e;return null===(e=(0,M().jI)({workflowStore:f,threadStore:x,clientStore:h}))||void 0===e||null===(e=e.modules)||void 0===e?void 0:e.find((e=>e.key===l))}),[f,x,h,l]),y=(0,o.useCallback)((e=>{const t=JSON.parse(e);c(t)}),[c]),v=(0,a().yK)((e=>({failedIcon:{width:16,height:16,fill:e.accentColors.red[400]},errorMessageContainer:{display:"flex",flexDirection:"column",gap:8,padding:8,borderRadius:4,backgroundColor:e.accentColors.red[100]},errorMessage:{display:"flex",alignItems:"center",gap:8},container:{display:"flex",flexDirection:"column",gap:4}})),[]),w=(0,i().O7)(),C=m?u().O[m.type]:void 0,j="oauth2"===(null==C||null===(t=C.authentication)||void 0===t?void 0:t.type)&&w.device.isElectron,b=(0,r().VK)((()=>{if(m&&f&&!T()._.isValidAndConnected(m,f,p))return j?"Please visit this page in a web browser in order to authenticate this connection.":T()._.getMessageIfNotValid(m,d)}),[m,f,p,d,j]),[S,I]=(0,o.useState)(!1),D=(0,o.useCallback)((()=>{I(!0)}),[]),B=(0,o.useCallback)((e=>{I(e)}),[]);return C&&f&&m?(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(A().z,{title:T()._.getName(m,d),subtitle:T()._.getDescription(m,d),debugComponent:(0,Q.jsx)(W().c,{value:JSON.stringify(m,null,2),onSave:y,disabled:!f,language:"json"}),actions:(0,Q.jsx)(le,{module:m,store:p,workflowStore:f})}),(0,Q.jsxs)("div",{style:v.container,children:["oauth2"===(null===(n=C.authentication)||void 0===n?void 0:n.type)&&p&&f&&(0,Q.jsx)(de,{store:p,module:m,workflowStore:f}),"database"===m.type&&p&&f&&(0,Q.jsx)(H().A,{store:p,module:m,title:"View database"}),"ai"===m.type&&f&&(0,Q.jsx)(se,{module:m}),b&&(0,Q.jsxs)("div",{style:v.errorMessageContainer,children:[(0,Q.jsxs)("div",{style:v.errorMessage,children:[(0,s().G)(v.failedIcon),b]}),"database"===m.type&&(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(k().Z,{onClick:D,children:(0,Q.jsx)(g()._H,{id:"syncChangesModal.button",defaultMessage:"Sync schema changes"})}),(0,Q.jsx)(X,{store:p,workflowStore:f,module:m,open:S,onOpenChange:B})]})]})]})]}):null}function le(e){const{module:t,store:n,workflowStore:a}=e,l=(0,i().O7)(),s=(0,r().VK)((()=>n.getSpaceId()),[n]),{handleConnect:c,authDetailModalArgs:g}=(0,B().pc)({module:t,spaceId:s,workflowPointer:{table:d().An,id:a.id,spaceId:s}}),h=function(e){var t;const{module:n,handleConnect:i}=e,r=u().O[n.type],a=n.state,l=!(!a||!("connectionPointer"in a))&&Boolean(a.connectionPointer),{saveModule:s}=(0,K().dP)(),d=(0,o.useCallback)((()=>{s({...n,state:{}})}),[n,s]),c="oauth2"===(null===(t=r.authentication)||void 0===t?void 0:t.type),g="notionmail"===n.type;if(!c&&!g)return[];return f().oA([{key:"connect",action:i,render:e=>(0,Q.jsx)(x().Z,{...e,title:l?"Reconnect":"Connect"})},l&&{key:"disconnect",action:d,render:e=>(0,Q.jsx)(x().Z,{...e,title:"Disconnect",isRedOnHover:!0})}])}({module:t,handleConnect:c}),m=function(e){const{store:t,workflowStore:n,module:a}=e,l=(0,i().O7)(),s="database"===a.type?a:void 0,{threadStore:d,clientStore:c}=(0,K().dP)(),u=(0,o.useCallback)((()=>{s&&p().createAndCommit({userAction:"DatabaseModuleControls.handleDisconnectDatabase",environment:l,canUndo:!0,perform:e=>{(0,I().disconnectDatabase)({workflowStore:n,module:s,transaction:e})}})}),[s,n,l]),g=(0,o.useCallback)((()=>{p().createAndCommit({userAction:"DatabaseModuleControls.handleCreateDatabase",environment:l,canUndo:!0,perform:e=>(0,S().P4)({environment:l,store:t,workflowStore:n,transaction:e})})}),[t,n,l]),h=(0,r().VK)((()=>{const e=(0,M().a5)({workflowStore:n,threadStore:d,clientStore:c});return(0,D().Dk)({databaseModule:s,workflowValue:e,getCollectionSchema:(0,D().ge)(t)})}),[t,s,n,d,c]);if(!s)return[];return f().oA(["needs-create"===h&&{key:"create",action:g,render:e=>(0,Q.jsx)(x().Z,{...e,title:"Create databases"})},"loading-database"!==h&&{key:"disconnect",action:u,render:e=>(0,Q.jsx)(x().Z,{...e,title:"Disconnect database",isRedOnHover:!0})}])}({store:n,workflowStore:a,module:t}),y=(0,o.useCallback)((()=>{a&&p().createAndCommit({userAction:"WorkflowModule.handleRemoveModule",environment:l,canUndo:!0,perform:e=>{(0,I().removeModule)({workflowStore:a,module:t,transaction:e})}})}),[t,a,l]),v=(0,o.useMemo)((()=>{const e=[{key:"actions",render:e=>(0,Q.jsx)(j().Z,{...e}),items:[...h,...m,{key:"remove",action:y,render:e=>(0,Q.jsx)(x().Z,{...e,title:"Remove",isRedOnHover:!0})}]}];return e}),[y,h,m]);return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(ce,{sections:v}),(0,Q.jsx)(B().Ds,{...g})]})}function se(e){var t;const{module:n}=e,i=(0,a().yK)((e=>({promptNameRow:{display:"flex",alignItems:"center",gap:8},promptName:{flexShrink:0}})),[]),{saveModule:l,workflowStore:s,threadStore:d,clientStore:u}=(0,K().dP)(),f=(0,o.useCallback)((e=>{var t;l({...n,state:{...n.state,promptNamesToModel:{...(null===(t=n.state)||void 0===t?void 0:t.promptNamesToModel)||{},[e.promptName]:e.model}}})}),[l,n]),p=(0,r().VK)((()=>{const e=(0,M().jI)({workflowStore:s,threadStore:d,clientStore:u});return e?(0,c().Cd)(e):[]}),[s,d,u]),x=(null===(t=n.state)||void 0===t?void 0:t.promptNamesToModel)||{};return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(g()._H,{id:"ai.promptNames",defaultMessage:"Prompts"}),p.map((e=>(0,Q.jsxs)("div",{style:i.promptNameRow,children:[(0,Q.jsx)("div",{style:i.promptName,children:e}),(0,Q.jsx)(h().q,{model:x[e],setModel:t=>f({promptName:e,model:t}),format:"button"})]},e)))]})}function de(e){const{module:t}=e,n=t.state,o=!(!n||!("connectionPointer"in n))&&Boolean(n.connectionPointer);return(0,Q.jsx)(Q.Fragment,{children:o&&(0,Q.jsx)("div",{children:"Connected"})})}function ce(e){const{sections:t}=e,n=(0,i().Fy)(),o=(0,a().yK)((e=>({iconButton:{height:24,width:24,flexShrink:0,borderRadius:4},icon:{height:16,width:16}})),[]);return(0,Q.jsx)(m().ZP,{originGap:0,alignmentToOrigin:m().vR.Center,placementToOrigin:m().pO.Bottom,popupType:n.isMobile?C().kQ.SlideUp:C().kQ.Popup,render:()=>{const e={menuType:b().o.Popup,width:250};return(0,Q.jsx)(v().Z,{...e,children:(0,Q.jsx)(w().ZP,{type:w().iW.Vertical,sections:t,initialFocus:0})})},renderOrigin:e=>(0,Q.jsx)(y().Z,{...e,ariaLabel:"More",hasBackground:!0,icon:l().o,iconStyle:o.icon,style:o.iconButton})})}},401848:(e,t,n)=>{n.d(t,{l:()=>c,z:()=>u});var o=n(667294),i=()=>n(846550),r=()=>n(146007),a=()=>n(707513),l=()=>n(1910),s=()=>n(466970),d=n(785893);function c(e){const{isDebugging:t,onClick:n}=e;return(0,d.jsx)(l().Z,{icon:r().r,ariaLabel:"Debug",onClick:n,isBlue:t})}function u(e){const{title:t,subtitle:n,debugComponent:r,actions:l}=e,u=(0,i().yK)((e=>({paneHeaderContainer:{},paneHeader:{display:"flex",alignItems:"center",padding:"1px 0px 0px 0px",justifyContent:"space-between"},paneHeaderTitle:{color:e.text.primary,fontSize:17,fontStyle:"normal",fontWeight:a().Ue.medium,lineHeight:"22px",letterSpacing:"-0.442px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",height:28,display:"flex"},paneHeaderActions:{display:"flex",alignItems:"center",gap:4},paneHeaderSubtitle:{},debugContainer:{marginBottom:12}})),[]),g=(0,s().E)("workflows_debug_tools"),[f,p]=(0,o.useState)(!1),h=(0,o.useCallback)((()=>p((e=>!e))),[]);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{style:u.paneHeaderContainer,children:[(0,d.jsxs)("div",{style:u.paneHeader,children:[(0,d.jsx)("div",{style:u.paneHeaderTitle,children:t}),(0,d.jsxs)("div",{style:u.paneHeaderActions,children:[g&&(0,d.jsx)(c,{isDebugging:f,onClick:h}),l]})]}),n&&(0,d.jsx)("div",{style:u.paneHeaderSubtitle,children:n})]}),f&&(0,d.jsx)("div",{style:u.debugContainer,children:r})]})}},897184:(e,t,n)=>{n.d(t,{q:()=>X});n(821057),n(267602),n(653476),n(470928),n(241792),n(228244);var o=()=>n(730120),i=n(667294),r=()=>n(219727),a=()=>n(142735),l=()=>n(846550),s=()=>n(928374),d=()=>n(135796),c=()=>n(80122),u=()=>n(38370),g=()=>n(119239),f=()=>n(318673),p=()=>n(293996),h=()=>n(717064),x=()=>n(409873),m=()=>n(237874),y=n(785893);const v=(0,n(827282).IU)("sidebarSearch",{viewBox:"0 0 20 20",svg:(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.24609 8.82031C3.24609 8.05469 3.38965 7.33691 3.67676 6.66699C3.96842 5.99251 4.36947 5.40007 4.87988 4.88965C5.3903 4.37467 5.98047 3.97363 6.65039 3.68652C7.32487 3.39941 8.04492 3.25586 8.81055 3.25586C9.58073 3.25586 10.3008 3.39941 10.9707 3.68652C11.6452 3.97363 12.2376 4.37467 12.748 4.88965C13.2585 5.40007 13.6572 5.99251 13.9443 6.66699C14.236 7.33691 14.3818 8.05469 14.3818 8.82031C14.3818 9.42188 14.2884 9.99382 14.1016 10.5361C13.9193 11.0785 13.6663 11.5729 13.3428 12.0195L16.46 15.1504C16.5557 15.2415 16.6263 15.3486 16.6719 15.4717C16.722 15.5947 16.7471 15.7246 16.7471 15.8613C16.7471 16.0527 16.7038 16.2259 16.6172 16.3809C16.5306 16.5358 16.4121 16.6566 16.2617 16.7432C16.1113 16.8343 15.9382 16.8799 15.7422 16.8799C15.6055 16.8799 15.4733 16.8548 15.3457 16.8047C15.2227 16.7591 15.111 16.6862 15.0107 16.5859L11.873 13.4482C11.4355 13.7399 10.957 13.9701 10.4375 14.1387C9.92253 14.3027 9.38021 14.3848 8.81055 14.3848C8.04492 14.3848 7.32487 14.2412 6.65039 13.9541C5.98047 13.667 5.3903 13.2682 4.87988 12.7578C4.36947 12.2474 3.96842 11.6572 3.67676 10.9873C3.38965 10.3128 3.24609 9.59049 3.24609 8.82031ZM4.70215 8.82031C4.70215 9.38997 4.80697 9.92318 5.0166 10.4199C5.23079 10.9167 5.52702 11.3542 5.90527 11.7324C6.28353 12.1061 6.72103 12.4001 7.21777 12.6143C7.71452 12.8285 8.24544 12.9355 8.81055 12.9355C9.38021 12.9355 9.91341 12.8285 10.4102 12.6143C10.9069 12.4001 11.3421 12.1061 11.7158 11.7324C12.0941 11.3542 12.3903 10.9167 12.6045 10.4199C12.8187 9.92318 12.9258 9.38997 12.9258 8.82031C12.9258 8.25521 12.8187 7.72428 12.6045 7.22754C12.3903 6.73079 12.0941 6.29329 11.7158 5.91504C11.3421 5.53678 10.9069 5.24284 10.4102 5.0332C9.91341 4.81901 9.38021 4.71191 8.81055 4.71191C8.24544 4.71191 7.71452 4.81901 7.21777 5.0332C6.72103 5.24284 6.28353 5.53678 5.90527 5.91504C5.52702 6.29329 5.23079 6.73079 5.0166 7.22754C4.80697 7.72428 4.70215 8.25521 4.70215 8.82031Z"})});var w=()=>n(724494),k=()=>n(783190),C=()=>n(788860),j=()=>n(342792),b=()=>n(696459),S=()=>n(707513),I=()=>n(959137),T=()=>n(154186),M=()=>n(448419),D=()=>n(1910),K=()=>n(573357),H=()=>n(291198),W=()=>n(312578),B=()=>n(661297),A=()=>n(654133),R=()=>n(641506),_=()=>n(677559),V=()=>n(466970),L=()=>n(644248),O=()=>n(998901),P=()=>n(814866),F=()=>n(452435),N=()=>n(10986);const Z=1.5,U=(16-Z)/2+4,z=26,E=2-z,J=`calc(100% + ${E}px)`,$=`calc(100% + ${E+z}px)`;var G=()=>n(642611),q=()=>n(401848),Y=()=>n(868997);function Q(){return(0,l().yK)((e=>({code:{whiteSpace:"pre-wrap",wordWrap:"break-word",fontFamily:"monospace",background:e.codeBlockBackground,color:e.regularTextColor,padding:8,margin:0,fontSize:12},failedIcon:{width:16,height:16,fill:e.accentColors.red[400]},infoIcon:{width:16,height:16,fill:e.accentColors.yellow[400]},infoMessage:{display:"flex",alignItems:"center",justifyContent:"center",gap:8,padding:13,backgroundColor:e.accentColors.yellow[50],color:e.accentColors.yellow[400],fontSize:13,marginBottom:16},inlineIcon:{width:16,height:16,fill:e.icon.tertiary},logEntryLine:{display:"flex",alignItems:"center",gap:6,padding:4,borderRadius:4,fontSize:13,fontWeight:S().Ue.medium}})),[])}function X(e){const{runStore:t,workflowStore:n,store:s,setThreadId:d}=e,u=(0,r().O7)(),f=(0,l().yK)((e=>({topBar:{display:"flex",alignItems:"center",gap:8,padding:12},heading:{fontWeight:S().Ue.semibold,fontSize:20,marginBottom:8},subheading:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:4,fontWeight:S().Ue.semibold,fontSize:14,marginTop:16},bodyContainer:{padding:"0px 16px"},showLogsInFunctionsButton:{fontSize:13,fontWeight:S().Ue.medium,color:e.lightTextColor,borderRadius:4,padding:"2px 6px"}})),[]),p=Q(),h=(0,a().VK)((()=>{var e;return null===(e=t.getData())||void 0===e?void 0:e.trigger_key}),[t]),v=(0,a().VK)((()=>{var e,o;const i=null===(e=t.getData())||void 0===e?void 0:e.trigger_key;if(!i)return;const r=null===(o=(0,N().xI)(n).functions)||void 0===o?void 0:o.find((e=>e.key===i));return(null==r?void 0:r.name)||i}),[t,n]),w=(0,a().VK)((()=>t.getCreatedAt()),[t]),C=(0,a().VK)((()=>{var e;return null===(e=t.getData())||void 0===e?void 0:e.finished_at}),[t]),j=(0,i.useMemo)((()=>{if(!C||!w)return;return o().ou.fromMillis(C).diff(o().ou.fromMillis(w)).toFormat("m'm' ss's'")}),[C,w]),b=(0,a().VK)((()=>{var e;return null===(e=n.getModel())||void 0===e?void 0:e.getVersion()}),[n]),M=(0,a().VK)((()=>{var e;return null===(e=t.getData())||void 0===e?void 0:e.workflow_version}),[t]),K=(0,i.useCallback)((()=>{(0,P().mS)({environment:u,store:s,navigationState:{route:{type:"runs"}}})}),[u,s]),{value:H}=(0,_().XJ)(I().F.clipboardActions),W=(0,i.useCallback)((()=>{const e=window.location.href;H&&H.copyString({environment:u,stringValue:e,copiedMessage:H.clipboardMessages.copiedLinkToClipboard})}),[u,H]),B=(0,a().VK)((()=>{var e;return null===(e=t.getData())||void 0===e?void 0:e.trigger_data}),[t]),A=(0,a().VK)((()=>{var e;return null===(e=t.getData())||void 0===e?void 0:e.event_log}),[t]),R=(0,a().VK)((()=>{var e;const n=null===(e=t.getData())||void 0===e?void 0:e.error;return n&&n.message||""}),[t]),L=(0,a().VK)((()=>{var e;return null===(e=t.getData())||void 0===e?void 0:e.status}),[t]),[O,F]=(0,i.useState)(!1),Z=(0,i.useCallback)((()=>F((e=>!e))),[]),[U,z]=(0,i.useState)(!1),E=(0,i.useCallback)((()=>z((e=>!e))),[]),[J,$]=(0,i.useState)(!1),G=(0,V().E)("workflows_debug_tools");return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{style:f.topBar,className:"workflow-run-top-bar",children:[(0,y.jsx)(D().Z,{onClick:K,icon:g().t,ariaLabel:"close run viewer"}),(0,y.jsx)("div",{style:{flexGrow:1}}),(0,y.jsx)(D().Z,{onClick:W,icon:m().N,ariaLabel:"open run in builder"}),(0,y.jsx)(ee,{workflowStore:n,store:s,triggerKey:h,eventLog:A,runStore:t,error:R,setThreadId:d})]}),M&&b!==M&&(0,y.jsxs)("div",{style:p.infoMessage,children:[(0,x().D)(p.infoIcon),"Ran on previous version of workflow"]}),(0,y.jsxs)("div",{style:f.bodyContainer,children:[(0,y.jsx)("div",{style:f.heading,children:v}),(0,y.jsx)(de,{date:w,duration:j}),R&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{style:f.subheading,children:[(0,y.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,c().X)(p.failedIcon),"Error"]}),(0,y.jsx)("div",{style:{flexGrow:1}})]}),(0,y.jsx)("div",{style:p.code,children:R})]}),A&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{style:f.subheading,children:["Timeline",(0,y.jsx)("div",{style:{flexGrow:1}}),G&&(0,y.jsx)(q().l,{isDebugging:O,onClick:Z}),(0,y.jsx)(T().Z,{style:f.showLogsInFunctionsButton,onClick:()=>$((e=>!e)),children:J?"Hide logs":"Show all logs"})]}),O&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{style:f.subheading,children:"Trigger variables"}),(0,y.jsx)("div",{style:p.code,children:JSON.stringify(JSON.parse(B||"{}"),null,2)}),(0,y.jsxs)("div",{style:f.subheading,children:[U?"Console Log (without effects)":"Event Log",(0,y.jsx)(q().l,{isDebugging:U,onClick:E})]}),(0,y.jsx)("div",{style:p.code,children:U?A.filter((e=>"log"===e.type)).map(k().hi).join("\n\n"):JSON.stringify(A,null,2)})]}),(0,y.jsx)(oe,{triggerName:v,triggerData:B,eventLog:A,workflowStore:n,store:s,shouldShowLogsInFunctions:J,hasRunFinished:"success"===L||"failure"===L})]})]})]})}function ee(e){const{workflowStore:t,store:n,runStore:o,error:a,setThreadId:s}=e,d=(0,r().Fy)(),c=(0,r().O7)(),u=!!a,[g,f]=i.useState(""),p=(0,l().yK)((e=>({wrap:{width:340,padding:8},button:{paddingLeft:6}})),[]),x=(0,i.useCallback)((()=>{if(!u&&!g)return;if(!n||!t)throw new Error("WorkflowRunFeedbackButton: store or workflowStore is undefined");const e=o.getData(),i=o.getCreatedAt();if(!e)throw new Error("WorkflowRunFeedbackButton: runData is undefined");const r={id:(0,j().ZP)(),type:"workflow-runs",value:[{id:o.id,created_at:i,data:e}],traceId:(0,j().ZP)()},a=(0,F().startEditWorkflow)({environment:c,workflowStore:t,store:n,inputValue:g||"",additionalSteps:[r]});a&&s({id:a})}),[o,n,t,c,u,s,g]);return u?(0,y.jsx)(B().Z,{style:p.button,icon:h().Q,size:"sm",onClick:x,children:"Fix with AI"}):(0,y.jsx)(M().ZP,{popupType:d.isMobile?M().Z4.BottomSheet:M().Z4.Popup,placementToOrigin:M().pO.Bottom,alignmentToOrigin:M().vR.Center,originGap:4,renderOrigin:e=>(0,y.jsx)(B().Z,{style:p.button,icon:h().Q,size:"sm",...e,children:"Fix with AI"}),render:e=>(0,y.jsx)(K().Z,{capture:!0,render:t=>(0,y.jsx)("div",{style:p.wrap,...t,children:(0,y.jsx)(H().Z,{value:g,textarea:!0,autoFocus:!0,autosize:!0,autosizeMinHeight:200,autosizeMaxHeight:600,onChange:e=>f(e.target.value),textareaSubmitOnEnter:!0,onSubmit:()=>{e.close(),x()},placeholder:"What should I fix about this run?"})})})})}function te(e){const{triggerName:t,triggerData:n}=e,o=Q();return(0,y.jsx)(le,{isInError:!1,iconIfNotInError:(0,s().M)(o.inlineIcon),fullContent:JSON.stringify(JSON.parse(n||"{}"),null,2),children:`Triggered by: ${t||"Unknown"}`})}function ne(e){const{functionKey:t,stringifiedDebugContent:n,isFunctionCall:o,workflowStore:l,store:s}=e,d=(0,r().O7)(),c=(0,a().VK)((()=>{var e;return null===(e=(0,N().xI)(l).functions)||void 0===e?void 0:e.find((e=>e.key===t))}),[l,t]),g=Q(),f=(0,i.useCallback)((()=>{(0,P().mS)({environment:d,store:s,navigationState:{route:{type:"function",key:t}}})}),[d,t,s]);return(0,y.jsxs)(le,{fullContent:n,iconIfNotInError:o?(0,u().z)(g.inlineIcon):void 0,children:[!o&&"Finished: ",(0,y.jsx)(T().Z,{onClick:f,children:null==c?void 0:c.name})]})}function oe(e){const{triggerName:t,triggerData:n,eventLog:o,store:i,workflowStore:r,shouldShowLogsInFunctions:a,hasRunFinished:s}=e,d=(0,l().yK)((e=>({list:{...R().mK,color:e.regularTextColor}})),[]);return(0,y.jsxs)("ul",{style:d.list,children:[(0,y.jsx)("li",{children:(0,y.jsx)(te,{triggerName:t,triggerData:n})}),o.map(((e,t)=>{const n=(()=>{switch(e.type){case"log":return a?(0,y.jsx)(re,{event:e},`${e.type}-${t}`):null;case"effect":return(0,y.jsx)(se,{effect:e.effect,hasRunFinished:s});case"functionCall":return(0,y.jsx)(ne,{functionKey:e.function_key,stringifiedDebugContent:JSON.stringify(e.function_arguments,null,2),isFunctionCall:!0,workflowStore:r,store:i});case"functionReturn":return a?(0,y.jsx)(ne,{functionKey:e.function_key,stringifiedDebugContent:JSON.stringify(e.function_return,null,2),isFunctionCall:!1,workflowStore:r,store:i}):null;default:return(0,b().t1)(e)}})();return(0,y.jsx)("li",{children:n},`${e.type}-${t}`)}))]})}function ie(e){const{errorMessage:t,stack:n,isExpanded:o}=e,i=Q();return(0,y.jsxs)(y.Fragment,{children:[t,o&&(0,y.jsx)("div",{style:i.code,children:n})]})}function re(e){const{event:t}=e,n=Q(),o=(0,l().yK)((e=>({inlineLogMessage:{marginRight:4},expandableContextText:{color:e.text.secondary},messages:{display:"block"}})),[]),{logLevelPrefix:r,isError:a}=(0,i.useMemo)((()=>{switch(t.level){case"error":return{logLevelPrefix:"Error: ",isError:!0};case"warn":return{logLevelPrefix:"Warning: ",isError:!1};case"info":return{logLevelPrefix:void 0,isError:!1};default:(0,b().t1)(t.level)}}),[t.level]),s=(0,i.useMemo)((()=>t.messages.some((e=>"object"===e.type||"error"===e.type))),[t.messages]),d=(0,y.jsx)("div",{style:n.code,children:t.messages.map(((e,t)=>{switch(e.type){case"msg":return e.data;case"object":return(0,y.jsx)("div",{children:JSON.stringify(JSON.parse(e.data),null,2)},`${e.type}-${t}`);case"undefined":return"undefined";case"error":return(0,y.jsx)(ie,{errorMessage:e.message,stack:e.stack,isExpanded:!0},`${e.type}-${t}`);case"database":return`${e.database_key}`;default:return(0,b().t1)(e)}}))});return(0,y.jsxs)(le,{isInError:a,iconIfNotInError:void 0,fullContent:s?d:void 0,children:[r,(0,y.jsx)("div",{style:o.messages,children:t.messages.map(((e,t)=>{switch(e.type){case"msg":return(0,y.jsx)("span",{style:o.inlineLogMessage,children:e.data});case"object":return null;case"undefined":return"undefined";case"error":return(0,y.jsx)(ie,{errorMessage:e.message,stack:e.stack,isExpanded:!1});case"database":return(0,y.jsx)("span",{style:o.inlineLogMessage,children:e.database_key});default:return(0,b().t1)(e)}}))}),s&&(0,y.jsx)("div",{style:o.expandableContextText,children:"{Collapsed information}"})]})}function ae(e){const{effect:t}=e;if(!t.moduleType)return(0,y.jsx)(C()._H,{defaultMessage:"Unknown effect, {effectKey}",id:"workflow.run.effect.unknown.description",values:{effectKey:t.key}});const n=G().D[t.moduleType].effect[t.key];if(!n)return(0,y.jsx)(C()._H,{defaultMessage:"Did not find effect definition for {effectKey}, inside module {moduleType}",id:"workflow.run.effect.unknownEffect.description",values:{effectKey:t.key,moduleType:t.moduleType}});if("minimal"===n.runDefinitionType)return(0,y.jsx)(C()._H,{...n.description});if("full"===n.runDefinitionType){const e=n.RunLog;return(0,y.jsx)(e,{effect:t})}return(0,b().t1)(n)}function le(e){const{children:t,isInError:n,iconIfNotInError:o,fullContent:r}=e,a=!!r,s=Q(),[d,c]=(0,i.useState)(!1),g=(0,i.useCallback)((()=>{c((e=>!e))}),[]),[f,h]=(0,L().C)(),x=(0,l().yK)((e=>({logEntryLine:{...s.logEntryLine,...o?{}:{marginLeft:18,paddingLeft:8}},errorLogEntryLine:{...s.logEntryLine,gap:0,alignItems:"center",justifyContent:"left",marginLeft:-1},threadLine:{position:"absolute",backgroundColor:e.stroke.secondary,borderRadius:2,width:Z,height:o?J:$,left:U,top:o?z:0},logEntryContainer:{position:"relative"},flexGrow:{flexGrow:1},actionButtons:{display:"flex",gap:4,opacity:h?1:0}})),[s.logEntryLine,o,h]),m=a?[{icon:u().z,text:"Show all information",onClick:g}]:[],v=n?(0,y.jsx)(B().Z,{icon:p().G,iconStyle:s.failedIcon,color:"uiRed",style:x.errorLogEntryLine,onClick:g,children:t}):(0,y.jsxs)("div",{ref:f,style:x.logEntryLine,children:[o,t,(0,y.jsx)("div",{style:x.flexGrow}),(0,y.jsx)("div",{style:x.actionButtons,children:m.map((e=>(0,y.jsx)(D().Z,{icon:e.icon,ariaLabel:e.text,onClick:e.onClick},e.text)))})]});return(0,y.jsxs)("div",{style:x.logEntryContainer,children:[v,(0,y.jsx)("div",{style:x.threadLine}),d&&(0,y.jsx)("div",{style:s.code,children:r})]})}function se(e){const{effect:t,hasRunFinished:n}=e,o=Q(),i=JSON.stringify(t,null,2),r=t.finished,a=!r&&n,l=r?"read"===t.type?v(o.inlineIcon):(0,f().g)(o.inlineIcon):(0,y.jsx)(W().Z,{size:"sm",style:o.inlineIcon});return(0,y.jsxs)(le,{isInError:a,iconIfNotInError:l,fullContent:i,children:[!r&&(0,y.jsx)(C()._H,{defaultMessage:"Did not finish: ",id:"workflow.run.effect.didNotFinish"}),(0,y.jsx)(ae,{effect:t})]})}function de(e){const{date:t,duration:n}=e,i=(0,l().yK)((e=>({container:{display:"flex",gap:16,alignItems:"center",color:e.text.secondary,fontSize:14,fontWeight:S().Ue.regular},item:{display:"flex",alignItems:"center",gap:8,backgroundColor:e.surface.wash,padding:"4px 8px",borderRadius:6},icon:{width:14,height:14,fill:e.text.secondary}})),[]);return(0,y.jsxs)("div",{style:i.container,children:[t&&(0,y.jsxs)("div",{style:i.item,children:[(0,d().C)(i.icon),(0,y.jsx)(A().Z,{placement:O().Placement.Bottom,render:e=>(0,y.jsx)("div",{...e,children:(0,y.jsx)(Y().w,{timestamp:t})}),renderTooltip:()=>(0,y.jsx)("div",{children:o().ou.fromMillis(t).toFormat("LLL dd, yyyy 'at' h:mm a")})})]}),n&&(0,y.jsxs)("div",{style:i.item,children:[(0,w().S)(i.icon),n]})]})}},868997:(e,t,n)=>{n.d(t,{r:()=>R,w:()=>L});n(267602),n(470928),n(241792);var o=()=>n(730120),i=n(667294),r=()=>n(219727),a=()=>n(142735),l=()=>n(846550),s=()=>n(801812),d=()=>n(235665),c=()=>n(80122),u=()=>n(728267),g=()=>n(76910),f=()=>n(899548),p=()=>n(724494),h=()=>n(365873),x=()=>n(788860),m=()=>n(707513),y=()=>n(824462),v=()=>n(628370),w=()=>n(154186),k=()=>n(552064),C=()=>n(1910),j=()=>n(573357),b=()=>n(291198),S=()=>n(312578),I=()=>n(661297),T=()=>n(654133),M=()=>n(568672),D=()=>n(804217),K=()=>n(826955),H=()=>n(814866),W=()=>n(10986),B=n(785893);const A=3e4;function R(e){const{store:t,workflowStore:n}=e,o=(0,r().O7)(),[d,c]=(0,i.useState)(""),f=(0,l().yK)((e=>({container:{width:"100%",maxWidth:1e3,margin:"0px auto",padding:"0px 20px"},paneHeader:{display:"flex",alignItems:"center",padding:"1px 8px 0px 8px",marginBottom:18,justifyContent:"space-between"},paneHeaderTitle:{color:e.text.primary,fontSize:20,fontStyle:"normal",fontWeight:m().Ue.medium,lineHeight:"22px",letterSpacing:"-0.442px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",height:28,display:"flex"},list:{display:"flex",flexDirection:"column",gap:1,alignItems:"flex-start",alignSelf:"stretch"},emptyStateContainer:{display:"flex",justifyContent:"center",alignItems:"flex-start",paddingTop:96,height:"100%"},searchInput:{width:200},refreshIcon:{width:16,height:void 0,fill:e.mediumIconColor},headerActions:{display:"flex",alignItems:"center",gap:8}})),[]),p=(0,a().VK)((()=>{const e=t.getSpaceId();if(e)return{spaceId:e,workflowId:n.id,containsSubstring:d}}),[t,n,d]),[{value:h},v]=(0,s().r5)((async()=>{if(!p)return;if(!D().default.state.online)return;const e=await y().callApi({eventName:"getWorkflowRuns",environment:o,data:p});return"failed"!==e.type?e.data.runIds:void 0}),[p,o]);return(0,M().Y)(v,A),(0,B.jsxs)("div",{style:f.container,children:[(0,B.jsxs)("div",{style:f.paneHeader,children:[(0,B.jsx)("div",{style:f.paneHeaderTitle,children:(0,B.jsx)(x()._H,{defaultMessage:"Run history",id:"workflowRuns.header"})}),h&&(h.length>0||d)&&(0,B.jsxs)("div",{style:f.headerActions,children:[(0,B.jsx)(C().Z,{icon:g().n,iconStyle:f.refreshIcon,onClick:v,ariaLabel:"Label for the refresh button"}),(0,B.jsx)(P,{value:d,onChange:c,style:f.searchInput})]})]}),h&&(h.length>0||d)?(0,B.jsx)("div",{style:f.list,children:h.map((e=>(0,B.jsx)(_,{store:t,workflowStore:n,runId:e},e)))}):(0,B.jsx)("div",{style:f.emptyStateContainer,children:(0,B.jsx)(k().Z,{icon:u().a,title:"No runs yet",description:"Workflow runs will appear here",cta:(0,B.jsx)(I().Z,{onClick:v,children:(0,B.jsx)(x()._H,{defaultMessage:"Refresh",id:"workflowRuns.refreshButton"})})})})]})}function _(e){const{store:t,runId:n,workflowStore:o}=e,s=(0,r().O7)(),d=(0,l().yK)((e=>({button:{display:"flex",gap:8,padding:"4px 8px",margin:"2px 0px",borderRadius:6,width:"100%"},textContainer:{display:"flex",flexDirection:"column",gap:4,flex:1},titleText:{fontSize:13,fontWeight:m().Ue.medium},subtitleContainer:{display:"flex",flexDirection:"row",alignItems:"center",fontSize:13,color:e.lightTextColor},sideContainer:{display:"flex",alignItems:"center",gap:8}})),[]),c=(0,i.useMemo)((()=>K().US.createChildStore(t,{table:h().I_,id:n,spaceId:t.getSpaceId()})),[t,n]),u=(0,a().VK)((()=>{var e,t;const n=null===(e=c.getData())||void 0===e?void 0:e.trigger_key;if(!n)return;const i=null===(t=(0,W().xI)(o).functions)||void 0===t?void 0:t.find((e=>e.key===n));return(null==i?void 0:i.name)||n}),[c,o]),g=(0,a().VK)((()=>{var e,t;const n=c.getCreatedAt(),o=null===(e=c.getData())||void 0===e?void 0:e.trigger_at;return"pending"===(null===(t=c.getData())||void 0===t?void 0:t.status)?o:n}),[c]),f=(0,a().VK)((()=>{var e;return null===(e=c.getData())||void 0===e?void 0:e.finished_at}),[c]),p=(0,a().VK)((()=>{var e;return null===(e=c.getData())||void 0===e?void 0:e.workflow_version}),[c]),x=(0,a().VK)((()=>{var e;return null===(e=c.getData())||void 0===e?void 0:e.status}),[c]),y=(0,i.useCallback)((()=>{(0,H().mS)({environment:s,store:t,navigationState:{route:{type:"runs",runId:n}}})}),[n,s,t]),v=(0,i.useMemo)((()=>{const e=(0,B.jsx)("span",{style:{margin:"0 4px"},children:"·"});return(0,B.jsxs)(B.Fragment,{children:[p?`v${p}`:"v0",g&&(0,B.jsxs)(B.Fragment,{children:[e,(0,B.jsx)(L,{timestamp:g})]}),f&&g&&(0,B.jsxs)(B.Fragment,{children:[e,(0,B.jsx)(O,{finishedAtTime:f,startTime:g})]})]})}),[g,p,f]);return g?(0,B.jsxs)(w().Z,{style:d.button,onClick:y,children:[(0,B.jsx)(V,{status:x}),(0,B.jsxs)("div",{style:d.textContainer,children:[(0,B.jsx)("div",{style:d.titleText,children:u}),(0,B.jsx)("div",{style:d.subtitleContainer,children:v})]})]}):null}function V(e){const{status:t}=e,n=(0,l().yK)((e=>({passedIcon:{fill:e.accentColors.green[400]},failedIcon:{fill:e.accentColors.red[400]},statusIcon:{marginTop:2,width:16,height:16}})),[]),o=(0,i.useMemo)((()=>"success"===t?{...n.passedIcon,...n.statusIcon}:"failure"===t?{...n.failedIcon,...n.statusIcon}:n.statusIcon),[t,n]);return"success"===t?(0,d().$)(o):"failure"===t?(0,c().X)(o):(0,B.jsx)(S().Z,{size:"sm",style:o})}function L(e){const{timestamp:t}=e,[,n]=(0,i.useState)({}),r=o().ou.now(),a=o().ou.fromMillis(t),l=r.diff(a).as("minutes"),s=l>0,d=Math.abs(l)<1;return(0,M().Y)((()=>{n({})}),d&&!s?1e3:6e4),(0,B.jsx)(B.Fragment,{children:o().ou.fromMillis(t).toRelative()})}function O(e){const{finishedAtTime:t,startTime:n}=e,i=(0,l().yK)((e=>({icon:{width:14,height:14,marginRight:2,marginTop:1,fill:e.text.tertiary}})),[]),r=o().ou.fromMillis(t).diff(o().ou.fromMillis(n)).toFormat("mm:ss");return(0,B.jsxs)(B.Fragment,{children:[(0,p().S)(i.icon),(0,B.jsx)("span",{children:r})]})}function P(e){let{value:t,onChange:n,style:o}=e;const[r,a]=(0,i.useState)(!1),s=(0,l().yK)((e=>({iconButton:{width:14,height:void 0,fill:e.mediumIconColor},input:{fontSize:14,lineHeight:1,paddingRight:4,color:e.regularTextColor,marginBottom:1},ignoreArea:{display:"flex",alignItems:"center",overflow:"hidden"}})),[]),d=(0,i.useCallback)((()=>{a((e=>!e))}),[]),c=(0,i.useCallback)((()=>{n(""),a(!1)}),[n]),u=(0,i.useCallback)((()=>{t||a(!1)}),[t]),g=(0,i.useCallback)((e=>{27===e.keyCode&&c()}),[c]),p=(0,i.useCallback)((e=>{n(e.target.value)}),[n]);return(0,B.jsx)(T().Z,{renderTooltip:()=>(0,B.jsx)(x()._H,{defaultMessage:"Search",id:"workflowRuns.searchButton.tooltip"}),render:e=>(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(C().Z,{...e,icon:f().R,iconStyle:s.iconButton,onClick:d,ariaLabel:"Search"}),(0,B.jsx)(v().Z,{visible:r,animate:{width:150,opacity:1},initial:{width:0,opacity:0},exit:{width:0,opacity:0},children:(0,B.jsx)(j().Z,{capture:r,allowEsc:!0,render:e=>(0,B.jsx)("div",{...e,style:s.ignoreArea,children:(0,B.jsx)(b().Z,{style:{...s.input,...o},format:b().B.Transparent,value:t,onChange:p,placeholder:"Search runs...",focusInitial:r,showClearButton:!0,onBlur:u,onCancel:c,onClearButtonClick:c,onKeyDown:g})})})})]})})}},905086:(e,t,n)=>{n.d(t,{ur:()=>pe,Z6:()=>ce});n(267602),n(653476),n(241792),n(228244);var o=n(667294),i=()=>n(219727),r=()=>n(142735),a=()=>n(846550),l=()=>n(801812),s=()=>n(29248),d=()=>n(242217),c=()=>n(286977),u=()=>n(728267),g=()=>n(328714),f=()=>n(38370),p=()=>n(697945),h=()=>n(491772),x=()=>n(293996),m=()=>n(293641),y=()=>n(159732),v=()=>n(515497),w=()=>n(217465),k=()=>n(827370),C=()=>n(836273),j=()=>n(396136),b=()=>n(696056),S=()=>n(325490),I=()=>n(361929),T=()=>n(365873),M=()=>n(788860),D=()=>n(342792),K=()=>n(707513),H=()=>n(824462),W=()=>n(497065),B=()=>n(269299),A=()=>n(265640),R=()=>n(573357),_=()=>n(826955),V=()=>n(814866),L=()=>n(452435),O=()=>n(401806),P=()=>n(10986),F=()=>n(832770),N=(n(821057),n(470928),()=>n(308186)),Z=()=>n(311419),U=()=>n(448419),z=()=>n(187435),E=n(785893);function J(e){const{workflowStore:t,renderButton:n}=e,o=(0,i().Fy)();return(0,E.jsx)(U().ZP,{popupType:o.isMobile?U().Z4.SlideUp:U().Z4.Popup,placementToOrigin:U().pO.Bottom,alignmentToOrigin:U().vR.Center,originGap:4,renderOrigin:n,render:e=>(0,E.jsx)($,{handleClose:e.close,workflowStore:t})})}function $(e){const{handleClose:t,workflowStore:n}=e,r=(0,i().O7)(),a=(0,o.useCallback)((e=>{var o;if("collection"!==e.type)throw new Error("Expected collection target");((null===(o=n.getData())||void 0===o?void 0:o.modules)||[]).find((t=>{var n;return"database"===t.type&&(null===(n=t.state)||void 0===n||null===(n=n.pointer)||void 0===n?void 0:n.id)===e.collection.id}))?N().PV({message:"Database already connected"}):(B().createAndCommit({userAction:"WorkflowPreview.DatabasePickerContent.handleChange",environment:r,canUndo:!0,perform:t=>{(0,z().TR)({workflowStore:n,pointer:e.collection,transaction:t})}}),t())}),[n,r,t]);return(0,E.jsx)(Z().L,{onChange:a,onClose:t,parentRecordStore:n,skipPages:!0,skipVariables:!0})}var G=()=>n(338215),q=()=>n(39736),Y=()=>n(897184),Q=()=>n(868997);n(749411);function X(e){var t;const{workflowStore:n,name:l,functionKey:s}=e,d=(0,i().O7)(),c=(0,a().yK)((e=>({header:{fontWeight:600,marginBottom:12}})),[]),u=(0,o.useCallback)((e=>{if(!n)return;const t=JSON.parse(e);B().createAndCommit({userAction:"WorkflowTest.handleSaveTest",environment:d,canUndo:!0,perform:e=>(0,L().saveTest)({workflow:(0,P().xI)(n),workflowStore:n,functionKey:s,test:t,transaction:e,environment:d,threadStore:void 0})})}),[n,s,d]),g=(0,r().VK)((()=>(0,P().xI)(n)),[n]),f=null==g||null===(t=g.functions)||void 0===t||null===(t=t.flatMap((e=>{var t;return null===(t=e.tests)||void 0===t?void 0:t.filter((e=>e.description.name===l))})))||void 0===t?void 0:t[0];return f?(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("div",{style:c.header,children:l}),(0,E.jsx)(F().c,{value:JSON.stringify(f,null,2),onSave:u,disabled:!n,language:"json"})]}):null}var ee=()=>n(730120),te=()=>n(552064),ne=()=>n(729775),oe=()=>n(568672),ie=()=>n(804217);const re=6e4;function ae(e){const{store:t,workflowStore:n}=e,o=(0,i().O7)(),s=(0,a().yK)((e=>({paneHeader:{display:"flex",alignItems:"center",padding:"1px 8px 0px 8px",marginBottom:18},paneHeaderTitle:{color:e.text.primary,fontSize:17,fontStyle:"normal",fontWeight:K().Ue.medium,lineHeight:"22px",letterSpacing:"-0.442px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",height:28,display:"flex"},list:{display:"flex",flexDirection:"column",gap:1,alignItems:"flex-start",alignSelf:"stretch"},emptyStateContainer:{display:"flex",justifyContent:"center",alignItems:"flex-start",paddingTop:96,height:"100%"}})),[]),d=(0,r().VK)((()=>{const e=t.getSpaceId();if(e)return{threadParentPointer:{table:I().An,id:n.id,spaceId:e}}}),[t,n]),[{value:c},u]=(0,l().r5)((async()=>{if(!d)return;if(!ie().default.state.online)return;const e=await H().callApi({eventName:"getInferenceTranscriptsForUser",environment:o,data:d});return"failed"!==e.type?e.data.transcripts:void 0}),[d,o]);return(0,oe().Y)(u,re),(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("div",{style:s.paneHeader,children:(0,E.jsx)("div",{style:s.paneHeaderTitle,children:(0,E.jsx)(M()._H,{defaultMessage:"Chats",id:"workflowTranscriptsViewer.header"})})}),c?(0,E.jsx)("div",{style:s.list,children:c.map((e=>(0,E.jsx)(le,{transcript:e},e.id)))}):(0,E.jsx)("div",{style:s.emptyStateContainer,children:(0,E.jsx)(te().Z,{icon:v().L,title:"No chats yet",description:"Configuration chats will appear here"})})]})}function le(e){const{transcript:t}=e,n=(0,a().yK)((e=>({transcript:{padding:"8px 8px",borderRadius:6,width:"100%"},transcriptInner:{display:"flex",justifyContent:"space-between",gap:8},transcriptTitle:{fontSize:14,fontStyle:"normal",fontWeight:K().Ue.medium,lineHeight:"20px",letterSpacing:"-0.154px",color:e.text.primary},transcriptDate:{color:e.text.tertiary,fontSize:14,fontStyle:"normal",fontWeight:K().Ue.regular,lineHeight:"20px",letterSpacing:"-0.154px"}})),[]);return(0,E.jsxs)(ne().Z,{href:`${C().VP.aiInferenceTranscript}?t=${(0,D().cj)(t.id)}`,style:n.transcript,innerStyle:n.transcriptInner,children:[(0,E.jsx)("span",{style:n.transcriptTitle,children:t.title||"Untitled chat"}),(0,E.jsx)("div",{style:{flexGrow:1}}),(0,E.jsx)("span",{style:n.transcriptDate,children:ee().ou.fromMillis(t.created_at).toRelative()})]})}var se=()=>n(573087);function de(e){var t;const{workflowStore:n,viewKey:o}=e,i=(0,a().yK)((e=>({paneHeader:{display:"flex",alignItems:"center",padding:"1px 8px 0px 8px",marginBottom:18,justifyContent:"space-between"},paneHeaderTitle:{color:e.text.primary,fontSize:17,fontStyle:"normal",fontWeight:K().Ue.medium,lineHeight:"22px",letterSpacing:"-0.442px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",height:28,display:"flex"}})),[]),l=(0,r().VK)((()=>(0,P().xI)(n)),[n]),s=null==l||null===(t=l.views)||void 0===t?void 0:t.find((e=>e.key===o));return s?(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("div",{style:i.paneHeader,children:(0,E.jsx)("div",{style:i.paneHeaderTitle,children:s.name})}),(0,E.jsx)(F().c,{value:JSON.stringify(s,null,2),language:"json",disabled:!0})]}):null}function ce(e){const{store:t,navigationState:n}=e,p=(0,i().O7)(),h=(0,a().yK)((e=>({wrap:{display:"flex",gap:16,width:"100%",overflow:"hidden",fontSize:14,flexGrow:1},sidebar:{display:"flex",flexDirection:"column",gap:8,maxWidth:300,width:"100%",overflow:"scroll",paddingBottom:24},sidebarHeader:{display:"flex",gap:10,alignItems:"flex-start",flexDirection:"column",padding:"1px 8px 12px 8px"},sidebarHeaderContent:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:2,alignSelf:"stretch"},sidebarHeaderTitle:{fontSize:14,fontStyle:"normal",fontWeight:K().Ue.regular,lineHeight:"20px",letterSpacing:"-0.154px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},sidebarHeaderTitleEmpty:{color:e.text.tertiary},sidebarSections:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:4,alignSelf:"stretch"},sidebarSection:{display:"flex",flexDirection:"column",gap:2,alignSelf:"stretch"},sidebarSectionTitle:{display:"flex",height:30,padding:"0px 8px",alignItems:"center",alignSelf:"stretch",fontSize:12,fontStyle:"normal",fontWeight:K().Ue.medium,lineHeight:"16px",color:e.text.secondary},list:{display:"flex",flexDirection:"column",gap:2,alignItems:"flex-start",alignSelf:"stretch",paddingBottom:12},sidebarHeaderDescription:{fontSize:14,color:e.text.secondary,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},emptySidebarHeaderDescription:{color:e.text.quaternary},header:{fontSize:12,color:e.text.primary},passedIcon:{width:14,height:14,fill:e.accentColors.green[400]},failedIcon:{width:16,height:16,fill:e.accentColors.red[400]},paneWrapper:{width:"100%",height:"100%",overflow:"scroll",display:"flex",flexDirection:"column",alignItems:"center",padding:"0px 96px 36px 96px"},pane:{width:"100%",maxWidth:900,paddingBottom:12},runPeek:{position:"absolute",top:0,right:0,bottom:0,background:e.contentBackground,zIndex:1e3,width:600,height:"100%",overflow:"scroll",padding:12,borderLeft:`1px solid ${e.outlineButtonBorder}`},workflowDatabasePicker:{display:"flex",flexDirection:"column",alignSelf:"stretch",marginTop:-12,paddingBottom:12}})),[]),S=(0,r().VK)((()=>{var e;const n=null===(e=t.getFormat())||void 0===e?void 0:e.workflow_id;if(n)return _().hA.createChildStore(t,{table:I().An,id:n,spaceId:t.getSpaceId()})}),[t]),A=(0,r().VK)((()=>{if(S)return(0,P().xI)(S)}),[S]),O=null==n?void 0:n.route,F=(0,r().VK)((()=>{if(S&&"runs"===(null==O?void 0:O.type)&&O.runId)return _().US.createChildStore(S,{table:T().I_,id:O.runId,spaceId:t.getSpaceId()})}),[S,O,t]),{runtimeActorStore:N,runtimeActorName:Z,missingRuntimeActorRoles:U,runtimeActorHasSufficientAccess:z,grantAccess:$}=function(e){const{workflowStore:t,store:n}=e,a=(0,i().O7)(),s=(0,r().VK)((()=>{var e;const n=null==t||null===(e=t.getDataStore())||void 0===e?void 0:e.getKeyStore("runtime_actor_pointer").getValue();if(!t||!n||!(0,k().$O)(n,b().cZ))return;const o=_().Qx.createChildStore(t,n);return o.isWorkflowBot()?o:void 0}),[t]),d=(0,r().VK)((()=>{if(s)return s.getName()}),[s]),[{value:c},u]=(0,l().r5)((async()=>{if(!t||!s)return;const e=await H().callApi({eventName:"getWorkflowRuntimeActorPermissions",environment:a,data:{workflowId:t.id,spaceId:n.getSpaceId()}});return"failed"!==e.type?w().RecordMapWithRole.create(e.data.missingRoles):void 0}),[t,s,n,a]),g=(0,r().VK)((()=>{var e;return!c||0===(null===(e=c.getByTable(j().iU))||void 0===e?void 0:e.length)}),[c]),f=(0,o.useCallback)((async()=>{if(!s||!c)return;const e=B().createAndCommit({userAction:"WorkflowPageBlock.WorkflowRuntimeActor.grantAccess",environment:a,canUndo:!0,perform:e=>{(0,L().grantRuntimeActorSufficientAccess)({environment:a,runtimeActorStore:s,missingRoles:c,transaction:e})}});await e.serverCommitResult,await u()}),[s,c,a,u]);return{runtimeActorStore:s,runtimeActorName:d,missingRuntimeActorRoles:c,runtimeActorHasSufficientAccess:g,grantAccess:f}}({workflowStore:S,store:t}),ee=(null==A?void 0:A.modules)||[],te=[...ee.filter((e=>"database"===e.type)),...ee.filter((e=>"database"!==e.type))],ne=(0,o.useCallback)((e=>{const{id:t}=e;t&&W().c4({environment:p,url:`${C().VP.aiInferenceTranscript}?t=${(0,D().cj)(t)}`})}),[p]);return S&&A&&O?(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)("div",{style:h.wrap,children:[(0,E.jsx)("div",{style:h.sidebar,children:(0,E.jsxs)("div",{style:h.sidebarSections,children:[(0,E.jsxs)("div",{style:h.list,children:[(0,E.jsx)(ue,{icon:u().a,label:"Run history",active:"runs"===O.type,onClick:()=>{(0,V().mS)({environment:p,store:t,navigationState:{route:{type:"runs"}}})}}),(0,E.jsx)(ue,{icon:v().L,label:"Chats",active:"chat"===O.type,onClick:()=>{(0,V().mS)({environment:p,store:t,navigationState:{route:{type:"chat"}}})}})]}),N&&(0,E.jsxs)("div",{style:h.sidebarSection,children:[(0,E.jsx)("div",{style:h.sidebarSectionTitle,children:(0,E.jsx)(M()._H,{id:"workflows.sidebar.runtime_actor",defaultMessage:"Runs as"})}),(0,E.jsx)("div",{style:h.list,children:(0,E.jsx)(ue,{icon:d().S,label:Z,active:"runtime_actor"===O.type,onClick:()=>{(0,V().mS)({environment:p,store:t,navigationState:{route:{type:"runtime_actor"}}})},right:z?(0,c().e)(h.passedIcon):(0,x().G)(h.failedIcon)},N.id)})]}),A.views&&A.views.length>0&&(0,E.jsxs)("div",{style:h.sidebarSection,children:[(0,E.jsx)("div",{style:h.sidebarSectionTitle,children:(0,E.jsx)(M()._H,{id:"workflows.sidebar.views",defaultMessage:"Views"})}),(0,E.jsx)("div",{style:h.list,children:A.views.map((e=>(0,E.jsx)(ue,{icon:m().J,label:e.name,active:"view_settings"===O.type&&O.key===e.key,onClick:()=>{(0,V().mS)({environment:p,store:t,navigationState:{route:{type:"view_settings",key:e.key}}})}},e.key)))})]}),te.length>0&&(0,E.jsxs)("div",{style:h.sidebarSection,children:[(0,E.jsx)("div",{style:h.sidebarSectionTitle,children:(0,E.jsx)(M()._H,{id:"workflows.sidebar.connections",defaultMessage:"Connections"})}),(0,E.jsx)("div",{style:h.list,children:te.map((e=>(0,E.jsx)(ge,{module:e,navigationState:n,failedIconStyle:h.failedIcon,workflowStore:S,store:t},e.key)))})]}),S&&(0,E.jsx)("div",{style:h.workflowDatabasePicker,children:(0,E.jsx)(J,{workflowStore:S,renderButton:e=>{let{onClick:t}=e;return(0,E.jsx)(ue,{icon:y().R,label:"Connect a database",active:!1,onClick:t})}})}),A.triggers&&A.triggers.length>0&&(0,E.jsxs)("div",{style:h.sidebarSection,children:[(0,E.jsx)("div",{style:h.sidebarSectionTitle,children:(0,E.jsx)(M()._H,{id:"workflows.sidebar.triggers",defaultMessage:"Triggers"})}),(0,E.jsx)("div",{style:h.list,children:A.triggers.map((e=>(0,E.jsx)(ue,{icon:s().K,label:e.name,active:"trigger"===O.type&&O.key===e.key,onClick:()=>{(0,V().mS)({environment:p,store:t,navigationState:{route:{type:"trigger",key:e.key}}})}},e.key)))})]}),A.functions&&A.functions.length>0&&(0,E.jsxs)("div",{style:h.sidebarSection,children:[(0,E.jsx)("div",{style:h.sidebarSectionTitle,children:(0,E.jsx)(M()._H,{id:"workflows.sidebar.functions",defaultMessage:"Functions"})}),(0,E.jsx)("div",{style:h.list,children:A.functions.map((e=>{const n=e.tests||[],i=n.filter((e=>{var t;return null===(t=e.result)||void 0===t?void 0:t.passed})),r="function"===O.type&&O.key===e.key,a="test"===O.type&&O.functionKey===e.key;return(0,E.jsxs)(o.Fragment,{children:[(0,E.jsx)(ue,{label:e.name,icon:f().z,right:`${i.length}/${n.length}`,active:r,onClick:()=>{(0,V().mS)({environment:p,store:t,navigationState:{route:{type:"function",key:e.key}}})}}),(r||a)&&n.map((n=>{var o;return(0,E.jsx)(ue,{label:n.description.name,right:null!==(o=n.result)&&void 0!==o&&o.passed?(0,c().e)(h.passedIcon):(0,g().U)(h.failedIcon),active:"test"===O.type&&O.name===n.description.name,onClick:()=>{(0,V().mS)({environment:p,store:t,navigationState:{route:{type:"test",name:n.description.name,functionKey:e.key}}})}},n.description.name)}))]},e.key)}))})]}),(0,E.jsx)(ue,{label:"Debug",active:"debug"===O.type,onClick:()=>(0,V().mS)({environment:p,store:t,navigationState:{route:{type:"debug"}}})})]})}),(0,E.jsx)("div",{style:h.paneWrapper,children:(0,E.jsxs)("div",{style:h.pane,children:["runtime_actor"===O.type&&(0,E.jsx)(fe,{missingRuntimeActorRoles:U,grantAccess:$}),"runs"===O.type&&(0,E.jsx)(Q().r,{store:t,workflowStore:S}),"chat"===O.type&&(0,E.jsx)(ae,{store:t,workflowStore:S}),"debug"===O.type&&(0,E.jsx)(pe,{store:t,workflowStore:S}),"module"===O.type&&(0,E.jsx)(q().Ll,{moduleKey:O.key},O.key),"trigger"===O.type&&(0,E.jsx)(se().i,{triggerKey:O.key},O.key),"function"===O.type&&(0,E.jsx)(G().H,{functionKey:O.key},O.key),"test"===O.type&&(0,E.jsx)(X,{workflowStore:S,name:O.name,functionKey:O.functionKey},O.name),"view_settings"===O.type&&(0,E.jsx)(de,{workflowStore:S,viewKey:O.key})]})})]}),F&&(0,E.jsx)(R().Z,{capture:!0,render:e=>(0,E.jsx)("div",{style:h.runPeek,...e,children:(0,E.jsx)(Y().q,{runStore:F,workflowStore:S,store:t,setThreadId:ne})})})]}):null}function ue(e){const t=(0,a().yK)((e=>({button:{width:"100%",fontWeight:K().Ue.medium,color:e.text.secondary,textOverflow:"ellipsis",whiteSpace:"nowrap",padding:"5px 8px"},isActive:{color:e.text.primary},icon:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,flexGrow:0,width:20,height:20,fill:e.icon.secondary},iconActive:{fill:e.icon.primary},trailingItems:{fontWeight:K().Ue.regular,color:e.text.tertiary},labelContainer:{display:"flex",alignItems:"center",alignSelf:"stretch",flex:1,minWidth:0},labelText:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",minWidth:0}})),[]);return(0,E.jsxs)(A().D,{shouldShrink:!1,icon:e.icon,iconStyle:e.active?{...t.icon,...t.iconActive}:t.icon,hovered:!!e.active||void 0,onClick:e.onClick,style:e.active?{...t.button,...t.isActive}:t.button,children:[(0,E.jsx)("div",{style:t.labelContainer,children:(0,E.jsx)("div",{style:t.labelText,children:e.label})}),(0,E.jsx)("div",{style:{flexShrink:0}}),e.right&&(0,E.jsx)("div",{style:{...t.trailingItems,flexShrink:0},children:e.right})]})}function ge(e){const{module:t,navigationState:n,failedIconStyle:a,workflowStore:l,store:s}=e,d=(0,M().YB)(),c=(0,i().O7)(),u=n.route,g=(0,o.useCallback)((()=>{s&&(0,V().mS)({environment:c,store:s,navigationState:{route:{type:"module",key:t.key}}})}),[t,c,s]),f=(0,r().VK)((()=>O()._.isValidAndConnected(t,l,s)),[t,l,s]);return(0,E.jsx)(ue,{icon:"database"===t.type?h().t:p().L,label:O()._.getName(t,d),active:"module"===u.type&&u.key===t.key,onClick:g,right:f?void 0:(0,x().G)(a)})}function fe(e){const{missingRuntimeActorRoles:t,grantAccess:n}=e,o=(0,a().yK)((e=>({paneHeader:{display:"flex",alignItems:"center",padding:"1px 8px 0px 8px",marginBottom:18},paneHeaderTitle:{color:e.text.primary,fontSize:17,fontStyle:"normal",fontWeight:K().Ue.medium,lineHeight:"22px",letterSpacing:"-0.442px"}})),[]),i=(0,r().VK)((()=>JSON.stringify((null==t?void 0:t.getByTable(j().iU))??[],null,2)),[t]);return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("div",{style:o.paneHeader,children:(0,E.jsx)("div",{style:o.paneHeaderTitle,children:"Missing roles"})}),(0,E.jsx)(A().D,{onClick:n,children:"Grant access"}),(0,E.jsx)(F().c,{value:i,disabled:!0,language:"json"})]})}function pe(e){const{store:t,workflowStore:n,hideTitle:l}=e,s=(0,i().O7)(),d=(0,a().yK)((e=>({paneHeader:{display:"flex",alignItems:"center",padding:"1px 8px 0px 8px",marginBottom:18},paneHeaderTitle:{color:e.text.primary,fontSize:17,fontStyle:"normal",fontWeight:K().Ue.medium,lineHeight:"22px",letterSpacing:"-0.442px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",height:28,display:"flex"}})),[]),c=(0,r().VK)((()=>{const e=n.getData();return e?JSON.stringify(e,null,2):""}),[n]),u=(0,o.useCallback)((e=>{const t=e?JSON.parse(e):void 0;B().createAndCommit({userAction:"WorkflowPageBlock.WorkflowDebugPopupContent.handleSave",environment:s,canUndo:!0,perform:e=>{(0,L().saveWorkflow)({environment:s,workflowStore:n,workflow:t,transaction:e,threadStore:void 0,step:void 0})}})}),[n,s]),g=(0,r().VK)((()=>{const e=n.getData();return!!e&&(t=e,he.some((e=>e.needsMigration(t))));var t}),[n]),f=(0,o.useCallback)((()=>{const e=n.getData();if(!e)return;const t=function(e){let t=e;for(const n of he)n.needsMigration(t)&&(t=n.migrate(t));return t}(e);B().createAndCommit({userAction:"WorkflowPageBlock.WorkflowDebugPopupContent.handleMigrate",environment:s,canUndo:!0,perform:e=>{(0,L().saveWorkflow)({environment:s,workflowStore:n,workflow:t,transaction:e,threadStore:void 0,step:void 0})}})}),[n,s]),p=(0,o.useCallback)((async()=>{const e=n.getData();if(!e)return;const o=await H().callApi({eventName:"getInferenceTranscriptsForUser",environment:s,data:{threadParentPointer:n.pointer}});if("failed"===o.type)return;const i=o.data.transcripts.map((e=>_().V3.createChildStore(n,{id:e.id,table:S().kL,spaceId:t.getSpaceId()})));B().createAndCommit({userAction:"WorkflowPageBlock.WorkflowDebugPopupContent.handleBlockMigration",environment:s,canUndo:!0,perform:o=>{(0,L().migrateWorkflowBlockToCollectionViewBlock)({environment:s,store:t,workflowStore:n,workflow:e,transaction:o,workflowThreads:i})}})}),[n,s,t]),h=(0,r().VK)((()=>"workflow"===t.getType()),[t]);return(0,E.jsxs)(E.Fragment,{children:[!l&&(0,E.jsx)("div",{style:d.paneHeader,children:(0,E.jsx)("div",{style:d.paneHeaderTitle,children:"Debug"})}),g&&(0,E.jsx)(A().D,{onClick:f,children:"Migrate"}),(0,E.jsx)(F().c,{value:c,onSave:u,language:"json"}),h&&(0,E.jsx)(A().D,{onClick:p,isRed:!0,children:"Migrate to collection view block"})]})}const he=[{version:1,needsMigration:function(e){return(e.triggers||[]).some((e=>{var t;return"slack.thread.updated"===(null===(t=e.state)||void 0===t?void 0:t.type)}))},migrate:function(e){return{...e,triggers:(e.triggers||[]).map((e=>{var t;return"slack.thread.updated"!==(null===(t=e.state)||void 0===t?void 0:t.type)?e:{...e,state:{...e.state,type:"slack.message"}}}))}}},{version:2,needsMigration:function(e){return(e.triggers||[]).some((e=>!e.moduleKey))},migrate:function(e){const t={"database.page.created":"database","database.page.updated":"database","database.page.deleted":"database","slack.message":"slack","slack.reaction.added":"slack","slack.thread.created":"slack",recurrence:"recurrence","page.discussion.comment.added":"discussions","agent.message":"agent","zendesk.ticket":"zendesk","notionmail.email.received":"notionmail"},n={"slack.":"slack.slack.","zendesk.":"zendesk.zendesk."};return{...e,triggers:(e.triggers||[]).map((e=>{if(e.moduleKey)return e;if(!e.state)return e;const n=e.state.moduleKey,o=t[e.state.type];return{...e,moduleKey:n||o}})),functions:(e.functions||[]).map((e=>{if(!e.value)return e;let t=e.value;for(const[o,i]of Object.entries(n))t=t.replaceAll(o,i);return t===e.value?e:{...e,value:t}}))}}}]},573087:(e,t,n)=>{n.d(t,{P:()=>H,i:()=>K});n(267602),n(470928);var o=n(667294),i=()=>n(219727),r=()=>n(142735),a=()=>n(846550),l=()=>n(50366),s=()=>n(788860),d=()=>n(707513),c=()=>n(471645),u=()=>n(654133),g=()=>n(641506),f=()=>n(10986),p=()=>n(741543),h=()=>n(832770),x=()=>n(38370),m=()=>n(175771),y=()=>n(51590),v=()=>n(896441),w=()=>n(154186),k=()=>n(814866),C=()=>n(25014),j=n(785893);function b(e){const{children:t}=e,n=(0,y().RD)();return(0,j.jsx)("div",{style:n.wrap,children:(0,j.jsx)("div",{style:n.list,children:t})})}function S(e){const{children:t,icon:n,subtitle:i,onClick:r}=e,l=(0,a().yK)((e=>({componentWrap:{borderRadius:10},buttonWrap:{borderRadius:10},headerWrap:{alignItems:"center"}})),[]),s=(0,v().on)({disabled:!1,hasActionMenu:!1,isActionMenuVisible:!1,overrideStyles:l}),d=(0,o.useMemo)((()=>({...s.componentWrap,...s.border})),[s.border,s.componentWrap]),c=(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{style:s.headerWrap,children:[n&&(0,j.jsx)("div",{"aria-hidden":"true",style:s.iconContainer,children:(0,j.jsx)("div",{style:s.iconWrap,children:n(s.icon)})}),(0,j.jsx)("div",{style:s.titleWrap,children:t})]}),i&&(0,j.jsx)("div",{style:s.subtitleWrap,children:i})]});return r?(0,j.jsx)("div",{style:s.buttonWrap,children:(0,j.jsx)(w().Z,{onClick:r,style:s.componentWrap,children:c})}):(0,j.jsx)("div",{style:d,children:c})}function I(e){const{workflowStore:t,trigger:n}=e,{clientStore:o,threadStore:i}=(0,p().dP)(),a=(0,r().VK)((()=>(0,f().a5)({workflowStore:t,clientStore:o,threadStore:i})),[t,o,i]),l=(0,C().fC)({workflowValue:a,trigger:n});return(0,j.jsx)(S,{icon:(null==l?void 0:l.icon)??m().L,children:(0,j.jsx)(C().NO,{workflowValue:a,trigger:n})})}function T(e){const{store:t,workflowStore:n,functionKey:l}=e,d=(0,s().YB)(),c=(0,i().O7)(),u=(0,r().VK)((()=>{var e;return null===(e=(0,f().xI)(n).functions)||void 0===e?void 0:e.find((e=>e.key===l))}),[n,l]),g=(0,a().yK)((e=>({title:{fontWeight:500}})),[]),p=(0,o.useCallback)((()=>{(0,k().mS)({environment:c,store:t,navigationState:{route:{type:"function",key:l}}})}),[c,l,t]);return u?(0,j.jsx)(S,{icon:x().z,onClick:p,children:(0,j.jsx)("div",{style:g.title,children:u.name})}):(0,j.jsx)(S,{icon:x().z,subtitle:d.formatMessage({defaultMessage:"This automation is misconfigured. The function {functionKey} is not found in the workflow.",id:"aiWorkflow.function.notFound.subtitle"},{functionKey:l}),children:(0,j.jsx)("div",{style:g.title,children:(0,j.jsx)(s()._H,{defaultMessage:"Not found",id:"aiWorkflow.function.notFound.title"})})})}var M=()=>n(401848);const D=(0,s().vU)({triggerEnabledLabel:{defaultMessage:"Active",id:"aiWorkflow.trigger.triggerEnabledLabel"},triggerPausedLabel:{defaultMessage:"Inactive",id:"aiWorkflow.trigger.triggerPausedLabel"},triggerEnabledHiddenAriaLabel:{defaultMessage:"Trigger is active.",id:"aiWorkflow.trigger.triggerEnabledHiddenAriaLabel"},triggerPausedHiddenAriaLabel:{defaultMessage:"Trigger is paused.",id:"aiWorkflow.trigger.triggerPausedHiddenAriaLabel"},triggerDisabledTooltip:{defaultMessage:"You do not have permission to resume this trigger.",id:"aiWorkflow.trigger.triggerDisabledTooltip"},triggerErrorsDisabledTooltip:{defaultMessage:"Fix any errors or remove failing steps to enable this trigger",id:"aiWorkflow.trigger.triggerErrorsDisabledTooltip"}});function K(e){const{triggerKey:t,hideTitle:n}=e,i=(0,a().yK)((e=>({section:{display:"flex",flexDirection:"column",gap:8,width:"100%",marginBottom:28},header:{alignItems:"center",display:"flex",flexDirection:"row"},title:{color:e.lightTextColor,fontSize:12,lineHeight:1.3,fontWeight:d().Ue.medium}})),[]),{saveTrigger:l,store:c,workflowStore:u,clientStore:g,threadStore:x}=(0,p().dP)(),m=(0,o.useCallback)((e=>{const t=JSON.parse(e);l(t)}),[l]),y=(0,r().VK)((()=>{var e;return null===(e=(0,f().jI)({workflowStore:u,clientStore:g,threadStore:x}))||void 0===e||null===(e=e.triggers)||void 0===e?void 0:e.find((e=>e.key===t))}),[u,t,x,g]);return y&&u?(0,j.jsxs)(j.Fragment,{children:[!n&&(0,j.jsx)(M().z,{title:y.name,debugComponent:(0,j.jsx)(h().c,{value:JSON.stringify(y,null,2),onSave:m,disabled:!u,language:"json"})}),(0,j.jsx)(W,{trigger:y,cantSaveDueToError:!1,disabled:!1,saveTrigger:l}),(0,j.jsxs)("section",{style:i.section,children:[(0,j.jsx)("header",{style:i.header,children:(0,j.jsx)("div",{style:i.title,children:(0,j.jsx)(s()._H,{defaultMessage:"When",id:"aiWorkflow.trigger.when"})})}),(0,j.jsx)(b,{children:(0,j.jsx)(I,{workflowStore:u,trigger:y})})]}),(0,j.jsxs)("section",{style:i.section,children:[(0,j.jsx)("header",{style:i.header,children:(0,j.jsx)("div",{style:i.title,children:(0,j.jsx)(s()._H,{defaultMessage:"Do",id:"aiWorkflow.trigger.do"})})}),(0,j.jsx)(b,{children:(0,j.jsx)(T,{store:c,workflowStore:u,functionKey:y.key})})]})]}):null}function H(e){const{trigger:t}=e,n=!1!==t.enabled,o=(0,a().yK)((e=>({container:{display:"flex",alignItems:"center",gap:4,fontWeight:d().Ue.regular,fontSize:13,color:e.text.secondary},icon:{width:12,height:12,fill:n?e.performanceToolbarIndicator.green:e.performanceToolbarIndicator.red}})),[n]);return(0,j.jsxs)("span",{style:o.container,children:[(0,l().U)(o.icon),n?(0,j.jsx)(s()._H,{...D.triggerEnabledLabel}):(0,j.jsx)(s()._H,{...D.triggerPausedLabel})]})}function W(e){const{trigger:t,cantSaveDueToError:n,disabled:r,saveTrigger:l}=e,f=!1!==t.enabled,p=`toggle-${t.key}`,h=(0,i().Fy)().isMobile,x=(0,o.useCallback)((()=>{l({...t,enabled:!f})}),[l,t,f]),m=(0,a().yK)((e=>({labelWrap:{color:r?e.text.tertiary:e.text.secondary,flex:"1 1 auto",fontSize:h?d().JB.UIRegular.mobile:d().JB.UIRegular.desktop},sectionWrap:{alignItems:"start",display:"flex",flexDirection:"row",gap:6,marginBlockEnd:0,...h?{paddingBottom:0,paddingTop:0}:{paddingBottom:12,borderBottom:`1px solid ${e.stroke.secondary}`,marginBottom:16}},toggleWrap:{flex:"0 0 auto",paddingBlockStart:h?5:2}})),[r,h]),y=D.triggerEnabledLabel,v=f?D.triggerEnabledHiddenAriaLabel:D.triggerPausedHiddenAriaLabel;return(0,j.jsxs)("section",{style:m.sectionWrap,children:[(0,j.jsx)("div",{style:m.toggleWrap,children:(0,j.jsx)(u().Z,{disableTooltip:!r||!f,renderTooltip:()=>n?(0,j.jsx)(s()._H,{...D.triggerErrorsDisabledTooltip}):(0,j.jsx)(s()._H,{...D.triggerDisabledTooltip}),render:e=>(0,j.jsx)("div",{...e,children:(0,j.jsx)(c().Z,{disabled:r,inputId:p,on:f,onClick:x})})})}),(0,j.jsx)("div",{style:m.labelWrap,children:(0,j.jsxs)("label",{htmlFor:p,children:[(0,j.jsx)("span",{"aria-hidden":!0,children:(0,j.jsx)(s()._H,{...y})}),(0,j.jsx)("span",{style:g().jy,children:(0,j.jsx)(s()._H,{...v})})]})})]})}},928374:(e,t,n)=>{n.d(t,{M:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("bolt",{svg:(0,o.jsx)("path",{d:"M4.629 21.418l8.877-11.416c.166-.205.254-.4.254-.625 0-.371-.293-.654-.703-.654H7.539l2.91-7.598C10.84.12 9.766-.428 9.131.412L.254 11.818c-.166.215-.254.41-.254.626 0 .38.293.663.703.663h5.518l-2.91 7.588c-.391 1.006.683 1.553 1.318.723zm.576-2.627l3.272-7.139H2.44l6.377-8.466-.273-.147-3.262 7.139h6.026l-6.377 8.467z"}),viewBox:"0 0 14 22"})},293996:(e,t,n)=>{n.d(t,{G:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("exclamation",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M7.99634 15.5659C6.96118 15.5659 5.98706 15.3682 5.07397 14.9727C4.16089 14.582 3.35522 14.0376 2.65698 13.3394C1.96362 12.6411 1.41919 11.8354 1.02368 10.9224C0.628174 10.0093 0.43042 9.03516 0.43042 8C0.43042 6.96484 0.628174 5.99072 1.02368 5.07764C1.41919 4.16455 1.96362 3.36133 2.65698 2.66797C3.35522 1.96973 4.15845 1.42285 5.06665 1.02734C5.97974 0.631836 6.95386 0.434082 7.98901 0.434082C9.02905 0.434082 10.0056 0.631836 10.9187 1.02734C11.8318 1.42285 12.6375 1.96973 13.3357 2.66797C14.0339 3.36133 14.5808 4.16455 14.9763 5.07764C15.3718 5.99072 15.5696 6.96484 15.5696 8C15.5696 9.03516 15.3718 10.0093 14.9763 10.9224C14.5808 11.8354 14.0339 12.6411 13.3357 13.3394C12.6375 14.0376 11.8318 14.582 10.9187 14.9727C10.0056 15.3682 9.03149 15.5659 7.99634 15.5659ZM7.99634 14.0718C8.84106 14.0718 9.62964 13.9155 10.3621 13.603C11.0945 13.2905 11.739 12.856 12.2957 12.2993C12.8523 11.7427 13.2869 11.0981 13.5994 10.3657C13.9119 9.6333 14.0681 8.84473 14.0681 8C14.0681 7.16016 13.9119 6.37402 13.5994 5.6416C13.2869 4.9043 12.8523 4.25732 12.2957 3.70068C11.739 3.14404 11.092 2.70947 10.3547 2.39697C9.62231 2.08447 8.83374 1.92822 7.98901 1.92822C7.14917 1.92822 6.3606 2.08447 5.62329 2.39697C4.89087 2.70947 4.24878 3.14404 3.69702 3.70068C3.14526 4.25732 2.71313 4.9043 2.40063 5.6416C2.08813 6.37402 1.93188 7.16016 1.93188 8C1.93188 8.84473 2.08813 9.6333 2.40063 10.3657C2.71313 11.0981 3.14526 11.7427 3.69702 12.2993C4.25366 12.856 4.89819 13.2905 5.63062 13.603C6.36792 13.9155 7.15649 14.0718 7.99634 14.0718ZM7.99634 9.21582C7.57153 9.21582 7.35181 9.00098 7.33716 8.57129L7.23462 5.01172C7.22485 4.79688 7.29077 4.62109 7.43237 4.48438C7.57397 4.34766 7.75708 4.2793 7.98169 4.2793C8.2063 4.2793 8.39185 4.3501 8.53833 4.4917C8.68481 4.62842 8.75317 4.80176 8.74341 5.01172L8.62622 8.57129C8.61646 9.00098 8.40649 9.21582 7.99634 9.21582ZM7.99634 11.6475C7.75708 11.6475 7.552 11.5718 7.3811 11.4204C7.21509 11.2642 7.13208 11.0713 7.13208 10.8418C7.13208 10.6123 7.21509 10.4219 7.3811 10.2705C7.552 10.1143 7.75708 10.0361 7.99634 10.0361C8.23071 10.0361 8.43091 10.1118 8.59692 10.2632C8.76782 10.4146 8.85327 10.6074 8.85327 10.8418C8.85327 11.0762 8.76782 11.269 8.59692 11.4204C8.42603 11.5718 8.22583 11.6475 7.99634 11.6475Z"})})},515497:(e,t,n)=>{n.d(t,{L:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("topbarComment",{viewBox:"0 0 20 20",svg:(0,o.jsx)("path",{d:"M5.9375 18.4844C6.38281 18.4844 6.71094 18.2656 7.25 17.7891L9.92969 15.4297H14.6328C16.9844 15.4297 18.3047 14.0703 18.3047 11.75V5.67969C18.3047 3.35938 16.9844 2 14.6328 2H4.67188C2.32812 2 1 3.35938 1 5.67969V11.75C1 14.0781 2.36719 15.4297 4.61719 15.4297H4.9375V17.3438C4.9375 18.0391 5.30469 18.4844 5.9375 18.4844ZM6.32812 16.7344V14.5078C6.32812 14.0469 6.125 13.8672 5.6875 13.8672H4.72656C3.25781 13.8672 2.55469 13.125 2.55469 11.7031V5.72656C2.55469 4.30469 3.25781 3.5625 4.72656 3.5625H14.5859C16.0469 3.5625 16.75 4.30469 16.75 5.72656V11.7031C16.75 13.125 16.0469 13.8672 14.5859 13.8672H9.84375C9.36719 13.8672 9.13281 13.9453 8.80469 14.2891L6.32812 16.7344Z"})})}}]);