"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[19592,16982],{945272:(e,t,n)=>{n.r(t),n.d(t,{SlackConnectionOptions:()=>U});n(670560),n(267602),n(653476),n(241792);var i=n(667294),s=()=>n(219727),o=()=>n(732811),a=()=>n(142735),r=()=>n(846550),l=()=>n(801812),c=()=>n(952260),d=()=>n(261070),u=()=>n(35e3),g=()=>n(820717),p=()=>n(168741),m=()=>n(95886),f=()=>n(741633),h=()=>n(788860),v=()=>n(707513),x=()=>n(824462),y=()=>n(308186),S=()=>n(231077),j=()=>n(402269),b=()=>n(343353),I=()=>n(827973),k=()=>n(312578),C=()=>n(198829),M=()=>n(255577),w=()=>n(388284),_=()=>n(251932),Z=()=>n(594546),P=()=>n(352230),A=()=>n(466970),N=()=>n(616433),T=()=>n(876822),H=()=>n(749826),D=()=>n(993261),B=n(785893);const K=(0,h().vU)({userOverwritePopupTitle:{id:"slackConnectionOptions.overwriteEmail.title",defaultMessage:"User Authorization"}});function U(e){var t;let{parent:n,from:U}=e;const O=(0,s().O7)(),[W,R]=(0,i.useState)(),E=(0,A().E)("ingestion_mapped_child_spaces"),z=(0,N().J)(),F=(0,r().yK)((e=>({icon:{width:16,height:16},caption:{color:e.lightTextColor,fontSize:12,textWrap:"wrap"},option:{paddingTop:4,paddingBottom:4},optionLabel:{fontSize:14,marginBottom:2},disabledOptionLabel:{color:e.lightTextColor,fontSize:14,marginBottom:2},iconWrapper:{paddingTop:4}})),[]),q=(0,a().VK)((()=>T().default.state.currentSpaceStore),[]),Q=(0,a().VK)((()=>D().slackUniversalQnAConnectionStore.state.isPublicSync),[]),$=(0,a().VK)((()=>D().slackUniversalQnAConnectionStore.state.isPrivateSync),[]),G=(0,a().VK)((()=>D().slackUniversalQnAConnectionStore.state.isSyncCompleted),[]),Y=(0,a().VK)((()=>D().slackUniversalQnAConnectionStore.state.sessionId),[]),[J,X]=i.useState(!0),[ee,te]=i.useState(!1),[ne,ie]=i.useState([]),se=(0,a().VK)((()=>{var e;return null===(e=T().default.getState().currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),oe=(0,a().VK)((()=>D().slackUniversalQnAConnectionStore.state.isDisconnecting),[]),ae=(0,a().VK)((()=>D().slackUniversalQnAConnectionStore.state.analyticsFrom),[]),[re,le]=(0,i.useState)(!0),ce=(0,a().VK)((()=>D().slackUniversalQnAConnectionStore.state.isSlackGridAiConnectorEnabled),[]);(0,o().K)((async()=>{const e=null==q?void 0:q.id;if(!e)return;if(E){const t=await x().callApi({eventName:"getMappedParentSpace",environment:O,data:{spaceId:e}});if("success"!==t.type)return;if(t.data.isMapped)return R(t.data),void X(!1)}const t=await x().callApi({eventName:"getSlackBulkIngestionStatus",environment:O,data:{spaceId:e},headers:(0,f().Bb)({spaceId:e})});"success"===t.type&&D().slackUniversalQnAConnectionStore.setState({...D().slackUniversalQnAConnectionStore.state,...t.data});const n=await x().callApi({eventName:"getConnectedAppsForUniversalQna",environment:O,data:{spaceId:e},headers:(0,f().Bb)({spaceId:e})});"success"===n.type&&ie(n.data.connectedApps);const i=await x().callApi({eventName:"canUserQuerySlack",environment:O,data:{spaceId:e}});"success"===i.type&&(le(i.data.canQuery),D().slackUniversalQnAConnectionStore.setState({...D().slackUniversalQnAConnectionStore.state,canQuery:i.data.canQuery})),X(!1)})),(0,l().r5)((async()=>{if(!se)return;const e=await x().callApi({eventName:"allowPrivateSlackIngestion",environment:O,data:{spaceId:se}});"success"===e.type&&te(e.data.allow)}),[O,se]);const de=(0,a().VK)((()=>ne.includes("slack-admin")),[ne]),ue=(0,a().VK)((()=>ne.includes("slack")),[ne]),ge=(0,a().VK)((()=>{const e=H().default.getConfigKey("ingestion","slack");return(null==e?void 0:e.userScopes.length)>0}),[]),pe=[{key:"slack-connection-section",render:e=>(0,B.jsx)(w().Z,{...e}),items:(null!=W&&W.isMapped?[{key:"inherited-space",label:(0,B.jsx)(h()._H,{id:"assistantOverflowMenu.slackIngestion.connectionDisabled",defaultMessage:"Disabled"}),caption:(0,B.jsx)(h()._H,{id:"assistantOverflowMenu.slackIngestion.disabledDescription",defaultMessage:"Cannot connect Slack to this space. Slack connection is inherited from {parentSpaceName}",values:{parentSpaceName:(0,B.jsx)("u",{children:null===(t=W.spaceDetails)||void 0===t?void 0:t.spaceName})}}),icon:(0,u().I)(F.icon),disabled:!0,connected:!1,hidden:!1,action:()=>{}}]:[{key:"slack-ingestion-admin-auth",label:V(ne,G,Q,ce),caption:L(z,ne,Q,oe,G),icon:(0,u().I)(F.icon),disabled:!0,connected:de,hidden:!1,action:()=>{se&&((0,b().navigateToSlackUniversalQnAOnboarding)({analyticsFrom:U||"chat_menu"}),(0,Z().j)({environment:O,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connect_public_slack",integration_type:"slack",setup_session_id:Y,from:U||ae}}}))}},{key:"slack-ingestion-user-auth",label:(0,B.jsx)(h()._H,{id:"assistantOverflowMenu.slackIngestion.userAuth",defaultMessage:"Private conversations"}),caption:$?(0,B.jsx)(h()._H,{id:"assistantOverflowMenu.slackIngestion.privateConnectionInProgress",defaultMessage:"Connecting. This can take up to 36 hours."}):ue?(0,B.jsx)(h()._H,{id:"assistantOverflowMenu.slackIngestion.connectedByYou",defaultMessage:"Connected by you"}):(0,B.jsx)(h()._H,{id:"assistantOverflowMenu.slackIngestion.userCaption",defaultMessage:"Connect to enhance your AI results"}),icon:(0,g().v)(F.icon),disabled:!1,connected:ue,hidden:!!ce||Boolean(!de||Boolean(ne.includes("slack-admin")&&Q)||!ee||!ge||oe),action:async()=>{if(se)if(ue){"success"===(await x().callApi({eventName:"disconnectSlackIngestion",environment:O,data:{spaceId:se,disconnectForWorkspace:!1}})).type&&ie((e=>e.filter((e=>"slack"!==e)))),(0,Z().j)({environment:O,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_private_slack",integration_type:"slack",setup_session_id:Y,from:U||ae}}})}else{const e=await x().callApi({eventName:"getSlackIngestionAuthorizeUrl",environment:O,data:{spaceId:se,isAdminAuth:!1,isDesktopApp:O.device.isElectron}});"success"===e.type&&window.open(e.data.url,"_blank"),(0,Z().j)({environment:O,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connect_private_slack",integration_type:"slack",setup_session_id:Y,from:U||ae}}})}}},{key:"slack-overwrite-email",label:(0,B.jsx)(h()._H,{id:"assistantOverflowMenu.slackIngestion.overWriteEmail",defaultMessage:"Log in to Slack"}),caption:(0,B.jsx)(h()._H,{id:"assistantOverflowMenu.slackIngestion.overWriteEmailCaption",defaultMessage:"We couldn't verify your Slack e-mail. Click to authenticate."}),icon:(0,d().f)(F.icon),disabled:!1,connected:ue,hidden:!!ce||(!G||re),action:async()=>{if(!se)return;(0,Z().j)({environment:O,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connect_slack_user_mapping",integration_type:"slack",setup_session_id:Y,from:U||ae}}});const e=await x().callApi({eventName:"getSlackIngestionAuthorizeUrl",environment:O,data:{spaceId:se,isAdminAuth:!1,isDesktopApp:O.device.isElectron,isUserMapping:!0,sessionId:Y}});"success"===e.type&&(O.device.isElectron?S().openExternalUrl(e.data.url):await j().M(O,{width:800,height:600,url:e.data.url,titleMessage:K.userOverwritePopupTitle}))}},{key:"slack-overwrite-email-logout",label:(0,B.jsx)(h()._H,{id:"assistantOverflowMenu.slackIngestion.overWriteEmailLogout",defaultMessage:"Disconnect your account"}),caption:(0,B.jsx)(B.Fragment,{}),icon:(0,m().y)(F.icon),disabled:!1,connected:!1,hidden:!!ce||!ne.includes("slack-user-mapping"),action:async()=>{if(!se)return;null==n||n.close();const{accept:e}=await y().gt({message:(0,B.jsxs)(_().Ht,{gap:8,children:[(0,B.jsx)("div",{style:{fontWeight:v().Ue.semibold,fontSize:18},children:(0,B.jsx)(h()._H,{id:"universalQna.slackChannelSelection.disconnectOverwriteHeader",defaultMessage:"Are you sure?"})}),(0,B.jsx)("div",{style:{fontWeight:v().Ue.regular},children:(0,B.jsx)(h()._H,{id:"universalQna.slackChannelSelection.disconnectOverwriteNote1",defaultMessage:"Your Slack data will be permanently deleted from Notion."})}),(0,B.jsx)("div",{style:{fontWeight:v().Ue.regular},children:(0,B.jsx)(h()._H,{id:"universalQna.slackChannelSelection.disconnectOverwriteNote2",defaultMessage:"This process can take up to 3 hours, and you'll only be able to reconnect after disconnecting is complete."})})]}),acceptLabel:(0,B.jsx)(h()._H,{id:"universalQna.slackChannelSelection.disconnectButtonLabel",defaultMessage:"Disconnect Slack"})});e&&((0,Z().j)({environment:O,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"slack_user_mapping_disconnect",integration_type:"slack",setup_session_id:Y,from:U||ae}}}),await x().callApi({eventName:"disconnectSlackIngestion",environment:O,data:{spaceId:se,disconnectUserMapping:!0}}))}}]).filter((e=>!e.hidden)).map((e=>{let{key:t,label:i,caption:s,icon:o,disabled:a,connected:r,action:l}=e;return{key:t,action:async()=>{await l(),null==n||n.close()},render:e=>(0,B.jsx)(I().Z,{...e,title:(0,B.jsxs)(_().gq,{gap:4,children:[(0,B.jsx)("div",{style:F.iconWrapper,children:o}),(0,B.jsxs)("div",{style:F.option,children:[(0,B.jsx)("div",{style:a?F.disabledOptionLabel:F.optionLabel,children:i}),(0,B.jsx)("div",{style:F.caption,children:s})]})]}),right:r&&(0,c().U)({width:12,height:12}),disabled:a})}}))}];return W||!ne.includes("slack-admin")||!z||Q||oe||pe.push({key:"slack-settings-section",render:e=>(0,B.jsx)(w().Z,{...e,topBorder:!0}),items:[{key:"slack-settings",action:()=>{se&&(D().slackUniversalQnAConnectionStore.setState({...D().slackUniversalQnAConnectionStore.state,currentScreen:"settings"}),null==n||n.close())},render:e=>(0,B.jsx)(I().Z,{...e,title:(0,B.jsxs)(_().gq,{gap:4,children:[(0,B.jsx)("div",{style:F.iconWrapper,children:(0,p().H)(F.icon)}),(0,B.jsx)("div",{style:F.option,children:(0,B.jsx)("div",{style:F.optionLabel,children:(0,B.jsx)(h()._H,{id:"assistantOverflowMenu.slackIngestion.settings",defaultMessage:"Settings"})})})]})})}]}),(0,B.jsx)(C().Z,{menuType:P().o.Popup,width:230,children:J?(0,B.jsx)(_().gq,{style:{padding:8,justifyContent:"center"},children:(0,B.jsx)(k().Z,{})}):(0,B.jsx)(M().ZP,{type:M().iW.Vertical,sections:pe,initialFocus:void 0})})}function V(e,t,n,i){return n||t||!e.includes("slack-admin")?(0,B.jsx)(h()._H,{id:"assistantOverflowMenu.slackIngestion.adminAuth",defaultMessage:"Public conversations"}):i?(0,B.jsx)(h()._H,{id:"assistantOverflowMenu.slackIngestion.noWorkspacesSelected",defaultMessage:"No workspaces selected"}):(0,B.jsx)(h()._H,{id:"assistantOverflowMenu.slackIngestion.noChannelsSelected",defaultMessage:"No channels selected"})}function L(e,t,n,i,s){return e?i?(0,B.jsx)(h()._H,{id:"assistantOverflowMenu.slackIngestion.disconnectingPublicSlack",defaultMessage:"Disconnecting. This can take up to 3 hours."}):n?(0,B.jsx)(h()._H,{id:"assistantOverflowMenu.slackIngestion.connectingPublicSlack",defaultMessage:"Connecting. This can take up to 36 hours."}):t.includes("slack-admin")?s?(0,B.jsx)(h()._H,{id:"assistantOverflowMenu.slackIngestion.connectedByWorkspaceOwner",defaultMessage:"Connected by workspace owner"}):(0,B.jsx)(h()._H,{id:"assistantOverflowMenu.slackIngestion.selectChannels",defaultMessage:"Your workspace owner hasn't completed the setup."}):(0,B.jsx)(h()._H,{id:"assistantOverflowMenu.slackIngestion.connectSlackToEnhanceResults",defaultMessage:"Connect to enhance your AI results"}):t.includes("slack-admin")?s?(0,B.jsx)(h()._H,{id:"assistantOverflowMenu.slackIngestion.connectedByWorkspaceOwner",defaultMessage:"Connected by workspace owner"}):n?(0,B.jsx)(h()._H,{id:"assistantOverflowMenu.slackIngestion.connectingPublicSlack",defaultMessage:"Connecting. This can take up to 36 hours."}):(0,B.jsx)(h()._H,{id:"assistantOverflowMenu.slackIngestion.selectChannels",defaultMessage:"Your workspace owner hasn't completed the setup."}):(0,B.jsx)(h()._H,{id:"assistantOverflowMenu.slackIngestion.contactAdmin",defaultMessage:"Contact your workspace owner to connect"})}},145873:(e,t,n)=>{n.d(t,{Z:()=>r});n(667294);var i=()=>n(846550),s=()=>n(641772),o=()=>n(154186),a=n(785893);function r(e){let{onClick:t,className:n,isMobile:r,style:l,onFocus:c,onBlur:d,onMouseDown:u,onMouseEnter:g,onMouseLeave:p}=e;const{buttonStyle:m,iconStyle:f}=(0,i().yK)((e=>({buttonStyle:{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,borderRadius:6,width:r?45:24,height:r?45:24,marginRight:r?-8:-6,...l},iconStyle:{width:r?18:14,height:r?18:14,fill:e.mediumIconColor}})),[r,l]);return(0,a.jsx)(o().Z,{onClick:t,style:m,className:n,mobileFeedback:r,onFocus:c,onBlur:d,onMouseDown:u,onMouseEnter:g,onMouseLeave:p,children:(0,s().o)(f)})}},906301:(e,t,n)=>{n.d(t,{cP:()=>Je,ZP:()=>Ye,a_:()=>Ge});n(670560),n(267602),n(653476),n(749411),n(30005),n(241792),n(228244);var i=n(667294),s=()=>n(146947),o=()=>n(219727),a=()=>n(142735),r=()=>n(846550),l=()=>n(48826),c=()=>n(646574),d=()=>n(235484),u=()=>n(430491),g=()=>n(242550),p=()=>n(922622),m=()=>n(138531),f=()=>n(679950),h=()=>n(345864),v=()=>n(108205),x=()=>n(525372),y=()=>n(521913),S=()=>n(705214),j=()=>n(696056),b=()=>n(85073),I=()=>n(441764),k=()=>n(696459);const C=(0,k().AO)((e=>(0,k().$K)(e)&&"active"!==e.status?{false:e}:{true:e}));var M=()=>n(657120),w=()=>n(921787),_=()=>n(499110),Z=()=>n(788860),P=()=>n(568017),A=()=>n(707513),N=()=>n(296209),T=()=>n(691728),H=()=>n(200398),D=()=>n(945272),B=()=>n(345918),K=()=>n(466970),U=()=>n(998901),V=()=>n(876822),L=()=>n(826955),O=()=>n(277533),W=()=>n(145873),R=(n(470928),n(731107),()=>n(163262)),E=()=>n(619186),z=()=>n(989478),F=()=>n(286310),q=()=>n(158792),Q=()=>n(752127),$=()=>n(102182),G=()=>n(269299),Y=()=>n(352230),J=()=>n(148126),X=()=>n(529048),ee=()=>n(853946),te=()=>n(528514),ne=()=>n(183680),ie=()=>n(18748),se=n(785893);function oe(e){const{capabilities:t}=e,n=(0,Z().YB)(),{device:i}=(0,o().O7)(),s=(0,te().uH)(t),a=(0,te().Rh)(t),r=(0,te().WM)(e.capabilities),l=[...(0,ne().zq)(s),...(0,ne().ac)(a),...(0,ne().VR)(r)];return(0,se.jsx)(ie().ZP,{...e,title:n.formatMessage((0,te().Gx)(s,void 0).label),shouldWrapCaption:!0,style:i.isMobile?{padding:"12px 4px"}:{padding:4,marginTop:2,marginBottom:2},captionStyle:{marginTop:4},caption:(0,se.jsx)("div",{children:l})})}var ae=()=>n(827973),re=()=>n(448419),le=()=>n(740046),ce=()=>n(312578),de=()=>n(198829),ue=()=>n(255577),ge=()=>n(708518),pe=()=>n(661297),me=()=>n(967092),fe=()=>n(388284),he=()=>n(67961),ve=()=>n(239444);function xe(e){const{integrationId:t,integrationTable:n,isLegacy:s,disableDisconnectUser:r,disableDisconnectAll:l,disableDisallow:c,botIds:u}=e,g=(0,a().VK)((()=>V().default.state.currentSpaceStore),[]),p=(0,o().Fy)(),m=(0,o().O7)(),f=(0,Z().YB)(),h=He(),[v,x]=(0,i.useState)(void 0),[y,I]=(0,i.useState)(!1),[C,w]=(0,i.useState)(!1),[_,P]=(0,i.useState)(!1),[A,N]=(0,i.useState)(void 0),T=(0,a().VK)((()=>g&&n?(0,L().Kv)(g,{table:n,id:t}):void 0),[g,t,n]),H=(0,a().VK)((()=>{if(s){const e=S().ns.find((e=>e.id===t));return{name:null==e?void 0:e.name,url:(0,J().UY)("guides.connectedApps")}}if(g&&n){const s=g.getRecordModel({table:n,id:t});if(n===b().K2&&!(0,d().BP)({integrationId:t,env:"production"})){var e,i;const t=s;return{name:null==s?void 0:s.name,url:null==t||null===(e=t.getInfo())||void 0===e?void 0:e.website_url,email:null==t||null===(i=t.getInfo())||void 0===i?void 0:i.email}}return{name:null==s?void 0:s.name}}}),[g,t,n,s]),D=(0,a().VK)((()=>u&&!r?u.map((e=>g&&T?L().t1.createChildStore(T,{table:j().cZ,id:e,spaceId:g.id}):void 0)):[]),[g,u,T,r]).filter(k().$K),B=(0,a().VK)((()=>D.filter((e=>e.getAlive()))),[D]),K=(0,a().VK)((()=>{if(g&&B&&!r){return B.map((e=>e.getCreatedById())).filter(k().$K).map((e=>O().U.createChildStore(g,{table:z().KJ,id:e}))).filter((e=>e.isDefined()))}return[]}),[B,g,r]),U=(0,a().VK)((()=>null==g?void 0:g.getBotSettingsStore().getValue()),[g]),R=(0,a().VK)((()=>null==B?void 0:B.reduce(((e,t)=>{const n=K.find((e=>e.id===t.getCreatedById()));return e[t.id]={userStore:n,botCapabilities:t.getCapabilities()},e}),{})),[B,K]),F=(0,a().VK)((()=>v?(0,E().ZP)(v,Object.entries(R),(e=>{let[,{userStore:t}]=e;return t.getSearchName(f)})):Object.entries(R)),[R,v,f]),q=!r&&(null==u?void 0:u.length)&&(0,se.jsx)(fe().Z,{isInput:!0,style:{padding:8},children:(0,se.jsx)(le().ZP,{textWrapperStyle:{margin:0},focus:!p.isMobile||void 0,focusAfterAnimation:!0,value:v||"",onChange:e=>x(e.target.value),placeholder:f.formatMessage({id:"integrationInstallerFilter.userSearch.placeholder",defaultMessage:"Filter by user"})})}),Q=F.length?[{key:"disconnect user section",render:e=>(0,se.jsx)(fe().Z,{...e}),items:Se({users:F,disableDisconnectUser:r,showDisplayModal:()=>w(!0),setSelectedUser:N,intl:f})}]:[],$=(null==H?void 0:H.url)||(null==H?void 0:H.email),X=Boolean(null==u?void 0:u.length)||(0,M().CJ)(U)&&!c,ee=(0,se.jsxs)(se.Fragment,{children:[$&&(0,se.jsxs)(fe().Z,{topBorder:Boolean(F.length),children:[(null==H?void 0:H.url)&&(0,se.jsx)(be,{environment:m,developerWebsite:H.url}),(null==H?void 0:H.email)&&(0,se.jsx)(Ie,{environment:m,developerEmail:H.email})]},"app-links"),X&&(0,se.jsxs)(fe().Z,{topBorder:Boolean(F.length||$),children:[Boolean(null==u?void 0:u.length)&&(0,se.jsx)(ke,{showDisplayModal:()=>P(!0)}),(0,M().CJ)(U)&&!c&&(0,se.jsx)(Ce,{showDisplayModal:()=>I(!0)})]})]});return($||X)&&H?(0,se.jsx)(re().ZP,{popupType:p.isMobile?re().Z4.SlideUp:re().Z4.Popup,renderOrigin:e=>(0,se.jsx)(W().Z,{...e,isMobile:p.isMobile,style:{marginLeft:8,marginRight:8}}),render:()=>(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(de().Z,{menuType:p.isMobile?Y().o.ActionSheet:Y().o.Popup,header:!r&&q,footer:ee,width:230,children:(0,se.jsx)(ue().ZP,{type:ue().iW.Vertical,sections:Q,initialFocus:void 0})}),(0,se.jsx)(ge().Z,{open:!r&&C,onDismiss:()=>{w(!1)},transitionAppearance:"none",showCloseIcon:!0,innerStyle:h.innerModal,render:()=>(0,se.jsx)(Me,{title:(0,se.jsx)(Ae,{integrationName:H.name}),caption:(0,se.jsx)(Ne,{integrationName:H.name,userName:null==A?void 0:A.userName}),type:"disconnect",handleCancel:()=>{w(!1),N(void 0)},handleConfirmation:async()=>{A&&(await ye({botIds:[A.botId],environment:m}),N(void 0)),w(!1)}})}),(0,se.jsx)(ge().Z,{open:!l&&_,onDismiss:()=>{P(!1)},transitionAppearance:"none",showCloseIcon:!0,innerStyle:h.innerModal,render:()=>(0,se.jsx)(Me,{title:(0,se.jsx)(Ze,{integrationName:H.name}),caption:(0,se.jsx)(Pe,{integrationName:H.name}),type:"disconnect",handleCancel:()=>P(!1),handleConfirmation:async()=>{await ye({botIds:u,environment:m}),P(!1)}})}),(0,se.jsx)(ge().Z,{open:!c&&y,onDismiss:()=>{I(!1)},transitionAppearance:"none",showCloseIcon:!0,innerStyle:h.innerModal,render:()=>(0,se.jsx)(Me,{title:(0,se.jsx)(we,{integrationName:H.name}),caption:(0,se.jsx)(_e,{integrationName:H.name,disableDisconnectAll:l}),type:"disapprove",handleCancel:()=>I(!1),handleConfirmation:async()=>{!function(e){const{currentSpaceStore:t,environment:n,integrationId:i}=e;t&&G().createAndCommit({userAction:"AdminIntegrationSettingsActionMenu.handleDisapproveIntegration",environment:n,canUndo:!0,perform:e=>{G().applyOperation({store:t,operation:{pointer:t.pointer,path:["bot_settings","integration_approval_statuses"],command:"update",args:{[i]:null}},transaction:e})}})}({currentSpaceStore:g,environment:m,integrationId:t}),l||await ye({botIds:u,environment:m}),I(!1)}})})]})}):null}async function ye(e){let{botIds:t,environment:n}=e;t&&await Promise.all(t.map((e=>q().P0({environment:n,botId:e,onSuccess:()=>{F().IN(n,{type:"public"})}}))))}function Se(e){const{intl:t,disableDisconnectUser:n,users:i,showDisplayModal:s,setSelectedUser:o}=e;return n?[]:i.map((e=>{let[n,{userStore:i,botCapabilities:a}]=e;return{key:i.id,render:e=>(0,se.jsx)(je,{buttonMenuProps:e,userStore:i,botCapabilities:a,selectAction:()=>{s(),o({botId:n,userName:i.getDisplayName(t)})}}),action:()=>{s(),o({botId:n,userName:i.getDisplayName(t)})}}}))}function je(e){const{buttonMenuProps:t,userStore:n,botCapabilities:s,selectAction:a}=e,r=(0,o().Fy)(),[l,c]=(0,i.useState)(!1);return(0,se.jsx)(me().ZP,{popupType:r.isMobile?re().Z4.SlideUp:re().Z4.Popup,placementToOrigin:re().pO.Right,open:l,onDismiss:()=>c(!1),origin:(0,se.jsx)(ae().Z,{...t,title:(0,se.jsx)("div",{style:{display:"flex",alignContent:"center",justifyContent:"space-between"},children:(0,se.jsx)(ve().Z,{userStore:n,avatarSize:18,inline:!0,avatarShouldShowShadow:!0,style:{flexShrink:1}})}),textWrapperStyle:{marginLeft:12,marginRight:12},focused:!1,onClick:()=>c(!0)}),render:()=>(0,se.jsx)(de().Z,{width:240,menuType:r.isMobile?Y().o.ActionSheet:Y().o.Popup,header:(0,se.jsx)("div",{style:{padding:2,marginTop:4,marginBottom:4},children:(0,se.jsx)(oe,{capabilities:s})}),children:(0,se.jsx)(ue().ZP,{type:ue().iW.Vertical,sections:[{key:"integration capabilities",render:e=>(0,se.jsx)(fe().Z,{...e,topBorder:!0}),items:[{key:"remove",render:e=>(0,se.jsx)(ae().Z,{...e,focused:!1,title:(0,se.jsx)("div",{style:{color:P().ZP.red},children:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.actionMenu.revokeUserAccess.label",defaultMessage:"Disconnect user"})})}),action:a}]}],initialFocus:void 0})})})}function be(e){let{environment:t,developerWebsite:n}=e;return(0,se.jsx)(ae().Z,{onClick:()=>{Q().D({environment:t,url:n}),F().fc(t,{href:n,from:"integration-settings"})},title:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.actionMenu.visitDeveloperWebsite.label",defaultMessage:"Visit developer website"}),shouldWrapCaption:!0,focused:!1,textWrapperStyle:{marginLeft:12,marginRight:12}})}function Ie(e){let{environment:t,developerEmail:n}=e;return(0,se.jsx)(ae().Z,{onClick:()=>{Q().D({environment:t,url:`mailto:${n}`}),F().Z9(t,{from:"integration-settings"})},title:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.actionMenu.contactDeveloperSupport.label",defaultMessage:"Contact support"}),shouldWrapCaption:!0,focused:!1,textWrapperStyle:{marginLeft:12,marginRight:12}})}function ke(e){let{showDisplayModal:t}=e;return(0,se.jsx)(ae().Z,{onClick:t,title:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.actionMenu.disconnectAll.label",defaultMessage:"Disconnect all users"}),shouldWrapCaption:!0,focused:!1,textWrapperStyle:{marginLeft:12,marginRight:12,color:P().ZP.red}})}function Ce(e){let{showDisplayModal:t}=e;return(0,se.jsx)(ae().Z,{onClick:t,title:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.label",defaultMessage:"Remove from approved list"}),focused:!1,textWrapperStyle:{marginLeft:12,marginRight:12,color:P().ZP.red}})}function Me(e){let{title:t,caption:n,handleConfirmation:s,handleCancel:o,type:a}=e;const[r,l]=(0,i.useState)(!1);return(0,se.jsxs)("div",{style:{padding:20,width:333},children:[(0,se.jsx)(he().Z,{isMultiline:!0,style:{marginBottom:8,fontWeight:A().Ue.semibold,paddingRight:30},children:t}),(0,se.jsx)(he().Z,{isMultiline:!0,isSecondaryColor:!0,style:{marginBottom:8},children:n}),(0,se.jsxs)("div",{style:{display:"flex",marginTop:12},children:[(0,se.jsx)(pe().Z,{style:{width:140,marginRight:9},size:"lg",onClick:o,disabled:r,children:(0,se.jsx)(he().Z,{children:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.button.cancel",defaultMessage:"Cancel"})})}),(0,se.jsx)(pe().Z,{style:{width:140},size:"lg",onClick:async()=>await s(l),backgroundColor:P().ZP.red,disabled:r,children:(0,se.jsxs)(he().Z,{style:{color:P().ZP.white},children:["disconnect"===a&&!0===r&&(0,se.jsx)(ce().Z,{onDarkBackground:!0}),"disconnect"===a&&!1===r&&(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.button.disconnect",defaultMessage:"Disconnect"}),"disapprove"===a&&(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.button.remove",defaultMessage:"Remove"})]})})]})]})}function we(e){let{integrationName:t}=e;return(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.title",defaultMessage:"Remove {integrationName} from approved integrations",values:{integrationName:t}})}function _e(e){let{integrationName:t,disableDisconnectAll:n}=e;return n?(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.caption",defaultMessage:"Prevent members from installing {integrationName}.",values:{integrationName:t}}):(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApprovalAndDisconnectAll.caption",defaultMessage:"Revoke access for {integrationName} for all users in this workspace and prevent members from installing {integrationName}.",values:{integrationName:t}})}function Ze(e){let{integrationName:t}=e;return(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.actionMenu.disconnectAll.modal.label",defaultMessage:"Disconnect {integrationName} for all users in workspace",values:{integrationName:t}})}function Pe(e){let{integrationName:t}=e;return(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.actionMenu.disconnectAll.modal.caption",defaultMessage:"Revoke access for {integrationName} for all users in this workspace.",values:{integrationName:t}})}function Ae(e){let{integrationName:t}=e;return(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.actionMenu.disconnectUser.modal.label",defaultMessage:"Disconnect {integrationName}?",values:{integrationName:t}})}function Ne(e){let{integrationName:t,userName:n}=e;return(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.actionMenu.disconnectUser.modal.caption",defaultMessage:"Revoke access for {integrationName} for {userName}",values:{integrationName:t,userName:n}})}function Te(e){const{adminIntegrationConfig:t,botId:n,maybeWebhookSubscriptionId:s}=e,r=(0,o().Fy)(),l=(0,o().O7)(),[c,d]=(0,i.useState)(!1),u=He(),g=(0,a().VK)((()=>V().default.state.currentSpaceStore),[]),p=(0,a().VK)((()=>{const e=null==g?void 0:g.getRecordModel({table:j().cZ,id:n});return null==e?void 0:e.getCapabilities()}),[g,n]),m=t.developer_name;if(!m)return null;const f=new(X().Z),h={key:"manage",action:()=>{ee().Z.setState({open:!0,integrationId:t.id,webhookSubscriptionId:s}),f.setState({open:!1})},render:e=>(0,se.jsx)(ae().Z,{...e,title:(0,se.jsx)(Z()._H,{id:"complianceIntegrationSettings.actionMenu.manage",defaultMessage:"Manage"})})},v={key:"learn more",action:()=>{Q().D({environment:l,url:t.integrationGalleryUrl})},render:e=>(0,se.jsx)(ae().Z,{...e,title:(0,se.jsx)(Z()._H,{id:"complianceIntegrationSettings.actionMenu.learnMore",defaultMessage:"Learn more"})})},x={key:"disconnect",action:()=>{f.setState({open:!1}),d(!0)},render:e=>(0,se.jsx)(ae().Z,{...e,title:(0,se.jsx)("span",{style:u.disconnect,children:(0,se.jsx)(Z()._H,{id:"complianceIntegrationSettings.actionMenu.disconnect",defaultMessage:"Disconnect"})})})},y=[...t.oauth||(0,R().ms)(p)||(0,w().Uw)(t.id)?[]:[h],...t.oauth||(0,R().ms)(p)?[v]:[],x];return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(re().ZP,{popupType:r.isMobile?re().Z4.SlideUp:re().Z4.Popup,renderOrigin:e=>(0,se.jsx)(W().Z,{...e,isMobile:r.isMobile,style:{marginLeft:8,marginRight:8}}),buttonPopupStore:f,render:()=>(0,se.jsx)(de().Z,{menuType:r.isMobile?Y().o.ActionSheet:Y().o.Popup,width:230,children:(0,se.jsx)(ue().ZP,{type:ue().iW.Vertical,sections:[{key:"options",render:e=>(0,se.jsx)(fe().Z,{...e}),items:y}],initialFocus:void 0})})}),(0,se.jsx)(ge().Z,{open:c,onDismiss:()=>d(!1),transitionAppearance:"none",showCloseIcon:!0,innerStyle:u.innerModal,render:()=>(0,se.jsx)(Me,{title:(0,se.jsx)(Z()._H,{id:"complianceIntegrationSettings.disconnectModal.title",defaultMessage:"Disconnect {integrationName}?",values:{integrationName:m}}),caption:(0,se.jsx)(Z()._H,{id:"complianceIntegrationSettings.disconnectModal.subtitle",defaultMessage:"Revoke {integrationName}'s access to this workspace. Workspace events will no longer be sent to {integrationName}.",values:{integrationName:m}}),type:"disconnect",handleCancel:()=>d(!1),handleConfirmation:async()=>{await q().P0({environment:l,botId:n,onSuccess:()=>{}}),F().wi(l,{integration_id:t.id}),$().oV({label:(0,se.jsx)(Z()._H,{id:"complianceIntegrationSettings.snackbar.title",defaultMessage:"Disconnected {integrationName} from your workspace",values:{integrationName:m}})})}})})]})}function He(){return(0,r().yK)((()=>({disconnect:{color:P().ZP.red},innerModal:{borderRadius:10}})),[])}var De=()=>n(521632),Be=()=>n(946563),Ke=()=>n(943620),Ue=()=>n(401102),Ve=()=>n(654133),Le=()=>n(981583),Oe=()=>n(801812),We=()=>n(836273),Re=()=>n(342792),Ee=()=>n(959137),ze=()=>n(497065);function Fe(e){const{botId:t}=e,[,,n]=(0,a().AF)(void 0,X().Z),s=(0,o().Fy)(),r=(0,o().O7)(),l=(0,a().VK)((()=>V().default.state.currentSpaceStore),[]),[c,d]=(0,i.useState)(!1),u=(0,a().VK)((()=>l?L().t1.createChildStore(l,{table:j().cZ,id:t,spaceId:l.id}):void 0),[t,l]),g=(0,a().VK)((()=>(0,R().Mh)(null==u?void 0:u.getModel())),[u]),[{value:p}]=(0,Oe().r5)((async()=>{if(u){return await q().VG({environment:r,botId:null==u?void 0:u.id})}}),[r,u]);if(!u)return null;let m;return m=s.isMobile?{menuType:Y().o.ActionSheet}:{menuType:Y().o.Popup},(0,se.jsx)(re().ZP,{popupType:s.isMobile?re().Z4.SlideUp:re().Z4.Popup,buttonPopupStore:n,renderOrigin:e=>(0,se.jsx)(W().Z,{isMobile:s.isMobile,...e,style:{marginLeft:8,marginRight:8}}),render:()=>(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(de().Z,{...m,children:(0,se.jsx)(ue().ZP,{type:ue().iW.Vertical,sections:[{key:"integration options",render:e=>(0,se.jsx)(fe().Z,{...e}),items:[...p?[qe({environment:r,botToken:p})]:[],{key:"manage",action:()=>ze().c4({environment:r,url:`${We()._j.creatorProfileIntegrations}/internal/${Re().cj(t)}`,openInNew:"tab"}),render:e=>(0,se.jsx)(ae().Z,{title:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.actionMenu.manageIntegration.label",defaultMessage:"Manage in developer portal"}),...e})},{key:"delete",action:()=>d(!0),render:e=>(0,se.jsx)(ae().Z,{title:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.actionMenu.disconnectIntegrationButton.label",defaultMessage:"Disconnect {integrationName}",values:{integrationName:g}}),style:{color:P().ZP.red},...e})}]}],initialFocus:void 0})}),(0,se.jsx)(ge().Z,{open:c,onDismiss:()=>{d(!1)},transitionAppearance:"none",render:()=>(0,se.jsxs)("div",{style:{padding:20,width:333},children:[(0,se.jsx)(he().Z,{isMultiline:!0,style:{marginBottom:8,fontWeight:A().Ue.semibold},children:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.actionMenu.removeIntegration.modal.label.title",defaultMessage:"Disconnect {integrationName} in workspace",values:{integrationName:g}})}),(0,se.jsx)(he().Z,{isMultiline:!0,isSecondaryColor:!0,style:{marginBottom:8},children:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.actionMenu.removeIntegration.modal.label.caption",defaultMessage:"Revoke access for {integrationName} in workspace",values:{integrationName:g}})}),(0,se.jsxs)("div",{style:{display:"flex",marginTop:12},children:[(0,se.jsx)(pe().Z,{style:{width:140,marginRight:9},size:"lg",onClick:()=>d(!1),children:(0,se.jsx)(he().Z,{children:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.button.cancel",defaultMessage:"Cancel"})})}),(0,se.jsx)(pe().Z,{style:{width:140},size:"lg",onClick:async()=>{d(!1),await q().P0({environment:r,botId:u.id,onSuccess:()=>{F().IN(r,{type:"internal"})}})},backgroundColor:P().ZP.red,children:(0,se.jsx)(he().Z,{style:{color:P().ZP.white},children:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.actionMenu.disconnectIntegration..modal.button.disconnect",defaultMessage:"Disconnect"})})})]})]})})]})})}function qe(e){const{botToken:t,environment:n}=e;return{key:"copy bot token",action:async()=>{const e=await Ee().F.clipboardActions.load();e.copyString({environment:n,stringValue:t,copiedMessage:e.clipboardMessages.copiedLinkToClipboard}),F().IV(n,{from:"integration-settings",table:j().cZ})},render:e=>(0,se.jsx)(ae().Z,{title:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.actionMenu.copyInternalIntegrationTokenButton.label",defaultMessage:"Copy internal integration token"}),...e})}}var Qe=()=>n(251932),$e=()=>n(378907);const Ge={automation_action:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.integrationTable.pillLabel.automation_action",defaultMessage:"Automation Action"}),internal:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.integrationTable.pillLabel.internal",defaultMessage:"Internal"}),databaseSync:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.integrationTable.pillLabel.sync",defaultMessage:"Sync"}),linkPreview:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.integrationTable.pillLabel.preview",defaultMessage:"Link Preview"}),importer:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.integrationTable.pillLabel.importer",defaultMessage:"Importer"}),dlp:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.integrationTable.pillLabel.dlp",defaultMessage:"DLP"}),siem:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.integrationTable.pillLabel.siem",defaultMessage:"SIEM"}),ediscovery:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.integrationTable.pillLabel.ediscovery",defaultMessage:"eDiscovery"}),aiConnector:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.integrationTable.pillLabel.aiConnector",defaultMessage:"AI connector"})};function Ye(e){const{integrationIdToBotIds:t,internalIntegrationIds:n,integrationIdToUsers:i}=e,s=(0,a().VK)((()=>V().default.state.currentSpaceStore),[]),o=(0,r().Fg)(),l=(0,a().VK)((()=>null==s?void 0:s.getBotSettingsStore().getValue()),[s]),c=(0,a().VK)((()=>"approved_or_built_by_notion"===(null==l?void 0:l.integration_restrictions)),[l]),u=(0,a().VK)((()=>Boolean(null==l?void 0:l.integration_restrictions)),[l]),g=(0,a().VK)((()=>null!=l&&l.integration_approval_statuses?Object.keys(l.integration_approval_statuses):[]),[l]),p=g.filter((e=>!Object.keys(t).includes(e)&&!S().T2.includes(e))),m=p.some((e=>e===d().f3)),f=(0,a().VK)((()=>null==s?void 0:s.id),[s]),h=t?Object.entries(t).map((e=>{let[t,n]=e;return Xe({integrationPointer:{table:b().K2,id:t},userStores:i[t],botIds:n,autoApproveBuiltByNotion:c})})):[],v=f?n.map((e=>Xe({integrationPointer:{table:j().cZ,id:e,spaceId:f},userStores:i[e],botIds:[e]}))):[],x=u?p.map((e=>Xe({integrationPointer:{table:b().K2,id:e},userStores:[],botIds:[],autoApproveBuiltByNotion:c}))):[],y=S().ns.filter((e=>!(0,M().CJ)(l)||g.includes(e.id)&&(e.id!==S()._o||!m))).map((e=>function(e){const{legacyIntegration:t}=e,{id:n,name:i,info:s}=t;return{key:n,columns:[(0,se.jsxs)("div",{style:{display:"flex",alignItems:"center",maxWidth:300},children:[(0,se.jsx)("img",{src:s.icon,style:{height:28}}),(0,se.jsxs)("div",{style:{minWidth:0,marginLeft:15},children:[(0,se.jsx)("div",{style:{display:"flex"},children:(0,se.jsx)(he().Z,{children:i})}),(0,se.jsx)(he().Z,{isSmall:!0,style:{display:"flex"},children:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.legacy",defaultMessage:"Notion Connected App"})})]})]},0),(0,se.jsx)(ct,{renderedUsers:void 0,displayUsers:!1},1),(0,se.jsx)("div",{children:(0,se.jsx)(xe,{integrationId:n,isLegacy:!0,disableDisconnectAll:!0,disableDisconnectUser:!0})},2)]}}({botSettings:l,legacyIntegration:e}))),I=h.length+v.length+x.length+y.length;return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)($e().Z,{columns:[{key:"integration",header:(0,se.jsx)(Z()._H,{id:"spaceConnectionsSettings.connectionsTable.connectionsColumn.title",defaultMessage:"Connection"}),style:{width:"40%"}},{key:"added_by",header:(0,se.jsx)(Z()._H,{id:"spaceConnectionsSettings.connectionsTable.creationInfoColumn.title",defaultMessage:"Users and access"})},{key:"more",header:void 0,style:{width:"5%"}}],rows:[...h,...v,...x,...y]}),0===I?(0,se.jsx)("div",{style:{height:120,width:"100%",fontSize:12,color:o.lightTextColor,display:"flex",alignItems:"center",justifyContent:"center",borderBottom:`1px solid ${o.lightDividerColor}`},children:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.integrationTable.emptyTable.message",defaultMessage:"No integration installed"})}):void 0]})}function Je(e){const{botIdToWebhookSubscriptionId:t,complianceIntegrationsIdToBotIds:n,aiConnectedApps:i}=e,s=(0,r().yK)((e=>({emptyTable:{height:120,width:"100%",fontSize:12,color:e.lightTextColor,display:"flex",alignItems:"center",justifyContent:"center",borderBottom:`1px solid ${e.lightDividerColor}`}})),[]),o=(0,a().VK)((()=>V().default.state.currentSpaceStore),[]),c=(0,K().E)("ai_connector_discoverability"),d=(0,a().VK)((()=>{if(!o)return[];return Object.entries(n).flatMap((e=>{let[n,i]=e;return i.map((e=>{const i=L().Qx.createChildStore(o,{table:j().cZ,id:e,spaceId:o.id});return{integrationPointer:{table:b().K2,id:n},botId:e,lastEditedAt:Number(i.getLastEditedAt()),lastEditedByPointer:i.getLastEditedByPointer(),webhookSubscriptionId:t[e]}}))})).filter(k().$K)}),[t,o,n]).map((e=>function(e){const{integrationPointer:t,lastEditedAt:n,lastEditedByPointer:i,botId:s,webhookSubscriptionId:o}=e,a=t.id,r=(0,w().EY)(a);if(!r)return;const l=w().ZB[r];if(!l)return;return{key:`${a}:${s}`,columns:[(0,se.jsx)(it,{integrationTable:b().K2,integrationId:a,maybeWebhookSubscriptionId:o},"integration-title"),(0,se.jsx)(rt,{editedByPointer:i},"integration-edited-by"),(0,se.jsx)(lt,{lastEditedOn:n},"integration-last-edited-on"),(0,se.jsx)(Te,{adminIntegrationConfig:l,maybeWebhookSubscriptionId:o,botId:s},"integration-menu")]}}(e))).filter(k().$K),u=c?function(e){const{aiConnectedApps:t}=e,n=[],i=function(e){const t=[];return e.forEach((e=>{switch(e.id){case l().aP:t.push({...e,integrationIcon:x().P,integrationName:"Slack",moreSettingsComponent:(0,se.jsx)(D().SlackConnectionOptions,{})});break;case l().V:t.push({...e,integrationIcon:f().c,integrationName:"Google Drive",moreSettingsComponent:(0,se.jsx)(T().Z,{callGetStatusAPI:!0})});break;case l().xb:t.push({...e,integrationIcon:m().f,integrationName:"GitHub",moreSettingsComponent:(0,se.jsx)(N().K,{})});break;case l().qC:t.push({...e,integrationIcon:v().k,integrationIconColor:"rgba(35, 131, 226, 1)",integrationName:"Jira",moreSettingsComponent:(0,se.jsx)(H().E,{})})}})),t}(t);return i.forEach((e=>{let t;e.connectorNotionId&&(t={table:"notion_user",id:e.connectorNotionId});const i=e.connectorNotionId?(0,se.jsx)(rt,{editedByPointer:t},"integration-edited-by"):(0,se.jsx)("div",{children:e.connectorEmail},`ai-connector-editor${e.id}`);n.push({key:e.id,columns:[(0,se.jsx)(tt,{aiConnectedApp:e},`ai-connector-title${e.id}`),i,(0,se.jsx)(lt,{lastEditedOn:e.connectionLastEditedTimestamp},`ai-connector-last-edited-on${e.id}`),(0,se.jsx)(et,{moreSettingsComponent:e.moreSettingsComponent},`"ai-connector-more-setting"${e.id}`)]})})),n||[]}({aiConnectedApps:i}):[],g=[...u,...d];return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)($e().Z,{columns:[{key:"integration",header:(0,se.jsx)(Z()._H,{id:"spaceConnectionsSettings.complianceConnectionsTable.connectionsColumn.title",defaultMessage:"Connection"}),style:{width:"30%"}},{key:"integration-edited-by",header:(0,se.jsx)(Z()._H,{id:"spaceConnectionsSettings.complianceConnectionsTable.integrationEditorColumn.title",defaultMessage:"Edited by"}),style:{width:"30%"}},{key:"integration-edited-on",header:(0,se.jsx)(Z()._H,{id:"spaceConnectionsSettings.complianceConnectionsTable.integrationDateLastEdited.title",defaultMessage:"Edited on"})},{key:"more",header:void 0,style:{width:"5%"}}],rows:g,tableStyle:{borderTop:"none"}}),0===g.length?(0,se.jsx)("div",{style:s.emptyTable,children:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.integrationTable.emptyTable.message",defaultMessage:"No integration installed"})}):void 0]})}function Xe(e){const{integrationPointer:t,userStores:n,botIds:i,autoApproveBuiltByNotion:s}=e;if(t.table===b().K2){const e=t.id,o=(0,d().BP)({integrationId:e,env:"production"});return{key:e,columns:[(0,se.jsx)(it,{integrationTable:b().K2,integrationId:e},"integration-title"),(0,se.jsx)(ct,{renderedUsers:n,displayUsers:!o},"integration-installer-info"),(0,se.jsx)(xe,{integrationId:e,integrationTable:b().K2,botIds:i,disableDisconnectUser:o||void 0,disableDisallow:o&&s},"admin-integration-settings-menu")]}}if(t.table===j().cZ)return{key:t.id,columns:[(0,se.jsx)(it,{integrationTable:j().cZ,integrationId:t.id},"integration-title"),(0,se.jsx)(ct,{renderedUsers:n,displayUsers:!1},"integration-installer-info"),(0,se.jsx)(Fe,{botId:t.id},"integration-settings-menu")]};(0,k().t1)(t)}function et(e){const{moreSettingsComponent:t}=e,n=(0,o().Fy)();return t?(0,se.jsx)(re().ZP,{popupType:n.isMobile?re().Z4.SlideUp:re().Z4.Popup,renderOrigin:e=>(0,se.jsx)(W().Z,{...e,isMobile:n.isMobile,style:{marginLeft:8,marginRight:8}}),render:e=>i.cloneElement(t,{parent:e,from:"connection_settings"})}):(0,se.jsx)(se.Fragment,{})}function tt(e){const{aiConnectedApp:t}=e,n=t.connectionStatus,i=(0,r().yK)((e=>({inProgressIcon:{width:14,height:14,fill:e.blueColor,marginRight:4},connectedIcon:{width:14,height:14,marginRight:4},error:{width:16,height:16,fill:e.icon.orangePrimary}})),[]);return(0,se.jsxs)(Qe().gq,{children:[t.integrationIcon({fill:t.integrationIconColor??void 0,width:28,height:28,marginTop:4}),(0,se.jsxs)("div",{style:{minWidth:0,marginLeft:15},children:[(0,se.jsxs)("div",{style:{display:"flex"},children:[(0,se.jsx)(he().Z,{children:t.integrationName}),(0,se.jsx)(De().Z,{content:"AI Connector"})]}),(0,se.jsx)(he().Z,{isSmall:!0,style:{display:"flex"},children:nt(n,i)})]})]})}function nt(e,t){switch(e){case"connected":return(0,se.jsxs)(Qe().gq,{children:[(0,g().A)(t.connectedIcon),(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.installerInfoColumn.aiConnector.connected",defaultMessage:"Connected"})]});case"disconnecting":return(0,se.jsxs)(Qe().gq,{children:[(0,u().a)(t.inProgressIcon),(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.installerInfoColumn.aiConnector.disconnectionInProgress",defaultMessage:"Disconnection in progress"})]});case"in_progress":return(0,se.jsxs)(Qe().gq,{children:[(0,u().a)(t.inProgressIcon),(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.installerInfoColumn.aiConnector.inProgress",defaultMessage:"Connection in progress"})]});case"error":return(0,se.jsxs)(Qe().gq,{children:[(0,p().l)(t.inProgressIcon),(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.installerInfoColumn.aiConnector.Error",defaultMessage:"Connection error, Try again"})]});default:return(0,se.jsx)(se.Fragment,{})}}function it(e){const{integrationId:t,integrationTable:n,maybeWebhookSubscriptionId:i}=e,s=(0,a().VK)((()=>V().default.state.currentSpaceStore),[]),o=(0,a().VK)((()=>{if(s)return s.getRecordModel({table:n,id:t})}),[s,t,n]),r=(0,a().VK)((()=>{var e;if(s&&i)return null===(e=s.getRecordModel({table:I().bf,id:i,spaceId:s.id}))||void 0===e?void 0:e.getHealth()}),[s,i]),l=(0,K().E)("inactive_webhook_subscription_ui"),[c,d,u,g]=(0,a().VK)((()=>{if(!o)return[];let e;const i=[];let s;if(n===j().cZ){const a=o;a.icon&&(e={pointer:{table:n,id:t},icon:a.icon}),i.push("internal"),s=(0,se.jsx)(st,{botId:a.id})}else if(n===b().K2){const a=o,r=a.getInfo();r.icon&&(e={pointer:{table:n,id:t},icon:r.icon}),(0,S().mo)(a)&&(i.push("linkPreview"),(0,S().zc)(a)&&i.push("databaseSync")),s=(0,w().z6)(a.id)?null:(0,se.jsx)(ot,{integrationId:a.id})}else(0,k().t1)(n);return[null==o?void 0:o.name,e,i,s]}),[n,t,o]);if(!o||!u)return(0,se.jsx)(ce().Z,{});let p=null;return l&&!C(r)&&(p=(0,se.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:3},children:[(0,y().t)({width:12,color:P().FN.light.red[500]}),(0,se.jsx)(he().Z,{isSmall:!0,style:{color:P().FN.light.red[500]},children:(0,se.jsx)(Z()._H,{id:"workspaceIntegrationSettings.integrationTable.titleColumn.webhookError",defaultMessage:"Webhook error"})})]})),(0,se.jsxs)("div",{style:{display:"flex",alignItems:"center",maxWidth:300},children:[(0,se.jsx)(Ke().Z,{disabled:!0,icon:d,title:c,isEmptyPage:!1,size:28,isLarge:!0,useInvertedColors:!0}),(0,se.jsxs)("div",{style:{minWidth:0,marginLeft:15},children:[(0,se.jsxs)("div",{style:{display:"flex",marginRight:16},children:[(0,se.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,se.jsx)(he().Z,{children:c}),p]}),u.map((e=>e&&(0,se.jsx)(Be().Z,{desktopStyle:{marginLeft:4},children:Ge[e]},e)))]}),g]})]})}function st(e){let{botId:t}=e;const n=(0,a().VK)((()=>V().default.state.currentSpaceStore),[]),i=(0,Z().YB)(),s=(0,a().VK)((()=>null==n?void 0:n.getRecordModel({table:j().cZ,id:t})),[n,t]),o=(0,a().VK)((()=>{if(n&&s){const e=n.getRecordModel({table:s.created_by_table,id:s.created_by_id});return(0,_().Nz)(i,e)}}),[n,s,i]);return o?(0,se.jsx)(he().Z,{className:"notranslate",isSmall:!0,children:o}):(0,se.jsx)(at,{})}function ot(e){let{integrationId:t}=e;const n=(0,a().VK)((()=>V().default.state.currentSpaceStore),[]),i=(0,r().Fg)(),s=(0,a().VK)((()=>{const e=null==n?void 0:n.getRecordModel({table:b().K2,id:t});if("internal"!==(null==e?void 0:e.type))return null==e?void 0:e.getInfo().developer_name}),[n,t]);return(0,d().BP)({integrationId:t,env:"production"})?(0,se.jsx)(he().Z,{isSmall:!0,style:{display:"flex",alignItems:"center"},children:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.notion",defaultMessage:"Notion {icon}",values:{icon:(0,se.jsx)(Ve().Z,{renderTooltip:()=>(0,se.jsx)("div",{children:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.integrationTable.installerInfo.notion.tooltip",defaultMessage:"Developed by Notion"})}),placement:U().Placement.Right,render:e=>(0,se.jsx)("div",{...e,children:(0,h().X)({width:12,height:12,fill:i.invoiceGreen})})})}})}):s?(0,se.jsx)(he().Z,{className:"notranslate",isSmall:!0,children:s}):(0,se.jsx)(at,{})}function at(){return(0,se.jsx)(he().Z,{isSmall:!0,children:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.integrationTable.label.unverifiedDeveloper",defaultMessage:"Unverified developer"})})}function rt(e){const{editedByPointer:t}=e,n=(0,Z().YB)(),i=(0,a().VK)((()=>{const e=V().default.state.currentSpaceStore;if(e)return e&&t?O().U.createChildStore(e,t):void 0}),[t]),s=(0,a().VK)((()=>null==i?void 0:i.getDisplayName(n)),[i,n]);return i&&s?(0,se.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"flex-start",gap:8,alignItems:"center",width:"100%"},children:[(0,se.jsx)(Le().Z,{userStore:i,size:18}),(0,se.jsx)(he().Z,{children:s})]}):null}function lt(e){const{lastEditedOn:t}=e;return void 0===t?null:(0,se.jsx)(Ue().iP,{useThinTitle:!0,title:(0,c().Yx)(t,"long",s().locale)})}function ct(e){const{renderedUsers:t,displayUsers:n}=e,s=(0,a().VK)((()=>V().default.state.currentSpaceStore),[]),r=(0,Z().YB)(),l=(0,o().O7)(),c=(0,a().VK)((()=>{if(s)return(0,B().rn)(l,s)}),[l,s]),d=(0,i.useMemo)((()=>t&&t.length),[t]),u=(0,a().VK)((()=>t&&t.length>0?t[0]:void 0),[t]),g=(0,a().VK)((()=>u?u.getDisplayName(r):void 0),[u,r]);return n&&void 0!==d?u?(0,se.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,se.jsx)(Le().Z,{userStore:u,avatarShouldShowShadow:!0,style:{marginRight:8},size:28}),(0,se.jsx)(he().Z,{children:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.listOfUsers",defaultMessage:"{remainingCount, plural, =0 {{firstUser}} one {{firstUser} +{remainingCount}} other {{firstUser} +{remainingCount}}}",values:{firstUser:g,remainingCount:d-1}})})]}):(0,se.jsx)(he().Z,{isSecondaryColor:!0,style:{display:"flex",alignItems:"center"},children:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.noUsers",defaultMessage:"No users"})}):(0,se.jsx)(he().Z,{style:{display:"flex",alignItems:"center"},children:(0,se.jsx)(Z()._H,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.anyone",defaultMessage:"Anyone in {spaceName}",values:{spaceName:(0,se.jsx)(he().Z,{style:{fontWeight:A().Ue.medium},children:c})}})})}},500590:(e,t,n)=>{n.d(t,{Z:()=>O});n(670560),n(267602),n(916054),n(653476),n(470928),n(241792),n(731107),n(228244);var i=n(667294),s=()=>n(219727),o=()=>n(142735),a=()=>n(846550),r=()=>n(263184),l=()=>n(933868),c=()=>n(396136),d=()=>n(788860),u=()=>n(568017),g=()=>n(239482),p=()=>n(876822),m=()=>n(826955),f=()=>n(827973),h=()=>n(715139),v=()=>n(943620),x=()=>n(384241),y=()=>n(945634),S=n(785893);const j={display:"flex",alignItems:"center"};const b=function(e){const{nestingLevel:t,isChecked:n,onClick:i,store:s,isMobile:o}=e;return(0,S.jsx)(f().Z,{...e,title:(0,S.jsx)(y().Z,{childrenStyle:j,left:(0,S.jsx)(I,{isChecked:n,onClick:i}),icon:(0,S.jsx)(k,{store:s,isMobile:o}),style:{marginLeft:8*t},children:(0,S.jsx)(x().Z,{store:s})})})};function I(e){let{isChecked:t,onClick:n}=e;return(0,S.jsx)(h().Z,{size:16,checked:t,onClick:n})}function k(e){let{store:t,isMobile:n}=e;const i=(0,a().Fg)(),s=(0,o().VK)((()=>t.getIcon()),[t]),r=(0,o().VK)((()=>t.isEmptyPage()),[t]);return(0,S.jsx)(v().Z,{disabled:!0,icon:s,title:void 0,isEmptyPage:r,size:n?24:20,pageIconStyle:{fill:i.mediumIconColor}})}var C=()=>n(255577),M=()=>n(388284),w=()=>n(801812),_=()=>n(696459),Z=()=>n(352230),P=()=>n(677559),A=()=>n(828946),N=()=>n(98228),T=()=>n(198829),H=()=>n(838367),D=()=>n(231219),B=()=>n(497459);function K(e){const{spaceId:t,onSelectPage:n,query:i,source:o,findSelectedBlockAncestorId:a}=e,r=(0,s().O7)();let u=null;const g=(0,P().XJ)(A().x.searchActions),[{status:p,value:f}]=(0,w().r5)((async()=>{if("resolved"!==g.status)return;const e=g.value;return await e.searchPagesInSpace({environment:r,query:i,limit:10,requireEditPermissions:!0,spaceId:t,excludeTemplates:!0,source:o,boostRecentlyViewedPages:!1})}),[r,i,t,o,g.status,g.value],{debounce:N().vp});if("idle"===p||"pending"===p)u=(0,S.jsx)(M().Z,{children:(0,S.jsx)(B().Z,{})});else{const e=((null==f?void 0:f.results)||[]).map((e=>{let{id:t}=e;const i=new(m().G)(r,{table:c().iU,id:t});return function(e){const{store:t,environment:n,alreadySelectedAncestorId:i,onSelectPage:s}=e;if(i&&i===t.id)return{key:t.id,action:()=>{},render:e=>(0,S.jsx)(D().Z,{...e,store:t,hidePath:!0,disabled:!0,style:{opacity:.5},caption:(0,S.jsx)(d()._H,{id:"oauthPageSearchResults.disabledResult.bySelf.message",defaultMessage:"Already added"})})};if(i){const e=new(m().G)(n,{table:c().iU,id:i});return{key:t.id,action:()=>{},render:n=>(0,S.jsx)(D().Z,{...n,store:t,hidePath:!0,disabled:!0,style:{opacity:.5},caption:(0,S.jsx)(d()._H,{id:"oauthPageSearchResults.disabledResult.byAncestor.message",defaultMessage:"Already added via {ancestorPageName}",values:{ancestorPageName:(0,S.jsx)(x().Z,{store:e,style:{display:"inline"}})}})})}}const o=t.getRole();return o&&l().zz(o)?{key:t.id,action:()=>s(t.id),render:e=>(0,S.jsx)(D().Z,{store:t,hidePath:!1,...e})}:void 0}({store:i,alreadySelectedAncestorId:a(i),environment:r,onSelectPage:n})})).filter(_().$K);u=0===e.length?(0,S.jsx)(M().Z,{children:(0,S.jsx)(H().Z,{title:(0,S.jsx)(d()._H,{id:"oauthPageSearchResults.noResults.placeholder",defaultMessage:"No results"})})}):function(e){return(0,S.jsx)(C().ZP,{type:C().iW.Vertical,initialFocus:void 0,sections:[{key:"results",items:e,render:e=>(0,S.jsx)(M().Z,{...e})}]})}(e)}const h={menuType:Z().o.Popup};return(0,S.jsx)(T().Z,{...h,children:u})}const U=r().default.createClass({},{name:"SelectedBlockIdsStore"}),V=r().default.createClass({open:!1,query:void 0},{name:"SearchStore"});function L(e){return e.isDefined()&&"copy_indicator"!==e.getType()}const O=function(e){let{selectedBlockIdsStore:t}=e;const r=(0,d().YB)(),l=(0,a().Fg)(),f=(0,s().O7)(),h=(0,o().VK)((()=>{var e;return null===(e=p().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),v=f.currentUser.id;(0,i.useEffect)((()=>{h&&v&&(n(221662).h({environment:f,spaceId:h,userId:v}),n(111631).I({environment:f,spaceId:h,userId:v}))}),[f,h,v]);const x=(0,o().qz)(void 0,V),j=(0,o().qz)(t,U),b=(0,i.useCallback)((()=>function(e){const t=e.state;e.setState({...t,open:!1,query:void 0})}(x)),[x]),I=(0,i.useCallback)((e=>function(e,t){const n=t.state[e.id];if(n)return e.id;const i=g().fJ(e),s=i.find((e=>e.table===c().iU&&Boolean(t.state[e.id])));if(s)return s.id}(e,j)),[j]),k=(0,o().Kw)((0,n(718959).k_)(f)),{allSharedPagesStores:w=[],showWorkspaceSection:_=!1,showTeamSection:Z=!1,showSharedSection:P=!1,showPrivateSection:A=!1,showOnlyPrivateSection:N=!1}=k??{},{currentSpaceViewStore:T,currentSpaceStore:H}=(0,o().VK)((()=>{const{currentSpaceViewStore:e,currentSpaceStore:t}=p().default.state;return{currentSpaceViewStore:e,currentSpaceStore:t}}),[]),D=(0,o().Kw)(j),B=(0,o().VK)((()=>{const e=(null==T?void 0:T.getTeamsStores())??[];return Z?e.map((e=>[e,e.getTeamPagesStores().filter(L)])):[]}),[Z,T]),O=(0,o().VK)((()=>(null==T?void 0:T.getWorkspacePages().filter(L))??[]),[T]),R=(0,o().VK)((()=>(null==T?void 0:T.getPrivatePages(f).filter(L))??[]),[T,f]),F=Object.keys(D).filter((e=>D[e])).map((e=>new(m().G)(f,{table:c().iU,id:e}))),Q=(0,o().VK)((()=>F.filter((e=>e.getSpaceId()===(null==H?void 0:H.id)&&e.isNavigableBlock()&&!e.isTopLevelPrivatePage({spaceStore:H,environment:f})&&!e.isTopLevelWorkspacePage(H.id)&&!(e.getParentTable()===n(306164).e0)&&!(null!=w&&w.some((t=>t.id===e.id)))))),[F,H,f,w]),$=(0,o().VK)((()=>H?(0,n(345918).rn)(f,H):void 0),[H,f]),{open:G,query:Y}=(0,o().VK)((()=>{const{open:e,query:t}=x.state;return{open:e,query:t}}),[x]),J=(0,o().VK)((()=>function(e){let{environment:t,theme:n,intl:i,subpages:s,selectedBlockIdsStore:o,showWorkspaceSection:a,workspacePages:r,showTeamSection:l,teamPagesByTeam:c,showSharedSection:u,allSharedPagesStores:g,showPrivateSection:p,showOnlyPrivateSection:m,spaceName:f,privatePages:h}=e;const v=[];s.length>0&&v.push({key:"manual",render:e=>(0,S.jsx)(M().Z,{...e,title:(0,S.jsx)(y().Z,{style:W(),children:(0,S.jsx)(d()._H,{id:"oauthAuthorizationPage.selectPagesStep.pagePicker.manuallyAddedPagesSection.title",defaultMessage:"Manually added"})}),isTitleUppercase:!0}),items:s.map((e=>z(e,0,t,o)))});a&&v.push(q("workspace",i.formatMessage({id:"oauthAuthorizationPage.selectPagesStep.pagePicker.workspaceSection.title",defaultMessage:"Workspace"}),r,t,n,o));if(l)for(const[d,x]of c){const e=d.id,i=d.getName();e&&void 0!==i&&v.push(q(`team-${e}`,i,x,t,n,o))}u&&v.push(q("shared",i.formatMessage({id:"oauthAuthorizationPage.selectPagesStep.pagePicker.sharedSection.title",defaultMessage:"Shared"}),g,t,n,o));if(p){const e=m?f||"":i.formatMessage({id:"oauthAuthorizationPage.selectPagesStep.pagePicker.privateSection.title",defaultMessage:"Private"});v.push(q("private",e,h,t,n,o))}return v}({environment:f,theme:l,intl:r,subpages:Q,selectedBlockIdsStore:j,showWorkspaceSection:_,workspacePages:O,showTeamSection:Z,teamPagesByTeam:B,showSharedSection:P,allSharedPagesStores:w,showPrivateSection:A,showOnlyPrivateSection:N,spaceName:$,privatePages:R})),[f,l,r,Q,j,_,O,Z,B,P,w,A,N,$,R]);if(!k)return(0,S.jsx)(n(312578).Z,{style:{alignSelf:"center"}});if(!T||!H)return null;const X={width:14,height:14,marginLeft:8,marginRight:8,flexGrow:0,flexShrink:0,fill:u().ZP.mediumIconColor};return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(n(967092).ZP,{origin:(0,S.jsx)(n(740046).ZP,{style:{marginBottom:8},itemMarginLeft:0,itemMarginRight:0,focus:!0,focusAfterAnimation:!0,value:Y||"",onChange:e=>{!function(e,t){const n=t.state,i=e.length>0;t.setState({...n,query:e,open:i})}(e.target.value,x)},placeholder:r.formatMessage({id:"oauthAuthorizationPage.selectPagesStep.pagePicker.search.placeholder",defaultMessage:"Search for pages in {workspaceName}"},{workspaceName:$}),inputLeft:(0,n(899548).R)(X)}),sameWidthAsOrigin:!0,popupType:n(104088).k.Popup,open:G,render:()=>(0,S.jsx)(K,{spaceId:H.id,onSelectPage:e=>E(e,!1,j),query:Y||"",source:"oauth",findSelectedBlockAncestorId:I}),onDismiss:b}),(0,S.jsx)("div",{style:{alignItems:"left",width:"100%",height:380,borderWidth:1,borderStyle:"solid",borderColor:u().ZP.contentBorder,borderRadius:6,overflowY:"auto"},children:(0,S.jsx)(C().ZP,{type:C().iW.Vertical,sections:J,initialFocus:void 0})})]})};function W(){return{textTransform:"uppercase",fontSize:12,fontWeight:600,color:u().ZP.mediumTextColor,padding:"2px 0"}}function R(e){return{key:"empty",action:()=>{},render:t=>(0,S.jsx)(f().Z,{...t,title:(0,S.jsx)(y().Z,{style:{fontSize:14,color:e.mediumTextColor,padding:"2px 32px"},children:(0,S.jsx)(d()._H,{id:"oauthAuthorizationPage.selectPageStep.empty",defaultMessage:"No pages inside"})})})}}function E(e,t,n){n.setState({...n.state,[e]:!t})}function z(e,t,n,i){const{device:s}=n,o=Boolean(i.state[e.id]);return{key:e.id,action:()=>E(e.id,o,i),render:n=>(0,S.jsx)(b,{...n,isMobile:s.isMobile,store:e,isChecked:o,disabled:!1,nestingLevel:t})}}function F(e,t,n){const i=t.length>0&&t.every((e=>n.state[e.id]));return{key:e,action:()=>function(e,t){const n=e.every((e=>t.state[e.id]));t.setState({...t.state,...e.reduce(((e,t)=>(e[t.id]=!n,e)),{})})}(t,n),render:t=>(0,S.jsx)(f().Z,{...t,title:(0,S.jsx)(y().Z,{left:(0,S.jsx)(h().Z,{onClick:t.onClick,checked:i,size:16}),style:W(),children:e})})}}function q(e,t,n,i,s,o){const a=n.filter((e=>l().zz(e.getRole()||"none")));return{key:e,render:e=>(0,S.jsx)(M().Z,{...e}),items:[F(t,a,o),...0===a.length?[R(s)]:a.map((e=>z(e,1,i,o)))]}}},625827:(e,t,n)=>{n.d(t,{Z:()=>I});n(267602),n(653476),n(241792);var i=n(667294),s=()=>n(219727),o=()=>n(846550),a=()=>n(667067),r=()=>n(788860),l=()=>n(696459),c=()=>n(707513),d=()=>n(286310),u=()=>n(906301),g=()=>n(154186),p=()=>n(265640),m=()=>n(356042),f=()=>n(946563),h=()=>n(943620),v=()=>n(868614),x=n(785893);const y=2,S=1,j=3,b=36;function I(e){const{apps:t,numberOfConnectedApps:n,title:o,subtitle:a,numberOfDisplayRows:c}=e,u=(0,s().O7)(),[g,m]=(0,i.useState)(!1),f=(c||S)*j,h=t.filter((e=>!e.shouldHideInDiscover)),b=h.length>f&&!g,I=g?h:h.slice(0,f);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(v().Z,{large:!0,divider:"none",children:[o,a]}),(0,x.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:16,overflow:"hidden"},children:I.map((e=>{var t;return e.onConnect&&(0,x.jsx)(k,{appName:e.appName,caption:e.caption,shouldShowNewBadge:e.shouldShowNewBadge,shouldShowUpsell:e.shouldShowUpsell,logo:e.logo,integrationTypes:null===(t=e.integrationTypes)||void 0===t?void 0:t.slice(0,y),onConnect:e.onConnect},e.id)})).filter((e=>(0,l().$K)(e)))}),b&&(0,x.jsx)(p().D,{style:{marginTop:10,gap:10,marginLeft:-8},isGray:!0,onClick:()=>{g||(m(!0),d().EU(u,{numberOfConnectedApps:n}))},children:(0,x.jsx)(r()._H,{id:"connectedAppsSettings.discoverNewAppSection.seeAll.label",defaultMessage:"See all"})})]})}function k(e){const{appName:t,caption:n,logo:i,shouldShowUpsell:s,integrationTypes:l,onConnect:d}=e,p=(0,o().yK)((e=>({card:{display:"flex",flexDirection:"column",justifyContent:"space-between",borderRadius:8,border:`1px solid ${e.tableDividerColor}`,padding:12,height:"100%",overflow:"hidden",minWidth:120,gap:12,maxWidth:256},upsellCard:{backgroundColor:e.whiteButtonBackground},connectedAppIcon:{width:b,height:b,padding:4,borderRadius:6},titleAndPillContainer:{display:"flex",flexDirection:"row",justifyContent:"center",gap:4},titleAndNewBadgeContainer:{alignItems:"center",display:"flex",marginLeft:2},title:{fontWeight:c().Ue.medium,fontSize:14,lineHeight:1.3,marginBottom:4},caption:{marginLeft:2,marginRight:2,fontWeight:c().Ue.regular,color:e.mediumTextColor,fontSize:12,maxHeight:72,overflow:"hidden",lineHeight:1.3},pillContainer:{marginTop:8,marginBottom:6,fontSize:12,color:e.text.tertiary,display:"flex",gap:4,fontWeight:500},lockedIcon:{color:e.mediumIconColor,width:16,height:16,marginLeft:6},logoTitleContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:8}})),[]),v=(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{style:p.logoTitleContainer,children:["string"==typeof i?(0,x.jsx)("img",{src:i,style:p.connectedAppIcon}):(0,x.jsx)(h().Z,{disabled:!0,icon:i,title:t,isEmptyPage:!1,size:b,isLarge:!0,useInvertedColors:!0,style:p.connectedAppIcon}),(0,x.jsxs)("div",{style:p.titleAndNewBadgeContainer,children:[(0,x.jsx)("div",{style:p.title,children:t}),s&&(0,a().Q)(p.lockedIcon)]})]}),(0,x.jsx)("div",{style:p.caption,children:n}),(0,x.jsx)("div",{style:p.pillContainer,children:null==l?void 0:l.map((e=>e&&(0,x.jsx)(f().Z,{children:u().a_[e]},e)))})]});return s?(0,x.jsx)("div",{style:{...p.card,...p.upsellCard},children:v}):(0,x.jsxs)(g().Z,{onClick:d,style:p.card,children:[v,(0,x.jsx)(m().F,{color:"uiBlue",onClick:d,children:(0,x.jsx)(r()._H,{id:"connectedAppSettingsDiscoverItem.connectButton.label",defaultMessage:"Connect"})})]})}},585649:(e,t,n)=>{n.d(t,{Z:()=>m});n(667294);var i=()=>n(219727),s=()=>n(843403),o=()=>n(456681),a=()=>n(828042),r=()=>n(836273),l=()=>n(788860),c=()=>n(286310),d=()=>n(148126),u=()=>n(265640),g=()=>n(108714),p=n(785893);function m(){const e=(0,i().O7)();return(0,p.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[(0,p.jsx)(g().Z,{style:{display:"flex",marginLeft:-6},className:"notion-print-ignore",href:`${r()._j.integrations}/all`,external:!0,onClick:()=>{c().uy(e,{from:"integration-settings",href:`${r()._j.integrations}/all`})},children:(0,p.jsx)(u().D,{icon:s().J,size:"sm",isLightGray:!0,children:(0,p.jsx)(l()._H,{id:"connectionsSettingsLinks.connectionsGallery",defaultMessage:"Browse connections in Gallery"})})}),(0,p.jsx)(g().Z,{style:{display:"flex",marginLeft:-6},className:"notion-print-ignore",href:r()._j.creatorProfileIntegrations,external:!0,onClick:()=>{c().YY(e,{from:"integration-settings",href:r()._j.creatorProfileIntegrations})},children:(0,p.jsx)(u().D,{icon:s().J,size:"sm",isLightGray:!0,children:(0,p.jsx)(l()._H,{id:"connectionsSettingsLinks.manageConnections",defaultMessage:"Develop or manage integrations"})})}),(0,p.jsx)(g().Z,{style:{display:"flex",marginLeft:-6},className:"notion-print-ignore",href:(0,d().UY)("guides.publicAPI"),external:!0,children:(0,p.jsx)(u().D,{icon:o().m,size:"sm",isLightGray:!0,children:(0,p.jsx)(l()._H,{id:"connectionsSettingsLinks.helpCenter",defaultMessage:"Learn more about connections"})})}),(0,p.jsx)(g().Z,{style:{display:"flex",marginLeft:-6},className:"notion-print-ignore",href:(0,d().UY)("guides.aiConnectorsSlack"),external:!0,children:(0,p.jsx)(u().D,{icon:a().t,size:"sm",isLightGray:!0,children:(0,p.jsx)(l()._H,{id:"connectionsSettingsLinks.aiConnectorsHelpCenter",defaultMessage:"Notion AI connectors"})})})]})}},219592:(e,t,n)=>{n.d(t,{Z:()=>Se,O:()=>ye});n(670560),n(267602),n(653476),n(470928),n(241792),n(228244);var i=n(667294),s=()=>n(219727),o=()=>n(142735),a=()=>n(714230),r=()=>n(163262),l=()=>n(235484),c=()=>n(801812),d=()=>n(705214),u=()=>n(696056),g=()=>n(255933),p=()=>n(657120),m=()=>n(921787),f=()=>n(788860),h=()=>n(513670),v=()=>n(696459),x=()=>n(286310),y=()=>n(824462),S=()=>n(54193),j=()=>n(916673),b=()=>n(308186),I=()=>n(205228),k=()=>n(848643);const C=new(n(529048).Z);var M=()=>n(528918),w=()=>n(402269);const _=(0,f().vU)({authenticatingWithAsana:{id:"asanaActions.authenticatingWithAsana.loadingMessage",defaultMessage:"Authenticating with Asana…"},titleMessage:{defaultMessage:"Asana login",id:"asanaActions.loginWithAsanaPopupModal.title"}});var Z=()=>n(158792),P=()=>n(481476),A=()=>n(819026),N=()=>n(585558),T=()=>n(388915),H=()=>n(306558),D=()=>n(423402);var B=()=>n(345918),K=()=>n(520849),U=()=>n(876822),V=()=>n(138912),L=()=>n(826955),O=()=>n(853648),W=()=>n(897257),R=()=>n(625827),E=()=>n(585649),z=()=>n(842574),F=()=>n(67961),q=()=>n(504117),Q=()=>n(868614),$=(n(30005),()=>n(943620)),G=()=>n(378907),Y=()=>n(263184),J=()=>n(568017),X=()=>n(352230),ee=()=>n(145873),te=()=>n(500590),ne=()=>n(827973),ie=()=>n(448419),se=()=>n(198829),oe=()=>n(255577),ae=()=>n(661297),re=()=>n(906651),le=()=>n(388284),ce=()=>n(868744),de=n(785893);function ue(e){const{botId:t,canSelectPageAccess:n,onConnect:a,onDisconnect:r,botSharedPagesStore:l}=e,[c]=(0,i.useState)(Y().default.createValue({})),d=(0,o().VK)((()=>U().default.state.currentSpaceStore),[]),g=(0,s().O7)(),p=(0,s().Fy)(),m=(0,o().VK)((()=>{var e;const n={};return((null===(e=l.state.result)||void 0===e||null===(e=e[t])||void 0===e?void 0:e.pageIds)??[]).forEach((e=>{n[e]=!0})),n}),[l,t]);(0,i.useEffect)((()=>{n&&d&&c.setState(m)}),[n,d,m,c]);const h=[];n&&d&&h.push({key:"actions for user guest connections",render:e=>(0,de.jsx)(le().Z,{...e}),items:[{key:"update selected pages",render:(e,n)=>(0,de.jsx)(ce().Z,{...e,onFocus:n.onFocus,disableDefaultClick:!0,renderOrigin:e=>(0,de.jsx)(ne().Z,{...e,title:(0,de.jsx)(f()._H,{id:"userConnectionsSettings.actionMenu.selectPages.label",defaultMessage:"Access selected pages"})}),renderExtension:(e,n)=>{return(0,de.jsxs)("div",{style:{width:400,padding:20},children:[(0,de.jsx)(te().Z,{selectedBlockIdsStore:c}),(i={leftText:(0,de.jsx)(f()._H,{id:"userConnectionsSettings.actionMenu.pagePicker.cancel",defaultMessage:"Cancel"}),leftAction:()=>{c.setState(m),n.close()},rightText:(0,de.jsx)(f()._H,{id:"userConnectionsSettings.actionMenu.pagePicker.update",defaultMessage:"Update access"}),rightAction:()=>{!function(e){const{botId:t,currentSpaceStore:n,environment:i,selectedBlockIdsStore:s,currentAccessedPages:o}=e,a=[],r=[],l=s.state;Object.keys(l).forEach((e=>{o.hasOwnProperty(e)&&!l[e]?a.push(e):!o.hasOwnProperty(e)&&l[e]&&r.push(e)}));const c=L().t1.createChildStore(n,{table:u().cZ,id:t});Z().jX({environment:i,currentSpaceStore:n,botStore:c,pages:a}),Z().jX({environment:i,currentSpaceStore:n,botStore:c,pages:r,addPermission:!0})}({selectedBlockIdsStore:c,environment:g,currentSpaceStore:d,botId:t,currentAccessedPages:m}),n.close()}},(0,de.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:24},children:[(0,de.jsx)(ae().Z,{size:"lg",onClick:i.leftAction,children:i.leftText}),(0,de.jsx)(re().Z,{isLarge:!0,onClick:i.rightAction,children:i.rightText})]}))]});var i}}),action:()=>{}}]});const v=[];return a&&v.push({key:"connect account",render:e=>(0,de.jsx)(ne().Z,{...e,title:(0,de.jsx)(f()._H,{id:"userConnectionsSettings.actionMenu.connectAccount.label",defaultMessage:"Connect another account"}),onClick:a}),action:a}),v.push({key:"disconnect account",render:e=>(0,de.jsx)(ne().Z,{...e,title:(0,de.jsx)("div",{style:{color:J().ZP.red},children:(0,de.jsx)(f()._H,{id:"userConnectionsSettings.actionMenu.disconnectAccount.label",defaultMessage:"Disconnect account"})}),onClick:()=>{r()}}),action:()=>r()}),h.push({key:"actions for all user connections",render:e=>(0,de.jsx)(le().Z,{...e}),items:v}),(0,de.jsx)(ie().ZP,{popupType:p.isMobile?ie().Z4.SlideUp:ie().Z4.Popup,renderOrigin:e=>(0,de.jsx)(ee().Z,{...e,isMobile:p.isMobile}),render:()=>(0,de.jsx)(se().Z,{menuType:p.isMobile?X().o.ActionSheet:X().o.Popup,children:(0,de.jsx)(oe().ZP,{type:oe().iW.Vertical,sections:h,initialFocus:void 0})})})}const ge=28;function pe(e){const{userConnections:t,botSharedPagesStore:n}=e;return(0,de.jsx)(G().Z,{columns:[{key:"connection",header:(0,de.jsx)(f()._H,{id:"userConnectionsSettings.connectionsTable.connectionsColumn.title",defaultMessage:"Connection"}),style:{width:"40%"}},{key:"access",header:(0,de.jsx)(f()._H,{id:"userConnectionsSettings.connectionsTable.accessColumn.title",defaultMessage:"Access"}),style:{width:"40%"}},{key:"more",header:void 0,style:{width:"5%"}}],rows:me(t,n)})}function me(e,t){const n=[];return e.forEach((e=>{const{account:i,onDisconnect:s}=e;if(Array.isArray(i)){const o=i.map((n=>fe({connection:{...e,onDisconnect:()=>{s(n)}},account:n,botSharedPagesStore:t})));n.push(...o)}else n.push(fe({connection:e,account:i,botSharedPagesStore:t}))})),n}function fe(e){const{account:t,connection:{id:n,appName:i,canSelectPageAccess:s,capabilities:o,logo:a,onConnect:r,onDisconnect:l},botSharedPagesStore:c}=e,d=void 0!==t&&"string"!=typeof t,u=d?t.accountName:t,g=d?t.accountId:n;return{key:`${g}-${u}`,columns:[(0,de.jsx)(he,{accountName:u,connectionLogo:a,connectionName:i},"connection-title"),o,(0,de.jsx)(ue,{botId:g,canSelectPageAccess:s,connectionName:i,onConnect:r,onDisconnect:l,botSharedPagesStore:c},"connection-action-menu")]}}function he(e){const{accountName:t,connectionLogo:n,connectionName:i}=e;return(0,de.jsxs)("div",{style:{display:"flex",alignItems:"center",marginRight:12},children:["string"==typeof n?(0,de.jsx)("img",{src:n,style:{height:ge,maxWidth:ge}}):(0,de.jsx)($().Z,{disabled:!0,icon:n,title:i,isEmptyPage:!1,size:ge,isLarge:!0,useInvertedColors:!0}),(0,de.jsxs)("div",{style:{marginLeft:15},children:[(0,de.jsx)(F().Z,{children:i}),t&&(0,de.jsx)(F().Z,{isSmall:!0,children:t})]})]})}const ve={height:"100%",padding:"36px 60px"},xe={alignItems:"center",display:"flex",flexDirection:"column",flex:1,height:"100%",justifyContent:"center"};function ye(e){const t=[];return null!=e&&e.read_content&&t.push((0,de.jsx)(f()._H,{id:"userConnectionsSettings.connectionsTable.botAccess.readContent",defaultMessage:"view"})),null!=e&&e.insert_content&&t.push((0,de.jsx)(f()._H,{id:"userConnectionsSettings.connectionsTable.botAccess.insertContent",defaultMessage:"insert"})),null!=e&&e.update_content&&t.push((0,de.jsx)(f()._H,{id:"userConnectionsSettings.connectionsTable.botAccess.updateContent",defaultMessage:"update"})),t}const Se=function(e){let{location:t}=e;const i=(0,s().O7)(),a=(0,o().qz)(void 0,O().Z);return(0,o().VK)((()=>n(804217).default.state.online),[])?(0,de.jsx)(n(154439).Z,{request:i,performRequest:()=>async function(e){const{currentSpaceStore:t}=U().default.state;return{guestBotIds:await Ce(e),connectionStatus:await P().LN(e,null==t?void 0:t.id)}}(i),requestStore:a,render:(e,i)=>null!=i&&i.connectionStatus?(0,de.jsx)(we,{location:t,requestStore:a,guestBotIds:i.guestBotIds}):(0,de.jsx)("div",{style:xe,children:(0,de.jsx)(n(312578).Z,{})})}):(0,de.jsx)(je,{})};function je(){return(0,de.jsx)(q().ZP,{children:(0,de.jsx)(F().Z,{isSmall:!0,style:{textAlign:"center"},children:(0,de.jsx)(f()._H,{id:"connectedAppsSettings.offline.message",defaultMessage:"Please go online to manage connecting to apps."})})})}function be(e){return{display:"flex",flexDirection:"column",height:"100%",width:"sidebar-modal"===e?"100%":"auto"}}function Ie(e,t){const{currentSpaceStore:n}=U().default.state;if(!n||(0,B().Cx)(n))return[];return e.map((e=>{const i=L().t1.createChildStore(n,{table:u().cZ,id:e}),s=i.getName();if(!i.getAlive()||!s||i.isInternalBot())return;const o=i.getIntegrationPointer(),a=i.getIcon(),r=a&&o?{pointer:o,icon:a}:void 0;return{id:i.id,appName:s,caption:void 0,account:void 0,logo:r,capabilities:(0,de.jsx)(f()._H,{id:"userConnectionsSettings.connectionsTable.accessColumn.userGuest",defaultMessage:"Can {capabilities} content",values:{capabilities:(0,de.jsx)(f().yX,{value:ye(i.getCapabilities()),type:"conjunction"})}}),canSelectPageAccess:!0,onDisconnect:async()=>{const{accept:e}=await b().gt({message:(0,de.jsx)("span",{children:(0,de.jsx)(f()._H,{id:"userConnectionsSettings.deleteExternalAuthorization.withoutAccountName.confirmationMessage",defaultMessage:"Revoke access for this account?"})}),acceptLabel:(0,de.jsx)(f()._H,{id:"userConnectionsSettings.deleteExternalAuthorization.confirmDelete.label",defaultMessage:"Yes"})});e&&await Z().P0({environment:t,botId:i.id,onSuccess:()=>{}})}}})).filter(v().$K)}function ke(e){const{currentSpaceStore:t}=U().default.state;if(!t||!t.canEdit())return[];const n=t.getBotSettingsStore().getValue(),i=t.id,{integrations:{state:s},bots:{state:o},externalAuthentications:{state:a}}=V().default,c=t.canAdmin(),g=l().Gw,y={[l().nO]:1,[l().f3]:2,[l().Ff]:3,[l().mQ]:4,[l().U9]:5,[g]:6};s.sort(((e,t)=>(y[e.id]??1/0)-(y[t.id]??1/0)));const S=[l().U9,l().Ff,l().aW];return s.map((s=>{var g;if(!s.info.icon)return;if(!c&&S.includes(s.id))return;if((0,m().I$)(s.id))return;const v=o.filter((e=>e.integration_id===s.id)),y=h().oA(v.map((e=>{const t=a.find((t=>t.parent_id===e.id));if(t)return{accountId:e.id,accountName:t.account_name}}))),j=(0,p().hU)({spaceBotSettings:n,integrationId:s.id,env:"production"}),I=y.length>0;if(!j&&!I)return;if(!I&&s.id===l().Dv)return;const k=!j,C=function(e){const t=[];return(0,d().VM)(e)&&t.push((0,de.jsx)(f()._H,{id:"userConnectionsSettings.connectionsTable.botAccess.previewLinks",defaultMessage:"preview links"},"previewLinks")),function(e){return!!e.info.original_url_patterns&&e.info.original_url_patterns.some((e=>{var t;return null===(t=e.additional_types)||void 0===t?void 0:t.collection}))}(e)&&t.push((0,de.jsx)(f()._H,{id:"userConnectionsSettings.connectionsTable.botAccess.syncDatabases",defaultMessage:"sync databases"},"syncedDatabase")),(0,d().hB)(e)&&t.push((0,de.jsx)(f()._H,{id:"userConnectionsSettings.connectionsTable.botAccess.automationAction",defaultMessage:"run automations"},"automationAction")),t}(s),M=!h().xb(C)&&(0,de.jsx)(f()._H,{id:"userConnectionsSettings.connectionsTable.accessColumn.external",defaultMessage:"Can {capabilities}",values:{capabilities:(0,de.jsx)(f().yX,{value:C,type:"conjunction"})}}),w=(0,r().ms)(s.capabilities),_=null===(g=s.capabilities)||void 0===g?void 0:g.inherit_creator_permissions,P=w&&!_,A=[];return(0,d().mo)(s)&&A.push("linkPreview"),(0,d().zc)(s)&&A.push("databaseSync"),(0,d().hB)(s)&&A.push("automation_action"),{id:s.id,appName:s.name,caption:s.info.tagline,logo:s.info.icon,account:y,shouldHideConnectAccount:k,shouldShowNewBadge:!s.info.hide_new_badge,integrationTypes:A,capabilities:(0,de.jsxs)(de.Fragment,{children:[(0,de.jsx)("div",{children:M}),w?(0,de.jsx)("div",{children:(0,de.jsx)(f()._H,{id:"userConnectionsSettings.connectionsTable.accessColumn.externalWithCapabilities",defaultMessage:"Can {capabilities} content",values:{capabilities:(0,de.jsx)(f().yX,{value:ye(s.capabilities),type:"conjunction"})}})}):null]}),canSelectPageAccess:P,onConnect:async()=>{await T().hM({environment:e,integration:s,spaceId:i,from:"connected_apps_settings"}),D().pJ({environment:e})},onDisconnect:async n=>{const i=o.find((e=>e.id===(null==n?void 0:n.accountId)));if(i){const o=L().t1.createChildStore(t,{table:u().cZ,id:i.id,spaceId:i.space_id}),a=null!=n&&n.accountName?(0,de.jsx)(f()._H,{id:"connectedAppSettings.deleteExternalAuthorization.withAccountName.confirmationMessage",defaultMessage:'Revoke access for "{accountName}"?',values:{accountName:n.accountName}}):(0,de.jsx)(f()._H,{id:"connectedAppSettings.deleteExternalAuthorization.withoutAccountName.confirmationMessage",defaultMessage:"Revoke access for this account?"}),{accept:r}=await b().gt({message:(0,de.jsx)("span",{children:a}),acceptLabel:(0,de.jsx)(f()._H,{id:"connectedAppSettings.deleteExternalAuthorization.confirmDelete.label",defaultMessage:"Yes"})});r&&(await Z().P0({environment:e,botId:o.id,onSuccess:()=>{}}),x().lL(e,{integrationId:s.id}))}}}})).filter(v().$K)}async function Ce(e){const{currentSpaceStore:t,currentUserStore:n}=U().default.state;if(!t||!n||!W().subscriptionDataStoreInstance.state)return[];return(await Z().Yw({environment:e,table:g().bx,id:t.id,type:"guest"})).botIds.filter((e=>L().t1.createChildStore(t,{table:u().cZ,id:e}).getCreatedById()===n.id))}function Me(e,t,n){var i;const s=n;let o=!1;const{currentSpaceStore:r}=U().default.state,c=null===(i=s.state.result)||void 0===i?void 0:i.connectionStatus,u=(null==c?void 0:c.drive)&&(null==c?void 0:c.drive.length)>0,g=function(){const{integrations:{state:e}}=V().default;return!e.some((e=>e.id===l().f3))}();if(g){const e=null==r?void 0:r.getBotSettingsStore().getValue();o=!(0,p().CJ)(e)||Boolean((null==e?void 0:e.integration_approval_statuses)&&e.integration_approval_statuses[d()._o])}const m=(0,de.jsx)(f()._H,{id:"userConnectionsSettings.connectionsTable.accessColumn.legacyImporter",defaultMessage:"Can only add pages"});return[...g&&(o||u)?[{id:"drive",appName:"Google Drive",caption:t.formatMessage({id:"connectedAppsSettings.googleDrive.caption",defaultMessage:"Find and embed your files."}),shouldHideConnectAccount:!o,shouldHideInDiscover:!g,logo:a().Z.images.import.googleDrivePng,account:null==c?void 0:c.drive,capabilities:(0,de.jsx)(f()._H,{id:"userConnectionsSettings.connectionsTable.accessColumn.googleDrive",defaultMessage:"Can embed content"}),canSelectPageAccess:!1,onConnect:()=>async function(e,t){x().SO(e,{integration_name:"google",from:"connected_apps"}),await A().qN(e),await P().LN(e),await t.refresh()}(e,n),onDisconnect:i=>{i&&function(e,t,n,i){b().vC({message:n.formatMessage({id:"connectedAppsSettings.disconnectGoogleDriveModal.message",defaultMessage:"Disconnecting disables file preview on Google Drive files embedded in all of your workspaces. It would not delete your embeds from Notion, so you can re-connect at anytime."}),showCancel:!0,keepFocus:!0,items:[{label:n.formatMessage({id:"connectedAppsSettings.disconnectGoogleDriveModal.disconnectButton.label",defaultMessage:"Disconnect"}),color:"red",onAccept:async()=>{await y().callApi({eventName:"disconnectDrive",environment:t,data:{googleUserId:e.accountId}}),await P().LN(t),await i.refresh()}}]})}(i,e,t,n)}}]:[],{id:"evernote",appName:"Evernote",caption:t.formatMessage({id:"connectedAppsSettings.evernote.caption",defaultMessage:"Import notebooks."}),logo:a().Z.images.import.evernotePng,account:null==c?void 0:c.evernote,capabilities:m,shouldHideInDiscover:!0,canSelectPageAccess:!1,integrationTypes:["importer"],onConnect:()=>N().e({environment:e,requestStore:s}),onDisconnect:()=>P().Lm(e,s)},{id:"trello",appName:"Trello",caption:t.formatMessage({id:"connectedAppsSettings.trello.caption",defaultMessage:"Import your boards."}),logo:a().Z.images.import.trelloPng,shouldHideInDiscover:!0,account:null==c?void 0:c.trello,capabilities:m,integrationTypes:["importer"],canSelectPageAccess:!1,onConnect:()=>H().M({environment:e,requestStore:s}),onDisconnect:()=>P().C(e,s)},{id:"asana",appName:"Asana",caption:t.formatMessage({id:"connectedAppsSettings.asana.caption",defaultMessage:"Import tasks from boards and lists."}),logo:a().Z.images.import.asanaPng,shouldHideInDiscover:!0,integrationTypes:["importer"],account:null==c?void 0:c.asana,capabilities:m,canSelectPageAccess:!1,onConnect:()=>async function(e){const{environment:t,requestStore:n}=e,i=(0,k().eC)(t);let s=(0,S().s1)(I().default.domainBaseUrl,{authType:i,userId:t.currentUser.id});s=i.redirectToAuth?s:await(0,k().HU)(t,s);const o=await w().M(t,{width:580,height:800,url:s,titleMessage:_.titleMessage});if(!o)return;const a=j().Qc(o);if(!a.query.code||!a.query.state)return;M().j({message:_.authenticatingWithAsana});const r=await y().callApi({eventName:"authWithAsana",environment:t,data:{code:a.query.code,encryptedState:a.query.state}});"failed"===r.type?(console.error(r.error),b().x2(r),M().x()):(x().L3(t,{integration_name:"asana"}),await n.refresh(),C.setState({open:!0}),M().x())}({environment:e,requestStore:s}),onDisconnect:()=>P().Ow(e,s)},...null!=r&&r.id?[{id:"confluence",appName:"Confluence",caption:t.formatMessage({id:"connectedAppsSettings.confluence.caption",defaultMessage:"Import Spaces from Confluence."}),logo:a().Z.images.import.confluencePng,shouldHideInDiscover:!0,account:null==c?void 0:c.confluence,capabilities:m,integrationTypes:["importer"],canSelectPageAccess:!1,onDisconnect:()=>P().DP(e,s,r.id)}]:[]]}function we(e){let{guestBotIds:t,location:n,requestStore:i}=e;const a=(0,s().O7)(),r=(0,f().YB)(),{connected:l,discover:d}=(0,o().VK)((()=>function(e,t,n,i){const s=h().vM([...ke(t),...Me(t,n,i)],(e=>e.account&&e.account.length>0?"connected":"discover"));return{connected:[...Ie(e,t),...s.connected||[]],discover:s.discover||[]}}(t,a,r,i)),[t,a,r,i]),u=(0,o().qz)(void 0,O().Z);(0,c().r5)((async()=>{u.update((e=>({...e,loading:!0,ready:!1,result:void 0})));const e=l.filter((e=>e.canSelectPageAccess)).map((e=>e.id)),t=await Z().Dw({environment:a,currentSpaceStore:U().default.getState().currentSpaceStore,botIds:e});u.update((e=>({...e,loading:!1,ready:!0,result:null==t?void 0:t.bots})))}),[a,l,u]);const g=l.length>0;return(0,de.jsx)("div",{style:be(n),children:(0,de.jsxs)(z().T,{style:ve,type:K().Z.Y,children:[g&&(0,de.jsxs)(de.Fragment,{children:[(0,de.jsx)(Q().Z,{large:!0,divider:"full",style:{borderBottom:"none",marginBottom:0},children:(0,de.jsx)(f()._H,{id:"connectionsSettings.connectionsSection.title",defaultMessage:"My connections"})}),(0,de.jsx)(pe,{userConnections:l,botSharedPagesStore:u})]}),(0,de.jsx)("div",{style:{marginTop:g?32:void 0},children:(0,de.jsx)(R().Z,{apps:d,numberOfConnectedApps:l.length,title:(0,de.jsx)("div",{style:{display:"flex",justifyContent:"space-between",minHeight:28,fontSize:16,fontWeight:510},children:(0,de.jsx)(f()._H,{id:"connectionsSettings.discoverNewConnectionsSection.title",defaultMessage:"Discover new connections"})})})}),(0,de.jsx)("div",{style:{marginTop:20},children:(0,de.jsx)(E().Z,{})})]})})}},853946:(e,t,n)=>{n.d(t,{Z:()=>s});class i extends(()=>n(263184))().default{getInitialState(){return{open:!1}}}const s=new i},345864:(e,t,n)=>{n.d(t,{X:()=>s});n(667294);var i=n(785893);const s=(0,n(827282).IU)("integrationSecurity",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M7.996 16c.152 0 .37-.056.59-.16C13.407 13.481 15 12.242 15 9.38V3.421c0-.927-.38-1.263-1.205-1.59-.919-.36-4.03-1.408-4.931-1.696A3.17 3.17 0 0 0 7.996 0c-.278 0-.59.064-.86.136-.91.272-4.012 1.335-4.93 1.695C1.378 2.151 1 2.495 1 3.422V9.38c0 2.863 1.66 3.99 6.414 6.461.22.112.439.16.582.16Zm-.936-4.398c-.32 0-.573-.128-.817-.424L4.178 8.796a.86.86 0 0 1-.228-.568c0-.408.346-.744.775-.744.262 0 .464.096.683.352l1.627 1.96 3.481-5.294c.185-.272.421-.416.683-.416.421 0 .809.28.809.696 0 .184-.101.383-.22.56l-3.952 5.836a.915.915 0 0 1-.776.424Z"})})},261070:(e,t,n)=>{n.d(t,{f:()=>s});n(667294);var i=n(785893);const s=(0,n(827282).IU)("key",{viewBox:"0 0 30 30",svg:(0,i.jsx)("path",{d:"M14.757 4A5.724 5.724 0 009 9.748c0 2.364 1.389 4.456 3.586 5.335V23.6c0 .255.079.483.272.676l1.53 1.477a.578.578 0 00.808-.009l2.769-2.768a.598.598 0 000-.87l-1.591-1.574 2.232-2.232a.602.602 0 00-.017-.861l-2.171-2.18c2.628-1.116 4.087-3.13 4.087-5.511A5.733 5.733 0 0014.757 4zm0 5.344a1.55 1.55 0 01-1.547-1.547c0-.861.685-1.547 1.547-1.547a1.55 1.55 0 011.547 1.547 1.55 1.55 0 01-1.547 1.547z"})})}}]);