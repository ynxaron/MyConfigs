(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[76540,31078,66463],{983317:(e,t,o)=>{"use strict";o.r(t),o.d(t,{toggleTwoWaySyncOnCollection:()=>y,updateSyncedData:()=>S});o(821057),o(267602),o(470928),o(398858),o(461318),o(33228);var n=()=>o(434255),i=()=>o(396136),r=()=>o(602299),l=()=>o(955620),a=()=>o(612427),s=()=>o(388573),c=()=>o(527278),d=()=>o(338855),u=()=>o(826955),p=()=>o(824462),g=()=>o(421654),m=()=>o(102182),f=()=>o(269299);function y(e){var t;const{environment:o,taskCollectionStore:i,projectCollectionStore:r}=e,l=!(null===(t=i.getFormat().sync_state)||void 0===t?void 0:t.enable_two_way_sync);l&&function(e){const{environment:t,taskCollectionStore:o}=e,i=o.getSchema(),r={};for(const l of n().Dw){const e=i[l];e&&"read_write"!==e.synced_permissions&&("notion://tasks/assign_property"===l&&"person"===e.type?r[l]={...e,synced_permissions:"read_write",limit:1}:r[l]={...e,synced_permissions:"read_write"})}Object.keys(r).length>0&&f().createAndCommit({userAction:"updateSyncedCollectionActions.addSyncedPermissionsToSchema",environment:t,canUndo:!0,perform:e=>{(0,a().x)({environment:t,collectionStore:o,update:r,transaction:e})}})}({environment:o,taskCollectionStore:i});const s=i.getFormat().sync_state||{syncing:!1};f().createAndCommit({userAction:"updateSyncedCollectionActions.toggleTwoWaySyncOnCollection",environment:o,canUndo:!0,perform:e=>{g().FH({stores:[i,r],update:{sync_state:{...s,enable_two_way_sync:l}},transaction:e})}})}async function S(e){const{transaction:t,environment:o}=e;try{const e=t.operations.find((e=>function(e){switch(e.command){case"set":case"addPersonAfter":case"removePerson":return!0;default:return!1}}(e)&&2===e.path.length&&"properties"===e.path[0]&&n().Dw.includes(e.path[1].toString())));if(e){const n=(0,d().SK)({transaction:t,updateOperation:e,environment:o});if(!n)return;return void(await async function(e){const{transaction:t,environment:o,updateOperation:n,syncedCollectionStore:i}=e,r=(0,d().c_)({updateOperation:n,transaction:t,collectionStore:i});if("UPDATE_PROPERTY"===r.syncCollectionUpdates[0].updateType){const e=d().b8({pageId:r.syncCollectionUpdates[0].collectionPagePointer.id,propertyId:r.syncCollectionUpdates[0].propertyId});d().lQ({uniquePropertyId:e});const t=await p().callApi({eventName:"updateSyncedCollectionData",environment:o,data:r});if(d().d4(e),"success"===t.type){if(t.data.success)return;var l;throw h({errorCode:t.data.errorCode,syncCollectionType:i.getFormat().external_collection_type,propertyName:1===r.syncCollectionUpdates.length?null===(l=i.getSchema()[r.syncCollectionUpdates[0].propertyId])||void 0===l?void 0:l.name:void 0}),new Error(t.data.message)}var a;throw h({syncCollectionType:i.getFormat().external_collection_type}),new Error((null===(a=t.error)||void 0===a||null===(a=a.name)||void 0===a?void 0:a.toString())??"Unknown error")}}({transaction:t,environment:o,updateOperation:e,syncedCollectionStore:n}))}const c=t.operations.find((e=>"set"===e.command&&1===e.path.length&&"text"===e.path[0]));if(c&&c.pointer.table===r().x_){const e=(0,d().q2)({transaction:t,commentPointer:c.pointer,environment:o});if(!e)return;const{collectionStore:n,collectionPagePointer:i}=e;return void(await async function(e){const{transaction:t,environment:o,updateOperation:n,syncedCollectionStore:i,collectionPagePointer:r}=e,l=(0,d().hN)({updateOperation:n,transaction:t,collectionStore:i,collectionPagePointer:r});d().Jb({commentId:n.pointer.id});const a=await p().callApi({eventName:"updateSyncedCollectionData",environment:o,data:l});if(d().dY(n.pointer.id),"success"===(null==a?void 0:a.type)){if(a.data.success)return;throw h({errorCode:a.data.errorCode,syncCollectionType:i.getFormat().external_collection_type}),new Error(a.data.message)}var s;throw h({syncCollectionType:i.getFormat().external_collection_type}),new Error((null===(s=a.error)||void 0===s||null===(s=s.name)||void 0===s?void 0:s.toString())??"Unknown error")}({transaction:t,environment:o,updateOperation:c,syncedCollectionStore:n,collectionPagePointer:i}))}const g=t.operations.find((e=>{var t;return"update"===e.command&&1===e.path.length&&"properties"===e.path[0]&&(null===(t=e.args)||void 0===t?void 0:t.source)}));if(g){const e=(0,d().Dv)({transaction:t,updateOperation:g,environment:o});if(!e)return;try{await async function(e){var t;const{transaction:o,environment:n,updateOperation:i,syncedCollectionStore:r,collectionPagePointer:a,commentPointer:s}=e,c=l().QaF(null===(t=i.args)||void 0===t?void 0:t.source);if(!c)return;const d=c.split("/").pop(),u=(g=c,new URL(g).pathname.slice(1));var g;if(!d)return;const m={spaceId:o.spaceId,syncType:r.getFormat().external_collection_type,syncCollectionUpdates:[{collectionPagePointer:a,notionCommentId:s.id,attachment:{fileName:d,s3Data:{path:u}},updateType:"APPEND_ATTACHMENT"}]},f=await p().callApi({eventName:"updateSyncedCollectionData",environment:n,data:m});if("success"===(null==f?void 0:f.type)){if(f.data.success)return;throw h({errorCode:f.data.errorCode,syncCollectionType:r.getFormat().external_collection_type}),new Error(f.data.message)}var y;throw h({syncCollectionType:r.getFormat().external_collection_type}),new Error((null===(y=f.error)||void 0===y||null===(y=y.name)||void 0===y?void 0:y.toString())??"Unknown error")}({transaction:t,environment:o,updateOperation:g,syncedCollectionStore:e.collectionStore,collectionPagePointer:e.collectionPagePointer,commentPointer:e.commentPointer})}catch(a){const n=new(u().T5)(o,e.commentPointer),r=new(u().G)(o,{id:g.pointer.id,table:i().iU,spaceId:t.spaceId});throw n&&r&&f().createAndCommit({userAction:"Comment.handleRemoveFileFromActionsDueToSyncFailure",environment:o,canUndo:!0,perform:e=>{s().Zo({commentStore:n,fileBlocks:[r],transaction:e})}}),a}return}}catch(a){throw h({}),a}}function h(e){const{errorCode:t,syncCollectionType:o,propertyName:n}=e,i=c().Z.getIntl();if(!o)return void m().mz({item:{label:i.formatMessage({id:"syncedCollectionUpdateError.syncCollectionTypeMissing",defaultMessage:"Failed to update: incorrect sync collection setup"})}});if(!t)return void m().mz({item:{label:`Failed to update ${n??o}`}});const r=d().Xp({syncCollectionType:o,errorCode:t,intl:i});m().mz({item:{label:r}})}},10829:(e,t,o)=>{"use strict";o.d(t,{B4:()=>m,OO:()=>d,ad:()=>f,dr:()=>g,my:()=>p,rc:()=>u});var n=()=>o(331540),i=()=>o(145006),r=()=>o(714230),l=()=>o(874459),a=()=>o(998411),s=()=>o(527278);const c=(0,o(788860).vU)({aiSummaryName:{id:"feature.ai_summary.name",defaultMessage:"AI summary"},aiSummaryDescription:{id:"feature.ai_summary.description",defaultMessage:"Summarize pages with AI"},aiAutofillName:{id:"feature.ai_autofill.name",defaultMessage:"Custom AI autofill"},aiAutofillDescription:{id:"feature.ai_autofill.description",defaultMessage:"Autofill properties with AI"},aiTranslationName:{id:"feature.ai_translation.name",defaultMessage:"AI translation"},aiTranslationDescription:{id:"feature.ai_translation.description",defaultMessage:"Translate pages with AI"},aiKeywordsName:{id:"feature.ai_keywords.name",defaultMessage:"AI keywords"},aiKeywordsDescription:{id:"feature.ai_keywords.description",defaultMessage:"Extract keywords with AI"}}),d=[{uri:i().S7.priorityHmlFeature,name:"Priority",dependencies:[{uri:i().ti.priorityHmlProperty,type:"property",collectionUri:n().br,name:"Priority",description:"High, medium, or low",icon:r().Z.images.appPackages.featurePrioritySvg,propertySchema:{type:"select",name:"Priority",options:[{id:"priority_low",value:"Low",color:"green"},{id:"priority_medium",value:"Medium",color:"yellow"},{id:"priority_high",value:"High",color:"red"}]}}],collectionUri:n().br},{uri:i().S7.progressBarFeature,collectionUri:n().br,name:"Progress Bar",description:"Visual representation of progress",icon:r().Z.images.appPackages.featureStatusSvg,dependencies:[{uri:i().ti.progressBarCurrentProperty,type:"property",collectionUri:n().br,name:"Progress Bar Current",propertySchema:{type:"number",name:"Current"}},{uri:i().ti.progressBarTargetProperty,type:"property",collectionUri:n().br,name:"Progress Bar Target",propertySchema:{type:"number",name:"Target"}},{uri:i().ti.progressBarFormulaProperty,type:"property",collectionUri:n().br,name:"Progress Bar Progress Formula",propertySchema:{type:"formula",name:"Progress bar",formula2:{code:[["‣",[["fpp",{property:i().ti.progressBarCurrentProperty,collection:{id:n().br,table:"collection"}}]]],["/"],["‣",[["fpp",{property:i().ti.progressBarTargetProperty,collection:{id:n().br,table:"collection"}}]]]],result_type:{type:"number"}},show_as:{type:"bar",color:"green",maxValue:1,showValue:!1},version:"v2"}}]},{uri:i().S7.ganttChartFeature,collectionUri:n().br,name:"Gantt Chat",description:"Chart to show progress of a project's tasks over time.",icon:r().Z.images.appPackages.featureGanttSvg,dependencies:[{uri:i().ti.ganttInitiativeProperty,type:"property",collectionUri:n().br,name:"Initiative",description:"Initiatives associated with a specific project",icon:r().Z.images.appPackages.featurePrioritySvg,propertySchema:{type:"select",name:"Initiative",options:[{id:"initiative_a",value:"Initiative A",color:"purple"},{id:"initiative_b",value:"Initiative B",color:"green"},{id:"initiative_c",value:"Initiative C",color:"blue"}]}},{uri:i().ti.ganttDueDateProperty,type:"property",collectionUri:n().br,name:"Due Date",description:"When a project is due.",icon:r().Z.images.appPackages.featurePrioritySvg,propertySchema:{type:"date",name:"Due Date"}},{uri:i().ti.ganttTimelineView,type:"collection_view",collectionUri:n().br,description:"GANTT chart timeline view of projects",value:{type:"timeline",name:"Timeline",format:{collection_view_icon:"/icons/timeline_gray.svg",timeline_show_table:!0,timeline_table_properties:[{width:171,visible:!0,property:"title"},{width:200,visible:!0,property:i().ti.ganttInitiativeProperty}],timeline_preference:{zoomLevel:"month",centerTimestamp:(0,l().uO)((0,l().Lg)((0,a().r)()),(0,a().r)())},collection_group_by:{sort:{type:"manual"},type:"multi_select",property:i().ti.ganttInitiativeProperty,hideEmptyGroups:!0}},query2:{timeline_by:i().ti.ganttDueDateProperty}},collectionViewBlockUri:n().Sc}]}],u=[p(),g(),m(),f()];function p(){return{uri:i().S7.aiSummaryFeature,collectionUri:n().br,name:s().Z.formatMessage(c.aiSummaryName),description:s().Z.formatMessage(c.aiSummaryDescription),icon:r().Z.images.appPackages.featureAiSummarizeSvg,tooltipImage:{img:r().Z.images.tooltips.properties.aiAutofillSummaryPng,scale:.5},isAi:!0,dependencies:[{uri:i().ti.aiSummaryProperty,type:"property",collectionUri:n().br,name:s().Z.formatMessage(c.aiSummaryName),propertySchema:{type:"text",name:s().Z.formatMessage(c.aiSummaryName),ai_inference:{type:"summarize",auto_update_on_edit:!0}}}]}}function g(){return{uri:i().S7.aiCustomAutofillFeature,collectionUri:n().br,name:s().Z.formatMessage(c.aiAutofillName),description:s().Z.formatMessage(c.aiAutofillDescription),icon:"",tooltipImage:{img:r().Z.images.tooltips.properties.aiCustomAutofillPng,scale:.5},isAi:!0,dependencies:[{uri:i().ti.aiCustomAutofillProperty,type:"property",collectionUri:n().br,name:s().Z.formatMessage(c.aiAutofillName),propertySchema:{name:s().Z.formatMessage(c.aiAutofillName),type:"text",ai_inference:{type:"custom",prompt:"",auto_update_on_edit:!0}}}]}}function m(){return{uri:i().S7.aiTranslationFeature,collectionUri:n().br,name:s().Z.formatMessage(c.aiTranslationName),description:s().Z.formatMessage(c.aiTranslationDescription),icon:"",tooltipImage:{img:r().Z.images.tooltips.properties.aiTranslationPng,scale:.5},isAi:!0,dependencies:[{uri:i().ti.aiTranslationProperty,type:"property",collectionUri:n().br,name:s().Z.formatMessage(c.aiTranslationName),propertySchema:{name:s().Z.formatMessage(c.aiTranslationName),type:"text",ai_inference:{type:"custom",prompt:"",auto_update_on_edit:!0}}}]}}function f(){return{uri:i().S7.aiKeywordsFeature,collectionUri:n().br,name:s().Z.formatMessage(c.aiKeywordsName),description:s().Z.formatMessage(c.aiKeywordsDescription),icon:"",tooltipImage:{img:r().Z.images.tooltips.properties.aiKeywordsPng,scale:.5},isAi:!0,dependencies:[{uri:i().ti.aiKeywordsProperty,type:"property",collectionUri:n().br,name:s().Z.formatMessage(c.aiKeywordsName),propertySchema:{type:"multi_select",name:s().Z.formatMessage(c.aiKeywordsName),select_ai_inference:{type:"multi_select",add_options:!0,auto_update_on_edit:!1}}}]}}},843307:(e,t,o)=>{"use strict";o.d(t,{S:()=>a,Z:()=>s});o(667294);var n=()=>o(513670),i=()=>o(677559),r=o(785893);const l=new(i().Ss)("builder-modals",(()=>Promise.all([o.e(62743),o.e(52774),o.e(44832),o.e(84885),o.e(94556),o.e(78701),o.e(38804),o.e(71896),o.e(53335),o.e(46546),o.e(91253),o.e(61171),o.e(63502),o.e(81917),o.e(71641),o.e(10553),o.e(67601),o.e(40692),o.e(58548),o.e(20683),o.e(73230),o.e(28682),o.e(28686),o.e(11582),o.e(93342),o.e(31655)]).then(o.bind(o,233355)))),a=(0,i().kF)(l,(e=>e.AutomationBuilderModal),{renderLoading:()=>(0,r.jsx)(c,{})}),s=(0,i().kF)(l,(e=>e.ButtonBuilderModal),{renderLoading:()=>(0,r.jsx)(c,{})});function c(){return(0,r.jsx)(o(294105).b,{handleOnDismiss:n().ZT,canSave:!1,handleOnSave:n().ZT,mode:"loading",children:(0,r.jsx)("div",{style:{display:"flex",justifyContent:"center",overflow:"hidden"},children:(0,r.jsx)(o(312578).Z,{})})})}},516463:(e,t,o)=>{"use strict";o.d(t,{Z:()=>r});o(667294);var n=()=>o(312578),i=o(785893);function r(){return(0,i.jsx)("div",{style:{alignItems:"center",display:"flex",justifyContent:"center",minHeight:200,overflow:"hidden"},children:(0,i.jsx)(n().Z,{})})}},801670:(e,t,o)=>{"use strict";o.r(t),o.d(t,{formEditorActions:()=>n()});var n=()=>o(509572)},114672:(e,t,o)=>{"use strict";o.d(t,{O:()=>I});o(241792);var n=o(667294),i=()=>o(846550),r=()=>o(26970),l=()=>o(513670),a=()=>o(696459),s=()=>o(701182),c=()=>o(473604);o(821057);class d{constructor(){this.stiffness=50,this.damping=10,this.precision=.001,this.currentValue=0,this.endValue=0,this.velocity=0}isAtRest(){return Math.abs(this.endValue-this.currentValue)<=this.precision}setEndValue(e){this.endValue=e;const t=this.isAtRest();return t&&this.setAtRest(),t}jumpToEnd(){this.currentValue=this.endValue}step(e){let t=e;do{let e;t>d.timestep?(t-=d.timestep,e=d.timestep):(e=t,t=0);const[o,n]=this.rk4(this.currentValue,this.velocity,e);this.velocity=n,this.currentValue=o}while(t>0);const o=this.isAtRest();return o&&this.setAtRest(),o}setAtRest(){this.currentValue=this.endValue,this.velocity=0}rk4(e,t,o){const n=e,i=t,r=this.computeAccel(n,i,0),l=e+.5*i*o,a=t+.5*r*o,s=this.computeAccel(l,a,o/2),c=e+.5*a*o,d=t+.5*s*o,u=this.computeAccel(c,d,o/2),p=e+d*o,g=t+u*o;return[e+o/6*(i+2*a+2*d+g),t+o/6*(r+2*s+2*u+this.computeAccel(p,g,o))]}computeAccel(e,t,o){return this.stiffness*d.stiffnessMultiplier*(this.endValue-e)-this.damping*d.dampingMultiplier*t}}d.stiffnessMultiplier=1e-5,d.dampingMultiplier=.005,d.timestep=1e3/60;const u=d;function*p(e,t){const o=new u;for(o.currentValue=e,o.endValue=t,o.stiffness=35;;){const e=yield o.currentValue;if(o.step(e)){yield o.currentValue;break}}}function*g(e,t,o){let n=0;for(;n<o;){n+=(yield e+n/o*(t-e))}}function*m(e){for(const[t,o]of l().$R(e,e.slice(1)))(0,a().$K)(t)&&(0,a().$K)(o)&&(yield*p(t,o))}function*f(e,t){let o=0;for(;!(0,a().$K)(t)||o<t;){o+=(yield e)}}function*y(e){let t=0;for(;;){const o={};for(const n of(0,a().Yd)(e)){const i=e[n].next(t);if(i.done)return;o[n]=i.value}t=yield o}}var S=()=>o(704713),h=o(785893);const x="inactive-task-filter",v="active-task-filter",C="mouse-cursor-filter",b=80,w=24,j=8,_=10,M=264,k=110,P=b/2;function*T(e){yield*y({x:e,opacity:f(1)})}function I(e){const{mode:t}=e,o=(0,i().yK)((e=>({wrap:{margin:"0px 10px",border:`1px solid ${e.regularDividerColor}`,borderRadius:6,alignItems:"center",position:"relative",height:k+2}})),[1]),r=(0,n.useRef)(null),l=(0,S().X)(r),a=l?l.width-2:M;return(0,h.jsx)("div",{style:o.wrap,ref:r,children:(0,h.jsx)(V,{mode:t,sceneWidth:a})})}function V(e){const{mode:t,sceneWidth:o}=e,d=(0,i().yK)((e=>({svgArrowTheme:{stroke:e.collectionValidDependencyArrow,strokeWidth:s().lf},invalidArrow:{stroke:e.collectionInvalidDependencyArrow},svgContainer:{position:"absolute",width:"100%",height:"100%",backgroundColor:e.accentColors.gray[30]}})),[]),u=(0,n.useMemo)((()=>({none:function*(){for(;;)yield*T(m([o/2,o/2+b/2+b/4,o/2-b/2-b/4,o/2]))},preserve_gap:function*(){for(;;)yield*T(m([o/2,o/2+b/2,o/2-b/2,o/2]))},consume_gap:function*(){for(;;){yield*T(m([o/2,o/2-b/2,o/2+b/2,o/2+b]));const e=500;yield*y({x:f(o/2+b),opacity:g(1,0,e)}),yield*y({x:f(o/2),opacity:g(0,1,e)})}}})),[o]),{x:p,opacity:S}=function(e){const t=(0,n.useMemo)((()=>e()),[e]),[o,i]=(0,n.useState)((()=>{const e=t.next(0);if(e.done)throw new Error("Generator must provide at least one result");return e.value}));return(0,n.useEffect)((()=>{const e=t.next(0);e.done||i(e.value);let o=Date.now(),n=0;return n=requestAnimationFrame((function e(){n=requestAnimationFrame(e);const r=Date.now(),l=r-o;o=r;const a=t.next(l);a.done||i(a.value)})),()=>cancelAnimationFrame(n)}),[t]),o}(u[t??"none"]),x={x:o/2-2*b,y:_},v={x:p-b/2,y:_+w+j},C={x:o/2+b,y:_+2*(w+j)},M={x:v.x+b/2,y:v.y+w/2};return(0,a().$K)(t)&&("consume_gap"===t?(x.x=Math.min(x.x,v.x-b),C.x=Math.max(C.x,v.x+b)):"preserve_gap"===t?(x.x=x.x+p-o/2,C.x=C.x+p-o/2):(0,a().t1)(t)),(0,h.jsxs)("svg",{style:d.svgContainer,children:[l().w6(o/2-2*b,o,P).map(((e,t)=>(0,h.jsx)(Z,{startPoint:{x:e,y:0},endPoint:{x:e,y:k}},t))),(0,h.jsx)(c().Z,{startPoint:{x:v.x+b,y:v.y+w/2},endPoint:{x:C.x-2,y:C.y+w/2},...(0,r().iv)(d.svgArrowTheme,v.x+b>C.x?d.invalidArrow:void 0,{opacity:S}),showArrowHead:!0}),(0,h.jsx)(c().Z,{startPoint:{x:x.x+b,y:x.y+w/2},endPoint:{x:v.x-2,y:v.y+w/2},...(0,r().iv)(d.svgArrowTheme,v.x<x.x+b?d.invalidArrow:void 0,{opacity:S}),showArrowHead:!0}),(0,h.jsx)(A,{point:x,opacity:S}),(0,h.jsx)(A,{point:v,active:!0,opacity:S}),(0,h.jsx)(A,{point:C,opacity:S}),(0,h.jsx)(B,{point:M,opacity:S}),(0,h.jsx)(F,{})]})}function A(e){const{point:t,active:o,opacity:n}=e,r=(0,i().Fg)(),l=o?"dark"===r.mode?"#28456C":"#E7F3F8":r.buttonBackground;return(0,h.jsx)("g",{transform:`translate(${t.x-4},${t.y-2})`,opacity:n,children:(0,h.jsx)("rect",{filter:`url(#${o?v:x})`,width:b,height:w,x:"4",y:"2",fill:l,rx:"3"})})}function Z(e){const{startPoint:t,endPoint:o}=e,n=(0,i().Fg)(),r="dark"===n.mode?n.accentColors.gray[300]:"#E3E2E0";return(0,h.jsx)("line",{x1:t.x,y1:t.y,x2:o.x,y2:o.y,stroke:r,strokeDasharray:"3 4"})}function B(e){const{point:t,opacity:o}=e;return(0,h.jsxs)("g",{filter:`url(#${C})`,transform:`translate(${t.x},${t.y})`,opacity:o,children:[(0,h.jsx)("path",{fill:"#32302C",d:"M14 12.25h-3.334l2.193 5.294-2.309.956-2.194-5.294L6 15.563l-.75-.75V3.94l1.06-.44L14 11.19v1.06z"}),(0,h.jsx)("path",{stroke:"#fff",fill:"#32302C",strokeWidth:"0.5",d:"M14 12.5h.25v-1.413l-.073-.073-7.69-7.69-.12-.12-.154.065-1.059.44L5 3.775v11.142l.073.073.75.75.177.177.177-.177 2.092-2.091 2.05 4.948.096.23.23-.095 2.31-.956.231-.096-.096-.231-2.05-4.948H14z"})]})}function F(){return(0,h.jsxs)("defs",{children:[(0,h.jsxs)("filter",{id:x,width:b+8,height:w+8,x:"0",y:"0",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,h.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,h.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,h.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_637_7659"}),(0,h.jsx)("feOffset",{}),(0,h.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,h.jsx)("feColorMatrix",{values:"0 0 0 0 0.0707 0 0 0 0 0.0693 0 0 0 0 0.0693 0 0 0 0.1 0"}),(0,h.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_637_7659"}),(0,h.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,h.jsx)("feOffset",{dy:"2"}),(0,h.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,h.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,h.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,h.jsx)("feBlend",{in2:"effect1_dropShadow_637_7659",result:"effect2_dropShadow_637_7659"}),(0,h.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_637_7659",result:"shape"})]}),(0,h.jsxs)("filter",{id:v,width:b+8,height:w+8,x:"0",y:"0",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,h.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,h.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,h.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_637_5084"}),(0,h.jsx)("feOffset",{}),(0,h.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,h.jsx)("feColorMatrix",{values:"0 0 0 0 0.2 0 0 0 0 0.494118 0 0 0 0 0.662745 0 0 0 0.2 0"}),(0,h.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_637_5084"}),(0,h.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,h.jsx)("feOffset",{dy:"2"}),(0,h.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,h.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,h.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,h.jsx)("feBlend",{in2:"effect1_dropShadow_637_5084",result:"effect2_dropShadow_637_5084"}),(0,h.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_637_5084",result:"shape"})]}),(0,h.jsxs)("filter",{id:C,width:"17.75",height:"24.244",x:"0.75",y:"0.91",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,h.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,h.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,h.jsx)("feOffset",{dy:"2"}),(0,h.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,h.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,h.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.2 0"}),(0,h.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_637_4925"}),(0,h.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_637_4925",result:"shape"})]})]})}},678121:(e,t,o)=>{"use strict";o.d(t,{$z:()=>Z,Fz:()=>R,PC:()=>K,Tg:()=>E,Yi:()=>A,kJ:()=>F,pK:()=>D,zk:()=>V});o(267602),o(653476),o(470928),o(241792);var n=o(667294),i=()=>o(219727),r=()=>o(142735),l=()=>o(846550),a=()=>o(226413),s=()=>o(677539),c=()=>o(168741),d=()=>o(95886),u=()=>o(788860),p=()=>o(543172),g=()=>o(696459),m=()=>o(707513),f=()=>o(250303),y=()=>o(984871),S=()=>o(139224),h=()=>o(308186),x=()=>o(636340),v=()=>o(269299),C=()=>o(612427),b=()=>o(154186),w=()=>o(906651),j=()=>o(388284),_=()=>o(667637),M=()=>o(66417),k=()=>o(446955),P=()=>o(114672),T=()=>o(940573),I=o(785893);const V="consume_gap",A=!0;function Z(e){var t;const{currentConfig:o,onConfigChange:a,disabled:s,collectionContextStore:c}=e,d=(0,r().VK)((()=>c.databaseType),[c]),p=(0,i().O7)(),m=null===(t=o.configWithoutDates)||void 0===t?void 0:t.mode,[y,S]=(0,n.useState)((0,g().$K)(o.configWithoutDates)?Boolean(o.configWithoutDates.avoid_weekends):A),h=(0,g().$K)(o.configWithoutDates)?Boolean(o.configWithoutDates.avoid_weekends):y;(0,n.useEffect)((()=>{if((0,g().$K)(o.configWithoutDates)){const e=Boolean(o.configWithoutDates.avoid_weekends);e!==y&&S(e)}}),[o,y]);const x=(0,l().yK)((()=>({dateShiftContainer:{marginLeft:4},previewContainer:{marginLeft:4},previewTitle:{paddingLeft:10}})),[]),v=(0,n.useCallback)((e=>{(0,g().$K)(o.configWithoutDates)&&(a({...o,configWithoutDates:{...o.configWithoutDates,avoid_weekends:e}}),f().wd({environment:p,collectionContextStore:c,action:"update_dependency_date_shift_avoid_weekends",new_avoid_weekends:e}))}),[c,o,p,a]),C=(0,n.useCallback)((e=>{(0,g().$K)(e)?a({...o,configWithoutDates:{...o.configWithoutDates,mode:e,avoid_weekends:y}}):a({...o,configWithoutDates:void 0}),f().wd({environment:p,collectionContextStore:c,action:"update_dependency_date_shift_mode",new_date_shift_mode:e??"none"})}),[c,o,p,y,a]);return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(j().Z,{title:(0,I.jsx)(u()._H,{...M().dH.dateShiftingSectionCaption}),disableMobileBorders:!0,style:x.previewContainer,desktopTitleStyle:x.previewTitle,children:(0,I.jsx)(P().O,{mode:m})}),(0,I.jsx)(j().Z,{disableMobileBorders:!0,style:x.dateShiftContainer,children:(0,I.jsx)(O,{currentMode:m,onModeChange:C,databaseType:d,disabled:s})}),(0,I.jsxs)(j().Z,{children:[(0,I.jsx)(H,{currentValue:h,databaseType:d,onChange:v,disabled:s||!(0,g().$K)(o.configWithoutDates)}),(0,I.jsx)(B,{...e})]})]})}function B(e){const{collectionContextStore:t,currentConfig:o,onConfigChange:i,disabled:l}=e,s=(0,r().VK)((()=>{const e=t.normalizedSchemaStore.state;return Object.keys(e).filter((t=>{const o=e[t];return o&&(0,a().Lt)(o)}))}),[t]),c=s.length,d=o.datePropertyId?s.find((e=>e!==o.datePropertyId)):void 0,p="string"==typeof o.datePropertyId&&(0,g().$K)(o.endDatePropertyId),m=(0,n.useCallback)(((e,t)=>{const n={[e]:t};if(p&&(0,g().$K)(o.datePropertyId)){const i="datePropertyId"===e?"endDatePropertyId":"datePropertyId";o[i]===t&&(n[i]=s.find((e=>e!==t)))}i({...o,...n})}),[o,s,i,p]);return!(0,g().$K)(o.configWithoutDates)||c<=1?null:(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(T().A,{collectionContextStore:t,currentPropertyId:o.datePropertyId,title:p?(0,I.jsx)(u()._H,{...M().dH.startDate}):(0,I.jsx)(u()._H,{...M().dH.datePropertyPickerTitle}),onPropertyChanged:e=>m("datePropertyId",e),disabled:l}),(0,g().$K)(d)&&"string"==typeof o.datePropertyId&&(0,I.jsxs)(I.Fragment,{children:[(0,g().$K)(o.endDatePropertyId)&&(0,I.jsx)(T().A,{collectionContextStore:t,currentPropertyId:o.endDatePropertyId,title:(0,I.jsx)(u()._H,{...M().dH.endDate}),onPropertyChanged:e=>m("endDatePropertyId",e),disabled:l}),(0,I.jsx)(_().Z,{title:(0,I.jsx)(u()._H,{id:"database.viewSettings.relationFeatures.datePropertyPicker.separateStartEnd",defaultMessage:"Separate start and end dates"}),focused:!1,on:p,disabled:l,disabledFeedback:!0,onClick:()=>{i({...o,endDatePropertyId:p?void 0:d})}})]})]})}function F(e){const{collectionSettingsStore:t,feature:o,permissionScopes:n}=e,i=!n.canConfigureCollection&&!n.canConfigureBlock;return(0,I.jsx)(k().Z,{icon:c().H,showChevron:!0,disabled:i,title:(0,I.jsx)(u()._H,{...M().dH.advancedSettings}),onClick:()=>{S().H4({collectionSettingsStore:t,item:{type:"relationFeaturesAdvancedSettings",feature:o}})}})}function R(e){const{feature:t,handleAddRelation:o,databaseType:n,permissionScopes:i}=e,r=(0,l().yK)((e=>({button:{width:"100%"},buttonWrap:{margin:"0px 12px 4px 12px"}})),[]);if(!i.canConfigureBlock||!i.canConfigureCollection)return null;const a=(0,M().Tq)({feature:t,databaseType:n});return(0,I.jsx)(j().Z,{disableMobileBorders:!0,children:(0,I.jsx)("div",{style:r.buttonWrap,children:(0,I.jsx)(w().Z,{style:r.button,onClick:o,isLarge:!0,children:(0,I.jsx)(u()._H,{...a})})})})}function K(e){const{feature:t,permissionScopes:o,propertyName:n,relationPropertyId:r,inversePropertyName:a,collectionContextStore:s,collectionSettingsStore:c,handleDefaultPropertySelect:p,databaseType:g,clearCollectionViewSubitemDisplayMode:x}=e,C=(0,i().O7)(),b=(0,l().yK)((e=>({modalPropertyName:{color:e.darkTextColor,fontWeight:m().Ue.semibold}})),[]);if(!(o.canConfigureCollection&&o.canConfigureBlock&&n&&a))return null;const w=(0,M().nB)({feature:t,databaseType:g}),j=(0,M().OH)({feature:t,databaseType:g}),_={label:(0,I.jsx)(u()._H,{...M().dH.turnOff}),color:"red",onAccept:async e=>{r&&(null!=e&&e.delete&&await async function(e){const{environment:t,collectionContextStore:o,propertyId:n,feature:i}=e,r=o.normalizedSchemaStore.state,l=o.collectionStore();if(!l)return;await v().createAndCommitAsync({environment:t,userAction:"CollectionSettingsViewRelationFeatures.handleTurnOffFeatureAndDeleteAccept",waitForServerCommit:!1,perform:e=>y().yV({environment:t,collectionStore:l,schema:r,property:n,transaction:e})});const a=r[n];a&&f().y9({environment:t,collectionContextStore:o,property_type:a.type,from:i,property:n})}({environment:C,propertyId:r,collectionContextStore:s,feature:t}),p(void 0),null==x||x(),S().wl({collectionSettingsStore:c,item:{type:"main"}}))}};return(0,I.jsx)(k().Z,{icon:d().y,title:(0,I.jsx)(u()._H,{...w}),isRed:!0,onClick:()=>{h().vC({selectionItems:[{key:"delete",text:(0,I.jsx)(u()._H,{...M().dH.removePropertiesTitle}),description:(0,I.jsx)(u()._H,{...M().dH.removePropertiesDescription,values:{span:e=>(0,I.jsx)("span",{style:b.modalPropertyName,children:e}),property:n,inverseProperty:a}}),preSelected:!0},{key:"keep",text:(0,I.jsx)(u()._H,{...M().dH.keepPropertiesTitle})}],selectType:"radio",selectAlignXAxis:"right",message:(0,I.jsx)(u()._H,{...j}),showCancel:!0,keepFocus:!0,items:[_]})}})}function H(e){const{currentValue:t,onChange:o,disabled:n,databaseType:i}=e;return(0,I.jsx)(_().Z,{title:(0,I.jsx)(u()._H,{...M().dH.avoidWeekendsSwitcherTitle}),caption:(0,I.jsx)(u()._H,{...(0,M().Bq)(i)}),shouldWrapCaption:!0,shouldWrapTitle:!0,focused:!1,on:t,disabled:n,disabledFeedback:!0,onClick:()=>o(!t)})}function O(e){const{currentMode:t,onModeChange:o,disabled:n,databaseType:i}=e,r=(0,l().yK)((e=>({wrap:{display:"flex",flexDirection:"column",rowGap:8,marginLeft:12,marginRight:12}})),[]);return(0,I.jsx)("div",{style:r.wrap,children:[...s().Bp,void 0].map((e=>(0,I.jsx)(L,{dateShiftingMode:e,databaseType:i,onClick:()=>o(e),active:e===t,disabled:n},e??"none")))})}function L(e){const{dateShiftingMode:t,onClick:o,active:n,disabled:r,databaseType:a}=e,s=(0,i().Fy)(),c=(0,l().yK)((e=>({buttonStyles:{fontSize:s.isMobile?m().JB.UISmall.mobile:m().JB.UISmall.desktop,fontWeight:m().Ue.medium,borderRadius:6,width:"100%",padding:"8px 8px",boxShadow:`0 0 0 1px ${e.regularDividerColor}`,color:e.darkTextColor,fill:e.mediumTextColor,...n&&{boxShadow:`0 0 0 2px ${e.blueColor}`,color:e.blueColor,fill:e.blueColor},...r&&{opacity:.65}},icon:{width:20,height:20,marginRight:6},buttonContentWrap:{display:"flex",alignItems:"center"}})),[n,s,r]),d=(0,M().W3)({dateShiftingMode:t,databaseType:a}),p=(0,M().l7)(t);return(0,I.jsx)(b().Z,{style:c.buttonStyles,onClick:o,disabled:r,children:(0,I.jsxs)("div",{style:c.buttonContentWrap,children:[(0,I.jsx)("div",{children:p(c.icon)}),(0,I.jsx)("div",{children:(0,I.jsx)(u()._H,{...d})})]})})}function D(e){const{environment:t,newConfig:o,collectionStore:n,transaction:i,intl:r}=e;let l;if((0,g().$K)(o.configWithoutDates))if(o.datePropertyId)l={...o.configWithoutDates,date_property:o.datePropertyId,end_date_property:o.endDatePropertyId};else{const e=(0,p().ZP)(),a={name:r.formatMessage(M().dH.newDateProperty),type:"date"};(0,C().x)({environment:t,collectionStore:n,update:{[e]:a},transaction:i}),l={...o.configWithoutDates,date_property:e,end_date_property:void 0}}x().sW({store:n.getFormatStore(),data:{dependency_date_shifting_config:l??null},transaction:i})}function E(e){const{viewType:t,feature:o}=e;return"timeline_arrows_by"===o?"timeline"===t:"subitem"===o||void(0,g().t1)(o)}},810374:(e,t,o)=>{"use strict";o.d(t,{Ld:()=>S,Xy:()=>x,he:()=>h,t6:()=>v});var n=o(667294),i=()=>o(219727),r=()=>o(142735),l=()=>o(788860),a=()=>o(696459),s=()=>o(250303),c=()=>o(984871),d=()=>o(917881),u=()=>o(236087),p=()=>o(421654),g=()=>o(269299),m=()=>o(493843),f=()=>o(129338),y=()=>o(678121);function S(e){const{collectionContextStore:t,feature:o}=e,n=(0,l().YB)();return{initialPropertyName:(0,r().VK)((()=>{const e=t.collectionStore();if(null!=e&&e.isDefined()){const i=t.normalizedSchemaStore.state;return f().m8(n,{targetCollectionStore:e,isSelfRelation:!0,sourceSchema:i,createUnique:!0,from:o})}return n.formatMessage({id:"database.viewSettings.relationsPropertyTab.initialPropertyName.placeholder",defaultMessage:"Related to target"})}),[t,n,o])}}function h(e){const{feature:t,collectionContextStore:o,onPropertySelect:h}=e,x=(0,i().O7)(),v=(0,l().YB)(),{initialPropertyName:C}=S({collectionContextStore:o,feature:t}),b=(0,n.useCallback)((e=>{const{collectionViewStore:o,newProperty:n,transaction:i}=e;"timeline_arrows_by"===t&&m().tF({collectionViewStore:o,newProperty:n,transaction:i})}),[t]),w=(0,r().Kw)(o.normalizedSchemaStore),j=(0,n.useCallback)((()=>f().ND(o,w)),[o,w]),_=(0,n.useCallback)((e=>{const{relationPropertyId:n,transaction:i}=e;"subitem"===t?u().km({environment:x,collectionContextStore:o,relationPropertyId:n,transaction:i}):"timeline_arrows_by"===t?m()._p({collectionContextStore:o,relationPropertyId:n,transaction:i}):(0,a().t1)(t)}),[o,x,t]),M=(0,n.useCallback)((e=>{const{featureType:t,from:n}=e,i=o.collectionStore(),r=i,l=o.collectionViewStore();if(!i||!r)return;const{performResult:u}=g().createAndCommit({userAction:"CollectionSettingsSetupRelation.handleAddRelation",environment:x,canUndo:!0,perform:n=>{const a=c().G3({environment:x,collectionStore:i,collectionViewArgs:l?{collectionViewStore:l,format:l.getFormat(),formatKey:"collection_page_properties"}:void 0,propertyType:"relation",transaction:n});return d().n7({environment:x,collectionContextStore:o,collectionStore:i,property:a,propertyName:C,targetCollectionStore:r,hasInverseRelation:!0,inverseName:void 0,autoRelate:{enabled:!1},propertyLimit:"no_limit",intl:v,transaction:n,from:t}),l&&(b({collectionViewStore:l,newProperty:a,transaction:n}),_({relationPropertyId:a,transaction:n})),"timeline_arrows_by"===t&&(0,y().pK)({environment:x,intl:v,collectionStore:i,transaction:n,newConfig:e.dateShiftingConfig}),a}});let p;"subitem"===t?p="notion://tasks/sub_task_feature":"timeline_arrows_by"===t?p="notion://tasks/task_dependencies_feature":(0,a().t1)(t),s()._H({environment:x,collectionContextStore:o,from:t,property_type:"relation",feature:{id:u,from:n,type:p}})}),[o,x,C,v,_,b]),k=(0,n.useCallback)((e=>{const n=o.collectionViewStore();if(!n)return;let i;g().createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handleDefaultPropertySelect",environment:x,canUndo:!0,perform:t=>{b({collectionViewStore:n,newProperty:e,transaction:t}),_({relationPropertyId:e,transaction:t})}}),h(e),"subitem"===t?i="update_default_subitem":"timeline_arrows_by"===t?i="update_default_timeline_arrows_by":(0,a().t1)(t),s().wd({action:i,original_view_type:void 0,property_type:e?"relation":void 0,environment:x,collectionContextStore:o})}),[o,x,h,t,b,_]);return{handlePropertySelect:(0,n.useCallback)((e=>{const n=o.collectionViewStore();if(!n)return;let i;g().createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handlePropertySelect",environment:x,canUndo:!0,perform:t=>{b({collectionViewStore:n,newProperty:e,transaction:t})}}),h(e),"subitem"===t?i="update_subitem":"timeline_arrows_by"===t?i="update_timeline_arrows_by":(0,a().t1)(t),s().wd({action:i,original_view_type:void 0,property_type:e?"relation":void 0,environment:x,collectionContextStore:o})}),[o,x,h,t,b]),handleDefaultPropertySelect:k,handleAddRelation:M,getProperties:j,clearCollectionViewSubitemDisplayMode:(0,n.useCallback)((()=>{const e=o.collectionViewStore();e&&g().createAndCommit({userAction:"actionRegistry.clearCollectionViewSubitemDisplayMode",environment:x,canUndo:!0,perform:t=>{p().FH({stores:[e],update:{subitem_display_mode:void 0},transaction:t})}})}),[o,x])}}function x(e){const{feature:t,collectionContextStore:o}=e;let n,i;var r,l;if("subitem"===t)i=null===(r=o.collectionStore())||void 0===r?void 0:r.getFormatStore().getKeyStore("subitem_property").getValue(),n="flattened"===(null===(l=o.collectionViewStore())||void 0===l?void 0:l.getFormat().subitem_display_mode)?void 0:i;else if("timeline_arrows_by"===t){var s;n=o.currentArrowsByFormatStore.state,i=null===(s=o.collectionStore())||void 0===s?void 0:s.getFormatStore().getKeyStore("collection_default_arrows_by").getValue()}else(0,a().t1)(t);const c=o.normalizedSchemaStore.state,d=f().NA(o,c);(0,a().$K)(n)&&!d.includes(n)&&(n=void 0),(0,a().$K)(i)&&!d.includes(i)&&(i=void 0);const u=n??i;if(u){var p;const e=Boolean(n),r="hidden"!==(null===(p=o.collectionViewStore())||void 0===p?void 0:p.getFormat().subitem_display_mode),l="subitem"===t?r:e;return{property:u,isDefault:u===i,enabledOnView:e,enabledOnCollection:Boolean(i),supportedInView:(0,y().Tg)({feature:t,viewType:o.getViewType()}),isVisibleInView:l}}}function v(e){const{feature:t,collectionContextStore:o}=e;return(0,r().VK)((()=>x({feature:t,collectionContextStore:o})),[o,t])}},940573:(e,t,o)=>{"use strict";o.d(t,{A:()=>E,I:()=>D});o(267602),o(653476);var n=o(667294),i=()=>o(219727),r=()=>o(142735),l=()=>o(846550),a=()=>o(545914),s=()=>o(788860),c=()=>o(696459),d=()=>o(707513),u=()=>o(448419),p=()=>o(198829),g=()=>o(967092),m=()=>o(352230),f=()=>o(66417),y=()=>o(529048),S=(o(670560),o(241792),o.n(o(443261))),h=()=>o(109477),x=()=>o(305580),v=()=>o(641772),C=()=>o(513670),b=()=>o(178498),w=()=>o(827973),j=()=>o(740046),_=()=>o(255577),M=()=>o(388284),k=()=>o(951877),P=()=>o(561933),T=()=>o(527278),I=()=>o(692304),V=o(785893);const A=2,Z=(0,s().vU)({inputPlaceholder:{defaultMessage:"Search for a property…",id:"database.viewSettings.propertySelect.inputPlaceholder"}});function B(e){const{currentProperty:t,getGroupedProperties:o,onAccept:a,renderProperty:d,inputPlaceholder:u,schema:p,format:g,defaultShowPropertyGroupCount:m}=e,f=(0,i().Fy)(),y=(0,r().qz)(void 0,I().Z),_=(0,r().VK)((()=>o()),[o]),[k,B]=(0,n.useState)(!1),[K,H]=(0,n.useState)(""),O=(0,x().i)(g,p,void 0,h().j5.Page).collection_page_properties||[],L=(0,n.useCallback)((e=>{H(e.target.value),y.setState({...y.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}}),B(!1)}),[y]),D=(0,l().yK)((e=>({dotsIcon:{width:16,fill:e.mediumTextColor,marginLeft:4,marginRight:2},showMoreButton:{color:e.mediumTextColor}})),[]),E=C().MR(_,(e=>Math.min(...e.map((e=>O.findIndex((t=>t.property===e))))))),N=[{key:"input",comp:(0,V.jsx)(M().Z,{children:(0,V.jsx)(j().ZP,{focusInitial:!f.isMobile||void 0,focus:!f.isMobile||void 0,value:K,onChange:L,placeholder:u||T().Z.formatMessage(Z.inputPlaceholder)})})}];if(K){const e=E.map((e=>e.filter((e=>{const t=p[e],o=t?`${t.name} ${P().SO[t.type]}`:"";return Boolean(S().match(K,o))})))).filter((e=>e.length>0));if(0===e.length)N.push({key:"noResults",comp:(0,V.jsx)(b().Z,{caption:(0,V.jsx)(s()._H,{defaultMessage:"No results",id:"database.viewSettings.propertySelect.noResultsTitle"})})});else{const o=[{key:"results",render:e=>(0,V.jsx)(M().Z,{...e}),items:e.flat().map((e=>R({onAccept:a,property:e,schema:p,currentProperty:t,renderProperty:d}))).filter(c().$K)}];N.push(F({sections:o,menuListStore:y}))}}else{const e=m||A;let o,n;if(!k&&E.length>e){o=E.slice(0,e);const t=C().Sm(E.slice(e).map((e=>e.length)));n={key:"show_more",render:e=>(0,V.jsx)(w().Z,{...e,icon:(0,v().o)(D.dotsIcon),style:D.showMoreButton,title:(0,V.jsx)(s()._H,{defaultMessage:"{moreCount} more",id:"database.viewSettings.propertySelect.showMoreTitle",values:{moreCount:t}})}),action:()=>{B(!0)}}}else o=E;const i=o.map(((e,i)=>({key:e.join("-"),render:e=>(0,V.jsx)(M().Z,{...e,topBorder:0!==i}),items:e.map((e=>R({onAccept:a,property:e,schema:p,currentProperty:t,renderProperty:d}))).concat(i===o.length-1?[n]:[]).filter(c().$K)})));N.push(F({sections:i,menuListStore:y}))}return(0,V.jsx)(V.Fragment,{children:N.map((e=>{let{key:t,comp:o}=e;return(0,V.jsx)(n.Fragment,{children:o},t)}))})}function F(e){const{menuListStore:t,sections:o}=e;return{key:"properties",comp:(0,V.jsx)(_().ZP,{type:_().iW.Vertical,initialFocus:0,sections:o,store:t})}}function R(e){const{schema:t,currentProperty:o,onAccept:n,renderProperty:i,property:r}=e,l=t[r];if(!l)return;return{key:r,render:e=>{const t=r===o;return i?i(e,r,t,l):(0,V.jsx)(k().N,{...e,propertySchema:l,format:k().L.Name,checkState:t})},action:()=>{n(r)}}}var K=()=>o(446955),H=()=>o(949719),O=()=>o(106713),L=()=>o(810374);function D(e){const{currentPropertyId:t,feature:o,collectionContextStore:n,permissionScopes:i,onPropertySelect:l,buttonPopupStore:d,disabled:u}=e,p=(0,s().YB)(),g=(0,r().VK)((()=>{var e,t;return"subitem"===o?null===(e=n.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.subitem_property:"timeline_arrows_by"===o?null===(t=n.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.collection_default_arrows_by:void(0,c().t1)(o)}),[o,n]),m=(0,r().VK)((()=>n.databaseType),[n]),{handleDefaultPropertySelect:y,handlePropertySelect:S,getProperties:h}=(0,L().he)({collectionContextStore:n,feature:o,onPropertySelect:l}),x=(0,f().g3)({feature:o,databaseType:m});return(0,V.jsx)(N,{intl:p,icon:a().v,caption:(0,V.jsx)(s()._H,{...x}),collectionContextStore:n,buttonPopupStore:d,shouldGroupProperties:!0,getGroupedProperties:h,currentProperty:t,disabled:u,onAccept:i.canConfigureBlock&&i.canConfigureCollection?S:()=>{},renderProperty:(e,t,i,r)=>(0,V.jsx)(O().Z,{version:"v2",feature:o,menuProps:e,property:t,defaultProperty:g,checkState:i,propertySchema:r,collectionContextStore:n,handleDefaultPropertySelect:y,handlePropertySelect:S})})}function E(e){const{currentPropertyId:t,collectionContextStore:o,onPropertyChanged:i,disabled:l,title:a}=e,d=(0,s().YB)(),u=(0,r().qz)(void 0,y().Z),p=(0,r().Kw)(o.normalizedSchemaStore),g=(0,n.useCallback)((()=>Object.keys(p).filter((e=>{const t=p[e];return"date"===(null==t?void 0:t.type)})).filter(c().$K)),[p]);return(0,V.jsx)(N,{intl:d,buttonPopupStore:u,title:a,collectionContextStore:o,shouldGroupProperties:!1,getProperties:g,currentProperty:t,disabled:l,onAccept:e=>{e&&i(e),u.setState({open:!1})}})}function N(e){const{currentProperty:t,icon:o,caption:n,buttonPopupStore:a,collectionContextStore:c,disabled:f,title:y,shouldGroupProperties:S}=e,h=(0,i().Fy)(),x=(0,r().VK)((()=>{var e;return(null===(e=c.collectionStore())||void 0===e?void 0:e.getFormat())??{}}),[c]),v=(0,r().Kw)(c.normalizedSchemaStore),C=(0,l().yK)((e=>({caption:{fontSize:h.isMobile?d().JB.UISmall.mobile:d().JB.UISmall.desktop,color:e.mediumTextColor,margin:"0 12px 12px 14px"}})),[h]),b=(0,r().VK)((()=>a.state.open),[a]),w=(0,r().VK)((()=>h.isPhone?{menuType:m().o.ActionSheet}:{menuType:m().o.Popup,width:300}),[h.isPhone]);return(0,V.jsxs)(V.Fragment,{children:[n&&(0,V.jsx)("div",{style:C.caption,children:n}),(0,V.jsx)(u().ZP,{popupType:h.isPhone?g().kQ.SlideUp:g().kQ.Popup,alignmentToOrigin:u().vR.End,placementToOrigin:u().pO.Bottom,disabled:f,originGap:0,renderOrigin:e=>{var n;return(0,V.jsx)(K().Z,{title:y??(0,V.jsx)(s()._H,{id:"database.viewSettings.relationFeatures.propertyPicker.default.title",defaultMessage:"Property"}),showChevron:!0,right:t?(0,V.jsx)("span",{style:d().Yu,children:null===(n=v[t])||void 0===n?void 0:n.name}):void 0,rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0},rotateChevron:b,disabled:f,icon:o,...e})},render:t=>(0,V.jsx)(p().Z,{...w,children:S?(0,V.jsx)(B,{...e,getGroupedProperties:e.getGroupedProperties,format:x,schema:v}):(0,V.jsx)(H().Z,{getProperties:e.getProperties,currentProperty:e.currentProperty,onAccept:e.onAccept,format:x,schema:v})}),buttonPopupStore:a})]})}},445294:(e,t,o)=>{"use strict";o.r(t),o.d(t,{ChartSettingsMain:()=>j()._,CollectionSettings:()=>n().A,CollectionSettingsButtonOptions:()=>b,CollectionSettingsEditButtonAutomationOption:()=>G,CollectionSettingsPropertyTypeMenuItem:()=>W});var n=()=>o(888686),i=o(667294),r=()=>o(142735),l=()=>o(494616),a=()=>o(788860),s=()=>o(636340),c=()=>o(285755),d=()=>o(516463),u=()=>o(637118),p=()=>o(486896),g=()=>o(269853),m=()=>o(882886),f=()=>o(359620),y=()=>o(740046),S=()=>o(388284),h=()=>o(527278),x=()=>o(205951),v=o(785893);const C=(0,a().vU)({inputPlaceholder:{defaultMessage:"Type a name for this button...",id:"database.buttonProperty.label.inputPlaceholder"}});function b(e){const{collectionContextStore:t,propertySchema:o}=e,n=(0,r().VK)((()=>t.collectionStore()),[t]),a=(0,r().VK)((()=>null==n?void 0:n.getSpaceId()),[n]),s=(0,i.useMemo)((()=>{const e=o.automation_id;if(e&&a)return{id:e,spaceId:a,table:l().cv}}),[o.automation_id,a]);return(0,m().N)(n,s)?(0,v.jsx)(w,{...e}):(0,v.jsx)(d().Z,{})}function w(e){const{collectionContextStore:t,propertySchema:o,propertyId:n}=e,[l,d]=(0,i.useState)([]),m=(0,r().Kw)(t.permissionScopesStore),b=(0,r().VK)((()=>t.collectionStore()),[t]),w=(0,r().VK)((()=>null==b?void 0:b.getSpaceId()),[b]),{maybePersistedAutomationStore:j,maybePersistedTransactionActions:_}=(0,f().$)({automationId:o.automation_id,spaceId:w,defaultValue:void 0,persist:!0}),M=(0,r().VK)((()=>null==j?void 0:j.getTrigger()),[j]),k=(0,g().C6)({automationStore:j,propertyId:n,propertySchema:o,collectionContextStore:t}),P=(0,r().VK)((()=>{var e;return"sufficient"===(null==k||null===(e=k.state)||void 0===e?void 0:e.executionPermissionStatus)}),[k]),T=(0,r().VK)((()=>(null==j?void 0:j.getNameStore().getValue())??""),[j]),I=(0,i.useCallback)((e=>{if(!j)return;const t=e.currentTarget.value;_.createAndCommit({userAction:"CollectionSettingsButtonOptions.setName",perform:e=>{s().sO({store:j.getNameStore(),transaction:e,value:t})}})}),[j,_]),V=(0,i.useCallback)((e=>{d((t=>[...t,e.id]))}),[]);return b&&j&&M&&"button"===M.type?(0,v.jsx)(u().Jj,{automationStore:j,contextType:"button_property",children:(0,v.jsxs)(p().$,{value:{collectionStore:b,disabled:!P,editorPlacement:{type:"inline"},editorWidth:x().P4,maybePersistedTransactionActions:_,onActionAdded:V,suppressActionErrors:l,hideDragHandle:!1},children:[(0,v.jsx)(S().Z,{topBorder:!0,title:(0,v.jsx)(a()._H,{id:"database.buttonProperty.label",defaultMessage:"Label"}),children:(0,v.jsx)(y().ZP,{disabled:!m.canConfigureCollection,placeholder:h().Z.formatMessage(C.inputPlaceholder),value:T,onChange:I})}),(0,v.jsx)(S().Z,{style:{paddingInline:12},children:(0,v.jsx)(c().IQ,{areActionsEditable:!0,areTriggersEditable:!1})})]})}):null}var j=()=>o(947961),_=()=>o(219727),M=()=>o(846550),k=()=>o(226413),P=()=>o(532850),T=()=>o(766933),I=()=>o(667067),V=()=>o(707513),A=()=>o(250303),Z=()=>o(984871),B=()=>o(139224),F=()=>o(853292),R=()=>o(269299),K=()=>o(360240),H=()=>o(943620),O=()=>o(384241),L=()=>o(396439),D=()=>o(654133),E=()=>o(561933),N=()=>o(998901),U=()=>o(264737),z=()=>o(446955);function W(e){const{collectionContextStore:t,collectionUri:o,disabled:n,formatKey:l,isTypedProperty:s,property:c,propertyTypeButtonPopupStore:d}=e,u=(0,M().Fg)(),p=(0,_().O7)(),g=(0,r().VK)((()=>t.collectionViewBlockStore()),[t]),m=(0,r().VK)((()=>(0,U().KV)({property:c,collectionContextStore:t})),[t,c]),f=(0,r().VK)((()=>(0,U().MF)(g,m)),[g,m]),y=(0,r().VK)((()=>null==f?void 0:f.getIcon()),[f]),S=t.settingsStore,h=(0,i.useCallback)((()=>{m&&function(e){const{collectionContextStore:t,collectionSettingsStore:o,environment:n,formatKey:i,property:r,propertySchema:l,propertyTypeButtonPopupStore:a}=e,s=t.collectionStore();if(!s)return;B().H4({collectionSettingsStore:o,item:{type:"propertyType",propertySchema:l,onAccept:e=>function(e){const{collectionContextStore:t,collectionSettingsStore:o,environment:n,formatKey:i,property:r,propertyTypeButtonPopupStore:l,type:a}=e,s=t.collectionStore();if(!s)return;A().$q({environment:n,collectionContextStore:t,property:r,new_property_type:(0,k().TN)(a),from:"view_settings",action:"change_type"}),"relation"===a?B().H4({collectionSettingsStore:o,item:{type:"selectRelationSource",property:r,formatKey:i}}):(R().createAndCommit({userAction:"CollectionSettingsProperty.handlePropertyTypeAccept",environment:n,canUndo:!0,perform:e=>{Z().LC({environment:n,collectionStore:s,property:r,type:a,transaction:e})}}),B().z$({collectionSettingsStore:o}),(0,k().XU)(a)&&F().K7({propertyType:a,propertyId:r,collectionContextStore:t}));l.reset()}({collectionContextStore:t,collectionSettingsStore:o,environment:n,formatKey:i,property:r,propertyTypeButtonPopupStore:a,type:e})}})}({collectionContextStore:t,collectionSettingsStore:S,environment:p,formatKey:l,property:c,propertySchema:m,propertyTypeButtonPopupStore:d})}),[t,S,p,l,c,m,d]);if(!m)return null;const x=(0,P().gg)(m)||(0,P().ic)(m);return(0,v.jsx)(D().Z,{placement:N().Placement.Left,disableTooltip:!n,renderTooltip:e=>function(e){const{tooltipEvents:t,isTypedProperty:o,collectionUri:n,propertySchema:i}=e;if(o&&n)return(0,v.jsx)(a()._H,{...t,defaultMessage:"{type} type is required for this property in {databaseType}.",id:"database.viewSettings.propertyTab.restrictedProperty",description:"A tooltip to educate the users on why they can't change the type of this property.",values:{type:E().SO[i.type],databaseType:(0,K().Mn)(n)}});return(0,v.jsx)(a()._H,{...t,defaultMessage:"This property's type cannot be changed.",id:"database.viewSettings.propertyTab.untypedRestrictedProperty",description:"A tooltip to educate the users on why they can't change the type of this property."})}({tooltipEvents:e,isTypedProperty:s,collectionUri:o,propertySchema:m}),render:e=>(0,v.jsx)(z().Z,{...e,disabled:n,rotateChevron:d.state.open,title:(0,v.jsx)(a()._H,{defaultMessage:"Type",id:"database.viewSettings.propertyTab.propertyType"}),showChevron:!0,right:(0,v.jsxs)(v.Fragment,{children:[n?(0,v.jsx)("div",{...e,children:(0,I().Q)({width:14,fill:u.regularIconColor})}):(0,v.jsx)(T().ZP,{type:m.type,icon:void 0,size:16,theme:u}),(0,v.jsx)(L().Z,{size:4}),x?(0,v.jsxs)("div",{style:{color:n?u.darkTextColor:void 0,display:"flex",alignItems:"center"},children:[(0,v.jsx)(H().Z,{icon:y,isEmptyPage:!1,size:20,disabled:!0}),(0,v.jsx)(O().Z,{store:f,style:{display:"inline",wordBreak:"break-word",...V().Yu}})]}):(0,v.jsx)("span",{style:{color:n?u.darkTextColor:void 0},children:E().SO[m.type]})]}),onClick:h})})}var q=()=>o(915687);function G(e){const{collectionSettingsStore:t,collectionContextStore:o,property:n}=e,i=(0,_().O7)(),l=(0,r().VK)((()=>(0,U().KV)({collectionContextStore:o,property:n})),[o,n]);return(0,v.jsx)(z().Z,{title:(0,v.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,v.jsx)(a()._H,{id:"database.collectionsettings.button.editAutomationLabel",defaultMessage:"Edit automation"})}),disabled:!1,showChevron:!0,onClick:()=>{l&&"button"===l.type&&q().b({environment:i,mode:"edit_button_property",collectionSettingsStore:t,collectionContextStore:o,propertyId:n,propertySchema:l})}})}},264737:(e,t,o)=>{"use strict";o.d(t,{KV:()=>c,MF:()=>d,bZ:()=>u});var n=()=>o(984871),i=()=>o(269299),r=()=>o(561933),l=()=>o(473244),a=()=>o(109083),s=()=>o(826955);function c(e){let{collectionContextStore:t,property:o}=e;return(0,r().BX)(t)[o]}function d(e,t){var o;if("relation"!==(null==t?void 0:t.type))return;const n=null===(o=a().Z.state.caches[l().he])||void 0===o?void 0:o.inMemoryRecordCache,i=null==t?void 0:t.collection_pointer,r=i&&e?s().NW.createChildStore(e,i):void 0;return n?null==r?void 0:r.clone(n):r}function u(e){const{name:t,environment:o,property:l,collectionContextStore:a,inputValue:s}=e;if((0,r().Gu)({property:l,collectionContextStore:a,newValue:s}))return;const c=a.collectionStore();if(!c)return;const d=c.getSchema()[l];d&&d.name!==t&&i().createAndCommit({userAction:"ButtonBuilderModal.handlePropertyNameSubmit",environment:o,canUndo:!0,perform:e=>{n().Bv({collectionStore:c,property:l,name:t,transaction:e})}})}},947961:(e,t,o)=>{"use strict";o.d(t,{_:()=>To});var n=o(667294),i=()=>o(219727),r=()=>o(142735),l=()=>o(846550),a=()=>o(970977),s=()=>o(790300),c=()=>o(259739),d=()=>o(788860),u=()=>o(388284),p=()=>o(125659),g=()=>o(876822),m=()=>o(55406),f=(o(821057),o(241792),()=>o(827282)),y=o(785893);const S=(0,f().IU)("collectionChartDonutSelected",{viewBox:"0 0 24 24",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{d:"M22.328 13.9022C22.1304 13.9657 21.9195 14 21.7 14H20.7771C20.4098 15.6195 19.6057 17.0728 18.4945 18.2307C16.8557 19.9384 14.5524 21 12 21C7.02944 21 3 16.9706 3 12C3 7.71682 5.99202 4.13247 10 3.22301V2.29999C10 2.08048 10.0343 1.86948 10.0978 1.67186C5.2069 2.56685 1.5 6.85052 1.5 12C1.5 17.799 6.20101 22.5 12 22.5C14.9776 22.5 17.6668 21.2596 19.5768 19.2693C20.9699 17.8176 21.9504 15.965 22.328 13.9022Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{d:"M10 5.86607C7.41679 6.70778 5.55 9.13588 5.55 12C5.55 15.5622 8.43776 18.45 12 18.45C13.7922 18.45 15.4148 17.7181 16.5829 16.5387C17.2814 15.8334 17.8186 14.9669 18.1337 14H17.75C17.3441 14 16.9702 13.8837 16.6561 13.6848C16.4095 14.3661 16.0175 14.9779 15.5171 15.4832C14.6192 16.3898 13.3757 16.95 12 16.95C9.26619 16.95 7.05 14.7338 7.05 12C7.05 9.85773 8.41088 8.03331 10.3153 7.34407C10.1163 7.02989 10 6.65601 10 6.24999V5.86607Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{d:"M12.75 3.03079C17.1223 3.39148 20.6085 6.87768 20.9692 11.25H18.4069C18.0637 8.28709 15.7129 5.93628 12.75 5.59314V3.03079Z",fill:"#2383E2",fillOpacity:"0.15"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.9692 11.25C20.6085 6.87768 17.1223 3.39148 12.75 3.0308L12.75 5.59315C15.7129 5.93628 18.0637 8.28709 18.4069 11.25L20.9692 11.25ZM22.4999 11.9459C22.5021 12.3866 22.146 12.75 21.7 12.75L17.75 12.75C17.3019 12.75 16.9535 12.3866 16.9498 11.9562C16.9265 9.25722 14.7428 7.07349 12.0438 7.05019C11.6134 7.04647 11.25 6.69813 11.25 6.25L11.25 2.3C11.25 1.85404 11.6134 1.49791 12.0541 1.50013C17.8102 1.52919 22.4708 6.18979 22.4999 11.9459Z",fill:"#2383E2",fillOpacity:"0.8"})]})}),h=(0,f().IU)("collectionChartDonutSelectedDark",{viewBox:"0 0 24 24",svg:(0,y.jsxs)("g",{children:[(0,y.jsx)("path",{fill:"#fff",fillOpacity:"0.283",d:"M22.328 13.902A2.049 2.049 0 0121.7 14h-.923a8.978 8.978 0 01-2.283 4.23A9 9 0 1110 3.223v-.922c0-.22.034-.43.098-.628C5.207 2.567 1.5 6.85 1.5 12c0 5.799 4.701 10.5 10.5 10.5 2.978 0 5.667-1.24 7.577-3.23a10.475 10.475 0 002.751-5.368z"}),(0,y.jsx)("path",{fill:"#fff",fillOpacity:"0.283",d:"M10 5.866A6.45 6.45 0 1018.134 14h-.384c-.406 0-.78-.116-1.094-.315A4.953 4.953 0 0112 16.95a4.95 4.95 0 01-1.685-9.606A2.034 2.034 0 0110 6.25v-.384z"}),(0,y.jsx)("path",{fill:"#2383E2",fillOpacity:"0.25",d:"M12.75 3.03a9.002 9.002 0 018.22 8.22h-2.563a6.453 6.453 0 00-5.657-5.657V3.031z"}),(0,y.jsx)("path",{fill:"#2383E2",fillRule:"evenodd",d:"M20.97 11.25a9.002 9.002 0 00-8.22-8.22v2.563a6.453 6.453 0 015.657 5.657h2.562zm1.53.696a.8.8 0 01-.8.804h-3.95a.8.8 0 01-.8-.794 4.95 4.95 0 00-4.906-4.906.8.8 0 01-.794-.8V2.3a.8.8 0 01.804-.8c5.756.03 10.417 4.69 10.446 10.446z",clipRule:"evenodd"})]})}),x=(0,f().IU)("collectionChartDonutUnselected",{viewBox:"0 0 24 24",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{d:"M22.328 13.9022C22.1304 13.9657 21.9195 14 21.7 14H20.7771C20.4098 15.6195 19.6057 17.0728 18.4945 18.2307C16.8557 19.9384 14.5524 21 12 21C7.02944 21 3 16.9706 3 12C3 7.71682 5.99202 4.13247 10 3.22301V2.29999C10 2.08048 10.0343 1.86948 10.0978 1.67186C5.2069 2.56685 1.5 6.85052 1.5 12C1.5 17.799 6.20101 22.5 12 22.5C14.9776 22.5 17.6668 21.2596 19.5768 19.2693C20.9699 17.8176 21.9504 15.965 22.328 13.9022Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{d:"M10 5.86607C7.41679 6.70778 5.55 9.13588 5.55 12C5.55 15.5622 8.43776 18.45 12 18.45C13.7922 18.45 15.4148 17.7181 16.5829 16.5387C17.2814 15.8334 17.8186 14.9669 18.1337 14H17.75C17.3441 14 16.9702 13.8837 16.6561 13.6848C16.4095 14.3661 16.0175 14.9779 15.5171 15.4832C14.6192 16.3898 13.3757 16.95 12 16.95C9.26619 16.95 7.05 14.7338 7.05 12C7.05 9.85773 8.41088 8.03331 10.3153 7.34407C10.1163 7.02989 10 6.65601 10 6.24999V5.86607Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.9692 11.25C20.6085 6.87768 17.1223 3.39148 12.75 3.0308L12.75 5.59315C15.7129 5.93628 18.0637 8.28709 18.4069 11.25L20.9692 11.25ZM22.4999 11.9459C22.5021 12.3866 22.146 12.75 21.7 12.75L17.75 12.75C17.3019 12.75 16.9535 12.3866 16.9498 11.9562C16.9265 9.25722 14.7428 7.07349 12.0438 7.05019C11.6134 7.04647 11.25 6.69813 11.25 6.25L11.25 2.3C11.25 1.85404 11.6134 1.49791 12.0541 1.50013C17.8102 1.52919 22.4708 6.18979 22.4999 11.9459Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),v=(0,f().IU)("collectionChartDonutUnselectedDark",{viewBox:"0 0 24 24",svg:(0,y.jsxs)("g",{children:[(0,y.jsx)("path",{fill:"#fff",fillOpacity:"0.283",d:"M22.328 13.902A2.049 2.049 0 0121.7 14h-.923a8.978 8.978 0 01-2.283 4.23A9 9 0 1110 3.223v-.922c0-.22.034-.43.098-.628C5.207 2.567 1.5 6.85 1.5 12c0 5.799 4.701 10.5 10.5 10.5 2.978 0 5.667-1.24 7.577-3.23a10.475 10.475 0 002.751-5.368z"}),(0,y.jsx)("path",{fill:"#fff",fillOpacity:"0.283",d:"M10 5.866A6.45 6.45 0 1018.134 14h-.384c-.406 0-.78-.116-1.094-.315A4.953 4.953 0 0112 16.95a4.95 4.95 0 01-1.685-9.606A2.034 2.034 0 0110 6.25v-.384z"}),(0,y.jsx)("path",{fill:"#2383E2",fillOpacity:"0.8",fillRule:"evenodd",d:"M20.97 11.25a9.002 9.002 0 00-8.22-8.22v2.563a6.453 6.453 0 015.657 5.657h2.562zm1.53.696a.8.8 0 01-.8.804h-3.95a.8.8 0 01-.8-.794 4.95 4.95 0 00-4.906-4.906.8.8 0 01-.794-.8V2.3a.8.8 0 01.804-.8c5.756.03 10.417 4.69 10.446 10.446z",clipRule:"evenodd"})]})}),C=(0,f().IU)("collectionChartHorizontalBarSelected",{viewBox:"0 0 24 24",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 6L15.25 6V4L4.75 4V6ZM4.045 7.5C3.60594 7.5 3.25 7.14407 3.25 6.705L3.25 3.295C3.25 2.85593 3.60593 2.5 4.045 2.5L15.955 2.5C16.3941 2.5 16.75 2.85593 16.75 3.295V6.705C16.75 7.14407 16.3941 7.5 15.955 7.5L4.045 7.5Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 13H11.25V11H4.75V13ZM4.045 14.5C3.60594 14.5 3.25 14.1441 3.25 13.705L3.25 10.295C3.25 9.85593 3.60593 9.5 4.045 9.5H11.955C12.3941 9.5 12.75 9.85593 12.75 10.295V13.705C12.75 14.1441 12.3941 14.5 11.955 14.5H4.045Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{d:"M20.25 20H4.75V18H20.25V20Z",fill:"#2383E2",fillOpacity:"0.15"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 20H20.25V18H4.75V20ZM4.05 21.5C3.60818 21.5 3.25 21.1418 3.25 20.7L3.25 17.3C3.25 16.8582 3.60817 16.5 4.05 16.5H20.95C21.3918 16.5 21.75 16.8582 21.75 17.3V20.7C21.75 21.1418 21.3918 21.5 20.95 21.5H4.05Z",fill:"#2383E2",fillOpacity:"0.8"})]})}),b=(0,f().IU)("collectionChartHorizontalBarSelectedDark",{viewBox:"0 0 24 24",svg:(0,y.jsxs)("g",{children:[(0,y.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M4.75 6h10.5V4H4.75v2zm-.705 1.5a.795.795 0 01-.795-.795v-3.41c0-.44.356-.795.795-.795h11.91c.44 0 .795.356.795.795v3.41c0 .44-.356.795-.795.795H4.045zM4.75 13h6.5v-2h-6.5v2zm-.705 1.5a.795.795 0 01-.795-.795v-3.41c0-.44.356-.795.795-.795h7.91c.44 0 .795.356.795.795v3.41c0 .44-.356.795-.795.795h-7.91z",clipRule:"evenodd"}),(0,y.jsx)("path",{fill:"#2383E2",fillOpacity:"0.25",d:"M20.25 20H4.75v-2h15.5v2z"}),(0,y.jsx)("path",{fill:"#2383E2",fillRule:"evenodd",d:"M4.75 20h15.5v-2H4.75v2zm-.7 1.5a.8.8 0 01-.8-.8v-3.4a.8.8 0 01.8-.8h16.9a.8.8 0 01.8.8v3.4a.8.8 0 01-.8.8H4.05z",clipRule:"evenodd"})]})}),w=(0,f().IU)("collectionChartHorizontalBarUnselected",{viewBox:"0 0 24 24",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 6L15.25 6V4L4.75 4V6ZM4.045 7.5C3.60594 7.5 3.25 7.14407 3.25 6.705L3.25 3.295C3.25 2.85593 3.60593 2.5 4.045 2.5L15.955 2.5C16.3941 2.5 16.75 2.85593 16.75 3.295V6.705C16.75 7.14407 16.3941 7.5 15.955 7.5L4.045 7.5Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 13H11.25V11H4.75V13ZM4.045 14.5C3.60594 14.5 3.25 14.1441 3.25 13.705L3.25 10.295C3.25 9.85593 3.60593 9.5 4.045 9.5H11.955C12.3941 9.5 12.75 9.85593 12.75 10.295V13.705C12.75 14.1441 12.3941 14.5 11.955 14.5H4.045Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 20H20.25V18H4.75V20ZM4.05 21.5C3.60818 21.5 3.25 21.1418 3.25 20.7L3.25 17.3C3.25 16.8582 3.60817 16.5 4.05 16.5H20.95C21.3918 16.5 21.75 16.8582 21.75 17.3V20.7C21.75 21.1418 21.3918 21.5 20.95 21.5H4.05Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),j=(0,f().IU)("collectionChartHorizontalBarUnselectedDark",{viewBox:"0 0 24 24",svg:(0,y.jsxs)("g",{children:[(0,y.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M4.75 6h10.5V4H4.75v2zm-.705 1.5a.795.795 0 01-.795-.795v-3.41c0-.44.356-.795.795-.795h11.91c.44 0 .795.356.795.795v3.41c0 .44-.356.795-.795.795H4.045zM4.75 13h6.5v-2h-6.5v2zm-.705 1.5a.795.795 0 01-.795-.795v-3.41c0-.44.356-.795.795-.795h7.91c.44 0 .795.356.795.795v3.41c0 .44-.356.795-.795.795h-7.91z",clipRule:"evenodd"}),(0,y.jsx)("path",{fill:"#2383E2",fillOpacity:"0.8",fillRule:"evenodd",d:"M4.75 20h15.5v-2H4.75v2zm-.7 1.5a.8.8 0 01-.8-.8v-3.4a.8.8 0 01.8-.8h16.9a.8.8 0 01.8.8v3.4a.8.8 0 01-.8.8H4.05z",clipRule:"evenodd"})]})}),_=(0,f().IU)("collectionChartLineSelected",{viewBox:"0 0 24 24",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.25 1.34999C2.66421 1.34999 3 1.68578 3 2.09999V21H21.9C22.3142 21 22.65 21.3358 22.65 21.75C22.65 22.1642 22.3142 22.5 21.9 22.5H2.4C1.90295 22.5 1.5 22.097 1.5 21.6V2.09999C1.5 1.68578 1.83579 1.34999 2.25 1.34999Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.282 8.82193C19.9925 9.39441 19.578 10.1448 19.073 10.8721C18.5636 11.606 17.9871 12.2798 17.3833 12.7313C16.7803 13.1822 16.2283 13.3564 15.7165 13.264C15.0386 13.1416 14.7238 12.6188 14.2275 11.6384C14.2133 11.6103 14.1988 11.5816 14.1841 11.5525C13.7578 10.7068 13.1391 9.47987 11.6666 9.21412C10.5932 9.02037 9.62328 9.43236 8.8352 10.0216C8.04796 10.6103 7.36417 11.4307 6.81155 12.2267C6.25441 13.0293 5.80504 13.8446 5.49617 14.4554C4.83609 15.7605 6.1888 16.4095 6.83472 15.1323C7.12425 14.5598 7.5388 13.8095 8.04375 13.0821C8.55321 12.3482 9.12966 11.6744 9.73347 11.2229C10.3364 10.7721 10.8884 10.5979 11.4002 10.6903C12.0781 10.8126 12.393 11.3355 12.8892 12.3158C12.9035 12.344 12.9179 12.3727 12.9326 12.4018C13.359 13.2474 13.9776 14.4744 15.4501 14.7401C16.5236 14.9339 17.4935 14.5219 18.2816 13.9326C19.0688 13.344 19.7526 12.5236 20.3052 11.7275C20.8623 10.925 21.3117 10.1096 21.6206 9.49889C22.2706 8.21371 20.8559 7.68723 20.282 8.82193Z",fill:"#2383E2",fillOpacity:"0.8"})]})}),M=(0,f().IU)("collectionChartLineSelectedDark",{viewBox:"0 0 24 24",svg:(0,y.jsxs)("g",{children:[(0,y.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M2.25 1.35A.75.75 0 013 2.1V21h18.9a.75.75 0 010 1.5H2.4a.9.9 0 01-.9-.9V2.1a.75.75 0 01.75-.75z",clipRule:"evenodd"}),(0,y.jsx)("path",{fill:"#2383E2",fillRule:"evenodd",d:"M20.282 8.822c-.29.572-.704 1.323-1.209 2.05-.51.734-1.086 1.408-1.69 1.86-.603.45-1.155.624-1.666.532-.678-.122-.993-.645-1.49-1.626l-.043-.085c-.426-.846-1.045-2.073-2.517-2.339-1.074-.194-2.044.218-2.832.808-.787.588-1.47 1.409-2.023 2.205a19.077 19.077 0 00-1.316 2.228c-.66 1.306.693 1.955 1.339.677.29-.572.704-1.322 1.209-2.05.51-.734 1.086-1.408 1.69-1.86.602-.45 1.154-.624 1.666-.532.678.123.993.646 1.49 1.626l.043.086c.426.845 1.045 2.072 2.517 2.338 1.074.194 2.044-.218 2.832-.807.787-.589 1.47-1.41 2.023-2.206A19.086 19.086 0 0021.621 9.5c.65-1.285-.765-1.812-1.339-.677z",clipRule:"evenodd"})]})}),k=(0,f().IU)("collectionChartLineUnselected",{viewBox:"0 0 24 24",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.25 1.34999C2.66421 1.34999 3 1.68578 3 2.09999V21H21.9C22.3142 21 22.65 21.3358 22.65 21.75C22.65 22.1642 22.3142 22.5 21.9 22.5H2.4C1.90295 22.5 1.5 22.097 1.5 21.6V2.09999C1.5 1.68578 1.83579 1.34999 2.25 1.34999Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.282 8.82193C19.9925 9.39441 19.578 10.1448 19.073 10.8721C18.5636 11.606 17.9871 12.2798 17.3833 12.7313C16.7803 13.1822 16.2283 13.3564 15.7165 13.264C15.0386 13.1416 14.7238 12.6188 14.2275 11.6384C14.2133 11.6103 14.1988 11.5816 14.1841 11.5525C13.7578 10.7068 13.1391 9.47987 11.6666 9.21412C10.5932 9.02038 9.62328 9.43236 8.8352 10.0216C8.04796 10.6103 7.36417 11.4307 6.81155 12.2267C6.25441 13.0293 5.80504 13.8446 5.49617 14.4554C4.83609 15.7605 6.1888 16.4095 6.83472 15.1323C7.12425 14.5598 7.5388 13.8095 8.04375 13.0821C8.55321 12.3482 9.12966 11.6744 9.73347 11.2229C10.3364 10.7721 10.8884 10.5979 11.4002 10.6903C12.0781 10.8126 12.393 11.3355 12.8892 12.3158C12.9035 12.344 12.9179 12.3727 12.9326 12.4018C13.359 13.2474 13.9776 14.4744 15.4501 14.7401C16.5236 14.9339 17.4935 14.5219 18.2816 13.9326C19.0688 13.344 19.7526 12.5236 20.3052 11.7275C20.8623 10.925 21.3117 10.1096 21.6206 9.49889C22.2706 8.21371 20.8559 7.68723 20.282 8.82193Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),P=(0,f().IU)("collectionChartLineUnselectedDark",{viewBox:"0 0 24 24",svg:(0,y.jsxs)("g",{children:[(0,y.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M2.25 1.35A.75.75 0 013 2.1V21h18.9a.75.75 0 010 1.5H2.4a.9.9 0 01-.9-.9V2.1a.75.75 0 01.75-.75z",clipRule:"evenodd"}),(0,y.jsx)("path",{fill:"#2383E2",fillOpacity:"0.8",fillRule:"evenodd",d:"M20.282 8.822c-.29.572-.704 1.323-1.209 2.05-.51.734-1.086 1.408-1.69 1.86-.603.45-1.155.624-1.666.532-.678-.122-.993-.645-1.49-1.626l-.043-.085c-.426-.846-1.045-2.073-2.517-2.339-1.074-.194-2.044.218-2.832.808-.787.588-1.47 1.409-2.023 2.205a19.077 19.077 0 00-1.316 2.228c-.66 1.306.693 1.955 1.339.677.29-.572.704-1.322 1.209-2.05.51-.734 1.086-1.408 1.69-1.86.602-.45 1.154-.624 1.666-.532.678.123.993.646 1.49 1.626l.043.086c.426.845 1.045 2.072 2.517 2.338 1.074.194 2.044-.218 2.832-.807.787-.589 1.47-1.41 2.023-2.206A19.086 19.086 0 0021.621 9.5c.65-1.285-.765-1.812-1.339-.677z",clipRule:"evenodd"})]})}),T=(0,f().IU)("collectionChartVerticalBarSelected",{viewBox:"0 0 24 24",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.75 9.75V20.25H5.25V9.75H2.75ZM1.25 9.045C1.25 8.60594 1.60593 8.25 2.045 8.25H5.955C6.39407 8.25 6.75 8.60593 6.75 9.045V20.955C6.75 21.3941 6.39407 21.75 5.955 21.75H2.045C1.60593 21.75 1.25 21.3941 1.25 20.955V9.045Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.75 13.75V20.25H13.25V13.75H10.75ZM9.25 13.045C9.25 12.6059 9.60593 12.25 10.045 12.25H13.955C14.3941 12.25 14.75 12.6059 14.75 13.045V20.955C14.75 21.3941 14.3941 21.75 13.955 21.75H10.045C9.60593 21.75 9.25 21.3941 9.25 20.955V13.045Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{d:"M18.75 20.25V4.75H21.25V20.25H18.75Z",fill:"#2383E2",fillOpacity:"0.15"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.75 4.75V20.25H21.25V4.75H18.75ZM17.25 4.05C17.25 3.60818 17.6082 3.25 18.05 3.25H21.95C22.3918 3.25 22.75 3.60817 22.75 4.05V20.95C22.75 21.3918 22.3918 21.75 21.95 21.75H18.05C17.6082 21.75 17.25 21.3918 17.25 20.95V4.05Z",fill:"#2383E2",fillOpacity:"0.8"})]})}),I=(0,f().IU)("collectionChartVerticalBarSelectedDark",{viewBox:"0 0 24 24",svg:(0,y.jsxs)("g",{children:[(0,y.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M2.75 9.75v10.5h2.5V9.75h-2.5zm-1.5-.705c0-.44.356-.795.795-.795h3.91c.44 0 .795.356.795.795v11.91c0 .44-.356.795-.795.795h-3.91a.795.795 0 01-.795-.795V9.045zm9.5 4.705v6.5h2.5v-6.5h-2.5zm-1.5-.705c0-.44.356-.795.795-.795h3.91c.44 0 .795.356.795.795v7.91c0 .44-.356.795-.795.795h-3.91a.795.795 0 01-.795-.795v-7.91z",clipRule:"evenodd"}),(0,y.jsx)("path",{fill:"#2383E2",fillOpacity:"0.25",d:"M18.75 20.25V4.75h2.5v15.5h-2.5z"}),(0,y.jsx)("path",{fill:"#2383E2",fillRule:"evenodd",d:"M18.75 4.75v15.5h2.5V4.75h-2.5zm-1.5-.7a.8.8 0 01.8-.8h3.9a.8.8 0 01.8.8v16.9a.8.8 0 01-.8.8h-3.9a.8.8 0 01-.8-.8V4.05z",clipRule:"evenodd"})]})}),V=(0,f().IU)("collectionChartVerticalBarUnselected",{viewBox:"0 0 24 24",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.75 9.75V20.25H5.25V9.75H2.75ZM1.25 9.045C1.25 8.60594 1.60593 8.25 2.045 8.25H5.955C6.39407 8.25 6.75 8.60593 6.75 9.045V20.955C6.75 21.3941 6.39407 21.75 5.955 21.75H2.045C1.60593 21.75 1.25 21.3941 1.25 20.955V9.045Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.75 13.75V20.25H13.25V13.75H10.75ZM9.25 13.045C9.25 12.6059 9.60593 12.25 10.045 12.25H13.955C14.3941 12.25 14.75 12.6059 14.75 13.045V20.955C14.75 21.3941 14.3941 21.75 13.955 21.75H10.045C9.60593 21.75 9.25 21.3941 9.25 20.955V13.045Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.75 4.75V20.25H21.25V4.75H18.75ZM17.25 4.05C17.25 3.60818 17.6082 3.25 18.05 3.25H21.95C22.3918 3.25 22.75 3.60817 22.75 4.05V20.95C22.75 21.3918 22.3918 21.75 21.95 21.75H18.05C17.6082 21.75 17.25 21.3918 17.25 20.95V4.05Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),A=(0,f().IU)("collectionChartVerticalBarUnselectedDark",{viewBox:"0 0 24 24",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M2.75 9.75v10.5h2.5V9.75h-2.5zm-1.5-.705c0-.44.356-.795.795-.795h3.91c.44 0 .795.356.795.795v11.91c0 .44-.356.795-.795.795h-3.91a.795.795 0 01-.795-.795V9.045zm9.5 4.705v6.5h2.5v-6.5h-2.5zm-1.5-.705c0-.44.356-.795.795-.795h3.91c.44 0 .795.356.795.795v7.91c0 .44-.356.795-.795.795h-3.91a.795.795 0 01-.795-.795v-7.91z",clipRule:"evenodd"}),(0,y.jsx)("path",{fill:"#2383E2",fillOpacity:"0.8",fillRule:"evenodd",d:"M18.75 4.75v15.5h2.5V4.75h-2.5zm-1.5-.7a.8.8 0 01.8-.8h3.9a.8.8 0 01.8.8v16.9a.8.8 0 01-.8.8h-3.9a.8.8 0 01-.8-.8V4.05z",clipRule:"evenodd"})]})});var Z=()=>o(696459),B=()=>o(154186),F=()=>o(654133),R=()=>o(288141),K=()=>o(998901);const H={light:{column:{unselected:V,selected:T},bar:{unselected:w,selected:C},line:{unselected:k,selected:_},donut:{unselected:x,selected:S}},dark:{column:{unselected:A,selected:I},bar:{unselected:j,selected:b},line:{unselected:P,selected:M},donut:{unselected:v,selected:h}}};function O(e){let{chartConfig:t,disabled:o}=e;const n=(0,i().MO)(),l=(0,r().VK)((()=>{if(!t)return;const e=t.type;if("placeholder"===e)throw new Error("Should not happen");return e}),[t]);return(0,y.jsx)("div",{style:{display:"flex",marginLeft:10,marginRight:10,...n?{marginTop:10}:{}},children:(0,Z().Yd)(H.light).map((e=>(0,y.jsx)(L,{chartType:e,currentlySelectedChartType:l,disabled:o},e)))})}function L(e){let{chartType:t,currentlySelectedChartType:o,disabled:a}=e;const s=(0,p().Y$)(),c=(0,i().O7)(),u=(0,i().Fy)(),g=(0,d().YB)(),f=(0,l().Fg)(),[S]=(0,R().o$)(),h=(0,l().yK)((e=>({button:{display:"flex",flexDirection:"column",alignItems:"center",flexGrow:0,flexShrink:0,fontSize:11,borderRadius:6,margin:6,padding:6,boxShadow:`0 0 0 1px ${e.regularDividerColor}`,position:"relative",width:"calc(20% - 12px)",height:0,paddingTop:0,paddingBottom:"calc(20% - 12px)",...u.isMobile?{width:50,height:50,paddingBottom:void 0}:{},...u.isPhone?{background:e.popoverBackground}:{}},selectedButton:{...u.isPhone?{background:e.popoverBackground}:{},boxShadow:`0 0 0 2px ${e.blueColor}`},icon:{width:24,height:24,position:"absolute",top:8,...u.isMobile?{width:30,height:30}:{}},moreIcon:{width:18,height:18,position:"absolute",top:12,...u.isMobile?{width:26,height:26}:{},fill:e.lightIconColor}})),[u]),x=(0,r().VK)((()=>s.normalizedSchemaStore.state),[s]),v=(0,n.useCallback)((e=>{const t=s.collectionViewStore(),o=null==t?void 0:t.getChartConfig();t&&o&&(0,m().N8)(e,o,c,t,s,x)}),[s,c,x]),C="dark"===f.mode?"dark":"light";let b=H[C][t].unselected(h.icon);return t===o&&(b=H[C][t].selected(h.icon)),(0,y.jsx)(F().Z,{placement:K().Placement.Top,alignment:K().Alignment.Center,renderTooltip:e=>g.formatMessage(m().NV[t]),render:e=>(0,n.createElement)(B().Z,{...e,ref:S,key:t,style:{...h.button,...t===o&&h.selectedButton},onClick:()=>{v(t)},disabled:a||t===o,disabledFeedback:a,ariaLabel:g.formatMessage(m().NV[t])},b)})}o(670560),o(267602),o(470928),o(30005);var D=()=>o(820271),E=()=>o(145112),N=()=>o(964120),U=()=>o(332143),z=()=>o(608352),W=()=>o(532850);const q=(0,f().IU)("pieChartSliceBy",{viewBox:"0 0 16 16",svg:(0,y.jsx)("path",{d:"M11.9102 12.8223L7.6377 8.65234C7.56934 8.58854 7.52148 8.52246 7.49414 8.4541C7.4668 8.38574 7.45312 8.30371 7.45312 8.20801V2.08301H8.54688V7.36719L13.0312 4.79688L13.585 5.74707L8.99121 8.37207L12.7373 12.0566L11.9102 12.8223ZM7.99316 15.126C7.02702 15.126 6.11784 14.9414 5.26562 14.5723C4.41341 14.2077 3.66146 13.6995 3.00977 13.0479C2.36263 12.3962 1.85449 11.6442 1.48535 10.792C1.11621 9.93978 0.931641 9.0306 0.931641 8.06445C0.931641 7.09831 1.11621 6.18913 1.48535 5.33691C1.85449 4.4847 2.36263 3.73503 3.00977 3.08789C3.66146 2.4362 4.41113 1.92578 5.25879 1.55664C6.111 1.1875 7.02018 1.00293 7.98633 1.00293C8.95703 1.00293 9.86849 1.1875 10.7207 1.55664C11.5729 1.92578 12.3249 2.4362 12.9766 3.08789C13.6283 3.73503 14.1387 4.4847 14.5078 5.33691C14.877 6.18913 15.0615 7.09831 15.0615 8.06445C15.0615 9.0306 14.877 9.93978 14.5078 10.792C14.1387 11.6442 13.6283 12.3962 12.9766 13.0479C12.3249 13.6995 11.5729 14.2077 10.7207 14.5723C9.86849 14.9414 8.95931 15.126 7.99316 15.126ZM7.99316 13.7314C8.78158 13.7314 9.51758 13.5856 10.2012 13.2939C10.8848 13.0023 11.4863 12.5967 12.0059 12.0771C12.5254 11.5576 12.931 10.9561 13.2227 10.2725C13.5143 9.58887 13.6602 8.85286 13.6602 8.06445C13.6602 7.2806 13.5143 6.54688 13.2227 5.86328C12.931 5.17513 12.5254 4.57129 12.0059 4.05176C11.4863 3.53223 10.8825 3.12663 10.1943 2.83496C9.51074 2.54329 8.77474 2.39746 7.98633 2.39746C7.20247 2.39746 6.46647 2.54329 5.77832 2.83496C5.09473 3.12663 4.49544 3.53223 3.98047 4.05176C3.46549 4.57129 3.06217 5.17513 2.77051 5.86328C2.47884 6.54688 2.33301 7.2806 2.33301 8.06445C2.33301 8.85286 2.47884 9.58887 2.77051 10.2725C3.06217 10.9561 3.46549 11.5576 3.98047 12.0771C4.5 12.5967 5.10156 13.0023 5.78516 13.2939C6.47331 13.5856 7.20931 13.7314 7.99316 13.7314Z"})}),G=(0,f().IU)("pieChartSliceRepresents",{viewBox:"0 0 16 16",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.25 3.39946C3.95441 3.95981 2.25 6.0316 2.25 8.5C2.25 10.2655 3.12025 11.8278 4.46076 12.7815C5.31822 13.3915 6.36539 13.75 7.5 13.75C8.14111 13.75 8.75268 13.6357 9.3173 13.4273C10.9405 12.8284 12.1854 11.4498 12.6005 9.75H8.25C7.14543 9.75 6.25 8.85457 6.25 7.75V3.39946ZM1 8.5C1 5.16337 3.51407 2.41394 6.75126 2.04265C7.16277 1.99546 7.5 2.33578 7.5 2.75V7.75C7.5 8.16421 7.83579 8.5 8.25 8.5H13.25C13.6642 8.5 14.0046 8.837 13.9574 9.24852C13.6742 11.7184 12.0066 13.7674 9.75 14.6C9.0489 14.8587 8.29095 15 7.5 15C6.09723 15 4.79824 14.5556 3.73613 13.8C2.08017 12.6219 1 10.6871 1 8.5Z"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.75 2.39949V6.25H13.6005C13.1378 4.35519 11.6448 2.86215 9.75 2.39949ZM14.9573 6.75126C15.0045 7.16277 14.6642 7.5 14.25 7.5H9.25C8.83579 7.5 8.5 7.16421 8.5 6.75V1.75C8.5 1.33578 8.83723 0.995456 9.24874 1.04265C12.2403 1.38576 14.6142 3.75975 14.9573 6.75126Z"})]})});var Y=()=>o(521913),$=()=>o(513670),Q=()=>o(707513),J=()=>o(250303),X=()=>o(636340),ee=()=>o(269299),te=()=>o(861026),oe=()=>o(593695),ne=(o(653476),o(228244),o.n(o(443261))),ie=()=>o(766933),re=()=>o(628330),le=()=>o(235605),ae=()=>o(827973),se=()=>o(448419),ce=()=>o(838003),de=()=>o(740046),ue=()=>o(198829),pe=()=>o(255577),ge=()=>o(838367),me=()=>o(868744),fe=()=>o(667247),ye=()=>o(347577),Se=()=>o(352230),he=()=>o(164079),xe=()=>o(529048),ve=()=>o(446955);const Ce="search-item",be="default",we="aggregate",je="distinct",_e={main_property:[be],aggregation_property:[be,we,je],y_axis_stacked_groups:[be]},Me=["sum","average","min","max","median"];function ke(e){return"unique"===e||"sum"===e||"average"===e||"min"===e||"max"===e||"median"===e}function Pe(e){switch(e.type){case"none":case"record_count":return e.type;case"property_group":{const t=e.groupByOption??"undefined";return`group:${e.property}-${t}`}case"aggregation":return`aggregation:${e.property}-${e.aggregation??"undefined"}`;default:(0,Z().t1)(e)}}function Te(e){const{collectionContextStore:t,selectedProperty:o,properties:a,callsite:s,handlePropertySelect:c,originProps:p,disabled:g,rightStyle:f,...S}=e,h=(0,i().O7)(),x=(0,i().Fy)(),v=(0,d().YB)(),[C,b]=n.useState(""),w=(0,r().qz)(void 0,xe().Z),j=(0,r().Kw)(w),_=(0,r().VK)((()=>t.normalizedSchemaStore.state),[t]),M=(0,r().VK)((()=>a.length>ye().nt),[a.length]),k=(0,r().VK)((()=>{const e=$().vM(a,(e=>e.sectionName));return _e[s].map((t=>{const o=e[t]??[];return[...o.filter((e=>"none"===e.key.type)),...o.filter((e=>"none"!==e.key.type)).sort(((e,t)=>e.name<t.name?-1:e.name>t.name?1:0))]}))}),[a,s]),P=(0,r().VK)((()=>{if(C.length>0){return k.map((e=>ne().filter(C,e,{extract:e=>e.name}).map((e=>{let{original:t}=e;return t}))))}return k}),[C,k]),T=(0,l().yK)((e=>({propertyIcon:{theme:e,fill:e.regularIconColor}})),[]);function I(){if(!o)return(0,y.jsx)(d()._H,{...m().s8.none});const e=e=>{for(let t=0;t<e.length;t++){const n=e[t];if(Pe(n.key)===Pe(o))return n}},t=e(a);if(t)return"property_group"===t.key.type&&t.sectionName===je?(0,y.jsx)("span",{style:Q().Yu,children:`${t.name} (${(0,m().Hk)({aggregation:{property:t.key.property,aggregator:"unique"},databaseType:void 0,intl:v})})`}):(0,y.jsx)("span",{style:Q().Yu,children:t.name});const n=(t=>{for(let o=0;o<t.length;o++){const n=t[o];if(n.subMenuItems){const t=e(n.subMenuItems);if(t)return{subMenuItem:t,menuItem:n}}}})(a);return n?(0,y.jsx)("span",{style:Q().Yu,children:`${n.menuItem.name} (${n.subMenuItem.name})`}):(0,y.jsx)(d()._H,{...m().s8.none})}function V(e){const{key:t,name:n,subMenuItems:i}=e;let r;if("record_count"===t.type)r=(0,re().k)({width:16,height:16,marginRight:-2});else if("property_group"===t.type){const e=(0,W().Qm)({schema:_,property:t.property});r=e?(0,y.jsx)(ie().ZP,{type:e.type,icon:e.icon,size:16,theme:T.propertyIcon.theme,style:{fill:T.propertyIcon.fill}}):void 0}if(i&&i.length>0){return{key:n,render:(e,t)=>(0,y.jsx)(me().Z,{...e,onFocus:t.onFocus,renderOrigin:(e,t)=>(0,y.jsx)(ae().Z,{...e,ref:t,title:n,icon:r}),renderExtension:(e,o)=>{let n;return n=x.isMobile?{menuType:Se().o.ActionSheet}:{menuType:Se().o.Popup,width:200},(0,y.jsx)(ue().Z,{...n,...e,children:(0,y.jsx)(pe().ZP,{type:pe().iW.Vertical,initialFocus:0,sections:[{key:"results",render:e=>(0,y.jsx)(u().Z,{...e}),items:$().oA(null==i?void 0:i.map(V))}],onAccept:t.onAccept})})}}),action:()=>null}}const l=o&&Pe(o)===Pe(t);let a=n;"aggregation"===t.type&&(a="value"===t.aggregation?v.formatMessage(m().wh.chartAggregateByValues):"unique"===t.aggregation?v.formatMessage(Ie.distinctValues):fe().VN[t.aggregation]);const s={key:n,render:e=>(0,y.jsx)(ae().Z,{...e,title:a,icon:r,right:l?(0,le().k)({width:14,height:14}):void 0}),action:t=>{c(e)}};return s}return(0,y.jsx)(ce().Z,{focused:!1,buttonPopupStore:w,alignmentToOrigin:se().vR.End,placementToOrigin:se().pO.Bottom,popupType:x.isMobile?se().Z4.SlideUp:se().Z4.Popup,onClose:()=>{b((()=>""))},renderOrigin:e=>(0,y.jsx)(ve().Z,{...(0,he().Z)(e,S),showChevron:!0,rotateChevron:j.open,icon:p.icon,title:p.title,right:I(),disabled:g,rightStyle:f}),render:e=>{const t=h.device.isMobile?{menuType:Se().o.ActionSheet}:{menuType:Se().o.Popup,width:250,maxHeight:400},o=[];if(M){const e={key:Ce,items:[{key:Ce,render:(e,t)=>(0,y.jsx)(de().ZP,{...e,value:C,onChange:e=>{b((()=>e.target.value))},focusInitial:!0,placeholder:v.formatMessage({id:"database.viewSettings.ChartSettingsPropertySearchMenuItem.searchPlaceholder",defaultMessage:"Search properties..."})}),action:e=>{}}],showNoResultMessage:!0,render:e=>(0,y.jsx)(u().Z,{isInput:!0,...e})};o.push(e)}if(P.some((e=>e.length>0)))P.forEach((e=>{if(0===e.length)return;const t=e[0].sectionName,n={key:t,items:e.map(V).filter(Z().$K),render:e=>(0,y.jsx)(u().Z,{...e,topBorder:t!==be})};o.push(n)}));else{const e=v.formatMessage(m().wh.noResultsMenuItem),t={key:e,items:[{key:`${e}-item`,action:()=>{},render:e=>(0,y.jsx)(ge().Z,{title:(0,y.jsx)(d()._H,{...m().wh.noResultsMenuItem})})}],render:e=>(0,y.jsx)(u().Z,{...e})};o.push(t)}return(0,y.jsx)(ue().Z,{...t,children:(0,y.jsx)(pe().ZP,{initialFocus:0,type:pe().iW.Vertical,sections:o,onAccept:t=>{t.key!==Ce&&e.close()}})})}})}const Ie=(0,d().vU)({distinctValues:{id:"database.viewSettings.ChartSettingsPropertySearchMenuItem.distinctValues",defaultMessage:"Distinct values"}});function Ve(e){var t;const{environment:o,menuItem:n,chartConfig:i,collectionSchema:r,collectionViewStore:l,collectionContextStore:a,mainPropertyId:c}=e,{key:d,sectionName:u}=n,p=(0,D().ib)({property:c,collectionSchema:r,hideEmptyGroups:"donut"===i.type||Boolean(null===(t=i.chartFormat)||void 0===t?void 0:t.axisHideEmptyGroups)});if(!p)return;let g=(0,$().Xh)(i);const m="groups_reducer"===g.dataConfig.type?g.dataConfig.groupBy:p;if(m){if("property_group"===d.type){if(u!==je)return;"donut"===g.type?g.dataConfig={type:"groups_reducer",groupBy:m,aggregationConfig:{aggregation:{aggregator:"unique",property:d.property}}}:g=(0,E().T9)({chartConfig:g,xAxisPropertyId:c,newDataConfigType:"groups_reducer",groupBy:m,aggregation:{aggregator:"unique",property:d.property}})}"donut"===g.type?"record_count"===d.type?g.dataConfig={type:"groups_reducer",groupBy:m,aggregationConfig:{aggregation:{aggregator:"count"}}}:"aggregation"===d.type&&("value"===d.aggregation?g.dataConfig={type:"results_reducer",nameProperty:c,valueProperty:d.property}:g.dataConfig={type:"groups_reducer",groupBy:m,aggregationConfig:{aggregation:{aggregator:d.aggregation,property:d.property}}}):"record_count"===d.type?g=(0,E().T9)({chartConfig:g,xAxisPropertyId:c,newDataConfigType:"groups_reducer",groupBy:m,aggregation:{aggregator:"count"}}):"aggregation"===d.type&&(g="value"===d.aggregation?(0,E().T9)({chartConfig:g,xAxisPropertyId:c,newDataConfigType:"results_reducer",groupBy:m,valueProperty:d.property}):(0,E().T9)({chartConfig:g,xAxisPropertyId:c,newDataConfigType:"groups_reducer",groupBy:m,aggregation:{aggregator:d.aggregation,property:d.property}})),ee().createAndCommit({userAction:(0,s().u)(g)?"chartSettings.setYAxis":"chartSettings.setDonutSlice",environment:o,canUndo:!0,perform:e=>{X().sW({store:l.getFormatStore().getKeyStore("chart_config"),data:g,transaction:e})}}),J().wd({environment:o,collectionContextStore:a,action:(0,s().u)(g)?"charts_y_axis_what_to_show":"charts_donut_slice_value",charts_analytics_context:(0,te().aL)(a)})}}var Ae=()=>o(691594);function Ze(e){let{chartConfig:t,chartError:o,disabled:s}=e;const c=(0,i().O7)(),u=(0,p().Y$)(),g=(0,d().YB)(),f=(0,l().yK)((e=>({errorIcon:(0,m().FV)(e)})),[]),S=(0,m().kM)(),h=(0,r().VK)((()=>u.collectionViewStore()),[u]),x=(0,r().VK)((()=>u.normalizedSchemaStore.state),[u]),v=(0,r().VK)((()=>null==t?void 0:t.dataConfig),[t]),C=(0,r().VK)((()=>{if("groups_reducer"===(null==v?void 0:v.type)){const e=v.groupBy;return(0,z().TD)(e)||(0,z().ib)(e)?{type:"property_group",property:e.property,groupByOption:e.groupBy}:{type:"property_group",property:v.groupBy.property}}if("results_reducer"===(null==v?void 0:v.type))return{type:"property_group",property:v.nameProperty}}),[v]),b=(0,r().VK)((()=>{const e={icon:q};return o&&(0,a().Ib)(o)?{icon:Y().t,iconStyle:f.errorIcon}:e}),[o,f.errorIcon]),w=(0,r().VK)((()=>{const e=(0,Z().qP)(x),t=[];return e.forEach((e=>{let[o,n]=e;if(n)if((0,z().H1)(n.type))t.push({key:{type:"property_group",property:o},name:n.name,sectionName:be,subMenuItems:z().vu.map((e=>({key:{type:"property_group",property:o,groupByOption:e},name:g.formatMessage(Ae().ci[e]),sectionName:be})))});else if((0,E().f3)(n))t.push({key:{type:"property_group",property:o},name:n.name,sectionName:be,subMenuItems:z().z8.map((e=>({key:{type:"property_group",property:o,groupByOption:e},name:g.formatMessage(Ae().aK[e]),sectionName:be})))});else{if(!(0,z().LG)(n))return;t.push({key:{type:"property_group",property:o},name:n.name,sectionName:be})}})),t}),[x,g]),j=n.useCallback((e=>{var o;const{key:n}=e,{property:i,groupByOption:r}=n;if(!t||!h)return;const l=x[i],a=(0,D().ib)({property:i,collectionSchema:x,hideEmptyGroups:!0});if(!l||!a)return;const s=Object.keys(x),d="results_reducer"===t.dataConfig.type?t.dataConfig.valueProperty:s.find((e=>{const t=x[e];return Boolean(t&&(0,D()._i)(t))})),p={aggregator:"count"},g=$().Xh(t);if(l&&(0,D().HT)(l)&&d)g.dataConfig={type:"results_reducer",nameProperty:i,valueProperty:d};else if(r){const e=(0,E().qV)({property:i,propertySchema:l,groupByOption:r,hideEmptyGroups:!0});e&&(g.dataConfig={type:"groups_reducer",groupBy:e,aggregationConfig:{aggregation:p}})}else if(a){const e="groups_reducer"===t.dataConfig.type?t.dataConfig.aggregationConfig.aggregation:p;g.dataConfig={type:"groups_reducer",groupBy:a,aggregationConfig:{aggregation:e}};const o="formula"===a.type?a.groupBy.sort:a.sort;g.chartFormat={...t.chartFormat,mainSort:l&&(0,N().jn)(l)?N().MN.yDescending:(0,N().H9)(o)}}(0,m().$I)({environment:c,collectionContextStore:u,chartConfig:g,sort:null===(o=g.chartFormat)||void 0===o?void 0:o.mainSort}),ee().createAndCommit({userAction:"chartSettings.setDonutGroupBy",environment:c,canUndo:!0,perform:e=>{X().sW({store:h.getFormatStore().getKeyStore("chart_config"),data:g,transaction:e})}}),J().wd({environment:c,collectionContextStore:u,action:"charts_donut_property",charts_analytics_context:(0,te().aL)(u)})}),[x,h,c,t,u]);return(0,y.jsx)(F().Z,{textWrap:!0,placement:K().Placement.Left,disableTooltip:!o||!(0,a().Ib)(o),renderTooltip:e=>o?(0,y.jsx)("span",{...e,children:(0,oe().e)(o)}):null,render:e=>(0,y.jsx)(Te,{...e,collectionContextStore:u,selectedProperty:C,properties:w,handlePropertySelect:j,originProps:{title:(0,y.jsx)("span",{children:(0,y.jsx)(d()._H,{...m().wh.chartWhatToShow})}),icon:b.icon},callsite:"main_property",disabled:s,rightStyle:S.whatToShowRightText})})}function Be(e){let{chartConfig:t,chartError:o,disabled:s}=e;const c=(0,d().YB)(),u=(0,i().O7)(),g=(0,p().Y$)(),f=(0,l().yK)((e=>({errorIcon:{...(0,m().FV)(e),width:18,height:18,marginLeft:4}})),[]),S=(0,m().kM)(),h=(0,r().VK)((()=>g.collectionViewStore()),[g]),x=(0,r().VK)((()=>g.databaseType),[g]),v=(0,r().VK)((()=>g.normalizedSchemaStore.state),[g]),C=(0,r().VK)((()=>null==t?void 0:t.dataConfig),[t]),b=(0,r().VK)((()=>{if(C)return"groups_reducer"===C.type?C.groupBy.property:C.nameProperty}),[C]),w=(0,r().VK)((()=>b?v[b]:void 0),[b,v]),j=(0,r().VK)((()=>{if(C)if("groups_reducer"===C.type){const e=null==C?void 0:C.aggregationConfig.aggregation;if((0,U().HK)(e))return{type:"record_count"};if(ke(e.aggregator)){const t=(0,W().Qm)({schema:v,property:e.property});if(!t)return;return(0,E().HQ)(t)||"unique"!==e.aggregator?{type:"aggregation",property:e.property,aggregation:e.aggregator}:{type:"property_group",property:e.property}}}else if("results_reducer"===C.type&&C.valueProperty)return{type:"aggregation",property:C.valueProperty,aggregation:"value"}}),[v,C]),_=(0,r().VK)((()=>{if(!C||!w)return[];const e=[];(0,Z().qP)(v).forEach((t=>{let[o,n]=t;if(!n||o===b||!(0,z().LG)(n))return;const i=[];(0,D()._i)(n)&&(0,D().HT)(w)&&i.push({key:{type:"aggregation",property:o,aggregation:"value"},name:c.formatMessage(m().wh.chartAggregateByValues),sectionName:we});const r=(0,E().HQ)(n);if(r){Me.forEach((e=>{const t={aggregator:e,property:o},n={key:{type:"aggregation",property:o,aggregation:e},name:(0,m().Hk)({aggregation:t,databaseType:x,intl:c})||"",sectionName:we};i.push(n)}));const e={key:{type:"aggregation",property:o,aggregation:"unique"},name:(0,m().Hk)({aggregation:{aggregator:"unique",property:o},databaseType:x,intl:c})||"",sectionName:we};i.push(e)}const l={key:{type:"property_group",property:o},name:n.name,sectionName:r?we:je,subMenuItems:i};e.push(l)}));return[{key:{type:"record_count"},name:(0,m().Hk)({aggregation:{aggregator:"count"},databaseType:x,intl:c})||"",sectionName:"default"},...e]}),[C,w,v,x,c,b]),M=(0,r().VK)((()=>o&&(0,a().lY)(o)?()=>(0,Y().t)(f.errorIcon):G),[o,f.errorIcon]),k=n.useCallback((e=>{h&&t&&b&&Ve({environment:u,menuItem:e,chartConfig:t,collectionSchema:v,collectionViewStore:h,collectionContextStore:g,mainPropertyId:b})}),[t,v,h,u,b,g]);return(0,y.jsx)(F().Z,{textWrap:!0,placement:K().Placement.Left,disableTooltip:!o||!(0,a().lY)(o),renderTooltip:e=>o?(0,y.jsx)("span",{...e,children:(0,oe().e)(o)}):null,render:e=>(0,y.jsx)(Te,{...e,collectionContextStore:g,selectedProperty:o?void 0:j,properties:_,handlePropertySelect:k,originProps:{title:(0,y.jsx)("span",{style:Q().Yu,children:(0,y.jsx)(d()._H,{...m().wh.chartSliceDonutAggregation})}),icon:M},callsite:"aggregation_property",disabled:s,rightStyle:S.donutSliceValueRightText})})}var Fe=()=>o(435308),Re=(o(313429),o(398858),o(461318),o(33228),()=>o(714230)),Ke=()=>o(265195),He=()=>o(75468),Oe=()=>o(527278),Le=()=>o(959137),De=()=>o(308186),Ee=()=>o(102182);function Ne(e){return{width:He().rV+He().TZ+He().lM,height:He().b+He().CN+He().lM}}async function Ue(e){const{environment:t,previewCanvas:o,chartStore:n}=e,{chart:i,responsiveChartOptions:r,exportBackgroundColor:l}=n.state;if(o)if("png"===e.format){const c=o.toDataURL("image/png");if("copy"===e.type){const d=await Le().F.clipboardActions.load();async function u(){const e=await fetch(c);return await e.blob()}const p=new ClipboardItem({"image/png":u()});try{await navigator.clipboard.write([p]),Ee().oV({label:Oe().Z.formatMessage(d.clipboardMessages.copiedImageToClipboard)})}catch(s){De().UW(Oe().Z.formatMessage(d.clipboardMessages.copyImageError))}}else if(t.device.isMobileNative){var a;null===(a=t.mobileNative)||void 0===a||a.showLightBoxV2({url:c,downloadName:`${Oe().Z.formatMessage(He().LY.chart)}.png`,type:"image",from:"chart",state:"url_ready"})}else{const g=document.createElement("a");g.href=c,g.download=`${Oe().Z.formatMessage(He().LY.chart)}.png`,g.click()}}else if("svg"===e.format){if("copy"===e.type)return;null==i||i.exportChartLocal({type:"image/svg+xml",filename:Oe().Z.formatMessage(He().LY.chart)},{...(0,He().Yh)(l),...r??{}})}else(0,Z().t1)(e.format)}var ze=()=>o(312578),We=()=>o(470386),qe=()=>o(661297),Ge=()=>o(906651),Ye=()=>o(817870),$e=()=>o(443269),Qe=()=>o(729201),Je=()=>o(356140),Xe=()=>o(815277);const et=290,tt=8,ot=14;const nt=function(e){const t=(0,d().YB)(),n=(0,i().Fy)();return n.isMobile&&n.isAndroid?null:(0,y.jsx)(ce().Z,{focused:!1,popupType:n.isMobile?se().Z4.SlideUp:se().Z4.Popup,placementToOrigin:K().Placement.Top,alignmentToOrigin:K().Alignment.Center,render:e=>(0,y.jsx)(it,{menuParent:e}),renderOrigin:n=>(0,y.jsx)(ve().Z,{...n,showChevron:!0,disabled:e.disabled,title:t.formatMessage(He().LY.exportChart),icon:o(819418).$})})};function it(e){var t;const o=(0,i().O7)(),a=(0,d().YB)(),s=(0,Ye().g)(),c=(0,p().Y$)(),g=(0,Je().W)(),m=(0,Xe().VX)({name:"watermarkless_chart_export",spaceId:g,userId:null===(t=o.currentUser)||void 0===t?void 0:t.id}),f=n.useRef(null),{isLoading:S,hasError:h,exportDisabled:x}=(0,r().VK)((()=>({isLoading:"loading"===s.state.previewCanvasState,hasError:"error"===s.state.previewCanvasState,exportDisabled:"loading"===s.state.previewCanvasState||"error"===s.state.previewCanvasState})),[s]),v=(0,r().VK)((()=>Ke().jl.filter((e=>!(!m&&"none"===e)))),[m]),C=(0,l().yK)((e=>{const t=o.device.isMobile;return{copyButton:{height:t?36:32,fontSize:t?16:14},downloadButton:{height:t?36:32,fontSize:t?16:14,display:"flex",justifyContent:"center",marginTop:8,background:e.contentBackground}}}),[o]),b=o.device.isMobile?{menuType:Se().o.Modal,title:a.formatMessage(He().LY.exportChart),right:(0,y.jsx)(We().DoneMenuText,{}),onClickRight:e.menuParent.close}:{menuType:Se().o.Popup,width:et},w=[{key:"preview",render:e=>(0,y.jsx)(rt,{...e,previewCanvasRef:f,isLoading:S,hasError:h}),items:[]},{key:"background",render:e=>(0,y.jsx)(u().Z,{...e,title:a.formatMessage(He().LY.exportChartBackground),mobileTitleStyle:{lineHeight:void 0},disableMobileBorders:!0,children:(0,y.jsx)("div",{style:{display:"flex",justifyContent:"space-between",paddingLeft:ot+3,paddingRight:ot+3,paddingTop:tt,paddingBottom:tt},children:e.children})}),items:v.map((e=>({key:e,render:t=>(0,y.jsx)(at,{menuListItemProps:t,disabled:x,colors:v,color:e}),action:()=>{s.setState({...s.state,exportBackgroundColor:e})}})))},{key:"export",render:e=>(0,y.jsx)(u().Z,{...e,topBorder:!0,disableMobileBorders:!0,children:(0,y.jsx)("div",{style:{display:"flex",flexDirection:"column",padding:"8px 14px",paddingTop:8},children:e.children})}),items:[{key:"copyPng",render:e=>(0,y.jsx)(Ge().Z,{...e,style:C.copyButton,disabled:x,children:a.formatMessage(He().LY.copyPng)}),action:async()=>{await Ue({environment:o,previewCanvas:f.current,chartStore:s,type:"copy",format:"png"}),J().wd({environment:o,collectionContextStore:c,action:"charts_export_copy_png",charts_analytics_context:(0,te().aL)(c)})}},{key:"downloadPng",render:e=>(0,y.jsx)(qe().Z,{...e,style:C.downloadButton,disabled:x,disabledFeedback:x,children:a.formatMessage(He().LY.downloadPng)}),action:async()=>{await Ue({environment:o,previewCanvas:f.current,chartStore:s,type:"download",format:"png"}),J().wd({environment:o,collectionContextStore:c,action:"charts_export_download_png",charts_analytics_context:(0,te().aL)(c)})}},{key:"downloadSvg",render:e=>o.device.isMobile?null:(0,y.jsx)(qe().Z,{...e,style:C.downloadButton,disabled:x,disabledFeedback:x,children:a.formatMessage(He().LY.downloadSvg)}),action:async()=>{await Ue({environment:o,previewCanvas:f.current,chartStore:s,type:"download",format:"svg"})}}]}];return(0,y.jsx)(ue().Z,{...b,children:(0,y.jsx)(pe().ZP,{initialFocus:0,type:pe().iW.Vertical,sections:w})})}function rt(e){const t=(0,d().YB)(),o=(0,l().Fg)(),i=(0,Ye().g)(),a=(0,r().VK)((()=>i.state.exportBackgroundColor),[i]),s=(0,Qe().Z)(!0,He().QG,0,!1);n.useEffect((()=>{const t=new(Fe().default)((()=>({chart:i.state.chart,exportBackgroundColor:i.state.exportBackgroundColor,responsiveChartOptions:i.state.responsiveChartOptions})),{debugName:"chartDrawingStateStore"});function n(){const n=e.previewCanvasRef.current;n&&function(e,t,o,n){const{chart:i,responsiveChartOptions:r,exportBackgroundColor:l}=t;o((()=>{}));const a=e.getContext("2d");if(!i||!a)return;let s;setTimeout((()=>{o((e=>void 0===e?"loading":e))}),He().QG);try{s=i.getSVG({...(0,He().Yh)(l),...r??{}})}catch(S){return console.error(S),void o((()=>"error"))}const c=new Blob([s],{type:"image/svg+xml;charset=utf-8"}),d=URL.createObjectURL(c),u=new Image,p=new Image,g=new Image,m=new Promise(((e,t)=>{"gradient"===l?(u.onload=()=>e(u),u.onerror=()=>t(new Error("Failed to load gradient image")),u.src="light"===n.mode?Re().Z.images.charts.chartsExportGradientLightPng:Re().Z.images.charts.chartsExportGradientDarkPng):e(u)})),f=new Promise(((e,t)=>{p.onload=()=>e(p),p.onerror=()=>t(new Error("Failed to load chart image")),p.src=`data:image/svg+xml;charset=utf-8;base64,${btoa(unescape(encodeURIComponent(s)))}`})),y=new Promise(((e,t)=>{g.onload=()=>e(g),g.onerror=()=>t(new Error("Failed to load chart image")),g.src="light"===n.mode?Re().Z.images.charts.chartsExportLogoLightPng:Re().Z.images.charts.chartsExportLogoDarkPng}));Promise.all([m,f,y]).then((t=>{let[i,r,s]=t;URL.revokeObjectURL(d);const c=Ne();if(e.width=c.width*He().FZ,e.height=c.height*He().FZ,a.scale(He().FZ,He().FZ),"gradient"===l?a.drawImage(i,0,0,e.width,e.height):"none"===l?(a.fillStyle=n.contentBackground,a.fillRect(0,0,e.width,e.height)):(a.fillStyle=(0,Ke().Ns)(n,l,!1),a.fillRect(0,0,e.width,e.height)),"none"!==l&&(a.strokeStyle=n.regularDividerColor,a.fillStyle=n.contentBackground,a.shadowColor="dark"===n.mode?"rgba(0, 0, 0, 0.25)":"rgba(0, 0, 0, 0.07)",a.shadowBlur=24,a.shadowOffsetY=8,a.beginPath(),a.roundRect(He().C_,He().qM,e.width/He().FZ-He().TZ,e.height/He().FZ-He().CN,12),a.stroke(),a.fill(),a.shadowColor="transparent"),"none"!==l){const e=Oe().Z.formatMessage(He().LY.madeWithNotion);a.font=`14px ${Q().Gl.sans}`;const t=c.width/2+He().VD+He().nZ,o=c.height-He().qM/2;a.textAlign="center",a.textBaseline="middle",a.fillStyle=n.lightTextColor,a.fillText(e,t,o);const i=a.measureText(e),r=c.width/2-i.width/2,l=o-He().nZ/2;a.drawImage(s,0,0,s.width,s.height,r,l,He().nZ,He().nZ)}"none"===l?a.drawImage(r,He().y9,He().y9):a.drawImage(r,He().C_+He().y9,He().qM+He().y9),o((()=>"success"))})).catch((()=>{o((()=>"error"))}))}(n,t.state,i.updatePreviewState,o)}return n(),t.addListener(n),()=>{t.removeListener(n)}}),[e.previewCanvasRef,i,o]);const c=(0,l().yK)((t=>{const o=et-2*ot,n=Ne(),i=o*(n.height/n.width);return{container:{width:`calc(100% - ${2*ot})`,height:e.isLoading||e.hasError?i:void 0,display:"flex",alignItems:"center",justifyContent:"center",marginTop:tt,marginLeft:ot,marginRight:ot,border:`1px solid ${t.regularDividerColor}`,borderRadius:6,fontSize:12,color:t.lightTextColor},canvas:{width:"100%",borderRadius:6,display:e.isLoading||e.hasError?"none":"block"}}}),[e.hasError,e.isLoading,a]);return(0,y.jsx)(u().Z,{title:t.formatMessage(He().LY.exportChartPreview),disableMobileBorders:!0,mobileTitleStyle:{lineHeight:void 0},children:(0,y.jsxs)("div",{style:c.container,children:[(0,y.jsx)("canvas",{style:c.canvas,ref:e.previewCanvasRef}),s&&e.isLoading&&(0,y.jsx)(ze().Z,{}),e.hasError&&(0,y.jsx)("span",{children:t.formatMessage($e().Gk.generic_error)})]})})}const lt=10;function at(e){const t=(0,d().YB)(),o=(0,Ye().g)(),n=(0,i().Fy)(),a=(0,r().VK)((()=>e.color===o.state.exportBackgroundColor),[o,e.color]),s=(0,l().yK)((t=>({button:{position:"relative",width:`calc((100%  / ${e.colors.length}) - ${lt}px)`,height:n.isMobile?36:28,borderRadius:4,boxShadow:`0 0 0 2px ${t.popoverBackground}, 0 0 0 3px ${t.regularDividerColor}`,background:(0,Ke().Ns)(t,e.color,!1)},selectedButton:{boxShadow:`0 0 0 2px ${t.popoverBackground}, 0 0 0 4px ${t.blueColor}`},hoveredStyle:{background:(0,Ke().Ns)(t,e.color,!0)},pressedStyle:{background:(0,Ke().Ns)(t,e.color,!1)}})),[n.isMobile,e.color,e.colors.length]);return(0,y.jsx)(B().Z,{...e.menuListItemProps,style:{...s.button,...a?s.selectedButton:{}},hoveredStyle:s.hoveredStyle,pressedStyle:s.pressedStyle,ariaLabel:t.formatMessage((0,Ke().jr)(e.color)),disabled:e.disabled,disabledFeedback:e.disabled})}var st=()=>o(263184),ct=()=>o(120793),dt=()=>o(834458),ut=()=>o(689271),pt=()=>o(237789),gt=()=>o(139224),mt=()=>o(662753),ft=()=>o(615719),yt=()=>o(629352),St=()=>o(263483),ht=()=>o(132258);const xt=(0,d().vU)({alphabetical:{defaultMessage:"{propertyName} A → Z",id:"charts.settings.sort.alphabetical"},reverseAlphabetical:{defaultMessage:"{propertyName} Z → A",id:"charts.settings.sort.reverseAlphabetical"},chronological:{defaultMessage:"Old → New",id:"charts.settings.sort.chronological"},reverseChronological:{defaultMessage:"New → Old",id:"charts.settings.sort.reverseChronological"},lowHigh:{defaultMessage:"{propertyName} Low → High",id:"charts.settings.sort.lowHigh"},highLow:{defaultMessage:"{propertyName} High → Low",id:"charts.settings.sort.highLow"},ascending:{defaultMessage:"{propertyName} Ascending",id:"charts.settings.sort.ascending"},descending:{defaultMessage:"{propertyName} Descending",id:"charts.settings.sort.descending"},manual:{defaultMessage:"Manual",id:"charts.settings.sort.manual"},advanced:{defaultMessage:"Advanced",id:"charts.settings.sort.advanced"}});function vt(e,t){const o=null==e?void 0:e.type;if(!o)return t?xt.ascending:xt.descending;if(t)switch(o){case"formula":switch((0,dt().getFormulaPropertySchemaResultType)(e)){case"date":return xt.chronological;case"text":return xt.alphabetical;case"number":return xt.lowHigh;default:return xt.ascending}case"title":case"text":case"url":case"email":case"phone_number":case"relation":case"created_by":case"last_edited_by":return xt.alphabetical;case"date":case"created_time":case"last_edited_time":case"last_visited_time":return xt.chronological;case"number":return xt.lowHigh;default:return xt.ascending}switch(o){case"formula":switch((0,dt().getFormulaPropertySchemaResultType)(e)){case"date":return xt.reverseChronological;case"text":return xt.reverseAlphabetical;case"number":return xt.highLow;default:return xt.descending}case"title":case"text":case"url":case"email":case"phone_number":case"relation":case"created_by":case"last_edited_by":return xt.reverseAlphabetical;case"date":case"created_time":case"last_edited_time":case"last_visited_time":return xt.reverseChronological;case"number":return xt.highLow;default:return xt.descending}}var Ct=()=>o(95804),bt=()=>o(329437),wt=()=>o(508858);function jt(e){let{chartConfig:t,chartError:o,disabled:l,sortType:a}=e;const c=(0,i().O7)(),u=(0,p().Y$)(),g=(0,d().YB)(),f=(0,yt().x)({chartConfig:t,chartError:o,collectionContextStore:u}),{collectionViewStore:S,databaseType:h,collectionSettingsStore:x,numberOfSorts:v}=(0,r().VK)((()=>({collectionViewStore:u.collectionViewStore(),databaseType:u.databaseType,collectionSettingsStore:u.settingsStore,numberOfSorts:u.currentSortsStore.state.length})),[u]),C=(0,r().VK)((()=>u.normalizedSchemaStore.state),[u.normalizedSchemaStore]),b=(0,m().y6)(t,C),{stackedPropertySchema:w,stackedGroupBy:j}=(0,r().VK)((()=>{var e;if("results_reducer"===(null==t?void 0:t.dataConfig.type)||"donut"===(null==t?void 0:t.type))return{stackedPropertySchema:void 0,stackedGroupBy:void 0};const o=null==t||null===(e=t.dataConfig.aggregationConfig.stackOptions)||void 0===e?void 0:e.groupBy,n=null==o?void 0:o.property;return n?{stackedPropertySchema:(0,W().Qm)({schema:C,property:n}),stackedGroupBy:o}:{stackedPropertySchema:void 0,stackedGroupBy:void 0}}),[t,C]),_=(0,r().VK)((()=>"stacked"===a?w:b),[b,a,w]),M=(0,r().VK)((()=>!_||"formula"!==_.type||(0,E().OY)(_)),[_]),k=(0,r().VK)((()=>{var e,o;if(null!=t&&null!==(e=t.chartFormat)&&void 0!==e&&e.mainSort&&"main"===a)return t.chartFormat.mainSort;if("groups_reducer"===(null==t||null===(o=t.dataConfig)||void 0===o?void 0:o.type)){var n;const e="stacked"===a&&j?j:null==t||null===(n=t.dataConfig)||void 0===n?void 0:n.groupBy,o=(0,z().mu)(e);return"formula"===e.type&&"formula"===(null==b?void 0:b.type)?(0,E().OY)(b)||(0,E().OY)(b)?(0,N().H9)(o):E().v6[a]:(0,N().H9)(o)}return E().v6[a]}),[t,b,a,j]),P=(0,m().DN)(t,C),T=(0,r().VK)((()=>{var e;if("groups_reducer"===(null==t||null===(e=t.dataConfig)||void 0===e?void 0:e.type)){const e=null==t?void 0:t.dataConfig.aggregationConfig.aggregation;return(0,m().Hk)({aggregation:e,databaseType:h,intl:g})}return null==P?void 0:P.name}),[t,h,g,P]),I=(0,m().kM)(),V=n.useCallback(((e,o)=>{if(!(S&&t&&b&&M))return;const n=$().Xh(t);if("stacked"===a&&"groups_reducer"===n.dataConfig.type&&(0,s().u)(n)){var i;const t=null===(i=n.dataConfig.aggregationConfig.stackOptions)||void 0===i?void 0:i.groupBy;t&&("formula"===t.type?t.groupBy.sort=Mt(e,t.groupBy.type):t.sort=Mt(e,t.type))}if("main"===a&&(n.chartFormat={...n.chartFormat,mainSort:e},"groups_reducer"===n.dataConfig.type&&n.dataConfig.groupBy)){const t=n.dataConfig.groupBy;"formula"===t.type?t.groupBy.sort=Mt(e,t.groupBy.type):t.sort=Mt(e,t.type)}(0,m().$I)({environment:c,collectionContextStore:u,chartConfig:n,sort:e}),ee().createAndCommit({userAction:"chartSettings.setMainSort",environment:c,canUndo:!0,perform:e=>{X().sW({store:S.getFormatStore().getKeyStore("chart_config"),data:n,transaction:e})}}),J().wd({environment:c,collectionContextStore:u,action:"charts_x_axis_sort",charts_analytics_context:(0,te().aL)(u)}),e!==N().MN.manual&&o&&o.close(),e===N().MN.resultsAdvanced&&(0===v?gt().H4({collectionSettingsStore:x,item:{type:"createSort"}}):gt().H4({collectionSettingsStore:x,item:{type:"sort"}}))}),[S,t,b,M,a,c,u,v,x]);if(!M||!_)return null;const A=[];A.push({key:N().MN.xAscending,type:"button",title:g.formatMessage(vt(_,!0),{propertyName:_.name})}),A.push({key:N().MN.xDescending,type:"button",title:g.formatMessage(vt(_,!1),{propertyName:_.name})});const Z=[];Z.push({key:N().MN.yAscending,type:"button",title:g.formatMessage(xt.lowHigh,{propertyName:T})}),Z.push({key:N().MN.yDescending,type:"button",title:g.formatMessage(xt.highLow,{propertyName:T})});const B=[];"groups_reducer"===(null==t?void 0:t.dataConfig.type)&&null!=_&&_.type&&(0,m().iT)(_)&&B.push({key:N().MN.manual,type:"button",title:g.formatMessage(xt.manual)});return!("checkbox"===(null==_?void 0:_.type)||"person"===(null==_?void 0:_.type)||"formula"===(null==_?void 0:_.type)&&("checkbox"===(0,dt().getFormulaPropertySchemaResultType)(_)||"person"===(0,dt().getFormulaPropertySchemaResultType)(_)))&&B.push(...A),"stacked"!==a&&(0,N().jn)(_)&&B.push(...Z),"results_reducer"===(null==t?void 0:t.dataConfig.type)&&B.push({key:N().MN.resultsAdvanced,type:"button",title:g.formatMessage(xt.advanced)}),(0,y.jsx)(wt().Z,{title:(0,y.jsx)(d()._H,{...m().wh.chartSortBy}),selectedKey:k,options:B,icon:"main"===a?ut().O:pt().T,onChange:V,disabled:l,disableParentClose:!0,rightStyle:I.sortByRightText,children:f&&t&&(0,y.jsx)(_t,{groupedChartReducer:f,sortType:a,chartConfig:t})})}function _t(e){let{groupedChartReducer:t,sortType:o,chartConfig:n}=e;const i=(0,p().Y$)(),l=(0,r().VK)((()=>{var e;return null===(e=n.chartFormat)||void 0===e?void 0:e.mainSort}),[n]),a=(0,r().VK)((()=>{const e=i.normalizedFormatStore.state;return(0,z().b7)(e,"chart_config","stacked"===o?"chart_subgroups":"collection_groups")}),[o,i]),c=(0,r().VK)((()=>"main"===o?(0,St().WT)():(0,St().K9)()),[o]),d=(0,r().VK)((()=>st().default.createClass(c,{name:"GroupsLimitStore"})),[c]),u=(0,r().qz)(void 0,d),g=(0,r().VK)((()=>(0,ht().q)()),[]),m=(0,mt().Z)({id:ct().FW,reducer:t,collectionContextStore:i,debounceWait:g}),f=(0,r().VK)((()=>{var e;if(!m||!(0,s().u)(n)||"groups_reducer"!==n.dataConfig.type)return!1;const t=(0,ft().VB)({groupedDataConfig:n.dataConfig,hideEmptyGroups:Boolean(null===(e=n.chartFormat)||void 0===e?void 0:e.axisHideEmptyGroups),mainSort:l});return"datetime"===t||"linear"===t}),[m,n,l]),S=(0,r().VK)((()=>{if(m&&("main"!==o||"manual"!==l))return(0,ft().P3)({chartConfig:n,sortType:o,groupedChartReducerResults:m})}),[m,o,l,n]),[h,x]=(0,Ct().P)({collectionContextStore:i,groupBy:a,groupsFormatKey:"stacked"===o?"chart_subgroups":"collection_groups",reducerResult:m,groupsLimit:c,renderGroupsFromAggregationArgs:S,removeUncategorized:f}),v=(0,r().VK)((()=>{const e=a?(0,z().mu)(a):void 0;return"manual"!==(null==e?void 0:e.type)||"main"===o&&("y-ascending"===l||"y-descending"===l)}),[l,a,o]);return"v2"===h.version&&a?(0,y.jsx)(bt().l,{collectionContextStore:i,groupBy:a,groupByKey:"chart_config",groupsFormatKey:"stacked"===o?"chart_subgroups":"collection_groups",groupsDisplayState:h,disableReorder:v}):(0,y.jsx)(Ae().y3,{collectionContextStore:i,groupsFormatKey:"stacked"===o?"chart_subgroups":"collection_groups",groupByKey:"chart_config",groupsLimitStore:u,groupsDisplayState:h,disableHideAll:!0,disableLoadMore:!0,disableReorder:v})}function Mt(e,t){switch(e){case N().MN.manual:return{type:"manual"};case N().MN.xAscending:return{type:"ascending"};case N().MN.xDescending:return{type:"descending"};case N().MN.yAscending:case N().MN.yDescending:default:return(0,z().A1)(t)||"number"===t?{type:"ascending"}:{type:"manual"}}}var kt=()=>o(176796);const Pt=(0,f().IU)("chartAxisName",{viewBox:"0 0 20 20",svg:(0,y.jsx)("g",{children:(0,y.jsx)("path",{d:"M2.71 12.742c-.417 0-.786-.078-1.106-.234a1.833 1.833 0 01-.756-.662 1.8 1.8 0 01-.276-.996c0-.555.205-.996.616-1.325.414-.332 1.001-.517 1.763-.556l1.817-.106v-.48c0-.383-.122-.684-.364-.903-.238-.222-.566-.334-.984-.334-.352 0-.647.075-.885.223-.234.149-.435.381-.603.697a.613.613 0 01-.217.2.61.61 0 01-.287.064.562.562 0 01-.387-.135.481.481 0 01-.146-.363c0-.066.007-.133.023-.2A1.53 1.53 0 011 7.422c.164-.379.467-.682.908-.908.442-.227.957-.34 1.547-.34.516 0 .961.088 1.336.263.379.176.67.422.873.739.207.316.31.69.31 1.119v3.838c0 .195-.054.348-.163.457a.57.57 0 01-.422.158.595.595 0 01-.422-.152.562.562 0 01-.164-.41v-.657h-.03a1.92 1.92 0 01-.498.65 2.32 2.32 0 01-.72.417c-.27.097-.551.146-.844.146zm.33-.932c.32 0 .608-.068.866-.205.262-.136.47-.32.627-.55.156-.235.235-.496.235-.785v-.592l-1.653.111c-.418.027-.74.133-.967.316a.855.855 0 00-.34.704c0 .3.114.543.34.726.23.184.528.275.891.275zm4.651.932a.578.578 0 01-.427-.158c-.106-.105-.159-.254-.159-.445V4.627a.63.63 0 01.165-.457.591.591 0 01.445-.176c.18 0 .324.059.433.176.114.113.17.266.17.457v2.889h.036c.18-.41.45-.735.814-.973a2.263 2.263 0 011.26-.357c.539 0 1.007.134 1.406.404.398.265.707.644.926 1.137.219.492.328 1.072.328 1.74 0 .668-.11 1.248-.328 1.74-.215.492-.524.871-.926 1.137-.402.265-.873.398-1.412.398-.488 0-.914-.117-1.277-.351a2.266 2.266 0 01-.827-.967h-.023v.715a.59.59 0 01-.17.445.598.598 0 01-.434.158zm2.403-1.002c.355 0 .664-.092.926-.275a1.75 1.75 0 00.603-.785c.14-.34.211-.744.211-1.213 0-.461-.072-.862-.217-1.201a1.743 1.743 0 00-.603-.786 1.522 1.522 0 00-.92-.28c-.348 0-.655.093-.92.28a1.878 1.878 0 00-.627.797c-.149.34-.223.737-.223 1.19 0 .46.074.861.223 1.201.152.34.361.604.627.791.265.188.572.281.92.281zm6.68 1.002c-.61 0-1.141-.133-1.594-.398a2.721 2.721 0 01-1.05-1.131c-.245-.492-.368-1.074-.368-1.746 0-.668.123-1.248.369-1.74a2.719 2.719 0 011.037-1.149c.45-.273.979-.41 1.588-.41.414 0 .795.068 1.142.205.352.137.653.324.903.563.25.238.426.507.527.808a.73.73 0 01.041.152c.012.051.018.1.018.147a.47.47 0 01-.147.363.547.547 0 01-.375.13.56.56 0 01-.316-.083.865.865 0 01-.235-.287c-.156-.332-.363-.582-.62-.75a1.608 1.608 0 00-.909-.252c-.535 0-.965.207-1.289.621-.324.41-.486.969-.486 1.676 0 .71.162 1.271.486 1.682.324.406.754.609 1.29.609.37 0 .683-.084.937-.252a1.77 1.77 0 00.603-.727.944.944 0 01.235-.298.539.539 0 01.334-.094.504.504 0 01.515.504.81.81 0 01-.017.158c-.012.055-.03.113-.053.176-.117.297-.303.56-.557.79-.254.231-.555.41-.902.54a3.129 3.129 0 01-1.108.193zM1.345 16.434a.718.718 0 01-.528-.217.721.721 0 01-.21-.522.721.721 0 01.738-.732.72.72 0 01.521.21.711.711 0 01.217.522.711.711 0 01-.217.522.711.711 0 01-.521.217zm2.888 0a.718.718 0 01-.527-.217.711.711 0 01-.217-.522.73.73 0 01.744-.732c.204 0 .375.07.516.21a.711.711 0 01.217.522.711.711 0 01-.217.522.692.692 0 01-.516.217zm2.883 0a.718.718 0 01-.527-.217.711.711 0 01-.217-.522.729.729 0 01.744-.732c.203 0 .375.07.516.21a.711.711 0 01.217.522.711.711 0 01-.217.522.692.692 0 01-.516.217zm2.883 0a.718.718 0 01-.527-.217.721.721 0 01-.211-.522.721.721 0 01.738-.732.72.72 0 01.521.21.711.711 0 01.217.522.711.711 0 01-.216.522.711.711 0 01-.522.217zm2.883 0a.711.711 0 01-.522-.217.711.711 0 01-.216-.522.71.71 0 01.216-.521.721.721 0 01.522-.211.72.72 0 01.521.21.711.711 0 01.217.522.711.711 0 01-.217.522.711.711 0 01-.521.217zm2.889 0a.718.718 0 01-.528-.217.711.711 0 01-.217-.522.728.728 0 01.744-.732c.2 0 .372.07.516.21a.711.711 0 01.217.522.711.711 0 01-.217.522.704.704 0 01-.515.217zm2.882 0a.73.73 0 01-.527-.217.71.71 0 01-.217-.522.71.71 0 01.217-.521.74.74 0 01.527-.211c.203 0 .375.07.516.21a.71.71 0 01.217.522.71.71 0 01-.217.522.692.692 0 01-.516.217z"})})}),Tt=(0,f().IU)("chartGradientArea",{viewBox:"0 0 16 16",svg:(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.5085 2.89074C13.3432 2.05604 14.7705 2.64721 14.7705 3.82766V11.4739C14.7705 12.2057 14.1772 12.7989 13.4455 12.7989H2.52495C1.79317 12.7989 1.19995 12.2057 1.19995 11.4739L1.19995 8.34731C1.19995 7.9959 1.33955 7.65888 1.58804 7.41039L4.65782 4.34061C5.17527 3.82316 6.01421 3.82316 6.53165 4.34061L8.67142 6.48037C8.73976 6.54871 8.85056 6.54871 8.91891 6.48037L12.5085 2.89074ZM13.6205 3.82766C13.6205 3.67175 13.432 3.59367 13.3217 3.70391L9.73208 7.29354C9.21463 7.81099 8.37569 7.81099 7.85824 7.29354L5.71848 5.15378C5.65014 5.08544 5.53933 5.08544 5.47099 5.15378L2.40121 8.22356C2.36839 8.25638 2.34995 8.3009 2.34995 8.34731L2.34995 11.4739C2.34995 11.5706 2.4283 11.6489 2.52495 11.6489H13.4455C13.5421 11.6489 13.6205 11.5706 13.6205 11.4739L13.6205 3.82766Z"})}),It=(0,f().IU)("chartGridLine",{viewBox:"0 0 20 20",svg:(0,y.jsxs)("g",{children:[(0,y.jsx)("circle",{cx:"4",cy:"10",r:"1"}),(0,y.jsx)("circle",{cx:"8",cy:"10",r:"1"}),(0,y.jsx)("circle",{cx:"12",cy:"10",r:"1"}),(0,y.jsx)("circle",{cx:"16",cy:"10",r:"1"})]})}),Vt=(0,f().IU)("chartSmoothLine",{viewBox:"0 0 16 16",svg:(0,y.jsx)("path",{fillRule:"evenodd",d:"M14.134 3.262a.75.75 0 01.604.872c-.256 1.41-.611 2.74-1.047 3.857-.429 1.1-.963 2.066-1.615 2.68-.332.313-.726.564-1.183.663-.47.103-.943.03-1.387-.2C8.67 10.7 7.957 9.718 7.317 8.31c-.61-1.342-1.147-1.922-1.514-2.113a.53.53 0 00-.376-.066c-.116.026-.277.103-.475.29-.411.386-.846 1.107-1.245 2.133-.393 1.007-.725 2.24-.97 3.58a.75.75 0 11-1.475-.268c.256-1.41.612-2.74 1.047-3.857.429-1.1.962-2.066 1.614-2.68.333-.313.727-.564 1.184-.663.47-.103.943-.03 1.387.2.836.434 1.549 1.416 2.189 2.824.61 1.342 1.147 1.922 1.514 2.113a.53.53 0 00.376.066c.116-.025.277-.103.476-.29.41-.386.845-1.107 1.244-2.133.393-1.007.726-2.24.97-3.58a.75.75 0 01.871-.604z",clipRule:"evenodd"})});var At=()=>o(933110);const Zt=(0,f().IU)("collectionChartStyle",{viewBox:"0 0 16 16",svg:(0,y.jsx)("path",{d:"M1.8491 15.1243C1.28739 14.5494 1.00437 13.9414 1.00005 13.3001C0.995729 12.6589 1.27011 12.0552 1.82318 11.4892C2.0133 11.2946 2.25527 11.0978 2.54909 10.8988C2.84723 10.6998 3.15833 10.5052 3.4824 10.3151C3.80646 10.1205 4.11325 9.93474 4.40274 9.75785C4.69656 9.58095 4.93637 9.41512 5.12217 9.26034L3.76758 7.88057C3.49536 7.60197 3.35709 7.30567 3.35277 6.99169C3.35277 6.67328 3.48672 6.37698 3.75461 6.1028L4.60367 5.23381C4.87156 4.95963 5.1589 4.82475 5.46568 4.82917C5.77679 4.82917 6.06844 4.96847 6.34066 5.24708L11.4933 10.534C11.7698 10.8126 11.9081 11.1089 11.9081 11.4228C11.9124 11.7324 11.7828 12.0265 11.5192 12.3051L10.6637 13.1807C10.4001 13.4505 10.1128 13.5832 9.80169 13.5787C9.49058 13.5787 9.20109 13.4394 8.93319 13.1608L7.58507 11.7744C7.42952 11.9646 7.26533 12.2078 7.09249 12.5041C6.91966 12.8004 6.73818 13.1166 6.54806 13.4527C6.36226 13.7888 6.17215 14.1072 5.97771 14.4079C5.78759 14.7131 5.59531 14.9629 5.40087 15.1575C4.8478 15.7236 4.258 16.0044 3.63147 15.9999C3.00494 15.9955 2.41082 15.7037 1.8491 15.1243ZM4.79811 6.82585C4.64255 6.98063 4.64255 7.13762 4.79811 7.29683L6.36659 8.89549C6.50053 9.02816 6.56103 9.17852 6.54806 9.34657C6.5351 9.51462 6.45732 9.67603 6.31474 9.83081C6.18943 9.96348 5.97987 10.1161 5.68605 10.2885C5.39223 10.461 5.05952 10.6534 4.68792 10.8656C4.32065 11.0779 3.95553 11.3057 3.59258 11.5489C3.22963 11.7921 2.92068 12.0442 2.66575 12.3051C2.36761 12.6058 2.21854 12.9309 2.21854 13.2802C2.22286 13.6296 2.37625 13.9613 2.67871 14.2752C2.9855 14.5848 3.3074 14.7396 3.64443 14.7396C3.98578 14.744 4.30553 14.5937 4.60367 14.2885C4.86292 14.0276 5.10921 13.7114 5.34254 13.3399C5.58019 12.9684 5.80271 12.5948 6.01011 12.2189C6.21752 11.8385 6.40547 11.5002 6.57399 11.2039C6.74682 10.9032 6.89589 10.6887 7.0212 10.5605C7.17243 10.4101 7.33014 10.3305 7.49434 10.3217C7.65853 10.3084 7.8076 10.3703 7.94155 10.5074L9.49707 12.1061C9.65262 12.2697 9.80601 12.2675 9.95724 12.0995L10.4498 11.5953C10.6011 11.4361 10.6032 11.2791 10.4563 11.1243L5.75086 6.31507C5.68173 6.23989 5.60827 6.20451 5.5305 6.20894C5.45272 6.20894 5.3771 6.24652 5.30365 6.3217L4.79811 6.82585ZM3.62499 14.1094C3.41326 14.1094 3.23179 14.032 3.08055 13.8772C2.92932 13.7225 2.85371 13.5367 2.85371 13.32C2.85371 13.1033 2.92932 12.9176 3.08055 12.7628C3.23179 12.608 3.41326 12.5306 3.62499 12.5306C3.83671 12.5306 4.01819 12.608 4.16942 12.7628C4.32065 12.9176 4.39626 13.1033 4.39626 13.32C4.39626 13.5367 4.32065 13.7225 4.16942 13.8772C4.01819 14.032 3.83671 14.1094 3.62499 14.1094ZM11.3183 11.3233L10.4757 10.4676L13.5284 7.34326C13.6494 7.21944 13.7099 7.08234 13.7099 6.93198C13.7099 6.78163 13.643 6.6379 13.509 6.50081L8.69338 1.57877C8.62857 1.51243 8.56159 1.47705 8.49246 1.47263C8.42765 1.46821 8.36715 1.49032 8.31098 1.53897C8.25913 1.58319 8.22024 1.65616 8.19432 1.75787C8.03877 2.34162 7.90698 2.84134 7.79896 3.25704C7.69094 3.67274 7.57859 4.04642 7.46193 4.3781C7.34527 4.70977 7.1962 5.03702 7.01472 5.35985C6.83756 5.67826 6.59775 6.03646 6.29529 6.43447L5.43976 5.55885C5.64284 5.26698 5.80919 5.01491 5.93882 4.80264C6.07277 4.58594 6.18511 4.37367 6.27585 4.16582C6.36659 3.95355 6.44868 3.71696 6.52214 3.45604C6.59991 3.1907 6.68201 2.8723 6.76843 2.50082C6.85485 2.12492 6.96071 1.66058 7.08601 1.10779C7.15083 0.82034 7.26749 0.588168 7.436 0.411276C7.60452 0.229961 7.79896 0.108347 8.01932 0.0464343C8.24401 -0.0154781 8.47086 -0.0154781 8.69986 0.0464343C8.92887 0.103924 9.13627 0.225538 9.32207 0.411276L14.4164 5.63182C14.8009 6.02983 14.9954 6.44774 14.9997 6.88555C15.0084 7.32336 14.8247 7.73464 14.4488 8.11938L11.3183 11.3233ZM10.2748 7.4494C10.197 7.37422 10.2035 7.29019 10.2943 7.19732C10.6572 6.82585 10.9726 6.419 11.2405 5.97676C11.5128 5.53453 11.6791 5.01933 11.7396 4.43116L13.1655 5.88389C13.0013 6.09617 12.7766 6.31286 12.4914 6.53398C12.2063 6.75067 11.9081 6.94525 11.597 7.11772C11.2902 7.28577 11.0137 7.40517 10.7674 7.47593C10.5254 7.54669 10.3612 7.53784 10.2748 7.4494Z"})}),Bt=(0,f().IU)("collectionVerticalSegments",{viewBox:"0 0 16 16",svg:(0,y.jsx)("path",{d:"M2.38428 7.84033L13.6362 7.84033V9.15967L2.38428 9.15967V7.84033ZM1.61865 4.36084C1.61865 3.62256 1.8055 3.06429 2.1792 2.68604C2.55745 2.30778 3.11117 2.11865 3.84033 2.11865L12.1597 2.11865C12.8934 2.11865 13.4471 2.30778 13.8208 2.68604C14.1945 3.06429 14.3813 3.62256 14.3813 4.36084L14.3813 12.6392C14.3813 13.3774 14.1945 13.9357 13.8208 14.314C13.4471 14.6922 12.8934 14.8813 12.1597 14.8813L3.84033 14.8813C3.11117 14.8813 2.55745 14.6922 2.1792 14.314C1.8055 13.9357 1.61865 13.3774 1.61865 12.6392L1.61865 4.36084ZM2.96533 4.44287L2.96533 12.5571C2.96533 12.8716 3.04736 13.1131 3.21143 13.2817C3.37549 13.4504 3.62386 13.5347 3.95654 13.5347L12.0503 13.5347C12.3784 13.5347 12.6245 13.4504 12.7886 13.2817C12.9526 13.1131 13.0347 12.8716 13.0347 12.5571L13.0347 4.44287C13.0347 4.12386 12.9526 3.88232 12.7886 3.71826C12.6245 3.54964 12.3784 3.46533 12.0503 3.46533L3.95654 3.46533C3.62386 3.46533 3.37549 3.54964 3.21143 3.71826C3.04736 3.88232 2.96533 4.12386 2.96533 4.44287Z"})});var Ft=()=>o(820717),Rt=()=>o(12663),Kt=()=>o(121183),Ht=()=>o(401506),Ot=()=>o(471645),Lt=()=>o(466970),Dt=()=>o(96868),Et=()=>o(477253);const Nt=1e3;function Ut(e){var t;let{collectionViewStore:o,chartConfig:r,disabled:a}=e;const s=(0,i().O7)(),c=(0,p().Y$)(),u=(0,l().Fg)(),g=(0,n.useCallback)((e=>{var t;const o=null===(t=(0,Ke().iM)(e,u))||void 0===t?void 0:t.slice(0,5);return{key:e,type:"button",title:(0,y.jsx)(d()._H,{...m().h5[e]}),caption:o?(0,y.jsx)("div",{style:{display:"flex"},children:null==o?void 0:o.map((e=>(0,y.jsx)("div",{style:{background:e,borderRadius:2,width:12,height:12,marginRight:3,marginTop:1}},e)))}):null,captionInline:!0,captionStyle:{marginLeft:"auto"},inlineSpacerStyle:{display:"none"}}}),[u]),f=(0,n.useMemo)((()=>[E().Gs.map(g),E().Fh.map(g)]),[g]),S=(null===(t=r.chartFormat)||void 0===t?void 0:t.colorTheme)||"auto",h=(0,l().yK)((()=>({icon:{width:20,height:20,marginLeft:2}})),[]);return(0,y.jsx)(wt().Z,{disabled:a,title:(0,y.jsx)(d()._H,{...m().OV.chartColor}),selectedKey:S,sections:f,icon:At().T,iconStyle:h.icon,hideCheck:!0,onChange:e=>{if(!e)return;const t=(0,$().Xh)(r);t.chartFormat||(t.chartFormat={}),t.chartFormat.colorTheme=e,(0,Ke().GL)(e)||(t.chartFormat.weightColorValue=!1),ee().createAndCommit({userAction:"chartSettings.setChartConfig",environment:s,canUndo:!0,perform:e=>{X().sW({store:o.getFormatStore().getKeyStore("chart_config"),data:t,transaction:e})}}),J().wd({environment:s,collectionContextStore:c,action:"charts_style_color"})}})}function zt(e){const t=(0,i().Fy)(),o=(0,r().qz)(void 0,xe().Z);return(0,y.jsx)(ce().Z,{focused:!1,popupType:t.isMobile?se().Z4.SlideUp:se().Z4.Popup,alignmentToOrigin:se().vR.End,placementToOrigin:se().pO.Bottom,buttonPopupStore:o,renderOrigin:t=>(0,y.jsx)(ve().Z,{...t,showChevron:!0,title:(0,y.jsx)(d()._H,{...m().wh.chartMoreStyle}),rotateChevron:o.state.open,icon:Zt,disabled:e.disabled}),render:t=>(0,y.jsx)(Wt,{parent:t,collectionViewStore:e.collectionViewStore,chartConfig:e.chartConfig,disabled:e.disabled})})}function Wt(e){const{collectionViewStore:t,chartConfig:o,disabled:n}=e,{isMobile:a}=(0,i().Fy)(),c=(0,Lt().E)("charts_next"),d=(0,p().Y$)(),g=(0,r().Kw)(d.normalizedSchemaStore),m=(0,r().VK)((()=>{var e;if((0,s().u)(o))return"groups_reducer"===(null==o||null===(e=o.dataConfig)||void 0===e?void 0:e.type)?(0,W().Qm)({schema:g,property:o.dataConfig.groupBy.property}):void 0}),[o,g]),f=[],S={key:"default",items:[{key:"chartHeight",render:(e,i)=>(0,y.jsx)(qt,{menuListItemProps:e,parent:i,collectionViewStore:t,chartConfig:o,disabled:n}),action:()=>{}},{key:"groupStyle",render:(e,i)=>(0,s().u)(o)&&"groups_reducer"===o.dataConfig.type&&o.dataConfig.aggregationConfig.stackOptions?(0,y.jsx)(Gt,{menuListItemProps:e,parent:i,collectionViewStore:t,chartConfig:o,disabled:n}):null,action:()=>{}},{key:"gridLine",render:(e,i)=>(0,s().u)(o)?(0,y.jsx)(Yt,{menuListItemProps:e,parent:i,collectionViewStore:t,chartConfig:o,disabled:n}):null,action:()=>{}},{key:"axisLabel",render:(e,i)=>(0,s().u)(o)?(0,y.jsx)(Qt,{menuListItemProps:e,parent:i,collectionViewStore:t,chartConfig:o,disabled:n}):null,action:()=>{}},{key:"axisAvatarStyle",render:(e,i)=>(0,s().u)(o)&&m&&(0,E().Sw)(m)?(0,y.jsx)($t,{menuListItemProps:e,parent:i,collectionViewStore:t,chartConfig:o,disabled:n}):null,action:()=>{}},{key:"donutValue",render:e=>"donut"!==o.type?null:(0,y.jsx)(to,{menuListItemProps:e,collectionViewStore:t,chartConfig:o,disabled:n}),action:()=>{}},{key:"colorByValue",render:e=>{var i;const r=null===(i=o.chartFormat)||void 0===i?void 0:i.colorTheme;return"line"===o.type||!r||r&&!(0,Ke().GL)(r)?null:(0,y.jsx)(no,{menuListItemProps:e,collectionViewStore:t,chartConfig:o,disabled:n})},action:()=>{}},{key:"smoothLine",render:e=>"line"!==o.type?null:(0,y.jsx)(Xt,{menuListItemProps:e,collectionViewStore:t,chartConfig:o,disabled:n}),action:()=>{}},{key:"areaFill",render:e=>"line"!==o.type?null:(0,y.jsx)(eo,{menuListItemProps:e,collectionViewStore:t,chartConfig:o,disabled:n}),action:()=>{}},{key:"legend",render:e=>(0,y.jsx)(io,{menuListItemProps:e,collectionViewStore:t,chartConfig:o,disabled:n}),action:()=>{}},{key:"dataLabels",render:e=>(0,s().u)(o)&&(0,E().qL)(o)?(0,y.jsx)(lo,{...e,collectionViewStore:t,chartConfig:o,disabled:n}):null,action:()=>{}},{key:"donutDataLabels",render:(e,i)=>"donut"!==o.type?null:(0,y.jsx)(ao,{menuListItemProps:e,parent:i,collectionViewStore:t,chartConfig:o,disabled:n}),action:()=>{}},{key:"valueLabel",render:e=>{var i;return"donut"!==o.type||null!==(i=o.chartFormat)&&void 0!==i&&i.donutHideValue||!c?null:(0,y.jsx)(oo,{menuListItemProps:e,collectionViewStore:t,chartConfig:o,disabled:n})},action:()=>{}},{key:"caption",render:e=>(0,y.jsx)(ro,{...e,collectionViewStore:t,chartConfig:o,disabled:n}),action:()=>{}}],render:e=>(0,y.jsx)(u().Z,{...e})};f.push(S);const h=a?{menuType:Se().o.ActionSheet}:{menuType:Se().o.Popup,width:280,maxHeight:400},x=(0,l().yK)((()=>({menuList:{paddingTop:8,paddingBottom:8}})),[]);return(0,y.jsx)(ue().Z,{...h,children:(0,y.jsx)(pe().ZP,{initialFocus:void 0,type:pe().iW.Vertical,sections:f,resetFocusOnMouseOut:!0,style:x.menuList})})}function qt(e){const{chartConfig:t,collectionViewStore:o}=e,a=(0,i().O7)(),s=(0,i().Fy)(),c=(0,l().yK)((()=>({icon:{width:20,height:20,marginLeft:2,marginRight:0}})),[]),p=(0,r().VK)((()=>{var e;const o=null==t||null===(e=t.chartFormat)||void 0===e?void 0:e.height;return o||E().Dv.medium}),[t]),g=(0,n.useCallback)((e=>{const n=(0,$().Xh)(t);n.chartFormat||(n.chartFormat={}),n.chartFormat.height=e,ee().createAndCommit({userAction:"chartSettings.setChartConfig",environment:a,canUndo:!0,perform:e=>{X().sW({store:o.getFormatStore(),data:{chart_config:n},transaction:e})}})}),[t,o,a]),f=(0,n.useMemo)((()=>(0,Z().qP)(m().CI).map((e=>{let[t,o]=e;const n=p===t;return{key:t,render:e=>(0,y.jsx)(ae().Z,{...e,title:(0,y.jsx)(d()._H,{...o}),right:n?(0,le().k)({width:14,height:14}):void 0}),action:()=>{g(t)}}}))),[p,g]);return(0,y.jsx)(me().Z,{...e.menuListItemProps,openOnFocus:!0,onFocus:e.parent.onFocus,renderOrigin:e=>(0,y.jsx)(ve().Z,{...e,showChevron:!0,title:(0,y.jsx)(d()._H,{...m().OV.chartHeight}),icon:kt().x,iconStyle:c.icon,right:p?(0,y.jsx)(d()._H,{...m().CI[p]}):null}),renderExtension:(t,o)=>{const n=Jt({title:(0,y.jsx)(d()._H,{...m().OV.chartHeight}),device:s,onClickRight:o.close,popupEvents:t});return(0,y.jsx)(ue().Z,{...n,children:(0,y.jsx)(pe().ZP,{type:pe().iW.Vertical,initialFocus:0,onAccept:e.parent.onAccept,sections:[{key:"chartHeight",render:e=>(0,y.jsx)(u().Z,{...e}),items:f}]})})}})}function Gt(e){const{chartConfig:t,collectionViewStore:o}=e,l=(0,i().O7)(),a=(0,i().Fy)(),s=(0,r().VK)((()=>{var e;const o=null==t||null===(e=t.chartFormat)||void 0===e?void 0:e.axisGroupStyle;return o||E().UJ.normal}),[t]),c=(0,n.useCallback)((e=>{const n=(0,$().Xh)(t);n.chartFormat||(n.chartFormat={axisGroupStyle:E().UJ.normal}),n.chartFormat.axisGroupStyle=e,ee().createAndCommit({userAction:"chartSettings.setChartConfig",environment:l,canUndo:!0,perform:e=>{X().sW({store:o.getFormatStore(),data:{chart_config:n},transaction:e})}})}),[t,o,l]),p=(0,n.useMemo)((()=>(0,Z().qP)(m().E4).map((e=>{let[t,o]=e;const n=s===t;return{key:t,render:e=>(0,y.jsx)(ae().Z,{...e,title:(0,y.jsx)(d()._H,{...o}),right:n?(0,le().k)({width:14,height:14}):void 0}),action:()=>{c(t)}}}))),[s,c]);return(0,y.jsx)(me().Z,{...e.menuListItemProps,openOnFocus:!0,onFocus:e.parent.onFocus,renderOrigin:e=>(0,y.jsx)(ve().Z,{...e,showChevron:!0,title:(0,y.jsx)(d()._H,{...m().OV.chartGroupStyle}),icon:Bt,right:s?(0,y.jsx)(d()._H,{...m().E4[s]}):null}),renderExtension:(t,o)=>{const n=Jt({title:(0,y.jsx)(d()._H,{...m().OV.chartGroupStyle}),device:a,onClickRight:o.close,popupEvents:t});return(0,y.jsx)(ue().Z,{...n,children:(0,y.jsx)(pe().ZP,{type:pe().iW.Vertical,initialFocus:0,onAccept:e.parent.onAccept,sections:[{key:"groupStyles",render:e=>(0,y.jsx)(u().Z,{...e}),items:p}]})})}})}function Yt(e){const t=(0,i().O7)(),o=(0,p().Y$)(),l=(0,i().Fy)(),a=(0,r().VK)((()=>{var t;const o=null===(t=e.chartConfig.chartFormat)||void 0===t?void 0:t.axisGridLine;return o||"horizontal"}),[e.chartConfig]),s=(0,n.useCallback)((n=>{const i=(0,$().Xh)(e.chartConfig);i.chartFormat||(i.chartFormat={axisGridLine:E().Xm.horizontal}),i.chartFormat.axisGridLine=n,ee().createAndCommit({userAction:"chartSettings.setChartConfig",environment:t,canUndo:!0,perform:t=>{X().sW({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:i,transaction:t})}}),J().wd({environment:t,collectionContextStore:o,action:"charts_style_grid_line"})}),[e.chartConfig,t,e.collectionViewStore,o]),c=(0,n.useMemo)((()=>(0,Z().qP)(m().s8).map((e=>{let[t,o]=e;const n=a===t;return{key:t,render:e=>(0,y.jsx)(ae().Z,{...e,title:(0,y.jsx)(d()._H,{...o}),right:n?(0,le().k)({width:14,height:14}):void 0}),action:()=>{s(t)}}}))),[a,s]);return(0,y.jsx)(me().Z,{...e.menuListItemProps,openOnFocus:!0,onFocus:e.parent.onFocus,renderOrigin:t=>(0,y.jsx)(ve().Z,{...t,showChevron:!0,title:(0,y.jsx)(d()._H,{...m().OV.chartGridLine}),right:a?(0,y.jsx)(d()._H,{...m().s8[a]}):null,icon:It,iconStyle:{width:20,height:20,marginLeft:2,marginRight:0},disabled:e.disabled}),renderExtension:(t,o)=>{const n=Jt({title:(0,y.jsx)(d()._H,{...m().OV.chartGridLine}),device:l,onClickRight:o.close,popupEvents:t});return(0,y.jsx)(ue().Z,{...n,children:(0,y.jsx)(pe().ZP,{type:pe().iW.Vertical,initialFocus:0,onAccept:e.parent.onAccept,sections:[{key:"gridStyles",render:e=>(0,y.jsx)(u().Z,{...e}),items:c}]})})}})}function $t(e){const t=(0,i().O7)(),o=(0,i().Fy)(),l=(0,m().kM)(),a=(0,r().VK)((()=>{var t;return(null===(t=e.chartConfig.chartFormat)||void 0===t?void 0:t.axisAvatar)||E().lr.avatar}),[e.chartConfig]),s=(0,n.useCallback)((o=>{const n=(0,$().Xh)(e.chartConfig);n.chartFormat||(n.chartFormat={axisAvatar:E().lr.avatar}),n.chartFormat.axisAvatar=o,ee().createAndCommit({userAction:"chartSettings.updateAxisAvatarFormat",environment:t,canUndo:!0,perform:t=>{X().sW({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:n,transaction:t})}})}),[e.chartConfig,e.collectionViewStore,t]),c=(0,n.useMemo)((()=>(0,Z().qP)(m().oq).map((e=>{let[t,o]=e;const n=a===t;return{key:t,render:e=>(0,y.jsx)(ae().Z,{...e,title:(0,y.jsx)(d()._H,{...o}),right:n?(0,le().k)({width:14,height:14}):void 0}),action:()=>{s(t)}}}))),[a,s]);return(0,y.jsx)(me().Z,{...e.menuListItemProps,openOnFocus:!0,onFocus:e.parent.onFocus,renderOrigin:t=>(0,y.jsx)(ve().Z,{...t,showChevron:!0,title:(0,y.jsx)(d()._H,{...m().OV.chartAxisAvatarFormat}),right:a?(0,y.jsx)("span",{style:Q().Yu,children:(0,y.jsx)(d()._H,{...m().oq[a]})}):null,rightStyle:l.avatarStyle,icon:Ft().v,iconStyle:{width:20,height:16,marginLeft:2,marginRight:0},disabled:e.disabled}),renderExtension:(t,n)=>{const i=Jt({title:(0,y.jsx)(d()._H,{...m().OV.chartAxisName}),device:o,onClickRight:n.close,popupEvents:t});return(0,y.jsx)(ue().Z,{...i,children:(0,y.jsx)(pe().ZP,{type:pe().iW.Vertical,initialFocus:0,onAccept:e.parent.onAccept,sections:[{key:"avatarStyles",render:e=>(0,y.jsx)(u().Z,{...e}),items:c}]})})}})}function Qt(e){const t=(0,i().O7)(),o=(0,p().Y$)(),l=(0,i().Fy)(),a=(0,r().VK)((()=>{var t;const o=null===(t=e.chartConfig.chartFormat)||void 0===t?void 0:t.axisLabel;return o||E().Xg.none}),[e.chartConfig]),s=(0,r().VK)((()=>"bar"===e.chartConfig.type),[e.chartConfig]),c=(0,n.useMemo)((()=>s?a===E().Xg.x_axis?m().li.y_axis:a===E().Xg.y_axis?m().li.x_axis:m().li[a]:m().li[a]),[s,a]),g=(0,n.useCallback)((n=>{const i=(0,$().Xh)(e.chartConfig);i.chartFormat||(i.chartFormat={axisLabel:E().Xg.none}),i.chartFormat.axisLabel=n,ee().createAndCommit({userAction:"chartSettings.updateAxisLabel",environment:t,canUndo:!0,perform:t=>{X().sW({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:i,transaction:t})}}),J().wd({environment:t,collectionContextStore:o,action:"charts_style_axis_label"})}),[e.chartConfig,e.collectionViewStore,t,o]),f=(0,n.useMemo)((()=>{let e=(0,Z().qP)(m().li);if(s){const t=[];for(const[o,n]of e)o===E().Xg.x_axis?t.push([E().Xg.y_axis,n]):o===E().Xg.y_axis?t.push([E().Xg.x_axis,n]):t.push([o,n]);e=t}return e.map((e=>{let[t,o]=e;const n=a===t;return{key:t,render:e=>(0,y.jsx)(ae().Z,{...e,title:(0,y.jsx)(d()._H,{...o}),right:n?(0,le().k)({width:14,height:14}):void 0}),action:()=>{g(t)}}}))}),[s,a,g]);return(0,y.jsx)(me().Z,{...e.menuListItemProps,openOnFocus:!0,onFocus:e.parent.onFocus,renderOrigin:t=>(0,y.jsx)(ve().Z,{...t,showChevron:!0,title:(0,y.jsx)(d()._H,{...m().OV.chartAxisName}),right:c?(0,y.jsx)(d()._H,{...c}):null,icon:Pt,iconStyle:{width:20,height:20,marginLeft:2,marginRight:0},disabled:e.disabled}),renderExtension:(t,o)=>{const n=Jt({title:(0,y.jsx)(d()._H,{...m().OV.chartAxisName}),device:l,onClickRight:o.close,popupEvents:t});return(0,y.jsx)(ue().Z,{...n,children:(0,y.jsx)(pe().ZP,{type:pe().iW.Vertical,initialFocus:0,onAccept:e.parent.onAccept,sections:[{key:"gridStyles",render:e=>(0,y.jsx)(u().Z,{...e}),items:f}]})})}})}function Jt(e){return e.device.isMobile?{menuType:Se().o.ActionSheet,...e.popupEvents}:{menuType:Se().o.Popup,width:200,...e.popupEvents}}function Xt(e){const t=(0,i().O7)(),o=(0,p().Y$)(),r=(0,n.useMemo)((()=>{var t;return Boolean(null===(t=e.chartConfig)||void 0===t||null===(t=t.chartFormat)||void 0===t?void 0:t.smoothLine)}),[e.chartConfig]),l=(0,n.useCallback)((()=>{var n;const i=(0,$().Xh)(e.chartConfig);i.chartFormat||(i.chartFormat={smoothLine:!1}),i.chartFormat.smoothLine=!(null!==(n=e.chartConfig.chartFormat)&&void 0!==n&&n.smoothLine),ee().createAndCommit({userAction:"chartSettings.setChartConfig",environment:t,canUndo:!0,perform:t=>{X().sW({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:i,transaction:t})}}),J().wd({environment:t,collectionContextStore:o,action:"charts_style_smooth_line"})}),[t,e.chartConfig,e.collectionViewStore,o]);return(0,y.jsx)(Et().Z,{...e.menuListItemProps,title:(0,y.jsx)(d()._H,{...m().OV.chartSmoothLine}),showChevron:!1,switcherProps:{on:r},icon:Vt,onClick:l,disabled:e.disabled})}function eo(e){const t=(0,i().O7)(),o=(0,p().Y$)(),r=(0,n.useMemo)((()=>{var t;return!(null!==(t=e.chartConfig)&&void 0!==t&&null!==(t=t.chartFormat)&&void 0!==t&&t.hideLineFillArea)}),[e.chartConfig]),l=(0,n.useCallback)((()=>{var n;const i=(0,$().Xh)(e.chartConfig);i.chartFormat||(i.chartFormat={hideLineFillArea:!1}),i.chartFormat.hideLineFillArea=!(null!==(n=e.chartConfig.chartFormat)&&void 0!==n&&n.hideLineFillArea),ee().createAndCommit({userAction:"chartSettings.setChartConfig",environment:t,canUndo:!0,perform:t=>{X().sW({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:i,transaction:t})}}),J().wd({environment:t,collectionContextStore:o,action:"charts_style_area_fill"})}),[t,e.chartConfig,e.collectionViewStore,o]);return(0,y.jsx)(Et().Z,{...e.menuListItemProps,title:(0,y.jsx)(d()._H,{...m().OV.chartLineFillArea}),showChevron:!1,switcherProps:{on:r},icon:Tt,onClick:l,disabled:e.disabled})}function to(e){var t;const o=(0,i().O7)(),r=(0,p().Y$)(),{collectionViewStore:l,chartConfig:a,disabled:s}=e,c=(0,n.useMemo)((()=>{var e;return!(null!=a&&null!==(e=a.chartFormat)&&void 0!==e&&e.donutHideValue)}),[null==a||null===(t=a.chartFormat)||void 0===t?void 0:t.donutHideValue]),u=(0,n.useCallback)((()=>{var e;const t=(0,$().Xh)(a);t.chartFormat||(t.chartFormat={donutHideValue:!1}),t.chartFormat.donutHideValue=!(null!==(e=a.chartFormat)&&void 0!==e&&e.donutHideValue),ee().createAndCommit({userAction:"chartSettings.setChartConfig",environment:o,canUndo:!0,perform:e=>{X().sW({store:l.getFormatStore().getKeyStore("chart_config"),data:t,transaction:e})}}),J().wd({environment:o,collectionContextStore:r,action:"charts_style_donut_value"})}),[a,l,o,r]);return(0,y.jsx)(Et().Z,{...e.menuListItemProps,title:(0,y.jsx)(d()._H,{...m().OV.chartShowDonutValue}),showChevron:!1,switcherProps:{on:c},icon:re().k,onClick:u,disabled:s})}function oo(e){var t;const o=(0,i().O7)(),r=(0,d().YB)(),a=(0,p().Y$)(),{collectionViewStore:s,chartConfig:c,disabled:u}=e,g=(0,n.useMemo)((()=>{var e;return null==c||null===(e=c.chartFormat)||void 0===e?void 0:e.valueLabel}),[null==c||null===(t=c.chartFormat)||void 0===t?void 0:t.valueLabel]),f=(0,n.useCallback)((e=>{const t=(0,$().Xh)(c);t.chartFormat||(t.chartFormat={valueLabel:void 0}),t.chartFormat.valueLabel=e,ee().createAndCommit({userAction:"chartSettings.setChartConfig",environment:o,canUndo:!0,perform:e=>{X().sW({store:s.getFormatStore().getKeyStore("chart_config"),data:t,transaction:e})}}),J().wd({environment:o,collectionContextStore:a,action:"charts_style_value_label"})}),[c,s,o,a]),S=(0,l().yK)((()=>({inputContainer:{padding:"4px 0",marginLeft:34,marginRight:4}})),[]);return(0,y.jsx)("div",{style:S.inputContainer,children:(0,y.jsx)(Dt().I,{initialValue:g||"",placeholder:r.formatMessage(m().OV.chartValueLabelPlaceholder),onBlur:f,onChange:f,onSubmit:f,disabled:u})})}function no(e){const t=(0,i().O7)(),o=(0,p().Y$)(),l=(0,r().VK)((()=>{var t;return(null===(t=e.chartConfig.chartFormat)||void 0===t?void 0:t.weightColorValue)??!1}),[e.chartConfig]),a=(0,n.useCallback)((()=>{var n;const i=(0,$().Xh)(e.chartConfig);i.chartFormat||(i.chartFormat={weightColorValue:!1}),i.chartFormat.weightColorValue=!(null!==(n=e.chartConfig.chartFormat)&&void 0!==n&&n.weightColorValue),ee().createAndCommit({userAction:"chartSettings.setChartConfig",environment:t,canUndo:!0,perform:t=>{X().sW({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:i,transaction:t})}}),J().wd({environment:t,collectionContextStore:o,action:"charts_style_weight_color_value"})}),[t,e.chartConfig,e.collectionViewStore,o]);return(0,y.jsx)(Et().Z,{...e.menuListItemProps,title:(0,y.jsx)(d()._H,{...m().OV.chartWeightColorValue}),showChevron:!1,switcherProps:{on:l},icon:Kt().J,onClick:a,disabled:e.disabled})}function io(e){const t=(0,i().O7)(),o=(0,p().Y$)(),l=(0,ft().bc)(e.chartConfig),a=(0,r().VK)((()=>{var t;return!(null!==(t=e.chartConfig.chartFormat)&&void 0!==t&&t.hideLegend||l)}),[e.chartConfig,l]),s=(0,n.useCallback)((()=>{var n;const i=(0,$().Xh)(e.chartConfig);i.chartFormat||(i.chartFormat={hideLegend:!1}),i.chartFormat.hideLegend=!(null!==(n=e.chartConfig.chartFormat)&&void 0!==n&&n.hideLegend),ee().createAndCommit({userAction:"chartSettings.setChartConfig",environment:t,canUndo:!0,perform:t=>{X().sW({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:i,transaction:t})}}),J().wd({environment:t,collectionContextStore:o,action:"charts_style_legend_toggle"})}),[t,e.chartConfig,e.collectionViewStore,o]);return l?null:(0,y.jsx)(Et().Z,{...e.menuListItemProps,title:(0,y.jsx)(d()._H,{...m().OV.chartLegend}),showChevron:!1,switcherProps:{on:a},icon:Rt().N,onClick:s,disabled:e.disabled})}function ro(e){let{collectionViewStore:t,chartConfig:o,disabled:a}=e;const s=(0,d().YB)(),c=(0,i().O7)(),u=(0,p().Y$)(),{showCaption:g,caption:f}=(0,r().VK)((()=>{var e,t;return"placeholder"===o.type?{showCaption:!1,caption:""}:{showCaption:(null===(e=o.chartFormat)||void 0===e?void 0:e.showCaption)??!1,caption:(null===(t=o.chartFormat)||void 0===t?void 0:t.caption)??""}}),[o]),S=(0,n.useCallback)((()=>{const e=t.getChartFormatStore();e&&(ee().createAndCommit({userAction:"chartSettings.setChartFormat.showCaption",environment:c,canUndo:!0,perform:t=>{X().sW({store:e,data:{showCaption:!g},transaction:t})}}),J().wd({environment:c,collectionContextStore:u,action:"charts_style_show_caption"}))}),[t,c,u,g]),h=(0,n.useCallback)((e=>{const o=t.getChartFormatStore();o&&(ee().createAndCommit({userAction:"chartSettings.setChartFormat.updateCaption",environment:c,canUndo:!0,perform:t=>{X().sW({store:o,data:{caption:e},transaction:t})}}),J().wd({environment:c,collectionContextStore:u,action:"charts_style_update_caption"}))}),[u,t,c]),x=(0,l().yK)((()=>({captionInputContainer:{padding:"4px 0",marginLeft:34,marginRight:4},icon:{width:24,height:17,marginRight:-2}})),[]);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(ve().Z,{title:(0,y.jsx)(d()._H,{...m().OV.chartCaption}),showChevron:!1,right:(0,y.jsx)(Ot().Z,{on:g,onClick:S,disabled:a}),icon:Ht().p,iconStyle:x.icon,onClick:S,disabled:a}),(0,y.jsx)("div",{style:x.captionInputContainer,children:(0,y.jsx)(Dt().I,{initialValue:f,placeholder:s.formatMessage(m().OV.chartCaptionPlaceholder),onBlur:h,onChange:h,onSubmit:h,disabled:a,textarea:!0,maxLength:Nt})})]})}function lo(e){let{collectionViewStore:t,chartConfig:o,disabled:a}=e;const s=(0,i().O7)(),c=(0,p().Y$)(),u=(0,r().VK)((()=>(0,E().vi)(o)),[o]),g=(0,n.useCallback)((()=>{const e=(0,$().Xh)(o);e.chartFormat||(e.chartFormat={axisShowDataLabels:!0}),e.chartFormat.axisShowDataLabels=!u,ee().createAndCommit({userAction:"chartSettings.setChartFormat.dataLabels",environment:s,canUndo:!0,perform:o=>{X().sW({store:t.getFormatStore().getKeyStore("chart_config"),data:e,transaction:o})}}),J().wd({environment:s,collectionContextStore:c,action:"charts_style_data_labels"})}),[o,t,s,u,c]),f=(0,l().yK)((()=>({icon:{width:24,height:17,marginRight:-2}})),[]);return(0,y.jsx)(ve().Z,{title:(0,y.jsx)(d()._H,{...m().OV.chartDataLabels}),showChevron:!1,right:(0,y.jsx)(Ot().Z,{on:u,onClick:g,disabled:a}),icon:re().k,iconStyle:f.icon,onClick:g,disabled:a})}function ao(e){const t=(0,i().O7)(),o=(0,p().Y$)(),l=(0,i().Fy)(),a=(0,m().kM)(),s=(0,r().VK)((()=>{var t;const o=null===(t=e.chartConfig.chartFormat)||void 0===t?void 0:t.donutDataLabels;return o||E().gg.none}),[e.chartConfig]),c=(0,n.useCallback)((n=>{const i=(0,$().Xh)(e.chartConfig);i.chartFormat||(i.chartFormat={donutDataLabels:E().gg.none}),i.chartFormat.donutDataLabels=n,ee().createAndCommit({userAction:"chartSettings.setChartConfig",environment:t,canUndo:!0,perform:t=>{X().sW({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:i,transaction:t})}}),J().wd({environment:t,collectionContextStore:o,action:"charts_style_donut_data_labels"})}),[e.chartConfig,t,e.collectionViewStore,o]),g=(0,n.useMemo)((()=>(0,Z().qP)(m().c5).map((e=>{let[t,o]=e;const n=s===t;return{key:t,render:e=>(0,y.jsx)(ae().Z,{...e,title:(0,y.jsx)(d()._H,{...o}),right:n?(0,le().k)({width:14,height:14}):void 0}),action:()=>{c(t)}}}))),[s,c]);return(0,y.jsx)(me().Z,{...e.menuListItemProps,openOnFocus:!0,onFocus:e.parent.onFocus,renderOrigin:t=>(0,y.jsx)(ve().Z,{...t,showChevron:!0,title:(0,y.jsx)(d()._H,{...m().OV.chartDataLabels}),right:s?(0,y.jsx)("div",{style:{...a.donutDataLabelsRightText,...Q().Yu},children:(0,y.jsx)(d()._H,{...m().c5[s]})}):null,icon:re().k,disabled:e.disabled}),renderExtension:(t,o)=>{const n=Jt({title:(0,y.jsx)(d()._H,{...m().OV.chartDataLabels}),device:l,onClickRight:o.close,popupEvents:t});return(0,y.jsx)(ue().Z,{...n,children:(0,y.jsx)(pe().ZP,{type:pe().iW.Vertical,initialFocus:0,onAccept:e.parent.onAccept,sections:[{key:"donutDataLabelsStyle",render:e=>(0,y.jsx)(u().Z,{...e}),items:g}]})})}})}const so=(0,f().IU)("collectionChartXAxis",{viewBox:"0 0 16 16",svg:(0,y.jsx)("path",{d:"M2.20831 11.2556L2.20782 2.77084C2.20782 2.62501 2.26023 2.49741 2.36505 2.38803C2.47443 2.27866 2.60659 2.22397 2.76154 2.22397C2.91193 2.22397 3.03953 2.27866 3.14435 2.38803C3.25372 2.49741 3.30841 2.62501 3.30841 2.77084L3.3089 10.5104C3.3089 10.638 3.3727 10.7018 3.50031 10.7018H12.3548C12.5052 10.7018 12.6351 10.7542 12.7444 10.8591C12.8538 10.9684 12.9085 11.0983 12.9085 11.2487C12.9085 11.4037 12.8538 11.5335 12.7444 11.6384C12.6351 11.7432 12.5052 11.7956 12.3548 11.7956H2.75519C2.59113 11.7956 2.45896 11.7455 2.3587 11.6452C2.25844 11.5495 2.20831 11.4196 2.20831 11.2556ZM9.40851 9.02458C9.40851 8.91065 9.43813 8.82406 9.49738 8.76482C9.56118 8.70102 9.64093 8.66684 9.73663 8.66228C9.83689 8.65772 9.93943 8.68507 10.0443 8.74431L13.5784 10.8635C13.6696 10.9181 13.7311 10.9911 13.763 11.0822C13.7995 11.1688 13.8017 11.2577 13.7698 11.3488C13.7425 11.4354 13.681 11.5083 13.5853 11.5676L10.0511 13.6867C9.94627 13.7505 9.84373 13.7801 9.74347 13.7756C9.64777 13.771 9.56801 13.7391 9.50421 13.6799C9.44041 13.6161 9.40851 13.5249 9.40851 13.4064V9.02458Z"})});var co=()=>o(421654);function uo(e){let{chartConfig:t,chartError:o,disabled:s}=e;const c=(0,i().O7)(),u=(0,p().Y$)(),g=(0,d().YB)(),f=(0,l().yK)((e=>({errorIcon:(0,m().FV)(e)})),[]),S=(0,m().kM)(),h=(0,r().VK)((()=>u.collectionViewStore()),[u]),x=(0,r().VK)((()=>u.normalizedSchemaStore.state),[u]),v=(0,r().VK)((()=>null==t?void 0:t.dataConfig),[t]),C=(0,r().VK)((()=>{if("groups_reducer"===(null==v?void 0:v.type)){const e="formula"===v.groupBy.type?v.groupBy.groupBy:v.groupBy;return(0,z().TD)(e)||(0,z().ib)(e)?{type:"property_group",property:v.groupBy.property,groupByOption:e.groupBy}:{type:"property_group",property:v.groupBy.property}}if("results_reducer"===(null==v?void 0:v.type))return{type:"property_group",property:v.nameProperty}}),[v]),b=(0,r().VK)((()=>{const e={icon:so};return o&&(0,a().Ib)(o)?{icon:Y().t,iconStyle:f.errorIcon}:e}),[o,f.errorIcon]),w=(0,r().VK)((()=>{const e=(0,Z().qP)(x),t=[];return e.forEach((e=>{let[o,n]=e;if(n)if((0,z().H1)(n.type))t.push({key:{type:"property_group",property:o},name:n.name,sectionName:be,subMenuItems:z().vu.map((e=>({key:{type:"property_group",property:o,groupByOption:e},name:g.formatMessage(Ae().ci[e]),sectionName:be})))});else if((0,E().f3)(n))t.push({key:{type:"property_group",property:o},name:n.name,sectionName:be,subMenuItems:z().z8.map((e=>({key:{type:"property_group",property:o,groupByOption:e},name:g.formatMessage(Ae().aK[e]),sectionName:be})))});else{if(!(0,z().LG)(n))return;t.push({key:{type:"property_group",property:o},name:n.name,sectionName:be})}})),t}),[x,g]),j=n.useCallback((e=>{var o,n;const{key:i}=e,{property:r,groupByOption:l}=i;if(!t||!h)return;const a=(0,W().Qm)({schema:x,property:r}),s=(0,D().ib)({property:r,collectionSchema:x,hideEmptyGroups:Boolean(null===(o=t.chartFormat)||void 0===o?void 0:o.axisHideEmptyGroups)});if(!a||!s)return;const d=Object.keys(x),p="results_reducer"===t.dataConfig.type?t.dataConfig.valueProperty:d.find((e=>{const t=x[e];return Boolean(t&&(0,D()._i)(t))})),g={aggregator:"count"};let f=$().Xh(t);if((0,D().HT)(a)&&p)f=(0,E().T9)({chartConfig:f,xAxisPropertyId:r,newDataConfigType:"results_reducer",valueProperty:p,groupBy:s});else if(l){var y;const e=(0,E().qV)({property:r,propertySchema:a,groupByOption:l,hideEmptyGroups:Boolean(null===(y=f.chartFormat)||void 0===y?void 0:y.axisHideEmptyGroups)});e&&(f=(0,E().T9)({chartConfig:f,xAxisPropertyId:r,newDataConfigType:"groups_reducer",groupBy:e,aggregation:g}))}else if(s){const e={aggregator:"count"};f=(0,E().T9)({chartConfig:f,xAxisPropertyId:r,newDataConfigType:"groups_reducer",groupBy:s,aggregation:e})}(0,m().$I)({environment:c,collectionContextStore:u,chartConfig:f,sort:null===(n=f.chartFormat)||void 0===n?void 0:n.mainSort}),ee().createAndCommit({userAction:"chartSettings.setXAxis",environment:c,canUndo:!0,perform:t=>{X().sW({store:h.getFormatStore().getKeyStore("chart_config"),data:f,transaction:t}),"week"===e.key.groupByOption&&co().$P(h,t)}}),J().wd({environment:c,collectionContextStore:u,action:"charts_x_axis_what_to_show",charts_analytics_context:(0,te().aL)(u)})}),[t,h,x,c,u]);return(0,y.jsx)(F().Z,{textWrap:!0,placement:K().Placement.Left,disableTooltip:!o||!(0,a().Ib)(o),renderTooltip:e=>o?(0,y.jsx)("span",{...e,children:(0,oe().e)(o)}):null,render:e=>(0,y.jsx)(Te,{...e,collectionContextStore:u,selectedProperty:C,properties:w,handlePropertySelect:j,originProps:{title:(0,y.jsx)("span",{children:(0,y.jsx)(d()._H,{...m().wh.chartWhatToShow})}),icon:b.icon},callsite:"main_property",disabled:s,rightStyle:S.whatToShowRightText})})}function po(e){let{collectionViewStore:t,chartConfig:o,disabled:l}=e;const a=(0,i().O7)(),s=(0,p().Y$)(),u=(0,r().VK)((()=>{var e;return Boolean(null==o||null===(e=o.chartFormat)||void 0===e?void 0:e.axisHideEmptyGroups)}),[o]),g=n.useCallback((()=>{if(!o)return;const e=$().Xh(o);e.chartFormat={...e.chartFormat,axisHideEmptyGroups:!u},"groups_reducer"===e.dataConfig.type&&(e.dataConfig.groupBy.hideEmptyGroups=!u),ee().createAndCommit({userAction:"chartSettings.setChartConfig",environment:a,canUndo:!0,perform:o=>{X().sW({store:t.getFormatStore().getKeyStore("chart_config"),data:e,transaction:o})}}),J().wd({environment:a,collectionContextStore:s,action:"charts_x_axis_hide_empty_groups",charts_analytics_context:(0,te().aL)(s)})}),[o,t,a,u,s]);return(0,y.jsx)(Et().Z,{title:(0,y.jsx)(d()._H,{...m().OV.chartHideEmptyGroups}),switcherProps:{on:u},onClick:g,icon:c().D,iconStyle:{height:20},disabled:l})}const go=(0,f().IU)("collectionChartCumulative",{viewBox:"0 0 16 16",svg:(0,y.jsxs)("g",{children:[(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.25 8C1.25 7.44772 1.69772 7 2.25 7H3.75C4.30228 7 4.75 7.44772 4.75 8V12C4.75 12.5523 4.30228 13 3.75 13H2.25C1.69772 13 1.25 12.5523 1.25 12V8ZM3.75 8L2.25 8V12H3.75V8Z"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.25 6C6.25 5.44772 6.69772 5 7.25 5H8.75C9.30228 5 9.75 5.44772 9.75 6V12C9.75 12.5523 9.30228 13 8.75 13H7.25C6.69772 13 6.25 12.5523 6.25 12V6ZM8.75 6L7.25 6V12H8.75V6Z"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.25 4C11.25 3.44772 11.6977 3 12.25 3H13.75C14.3023 3 14.75 3.44772 14.75 4V12C14.75 12.5523 14.3023 13 13.75 13H12.25C11.6977 13 11.25 12.5523 11.25 12V4ZM13.75 4L12.25 4V12H13.75V4Z"})]})}),mo=(0,f().IU)("collectionChartYAxis",{viewBox:"0 0 16 16",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{d:"M4.35184 13.3584L4.35184 4.92715C4.35184 4.77446 4.40671 4.64086 4.51645 4.52634C4.63097 4.41183 4.76935 4.35457 4.93158 4.35457C5.08904 4.35457 5.22264 4.41183 5.33239 4.52634C5.4469 4.64086 5.50416 4.77446 5.50416 4.92715V12.5783C5.50416 12.7119 5.57096 12.7787 5.70456 12.7787L13.1625 12.7792C13.3199 12.7792 13.4559 12.8341 13.5704 12.9438C13.6849 13.0583 13.7422 13.1943 13.7422 13.3518C13.7422 13.514 13.6849 13.65 13.5704 13.7598C13.4559 13.8695 13.3199 13.9244 13.1625 13.9244L4.92442 13.9239C4.75265 13.9239 4.61427 13.8714 4.5093 13.7664C4.40432 13.6662 4.35184 13.5302 4.35184 13.3584Z"}),(0,y.jsx)("path",{d:"M2.36568 6.57231C2.42771 6.63434 2.51837 6.66535 2.63766 6.66535L7.22548 6.66535C7.34954 6.66535 7.44497 6.63195 7.51177 6.56515C7.5738 6.49835 7.6072 6.41485 7.61197 6.31464C7.61674 6.20967 7.58573 6.10231 7.51893 5.99257L5.30017 2.29225C5.23814 2.19205 5.1618 2.12763 5.07114 2.099C4.97571 2.0656 4.88266 2.06799 4.792 2.10616C4.69657 2.13956 4.62023 2.20398 4.56297 2.29941L2.34421 5.99972C2.28218 6.10947 2.25355 6.21683 2.25832 6.3218C2.2631 6.422 2.29888 6.50551 2.36568 6.57231Z"})]})}),fo=(0,f().IU)("decimals",{viewBox:"0 0 20 20",svg:(0,y.jsx)("g",{children:(0,y.jsx)("path",{d:"M15.124 14.287c-2.033 0-3.244-1.65-3.244-4.296 0-2.633 1.222-4.278 3.244-4.278 2.017 0 3.234 1.633 3.234 4.273s-1.205 4.301-3.234 4.301m0-1.205c1.114 0 1.749-1.137 1.749-3.09 0-1.931-.646-3.074-1.749-3.074-1.108 0-1.759 1.148-1.759 3.068 0 1.954.64 3.096 1.76 3.096Zm-7.461 1.205c-2.033 0-3.245-1.65-3.245-4.296 0-2.633 1.223-4.278 3.245-4.278 2.017 0 3.234 1.633 3.234 4.273s-1.206 4.301-3.234 4.301m0-1.205c1.114 0 1.748-1.137 1.748-3.09 0-1.931-.645-3.074-1.748-3.074-1.108 0-1.76 1.148-1.76 3.068 0 1.954.64 3.096 1.76 3.096m-5.198 1.103a.81.81 0 0 1-.823-.823c0-.457.36-.823.823-.823.457 0 .817.366.817.823a.81.81 0 0 1-.817.823"})})});var yo=()=>o(447490),So=()=>o(996106),ho=()=>o(599291),xo=()=>o(422118),vo=()=>o(910007);function Co(e){let{chartConfig:t,chartError:o,disabled:s}=e;const c=(0,d().YB)(),u=(0,i().O7)(),g=(0,p().Y$)(),f=(0,l().yK)((e=>({errorIcon:{...(0,m().FV)(e),width:18,height:18,marginLeft:4}})),[]),S=(0,m().kM)(),h=(0,r().VK)((()=>g.collectionViewStore()),[g]),x=(0,r().VK)((()=>g.databaseType),[g]),v=(0,r().VK)((()=>g.normalizedSchemaStore.state),[g]),C=(0,r().VK)((()=>null==t?void 0:t.dataConfig),[t]),b=(0,r().VK)((()=>{if(C)return"groups_reducer"===C.type?C.groupBy.property:C.nameProperty}),[C]),w=(0,r().VK)((()=>b?(0,W().Qm)({schema:v,property:b}):void 0),[b,v]),j=(0,r().VK)((()=>{if(C)if("groups_reducer"===C.type){const e=C.aggregationConfig.aggregation;if((0,U().HK)(e))return{type:"record_count"};if(ke(e.aggregator)){const t=(0,W().Qm)({schema:v,property:e.property});if(!t)return;return(0,E().HQ)(t)||"unique"!==e.aggregator?{type:"aggregation",property:e.property,aggregation:e.aggregator}:{type:"property_group",property:e.property}}}else if("results_reducer"===C.type&&C.valueProperty)return{type:"aggregation",property:C.valueProperty,aggregation:"value"}}),[v,C]),_=(0,r().VK)((()=>{if(!C||!w)return[];const e=[];(0,Z().qP)(v).forEach((t=>{let[o,n]=t;if(!n||o===b||!(0,z().LG)(n))return;const i=[];(0,D()._i)(n)&&(0,D().HT)(w)&&i.push({key:{type:"aggregation",property:o,aggregation:"value"},name:c.formatMessage(m().wh.chartAggregateByValues),sectionName:we});const r=(0,E().HQ)(n);if(r){Me.forEach((e=>{const t={aggregator:e,property:o},n={key:{type:"aggregation",property:o,aggregation:e},name:(0,m().Hk)({aggregation:t,databaseType:x,intl:c})||"",sectionName:we};i.push(n)}));const e={key:{type:"aggregation",property:o,aggregation:"unique"},name:(0,m().Hk)({aggregation:{aggregator:"unique",property:o},databaseType:x,intl:c})||"",sectionName:we};i.push(e)}const l={key:{type:"property_group",property:o},name:n.name,sectionName:r?we:je,subMenuItems:i};e.push(l)}));return[{key:{type:"record_count"},name:(0,m().Hk)({aggregation:{aggregator:"count"},databaseType:x,intl:c})||"",sectionName:be},...e]}),[C,w,v,x,c,b]),M=(0,r().VK)((()=>o&&(0,a().lY)(o)?()=>(0,Y().t)(f.errorIcon):mo),[o,f.errorIcon]),k=n.useCallback((e=>{h&&t&&b&&Ve({environment:u,menuItem:e,chartConfig:t,collectionSchema:v,collectionViewStore:h,collectionContextStore:g,mainPropertyId:b})}),[t,g,v,h,u,b]);return(0,y.jsx)(F().Z,{textWrap:!0,placement:K().Placement.Left,disableTooltip:!o||!(0,a().lY)(o),renderTooltip:e=>o?(0,y.jsx)("span",{...e,children:(0,oe().e)(o)}):null,render:e=>(0,y.jsx)(Te,{...e,collectionContextStore:g,selectedProperty:o&&!(0,a().se)(o)?void 0:j,properties:_,handlePropertySelect:k,originProps:{title:(0,y.jsx)("span",{children:(0,y.jsx)(d()._H,{...m().wh.chartWhatToShow})}),icon:M},callsite:"aggregation_property",disabled:s,rightStyle:S.whatToShowRightText})})}function bo(e){let{chartConfig:t,chartError:o,disabled:s}=e;const c=(0,d().YB)(),u=(0,i().O7)(),g=(0,p().Y$)(),f=(0,l().yK)((e=>({errorIcon:{...(0,m().FV)(e),width:18,height:18,marginLeft:4}})),[]),S=(0,m().kM)(),h=(0,r().Kw)(g.normalizedSchemaStore),x=(0,r().VK)((()=>g.collectionViewStore()),[g]),v=(0,r().VK)((()=>{var e,o,n,i,r;if(!t||"groups_reducer"!==(null===(e=t.dataConfig)||void 0===e?void 0:e.type))return;const l=t.dataConfig.aggregationConfig,a="formula"===(null===(o=l.stackOptions)||void 0===o?void 0:o.groupBy.type)?null===(n=l.stackOptions)||void 0===n?void 0:n.groupBy.groupBy:null===(i=l.stackOptions)||void 0===i?void 0:i.groupBy,s=null===(r=l.stackOptions)||void 0===r?void 0:r.groupBy.property;return a&&s?(0,z().TD)(a)||(0,z().ib)(a)?{type:"property_group",property:s,groupByOption:a.groupBy}:{type:"property_group",property:s}:{type:"none"}}),[t]),C=(0,r().VK)((()=>{const e=(0,Z().qP)(h),t=[],o={key:{type:"none"},name:Oe().Z.formatMessage(m().wh.noneMenuItem),sectionName:be};return t.push(o),e.forEach((e=>{let[o,n]=e;if(n)if((0,z().H1)(n.type))t.push({key:{type:"property_group",property:o},name:n.name,sectionName:be,subMenuItems:z().vu.map((e=>({key:{type:"property_group",property:o,groupByOption:e},name:c.formatMessage(Ae().ci[e]),sectionName:be})))});else if((0,E().f3)(n))t.push({key:{type:"property_group",property:o},name:n.name,sectionName:be,subMenuItems:z().z8.map((e=>({key:{type:"property_group",property:o,groupByOption:e},name:c.formatMessage(Ae().aK[e]),sectionName:be})))});else{if(!(0,z().LG)(n))return;t.push({key:{type:"property_group",property:o},name:n.name,sectionName:be})}})),t}),[h,c]),b=(0,r().VK)((()=>o&&(0,a().C)(o)?()=>(0,Y().t)(f.errorIcon):Bt),[o,f.errorIcon]),w=n.useCallback(((e,o)=>{var n,i;const r=(0,W().Qm)({schema:h,property:e});if(!x||!r||!t||"groups_reducer"!==(null===(n=t.dataConfig)||void 0===n?void 0:n.type))return;const l=(0,E().qV)({property:e,propertySchema:r,groupByOption:o,hideEmptyGroups:!0});if(!l||!(0,z().sM)(l.type))return;const a=$().Xh(t);if("groups_reducer"!==a.dataConfig.type)return;const s=t.dataConfig.aggregationConfig;let c;if(a.dataConfig.aggregationConfig={...s,stackOptions:{groupBy:l}},"bar"===t.type||"column"===t.type)c=E().UJ.normal;else if("line"===t.type){var d;c=null!==(d=t.chartFormat)&&void 0!==d&&d.axisCumulative?E().UJ.normal:E().UJ.side_by_side}const p=null===(i=t.chartFormat)||void 0===i?void 0:i.axisGroupStyle;a.chartFormat={...a.chartFormat,axisGroupStyle:p||c},ee().createAndCommit({userAction:"chartSettings.setYAxisStackBy",environment:u,canUndo:!0,perform:e=>{X().sW({store:x.getFormatStore().getKeyStore("chart_config"),data:a,transaction:e}),"week"===o&&co().$P(x,e)}}),J().wd({environment:u,collectionContextStore:g,action:"charts_y_axis_group_by",charts_analytics_context:(0,te().aL)(g)})}),[h,t,x,u,g]),j=n.useCallback((()=>{var e;if(!t||"groups_reducer"!==(null===(e=t.dataConfig)||void 0===e?void 0:e.type))return;const o=t.dataConfig.aggregationConfig;x&&ee().createAndCommit({userAction:"chartSettings.clearYAxisStackBy",environment:u,canUndo:!0,perform:e=>{if(o){const n=$().Xh(t);if("groups_reducer"!==n.dataConfig.type)return;n.dataConfig.aggregationConfig={...o,stackOptions:void 0},X().sW({store:x.getFormatStore().getKeyStore("chart_config"),data:n,transaction:e})}}})}),[x,t,u]),_=n.useCallback((e=>{const{key:t}=e;if("none"===t.type)j();else{const{property:e,groupByOption:o}=t;w(e,o)}}),[j,w]);return(0,y.jsx)(F().Z,{textWrap:!0,placement:K().Placement.Left,disableTooltip:!o||!(0,a().C)(o),renderTooltip:e=>o?(0,y.jsx)("span",{...e,children:(0,oe().e)(o)}):null,render:e=>(0,y.jsx)(Te,{...e,collectionContextStore:g,selectedProperty:v,properties:C,handlePropertySelect:_,originProps:{title:(0,y.jsx)("span",{style:Q().Yu,children:(0,y.jsx)(d()._H,{...m().wh.chartGroupBy})}),icon:b},callsite:"y_axis_stacked_groups",disabled:s,rightStyle:S.groupByRightText})})}function wo(e){let{chartConfig:t,disabled:o}=e;const l=(0,i().O7)(),a=(0,p().Y$)(),s=(0,r().VK)((()=>a.collectionViewStore()),[a]),c=(0,r().VK)((()=>{var e;return Boolean(null==t||null===(e=t.chartFormat)||void 0===e?void 0:e.axisCumulative)}),[t]),u=(0,n.useCallback)((()=>{var e,o;if(!s||!t)return;const n=$().Xh(t),i=!(null!==(e=n.chartFormat)&&void 0!==e&&e.axisCumulative);n.chartFormat={...n.chartFormat,axisCumulative:i};const r=Boolean("groups_reducer"===n.dataConfig.type&&(null===(o=n.dataConfig)||void 0===o||null===(o=o.aggregationConfig)||void 0===o||null===(o=o.stackOptions)||void 0===o?void 0:o.groupBy));"line"===t.type&&r&&i&&(n.chartFormat={...n.chartFormat,axisGroupStyle:E().UJ.normal}),ee().createAndCommit({userAction:"chartSettings.setCumulative",environment:l,canUndo:!0,perform:e=>{X().sW({store:s.getFormatStore().getKeyStore("chart_config"),data:n,transaction:e})}}),J().wd({environment:l,collectionContextStore:a,action:"charts_y_axis_cumulative",charts_analytics_context:(0,te().aL)(a)})}),[t,s,l,a]);return t&&!(0,ft().d)(t)?null:(0,y.jsx)(Et().Z,{title:(0,y.jsx)(d()._H,{...m().wh.chartCumulative}),switcherProps:{on:c},onClick:u,icon:go,iconStyle:{height:18},disabled:o})}function jo(e){const{chartConfig:t,disabled:o}=e,a=null==t?void 0:t.chartFormat,s=(0,i().O7)(),c=(0,i().Fy)(),g=(0,d().YB)(),f=(0,r().qz)(void 0,xe().Z),S=(0,p().Y$)(),h=(0,r().VK)((()=>S.collectionViewStore()),[S]),x=void 0!==(null==a?void 0:a.yAxisMin)||void 0!==(null==a?void 0:a.yAxisMax),[v,C]=(0,n.useState)(void 0!==(null==a?void 0:a.yAxisMin)&&void 0!==(null==a?void 0:a.yAxisMax)&&a.yAxisMin>a.yAxisMax),[b,w]=(0,n.useState)(void 0!==(null==a?void 0:a.yAxisMin)&&void 0!==(null==a?void 0:a.yAxisMax)&&a.yAxisMin>a.yAxisMax),j=(0,n.useCallback)((e=>{if(!h||!t)return;var o,n;if("yAxisMin"in e&&"yAxisMax"in e){if(e.yAxisMin===(null===(o=t.chartFormat)||void 0===o?void 0:o.yAxisMin)&&e.yAxisMax===(null===(n=t.chartFormat)||void 0===n?void 0:n.yAxisMax))return}else if("yAxisMin"in e){var i;if(e.yAxisMin===(null===(i=t.chartFormat)||void 0===i?void 0:i.yAxisMin))return}else if("yAxisMax"in e){var r;if(e.yAxisMax===(null===(r=t.chartFormat)||void 0===r?void 0:r.yAxisMax))return}if("yAxisMin"in e){const t=void 0!==e.yAxisMin&&void 0!==(null==a?void 0:a.yAxisMax)&&e.yAxisMin>a.yAxisMax;if(C(t),t)return;void 0===e.yAxisMin&&C(!1)}if("yAxisMax"in e){const t=void 0!==e.yAxisMax&&void 0!==(null==a?void 0:a.yAxisMin)&&e.yAxisMax<a.yAxisMin;if(w(t),t)return;void 0===e.yAxisMax&&w(!1)}const l=h.getAxisChartFormatStore();l&&(ee().createAndCommit({userAction:"chartSettings.setYAxisRange",environment:s,canUndo:!0,perform:t=>{X().sW({store:l,data:$().Q8(e,(e=>void 0===e?null:e)),transaction:t})}}),J().wd({environment:s,collectionContextStore:S,action:"charts_y_axis_range",charts_analytics_context:(0,te().aL)(S)}))}),[t,null==a?void 0:a.yAxisMax,null==a?void 0:a.yAxisMin,S,h,s]),_=(0,n.useCallback)((e=>j({yAxisMin:e})),[j]),M=(0,n.useCallback)((e=>j({yAxisMax:e})),[j]),k=(0,n.useCallback)((()=>j({yAxisMin:void 0,yAxisMax:void 0})),[j]),P=(0,l().yK)((e=>({container:{paddingBottom:16},icon:{transform:"bar"===(null==t?void 0:t.type)?"rotate(90deg)":void 0,height:18},errorIcon:{...(0,m().FV)(e),width:18,height:18,marginLeft:4},title:{display:"flex",justifyContent:"space-between",width:"100%"},resetButton:{float:"right",color:e.blueColor,cursor:"pointer"},inputContainer:{display:"flex",paddingLeft:14,paddingRight:14},separator:{color:e.mediumTextColor,margin:"0 8px"}})),[null==t?void 0:t.type]);return(0,y.jsx)(ce().Z,{focused:!1,popupType:c.isMobile?se().Z4.SlideUp:se().Z4.Popup,alignmentToOrigin:se().vR.End,placementToOrigin:se().pO.Bottom,buttonPopupStore:f,renderOrigin:e=>(0,y.jsx)(ve().Z,{...e,showChevron:!0,title:(0,y.jsx)(d()._H,{...m().wh.chartYAxisRange}),rotateChevron:f.state.open,icon:kt().x,iconStyle:P.icon,disabled:o,right:(0,y.jsx)(d()._H,{...x?m().wh.chartYAxisRangeCustom:m().wh.chartYAxisRangeAuto})}),render:()=>(0,y.jsx)(u().Z,{topBorder:!1,disableMobileBorders:!0,title:(0,y.jsx)("div",{style:P.title,children:(0,y.jsx)(d()._H,{...m().wh.chartYAxisRangeMenu})}),right:x?(0,y.jsx)(B().Z,{style:P.resetButton,onClick:k,children:(0,y.jsx)(d()._H,{...m().wh.chartYAxisRangeReset})}):void 0,isTitleUppercase:!1,style:P.container,children:(0,y.jsxs)("div",{style:P.inputContainer,children:[(0,y.jsx)(ho().V,{value:null==a?void 0:a.yAxisMin,onBlur:_,onKeyDown:_,inputProps:{placeholder:g.formatMessage(m().wh.chartYAxisRangeMinPlaceholder),errorOutline:v}}),(0,y.jsx)("span",{style:P.separator,children:"-"}),(0,y.jsx)(ho().V,{value:null==a?void 0:a.yAxisMax,onBlur:M,onKeyDown:M,inputProps:{placeholder:g.formatMessage(m().wh.chartYAxisRangeMaxPlaceholder),errorOutline:b}})]})})})}function _o(e){const{chartConfig:t,disabled:o}=e,a=null==t?void 0:t.chartFormat,s=(0,i().O7)(),c=(0,d().YB)(),u=(0,p().Y$)(),g=(0,r().VK)((()=>u.collectionViewStore()),[u]),m=(0,r().VK)((()=>u.normalizedSchemaStore.state),[u]),f=(0,r().VK)((()=>null==t?void 0:t.dataConfig),[t]),S=(0,r().VK)((()=>{if(f&&"results_reducer"===f.type)return f.valueProperty}),[f]),h=(0,r().VK)((()=>{if(S)return(0,W().Qm)({schema:m,property:S})}),[S,m]),x=(0,r().VK)((()=>h?(0,xo().NX)(h):void 0),[h]),v=(0,n.useMemo)((()=>{const e=So().yF.map((e=>({key:e,type:"button",title:(0,vo().S)(c,e)})));return x&&"precision_uncapped"!==x?[...e,{key:"precision_from_number_property",type:"button",title:c.formatMessage({id:"collection.chartYAxisSettings.fromNumberProperty",defaultMessage:"Use property value ({value})"},{value:So().T4[x]})}]:e}),[c,x]),C=(0,n.useCallback)((e=>{if(!g||!t)return;const o=g.getAxisChartFormatStore();o&&(ee().createAndCommit({userAction:"chartSettings.setYAxisPrecision",environment:s,canUndo:!0,perform:t=>{X().sW({store:o,data:{numberPrecisionOverride:e},transaction:t})}}),J().wd({environment:s,collectionContextStore:u,action:"charts_y_axis_precision",charts_analytics_context:(0,te().aL)(u)}))}),[t,u,g,s]),b=(0,l().yK)((()=>({icon:{height:18}})),[]);return(0,y.jsx)(F().Z,{placement:K().Placement.Right,textWrap:!0,renderTooltip:()=>(0,y.jsx)(d()._H,{defaultMessage:"Rounding defaults to 2 decimal places. Use this setting to override.",id:"database.chartSettings.numberOptions.numberPrecision.tooltip"}),render:e=>(0,y.jsx)(wt().Z,{...e,icon:fo,iconStyle:b.icon,title:(0,y.jsx)(d()._H,{defaultMessage:"Decimal places",id:"database.chartSettings.numberOptions.numberPrecision"}),selectedKey:(null==a?void 0:a.numberPrecisionOverride)??So().N3,options:v,onChange:C,disabled:o})})}function Mo(e){let{disabled:t}=e;const o=(0,i().O7)(),l=(0,p().Y$)(),a=(0,r().VK)((()=>l.collectionStore()),[l]),s=(0,r().VK)((()=>{var e;return Boolean(null==a||null===(e=a.getFormat())||void 0===e?void 0:e.subitem_property)}),[a]),c=(0,r().VK)((()=>l.collectionViewStore()),[l]),u=(0,r().VK)((()=>null==c?void 0:c.getFormat()),[c]),g=(0,r().VK)((()=>"flattened"===(null==u?void 0:u.subitem_display_mode)),[u]),f=(0,n.useCallback)((()=>{const e=null==c?void 0:c.getFormatStore();if(!e)return;const t="flattened"===(null==u?void 0:u.subitem_display_mode)?void 0:"flattened";ee().createAndCommit({userAction:"chartSettings.setCountSubitems",environment:o,canUndo:!0,perform:o=>{X().sO({store:e.getKeyStore("subitem_display_mode"),transaction:o,value:t})}}),J().wd({environment:o,collectionContextStore:l,action:"charts_set_subitems",charts_analytics_context:(0,te().aL)(l)})}),[c,o,l,u]);return s?(0,y.jsx)(Et().Z,{title:(0,y.jsx)(d()._H,{...m().wh.chartIncludeSubitems}),switcherProps:{on:g},onClick:f,icon:yo().Y,iconStyle:{height:18},disabled:t}):null}var ko=()=>o(221362);function Po(e){let{collectionContextStore:t,collectionSettingsStore:n}=e;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(o(291308).Z,{collectionContextStore:t}),(0,y.jsx)(o(43143).Z,{collectionContextStore:t}),(0,y.jsx)(o(812531).Z,{collectionContextStore:t,collectionSettingsStore:n}),(0,y.jsx)(o(861343).Z,{collectionContextStore:t,collectionSettingsStore:n})]})}const To=n.memo((function(e){let{collectionSettingsStore:t}=e;const n=(0,i().O7)(),l=(0,d().YB)(),f=(0,p().Y$)(),S=(0,r().VK)((()=>f.normalizedSchemaStore.state),[f.normalizedSchemaStore]),h=(0,r().VK)((()=>f.collectionViewStore()),[f]),x=(0,r().VK)((()=>f.normalizedFormatStore.state.chart_config),[f.normalizedFormatStore]),{canViewChart:v}=(0,o(186923).n)({collectionContextStore:f}),C=!v,b=(0,r().VK)((()=>{const e=(0,a().SO)({chartConfig:x,collectionSchema:S});if(void 0!==e)return e;return h?f.chartErrorStore.getState().get(h.id):void 0}),[x,f.chartErrorStore,S,h]),w=(0,r().VK)((()=>f.isInHomeWidgetStore.state),[f]),j=(0,r().VK)((()=>{var e;const t=null===(e=f.collectionViewBlockStore())||void 0===e?void 0:e.id;return!!t&&(0,o(718959).qG)(t)}),[f]),_=(0,r().VK)((()=>j?{feature:"tasks",from:"tasks_more_menu"}:{feature:"custom_db",from:"custom_db_more_menu"}),[j]),M=!(0,r().VK)((()=>f.permissionScopesStore.state),[f.permissionScopesStore]).canConfigureBlock||C,k=Fo(M);return h&&S&&x&&"placeholder"!==x.type?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(u().Z,{children:(0,y.jsx)(o(796427).$$,{collectionContextStore:f,collectionSettingsStore:t})}),(0,y.jsx)(u().Z,{topBorder:!0,title:l.formatMessage(m().wh.chartType),mobileStyle:{boxShadow:"none"},desktopTitleStyle:k.disabled,mobileTitleStyle:k.disabled,children:(0,y.jsx)(O,{chartConfig:x,disabled:M})}),"donut"===x.type?(0,y.jsx)(Vo,{chartConfig:x,chartError:b,disabled:M}):null,(0,s().u)(x)?"bar"===x.type?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Zo,{chartConfig:x,chartError:b,disabled:M,useXAxisLabel:!0}),(0,y.jsx)(Ao,{collectionViewStore:h,chartConfig:x,chartError:b,disabled:M,useYAxisLabel:!0})]}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Ao,{collectionViewStore:h,chartConfig:x,chartError:b,disabled:M}),(0,y.jsx)(Zo,{chartConfig:x,chartError:b,disabled:M})]}):null,(0,y.jsx)(Bo,{collectionContextStore:f,chartConfig:x,paywallDisabled:Boolean(C)}),(0,y.jsx)(Io,{collectionContextStore:f,collectionSettingsStore:t,paywallDisabled:Boolean(C)}),(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(u().Z,{topBorder:!0,children:[(0,y.jsx)(nt,{chartConfig:x,disabled:M}),(0,y.jsx)(Po,{collectionContextStore:f,collectionSettingsStore:t}),w&&(0,y.jsx)(ve().Z,{icon:c().D,isPadded:!0,title:l.formatMessage(o(496291).Iu.hide),showChevron:!1,onClick:()=>{g().default.state.currentSpaceViewStore&&o(140798).aG({environment:n,currentSpaceViewStore:g().default.state.currentSpaceViewStore,..._})}})]}),(0,y.jsx)(u().Z,{topBorder:!0,children:(0,y.jsx)(o(576447).Z,{href:(0,o(148126).UY)("guides.charts"),title:(0,y.jsx)(d()._H,{...m().wh.chartHelp}),analyticsFrom:"view_settings_charts_help"})})]})]}):null}));function Io(e){const{collectionContextStore:t,collectionSettingsStore:n,paywallDisabled:i}=e;return(0,y.jsxs)(u().Z,{topBorder:!0,shouldShowBottomDivider:!0,style:{marginTop:8,marginBottom:8,paddingBottom:0},children:[(0,y.jsx)(o(307190).Z,{collectionContextStore:t,collectionSettingsStore:n,disabled:i}),(0,y.jsx)(o(543020).Z,{collectionContextStore:t,collectionSettingsStore:n,disabled:i})]})}function Vo(e){const t=Fo(e.disabled);return(0,y.jsxs)(u().Z,{title:(0,y.jsx)(d()._H,{...m().wh.chartData}),desktopTitleStyle:t.disabled,mobileTitleStyle:t.disabled,children:[(0,y.jsx)(Ze,{...e}),(0,y.jsx)(Be,{...e}),(0,y.jsx)(jt,{...e,sortType:"main"}),(0,y.jsx)(Mo,{disabled:e.disabled})]})}function Ao(e){const{collectionViewStore:t,useYAxisLabel:o,...n}=e,i=Fo(e.disabled),l=(0,r().VK)((()=>{if("groups_reducer"===e.chartConfig.dataConfig.type)return e.chartConfig.dataConfig.groupBy}),[e.chartConfig.dataConfig]);return(0,y.jsxs)(u().Z,{title:o?(0,y.jsx)(d()._H,{...m().wh.chartYAxis}):(0,y.jsx)(d()._H,{...m().wh.chartXAxis}),desktopTitleStyle:i.disabled,mobileTitleStyle:i.disabled,children:[(0,y.jsx)(uo,{...n}),l?(0,y.jsx)(ko().q,{groupBy:l}):null,(0,y.jsx)(jt,{...n,sortType:"main"}),(0,y.jsx)(po,{...e})]})}function Zo(e){var t,o;const{useXAxisLabel:n,disabled:i}=e,l=Fo(i),a=(0,r().VK)((()=>{var t;if("results_reducer"===e.chartConfig.dataConfig.type)return;return null===(t=e.chartConfig.dataConfig.aggregationConfig.stackOptions)||void 0===t?void 0:t.groupBy}),[e.chartConfig.dataConfig]),s=(0,r().VK)((()=>{var t;const o=null===(t=e.chartConfig)||void 0===t?void 0:t.dataConfig;return"results_reducer"===(null==o?void 0:o.type)||"groups_reducer"===(null==o?void 0:o.type)&&("max"===o.aggregationConfig.aggregation.aggregator||"min"===o.aggregationConfig.aggregation.aggregator||"median"===o.aggregationConfig.aggregation.aggregator||"average"===o.aggregationConfig.aggregation.aggregator||"sum"===o.aggregationConfig.aggregation.aggregator)}),[null===(t=e.chartConfig)||void 0===t?void 0:t.dataConfig]);return(0,y.jsxs)(u().Z,{title:n?(0,y.jsx)(d()._H,{...m().wh.chartXAxis}):(0,y.jsx)(d()._H,{...m().wh.chartYAxis}),desktopTitleStyle:l.disabled,mobileTitleStyle:l.disabled,children:[(0,y.jsx)(Co,{...e}),s&&(0,y.jsx)(_o,{...e}),"groups_reducer"!==(null===(o=e.chartConfig)||void 0===o||null===(o=o.dataConfig)||void 0===o?void 0:o.type)?null:(0,y.jsx)(bo,{...e}),a?(0,y.jsx)(ko().q,{groupBy:a}):null,a?(0,y.jsx)(jt,{...e,sortType:"stacked"}):null,(0,y.jsx)(wo,{...e}),(0,y.jsx)(jo,{...e}),(0,y.jsx)(Mo,{disabled:e.disabled})]})}function Bo(e){let{collectionContextStore:t,chartConfig:o,paywallDisabled:n}=e;const i=(0,r().VK)((()=>t.collectionViewStore()),[t]),l=(0,r().VK)((()=>t.permissionScopesStore.state),[t.permissionScopesStore]),a=(0,r().VK)((()=>!o||!l.canConfigureBlock||n),[o,l.canConfigureBlock,n]),s=Fo(a);return i&&o&&"placeholder"!==o.type?(0,y.jsxs)(u().Z,{title:(0,y.jsx)(d()._H,{...m().wh.chartStyle}),desktopTitleStyle:s.disabled,mobileTitleStyle:s.disabled,children:[(0,y.jsx)(Ut,{collectionViewStore:i,chartConfig:o,disabled:a}),(0,y.jsx)(zt,{collectionViewStore:i,chartConfig:o,disabled:a})]}):null}function Fo(e){return(0,l().yK)((()=>({disabled:{opacity:e?.4:void 0}})),[e])}},705670:(e,t,o)=>{"use strict";o.d(t,{l:()=>m});o(667294);var n=()=>o(219727),i=()=>o(846550),r=()=>o(367250),l=()=>o(788860),a=()=>o(154186),s=()=>o(654133),c=()=>o(514),d=()=>o(644248),u=()=>o(998901),p=o(785893);const g=(0,l().vU)({addDescriptionTooltip:{id:"database.description.addDescriptionTooltip",defaultMessage:"Add description"},editDescriptionTooltip:{id:"database.description.editDescriptionTooltip",defaultMessage:"Edit description"}});function m(e){let{onClick:t,description:o,showTooltip:m,addDescriptionText:f,editDescriptionText:y,disabled:S}=e;const{isMobile:h}=(0,n().Fy)(),[x,v]=(0,d().C)(),C=(0,l().YB)(),b=(0,i().yK)((e=>({button:{flexShrink:0,flexGrow:0,borderRadius:h?24:20,marginLeft:4},info:{width:h?18:16,height:h?18:16,fill:v&&!S?e.regularIconColor:e.mediumIconColor}})),[v,h,S]);return(0,p.jsx)(s().Z,{renderTooltip:e=>(0,p.jsx)("div",{...e,children:null!=o&&o.length?o:f??C.formatMessage(g.addDescriptionTooltip)}),disableTooltip:!m||S,style:c().F6,placement:u().Placement.Top,render:e=>(0,p.jsx)(a().Z,{...e,ref:x,onClick:t,"aria-label":null!=o&&o.length?f:y??C.formatMessage(g.editDescriptionTooltip),style:b.button,disabled:S,disabledFeedback:S,children:(0,r().N)(b.info)})})}},678523:(e,t,o)=>{"use strict";o.d(t,{i:()=>g,k:()=>u});var n=o(667294),i=()=>o(219727),r=()=>o(846550),l=()=>o(788860),a=()=>o(740046),s=()=>o(388284),c=()=>o(514),d=o(785893);const u=(0,l().vU)({descriptionHeader:{id:"database.viewSettings.propertyTab.description.title",defaultMessage:"Description"},addDescription:{id:"database.viewSettings.propertyTab.description.addDescription",defaultMessage:"Add a description..."}}),p=60;function g(e){let{initialDescription:t,handleSaveDescription:o,disableAutoSection:g}=e;const[m,f]=(0,n.useState)(t??""),y=(0,n.useRef)(m),{isMobile:S}=(0,i().Fy)(),h=(0,l().YB)(),x=(0,r().yK)((e=>({title:{display:"flex",alignItems:"center",gap:4,cursor:"default",color:e.mediumTextColor},infoTooltip:{width:300,whiteSpace:"normal"},menuItem:{padding:S?"8px 0":"4px 0"},descriptionInput:{lineHeight:"20px",fontSize:S?14:13}})),[S]),v=(0,n.useCallback)((()=>o(y.current)),[o]);(0,n.useEffect)((()=>()=>v()),[v]);const C=(0,n.useMemo)((()=>(0,d.jsx)(a().ZP,{value:m,onChange:e=>{f(e.target.value),y.current=e.target.value},onBlur:v,onSubmit:v,placeholder:h.formatMessage(u.addDescription),focusInitial:!0,disabled:!1,style:x.menuItem,inputOuterStyle:x.descriptionInput,textarea:!0,textareaSubmitOnEnter:!0,maxlength:c().pT,autosize:!0,autosizeMaxHeight:p,showClearButton:!1})),[m,h,v,x.descriptionInput,x.menuItem]);return S&&!g?(0,d.jsx)(s().Z,{topBorder:!0,title:(0,d.jsx)("span",{style:x.title,children:h.formatMessage(u.descriptionHeader)}),children:C}):C}},888686:(e,t,o)=>{"use strict";o.d(t,{A:()=>_m});var n=o(667294),i=()=>o(219727),r=()=>o(142735),l=()=>o(342792),a=()=>o(491927),s=()=>o(139224),c=()=>o(421654),d=()=>o(269299),u=()=>o(843307),p=()=>o(291198),g=()=>o(94967),m=(o(670560),o(241792),()=>o(730120)),f=()=>o(846550),y=()=>o(714230),S=()=>o(801812),h=()=>o(874650),x=()=>o(135796),v=()=>o(827282),C=o(785893);const b=(0,v().IU)("checkboxSquareCheckedDotted",{viewBox:"0 0 16 16",svg:(0,C.jsx)("path",{d:"M3.243 2.712a.648.648 0 00.465.191.664.664 0 00.478-.191.636.636 0 00.199-.465.652.652 0 00-.199-.479.652.652 0 00-.478-.198.636.636 0 00-.465.198.664.664 0 00-.191.479.65.65 0 00.19.465zm2.14 0a.656.656 0 00.471.191c.183 0 .34-.064.472-.191a.626.626 0 00.205-.465.641.641 0 00-.205-.479.644.644 0 00-.472-.198.664.664 0 00-.663.677c0 .178.064.332.192.465zm2.14 0A.664.664 0 008 2.903c.182 0 .34-.064.471-.191a.636.636 0 00.199-.465.652.652 0 00-.199-.479A.644.644 0 008 1.57a.664.664 0 00-.67.677c0 .178.064.332.191.465zm2.146 0c.132.127.29.191.471.191a.641.641 0 00.472-.191.637.637 0 00.198-.465.652.652 0 00-.198-.479.63.63 0 00-.472-.198.644.644 0 00-.471.198.652.652 0 00-.199.479.64.64 0 00.199.465zm2.14 0a.68.68 0 00.478.191.633.633 0 00.465-.191.636.636 0 00.198-.465.652.652 0 00-.198-.479.622.622 0 00-.465-.198.652.652 0 00-.479.198.652.652 0 00-.198.479c0 .178.066.332.198.465zm1.476 1.47a.65.65 0 00.472.198.63.63 0 00.471-.199.644.644 0 00.199-.471.644.644 0 00-.199-.472.63.63 0 00-.471-.198.644.644 0 00-.472.198.656.656 0 00-.191.472c0 .182.063.34.19.471zm0 2.139c.132.132.29.198.472.198a.63.63 0 00.471-.198.644.644 0 00.199-.472.644.644 0 00-.199-.471.63.63 0 00-.471-.199.644.644 0 00-.472.199.656.656 0 00-.191.471c0 .183.063.34.19.472zm0 2.146c.132.133.29.199.472.199a.63.63 0 00.471-.199.644.644 0 00.199-.471.652.652 0 00-.199-.479.63.63 0 00-.471-.198.634.634 0 00-.472.205.656.656 0 00-.191.472c0 .182.063.34.19.471zm0 2.147c.132.132.29.198.472.198a.63.63 0 00.471-.198.644.644 0 00.199-.472.644.644 0 00-.199-.471.62.62 0 00-.471-.205.634.634 0 00-.472.205.656.656 0 00-.191.471c0 .183.063.34.19.472zm0 2.14c.132.132.29.198.472.198a.63.63 0 00.471-.198.644.644 0 00.199-.472.644.644 0 00-.199-.472.63.63 0 00-.471-.198.644.644 0 00-.472.198.656.656 0 00-.191.472c0 .182.063.34.19.472zm-1.477 1.476a.667.667 0 00.479.198.622.622 0 00.465-.198.636.636 0 00.198-.465.652.652 0 00-.198-.478.622.622 0 00-.465-.198.652.652 0 00-.479.198.652.652 0 00-.198.478c0 .178.066.333.198.465zm-2.14 0a.667.667 0 00.48.198.622.622 0 00.464-.198.637.637 0 00.198-.465.652.652 0 00-.198-.478.622.622 0 00-.465-.198.652.652 0 00-.478.198.652.652 0 00-.199.478c0 .178.067.333.199.465zm-2.146 0a.66.66 0 00.486.198.622.622 0 00.464-.198.637.637 0 00.199-.465.652.652 0 00-.199-.478.636.636 0 00-.464-.198.664.664 0 00-.677.677c0 .177.064.332.191.464zm-2.14 0c.133.132.29.198.472.198a.652.652 0 00.479-.198.637.637 0 00.198-.465.652.652 0 00-.198-.478.652.652 0 00-.479-.198.664.664 0 00-.663.677c0 .177.064.332.192.464zm-2.14 0c.133.132.29.198.473.198.182 0 .34-.066.471-.198a.637.637 0 00.199-.465.652.652 0 00-.199-.478.644.644 0 00-.471-.198.664.664 0 00-.663.677c0 .177.063.332.19.464zm-1.476-1.476a.652.652 0 00.479.198.622.622 0 00.465-.198.644.644 0 00.198-.472.644.644 0 00-.198-.472.622.622 0 00-.465-.198.644.644 0 00-.472.198.644.644 0 00-.198.472c0 .182.064.34.191.472zm0-2.14a.652.652 0 00.479.198.622.622 0 00.465-.198.644.644 0 00.198-.472.644.644 0 00-.198-.471.612.612 0 00-.465-.205.634.634 0 00-.472.205.644.644 0 00-.198.471c0 .183.064.34.191.472zm0-2.147a.652.652 0 00.479.199.622.622 0 00.465-.199.644.644 0 00.198-.471.652.652 0 00-.198-.479.622.622 0 00-.465-.198.634.634 0 00-.472.205.644.644 0 00-.198.472c0 .182.064.34.191.471zm0-2.146a.652.652 0 00.479.198.622.622 0 00.465-.198.644.644 0 00.198-.472.644.644 0 00-.198-.471.622.622 0 00-.465-.199.644.644 0 00-.472.199.644.644 0 00-.198.471c0 .183.064.34.191.472zm0-2.14a.652.652 0 00.479.199.622.622 0 00.465-.199.644.644 0 00.198-.471.63.63 0 00-.198-.472.622.622 0 00-.465-.198.644.644 0 00-.472.198.644.644 0 00-.198.472c0 .182.064.34.191.471zm5.161 6.973a.7.7 0 00.342.082c.255 0 .456-.116.602-.349l3.056-4.778a1.27 1.27 0 00.116-.219.587.587 0 00.054-.239.506.506 0 00-.191-.41.661.661 0 00-.43-.157c-.215 0-.393.116-.534.348l-2.7 4.327L5.97 8.146a.713.713 0 00-.252-.225.567.567 0 00-.28-.069.568.568 0 00-.425.185.599.599 0 00-.17.43c0 .155.059.308.177.458l1.614 1.97c.095.113.193.2.293.259z",clipRule:"evenodd"})}),w=(0,v().IU)("cursorArrowClickRays",{viewBox:"0 0 16 16",svg:(0,C.jsx)("path",{d:"M7.997 3.766a.604.604 0 01-.595-.595V1.175c0-.322.274-.595.595-.595.328 0 .602.273.602.595V3.17a.606.606 0 01-.602.595zM4.948 4.955a.594.594 0 01-.84 0L2.705 3.54a.607.607 0 010-.84.607.607 0 01.84.006l1.402 1.408a.594.594 0 010 .841zm6.023.068a.607.607 0 010-.84l1.422-1.415a.598.598 0 01.834 0 .602.602 0 010 .847l-1.409 1.408a.602.602 0 01-.847 0zm-3.514 7.725l.062-5.462c.006-.253.266-.349.437-.17l3.74 3.834c.184.198.054.445-.199.458l-1.476.062 1.23 2.843a.241.241 0 01-.11.329l-.683.266c-.123.055-.26-.013-.314-.137l-1.17-2.891-1.038 1.046c-.178.17-.486.089-.479-.178zM3.779 7.997a.606.606 0 01-.601.595H1.175a.604.604 0 01-.595-.595c0-.321.274-.595.595-.595h2.003c.328 0 .601.274.601.595zm8.45 0c0-.321.273-.595.594-.595h1.996c.329 0 .602.274.602.595a.606.606 0 01-.602.595h-1.996a.604.604 0 01-.595-.595zm-7.212 2.98a.594.594 0 010 .841l-1.409 1.409a.616.616 0 01-.847-.007.614.614 0 01.007-.841l1.408-1.402c.232-.225.622-.225.84 0z"})});var j=()=>o(491772),_=()=>o(456681),M=()=>o(229010);const k=(0,v().IU)("rightArrowEmpty",{viewBox:"0 0 22 18",svg:(0,C.jsx)("path",{d:"M21.582 8.955c0-.332-.117-.693-.498-1.055L13.379.693C12.86.205 12.539 0 12.06 0c-.683 0-1.171.537-1.171 1.191v3.692h-7.92c-1.543 0-2.442.879-2.442 2.392v3.37c0 1.513.899 2.392 2.442 2.392h7.92v3.73c0 .655.488 1.143 1.152 1.143.479 0 .87-.195 1.338-.635L21.084 10c.371-.352.498-.723.498-1.045zm-1.758 0c0 .059-.02.107-.097.186l-6.963 6.582a.219.219 0 01-.166.087c-.079 0-.137-.058-.137-.146v-3.78c0-.224-.098-.322-.322-.322h-9.15c-.626 0-.987-.36-.987-.996V7.354c0-.635.361-.997.986-.997h9.15c.225 0 .323-.097.323-.322V2.158c0-.078.059-.137.146-.137.059 0 .118.04.166.079l6.954 6.67c.068.068.097.126.097.185z"})});var P=()=>o(73108),T=()=>o(95886),I=()=>o(788860),V=()=>o(707513),A=()=>o(308186),Z=()=>o(918745),B=()=>o(205951),F=()=>o(446955),R=()=>o(864295),K=()=>o(926724),H=()=>o(605974),O=()=>o(396136),L=()=>o(856466),D=()=>o(955620),E=()=>o(855741),N=()=>o(696459),U=()=>o(96724),z=()=>o(86609),W=()=>o(826955);var q=()=>o(827973),G=()=>o(448419),Y=()=>o(108714),$=()=>o(198829),Q=()=>o(255577),J=()=>o(967092),X=()=>o(906651),ee=()=>o(388284),te=()=>o(667637),oe=()=>o(255933),ne=()=>o(306164),ie=()=>o(824462),re=()=>o(110232),le=()=>o(544903);const ae="https://www.notion.so/help/sprints",se=[1,2,3,4,5,6,7,8],ce={1:{key:"one_week",value:1},2:{key:"two_weeks",value:2},3:{key:"three_weeks",value:3},4:{key:"four_weeks",value:4},5:{key:"five_weeks",value:5},6:{key:"six_weeks",value:6},7:{key:"seven_weeks",value:7},8:{key:"eight_weeks",value:8}},de={MO:"Monday",TU:"Tuesday",WE:"Wednesday",TH:"Thursday",FR:"Friday",SA:"Saturday",SU:"Sunday"},ue=(0,I().vU)({sprintsMenuTitle:{id:"sprintSettingsMenu.label",defaultMessage:"Sprints"},setupSprintsTitle:{id:"sprintSettingsMenu.setupSprints.label",defaultMessage:"Set up sprints"},setupSprintsCaption:{id:"sprintSettingsMenu.setupSprints.caption",defaultMessage:"Use sprints to regularly tackle a group of tasks in a recurring, set amount of time."},setupSprintsTeamspaceStatement:{id:"sprintSettingsMenu.setupSprintsTeamspaceStatement.caption",defaultMessage:"We'll also add to your teamspace:"},setupSprintsSprintBoardPageStatement:{id:"sprintSettingsMenu.setupSprintsSprintBoardPageStatement.caption",defaultMessage:"<bold>Sprint board</bold>: To manage tasks and plan your work"},setupSprintsSprintsDatabaseStatement:{id:"sprintSettingsMenu.setupSprintsSprintsDatabaseStatement.caption",defaultMessage:"<bold>Sprints database</bold>: To keep a historical record of what you accomplished"},manual:{id:"sprintSettingsMenu.manual.label",defaultMessage:"Manual"},automatic:{id:"sprintSettingsMenu.automatic.label",defaultMessage:"Auto"},off:{id:"sprintSettingsMenu.off.label",defaultMessage:"Off"},completeSprintNextSprintActionMenuOptionText:{id:"sprintSettingsMenu.remainingTasks.moveToNextSprintOption.label",defaultMessage:"Move to next sprint"},completeSprintNextSprintActionSelectedText:{id:"sprintSettingsMenu.remainingTasks.moveToNextSprintOption.selected.label",defaultMessage:"Next sprint"},completeSprintBacklogActionMenuOptionText:{id:"sprintSettingsMenu.remainingTasks.moveToBacklogOption.label",defaultMessage:"Move to backlog"},completeSprintBacklogActionSelectedText:{id:"sprintSettingsMenu.remainingTasks.moveToBacklogOption.selected.label",defaultMessage:"Backlog"},completeSprintKeepInCurrentSprintActionMenuOptionText:{id:"sprintSettingsMenu.remainingTasks.keepInCurrentSprint.label",defaultMessage:"Keep in current sprint"},completeSprintKeepInCurrentSprintActionSelectedText:{id:"sprintSettingsMenu.remainingTasks.keepInCurrentSprint.selected.label",defaultMessage:"Current sprint"},automatedSprintsToggleTitle:{id:"sprintSettingsMenu.automatedSprintsToggle.label",defaultMessage:"Automated sprints"},automatedSprintsToggleCaption:{id:"sprintSettingsMenu.automatedSprintsToggle.caption",defaultMessage:"Sprints complete automatically before the start of the next sprint."},duration:{id:"sprintSettingsMenu.duration.label",defaultMessage:"Duration"},durationMenuOptionText:{id:"sprintSettingsMenu.duration.option.label",defaultMessage:"{durationValue, plural, one {1 week} other {{durationValue} weeks}}"},startOn:{id:"sprintSettingsMenu.startOn.label",defaultMessage:"Start on"},weekdayOption:{id:"sprintSettings.weekdayOption.label",defaultMessage:"{weekdayName}s"},incompleteTasks:{id:"sprintSettingsMenu.incompleteTasks.label",defaultMessage:"Incomplete tasks"},turnOnSprints:{id:"sprintSettingsMenu.turnOnSprints.button.label",defaultMessage:"Turn on sprints"},turnOffSprints:{id:"sprintSettingsMenu.turnOffSprints.button.label",defaultMessage:"Turn off sprints"},turnOffSprintsModalTitle:{id:"sprintSettingsMenu.turnOffSprints.modal.title.label",defaultMessage:"Turn off sprints?"},turnOffSprintsModalNoSprintBoardsDescription:{id:"sprintSettingsMenu.turnOffSprints.modal.default.description",defaultMessage:"This will delete your sprints database and its linked views."},turnOffSprintsModalWithSprintBoardsDescription:{id:"sprintSettingsMenu.turnOffSprints.modal.withSprintBoards.description",defaultMessage:"This will delete your sprint board(s), sprints database and its linked views."},turnOffAndDeleteModalButton:{id:"sprintSettingsMenu.turnOffAndDeleteModal.button.label",defaultMessage:"Turn off and delete"},learnSprintsTitle:{id:"sprintSettingsMenu.learnSprints.button.label",defaultMessage:"Learn about sprints"},manageSprintFromThisView:{id:"sprintSettingsMenu.manageSprintFromThisView.label",defaultMessage:"Manage sprint from this view"},manageSprintFromThisViewModalTitle:{id:"sprintSettingsMenu.manageSprintFromThisView.modal.title.label",defaultMessage:"Manage sprint from this view?"},manageSprintFromThisViewModalButton:{id:"sprintSettingsMenu.manageSprintFromThisView.button.label",defaultMessage:"Update view"},manageSprintFromThisViewModalAutomaticSprintCompletionDescription:{id:"sprintSettingsMenu.manageSprintFromThisView.modal.automaticSprintCompletion.description",defaultMessage:"The view will be updated with filters for the current sprint."},manageSprintFromThisViewModalManualSprintCompletionDescription:{id:"sprintSettingsMenu.manageSprintFromThisView.modal.manualSprintCompletion.description",defaultMessage:"The view will be updated with filters for the current sprint and a button to complete sprints will be displayed."},sprintStartDateToday:{id:"sprintSettingsMenu.sprintStartDateToday",defaultMessage:"Next sprint starts <time>today</time>}"},sprintStartDateFuture:{id:"sprintSettingsMenu.sprintStartDateFuture",defaultMessage:"Next sprint starts in {days} {days, plural, one {day} other {days}} <time>({formattedDate}</time>)"},sprintStartDateShouldStartPast:{id:"sprintSettingsMenu.sprintStartDateShouldStartPast",defaultMessage:"Next sprint should have started {days} {days, plural, one {day} other {days}} ago <time>({formattedDate})</time>"},sprintStartDateShouldStartToday:{id:"sprintSettingsMenu.sprintStartDateShouldStartToday",defaultMessage:"Next sprint should start <time>today</time>"},sprintStartDateShouldStartFuture:{id:"sprintSettingsMenu.sprintStartDateShouldStartFuture",defaultMessage:"Next sprint should start in {days} {days, plural, one {day} other {days}} <time>({formattedDate})</time>"}}),pe={complete_sprint_and_move_incomplete_tasks_to_next_sprint:{menuOptionText:ue.completeSprintNextSprintActionMenuOptionText,selectedText:ue.completeSprintNextSprintActionSelectedText},complete_sprint_and_move_incomplete_tasks_to_backlog:{menuOptionText:ue.completeSprintBacklogActionMenuOptionText,selectedText:ue.completeSprintBacklogActionSelectedText},complete_sprint:{menuOptionText:ue.completeSprintKeepInCurrentSprintActionMenuOptionText,selectedText:ue.completeSprintKeepInCurrentSprintActionSelectedText}};function ge(e){return(0,C.jsx)(I()._H,{...pe[e.completeSprintAction].menuOptionText})}function me(e){return(0,C.jsx)(I()._H,{...pe[e.completeSprintAction].selectedText})}function fe(e){const{weekday:t}=e;return(0,C.jsx)(I()._H,{...ue.weekdayOption,values:{weekdayName:de[t]}})}function ye(e){return ce[e]}function Se(e){const{sprintDurationValue:t}=e;return(0,C.jsx)(I()._H,{...ue.durationMenuOptionText,values:{durationValue:ce[t].value}})}function he(e){const{numOfSprintBoards:t}=e;return t>0?(0,C.jsx)(I()._H,{...ue.turnOffSprintsModalWithSprintBoardsDescription}):(0,C.jsx)(I()._H,{...ue.turnOffSprintsModalNoSprintBoardsDescription})}function xe(e){const{automaticSprintCompletionEnabled:t}=e;return t?(0,C.jsx)(I()._H,{...ue.manageSprintFromThisViewModalAutomaticSprintCompletionDescription}):(0,C.jsx)(I()._H,{...ue.manageSprintFromThisViewModalManualSprintCompletionDescription})}function ve(e){const{collectionContextStore:t,collectionSettingsStore:o,from:l}=e,{sprintSettingsConfig:a,currentSprintDateRange:s,sprintSettingsPermissionsContext:c,sprintSettingsConfigUpdater:u,turnOffSprints:p,turnOnSprints:g,automaticSprintCompletionEnabled:m,canManageSprintFromThisView:f,manageSprintFromThisView:y}=function(e){var t;const{collectionContextStore:o,from:l}=e,a=(0,i().O7)(),s=(0,r().VK)((()=>o.sprintSettingsContextStore.state),[o.sprintSettingsContextStore]),c=(0,r().VK)((()=>null==s?void 0:s.permissionsContext),[s]),u=(0,r().VK)((()=>{var e;return Boolean(null==s||null===(e=s.automationContext)||void 0===e?void 0:e.automationStore.isActive())}),[null==s||null===(t=s.automationContext)||void 0===t?void 0:t.automationStore]),p=(0,r().VK)((()=>{var e;return o.collectionStore()===(null==s?void 0:s.taskCollectionStore)&&(null===(e=o.collectionViewStore())||void 0===e?void 0:e.getFormat().app_config_uri)!==K().g3}),[o,null==s?void 0:s.taskCollectionStore]),[g,m]=(0,n.useState)(void 0);(0,n.useEffect)((()=>{!async function(){if(m(void 0),!s)return;const{sprintCollectionViewBlockStore:e,sprintCollectionStore:t}=s;if(!e||!t)return;const o=t.getSchema(),n=H().qB[K().p$].current.reducer,i=await U().tA(a,{source:"automation",parentRecordStore:e,collectionPointer:t.getSpaceShardedPointer(),filter:n.getCombinatorFilter(o),limit:1});E().x.isFail(i)||m(i.value.blockIds[0])}()}),[a,s]);const f=(0,r().VK)((()=>{const e=null==s?void 0:s.sprintCollectionViewBlockStore;if(e&&g)return W().G.createChildStore(e,{id:g,table:O().iU,spaceId:e.getSpaceId()})}),[g,null==s?void 0:s.sprintCollectionViewBlockStore]),y=(0,r().VK)((()=>{if(!f)return;const e=f.getPropertyValue(K().b0.Dates);if(!e)return;const t=(0,D().nai)(e)[0];return t&&"daterange"===t.type?t:void 0}),[f]),S=(0,r().VK)((()=>{var e,t,o;if(!s)return;const n=(null===(e=s.automationContext)||void 0===e||null===(e=e.automationActionStore.getConfig())||void 0===e?void 0:e.complete_sprint_action)??L().iZ.actionConfig.complete_sprint_action,i=Boolean(null===(t=s.automationContext)||void 0===t?void 0:t.automationStore.isActive()),r=null===(o=s.automationContext)||void 0===o?void 0:o.automationStore.getRecurrence();return{autoCompleteSprints:i,actionConfig:{complete_sprint_action:n},recurrenceConfig:{interval:(null==r?void 0:r.interval)??L().iZ.recurrenceConfig.interval,weekdays:(null==r?void 0:r.weekdays)??L().iZ.recurrenceConfig.weekdays}}}),[s]),h=(0,r().VK)((()=>(0,N().$K)(f)&&(0,N().$K)(S)),[f,S]),x=n.useCallback((e=>{h&&d().createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:a,canUndo:!0,perform:t=>{s&&s.sprintCollectionStore&&s.automationContext&&f&&z().KV({environment:a,transaction:t,automationStore:s.automationContext.automationStore,currentSprintBlockStore:f,newDuration:e})}})}),[h,f,a,s]),v=n.useCallback((e=>{h&&d().createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:a,canUndo:!0,perform:t=>{s&&s.sprintCollectionStore&&s.automationContext&&f&&z().g9({environment:a,transaction:t,automationStore:s.automationContext.automationStore,currentSprintBlockStore:f,newWeekday:e})}})}),[h,f,a,s]),C=n.useCallback((e=>{h&&d().createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:a,canUndo:!0,perform:t=>{s&&s.sprintCollectionStore&&s.automationContext&&f&&z().jc({environment:a,transaction:t,automationStore:s.automationContext.automationStore,actionStore:s.automationContext.automationActionStore,currentSprintBlockStore:f,newAutocompleteStatus:e})}})}),[h,f,a,s]),b=n.useCallback((e=>{h&&d().createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:a,canUndo:!0,perform:t=>{s&&s.sprintCollectionStore&&s.automationContext&&z().U6({transaction:t,actionStore:s.automationContext.automationActionStore,newRemainingTasksBehavior:e})}})}),[h,a,s]),w=n.useCallback((async()=>{await z().ys({environment:a,collectionContextStore:o,from:l})}),[a,o,l]),j=n.useCallback((async e=>{s&&await z().m8({environment:a,collectionContextStore:o,sprintSettingsContext:s,sprintBoardViewBlockIds:e})}),[o,a,s]),_=n.useCallback((()=>{s&&z().YD({environment:a,collectionContextStore:o,currentViewBlockStore:s.currentCollectionViewBlockStore,taskCollectionViewBlockStore:s.taskCollectionViewBlockStore})}),[o,a,s]);return{sprintSettingsConfig:S,sprintSettingsPermissionsContext:c,turnOnSprints:w,turnOffSprints:j,automaticSprintCompletionEnabled:u,canManageSprintFromThisView:p,currentSprintDateRange:y,manageSprintFromThisView:_,sprintSettingsConfigUpdater:{canUpdateSprintSettingsConfig:h,handleSprintDurationChange:x,handleSprintStartWeekdayChange:v,handleSprintAutoCompleteChange:C,handleSprintRemainingTasksBehaviorChange:b}}}({collectionContextStore:t,collectionSettingsStore:o,from:l});if(!c||!c.canEdit||!a)return null;let S;return S=c.sprintsEnabled?(0,C.jsx)(Ce,{...e,updateSprintSettingsConfig:u,onTurnOffSprints:p,automaticSprintCompletionEnabled:m,currentSprintDateRange:s,canManageSprintFromThisView:f,onManageSprintFromThisView:y,sprintSettingsConfig:a}):(0,C.jsx)(be,{...e,onTurnOnSprints:g}),S}function Ce(e){const{sprintSettingsConfig:t,automaticSprintCompletionEnabled:o,currentSprintDateRange:n,canManageSprintFromThisView:i,updateSprintSettingsConfig:r,collectionContextStore:l,onTurnOffSprints:a,onManageSprintFromThisView:s}=e,c=Re(),d=[];return d.push((0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(ee().Z,{topBorder:!0,disableMobileBorders:!0,children:[i&&(0,C.jsx)(Te,{automaticSprintCompletionEnabled:o,manageSprintFromThisView:s}),(0,C.jsx)(Pe,{turnOffSprints:a,collectionContextStore:l})]},"turn-off-sprints-section"),(0,C.jsx)(ee().Z,{topBorder:!0,children:(0,C.jsx)(Y().Z,{href:ae,external:!0,children:(0,C.jsx)(F().Z,{icon:_().m,iconStyle:c.icon,title:(0,C.jsx)(I()._H,{...ue.learnSprintsTitle}),isGray:!0})})})]})),(0,C.jsxs)(B().ZP,{...e,title:(0,C.jsx)(I()._H,{...ue.sprintsMenuTitle}),footer:d,children:[(0,C.jsx)(we,{automaticSprintCompletionEnabled:o,currentSprintDateRange:n}),(0,C.jsxs)(ee().Z,{children:[(0,C.jsx)(Ve,{onChange:r.handleSprintDurationChange,disabled:!r.canUpdateSprintSettingsConfig,sprintSettingsConfig:t}),(0,C.jsx)(Ae,{onChange:r.handleSprintStartWeekdayChange,disabled:!r.canUpdateSprintSettingsConfig,sprintSettingsConfig:t}),(0,C.jsx)(Ze,{onChange:r.handleSprintRemainingTasksBehaviorChange,disabled:!r.canUpdateSprintSettingsConfig,sprintSettingsConfig:t})]}),(0,C.jsx)(ee().Z,{topBorder:!0,children:(0,C.jsx)(Ie,{onChange:r.handleSprintAutoCompleteChange,sprintSettingsConfig:t})})]})}function be(e){const{onTurnOnSprints:t}=e,o=Re(),n=[];return n.push((0,C.jsx)(ee().Z,{disableMobileBorders:!0,children:(0,C.jsx)("div",{style:o.buttonWrap,children:(0,C.jsx)(X().Z,{style:o.button,onClick:async()=>{await t()},isLarge:!0,children:(0,C.jsx)(I()._H,{...ue.turnOnSprints})})})},"turn-on-sprints-section")),(0,C.jsx)(B().ZP,{...e,title:(0,C.jsx)(I()._H,{...ue.setupSprintsTitle}),footer:n,children:(0,C.jsxs)(ee().Z,{disableMobileBorders:!0,children:[(0,C.jsx)(je,{}),(0,C.jsx)(_e,{}),(0,C.jsx)(Me,{})]})})}function we(e){const{automaticSprintCompletionEnabled:t,currentSprintDateRange:o}=e,n=Re();if(!o)return null;const i=m().ou.fromISO(o.end_date).plus({days:1});return(0,C.jsx)(R().P,{style:n.sprintStartDateHeader,children:(0,C.jsxs)("div",{style:n.sprintStartDateHeaderWrap,children:[k(n.sprintStartDateHeaderIcon),(0,C.jsx)(Fe,{nextSprintStartDate:i,automaticSprintCompletionEnabled:t})]})})}function je(){const e=Re();return(0,C.jsx)("div",{style:{...e.menuDescriptionContainer,...e.menuDescriptionText},children:(0,C.jsx)(I()._H,{...ue.setupSprintsCaption})})}function _e(){const e=Re();return(0,C.jsx)("div",{style:e.mediaWrap,children:(0,C.jsx)("img",{src:y().Z.images.appPackages.sprintsTurnOnPreviewPng,style:e.media})})}function Me(){const e=Re(),t=t=>(0,C.jsx)("span",{style:e.boldText,children:t});return(0,C.jsxs)("div",{style:e.disclaimerWrap,children:[(0,C.jsx)("div",{children:(0,C.jsx)(I()._H,{...ue.setupSprintsTeamspaceStatement})}),(0,C.jsx)(ke,{text:(0,C.jsx)(I()._H,{...ue.setupSprintsSprintBoardPageStatement,values:{bold:t}}),icon:P().L}),(0,C.jsx)(ke,{text:(0,C.jsx)(I()._H,{...ue.setupSprintsSprintsDatabaseStatement,values:{bold:t}}),icon:j().t})]})}function ke(e){const{text:t,icon:o}=e,n=Re();return(0,C.jsxs)("div",{style:n.disclaimerSubitem,children:[(0,C.jsx)("div",{children:o(n.disclaimerSubitemIcon)}),(0,C.jsx)("div",{children:t})]})}function Pe(e){const{collectionContextStore:t,turnOffSprints:o}=e,n=(0,i().O7)(),l=(0,r().VK)((()=>t.sprintSettingsContextStore.state),[t.sprintSettingsContextStore]),[{value:a}]=(0,S().r5)((async()=>{if(null==l||!l.taskCollectionStore||null==l||!l.taskCollectionViewBlockStore)return;const e=await async function(e){var t;const{environment:o,collectionStore:n,collectionViewBlockStore:i}=e,{appConfigs:r}=await le().vF.load(),l=i.getSpaceId(),a=i.getParentStore(),s=null===(t=n.getFormat())||void 0===t?void 0:t.app_config_uri,c=s&&(0,re().YB)(r(),s);if(!a||a.table!==oe().bx&&a.table!==O().iU&&a.table!==ne().e0||!c)return;const d=await ie().callApi({eventName:"getSprintBoardViewBlocks",environment:o,data:{spaceId:l,taskCollectionId:n.id,parentId:a.id,parentTable:a.table}});return"success"===(null==d?void 0:d.type)?d.data.result:[]}({environment:n,collectionStore:l.taskCollectionStore,collectionViewBlockStore:l.taskCollectionViewBlockStore});return e}),[n,null==l?void 0:l.taskCollectionStore,null==l?void 0:l.taskCollectionViewBlockStore]),s=Re();return(0,C.jsx)(F().Z,{icon:T().y,title:(0,C.jsx)(I()._H,{...ue.turnOffSprints}),isRed:!0,iconStyle:s.icon,onClick:()=>{A().vC({description:(0,C.jsx)(he,{numOfSprintBoards:a?a.length:0}),message:(0,C.jsx)("div",{style:s.modalTitle,children:(0,C.jsx)(I()._H,{...ue.turnOffSprintsModalTitle})}),innerStyle:s.modalInnerStyle,showCancel:!0,keepFocus:!0,items:[{label:(0,C.jsx)(I()._H,{...ue.turnOffAndDeleteModalButton}),color:"red",onAccept:async()=>{await o(a??[])}}]})}})}function Te(e){const{automaticSprintCompletionEnabled:t,manageSprintFromThisView:o}=e,n=Re();return(0,C.jsx)(F().Z,{icon:w,title:(0,C.jsx)(I()._H,{...ue.manageSprintFromThisView}),iconStyle:n.icon,onClick:()=>{A().vC({description:(0,C.jsx)(xe,{automaticSprintCompletionEnabled:t}),message:(0,C.jsx)("div",{style:n.modalTitle,children:(0,C.jsx)(I()._H,{...ue.manageSprintFromThisViewModalTitle})}),innerStyle:n.modalInnerStyle,showCancel:!0,keepFocus:!0,items:[{label:(0,C.jsx)(I()._H,{...ue.manageSprintFromThisViewModalButton}),color:"blue",onAccept:o}]})}})}function Ie(e){const{onChange:t,sprintSettingsConfig:o}=e,n=Re();return(0,C.jsx)(te().Z,{title:(0,C.jsx)(I()._H,{...ue.automatedSprintsToggleTitle}),caption:(0,C.jsx)(I()._H,{...ue.automatedSprintsToggleCaption}),focused:!1,on:o.autoCompleteSprints,onClick:()=>{t(!o.autoCompleteSprints)},style:{alignItems:void 0},icon:(0,M().N)(n.icon),shouldWrapCaption:!0})}function Ve(e){const{onChange:t,sprintSettingsConfig:o,disabled:n}=e,i=ye(o.recurrenceConfig.interval),r=se.map((e=>ye(e)));return(0,C.jsx)(Be,{title:(0,C.jsx)(I()._H,{...ue.duration}),right:(0,C.jsx)(Se,{sprintDurationValue:i.value}),icon:h().r,getMenuItems:e=>r.map((o=>{const r={key:o.key,render:e=>(0,C.jsx)(q().Z,{...e,disabled:n,title:(0,C.jsx)(Se,{sprintDurationValue:o.value}),checkState:o.key===i.key}),action:()=>{t(o.value),e.close()}};return r})),showChevron:!0})}function Ae(e){const{onChange:t,sprintSettingsConfig:o,disabled:n}=e,i=o.recurrenceConfig.weekdays[0],r=["SU","MO","TU","WE","TH","FR","SA"];return(0,C.jsx)(Be,{title:(0,C.jsx)(I()._H,{...ue.startOn}),icon:x().C,right:(0,C.jsx)(fe,{weekday:i}),getMenuItems:e=>r.map((o=>{const r={key:o,render:e=>(0,C.jsx)(q().Z,{...e,disabled:n,title:(0,C.jsx)(fe,{weekday:o}),checkState:o===i}),action:()=>{t(o),e.close()}};return r})),showChevron:!0})}function Ze(e){const{onChange:t,sprintSettingsConfig:o,disabled:n}=e,i=o.actionConfig.complete_sprint_action,r=["complete_sprint_and_move_incomplete_tasks_to_next_sprint","complete_sprint_and_move_incomplete_tasks_to_backlog","complete_sprint"];return(0,C.jsx)(Be,{title:(0,C.jsx)(I()._H,{...ue.incompleteTasks}),right:(0,C.jsx)(me,{completeSprintAction:i}),icon:b,getMenuItems:e=>r.map((o=>{const r={key:o,render:e=>(0,C.jsx)(q().Z,{...e,disabled:n,title:(0,C.jsx)(ge,{completeSprintAction:o}),checkState:o===i}),action:()=>{t(o),e.close()}};return r})),showChevron:!0})}function Be(e){const{getMenuItems:t}=e,o=(0,i().Fy)(),n=Re(),r=(0,Z().F)({width:250});return(0,C.jsx)(G().ZP,{popupType:o.isMobile?J().kQ.SlideUp:J().kQ.Popup,alignmentToOrigin:G().vR.End,placementToOrigin:G().pO.Bottom,renderOrigin:t=>(0,C.jsx)(F().Z,{...e,iconStyle:n.icon,...t}),render:e=>(0,C.jsx)($().Z,{...r,children:(0,C.jsx)(Q().ZP,{type:Q().iW.Vertical,sections:[{key:0,render:e=>(0,C.jsx)(ee().Z,{enableActionSheetTitle:!0,...e}),items:t(e)}],initialFocus:0})})})}function Fe(e){const{nextSprintStartDate:t,automaticSprintCompletionEnabled:o}=e,n=m().ou.local().startOf("day"),i=t.diff(n,"days").days,r=t.toLocaleString({weekday:"short",month:"short",day:"numeric"}),l=e=>(0,C.jsx)("time",{dateTime:t.toISODate(),children:e});return o?0===i?(0,C.jsx)("div",{children:(0,C.jsx)(I()._H,{...ue.sprintStartDateToday,values:{time:l}})}):(0,C.jsx)("div",{children:(0,C.jsx)(I()._H,{...ue.sprintStartDateFuture,values:{time:l,days:i,formattedDate:r}})}):i<0?(0,C.jsx)("div",{children:(0,C.jsx)(I()._H,{...ue.sprintStartDateShouldStartPast,values:{time:l,days:Math.abs(i),formattedDate:r}})}):0===i?(0,C.jsx)("div",{children:(0,C.jsx)(I()._H,{...ue.sprintStartDateShouldStartToday,values:{time:l}})}):(0,C.jsx)("div",{children:(0,C.jsx)(I()._H,{...ue.sprintStartDateShouldStartFuture,values:{time:l,days:i,formattedDate:r}})})}function Re(){const e=(0,i().Fy)();return(0,f().yK)((t=>({icon:{width:16,height:"auto"},menuDescriptionContainer:{margin:"0px 12px"},menuDescriptionText:{fontSize:e.isMobile?V().JB.UISmall.mobile:V().JB.UISmall.desktop,color:t.mediumTextColor,fontWeight:V().Ue.regular,marginLeft:14},button:{width:"100%"},buttonWrap:{margin:"0px 12px"},disclaimerWrap:{margin:"0px 12px",fontSize:e.isMobile?V().JB.UIRegular.mobile:V().JB.UIRegular.desktop,color:t.mediumTextColor,fontWeight:V().Ue.regular},disclaimerSubitem:{display:"flex",padding:"0px 10px",margin:"7px 0px",gap:7},disclaimerSubitemIcon:{color:t.lightIconColor,width:20,height:20,marginTop:e.isMobile?3:1},boldText:{color:t.regularTextColor,fontWeight:V().Ue.semibold},mediaWrap:{margin:"0px 12px"},media:{margin:"15px 0px 10px 0px",width:"100%",border:`1px solid ${t.accentColors.washGlass[0]}`,borderRadius:"5px"},mediaIcon:{width:40,height:40,color:t.lightIconColor},modalTitle:{fontWeight:V().Ue.semibold,fontSize:18},modalInnerStyle:{textAlign:"center"},modalReferencedPageName:{color:t.darkTextColor,fontWeight:V().Ue.semibold},sprintStartDateHeaderWrap:{display:"flex",flexDirection:"row",alignItems:"start",gap:"8px",color:t.mediumTextColor},sprintStartDateHeaderIcon:{width:16,height:"auto",marginBlockStart:3},sprintStartDateHeader:{background:t.surface.wash}})),[e])}var Ke=()=>o(677559);const He=new(Ke().Ss)("database-automations",(()=>Promise.all([o.e(62743),o.e(52774),o.e(44832),o.e(84885),o.e(94556),o.e(78701),o.e(38804),o.e(71896),o.e(53335),o.e(46546),o.e(91253),o.e(61171),o.e(63502),o.e(81917),o.e(71641),o.e(10553),o.e(67601),o.e(40692),o.e(58548),o.e(20683),o.e(73230),o.e(28682),o.e(28686),o.e(11582),o.e(93342),o.e(31655)]).then(o.bind(o,488901)))),Oe=(0,Ke().kF)(He,(e=>e.CollectionSettingsAutomationsView)),Le=new(Ke().Ss)("CollectionSettingsCustomizeMenu",(()=>o.e(55918).then(o.bind(o,144876)))),De=(0,Ke().kF)(Le,(e=>e.CollectionSettingsCustomizeMenu)),Ee=new(Ke().Ss)("CollectionSettingsCustomizeMenuPrototype",(()=>o.e(70586).then(o.bind(o,65503)))),Ne=(0,Ke().kF)(Ee,(e=>e.CollectionSettingsCustomizeMenuPrototype)),Ue=new(Ke().Ss)("CustomizeMenuConnectionsSettings",(()=>o.e(8872).then(o.bind(o,234276)))),ze=(0,Ke().kF)(Ue,(e=>e.CustomizeMenuConnectionsSettings));var We=()=>o(949842),qe=()=>o(36296),Ge=()=>o(520849),Ye=()=>o(642966),$e=()=>o(749826),Qe=()=>o(919775),Je=()=>o(293307),Xe=()=>o(382474),et=()=>o(932200),tt=()=>o(264737),ot=(o(492176),o(7961),o(267602),o(653476),()=>o(492788)),nt=()=>o(94250),it=()=>o(717956),rt=()=>o(409873),lt=()=>o(426546),at=()=>o(984871),st=()=>o(236087),ct=()=>o(360240),dt=()=>o(887430),ut=()=>o(666414),pt=()=>o(67961),gt=()=>o(125659),mt=()=>o(594546),ft=()=>o(576868);var yt=()=>o(582835),St=()=>o(66417),ht=()=>o(129338),xt=()=>o(529048),vt=()=>o(508858),Ct=()=>o(960482),bt=()=>o(531328),wt=()=>o(167705);function jt(e){const{propertyName:t,subitemsDisplayMode:o,inversePropertyName:n}=e,i=(0,f().yK)((e=>({togglePreviewOutsideBorder:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:"4px",alignItems:"center",fontWeight:V().Ue.medium,backgroundColor:e.accentColors.gray[30],padding:"9px 0"}})),[]);return(0,C.jsx)(ee().Z,{disableMobileBorders:!0,children:(0,C.jsx)("div",{style:i.togglePreviewOutsideBorder,children:(r=o,"disabled"===r?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(_t,{isLast:!1,itemEmoji:Tt,title:n}),(0,C.jsx)(_t,{isLast:!1,itemEmoji:It,title:t}),(0,C.jsx)(_t,{isLast:!0,itemEmoji:It,title:t})]}):"flattened"===r?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(_t,{isLast:!1,itemEmoji:Tt,title:n}),(0,C.jsx)(_t,{isLast:!1,itemEmoji:It,title:t,right:(0,C.jsx)(Pt,{parentPropertyName:n})}),(0,C.jsx)(_t,{isLast:!0,itemEmoji:It,title:t,right:(0,C.jsx)(Pt,{parentPropertyName:n})})]}):"hidden"===r?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(_t,{isLast:!1,itemEmoji:Tt,title:n,right:(0,C.jsx)(kt,{count:2})}),(0,C.jsx)(_t,{isLast:!1,itemEmoji:Vt,title:n}),(0,C.jsx)(_t,{isLast:!0,itemEmoji:At,title:n,right:(0,C.jsx)(kt,{count:1})})]}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(_t,{isLast:!1,itemEmoji:Tt,title:n,left:(0,C.jsx)(Mt,{indented:!1})}),(0,C.jsx)(_t,{isLast:!1,itemEmoji:It,title:t,left:(0,C.jsx)(Mt,{indented:!0})}),(0,C.jsx)(_t,{isLast:!0,itemEmoji:It,title:t,left:(0,C.jsx)(Mt,{indented:!0})})]}))})});var r}function _t(e){let{isLast:t,itemEmoji:o,title:n,left:i,right:r}=e;const l=(0,f().yK)((e=>({previewItem:{padding:"4px",margin:"0px 12px",display:"flex",fontSize:14,alignItems:"center",borderBottom:t?void 0:`1px solid ${e.regularDividerColor}`}})),[t]);return(0,C.jsxs)("div",{style:l.previewItem,children:[i,(0,C.jsxs)("span",{style:{marginRight:"5px"},children:[" ",o]}),n,r]})}function Mt(e){let{indented:t}=e;const o=(0,f().Fg)();return(0,C.jsx)(wt().Z,{isSidebar:!1,open:!1,fill:!0,onClick:()=>{},style:{color:o.regularIconColor,marginLeft:t?"24px":void 0,height:20},disabled:!0})}function kt(e){let{count:t}=e;const o=(0,f().yK)((e=>({subitemCountIndicator:{display:"inline-flex",alignItems:"center",paddingLeft:8,paddingRight:4,verticalAlign:"text-top"},subitemIcon:{color:e.mediumIconColor,width:14,height:14,marginRight:4},innerText:{color:e.lightTextColor,fontWeight:V().Ue.medium,fontSize:V().JB.UISmall.desktop}})),[]);return(0,C.jsxs)("span",{style:o.subitemCountIndicator,children:[(0,bt().S)(o.subitemIcon),(0,C.jsx)("span",{style:o.innerText,children:t})]})}function Pt(e){let{parentPropertyName:t}=e;const o=(0,f().yK)((e=>({parentItemIcon:{color:e.mediumIconColor,width:14,height:14,marginRight:4},parentWrapper:{paddingLeft:8,display:"inline-flex",alignItems:"center"},parentTitle:{textOverflow:"ellipsis",overflow:"hidden",color:e.lightTextColor,fontWeight:V().Ue.medium,fontSize:V().JB.UISmall.desktop,whiteSpace:"nowrap"}})),[]);return(0,C.jsxs)("span",{style:o.parentWrapper,children:[(0,Ct().v)(o.parentItemIcon),(0,C.jsx)("span",{style:o.parentTitle,children:t})]})}const Tt="🐔",It="🐣",Vt="🐮",At="🐷";var Zt=()=>o(114672),Bt=()=>o(678121),Ft=()=>o(810374);function Rt(e){const{collectionContextStore:t,collectionSettingsStore:o,feature:l,from:a}=e,c=(0,I().YB)(),d=(0,i().Fy)(),u=(0,r().Kw)(t.normalizedSchemaStore),p=(0,r().VK)((()=>t.databaseType),[t]),g=(0,r().VK)((()=>t.collectionStore()),[t]),m=(0,Ft().t6)({collectionContextStore:t,feature:l}),y=null==m?void 0:m.property,S=(0,n.useMemo)((()=>dt().HI(u)),[u]),h=(0,r().Kw)(t.permissionScopesStore),x=(0,r().VK)((()=>{var e;return y&&(null===(e=u[y])||void 0===e?void 0:e.name)}),[u,y]),v=(0,r().VK)((()=>t.collectionViewStore()),[t]),b=(0,r().VK)((()=>null==v?void 0:v.getFormat()),[v]),w=(null==b?void 0:b.subitem_display_mode)??"show",j=(0,r().VK)((()=>{const e=y&&u[y];if(e&&"relation"===e.type){var t;const o=e.property;return o?null===(t=u[o])||void 0===t?void 0:t.name:void 0}}),[y,u]),_=(0,r().VK)((()=>{const e=t.collectionStore();return null!=e&&e.isDefined()?ht().aI(c,{sourceCollection:e.getModel(),isSelfRelation:!0,targetCollectionStore:e,createUnique:!0,from:l}):c.formatMessage({id:"database.viewSettings.relationsPropertyTab.inverseName.placeholder",defaultMessage:"Related to this database"})}),[t,c,l]),M=(0,r().VK)((()=>Boolean(g&&function(e){const{collectionContextStore:t,collectionStore:o}=e,n=o.getFormat().collection_default_arrows_by,i=t.currentArrowsByFormatStore.state;return!(0,N().$K)(i)||i===n}({collectionContextStore:t,collectionStore:g}))),[t,g]),k=(0,r().qz)(void 0,xt().Z),P=(0,n.useCallback)((e=>{e&&k.setState({open:!1})}),[k]),{initialPropertyName:T}=(0,Ft().Ld)({collectionContextStore:t,feature:l}),A=(0,Ft().he)({collectionContextStore:t,onPropertySelect:P,feature:l}),{handleAddRelation:Z,handleDefaultPropertySelect:F,clearCollectionViewSubitemDisplayMode:R}=A,K=(0,f().yK)((e=>({container:{marginLeft:12,marginRight:12},captionText:{fontSize:d.isMobile?V().JB.UISmall.mobile:V().JB.UISmall.desktop,color:e.mediumTextColor,fontWeight:V().Ue.regular,marginLeft:14},subitemsPreviewContainer:{marginBottom:6,marginLeft:2}})),[d]);if(!g)return null;let H;if("subitem"===l)if(m)H=(0,C.jsxs)(ee().Z,{disableMobileBorders:!0,children:[(0,C.jsx)("div",{style:K.subitemsPreviewContainer,children:(0,C.jsx)(jt,{propertyName:x||T,inversePropertyName:j||_,subitemsDisplayMode:w})}),(0,C.jsx)(Ut,{databaseType:p,permissionScopes:h}),(0,C.jsx)(ut().Z,{size:12,style:{marginTop:4,marginBottom:4}}),(0,C.jsx)(Bt().kJ,{collectionSettingsStore:o,feature:l,permissionScopes:h}),(0,C.jsx)(Bt().PC,{feature:l,databaseType:p,permissionScopes:h,propertyName:x,relationPropertyId:y,collectionContextStore:t,collectionSettingsStore:o,handleDefaultPropertySelect:F,inversePropertyName:j,clearCollectionViewSubitemDisplayMode:R})]});else{const e=()=>{Z({featureType:"subitem",from:a}),s().z$({collectionSettingsStore:o}),ot().default.afterNextFlush((()=>{const e=t.subitemTreeStore.getState(),o=t.resultsInViewOrder(1).at(0),n=(0,lt().DY)(e.children,(e=>e.value.store===o));if(n){const e=n.map((e=>e.value.store.pointer)),o=(0,yt().Af)(e);st().rT({collectionContextStore:t,pathKey:o})}}))};H=(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(jt,{propertyName:x||T,inversePropertyName:j||_,subitemsDisplayMode:w}),(0,C.jsx)(Bt().Fz,{feature:l,permissionScopes:h,databaseType:p,handleAddRelation:e})]})}else"timeline_arrows_by"===l?H=m?(0,C.jsxs)(C.Fragment,{children:[M?(0,C.jsx)(Ht,{collectionContextStore:t,firstDatePropertyId:S,permissionScopes:h}):(0,C.jsx)(Kt,{collectionContextStore:t,databaseType:p}),(0,C.jsxs)(ee().Z,{topBorder:!0,children:[(0,C.jsx)(Bt().kJ,{collectionSettingsStore:o,feature:l,permissionScopes:h}),(0,C.jsx)(Lt,{feature:l,databaseType:p,featuredRelationProperty:m,actions:A,permissionScopes:h}),(0,C.jsx)(Bt().PC,{feature:l,databaseType:p,permissionScopes:h,relationPropertyId:y,propertyName:x,inversePropertyName:j,collectionContextStore:t,collectionSettingsStore:o,handleDefaultPropertySelect:F})]})]}):(0,C.jsx)(Ot,{databaseType:p,collectionContextStore:t,firstDatePropertyId:S,handleAddRelation:Z,permissionScopes:h,from:a}):(0,N().t1)(l);const O=(0,St().Gt)({feature:l,databaseType:p}),L=(0,St().qi)({feature:l,databaseType:p});return(0,C.jsxs)(B().ZP,{...e,title:(0,C.jsx)(I()._H,{...O}),children:[(0,C.jsx)(ee().Z,{disableMobileBorders:!0,children:(0,C.jsx)("div",{style:{...K.container,...K.captionText},children:(0,C.jsx)(I()._H,{...L})})}),H]})}function Kt(e){const{collectionContextStore:t,databaseType:o}=e,n=(0,i().MO)(),l=(0,f().yK)((e=>({wrap:{boxShadow:e.shadow2XS,...n?{backgroundColor:e.surface.wash,margin:void 0,borderRadius:void 0}:{background:"rgba(196, 196, 196, 0.13)",marginTop:14,marginBottom:20}},iconWithMessage:{display:"flex",gap:8},icon:{width:14,height:14,position:"relative",top:1,color:e.mediumTextColor}})),[n]),a=(0,r().VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getNormalizedDependencyDateShiftingConfig()}),[t]),s=(0,St().uM)({currentDateShiftConfig:a,databaseType:o});return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(ee().Z,{title:(0,C.jsx)(I()._H,{...St().dH.dateShiftingSectionCaption}),children:(0,C.jsx)(Zt().O,{mode:null==a?void 0:a.mode})}),(0,C.jsx)(R().P,{style:l.wrap,showCloseButton:!1,children:(0,C.jsxs)("div",{style:l.iconWithMessage,children:[(0,rt().D)(l.icon),(0,C.jsx)(pt().Z,{isSmall:!0,isMultiline:!0,children:(0,C.jsx)(I()._H,{...s})})]})})]})}function Ht(e){const{collectionContextStore:t,firstDatePropertyId:o,permissionScopes:l}=e,a=(0,i().O7)(),s=(0,I().YB)(),c=(0,r().VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getNormalizedDependencyDateShiftingConfig()}),[t]),u=(0,n.useCallback)((e=>{const o=t.collectionStore();o&&d().createAndCommit({userAction:"FeatureEnabledDependenciesSection.handleConfigChange",environment:a,canUndo:!0,perform:t=>{(0,Bt().pK)({collectionStore:o,environment:a,intl:s,newConfig:e,transaction:t})}})}),[t,a,s]),p=(0,n.useMemo)((()=>({configWithoutDates:c,...c?{datePropertyId:c.date_property,endDatePropertyId:c.end_date_property}:{datePropertyId:o}})),[c,o]);return(0,C.jsx)(Bt().$z,{collectionContextStore:t,currentConfig:p,disabled:!l.canConfigureBlock||!l.canConfigureCollection,onConfigChange:u})}function Ot(e){const{collectionContextStore:t,handleAddRelation:o,firstDatePropertyId:i,permissionScopes:l,databaseType:a,from:c}=e,[d,u]=(0,n.useState)({datePropertyId:i,configWithoutDates:{mode:Bt().zk,avoid_weekends:Bt().Yi}}),p=(0,r().VK)((()=>t.settingsStore),[t]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Bt().$z,{collectionContextStore:t,currentConfig:d,disabled:!l.canConfigureBlock||!l.canConfigureCollection,onConfigChange:u}),(0,C.jsx)(Bt().Fz,{feature:"timeline_arrows_by",permissionScopes:l,databaseType:a,handleAddRelation:()=>{o({featureType:"timeline_arrows_by",dateShiftingConfig:d,from:c}),s().z$({collectionSettingsStore:p})}})]})}function Lt(e){const{feature:t,featuredRelationProperty:o,actions:n,permissionScopes:r,databaseType:l}=e,a=(0,i().Fy)(),s=(0,f().yK)((()=>({eyeHideIcon:{width:20,height:a.isMobile?24:12,marginLeft:3}})),[a]);if(!o.supportedInView)return null;const c=o.enabledOnView,d=o.isVisibleInView,u=d?{icon:it().B,iconStyle:s.eyeHideIcon}:{icon:nt().c};return(0,C.jsx)(F().Z,{...u,onClick:()=>{n.handlePropertySelect(c?void 0:o.property)},title:(0,C.jsx)(I()._H,{...(0,St().cn)({feature:t,isOn:d,databaseType:l})}),disabled:!r.canConfigureBlock})}function Dt(e){const{subitemDisplayMode:t,collectionViewType:o,intl:n,databaseType:i}=e;if("show"===t||void 0===t)switch(o){case"board":case"calendar":case"gallery":return n.formatMessage({id:"getTitleForSubitemDisplayModeMenuItem.onCard",defaultMessage:"Card property"});case"table":case"list":case"timeline":case"page":return n.formatMessage({id:"getTitleForSubitemDisplayModeMenuItem.nestedInToggle",defaultMessage:"Nested in toggle"})}else{if("hidden"===t)return n.formatMessage({id:"subitemDisplayModeMenuItemTitle.hideSubitems",defaultMessage:"Parents only"},{items:(0,ct().Q_)(i,!0)});if("flattened"===t)return n.formatMessage({id:"subitemDisplayModeMenuItemTitle.flattenedList",defaultMessage:"Flattened list"});if("disabled"===t)return n.formatMessage({id:"subitemDisplayModeMenuItemTitle.disabled",defaultMessage:"Disabled"});(0,N().t1)(t)}}const Et=["show","hidden","flattened","disabled"];function Nt(e){const{intl:t,collectionViewType:o,databaseType:n}=e;return Et.map((e=>({key:e,type:"button",title:Dt({intl:t,collectionViewType:o,subitemDisplayMode:e,databaseType:n})})))}function Ut(e){const{databaseType:t,permissionScopes:o}=e,l=(0,I().YB)(),a=(0,gt().Y$)(),s=(0,r().VK)((()=>a.collectionViewStore()),[a]),u=(0,r().VK)((()=>null==s?void 0:s.getFormat()),[s]),p=(null==u?void 0:u.subitem_display_mode)??"show",g="show"===p,m=(0,i().O7)(),f=n.useCallback((e=>{const t=a.getPropertyFormatKey(),o=(0,yt().wf)(a),n=null==o?void 0:o.property,i=null==o?void 0:o.inverse;s&&t&&n&&i&&e!==p&&d().createAndCommit({userAction:"actionRegistry.updateCollectionViewSubitemDisplayMode",environment:m,canUndo:!0,perform:o=>{const r=s.getType();if(("board"===r||"gallery"===r||"calendar"===r)&&at().er({formatStore:s,formatKey:t,property:n,update:{visible:"show"===e},transaction:o}),"hidden"===p){var l;const e=null==u||null===(l=u.property_filters)||void 0===l?void 0:l.filter((e=>e.id!==ft().OC));c().FH({stores:[s],update:{property_filters:e},transaction:o})}if("hidden"===e){const e={property:i,filter:{operator:"is_empty"}},t=(null==u?void 0:u.property_filters)||[];c().FH({stores:[s],update:{property_filters:[...t,{id:ft().OC,filter:e}]},transaction:o})}c().FH({stores:[s],update:{subitem_display_mode:e},transaction:o})}})}),[a,s,m,u,p]);(0,n.useEffect)((()=>{mt().K4(m,"configure_subitem_display_mode",{userAction:g?"CollectionSettingsViewRelationFeatures.configureSubitemDisplayMode.flattened":"CollectionSettingsViewRelationFeatures.configureSubitemDisplayMode.show"})}),[g,m]);const y=(0,r().VK)((()=>(null==s?void 0:s.getType())??"table"),[s]);return"chart"===y||"form_editor"===y||"feed"===y||"map"===y||"chat"===y?(0,C.jsx)(C.Fragment,{}):(0,C.jsx)(vt().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"Show as",id:"SubitemDisplayModeMenuItem.menuItemTitle"}),collectionContextStore:a,selectedKey:p,options:Nt({collectionViewType:y,intl:l,databaseType:t}),onChange:e=>f(e),disabled:!o.canConfigureBlock})}var zt=()=>o(417387),Wt=()=>o(250303),qt=()=>o(435168),Gt=()=>o(471645),Yt=()=>o(777898);const $t="box1-filter",Qt="box2-filter";function Jt(e){const{propertyName:t,inversePropertyName:o}=e,n=(0,f().Fg)(),i=(0,f().yK)((e=>({svgWrap:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:6,alignItems:"center",position:"relative",height:112,backgroundColor:e.accentColors.gray[30],display:"flex",justifyContent:"center"}})),[]);return(0,C.jsx)(ee().Z,{disableMobileBorders:!0,children:(0,C.jsx)("div",{style:i.svgWrap,children:(0,C.jsxs)("svg",{width:"266",height:"116",fill:"none",children:[(0,C.jsx)("path",{stroke:"#DFAF49",strokeWidth:"2",d:"M124 20h.426c7.703 0 17.307-.002 25.029 1.93 3.979.994 8.078 2.638 11.248 5.575C164.082 30.635 166 34.868 166 40c0 8.001-6.095 12.917-11.524 15.932-5.553 3.086-12.74 5.481-19.23 7.644l-.349.116c-6.919 2.307-13.074 4.381-17.546 6.866C112.655 73.166 112 75 112 76c0 1.868.582 2.885 1.453 3.692 1.08 1.001 2.981 1.982 6.002 2.737C125.59 83.963 132.773 84 141 84"}),(0,C.jsx)("path",{stroke:"#E3E2E0",strokeWidth:"2",d:"M125 32c8.227 0 15.41.037 21.545 1.57 3.021.756 4.922 1.737 6.002 2.738.871.807 1.453 1.824 1.453 3.692 0 .999-.655 2.834-5.351 5.443-4.472 2.484-10.627 4.558-17.546 6.865l-.349.116c-6.49 2.163-13.677 4.558-19.23 7.644C106.095 63.084 100 67.998 100 76c0 5.132 1.918 9.365 5.297 12.495 3.17 2.937 7.269 4.581 11.248 5.576C124.267 96 133.871 96 141.574 96H142"}),(0,C.jsx)("path",{fill:n.accentColors.gray[30],d:"M157 27h16v18h-16zM92 70h16v18H92z"}),(0,C.jsx)("path",{stroke:"#DFAF49",strokeWidth:"2",d:"M136 88l5-4-5-4"}),(0,C.jsx)("path",{stroke:"#E3E2E0",strokeWidth:"2",d:"M130 36l-5-4 5-4"}),(0,C.jsxs)("g",{filter:`url(#${$t})`,children:[(0,C.jsx)("rect",{width:"100",height:"28",x:"24",y:"12",fill:n.buttonBackground,rx:"3"}),(0,C.jsx)("text",{x:"67",y:"31",fill:"#000",children:"🌱"})]}),(0,C.jsxs)("g",{filter:`url(#${Qt})`,children:[(0,C.jsx)("rect",{width:"100",height:"28",x:"142",y:"76",fill:n.buttonBackground,rx:"3"}),(0,C.jsx)("text",{x:"185",y:"95",fill:"#000",children:"🌳"})]}),(0,C.jsx)(Xt,{x:"161",y:"26",width:"100",height:"16",textStyles:{fontSize:12,fontWeight:590,color:n.regularTextColor},children:t}),(0,C.jsx)(Xt,{x:"15",y:"69",width:"90",height:"16",textStyles:{color:n.lightTextColor,fontSize:12,fontWeight:500,textAlign:"right"},children:o}),(0,C.jsxs)("defs",{children:[(0,C.jsxs)("filter",{id:$t,width:"108",height:"36",x:"20",y:"10",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,C.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,C.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,C.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_1034_52436"}),(0,C.jsx)("feOffset",{}),(0,C.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,C.jsx)("feColorMatrix",{values:"0 0 0 0 0.0707 0 0 0 0 0.0693 0 0 0 0 0.0693 0 0 0 0.1 0"}),(0,C.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_1034_52436"}),(0,C.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,C.jsx)("feOffset",{dy:"2"}),(0,C.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,C.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,C.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,C.jsx)("feBlend",{in2:"effect1_dropShadow_1034_52436",result:"effect2_dropShadow_1034_52436"}),(0,C.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_1034_52436",result:"shape"})]}),(0,C.jsxs)("filter",{id:Qt,width:"108",height:"36",x:"138",y:"74",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,C.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,C.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,C.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_1034_52436"}),(0,C.jsx)("feOffset",{}),(0,C.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,C.jsx)("feColorMatrix",{values:"0 0 0 0 0.0707 0 0 0 0 0.0693 0 0 0 0 0.0693 0 0 0 0.1 0"}),(0,C.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_1034_52436"}),(0,C.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,C.jsx)("feOffset",{dy:"2"}),(0,C.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,C.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,C.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,C.jsx)("feBlend",{in2:"effect1_dropShadow_1034_52436",result:"effect2_dropShadow_1034_52436"}),(0,C.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_1034_52436",result:"shape"})]})]})]})})})}function Xt(e){const{children:t,textStyles:o,...n}=e;return(0,C.jsx)("foreignObject",{...n,children:(0,C.jsx)("div",{style:{...V().Yu,...n.width?{width:Number(n.width)}:{},...o},children:t})})}var eo=()=>o(940573);function to(e){var t;const{collectionContextStore:o,feature:i}=e,l=(0,I().YB)(),a=(0,r().VK)((()=>o.collectionStore()),[o]),s=(0,r().Kw)(o.normalizedSchemaStore),c=(0,r().Kw)(o.permissionScopesStore),d=null===(t=(0,Ft().t6)({collectionContextStore:o,feature:i}))||void 0===t?void 0:t.property,u=(0,r().VK)((()=>{var e;return d&&(null===(e=s[d])||void 0===e?void 0:e.name)}),[d,s]),p=(0,r().VK)((()=>{var e;return"table"===(null===(e=o.collectionViewStore())||void 0===e?void 0:e.getType())}),[o]),g=(0,r().VK)((()=>{const e=d&&s[d];if(e&&"relation"===e.type){var t;const o=e.property;return o?null===(t=s[o])||void 0===t?void 0:t.name:void 0}}),[d,s]),m=(0,r().VK)((()=>{const e=o.collectionStore();return null!=e&&e.isDefined()?ht().aI(l,{sourceCollection:e.getModel(),isSelfRelation:!0,targetCollectionStore:e,createUnique:!0,from:i}):l.formatMessage({id:"database.viewSettings.relationsPropertyTab.inverseName.placeholder",defaultMessage:"Related to this database"})}),[o,l,i]),y=(0,r().qz)(void 0,xt().Z),{initialPropertyName:S}=(0,Ft().Ld)({collectionContextStore:o,feature:i}),h=(0,n.useCallback)((e=>{e&&y.setState({open:!1})}),[y]),x=(0,f().yK)((()=>({previewContainer:{marginLeft:2}})),[]);if(!a)return null;let v;return"subitem"===i?v=(0,C.jsx)(jt,{propertyName:u||S,inversePropertyName:g||m,subitemsDisplayMode:"show"}):"timeline_arrows_by"===i?v=(0,C.jsx)(Jt,{propertyName:u||S,inversePropertyName:g||m}):(0,N().t1)(i),(0,C.jsxs)(B().ZP,{...e,title:(0,C.jsx)(I()._H,{...St().dH.advancedSettings}),children:[(0,C.jsx)("div",{style:x.previewContainer,children:v}),(0,C.jsxs)(ee().Z,{disableMobileBorders:!0,children:[(0,C.jsx)(eo().I,{currentPropertyId:d,feature:i,onPropertySelect:h,buttonPopupStore:y,collectionContextStore:o,permissionScopes:c,disabled:!c.canConfigureCollection}),"subitem"===i&&p&&(0,C.jsx)(oo,{collectionContextStore:o,permissionScopes:c})]})]})}function oo(e){const{collectionContextStore:t,permissionScopes:o}=e,l=(0,I().YB)(),a=(0,i().O7)(),s=(0,r().VK)((()=>"title"===t.normalizedFormatStore.state.table_subitem_toggle_column),[t]),c=!o.canConfigureBlock,d=(0,n.useCallback)((()=>{const e=t.collectionViewStore();e&&(qt().d1({environment:a,collectionViewStore:e,currentValue:t.normalizedFormatStore.state.table_subitem_toggle_column}),Wt().wd({environment:a,collectionContextStore:t,action:"toggle_table_subitem_toggle_on_title"}))}),[t,a]);return(0,C.jsx)(Yt().Z,{showImage:o.canConfigureBlock,caption:l.formatMessage(St().dH.toggleNestingOnTitleMenuItemTooltip),tooltipImage:y().Z.images.tooltips.collectionSettings.subitemsToggleOnTitlePng,tooltipImageScale:.3,render:e=>(0,C.jsx)(F().Z,{...e,icon:e=>(0,zt().L)({width:11,height:11,marginRight:5,marginLeft:6,transform:"rotateZ(180deg)"}),onClick:d,title:(0,C.jsx)(I()._H,{defaultMessage:"Show nesting toggle on title",id:"database.viewSettings.layoutTab.tableSubitemToggleOnTitle"}),right:(0,C.jsx)(Gt().Z,{disallowTabbing:!0,on:s,disabled:c,onClick:d}),disabled:c})})}var no=()=>o(159732),io=()=>o(388915),ro=()=>o(654133),lo=()=>o(164079),ao=()=>o(998901),so=()=>o(138912);function co(e){const{integration:t,collectionSettingsStore:o,collectionContextStore:n,onAccountSelect:l}=e,a=(0,f().yK)((()=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px 16px 16px 8px"}})),[]),c=(0,i().O7)(),d=(0,r().VK)((()=>{var e;return null===(e=n.collectionStore())||void 0===e?void 0:e.getSpaceId()}),[n]),u=(0,r().VK)((()=>{const e=so().default.state;return e.loaded?e.externalAuthentications.filter((e=>e.integration_id===t.id)):[]}),[t]);return t&&d?(0,C.jsx)(B().ZP,{...e,title:(0,C.jsx)(I()._H,{defaultMessage:"Choose an account",id:"collectionSettingsAccountPicker.title"}),footer:uo({environment:c,integration:t,spaceId:d}),children:(0,C.jsx)("div",{style:a.settingsMenu,children:(0,C.jsx)(Q().ZP,{type:Q().iW.Vertical,initialFocus:0,sections:[{key:"externalAuthentications",items:u.map((e=>{const n={key:e.id,render:o=>(0,C.jsx)(ro().Z,{renderTooltip:()=>(0,C.jsx)("span",{children:e.account_name}),placement:ao().Placement.Left,textWrap:!0,render:n=>(0,C.jsx)(q().Z,{...(0,lo().Z)(n||{},o),title:e.account_name,icon:(0,C.jsx)("img",{style:{width:18},src:t.info.icon}),focused:o.focused})}),action:()=>{s().z$({collectionSettingsStore:o}),l(e)}};return n})),render:e=>(0,C.jsx)(ee().Z,{...e})}]})})}):null}function uo(e){const t=e.environment.device.isMobileBrowser;return(0,C.jsx)(ee().Z,{topBorder:!0,children:t?void 0:po(e)})}function po(e){return(0,C.jsx)(F().Z,{...e,icon:no().R,title:(0,C.jsx)(I()._H,{id:"collectionSettingsAccountPicker.addAccount",defaultMessage:"Connect another account"}),isGray:!0,onClick:async()=>{await io().hM({...e,from:"source_picker_connect_another_account"})}})}o(916054),o(228244);var go=()=>o(226413),mo=()=>o(766933),fo=()=>o(799891),yo=()=>o(619186),So=()=>o(450048),ho=()=>o(715139),xo=()=>o(740046),vo=()=>o(668001),Co=()=>o(527278),bo=()=>o(395154),wo=()=>o(303171),jo=()=>o(154186),_o=()=>o(265640),Mo=()=>o(312578),ko=()=>o(514);function Po(e){const{title:t,items:o,handleSelect:r,isSelectAll:l,sectionCallout:a,selectAllTooltipContent:s,isSectionItemsLoading:c}=e,[d,u]=n.useState(!0),{isMobile:p}=(0,i().Fy)(),g=e.disableCollapse??!1,m=(0,f().yK)((e=>({sectionMargin:{margin:"0px 14px"},sectionTitleContainer:{display:"flex",padding:2,borderRadius:6,gap:2,alignItems:"center"},sectionMenuDesktopTitleStyle:{padding:0,margin:0,alignItems:"center"},arrow:{width:p?14:12,height:p?14:12,transition:"transform 200ms ease-out",transform:`rotateZ(${d?0:-90}deg)`,fill:"inherit",opacity:1,marginTop:2},menuList:{paddingTop:0,paddingBottom:0}})),[p,d]);return o.length?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(ee().Z,{style:{...m.sectionMargin},desktopTitleStyle:m.sectionMenuDesktopTitleStyle,title:(0,C.jsxs)(jo().Z,{style:m.sectionTitleContainer,onClick:()=>u(!d),disabled:g,children:[t,!g&&(0,wo().A)(m.arrow),c&&(0,C.jsx)(Mo().Z,{style:{alignSelf:"right"}})]}),right:o.length&&d&&!c&&(0,C.jsx)(ro().Z,{renderTooltip:e=>(0,C.jsx)("div",{...e,style:ko().F6,children:s}),render:e=>(0,C.jsx)("div",{...e,children:(0,C.jsx)(To,{onClick:r,isSelectAll:l})}),disableTooltip:!s})}),d&&(0,C.jsxs)(C.Fragment,{children:[a,(0,C.jsx)(Q().ZP,{style:m.menuList,type:Q().iW.Vertical,initialFocus:0,sections:[{key:"collapsableSectionMenuList",render:e=>(0,C.jsx)(ee().Z,{topBorder:!1,...e}),items:o}]})]})]}):(0,C.jsx)(C.Fragment,{})}function To(e){return(0,C.jsx)(_o().D,{size:"sm",shouldShrink:!0,isBlue:!0,style:{fontSize:V().JB.UISmall.desktop,height:"fit-content"},onClick:e.onClick,children:e.isSelectAll?(0,C.jsx)(I()._H,{id:"database.viewSettings.collapsableSection.selectAll",defaultMessage:"Select all"}):(0,C.jsx)(I()._H,{id:"database.viewSettings.collapsableSection.unselectAll",defaultMessage:"Unselect all"})})}const Io=(0,I().vU)({inputPlaceholder:{defaultMessage:"Search property",id:"database.viewSettings.ConnectedRelationActionsAddProperties.inputPlaceholder"},addColumn:{defaultMessage:"Add properties",id:"database.viewSettings.ConnectedRelationActionsAddProperties.addColumn"}});function Vo(e){const{collectionSettingsStore:t,collectionContextStore:o,rootPropertySchema:l,rootPropertyId:a,integrationId:c}=e,[u,p]=n.useState(""),[g,m]=n.useState([]),y=(0,r().VK)((()=>{var e;return null==o||null===(e=o.collectionStore())||void 0===e?void 0:e.getSpaceId()}),[o]),h=(0,f().Fg)(),x=(0,i().O7)(),v=(0,f().yK)((e=>({buttonWrapper:{borderColor:"none",padding:8},button:{width:"100%",border:"none",fontWeight:V().Ue.medium},shimmerRow:{display:"flex",cursor:"pointer",alignItems:"center",gap:6,height:24,marginTop:4,marginLeft:16,borderRadius:4},leftShimmer:{height:14,width:14,borderRadius:6},rightShimmer:{height:14,borderRadius:6}})),[]),[{status:b,value:w}]=(0,S().r5)((async()=>{var e;if(!y)return;if(!l||!(0,go().NK)(l))return;const t=null==l?void 0:l.collection_pointer;if(!t)return;const n=new(bo().N)(x,t);await n.load();const i=null==n||null===(e=n.getFormat())||void 0===e?void 0:e.pattern_name;if(!i)return;const r=await So().ne({environment:x,integrationId:c,connectedRelationPatternName:i,spaceId:y}),s=o.collectionStore();if(s&&r){const e=Ao({collectionStore:s,rootPropertyId:a}).map((e=>e.attributeName));return r.map((t=>({...t,isSelected:!!e.includes(t.id)})))}}),[x,y,c,l,o,a]);(0,n.useEffect)((()=>{"resolved"===b&&w&&m(w)}),[b,w]);const j=g.length?(0,yo().ZP)(u,g,(e=>e.name)):[],_=e=>{m(g.map((t=>t.id===e.id?{id:e.id,name:e.name,isSelected:!e.isSelected,type:e.type,isCustom:e.isCustom,options:e.options}:t)))},M=j.filter((e=>!e.isCustom)).map((e=>({key:e.id,render:()=>(0,C.jsx)(q().Z,{focused:!1,style:{},onClick:()=>{_(e)},title:(0,C.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,C.jsx)("div",{children:(0,C.jsx)(ho().Z,{size:14,checked:e.isSelected,onClick:()=>{_(e)},style:{borderRadius:2}})}),icon:(0,C.jsx)(mo().ZP,{type:e.type??"text",icon:void 0,size:16,theme:h})}),action:()=>{}}))),k=j.filter((e=>e.isCustom)).map((e=>({key:e.id,render:()=>(0,C.jsx)(q().Z,{focused:!1,style:{},onClick:()=>{_(e)},title:(0,C.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,C.jsx)("div",{children:(0,C.jsx)(ho().Z,{size:14,checked:e.isSelected,onClick:()=>{_(e)},style:{borderRadius:2}})}),icon:(0,C.jsx)(mo().ZP,{type:e.type??"text",icon:void 0,size:16,theme:h})}),action:()=>{}})));return(0,C.jsx)(B().ZP,{...e,title:(0,C.jsx)(I()._H,{defaultMessage:"Add properties",id:"ConnectedRelationActionsAddProperties.titleForSelectPropertiesTab"}),header:(0,C.jsx)(Zo,{inputValue:u,integrationName:"Salesforce",onChange:p}),footer:"resolved"===b&&(0,C.jsx)("div",{style:v.buttonWrapper,children:(0,C.jsx)(X().Z,{style:v.button,onClick:e=>{e.stopPropagation(),function(e,t,o,n,i){const r=t.collectionStore();if(!r)return;const l=t.collectionViewStore(),a=t.getPropertyFormatKey();if(!a)return;const s=o.filter((e=>e.isSelected)),c=Ao({collectionStore:r,rootPropertyId:n}),u=c.map((e=>e.attributeName)),p=s.filter((e=>!u.includes(e.id))).map((e=>({propertyAttribute:e.id,rootPropertyId:n,name:e.name,type:e.type,options:e.options}))),g=c.filter((e=>!s.some((t=>t.id===e.attributeName))));if(p.length||g.length){var m;d().createAndCommit({userAction:"CollectionSettingsConnectedRelationActionsCreateNewProperty",environment:e,canUndo:!0,perform:t=>{if(p.length&&at().g2({environment:e,collectionStore:r,transaction:t,propertiesToBeAdded:p,collectionViewArgs:l?{collectionViewStore:l,format:l.getFormat(),formatKey:a}:void 0}),g.length){const o=r.getSchema();for(const n of g)at().E2({environment:e,transaction:t,permanentlyDelete:!0,collectionStore:r,schema:o,property:n.id})}}}),fo().log({level:"info",from:"ConnectedRelationActionsAddProperties",type:"updateCollectionSchema",data:{miscDataToConvertToString:{propertiesToBeAddedCount:p.length,propertiesToBeDeletedCount:g.length,collectionPointer:null===(m=t.collectionStore())||void 0===m?void 0:m.getSpacePointer(),rootPropertyId:n,totalProperties:o.length}}}),(0,mt().j)({environment:e,event:{eventName:"salesforce_actions",eventProperties:{integrationId:i,actionType:"added_properties_for_connected_relation"}}})}}(x,o,g,a,c),s().E3({collectionSettingsStore:t})},children:Co().Z.formatMessage(Io.addColumn)})}),handleClose:()=>{s().E3({collectionSettingsStore:t})},menuScrollerStyle:{paddingBottom:6},children:(0,C.jsxs)(C.Fragment,{children:["pending"===b&&(0,C.jsx)("div",{children:(0,C.jsx)("div",{children:[64,51,73,95,45,67,45,91,52].map(((e,t)=>(0,C.jsxs)("div",{style:{...v.shimmerRow},children:[(0,C.jsx)(vo().Z,{style:{...v.leftShimmer}}),(0,C.jsx)(vo().Z,{style:{...v.rightShimmer,width:e}})]},t)))})}),"resolved"===b&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Po,{title:(0,C.jsx)(I()._H,{defaultMessage:"{propertyCount, plural, one {{propertyCount} standard property} other {{propertyCount} standard properties}}",id:"database.viewSettings.ConnectedRelationActionsAddProperties.standardPropertiesTitle",values:{propertyCount:g.filter((e=>!e.isCustom)).length}}),isSelectAll:!g.filter((e=>!e.isCustom)).every((e=>e.isSelected)),items:M,handleSelect:()=>{g.filter((e=>!e.isCustom)).every((e=>e.isSelected))?m(g.map((e=>e.isCustom?e:{...e,isSelected:!1}))):m(g.map((e=>e.isCustom?e:{...e,isSelected:!0})))}},"Standard Properties"),(0,C.jsx)(Po,{title:(0,C.jsx)(I()._H,{defaultMessage:"{propertyCount, plural, one {{propertyCount} custom property} other {{propertyCount} custom properties}}",id:"database.viewSettings.ConnectedRelationActionsAddProperties.OptionalPropertiesTitle",values:{propertyCount:g.filter((e=>e.isCustom)).length}}),isSelectAll:!g.filter((e=>e.isCustom)).every((e=>e.isSelected)),items:k,handleSelect:()=>{g.filter((e=>e.isCustom)).every((e=>e.isSelected))?m(g.map((e=>e.isCustom?{...e,isSelected:!1}:e))):m(g.map((e=>e.isCustom?{...e,isSelected:!0}:e)))}},"Optional Properties")]})]})})}function Ao(e){const{collectionStore:t,rootPropertyId:o}=e,n=t.getSchema(),i=[];for(const c in n){var r;if("rollup"===(null===(r=n[c])||void 0===r?void 0:r.type)){var l,a;if((null===(l=n[c])||void 0===l?void 0:l.relation_property)===o)i.push({id:c,attributeName:null===(a=n[c])||void 0===a||null===(a=a.target_property)||void 0===a?void 0:a.trim()})}else{var s;const e=null===(s=n[c])||void 0===s?void 0:s.derived_property_record_metadata;(null==e?void 0:e.pointer_property_uri)===o&&i.push({id:c,attributeName:null==e?void 0:e.external_object_attribute})}}return i}function Zo(e){const{isMobile:t}=(0,i().Fy)();return(0,C.jsxs)(ee().Z,{children:[(0,C.jsx)(pt().Z,{isSecondaryColor:!0,isMultiline:!0,style:{marginLeft:12,marginBottom:12,fontSize:t?V().JB.UISmall.mobile:V().JB.UISmall.desktop},children:(0,C.jsx)(I()._H,{defaultMessage:"Add {integrationName} properties as a column directly to this database.",id:"database.viewSettings.ConnectedRelationActionsAddProperties.description",values:{integrationName:e.integrationName}})}),(0,C.jsx)(xo().ZP,{focusInitial:!0,value:e.inputValue,onChange:t=>{e.onChange(t.target.value)},placeholder:Co().Z.formatMessage(Io.inputPlaceholder)})]})}o(470928);const Bo=(0,o(830742).LS)("bulkCreateConnectedProperty");var Fo=()=>o(782646);const Ro=(0,I().vU)({copyUrlDescription:{defaultMessage:"Content will be copied and any Salesforce URLs will be auto-converted as a Salesforce property with live preview on hover.",id:"database.viewSettings.salesforceConfigTab.copyUrlDescription"},copyColumn:{defaultMessage:"Copy column",id:"ConnectedRelationActionsCopyUrl.copyColumn"},SalesforceBulkCreateConnectedPropertyFailed:{defaultMessage:"Failed to copy column",id:"ConnectedRelationActionsCopyUrl.SalesforceBulkCreateConnectedPropertyFailed"}});function Ko(e){const{collectionSettingsStore:t,collectionContextStore:o,integrationId:l}=e,[a,c]=(0,n.useState)(null),d=(0,i().O7)(),u=(0,r().VK)((()=>{var e;const t=null==o||null===(e=o.collectionStore())||void 0===e?void 0:e.getSchema();if(!t)return[];const n=[];for(const[o,i]of Object.entries(t)){i&&"url"===i.type&&n.push({id:o,...i})}return n}),[o]);(0,n.useEffect)((()=>{var e;c((null===(e=u[0])||void 0===e?void 0:e.id)||null)}),[u]);const p=(0,f().yK)((e=>({buttonWrapper:{borderColor:"none",padding:8},button:{width:"100%",border:"none",fontWeight:V().Ue.medium},addDivider:{borderColor:e.tableDividerColor}})),[]);return(0,C.jsx)(B().ZP,{...e,title:(0,C.jsx)(I()._H,{defaultMessage:"Copy URL",id:"ConnectedRelationActionsCopyUrl.titleForCopyUrlTab"}),header:(0,C.jsx)(Oo,{}),handleClose:()=>{s().E3({collectionSettingsStore:t})},menuScrollerStyle:{paddingBottom:6},children:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(vt().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"What to copy?",id:"ConnectedRelationActionsCopyUrl.whatToCopy"}),selectedKey:a||"select",popupStyle:{minWidth:190},options:[...null==u?void 0:u.map((e=>e?{key:e.id,type:"button",title:e.name}:void 0)).filter((e=>void 0!==e))],onChange:e=>{c(e)}}),(0,C.jsx)("div",{style:p.buttonWrapper,children:(0,C.jsx)(X().Z,{style:p.button,onClick:async n=>{n.stopPropagation(),s().E3({collectionSettingsStore:t});const i=so().default.bots.state.find((e=>e.integration_id===l));if(!i)return;const r=i.id,c=o.collectionStore(),u=a&&c?(0,Fo().Lj)(d,Bo,{spaceId:c.getSpaceId(),botId:r,collectionId:c.id,integrationId:e.integrationId,sourceColumnId:a,destinationColumnId:e.property}):null;if(u)for await(const e of u)"in_progress"!==e.taskStatus&&(e.taskStatus,"failure"!==e.taskStatus&&"dead"!==e.taskStatus&&"timeout_before_execution"!==e.taskStatus&&"retryable_failure"!==e.taskStatus||e.error&&A().UW(Co().Z.formatMessage(Ro.SalesforceBulkCreateConnectedPropertyFailed)))},children:Co().Z.formatMessage(Ro.copyColumn)})}),(0,C.jsx)(ut().Z,{size:"100%",innerStyle:{borderColor:p.addDivider.borderColor}}),(0,C.jsx)(Ho,{})]})})}function Ho(){const e=(0,I().YB)(),{isMobile:t}=(0,i().Fy)(),o=(0,f().yK)((e=>({previewContentContainer:{display:"flex",alignSelf:"center",flexDirection:"column",width:"100%",paddingLeft:10,paddingRight:10,cursor:"default"},tabDescription:{padding:t?18:10,fontSize:t?16:12,color:e.lightTextColor}})),[t]);return(0,C.jsxs)(ee().Z,{disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,mobileStyle:o.previewContentContainer,children:[(0,C.jsxs)("div",{style:o.tabDescription,children:[" ","Preview"]}),(0,C.jsx)("div",{children:(0,C.jsx)("img",{src:y().Z.images.externalIntegrations.salesforceCopyUrlPng,style:o.previewContentContainer,alt:"Salesforce Copy URL"})}),(0,C.jsx)("div",{style:o.tabDescription,children:e.formatMessage(Ro.copyUrlDescription)})]})}function Oo(e){const{isMobile:t}=(0,i().Fy)();return(0,C.jsx)(ee().Z,{children:(0,C.jsx)(pt().Z,{isSecondaryColor:!0,isMultiline:!0,style:{marginLeft:12,marginBottom:12,fontSize:t?V().JB.UISmall.mobile:V().JB.UISmall.desktop},children:(0,C.jsx)(I()._H,{defaultMessage:"Select the column you wish to copy and auto-populate this property.\nCopying URL from column will override all existing Salesforce URLs.",id:"database.viewSettings.ConnectedRelationActionsCopyUrl.description"})})})}o(122556),o(582845),o(250570),o(533019),o(721473),o(788208),o(22624);var Lo=()=>o(235484),Do=(o(821057),o(30005),()=>o(124199)),Eo=()=>o(35277);const No={name:"User",regex:"^(https?:\\/\\/)?(?<instanceUrl>[a-z0-9-]+\\.[\\w.]+\\.force\\.com)\\/lightning\\/r\\/User\\/(?<recordId>[a-zA-Z0-9]+)\\/(?<action>[a-zA-Z0-9_]+)?(\\?(?<queryParams>[^\\s#]*))?$",sample_urls:["https://notion.lightning.force.com/lightning/r/User/0055b00000MWTaJAAX/view","https://notion.lightning.force.com/lightning/r/user/0055b00000MWTaJAAX/view"],additional_types:{connectedRelation:!0},attributes:Eo().j1.attributes,connected_relation_properties:{title:{name:"Name",type:"title"},Id:{name:"Id",type:"text"},CreatedDate:{name:"Created Date",type:"date"},LastModifiedDate:{name:"Last Modified Date",type:"date"},Email:{name:"Email",type:"email"},SmallPhotoUrl:{name:"Avatar URL",type:"url"},NotionUser:{name:"Notion User",type:"relation",uri:"notion://user-defined-collection/salesforce:User"}},connected_relation_sub_schemas:{"notion://user-defined-collection/salesforce:User":{title:{name:"Name",type:"title"}}}},Uo={name:"Report",regex:"^(https?:\\/\\/)?(?<instanceUrl>[a-z0-9-]+\\.[\\w.]+\\.force\\.com)\\/lightning\\/r\\/Report\\/(?<recordId>[a-zA-Z0-9]+)\\/(?<action>[a-zA-Z0-9_]+)?(\\?(?<queryParams>[^\\s#]*))?$",sample_urls:["https://notionlabs-dev-ed.develop.lightning.force.com/lightning/r/Report/00O5b000000Xr5jEAC/view","https://notionlabs-abc-dev-ed.develop.lightning.force.com/lightning/r/Report/00O5b000000Xr5jEAC/view?queryParamsAny=test"],attributes:Eo().j1.attributes},zo=[{name:"Account",regex:"^(https?:\\/\\/)?(?<instanceUrl>[a-z0-9-]+\\.[\\w.]+\\.force\\.com)\\/lightning\\/r\\/Account\\/(?<recordId>[a-zA-Z0-9]+)\\/(?<action>[a-zA-Z0-9_]+)",sample_urls:["https://notionlabs-dev-ed.develop.lightning.force.com/lightning/r/Account/001bm000004etjTAAQ/view","https://notionlabs-dev-ed.develop.lightning.force.com/lightning/r/Account/001bm000004euUDAAY/view"],attributes:Eo().j1.attributes,additional_types:{connectedRelation:!0},connected_relation_properties:{...Eo().j1.connected_relation_properties,Type:{name:"Type",type:"text"},AccountNumber:{name:"Account Number",type:"text"},AnnualRevenue:{name:"Annual Revenue",type:"number"},Website:{name:"Website",type:"url"},Phone:{name:"Phone",type:"phone_number"},Description:{name:"Description",type:"text"},ParentId:{uri:"notion://user-defined-collection/salesforce:Account",name:"Parent Account",type:"relation"},OwnerId:{uri:"notion://user-defined-collection/salesforce:User",name:"Account Owner",type:"relation"},mapped_OwnerId:{name:"Mapped Account Owner",uri:"notion://user-defined-collection/salesforce:User",type:"person",source_property_id:"Email"}},connected_relation_sub_schemas:Eo().j1.connected_relation_sub_schemas},{name:"Contact",regex:"^(https?:\\/\\/)?(?<instanceUrl>[a-z0-9-]+\\.[\\w.]+\\.force\\.com)\\/lightning\\/r\\/Contact\\/(?<recordId>[a-zA-Z0-9]+)\\/(?<action>[a-zA-Z0-9_]+)",sample_urls:["https://notionlabs-dev-ed.develop.lightning.force.com/lightning/r/Contact/003bm000004etjTAAQ/view","https://notionlabs-dev-ed.develop.lightning.force.com/lightning/r/Contact/003bm000004euUDAAY/view"],attributes:Eo().j1.attributes,additional_types:{connectedRelation:!0},connected_relation_properties:{...Eo().j1.connected_relation_properties,Phone:{name:"Phone",type:"phone_number"},Email:{name:"Email",type:"email"},AccountId:{uri:"notion://user-defined-collection/salesforce:Account",name:"Account",type:"relation"}},connected_relation_sub_schemas:Eo().j1.connected_relation_sub_schemas},{name:"Opportunity",regex:"^(https?:\\/\\/)?(?<instanceUrl>[a-z0-9-]+\\.[\\w.]+\\.force\\.com)\\/lightning\\/r\\/Opportunity\\/(?<recordId>[a-zA-Z0-9]+)\\/(?<action>[a-zA-Z0-9_]+)",sample_urls:["https://notionlabs-dev-ed.develop.lightning.force.com/lightning/r/Opportunity/006bm000004etjTAAQ/view","https://notionlabs-dev-ed.develop.lightning.force.com/lightning/r/Opportunity/006bm000004euUDAAY/view"],attributes:Eo().j1.attributes,additional_types:{connectedRelation:!0},connected_relation_properties:{...Eo().j1.connected_relation_properties,Amount:{name:"Amount",type:"number"},CloseDate:{name:"Close Date",type:"date"},StageName:{name:"Stage",type:"text"},AccountId:{uri:"notion://user-defined-collection/salesforce:Account",name:"Account",type:"relation"},OwnerId:{name:"Owner",uri:"notion://user-defined-collection/salesforce:User",type:"relation"},mapped_OwnerId:{name:"Mapped Opportunity Owner",uri:"notion://user-defined-collection/salesforce:User",type:"person",source_property_id:"Email"}},connected_relation_sub_schemas:Eo().j1.connected_relation_sub_schemas},No],Wo=(Eo().j1,zo.map((e=>({name:e.name,additional_types:e.additional_types,connected_relation_properties:e.connected_relation_properties,connected_relation_sub_schemas:e.connected_relation_sub_schemas}))),Do().string());Do().object({required:{Name:Do().string(),Id:Wo,CreatedById:Wo},optional:{UserName:Do().string(),SmallPhotoUrl:Do().nullable(Do().string()),Alias:Do().nullable(Do().string()),Email:Do().nullable(Do().string()),IsActive:Do().boolean(),ProfileId:Do().nullable(Wo),UserType:Do().nullable(Do().string())}}),Do().union([Do().object({required:{scope:Do().string(),signature:Do().string(),access_token:Do().string(),refresh_token:Do().string(),instance_url:Do().string(),id:Do().string(),token_type:Do().string(),issued_at:Do().string()},optional:{id_token:Do().string(),refresh_token:Do().string(),state:Do().string()}})]),Do().object({required:{sub:Do().string(),user_id:Do().string(),organization_id:Do().string(),preferred_username:Do().string(),name:Do().string(),email:Do().string()},optional:{nickname:Do().string(),email_verified:Do().boolean(),given_name:Do().string(),family_name:Do().string(),zoneinfo:Do().string(),photos:Do().object({optional:{},required:{picture:Do().string(),thumbnail:Do().string()}}),profile:Do().string(),picture:Do().string(),address:Do().object({optional:{country:Do().string()},required:{}}),urls:Do().record(Do().string(),Do().string()),active:Do().boolean(),user_type:Do().string(),language:Do().string(),locale:Do().string(),utcOffset:Do().number(),updated_at:Do().string()}});var qo=()=>o(853292);async function Go(e){var t,o;const{environment:n,objectName:i,objectLabel:r,collectionContextStore:l,intl:a}=e,s=so().default.state;if(!s.loaded)return[];const c=null==l||null===(t=l.collectionStore())||void 0===t?void 0:t.getSpaceId();if(!c)return;const d=null==l||null===(o=l.collectionStore())||void 0===o?void 0:o.getSpacePointer();fo().log({level:"info",from:"salesforceConnectedRelationActions",type:"createSalesforceConnectedRelationProperty",data:{message:"Received request to create Salesforce connected relation property",miscDataToConvertToString:{objectName:i,objectLabel:r,spaceId:c,collectionPointer:d}}});const u=s.integrations.find((e=>e.id===Lo().aW));if(!u)return;const p=so().default.bots.state.find((e=>e.integration_id===Lo().aW));if(!p)return;const g=p.id,m=await ie().callApi({eventName:"describeSalesforceObject",environment:n,data:{spaceId:c,objectName:i,botId:g}});if("success"!==(null==m?void 0:m.type))return fo().log({level:"error",from:"salesforceConnectedRelationActions",type:"createSalesforceConnectedRelationProperty",data:{message:"Describe Salesforce object failed while creating Salesforce connected relation property",miscDataToConvertToString:{objectName:i,objectLabel:r,spaceId:c,collectionPointer:d,error:m.error}}}),void(0,mt().j)({environment:n,event:{eventName:"salesforce_actions",eventProperties:{integrationId:Lo().aW,actionType:"create_connected_relation_property",status:"failed"}}});const f=function(e){const{describeObjectResponse:t,objectName:o}=e;let n={},i={};return t.forEach((e=>{if("Name"!==e.name){if("created_by"!==e.type&&"last_edited_by"!==e.type&&"created_time"!==e.type&&"last_edited_time"!==e.type&&"rollup"!==e.type&&"formula"!==e.type)if("relation"===e.type){if(e.referenceTo){const t=e.referenceTo;n[e.name]={name:e.label,type:e.type,uri:`notion://user-defined-collection/salesforce:${t}`},i[`notion://user-defined-collection/salesforce:${t}`]={title:{name:e.label,type:"title"}}}}else if("select"===e.type||"multi_select"===e.type){var t;n[e.name]={name:e.label,type:e.type,options:null===(t=e.picklistValues)||void 0===t?void 0:t.map((e=>({id:e.label,value:e.value})))}}else"person"===e.type?n[e.name]={name:e.label,type:e.type,uri:"notion://user-defined-collection/salesforce:User",source_property_id:"Email"}:n[e.name]={name:e.label,type:e.type}}else n.title={name:e.label,type:"title"}})),n={...Eo().j1.connected_relation_properties,...n},i={...Eo().j1.connected_relation_sub_schemas,...i},{value:{name:o,regex:(0,Eo().Hw)(o),attributes:Eo().j1.attributes,additional_types:{connectedRelation:!0},connected_relation_properties:n,connected_relation_sub_schemas:i}}}({describeObjectResponse:m.data.properties,objectName:i});if(E().x.isFail(f))return fo().log({level:"error",from:"salesforceConnectedRelationActions",type:"createSalesforceConnectedRelationProperty",data:{message:"Failed to get connected relation pattern while creating Salesforce connected relation property",miscDataToConvertToString:{objectName:i,objectLabel:r,spaceId:c,collectionPointer:d,error:f.error}}}),(0,mt().j)({environment:n,event:{eventName:"salesforce_actions",eventProperties:{integrationId:Lo().aW,actionType:"create_connected_relation_property",status:"failed"}}}),{error:new Error(f.error)};const y={name:`${u.name} ${r}`,pattern:f.value,integration:u};await qo().Jw({environment:n,connectedRelationProperty:y,collectionContextStore:l,intl:a,from:"new_property",propertyGroupId:void 0,propertyLimit:"1"}),fo().log({level:"info",from:"salesforceConnectedRelationActions",type:"createSalesforceConnectedRelationProperty",data:{message:"Successfully created Salesforce connected relation property",miscDataToConvertToString:{objectName:i,objectLabel:r,spaceId:c,collectionPointer:d}}}),(0,mt().j)({environment:n,event:{eventName:"salesforce_actions",eventProperties:{integrationId:Lo().aW,actionType:"create_connected_relation_property",status:"success"}}})}const Yo=(0,I().vU)({inputPlaceholder:{defaultMessage:"Search object",id:"database.viewSettings.ConnectedRelationActionsObjectSelection.inputPlaceholder"}});function $o(e){const{collectionSettingsStore:t,collectionContextStore:o}=e,[l,a]=n.useState(""),c=(0,i().O7)(),d=(0,I().YB)(),u=(0,f().Fg)(),p=(0,r().VK)((()=>{var e;return null==o||null===(e=o.collectionStore())||void 0===e?void 0:e.getSpaceId()}),[o]),g=(0,r().VK)((()=>{const e=so().default.state;if(!e.loaded)return;const t=e.integrations.find((e=>e.id===Lo().aW));return t?t.info.icon:void 0}),[]),m=(0,f().yK)((e=>({shimmerRow:{display:"flex",cursor:"pointer",alignItems:"center",gap:6,height:24,marginTop:4,marginLeft:16,borderRadius:4},leftShimmer:{height:14,width:14,borderRadius:6},rightShimmer:{height:14,borderRadius:6}})),[]),[{status:y,value:h}]=(0,S().r5)((async()=>{if(!p)return;const e=await async function(e){var t;const{environment:o,spaceId:n}=e,i=so().default.bots.state.find((e=>e.integration_id===Lo().aW));if(!i)return;const r=i.id,l=await ie().callApi({eventName:"listSalesforceObjects",environment:o,data:{spaceId:n,botId:r}});return"success"===(null==l?void 0:l.type)?null==l||null===(t=l.data)||void 0===t?void 0:t.sObjects:void 0}({environment:c,spaceId:p});return e&&e.length>0?e.map((e=>({name:e.name,label:e.label}))):void 0}),[p,c]),[{status:x,value:v}]=(0,S().r5)((async()=>{var e;const t=null===(e=o.collectionStore())||void 0===e?void 0:e.getSchema(),n=new Set;if(t){const e=Object.values(t);for(const t of e){var i;if(t&&(0,go().NK)(t)&&(null===(i=t.connectedRelation)||void 0===i?void 0:i.integration_id)===Lo().aW){var r;const e=t.collection_pointer;if(!e)continue;const o=new(bo().N)(c,e);await o.load();const i=null==o||null===(r=o.getFormat())||void 0===r?void 0:r.pattern_name;i&&n.add(i)}}}return n}),[c,o]);return(0,C.jsxs)(B().ZP,{...e,title:(0,C.jsx)(I()._H,{defaultMessage:"Salesforce",id:"ConnectedRelationActionsObjectSelection.titleForSelectPropertiesTab"}),header:(0,C.jsx)(Qo,{inputValue:l,integrationName:"Salesforce",onChange:a}),handleClose:()=>{s().E3({collectionSettingsStore:t})},menuScrollerStyle:{paddingBottom:6},children:[("pending"===y||"pending"===x)&&(0,C.jsx)("div",{children:(0,C.jsx)("div",{children:[64,51,73,95,45,67,45,91,52].map(((e,t)=>(0,C.jsxs)("div",{style:{...m.shimmerRow},children:[(0,C.jsx)(vo().Z,{style:{...m.leftShimmer}}),(0,C.jsx)(vo().Z,{style:{...m.rightShimmer,width:e}})]},t)))})}),"resolved"===y&&"resolved"===x&&h&&(0,C.jsx)(Q().ZP,{type:Q().iW.Vertical,initialFocus:0,sections:[{key:"objects",render:e=>(0,C.jsx)(ee().Z,{...e,title:"Salesforce objects"}),items:h.filter((e=>e.label.toLowerCase().includes(l.toLowerCase()))).map((e=>({key:e.name,render:t=>(0,C.jsx)(ro().Z,{placement:ao().Placement.Left,textWrap:!0,style:{maxWidth:240},disableTooltip:!v.has(e.name),renderTooltip:()=>(0,C.jsx)(I()._H,{defaultMessage:"This object is already connected to a property in this collection.",id:"ConnectedRelationActionsObjectSelection.alreadyConnected"}),render:o=>(0,C.jsx)(q().Z,{...(0,lo().Z)(t,o),disabled:v.has(e.name),style:{opacity:v.has(e.name)?.5:1},title:e.label,id:e.name,icon:(0,C.jsx)(mo().ZP,{type:"text",icon:g,size:16,theme:u})})}),action:async()=>{await Go({environment:c,objectName:e.name,objectLabel:e.label,collectionContextStore:o,intl:d})}})))}]})]})}function Qo(e){return(0,C.jsx)(ee().Z,{children:(0,C.jsx)(xo().ZP,{focusInitial:!0,value:e.inputValue,onChange:t=>{e.onChange(t.target.value)},placeholder:Co().Z.formatMessage(Yo.inputPlaceholder)})})}function Jo(e){const{collectionSettingsStore:t,collectionContextStore:o,tabSettings:{source:n,rootPropertyId:i,rootPropertySchema:r,integrationId:l}}=e;return"connectedRelationAddProperties"===n&&i&&r?(0,C.jsx)(Vo,{collectionSettingsStore:t,collectionContextStore:o,rootPropertyId:i,integrationId:l,rootPropertySchema:r}):"ConnectedRelationObjectSelection"===n?(0,C.jsx)($o,{collectionSettingsStore:t,collectionContextStore:o,integrationId:l}):"connectedRelationCopyUrl"===n&&i?(0,C.jsx)(Ko,{collectionContextStore:o,integrationId:l,property:i,collectionSettingsStore:t}):null}var Xo=()=>o(565271),en=()=>o(899548),tn=()=>o(568017),on=()=>o(916673),nn=()=>o(286310),rn=()=>o(959137),ln=()=>o(423402),an=()=>o(61738),sn=()=>o(842574),cn=()=>o(763266),dn=()=>o(861026),un=()=>o(876822);function pn(e){const{onClick:t,integration:o,accountName:n}=e,i=(0,f().yK)((e=>({accountSelection:{padding:"8px",borderTop:`1px solid ${e.regularDividerColor}`,cursor:"pointer"},accountSelectionLabel:{fontWeight:V().Ue.medium,paddingLeft:4,paddingTop:4}})),[]);return(0,C.jsx)("div",{style:i.accountSelection,children:(0,C.jsxs)("div",{onClick:t,children:[(0,C.jsx)(pt().Z,{isSecondaryColor:!0,isSmall:!0,style:i.accountSelectionLabel,children:(0,C.jsx)(I()._H,{id:"collectionSettingsCreateExternalViewPicker.currentAccountSection.label",defaultMessage:"Connected to {integration}",values:{integration:o.name}})}),(0,C.jsx)(ro().Z,{renderTooltip:()=>(0,C.jsx)("span",{children:n}),placement:ao().Placement.Left,textWrap:!0,render:t=>(0,C.jsx)(q().Z,{showExtensionArrow:!0,focused:!1,...(0,lo().Z)(t||{},e),title:n,icon:(0,C.jsx)("img",{style:{width:18},src:o.info.icon})})})]})})}var gn=()=>o(661727);function mn(e,t){const{r:o,g:n,b:i}=(null==e?void 0:e.info.accent_color)||{r:0,g:0,b:0},r=`rgba(${o},${n},${i},${"dark"===t?.6:1})`;return{background:r,hoveredBackground:(0,gn()._j)(r,.4),pressedBackground:(0,gn()._j)(r,.9)}}var fn=()=>o(943620),yn=()=>o(56424);function Sn(e){const{collectionContextStore:t,integration:o}=e,n=(0,f().Fg)(),l=(0,r().VK)((()=>t.collectionStore()),[t]),a=(0,r().VK)((()=>null==l?void 0:l.getIcon()),[l]),s=(0,i().O7)(),c=(0,r().VK)((()=>{var e;return null===(e=un().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),d=(0,f().yK)((e=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px 16px 16px 8px"},authenticationBody:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",padding:"0px 16px 16px 16px",textAlign:"center"},settingsMenuSubHeading:{display:"inline",fontSize:14,margin:"4px 20px 20px 20px",color:e.mediumTextColor,textAlign:"center"},settingsMenuAuthenticationButton:{fontSize:14,height:32,color:e.regularInvertedTextColor}})),[]),{background:u,hoveredBackground:p,pressedBackground:g}=mn(o,n.mode);return(0,C.jsx)(B().ZP,{...e,title:(0,C.jsx)(I()._H,{defaultMessage:"Connect to {integration}",id:"collectionSettingsCreateExternalViewPicker.authenticateHeader.title",values:{integration:o.name}}),children:(0,C.jsx)("div",{style:d.settingsMenu,children:(0,C.jsxs)("div",{style:d.authenticationBody,children:[(0,C.jsx)(fn().Z,{disabled:!0,bucket:"secure",store:l,icon:a,size:40,isEmptyPage:!1,style:{marginBottom:6}}),(0,C.jsx)("div",{style:d.settingsMenuSubHeading,children:(0,C.jsx)(I()._H,{defaultMessage:"Link your {integration} account for richer content previews and seamless imports.",id:"collectionSettingsCreateExternalViewPicker.authenticateBody.title",values:{integration:o.name}})}),(0,C.jsx)(_o().D,{onClick:()=>{c&&(io().hM({environment:s,integration:o,spaceId:c,from:"placeholder_root_external_collection_view_block"}),yn().Z.reset())},style:{background:u,...d.settingsMenuAuthenticationButton},hoveredStyle:{background:p},pressedStyle:{background:g},children:(0,C.jsx)(I()._H,{defaultMessage:"Connect to {integration}",id:"collectionSettingsCreateExternalViewPicker.authenticateButton.title",values:{integration:o.name}})})]})})})}function hn(e){const{collectionSettingsStore:t,collectionContextStore:o,externalAuthentication:n}=e,i=(0,r().VK)((()=>o.collectionStore()),[o]),l=(0,r().VK)((()=>{if(!i)return;const e=i.getFormat().integration_id;return so().default.integrations.state.find((t=>t.id===e))}),[i]),a=(0,r().VK)((()=>!!l&&(0,cn().NP)(l.id).length>0),[l]),s=(0,r().VK)((()=>{var e;return null===(e=un().default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit()}),[]);return i&&s&&l?(0,C.jsx)(C.Fragment,{children:a?(0,C.jsx)(Cn,{...e,collectionContextStore:o,collectionSettingsStore:t,integration:l,externalAuthentication:n}):(0,C.jsx)(Sn,{...e,collectionContextStore:o,collectionSettingsStore:t,integration:l})}):null}function xn(e){var t;return null===(t=e.integration.info)||void 0===t||null===(t=t.original_url_patterns)||void 0===t?void 0:t.filter((e=>{var t;return null===(t=e.additional_types)||void 0===t?void 0:t.collection})).find((t=>{let{regex:o}=t;return new RegExp(o).test(e.url)}))}const vn=(0,I().vU)({all:{id:"collectionSettingsCreateExternalViewPicker.filters.all",defaultMessage:"All"},issues:{id:"collectionSettingsCreateExternalViewPicker.filters.issues",defaultMessage:"Issues"},pull_requests:{id:"collectionSettingsCreateExternalViewPicker.filters.pullRequests",defaultMessage:"Pull Requests"},board:{id:"collectionSettingsCreateExternalViewPicker.filters.boards",defaultMessage:"Boards"},project:{id:"collectionSettingsCreateExternalViewPicker.filters.projects",defaultMessage:"Projects"},Releases:{id:"collectionSettingsCreateExternalViewPicker.filters.releases",defaultMessage:"Releases"},"Pull Request":{id:"collectionSettingsCreateExternalViewPicker.filters.PullRequests",defaultMessage:"Pull Requests"},Issues:{id:"collectionSettingsCreateExternalViewPicker.filters.Issues",defaultMessage:"Issues"}});function Cn(e){const{integration:t,collectionContextStore:o,collectionSettingsStore:l,externalAuthentication:a}=e,[c,d]=(0,n.useState)(""),u=(0,r().VK)((()=>{const e=so().default.state;return e.loaded?e.externalAuthentications.filter((e=>e.integration_id===t.id)):[]}),[t]),p=(0,r().VK)((()=>a||(u.length?u[0]:null)),[u,a]),[g,m]=(0,n.useState)(!1),[y,h]=(0,n.useState)(null),x=(0,f().yK)((e=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px"},settingsMenuSearchBox:{background:e.contentBackground,marginBottom:10},syncSourceButton:{width:"100%",display:"flex",justifyContent:"center"},noResults:{width:"100%",paddingBottom:10,display:"flex",justifyContent:"center",fontSize:14,color:e.mediumTextColor},suggestionBox:{display:"flex",alignItems:"center",fontSize:12,color:tn().ZP.white,background:tn().ZP.blue,borderRadius:6,padding:10,boxShadow:e.shadowMD,alignSelf:"center",maxWidth:"80%"},errorMessage:{alignSelf:"center",padding:10,fontSize:14,color:e.errorText},syncingData:{width:"100%",paddingBottom:10,display:"flex",justifyContent:"center",fontSize:14,color:e.mediumTextColor},filterContainer:{position:"relative",flexGrow:0,overflow:"hidden"},filterContainerScroller:{display:"flex",alignItems:"center",padding:"8px 12px"}})),[]),v=(0,r().VK)((()=>o.collectionStore()),[o]),b=(0,r().VK)((()=>o.collectionViewBlockStore()),[o]),w=(0,i().O7)(),[{value:j,status:_}]=(0,S().r5)((async()=>{if(!p)return;const e=p.parent_id;return ie().callApi({eventName:"listExternalCollections",environment:w,data:{bot_id:e}})}),[w,p]),M="success"===(null==j?void 0:j.type)&&"data"in j.data?j.data.data:[],k="success"===(null==j?void 0:j.type)&&"error"in j.data?j.data.error:null,P=M.filter((e=>!y||e.type===y)),T=P.length?(0,yo().ZP)(c,P,(e=>e.title)):[],V=Array.from(new Set(M.map((e=>e.type)))),Z=xn({integration:t,url:c}),F=async e=>{if(m(!0),!v||!b)return;const n=e||c,i=xn({integration:t,url:n});if(!i)return m(!1),void A().vC({items:[{label:(0,C.jsx)(I()._H,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.copyDebuggingInformation",defaultMessage:"Copy debugging information"}),color:"blue",onAccept:async()=>{const e=await rn().F.clipboardActions.load();e.copyString({environment:w,stringValue:JSON.stringify({botId:null==p?void 0:p.parent_id,url:n},null,2),copiedMessage:e.clipboardMessages.copiedToClipboard})}},{label:(0,C.jsx)(I()._H,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.closeButton",defaultMessage:"Close"}),onAccept:()=>{}}],showCancel:!1,keepFocus:!1,message:(0,C.jsx)(I()._H,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.title",defaultMessage:"This source is currently not supported. Please try a different source."})});const r=(0,cn().NP)(t.id);await ln().UY({environment:w,url:n,botIds:r.map((e=>e.id)),externalCollectionStore:v,externalCollectionViewBlockStore:b});const{host:a}=(0,on().Qc)(n);nn().Mp(w,{...(0,dn().Pn)(o),integrationId:t.id,type:"collection",entity:i.name,domain:a||"",from:"external_picker_settings"}),s().wl({collectionSettingsStore:l,item:{type:"shareSyncedView",integrationName:t.name,integrationIcon:t.info.icon}}),m(!1)};if(!v||!b)return null;const R=V.length>1?(0,C.jsx)("div",{style:x.filterContainer,children:(0,C.jsxs)(sn().T,{type:Ge().Z.X,style:x.filterContainerScroller,children:[(0,C.jsx)(an().Z,{title:(0,C.jsx)("span",{children:Co().Z.formatMessage(vn.all)}),on:!(0,N().K0)(y),hideChevron:!0,onClick:e=>{(0,We().ZP)({event:e,context:We().Af.CollectionSettingsClick,callback:()=>{h(null)}})}},"all"),V.map((e=>(0,C.jsx)(an().Z,{title:(0,C.jsx)("span",{children:Co().Z.formatMessage(vn[e])}),on:y===e,hideChevron:!0,onClick:t=>{(0,We().ZP)({event:t,context:We().Af.CollectionSettingsClick,callback:()=>{h((t=>t===e?null:e))}})}},e)))]})}):null,K=Z?(0,C.jsx)("div",{style:x.syncSourceButton,children:(0,C.jsx)(X().Z,{isLarge:!0,onClick:e=>{(0,We().ZP)({event:e,context:We().Af.CollectionSettingsClick,callback:()=>{F()}})},disabled:!1,children:(0,C.jsx)(I()._H,{id:"collectionSettingsCreateExternalViewPicker.syncSourceButton.label",defaultMessage:"Sync Source"})})}):null,H=Z||M.length&&T.length?null:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{style:x.noResults,children:(0,C.jsx)(I()._H,{id:"collectionSettingsCreateExternalViewPicker.noResults.text",defaultMessage:"No results"})}),(0,C.jsxs)("div",{style:x.suggestionBox,children:[(0,rt().D)({marginRight:8,width:14,height:14}),(0,C.jsx)(I()._H,{defaultMessage:"Try different search or paste any {integration} URL",id:"collectionSettingsCreateExternalViewPicker.noResults.help",values:{integration:t.name}})]})]}),O=M.length&&T.length?(0,C.jsx)(Q().ZP,{type:Q().iW.Vertical,initialFocus:0,sections:[{key:"collections",items:T.map((e=>{const t={key:e.url,render:t=>(0,C.jsx)(ro().Z,{renderTooltip:()=>(0,C.jsx)("span",{children:e.title}),placement:ao().Placement.Left,textWrap:!0,render:o=>(0,C.jsx)(q().Z,{...(0,lo().Z)(o||{},t),title:e.title,icon:(0,C.jsx)("img",{style:{width:18},src:e.icon}),caption:e.parent.title})}),action:t=>{"stopPropagation"in t.event&&t.event.stopPropagation(),F(e.url)}};return t})),render:e=>(0,C.jsx)(ee().Z,{...e,disableMobilePadding:!0})}]}):null,L="pending"===_||"idle"===_||g;if(!p||k&&(k.status===Xo().mQ.UNAUTHORIZED||k.status===Xo().mQ.FORBIDDEN))return(0,C.jsx)(Sn,{collectionContextStore:o,collectionSettingsStore:l,integration:t});const D="rejected"===_||"failed"===(null==j?void 0:j.type)||k,E=(0,C.jsx)(pn,{onClick:()=>{s().H4({collectionSettingsStore:l,item:{type:"selectAccountForExternalSource",integration:t,onAccountSelect:e=>{s().H4({collectionSettingsStore:l,item:{type:"createSyncedViewSource",externalAuthentication:e}})}}})},integration:t,accountName:p.account_name});return(0,C.jsx)(B().ZP,{...e,footer:K||g?null:E,title:(0,C.jsx)(I()._H,{defaultMessage:"Select from {integration}",id:"collectionSettingsCreateExternalViewPicker.title",values:{integration:t.name}}),header:!L&&"resolved"===_&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(xo().ZP,{inputLeft:(0,C.jsx)(xo().f_,{icon:en().R}),onSubmit:()=>{Z&&F()},style:x.settingsMenuSearchBox,focusInitial:!0,value:c,onChange:e=>{d(e.target.value)},placeholder:"Search source or paste a link..."}),Z?null:R]}),children:(0,C.jsxs)("div",{style:x.settingsMenu,children:[D&&(0,C.jsx)("div",{style:x.errorMessage,children:(0,C.jsx)(I()._H,{id:"collectionSettingsCreateExternalViewPicker.error.unknown",defaultMessage:"Something went wrong.",values:{integration:t.name}})}),L&&(g?(0,C.jsxs)("div",{style:x.syncingData,children:[(0,C.jsx)("span",{children:(0,C.jsx)(I()._H,{id:"collectionSettingsCreateExternalViewPicker.settingUpSync",defaultMessage:"Setting up sync..."})}),(0,C.jsx)(Mo().Z,{style:{alignSelf:"center"}})]}):(0,C.jsxs)("div",{style:x.syncingData,children:[(0,C.jsx)("span",{children:(0,C.jsx)(I()._H,{id:"collectionSettingsCreateExternalViewPicker.loadingData",defaultMessage:"Loading available sources..."})}),(0,C.jsx)(Mo().Z,{style:{alignSelf:"center"}})]})),!L&&"resolved"===_&&(0,C.jsxs)(C.Fragment,{children:[K,H,O]})]})})}var bn=()=>o(890085),wn=()=>o(757216),jn=()=>o(210900),_n=()=>o(716025),Mn=()=>o(26796),kn=()=>o(96868),Pn=()=>o(137727);const Tn=function(e){const{collectionContextStore:t,collectionSettingsStore:n}=e,l=(0,I().YB)(),a=(0,f().Fg)(),c=(0,i().O7)(),{device:u}=c,p=(0,r().VK)((()=>t.collectionViewStore()),[t]),g=(0,r().VK)((()=>null==p?void 0:p.isDefined()),[p]),m=(0,r().VK)((()=>null==p?void 0:p.getFormat().collection_view_icon),[p]),y=(0,r().VK)((()=>null==p?void 0:p.getType()),[p]),S=(0,r().VK)((()=>Mn().Z.state.isOpen),[]);return p&&g?(0,C.jsxs)(B().ZP,{...e,collectionSettingsStore:n,title:(0,C.jsx)(I()._H,{defaultMessage:"New view",id:"database.viewSettings.createViewTab.title"}),desktopWidth:S?280:290,children:[(0,C.jsx)(ee().Z,{isInput:!0,children:(0,C.jsx)(kn().I,{initialValue:"",placeholder:l.formatMessage(o(498922).L.viewNamePlaceholderMessage),focusInitial:!u.isMobile||void 0,onBlur:e=>In(e,c,t),iconButton:{icon:e=>(0,C.jsx)(_n().F,{color:"gray",viewIcon:m,viewType:y}),iconStyle:{fill:bn().Lr[a.mode].gray},enforceIconColor:"gray",onSubmit:e=>function(e,t,o){const n=t.collectionViewStore();if(!n||!n.isDefined())return;d().createAndCommit({userAction:"CollectionSettingsCreateView.handleViewIconSubmit",environment:e,canUndo:!0,perform:e=>{(0,jn().U)({collectionViewStore:n,icon:o,transaction:e})}}),Wt().wd({environment:e,collectionContextStore:t,action:"change_icon",icon:o})}(c,t,e)},onSubmit:e=>function(e,t,o,n){In(e,t,n),s().wl({collectionSettingsStore:o,item:{type:"main"}}),Wt().wd({environment:t,collectionContextStore:n,action:"rename"})}(e,c,n,t)})}),(0,C.jsx)(Pn().Z,{collectionContextStore:t,collectionSettingsStore:n,showDoneButton:!u.isMobile})]}):null};function In(e,t,o){const n=o.collectionViewStore();n&&n.isDefined()&&n.getName()!==e&&d().createAndCommit({userAction:"CollectionSettingsCreateView.handleViewNameBlur",environment:t,canUndo:!0,perform:t=>{(0,wn().i)({collectionViewStore:n,update:{name:e},transaction:t})}})}var Vn=()=>o(842631),An=()=>o(722920),Zn=()=>o(636340),Bn=()=>o(970105),Fn=()=>o(384525),Rn=()=>o(828458),Kn=()=>o(561933),Hn=()=>o(714966),On=()=>o(228772),Ln=()=>o(815277),Dn=()=>o(466970),En=()=>o(877727);function Nn(e){let{environment:t,collectionContextStore:o}=e;const n=(0,Dn().E)("workflow_container");return(0,r().VK)((()=>{var e,i;if(!(0,En().QZ)(t))return!1;if(Boolean((null===(e=o.collectionViewBlockStore())||void 0===e?void 0:e.isInlineCollectionView())&&"uninitialized"===o.getCollectionViewBlockSourceState()))return!1;return!Boolean("chart"===(null===(i=o.collectionViewStore())||void 0===i?void 0:i.getType()))&&("linked"!==o.getCollectionViewBlockSourceState()||n)}),[t,o,n])}var Un=()=>o(748360),zn=()=>o(820271),Wn=()=>o(790300),qn=()=>o(752778),Gn=()=>o(326966);function Yn(e){var t,o,n;const{collectionContextStore:i,collectionStore:r,transaction:l}=e,a=i.collectionViewStore();if(!a||!r.isDefined())return;const s=dt().Vv(r),c=null===(t=r.getFormat())||void 0===t?void 0:t.collection_default_arrows_by,d=i.collectionStore(),u=(null==d?void 0:d.pointer.id)!==r.pointer.id,p=r.getSchema();let g=a.getChartConfig();u&&"chart"===a.getType()&&g&&"placeholder"!==g.type&&(g=function(e){let{chartConfig:t,collectionSchema:o}=e;return(0,Wn().u)(t)?(0,zn().K0)({collectionSchema:o,axisChartType:t.type}):"donut"===t.type?(0,zn().dq)({collectionSchema:o}):(0,zn().K0)({collectionSchema:o,axisChartType:"column"})}({chartConfig:g,collectionSchema:p}));const m={table_properties:null==s||null===(o=s.getFormat())||void 0===o?void 0:o.table_properties,collection_pointer:{table:qn().vF,id:r.id,spaceId:r.getSpaceId()},chart_config:g,timeline_arrows_by:c?{property:c}:void 0,table_subitem_toggle_column:"title"},f=null==i?void 0:i.normalizedSchemaStore.state;Zn().sW({store:a,data:(0,Gn().Q2)({format:m,query2:{sort:null==s||null===(n=s.getQuery(f))||void 0===n?void 0:n.sort}}),transaction:l})}function $n(e){const{collectionContextStore:t,transaction:o,source:n}=e,i=t.collectionViewStore();if(i&&(c().FH({stores:[i],update:{collection_view_source:n},transaction:o}),"collection"===n.type)){const e=W().NW.createChildStore(i,{table:qn().vF,id:n.id,spaceId:n.spaceId});if(!e.isDefined())return;Yn({collectionContextStore:t,collectionStore:e,transaction:o})}}var Qn=()=>o(814866),Jn=()=>o(276124),Xn=()=>o(594134);function ei(e){const{collectionContextStore:t,environment:o,collectionStore:n,collectionSettingsStore:i,createdCollectionStore:r,userAction:l}=e;if(d().createAndCommit({userAction:l,environment:o,canUndo:!0,perform:e=>{var l;const a=t.collectionViewStore(),c=t.collectionViewBlockStore();if(!a||!c)return;$n({collectionContextStore:t,source:{type:"collection",id:n.id,spaceId:n.getSpaceId()},transaction:e}),r&&(0,Un().A)({collectionViewBlockStore:c,collectionStore:r,transaction:e}),t.isInHomeWidgetStore.state&&s().E3({collectionSettingsStore:i});const d=c.getBlockTitleStore(),u=null==c||null===(l=c.getTitleStore())||void 0===l?void 0:l.getValue();d&&u&&Bn().sO({environment:o,store:d,value:u,transaction:e}),(0,Jn().z)({collectionViewBlockStore:c,collectionPointer:n.pointer,transaction:e})}}),(0,Qn().Hi)(o))return void s().E3({collectionSettingsStore:i});const a=t.viewsModuleContextStore.isInLayoutBuilder();(0,Xn().V)({environment:o,collectionStore:n,collectionContextStore:t,collectionSettingsStore:i,shouldSkipViewSelection:a})}var ti=()=>o(821159),oi=()=>o(263184),ni=()=>o(632314),ii=()=>o(906769),ri=()=>o(454860),li=()=>o(692304),ai=()=>o(698357),si=()=>o(209980),ci=()=>o(392423);const di=(0,I().vU)({browse:{defaultMessage:"Browse",id:"database.collectionSettings.useBrowseCollections.browse"},createdByMe:{defaultMessage:"Created by me",id:"database.collectionSettings.useBrowseCollections.createdByMe"},recents:{defaultMessage:"Recents",id:"database.collectionSettings.useBrowseCollections.recents"},mentionedMe:{defaultMessage:"Mentioned me",id:"database.collectionSettings.useBrowseCollections.mentionedMe"}});function ui(e){const t=(0,i().O7)(),o=(0,Dn().E)("collections_system_db"),{isMobile:r}=t.device,l=(0,f().yK)((e=>({icon:{color:e.mediumIconColor,width:r?24:20,height:r?24:20}})),[r]),a=(0,n.useCallback)((o=>{const n=e.collectionViewStore();n&&d().createAndCommit({userAction:"CreateViewSourceMenuBody.allPagesOption",environment:t,canUndo:!0,perform:t=>{$n({collectionContextStore:e,source:{type:o,spaceId:n.getSpaceId()},transaction:t}),(0,ci().E)({collectionViewStore:n,update:{filter:void 0,sort:[],aggregations:void 0},transaction:t});const i=e.settingsStore;s().E3({collectionSettingsStore:i})}})}),[e,t]);return(0,n.useMemo)((()=>{if(!o)return;return{key:"browse",items:[{key:"created-by-me",render:e=>(0,C.jsx)(q().Z,{...e,title:Co().Z.formatMessage(di.createdByMe),icon:(0,si().K)(l.icon)}),action:()=>{a("createdByMe")}},{key:"recents",render:e=>(0,C.jsx)(q().Z,{...e,title:Co().Z.formatMessage(di.recents),icon:(0,ai().d)(l.icon)}),action:()=>{a("recents")}},{key:"mentioned-me",render:e=>(0,C.jsx)(q().Z,{...e,title:Co().Z.formatMessage(di.mentionedMe),icon:(0,ai().d)(l.icon)}),action:()=>{a("mentionsMe")}}],render:e=>(0,C.jsx)(ee().Z,{...e,title:Co().Z.formatMessage(di.browse),...e})}}),[l.icon,a,o])}var pi=()=>o(565630),gi=()=>o(641772),mi=()=>o(899133),fi=()=>o(513670),yi=()=>o(178498),Si=()=>o(231219),hi=()=>o(766463),xi=()=>o(828946),vi=()=>o(98228);function Ci(e){let{numShimmers:t=5}=e;const o=(0,f().yK)((e=>({container:{maxHeight:253},shimmerContainer:{height:45,margin:"0 14px 0px 18px",display:"flex",alignItems:"center"},circleContainer:{display:"flex",alignItems:"center",justifyContent:"center",marginRight:5,marginTop:5,alignSelf:"flex-start"},circle:{width:16,height:16,borderRadius:12,backgroundColor:e.lightDividerColor},sourceContainer:{flex:"1 1 auto",marginTop:6,marginLeft:8,alignSelf:"flex-start"},title:{height:9,width:"40%",borderRadius:8,backgroundColor:e.lightDividerColor},location:{marginTop:9,height:9,width:"60%",borderRadius:8,backgroundColor:e.lightDividerColor},showMoreContainer:{margin:"-2px 14px 0px 18px",display:"flex",alignItems:"center"},showMore:{marginTop:3,height:9,width:"40%",borderRadius:8,backgroundColor:e.lightDividerColor}})),[]),n=fi().DZ(t,(e=>(0,C.jsxs)("div",{style:o.shimmerContainer,children:[(0,C.jsx)("div",{style:o.circleContainer,children:(0,C.jsx)(vo().Z,{style:o.circle})}),(0,C.jsxs)("div",{style:o.sourceContainer,children:[(0,C.jsx)(vo().Z,{style:o.title}),(0,C.jsx)(vo().Z,{style:o.location})]})]},e))),i=(0,C.jsxs)("div",{style:o.showMoreContainer,children:[(0,C.jsx)("div",{style:o.circleContainer,children:(0,C.jsx)(vo().Z,{style:o.circle})}),(0,C.jsx)("div",{style:o.sourceContainer,children:(0,C.jsx)(vo().Z,{style:o.showMore})})]});return(0,C.jsxs)("div",{style:o.container,children:[n,i]})}const bi=5,wi=20,ji=20;function _i(e){const{input:t,handleAcceptExistingCollection:o,hideSearchTitle:l,collectionContextStore:a,collectionStore:s,parentStore:c,context:d,showSuggestions:u,searchResultsItemsLimit:p=wi,isSearchSurfacesHookEnabled:g=!1,showLoadMoreResultsButton:m=!1,requireEditPermissions:y=!1}=e,h=(0,i().O7)(),[x,v]=(0,n.useState)(bi),b=(0,n.useRef)(!1);(0,pi().D9)(t)!==t&&(b.current=!1),(0,n.useEffect)((()=>{g||(t.length>0&&x===bi?v(wi):0===t.length&&x===wi&&v(bi))}),[t.length,g,x]);const{results:w,isResultsLoading:j,searchSessionId:_,fetchAdditionalServerResultsOnChange:M,hasMoreResults:k,searchSessionFlowNumber:P}=(0,hi().s)({disable:!g||0===t.length&&!u,searchQuery:t,limit:t.length>0?p:bi,source:"collection_settings_source",type:mi().n8.CollectionsInSpace}),T=(0,n.useRef)(0),I=P+T.current,[V]=(0,S().r5)((async()=>{if(g)return;const e=await ki({query:t,limit:x},c,h,_,a,y);return T.current+=1,e}),[g,t,x,c,h,_,a,y],{debounce:vi().vp}),A=(0,f().yK)((e=>({showMoreButton:{color:e.mediumTextColor,fill:e.mediumIconColor}})),[]),Z=(0,r().VK)((()=>V&&"pending"===V.status||j),[j,V]),{resultsSectionItems:B,hasResults:F}=(0,r().VK)((()=>{if("rejected"===V.status)return{resultsSectionItems:[],hasResults:!1};const{results:e,showMore:n}=V.value??{results:[],showMore:0},i=g?w.map((e=>e.store.getCollectionViewSourceCollectionStore())):e.map((e=>bo().N.createChildStore(c,{table:qn().vF,id:e}))),r=(0,fi().oA)(i).filter((e=>{if(d===Ti.Source){const t=e.getParentBlockStore();return(null==t?void 0:t.id)!==c.id}return!y||e.canEditCollection()})),l=r.map(((e,n)=>({key:e.id,render:t=>{var o;return(0,C.jsx)(Si().Z,{...t,store:e,right:d===Ti.Relation&&((null==s?void 0:s.id)??(null==a||null===(o=a.collectionStore())||void 0===o?void 0:o.id))===e.id&&(0,C.jsx)(Mi,{})})},action:i=>{o(e),(0,mt().j)({environment:h,event:{eventName:"source_collection_search_item_click",eventProperties:{index:n,search_session_id:_,source:"source",using_secondary_search_surfaces_hook:g,query_length:t.length,reciprocal_rank:1/(n+1),search_session_flow_number:I,total_results:r.length}}})}})));if(Z&&l.push({key:"loading",render:e=>(0,C.jsx)("div",{style:{paddingTop:h.device.isMobile?10:0},children:(0,C.jsx)(Ci,{numShimmers:Math.min(p,5)})}),action:()=>{}}),!g&&n>0&&!Z){const e={key:"showMore",render:e=>(0,C.jsx)(q().Z,{...e,buttonStyle:A.showMoreButton,icon:(0,gi().o)({width:16,height:16}),title:Co().Z.formatMessage(Pi.showMore,{showMore:n})}),action:()=>v((e=>e+ji))};l.push(e)}else if(g&&(0===t.length||m)&&!Z&&!b.current&&k&&M){const e={key:"showMore",render:e=>(0,C.jsx)(q().Z,{...e,buttonStyle:A.showMoreButton,icon:(0,gi().o)({width:16,height:16}),title:Co().Z.formatMessage(Pi.showMoreWithoutCount)}),action:()=>{M(p),b.current=!0}};l.push(e)}return l.length>0?{resultsSectionItems:l,hasResults:!0}:{resultsSectionItems:[{key:"noResults",render:e=>(0,C.jsx)(yi().Z,{caption:Co().Z.formatMessage(Pi.noResults),style:{marginLeft:1},...e}),action:()=>{}}],hasResults:!1}}),[V.status,V.value,g,w,Z,t.length,m,k,M,c,d,y,s,a,o,h,_,I,p,A.showMoreButton]),R=(0,n.useMemo)((()=>({key:"results",items:B,render:e=>(0,C.jsx)(ee().Z,{title:!l&&Co().Z.formatMessage(Pi.existingDatabases),...e})})),[l,B]);return{resultsSection:R,fetchMoreResults:!Z&&M?M:void 0,searchSessionFlowNumber:I,searchSessionId:_,hasResults:F}}function Mi(){const e=(0,I().YB)();return(0,C.jsx)(ro().Z,{renderTooltip:()=>e.formatMessage(Pi.thisDatabase),render:e=>(0,C.jsx)("div",{...e,children:(0,rt().D)({width:14,height:14})})})}async function ki(e,t,o,n,i,r){const{query:l,limit:a}=e,{currentSpaceStore:s}=un().default.state,c=null==i?void 0:i.collectionViewBlockStore(),d=await xi().x.searchActions.load(),u=await d.searchCollectionsWithRecents({environment:o,collectionViewBlockStore:c,parentStore:t,spaceStore:s,query:l,limit:a,requireEditPermissions:r,searchSessionId:n});return{results:u.results,showMore:Math.max(0,u.total-u.results.length)}}const Pi=(0,I().vU)({showMore:{defaultMessage:"Show {showMore} more",id:"database.viewSettings.searchCollections.showMore.title"},noResults:{defaultMessage:"No results",id:"database.viewSettings.searchCollections.noResults.title"},existingDatabases:{defaultMessage:"Existing databases",id:"database.viewSettings.createViewTab.existingDatabases"},showMoreWithoutCount:{defaultMessage:"Show more",id:"database.viewSettings.searchCollections.showMore.titleWithoutCount"},thisDatabase:{defaultMessage:"This database",id:"database.viewSettings.searchCollections.thisDatabase.tooltip"}});let Ti=function(e){return e[e.Source=0]="Source",e[e.Relation=1]="Relation",e[e.Automation=2]="Automation",e}({});const Ii=(0,I().vU)({linkedInputPlaceholder:{defaultMessage:"Link to a database…",id:"database.viewSettings.searchCollections.linkedInputPlaceholder"},linkedOrSourceInputPlaceholder:{defaultMessage:"Link or create a database…",id:"database.viewSettings.searchCollections.linkedOrSourceInputPlaceholder"},automationInputPlaceholder:{id:"automations.databasePicker.automationInputPlaceholder",defaultMessage:"Select a database…"}}),Vi=oi().default.createClass("",{name:"InputStore"});function Ai(e){let{collectionContextStore:t,context:o,parentStore:l,onAccept:a,inputStore:s,requireEditPermissions:c,collectionStore:d}=e;const u=(0,i().O7)(),p=(0,r().qz)(s,Vi),g=(0,r().qz)(void 0,li().Z),m=(0,n.useRef)(0),f=(0,r().Kw)(p),{resultsSection:y,fetchMoreResults:S,searchSessionId:h,searchSessionFlowNumber:x}=_i({input:f,handleAcceptExistingCollection:a,collectionContextStore:t,parentStore:l,context:o,showSuggestions:!0,requireEditPermissions:c,collectionStore:d}),v=ui(t);(0,n.useEffect)((()=>{m.current=x}),[x]);const b=(0,r().VK)((()=>"on"===$e().default.getEligibleGroup({experimentId:"search_surfaces_collection_search",defaultGroup:"unassigned"})),[]);(0,n.useEffect)((()=>((0,mt().j)({environment:u,event:{eventName:"source_collection_search_open",eventProperties:{search_session_id:h,using_secondary_search_surfaces_hook:b,source:"relation"}}}),()=>{(0,mt().j)({environment:u,event:{eventName:"source_collection_search_close",eventProperties:{search_session_id:h,source:"relation",using_secondary_search_surfaces_hook:b,search_session_flow_number:m.current}}})})),[u,b,h]);const w="linked"===(0,r().VK)((()=>null==t?void 0:t.getCollectionViewBlockSourceState()),[t])||o===Ti.Relation?Ii.linkedInputPlaceholder:o===Ti.Source?Ii.linkedOrSourceInputPlaceholder:Ii.automationInputPlaceholder;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(ee().Z,{isInput:!0,children:(0,C.jsx)(xo().ZP,{focusInitial:!u.device.isMobile||void 0,value:f,onChange:e=>{p.setState(e.target.value),g.setState({focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})},placeholder:Co().Z.formatMessage(w),showClearButton:!0})}),(0,C.jsx)(Q().ZP,{type:Q().iW.Vertical,initialFocus:0,sections:[y,v].filter(N().$K),store:g}),b?(0,C.jsx)(ii().Z,{onChange:(e,t)=>{S&&e<ri().Z.incrementScrollOffset&&S()}}):null]})}const Zi=n.memo(Ai,ni().Z);var Bi=()=>o(780741),Fi=()=>o(214993),Ri=()=>o(602299),Ki=()=>o(641506),Hi=()=>o(737128),Oi=()=>o(661641);function Li(e){let{icon:t,style:o}=e;return t({...(0,f().yK)((e=>({icon:{fill:e.regularIconColor,width:18,height:18}})),[]).icon,...o})}function Di(e){let{buttonMenuItemProps:t,iconStyle:o,hideButton:n,menuItemStyle:i}=e;const r=(0,f().yK)((e=>({buttonMenuItem:{display:n?"none":"flex",...i},icon:{fill:e.mediumIconColor,...o}})),[n,i,o]);return(0,C.jsx)(q().Z,{style:r.buttonMenuItem,...t,title:(0,C.jsx)(Oi().q,{styleName:"Body-14px/Regular",colorName:"secondary",children:(0,C.jsx)(I()._H,{id:"addWorkflowTemplateMenu.moreTemplates",defaultMessage:"More templates"})}),icon:(0,C.jsx)(Li,{icon:gi().o,style:r.icon})})}var Ei=()=>o(499819),Ni=()=>o(281236),Ui=()=>o(97162);var zi=()=>o(113212),Wi=()=>o(938938),qi=()=>o(413894),Gi=()=>o(533808);const Yi=(0,I().vU)({suggested:{defaultMessage:"Suggested",id:"database.viewSettings.createViewTab.suggested"},link:{defaultMessage:"Link...",id:"database.viewSettings.searchCollections.link"},search:{defaultMessage:"Search...",id:"database.viewSettings.searchCollections.search"},linkOrCreate:{defaultMessage:"Link or create...",id:"database.viewSettings.searchCollections.linkedOrCreate"},addOrLinkDatabase:{defaultMessage:"Add or link database...",id:"database.viewSettings.searchCollections.addOrLinkDatabase"},setupWithAI:{defaultMessage:"Build with AI",id:"database.viewSettings.searchCollections.setupWithAI"}}),$i=14,Qi=32;function Ji(e){let{collectionContextStore:t,collectionSettingsStore:o,parentStore:a,existingCollectionStore:c,createdCollectionRecordPointerMap:d,input:u,setInput:p,newButtonMenuItem:g,context:m,handleAcceptExistingCollection:y,hideSearchTitle:S,onCollectionPicked:h}=e;const x=(0,i().O7)(),v=(0,r().qz)(void 0,li().Z),b=(0,n.useMemo)((()=>u.length>0),[u]),{resultsSection:w,searchSessionId:j,searchSessionFlowNumber:_,hasResults:M}=_i({showSuggestions:!1,input:u,collectionContextStore:t,hideSearchTitle:S,parentStore:a,context:m,handleAcceptExistingCollection:y,searchResultsItemsLimit:3,showLoadMoreResultsButton:!0,isSearchSurfacesHookEnabled:!0}),k=(0,n.useRef)(0);(0,n.useEffect)((()=>{k.current=_}),[_]),(0,n.useEffect)((()=>((0,mt().j)({environment:x,event:{eventName:"source_collection_search_open",eventProperties:{search_session_id:j,using_secondary_search_surfaces_hook:!0,source:"source"}}}),()=>{(0,mt().j)({environment:x,event:{eventName:"source_collection_search_close",eventProperties:{search_session_id:j,source:"source",using_secondary_search_surfaces_hook:!0,search_session_flow_number:k.current}}})})),[x,j]);const P=(0,f().yK)((e=>({newTableWrapperStyle:{...b&&{position:"sticky",bottom:0,backgroundColor:e.popoverBackground}}})),[b]),T=(0,r().VK)((()=>or(a)),[a]),V=(0,n.useCallback)((e=>{var o;let{template:n,collectionViewBlockStore:i,collectionViewBlockParentStore:r,flowId:l,aiPrompt:a}=e;null!==(o=n.value.onboarding)&&void 0!==o&&o.isMinimal?(0,Wi().createMinimalCollectionTemplateWithoutModal)({environment:x,template:n,parentStore:r,existingCollectionInfo:{collectionViewBlockStore:i,collectionStore:t.collectionStore(),collectionViewStore:t.collectionViewStore()},relationInfos:[]}):(0,Wi().openSelectedTemplateOnboardingModalForInAppFlows)({environment:x,template:n,parentStore:r,existingCollectionInfo:{collectionViewBlockStore:i,collectionStore:t.collectionStore(),collectionViewStore:t.collectionViewStore()},origin:nr(t),navigateToOnFinish:"skip",flowId:l,aiPrompt:a,onClose:e=>(0,Hi().jw)({environment:x,userAction:"CreateViewSourceMenuBodyNew.onAcceptCollectionTemplate",result:e,existingCollectionViewBlockStore:i})})}),[x,t]),A=function(e){const{input:t,parentStore:o,onAcceptCollectionTemplate:a,collectionContextStore:s}=e,c=(0,i().O7)(),d=(0,f().Fg)(),[u]=(0,n.useState)((0,l().ZP)()),p=(0,f().yK)((()=>({icon:{marginLeft:6,marginRight:6},moreIcon:{width:$i,height:$i,margin:(Qi-$i)/2},caption:{fontSize:(0,Ki().yv)(c,"UIRegular"),whiteSpace:"normal"}})),[c]),g=(0,r().VK)((()=>or(o)),[o]),m=(0,Ui().l)({parentStore:g}),y=(0,yo().ZP)(t,m,(e=>e.value.targetCollection.name)),S=y.slice(0,Ni().TRUNCATE_COLLECTION_TEMPLATE_ITEMS_AT),h=S.length<y.length,x=(0,n.useMemo)((()=>g?S.map(((e,t)=>er({collectionTemplate:e,theme:d,styles:p,hideCaption:!0,onAcceptCollectionTemplate:o=>{a(o),(0,zi().kR)({environment:c,eventProperties:{from_modal_template_picker:!1,selected_index:t,collection_template_ids_shown:S.map((e=>e.templateId)),...(0,Gi().px)({origin:nr(s),parentStore:g,collectionTemplate:e,flowId:u,collectionTemplatesSearchQuery:void 0})}})},parentStore:o,collectionTemplateParentStore:g,aiPrompt:void 0}))):[]),[g,a,o,d,p,S,c,u,s]),v=(0,n.useMemo)((()=>{const e={key:"see_more_workflow_templates",render:e=>(0,C.jsx)(Di,{buttonMenuItemProps:e,iconStyle:p.moreIcon,menuItemStyle:(0,ti().s)({environment:c})}),action:()=>function(e){let{environment:t,parentStore:o,collectionContextStore:n}=e;const i=o.getParentStore(),r=n.collectionViewBlockStore(),l=n.collectionStore(),a=n.collectionViewStore();if(!(i&&r&&l&&a&&i.table!==Ri().x_&&(0,Ni().isCollectionTemplateParentStore)(i)))return;(0,Wi().openTemplateOnboardingModal)({parentStore:i,template:void 0,version:(0,Wi().getTemplateOnboardingVersion)({template:void 0}),origin:nr(n),existingCollectionInfo:{collectionStore:l,collectionViewStore:a,collectionViewBlockStore:r},navigateToOnFinish:"skip",onClose:e=>(0,Hi().jw)({environment:t,userAction:"CreateViewSourceMenuBodyNew.handleClickMoreButton",result:e,existingCollectionViewBlockStore:r})})}({parentStore:o,collectionContextStore:s,environment:c})};return{key:"suggestedCollectionTemplates",items:[...x,...h?[e]:[]],render:e=>(0,C.jsx)(ee().Z,{title:Co().Z.formatMessage(Yi.suggested),...e})}}),[x,h,p.moreIcon,c,o,s]),b=(0,r().VK)((()=>nr(s)),[s]);return function(e){let{collectionTemplateIds:t,origin:o,flowId:r,blockId:l}=e;const a=(0,i().O7)(),s=(0,n.useRef)(!1);(0,n.useEffect)((()=>{s.current||((0,mt().j)({environment:a,event:{eventName:"suggested_collection_templates_shown",eventProperties:{origin:o,collection_template_ids_shown:t,block_id:l,flow_id:r}}}),s.current=!0)}))}({collectionTemplateIds:S.map((e=>e.templateId)),origin:b,blockId:o.id,flowId:u}),0===x.length?void 0:v}({input:u,onAcceptCollectionTemplate:V,parentStore:a,collectionContextStore:t}),Z=function(e){const{newButtonMenuItem:t,collectionTemplateParentStore:o,onAcceptCollectionTemplate:n,parentStore:i,showTopBorder:l,hideCaption:a,searchInput:s}=e,c=(0,I().YB)(),d=(0,f().Fg)(),u=(0,f().yK)((()=>({...e.styles,icon:{...e.styles.icon,width:20,height:20}})),[e.styles]);return(0,r().VK)((()=>{if(!t)return;const e=[t];if((0,Ni().getIsSetupGeneratorEnabled)()&&o){const t=Ni().globalWorkflowTemplates.fromIdOfType({type:"collection",templateId:Bi()._q});e.push(er({collectionTemplate:t,theme:d,styles:u,onAcceptCollectionTemplate:n,parentStore:i,collectionTemplateParentStore:o,nameOverride:c.formatMessage(Yi.setupWithAI),hideIconBackground:!0,hideCaption:a,aiPrompt:(0,D().TPx)(s)}))}return{key:"newButton",render:e=>(0,C.jsx)(ee().Z,{...e,topBorder:l,style:u.newTableWrapperStyle}),items:e}}),[t,o,d,u,n,i,c,a,s,l])}({newButtonMenuItem:g,collectionTemplateParentStore:T,onAcceptCollectionTemplate:V,parentStore:a,showTopBorder:b&&(Boolean(A)||M),styles:P,hideCaption:!0,searchInput:u}),B=b?void 0:function(e){let{existingCollectionStore:t,collectionSettingsStore:o,createdCollectionRecordPointerMap:n,onCollectionPicked:i}=e;const r={key:"link_database",render:e=>(0,C.jsx)(tr,{buttonMenuItemProps:e}),action:()=>{s().FK({collectionSettingsStore:o,item:{type:"createViewSource",existingCollectionStore:t,createdCollectionRecordPointerMap:n}}),s().H4({collectionSettingsStore:o,item:{type:"linkToDatabase",existingCollectionStore:t,onCollectionPicked:i}})}};return{key:"more_settings",render:e=>(0,C.jsx)(ee().Z,{topBorder:!0,...e}),items:[r]}}({existingCollectionStore:c,collectionSettingsStore:o,createdCollectionRecordPointerMap:d,onCollectionPicked:h}),F=(0,r().VK)((()=>void 0!==g?Yi.addOrLinkDatabase:null!=t&&t.isInHomeWidgetStore.state?Yi.search:Yi.link),[t,g]),R=(0,n.useMemo)((()=>({key:"input",render:e=>(0,C.jsx)(ee().Z,{shouldShowBottomDivider:!1,...e}),items:[{key:"input",action:()=>{},render:e=>(0,C.jsx)(xo().ZP,{...e,value:u,onChange:e=>{p(e.target.value),v.setState({focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})},focusInitial:!0,placeholder:Co().Z.formatMessage(F),showClearButton:!0})}]})),[u,v,F,p]),K=(0,n.useMemo)((()=>(0,fi().oA)(b?[R,M?w:void 0,A,Z,B]:[R,Z,A,B])),[b,R,M,w,A,Z,B]);return(0,C.jsx)(Q().ZP,{type:Q().iW.Vertical,initialFocus:void 0,resetFocusOnMouseOut:!0,sections:K})}function Xi(e){let{collectionContextStore:t,context:o,parentStore:l,handleAcceptExistingCollection:a,input:s,setInput:c,newButtonMenuItem:d,hideSearchTitle:u}=e;const p=(0,i().O7)(),g=(0,r().qz)(void 0,li().Z),m=(0,n.useRef)(0),{resultsSection:y,searchSessionId:S,searchSessionFlowNumber:h}=_i({showSuggestions:!0,input:s,collectionContextStore:t,hideSearchTitle:u,parentStore:l,context:o,handleAcceptExistingCollection:a,isSearchSurfacesHookEnabled:!1}),x=ui(t);(0,n.useEffect)((()=>{m.current=h}),[h]);const v=(0,r().VK)((()=>"on"===$e().default.getEligibleGroup({experimentId:"search_surfaces_collection_search",defaultGroup:"unassigned"})),[]);(0,n.useEffect)((()=>((0,mt().j)({environment:p,event:{eventName:"source_collection_search_open",eventProperties:{search_session_id:S,using_secondary_search_surfaces_hook:v,source:"source"}}}),()=>{(0,mt().j)({environment:p,event:{eventName:"source_collection_search_close",eventProperties:{search_session_id:S,source:"source",using_secondary_search_surfaces_hook:v,search_session_flow_number:m.current}}})})),[p,v,S]);const b=(0,n.useMemo)((()=>s.length>0),[s]),w=(0,r().VK)((()=>b&&v),[b,v]),j=(0,f().yK)((e=>({newTableWrapperStyle:{...w&&{position:"sticky",bottom:0,backgroundColor:e.popoverBackground}}})),[w]),_=(0,n.useMemo)((()=>{if(d)return{key:"newButton",render:e=>(0,C.jsx)(ee().Z,{...e,topBorder:b,style:j.newTableWrapperStyle}),items:[d]}}),[d,b,j.newTableWrapperStyle]),M=(0,n.useMemo)((()=>(0,fi().oA)([s?void 0:_,y,...x?[x]:[],s?_:void 0])),[s,_,y,x]),k=(0,r().VK)((()=>void 0!==d?Yi.linkOrCreate:null!=t&&t.isInHomeWidgetStore.state?Yi.search:Yi.link),[t,d]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(ee().Z,{shouldShowBottomDivider:!1,children:(0,C.jsx)(xo().ZP,{value:s,onChange:e=>{c(e.target.value),g.setState({focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})},focusInitial:!0,placeholder:Co().Z.formatMessage(k),showClearButton:!0})}),(0,C.jsx)(Q().ZP,{type:Q().iW.Vertical,initialFocus:void 0,sections:M})]})}function er(e){const{collectionTemplate:t,theme:o,styles:n,onAcceptCollectionTemplate:i,parentStore:r,collectionTemplateParentStore:l,hideIconBackground:a,nameOverride:s,hideCaption:c,aiPrompt:d}=e,{templateId:u,description:p}=t,{name:g}=t.value.targetCollection,m=(0,qi().A)(t.value.targetCollection.icon,o),f=(0,C.jsx)(Ei().l,{template:t,size:$i,iconStyle:n.icon});return{key:u,render:e=>(0,C.jsx)(Je().cB,{placement:ao().Placement.Left,collectionTemplate:t,render:t=>(0,C.jsx)(ti().Y,{buttonMenuItemProps:{...(0,lo().Z)(e,t),alignIconTop:!0},title:s??g,caption:c?void 0:(0,C.jsx)("div",{style:n.caption,children:p}),icon:(0,C.jsx)(Rn().I,{backgroundSize:Qi,icon:f,backgroundColor:a?"#00000000":m.fill.secondary})})}),action:()=>{i({template:t,collectionViewBlockStore:r,collectionViewBlockParentStore:l,flowId:void 0,aiPrompt:d})}}}function tr(e){let{buttonMenuItemProps:t}=e;const o=(0,f().yK)((e=>({iconWrapper:{width:Qi},linkDatabaseIcon:{fill:e.mediumTextColor,height:16,width:16,margin:"auto",transform:"rotate(45deg)"}})),[]);return(0,C.jsx)(ti().Y,{buttonMenuItemProps:t,title:(0,C.jsx)(I()._H,{id:"createViewSourceMenuBody.linkDatabase",defaultMessage:"Link to existing database"}),icon:(0,C.jsx)("div",{style:o.iconWrapper,children:(0,Fi().Z)(o.linkDatabaseIcon)})})}function or(e){const t=e.getParentStore();if(t&&(0,Ni().isCollectionTemplateParentStore)(t))return t}function nr(e){return e.isFullScreenStore.state?"collection_settings_create_view_source":"collection_settings_create_view_source_inline"}function ir(e){const t=(0,i().O7)(),{collectionContextStore:o}=e;return Nn({environment:t,collectionContextStore:o})?(0,C.jsx)(rr,{...e}):(0,C.jsx)(lr,{...e})}function rr(e){const{collectionSettingsStore:t,collectionContextStore:o,existingCollectionStore:l,onCollectionPicked:a}=e,c=(0,i().O7)(),d=(0,On().r)(),u=c.currentUser.id,p=null==d?void 0:d.id,[g,m,f,y]=(0,r().VK)((()=>[o.collectionViewBlockStore(),o.collectionViewStore(),o.collectionStore(),o.getCollectionViewBlockSourceState()]),[o]),[S,h]=(0,n.useState)(void 0),[x,v]=(0,n.useState)(void 0),[[b,w],j]=(0,n.useState)([l,void 0]),_=(0,n.useCallback)((e=>{j(e),s().FK({collectionSettingsStore:t,item:{type:"createViewSource",existingCollectionStore:e[0],createdCollectionRecordPointerMap:e[1]}})}),[t]),[M,k]=(0,n.useState)(""),P=(0,r().VK)((()=>f&&o.hasSingleCollection()),[o,f]),T=(0,Ln().VX)({name:"view_chart",spaceId:p,userId:u,amount:"unknown"}),[I,V]=(0,n.useState)("boot");(0,n.useEffect)((()=>{if("boot"===I&&m){var e,n,i;const l=null==m?void 0:m.id,a=l?null===(e=(0,Hn().x)(l))||void 0===e?void 0:e.viewType:void 0,d=a||(null==m?void 0:m.getType());h(a??(null==m?void 0:m.getType()));const u=null===(n=o.collectionViewBlockStore())||void 0===n?void 0:n.getTitleValue();var r;if(null!=u&&null!==(i=u[0])&&void 0!==i&&null!==(i=i[0])&&void 0!==i&&i.length)v(null===(r=o.collectionViewBlockStore())||void 0===r?void 0:r.getTitleValue());"chart"===d&&An().Q({environment:c,collectionContextStore:o,collectionViewId:l,from:"slash_menu"}).then((e=>{if("success"===(null==e?void 0:e.type)){const n=e.data.can_view_chart;T||n||"source"!==o.getCollectionViewBlockSourceState()||s().E3({collectionSettingsStore:t})}})),V("initializing")}}),[T,o,t,m,c,I]);const A=(0,n.useCallback)((async e=>{const t=o.collectionViewStore(),n=o.collectionViewBlockStore();if(!t||!n)return;let i;x?i=x:null!=e&&e.length&&(i=(0,D().TPx)(e)),await cr({environment:c,baseViewType:S,collectionName:i,collectionContextStore:o,collectionViewBlockStore:n,collectionViewStore:t,createdCollectionRecordPointerMap:w,setCreatedCollection:_}),b&&(null==a||a(b))}),[o,x,c,S,w,_,a,b]);(0,n.useEffect)((()=>{if("initializing"===I){if(l)return _([l,w]),void V("initialized");const e=(null==g?void 0:g.getCollectionViewStores().length)||0;"source"===y?V("initialized_source"):"linked"===y&&e>1||o.isEditableHomeCollectionStore.state?V("initialized_linked"):(A(),V("initialized"))}}),[S,o,g,A,l,w,P,I,y,_]);const Z=ar({phase:I,baseViewType:S,createNewCollection:A,input:M,originalTitle:x}),F=(0,r().VK)((()=>t.state.hideSettingsHeader),[t]),R=(0,n.useCallback)((e=>{ei({collectionContextStore:o,environment:c,collectionStore:e,collectionSettingsStore:t,createdCollectionStore:b,userAction:"CollectionSettingsCreateViewSource.handleSourcePickerAccept"}),null==a||a(e)}),[o,t,b,c,a]);return(0,C.jsx)(B().ZP,{...e,title:Co().Z.formatMessage(sr.newDatabase),handleClose:()=>{s().E3({collectionSettingsStore:t})},children:g&&(0,C.jsx)(Ji,{collectionContextStore:o,collectionSettingsStore:t,parentStore:g,existingCollectionStore:b,createdCollectionRecordPointerMap:w,input:M,setInput:k,newButtonMenuItem:Z,handleAcceptExistingCollection:R,context:Ti.Source,hideSearchTitle:F,onCollectionPicked:a})})}function lr(e){const{collectionSettingsStore:t,collectionContextStore:o,existingCollectionStore:l,onCollectionPicked:a}=e,c=(0,i().O7)(),d=(0,On().r)(),u=c.currentUser.id,p=null==d?void 0:d.id,[g,m,f,y]=(0,r().VK)((()=>[o.collectionViewBlockStore(),o.collectionViewStore(),o.collectionStore(),o.getCollectionViewBlockSourceState()]),[o]),[S,h]=(0,n.useState)(void 0),[x,v]=(0,n.useState)(void 0),[[b,w],j]=(0,n.useState)([l,void 0]),_=(0,n.useCallback)((e=>{j(e),s().FK({collectionSettingsStore:t,item:{type:"createViewSource",existingCollectionStore:e[0],createdCollectionRecordPointerMap:e[1]}})}),[t]),[M,k]=(0,n.useState)(""),P=(0,r().VK)((()=>f&&o.hasSingleCollection()),[o,f]),T=(0,Ln().VX)({name:"view_chart",spaceId:p,userId:u,amount:"unknown"}),[I,V]=(0,n.useState)("boot");(0,n.useEffect)((()=>{if("boot"===I&&m){var e,n,i;const l=null==m?void 0:m.id,a=l?null===(e=(0,Hn().x)(l))||void 0===e?void 0:e.viewType:void 0,d=a||(null==m?void 0:m.getType());h(a??(null==m?void 0:m.getType()));const u=null===(n=o.collectionViewBlockStore())||void 0===n?void 0:n.getTitleValue();var r;if(null!=u&&null!==(i=u[0])&&void 0!==i&&null!==(i=i[0])&&void 0!==i&&i.length)v(null===(r=o.collectionViewBlockStore())||void 0===r?void 0:r.getTitleValue());"chart"===d&&An().Q({environment:c,collectionContextStore:o,collectionViewId:l,from:"slash_menu"}).then((e=>{if("success"===(null==e?void 0:e.type)){const n=e.data.can_view_chart;T||n||"source"!==o.getCollectionViewBlockSourceState()||s().E3({collectionSettingsStore:t})}})),V("initializing")}}),[T,o,t,m,c,I]);const A=(0,n.useCallback)((async e=>{const t=o.collectionViewStore(),n=o.collectionViewBlockStore();if(!t||!n)return;let i;x?i=x:null!=e&&e.length&&(i=(0,D().TPx)(e)),await cr({environment:c,baseViewType:S,collectionName:i,collectionContextStore:o,collectionViewBlockStore:n,collectionViewStore:t,createdCollectionRecordPointerMap:w,setCreatedCollection:_}),b&&(null==a||a(b))}),[o,x,c,S,w,_,a,b]);(0,n.useEffect)((()=>{if("initializing"===I){if(l)return _([l,w]),void V("initialized");const e=(null==g?void 0:g.getCollectionViewStores().length)||0;"source"===y?V("initialized_source"):"linked"===y&&e>1||o.isEditableHomeCollectionStore.state?V("initialized_linked"):(A(),V("initialized"))}}),[S,o,g,A,w,l,P,I,_,y]);const Z=(0,n.useCallback)((e=>{ei({collectionContextStore:o,environment:c,collectionStore:e,collectionSettingsStore:t,createdCollectionStore:b,userAction:"CollectionSettingsCreateViewSource.handleSourcePickerAccept"}),null==a||a(e)}),[o,t,b,c,a]),F=ar({phase:I,baseViewType:S,createNewCollection:A,input:M,originalTitle:x}),R=(0,r().VK)((()=>t.state.hideSettingsHeader),[t]);return(0,C.jsx)(B().ZP,{...e,title:Co().Z.formatMessage(sr.newDatabase),handleClose:()=>{s().E3({collectionSettingsStore:t})},children:g&&(0,C.jsx)(Xi,{collectionContextStore:o,parentStore:g,handleAcceptExistingCollection:Z,context:Ti.Source,input:M,setInput:k,newButtonMenuItem:F,hideSearchTitle:R})})}function ar(e){let{phase:t,baseViewType:o,createNewCollection:l,input:a,originalTitle:c}=e;const u=(0,i().O7)(),p=(0,gt().Y$)(),g=p.settingsStore,m=Nn({environment:u,collectionContextStore:p}),[y,S]=(0,r().VK)((()=>[p.collectionViewBlockStore(),p.getCollectionViewBlockSourceState()]),[p]),h=(0,n.useMemo)((()=>o?Kn().Bh[o].toLocaleLowerCase():Co().Z.formatMessage(sr.database).toString().toLocaleLowerCase()),[o]),x=(0,f().yK)((e=>({newItemIconStyle:{color:e.mediumIconColor,marginTop:2},newItemRightStyle:{alignItems:"top"},newDatabaseIconStyle:{fill:e.text.secondary,height:14,width:14}})),[]);return(0,r().VK)((()=>{if("initialized"===t||"initialized_source"===t)return{key:"newButton",render:e=>m?(0,C.jsx)(ti().Y,{buttonMenuItemProps:e,title:a.length>0?Co().Z.formatMessage(sr.newDatabaseWithName,{name:a}):Co().Z.formatMessage(sr.newEmptyDatabase),icon:(0,C.jsx)(Rn().I,{icon:(0,Vn().A)(x.newDatabaseIconStyle),backgroundSize:Qi})}):(0,C.jsx)(F().Z,{...e,icon:no().R,iconStyle:x.newItemIconStyle,rightStyle:x.newItemRightStyle,title:Co().Z.formatMessage(sr.newViewType,{viewType:h}),caption:Co().Z.formatMessage(sr.startBlankDatabase)}),action:()=>{var e;if("linked"===S)l(a);else if(a&&!c){const e=null==y?void 0:y.getTitleStore();e&&d().createAndCommit({userAction:"CollectionSettingsCreateViewSource.setTitleAfterNewInput",environment:u,canUndo:!0,perform:t=>{Bn().sO({environment:u,store:e,value:[[a]],transaction:t})}})}s().E3({collectionSettingsStore:g}),"collection_view_page"!==(null===(e=p.collectionViewBlockStore())||void 0===e?void 0:e.getType())||0!==a.length||c||ot().default.afterNextFlush((()=>{(0,Fn().W)({environment:u,collectionContextStore:p})}))}}}),[t,m,x,h,S,a,c,p,u,g,l,y])}const sr=(0,I().vU)({newViewType:{defaultMessage:"New {viewType}",id:"database.viewSettings.createView.newViewType"},newDatabase:{defaultMessage:"New database",id:"database.viewSettings.createViewTab.newDatabase"},newTable:{defaultMessage:"New table",id:"database.viewSettings.createViewTab.newTable"},newEmptyDatabase:{defaultMessage:"New empty database",id:"database.viewSettings.createViewTab.newEmptyDatabase"},newDatabaseWithName:{defaultMessage:"New “{name}” database",id:"database.viewSettings.createViewTab.newDatabaseWithName"},database:{defaultMessage:"Database",id:"database.viewSettings.createViewTab.view"},startBlankDatabase:{defaultMessage:"Start a blank database",id:"database.viewSettings.createViewTab.startBlankDatabase"}});async function cr(e){const{environment:t,collectionName:n,collectionContextStore:i,collectionViewBlockStore:r,collectionViewStore:l,baseViewType:a,createdCollectionRecordPointerMap:s,setCreatedCollection:c}=e,u=l,p=r;Wt().wd({environment:t,collectionContextStore:i,action:"select_new_collection"}),"chart"===a&&i.isCreatingNewChartCollectionStore.setState(!0);const{addCollectionViewSourceToNewCollection:g}=await o.e(15249).then(o.bind(o,901100));d().createAndCommit({userAction:"CollectionSettingsCreateViewSourceNew.handleCreateDB",environment:t,canUndo:!0,perform:e=>{Zn().sW({store:u,data:{name:a?Kn().Bh[a]:void 0,query2:void 0,type:a??"table",..."chart"!==a&&{format:void 0}},transaction:e});const o=g({environment:t,collectionViewStore:u,collectionViewBlockStore:p,name:n,transaction:e,targetCollectionRecordPointerMap:s}),r=p.getCollectionViewSourceCollectionStore();i.setContext({type:"collectionView",collectionViewBlockStore:p,collectionStore:r,collectionViewStore:u,pageVisitSourceOverride:void 0}),c([r,o])}})}var dr=o.n(o(443261)),ur=()=>o(148126),pr=()=>o(525898),gr=()=>o(576447);const mr=(0,I().vU)({searchPlaceholder:{defaultMessage:"Search for a property...",id:"database.viewSettings.databaseProperties.searchPlaceholder"}}),fr=oi().default.createClass("",{name:"InputStore"});function yr(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,l=(0,i().O7)(),a=(0,f().Fg)(),c=(0,r().Kw)(t.normalizedSchemaStore),d=(0,r().Kw)(t.permissionScopesStore),u=(0,r().qz)(void 0,fr),p=(0,r().Kw)(u),g=(0,n.useMemo)((()=>{const e=p.toLowerCase();return e?Object.entries(c).filter((t=>{let[o,n]=t;return!!n&&dr().test(e,n.name.toLowerCase())})):Object.entries(c)}),[c,p]),m=d.canConfigureCollection&&!d.isExternallyImportedAndSyncedCollection,y=(0,n.useCallback)((()=>{(0,pr().C)({environment:l,collectionContextStore:t})}),[l,t]),S=(0,n.useCallback)((e=>{s().H4({collectionSettingsStore:o,item:{type:"property",property:e,formatKey:void 0}})}),[o]),h=(0,f().yK)((e=>({title:{display:"flex",alignItems:"center"},propertiesContainer:{paddingTop:8,paddingBottom:8},propertyIcon:{fill:e.regularIconColor}})),[]);return(0,C.jsx)(B().ZP,{...e,title:(0,C.jsx)("div",{style:h.title,children:(0,C.jsx)(I()._H,{defaultMessage:"Properties",id:"database.viewSettings.databaseProperties.title"})}),header:(0,C.jsx)(ee().Z,{children:(0,C.jsx)(xo().ZP,{placeholder:Co().Z.formatMessage(mr.searchPlaceholder),value:p,onChange:e=>u.setState(e.target.value)})}),footer:(0,C.jsxs)(ee().Z,{topBorder:!0,children:[m&&(0,C.jsx)(F().Z,{icon:no().R,title:(0,C.jsx)(I()._H,{defaultMessage:"New property",id:"database.viewSettings.databaseProperties.newProperty"}),isGray:!0,onClick:y}),(0,C.jsx)(gr().Z,{href:(0,ur().UY)("guides.databaseProperties"),title:(0,C.jsx)(I()._H,{defaultMessage:"Learn about properties",id:"database.viewSettings.databaseProperties.learnMoreButton.title"}),analyticsFrom:"database_settings_properties"})]}),children:(0,C.jsx)("div",{style:h.propertiesContainer,children:g.map((e=>{let[t,o]=e;return o?(0,C.jsx)(F().Z,{icon:e=>(0,C.jsx)(mo().ZP,{type:o.type,icon:o.icon,size:16,style:{...e,...h.propertyIcon},theme:a}),title:o.name,onClick:()=>S(t),showChevron:!0},t):null}))})})}var Sr=()=>o(237874),hr=()=>o(12663),xr=()=>o(102182),vr=()=>o(367404),Cr=()=>o(796427);const br=(0,I().vU)({copySuccessMessage:{defaultMessage:"Link to database copied to clipboard",id:"database.viewSettings.databaseSettings.copyLinkSnackBarItem.title"},deleteButtonLabel:{defaultMessage:"Delete",id:"database.viewSettings.databaseSettings.deleteDatabaseButton.title"},detachButtonLabel:{defaultMessage:"Detach",id:"database.viewSettings.databaseSettings.detachDatabaseButton.title"},cancelButtonLabel:{defaultMessage:"Cancel",id:"database.viewSettings.databaseSettings.cancelButton.title"}});function wr(e){const t=(0,i().O7)(),o=(0,f().yK)((()=>({title:{display:"flex",alignItems:"center"}})),[]),n=(0,r().VK)((()=>{const t=e.collectionContextStore.collectionViewBlockStore();if(!t)return;const o=e.collectionContextStore.collectionStore();if(!o)return;const n=o.getSchemaStore().getValue(),i=t.getCollectionViewStores().filter((e=>{var t;return(null===(t=e.getCollectionStore())||void 0===t?void 0:t.id)===o.id})),r=o.getAutomationStores(),l=o.getParentId()===t.id;return{collectionViewBlockStore:t,collectionStore:o,schema:n,views:i,automations:r,isSourceDatabase:l}}),[e.collectionContextStore]),l=null==n?void 0:n.collectionViewBlockStore;if(!n)return null;const a=n.isSourceDatabase?(0,C.jsx)(I()._H,{defaultMessage:"Delete database",id:"database.viewSettings.databaseSettings.deleteDatabaseButton.confirm"}):(0,C.jsx)(I()._H,{defaultMessage:"Detach database",id:"database.viewSettings.databaseSettings.detachDatabaseButton.confirm"});return(0,C.jsxs)(B().ZP,{...e,title:(0,C.jsx)("div",{style:o.title,children:(0,C.jsx)(I()._H,{defaultMessage:"Database options",id:"database.viewSettings.databaseSettings.title"})}),children:[(0,C.jsxs)(ee().Z,{children:[(0,C.jsx)(F().Z,{icon:hr().N,showChevron:!0,title:(0,C.jsx)(I()._H,{defaultMessage:"Properties",id:"database.viewSettings.databaseSettings.properties"}),onClick:()=>{s().H4({collectionSettingsStore:e.collectionSettingsStore,item:{type:"databaseProperties"}})}}),(0,C.jsx)(Cr().aA,{collectionContextStore:e.collectionContextStore,collectionSettingsStore:e.collectionSettingsStore}),(0,C.jsx)(vr().Ar,{collectionContextStore:e.collectionContextStore,collectionSettingsStore:e.collectionSettingsStore}),(0,C.jsx)(Cr().Zj,{collectionContextStore:e.collectionContextStore,collectionSettingsStore:e.collectionSettingsStore})]}),(0,C.jsxs)(ee().Z,{topBorder:!0,children:[(0,C.jsx)(F().Z,{icon:Sr().N,title:(0,C.jsx)(I()._H,{defaultMessage:"Copy link to database",id:"database.viewSettings.databaseSettings.copyLinkButton.title"}),onClick:async()=>{const e=await rn().F.clipboardActions.load();await e.copyString({environment:t,stringValue:window.location.href,copiedMessage:e.clipboardMessages.copiedLinkToClipboard}),xr().oV({label:Co().Z.formatMessage(br.copySuccessMessage)})}}),(0,C.jsx)(F().Z,{icon:T().y,isRed:!0,title:a,onClick:async()=>{if(!n)return;const{collectionStore:e,collectionViewBlockStore:o,isSourceDatabase:i}=n,r=i?(0,C.jsx)(I()._H,{defaultMessage:"{databaseCount, plural, one {# database} other {# databases}}, {propertyCount, plural, one {# property} other {# properties}}, {viewCount, plural, one {# view} other {# views}}, {automationCount, plural, one {# automation} other {# automations}} will be deleted",id:"database.viewSettings.databaseSettings.deleteDatabaseButton.confirmDescription",values:{databaseCount:1,propertyCount:Object.keys(n.schema??{}).length,viewCount:n.views.length,automationCount:n.automations.length}}):(0,C.jsx)(I()._H,{defaultMessage:"{viewCount, plural, one {# view} other {# views}} will be deleted. The database will not be deleted.",id:"database.viewSettings.databaseSettings.detachDatabaseButton.confirmDescription",values:{viewCount:n.views.length}}),{accept:s}=await A().gt({message:a,description:r,acceptLabel:Co().Z.formatMessage(i?br.deleteButtonLabel:br.detachButtonLabel),cancelLabel:Co().Z.formatMessage(br.cancelButtonLabel),cancelButtonType:"plain",cancelColor:"gray"});s&&(d().createAndCommit({environment:t,userAction:"CollectionSettingsDatabaseSettings.handleDeleteDatabase",canUndo:!0,perform:t=>{(0,Un().A)({collectionViewBlockStore:o,collectionStore:e,transaction:t})}}),l&&(0,Qn().mS)({environment:t,store:l,navigationState:{route:{type:"configure"}}}))}})]})]})}var jr=()=>o(366825),_r=()=>o(494616),Mr=()=>o(285755),kr=()=>o(586806),Pr=()=>o(1910),Tr=()=>o(18748),Ir=()=>o(347577),Vr=()=>o(142730);const Ar=(0,I().vU)({delete:{defaultMessage:"Delete",id:"database.deletedProperties.delete"},undo:{defaultMessage:"Undo",id:"database.deletedProperties.undo"}});function Zr(e){let{collectionSettingsStore:t,collectionContextStore:l,timelineViewTab:a}=e;const c=(0,i().O7)(),u=(0,f().Fg)(),p=(0,r().Kw)(l.normalizedDeletedSchemaStore),g=(0,o(552245).Z)(),m=(0,n.useCallback)((e=>{g(e);const o=(0,Ir().jI)({timelineViewTab:a,collectionContextStore:l});s().z$({collectionSettingsStore:t}),s().H4({collectionSettingsStore:t,item:{type:"property",property:e,formatKey:o}})}),[l,t,g,a]),y=(0,n.useCallback)((()=>{const e=Object.entries(p).map((e=>{let[t,o]=e;if(o)return{propertyId:t,propertySchema:o}})).filter(N().$K);return 0===e.length?(0,C.jsx)(ee().Z,{children:(0,C.jsx)(Tr().ZP,{title:(0,C.jsx)(I()._H,{defaultMessage:"No results",id:"database.viewSettings.deletedPropertiesTab.noResults"})})}):(0,C.jsx)(ee().Z,{children:e.map((e=>{let{propertyId:t,propertySchema:o}=e;return(0,C.jsx)(Tr().ZP,{title:(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,C.jsx)(mo().ZP,{type:o.type,icon:o.icon,size:16,theme:u,style:{fill:u.regularIconColor}}),(0,C.jsx)("span",{style:{marginLeft:6,maxWidth:200,...V().Yu},children:o.name})]}),right:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Pr().Z,{icon:jr().s,iconStyle:{marginRight:2},ariaLabel:Co().Z.formatMessage(Ar.undo),onClick:()=>m(t)}),(0,C.jsx)(Pr().Z,{icon:T().y,ariaLabel:Co().Z.formatMessage(Ar.delete),onClick:()=>{!async function(e,t,o){const{automationActions:n}=await Mr().Sm.automations.load();A().vC({message:(0,C.jsx)(I()._H,{id:"database.viewSettings.deletedPropertiesTab.permanentlyDeleteProperty.modal.prompt",defaultMessage:"Are you sure you want to delete this property?"}),showCancel:!0,keepFocus:!0,items:[{label:(0,C.jsx)(I()._H,{id:"database.viewSettings.propertyTab.deleteProperty.modal.confirmButton",defaultMessage:"Delete"}),color:"red",onAccept:async()=>{const i=t.collectionStore();if(i){const t=i.getLayoutStore();await(null==t?void 0:t.load());const r=function(e,t){const o=e.getDeletedSchema(),n=o[t];if((0,N().$K)(n)&&(0,go().D1)(n)&&n.automation_id)return W().Mz.createChildStore(e,{id:n.automation_id,spaceId:e.getSpaceId(),table:_r().cv})}(i,e);d().createAndCommit({userAction:"CollectionSettingsDeletedProperties.handlePermanentlyDeleteDeletedPropertyClick",environment:o,canUndo:!0,perform:l=>{t&&(0,Vr().iQ)({environment:o,layoutStore:t,property:e,transaction:l}),(0,kr().$)({collectionStore:i,update:{[e]:null},transaction:l}),r&&n.deleteAutomation({automationStore:r,environment:o,transaction:l})}})}}}]})}(t,l,c)}})]})},t)}))})}),[l,p,c,m,u]);return(0,C.jsx)(B().ZP,{collectionSettingsStore:t,title:(0,C.jsx)(I()._H,{defaultMessage:"Deleted properties",id:"database.viewSettings.propertyTab.deletedTitle"}),children:y()})}const Br=n.memo(Zr,ni().Z);var Fr=()=>o(66077),Rr=()=>o(629013),Kr=()=>o(732811),Hr=()=>o(70186),Or=()=>o(272597),Lr=()=>o(900596);const Dr=(0,I().vU)({inputPlaceholder:{defaultMessage:"Search for a view…",id:"database.viewSettings.duplicateExistingViewTab.inputPlaceholder"}}),Er=7;function Nr(e){const{collectionSettingsStore:t,collectionName:o,inputValue:n,menuListItems:r,showMore:l,initialViewType:a,menuListStore:s,onNewEmptyViewClick:c,onBackArrowClick:d,onInputValueChange:u}=e,p=(0,i().O7)(),{device:g}=p,m=(0,f().yK)((e=>({plusIconStyle:{color:e.mediumIconColor}})),[]),y=a?Kn().Bh[a].toLocaleLowerCase():void 0,S=y?(0,C.jsx)(I()._H,{defaultMessage:"New {viewType} view",id:"database.viewSettings.createViewTab.newView1",values:{viewType:y}}):(0,C.jsx)(I()._H,{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView2"}),h={key:"emptyViewSection",items:[{key:"emptyViewMenuItem",render:e=>(0,C.jsx)(F().Z,{...e,icon:no().R,iconStyle:m.plusIconStyle,title:S}),action:c}],render:e=>(0,C.jsx)(ee().Z,{topBorder:n.length>0,...e})},x=(0,C.jsx)(I()._H,{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView"});return(0,C.jsxs)(B().ZP,{collectionSettingsStore:t,title:x,handleBackArrowClick:d,children:[(l>0||n)&&(0,C.jsx)(ee().Z,{children:(0,C.jsx)(xo().ZP,{focusInitial:!g.isMobile||void 0,value:n,onChange:e=>{u(e.target.value)},placeholder:Co().Z.formatMessage(Dr.inputPlaceholder),showClearButton:!0})}),(0,C.jsx)(Q().ZP,{type:Q().iW.Vertical,initialFocus:0,sections:fi().oA([n.length?void 0:h,{key:"results",render:e=>0===r.length?(0,C.jsx)(yi().Z,{caption:(0,C.jsx)(I()._H,{defaultMessage:"No results",id:"database.viewSettings.duplicateExistingViewTab.noResultsTitle"})}):(0,C.jsx)(ee().Z,{title:o?(0,C.jsx)(I()._H,{defaultMessage:"Views on {collectionName}",id:"database.viewSettings.duplicateExistingViewTab.viewsTitle",values:{collectionName:o}}):(0,C.jsx)(I()._H,{defaultMessage:"Existing views",id:"database.viewSettings.duplicateExistingViewTab.viewsTitleExistingViews"}),...e}),items:r},n.length?h:void 0]),store:s})]})}function Ur(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,l=(0,i().O7)(),a=(0,n.useMemo)((()=>new(Fr().Z)({name:"CollectionSettingsDuplicateExistingView"})),[]),c=(0,r().qz)(void 0,li().Z),[d,u]=(0,n.useState)(""),[p,g]=(0,n.useState)(!0),m=(0,n.useRef)({lastDuplicatedViewId:void 0,didAccept:!1,wentBack:!1,initialViewType:void 0,preselectedViewPointer:void 0}),y=(0,n.useCallback)(((e,o)=>{if(e.id===m.current.lastDuplicatedViewId&&o)return;m.current.lastDuplicatedViewId=e.id;const n=t.collectionViewStore();if(!n)return;let i=n;o&&(i=n.clone(a)),(0,Or().V)({viewToDuplicateStore:e,collectionContextStore:t,collectionViewStore:n,environment:l,temporaryStore:i})}),[t,l,a]);(0,Kr().K)((()=>{const e=t.collectionViewStore();if(!e)return;const o=(0,Hn().x)(e.id);m.current.preselectedViewPointer=null==o?void 0:o.viewPointer,l.defaultRecordCache.inMemoryRecordCache.addCacheOverride(a),m.current.initialViewType=e.getType()})),(0,Hr().L)((()=>{const e=m.current;if(l.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(a),!e.didAccept&&!e.wentBack){const{viewStores:o}=zr(t,d,p),n=o.find((t=>t.id===e.lastDuplicatedViewId));if(!n)return;y(n,!1)}}));const S=(0,n.useCallback)((e=>{e?y(e,!0):(m.current.lastDuplicatedViewId=void 0,a.clearCache())}),[y,a]),h=(0,Rr().y)(S,500);(0,r().VK)((()=>{const e=c.state,{device:o}=l;if(void 0===e.focus.indexLocal||o.isMobile)return;const n=d.length>0;if(!n&&0===e.focus.section||n&&1===e.focus.section)return void h(void 0);const i=zr(t,d,p).viewStores[e.focus.indexLocal];i&&h(i)}),[t,l,h,d,p,c]);const x=(0,n.useCallback)((e=>{l.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(a),Wt().wd({environment:l,collectionContextStore:t,action:"click_duplicate_view"}),y(e,!1),s().wl({collectionSettingsStore:o,item:{type:"main",selectViewNameInitial:!0}}),m.current.didAccept=!0}),[t,o,y,l,a]),v=(0,n.useCallback)((()=>{Wt().wd({environment:l,collectionContextStore:t,action:"click_new_empty_view"}),s().E3({collectionSettingsStore:o}),s().H4({collectionSettingsStore:o,item:{type:"createView"}}),m.current.didAccept=!0}),[t,o,l]),{viewStores:b,showMore:w}=(0,r().VK)((()=>zr(t,d,p)),[t,d,p]),j=(0,f().Fg)(),_=(0,r().VK)((()=>{var e;return function(e){const{theme:t,viewStores:o,showMore:n,preselectedViewPointerId:i,onDuplicateViewAccept:r,onShowMore:l}=e,a=fi().oA(o.map((e=>{const t=e.getType(),o=e.getFormat().collection_view_icon;if(!t||"page"===t)return;const n=e.getName(),l=e.id,a={key:l,render:e=>(0,C.jsx)(q().Z,{...e,title:(0,C.jsx)(Lr().Z,{collectionViewType:t,collectionViewName:n}),icon:(0,C.jsx)(_n().F,{color:"regular",viewIcon:o,viewType:t,style:{marginRight:4,marginLeft:2}}),checkState:i===l}),action:()=>{r(e)}};return a})));if(n>0){const e={key:"showMore",render:e=>(0,C.jsx)(q().Z,{...e,icon:(0,gi().o)({width:16,height:16,color:t.mediumTextColor}),style:{color:t.mediumTextColor},title:(0,C.jsx)(I()._H,{defaultMessage:"Show {showMore} more",id:"database.viewSettings.duplicateExistingViewTab.showMore.title",values:{showMore:n}})}),action:()=>{l()}};a.push(e)}return a}({viewStores:b,showMore:w,preselectedViewPointerId:null===(e=m.current.preselectedViewPointer)||void 0===e?void 0:e.id,onDuplicateViewAccept:x,onShowMore:()=>g(!1),theme:j})}),[x,w,j,b]),M=(0,r().VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getName()}),[t]);return(0,C.jsx)(Nr,{collectionSettingsStore:o,collectionName:M,inputValue:d,onInputValueChange:e=>{u(e),c.setState({focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}}),g(!0)},menuListItems:_,showMore:w,initialViewType:m.current.initialViewType,menuListStore:c,onNewEmptyViewClick:v,onBackArrowClick:()=>{m.current.wentBack=!0,s().z$({collectionSettingsStore:o})}})}function zr(e,t,o){const n=e.collectionViewBlockStore(),i=e.collectionStore(),r=e.collectionViewStore();if(!n||!i||!r)return{viewStores:[],showMore:0};const l=i.getParentBlockStore();if(!n||!l)return{viewStores:[],showMore:0};let a=(0,dt().gL)({collectionStore:i,sourceCollectionViewBlockStore:l,currentCollectionViewBlockStore:n,currentCollectionViewStore:r,constraints:(0,Hn().x)(r.id)}),s=0;return t?a=a.filter((e=>(0,dt().D)(e,t))):o&&(s=a.length-Er,a=a.slice(0,Er)),{viewStores:a,showMore:s}}var Wr=()=>o(5234),qr=()=>o(889919),Gr=()=>o(956057),Yr=()=>o(434255),$r=()=>o(696056),Qr=()=>o(839002),Jr=()=>o(661297),Xr=()=>o(64509),el=()=>o(148976),tl=()=>o(308939),ol=()=>o(838266),nl=()=>o(697623);const il=(0,I().vU)({inputPlaceholder:{defaultMessage:"Search for a project...",id:"database.viewSettings.collectionSettingsExternalListProjects.inputPlaceholder"},fetchingProjects:{defaultMessage:"Loading projects from Jira...",id:"database.viewSettings.collectionSettingsExternalListProjects.fetchingProjects"},fetchingProjectsFailed:{defaultMessage:"We're experiencing temporary issues with Jira's APIs. Please try again in a sometime.",id:"database.viewSettings.collectionSettingsExternalListProjects.fetchingProjectsFailed"},defaultLoadingMessage:{defaultMessage:"Loading...",id:"database.viewSettings.collectionSettingsExternalListProjects.loading"},somethingWentWrong:{defaultMessage:"Something went wrong. Please try again!",id:"database.viewSettings.collectionSettingsExternalListProjects.somethingWentWrong"},authInProgress:{defaultMessage:"Authenticating with Jira...",id:"database.viewSettings.collectionSettingsExternalListProjects.authInProgress"},authFailed:{defaultMessage:"Authentication failed, try again!",id:"database.viewSettings.collectionSettingsExternalListProjects.authFailed"},noAccessToSite:{defaultMessage:"If you have multiple Jira sites, make sure you're authenticating into {site}",id:"database.viewSettings.collectionSettingsExternalListProjects.noAccessToSite"}});function rl(e){switch(e){case"fetchingProjects":return il.fetchingProjects;case"somethingWentWrong":return il.somethingWentWrong;case"fetchingProjectsFailed":return il.fetchingProjectsFailed;case"authFailed":return il.authFailed;case"authInProgress":return il.authInProgress;case"noAccessToSite":return il.noAccessToSite;default:return il.defaultLoadingMessage}}function ll(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,[l,a]=n.useState(""),[c,d]=n.useState(!1),[u,p]=n.useState([]),[g,m]=n.useState(!1),[y,h]=n.useState(0),[x,v]=n.useState(!1),[b,w]=n.useState([]),[j,M]=n.useState([]),[k,P]=n.useState([]),[T,Z]=n.useState({show:!1}),[F,R]=n.useState(!1),[K,H]=n.useState({show:!1}),[O,L]=n.useState(""),D=(0,i().O7)(),N=(0,r().VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSpaceId()}),[t]),U=(0,r().VK)((()=>un().default.state.currentSpaceStore),[]),z=(0,r().VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat().bot_id}),[t]),[{value:G}]=(0,S().r5)((async()=>{if(z&&N)return ie().callApi({eventName:"getExternalConnectionMetaInfo",environment:D,data:{botId:z,spaceId:N}})}),[D,z,N]);(0,n.useEffect)((()=>{"success"===(null==G?void 0:G.type)&&"data"in G&&L(G.data.email)}),[G]);const $=(0,r().VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat().synced_collection_external_url}),[t]),Q=(0,r().VK)((()=>{var e;return(null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.synced_collection_instance_type)??"Cloud"}),[t]),J=(0,r().VK)((()=>"DataCenter"===Q?"jira-dc":"jira"),[Q]),X=(0,r().VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.external_collection_type}),[t]),ee=(0,r().VK)((()=>{var e;const o=null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat();return Boolean(null==o?void 0:o.sync_state)}),[t]),te=(0,r().Kw)(tl().ZP),{projectCollectionPointer:oe,taskCollectionPointer:ne}=(0,r().VK)((()=>(0,el().$s)(t.collectionStore())),[t]),re=(0,r().VK)((()=>{if(z&&U){return W().Qx.createChildStore(U,{table:$r().cZ,id:z,spaceId:U.id}).getLastEditedById()}return null}),[z,U]),le=(0,r().VK)((()=>(null==U?void 0:U.userId)===re),[re,U]),ae=(0,r().VK)((()=>{const e=tl().ZP.state.flowId||Gr().Il();return tl().ZP.setState({...tl().ZP.state,flowId:e}),e}),[]),se=(0,r().VK)((()=>te.projectKeys),[te]),[{value:ce}]=(0,S().r5)((async()=>N&&z&&oe?(Z({show:!0,type:"fetchingProjects"}),"DataCenter"===Q&&(0,el().bd)()?ie().callStreamApi({eventName:"streamProjectsForJiraSite",environment:D,data:{botId:z,spaceId:N,projectCollectionPointer:oe}}):ie().callApi({eventName:"getProjectsForJiraSite",environment:D,data:{botId:z,spaceId:N,projectCollectionPointer:oe}})):null),[D,oe,N,z,Q]),de=(0,r().VK)((()=>nl().QM()),[]);(0,n.useEffect)((()=>{de&&y>100?(m(!0),(0,mt().j)({environment:D,event:{eventName:"external_sync_setup_action",eventProperties:{integration:J,actionType:"issues_free_limit_exceeded",flowId:ae,issueCount:y,isSyncOwner:le}}})):m(!1)}),[D,ae,de,y,le,J]);const ue=(0,n.useCallback)((e=>{const{jiraProjects:t,permittedProjects:o,existingImportedProjectKeys:n}=e;P(n);const i=o.map((e=>e.key));w(i);const r=[...t.filter((e=>{let{isPrivate:t}=e;return!t})).sort(((e,t)=>{var o,n;return t.insight&&e.insight?null!==(o=t.insight)&&void 0!==o&&o.lastIssueUpdateTime&&null!==(n=e.insight)&&void 0!==n&&n.lastIssueUpdateTime?new Date(t.insight.lastIssueUpdateTime).getTime()-new Date(e.insight.lastIssueUpdateTime).getTime():t.insight.totalIssueCount-e.insight.totalIssueCount:1})),...t.filter((e=>{let{isPrivate:t}=e;return t})).sort(((e,t)=>{const o=i.includes(e.key),n=i.includes(t.key);return o&&n?0:o?-1:1}))];let l=0;r.forEach((e=>{var t;n.includes(e.key)&&(l+=(null===(t=e.insight)||void 0===t?void 0:t.totalIssueCount)??0)})),M(r),h(l);const a=fi().jj([...n,...se||[]]);n.length&&d(!0),a&&p(a)}),[se]),pe=(0,n.useCallback)((async e=>{const{response:t}=e;let o=!1;try{for await(const e of t){if("error"===e.type)return Z({show:!1}),R(!1),!("code"in e)||"SITE_NOT_FOUND"!==e.code&&"NO_USER_BOT_FOUND"!==e.code&&"INVALID_BOT"!==e.code||le?void H({show:!0,type:"fetchingProjectsFailed"}):void v(!0);if(!o){d(!0),P(e.existingImportedProjectKeys);const t=fi().jj([...e.existingImportedProjectKeys,...se||[]]);p(t),o=!0,Z({show:!1})}M((t=>fi().sv([...t,...e.permittedProjects],((e,t)=>e.key===t.key)))),w((t=>fi().jj([...t,...e.permittedProjects.map((e=>e.key))])))}}finally{R(!1)}}),[se,le]);(0,n.useEffect)((()=>{if("success"!==(null==ce?void 0:ce.type)&&"failed"!==(null==ce?void 0:ce.type)||("Cloud"!==Q&&(0,el().bd)()||Z({show:!1}),"failed"===(null==ce?void 0:ce.type)&&H({show:!0,type:"fetchingProjectsFailed"})),"success"===(null==ce?void 0:ce.type)&&"data"in ce&&"object"==typeof ce.data)if("code"in ce.data){if(!le){const{code:e}=ce.data;"SITE_NOT_FOUND"===e?(v(!0),H({show:!0,type:"noAccessToSite"})):"NO_USER_BOT_FOUND"!==e&&"INVALID_BOT"!==e||v(!0),(0,mt().j)({environment:D,event:{eventName:"external_sync_auth",eventProperties:{integration:J,actionType:"member_auth_render",flowId:ae}}})}}else"DataCenter"===Q&&(0,el().bd)()&&Symbol.asyncIterator in ce.data?(R(!0),pe({response:ce.data})):ue(ce.data)}),[ce,le,ue,pe,D,ae,Q,J]);const ge=X?Xr().I[X]:"",me=(0,r().VK)((()=>{const e=tl().ZP.state;return e.isMemberAuthSuccessForDataCenter&&!e.open&&"DataCenter"===e.instanceValue&&e.site&&"dc-auth"===e.type}),[]);(0,S().r5)((async()=>{if(!le&&oe&&N&&z&&me&&(0,el().oA)()&&(0,el().bd)()){v(!1),Z({show:!0,type:"fetchingProjects"}),M([]),R(!0);try{const e=await ie().callStreamApi({eventName:"streamProjectsForJiraSite",environment:D,data:{botId:z,spaceId:N,projectCollectionPointer:oe}});"success"===e.type&&"data"in e&&"object"==typeof e.data&&await pe({response:e.data})}catch(e){R(!1),H({show:!0,type:"fetchingProjectsFailed"})}}}),[z,N,oe,D,pe,me,le]);const fe=(0,f().yK)((e=>{const t="dark"===e.mode;return{fetchingProjects:{width:"100%",height:"100%",paddingBottom:10,display:"flex",justifyContent:"center",alignItems:"center",fontSize:14,paddingLeft:8,paddingRight:8,color:e.mediumTextColor,textAlign:"center"},settingsMenu:{padding:"8px"},projectIcon:{width:20,height:20,borderRadius:4,..."Cloud"===Q&&{marginBottom:14}},connectAccountWrapper:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",margin:12,padding:12,flexDirection:"column",gap:8},connectAccountCTA:{borderRadius:6},connectAccountDescription:{fontSize:V().JB.UIRegular.desktop,textAlign:"center",color:e.text.secondary},errorMessage:{display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",height:"100%",color:tn().ZP.red,paddingLeft:8,paddingRight:8,fontSize:V().JB.UIRegular.desktop},authErrorMessage:{fontSize:V().JB.UIRegular.desktop,color:e.text.secondary,marginBottom:12,textAlign:"center"},permittedProjectItemTitle:{fontSize:V().JB.UISmall.desktop,fontWeight:V().Ue.medium},permittedProjectItemCaption:{fontSize:V().JB.UISmall.desktop,color:bn().Lr.dark.gray,fontWeight:V().Ue.regular},disabledItem:{color:e.mediumTextColor,fill:e.mediumIconColor,opacity:.4},sectionMargin:{margin:"0px 14px"},projectVisibilityCallout:{fontSize:V().JB.UISmall.desktop,...!t&&{backgroundColor:tn().ZP.EmailLinkBackground},padding:"6px 8px",marginBottom:6,borderRadius:6,color:e.text.secondary},privateProjectCallout:{width:"-webkit-fill-available",padding:"0px 16px",color:e.text.secondary,marginLeft:4,marginRight:4},helpIcon:{width:12,height:12,display:"inline-block"},menuListItem:{paddingTop:"0px",paddingBottom:"0px"},checkBox:{borderRadius:2,..."Cloud"===Q&&{marginBottom:14}},deskTopIcon:{..."Cloud"===Q&&{alignSelf:"center"}}}}),[Q]);if(!z||!N)return null;const ye=j.length?(0,yo().ZP)(l,j,(e=>e.name)):[],Se=e=>{const t=e.key;var o,n;u.includes(t)?(p(u.filter((e=>e!==t))),h(y-((null===(o=e.insight)||void 0===o?void 0:o.totalIssueCount)??0))):(p([...u,t]),h(y+((null===(n=e.insight)||void 0===n?void 0:n.totalIssueCount)??0)))},he=()=>{const e=j.filter((e=>Ce(e.key)));if(u.length===e.length)p([]),h(0);else{let e=0;p(j.filter((e=>Ce(e.key))).map((t=>{var o;return e+=(null===(o=t.insight)||void 0===o?void 0:o.totalIssueCount)??0,t.key}))),h(e)}},xe=()=>{let e=0;const t=j.filter((e=>!k.includes(e.key)&&Ce(e.key))).map((t=>{var o;return e+=(null===(o=t.insight)||void 0===o?void 0:o.totalIssueCount)??0,t.key})),o=u.filter((e=>!t.includes(e)));if(t.every((e=>u.includes(e))))p(o),h(y-e);else{p([...o,...t]);let e=0;for(const t of u){const o=j.find((e=>e.key===t));var n;if(o)e+=(null===(n=o.insight)||void 0===n?void 0:n.totalIssueCount)??0}h(e)}},ve=()=>{const e=u.filter((e=>!k.includes(e)));k.every((e=>u.includes(e)))?p(e):p([...e,...k]);let t=0;for(const n of u){const e=j.find((e=>e.key===n));var o;if(e)t+=(null===(o=e.insight)||void 0===o?void 0:o.totalIssueCount)??0}h(t)},Ce=e=>b.includes(e),be=$&&(0,Wr().Z)((0,el().jh)($)),we=ye.map((e=>({key:e.id,render:()=>(0,C.jsx)(ro().Z,{disableTooltip:Ce(e.key),renderTooltip:e=>(0,C.jsx)("div",{...e,style:ko().F6,children:Te}),render:t=>(0,C.jsx)(q().Z,{...t,style:fe.menuListItem,focused:!1,buttonStyle:Ce(e.key)?{}:fe.disabledItem,disabled:!Ce(e.key),onClick:()=>{Se(e)},title:(0,C.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,C.jsx)("div",{children:(0,C.jsx)(ho().Z,{size:14,disabled:!Ce(e.key),checked:u.includes(e.key),onClick:()=>{Se(e)},style:fe.checkBox})}),icon:(0,C.jsx)("img",{src:e.avatarUrls["48x48"],style:fe.projectIcon}),desktopIconStyle:fe.deskTopIcon,caption:e.insight&&(0,C.jsx)("div",{children:e.isPrivate?(0,C.jsx)(I()._H,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}} (Private)",id:"database.viewSettings.collectionSettingsExternalListProjects.allProjectsIssueCountPrivate",values:{issues:e.insight.totalIssueCount}}):(0,C.jsx)(I()._H,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}}",id:"database.viewSettings.collectionSettingsExternalListProjects.allProjectsIssueCountNotPrivate",values:{issues:e.insight.totalIssueCount}})})})}),action:()=>{}}))),je=ye.filter((e=>k.includes(e.key))).map((e=>({key:e.id,render:()=>(0,C.jsx)(ro().Z,{disableTooltip:Ce(e.key),renderTooltip:e=>(0,C.jsx)("div",{...e,style:ko().F6,children:Te}),render:t=>(0,C.jsx)(q().Z,{...t,style:fe.menuListItem,focused:!1,buttonStyle:Ce(e.key)?{}:fe.disabledItem,disabled:!Ce(e.key),onClick:()=>{Se(e)},title:(0,C.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,C.jsx)("div",{children:(0,C.jsx)(ho().Z,{size:14,disabled:!Ce(e.key),checked:u.includes(e.key),onClick:()=>{Se(e)},style:fe.checkBox})}),icon:(0,C.jsx)("img",{src:e.avatarUrls["48x48"],style:fe.projectIcon}),desktopIconStyle:fe.deskTopIcon,caption:e.insight&&(0,C.jsx)("div",{children:e.isPrivate?(0,C.jsx)(I()._H,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}} (Private)",id:"database.viewSettings.collectionSettingsExternalListProjects.syncedProjectsIssueCountPrivate",values:{issues:e.insight.totalIssueCount}}):(0,C.jsx)(I()._H,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}}",id:"database.viewSettings.collectionSettingsExternalListProjects.syncedProjectsIssueCountNotPrivate",values:{issues:e.insight.totalIssueCount}})})})}),action:()=>{}}))),_e=ye.filter((e=>!k.includes(e.key))).map((e=>({key:e.id,render:()=>(0,C.jsx)(ro().Z,{disableTooltip:Ce(e.key),renderTooltip:e=>(0,C.jsx)("div",{...e,style:ko().F6,children:Te}),render:t=>(0,C.jsx)(q().Z,{...t,style:fe.menuListItem,focused:!1,buttonStyle:Ce(e.key)?{}:fe.disabledItem,disabled:!Ce(e.key),onClick:()=>{Se(e)},title:(0,C.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,C.jsx)("div",{children:(0,C.jsx)(ho().Z,{size:14,disabled:!Ce(e.key),checked:u.includes(e.key),onClick:()=>{Se(e)},style:fe.checkBox})}),desktopIconStyle:fe.deskTopIcon,icon:(0,C.jsx)("img",{src:e.avatarUrls["48x48"],style:fe.projectIcon}),caption:e.insight&&(0,C.jsx)("div",{children:e.isPrivate?(0,C.jsx)(I()._H,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}} (Private)",id:"database.viewSettings.collectionSettingsExternalListProjects.unsyncedProjectsIssueCountPrivate",values:{issues:e.insight.totalIssueCount}}):(0,C.jsx)(I()._H,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}}",id:"database.viewSettings.collectionSettingsExternalListProjects.unsyncedProjectsIssueCountNotPrivate",values:{issues:e.insight.totalIssueCount}})})})}),action:()=>{}}))),Me=(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{style:fe.permittedProjectItemTitle,children:(0,C.jsx)(I()._H,{id:"database.viewSettings.collectionSettingsExternalListProjects.userTooltipTitleForPrivatePages",defaultMessage:"Only some private projects can be synced to Notion"})}),(0,C.jsx)("div",{style:fe.permittedProjectItemCaption,children:le?(0,C.jsx)(I()._H,{id:"database.viewSettings.collectionSettingsExternalListProjects.owner.userTooltipCaptionForPrivatePages",defaultMessage:"{site} sync was set up with the Jira account {email}. You can only sync projects they have access to. Click to view the help center",values:{email:O,site:be||"This"}}):(0,C.jsx)(I()._H,{id:"database.viewSettings.collectionSettingsExternalListProjects.member.userTooltipCaptionForPrivatePages",defaultMessage:"{site} sync was set up with the Jira account {email}. You can only sync projects that both have access to. Click to view the help center",values:{email:O,site:be||"This"}})})]}),ke=()=>(0,C.jsxs)("div",{style:{...fe.sectionMargin,...fe.projectVisibilityCallout},children:[(0,C.jsx)(I()._H,{id:"database.viewSettings.collectionSettingsExternalListProjects.projectVisibilityCallout",defaultMessage:"Syncing these projects will make them visible to everyone with access to this database "}),(0,C.jsx)(ro().Z,{renderTooltip:e=>(0,C.jsxs)("div",{...e,style:ko().F6,children:[(0,C.jsx)("div",{style:fe.permittedProjectItemTitle,children:(0,C.jsx)(I()._H,{id:"database.viewSettings.collectionSettingsExternalListProjects.projectVisibilityCalloutTooltip.title",defaultMessage:"To restrict access, create a new Jira sync database"})}),(0,C.jsx)("div",{style:fe.permittedProjectItemCaption,children:(0,C.jsx)(I()._H,{id:"database.viewSettings.collectionSettingsExternalListProjects.projectVisibilityCalloutTooltip.description",defaultMessage:"Use the Share menu to choose who can access the database, then sync your private projects"})})]}),alignment:ao().Alignment.Start,render:e=>(0,C.jsx)("div",{...e,style:{display:"inline",position:"relative",top:2},children:(0,C.jsx)("span",{children:(0,_().m)(fe.helpIcon)})})})]}),Pe=()=>(0,C.jsx)(ro().Z,{renderTooltip:e=>(0,C.jsx)("div",{...e,style:ko().F6,children:Me}),render:e=>(0,C.jsx)(_o().D,{...e,style:fe.privateProjectCallout,children:(0,C.jsxs)(Y().Z,{className:"notion-print-ignore",href:(0,ur().UY)("guides.externalImportAndSync"),external:!0,children:[(0,_().m)({...fe.helpIcon,marginRight:6}),(0,C.jsx)(I()._H,{id:"database.viewSettings.collectionSettingsExternalListProjects..privateProjectNotFound",defaultMessage:"Can't find a private project?"})]})})}),Te=le?(0,C.jsx)(I()._H,{id:"database.viewSettings.collectionSettingsExternalListProjects.tooltipMessageForPrivatePages",defaultMessage:"You don't have access to this project in Jira"}):Me;async function Ie(){H({show:!1});const e="DataCenter"===Q?Lo().Gl:Lo().mC,t=so().default.integrations.state.find((t=>{let{id:o}=t;return o===e}));if(!t||!N)return;(0,mt().j)({environment:D,event:{eventName:"external_sync_auth",eventProperties:{integration:J,actionType:"member_auth_initiated",flowId:ae}}}),e===Lo().Gl&&tl().ZP.setState({...tl().ZP.state,site:$});const o=D.device.isElectron?await async function(e,t){const o=await io().hM({environment:D,integration:e,spaceId:t,from:"connected_apps_settings"});Z({show:!0,type:"authInProgress"});const n=so().default.externalAuthentications.state,i=performance.now()+6e4,r=Qr().UZ(),l=setInterval((()=>{const e=performance.now();i<e?r.resolve(void 0):so().default.externalAuthentications.state.length>n.length&&r.resolve("success")}),1e3);return await r.promise,clearInterval(l),Z({show:!1}),o}(t,N):await io().hM({environment:D,integration:t,spaceId:N,from:"connected_apps_settings"});if("DataCenter"!==Q||le)if(v(!1),o&&E().x.isSuccess(o)){if(!z||!oe)return;if((0,mt().j)({environment:D,event:{eventName:"external_sync_auth",eventProperties:{integration:J,flowId:ae,status:"success",actionType:"member_auth_status"}}}),Z({show:!0,type:"fetchingProjects"}),"DataCenter"===Q&&(0,el().bd)()&&le){M([]);try{const e=await ie().callStreamApi({eventName:"streamProjectsForJiraSite",environment:D,data:{botId:z,spaceId:N,projectCollectionPointer:oe}});"success"===e.type&&"data"in e&&"object"==typeof e.data&&(R(!0),pe({response:e.data}))}catch(i){H({show:!0,type:"fetchingProjectsFailed"})}}else{var n;const e=await ie().callApi({eventName:"getProjectsForJiraSite",environment:D,data:{botId:z,spaceId:N,projectCollectionPointer:oe,userBotId:null===(n=o.value)||void 0===n||null===(n=n.externalAuthentication)||void 0===n?void 0:n.id}});Z({show:!1}),"success"===e.type?"code"in e.data?"SITE_NOT_FOUND"===e.data.code?(v(!0),A().vC({message:(0,C.jsx)(cl,{site:$,integrationIconUrl:ge,connectAccount:Ie}),showCancel:!1,keepFocus:!0,innerStyle:{width:320,padding:18},items:[]}),(0,mt().j)({environment:D,event:{eventName:"external_sync_auth",eventProperties:{integration:J,actionType:"member_auth_render",flowId:ae}}})):"NO_USER_BOT_FOUND"===e.data.code?(v(!0),H({type:"somethingWentWrong",show:!0}),(0,mt().j)({environment:D,event:{eventName:"external_sync_auth",eventProperties:{integration:J,actionType:"member_auth_render",flowId:ae}}})):H({type:"fetchingProjectsFailed",show:!0}):ue(e.data):H({type:"fetchingProjectsFailed",show:!0})}}else v(!0),H({type:"authFailed",show:!0}),(0,mt().j)({environment:D,event:{eventName:"external_sync_auth",eventProperties:{integration:J,flowId:ae,status:"failed",actionType:"member_auth_status"}}})}return(0,C.jsx)(B().ZP,{...e,title:(0,C.jsx)(I()._H,{defaultMessage:"{title}",id:"database.viewSettings.collectionSettingsExternalListProjects.title",values:{title:ee?"Synced projects":"Select projects"}}),header:!T.show&&!x&&!K.show&&(0,C.jsx)(al,{inputValue:l,onChange:a}),handleClose:()=>{tl().ZP.setState({...te,projectKeys:[],site:void 0,isMemberAuthSuccessForDataCenter:!1}),s().E3({collectionSettingsStore:o})},footer:!T.show&&!x&&!K.show&&(0,C.jsx)(sl,{onActionButtonClick:()=>{const e={};j.forEach((t=>{var o;t.insight&&(u.includes(t.key)&&(e[t.key]=(null===(o=t.insight)||void 0===o?void 0:o.totalIssueCount)??0))})),s().H4({collectionSettingsStore:o,item:{type:"externalProjectsSyncSettings",source:"external_list_task_properties",action:go().K6.SyncProjects,selectedProjectKeys:u,projectIssueCounts:e}}),tl().ZP.setState({...tl().ZP.state,projectKeys:[]}),(0,mt().j)({environment:D,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:J,actionType:"select_properties_cta_click",flowId:ae,identifier:$,botId:z,collectionId:null==ne?void 0:ne.id,isSyncOwner:le}}})},disabled:!c&&0===u.length,selectedProjectKeysLength:u.length,isSetupComplete:ee,shouldShowUpgradePlan:g,flowId:ae,isSyncOwner:le,integrationType:J}),fullHeight:!0,menuScrollerStyle:{paddingBottom:6,...x||K.show?{height:"100%"}:{}},children:T.show?(0,C.jsxs)("div",{style:fe.fetchingProjects,children:[(0,C.jsx)("span",{children:Co().Z.formatMessage(rl(T.type))}),(0,C.jsx)(Mo().Z,{style:{alignSelf:"center"}})]}):x?(0,C.jsxs)("div",{style:fe.connectAccountWrapper,children:[K.show&&(0,C.jsx)("div",{style:fe.authErrorMessage,children:Co().Z.formatMessage(rl(K.type),{site:(0,Yr().D1)($||"")})}),(0,C.jsxs)(Jr().Z,{onClick:Ie,style:fe.connectAccountCTA,children:[(0,C.jsx)("img",{style:{width:14,height:15,marginRight:8},src:ge}),(0,C.jsx)(I()._H,{id:"database.viewSettings.collectionSettingsExternalListProjects.connectAccountCTA",defaultMessage:"Authenticate your access"})]}),(0,C.jsx)("div",{style:fe.connectAccountDescription,children:(0,C.jsx)(I()._H,{id:"database.viewSettings.collectionSettingsExternalListProjects.connectAccountDescription",defaultMessage:"Connect your Jira account to view and sync projects"})})]}):K.show?(0,C.jsx)("div",{style:fe.errorMessage,children:Co().Z.formatMessage(rl(K.type))}):c?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Po,{title:(0,C.jsx)(I()._H,{defaultMessage:"{existingSyncedProjectsCount, plural, one {{existingSyncedProjectsCount} synced project} other {{existingSyncedProjectsCount} synced projects}}",id:"database.viewSettings.collectionSettingsExternalListProjects.syncedProjectsTitle",values:{existingSyncedProjectsCount:k.length}}),isSectionItemsLoading:F,isSelectAll:!k.every((e=>u.includes(e))),items:je,handleSelect:ve},"syncedProjects"),(0,C.jsx)(Po,{title:(0,C.jsx)(I()._H,{defaultMessage:"{unsyncedProjectsCount, plural, one {{unsyncedProjectsCount} unsynced project} other {{unsyncedProjectsCount} unsynced projects}}",id:"database.viewSettings.collectionSettingsExternalListProjects.unsyncedProjectsTitle",values:{unsyncedProjectsCount:j.length-k.length}}),isSectionItemsLoading:F,isSelectAll:!j.filter((e=>!k.includes(e.key))).map((e=>e.key)).every((e=>u.includes(e))),sectionCallout:ke(),items:_e,handleSelect:xe},"unsyncedProjects"),Pe()]}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Po,{title:(0,C.jsx)(I()._H,{defaultMessage:"{buttonText}",id:"database.viewSettings.collectionSettingsExternalListProjects.selectedProjectsTitleForInitialSync",values:{buttonText:u.length===j.length?`All ${j.length} Projects`:`${u.length.toString()} of ${j.length.toString()} projects`}}),isSectionItemsLoading:F,handleSelect:he,items:we,sectionCallout:ke(),isSelectAll:u.length!==j.length,disableCollapse:!0},"allProjects"),Pe()]})})}function al(e){const{isMobile:t}=(0,i().Fy)();return(0,C.jsxs)(ee().Z,{children:[(0,C.jsx)(pt().Z,{isSecondaryColor:!0,isMultiline:!0,style:{marginLeft:12,marginBottom:12,fontSize:t?V().JB.UISmall.mobile:V().JB.UISmall.desktop},children:(0,C.jsx)(I()._H,{defaultMessage:"Whenever a synced project is updated in Jira, those updates will appear in Notion",id:"database.viewSettings.collectionSettingsExternalListProjects.description"})}),(0,C.jsx)(xo().ZP,{focusInitial:!0,value:e.inputValue,onChange:t=>{e.onChange(t.target.value)},placeholder:Co().Z.formatMessage(il.inputPlaceholder)})]})}function sl(e){const t=(0,i().O7)(),o=(0,f().yK)((e=>({wrapper:{padding:12,borderTop:`1px solid ${e.tableHomeDividerColor}`},wrapperInner:{borderColor:"none"},button:{width:"100%",border:"none",fontWeight:V().Ue.medium},syncDescription:{fontSize:V().JB.UISmall.desktop,color:e.mediumTextColor,marginBottom:8,textAlign:"center"},error:{color:"#D44C47"}})),[]);return(0,C.jsx)("div",{style:o.wrapper,children:(0,C.jsx)("div",{style:o.wrapperInner,children:e.shouldShowUpgradePlan?(0,C.jsxs)("div",{children:[(0,C.jsx)("div",{style:{...o.syncDescription,...o.error},children:(0,C.jsx)(I()._H,{defaultMessage:"Your Free Notion plan allows up to 100 synced issues. Choose fewer projects or upgrade to sync unlimited issues.",id:"database.viewSettings.collectionSettingsExternalListProjects.upgradePlanContext"})}),(0,C.jsx)(X().Z,{style:o.button,onClick:()=>{ol().default.setState({open:!0,openedFrom:"jira_sync_2",currentTab:"plans",defaultSubtab:void 0,highlightedSetting:void 0}),(0,mt().j)({environment:t,event:{eventName:"external_sync_setup_action",eventProperties:{integration:e.integrationType,actionType:"plan_upgrade_cta_click",flowId:e.flowId,isSyncOwner:e.isSyncOwner}}})},disabled:e.disabled,children:(0,C.jsx)(I()._H,{defaultMessage:"Upgrade",id:"database.viewSettings.collectionSettingsExternalListProjects.Upgrade"})})]}):(0,C.jsxs)(C.Fragment,{children:[!e.isSetupComplete&&(0,C.jsx)("div",{style:o.syncDescription,children:(0,C.jsx)(I()._H,{defaultMessage:"{projects, plural, one {{projects} project will be synced} other {{projects} projects will be synced}}",id:"database.viewSettings.collectionSettingsExternalListProjects.projectsToBeSynced",values:{projects:e.selectedProjectKeysLength}})}),(0,C.jsxs)(X().Z,{style:o.button,onClick:e.onActionButtonClick,disabled:e.disabled,children:[(0,C.jsx)("div",{style:{textOverflow:"ellipsis",overflow:"hidden"},children:(0,C.jsx)(I()._H,{defaultMessage:"Select properties to sync ",id:"database.viewSettings.collectionSettingsExternalListProjects.selectProperties"})}),(0,qr().k)({width:14,height:14,marginLeft:6})]})]})})})}function cl(e){const{isMobile:t}=(0,i().Fy)(),o=(0,f().yK)((e=>({title:{fontWeight:V().Ue.medium,marginRight:4,marginBottom:6},caption:{marginBottom:24},tryAgainCTA:{width:"100%",marginBottom:8},cancelCTA:{width:"100%",justifyContent:"center",color:e.lightTextColor,fontWeight:V().Ue.medium},siteButtonContainer:{gap:2,borderRadius:6,borderStyle:"solid",borderWidth:1,borderColor:e.stroke.secondary,marginBottom:24},siteButton:{padding:"4px 30px 4px 8px",borderRadius:6,gap:8,display:"flex"},siteButtonTextContainer:{gap:8,display:"flex"},siteNameText:{fontSize:t?V().JB.UIRegular.mobile:V().JB.UIRegular.desktop,fontWeight:V().Ue.regular,lineHeight:"18px",letterSpacing:"0.15px",color:e.text.primary},siteNameSecondaryText:{fontSize:t?V().JB.UISmall.mobile:V().JB.UISmall.desktop,color:e.text.secondary,fontWeight:V().Ue.regular,textAlign:"left",lineHeight:t?V().Nv.UISmall.mobile:V().Nv.UISmall.desktop},logo:{width:20,height:20,marginTop:6},siteWrapper:{display:"flex",flexFlow:"column",gap:1,alignItems:"flex-start"}})),[t]);return(0,C.jsxs)("div",{children:[(0,C.jsx)("div",{style:o.title,children:(0,C.jsx)(I()._H,{id:"database.viewSettings.collectionSettingsExternalListProjects.siteMismatchPopup.title",defaultMessage:"Authentication Failed"})}),(0,C.jsx)(pt().Z,{isSecondaryColor:!0,isMultiline:!0,style:o.caption,children:(0,C.jsx)(I()._H,{id:"database.viewSettings.collectionSettingsExternalListProjects.siteMismatchPopup.description",defaultMessage:"If you have multiple Jira sites, make sure you’re authenticating into this one:"})}),(0,C.jsx)("div",{style:o.siteButtonContainer,children:(0,C.jsx)(jo().Z,{style:o.siteButton,disallowTabbing:!0,disabled:!0,children:(0,C.jsxs)("div",{style:o.siteButtonTextContainer,children:[(0,C.jsx)("img",{style:o.logo,src:e.integrationIconUrl}),(0,C.jsxs)("div",{style:o.siteWrapper,children:[(0,C.jsx)("span",{style:o.siteNameText,children:(0,Wr().Z)((0,el().jh)(e.site||""))}),(0,C.jsx)("span",{style:o.siteNameSecondaryText,children:e.site})]})]})})}),(0,C.jsx)(X().Z,{style:{width:"100%",marginBottom:8},onClick:()=>{e.connectAccount(),A().lo()},children:(0,C.jsx)(I()._H,{defaultMessage:"Try again",id:"database.viewSettings.collectionSettingsExternalListProjects.siteMismatchPopup.tryAgainCTA"})}),(0,C.jsx)(_o().D,{onClick:()=>{A().lo()},style:{width:"100%",justifyContent:"center"},children:(0,C.jsx)(pt().Z,{isSecondaryColor:!0,children:(0,C.jsx)(I()._H,{defaultMessage:"Cancel",id:"database.viewSettings.collectionSettingsExternalListProjects.siteMismatchPopup.cancenCTA"})})})]})}const dl=(0,I().vU)({inputPlaceholder:{defaultMessage:"Search for a property...",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.inputPlaceholder"}}),ul=o(919758).Lt,pl=["attachment","issuetype"],gl=["description","comment"],ml=["updated","labels","issuelinks","creator","subtasks","reporter","watches","created"],fl=new Map([["user","person"],["attachment","file"],["array","multi_select"],["option","select"],["option-with-child","select"],["number","number"],["datetime","date"],["date","date"],["priority","select"],["issuetype","select"],["string","text"],["default","text"]]),yl=100;function Sl(e){const{collectionSettingsStore:t,collectionContextStore:o,action:a,selectedProjectKeys:c}=e,[d,u]=n.useState(""),[p,g]=n.useState([]),m=(0,f().Fg)(),[y,h]=n.useState(!1),x=(0,i().O7)(),v=(0,r().VK)((()=>o.collectionStore()),[o]),b=(0,r().VK)((()=>null==v?void 0:v.getFormat()),[v]),w=(0,r().VK)((()=>null==v?void 0:v.getSchema()),[v]),j=(0,r().VK)((()=>{const e=o.collectionViewBlockStore();return"notion://projects_collection"===(null==b?void 0:b.app_config_uri)?(0,tt().MF)(e,null==w?void 0:w["notion://projects/project_to_task_relation"]):v}),[o,w,b,v]),_=(0,r().VK)((()=>null==j?void 0:j.getSchema()),[j]),M=(0,r().VK)((()=>null==j?void 0:j.id),[j]),k=(0,r().VK)((()=>null==v?void 0:v.getSpaceId()),[v]),P=(0,r().VK)((()=>{var e;return null==v||null===(e=v.getFormat())||void 0===e?void 0:e.synced_collection_external_url}),[v]),T=(0,r().VK)((()=>null==v?void 0:v.getFormat().bot_id),[v]),V=(0,r().VK)((()=>p.filter((e=>e.isSelected)).length),[p]),A=(0,r().VK)((()=>{const e=null==v?void 0:v.getFormat();return Boolean(null==e?void 0:e.sync_state)}),[v]),Z=(0,r().Kw)(tl().ZP),F=(0,r().VK)((()=>{const e=Z.flowId||Gr().Il();return Z.flowId||tl().ZP.setState({...Z,flowId:e}),e}),[Z]),R=(0,r().VK)((()=>Boolean(so().default.externalAuthentications.state.find((e=>e.id===T&&e.user_id===x.currentUser.id)))),[T,x]),K=(0,n.useCallback)((e=>{const t=p.map((t=>{const o=e.find((e=>e.id===t.id));var n;return o&&!gl.includes(o.id)?{...t,isProjectLevel:"PROJECT"===(null===(n=o.scope)||void 0===n?void 0:n.type)}:t})),o=e.filter((e=>!t.find((t=>t.id===e.id))&&!gl.includes(e.id))).filter((e=>{let{schema:t}=e;return Boolean(t)})).map((e=>{var t;const o=pl.includes(e.id),n=(0,l().Ul)(`${M}:${e.id}`),i=Boolean(null==_?void 0:_[n]);return{id:e.id,name:e.name,isSelected:o||i,isRequired:o,currentlySyncing:o||i,type:(r=null==e?void 0:e.schema,r?"watches"===r.type||"array"===r.type&&"user"===r.items?"person":"array"===r.type&&"attachment"===r.items?"file":fl.get((null==r?void 0:r.type)??"default"):"text"),isProjectLevel:"PROJECT"===(null===(t=e.scope)||void 0===t?void 0:t.type),isPopular:ml.includes(e.id)};var r}));return[...t,...o]}),[p,M,_]),H=(0,n.useCallback)((e=>{g(e);e.filter((e=>e.isSelected)).length>100&&(0,mt().j)({environment:x,event:{eventName:"external_sync_setup_action",eventProperties:{integration:"jira",actionType:"properties_limit_exceeded",flowId:F,identifier:P,botId:T,collectionId:M,isSyncOwner:R}}})}),[x,P,T,M,F,R]),[{value:O}]=(0,S().r5)((async()=>k&&P?await ie().callApi({eventName:"getFieldsForJiraIssues",environment:x,data:{spaceId:k,site:P}}):null),[x,k,P]);(0,n.useEffect)((()=>{if(!y&&"success"===(null==O?void 0:O.type)&&"data"in O){const e=K(O.data.fields.sort(((e,t)=>{var o,n,i,r,l;return pl.includes(e.id)&&!pl.includes(t.id)?-1:!pl.includes(e.id)&&pl.includes(t.id)?1:pl.includes(e.id)&&pl.includes(t.id)||null!==(o=e.schema)&&void 0!==o&&o.customId&&null!==(n=t.schema)&&void 0!==n&&n.customId||!(null!==(i=e.schema)&&void 0!==i&&i.customId||null!==(r=t.schema)&&void 0!==r&&r.customId)?e.name.toLocaleLowerCase()>t.name.toLocaleLowerCase()?1:-1:null!==(l=e.schema)&&void 0!==l&&l.customId?1:-1})));h(!0),H(e)}}),[O,y,H,K]),(0,n.useEffect)((()=>{const e=[];_&&Object.entries(_).forEach((t=>{let[o,n]=t;if(("relation"!==(null==n?void 0:n.type)||null==n||!n.connectedRelation)&&(null!=n&&n.derived_property_record_metadata||ul.has(o))){var i;const t="title"===o?"Task Name (Summary)":(null==n?void 0:n.name)??ul.get(o)??"",r=(null==n||null===(i=n.derived_property_record_metadata)||void 0===i?void 0:i.external_object_attribute)??ul.get(o)??"";e.push({id:r,name:t,isSelected:!0,currentlySyncing:!0,isRequired:ul.has(o)||pl.includes(r),type:null==n?void 0:n.type})}})),g((t=>fi().mN([...t,...e],"id")))}),[_]);const L=(0,f().yK)((e=>({settingsMenu:{padding:8},disabledItem:{color:e.mediumTextColor,fill:e.mediumIconColor,opacity:.4},snackbarCta:{color:e.regularInvertedTextColor,marginLeft:16}})),[]),D=p.length?(0,yo().ZP)(d,p,(e=>e.name)):[],E=e=>{H(p.map((t=>t.id===e.id?{id:e.id,name:e.name,isRequired:e.isRequired,isSelected:!e.isSelected,currentlySyncing:e.currentlySyncing,type:e.type,isPopular:e.isPopular,isProjectLevel:e.isProjectLevel}:t)))},N=D.filter((e=>e.isRequired||e.isPopular)).map((e=>({key:e.id,render:()=>(0,C.jsx)(q().Z,{focused:!1,style:e.isRequired?L.disabledItem:{},onClick:()=>{E(e)},disabled:e.isRequired,title:(0,C.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,C.jsx)("div",{children:(0,C.jsx)(ho().Z,{size:14,checked:e.isSelected,disabled:e.isRequired,onClick:()=>{E(e)},style:{borderRadius:2}})}),icon:(0,C.jsx)(mo().ZP,{type:e.type??"text",icon:void 0,size:16,theme:m})}),action:()=>{}}))),U=D.filter((e=>!e.isRequired&&e.isProjectLevel)),z=D.filter((e=>!(e.isProjectLevel||e.isPopular||e.isRequired))),W=U.map((e=>({key:e.id,render:()=>(0,C.jsx)(q().Z,{focused:!1,onClick:()=>{E(e)},title:(0,C.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,C.jsx)("div",{children:(0,C.jsx)(ho().Z,{size:14,checked:e.isSelected,disabled:e.isRequired,onClick:()=>{E(e)},style:{borderRadius:2}})}),icon:(0,C.jsx)(mo().ZP,{type:e.type??"text",icon:void 0,size:16,theme:m})}),action:()=>{}}))),G=z.map((e=>({key:e.id,render:()=>(0,C.jsx)(q().Z,{focused:!1,onClick:()=>{E(e)},title:(0,C.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,C.jsx)("div",{children:(0,C.jsx)(ho().Z,{size:14,checked:e.isSelected,disabled:e.isRequired,onClick:()=>{E(e)},style:{borderRadius:2}})}),icon:(0,C.jsx)(mo().ZP,{type:e.type??"text",icon:void 0,size:16,theme:m})}),action:()=>{}})));return(0,C.jsx)(B().ZP,{...e,title:(0,C.jsx)(C.Fragment,{children:A?(0,C.jsx)(I()._H,{defaultMessage:"Synced issue properties",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.titleForSyncedPropertiesTab"}):(0,C.jsx)(I()._H,{defaultMessage:"Select issue properties",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.titleForSelectPropertiesTab"})}),header:(0,C.jsx)(hl,{inputValue:d,onChange:u}),handleClose:()=>{s().E3({collectionSettingsStore:t})},footer:(0,C.jsx)(xl,{action:a,onSubmit:async()=>{if(!(v&&T&&k))return;const{projectCollectionPointer:o,taskCollectionPointer:n}=(0,el().$s)(v);if(!o||!n)return;const i=t.state.stack.find((e=>"externalProjectsSyncSettings"===e.type&&"external_list_projects"===e.source)),r=p.filter((e=>e.isSelected)).map((e=>e.id));pl.forEach((e=>{r.includes(e)||r.push(e)})),xr().oV({label:(0,C.jsx)(I()._H,{defaultMessage:"Started syncing from Jira. You’ll be notified when the sync is complete",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.snackbar.title"}),right:(0,C.jsx)(_o().D,{onClick:xr().rN,style:L.snackbarCta,children:(0,C.jsx)(I()._H,{defaultMessage:"Close",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.snackbar.close"})}),position:"bottom"}),await ie().callApi({eventName:"syncJiraProjects",environment:x,data:{botId:T,projectKeys:c,projectIssueCounts:e.projectIssueCounts,spaceId:k,properties:r,projectCollectionPointer:o,taskCollectionPointer:n,onlyUpdateProperties:!i,flowId:F}}),i?(0,mt().j)({environment:x,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:"jira",actionType:"sync_projects_and_properties",flowId:F,identifier:P,botId:T,collectionId:M,isSyncOwner:R}}}):(0,mt().j)({environment:x,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:"jira",actionType:"sync_properties",flowId:F,identifier:P,botId:T,collectionId:M,isSyncOwner:R}}}),tl().ZP.setState({...tl().ZP.state,flowId:void 0}),s().E3({collectionSettingsStore:t})},isSetupComplete:A,selectedPropertiesCount:V}),fullHeight:!0,menuScrollerStyle:{paddingBottom:6},children:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Po,{title:(0,C.jsx)(I()._H,{defaultMessage:"{standardPropertyCount, plural, one {{standardPropertyCount} standard property} other {{standardPropertyCount} standard properties}}",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.standardPropertiesTitle",values:{standardPropertyCount:p.filter((e=>e.isRequired||e.isPopular)).length}}),isSelectAll:!p.filter((e=>e.isPopular||e.isRequired)).every((e=>e.isSelected)),items:N,handleSelect:()=>{p.filter((e=>e.isPopular||e.isRequired)).every((e=>e.isSelected))?H(p.map((e=>e.isPopular&&!e.isRequired?{...e,isSelected:!1}:e))):H(p.map((e=>e.isPopular&&!e.isRequired?{...e,isSelected:!0}:e)))},isSectionItemsLoading:!y},"requiredProperties"),(0,C.jsx)(Po,{title:(0,C.jsx)(I()._H,{defaultMessage:"{projectLevelOptionalPropertyCount, plural, one {{projectLevelOptionalPropertyCount} project property} other {{projectLevelOptionalPropertyCount} project properties}}",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.projectLevelOptionalPropertiesTitle",values:{projectLevelOptionalPropertyCount:W.length.toString()}}),handleSelect:()=>{p.filter((e=>e.isProjectLevel&&!e.isPopular&&!e.isRequired)).every((e=>e.isSelected))?H(p.map((e=>!e.isProjectLevel||e.isPopular||e.isRequired?e:{...e,isSelected:!1}))):H(p.map((e=>!e.isProjectLevel||e.isPopular||e.isRequired?e:{...e,isSelected:!0})))},items:W,isSelectAll:!p.filter((e=>e.isProjectLevel&&!e.isPopular&&!e.isRequired)).every((e=>e.isSelected)),selectAllTooltipContent:(0,C.jsx)(I()._H,{defaultMessage:"Syncing all properties may lead to worst performance. Try syncing only properties that are in use",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.warningMessageForProjectLevelProperties"}),isSectionItemsLoading:!y},"projectProperties"),(0,C.jsx)(Po,{title:(0,C.jsx)(I()._H,{defaultMessage:"{siteLevelPropertiesCount, plural, one {{siteLevelPropertiesCount} site property} other {{siteLevelPropertiesCount} site properties}}",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.siteLevelPropertiesTitle",values:{siteLevelPropertiesCount:G.length.toString()}}),items:G,handleSelect:()=>{p.filter((e=>!(e.isProjectLevel||e.isPopular||e.isRequired))).every((e=>e.isSelected))?H(p.map((e=>e.isProjectLevel||e.isPopular||e.isRequired?e:{...e,isSelected:!1}))):H(p.map((e=>e.isProjectLevel||e.isPopular||e.isRequired?e:{...e,isSelected:!0})))},isSelectAll:!p.filter((e=>!(e.isProjectLevel||e.isPopular||e.isRequired))).every((e=>e.isSelected)),selectAllTooltipContent:(0,C.jsx)(I()._H,{defaultMessage:"Syncing all properties may lead to worst performance. Try syncing only properties that are in use",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.warningMessageForProjectLevelProperties"}),isSectionItemsLoading:!y},"siteProperties")]})})}function hl(e){const{isMobile:t}=(0,i().Fy)();return(0,C.jsxs)(ee().Z,{children:[(0,C.jsx)(pt().Z,{isSecondaryColor:!0,isMultiline:!0,style:{marginLeft:12,marginBottom:12,fontSize:t?V().JB.UISmall.mobile:V().JB.UISmall.desktop},children:(0,C.jsx)(I()._H,{defaultMessage:"Select which Jira properties will be synced as Notion properties in the issues database",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.description"})}),(0,C.jsx)(xo().ZP,{focusInitial:!0,value:e.inputValue,onChange:t=>{e.onChange(t.target.value)},placeholder:Co().Z.formatMessage(dl.inputPlaceholder)})]})}function xl(e){const t=(0,f().yK)((e=>({wrapper:{padding:12,borderTop:`1px solid ${e.tableHomeDividerColor}`},buttonWrapper:{borderColor:"none"},button:{width:"100%",border:"none",fontWeight:V().Ue.medium},syncDescription:{paddingTop:8,fontSize:V().JB.UISmall.desktop,color:e.mediumTextColor,marginBottom:8,textAlign:"center"},error:{color:"#D44C47"}})),[]),o=e.selectedPropertiesCount>yl,n=e.action===go().K6.SyncProjects?(0,C.jsx)("div",{style:t.buttonWrapper,children:(0,C.jsx)(X().Z,{style:t.button,onClick:e.onSubmit,disabled:o,children:e.isSetupComplete?(0,C.jsx)(I()._H,{defaultMessage:"Sync projects",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.syncProjectsButton"}):(0,C.jsx)(I()._H,{defaultMessage:"Start Jira sync",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.startJiraSyncButton"})})}):(0,C.jsx)("div",{style:t.buttonWrapper,children:(0,C.jsx)(X().Z,{style:t.button,onClick:e.onSubmit,disabled:o,children:(0,C.jsx)("div",{style:{textOverflow:"ellipsis",overflow:"hidden"},children:(0,C.jsx)(I()._H,{defaultMessage:"Sync additional properties",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.syncAdditionalProperties"})})})});return(0,C.jsxs)("div",{style:t.wrapper,children:[!e.isSetupComplete&&!o&&(0,C.jsx)("div",{style:t.syncDescription,children:(0,C.jsx)(I()._H,{defaultMessage:"{propertiesCount, plural, one {{propertiesCount} property will be synced} other {{propertiesCount} properties will be synced}}",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.selectProperties",values:{propertiesCount:e.selectedPropertiesCount}})}),o&&(0,C.jsx)("div",{style:{...t.syncDescription,...t.error},children:(0,C.jsx)(I()._H,{defaultMessage:"You selected {selectedProperties} properties. The maximum allowed is 100",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.propertiesLimit",values:{selectedProperties:e.selectedPropertiesCount}})}),n]})}var vl=()=>o(146947),Cl=()=>o(646574),bl=()=>o(667067),wl=()=>o(430366),jl=()=>o(672039),_l=()=>o(384241),Ml=()=>o(983317);function kl(e){var t,o;let{taskCollectionStore:n,projectCollectionStore:l,externalSyncStore:a,currentSpaceStore:s}=e;const c=(0,r().VK)((()=>{if(s)return s.getSubscriptionTier()}),[s]),d=(0,r().VK)((()=>"enterprise"===c),[c]),u=(0,r().VK)((()=>null==n?void 0:n.getFormat()),[n]),p=Boolean(null==u||null===(t=u.sync_state)||void 0===t?void 0:t.syncing),g=(0,r().VK)((()=>p||!(null!=a&&a.shouldAllowUserToEditSyncedCollection())),[p,a]),m=Boolean(null==u||null===(o=u.sync_state)||void 0===o?void 0:o.enable_two_way_sync),f=(0,i().O7)();return d?(0,C.jsx)(te().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"2-way sync",id:"database.viewSettings.collectionSettingsExternalSource.twoWaySync.switchName"}),caption:(0,C.jsx)(I()._H,{id:"database.viewSettings.collectionSettingsExternalSource.twoWaySync.caption",defaultMessage:"Allows editing in Notion and automatically syncs changes to JIRA"}),on:m,focused:!1,onClick:()=>{Ml().toggleTwoWaySyncOnCollection({environment:f,taskCollectionStore:n,projectCollectionStore:l})},disabled:g,textWrapperStyle:{opacity:1}}):null}var Pl=()=>o(965014);function Tl(e){let{integrationIconUrl:t,currentSpaceStore:o}=e;const{isMobile:n}=(0,i().Fy)(),l=(0,i().O7)(),a=(0,f().yK)((e=>({upgradeToEnterpriseContainer:{margin:"6px 15px",padding:"12px",borderRadius:6,backgroundColor:e.surface.wash},upgradeToEnterpriseButton:{width:"100%",marginTop:6,padding:"3px 0px",backgroundColor:e.whiteButtonBackground,color:e.text.primary,borderRadius:6,textAlign:"center",border:`1px solid ${e.stroke.primary}`,fontWeight:V().Ue.medium,fontSize:n?V().JB.UIRegular.mobile:V().JB.UIRegular.desktop},upgradeToEnterpriseTextContainer:{display:"flex",alignItems:"center",margin:"0px 12px",gap:6},upgradeToEnterpriseIcon:{width:14,height:14},upgradeToEnterpriseText:{fontSize:n?V().JB.UISmall.mobile:V().JB.UISmall.desktop,color:e.text.primary,fontWeight:V().Ue.regular},hoveredStyle:{backgroundColor:e.whiteButtonHoveredBackground}})),[n]),s=(0,r().VK)((()=>{if(o)return o.getSubscriptionTier()}),[o]);return(0,r().VK)((()=>"enterprise"===s),[s])?null:(0,C.jsxs)("div",{style:a.upgradeToEnterpriseContainer,children:[(0,C.jsxs)("div",{style:a.upgradeToEnterpriseTextContainer,children:[(0,C.jsx)("img",{style:a.upgradeToEnterpriseIcon,src:t}),(0,C.jsx)("div",{style:a.upgradeToEnterpriseText,children:(0,C.jsx)(I()._H,{defaultMessage:"Jira 2-way sync is now available",id:"database.viewSettings.collectionSettingsExternalSource.twoWaySyncAvailable"})})]}),(0,C.jsx)(jo().Z,{style:a.upgradeToEnterpriseButton,hoveredStyle:a.hoveredStyle,onClick:()=>{(0,Pl().y)(l,{from:"workspace_connections",upsell:{type:"product",product:"enterprise",limit:{type:"none"}}})},children:(0,C.jsx)(I()._H,{defaultMessage:"Upgrade to Enterprise",id:"database.viewSettings.collectionSettingsExternalSource.upgradeToEnterprise"})})]})}var Il=()=>o(345918);const Vl=(0,I().vU)({CollectionSettingsExternalSourceTitle:{defaultMessage:"Select data to sync",id:"database.viewSettings.collectionSettingsExternalSource.tabTitle"},CollectionSettingsExternalSourceDescription:{id:"database.viewSettings.collectionSettingsExternalSource.description",defaultMessage:"To set up a Jira synced database, you’ll need to choose projects and properties to sync"},importInProgressToolTip:{id:"database.viewSettings.collectionSettingsExternalSource.tooltipForInProgressImport",defaultMessage:"Cannot be edited while sync is in progress"},accountDisconnectedTooltip:{id:"database.viewSettings.collectionSettingsExternalSource.accountDisconnectedTooltip",defaultMessage:"Account has been disconnected"},sourceDisabledTooltip:{id:"database.viewSettings.collectionSettingsExternalSource.sourceDisabledTooltip",defaultMessage:"Workspace owner has disabled edits for this Jira site"}}),Al=12;function Zl(e){var t,o;const{collectionSettingsStore:n,collectionContextStore:l}=e,a=(0,I().YB)(),{isMobile:c}=(0,i().Fy)(),d=(0,i().O7)(),u=(0,r().VK)((()=>l.collectionStore()),[l]),p=(0,r().VK)((()=>null==u?void 0:u.getFormat()),[u]),g=(0,r().VK)((()=>null==u?void 0:u.getSchema()),[u]),m=(0,r().VK)((()=>{var e;return null==u||null===(e=u.getFormat())||void 0===e?void 0:e.external_collection_type}),[u]),y=(0,r().VK)((()=>un().default.state.currentSpaceStore),[]),S=(0,r().Kw)(l.externalSyncStore),h=(0,r().VK)((()=>{var e;return(null==u||null===(e=u.getFormat())||void 0===e?void 0:e.synced_collection_instance_type)??"Cloud"}),[u]),x=(0,r().VK)((()=>"DataCenter"===h?"jira-dc":"jira"),[h]),v=m?Xr().I[m]:"",b=(0,r().VK)((()=>{const e=l.collectionViewBlockStore();return(0,tt().MF)(e,(null==p?void 0:p.app_config_uri)===K().wW?null==g?void 0:g[K().zI.ProjectToTaskRelation]:null==g?void 0:g[K().Es.TaskToProjectRelation])}),[l,g,p]),w=(0,r().VK)((()=>tl().ZP.getFlowId()),[]),j=(0,r().VK)((()=>Boolean(so().default.externalAuthentications.state.find((e=>e.id===(null==p?void 0:p.bot_id)&&e.user_id===d.currentUser.id)))),[p,d]),M=(0,r().VK)((()=>(0,el().Uo)()),[]),k=(0,f().yK)((e=>({collectionSettingsExternalSourceTitle:{marginLeft:12,fontSize:c?V().JB.UISmall.mobile:V().JB.UISmall.desktop,color:e.text.secondary},preview:{padding:"12px 36px 12px 30px",background:e.surface.wash,display:"flex",justifyContent:"flex-start",marginLeft:14,marginRight:14,borderRadius:6,marginBottom:24},container:{marginLeft:12,marginRight:12},lastSyncText:{fontSize:c?V().JB.UISmall.mobile:V().JB.UISmall.desktop,color:e.text.secondary,fontWeight:V().Ue.regular,textAlign:"left",marginLeft:14,lineHeight:V().Nv.UISmall.desktop,marginBottom:6},captionText:{fontSize:c?V().JB.UISmall.mobile:V().JB.UISmall.desktop,color:e.text.secondary,fontWeight:V().Ue.regular,textAlign:"left",marginLeft:14},sourceSectionTitle:{textAlign:"left",color:e.text.secondary,paddingTop:0},siteButtonContainer:{margin:"0px 14px",gap:2,borderRadius:6,borderStyle:"solid",borderWidth:1,borderColor:e.stroke.secondary},siteButton:{padding:"4px 8px",borderRadius:6,gap:8,display:"flex",justifyContent:"space-between"},siteButtonTextContainer:{gap:8,display:"flex"},siteNameText:{fontSize:c?V().JB.UIRegular.mobile:V().JB.UIRegular.desktop,fontWeight:V().Ue.regular,lineHeight:V().Nv.UIRegular.desktop,letterSpacing:"0.15px",color:e.text.primary},siteNameSecondaryText:{fontSize:c?V().JB.UISmall.mobile:V().JB.UISmall.desktop,color:e.text.secondary,fontWeight:V().Ue.regular,textAlign:"left",lineHeight:c?V().Nv.UISmall.mobile:V().Nv.UISmall.desktop},lockedIcon:{width:14,height:14,color:e.icon.secondary},emptyViewWrap:{paddingBlockEnd:42,paddingInline:12},wrap:{display:"flex",flexDirection:"column"},showMoreButtonContainer:{marginLeft:12,marginBottom:12,marginRight:"auto"},showMoreButtonContent:{fontSize:12},noResultsTitle:{color:e.text.secondary,fontSize:12,margin:0}})),[c]);if(!u||!b)return null;const P=(null==p?void 0:p.app_config_uri)===K().wW,T=Boolean((null==p?void 0:p.sync_state)&&(null==p||null===(t=p.sync_state)||void 0===t?void 0:t.last_synced_at));return(0,C.jsxs)(B().ZP,{collectionSettingsStore:n,title:a.formatMessage(Vl.CollectionSettingsExternalSourceTitle),fullHeight:!0,handleClose:()=>{tl().ZP.setState({...tl().ZP.state,projectKeys:[]}),s().E3({collectionSettingsStore:n})},children:[M?(0,C.jsx)(Tl,{integrationIconUrl:v,currentSpaceStore:y}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(ee().Z,{disableMobileBorders:!0,children:(0,C.jsx)("div",{style:k.collectionSettingsExternalSourceTitle,children:(0,C.jsx)(I()._H,{...Vl.CollectionSettingsExternalSourceDescription})})}),(0,C.jsx)("div",{style:k.preview,children:Bl({projectCollectionStore:P?u:b,taskCollectionStore:P?b:u,integrationIconUrl:v})})]}),M&&(0,C.jsx)(kl,{taskCollectionStore:P?b:u,projectCollectionStore:P?u:b,externalSyncStore:S,currentSpaceStore:y}),(0,C.jsxs)(ee().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"Source",id:"database.viewSettings.collectionSettingsExternalSource.sourceSite"}),style:k.sourceSectionTitle,desktopTitleStyle:{marginBottom:0},children:[(null==p||null===(o=p.sync_state)||void 0===o?void 0:o.last_synced_at)&&(0,C.jsx)("div",{style:k.lastSyncText,children:(0,C.jsx)(I()._H,{defaultMessage:"Last synced {lastSyncedAt}",id:"database.viewSettings.collectionSettingsExternalSource.lastSynced",values:{lastSyncedAt:`${(0,Cl().$b)(p.sync_state.last_synced_at,vl().locale,a)}`}})}),(0,C.jsx)("div",{style:k.siteButtonContainer,children:(0,C.jsxs)(jo().Z,{style:k.siteButton,disallowTabbing:!0,disabled:!0,children:[(0,C.jsxs)("div",{style:k.siteButtonTextContainer,children:[Fl({iconStyle:{width:15,height:15,marginTop:6},srcUrl:v}),(0,C.jsxs)("div",{style:{display:"flex",flexFlow:"column",gap:1},children:[(0,C.jsx)("span",{style:k.siteNameText,children:(0,Wr().Z)((0,el().jh)((null==p?void 0:p.synced_collection_external_url)||""))}),(0,C.jsx)("span",{style:k.siteNameSecondaryText,children:null==p?void 0:p.synced_collection_external_url})]})]}),(0,C.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,bl().Q)(k.lockedIcon)})]})})]}),Rl({taskCollectionStore:P?b:u,collectionSettingsStore:n,isSetupComplete:T,flowId:w,isSyncOwner:j}),(0,C.jsx)(ut().Z,{size:1,style:{marginTop:16,marginBottom:16}}),(0,C.jsx)(Y().Z,{style:{display:"flex",marginLeft:14,marginRight:14},className:"notion-print-ignore",href:(0,ur().UY)("guides.externalImportAndSync"),external:!0,onClick:()=>{(0,mt().j)({environment:d,event:{eventName:"external_sync_setup_action",eventProperties:{integration:x,actionType:"learn_more_cta_click",flowId:w,collectionId:P?b.id:u.id,botId:null==p?void 0:p.bot_id,identifier:null==p?void 0:p.synced_collection_external_url,isSyncOwner:j}}})},children:(0,C.jsx)(_o().D,{icon:_().m,isLightGray:!0,style:{width:"100%"},children:(0,C.jsx)(I()._H,{id:"externalSync.helpCenter",defaultMessage:"Learn about Jira sync"})})})]})}function Bl(e){const{projectCollectionStore:t,taskCollectionStore:o,integrationIconUrl:n}=e,l=(0,i().O7)(),a=(0,r().VK)((()=>"dark"===l.ThemeStore.state.mode),[l]),s=(0,f().yK)((e=>({iconContainer:{display:"flex",alignItems:"center"},sourceIcon:{width:26,height:26,padding:5,borderRadius:6,gap:10,borderColor:e.stroke.primary,borderStyle:"solid",borderWidth:1,boxShadow:"0px 2px 4px 0px #161D1B05",...!a&&{background:`linear-gradient(0deg, ${e.text.contrastPrimary}, ${e.text.contrastPrimary})`}},taskArrow:{width:87,height:26,top:26},projectArrow:{width:87,height:26,top:2,border:1},arrowContainer:{display:"flex",flexFlow:"column",justifyContent:"center"},collectionIconContainer:{display:"flex",flexFlow:"column",justifyContent:"space-around",gap:12},collectionIcon:{width:88,padding:"4px 6px 6px 6px",borderRadius:6,gap:6,display:"flex",alignItems:"center",borderColor:e.stroke.primary,borderWidth:1,borderStyle:"solid",...!a&&{background:`linear-gradient(0deg, ${e.text.contrastPrimary}, ${e.text.contrastPrimary})`}},title:{fontSize:Al,fontWeight:V().Ue.medium,lineHeight:V().Nv.UISmall.desktop,letterSpacing:0,color:e.text.primary}})),[a]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{style:s.iconContainer,children:Fl({iconStyle:s.sourceIcon,srcUrl:n})}),(0,C.jsxs)("div",{style:s.arrowContainer,children:[Fl({iconStyle:s.projectArrow,srcUrl:y().Z.images.externalIntegrations.externalAppToProjectsArrowPng}),Fl({iconStyle:s.taskArrow,srcUrl:y().Z.images.externalIntegrations.externalAppToTasksArrowPng})]}),(0,C.jsxs)("div",{style:s.collectionIconContainer,children:[(0,C.jsxs)("div",{style:s.collectionIcon,children:[Kl(wl().D,n),(0,C.jsx)(_l().Z,{store:t,style:s.title})]}),(0,C.jsxs)("div",{style:s.collectionIcon,children:[Kl(jl().w,n),(0,C.jsx)(_l().Z,{store:o,style:s.title})]})]})]})}function Fl(e){const{iconStyle:t,srcUrl:o,altString:n}=e;return(0,C.jsx)("img",{style:t,src:o,alt:n})}function Rl(e){let{taskCollectionStore:t,collectionSettingsStore:o,isSetupComplete:n,flowId:l,isSyncOwner:a}=e;const c=(0,i().O7)(),d=(0,r().VK)((()=>t.getSchema()),[t]),u=(0,r().VK)((()=>{var e;return null===(e=t.getFormat().sync_state)||void 0===e?void 0:e.syncing}),[t]),p=(0,r().VK)((()=>un().default.state.currentSpaceStore),[]),g=(0,r().VK)((()=>t.getFormat().bot_id),[t]),m=(0,r().VK)((()=>t.getFormat().synced_collection_external_url),[t]),f=(0,r().VK)((()=>(0,Il().lQ)(p)),[p]),y=(0,r().VK)((()=>(0,el().oA)()),[]),S=(0,r().VK)((()=>(0,el().dv)()),[]),h=(0,r().VK)((()=>t.getFormat().synced_collection_instance_type),[t]),x=(0,r().VK)((()=>"DataCenter"===h?"jira-dc":"jira"),[h]),v=(0,r().VK)((()=>(0,el().Eg)()),[])&&!f&&"Cloud"===h||"DataCenter"===h&&(!S||!f&&!y),b=(0,r().VK)((()=>{if(g&&p){const e=W().Qx.createChildStore(p,{table:$r().cZ,id:g,spaceId:p.id});return!e.isDefined()||Boolean(e.getAlive())}return!0}),[g,p]);let w=0;for(const i in d){var j;null!==(j=d[i])&&void 0!==j&&j.derived_property_record_metadata&&w++}let _=Co().Z.formatMessage(Vl.accountDisconnectedTooltip);return Boolean(u)?_=Co().Z.formatMessage(Vl.importInProgressToolTip):v&&(_=Co().Z.formatMessage(Vl.sourceDisabledTooltip)),n?(0,C.jsx)(ee().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"Data synced from Jira",id:"database.viewSettings.collectionSettingsExternalSource.titleStringForSyncedData"}),children:(0,C.jsx)(ro().Z,{disableTooltip:!Boolean(u)&&b&&!v,renderTooltip:e=>(0,C.jsx)("div",{...e,style:ko().F6,children:_}),render:e=>(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(F().Z,{...e,icon:wl().D,disabled:Boolean(u)||!b||v,onClick:()=>{s().H4({collectionSettingsStore:o,item:{type:"externalProjectsSyncSettings",source:"external_list_projects"}}),(0,mt().j)({environment:c,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:x,actionType:"select_projects_cta_click",flowId:l,identifier:m,botId:g,collectionId:t.id,isSyncOwner:a}}})},showChevron:!0,title:(0,C.jsx)(I()._H,{defaultMessage:"Projects",id:"database.viewSettings.collectionSettingsExternalSource.projects"})}),(0,C.jsx)(F().Z,{...e,icon:hr().N,disabled:Boolean(u)||!b||v,onClick:()=>{s().H4({collectionSettingsStore:o,item:{type:"externalProjectsSyncSettings",source:"external_list_task_properties",action:go().K6.SyncAdditionalProperties,selectedProjectKeys:[],projectIssueCounts:{}}}),(0,mt().j)({environment:c,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:x,actionType:"select_properties_cta_click",flowId:l,identifier:m,botId:g,collectionId:t.id,isSyncOwner:a}}})},right:(0,C.jsx)(I()._H,{id:"database.viewSettings.collectionSettingsExternalSource.syncedPropertiesCount",defaultMessage:"{syncedPropertiesCountString}",values:{syncedPropertiesCountString:w.toString()}}),showChevron:!0,title:(0,C.jsx)(I()._H,{defaultMessage:"Task Properties",id:"database.viewSettings.collectionSettingsExternalSource.taskProperties"})})]})})}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(ee().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"Step 1",id:"database.viewSettings.collectionSettingsExternalSource.setupProjects"}),children:(0,C.jsx)("div",{style:{margin:"6px 14px 0px"},children:(0,C.jsx)(X().Z,{style:{width:"100%"},onClick:()=>{s().H4({collectionSettingsStore:o,item:{type:"externalProjectsSyncSettings",source:"external_list_projects"}}),(0,mt().j)({environment:c,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:x,actionType:"select_projects_cta_click",flowId:l,identifier:m,botId:g,collectionId:t.id,isSyncOwner:a}}})},disabled:v,children:(0,C.jsx)(I()._H,{defaultMessage:"Select projects to sync",id:"database.viewSettings.collectionSettingsExternalSource.syncProjectsButton"})})})}),(0,C.jsx)(ee().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"Step 2",id:"database.viewSettings.collectionSettingsExternalSource.setupProperties"}),children:(0,C.jsx)("div",{style:{margin:"6px 14px 0px"},children:(0,C.jsx)(X().Z,{style:{width:"100%"},disabled:!0,children:(0,C.jsx)(I()._H,{defaultMessage:"Select properties to sync",id:"database.viewSettings.collectionSettingsExternalSource.syncPropertiesButton"})})})})]})}function Kl(e,t){const o=(0,i().O7)(),n=(0,r().VK)((()=>"dark"===o.ThemeStore.state.mode),[o]),l=(0,f().yK)((e=>({sourceIcon:{width:10,height:10,padding:2,borderRadius:3,gap:10,position:"absolute",borderColor:e.stroke.primary,borderStyle:"solid",borderWidth:1,right:-3,bottom:-3,boxShadow:"0px 2px 4px 0px #161D1B05",...!n&&{background:`linear-gradient(0deg, ${e.text.contrastPrimary}, ${e.text.contrastPrimary})`},display:"flex",alignItems:"center",justifyContent:"center"},baseIcon:{height:14,width:14,color:e.icon.secondary}})),[n]);return(0,C.jsxs)("div",{style:{position:"relative"},children:[e(l.baseIcon),(0,C.jsx)("div",{style:l.sourceIcon,children:Fl({iconStyle:{height:5,width:5},srcUrl:t})})]})}function Hl(e){const{collectionSettingsStore:t,collectionContextStore:o,tabSettings:{source:n}}=e;if("external_source"===n)return(0,C.jsx)(Zl,{collectionSettingsStore:t,collectionContextStore:o});if("external_list_projects"===n)return(0,C.jsx)(ll,{collectionSettingsStore:t,collectionContextStore:o});if("external_list_task_properties"===n){const{action:n,selectedProjectKeys:i,projectIssueCounts:r}=e.tabSettings;return(0,C.jsx)(Sl,{collectionSettingsStore:t,collectionContextStore:o,action:n,selectedProjectKeys:i,projectIssueCounts:r})}return(0,C.jsx)(C.Fragment,{})}var Ol=()=>o(253335),Ll=()=>o(396439),Dl=()=>o(616433),El=()=>o(889646);const Nl=(0,I().vU)({autoIncrementIdPrefixPlaceholder:{defaultMessage:"Prefix",id:"database.viewSettings.propertyTab.autoIncrementIdPrefixPlaceholder"},duplicatePrefixNameError:{defaultMessage:"{prefixName} isn't available for use.",id:"database.viewSettings.propertyTab.duplicatePrefixNameError"}});function Ul(e){const{uniqueIdProperty:t,prefixValue:o,collectionContextStore:l}=e,a=(0,i().O7)(),s=(0,r().VK)((()=>l.collectionStore()),[l]),[c,u]=(0,n.useState)(o??""),[p,g]=(0,n.useState)(!0),[m,y]=(0,n.useState)(),h=(0,n.useCallback)((()=>{g(!0),y(void 0)}),[g,y]),x=(0,n.useCallback)((e=>{g(!0),y(Co().Z.formatMessage(Nl.duplicatePrefixNameError,{prefixName:`"${e}"`}))}),[]),v=(0,n.useCallback)(((e,t,o)=>{const n=o.collectionStore();n&&(g(!1),ie().callApi({eventName:"setRecordKey",environment:a,data:{spaceId:n.getSpaceId(),table:n.table,key:e,id:n.id}}).then((n=>{g(!0),200!==n.status?x(e):Wt().$q({environment:a,collectionContextStore:o,property:t,from:"view_settings",action:"unique_id_change_collection_key"})})).catch((()=>x(e))))}),[a,x]),b=(0,n.useCallback)((async e=>{if(!s)return!1;const t=await ie().callApi({eventName:"isRecordKeyAvailable",environment:a,data:{spaceId:s.getSpaceId(),table:s.table,key:e.trim()}});return"success"===t.type&&t.data.isAvailable}),[s,a]),w=(0,Rr().v)((e=>{b(e).then((t=>{t||x(e),g(!0)})).catch((()=>x(e)))}),500),[j]=(0,S().r5)((async()=>{if(s)return ie().callApi({eventName:"suggestRecordKey",environment:a,data:{spaceId:s.getSpaceId(),table:qn().vF,id:s.id,shouldSetSuccessfullySuggestedRecord:!1}})}),[s,a]);(0,n.useEffect)((()=>{var e;if(!o&&"resolved"===j.status)return"success"===(null===(e=j.value)||void 0===e?void 0:e.type)&&j.value.data?(y(void 0),void u(j.value.data.key)):void 0}),[o,j]),(0,n.useEffect)((()=>()=>{w.cancel()}),[w]);const _=(0,n.useCallback)((e=>{const t=e.target.value.toUpperCase();u(t),h(),t&&t!==o&&((0,El().k5)(t)||y(Co().Z.formatMessage(El().sY.prefixInvalidError)),g(!1),w(t))}),[h,o,w]),M=(0,n.useCallback)((()=>{w.flush()}),[w]),k=(0,n.useCallback)((e=>{const n=null==s?void 0:s.getRecordKeyStore();e!==o&&!m&&n&&s&&null!=t&&t.propertySchema?v(e,null==t?void 0:t.propertyId,l):g(!0)}),[s,o,m,t,v,l]),P=(0,n.useCallback)((()=>{const e=l.collectionStore();e&&d().createAndCommit({userAction:"CollectionSettingsAutoIncrementIdPropertyCreateNewIdProperty",environment:a,canUndo:!0,perform:t=>{const o=at().G3({environment:a,collectionStore:e,collectionViewArgs:void 0,propertyType:"auto_increment_id",transaction:t});v(c,o,l)}})}),[l,a,c,v]),T=(0,n.useCallback)((e=>{if(!s)return;const t=[{label:(0,C.jsx)(I()._H,{id:"database.viewSettings.propertyTab.autoIncrementIdPrefixSubmit",defaultMessage:"Update ID Prefix"}),color:"red",onAccept:()=>k(e)}];A().vC({message:(0,C.jsx)("span",{children:(0,C.jsx)(I()._H,{id:"database.viewSettings.propertyTab.changePrefixConfirmationMessage",defaultMessage:"Updating the prefix will stop 3rd party automations that rely on this ID (e.g., GitHub PR status automation).",values:{databaseName:(0,C.jsx)(_l().Z,{style:{display:"inline",fontWeight:V().Ue.medium},shouldWrap:!0,store:s})}})}),showCancel:!0,keepFocus:!0,items:t})}),[s,k]),Z=(0,n.useCallback)((e=>{o?T(e):k(e)}),[o,k,T]),B=(0,n.useCallback)((()=>t?t&&!o?(0,C.jsxs)(C.Fragment,{children:[(0,no().R)({width:14,height:14}),(0,C.jsx)(Ll().Z,{size:4}),(0,C.jsx)(I()._H,{defaultMessage:"Add ID prefix",id:"database.viewSettings.propertyTab.autoIncrementIdCreatePrefix"})]}):(0,C.jsx)(I()._H,{defaultMessage:"Update ID Prefix",id:"database.viewSettings.propertyTab.autoIncrementIdPrefixSubmit"}):(0,C.jsxs)(C.Fragment,{children:[(0,no().R)({width:14,height:14}),(0,C.jsx)(Ll().Z,{size:4}),(0,C.jsx)(I()._H,{defaultMessage:"Add ID property",id:"database.viewSettings.propertyTab.autoIncrementIdCreateProperty"})]})),[o,t]),F=(0,f().yK)((e=>({prefixInputOuterStyle:{color:void 0===o?e.lightTextColor:e.regularTextColor}})),[o]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(xo().ZP,{left:(0,C.jsx)(pt().Z,{style:{marginLeft:4,marginRight:7},children:(0,C.jsx)(I()._H,{defaultMessage:"Prefix",id:"database.viewSettings.propertyTab.autoIncrementIdPrefix"})}),value:c,inputOuterStyle:F.prefixInputOuterStyle,onChange:_,onBlur:M,placeholder:Nl.autoIncrementIdPrefixPlaceholder.defaultMessage,onSubmit:()=>Z(c.trim()),focusInitial:!1,selectAll:!1,disabled:!1}),m||!p?(0,C.jsx)(zl,{prefixName:c,hasRequestCompleted:p,errorMessage:m}):(0,C.jsx)(pt().Z,{isSmall:!0,isSecondaryColor:!0,style:{marginTop:16,marginLeft:16},children:(0,C.jsx)(I()._H,{defaultMessage:"{prefixWithHyphen}1, {prefixWithHyphen}2, {prefixWithHyphen}3, ...",id:"database.viewSettings.propertyTab.autoIncrementIdPrefixPreview",values:{prefixWithHyphen:c?`${c}-`:""}})}),(0,C.jsx)(X().Z,{isLarge:!0,style:{margin:"8px 16px",width:"90%"},onClick:()=>{t?Z(c.trim()):P()},disabled:c===o||Boolean(m)||!p,children:B()})]})}function zl(e){const{errorMessage:t,hasRequestCompleted:o}=e;return(0,C.jsx)(pt().Z,{isMultiline:!0,style:{paddingTop:12,marginLeft:16,marginRight:16,...o?{color:tn().ZP.red}:{},...e.styles},isSecondaryColor:!o,children:o&&t?t:(0,C.jsx)("div",{style:{paddingTop:3,paddingBottom:3},children:(0,C.jsx)(Mo().Z,{legacySize:14})})})}o(749411);var Wl=()=>o(38883);const ql={pull_request_review_edited:!0,pull_request_review_submitted:!0,pull_request_review_requested:!0,pull_request_review_request_removed:!0,pull_request_closed:!0,pull_request_opened:!0,pull_request_reopened:!0,pull_request_converted_to_draft:!0,pull_request_edited:!0,pull_request_assigned:!0,pull_request_labeled:!0,pull_request_unlabeled:!0},Gl={pull_request_review_comment_created:!0,issue_comment_created:!0},Yl={installation_deleted:!0,installation_suspend:!0,installation_unsuspend:!0,...ql,...Gl},$l={pull_request_opened:!0,pull_request_review_requested:!0,pull_request_review_submitted:!0,pull_request_closed:!0};(0,N().AO)((e=>{const t=(0,N().Yd)(Yl);return(0,N().DE)(t,e)?{true:e}:{false:e}}));Do().literals(...(0,N().Yd)({pull_request:!0,pull_request_review:!0,pull_request_review_comment:!0,installation:!0,issue_comment:!0})),Do().literals(...(0,N().Yd)(Yl)),Do().literals(...(0,N().Yd)(Gl));var Ql=()=>o(374844),Jl=()=>o(612427),Xl=()=>o(838003),ea=()=>o(470386),ta=()=>o(749854),oa=()=>o(246471),na=()=>o(352230);const ia=14,ra=(0,I().vU)({autoUpdate:{defaultMessage:"Auto-update",id:"collectionSettingsGithubAutomationConfig.statusPicker.autoUpdate"},when:{defaultMessage:"when PR is",id:"collectionSettingsGithubAutomationConfig.statusPicker.when"},addStatusDescription:{defaultMessage:"Add a status property to set up automations.",id:"collectionSettingsGithubAutomationConfig.addStatusDescription"},addStatusButton:{defaultMessage:"Add status property",id:"collectionSettingsGithubAutomationConfig.statusPicker.addStatusButton"},newStatusPropertyButton:{defaultMessage:"New status",id:"collectionSettingsGithubAutomationConfig.statusPicker.newStatusPropertyButton"},pull_request_opened:{defaultMessage:"Opened",id:"collectionSettingsGithubAutomationConfig.pullRequestOpened"},pull_request_review_requested:{defaultMessage:"Review requested",id:"collectionSettingsGithubAutomationConfig.pullRequestReviewRequested"},pull_request_review_submitted:{defaultMessage:"Approved",id:"collectionSettingsGithubAutomationConfig.pullRequestApproved"},pull_request_closed:{defaultMessage:"Merged",id:"collectionSettingsGithubAutomationConfig.pullRequestMerged"},noAutomations:{defaultMessage:"None",id:"collectionSettingsGithubAutomationConfig.noAutomation"},removeStatusOption:{defaultMessage:"Clear",id:"collectionSettingsGithubAutomationConfig.removeStatusOption"},linkBackToggle:{defaultMessage:"Enable Linkbacks to the linked page on GitHub",id:"collectionSettingsGithubAutomationConfig.linkBackToggle"},activityCommentsToggle:{defaultMessage:"Show GitHub activity on the linked page",id:"collectionSettingsGithubAutomationCofnig.activityToggle"}}),la={pull_request_opened:Co().Z.formatMessage(ra.pull_request_opened),pull_request_review_requested:Co().Z.formatMessage(ra.pull_request_review_requested),pull_request_review_submitted:Co().Z.formatMessage(ra.pull_request_review_submitted),pull_request_closed:Co().Z.formatMessage(ra.pull_request_closed)},aa=Co().Z.formatMessage(ra.noAutomations),sa={pull_request_opened:null,pull_request_review_requested:null,pull_request_review_submitted:null,pull_request_closed:null},ca={github_linkbacks:!0,activity_comments:!1};function da(e){const{gitHubProperty:t,selectedStatusProperty:o,setSelectedStatusProperty:l,intl:a}=e,s=(0,i().O7)(),c=(0,gt().Y$)(),u=(0,i().Fy)(),p=ma(),g=(0,Dn().E)("show_github_connected_property_settings"),m=(0,r().VK)((()=>{const e=(0,ht().KV)(c,t);if(e&&(0,go().NK)(e))return e}),[c,t]),f=(0,r().VK)((()=>{const e=c.normalizedSchemaStore.state;return(0,N().qP)(e).flatMap((e=>{let[t,o]=e;return o&&(0,go().gB)(o)?[{id:t,schema:o}]:[]}))}),[c.normalizedSchemaStore]),y=(0,r().VK)((()=>m&&(0,go().NK)(m)&&(0,N().$K)(m.connectedRelation.automationSettings)?m.connectedRelation.automationSettings:ca),[m]);(0,n.useEffect)((()=>{v(y)}),[y]),(0,n.useEffect)((()=>{if(!o&&f.length>0){if(null!=m&&m.connectedRelation.automation)for(const t of f)if(m.connectedRelation.automation[t.id])return void l(t);const e=f[0];l(e)}}),[f,m,o,l]);const[S,h]=(0,n.useState)(sa),[x,v]=(0,n.useState)(ca),b=(0,n.useCallback)((e=>{const n=c.collectionStore();if(!(n&&o&&m&&(0,go().p_)(m)))return;const i=m.connectedRelation;i.automationSettings=e;const r={...m,connectedRelation:{...i}};d().createAndCommit({userAction:"CollectionSettingsConfigureGithubAutomation",environment:s,canUndo:!0,perform:e=>{(0,Jl().x)({environment:s,collectionStore:n,update:{[t]:r},transaction:e})}}),v(e)}),[c,s,t,m,o]);(0,n.useEffect)((()=>{var e,t;o&&m&&(0,go().NK)(m)&&null!==(e=m.connectedRelation.automation)&&void 0!==e&&e[o.id]?h(null===(t=m.connectedRelation.automation)||void 0===t?void 0:t[o.id]):h(sa)}),[m,o]);const w=(0,n.useCallback)((e=>{const n=c.collectionStore();if(!(n&&o&&m&&(0,go().p_)(m)))return;const i=m.connectedRelation;if(!i||!o.id)return;i.automation={...i.automation,...e};const r={...m,connectedRelation:{...i}};Wt().$q({environment:s,collectionContextStore:c,property:o.id,from:"github_pull_requests_property",action:"configure_github_pr_automation",githubAutomationConfigured:e}),d().createAndCommit({userAction:"CollectionSettingsConfigureGithubAutomation",environment:s,canUndo:!0,perform:e=>{(0,Jl().x)({environment:s,collectionStore:n,update:{[t]:r},transaction:e})}})}),[c,o,m,s,t]),j=(0,r().VK)((()=>o&&o.schema.options?o.schema.options:[]),[o]),_=(0,r().VK)((()=>{const e={};return j.forEach((t=>{e[t.id]=t})),e}),[j]),M=(0,r().VK)((()=>{var e,t;const n=null==o||null===(e=o.schema)||void 0===e?void 0:e.groups,i=null==o||null===(t=o.schema)||void 0===t?void 0:t.options;return n&&i?n.map((e=>{const t=i.filter((t=>{var o;return null===(o=e.optionIds)||void 0===o?void 0:o.includes(t.id)}));if(0!==t.length)return{group:e,groupOptions:t}})).filter(N().$K):[]}),[o]);function k(e,t){const n=M.map((t=>{let{group:n,groupOptions:i}=t;const r=i.map((t=>({key:t.id,render:e=>(0,C.jsx)(q().Z,{...e,focused:e.focused,isTokenTitle:!0,title:(0,C.jsx)(oa().F,{format:Wl().lo.Small,value:t.value,color:t.color,showRemoveButton:!1,groupColor:n.color,isSingle:!0})}),action:()=>{const n={...S,[e]:t.id};o&&(w({[o.id]:n}),h(n))}}))).filter(N().$K);return{key:n.name,render:e=>(0,C.jsx)(ee().Z,{...e,title:n.name,topBorder:e.index>0}),items:r}}));if(S[e]){function i(){const n={...S,[e]:null};o&&(w({[o.id]:n}),h(n)),t.close()}const r={key:"removeOptionSection",render:e=>(0,C.jsx)(ee().Z,{...e,topBorder:!0}),items:[{key:"removeOptionButton",render:e=>(0,C.jsx)(q().Z,{...e,focused:!1,title:a.formatMessage(ra.removeStatusOption),left:(0,T().y)({width:12}),onClick:i}),action:e=>{i()}}]};n.push(r)}return n}return o?(0,C.jsxs)(ee().Z,{topBorder:!1,disableDesktopPadding:!0,disableMobilePadding:!0,title:(0,C.jsx)(pa,{selectedStatusProperty:o,setSelectedStatusProperty:l,existingStatusProperties:f,intl:a}),children:[(0,N().Yd)($l).map((e=>(0,C.jsx)(Xl().Z,{focused:!1,placementToOrigin:G().pO.Top,alignmentToOrigin:G().vR.End,popupType:u.isMobile?G().Z4.SlideUp:G().Z4.Popup,render:t=>{const o=u.isMobile?{menuType:na().o.Modal,right:(0,C.jsx)(ea().DoneMenuText,{}),onClickRight:t.close}:{menuType:na().o.Popup,width:150};return(0,C.jsx)($().Z,{...o,children:(0,C.jsx)(Q().ZP,{type:Q().iW.Vertical,sections:k(e,t),initialFocus:void 0,onAccept:t.close})})},renderOrigin:t=>{const n=S[e];let i=(0,C.jsx)("div",{style:p.noneText,children:aa});if(n){const e=_[n];if(e){var r;const t=null==o||null===(r=o.schema)||void 0===r||null===(r=r.groups)||void 0===r||null===(r=r.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(n)})))||void 0===r?void 0:r.color;i=(0,C.jsx)(oa().F,{format:Wl().lo.Small,showRemoveButton:!1,isSingle:!0,value:e.value,color:e.color,groupColor:t})}}return(0,C.jsx)(F().Z,{...t,focused:!1,icon:()=>(0,C.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",justifyContent:"flex-start",whiteSpace:"nowrap"},children:[la[e],(0,C.jsx)(Ll().Z,{size:8}),(0,Ql().n)(p.automationMenuItemArrow)]}),title:(0,C.jsx)("div",{style:{width:"100%",display:"inline-flex",justifyContent:"flex-end"},children:i}),showChevron:!0,chevronStyle:{margin:0}})}},e))),(0,C.jsx)(ut().Z,{size:"100%",innerStyle:{borderColor:p.addStatusDivider.borderColor}}),g&&[{property:"github_linkbacks",setting:(0,C.jsx)(ta().Z,{title:"Linkbacks in GitHub",subtitle:a.formatMessage(ra.linkBackToggle),on:x.github_linkbacks,onChange:()=>{b({...x,github_linkbacks:!x.github_linkbacks})}})},{property:"activity_comments",setting:(0,C.jsx)(ta().Z,{title:"Activity Comments",subtitle:a.formatMessage(ra.activityCommentsToggle),on:x.activity_comments,onChange:()=>b({...x,activity_comments:!x.activity_comments})})}].map((e=>(0,C.jsx)("div",{style:p.otherAutomationsSettings,children:e.setting},e.property)))]}):(0,C.jsx)(ua,{setSelectedStatusProperty:l,intl:a})}function ua(e){const{setSelectedStatusProperty:t,intl:o}=e,n=(0,i().O7)(),r=(0,gt().Y$)(),l=ma();return(0,C.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,C.jsx)(ut().Z,{size:"100%",innerStyle:l.addStatusDivider}),(0,C.jsx)("div",{style:l.addStatusDescription,children:o.formatMessage(ra.addStatusDescription)}),(0,C.jsxs)(X().Z,{style:l.addStatusButton,onClick:e=>{e.stopPropagation(),ga(n,r,t)},children:[(0,no().R)({width:14}),(0,C.jsx)(Ll().Z,{size:4}),o.formatMessage(ra.addStatusButton)]}),(0,C.jsx)(Ll().Z,{size:4})]})}function pa(e){const{selectedStatusProperty:t,setSelectedStatusProperty:o,existingStatusProperties:n,intl:r}=e,l=(0,i().O7)(),a=(0,gt().Y$)(),s=(0,i().Fy)(),c=ma(),d=(0,f().Fg)(),u=n.map((e=>{const{id:t,schema:n}=e;return{key:t,action:()=>{o(e)},render:t=>(0,C.jsx)(q().Z,{...t,icon:(0,C.jsx)(mo().ZP,{size:ia,theme:d,icon:e&&e.schema.icon,type:"status"}),title:n.name})}})).filter(N().$K),p={key:"newStatusProperty",action:()=>{ga(l,a,o)},render:e=>(0,C.jsx)(q().Z,{...e,icon:(0,no().R)(c.statusPickerIcon),title:r.formatMessage(ra.newStatusPropertyButton)})};return(0,C.jsxs)("div",{style:c.statusPickerWrapper,children:[(0,C.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[r.formatMessage(ra.autoUpdate),s.isMobile&&(0,C.jsx)(Ll().Z,{size:4}),(0,C.jsx)(G().ZP,{placementToOrigin:G().pO.Bottom,alignmentToOrigin:G().vR.Start,popupType:s.isMobile?G().Z4.SlideUp:G().Z4.Popup,renderOrigin:e=>(0,C.jsx)(q().Z,{...e,title:t.schema.name,focused:!1,style:c.statusPickerButtonCore,textWrapperStyle:c.statusPickerButtonTextWrapper,left:(0,C.jsx)(mo().ZP,{size:ia,theme:d,icon:t.schema.icon,type:"status"}),leftStyle:{marginLeft:2},showExtensionArrow:!0,extensionArrowStyle:c.statusPickerExtensionArrow}),render:e=>{const t=s.isMobile?{menuType:na().o.ActionSheet}:{menuType:na().o.Popup,width:150};return(0,C.jsx)($().Z,{...t,children:(0,C.jsx)(Q().ZP,{type:Q().iW.Vertical,sections:[{key:0,render:e=>(0,C.jsx)(ee().Z,{...e}),items:[...u,p]}],initialFocus:0,onAccept:e.close})})}})]}),s.isMobile&&(0,C.jsx)(Ll().Z,{size:4}),r.formatMessage(ra.when)]})}function ga(e,t,o){const n=t.collectionStore();n&&d().createAndCommit({userAction:"CollectionSettingsConfigureGithubAutomationCreateNewStatusProperty",environment:e,canUndo:!0,perform:i=>{const r=at().G3({environment:e,collectionStore:n,collectionViewArgs:void 0,propertyType:"status",transaction:i}),l=(0,ht().KV)(t,r);l&&(0,go().gB)(l)&&o({id:r,schema:l})}})}function ma(){const e=(0,i().Fy)().isMobile;return(0,f().yK)((t=>({addStatusDivider:{borderColor:t.tableDividerColor},addStatusDescription:{width:"calc(100% - 24px)",padding:e?"16px 8px":"14px 0px",fontSize:e?16:12,color:t.lightTextColor},addStatusButton:{width:"calc(100% - 24px)",display:"inline-flex",alignItems:"center",justifyContent:"center"},noneText:{color:t.lightTextColor},automationMenuItemArrow:{width:12,fill:t.lightIconColor,stroke:t.lightIconColor,strokeOpacity:.5,strokeWidth:2},statusPickerWrapper:{display:"inline-flex",alignItems:"center",flexWrap:"wrap",rowGap:2,marginBottom:e?10:void 0},statusPickerButtonTextWrapper:{margin:"0px 4px",fontSize:12},statusPickerButtonCore:{minHeight:e?28:20,borderRadius:5,maxWidth:e?150:100},statusPickerIcon:{width:ia,height:ia},statusPickerExtensionArrow:{transform:"rotate(180deg)",marginRight:2},otherAutomationsSettings:{padding:e?"0px 8px":"4px 14px"}})),[e])}var fa=()=>o(675334);const ya=(0,I().vU)({tabTitle:{defaultMessage:"GitHub Pull Requests",id:"database.viewSettings.githubConfigTab.tabTitle"},connect:{defaultMessage:"Connect to GitHub (Workspace)",id:"database.viewSettings.githubConfigTab.connect"},connectDescriptionAdmin:{defaultMessage:"Ask your workspace admin to configure the GitHub (Workspace) connection.",id:"database.viewSettings.githubConfigTab.connectDescriptionAdmin"},authError:{defaultMessage:"Auth failed. Please try again or contact Notion support.",id:"database.viewSettings.githubConfigTab.authError"},tabDescriptionNoIdPrefix:{defaultMessage:"This feature requires a prefixed ID property to link GitHub PRs to Notion {pluralItemName}.",id:"database.viewSettings.githubConfigTab.tabDescriptionNoIdPrefix"},tabDescriptionNoStatus:{defaultMessage:"Link PRs by adding the {singleItemName} ID to the PR title.",id:"database.viewSettings.githubConfigTab.tabDescriptionNoStatus"},tabDescription:{defaultMessage:"Link PRs by adding the {singleItemName} ID to the PR title. Set up automated status updates in Notion based on PR status changes.",id:"database.viewSettings.githubConfigTab.tabDescription"}});function Sa(e){let{collectionContextStore:t,intl:o}=e;const n=_a(),{hoveredBackground:l,pressedBackground:a}=ja(),s=(0,Dl().J)(),c=(0,i().O7)(),d=wa(),u=function(e){return(0,r().VK)((()=>{var t;return null===(t=e.collectionStore())||void 0===t?void 0:t.getSpaceId()}),[e])}(t);return(0,C.jsxs)(ee().Z,{disableMobileBorders:!0,mobileStyle:n.previewContentContainer,style:n.previewContentContainer,children:[(0,C.jsx)("img",{src:"/images/external_integrations/github-icon.png",style:{width:36,height:36}}),(0,C.jsx)("p",{style:n.connectDescription,children:s?(0,Ol().GT)().description:o.formatMessage(ya.connectDescriptionAdmin)}),(0,C.jsx)(_o().D,{style:n.connectButton,hoveredStyle:{background:l},pressedStyle:{background:a},disabled:!s,disabledFeedback:!s,onClick:async e=>{if(e.preventDefault(),u&&d)try{await io().hM({environment:c,spaceId:u,integration:d,from:"connected_relation_property_menu"})}catch(t){const e=o.formatMessage(ya.authError);A().UW(e)}},children:o.formatMessage(ya.connect)}),(0,C.jsx)(Ll().Z,{size:4})]})}function ha(e){let{collectionContextStore:t}=e;const o=_a(),{isMobile:n}=(0,i().Fy)(),r=ba(t);return(0,C.jsxs)(ee().Z,{disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,mobileStyle:o.previewContentContainer,style:o.previewContentContainer,children:[(0,C.jsx)(Ll().Z,{size:n?16:8}),(0,C.jsx)(fa().Z,{width:"calc(100% - 24px)",uniqueIdPrefix:null==r?void 0:r.prefix})]})}function xa(e){let{collectionContextStore:t,intl:o,selectedStatusProperty:n}=e;const i=(0,r().VK)((()=>t.databaseType),[t]),l=ba(t),a=_a(),s=(0,ct().sN)(i),c=(0,ct().Q_)(i);let d;return d=l&&l.prefix?n?o.formatMessage(ya.tabDescription,{singleItemName:s}):o.formatMessage(ya.tabDescriptionNoStatus,{singleItemName:s}):o.formatMessage(ya.tabDescriptionNoIdPrefix,{pluralItemName:c}),(0,C.jsx)(ee().Z,{disableMobileBorders:!0,disableMobilePadding:!0,mobileStyle:a.tabDescription,style:a.tabDescription,children:d})}function va(e){let{collectionContextStore:t}=e;const o=ba(t);return o&&o.prefix?null:(0,C.jsx)(Ul,{collectionContextStore:t,uniqueIdProperty:o&&{propertyId:o.id,propertySchema:o.schema},prefixValue:null==o?void 0:o.prefix})}function Ca(e){let{collectionContextStore:t,selectedStatusProperty:o,setSelectedStatusProperty:n,property:i,intl:r}=e;const l=ba(t);return l&&l.prefix?(0,C.jsx)(da,{selectedStatusProperty:o,setSelectedStatusProperty:n,gitHubProperty:i,intl:r}):null}function ba(e){return(0,r().VK)((()=>{var t,o;const n=null===(t=e.collectionStore())||void 0===t||null===(t=t.getRecordKeyStore())||void 0===t?void 0:t.getRecordKey(),i=null===(o=e.collectionStore())||void 0===o?void 0:o.getSchema(),r=i&&(0,N().qP)(i).find((e=>{let[,t]=e;return t&&"auto_increment_id"===t.type}));if(r){const[e,t]=r;if(t&&"auto_increment_id"===t.type)return{id:e,schema:t,prefix:n}}}),[e])}function wa(){return(0,r().VK)((()=>so().default.integrations.state.find((e=>e.id===Lo().U9))),[])}function ja(){const e=wa(),t=(0,f().Fg)();return(0,r().VK)((()=>mn(e,t.mode)),[e,t.mode])}function _a(){const{isMobile:e}=(0,i().Fy)(),{background:t}=ja();return(0,f().yK)((o=>({previewContentContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},connectButton:{fontSize:14,maxWidth:"calc(100% - 24px)",height:void 0,color:o.regularInvertedTextColor,background:t,whiteSpace:"normal",padding:8,textAlign:"center"},connectDescription:{maxWidth:"calc(100% - 24px)",color:o.lightTextColor,fontSize:14,textAlign:"center"},tabDescription:{padding:e?18:14,fontSize:e?16:12,color:o.lightTextColor}})),[e,t])}const Ma=(0,I().XN)((function(e){const{collectionContextStore:t,property:o,intl:i}=e,[l,a]=(0,n.useState)(void 0);return(0,r().VK)((()=>{const e=so().default.bots.state.find((e=>e.integration_id===Lo().U9));return Boolean(e)}),[])?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(ha,{collectionContextStore:t}),(0,C.jsx)(xa,{collectionContextStore:t,intl:i,selectedStatusProperty:l}),(0,C.jsx)(va,{collectionContextStore:t}),(0,C.jsx)(Ca,{collectionContextStore:t,selectedStatusProperty:l,setSelectedStatusProperty:a,property:o,intl:i})]}):(0,C.jsx)(Sa,{collectionContextStore:t,intl:i})}));var ka=()=>o(532850),Pa=()=>o(429600),Ta=()=>o(44037),Ia=()=>o(989478),Va=()=>o(255393),Aa=()=>o(765458),Za=()=>o(562109),Ba=()=>o(501912),Fa=()=>o(2971),Ra=()=>o(49396),Ka=()=>o(187920),Ha=()=>o(518645),Oa=()=>o(393308);function La(e){let{setAiInference:t,aiInference:o,disabled:i}=e;const r=(0,n.useRef)(Gr().Il()),l=()=>{if(!o)return;const e={...o,add_options:!o.add_options};t(e)};return(0,C.jsx)(ro().Z,{renderTooltip:()=>(0,C.jsx)(I()._H,{id:"collectionSettingsAiAutofillAddOptionsToggle.title.description",defaultMessage:"New options are created based on property name & page details"}),placement:ao().Placement.Bottom,render:e=>(0,C.jsx)(F().Z,{title:(0,C.jsx)(I()._H,{id:"collectionSettingsAiAutofillAddOptionsToggle.title.text",defaultMessage:"Generate new options"}),showChevron:!1,right:(0,C.jsx)(Gt().Z,{inputId:r.current,on:!(null==o||!o.add_options),onClick:l,disabled:!1,noColor:!1}),onClick:l,disabled:Boolean(i),textWrapperStyle:{minWidth:"auto"},...e})})}const Da=n.memo(La);var Ea=()=>o(663631),Na=()=>o(530671),Ua=()=>o(228362),za=()=>o(982855);const Wa=(0,v().IU)("numbers",{viewBox:"0 0 22 12",svg:(0,C.jsx)("path",{d:"M2.91732 11V2.50293H2.80795L0.299156 4.32129V3.02246L2.92416 1.13574H4.14779V11H2.91732ZM6.73438 11V10.1523L10.0703 6.54297C10.4896 6.08724 10.8177 5.71126 11.0547 5.41504C11.2917 5.11426 11.458 4.8431 11.5537 4.60156C11.6494 4.36003 11.6973 4.0957 11.6973 3.80859V3.79492C11.6973 3.44857 11.6221 3.13867 11.4717 2.86523C11.3213 2.5918 11.1071 2.37533 10.8291 2.21582C10.5511 2.05632 10.2184 1.97656 9.83105 1.97656C9.43913 1.97656 9.09505 2.05859 8.79883 2.22266C8.5026 2.38216 8.27246 2.60775 8.1084 2.89941C7.94434 3.18652 7.8623 3.52376 7.8623 3.91113L7.85547 3.9248L6.67969 3.91797L6.66602 3.91113C6.67057 3.3278 6.81185 2.81055 7.08984 2.35938C7.36784 1.90365 7.75065 1.54818 8.23828 1.29297C8.72591 1.0332 9.28418 0.90332 9.91309 0.90332C10.4873 0.90332 11.0046 1.02409 11.4648 1.26562C11.9251 1.5026 12.2874 1.82845 12.5518 2.24316C12.8206 2.65788 12.9551 3.13184 12.9551 3.66504V3.67871C12.9551 4.05241 12.889 4.41243 12.7568 4.75879C12.6292 5.10514 12.4014 5.49023 12.0732 5.91406C11.7451 6.33333 11.2826 6.85059 10.6855 7.46582L8.13574 10.0977L8.44336 9.53027V10.0977L8.14258 9.89258H13.1191V11H6.73438ZM18.276 11.1641C17.597 11.1641 17.0046 11.0479 16.4987 10.8154C15.9928 10.583 15.5918 10.264 15.2956 9.8584C15.0039 9.4528 14.8353 8.99023 14.7897 8.4707L14.7829 8.38867H15.9655L15.9723 8.45703C16.0042 8.7806 16.1182 9.06543 16.3141 9.31152C16.5146 9.55762 16.7812 9.7513 17.1139 9.89258C17.4512 10.0293 17.8385 10.0977 18.276 10.0977C18.709 10.0977 19.0872 10.0225 19.4108 9.87207C19.7389 9.72168 19.9941 9.51432 20.1764 9.25C20.3587 8.98112 20.4499 8.6735 20.4499 8.32715V8.31348C20.4499 7.70736 20.2471 7.24251 19.8415 6.91895C19.4404 6.59082 18.8936 6.42676 18.2008 6.42676H16.9635V5.3877H18.1462C18.5381 5.3877 18.8844 5.31478 19.1852 5.16895C19.486 5.01855 19.7207 4.81576 19.8893 4.56055C20.0579 4.30078 20.1423 4.00684 20.1423 3.67871V3.66504C20.1423 3.31868 20.0693 3.02474 19.9235 2.7832C19.7777 2.54167 19.5635 2.3571 19.2809 2.22949C19.0029 2.10189 18.6634 2.03809 18.2624 2.03809C17.875 2.03809 17.5286 2.10417 17.2233 2.23633C16.9225 2.36393 16.681 2.5485 16.4987 2.79004C16.3164 3.03158 16.207 3.31868 16.1706 3.65137L16.1637 3.71973H14.9811L14.988 3.65137C15.0426 3.11361 15.2113 2.64421 15.4938 2.24316C15.7809 1.84212 16.1592 1.52995 16.6286 1.30664C17.1025 1.08333 17.6471 0.97168 18.2624 0.97168C18.8913 0.97168 19.4381 1.08105 19.903 1.2998C20.3724 1.514 20.7347 1.8125 20.9899 2.19531C21.2497 2.57357 21.3796 3.01335 21.3796 3.51465V3.52832C21.3796 3.93392 21.2907 4.29395 21.113 4.6084C20.9352 4.92285 20.6891 5.1849 20.3747 5.39453C20.0602 5.60417 19.6979 5.75228 19.2878 5.83887V5.86621C20.0078 5.92546 20.5889 6.16927 21.0309 6.59766C21.4775 7.02148 21.7008 7.58431 21.7008 8.28613V8.2998C21.7008 8.84668 21.5527 9.33659 21.2565 9.76953C20.9603 10.2025 20.5547 10.5443 20.0397 10.7949C19.5247 11.041 18.9368 11.1641 18.276 11.1641Z"})}),qa=(0,v().IU)("numbersBold",{viewBox:"0 0 39 19",svg:(0,C.jsx)("path",{d:"M5.05697 18V3.98438H4.96322L0.627281 6.97266V4.19531L5.04525 1.08984H8.03353V18H5.05697ZM11.8711 18V15.9375L17.7656 10.1484C18.5156 9.41406 19.0859 8.80859 19.4766 8.33203C19.8672 7.84766 20.1367 7.41406 20.2852 7.03125C20.4336 6.64844 20.5078 6.25 20.5078 5.83594V5.80078C20.5078 5.29297 20.3906 4.84375 20.1562 4.45312C19.9219 4.0625 19.5938 3.75781 19.1719 3.53906C18.7578 3.3125 18.2734 3.19922 17.7188 3.19922C17.1016 3.19922 16.5547 3.32812 16.0781 3.58594C15.6016 3.83594 15.2266 4.17969 14.9531 4.61719C14.6875 5.04688 14.5508 5.53906 14.543 6.09375L14.5312 6.16406H11.7188L11.707 6.09375C11.707 5.05469 11.9688 4.13672 12.4922 3.33984C13.0234 2.53516 13.7422 1.90625 14.6484 1.45312C15.5547 1 16.582 0.773438 17.7305 0.773438C18.8555 0.773438 19.8477 0.984375 20.707 1.40625C21.5742 1.82031 22.25 2.39453 22.7344 3.12891C23.2266 3.85547 23.4727 4.68359 23.4727 5.61328V5.64844C23.4727 6.30469 23.3516 6.92578 23.1094 7.51172C22.875 8.08984 22.4727 8.72266 21.9023 9.41016C21.332 10.0898 20.5469 10.9141 19.5469 11.8828L14.8477 16.3594L15.8789 14.4961V16.3594L14.8594 15.5273H23.7305V18H11.8711ZM32.0094 18.293C30.7751 18.293 29.6969 18.0898 28.7751 17.6836C27.8532 17.2695 27.1227 16.6992 26.5837 15.9727C26.0446 15.2461 25.736 14.4102 25.6579 13.4648L25.6462 13.3242H28.529L28.5407 13.4414C28.6032 13.9023 28.779 14.3125 29.068 14.6719C29.3649 15.0312 29.7633 15.3164 30.2633 15.5273C30.7633 15.7305 31.3454 15.832 32.0094 15.832C32.6657 15.832 33.236 15.7227 33.7204 15.5039C34.2126 15.2773 34.5915 14.9688 34.8571 14.5781C35.1305 14.1797 35.2673 13.7227 35.2673 13.207V13.1836C35.2673 12.293 34.9587 11.6094 34.3415 11.1328C33.7243 10.6562 32.8766 10.418 31.7985 10.418H29.7946V8.16797H31.7282C32.3532 8.16797 32.8962 8.05859 33.3571 7.83984C33.8258 7.62109 34.1891 7.32422 34.4469 6.94922C34.7048 6.56641 34.8337 6.12891 34.8337 5.63672V5.61328C34.8337 5.09766 34.7204 4.66016 34.4938 4.30078C34.2751 3.94141 33.9508 3.66797 33.5212 3.48047C33.0993 3.28516 32.5876 3.1875 31.986 3.1875C31.3923 3.1875 30.8649 3.28516 30.404 3.48047C29.9508 3.67578 29.5876 3.95312 29.3141 4.3125C29.0407 4.67188 28.8766 5.09766 28.8219 5.58984L28.8102 5.69531H26.0094L26.0212 5.56641C26.1071 4.60547 26.404 3.76953 26.9118 3.05859C27.4274 2.33984 28.1149 1.78516 28.9743 1.39453C29.8415 0.996094 30.8454 0.796875 31.986 0.796875C33.1501 0.796875 34.1618 0.984375 35.0212 1.35938C35.8805 1.72656 36.5446 2.24219 37.0133 2.90625C37.4899 3.5625 37.7282 4.33203 37.7282 5.21484V5.23828C37.7282 5.93359 37.5719 6.55078 37.2594 7.08984C36.9548 7.62109 36.5329 8.0625 35.9938 8.41406C35.4626 8.76562 34.8571 9.01172 34.1774 9.15234V9.21094C35.4274 9.32812 36.4313 9.74219 37.1891 10.4531C37.9469 11.1562 38.3258 12.0938 38.3258 13.2656V13.2891C38.3258 14.2656 38.0602 15.1328 37.529 15.8906C36.9977 16.6484 36.2555 17.2383 35.3024 17.6602C34.3571 18.082 33.2594 18.293 32.0094 18.293Z"})});var Ga=()=>o(411094),Ya=()=>o(356117),$a=()=>o(162178);function Qa(){const{layoutStore:e,currentModuleSelection:t,collectionStore:n}=(0,$a().J9)(),i=(0,r().VK)((()=>{if("existing_module"===(null==t?void 0:t.type))return e.getModuleById(t.moduleId)}),[t,e]),l=(0,r().VK)((()=>{if((0,o(639708).f)(i))return null==n?void 0:n.getSchemaStore().getKeyStore(i.propertyId).getValue()}),[n,i]);if(!i||!l)return null;switch(i.type){case"property_person":case"property_created_by":case"property_last_edited_by":return(0,C.jsx)(ts,{module:i,options:Ja,heightVariant:"tall"});case"property_formula":return(0,o(834458).isNumberFormulaPropertySchema)(l)?(0,C.jsx)(ts,{module:i,options:es,heightVariant:"short"}):null;case"property_number":return(0,C.jsx)(ts,{module:i,options:es,heightVariant:"short"});case"property_file":return(0,C.jsx)(ts,{module:i,options:Xa,heightVariant:"short"});default:return null}}const Ja={available:["large","compact"],appearance:{compact:{label:(0,C.jsx)(I()._H,{id:"PropertyTypeSpecificModuleConfiguration.person.display.compact",defaultMessage:"Compact"}),image:{src:y().Z.images.layouts.configuration.personCompactPng,width:100,height:41}},large:{label:(0,C.jsx)(I()._H,{id:"PropertyTypeSpecificModuleConfiguration.person.display.large",defaultMessage:"Large"}),image:{src:y().Z.images.layouts.configuration.personMediumPng,width:82,height:56}}}},Xa={available:["landscape","portrait","square"],appearance:{landscape:{label:(0,C.jsx)(I()._H,{id:"PropertyTypeSpecificModuleConfiguration.file.display.landscape",defaultMessage:"Landscape"}),image:{src:y().Z.images.layouts.configuration.fileLandscapePng,width:192,height:128}},portrait:{label:(0,C.jsx)(I()._H,{id:"PropertyTypeSpecificModuleConfiguration.file.display.portrait",defaultMessage:"Portrait"}),image:{src:y().Z.images.layouts.configuration.filePortraitPng,width:192,height:128}},square:{label:(0,C.jsx)(I()._H,{id:"PropertyTypeSpecificModuleConfiguration.file.display.square",defaultMessage:"Square"}),image:{src:y().Z.images.layouts.configuration.fileSquarePng,width:192,height:128}}}},es={available:["large","small"],appearance:{large:{label:(0,C.jsx)(I()._H,{id:"PropertyTypeSpecificModuleConfiguration.number.display.large",defaultMessage:"Large"}),icon:{function:qa,size:42}},small:{label:(0,C.jsx)(I()._H,{id:"PropertyTypeSpecificModuleConfiguration.number.display.small",defaultMessage:"Small"}),icon:{function:Wa,size:22}}}};function ts(e){let{module:t,options:o,heightVariant:r}=e;const l=(0,i().O7)(),{layoutStore:a}=(0,$a().J9)(),s=(0,n.useCallback)((e=>{const o=a.getModel(),n=null==o?void 0:o.getPageModuleAreaById(t.id);if(!n||!o)return;const i={...t,style:e};d().createAndCommit({environment:l,perform(e){(0,Ya().Uq)({environment:l,transaction:e,layoutStore:a,position:{area:n,moduleId:i.id},updatedModule:i})},canUndo:!0,userAction:"BuilderLayoutModules.setDisplayStyle"})}),[l,a,t]),c=(0,f().yK)((e=>({container:{margin:"10px 8px"},label:{fontSize:V().JB.UISmall.desktop,fontWeight:V().Ue.medium,margin:"0px 8px 6px 8px",color:e.text.secondary}})),[]);return(0,C.jsxs)("div",{style:c.container,children:[(0,C.jsx)("p",{style:c.label,children:(0,C.jsx)(I()._H,{id:"PropertyTypeSpecificModuleConfiguration.person.display.title",defaultMessage:"Style"})}),(0,C.jsx)(Ga().Z,{disabled:!1,options:o,selectedOption:t.style,onOptionSelected:s,height:r})]})}var os=()=>o(890324),ns=()=>o(897257),is=()=>o(803021),rs=()=>o(963979);function ls(e){let{collectionContextStore:t,property:o}=e;const n=(0,I().YB)(),l=(0,i().O7)(),a=(0,r().VK)((()=>as(t,o)),[t,o]),s=(0,r().VK)((()=>t.getPropertyFormat(o)),[t,o]);if(!a)return null;const c=(null==s?void 0:s.date_format)||a.date_format||is().sF,u=function(e){const t=ss();for(const o in t)if(t[o]===e)return o;return"12h"}((null==s?void 0:s.time_format)||a.time_format||is().c_);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(vt().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"Date format",id:"database.viewSettings.dateOptions.dateFormat"}),selectedKey:c,popupStyle:{minWidth:190},options:is().Zy.map((e=>({key:e,type:"button",title:n.formatMessage(is().fy[e])}))),onChange:e=>function(e,t,o,n){const i="collectionTypedView"===o.contextType;if(i){const i=o.formatStore();if(!i)return;const r=o.getPropertyFormatKey();if(!r)return;d().createAndCommit({userAction:"CollectionSettingsDateOptions.handleMsvDateFormatChange",environment:t,canUndo:!0,perform:t=>{at().er({formatStore:i,formatKey:r,property:n,update:{date_format:e},transaction:t})}})}else{const i=o.collectionStore(),r=as(o,n);if(!i||!r)return;const l={...r,date_format:e};d().createAndCommit({userAction:"CollectionSettingsDateOptions.handleDateFormatChange",environment:t,canUndo:!0,perform:e=>{(0,Jl().x)({environment:t,collectionStore:i,update:{[n]:l},transaction:e})}})}Wt().$q({environment:t,collectionContextStore:o,property:n,from:"view_settings",action:"date_change_format"})}(e,l,t,o)}),(0,C.jsx)(vt().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"Time format",id:"database.viewSettings.dateOptions.timeFormat"}),selectedKey:u,popupStyle:{minWidth:190},options:is().L7.map((e=>({key:e,type:"button",title:n.formatMessage(is().Fi[e])}))),onChange:e=>function(e,t,o,n){const i=ss()[e],r="collectionTypedView"===o.contextType;if(r){const e=o.formatStore();if(!e)return;const r=o.getPropertyFormatKey();if(!r)return;d().createAndCommit({userAction:"CollectionSettingsDateOptions.handleMsvClockFormatChange",environment:t,canUndo:!0,perform:t=>{at().er({formatStore:e,formatKey:r,property:n,update:{time_format:i},transaction:t})}})}else{const e=o.collectionStore(),r=as(o,n);if(!e||!r)return;const l={...r,time_format:i};d().createAndCommit({userAction:"CollectionSettingsDateOptions.handleClockFormatChange",environment:t,canUndo:!0,perform:o=>{(0,Jl().x)({environment:t,collectionStore:e,update:{[n]:l},transaction:o})}})}Wt().$q({environment:t,collectionContextStore:o,property:n,from:"view_settings",action:"date_change_time_format"})}(e,l,t,o)})]})}function as(e,t){const o=e.normalizedSchemaStore.state[t];if(o)return"date"===o.type||"created_time"===o.type||"last_edited_time"===o.type||"last_visited_time"===o.type?o:void 0}function ss(){return(0,rs().E)(vl().locale).time}var cs=()=>o(730388);function ds(e){const{collectionContextStore:t,property:o,propertySchema:r}=e,l=(0,i().O7)(),a=(0,n.useCallback)((e=>{const n={...r,default:"created_by"===e?"created_by":void 0},i=t.collectionStore();i&&((0,Ka().H)({environment:l,collectionStore:i,performTransaction:t=>{d().applyOperation({store:(0,W().Kv)(i,i.pointer),operation:{pointer:i.pointer,command:"update",path:["schema",o],args:{default:e}},transaction:t})}}),d().createAndCommit({userAction:"CollectionSettingsDefaultPersonPicker.handleChange",environment:l,canUndo:!0,perform:e=>{(0,Jl().x)({environment:l,collectionStore:i,update:{[o]:n},transaction:e})}}))}),[t,l,o,r]);return(0,C.jsx)(vt().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"Default",id:"CollectionSettingsDefaultPersonPicker.default.title"}),selectedKey:r.default?"created_by":"no_default",popupStyle:{minWidth:190},options:[{key:"no_default",type:"button",title:(0,C.jsx)(I()._H,{defaultMessage:"No default",id:"CollectionSettingsDefaultPersonPicker.options.noDefault"})},{key:"created_by",type:"button",title:(0,C.jsx)(I()._H,{defaultMessage:"Created by",id:"CollectionSettingsDefaultPersonPicker.options.creator"}),icon:(0,cs().f)({width:16})}],onChange:a})}function us(e){let{collectionContextStore:t,collectionSettingsStore:l,property:a}=e;const s=(0,i().O7)(),c=(0,r().qz)(void 0,xt().Z),u=(0,n.useCallback)((e=>{const n=t.collectionStore();if(!n)return null;const i=t.normalizedSchemaStore.state[a];if("formula"!==(null==i?void 0:i.type))return;const r=Boolean(n.getDatabaseType()&&n.isTypedProperty(a)),c=null==l?void 0:l.getState().fromBlockStore;return(0,C.jsx)(Ke().ev,{dependency:o(141735).F.formulas,children:t=>(0,C.jsx)(o(8225).Z,{handleClose:e.close,property:a,getRecordModel:n.getRecordModel,propertySchema:i,collectionStore:n,handleSave:e=>function(e,t){const{newValue:o,newType:n,propertySchema:i,property:r,collectionStore:l}=e,a=o?{...i,formula2:{code:o,result_type:n},version:"v2"}:{...i,formula2:void 0,version:"v2"};d().createAndCommit({userAction:"CollectionSettingsFormulaOptions.handleFormulaChange",environment:t,canUndo:!0,perform:e=>{(0,Jl().x)({environment:t,collectionStore:l,update:{[r]:a},transaction:e})}})}(e,s),formulas:t,disabled:r,blockStore:c,analyticsFrom:"view_settings"})})}),[t,l,s,a]);return(0,C.jsx)(G().ZP,{popupType:s.device.isMobile?J().kQ.SlideUp:J().kQ.Popup,alignmentToOrigin:G().vR.End,renderOrigin:e=>(0,C.jsx)(F().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"Edit formula",id:"database.viewSettings.formulaOptions.title"}),showChevron:!0,rotateChevron:c.state.open,...e}),render:u,buttonPopupStore:c})}const ps=n.memo(us,ni().Z);function gs(e,t,o){return"1"===e?"relation"===t?o&&!0===o?(0,C.jsx)(I()._H,{defaultMessage:"1 item",id:"database.viewSettings.collectionPropertyLimitHelpers.limitOne.connectedRelation"}):(0,C.jsx)(I()._H,{defaultMessage:"1 page",id:"database.viewSettings.collectionPropertyLimitHelpers.limitOne.relation"}):(0,C.jsx)(I()._H,{defaultMessage:"1 {type}",id:"database.viewSettings.collectionPropertyLimitHelpers.limitOne",values:{type:Kn().SO[t]}}):"no_limit"===e?(0,C.jsx)(I()._H,{defaultMessage:"No limit",id:"database.viewSettings.collectionPropertyLimitHelpers.noLimit"}):void 0}function ms(e,t,o){return{key:e,type:"button",title:gs(e,t,o)}}function fs(e){const{property:t,propertySchema:o,collectionContextStore:r}=e,l=(0,i().O7)(),a=(0,n.useCallback)((e=>{const n=r.collectionStore();if(!n||!(0,go().en)(o))return;const i={...o,limit:Number(e)?1:void 0};d().createAndCommit({userAction:"CollectionSettingsLimitOptions.handleLimitChange",environment:l,canUndo:!0,perform:e=>{(0,Jl().x)({environment:l,collectionStore:n,update:{[t]:i},transaction:e})}});const a=Number(e)?`${o.type}_toggle_limit_on`:`${o.type}_toggle_limit_off`;Wt().$q({environment:l,collectionContextStore:r,property:t,from:"view_settings",action:a})}),[r,l,t,o]);return(0,go().en)(o)?"relation"===o.type&&o.connectedRelation?(0,C.jsx)(ys,{propertyType:o.type,connectedRelation:!0,selectedKey:o.limit?"1":"no_limit",onChange:a}):(0,C.jsx)(ys,{propertyType:o.type,selectedKey:o.limit?"1":"no_limit",onChange:a}):null}function ys(e){const{propertyType:t,selectedKey:o,connectedRelation:n,onChange:i}=e;return(0,C.jsx)(vt().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"Limit",id:"database.viewSettings.collectionPropertyLimitHelpers.limit"}),selectedKey:o,popupStyle:{minWidth:190},options:[ms("1",t,n),ms("no_limit",t)],onChange:i})}var Ss=()=>o(910007),hs=()=>o(475692),xs=()=>o(417823),vs=()=>o(524052);const Cs=(0,I().vU)({linkPreviewDescription:{defaultMessage:"Salesforce URLs will be auto-converted as a Salesforce property with live preview on hover.",id:"database.viewSettings.salesforceConfigTab.linkPreviewDescription"}});function bs(){const e=js(),t=(0,I().YB)();return(0,C.jsxs)(ee().Z,{disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,mobileStyle:e.previewContentContainer,children:[(0,C.jsxs)("div",{style:e.tabDescription,children:[" ","Preview"]}),(0,C.jsx)("div",{children:(0,C.jsx)("img",{src:y().Z.images.externalIntegrations.salesforceLinkpreviewPng,style:e.previewContentContainer})}),(0,C.jsx)("div",{style:e.tabDescription,children:t.formatMessage(Cs.linkPreviewDescription)})]})}function ws(e){let{collectionContextStore:t,property:o,connectedRelationPatternName:n,integrationId:i,propertySchema:r,environment:l}=e;const a=js(),c=t.settingsStore;return(0,C.jsxs)(ee().Z,{disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,mobileStyle:a.previewContentContainer,children:[(0,C.jsxs)("div",{style:a.tabDescription,children:[" ","Database actions"]}),(0,C.jsx)(F().Z,{showChevron:!0,title:"Add properties",icon:hr().N,onClick:()=>{(0,mt().j)({environment:l,event:{eventName:"salesforce_actions",eventProperties:{actionType:"add_properties_clicked",integrationId:i}}}),s().H4({collectionSettingsStore:c,item:{type:"connectedRelationDatabaseActions",source:"connectedRelationAddProperties",rootPropertyId:o,connectedRelationPatternName:n,integrationId:i,rootPropertySchema:r}})}}),(0,C.jsx)(F().Z,{showChevron:!0,title:"Copy URL",icon:vs().U,onClick:()=>{s().H4({collectionSettingsStore:c,item:{type:"connectedRelationDatabaseActions",source:"connectedRelationCopyUrl",rootPropertyId:o,connectedRelationPatternName:n,integrationId:i,rootPropertySchema:r}})}})]})}function js(){const{isMobile:e}=(0,i().Fy)();return(0,f().yK)((t=>({addDivider:{borderColor:t.tableDividerColor},previewContentContainer:{display:"flex",alignSelf:"center",flexDirection:"column",width:"100%",paddingLeft:10,paddingRight:10,cursor:"default"},tabDescription:{padding:e?18:10,fontSize:e?16:12,color:t.lightTextColor}})),[e])}const _s=function(e){const{collectionContextStore:t,property:o,connectedRelationPatternName:n,integrationId:i,propertySchema:r,environment:l}=e,a=js();return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(bs,{}),(0,C.jsx)(ut().Z,{size:"100%",innerStyle:{borderColor:a.addDivider.borderColor}}),(0,C.jsx)(ws,{collectionContextStore:t,property:o,connectedRelationPatternName:n,integrationId:i,propertySchema:r,environment:l})]})};var Ms=()=>o(917881),ks=()=>o(933868),Ps=()=>o(173113),Ts=()=>o(499829);function Is(e){const{temporaryAutoRelateState:t,handleAutoRelateToggle:o,collectionStore:n,targetCollectionStore:l,autoRelate:a}=e,s=(0,i().Fy)(),c=(0,r().VK)((()=>(null==n?void 0:n.getFormat().bot_id)||l.getFormat().bot_id),[n,l]),d=(0,r().VK)((()=>!!c),[c]),u=(0,f().yK)((e=>({errorLabel:{margin:"0px 14px",color:e.errorText},helpIcon:{width:16,fill:e.lightIconColor,marginLeft:6}})),[]),p=(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center",whiteSpace:"pre"},children:[(0,C.jsx)(I()._H,{defaultMessage:"Automatically Relate",id:"database.viewSettings.setupRelationTab.autoRelate.title"}),!s.isMobile&&(0,C.jsx)(ro().Z,{render:e=>(0,C.jsx)("div",{...e,children:(0,_().m)(u.helpIcon)}),style:{width:200},placement:ao().Placement.Bottom,textWrap:!0,renderTooltip:()=>(0,C.jsx)(I()._H,{defaultMessage:"Relations will automatically populate based on links found in page properties.",id:"database.viewSettings.setupRelationTab.autoRelateTooltip"})})]});return d?(0,C.jsx)(te().Z,{title:p,on:t?t.enabled:!!a&&(null==a?void 0:a.enabled),focused:!1,onClick:()=>o(c),textWrapperStyle:{opacity:1}}):null}function Vs(e){const{collectionContextStore:t,property:o,targetCollectionStore:l,temporaryInverseState:a,setTemporaryInverseState:s,mode:c="edit",onSubmit:d,shouldEnforceTwoWayRelation:u}=e,p=(0,i().O7)(),g=(0,i().Fy)(),m=(0,I().YB)(),y=(0,r().qz)(void 0,xt().Z),S=(0,r().VK)((()=>o?ht().KV(t,o):void 0),[t,o]),h=(0,Ps().a)(S),x=(0,r().VK)((()=>t.collectionStore()),[t]),v=(0,r().VK)((()=>t.contextType),[t]),b=Boolean((null==x?void 0:x.id)===l.id),w=(0,r().VK)((()=>Boolean(o?ht().OP(t,o,l):void 0)),[t,o,l]),j=(0,r().VK)((()=>{if("relation"!==(null==S?void 0:S.type))return"";const e=S.property;if(!e||e===o)return"";const t=l.getRole();if(!t||!ks().YX(t))return"";const n=l.getSchema()[e];return(null==n?void 0:n.name)||""}),[l,o,S]),M=(0,r().VK)((()=>"relation"===(null==S?void 0:S.type)&&S.autoRelate?S.autoRelate:{enabled:!1}),[S]),k=(0,r().VK)((()=>Boolean(ht().gZ(l))),[l]),P=(0,r().VK)((()=>Boolean((null==x?void 0:x.getDatabaseType())&&o&&(null==x?void 0:x.isTypedProperty(o)))),[x,o]),T=(0,n.useMemo)((()=>a?a.hasInverseRelation:w),[a,w]),V=(0,n.useMemo)((()=>a?a.inverseName:j),[a,j]),A=(0,n.useMemo)((()=>a?a.autoRelate:M),[a,M]),Z=(0,n.useCallback)((()=>{o&&Wt().$q({environment:p,collectionContextStore:t,property:o,from:"collectionPage"===v?"page_properties":"view_settings",action:T?"relation_toggle_inverse_off":"relation_toggle_inverse_on",is_self_relation:b})}),[o,t,p,v,b,T]),B=(0,n.useCallback)((()=>null!=x&&x.isSyncedCollection()?A:T?{enabled:!1}:A),[x,A,T]),R=(0,n.useCallback)((()=>{s({hasInverseRelation:!0,inverseName:V,autoRelate:B()}),Z()}),[s,V,Z,B]),K=(0,n.useCallback)((()=>{s({hasInverseRelation:!1,inverseName:void 0,autoRelate:B()}),Z()}),[s,Z,B]),H=Boolean(h||!k||P||u),O=(0,n.useCallback)((e=>{s({hasInverseRelation:!0,inverseName:e.target.value,autoRelate:A})}),[s,A]),L=(0,n.useCallback)((e=>{const n=null!=A&&A.enabled?{enabled:!1}:{enabled:!0,bot_id:e};s({hasInverseRelation:T,inverseName:V,autoRelate:n}),o&&Wt().$q({environment:p,collectionContextStore:t,property:o,from:"collectionPage"===v?"page_properties":"view_settings",action:n.enabled?"auto_relation_toggle_on":"auto_relation_toggle_off"})}),[o,s,t,v,V,T,A,p]),D=(0,n.useCallback)((e=>{(0,We().ZP)({event:e,context:We().Af.CollectionSettingsClick,callback:d})}),[d]),E=(0,f().yK)((e=>({container:{width:g.isMobile?"100%":250,paddingBottom:g.isMobile?16:8,paddingLeft:g.isMobile?8:4,paddingRight:g.isMobile?8:4,marginTop:8},errorLabel:{margin:"0px 14px",color:e.errorText},helpIcon:{width:16,fill:e.lightIconColor,marginLeft:6},modalTitleStyle:{fontSize:16,fontWeight:600,lineHeight:1.2,color:e.regularTextColor,marginTop:8,whiteSpace:"normal",marginLeft:14,marginRight:14},disabled:{opacity:.5,pointerEvents:"none"}})),[g]),N=(0,r().qz)(void 0,Ts().Z),U=(0,r().VK)((()=>N.state.hovered||N.state.focused),[N]),z=(0,n.useMemo)((()=>!k||P?m.formatMessage(Bs.errors.cannotEditTargetDatabase):b?m.formatMessage(Bs.tooltips.selfRelationInverseTooltip):m.formatMessage(Bs.tooltips.inverseRelationTooltip,{databaseName:(0,C.jsx)(_l().Z,{shouldWrap:!0,style:{display:"inline"},store:l})})),[k,P,m,b,l]),W=(0,n.useMemo)((()=>(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center",whiteSpace:"pre"},children:[m.formatMessage(Bs.generic.title),!g.isMobile&&(0,C.jsx)(ro().Z,{placement:ao().Placement.Bottom,textWrap:!0,style:{width:200},store:N,render:e=>(0,C.jsx)("div",{...e,children:(0,_().m)(E.helpIcon)}),renderTooltip:()=>z})]})),[m,g.isMobile,E.helpIcon,z,N]);return x?(0,C.jsxs)(C.Fragment,{children:["create"===c&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(As,{currentInverseState:T,disableInverseRelation:K,enableInverseRelation:R,handleAutoRelateToggle:L,temporaryInverseState:a,collectionStore:x,targetCollectionStore:l,isTwoWayToggleDisabled:H,isNameDisabled:H,menuTitle:W,autoRelate:M,isSelfRelation:b,inverseRelationName:j,handleInverseNameChange:O}),(0,C.jsx)(X().Z,{style:{display:"flex",margin:"6px 12px 0px 12px"},onClick:D,children:m.formatMessage(Bs.create.addRelation)})]}),"edit"===c&&(0,C.jsx)(Xl().Z,{focused:!1,disabled:H,popupType:g.isMobile?G().Z4.SlideUp:G().Z4.Popup,alignmentToOrigin:G().vR.End,placementToOrigin:G().pO.Bottom,isFullWidthOnMobile:!0,buttonPopupStore:y,onClose:d,renderOrigin:e=>(0,C.jsx)(ro().Z,{placement:ao().Placement.Bottom,textWrap:!0,style:{width:200},forceVisibleState:!U&&void 0,disableTooltip:!h,render:t=>(0,C.jsx)("div",{...t,children:(0,C.jsx)(F().Z,{...e,showChevron:!0,rotateChevron:y.state.open,title:W,disabled:H,right:T?m.formatMessage(Bs.generic.on):m.formatMessage(Bs.generic.off)})}),renderTooltip:()=>h&&m.formatMessage(Bs.tooltips.disabledTwoWayRelationTooltip)}),render:e=>(0,C.jsxs)("div",{style:E.container,children:[(0,C.jsx)(te().Z,{textWrapperStyle:{overflow:"hidden",display:"inline-flex"},focused:!1,disabled:H,on:T,title:m.formatMessage(Bs.edit.enable),titleStyle:{display:"inline-flex"},onClick:e=>{T?K():R()}}),(0,C.jsxs)("div",{style:T?void 0:E.disabled,children:[(0,C.jsx)(Is,{handleAutoRelateToggle:L,temporaryAutoRelateState:null==a?void 0:a.autoRelate,collectionStore:x,autoRelate:M,targetCollectionStore:l}),(0,C.jsx)(Zs,{collectionStore:x,targetCollectionStore:l,isSelfRelation:b,temporaryInverseState:a,inverseRelationName:j,disabled:H,onChange:O,title:(0,C.jsx)(pt().Z,{isSecondaryColor:!0,isSmall:!0,children:m.formatMessage(Bs.edit.propertyNameLabel)})})]})]})})]}):null}function As(e){const{currentInverseState:t,disableInverseRelation:o,enableInverseRelation:n,handleAutoRelateToggle:i,temporaryInverseState:r,collectionStore:l,targetCollectionStore:a,isTwoWayToggleDisabled:s,isNameDisabled:c,menuTitle:d,autoRelate:u,isSelfRelation:p,inverseRelationName:g,handleInverseNameChange:m}=e,f=(0,I().YB)();return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(te().Z,{textWrapperStyle:{overflow:"hidden",display:"inline-flex"},focused:!1,on:t,disabled:s,title:d,titleStyle:{display:"inline-flex"},onClick:()=>{t?o():n()}}),t&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Is,{handleAutoRelateToggle:i,temporaryAutoRelateState:null==r?void 0:r.autoRelate,collectionStore:l,autoRelate:u,targetCollectionStore:a}),(0,C.jsx)(Zs,{collectionStore:l,targetCollectionStore:a,isSelfRelation:p,temporaryInverseState:r,inverseRelationName:g,disabled:c,onChange:m,title:(0,C.jsx)(pt().Z,{isSmall:!0,isSecondaryColor:!0,children:p?f.formatMessage(Bs.create.selfRelationPropertyNameHeader):f.formatMessage(Bs.create.relationPropertyNameHeader)})})]})]})}function Zs(e){const{collectionStore:t,targetCollectionStore:o,isSelfRelation:n,temporaryInverseState:i,inverseRelationName:l,disabled:a,onChange:s,title:c}=e,d=(0,I().YB)(),u=(0,r().VK)((()=>null!=t&&t.isDefined()?ht().aI(d,{sourceCollection:t.getModel(),isSelfRelation:n,targetCollectionStore:o,createUnique:!0}):d.formatMessage(Bs.placeholders.relatedToTarget)),[t,d,n,o]);return(0,C.jsx)(ee().Z,{title:c,noTextOverflow:!0,children:(0,C.jsx)(xo().ZP,{value:(null==i?void 0:i.inverseName)||l,placeholder:u,onChange:s,onBlur:fi().yR,onSubmit:fi().yR,focusInitial:!0,selectAll:!1,disabled:a})})}const Bs={generic:(0,I().vU)({on:{id:"database.viewSettings.setupRelationTab.generic.on",defaultMessage:"On"},off:{id:"database.viewSettings.setupRelationTab.generic.off",defaultMessage:"Off"},title:{id:"database.viewSettings.setupRelationTab.generic.title",defaultMessage:"Two-way relation"}}),create:(0,I().vU)({addRelation:{id:"database.viewSettings.setupRelationTab.create.relation.add",defaultMessage:"Add relation"},addRelationInverse:{id:"database.viewSettings.setupRelationTab.create.relation.inverse.add",defaultMessage:"Show on {databaseName}"},addSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.addSelfRelationInverse",defaultMessage:"Separate directions {icon}"},relationPropertyNameHeader:{id:"database.viewSettings.setupRelationTab.create.relation.inverse.propertyNameHeader",defaultMessage:"Related property name"},selfRelationPropertyNameHeader:{id:"database.viewSettings.setupRelationTab.create.selfRelation.inverse.propertyNameHeader",defaultMessage:"Inverse related property name"}}),edit:(0,I().vU)({modalTitle:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.modalTitle",defaultMessage:"Related property settings"},enable:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.enable",defaultMessage:"Enable"},propertyNameLabel:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.propertyNameLabel",defaultMessage:"Related property name"},addRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.add",defaultMessage:"Show on {databaseName}"},editRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.edit",defaultMessage:"Edit relation on {databaseName}"},saveRelationInverse:{id:"database.viewSettings.setupRelationTab.relation.inverse.save",defaultMessage:"Save"},removeRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.remove",defaultMessage:"Remove property"},addSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.selfRelation.inverse.add",defaultMessage:"Add inverse property"},editSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.selfRelation.inverse.edit",defaultMessage:"Edit inverse property"},renameSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.selfRelation.inverse.rename",defaultMessage:"Rename"},saveSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.selfRelation.inverse.save",defaultMessage:"Save"},removeSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.selfRelation.inverse.remove",defaultMessage:"Remove property"}}),tooltips:(0,I().vU)({inverseRelationTooltip:{id:"database.viewSettings.setupRelationTab.relation.inverse.tooltip",defaultMessage:"Manage property on {databaseName} showing backlinks to the current database"},selfRelationInverseTooltip:{id:"database.viewSettings.setupRelationTab.selfRelation.inverse.tooltip",defaultMessage:"Manage separate properties for each direction of a two-way relation. Useful for modeling Parent task/Sub-tasks, Blocked by/Blocking, and more."},disabledTwoWayRelationTooltip:{id:"database.viewSettings.setupRelationTab.relation.inverse.disabled.tooltip",defaultMessage:"Two-way relations cannot be enabled when share settings are inherited through this relation."}}),errors:(0,I().vU)({cannotEditTargetDatabase:{id:"database.viewSettings.setupRelationTab.inverseDisabledWarning.title",defaultMessage:"Cannot edit target database."}}),placeholders:(0,I().vU)({relatedToTarget:{id:"database.viewSettings.setupRelationTab.relation.inverse.placeholder",defaultMessage:"Related to target"}})};function Fs(e){const{collectionContextStore:t,property:o,targetCollectionStore:l}=e,a=(0,i().O7)(),s=(0,I().YB)(),c=(0,r().VK)((()=>t.collectionStore()),[t]),u=(0,r().VK)((()=>t.contextType),[t]),[p,g]=(0,n.useState)(void 0),m=Boolean(l&&(null==c?void 0:c.id)===l.id),f=(0,n.useCallback)((()=>{if(!p)return;const{hasInverseRelation:e,inverseName:n,autoRelate:i}=p;d().createAndCommit({userAction:"CollectionSettingsRelationOptions.handleEditRelation",environment:a,canUndo:!0,perform:r=>{Ms().gy({environment:a,collectionContextStore:t,property:o,hasInverseRelation:e,inverseName:n,autoRelate:i,intl:s,transaction:r})}}),Wt().$q({environment:a,collectionContextStore:t,property:o,from:"collectionPage"===u?"page_properties":"view_settings",action:"relation_edit",is_self_relation:m,has_inverse:e,auto_relate:null==i?void 0:i.enabled}),g(void 0)}),[p,a,t,o,u,m,s]);return(0,C.jsx)(Vs,{collectionContextStore:t,targetCollectionStore:l,property:o,temporaryInverseState:p,setTemporaryInverseState:g,onSubmit:f})}const Rs=(0,v().IU)("linkedRelationDark",{viewBox:"0 0 36 32",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("path",{fill:"#fff",d:"M3.5 5.5a2 2 0 100-4 2 2 0 000 4zm0 1.5a3.5 3.5 0 100-7 3.5 3.5 0 000 7zM8 3a.5.5 0 000 1h6.313a2.5 2.5 0 012.5 2.5v19a3.5 3.5 0 003.5 3.5h6.48l-1.147 1.146a.5.5 0 00.708.708l2-2a.5.5 0 000-.708l-2-2a.5.5 0 00-.708.708L26.793 28h-6.48a2.5 2.5 0 01-2.5-2.5v-19a3.5 3.5 0 00-3.5-3.5H8z",opacity:"0.5"}),(0,C.jsx)("circle",{cx:"32.5",cy:"28.5",r:"3.5",fill:"#fff",opacity:"0.5"}),(0,C.jsx)("path",{fill:"#564328",d:"M8 16a7 7 0 017-7h6a7 7 0 110 14h-6a7 7 0 01-7-7z"}),(0,C.jsx)("path",{fill:"#CA984D",d:"M17.607 19.531c-.32 0-.544-.048-.671-.144a.477.477 0 01-.192-.41c0-.253.076-.517.227-.793.153-.276.373-.536.66-.778a3.514 3.514 0 011.043-.59 3.902 3.902 0 011.367-.226c.508 0 .965.075 1.371.226a3.46 3.46 0 011.04.59c.288.242.51.502.663.778.154.276.23.54.23.793 0 .18-.064.316-.195.41-.127.096-.351.144-.671.144h-4.872zm2.438-3.636a1.44 1.44 0 01-.79-.23 1.705 1.705 0 01-.57-.622 1.785 1.785 0 01-.214-.875 1.701 1.701 0 01.793-1.473c.24-.15.5-.226.78-.226.285 0 .545.074.782.222.24.149.431.352.574.61.146.255.22.541.22.86 0 .325-.074.619-.22.882-.143.26-.334.467-.574.621-.237.154-.497.23-.781.23zm-6.668 3.636c-.263 0-.45-.053-.559-.16-.109-.104-.164-.252-.164-.445 0-.266.068-.535.203-.809a2.6 2.6 0 01.579-.762c.252-.231.554-.419.906-.562a3.14 3.14 0 011.187-.215c.354 0 .67.047.95.14.28.092.53.206.746.345a3.022 3.022 0 00-.575.593 2.852 2.852 0 00-.375.676 1.87 1.87 0 00-.128.656c0 .211.052.392.156.543h-2.926zm2.152-3.547c-.247 0-.475-.066-.683-.199a1.5 1.5 0 01-.5-.543 1.565 1.565 0 01-.188-.762 1.475 1.475 0 01.691-1.281 1.24 1.24 0 01.68-.199c.245 0 .472.065.68.195.21.128.379.304.504.528.125.221.187.471.187.75 0 .284-.062.54-.187.77a1.5 1.5 0 01-.5.542c-.208.133-.436.2-.684.2z"})]})}),Ks=(0,v().IU)("linkedRelationLight",{viewBox:"0 0 36 32",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("path",{fill:"#91918E",d:"M3.5 5.5a2 2 0 100-4 2 2 0 000 4zm0 1.5a3.5 3.5 0 100-7 3.5 3.5 0 000 7zM9 3a.5.5 0 000 1h5.313a2.5 2.5 0 012.5 2.5v19a3.5 3.5 0 003.5 3.5h6.48l-1.147 1.146a.5.5 0 00.708.708l2-2a.5.5 0 000-.708l-2-2a.5.5 0 00-.708.708L26.793 28h-6.48a2.5 2.5 0 01-2.5-2.5v-19a3.5 3.5 0 00-3.5-3.5H9z",opacity:"0.5"}),(0,C.jsx)("circle",{cx:"32.5",cy:"28.5",r:"3.5",fill:"#91918E",opacity:"0.5"}),(0,C.jsx)("path",{fill:"#FBF3DB",d:"M8 16a7 7 0 017-7h6a7 7 0 110 14h-6a7 7 0 01-7-7z"}),(0,C.jsx)("path",{fill:"#CB912F",d:"M17.607 19.531c-.32 0-.544-.048-.671-.144a.477.477 0 01-.192-.41c0-.253.076-.517.227-.793.153-.276.373-.536.66-.778a3.514 3.514 0 011.043-.59 3.902 3.902 0 011.367-.226c.508 0 .965.075 1.371.226a3.46 3.46 0 011.04.59c.288.242.51.502.663.778.154.276.23.54.23.793 0 .18-.064.316-.195.41-.127.096-.351.144-.671.144h-4.872zm2.438-3.636a1.44 1.44 0 01-.79-.23 1.705 1.705 0 01-.57-.622 1.785 1.785 0 01-.214-.875 1.701 1.701 0 01.793-1.473c.24-.15.5-.226.78-.226.285 0 .545.074.782.222.24.149.431.352.574.61.146.255.22.541.22.86 0 .325-.074.619-.22.882-.143.26-.334.467-.574.621-.237.154-.497.23-.781.23zm-6.668 3.636c-.263 0-.45-.053-.559-.16-.109-.104-.164-.252-.164-.445 0-.266.068-.535.203-.809a2.6 2.6 0 01.579-.762c.252-.231.554-.419.906-.562a3.14 3.14 0 011.187-.215c.354 0 .67.047.95.14.28.092.53.206.746.345a3.022 3.022 0 00-.575.593 2.852 2.852 0 00-.375.676 1.87 1.87 0 00-.128.656c0 .211.052.392.156.543h-2.926zm2.152-3.547c-.247 0-.475-.066-.683-.199a1.5 1.5 0 01-.5-.543 1.565 1.565 0 01-.188-.762 1.475 1.475 0 01.691-1.281 1.24 1.24 0 01.68-.199c.245 0 .472.065.68.195.21.128.379.304.504.528.125.221.187.471.187.75 0 .284-.062.54-.187.77a1.5 1.5 0 01-.5.542c-.208.133-.436.2-.684.2z"})]})}),Hs=(0,v().IU)("unlinkedRelationDark",{viewBox:"0 0 36 32",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("path",{fill:"#fff",d:"M4 17.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM4 19a4 4 0 100-8 4 4 0 000 8z",opacity:"0.5"}),(0,C.jsx)("circle",{cx:"32",cy:"15",r:"4",fill:"#fff",opacity:"0.5"}),(0,C.jsx)("circle",{cx:"12",cy:"15",r:"1",fill:"#fff",opacity:"0.5"}),(0,C.jsx)("circle",{cx:"16",cy:"15",r:"1",fill:"#fff",opacity:"0.5"}),(0,C.jsx)("circle",{cx:"20",cy:"15",r:"1",fill:"#fff",opacity:"0.5"}),(0,C.jsx)("circle",{cx:"24",cy:"15",r:"1",fill:"#fff",opacity:"0.5"})]})}),Os=(0,v().IU)("unlinkedRelationLight",{viewBox:"0 0 36 32",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("path",{fill:"#91918E",d:"M4 17.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM4 19a4 4 0 100-8 4 4 0 000 8z",opacity:"0.5"}),(0,C.jsx)("circle",{cx:"32",cy:"15",r:"4",fill:"#91918E",opacity:"0.5"}),(0,C.jsx)("circle",{cx:"12",cy:"15",r:"1",fill:"#91918E",opacity:"0.5"}),(0,C.jsx)("circle",{cx:"16",cy:"15",r:"1",fill:"#91918E",opacity:"0.5"}),(0,C.jsx)("circle",{cx:"20",cy:"15",r:"1",fill:"#91918E",opacity:"0.5"}),(0,C.jsx)("circle",{cx:"24",cy:"15",r:"1",fill:"#91918E",opacity:"0.5"})]})});var Ls=()=>o(921981),Ds=()=>o(443269),Es=()=>o(181758);function Ns(e){const{collectionContextStore:t,property:o,propertySchema:l}=e,a=(0,I().YB)(),s=(0,i().O7)(),c=(0,i().Fy)(),u=(0,r().VK)((()=>t.collectionStore()),[t]),p=(0,r().VK)((()=>{const e=t.collectionViewBlockStore();return(0,tt().MF)(e,l)}),[t,l]),g=(0,r().VK)((()=>{var e;return Boolean(null===(e=l.permissions_data)||void 0===e?void 0:e.shared_by_enabled)}),[l]),m=(0,r().VK)((()=>"dark"===s.ThemeStore.state.mode),[s.ThemeStore]),y=(0,r().VK)((()=>m?Hs:Os),[m]),S=(0,r().VK)((()=>m?Rs:Ks),[m]),h=(0,r().VK)((()=>null==u?void 0:u.getName()),[u]),x=(0,r().VK)((()=>null==p?void 0:p.getName()),[p]),v=u&&p&&u.id===p.id,b=(0,r().VK)((()=>{const e=u&&u.getSharingEnabledRelationId();return Boolean(e&&e!==o)}),[u,o]);let w;b?w="hasAnotherSharingEnabledProperty":v&&(w="isSelfRelation");const[j,_]=(0,n.useState)(!1),[M,k]=(0,n.useState)(!1),P=(0,r().VK)((()=>{const e={limit:!1,twoWayRelation:!1};if(!u)return e;if(1!==l.limit&&(e.limit=!0),p){ht().OP(t,o,p)&&(e.twoWayRelation=!0)}return e}),[u,l,t,o,p]),[T,V]=(0,n.useState)([]);(0,n.useEffect)((()=>{if(!M){const e=[];P.limit&&e.push("limit"),P.twoWayRelation&&e.push("twoWayRelation"),V(e)}}),[P,M]);const Z=(0,n.useCallback)((async e=>{if(!u)return;const t=l.property,n=(null==l?void 0:l.permissions_data)??{},i={...l,limit:1,autoRelate:void 0,permissions_data:{...n,shared_by_enabled:e}},{serverCommitResult:r}=d().createAndCommit({userAction:"CollectionSettingsShareBy.handleShareByChange",environment:s,canUndo:!0,perform:e=>{(0,Jl().x)({environment:s,collectionStore:u,update:{[o]:i},transaction:e}),p&&t&&Ms().kQ({environment:s,collectionStore:p,property:t,transaction:e})}});try{await r}catch(c){if(c instanceof Es().x7&&c.clientData){const e=(0,Ds().cq)(c.clientData),t=(0,Ds().XN)(a,e);t&&A().UW(t)}}}),[u,l,s,o,p,a]),B=(0,n.useCallback)((e=>{u&&(e&&T.length>0?_(!0):Z(e))}),[u,T,Z]),F=(0,n.useCallback)((()=>{_(!1)}),[]),R=(0,n.useCallback)((async()=>{k(!0);try{await Z(!0)}finally{k(!1),_(!1)}}),[Z]),K=(0,f().yK)((e=>({disabled:{opacity:.5,pointerEvents:"none"},container:{marginLeft:14,marginRight:16,marginBottom:12},buttonTitle:{fontSize:c.isMobile?17:14,fontWeight:400,lineHeight:c.isMobile?"24px":"20px",textWrap:"wrap",overflow:"auto"},buttonDefault:{marginTop:12,paddingTop:c.isMobile?16:12,paddingBottom:c.isMobile?16:12,borderRadius:8,boxShadow:`0 0 0 1px ${e.selectLightGray[200]}`,gap:6},buttonSelected:{boxShadow:`0 0 0 2px ${e.blueColor}`},icon:{width:c.isMobile?54:36,height:c.isMobile?48:32},disabledReasonContent:{paddingLeft:16,paddingRight:16,paddingTop:12,paddingBottom:12,borderRadius:10,backgroundColor:e.tint.uiYellow,color:e.text.uiYellowPrimary,fontSize:12,textWrap:"pretty"},modalContainer:{padding:20,paddingBottom:12,width:c.isMobile?void 0:400},modalHeader:{display:"flex",flexDirection:"column"},modalHeaderIconContainer:{display:"flex",justifyContent:"center"},modalHeaderTitle:{display:"flex",justifyContent:"center",marginTop:8,fontSize:17,fontWeight:590,lineHeight:"22px",textAlign:"center",color:e.regularTextColor},modalHeaderDescription:{display:"flex",justifyContent:"center",marginTop:8,fontSize:14,lineHeight:"20px",color:e.mediumTextColor,textAlign:"center",textWrap:"pretty"},modalList:{display:"flex",marginTop:24,flexDirection:"column",alignItems:"flex-start",alignSelf:"stretch",fontSize:14,boxShadow:`0 0 0 1px ${e.selectLightGray[100]}`,borderRadius:10},modalListItem:{borderBottom:`1px solid ${e.selectLightGray[100]}`},modalListItemContent:{paddingLeft:16,paddingRight:16,paddingTop:12,paddingBottom:12}})),[c.isMobile]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(ee().Z,{topBorder:!0,disableMobileBorders:!0,disableDesktopPadding:!0,disableMobilePadding:!0,mobileTitleStyle:{marginTop:12},mobileStyle:{paddingBottom:6},title:(0,C.jsx)(pt().Z,{isSmall:!0,isSecondaryColor:!0,isMobile:c.isMobile,children:(0,C.jsx)(I()._H,{id:"collectionSettings.relationSharingSwitcher.header",defaultMessage:"Share settings through relation"})}),children:[w&&(0,C.jsx)("div",{style:K.container,children:(0,C.jsx)("div",{style:K.disabledReasonContent,children:a.formatMessage(Us.disabledReasons[w])})}),(0,C.jsxs)("div",{style:{...K.container,...v&&K.disabled,...b&&K.disabled},children:[(0,C.jsx)(q().Z,{focused:!1,left:y(K.icon),title:(0,C.jsx)(I()._H,{id:"collectionSettings.relationSharingSwitcher.unlinkedTitle",defaultMessage:"{collectionName} and {relationName} have separate share settings",values:{collectionName:h,relationName:x}}),titleStyle:K.buttonTitle,style:{...K.buttonDefault,...!g&&K.buttonSelected},onClick:()=>B(!1)}),(0,C.jsx)(q().Z,{focused:!1,left:S(K.icon),title:(0,C.jsx)(I()._H,{id:"collectionSettings.relationSharingSwitcher.linkedTitle",defaultMessage:"{collectionName} inherit share settings from related {relationName}",values:{collectionName:h,relationName:x}}),titleStyle:K.buttonTitle,style:{...K.buttonDefault,...g&&K.buttonSelected},onClick:()=>B(!0)})]})]}),(0,C.jsx)(Ls().c,{showCloseIcon:!0,isOpen:j,onDismiss:()=>{_(!1)},render:()=>(0,C.jsxs)("div",{style:K.modalContainer,children:[(0,C.jsxs)("div",{style:K.modalHeader,children:[(0,C.jsx)("div",{style:K.modalHeaderIconContainer,children:S({width:36,height:32,marginLeft:4})}),(0,C.jsx)("div",{style:K.modalHeaderTitle,children:a.formatMessage(Us.header.title)}),(0,C.jsx)("div",{style:K.modalHeaderDescription,children:a.formatMessage(Us.header.description)})]}),(0,C.jsx)("div",{style:K.modalList,children:T.map(((e,t,o)=>(0,C.jsx)("div",{style:{...K.modalListItem,borderBottom:t+1===o.length?"none":K.modalListItem.borderBottom},children:(0,C.jsx)("div",{style:K.modalListItemContent,children:a.formatMessage(Us.issues[e],{title:e=>(0,C.jsx)("span",{style:{fontWeight:590},children:e}),description:e=>(0,C.jsx)("div",{style:{marginTop:4},children:e})})})},e)))}),(0,C.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",flexDirection:"column",marginTop:24,gap:8},children:[(0,C.jsx)(X().Z,{isLarge:!0,onClick:R,isLoading:M,disabled:M,children:(0,C.jsx)(I()._H,{id:"collectionSettings.relationSharingSwitcher.changes.applyChanges",defaultMessage:"Apply changes"})}),(0,C.jsx)(_o().D,{onClick:F,size:"lg",isGray:!0,disabled:M,style:{justifyContent:"center"},children:(0,C.jsx)(I()._H,{id:"collectionSettings.relationSharingSwitcher.changes.cancel",defaultMessage:"Cancel"})})]})]})})]})}const Us={header:(0,I().vU)({title:{id:"collectionSettings.relationSharingSwitcher.changes.modalHeaderTitle",defaultMessage:"Turn on permission sharing"},description:{id:"collectionSettings.relationSharingSwitcher.changes.modalHeaderDescription",defaultMessage:"To enable permission sharing through a relation, the following changes are required."}}),issues:(0,I().vU)({limit:{id:"collectionSettings.relationSharingSwitcher.changes.setLimitToOne",defaultMessage:"<title>Limit to one page</title><description>Permissions can only be inherited from one related page. For existing pages that have more than one related page, only the first page will be kept.</description>"},twoWayRelation:{id:"collectionSettings.relationSharingSwitcher.changes.removeTwoWayRelation",defaultMessage:"<title>Remove the two-way relation</title><description>Only one-way relations are supported at this time.</description>"}}),disabledReasons:(0,I().vU)({hasAnotherSharingEnabledProperty:{id:"collectionSettings.relationSharingSwitcher.disabledReasons.hasAnotherSharingEnabledProperty",defaultMessage:"Sharing is already enabled through another relation."},isSelfRelation:{id:"collectionSettings.relationSharingSwitcher.disabledReasons.isSelfRelation",defaultMessage:"Can't change share settings for a self-relation."}})};var zs=()=>o(506347),Ws=()=>o(729775),qs=()=>o(429725);function Gs(e){const{isSelfRelation:t,collectionStore:o,showAs:n,disabled:l,onClick:a}=e,s=(0,r().VK)((()=>Boolean(o)),[o]),c=(0,r().VK)((()=>null==o?void 0:o.getIcon()),[o]),d=(0,r().VK)((()=>{if(t)return;const e=null==o?void 0:o.getParentBlockStore();return e&&(0,qs().ZP)({store:e,pageVisitSource:zs().tY.LinkInPage})}),[o,t]),u=(0,i().Fy)(),p=(0,f().yK)((e=>({linkBox:{display:"flex",alignItems:"center"},linkTitle:{color:e.regularTextColor,fontWeight:V().Ue.semibold,fontSize:14,marginLeft:4*(u.isRetina?.5:1),wordBreak:"break-word",...V().Yu},chevronTitle:{display:"inline",wordBreak:"break-word",...V().Yu}})),[u]),g=(0,r().VK)((()=>Mn().Z.state.isOpen&&"layout-editor"===Mn().Z.state.mode),[]),m=(0,C.jsx)(fn().Z,{icon:c,isEmptyPage:!1,size:20,disabled:!0});return(0,C.jsx)(F().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"Related to",id:"database.viewSettings.editRelation.targetLink.title"}),showChevron:"chevron"===n,onClick:a,disabled:l,right:t?(0,C.jsx)(I()._H,{defaultMessage:"This database",id:"database.viewSettings.editRelation.selfRelationTarget.title"}):"link"===n&&d?(0,C.jsxs)(Ws().Z,{external:g,href:d,innerStyle:p.linkBox,children:[m,(0,C.jsx)(_l().Z,{store:o,underline:!0,style:p.linkTitle,maxLength:15})]}):s?(0,C.jsxs)(C.Fragment,{children:[m,(0,C.jsx)(_l().Z,{store:o,style:p.chevronTitle})]}):(0,C.jsx)(I()._H,{defaultMessage:"No target",id:"database.viewSettings.editRelation.noTarget.title"}),rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0}})}function Ys(e){const{collectionContextStore:t,property:o}=e,n=(0,i().O7)(),l=(0,r().VK)((()=>t.collectionStore()),[t]),a=(0,r().VK)((()=>ht().KV(t,o)),[t,o]),s=(0,r().VK)((()=>{const e=t.collectionViewBlockStore();return(0,tt().MF)(e,a)}),[t,a]),c=Boolean(s&&(null==l?void 0:l.id)===s.id),d=(0,r().VK)((()=>{var e;return(0,xs().nS)({experimentService:$e().default,actor:{table:Ia().KJ,id:n.currentUser.id??""},spaceId:(null===(e=un().default.state.currentSpaceStore)||void 0===e?void 0:e.id)??""})}),[n.currentUser]),u=a&&(0,go().NK)(a)?a.connectedRelation:void 0,{isConnectedRelationDatabaseActionsSupported:p,connectedRelationPatternName:g,integrationId:m}=(0,r().VK)((()=>{const e=t.normalizedSchemaStore.state[o],n=null==e?void 0:e.name,i=(0,ka().go)(e);return{isConnectedRelationDatabaseActionsSupported:(0,ka().v3)(i)&&$e().default.checkGate({gateName:"connected_relations_database_actions_enabled"}),connectedRelationPatternName:n,integrationId:i}}),[t,o]);if(!s)return null;const f=a&&!(0,ka().gg)(a)&&!(0,ka().ic)(a)&&!(0,ka().R3)(a);return(0,C.jsxs)(C.Fragment,{children:[f&&(0,C.jsx)(Gs,{isSelfRelation:c,collectionStore:s,showAs:"link",disabled:!0}),p&&g&&m&&(0,C.jsx)(_s,{collectionContextStore:t,property:o,connectedRelationPatternName:g,integrationId:m,propertySchema:a,environment:n}),f&&(0,C.jsx)(fs,{collectionContextStore:t,propertySchema:a,property:o}),!Boolean(u)&&(0,C.jsx)(Fs,{collectionContextStore:t,property:o,targetCollectionStore:s}),d&&a&&(0,go().p_)(a)&&(0,C.jsx)(Ns,{collectionContextStore:t,property:o,propertySchema:a})]})}var $s=()=>o(971928),Qs=()=>o(709917),Js=()=>o(119891),Xs=()=>o(291848),ec=()=>o(277443);function tc(e){var t;const o=(0,i().O7)(),l=(0,f().Fg)(),{isMobile:a}=(0,i().Fy)(),{property:s,option:c,statusGroup:u,propertySchema:p,isDefault:g,disabled:m}=e,y=(0,gt().Y$)(),S=(0,r().VK)((()=>{var e;return null===(e=y.collectionStore())||void 0===e?void 0:e.id}),[y]),h=(0,r().qz)(void 0,xt().Z),x=(0,r().VK)((()=>h.state.open),[h]),v=(0,n.useCallback)((()=>{h.setState({open:!0})}),[h]),b=(0,n.useCallback)((()=>{h.setState({open:!1})}),[h]),w=(0,n.useCallback)((e=>{const t=y.collectionStore();t&&(0,Ka().H)({environment:o,collectionStore:t,performTransaction:o=>{for(const n of e)d().applyOperation({store:(0,W().Kv)(t,n.pointer),operation:n,transaction:o})}})}),[y,o]),j=(0,f().yK)((()=>({defaultText:{fontSize:12,fontWeight:500,textTransform:"uppercase"}})),[]);return S?(0,C.jsx)(ec()._,{open:x,origin:(0,C.jsx)(ro().Z,{renderTooltip:e=>(0,C.jsxs)("div",{...e,style:ko().F6,children:[(0,C.jsx)("div",{children:c.value}),(0,C.jsx)("div",{style:{color:l.mediumInvertedTextColor},children:c.description})]}),placement:ao().Placement.Left,disableTooltip:!(null!==(t=c.description)&&void 0!==t&&t.length),render:e=>{var t,o;return(0,C.jsx)(F().Z,{...e,showDragHandle:!a,showChevron:!0,disabled:m,rotateChevron:x,title:"status"===p.type?(0,C.jsx)(oa().F,{format:a?Wl().lo.Large:Wl().lo.Medium,value:c.value,color:c.color,hideTooltip:!(null===(t=c.description)||void 0===t||!t.length),tooltipPlacement:ao().Placement.Left,showRemoveButton:!1,isSingle:!0,groupColor:null==u?void 0:u.color}):(0,C.jsx)(oa().a,{format:a?Wl().lo.Large:Wl().lo.Medium,value:c.value,color:c.color,hideTooltip:!(null===(o=c.description)||void 0===o||!o.length),tooltipPlacement:ao().Placement.Left,showRemoveButton:!1,isSingle:!0}),right:g?(0,C.jsx)("span",{style:j.defaultText,children:(0,C.jsx)(I()._H,{id:"database.statusProperty.default",defaultMessage:"Default"})}):void 0,onClick:v})}}),option:c,property:s,propertySchema:p,statusGroup:u,collectionId:S,analyticsFrom:"view_settings",alignmentToOrigin:ao().Alignment.End,onChange:w,onClose:b}):null}const oc=oi().default.createClass(void 0,{name:"InputGroupIndexStore"});const nc=function(e){let{collectionContextStore:t,property:o,disabled:l,aIAutofillOption:a}=e;const s=(0,i().O7)(),c=(0,r().qz)(void 0,oc),[u,p]=(0,n.useState)({inputValue:"",focus:!1}),g=(0,r().VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema()}),[t]),m=(0,r().VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat().app_config_uri}),[t]),f=(0,r().VK)((()=>rc(t,o)),[t,o]),y=(0,r().Kw)(c);if(!g||!f)return null;if("status"===f.type){const e=f.groups??[];if(0===e.length)return null;const n=f.options??[],i=e.map((e=>{const t=n.filter((t=>{var o;return null===(o=e.optionIds)||void 0===o?void 0:o.includes(t.id)}));return{group:e,groupOptions:t}})),r=f.defaultOption,a=[...i[0].groupOptions.map((e=>e.value))];for(const{group:t,groupOptions:o}of i.slice(1))a.push({key:`group-header-${t.name}`,draggable:!1}),a.push(...o.map((e=>e.value)));const d=(0,re().Hw)(m,g,o)?{tooltipCaption:(0,C.jsx)(I()._H,{defaultMessage:"These options are core to the property and cannot be changed.",id:"database.viewSettings.selectOptions.disabledGroupMessage"})}:void 0,S=(a,s)=>{if(a.startsWith("group-header-")){const e=a.substring(13),n=i.findIndex((t=>{let{group:o}=t;return o.name===e})),{group:r,groupOptions:s}=i[n];return(0,C.jsxs)(ic,{title:(0,C.jsx)(Qs().r_,{disableGroup:d,group:r,showIcon:!1}),right:!u.focus&&(0,C.jsx)(lc,{collectionContextStore:t,property:o,onClick:e=>(0,We().ZP)({event:e,context:We().Af.CollectionSettingsClick,callback:()=>sc(p,c,n)})}),disabled:l,children:[y===n&&(0,C.jsx)(cc,{collectionContextStore:t,property:o,input:u,setInput:p,inputGroupIndexStore:c}),!u.focus&&0===s.length&&(0,C.jsx)(dc,{setInput:p,inputGroupIndexStore:c,groupIndex:n})]})}{const t=n.find((e=>e.value===a));if(!t)return null;const i=e.find((e=>{var o;return null===(o=e.optionIds)||void 0===o?void 0:o.includes(t.id)}));return(0,C.jsx)(tc,{option:t,statusGroup:i,propertySchema:f,property:o,isDefault:t.value===r,disabled:l},t.value)}};return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(ic,{title:(0,C.jsx)(Qs().r_,{disableGroup:d,group:i[0].group}),right:!u.focus&&(0,C.jsx)(lc,{collectionContextStore:t,property:o,onClick:e=>(0,We().ZP)({event:e,context:We().Af.CollectionSettingsClick,callback:()=>sc(p,c,0)})}),disabled:l,children:[0===y&&(0,C.jsx)(cc,{collectionContextStore:t,property:o,input:u,setInput:p,inputGroupIndexStore:c}),!u.focus&&0===i[0].groupOptions.length&&(0,C.jsx)(dc,{setInput:p,inputGroupIndexStore:c,groupIndex:0})]}),(0,C.jsx)(Js().ZP,{direction:"vertical",keys:a,renderKey:S,onDrop:e=>ac(e,s,o,t),disabled:l})]})}{const e=f.options??[],n=e.map((e=>e.value)),i=f.auto_sort_options||"manual";return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(vt().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"Sort",id:"database.viewSettings.selectOptions.autoSort"}),selectedKey:i,options:[{key:"manual",type:"button",title:(0,C.jsx)(I()._H,{defaultMessage:"Manual",id:"database.viewSettings.selectOptions.autoSort.none"})},{key:"alphabetical",type:"button",title:(0,C.jsx)(I()._H,{defaultMessage:"Alphabetical",id:"database.viewSettings.selectOptions.autoSort.alphabetical"})},{key:"reverse_alphabetical",type:"button",title:(0,C.jsx)(I()._H,{defaultMessage:"Reverse alphabetical",id:"database.viewSettings.selectOptions.autoSort.reverseAlphabetical"})}],onChange:e=>function(e,t,o,n){const i=o.collectionStore(),r=o.normalizedSchemaStore.state,l=rc(o,n);if(!i||!l)return;if(!(0,go().cu)(l))return;const a=[{pointer:i.pointer,command:"update",path:["schema",n],args:{auto_sort_options:e}}];"alphabetical"!==e&&"reverse_alphabetical"!==e||a.push(...(0,dt().L5)({collectionId:i.id,property:n,propertySchema:l,schema:r,isAscending:"alphabetical"===e})||[]);(0,Ka().H)({environment:t,collectionStore:i,performTransaction:e=>{for(const t of a)d().applyOperation({store:(0,W().Kv)(i,t.pointer),operation:t,transaction:e})}}),Wt().$q({environment:t,collectionContextStore:o,property:n,from:"view_settings",action:"select_change_auto_sort_options"})}(e,s,t,o),popupStyle:{minWidth:190}},"autoSortMenuItem"),a,(0,C.jsx)(ic,{title:(0,C.jsx)(I()._H,{defaultMessage:"Options",id:"database.viewSettings.selectOptions.title"}),right:!u.focus&&n.length>0&&(0,C.jsx)(lc,{collectionContextStore:t,property:o,onClick:e=>(0,We().ZP)({event:e,context:We().Af.CollectionSettingsClick,callback:()=>sc(p,c)})}),disabled:l,children:(0,C.jsx)(cc,{collectionContextStore:t,property:o,input:u,setInput:p,inputGroupIndexStore:c})},"sectionHeader"),n.length>0&&(0,C.jsx)(Js().ZP,{direction:"vertical",keys:n,renderKey:t=>{const n=e.find((e=>e.value===t));return n?(0,C.jsx)(tc,{option:n,property:o,propertySchema:f,isDefault:!1,statusGroup:void 0,disabled:l},n.value):null},onDrop:e=>ac(e,s,o,t)}),!u.focus&&0===n.length&&(0,C.jsx)(dc,{setInput:p,inputGroupIndexStore:c})]})}};function ic(e){let{title:t,right:o,children:n,disabled:i,overrideStyle:r}=e;return(0,C.jsx)(ee().Z,{topBorder:!0,title:t,desktopTitleStyle:{height:20},right:!i&&o,style:{width:"100%",paddingBottom:0,...r},children:!i&&n})}function rc(e,t){const o=e.normalizedSchemaStore.state[t];if(o&&((0,go().cu)(o)||"status"===o.type))return o}function lc(e){let{onClick:t,collectionContextStore:o,property:n}=e;const i=(0,I().YB)();return(0,r().VK)((()=>rc(o,n)),[o,n])?(0,C.jsx)(Pr().Z,{icon:no().R,onClick:t,style:{width:20,height:20},ariaLabel:i.formatMessage({defaultMessage:"Add an option",id:"database.viewSettings.selectOptions.addOption"})}):null}function ac(e,t,o,n){const i=n.normalizedSchemaStore.state,r=n.collectionStore();r&&($s().n6({newValues:e,property:o,schema:i,collectionStore:r,environment:t}),Wt().$q({environment:t,collectionContextStore:n,property:o,from:"view_settings",action:"select_options_reorder"}))}function sc(e,t,o){e({focus:!0,inputValue:""}),void 0!==o&&t.setState(o)}function cc(e){let{collectionContextStore:t,property:o,input:r,setInput:l,inputGroupIndexStore:a}=e;const s=(0,i().O7)(),c=(0,I().YB)(),d=(0,n.useCallback)((()=>function(e,t,o,n,i,r){const l=t.collectionStore(),a=rc(t,o);if(!a||!l)return;const s=a.options||[],c=n.inputValue.trim();if(c)if("status"===a.type){const t=r.state;let n;if(void 0!==t&&(n=s.find((e=>{var o;return null===(o=a.groups)||void 0===o||null===(o=o[t].optionIds)||void 0===o?void 0:o.includes(e.id)}))),void 0===t||void 0!==n)$s().P3({modification:{type:"keyedObjectListBefore",beforeOption:n,newValue:c},property:o,propertySchema:a,options:s,environment:e,collectionStore:l,groupIndex:t});else{let n;for(let e=t-1;e>=0;e--){var d;const t=null===(d=a.groups)||void 0===d?void 0:d[e];if(t&&(n=s.find((e=>{var o;return null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id)})),void 0!==n))break}$s().P3({modification:{type:"keyedObjectListAfter",afterOption:n,newValue:c},property:o,propertySchema:a,options:s,environment:e,collectionStore:l,groupIndex:t})}}else!(0,go().cu)(a)||"alphabetical"!==a.auto_sort_options&&"reverse_alphabetical"!==a.auto_sort_options?$s().P3({modification:{type:"keyedObjectListBefore",newValue:c},property:o,propertySchema:a,options:s,environment:e,collectionStore:l}):$s().P3({modification:{type:"autoSortInsert",newValue:c},property:o,propertySchema:a,options:s,environment:e,collectionStore:l});i({focus:!0,inputValue:""}),Wt().$q({environment:e,collectionContextStore:t,property:o,from:"view_settings",action:"select_add_option",option_value_char_count:c.length})}(s,t,o,r,l,a)),[s,t,o,r,l,a]),u=(0,n.useCallback)((e=>function(e,t){t({focus:!0,inputValue:e.target.value.replace(/,/g,"")})}(e,l)),[l]),p=(0,n.useCallback)((()=>function(e,t,o){o({focus:!1,inputValue:e.device.isPhone?t.inputValue:""})}(s,r,l)),[s,r,l]),m=(0,Xs().w)(),y=(0,f().yK)((e=>({inputOuterStyle:m?{backgroundColor:e.white}:{},inputMenuItem:{marginTop:2,marginBottom:8}})),[m]);return r.focus?(0,C.jsx)(g().Z,{debugName:"CollectionSettingsSelectOptions",capture:!0,onEsc:p,children:(0,C.jsx)(xo().ZP,{value:r.inputValue,focus:!0,placeholder:c.formatMessage({defaultMessage:"Type a new option…",id:"database.viewSettings.selectOptions.newSelectOption.inputPlaceholder"}),style:y.inputMenuItem,inputOuterStyle:y.inputOuterStyle,onChange:u,onBlur:p,onSubmit:d,mobileKeyboardOnDismiss:d})}):null}function dc(e){let{groupIndex:t,setInput:o,inputGroupIndexStore:n}=e;return(0,C.jsx)(q().Z,{icon:(0,no().R)({width:14}),focused:!1,title:(0,C.jsx)(I()._H,{defaultMessage:"Add an option",id:"database.viewSettings.selectOptions.noOptions"}),style:{width:"100%"},onClick:e=>(0,We().ZP)({event:e,context:We().Af.CollectionSettingsClick,callback:()=>sc(o,n,t)})})}var uc=()=>o(544672),pc=()=>o(870960);const gc=(0,I().vU)({statusShowAsLabel:{id:"database.viewSettings.statusOptions.showAs",defaultMessage:"Show as"},statusCheckboxLabel:{id:"database.viewSettings.statusOptions.showAs.checkbox",defaultMessage:"Checkbox"},statusSelectLabel:{id:"database.viewSettings.statusOptions.showAs.select",defaultMessage:"Select"}});function mc(e){let{collectionContextStore:t,property:o,disabled:n}=e;const l=(0,i().O7)(),a=(0,f().yK)((e=>({icon:{width:16,height:16,fill:e.mediumIconColor}})),[]),[s,c]=(0,r().VK)((()=>{var e;return[fc(t,o),(null===(e=t.getPropertyFormat(o))||void 0===e?void 0:e.statusShowAs)??"select"]}),[t,o]);if(!s)return null;const u=[{key:"checkbox",type:"button",title:Co().Z.formatMessage(gc.statusCheckboxLabel),icon:(0,uc().r)(a.icon)},{key:"select",type:"button",title:Co().Z.formatMessage(gc.statusSelectLabel),icon:(0,pc().w)(a.icon)}];return(0,C.jsx)(vt().Z,{title:Co().Z.formatMessage(gc.statusShowAsLabel),selectedKey:c,popupStyle:{minWidth:190},options:u,onChange:e=>function(e,t,o,n){const i=o.formatStore();if(!i)return;const r=o.getPropertyFormatKey();if(!r)return;d().createAndCommit({userAction:"CollectionSettingsStatusOptions.handleShowAsChange",environment:t,canUndo:!0,perform:t=>{at().er({formatStore:i,formatKey:r,property:n,update:{statusShowAs:e,visible:!0},transaction:t})}}),Wt().$q({environment:t,collectionContextStore:o,property:n,from:"view_settings",action:"status_change_format"})}(e,l,t,o),disabled:n})}function fc(e,t){const o=e.normalizedSchemaStore.state[t];if(o&&"status"===o.type)return o}var yc=()=>o(477253);function Sc(e){let{collectionContextStore:t,property:o,propertySchema:n}=e;const r=(0,i().O7)();return(0,C.jsx)(yc().Z,{title:(0,C.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,C.jsx)(I()._H,{defaultMessage:"Show full URL",id:"database.viewSettings.propertyTab.toggleShowFullUrl"})}),showChevron:!1,switcherProps:{on:Boolean(n.show_full_url),noColor:!1},onClick:()=>function(e,t,o,n){const i=t.collectionStore();if(!n||!i||"url"!==n.type)return;const r=!Boolean(n.show_full_url);d().createAndCommit({userAction:"CollectionSettingsProperty.handleNumberShowAsChange",environment:e,canUndo:!0,perform:t=>{(0,Jl().x)({environment:e,collectionStore:i,update:{[o]:{...n,show_full_url:r}},transaction:t})}}),Wt().$q({environment:e,collectionContextStore:t,property:o,from:"view_settings",action:r?"url_toggle_show_full_on":"url_toggle_show_full_off"})}(r,t,o,n)})}const hc=n.memo((function(e){const{collectionContextStore:t,collectionSettingsStore:l,formatKey:a,property:s,selectNameInitial:c,titleOverride:u}=e,[p,g]=(0,n.useState)(!1),[m,y]=(0,n.useState)(""),S=(0,i().O7)(),h=(0,n.useRef)(null),x=(0,I().YB)(),v=(0,f().Fg)(),{collectionStore:b,isMultiSourceView:w}=(0,r().VK)((()=>({collectionStore:t.collectionStore(),isMultiSourceView:"collectionTypedView"===t.contextType})),[t]),j=(0,r().VK)((()=>t.normalizedSchemaStore.state),[t.normalizedSchemaStore]),{isTypedProperty:_,databaseType:M}=(0,r().VK)((()=>b?{isTypedProperty:b.isTypedProperty(s),databaseType:b.getDatabaseType()}:{isTypedProperty:!1,databaseType:void 0}),[b,s]),k=(0,r().VK)((()=>(0,ka().Qm)({schema:j,property:s})),[s,j]),P=(0,r().VK)((()=>wc({property:s,formatKey:a,collectionContextStore:t})),[t,a,s]),T=(0,r().VK)((()=>(0,Kn().Gu)({property:s,collectionContextStore:t,newValue:m})),[t,m,s]),V=(0,r().VK)((()=>{var e;const n=null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.id;return!!n&&(0,o(772529).Kj)(n)}),[t]),A=(0,r().VK)((()=>Boolean(b&&M&&re().cR((0,Fa().appConfigs)(),M,s,b))),[b,M,s]),Z=(0,r().VK)((()=>{var e;const o=t.collectionViewStore();return!!o&&(Boolean((null===(e=wc({property:s,formatKey:a,collectionContextStore:t}))||void 0===e?void 0:e.wrap)||o.getFormat().table_wrap)&&"timeline"!==o.getType())}),[t,a,s]),F=(0,r().qz)(void 0,xt().Z),R=(0,r().VK)((()=>Mn().Z.state.isOpen),[]);(0,n.useEffect)((()=>{!function(e,t,n){const i=t.collectionViewStore();if(!i||"table"!==i.getType())return;const r=o(804097).Z.findTableHeaderCell(t,e);if(!r)return;const l=r.getNode();if(!l||!n)return;const a=(0,o(275200).xH)(l);if(!a)return;const s=n.getBoundingClientRect(),c=l.getBoundingClientRect().right+20-s.left;a.scrollLeft=a.scrollLeft+c}(s,t,h.current),k&&y(k.name||"")}),[t,s,k]);const K=(0,n.useCallback)((e=>{(0,tt().bZ)({collectionContextStore:t,environment:S,inputValue:m,name:e,property:s})}),[t,S,m,s]),H=(0,n.useCallback)((e=>{g(!p),e.stopPropagation()}),[p]),O=(0,n.useCallback)((e=>{!function(e){var t;const{description:o,environment:n,collectionContextStore:i,property:r}=e,l=i.collectionStore(),a=null==l||null===(t=l.getSchema())||void 0===t?void 0:t[r];if(!l||void 0===a||o===a.description)return;d().createAndCommit({userAction:"CollectionSettingsProperty.handleDescriptionChange",environment:n,canUndo:!0,perform:e=>{(0,Jl().x)({environment:n,collectionStore:l,update:{[r]:{...a,description:o}},transaction:e})}}),Wt().$q({environment:n,collectionContextStore:i,property:r,from:"view_properties",action:"set_description"})}({collectionContextStore:t,description:e,environment:S,property:s})}),[t,S,s]),L=(0,n.useCallback)((e=>{y(e)}),[]);if(!k)return null;const D=!(0,ka().Kp)(k),E=w,N=w||(0,ka().sh)({property:s,propertySchema:k,isTypedProperty:_}),U=k.description;return(0,C.jsxs)(B().ZP,{...e,title:u||(b?(0,C.jsx)(I()._H,{defaultMessage:"Edit property",id:"database.viewSettings.propertyTab.title"}):(0,C.jsx)(I()._H,{defaultMessage:"View property",id:"database.viewSettings.propertyTab.title.viewProperty"})),footer:(0,C.jsx)(Uc,{collectionContextStore:t,formatKey:a,property:s,collectionSettingsStore:l,wrapProperty:Z,propertySchema:k,propertyFormat:P,isRequiredTypedProperty:A,databaseType:M}),ref:h,children:[(0,C.jsxs)(ee().Z,{isInput:!0,style:R?{margin:"0 2px"}:void 0,children:[(0,C.jsx)(kn().I,{disabled:E,initialValue:k.name||"",placeholder:Co().Z.formatMessage(hs().Z.inputPlaceholder),onBlur:K,onSubmit:K,focusInitial:c,selectAll:c,iconButton:{icon:e=>(0,C.jsx)(mo().ZP,{type:k.type,icon:k.icon,size:16,theme:v,style:e}),iconStyle:{fill:bn().Lr[v.mode].gray},...R?{backgroundColor:v.white}:void 0,enforceIconColor:"gray",onSubmit:e=>function(e,t,o,n){const i=o.collectionStore();if(!i)return;d().createAndCommit({userAction:"CollectionSettingsProperty.handlePropertyIconSubmit",environment:e,canUndo:!0,perform:e=>{at().OK({collectionStore:i,property:t,icon:n,transaction:e})}}),Wt().$q({environment:e,collectionContextStore:o,property:t,icon:n,from:"view_settings",action:"change_icon"})}(S,s,t,e)},inputOuterStyle:R?{backgroundColor:v.white}:void 0,inputRightButton:V?null:(0,C.jsx)(o(705670).l,{description:U,showTooltip:!p,onClick:H,addDescriptionText:x.formatMessage(ko().aB.addPropertyDescriptionTooltip),editDescriptionText:x.formatMessage(ko().aB.editPropertyDescriptionTooltip)}),onChange:L}),T&&(0,C.jsx)(o(604185).Z,{propertyName:m})]}),p&&(0,C.jsx)(o(678523).i,{initialDescription:U,handleSaveDescription:O}),(0,C.jsxs)(ee().Z,{children:[D&&(0,C.jsx)(Aa().yA,{disabled:N,isTypedProperty:_,collectionUri:M,collectionContextStore:t,formatKey:a,propertyTypeButtonPopupStore:F,property:s}),"button"===k.type&&(0,C.jsx)(Aa().oL,{collectionSettingsStore:l,collectionContextStore:t,property:s}),w?(0,C.jsxs)(C.Fragment,{children:["status"===k.type&&(0,C.jsx)(_c,{collectionSettingsStore:l,collectionContextStore:t,property:s}),("date"===k.type||"created_time"===k.type||"last_edited_time"===k.type)&&(0,C.jsx)(kc,{collectionContextStore:t,property:s})]}):(0,C.jsx)(zc,{collectionContextStore:t,property:s,propertySchema:k})]}),R&&(0,C.jsx)(Qa,{})]})}));function xc(e,t,o,n){const i=wc({property:n,formatKey:o,collectionContextStore:t}),r=t.collectionViewStore(),l=t.normalizedFormatStore.state,a=(0,tt().KV)({collectionContextStore:t,property:n});if(!a)return;if(!(i&&r&&o&&a))return;const s=Cc({formatKey:o,collectionContextStore:t}).map((e=>e.property===i.property?{...i,visible:!i.visible}:e)),c={...l,[o]:s};d().createAndCommit({userAction:"CollectionSettingsProperty.handleToggleVisibilityClick",environment:e,canUndo:!0,perform:l=>{(0,wn().i)({collectionViewStore:r,update:{format:c},transaction:l});const a=jc({property:n,formatKey:o,collectionContextStore:t});qt().oz({environment:e,collectionContextStore:t,currentIndex:a,entrypoint:"CollectionSettingsProperty",transaction:l,propertyAction:i.visible?"hide":"show"})}}),Wt().wd({environment:e,collectionContextStore:t,action:"toggle_property_visibility",original_view_type:r.getType(),property_type:a.type})}async function vc(e,t,o,n,i,r){await Ba().T({environment:e,collectionContextStore:o,property:n,handleDeleteAccept:()=>function(e,t,o,n,i){const r=o.normalizedSchemaStore.state,l=o.collectionStore(),a=(0,ka().Qm)({schema:r,property:t});a&&(l&&d().createAndCommitAsync({environment:e,userAction:"CollectionSettingsProperty.handleDeleteAccept",waitForServerCommit:!1,perform:async n=>{await at().yV({environment:e,collectionStore:l,schema:r,property:t,transaction:n});const a=jc({property:t,formatKey:i,collectionContextStore:o});qt().oz({environment:e,collectionContextStore:o,currentIndex:a,entrypoint:"CollectionSettingsProperty",transaction:n,propertyAction:"delete"})}}),s().z$({collectionSettingsStore:n}),Wt().wd({environment:e,collectionContextStore:o,action:"delete_property",property_type:null==a?void 0:a.type}),Wt().y9({environment:e,collectionContextStore:o,property_type:a.type,from:"view_settings",property:t}))}(e,n,o,i,r),theme:t,from:"view_settings"})}function Cc(e){const{formatKey:t,collectionContextStore:o}=e;if(!t)return[];var n;if("collection_page_properties"===t)return(null===(n=o.collectionStore())||void 0===n?void 0:n.getFormat().collection_page_properties)??[];return o.normalizedFormatStore.state[t]||[]}function bc(e){const t=e.getViewType();if(!t)throw new Error("View type was not defined.");return t}function wc(e){const{collectionContextStore:t,formatKey:o,property:n}=e,i=Cc({formatKey:o,collectionContextStore:t});return null==i?void 0:i.find((e=>e.property===n))}function jc(e){const{collectionContextStore:t,formatKey:o,property:n}=e,i=Cc({formatKey:o,collectionContextStore:t});if(0===i.length)return-1;return i.filter((e=>e.visible)).findIndex((e=>e.property===n))}function _c(e){let{collectionSettingsStore:t,collectionContextStore:o,property:n}=e;const i=(0,r().VK)((()=>{var e;return re().Hw(null===(e=o.collectionStore())||void 0===e?void 0:e.getDatabaseType(),o.normalizedSchemaStore.state,n)}),[o,n]);return(0,C.jsxs)(C.Fragment,{children:[i?null:(0,C.jsx)(mc,{collectionContextStore:o,property:n,disabled:i}),(0,C.jsx)(nc,{collectionSettingsStore:t,collectionContextStore:o,property:n,disabled:i,aIAutofillOption:null})]})}function Mc(e){let{collectionContextStore:t,collectionSettingsStore:o,property:n}=e;return(0,C.jsx)(ps,{collectionContextStore:t,collectionSettingsStore:o,property:n})}function kc(e){let{collectionContextStore:t,property:o}=e;return(0,C.jsx)(ls,{collectionContextStore:t,property:o})}function Pc(e){let{collectionContextStore:t,property:o}=e;return(0,r().VK)((()=>{const e=t.normalizedSchemaStore.state[o];return(0,ka().Kp)(e)}),[t,o])?(0,C.jsx)(Ma,{collectionContextStore:t,property:o}):(0,C.jsx)(Ys,{collectionContextStore:t,property:o})}function Tc(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().VK)((()=>(0,tt().KV)({collectionContextStore:t,property:o})),[t,o]);return n&&("number"===n.type||"formula"===n.type||"rollup"===n.type)?(0,C.jsx)(Ss().z,{collectionContextStore:t,property:o}):null}function Ic(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().VK)((()=>(0,tt().KV)({collectionContextStore:t,property:o})),[t,o]),i=(0,r().VK)((()=>t.collectionStore()),[t]);return n&&"url"===n.type&&i?(0,C.jsx)(Sc,{collectionContextStore:t,property:o,propertySchema:n}):null}function Vc(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().VK)((()=>(0,tt().KV)({collectionContextStore:t,property:o})),[t,o]);return n&&"person"===n.type?(0,C.jsx)(ds,{collectionContextStore:t,propertySchema:n,property:o}):null}function Ac(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().VK)((()=>(0,tt().KV)({collectionContextStore:t,property:o})),[t,o]);return n&&"button"===n.type?(0,C.jsx)(Aa().fq,{collectionContextStore:t,propertySchema:n,propertyId:o}):null}function Zc(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().VK)((()=>(0,tt().KV)({collectionContextStore:t,property:o})),[t,o]);return n?(0,C.jsx)(fs,{collectionContextStore:t,propertySchema:n,property:o}):null}function Bc(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().VK)((()=>(0,tt().KV)({collectionContextStore:t,property:o})),[t,o]),i=(0,r().VK)((()=>{var e;const o=null===(e=t.collectionStore())||void 0===e?void 0:e.getRecordKeyStore();return null==o?void 0:o.getRecordKey()}),[t]);return n&&"auto_increment_id"===n.type?(0,C.jsx)(Ul,{uniqueIdProperty:{propertyId:o,propertySchema:n},prefixValue:i,collectionContextStore:t}):null}function Fc(e){let{collectionContextStore:t,property:o}=e;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Zc,{collectionContextStore:t,property:o}),(0,C.jsx)(Vc,{collectionContextStore:t,property:o})]})}function Rc(e){const{environment:t,property:o,propertySchema:i,collectionSettingsStore:l,collectionContextStore:a,collectionStore:c}=e,u=(0,r().VK)((()=>(0,go().q3)(i)),[i]),p=(0,r().VK)((()=>(0,za().mX)(t,os().Z.getMode(t,c),c)),[t,c]),g=(0,n.useMemo)((()=>{const e=i.name.trim(),t=Kn().SO[i.type],o=new RegExp(`${t}(?:\\s?\\d+)?`);return!e||o.test(e)}),[i.name,i.type]),m=(0,n.useCallback)((()=>{if(!c||!i||!(0,go().cu)(i))return;const e=(0,go().xo)(i);if(!e)return;const n=[];if(u)Za()._e(t,{type:"remove_ai_inference",ai_inference_type:u.type,collection_id:c.id}),n.push({pointer:c.pointer,command:"set",path:["schema",o,e],args:void 0});else{const r={type:i.type,auto_update_on_edit:!1,add_options:!1};Za()._e(t,{type:"set_ai_inference",ai_inference_type:r.type,collection_id:c.id}),n.push({pointer:c.pointer,command:"set",path:["schema",o,e],args:r})}(0,Ka().H)({environment:t,collectionStore:c,performTransaction:e=>{for(const t of n)d().applyOperation({store:(0,W().Kv)(c,t.pointer),operation:t,transaction:e})}})}),[u,c,t,o,i]),f=(0,n.useCallback)((e=>{if(!i||!c||!(0,go().qQ)(i))return;const n=(0,go().xo)(i);if(!n)return;const r={pointer:c.pointer,command:"set",path:["schema",o,n],args:e};(0,Ka().H)({environment:t,collectionStore:c,performTransaction:e=>{d().applyOperation({store:(0,W().Kv)(c,r.pointer),operation:r,transaction:e})}})}),[c,t,o,i]),y=(0,r().VK)((()=>bc(a)),[a]);return(0,r().VK)((()=>p&&"form_editor"!==y),[p,y])?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(ic,{disabled:!0,overrideStyle:{marginTop:6,paddingTop:6}},"aiSectionHeader"),(0,C.jsx)(ro().Z,{disableTooltip:!g,placement:ao().Placement.Left,renderTooltip:e=>(0,C.jsx)(I()._H,{...e,defaultMessage:"Update the property name to use AI autofill",id:"database.collectionsettings.autofilloptions.disableswitch.tooltip",description:"User needs to change the property name from the default name to turn on autofill"}),render:e=>(0,C.jsx)(yc().Z,{...e,title:(0,C.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,C.jsx)(I()._H,{defaultMessage:"AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.open"}),(0,C.jsx)(Ea().Z,{style:{display:"inline-block"}})]}),showChevron:!1,switcherProps:{on:Boolean(u),noColor:!1},onClick:m,disabled:!p||g}),style:{whiteSpace:"break-spaces"}}),u&&!g&&("select"===u.type||"multi_select"===u.type)&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Da,{setAiInference:f,aiInference:u,disabled:!p}),(0,C.jsx)(F().Z,{title:(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center",lineHeight:1.2,color:tn().ZP.uiGray},children:[(0,C.jsx)(I()._H,{id:"database.collectionsettings.aiAutofillOptions.more",defaultMessage:"More"}),(0,Pa().o)({fill:tn().ZP.uiGray,width:12,height:12,marginLeft:4})]}),disabled:!1,onClick:()=>{s().H4({collectionSettingsStore:l,item:{type:"propertyAiAutofill",propertySchema:i,property:o}})}})]})]}):null}function Kc(e){const{environment:t,property:o,propertySchema:n,collectionContextStore:i,collectionStore:l}=e,a=(0,r().VK)((()=>{var e;const t=(null===(e=ns().subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return(0,Va().de)(t)}),[]),s=(0,r().VK)((()=>{const e=i.collectionStore();return e&&(0,za().mX)(t,os().Z.getMode(t,e),e)}),[t,i]);return(0,r().VK)((()=>(0,go().cu)(n)&&n.select_ai_inference),[n])?(0,C.jsx)(Oa().TB,{environment:t,collectionContextStore:i,collectionStore:l,property:o,propertySchema:n,doesUserHaveAIAddOn:a,isAutofillSetupEnabled:Boolean(s)}):null}function Hc(e){let{propertySchema:t,collectionSettingsStore:o,collectionContextStore:n,property:l}=e;const a=(0,i().O7)(),s=(0,r().VK)((()=>n.collectionStore()),[n]);return s?(0,C.jsx)(nc,{collectionSettingsStore:o,collectionContextStore:n,property:l,disabled:!1,aIAutofillOption:(0,C.jsx)(Rc,{environment:a,collectionStore:s,collectionSettingsStore:o,collectionContextStore:n,property:l,propertySchema:t})}):null}function Oc(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().Kw)(t.normalizedSchemaStore)[o];let i;return i=(0,ka().Kp)(n)?(0,C.jsx)(gr().Z,{href:(0,ur().UY)("guides.githubRelation"),title:(0,C.jsx)(I()._H,{defaultMessage:"Learn about GitHub Pull Requests",id:"database.viewSettings.propertyTab.githubPrRelation.learnMoreButton.title"}),analyticsFrom:"view_settings_property_github_pr_relation"}):(0,C.jsx)(gr().Z,{href:(0,ur().UY)("guides.relations"),title:(0,C.jsx)(I()._H,{defaultMessage:"Learn about relations",id:"database.viewSettings.propertyTab.relations.learnMoreButton.title"}),analyticsFrom:"view_settings_property_relation"}),(0,C.jsx)(ee().Z,{topBorder:!0,children:i})}function Lc(e){let{collectionContextStore:t,property:o,collectionSettingsStore:n}=e;const i=(0,r().VK)((()=>(0,tt().KV)({collectionContextStore:t,property:o})),[t,o]),l=(0,r().VK)((()=>bc(t)),[t]);if(!i||"text"!==i.type||"form_editor"===l)return null;const a=(0,go().q3)(i);let c;return a&&(0,go().MD)(a.type)?"summarize"===a.type?c=Ua().Dr.autofillSummary:"extract"===a.type?c=Ua().Dr.autofillExtract:"custom"===a.type?c=Ua().Dr.autofillCustom:"translate"===a.type?c=Ua().Dr.autofillTranslate:(0,N().t1)(a):c=hs().Z.autofillOffLabel,(0,C.jsx)(F().Z,{title:(0,C.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,C.jsx)(I()._H,{defaultMessage:"AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.open"}),(0,C.jsx)(Ea().Z,{style:{display:"inline-block"}})]}),showChevron:!0,right:Co().Z.formatMessage(c),onClick:()=>function(e,t,o){const n=(0,tt().KV)({collectionContextStore:t,property:o});t.collectionStore()&&n&&s().H4({collectionSettingsStore:e,item:{type:"propertyAiAutofill",propertySchema:n,property:o}})}(n,t,o)})}function Dc(e){let{property:t,collectionContextStore:o}=e;const n=(0,i().O7)(),l=(0,r().VK)((()=>o.collectionStore()),[o]),a=(0,r().VK)((()=>(0,Kn().BX)(o)),[o]),s=(0,r().VK)((()=>Boolean((null==l?void 0:l.getDatabaseType())&&(null==l?void 0:l.isTypedProperty(t)))),[l,t]);return l?(0,C.jsx)(Na().Z,{disabled:s,context:Na().t.ViewSettings,property:t,schema:a,analyticsFrom:"view_settings",parentStore:l,onChange:e=>function(e,t,o,n){const i=n.collectionStore();i&&d().createAndCommit({userAction:"CollectionSettingsProperty.handleRollupPropertyMenuChange",environment:t,canUndo:!0,perform:n=>{(0,Jl().x)({environment:t,collectionStore:i,update:{[o]:e.propertySchema},transaction:n})}})}(e,n,t,o)}):null}function Ec(e){let{isRequiredTypedProperty:t,databaseType:o,collectionContextStore:n,property:r,collectionSettingsStore:l,formatKey:a}=e;const s=(0,f().Fg)(),c=(0,i().O7)();return(0,C.jsx)(ro().Z,{disableTooltip:!t,placement:ao().Placement.Left,renderTooltip:e=>(0,ct().A7)(o,e),render:e=>(0,C.jsx)(F().Z,{...e,isRed:!0,disabled:t,onClick:()=>vc(c,s,n,r,l,a),icon:()=>t?(0,C.jsx)("div",{...e,style:{display:"inline-flex"},children:(0,bl().Q)({width:14,marginLeft:4,marginRight:4})}):(0,T().y)({width:16,marginLeft:4,marginRight:4}),title:(0,C.jsx)(I()._H,{defaultMessage:"Delete property",id:"database.viewSettings.propertyTab.deleteButton.title"}),caption:c.device.isMobile&&t?(0,ct().A7)(o):null})})}function Nc(e){let{}=e;return(0,C.jsx)(gr().Z,{href:(0,ur().UY)("guides.databaseProperties"),title:(0,C.jsx)(I()._H,{defaultMessage:"Learn about properties",id:"database.viewSettings.propertiesTab.learnMoreButton.title"}),analyticsFrom:"view_settings_properties"})}function Uc(e){let{propertySchema:t,propertyFormat:l,isRequiredTypedProperty:a,databaseType:u,collectionContextStore:p,formatKey:g,property:m,collectionSettingsStore:f,wrapProperty:y}=e;const S=(0,i().O7)(),h=(0,o(409318).L)(),x=(0,n.useCallback)((()=>function(e,t,o,n,i){const r=wc({property:n,formatKey:o,collectionContextStore:t}),l=t.collectionViewStore(),a=t.normalizedFormatStore.state,s=(0,tt().KV)({collectionContextStore:t,property:n});s&&r&&l&&o&&s&&(qt().K4({currentValue:i,environment:e,property:n,collectionViewStore:l,format:a,formatKey:o}),Wt().wd({environment:e,collectionContextStore:t,action:"toggle_property_wrap",original_view_type:l.getType(),property_type:s.type}))}(S,p,g,m,y)),[S,p,g,m,y]),v=(0,r().VK)((()=>p.collectionStore()),[p]),b=(0,r().VK)((()=>bc(p)),[p]),w=(0,r().VK)((()=>Mn().Z.state.isOpen),[]),j=(0,r().VK)((()=>g&&("title"!==m||(0,dt().XO)({viewType:b,format:p.normalizedFormatStore.state}))&&"page"!==b),[g,m,b,p]),_=(0,r().VK)((()=>g&&(0,dt().w0)({viewType:b,property:m})),[g,m,b]),M=(0,r().VK)((()=>f.state.hideDuplicatePropertyOption),[f]),k=(0,go().g0)(t)&&Boolean(v)&&!w&&"form_editor"!==b&&!M,P=go().Tr.includes(t.type)&&v&&!w&&"form_editor"!==b,T="form_editor"===b;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(ee().Z,{topBorder:!0,disableMobilePadding:!h,children:[_&&l&&(0,C.jsx)(yc().Z,{icon:jr().s,iconStyle:{transform:"rotateX(180deg)"},title:(0,C.jsx)(I()._H,{defaultMessage:"Wrap in view",id:"database.viewSettings.propertyTab.wrapInViewButton.title"}),switcherProps:{on:y,disallowTabbing:!0},onClick:x}),(j||k||P||T)&&(0,C.jsxs)(C.Fragment,{children:[v&&(0,C.jsx)(Kc,{environment:S,collectionStore:v,collectionContextStore:p,property:m,propertySchema:t}),j&&l&&(null!=l&&l.visible?(0,C.jsx)(F().Z,{icon:o(259739).D,isPadded:!0,title:(0,C.jsx)(I()._H,{defaultMessage:"Hide in view",id:"database.viewSettings.propertyTab.hideInViewButton.title"}),onClick:()=>xc(S,p,g,m)}):(0,C.jsx)(F().Z,{icon:o(682547).N,isPadded:!0,title:(0,C.jsx)(I()._H,{defaultMessage:"Show in view",id:"database.viewSettings.propertyTab.showInViewButton.title"}),onClick:()=>xc(S,p,g,m)})),k&&(0,C.jsx)(F().Z,{icon:Ta().a,title:(0,C.jsx)(I()._H,{defaultMessage:"Duplicate property",id:"database.viewSettings.propertyTab.duplicateButton.title"}),onClick:()=>async function(e,t,o,n,i){const r=Cc({formatKey:i,collectionContextStore:o}),l=o.normalizedSchemaStore.state,a=o.collectionStore(),u=null==a?void 0:a.getSpaceId();if(!a||!u)return;const p=(0,ka().Qm)({schema:l,property:t});if(!p)return;const g=a.getNormalizedPropertyGroups(),m=await(0,dt().xy)({environment:e,schema:l,property:t,properties:r,propertyGroups:g,parentStore:a,spaceId:u});if(!m)return;const f=e.currentUser.id,y=f?{id:f,table:Ia().KJ}:void 0,S=o.collectionViewStore();d().createAndCommit({userAction:"CollectionSettingsProperty.handleDuplicateClick",environment:e,canUndo:!0,perform:n=>{(0,N().$K)(m.automationUpdate)&&Ra().duplicateAutomation({actorPointer:y,environment:e,sourceAutomationStore:m.automationUpdate.sourceAutomationStore,targetAutomationId:m.automationUpdate.targetAutomationId,transaction:n});const r={...l,[m.newProperty]:m.newPropertySchema},s={...a.getFormat(),collection_page_properties:m.newProperties,property_groups:m.newPropertyGroups};(0,Ha().R)({environment:e,collectionStore:a,update:{schema:r,format:s},transaction:n});const d=jc({property:t,formatKey:i,collectionContextStore:o});qt().oz({environment:e,collectionContextStore:o,currentIndex:d,entrypoint:"CollectionSettingsProperty",transaction:n,propertyAction:"duplicate"}),i&&S&&c().FH({stores:[S],update:{[i]:m.newProperties},transaction:n})}}),s().E3({collectionSettingsStore:n}),Wt().wd({environment:e,collectionContextStore:o,action:"duplicate_property",original_view_type:null==S?void 0:S.getType(),property_type:p.type})}(S,m,p,f,g)}),P&&(0,C.jsx)(Ec,{collectionContextStore:p,property:m,collectionSettingsStore:f,formatKey:g,isRequiredTypedProperty:a,databaseType:u}),T&&(0,C.jsx)(Nc,{})]})]}),"formula"===t.type&&(0,C.jsx)(ee().Z,{topBorder:!0,children:(0,C.jsx)(gr().Z,{href:(0,ur().UY)("guides.formulas"),title:(0,C.jsx)(I()._H,{defaultMessage:"Learn about formulas",id:"database.viewSettings.propertyTab.formulas.learnMoreButton.title"}),analyticsFrom:"view_settings_property_formula"})}),"relation"===t.type&&(0,C.jsx)(Oc,{collectionContextStore:p,property:m}),"rollup"===t.type&&(0,C.jsx)(ee().Z,{topBorder:!0,children:(0,C.jsx)(gr().Z,{href:(0,ur().UY)("guides.relations"),title:(0,C.jsx)(I()._H,{defaultMessage:"Learn about rollups",id:"database.viewSettings.propertyTab.rollups.learnMoreButton.title"}),analyticsFrom:"view_settings_property_relation"})})]})}function zc(e){let{property:t,propertySchema:o,collectionContextStore:l}=e;const a=(0,i().O7)(),s=l.settingsStore,c=(0,r().VK)((()=>(0,za().Zt)(a)),[a]);return(0,n.useMemo)((()=>"button"===o.type),[o.type])?null:(0,C.jsxs)(C.Fragment,{children:[c&&"text"===o.type&&(0,C.jsx)(Lc,{collectionContextStore:l,property:t,collectionSettingsStore:s}),(0,go().cu)(o)&&(0,C.jsx)(Hc,{collectionSettingsStore:s,collectionContextStore:l,property:t,propertySchema:o}),"status"===o.type&&(0,C.jsx)(_c,{collectionSettingsStore:s,collectionContextStore:l,property:t}),"formula"===o.type&&(0,C.jsx)(Mc,{collectionContextStore:l,collectionSettingsStore:s,property:t}),"rollup"===o.type&&(0,C.jsx)(Dc,{property:t,collectionContextStore:l}),("date"===o.type||"created_time"===o.type||"last_edited_time"===o.type)&&(0,C.jsx)(kc,{collectionContextStore:l,property:t}),"relation"===o.type&&(0,C.jsx)(Pc,{collectionContextStore:l,property:t}),"person"===o.type&&(0,C.jsx)(Fc,{collectionContextStore:l,property:t}),(0,C.jsx)(Tc,{collectionContextStore:l,property:t}),(0,C.jsx)(Ic,{collectionContextStore:l,property:t}),"auto_increment_id"===o.type&&(0,C.jsx)(Bc,{collectionContextStore:l,property:t}),"button"===o.type&&(0,C.jsx)(Ac,{collectionContextStore:l,property:t})]})}var Wc=()=>o(704923),qc=()=>o(437187),Gc=()=>o(949489),Yc=()=>o(57194),$c=()=>o(207874),Qc=()=>o(351763),Jc=()=>o(78078),Xc=()=>o(292518),ed=()=>o(718959),td=()=>o(549813);const od=(0,I().vU)({autoUpdateExplanationMessage:{defaultMessage:"Keep values updated with the latest edits to pages",id:"database.CollectionSettingsPropertyAiAutofill.autoUpdateExplanationMessage"},onlyWithAiAddOnMessage:{defaultMessage:"Only with Notion AI add-on",id:"database.CollectionSettingsPropertyAiAutofill.onlyWithAiAddOnMessage"},updateOnPageEdits:{defaultMessage:"Auto-update on page edits",id:"database.viewSettings.propertyTab.aiAutofill.updateOnPageEdits"}});function nd(e){let{collectionContextStore:t,environment:o,setAiInference:i,aiInference:r,doesUserHaveAIAddOn:l}=e;const a=(0,n.useRef)(Gr().Il()),s=(0,n.useCallback)((()=>{if(!t.collectionStore())return;if(!r)return;if(!(l||null!=r&&r.auto_update_on_edit))return void Qc().triggerAiAutofillUpsell({environment:o,from:"ai_autofill_on_page_edit"});const e={...r,auto_update_on_edit:!r.auto_update_on_edit};i(e)}),[t,r,l,i,o]);return r?(0,C.jsx)(ro().Z,{renderTooltip:()=>(0,C.jsxs)("div",{style:{width:159},children:[(0,C.jsx)("div",{style:{color:"white",fontWeight:500,wordWrap:"break-word",whiteSpace:"pre-wrap"},children:(0,C.jsx)(I()._H,{...od.autoUpdateExplanationMessage})}),!l&&(0,C.jsx)("div",{style:{color:"#ACABA9",fontWeight:500},children:(0,C.jsx)(I()._H,{...od.onlyWithAiAddOnMessage})})]}),render:e=>(0,C.jsx)(yc().Z,{title:(0,C.jsx)(I()._H,{...od.updateOnPageEdits}),showChevron:!1,switcherProps:{inputId:a.current,on:!!r.auto_update_on_edit,noColor:!1},onClick:s,disabled:!1,textWrapperStyle:{minWidth:"auto"},...e})}):null}var id=()=>o(521913),rd=()=>o(206352);const ld=(0,I().vU)({optionsSectionTitle:{defaultMessage:"Options",id:"database.viewSettings.propertyTab.aiAutofill.optionsSectionTitle"},extractPromptSectionTitle:{defaultMessage:"What key info to extract?",id:"database.viewSettings.propertyTab.aiAutofill.extractPromptSectionTitle"},customPromptSectionTitle:{defaultMessage:"What to generate?",id:"database.viewSettings.propertyTab.aiAutofill.customPromptSectionTitle"},extractPromptInputPlaceholder:{defaultMessage:"e.g. “Key topics in bullets” or “People mentioned on the page”",id:"database.viewSettings.propertyTab.aiAutofill.extractPromptInputPlaceholder"},customPromptInputPlaceholder:{defaultMessage:"Tell AI what to generate from page content and properties…",id:"database.viewSettings.propertyTab.aiAutofill.customPromptInputPlaceholder"}});function ad(e){var t;let{environment:o,aiInference:i,setAiInference:l,collectionContextStore:a,isAutofillSetupEnabled:s,shouldShowUserPromptIsInvalidError:c,setShouldShowUserPromptIsInvalidError:d}=e;const u=function(e){if(!e)return;switch(e.type){case"summarize":case"translate":return;case"extract":return{aiInferenceType:e.type,sectionTitle:ld.extractPromptSectionTitle,inputPlaceholder:ld.extractPromptInputPlaceholder,value:e.prompt};case"custom":case"select":case"multi_select":return{aiInferenceType:e.type,sectionTitle:ld.customPromptSectionTitle,inputPlaceholder:ld.customPromptInputPlaceholder,value:e.prompt};default:(0,N().t1)(e)}}(i),p=(0,r().VK)((()=>(0,Kn().k4)()),[]),g=(0,n.useCallback)((e=>{if(a.collectionStore()&&u)switch(e.target.value&&e.target.value.length<=Wc().Th?d(!1):e.target.value.length>Wc().Th&&d(!0),u.aiInferenceType){case"extract":case"custom":l({type:u.aiInferenceType,prompt:e.target.value,auto_update_on_edit:(null==i?void 0:i.auto_update_on_edit)??p});break;case"select":case"multi_select":l({type:u.aiInferenceType,prompt:e.target.value,auto_update_on_edit:(null==i?void 0:i.auto_update_on_edit)??p,add_options:((null==i?void 0:i.type)===u.aiInferenceType&&(null==i?void 0:i.add_options))??!1});break;case"summarize":case"translate":return;default:(0,N().t1)(u.aiInferenceType)}}),[i,a,p,u,l,d]),m=(0,Xs().w)(),y=(0,f().yK)((e=>({inputOuterStyle:{margin:o.device.isMobile?"8px 0":0,border:c?"1px solid red":void 0,backgroundColor:m?e.white:void 0}})),[o.device.isMobile,m,c]);return u?(0,C.jsxs)(ee().Z,{title:Co().Z.formatMessage(u.sectionTitle),isInput:!0,style:{marginTop:-4},children:[(0,C.jsx)(rd().Z,{debugName:"CollectionSettingsAiAutofillPromptInput",capture:!0,allowEsc:!0,children:(0,C.jsx)(xo().ZP,{inputOuterStyle:y.inputOuterStyle,type:"text",value:u.value||"",onChange:g,placeholder:Co().Z.formatMessage(u.inputPlaceholder),textarea:!0,disabled:!s,autosize:!0,autosizeMinHeight:100,autosizeMaxHeight:600},u.aiInferenceType)}),c&&(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center",paddingLeft:12,fontSize:12},children:[(0,id().t)({width:12,height:12,fill:"#D34F43"}),(0,C.jsx)("div",{style:{color:"#D34F43",paddingLeft:4},children:((null===(t=u.value)||void 0===t?void 0:t.length)??0)>Wc().Th?(0,C.jsx)(I()._H,{defaultMessage:"Instruction is too long",id:"CollectionSettings.propertyTab.aiAutofill.promptInput.exceedsMaxLength"}):(0,C.jsx)(I()._H,{defaultMessage:"Required",id:"CollectionSettings.propertyTab.aiAutofill.promptInput.required"})})]})]}):null}function sd(e){const{collectionContextStore:t,isAutofillSetupEnabled:o,draftAiInference:n,setDraftAiInference:i,environment:r,shouldShowUserPromptIsInvalidError:l,setShouldShowUserPromptIsInvalidError:a,doesUserHaveAIAddOn:s}=e;return n?"select"!==n.type&&"multi_select"!==n.type?null:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(ee().Z,{style:{marginBottom:10},children:[(0,C.jsx)(nd,{collectionContextStore:t,environment:r,setAiInference:i,aiInference:n,doesUserHaveAIAddOn:s}),(0,C.jsx)(Da,{setAiInference:i,aiInference:n})]}),n&&(0,C.jsx)(ee().Z,{topBorder:!0,children:(0,C.jsx)(ad,{environment:r,aiInference:n,setAiInference:i,collectionContextStore:t,isAutofillSetupEnabled:o,shouldShowUserPromptIsInvalidError:l,setShouldShowUserPromptIsInvalidError:a})})]}):null}var cd=()=>o(999673),dd=()=>o(838367);const ud=new(xt().Z),pd=(0,I().vU)({optionsSectionTitle:{defaultMessage:"Options",id:"database.viewSettings.propertyTab.aiAutofill.optionsSectionTitle"},whatToTranslate:{defaultMessage:"What to translate?",id:"CollectionSettingsPropertyAiAutofill.translateProperty.propertySelector"},translateTo:{defaultMessage:"Translate to",id:"CollectionSettingsPropertyAiAutofill.translateProperty.languageSelector"},selectorSearchPlaceholder:{defaultMessage:"Search",id:"CollectionSettingsPropertyAiAutofill.selectorOption.searchbar.placeholder"},allProperties:{defaultMessage:"All properties",id:"CollectionSettingsPropertyAiAutofill.selectorOption.allProperties.checkbox"},noAiAutofillSelected:{defaultMessage:"Select an option",id:"database.CollectionSettingsPropertyAiAutofill.noAiAutofillSelected"}});function gd(e){const{collectionContextStore:t,propertySchema:o,previousPromptByAiInferenceType:i,isAutofillSetupEnabled:r,draftAiInference:l,setDraftAiInference:a,environment:s,propertyId:c,collectionSchema:d,shouldShowUserPromptIsInvalidError:u,setShouldShowUserPromptIsInvalidError:p,doesUserHaveAIAddOn:g}=e,m=(0,f().Fg)(),y=(0,n.useMemo)((()=>[new(xt().Z),new(xt().Z)]),[]),S=(0,n.useMemo)((()=>function(e){var t;let{environment:o,aiInference:n,collectionSchema:i,setAiInference:r,property:l,theme:a,optionsButtonPopupStores:s}=e;if(!n||!(0,go().MD)(n.type))return[];switch(n.type){case"summarize":case"extract":case"custom":return[];case"translate":const e=fi().oA((0,N().Yd)(i).map((e=>{if(e===l)return;const t=i[e];if(t&&(0,cd().K9)(t)){var o;if("text"===t.type&&"translate"===(null===(o=t.ai_inference)||void 0===o?void 0:o.type))return;return{id:e,option:t.name,icon:(0,C.jsx)(mo().ZP,{icon:t.icon,type:t.type,theme:a,size:16})}}}))),o=e.findIndex((e=>"title"===e.id));if(o&&o>0){const t=e[o];e.splice(o,1),e.unshift(t)}for(;s.length<2;)s.push(new(xt().Z));return[{type:"multi",options:e,selectedIds:(null===(t=n.targetProperties)||void 0===t?void 0:t.length)>0?n.targetProperties:["title"],setSelectedIds:e=>{r({...n,targetProperties:e})},selectorTitle:pd.whatToTranslate,selectAllTitle:pd.allProperties,buttonPopupStore:s[0]},{type:"single",options:cd().nI.map((e=>{let{key:t,name:o}=e;return{id:t,option:Co().Z.formatMessage(o)}})),selectedId:n.toLanguage,onSelect:e=>{r({...n,toLanguage:e})},selectorTitle:pd.translateTo,buttonPopupStore:s[1]}];default:(0,N().t1)(n)}}({environment:s,aiInference:l,collectionSchema:d,setAiInference:a,property:c,theme:m,optionsButtonPopupStores:y})),[s,l,d,a,c,m,y]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(ee().Z,{style:{marginBottom:10},children:[(0,C.jsx)(md,{propertySchema:o,previousPromptByAiInferenceType:i,draftAiInference:l,setDraftAiInference:a,environment:s}),(0,go().by)(l,"text")&&(0,C.jsx)(nd,{collectionContextStore:t,environment:s,setAiInference:a,aiInference:l,doesUserHaveAIAddOn:g})]}),(0,go().by)(l,"text")&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(ee().Z,{topBorder:!0,children:(0,C.jsx)(ad,{environment:s,aiInference:l,setAiInference:a,collectionContextStore:t,isAutofillSetupEnabled:r,shouldShowUserPromptIsInvalidError:u,setShouldShowUserPromptIsInvalidError:p})}),(0,C.jsx)(yd,{environment:s,optionProps:S})]})]})}function md(e){let{propertySchema:t,previousPromptByAiInferenceType:o,draftAiInference:i,setDraftAiInference:l,environment:a}=e;const s=(0,r().VK)((()=>(0,Kn().k4)()),[]),c=(0,n.useCallback)((e=>{var n,i,r,a,c,d,u,p;if(!t||!(0,go().qQ)(t)||!e)return;let g;switch(e){case"summarize":g={type:e,auto_update_on_edit:s};break;case"translate":g={type:e,auto_update_on_edit:s,targetProperties:(null===(n=t.ai_inference)||void 0===n?void 0:n.type)===e?null===(i=t.ai_inference)||void 0===i?void 0:i.targetProperties:["title"],toLanguage:(null===(r=t.ai_inference)||void 0===r?void 0:r.type)===e?null===(a=t.ai_inference)||void 0===a?void 0:a.toLanguage:"english"};break;case"extract":g={type:e,prompt:(null===(c=t.ai_inference)||void 0===c?void 0:c.type)===e?null===(d=t.ai_inference)||void 0===d?void 0:d.prompt:o[e]??"",auto_update_on_edit:s};break;case"custom":g={type:e,prompt:(null===(u=t.ai_inference)||void 0===u?void 0:u.type)===e?null===(p=t.ai_inference)||void 0===p?void 0:p.prompt:o[e]??"",auto_update_on_edit:s};break;default:(0,N().t1)(e)}l(g)}),[s,o,t,l]),d=(0,f().Fg)();return t&&(0,go().qQ)(t)?(0,C.jsx)(G().ZP,{popupType:a.device.isMobile?G().Z4.SlideUp:G().Z4.Popup,buttonPopupStore:ud,render:e=>{const t={key:"section",render:e=>(0,C.jsx)(ee().Z,{...e}),items:fi().oA(Object.keys(Ua().OE.text).map((t=>{if((0,go().MD)(t))return{key:t,render:e=>{const o=Ua().OE.text[t];return(0,C.jsx)(q().Z,{focused:!1,onClick:e.onClick,icon:o.svg({height:20,width:24,fill:d.aiPurpleColor}),title:Co().Z.formatMessage(o.name),checkState:(null==i?void 0:i.type)===t})},action:()=>{e.close(),c(t)}}})))};return(0,C.jsx)($().Z,{menuType:na().o.Popup,minWidth:260,maxWidth:"100vw",children:(0,C.jsx)(Q().ZP,{type:Q().iW.Vertical,initialFocus:void 0,sections:[t]})})},renderOrigin:e=>{let{onClick:t}=e;return(0,C.jsx)(q().Z,{focused:!1,onClick:t,title:(0,C.jsx)(I()._H,{defaultMessage:"Fill with",id:"CollectionSettingsPropertyAiAutofill.ClosedSelector.Title"}),right:(0,C.jsx)(fd,{aiActionType:null==i?void 0:i.type})})}}):null}function fd(e){let{aiActionType:t}=e;const o=(0,f().Fg)(),n=t&&(0,go().MD)(t)?Ua().OE.text[t]:{name:pd.noAiAutofillSelected,svg:()=>null};return(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer",fontSize:14,paddingLeft:15,paddingBottom:0},children:[(0,C.jsx)("div",{style:{color:o.lightIconColor},children:n.svg({height:16,width:16,marginRight:2})}),(0,C.jsx)("div",{style:{color:o.lightTextColor,paddingLeft:4},children:(0,C.jsx)(I()._H,{...n.name})}),(0,C.jsx)("div",{style:{color:o.lightIconColor,paddingLeft:4},children:(0,Pa().o)({height:12,width:12})})]})}function yd(e){let{environment:t,optionProps:o}=e;return o&&o.length>0?(0,C.jsx)(ee().Z,{title:Co().Z.formatMessage(pd.optionsSectionTitle),isInput:!0,style:{marginTop:-4},children:o.map(((e,o)=>"multi"===e.type?(0,C.jsx)(Sd,{environment:t,options:e.options,selectedIds:e.selectedIds,setSelectedIds:e.setSelectedIds,selectorTitle:e.selectorTitle,selectAllTitle:e.selectAllTitle,buttonPopupStore:e.buttonPopupStore},o):(0,C.jsx)(hd,{environment:t,options:e.options,selectedId:e.selectedId,onSelect:e.onSelect,selectorTitle:e.selectorTitle,buttonPopupStore:e.buttonPopupStore},o)))}):null}function Sd(e){let{environment:t,options:o,selectedIds:i,setSelectedIds:l,selectorTitle:a,selectAllTitle:s,buttonPopupStore:c}=e;const[d,u]=(0,n.useState)(""),p=(0,f().Fg)(),g=o.filter((e=>i.includes(e.id))),m=(0,r().VK)((()=>fi().jj(fi().MR(o.map((e=>e.id)))).join(",")===fi().jj(fi().MR(i)).join(",")),[o,i]),y=e=>{i.includes(e)?l(i.filter((t=>t!==e))):l(fi().jj([...i,e]))},S=()=>{i.length<o.length?l(o.map((e=>e.id))):l(["title"])},h=(0,C.jsx)(ee().Z,{desktopStyle:{paddingTop:12,paddingBottom:4},children:(0,C.jsx)(xo().ZP,{focusInitial:!t.device.isMobile||void 0,focus:!t.device.isMobile||void 0,value:d,onChange:e=>{u(e.target.value)},placeholder:Co().Z.formatMessage(pd.selectorSearchPlaceholder)})});return(0,C.jsx)(G().ZP,{popupType:t.device.isMobile?G().Z4.SlideUp:G().Z4.Popup,buttonPopupStore:c,render:e=>{const t=o.filter((e=>{var t;const o=null===(t=e.option)||void 0===t?void 0:t.toLowerCase();return-1!==(null==o?void 0:o.indexOf(d.toLowerCase()))})).map((e=>{let{id:t,option:o,icon:n}=e;return{key:t,render:e=>(0,C.jsx)(q().Z,{focused:!1,onClick:e.onClick,left:(0,C.jsx)(ho().Z,{checked:i.includes(t),size:14,checkSize:8,onClick:e=>{y(t)}}),icon:n,title:o}),action:()=>{y(t)}}})),n={key:"section",render:e=>(0,C.jsx)(ee().Z,{...e,topBorder:!0}),items:t},r={key:"all-items",render:e=>(0,C.jsx)(ee().Z,{...e}),items:[{key:"all-items",render:e=>(0,C.jsx)(q().Z,{focused:!1,onClick:()=>{S()},left:(0,C.jsx)(ho().Z,{checked:m,size:14,checkSize:8,onClick:()=>{S()}}),title:Co().Z.formatMessage(s)}),action:()=>{S()}}]};return(0,C.jsxs)($().Z,{menuType:na().o.Popup,minWidth:260,maxWidth:"100vw",children:[h,0===t.length?(0,C.jsx)(ee().Z,{children:(0,C.jsx)(dd().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"No results",id:"CollectionSettingsPropertyAiAutofill.searchBar.noResults.label"})})}):(0,C.jsx)(Q().ZP,{type:Q().iW.Vertical,initialFocus:void 0,sections:[r,n]})]})},renderOrigin:e=>(0,C.jsx)(F().Z,{title:Co().Z.formatMessage(a),showChevron:!0,right:(0,C.jsx)("div",{style:{color:p.lightTextColor,paddingLeft:4,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"90%"},children:fi().oA(g.map((e=>{let{id:t,option:o,icon:n}=e;return o}))).join(", ")}),rightStyle:{flexShrink:1},rotateChevron:c.state.open,disabled:!1,textWrapperStyle:{minWidth:"auto"},...e})})}function hd(e){let{environment:t,options:o,selectedId:i,onSelect:r,selectorTitle:l,buttonPopupStore:a}=e;const[s,c]=(0,n.useState)(""),d=o.find((e=>e.id===i)),u=(0,f().Fg)(),p=(0,C.jsx)(ee().Z,{desktopStyle:{paddingTop:12,paddingBottom:4},children:(0,C.jsx)(xo().ZP,{focusInitial:!t.device.isMobile||void 0,focus:!t.device.isMobile||void 0,value:s,onChange:e=>{c(e.target.value)},placeholder:Co().Z.formatMessage(pd.selectorSearchPlaceholder)})});return(0,C.jsx)(G().ZP,{popupType:t.device.isMobile?G().Z4.SlideUp:G().Z4.Popup,buttonPopupStore:a,render:e=>{const t=o.filter((e=>{var t;return-1!==(null===(t=e.option)||void 0===t?void 0:t.toLowerCase().indexOf(s.toLowerCase()))})).map((t=>{let{id:o,option:n,icon:l}=t;return{key:o,render:e=>(0,C.jsx)(q().Z,{focused:!1,onClick:e.onClick,icon:l,title:n,checkState:o===i}),action:()=>{e.close(),r(o)}}})),n={key:"section",render:e=>(0,C.jsx)(ee().Z,{...e}),items:t};return(0,C.jsxs)($().Z,{menuType:na().o.Popup,minWidth:260,maxWidth:"100vw",children:[p,0===t.length?(0,C.jsx)(ee().Z,{children:(0,C.jsx)(dd().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"No results",id:"CollectionSettingsPropertyAiAutofill.searchBar.noResults.label"})})}):(0,C.jsx)(Q().ZP,{type:Q().iW.Vertical,initialFocus:void 0,sections:[n]})]})},renderOrigin:e=>(0,C.jsx)(F().Z,{title:Co().Z.formatMessage(l),showChevron:!0,right:d&&(0,C.jsxs)(C.Fragment,{children:[d.icon,(0,C.jsx)("div",{style:{color:u.lightTextColor,paddingLeft:4,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"90%"},children:d.option})]}),rightStyle:{flexShrink:1},rotateChevron:a.state.open,disabled:!1,textWrapperStyle:{minWidth:"auto"},...e})})}const xd=(0,I().vU)({optionsSectionTitle:{defaultMessage:"Options",id:"database.viewSettings.propertyTab.aiAutofill.optionsSectionTitle"},removeAutofillButton:{defaultMessage:"Turn off AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.removeAutofillButton"},toggleFillWithAiSectionLabel:{defaultMessage:"Actions",id:"database.viewSettings.propertyTab.aiAutofill.actionsSectionLabel"},confirmOverwriteExistingPropertyValues:{defaultMessage:"Filling “{propertyName}” with AI will overwrite any existing values of the property. Are you sure you want to continue?",id:"database.viewSettings.propertyTab.aiAutofill.confirmOverwriteModal"},noAiAutofillSelected:{defaultMessage:"Select an option",id:"database.CollectionSettingsPropertyAiAutofill.noAiAutofillSelected"}});function vd(e){const{property:t,collectionContextStore:o,collectionSettingsStore:l}=e,a=(0,r().VK)((()=>o.normalizedSchemaStore.state[t]),[t,o.normalizedSchemaStore]),c=(0,r().VK)((()=>o.collectionStore()),[o]),u=(0,r().VK)((()=>o.normalizedSchemaStore.getState()),[o]),p=a&&(0,go().qQ)(a)?(0,go().q3)(a):void 0,m=(0,i().O7)(),f=(0,I().YB)(),y=bd(),S=(0,r().VK)((()=>{const e=o.collectionStore();return e&&(0,za().mX)(m,os().Z.getMode(m,e),e)}),[m,o]),h=oi().default.createValue({stage:"not_started"},{name:"tryAutofillStore"});(0,n.useEffect)((()=>{var e,n;if("page"===o.getViewType())return;if(!1!==(null===(e=o.getPropertyFormat(t))||void 0===e?void 0:e.visible))return;const i=new(Fr().Z)({name:"CollectionSettingsPropertyAiAutofill"});m.defaultRecordCache.inMemoryRecordCache.addCacheOverride(i);const r=null===(n=o.formatStore())||void 0===n?void 0:n.clone(i),l=o.getPropertyFormatKey();return r&&l&&d().createAndCommit({userAction:"CollectionSettingsPropertyAiAutofill.open",environment:m,canUndo:!0,perform:e=>{at().er({formatStore:r,formatKey:l,property:t,update:{visible:!0},transaction:e})}}),()=>{m.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(i)}}),[o,m,t]);const x=(0,n.useRef)({}),v=(0,r().VK)((()=>(0,Kn().k4)()),[]),[b,w]=(0,n.useState)(a&&Qc().getDefaultAiInference(a,v)),[j,_]=(0,n.useState)(!1),M=(0,n.useCallback)((()=>{const e=o.collectionStore();if(!e||!a||!(0,go().qQ)(a))return;const n=(0,go().q3)(a);n&&"prompt"in n&&(x.current={...x.current,[n.type]:n.prompt}),Qc().saveOrRemovePropertyAiInference({environment:m,propertySchema:a,collectionStore:e,property:t,draftAiInference:b})}),[o,a,b,t,m]),k=(0,r().VK)((()=>{const e=o.collectionStore();return e?(0,td().vU)({environment:m,intl:f,store:e}):(0,qc().Q2)(f)}),[o,m,f]),P=(0,n.useCallback)((async()=>{if(a&&(0,go().qQ)(a)&&fi().Xy(b,(0,go().q3)(a)))s().E3({collectionSettingsStore:l});else if(b){var e;if("prompt"in b)if((0,go().DS)(b)&&0===(null===(e=b.prompt)||void 0===e?void 0:e.length)||(0,N().$K)(b.prompt)&&b.prompt.length>Wc().Th)return void _(!0);(null==p||!p.auto_update_on_edit)&&null!=b&&b.auto_update_on_edit&&v&&a?await Yc().r({sourceAction:"auto_update",propertyName:a.name,collectionName:k})&&M():M()}}),[k,l,p,b,M,v,a]),V=(0,n.useCallback)((()=>{const e=o.collectionStore();e&&p&&a&&(Qc().saveOrRemovePropertyAiInference({environment:m,propertySchema:a,collectionStore:e,property:t,draftAiInference:null}),s().z$({collectionSettingsStore:l}))}),[o,p,m,a,t,l]),Z=a&&(0,go().qQ)(a)&&fi().Xy(b,(0,go().q3)(a)),R=(0,n.useCallback)((async()=>new Promise((e=>{A().vC({showCancel:!1,keepFocus:!1,message:(0,C.jsxs)(Jc().sg,{alignItems:"center",gap:8,children:[(0,Gc().y)(y.confirmDiscardChangesDialogIconStyle),(0,C.jsx)("div",{style:y.confirmDiscardChangesDialogMessageStyle,children:(0,C.jsx)(I()._H,{defaultMessage:"Do you want to discard changes for AI autofill?",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.message"})})]}),items:[{label:(0,C.jsx)(I()._H,{defaultMessage:"Discard",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.acceptLabel"}),color:"red",onAccept:()=>e(!0)},{label:(0,C.jsx)(I()._H,{defaultMessage:"Continue editing",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.cancelLabel"}),onAccept:()=>e(!1)}]})}))),[y]),K=(0,n.useCallback)((async()=>{(Z||await R())&&s().z$({collectionSettingsStore:l})}),[Z,l,R]),H=(0,n.useCallback)((async()=>{(Z||await R())&&s().E3({collectionSettingsStore:l})}),[Z,l,R]),O=(0,r().VK)((()=>{var e;const t=(null===(e=ns().subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return(0,Va().de)(t)}),[]);return a&&(0,go().qQ)(a)&&c?(0,C.jsx)(g().Z,{debugName:"CollectionSettingsPropertyAiAutofill",capture:!0,onEsc:H,children:(0,C.jsxs)(B().ZP,{...e,title:(0,C.jsx)(I()._H,{defaultMessage:"Fill “{propertyName}” with AI",id:"database.viewSettings.propertyTab.aiAutofill.title",values:{propertyName:a.name}}),handleBackArrowClick:K,handleClose:H,children:[!S&&(0,C.jsx)(ee().Z,{style:y.menuItemStyle,children:(0,C.jsx)(I()._H,{defaultMessage:"You don't have permission to set up AI autofill on this database.",id:"database.viewSettings.propertyTab.aiAutofill.noSetupPermission"})}),"text"===a.type&&(0,C.jsx)(gd,{collectionContextStore:o,propertySchema:a,previousPromptByAiInferenceType:x.current,isAutofillSetupEnabled:Boolean(S),draftAiInference:b,setDraftAiInference:w,environment:m,propertyId:t,collectionSchema:u,shouldShowUserPromptIsInvalidError:j,setShouldShowUserPromptIsInvalidError:_,doesUserHaveAIAddOn:O}),(0,go().cu)(a)&&(0,C.jsx)(sd,{collectionContextStore:o,isAutofillSetupEnabled:Boolean(S),draftAiInference:b,setDraftAiInference:w,environment:m,shouldShowUserPromptIsInvalidError:j,setShouldShowUserPromptIsInvalidError:_,doesUserHaveAIAddOn:O}),(0,go().by)(b,a.type)&&(0,C.jsxs)(ee().Z,{children:[(0,C.jsx)(Cd,{environment:m,isAutofillSetupEnabled:S,collectionContextStore:o,tryAutofillStore:h,propertySchema:a,property:t,aiInference:b}),(0,C.jsx)(X().Z,{style:{...y.buttonStyle,margin:"8px 12px 12px 12px",display:Z?"none":"flex"},onClick:P,disabled:!S,children:Z?(0,C.jsx)(I()._H,{defaultMessage:"Done",id:"database.viewSettings.propertyTab.aiAutofill.saveButtonAllSaved"}):(0,C.jsx)(I()._H,{defaultMessage:"Save changes",id:"database.viewSettings.propertyTab.aiAutofill.saveButtonWithChanges"})})]}),(0,C.jsxs)(ee().Z,{topBorder:!0,title:m.device.isMobile&&Co().Z.formatMessage(xd.toggleFillWithAiSectionLabel),children:[(0,go().by)(p,a.type)&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Oa().TB,{environment:m,collectionContextStore:o,collectionStore:c,property:t,propertySchema:a,doesUserHaveAIAddOn:O,isAutofillSetupEnabled:Boolean(S)}),(0,C.jsx)(F().Z,{icon:T().y,isRed:!0,focused:!1,title:Co().Z.formatMessage(xd.removeAutofillButton),onClick:V,disabled:!S})]}),(0,C.jsx)(gr().Z,{href:(0,ur().UY)("guides.aiAutofill"),title:(0,C.jsx)(I()._H,{defaultMessage:"Learn about AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.learnMoreLink"}),analyticsFrom:"collection_ai_autofill_menu"})]})]})}):null}function Cd(e){let{environment:t,isAutofillSetupEnabled:o,collectionContextStore:i,tryAutofillStore:l,propertySchema:a,property:s,aiInference:c}=e;const[d,u]=(0,n.useState)(Gr().Il()),p=(0,n.useRef)(Gr().Il()),g=(0,r().VK)((()=>l.state.stage),[l]),m=(0,r().VK)((()=>{const e=i.contextType;if("collectionPage"===e)return{type:"page",candidateBlockStores:fi().oA([(0,ed().np)()])};if("collectionTypedView"===e||"collectionView"===e)return{type:"collection",candidateBlockStores:i.resultsInViewOrder(5)};throw new Error(`Unexpected context type: ${e}`)}),[i]),f=(0,n.useCallback)((()=>{var e;Za().qG(t,{ai_inference_type:c.type,type:"undo_from_collection_settings",inference_id:d,collection_id:null===(e=i.collectionStore())||void 0===e?void 0:e.id,session_id:p.current}),"not_started"!==g&&($c().Yw(t,!1),l.setState({stage:"not_started"}))}),[t,c,d,i,g,l]),y=(0,N().Of)(m.candidateBlockStores),S=bd({isTryAutofillEnabled:o&&y}),h=Boolean((0,n.useContext)($a().eK));if(t.device.isMobile||h)return null;let x;return x=y?"collection"===m.type?(0,C.jsx)(I()._H,{defaultMessage:"Updates the first {maxPages} pages. You can undo changes anytime.",id:"database.viewSettings.propertyTab.aiAutofill.tryOnCollectionDescription",values:{maxPages:5}}):(0,C.jsx)(I()._H,{defaultMessage:'Updates "{propertyName}" on this page. You can undo changes anytime.',id:"database.viewSettings.propertyTab.aiAutofill.tryOnPageDescription",values:{propertyName:a.name}}):(0,C.jsx)(I()._H,{defaultMessage:"Add more pages or remove filters to try AI on this view.",id:"database.viewSettings.propertyTab.tryAutofillDisabledDescription"}),(0,C.jsx)("div",{style:{margin:"8px 12px"},children:(0,C.jsxs)(Jc().X2,{gap:8,children:[(0,C.jsx)(_o().D,{disabled:!o||!y,style:{...S.buttonStyle,...S.undoButtonStyle,..."not_started"===g&&{display:"none"}},onClick:f,children:(0,C.jsx)(I()._H,{defaultMessage:"Undo",id:"database.viewSettings.propertyTab.aiAutofill.undoButton"})}),(0,C.jsx)(ro().Z,{renderTooltip:()=>(0,C.jsx)("div",{children:x}),render:e=>(0,C.jsx)(_o().D,{...e,disabled:!o||!y,style:{...S.buttonStyle,...S.tryButtonStyle},hoveredStyle:S.tryButtonHoveredStyle,pressedStyle:S.tryButtonPressedStyle,onClick:async()=>{if((0,N().Of)(m.candidateBlockStores)){const e=Gr().Il();u(e),l.setState({stage:"in_progress"}),await Qc().autofillPropertyForBlocks({environment:t,stores:m.candidateBlockStores,property:s,propertySchema:a,aiInferenceOverride:c,userEventForAnalytics:"generate_from_try_on_view_button",sessionIdForAnalytics:p.current,collectionContextStore:i,from:"ai_autofill_settings"}),l.setState({stage:"complete"})}},children:"in_progress"===g?(0,C.jsx)(Xc().Z,{}):(0,C.jsxs)(C.Fragment,{children:[(0,Gc().y)({width:16,..."not_started"!==g&&{display:"none"}}),"not_started"!==g?(0,C.jsx)(I()._H,{defaultMessage:"Try again",id:"database.viewSettings.propertyTab.aiAutofill.tryAgain"}):"collection"===m.type?(0,C.jsx)(I()._H,{defaultMessage:"Try on this view",id:"database.viewSettings.propertyTab.aiAutofill.tryOnCollection"}):(0,C.jsx)(I()._H,{defaultMessage:"Try on this page",id:"database.viewSettings.propertyTab.aiAutofill.tryOnPage"})]})})})]})})}function bd(e){const t=(0,f().Fg)();return(0,f().yK)((()=>({buttonStyle:{flexGrow:1,display:"flex",alignItems:"center",justifyContent:"center",gap:8},menuItemStyle:{fontSize:13,borderRadius:6,background:t.accentColors.purple[50],color:t.accentColors.purple[500],margin:"8px 12px",padding:"8px 12px"},undoButtonStyle:{border:`1px solid ${t.accentColors.gray[100]}`,flex:1},tryButtonStyle:{fontWeight:500,flex:1,background:null!=e&&e.isTryAutofillEnabled?"light"===t.mode?t.accentColors.purple[50]:t.accentColors.purple[200]:t.accentColors.gray[75],color:null!=e&&e.isTryAutofillEnabled?t.aiPurpleColor:t.accentColors.gray[400]},fillAllPagesWandIconStyle:{fill:t.aiPurpleColor},tryButtonHoveredStyle:{background:t.accentColors.purple[100]},tryButtonPressedStyle:{background:t.accentColors.purple[200]},confirmDiscardChangesDialogIconStyle:{width:32,height:32,fill:t.aiPurpleColor,paddingTop:8},confirmDiscardChangesDialogMessageStyle:{textAlign:"center",fontWeight:500}})),[t,null==e?void 0:e.isTryAutofillEnabled])}var wd=()=>o(197874),jd=()=>o(353329),_d=()=>o(659089),Md=()=>o(570270),kd=()=>o(374289),Pd=()=>o(741633),Td=()=>o(496205),Id=()=>o(429158),Vd=()=>o(447832),Ad=()=>o(397540),Zd=()=>o(641702),Bd=()=>o(352701),Fd=()=>o(90065),Rd=()=>o(188296),Kd=()=>o(535645),Hd=()=>o(925880),Od=()=>o(182722);function Ld(e){const{collectionContextStore:t,onAccept:o,propertySchema:l,disableSuggestions:a,propertyGroupId:s}=e,u=(0,i().Fy)(),[p,g]=n.useState(""),m=function(e){let{collectionContextStore:t,propertySchema:o,onAccept:l,searchInput:a,disableSuggestions:s,propertyGroupId:u}=e;const[p,g]=(0,n.useState)(!1),m=(0,I().YB)(),y=(0,i().O7)(),S=(0,r().VK)((()=>{const e=t.collectionStore();return Boolean(e&&(0,za().mX)(y,os().Z.getMode(y,e),e))}),[y,t]),h=(0,r().VK)((()=>{var e;if(!t)return;const o=null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.app_config_uri;return o?(0,re().YB)((0,Fa().appConfigs)(),o):void 0}),[t]),x=(0,r().VK)((()=>{var e,o;if(!S)return!1;if(void 0!==h)return!1;if(null===(e=t.collectionStore())||void 0===e||!e.getName())return!1;const n=null===(o=t.collectionStore())||void 0===o?void 0:o.getSchema();return!(n&&(0,N().Yd)(n).length>go().ci)&&(0,za().kL)()}),[S,h,t]),v=function(e){let{collectionContextStore:t,onAccept:o}=e;const n=(0,i().O7)(),l=(0,f().Fg)(),a=(0,I().YB)(),s=(0,r().VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema()}),[t]),c=(0,r().VK)((()=>(0,za().kL)()),[]),d=(0,r().VK)((()=>{if(c){return tu((0,Kn().W3)({environment:n,collectionContextStore:t}),s)}return[]}),[t,s,n,c]),u=(0,r().VK)((()=>Object.fromEntries(d.map((e=>[Kn().SO[e.propertyType].toLowerCase(),Gd({collectionContextStore:t,propertyType:e.propertyType,propertyName:Kn().SO[e.propertyType],disablePropertyTooltip:!0,intl:a,iconFill:l.aiPurpleColor,onAccept:o,isSuggestedProperty:!0})])))),[t,a,o,l.aiPurpleColor,d]);return u}({collectionContextStore:t,onAccept:l}),b=function(e){let{environment:t,collectionContextStore:o,propertySchema:n,onAccept:i,intl:l}=e;const a=(0,r().VK)((()=>Object.fromEntries((0,Kn().TP)({collectionContextStore:o,environment:t}).map((e=>[Kn().SO[e].toLowerCase(),Gd({propertyType:e,propertyName:Kn().SO[e],collectionContextStore:o,onAccept:i,intl:l,propertySchema:n,isSuggestedProperty:!1})])))),[o,l,i,n,t]);return a}({environment:y,propertySchema:o,onAccept:l,intl:m,collectionContextStore:t}),w=function(){const e=(0,i().O7)(),t=(0,gt().Y$)(),o=(0,f().Fg)(),n=(0,r().VK)((()=>{const n=function(e){var t;let{environment:o,collectionContextStore:n,spaceStore:i}=e;if(!(0,Fd().tj)())return!1;const r=null==i?void 0:i.getModel();if(!r||!(0,Td().$T)(r))return!1;const l=null===(t=n.collectionViewBlockStore())||void 0===t?void 0:t.isCollectionViewPageWithContent();if(l)return!1;const a=n.collectionStore();if(!a)return!1;const s=(0,Xe().w2)({environment:o,collectionStore:a,templateId:Bi()._5});if(s)return!1;return!0}({environment:e,collectionContextStore:t,spaceStore:un().default.getState().currentSpaceStore}),i=(0,Fd().$0)({environment:e,collectionStore:t.collectionStore()});if(!n&&!i)return{};const r=Ni().globalWorkflowTemplates.fromId(Bi()._5);return(0,jd().iI)(r)?{[r.templateId]:Wd({environment:e,template:r,collectionContextStore:t,theme:o,suggestedFeatureAnalytics:void 0,isUpsell:i})}:{}}),[t,e,o]);return n}(),j=(0,n.useMemo)((()=>({...b,...w})),[b,w]),_=function(e){let{collectionContextStore:t,propertySchema:o,propertyGroupId:l}=e;const a=(0,i().O7)(),s=(0,I().YB)(),c=(0,r().VK)((()=>so().default.bots.state),[]),d=(0,r().VK)((()=>t.collectionStore()),[t]),u=(0,r().VK)((()=>(null==d?void 0:d.getSchema())??{}),[d]),p=(0,r().VK)((()=>!(null==d||!d.isPageTreeCollection())),[d]),g=(0,r().VK)((()=>t.databaseType),[t]),m=(0,r().VK)((()=>{var e;return null===(e=un().default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit()}),[]),f=(0,r().VK)((()=>{if(void 0===o)return(0,Bd().n)(d,m)}),[d,o,m]),y=(0,r().VK)((()=>Boolean(null==d?void 0:d.isSyncedCollection())),[d]),S=(0,Dl().J)(),h=(0,Xs().w)(),x=(0,n.useMemo)((()=>{if(null!=f&&f.length&&!h)return Object.fromEntries(f.map((e=>{const{isDisabled:o,propertyDisabledTooltip:n}=function(e){let{propertyConfig:t,databaseType:o,bots:n,isSpaceAdmin:i,isMobile:r,isWikiCollection:l,isSyncedCollection:a,schema:s,intl:c}=e;const d="integration"in t?t.integration.id:t.integrationId;if(!d)return{isDisabled:!1};var u;if((0,ka().gi)({isAuthed:Boolean(n.find((e=>e.integration_id===d))),isSpaceAdmin:i,isPropertyAdminAuthOnly:Boolean(t.canOnlyAdminAuth),isMobile:r}))return{isDisabled:!0,propertyDisabledTooltip:null===(u=t.canOnlyAdminAuth)||void 0===u?void 0:u.disabledPropertyTooltipMessage};if(d===Lo().U9){if(Xd(s,Lo().U9))return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(ou.duplicateGithubPropertyTooltip)};if(l)return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(ou.wikiGithubPropertyTooltip)};if(a)return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(ou.syncedDatabaseGithubPropertyTooltip)}}else if(d===Lo().Dv){if(Xd(s,Lo().Dv),o!==K().Fi)return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(ou.nonMeetingsCronPropertyTooltip)};if(Xd(s,Lo().Dv))return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(ou.duplicateCronEventPropertyTooltip)}}return{isDisabled:!1}}({propertyConfig:e,bots:c,isSpaceAdmin:S,environment:a,isWikiCollection:p,databaseType:g,isSyncedCollection:y,schema:u,intl:s,isMobile:a.device.isMobile});return[e.name.toLowerCase(),Yd({connectedRelationProperty:e,isDisabled:o,propertyDisabledTooltip:n,environment:a,intl:s,collectionContextStore:t,propertyGroupId:l})]})).filter(N().$K))}),[f,h,c,S,a,p,g,y,u,s,t,l]);return x}({collectionContextStore:t,propertySchema:o,propertyGroupId:u}),[M,k]=function(e){const{collectionContextStore:t}=e,o=(0,i().O7)(),l=(0,r().VK)((()=>{var e;return(null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema())??{}}),[t]),a=(0,Dn().E)("connected_relations_database_actions_enabled"),[s,c]=(0,n.useMemo)((()=>{if(!a)return[{},[]];const e={};for(const[n,i]of Object.entries(l)){if(!i||!(0,go().NK)(i))continue;const r=i.connectedRelation.integration_id;if(!r||!(0,Lo().NN)(r))continue;const l=$d({propertySchema:i,environment:o,collectionContextStore:t,propertyId:n,integrationId:r});e[r]||(e[r]={}),e[r][i.name.toLowerCase()]=l}return[e,Object.values(e).flat()]}),[l,a,o,t]);return[s,c]}({collectionContextStore:t}),P=a.length>0,T=(0,n.useCallback)((e=>e.splice(0,p?1/0:Dd)),[p]),V=(0,n.useCallback)((e=>{let t;return t=P||p?e:T(e),dr().filter(a,t).filter((e=>!(P&&(j.hasOwnProperty(e.original)||null!=_&&_.hasOwnProperty(e.original)||null!=k&&k.hasOwnProperty(e.original))))).map((e=>e.original.toString()))}),[P,p,a,j,_,k,T]),A=function(e){let{collectionContextStore:t,propertySchema:o,disableSuggestions:l,hasAiEnabled:a,showAiSuggestions:s,getFilteredSuggestedItemKeys:u,onAccept:p}=e;const g=(0,i().O7)(),m=(0,f().Fg)(),y=(0,I().YB)(),S=(0,r().VK)((()=>{var e;const o=null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.app_config_uri;return o?(0,re().YB)((0,Fa().appConfigs)(),o):void 0}),[t]);(0,et().Y)(t);const h=(0,Hd().c)(t),x=(0,r().VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema()}),[t]),v=(0,r().VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat()}),[t]),C=function(e){let{collectionContextStore:t,showAiSuggestions:o}=e;const l=(0,i().O7)(),a=(0,r().VK)((()=>{var e;const o=null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema();return o?fi().oA(Object.values(o).map((e=>null==e?void 0:e.name.toLocaleLowerCase()))):[]}),[t]),s=(0,n.useCallback)((e=>e.filter((e=>!a.includes(e.name.toLocaleLowerCase())))),[a]),u=(0,r().VK)((()=>{const e=t.collectionStore(),o=null==e?void 0:e.getFormat();if(null!=o&&o.ai_suggested_properties&&(null==o?void 0:o.ai_suggested_properties.length)>0)return s(null==o?void 0:o.ai_suggested_properties)}),[t,s]),[p,g]=(0,n.useState)(u||"loading"),m=(0,n.useRef)(!1);return(0,n.useEffect)((()=>{if(m.current||u)return;(async()=>{const e=t.collectionStore(),o=null==e?void 0:e.getSpaceId(),n=null==e?void 0:e.id,i=[];if(o&&n&&e.getName()){const t=await ie().callApi({eventName:"getAiSuggestedProperties",environment:l,data:{spaceId:null==e?void 0:e.getSpaceId(),collectionId:null==e?void 0:e.id,schema:fi().oA(Object.values(e.getSchema())),collectionName:(0,Zd().Xh)(e.getName(),e),numSuggestion:Ed},headers:(0,Pd().Bb)({spaceId:o})});if("success"===t.type){const o=t.data.properties.filter((e=>!a.includes(e.name.toLocaleLowerCase())));i.push(...o),d().createAndCommit({environment:l,perform:t=>{c().FH({stores:[e],update:{ai_suggested_properties:o},transaction:t})},canUndo:!0,userAction:"propertyType.generateAiSuggestion"})}}const r=s(i);g(r)})(),m.current=!0}),[t,l,p,o,u,a,s]),p}({collectionContextStore:t,showAiSuggestions:s}),b=(0,r().VK)((()=>(0,za().kL)()),[]),w=(0,r().VK)((()=>{if(o||l)return[];const e=h.filter((e=>(0,Ni().shouldShowInSuggestedProperties)(e)));if(S){const e=Jd({appConfig:S,collectionFormat:v,collectionSchema:x,hasAiEnabled:a});return(b?e.filter((e=>"notion://tasks/task_summary_feature"!==e.uri)):e).map((e=>({type:"typed",appConfigFeature:e})))}if(e.length>0)return e.map((e=>({type:"workflow",template:e})));if(s)return"loading"===C?"loading":C.map((e=>({type:"ai_suggestion",propertySchema:e})));if(!b){return tu((0,Kn().W3)({environment:g,collectionContextStore:t}),x)}return[]}),[o,l,h,S,s,b,v,x,a,C,g,t]),j=(0,n.useMemo)((()=>{if("loading"===w)return[];const e=w.filter((e=>"workflow"===e.type)).map((e=>Ud(e.template.templateId)));return u(e).map(zd)}),[w,u]);(0,Od().J)({collectionContextStore:t,origin:"suggested_properties",shownTemplateIds:j});const _=(0,r().VK)((()=>"loading"===w?"loading":Object.fromEntries(w.map(((e,o)=>{switch(e.type){case"ai_suggestion":return[e.propertySchema.name.toLowerCase(),Gd({collectionContextStore:t,propertyType:e.propertySchema.type,propertyName:e.propertySchema.name,disablePropertyTooltip:!0,intl:y,onAccept:p,isSuggestedProperty:!0})];case"typed":return[e.appConfigFeature.name.toLowerCase(),qd({appConfig:S,suggestedProperty:e.appConfigFeature,isDisabled:!1,environment:g,collectionContextStore:t,theme:m})];case"workflow":return[(0,Ni().getWorkflowTemplateName)(e.template).toLowerCase(),Wd({environment:g,template:e.template,collectionContextStore:t,theme:m,isUpsell:!1,suggestedFeatureAnalytics:{origin:"suggested_properties",selectedIndex:j.indexOf(e.template.templateId),shownTemplateIds:j}})];case"derived_ai_property":return[Kn().SO[e.propertyType].toLowerCase(),Gd({collectionContextStore:t,propertyType:e.propertyType,propertyName:Kn().SO[e.propertyType],disablePropertyTooltip:!0,intl:y,iconFill:m.aiPurpleColor,onAccept:p,isSuggestedProperty:!0})]}})))),[S,t,g,y,w,m,p,j]);return _}({hasAiEnabled:S,showAiSuggestions:x,collectionContextStore:t,propertySchema:o,onAccept:l,disableSuggestions:s,getFilteredSuggestedItemKeys:V}),Z=(0,n.useMemo)((()=>{if("loading"===A)return[];return V((0,N().Yd)(A)).flatMap((e=>A[e]))}),[A,V]),B=(0,n.useMemo)((()=>dr().filter(a,(0,N().Yd)(v)).flatMap((e=>v[e.original]))),[v,a]),F=(0,n.useMemo)((()=>dr().filter(a,(0,N().Yd)(j)).flatMap((e=>j[e.original]))),[a,j]),R=(0,n.useMemo)((()=>_?dr().filter(a,(0,N().Yd)(_)).flatMap((e=>_[e.original])):[]),[_,a]),H=(0,n.useMemo)((()=>{if(!M)return{};const e={};return(0,N().Yd)(M).forEach((t=>{const o=dr().filter(a,(0,N().Yd)(M[t])).flatMap((e=>M[t][e.original]));o.length>0&&(e[t]=o)})),e}),[M,a]),O=function(e){let{hasMoreSuggestions:t,filteredSuggestedPropertyItems:o,showAiSuggestions:i,setIsShowingMoreSuggestions:r,hasSearchInput:l,disableSuggestions:a,isLoading:s}=e;const c=(0,f().yK)((e=>({loadingShimmer:{height:10,borderRadius:4,margin:"12px 14px",backgroundColor:e.lightDividerColor},moreSuggestionsButtonContainer:{display:"flex",alignItems:"center",lineHeight:1.2,color:e.mediumTextColor,fontSize:12}})),[]),d=(0,n.useMemo)((()=>({key:"suggested",render:e=>(0,C.jsxs)(ee().Z,{...e,title:Co().Z.formatMessage(ou.suggestedSectionTitle),disableMobileBorders:!0,children:[(0,C.jsx)(vo().Z,{style:{width:"80%",...c.loadingShimmer}}),(0,C.jsx)(vo().Z,{style:{width:"50%",...c.loadingShimmer}}),(0,C.jsx)(vo().Z,{style:{width:"60%",...c.loadingShimmer}}),(0,C.jsx)(vo().Z,{style:{width:"50%",...c.loadingShimmer}})]}),items:[]})),[c.loadingShimmer]),u=(0,n.useMemo)((()=>({key:"more-suggestions",render:e=>(0,C.jsx)(q().Z,{...e,title:(0,C.jsxs)("div",{style:c.moreSuggestionsButtonContainer,children:[(0,C.jsx)(I()._H,{id:"database.collectionsettings.propertySuggestions.more",defaultMessage:"More"}),(0,kd().i)({fill:tn().ZP.uiGray,width:12,height:12,marginLeft:4})]})}),action:e=>{r(!0),e.event&&"stopPropagation"in e.event&&e.event.stopPropagation()}})),[r,c.moreSuggestionsButtonContainer]),p=(0,n.useMemo)((()=>a?{key:"suggested",render:()=>(0,C.jsx)(C.Fragment,{}),items:[]}:o.length?{key:"suggested",render:e=>(0,C.jsx)(ee().Z,{...e,title:Co().Z.formatMessage(ou.suggestedSectionTitle)}),items:t&&!l?[...o,u]:o}:s&&i&&!l?d:{key:"suggested",render:()=>(0,C.jsx)(C.Fragment,{}),items:[]}),[a,o,l,u,s,i,d,t]);return p}({hasMoreSuggestions:!p&&(0,N().Yd)(A).length>Dd,filteredSuggestedPropertyItems:Z,hasSearchInput:P,showAiSuggestions:x,setIsShowingMoreSuggestions:g,disableSuggestions:Boolean(s||o),isLoading:"loading"===A}),L=function(e){let{filteredAiDerivedPropertyItems:t}=e;return(0,n.useMemo)((()=>t.length?{key:"autofill",render:e=>(0,C.jsx)(ee().Z,{...e,title:Co().Z.formatMessage(ou.autofillSectionTitle)}),items:t}:{key:"autofill",render:()=>(0,C.jsx)(C.Fragment,{}),items:[]}),[t])}({filteredAiDerivedPropertyItems:B}),D=function(e){let{filteredStandardPropertyItems:t}=e;return(0,n.useMemo)((()=>t.length?{key:"standard",render:e=>(0,C.jsx)(ee().Z,{...e,title:Co().Z.formatMessage(ou.typesSectionTitle)}),items:t}:{key:"standard",render:()=>(0,C.jsx)(C.Fragment,{}),items:[]}),[t])}({filteredStandardPropertyItems:F}),E=function(e){let{filteredConnectedPropertyItems:t}=e;const o=(0,n.useMemo)((()=>t.length?{key:"connected",render:e=>(0,C.jsx)(ee().Z,{...e,title:Co().Z.formatMessage(ou.connectedRelationSectionTitle)}),items:t}:{key:"connected",render:()=>null,items:[]}),[t]);return o}({filteredConnectedPropertyItems:R}),U=function(e){let{filteredConnectedPropertyItemsPerIntegration:t}=e;const o=(0,n.useMemo)((()=>0===Object.keys(t).length?[{key:"existingConnectedRelations",render:()=>null,items:[]}]:Object.entries(t).map((e=>{let[t,o]=e;return 0===o.length?{key:t,render:()=>null,items:[]}:{key:t,render:e=>(0,C.jsx)(ee().Z,{...e,title:Co().Z.formatMessage(ou.existingConnectedRelationSectionTitle,{integrationName:(0,Lo().Vh)(t)})}),items:o}}))),[t]);return o}({filteredConnectedPropertyItemsPerIntegration:H}),z=(0,n.useMemo)((()=>{if(o||!a.length)return{key:"custom",render:()=>(0,C.jsx)(C.Fragment,{}),items:[]};const e=T((0,N().Yd)(A));return v.hasOwnProperty(a.toLowerCase())||null!=e&&e.includes(a.toLowerCase())||null!=j&&j.hasOwnProperty(a.toLowerCase())||null!=_&&_.hasOwnProperty(a.toLowerCase())||null!=k&&k.hasOwnProperty(a.toLowerCase())?{key:"custom",render:()=>(0,C.jsx)(C.Fragment,{}),items:[]}:{key:"custom",render:e=>(0,C.jsx)(ee().Z,{...e,title:Co().Z.formatMessage(ou.selectToAddNewProperty)}),items:[Gd({collectionContextStore:t,onAccept:l,propertyType:"text",propertyName:a,disablePropertyTooltip:!0,intl:m,isSuggestedProperty:!1})]}}),[o,a,v,T,A,j,_,k,t,l,m]),W=(0,n.useMemo)((()=>[O,L,D,...U,E,z]),[O,L,D,E,z,U]);return W}({collectionContextStore:t,propertySchema:l,onAccept:o,disableSuggestions:a,searchInput:p,propertyGroupId:s}),y=(0,r().VK)((()=>{const e=null==t?void 0:t.collectionStore();if(e)return(0,Zd().Xh)(e.getName(),e)}),[t]),S=(0,r().VK)((()=>t.permissionScopesStore.state),[t]),h=(0,Xs().w)(),x=(0,f().yK)((e=>({inputOuterStyle:h?{backgroundColor:e.white}:{}})),[h]);return null!=S&&S.isExternallyImportedAndSyncedCollection?null:(0,C.jsxs)(B().ZP,{...e,title:l?Co().Z.formatMessage(ou.changePropertyType):u.isDesktop&&y?Co().Z.formatMessage(ou.newPropertyWithDatabaseName,{databaseName:y}):Co().Z.formatMessage(ou.newProperty),children:[(0,C.jsx)(ee().Z,{isInput:!0,children:(0,C.jsx)(xo().ZP,{focusInitial:!u.isMobile||void 0,focus:!u.isMobile||void 0,value:p,onChange:e=>{g(e.target.value)},inputOuterStyle:x.inputOuterStyle,placeholder:Co().Z.formatMessage(l?ou.searchToChangePlaceholder:ou.searchPlaceholder)})}),(0,C.jsx)(Q().ZP,{disableInitialScroll:!0,type:Q().iW.Vertical,initialFocus:0,sections:m,resetInitialFocusOnSectionChange:!0})]})}const Dd=4,Ed=10;const Nd="workflow.";function Ud(e){return`${Nd}${e}`}function zd(e){return e.replace(Nd,"")}function Wd(e){let{environment:t,template:o,collectionContextStore:n,theme:i,suggestedFeatureAnalytics:r,isUpsell:l}=e;const a=(0,Ni().getWorkflowTemplateName)(o);return{key:Ud(o.templateId),action:()=>{(0,Kd().r)({environment:t,template:o,collectionContextStore:n,suggestedFeatureAnalytics:r})},render:e=>(0,C.jsx)(q().Z,{...e,disabled:l,title:l?(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,C.jsx)(pt().Z,{style:{marginRight:4},children:a}),(0,C.jsx)(Rd().Z,{subscriptionTier:"business",analyticsName:"verification_upsell_item_collection_entrypoint"})]}):a,icon:(0,C.jsx)(Ei().l,{template:o,size:16,iconStyle:{fill:i.regularIconColor}})})}}function qd(e){let{appConfig:t,suggestedProperty:o,isDisabled:n,propertyDisabledTooltip:i,environment:r,collectionContextStore:l,theme:a}=e;const c=l.collectionStore(),d=Md().aQ.derivePropertyUris((null==c?void 0:c.getSchema())??{},null==c?void 0:c.getPropertyMapping()),u=(e,t,o,i)=>{const r=o.dependencies.find((e=>{var t;return"property"===e.type&&e.collectionUri===(null==c||null===(t=c.getFormat())||void 0===t?void 0:t.app_config_uri)&&(0,wd().Pf)(e.uri)&&!d.has(e.uri)})),l=o.dependencies.find((e=>"property"===e.type&&(0,go().qQ)(e.propertySchema)&&(0,go().q3)(e.propertySchema)));if(r)return(0,C.jsx)(q().Z,{...e,disabled:n,disabledFeedback:n,title:(0,C.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[t,l?(0,C.jsx)(Id().Z,{}):null,o.isNew?"notion://projects/tasks_with_sprints_feature"===o.uri&&(0,C.jsx)(Vd().Z,{}):null]}),icon:(0,C.jsx)(mo().ZP,{type:r.propertySchema.type,theme:a,icon:i,size:16,style:{fill:a.regularIconColor}})})},p=new(xt().Z);return{key:o.name,render:e=>{var n,a;return(0,C.jsx)(Yt().Z,{showImage:!i,caption:i??o.description,tooltipImage:i||null===(n=o.tooltipImage)||void 0===n?void 0:n.img,tooltipImageScale:null===(a=o.tooltipImage)||void 0===a?void 0:a.scale,render:n=>{if((0,re().BQ)(o))return u({...(0,lo().Z)(e,n)},o.name,o,o.icon);{const i=fi().oA(o.variants.map((e=>{const o=null==t?void 0:t.allFeatures.find((t=>t.uri===e));if(o&&(0,re().BQ)(o))return o})));return(0,C.jsx)(Ad().Z,{buttonPopupStore:p,items:i,getKey:e=>e.name,onSelect:async e=>{await qo().G0({environment:r,feature:e,collectionContextStore:l,addFeatureFrom:"new_property"}),s().E3({collectionSettingsStore:l.settingsStore})},selectedItem:void 0,renderOrigin:t=>u({focused:Boolean(e.focused),...(0,lo().Z)(fi().CE(e,"onClick","focused"),(0,lo().Z)(n,t))},o.name,i[0],o.icon),renderItem:e=>(0,C.jsx)(q().Z,{...e,title:e.value.name,shouldWrapCaption:!0,shouldWrapTitle:!0})})}}})},action:async()=>{(0,re().BQ)(o)?(await qo().G0({environment:r,feature:o,collectionContextStore:l,addFeatureFrom:"new_property"}),s().E3({collectionSettingsStore:l.settingsStore})):p.setState({open:!0})}}}function Gd(e){let{collectionContextStore:t,propertySchema:o,propertyName:n,propertyType:i,disablePropertyTooltip:r,intl:l,onAccept:a,iconFill:s,isSuggestedProperty:c}=e;const d={key:n,render:e=>{const a=o&&(null==o?void 0:o.type)===i,c=function(e,t,o){if("auto_increment_id"===t){var n;if(null!=o&&o.type)return Co().Z.formatMessage(Ds().zU.convert_to_auto_increment_id_property);const t=e.collectionStore();if(null==t?void 0:t.isPageTreeCollection())return Co().Z.formatMessage(Ds().zU.wiki_forbidden_auto_increment_id_property);if(Boolean(null==t?void 0:t.isSyncedCollection()))return Co().Z.formatMessage(Ds().zU.synced_database_forbidden_auto_increment_id_property);const i=t&&t.id,r=t&&t.getFormat(),l=t&&(null===(n=t.getSpaceStore())||void 0===n?void 0:n.id),a=t&&t.getSchema(),s=t&&t.getDeletedSchema();if(!(i&&r&&l&&a&&s))return;if(t&&(0,_d().cj)({id:i,format:r,space_id:l,schema:a,deleted_schema:s}))return Co().Z.formatMessage(Ds().zU.duplicate_auto_increment_id_property)}}(t,i,o),d=void 0!==c,u=!r&&nu.hasOwnProperty(i)&&"on"===$e().default.getEligibleGroup({experimentId:"property_creation_tooltips_exp",defaultGroup:"control"})?l.formatMessage(nu[i]):void 0;return(0,C.jsx)(Qd,{checkState:a,buttonMenuItemProps:e,propertyName:n,propertyType:i,isDisabled:d,tooltip:c??u,iconFill:s})},action:()=>{a(i,c,n)}};return d}function Yd(e){let{connectedRelationProperty:t,isDisabled:o,propertyDisabledTooltip:n,environment:i,collectionContextStore:r,intl:l,propertyGroupId:a}=e;return{key:t.name,render:e=>(0,C.jsx)(Qd,{buttonMenuItemProps:e,propertyName:t.name,propertyType:"relation",isDisabled:o,tooltip:n,icon:t.integration.info.icon}),action:async()=>{const e=$e().default.checkGate({gateName:"salesforce_connected_relation_database_actions_enabled"});t.integration.id===Lo().aW&&e?((0,mt().j)({environment:i,event:{eventName:"salesforce_actions",eventProperties:{actionType:"navigate_to_object_selection",integrationId:t.integration.id}}}),s().H4({collectionSettingsStore:r.settingsStore,item:{type:"connectedRelationDatabaseActions",source:"ConnectedRelationObjectSelection",integrationId:t.integration.id}})):await qo().Jw({environment:i,connectedRelationProperty:t,collectionContextStore:r,intl:l,from:"new_property",propertyGroupId:a})}}}function $d(e){const{propertySchema:t,collectionContextStore:o,propertyId:n,integrationId:i}=e;return{key:n,render:e=>(0,C.jsx)(Qd,{buttonMenuItemProps:e,propertyName:t.name,propertyType:"relation",isDisabled:!1,icon:t.icon}),action:()=>{s().H4({collectionSettingsStore:o.settingsStore,item:{type:"connectedRelationDatabaseActions",source:"connectedRelationAddProperties",rootPropertyId:n,integrationId:i,rootPropertySchema:t}})}}}const Qd=n.memo((function(e){let{buttonMenuItemProps:t,checkState:o,propertyName:i,propertyType:r,isDisabled:l,badge:a,tooltip:s,tooltipImage:c,tooltipImageScale:d,icon:u,iconFill:p}=e;const g=(0,f().Fg)(),m=(0,n.useCallback)((e=>(0,C.jsx)(q().Z,{...e?(0,lo().Z)(t,e):t,disabled:l,disabledFeedback:l,title:(0,C.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[i,a]}),checkState:o,icon:(0,C.jsx)(mo().ZP,{type:r,theme:g,icon:u,size:16,style:{fill:p??g.regularIconColor}})})),[t,l,i,a,o,r,g,u,p]);return s?(0,C.jsx)(Yt().Z,{showImage:!l,caption:s,tooltipImage:l?void 0:c,tooltipImageScale:d,render:e=>m(e)}):m(void 0)}));function Jd(e){let{appConfig:t,collectionFormat:o,collectionSchema:n,hasAiEnabled:i}=e;if(!o||!n)return[];const r=e=>{const t=o.app_config_uri,r=Md().aQ.derivePropertyUris(n??{},o.app_uri_map);if(e.collectionUri!==t)return!1;let l=!0;e.uri===(0,Ol().GT)().uri&&r.has(K().Es.GithubPrsRelation)&&(l=!1);return e.dependencies.some((e=>"property"===e.type&&e.collectionUri===t&&(0,wd().Pf)(e.uri)&&!r.has(e.uri)))&&(!e.isAi||i)&&l},l={};t.allFeatures.forEach((e=>{(0,re().Dl)(e)&&e.variants.every((e=>Boolean(t.allFeatures.find((t=>t.uri===e&&(0,re().BQ)(t)&&r(t))))))&&(l[e.uri]=e.variants)}));const a=Object.values(l).flat();return t.allFeatures.filter((e=>(0,re().BQ)(e)&&!a.find((t=>t===e.uri))?r(e):!!(0,re().Dl)(e)&&Boolean(l[e.uri]))).sort(((e,t)=>(0,re().Dl)(e)?-1:(0,re().Dl)(t)?1:e.dependencies.length-t.dependencies.length))}function Xd(e,t){for(const n in e){var o;const i=e[n];if(i&&"connectedRelation"in i&&(null===(o=i.connectedRelation)||void 0===o?void 0:o.integration_id)===t)return!0}return!1}const eu=["ai_summary"];function tu(e,t){const o=t?function(e){const t=new Set;for(const n in e){const i=e[n];if(i&&"ai_inference"in i){var o;const e=null===(o=i.ai_inference)||void 0===o?void 0:o.type;if(e)switch(e){case"custom":t.add("ai_custom_prompt");break;case"summarize":t.add("ai_summary");break;case"extract":t.add("ai_extract");break;case"translate":t.add("ai_translate")}}else i&&"select_ai_inference"in i&&t.add("ai_keywords")}return t}(t):new Set;return e.map((e=>({type:"derived_ai_property",propertyType:e}))).filter((e=>!eu.includes(e.propertyType)||!o.has(e.propertyType)))}const ou=(0,I().vU)({searchPlaceholder:{defaultMessage:"Search or add new property",id:"database.viewSettings.propertyTypeSelect.searchPlaceholder"},searchToChangePlaceholder:{defaultMessage:"Search for property type",id:"database.viewSettings.propertyTypeSelect.searchToChangePlaceholder"},suggestedSectionTitle:{defaultMessage:"Suggested",id:"database.viewSettings.propertyTypeSection.suggested"},connectedRelationSectionTitle:{defaultMessage:"Connections",id:"database.viewSettings.propertyTypeSection.connected"},existingConnectedRelationSectionTitle:{defaultMessage:"{integrationName}",id:"database.viewSettings.propertyTypeSection.existingConnectedIntegrationTitle"},typesSectionTitle:{defaultMessage:"Type",id:"database.viewSettings.propertyTab.propertyType"},autofillSectionTitle:{defaultMessage:"AI autofill",id:"database.viewSettings.propertyTab.autofillProperties"},newProperty:{defaultMessage:"New property",id:"database.viewSettings.newProperty"},newPropertyWithDatabaseName:{defaultMessage:"New property on {databaseName}",id:"database.viewSettings.newPropertyOnDatabase"},changePropertyType:{defaultMessage:"Change property type",id:"database.viewSettings.changePropertyType"},selectToAddNewProperty:{defaultMessage:"Select to add",id:"database.viewSettings.selectToAdd"},newPill:{defaultMessage:"New",id:"database.viewSettings.newHighlightedFeature"},duplicateGithubPropertyTooltip:{defaultMessage:"A database can only have one GitHub Pull Requests property",id:"database.viewSettings.propertyTab.duplicateGithubProperty.tooltip"},wikiGithubPropertyTooltip:{defaultMessage:"A wiki cannot have a GitHub Pull Requests property",id:"database.viewSettings.propertyTab.wikiGithubProperty.tooltip"},syncedDatabaseGithubPropertyTooltip:{defaultMessage:"A synced database cannot have a GitHub Pull Requests property",id:"database.viewSettings.propertyTab.syncedDatabaseGithubProperty.tooltip"},nonMeetingsCronPropertyTooltip:{defaultMessage:"The Cron Calendar property can only be added to a Meetings database",id:"database.viewSettings.propertyTab.nonMeetingsCronProperty.tooltip"},duplicateCronEventPropertyTooltip:{defaultMessage:"A database can only have one Cron Calendar event property",id:"database.viewSettings.propertyTab.duplicateCronEventProperty.tooltip"}}),nu=(0,I().vU)({text:{defaultMessage:"Add text that can be formatted. Great for summaries, notes, or descriptions.",id:"database.viewSettings.propertyTab.textProperty.tooltip"},number:{defaultMessage:"Accepts numbers. These can also be formatted as currency or progress bars. Useful for tracking counts, prices, and completion.",id:"database.viewSettings.propertyTab.numberProperty.tooltip"},select:{defaultMessage:"Select one option from a list of tags. Useful for categorization.",id:"database.viewSettings.propertyTab.selectProperty.tooltip"},multi_select:{defaultMessage:"Select one or more options from a list of tags. Useful for tagging items across multiple categories.",id:"database.viewSettings.propertyTab.multiSelectProperty.tooltip"},date:{defaultMessage:"Accepts a date or a date range (time optional). Useful for deadlines, especially with calendar and timeline views.",id:"database.viewSettings.propertyTab.dateProperty.tooltip"},formula:{defaultMessage:"Perform calculations based on other properties using Notion’s formula language.",id:"database.viewSettings.propertyTab.formulaProperty.tooltip"},relation:{defaultMessage:"Connect databases and mention database pages. Useful for connecting items across your workspace.",id:"database.viewSettings.propertyTab.relationProperty.tooltip"},rollup:{defaultMessage:"View and aggregate information about properties from relation properties. Useful for summarizing interconnected data.",id:"database.viewSettings.propertyTab.rollupProperty.tooltip"},person:{defaultMessage:"Tag anyone in your Notion workspace. Useful for assigning tasks or referencing relevant team members.",id:"database.viewSettings.propertyTab.personProperty.tooltip"},file:{defaultMessage:"Upload files and images for easy retrieval. Useful for storing documents and photos.",id:"database.viewSettings.propertyTab.filesProperty.tooltip"},checkbox:{defaultMessage:"Use a checkbox to indicate whether a condition is true or false. Useful for lightweight task tracking.",id:"database.viewSettings.propertyTab.checkboxProperty.tooltip"},url:{defaultMessage:"Accepts a link to a website and opens the link in a new tab when clicked.",id:"database.viewSettings.propertyTab.urlProperty.tooltip"},email:{defaultMessage:"Accepts an email address and launches your mail client when clicked.",id:"database.viewSettings.propertyTab.emailProperty.tooltip"},phone_number:{defaultMessage:"Accepts a phone number and prompts your device to call it when clicked.",id:"database.viewSettings.propertyTab.phoneNumberProperty.tooltip"},created_time:{defaultMessage:"Records the timestamp of an item's creation. Auto-generated and not editable.",id:"database.viewSettings.propertyTab.createdTimeProperty.tooltip"},created_by:{defaultMessage:"Automatically records the person who created the item. Auto-generated and not editable.",id:"database.viewSettings.propertyTab.createdByProperty.tooltip"},last_edited_time:{defaultMessage:"Records the timestamp of an item's last edit. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastEditedTimeProperty.tooltip"},last_edited_by:{defaultMessage:"Records the person who edited the item last. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastEditedByProperty.tooltip"},auto_increment_id:{defaultMessage:"Automatically creates a numerical ID for each item. IDs are unique and cannot be manually changed.",id:"database.viewSettings.propertyTab.uniqueIdProperty.tooltip"},status:{defaultMessage:"Track this item’s progress using status tags categorized by To-do, In progress, and Complete.",id:"database.viewSettings.propertyTab.statusProperty.tooltip"},verification:{defaultMessage:"Indicate whether a page has been verified by the page owner, with the option to set an expiration date.",id:"database.viewSettings.propertyTab.verificationProperty.tooltip"},button:{defaultMessage:"Trigger actions based on the item properties.",id:"database.viewSettings.propertyTab.buttonProperty.tooltip"},ai_summary:{defaultMessage:"Text property with AI summary set up for you. Generates a summary based on page content and properties.",id:"database.viewSettings.propertyTab.aiSummaryProperty.tooltip"},ai_translate:{defaultMessage:"Text property with AI translate set up for you. Translate a property to another language using AI. ",id:"database.viewSettings.propertyTab.aiTranslateProperty.tooltip"},ai_category:{defaultMessage:"Select property that automatically adds tags based on the page content and properties.",id:"database.viewSettings.propertyTab.aiCategoryProperty.tooltip"},ai_keywords:{defaultMessage:"Multi-select property that automatically adds tags based on the page content and properties.",id:"database.viewSettings.propertyTab.aiKeywordsProperty.tooltip"},ai_custom_prompt:{defaultMessage:"Text property with a custom AI prompt. Generate content based on the page content and properties.",id:"database.viewSettings.propertyTab.aiCustomPromptProperty.tooltip"},ai_extract:{defaultMessage:"Text property with a custom AI prompt. Extract key info based on the page content and properties.",id:"database.viewSettings.propertyTab.aiExtractProperty.tooltip"},title:{defaultMessage:"Add a title for your database item. This determines the page's title.",id:"database.viewSettings.propertyTab.titleProperty.tooltip"},location:{defaultMessage:"Display the location of which database this item belongs to.",id:"database.viewSettings.propertyTab.locationProperty.tooltip"},last_visited_time:{defaultMessage:"Records the timestamp of the last time you visited this page. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastVisitedTimeProperty.tooltip"},geo_point:{defaultMessage:"Display a physical location on a map.",id:"database.viewSettings.propertyTab.geoPointProperty.tooltip"}});function iu(e){const{collectionContextStore:t,collectionSettingsStore:o,property:l,formatKey:a,propertyGroupId:c}=e,d=(0,i().O7)(),u=(0,n.useMemo)((()=>oi().default.createValue("")),[]),p=(0,r().VK)((()=>t.collectionViewBlockStore()),[t]);return p?(0,C.jsx)(B().ZP,{...e,title:(0,C.jsx)(I()._H,{defaultMessage:"Related to",id:"database.viewSettings.selectNewRelationSourceTab.title"}),handleClose:()=>s().E3({collectionSettingsStore:o}),children:(0,C.jsx)(Zi,{collectionContextStore:t,onAccept:e=>function(e,t,o,n,i,r,l){const a=o.collectionStore();if(!a)return;Wt().wd({environment:t,collectionContextStore:o,action:"select_relation_source"});const{stack:c}=n.state,d=c[c.length-2];d&&"setupRelation"===d.type&&s().z$({collectionSettingsStore:n});s().FK({collectionSettingsStore:n,item:{type:"setupRelation",property:i,formatKey:r,propertyGroupId:l,targetCollectionPointer:e.pointer}})}(e,d,t,o,l,a,c),parentStore:p,context:Ir().S7.Relation,inputStore:u})}):null}function ru(e){const{collectionContextStore:t,collectionSettingsStore:o,module:i}=e,l=(0,n.useMemo)((()=>oi().default.createValue("")),[]),{collectionStore:a}=(0,$a().PP)(),c=(0,r().VK)((()=>t.collectionViewBlockStore()),[t]),d=(0,n.useCallback)((e=>{s().FK({collectionSettingsStore:o,item:{type:"setupViewsModule",targetCollectionPointer:e.pointer,module:i}})}),[o,i]);return c?(0,C.jsx)(B().ZP,{...e,handleClose:()=>s().E3({collectionSettingsStore:o}),children:(0,C.jsx)(Zi,{collectionContextStore:t,onAccept:d,parentStore:c,context:Ir().S7.Relation,inputStore:l,collectionStore:a})}):null}var lu=()=>o(493843),au=()=>o(170075);function su(e){const{collectionContextStore:t,collectionSettingsStore:o,property:l,formatKey:a,propertyGroupId:u,targetCollectionPointer:p,from:g}=e,m=(0,r().VK)((()=>t.collectionStore()),[t]),f=(0,r().VK)((()=>{const e=t.collectionViewBlockStore();return function(e){const{targetCollectionPointer:t,collectionStore:o,collectionViewBlockStore:n}=e;if(!t)return;if(o&&o.pointer===t)return o;return n?W().NW.createChildStore(n,t):void 0}({targetCollectionPointer:p,collectionStore:m,collectionViewBlockStore:e})}),[t,m,p]),y=(0,r().VK)((()=>l?ht().KV(t,l):void 0),[t,l]),S=Boolean(m&&f&&m.id===f.id),h=Boolean("relation"===(null==y?void 0:y.type)&&y.connectedRelation),x=Boolean("subitem"===g),v=Boolean("timeline_arrows_by"===g),b=x||v,w=(0,r().VK)((()=>t.contextType),[t]),j=(0,i().O7)(),_=(0,I().YB)(),M=(0,r().VK)((()=>{const e=null==m?void 0:m.getSchema();return void 0===(null==y?void 0:y.name)&&f&&e?ht().m8(_,{targetCollectionStore:f,isSelfRelation:S,sourceSchema:e,createUnique:!0,from:g}):(null==y?void 0:y.name)||""}),[m,null==y?void 0:y.name,f,_,S,g]),[k,P]=(0,n.useState)(M),[T,V]=(0,n.useState)("no_limit"),[A,Z]=(0,n.useState)({hasInverseRelation:b,inverseName:void 0,autoRelate:{enabled:!1}}),F=(0,n.useCallback)((()=>{s().H4({collectionSettingsStore:o,item:{type:"selectRelationSource",property:l,formatKey:a}})}),[o,l,a]),R=(0,n.useCallback)((()=>{if(!A)return;const{hasInverseRelation:e,inverseName:n,autoRelate:i}=A,r=t.collectionStore(),p=t.collectionViewStore();if(!r||!f)return;const{performResult:m}=d().createAndCommit({userAction:"CollectionSettingsSetupRelation.handleAddRelation",environment:j,canUndo:!0,perform:o=>{const s=l??at().G3({environment:j,collectionStore:r,collectionViewArgs:p&&a?{collectionViewStore:p,format:p.getFormat(),formatKey:a}:void 0,propertyType:"relation",transaction:o});if(Ms().n7({environment:j,collectionContextStore:t,collectionStore:r,property:s,propertyName:k,targetCollectionStore:f,hasInverseRelation:e,inverseName:n,autoRelate:i,propertyLimit:T,intl:_,transaction:o,from:g}),u&&s&&(0,au().Nk)({collectionStore:r,groupId:u,propertyId:s,transaction:o}),p){var d;const e=(null===(d=p.getFormat().table_properties)||void 0===d?void 0:d.find((e=>e.property===s)))??{property:s,visible:!0};c().FH({stores:[p],update:{table_properties:[...p.getFormat().table_properties??[],e]},transaction:o})}return"subitem"===g&&p?st().km({environment:j,collectionContextStore:t,relationPropertyId:s,transaction:o}):"timeline_arrows_by"===g&&p&&(lu().tF({collectionViewStore:p,newProperty:s,transaction:o}),lu()._p({collectionContextStore:t,relationPropertyId:s,transaction:o})),s}});"subitem"===g||"timeline_arrows_by"===g?(s().z$({collectionSettingsStore:o}),s().H4({collectionSettingsStore:o,item:{type:"main"}})):s().qU({collectionSettingsStore:o,property:m,formatKey:a}),Wt()._H({environment:j,collectionContextStore:t,from:"collectionPage"===w?"page_properties":"view_settings",property_type:"relation"})}),[A,t,f,j,g,w,l,a,u,k,T,_,o]);return(0,C.jsxs)(B().ZP,{...e,title:(0,C.jsx)(I()._H,{defaultMessage:"New relation",id:"database.viewSettings.setupRelationTab.title"}),children:[(0,C.jsx)(ee().Z,{isInput:!0,children:(0,C.jsx)(xo().ZP,{value:k||"",placeholder:"Property name",onChange:e=>P(e.target.value),onBlur:fi().ZT,onSubmit:fi().ZT,focusInitial:!0,selectAll:!1})}),(0,C.jsx)(Gs,{isSelfRelation:S,collectionStore:f,showAs:"chevron",onClick:F,disabled:x}),!g&&(0,C.jsx)(ys,{selectedKey:T,propertyType:"relation",onChange:e=>V(e)}),f&&!h&&(0,C.jsx)(Vs,{collectionContextStore:t,targetCollectionStore:f,property:l,mode:"create",temporaryInverseState:A,setTemporaryInverseState:Z,onSubmit:R,shouldEnforceTwoWayRelation:b}),(0,C.jsx)(ee().Z,{children:(0,C.jsx)(gr().Z,{href:(0,ur().UY)("guides.relations"),title:(0,C.jsx)(I()._H,{defaultMessage:"Learn about relations",id:"database.viewSettings.propertyTab.relations.learnMoreButton.title"}),analyticsFrom:"view_settings_property_relation"})})]})}var cu=()=>o(998411),du=()=>o(427886),uu=()=>o(754664);function pu(e){const{collectionContextStore:t,collectionSettingsStore:o,targetCollectionPointer:l,module:a}=e,c=(0,I().YB)(),{isMobile:u}=(0,i().Fy)(),{layoutStore:p,setModuleSelection:g}=(0,$a().J9)(),{collectionStore:m}=(0,$a().PP)(),y=(0,i().O7)(),S=(0,r().VK)((()=>p.inMemoryRecordCache),[p]),h=(0,r().VK)((()=>{if(!l)return;if(m&&m.pointer===l)return m;const e=t.collectionViewBlockStore();return e?W().NW.createChildStore(e,l):void 0}),[t,m,l]),x=(0,r().VK)((()=>null==h?void 0:h.canEditCollection()),[h]),v=Boolean(m&&h&&m.id===h.id),b=(0,r().VK)((()=>{var e;return null==h||null===(e=h.getModel())||void 0===e?void 0:e.getRenderTitle({getRecordModel:null==m?void 0:m.getRecordModel,intl:c,userTimeZone:(0,cu().r)()})}),[h,m,c]),w=(null==h?void 0:h.id)!==(null==m?void 0:m.id),[j,M]=(0,n.useState)(b??""),[k,P]=(0,n.useState)({hasInverseRelation:w,inverseName:void 0,autoRelate:{enabled:!1}}),[T,A]=(0,n.useState)(!1),Z=(0,n.useCallback)((()=>{s().H4({collectionSettingsStore:o,item:{type:"selectViewsModuleSource",module:a}})}),[o,a]),R=(0,n.useCallback)((()=>{A((e=>!e))}),[]),K=(0,n.useCallback)((()=>{P((e=>({...e,hasInverseRelation:!1})))}),[]),H=(0,n.useCallback)((()=>{P((e=>({...e,hasInverseRelation:!0})))}),[]),O=(0,n.useCallback)((e=>{var t;const o=null!=k&&null!==(t=k.autoRelate)&&void 0!==t&&t.enabled?{enabled:!1}:{enabled:!0,bot_id:e};P((t=>({...t,autoRelate:{enabled:!!o,bot_id:e}})))}),[k]),L=(0,n.useCallback)((e=>{P((t=>({...t,inverseName:e.target.value})))}),[]),D=(0,n.useCallback)((()=>{const e=null==t?void 0:t.collectionViewBlockStore();if(!e)throw new Error("Views module block not found");const{performResult:n}=d().createAndCommit({userAction:"CollectionSettingsSetupViewsModule.handleAddView",environment:y,canUndo:!0,perform:o=>{let n;if(T&&m){const e=at().G3({environment:y,collectionStore:m,collectionViewArgs:void 0,propertyType:"relation",transaction:o}),{inverseRelationPropertyId:i}=Ms().n7({environment:y,collectionContextStore:t,collectionStore:m,property:e,propertyName:j,targetCollectionStore:h??m,hasInverseRelation:k.hasInverseRelation,inverseName:k.inverseName,autoRelate:k.autoRelate,intl:c,transaction:o,propertyLimit:"no_limit"})??{};n=i??e}const i=(0,uu().aq)({environment:y,transaction:o,collectionViewBlockStore:e,targetCollectionPointer:null==h?void 0:h.pointer,viewName:j,relationPropertyId:n,inMemoryRecordCache:S});return g({type:"existing_module",moduleId:a.id,isDragging:!1}),{collectionViewPointer:i}}});s().E3({collectionSettingsStore:o});const{collectionViewPointer:i}=n??{};i&&(ot().default.afterNextFlush((()=>{t&&((0,du().f)({environment:y,collectionContextStore:t,collectionViewId:i.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1}),s().r$({collectionContextStore:t,collectionSettingsStore:t.settingsStore,closeOnEscape:!1}))})),t&&Wt().xb({environment:y,collectionContextStore:t,view_type:"table",module:"viewsMain",is_in_page_builder:!0})),s().E3({collectionSettingsStore:o})}),[t,y,o,T,m,j,h,k,c,S,g,a.id]),E=(0,r().VK)((()=>null==h?void 0:h.getIcon()),[h]),N=(0,f().yK)((e=>({chevronTitle:{marginLeft:4,display:"inline",wordBreak:"break-word",alignSelf:"center",...V().Yu},relationMenuTitle:{display:"flex",alignItems:"center",whiteSpace:"pre"},helpIcon:{width:16,fill:e.lightIconColor,marginLeft:6},tooltip:{maxWidth:285,width:"max-content",overflowWrap:"break-word",textWrap:"wrap",whiteSpace:"pre-line"},tooltipSecondary:{color:e.mediumInvertedTextColor}})),[]),U=T&&h&&x;return(0,C.jsxs)(B().ZP,{...e,title:(0,C.jsx)(I()._H,{defaultMessage:"New view",id:"database.viewSettings.setupViewTab.title"}),children:[(0,C.jsx)(ee().Z,{isInput:!0,children:(0,C.jsx)(xo().ZP,{value:j||"",placeholder:T?c.formatMessage({defaultMessage:"View & relation name",id:"database.viewSettings.mainTab.viewNameAndRelationNameSection.title"}):c.formatMessage({defaultMessage:"View name",id:"database.viewSettings.mainTab.viewNameSection.title"}),onChange:e=>M(e.target.value),onBlur:fi().ZT,onSubmit:fi().ZT,focusInitial:!0,selectAll:!1})}),(0,C.jsx)(F().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"View of",id:"database.viewSettings.setupViewsModule.viewOf.title"}),showChevron:!0,onClick:Z,disabled:!1,right:v?(0,C.jsx)(I()._H,{defaultMessage:"This database",id:"database.viewSettings.editRelation.selfRelationTarget.title"}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(fn().Z,{icon:E,isEmptyPage:!1,size:20,disabled:!0}),(0,C.jsx)(_l().Z,{store:h,style:N.chevronTitle})]}),rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0}}),(0,C.jsx)(ee().Z,{children:(0,C.jsx)(te().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"Add new relation",id:"database.viewSettings.addRelationToggle"}),on:T,onClick:R,focused:!1,disabled:!x})}),U&&(0,C.jsx)(ee().Z,{topBorder:!0,children:(0,C.jsx)(As,{currentInverseState:!(null==k||!k.hasInverseRelation),disableInverseRelation:K,enableInverseRelation:H,handleAutoRelateToggle:O,temporaryInverseState:k,collectionStore:m,targetCollectionStore:h,isTwoWayToggleDisabled:!v,isNameDisabled:!1,menuTitle:(0,C.jsxs)("div",{style:N.relationMenuTitle,children:[c.formatMessage(Bs.generic.title),!u&&(0,C.jsx)(ro().Z,{placement:ao().Placement.Bottom,textWrap:!0,style:N.tooltip,render:e=>(0,C.jsx)("div",{...e,children:(0,_().m)(N.helpIcon)}),renderTooltip:()=>(0,C.jsxs)(C.Fragment,{children:[v?c.formatMessage(gu.selfTwoWayRelationTooltip):c.formatMessage(gu.nonSelfTwoWayRelationTooltip),!v&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("br",{}),(0,C.jsx)("span",{style:N.tooltipSecondary,children:(0,C.jsx)(I()._H,{...gu.nonSelfTwoWayRelationTooltipSecondary})})]})]})})]}),autoRelate:null==k?void 0:k.autoRelate,isSelfRelation:v,inverseRelationName:(null==k?void 0:k.inverseName)??"",handleInverseNameChange:L})}),(0,C.jsx)(ee().Z,{children:(0,C.jsx)(X().Z,{style:{display:"flex",margin:"0px 12px 6px 12px"},onClick:D,disabled:0===j.length,children:T?(0,C.jsx)(I()._H,{...gu.addViewAndRelationButton}):(0,C.jsx)(I()._H,{...gu.addViewButton})})})]})}const gu=(0,I().vU)({addViewButton:{defaultMessage:"Add view",id:"database.viewSettings.addViewButton"},addViewAndRelationButton:{defaultMessage:"Add view & relation",id:"database.viewSettings.addViewAndRelationButton"},selfTwoWayRelationTooltip:{defaultMessage:"Manage separate properties for each direction of a two-way relation.",id:"database.viewSettings.selfTwoWayRelationTooltip"},nonSelfTwoWayRelationTooltip:{defaultMessage:"Manage separate properties for each direction of a two-way relation.",id:"database.viewSettings.nonSelfTwoWayRelationTooltip"},nonSelfTwoWayRelationTooltipSecondary:{defaultMessage:"This setting is required for relations of linked databases in tabbed views.",id:"database.viewSettings.nonSelfTwoWayRelationTooltipSecondary"}});var mu=()=>o(784234),fu=()=>o(251932),yu=()=>o(972544);function Su(e){let{collectionSettingsStore:t,collectionContextStore:l,integrationName:c,integrationIcon:u,fullHeight:p}=e;const g=(0,i().O7)(),m=(0,f().yK)((e=>({promptTitle:xu(e)})),[]),[y,S]=(0,n.useState)(!1),h=(0,r().VK)((()=>l.collectionViewBlockStore()),[l]),{numberOfGuests:x,numberOfUsers:v,isPublic:b}=(0,r().VK)((()=>{const e=ns().subscriptionDataStoreInstance.state?o(18281).CM(ns().subscriptionDataStoreInstance.state):[],t=(0,Gn().m8)(fi().oA(e.map((e=>[e.userId,e.role]))));if(!h)return{numberOfGuests:void 0,numberOfUsers:void 0,isPublic:void 0};const n=(0,o(122479).YO)(h).map((e=>e.permissionItem));let i=!1,r=!1;for(const o of n)ks().$D(o)?i=!0:ks().Ir(o)&&!ks().Wi(o.role)&&(r=!0);const l=fi().jj(fi().oA([...n.map((e=>"user_permission"===e.type?e.user_id:void 0)),...r?Object.keys(t):[]])),a=l.filter((e=>"none"!==t[e])).length,s=l.filter((e=>{const o=t[e],i=Boolean(n.filter(ks().jg).find((t=>t.user_id===e)));return Boolean(o&&i&&!ks().YX(o))})).length;return{numberOfGuests:s,numberOfUsers:a+s,isPublic:i}}),[h]);(0,n.useEffect)((()=>{b||1!==v||s().E3({collectionSettingsStore:t})}),[t,b,v]);const w=(0,n.useCallback)((()=>{h&&(y&&function(e){const{environment:t,store:o}=e,n=t.currentUser.id;if(!n)return;d().createAndCommit({userAction:"CollectionSettingsSyncedContentShare.restrictAccessToSyncedContent",environment:t,canUndo:!0,perform:e=>{mu().Pk({environment:t,store:o,shouldInherit:!1,transaction:e,permissionItem:{type:"user_permission",user_id:n,role:"editor"}})}})}({environment:g,store:h}),a().KI(g,{type:y?"restrict":"share"}),s().E3({collectionSettingsStore:t}))}),[t,h,g,y]);if(!h)return null;const j=(0,C.jsx)("div",{style:m.promptTitle,children:(0,C.jsx)(I()._H,{id:"CollectionSettingsSyncedContentShare.header",defaultMessage:"Share synced content with"})}),_=(0,C.jsxs)(C.Fragment,{children:[0!==x?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(I()._H,{id:"CollectionSettingsSyncedContentShare.option.share.caption.usersWithGuests",defaultMessage:"{numberOfUsers} people (including you {numberOfGuests, plural, one {and {numberOfGuests} guest} other {and {numberOfGuests} guests}})",values:{numberOfUsers:v,numberOfGuests:x}})," "]}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(I()._H,{id:"CollectionSettingsSyncedContentShare.option.share.caption.usersWithoutGuests",defaultMessage:"{numberOfUsers} people (including you)",values:{numberOfUsers:v}})," "]}),b&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(I()._H,{id:"CollectionSettingsSyncedContentShare.option.share.caption.sharedWithPublic",defaultMessage:"and those with the link"})," "]}),(0,C.jsx)(I()._H,{id:"CollectionSettingsSyncedContentShare.option.share.caption.accessToIntegration",defaultMessage:"will get access to content synced from {integrationName}",values:{integrationName:c}})]}),M=(0,C.jsx)(fu().gq,{style:{marginTop:10},children:(0,C.jsx)(X().Z,{style:{flex:"0 0 100%"},isLarge:!0,onClick:w,children:(0,C.jsx)(I()._H,{id:"CollectionSettingsSyncedContentShare.continueButton",defaultMessage:"Continue"})})}),k=(0,C.jsx)(fu().gq,{style:{paddingBottom:24},alignItems:"center",justifyContent:"center",children:(0,C.jsx)("img",{style:{width:40},src:u})}),P=(0,C.jsx)(Q().ZP,{type:Q().iW.Vertical,initialFocus:void 0,sections:[{key:"grant_permissions",items:[{key:"allow",action:()=>null,render:e=>(0,C.jsx)(q().Z,{...e,textWrapperStyle:{textAlign:"left"},title:(0,C.jsx)(I()._H,{id:"CollectionSettingsSyncedContentShare.option.share.title",defaultMessage:"Anyone on this page"}),shouldWrapCaption:!0,caption:_,icon:(0,C.jsx)(yu().Z,{isSelected:!y}),onClick:()=>{S(!1)}})},{key:"restrict",action:()=>null,render:e=>(0,C.jsx)(q().Z,{...e,textWrapperStyle:{textAlign:"left"},title:(0,C.jsx)(I()._H,{id:"CollectionSettingsSyncedContentShare.option.restrict.title",defaultMessage:"Only you"}),shouldWrapCaption:!0,caption:(0,C.jsx)(I()._H,{id:"CollectionSettingsSyncedContentShare.option.restrict.caption",defaultMessage:"You'll need to share with others using the share menu"}),icon:(0,C.jsx)(yu().Z,{isSelected:y}),onClick:()=>{S(!0)}})}],render:e=>(0,C.jsx)(ee().Z,{...e})}]});return(0,C.jsx)(B().ZP,{collectionSettingsStore:t,fullHeight:p,children:(0,C.jsxs)(fu().gq,{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0px 16px 16px 16px"},flexDirection:"column",children:[k,(0,C.jsxs)("div",{children:[j,P]}),M]})})}const hu=n.memo(Su,ni().Z);function xu(e){return{color:e.regularTextColor,fontWeight:V().Ue.semibold,fontSize:14}}var vu=()=>o(151861),Cu=()=>o(949719);const bu=(0,I().vU)({inputPlaceholder:{defaultMessage:"Filter by…",id:"database.viewSettings.createFilterTab.inputPlaceholder"}});function wu(e){var t;const{context:l,collectionSettingsStore:a,collectionContextStore:c}=e,d=(0,i().O7)(),u=(0,r().Kw)(c.normalizedSchemaStore),p=(0,r().Kw)(c.normalizedFormatStore),g=(0,r().Kw)(c.permissionScopesStore),m=(0,r().VK)((()=>function(e){return e.currentCombinatorFilterStore.state}(c)),[c]),f=(0,r().VK)((()=>{const e=c.collectionViewStore();return e?(0,ft().qd)({schema:u,filters:ku(c),getRecordModel:e.getRecordModel}):[]}),[c,u]),y=(0,n.useCallback)((e=>{if(!e)return;const t=c.collectionViewStore(),o=f.find((t=>t.property===e));if(!o||!t)return;const n={id:Gr().Il(),filter:o};vu().iU({environment:d,collectionContextStore:c,temporaryState:{...c.temporaryStateStore.state,propertyFilters:{value:[...ku(c),n]}}}),function(e,t,o,n,i){if(Wt().wd({environment:i,collectionContextStore:t,action:"create_property_filter"}),o===Ir().HV.FilterBar||o===Ir().HV.TopbarFilterPopup){_u(t,n);const o=t.getFilterBarItemSettingsStore(e);s().wl({collectionSettingsStore:o,item:{type:"filter"}})}else if(o===Ir().HV.ViewSettings){Mu(n);const o=t.getFilterOptionsItemSettingsStore(e);s().wl({collectionSettingsStore:o,item:{type:"filter"}})}}(n,c,l,a,d)}),[c,a,l,d,f]),S=(0,n.useCallback)((()=>{c.collectionViewStore()&&(m||vu().iU({environment:d,collectionContextStore:c,temporaryState:{...c.temporaryStateStore.state,combinatorFilter:{value:o(455947).TI}}}),Pu(c,l,a,d))}),[c,a,m,l,d]);return(0,C.jsx)(B().ZP,{...e,title:(0,C.jsx)(I()._H,{defaultMessage:"Add filter",id:"database.viewSettings.createFilterTab.title"}),footer:g.canConfigureBlock&&(0,C.jsx)(ee().Z,{topBorder:!0,children:(0,C.jsx)(F().Z,{icon:m?o(185056).Q:no().R,isGray:!0,title:m?(0,C.jsx)(I()._H,{defaultMessage:"Advanced filter",id:"database.viewSettings.createFilterTab.advancedFilter.title"}):(0,C.jsx)(I()._H,{defaultMessage:"Add advanced filter",id:"database.viewSettings.createFilterTab.addAdvancedFilter.title"}),right:m&&(0,C.jsx)(I()._H,{defaultMessage:"{ruleCount, plural, one {{ruleCount} rule} other {{ruleCount} rules}}",id:"database.viewSettings.createFilterTab.advancedFilterRulesCount.title",values:{ruleCount:(null===(t=m.filters)||void 0===t?void 0:t.length)||1}}),onClick:S})}),children:(0,C.jsx)(Cu().Z,{schema:u,format:p,getProperties:()=>f.map((e=>e.property)),onAccept:y,inputPlaceholder:Co().Z.formatMessage(bu.inputPlaceholder)})})}const ju=n.memo(wu,ni().Z);function _u(e,t){e.filtersBarOpenStore.setState(!0),s().z$({collectionSettingsStore:t})}function Mu(e){s().wl({collectionSettingsStore:e,item:{type:"main"}}),s().H4({collectionSettingsStore:e,item:{type:"filters"}})}function ku(e){return e.currentPropertyFiltersStore.state}function Pu(e,t,o,n){Wt().wd({environment:n,collectionContextStore:e,action:"create_combinator_filter"}),t===Ir().HV.FilterBar||t===Ir().HV.TopbarFilterPopup?(_u(e,o),s().wl({collectionSettingsStore:e.filterBarCombinatorFilterSettingsStore,item:{type:"filter"}})):t===Ir().HV.ViewSettings&&(Mu(o),s().wl({collectionSettingsStore:e.filterOptionsCombinatorFilterSettingsStore,item:{type:"filter"}}))}const Tu=(0,I().vU)({inputPlaceholder:{defaultMessage:"Sort by…",id:"database.viewSettings.createSortTab.inputPlaceholder"}});const Iu=function(e){const{context:t,collectionContextStore:o,collectionSettingsStore:n}=e,l=(0,i().O7)(),a=(0,I().YB)(),c=(0,r().Kw)(o.normalizedSchemaStore),d=(0,r().Kw)(o.normalizedFormatStore),u=(0,r().VK)((()=>Vu(o)),[o]);return(0,C.jsx)(B().ZP,{...e,collectionSettingsStore:n,title:(0,C.jsx)(I()._H,{defaultMessage:"New sort",id:"database.viewSettings.createSortTab.title"}),children:(0,C.jsx)(Cu().Z,{schema:c,format:d,getProperties:()=>Object.entries(c).filter((e=>{let[t,o]=e;return!u.find((e=>e.property===t))&&(0,ka().bA)(o)})).map((e=>{let[t]=e;return t})),onAccept:e=>function(e,t,o,n,i){var r;if(!e)return;const l=o.collectionViewStore(),a=o.normalizedSchemaStore.state;if(!l||!a)return;const c=null===(r=a[e])||void 0===r?void 0:r.type;Wt().wd({environment:t,collectionContextStore:o,action:"create_sort_accept",original_view_type:l.getType(),property_type:c});const d={property:e,direction:"ascending"},u=[...Vu(o),d];if(vu().iU({environment:t,collectionContextStore:o,temporaryState:{...o.temporaryStateStore.state,sorts:{value:u}}}),n===Ir().HV.TopbarSortPopup||n===Ir().HV.FilterBar){o.filtersBarOpenStore.setState(!0),s().z$({collectionSettingsStore:i});const{filterBarSortSettingsStore:e}=o;s().wl({collectionSettingsStore:e,item:{type:"sort"}})}else n===Ir().HV.ViewSettings&&(s().wl({collectionSettingsStore:i,item:{type:"main"}}),s().H4({collectionSettingsStore:i,item:{type:"sort"}}))}(e,l,o,t,n),inputPlaceholder:a.formatMessage(Tu.inputPlaceholder)})})};function Vu(e){return e.currentSortsStore.state}var Au=()=>o(620218);const Zu=function(e){const{collectionContextStore:t,context:n,collectionSettingsStore:l}=e,a=(0,i().O7)(),c=(0,r().VK)((()=>t.collectionViewStore()),[t]),d=(0,r().Kw)(t.normalizedSchemaStore),u=(0,r().VK)((()=>function(e){return e.currentCombinatorFilterStore.state}(t)),[t]),p=(0,r().VK)((()=>null==c?void 0:c.getType()),[c]);return c&&u&&p?(0,C.jsxs)(B().ZP,{...e,title:(0,C.jsx)(I()._H,{defaultMessage:"Advanced filter",id:"database.viewSettings.filterTab.title"}),unconstrainedWidth:!0,children:[(0,C.jsx)(o(384547).D,{children:(0,C.jsx)(o(347558).Pq,{index:0,level:0,combinatorFilter:u,schema:d,onChange:(e,o)=>function(e,t,o,n){var i;const r=null===(i=n.remoteResultStore.state)||void 0===i?void 0:i.sizeHint,l=Au().default.DO_NOT_USE_markLegacy("collections.update_filter_lag");Au().default.DO_NOT_USE_measureAfterNextFlushLegacy(l,{environment:o,getData:()=>dn().Y5({from:"combinator_filter",collectionContextStore:n,sizeHintAtStart:r})}),vu().iU({environment:o,collectionContextStore:n,temporaryState:{...n.temporaryStateStore.state,combinatorFilter:{value:t}}}),Wt().wd({environment:o,collectionContextStore:n,action:"update_combinator_filter"})}(0,o,a,t),collectionContextStore:t,collectionViewType:p,collectionViewId:c.id,parentStore:c})}),(0,C.jsx)(ee().Z,{topBorder:!0,children:(0,C.jsx)(F().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"Delete filter",id:"database.viewSettings.filterTab.deleteFilterButton.title"}),isRed:!0,icon:T().y,onClick:()=>function(e,t,o,n){vu().iU({environment:e,collectionContextStore:t,temporaryState:{...t.temporaryStateStore.state,combinatorFilter:{value:void 0}}}),o===Ir().HV.FilterBar&&s().E3({collectionSettingsStore:n});Wt().wd({environment:e,collectionContextStore:t,action:"delete_combinator_filter"})}(a,t,n,l)})})]}):null};var Bu=()=>o(259314),Fu=()=>o(845297),Ru=()=>o(364300),Ku=()=>o(9641),Hu=()=>o(84439);function Ou(e){const{collectionSettingsStore:t,collectionContextStore:l}=e,a=(0,i().O7)(),[c,d,u,p]=(0,r().VK)((()=>[l.currentPropertyFiltersStore.state,l.currentPropertyFiltersStore.state.map((e=>e.id)),l.permissionScopesStore.state,(0,ft().yU)(l)]),[l]),g=(0,o(992231).k)(),m=(0,r().VK)((()=>{const e=l.isUnlistedViewStore.state&&l.isInlineViewStore.state;return u.canConfigureBlock||e?l.currentCombinatorFilterStore.state:void 0}),[l,u]),y=(0,n.useCallback)((()=>{s().E3({collectionSettingsStore:l.filterOptionsCombinatorFilterSettingsStore}),c.forEach((e=>{const t=l.getFilterOptionsItemSettingsStore(e);s().E3({collectionSettingsStore:t})}))}),[l,c]);(0,n.useEffect)((()=>y()),[]);const S=(0,f().yK)((e=>({menuItem:{color:e.mediumTextColor},menuItemIcon:{width:14,marginLeft:4,marginRight:4,fill:e.mediumIconColor},mobile:{paddingTop:8,background:e.contentBackground}})),[]);return(0,C.jsx)("div",{onClick:e=>{(0,We().ZP)({event:e,context:We().Af.CollectionSettingsClick,callback:y})},children:(0,C.jsx)(B().ZP,{...e,title:(0,C.jsx)(I()._H,{defaultMessage:"Filters",id:"database.viewSettings.filtersTab.title"}),footer:p&&(0,C.jsx)(ee().Z,{topBorder:!0,children:(0,C.jsx)(Du,{collectionContextStore:l})}),unconstrainedWidth:!0,children:(0,C.jsxs)(ee().Z,{children:[(d.length>0||m)&&(0,C.jsxs)("div",{style:a.device.isMobile?S.mobile:void 0,children:[m&&(0,C.jsx)(Nu,{collectionContextStore:l}),Eu(a)?(0,C.jsx)(Js().ZP,{direction:"vertical",keys:d,renderKey:e=>{const t=d.indexOf(e);return(0,C.jsx)(Uu,{collectionContextStore:l,filter:c[t],onClick:y})},onDrop:e=>function(e,t,o){const n=o.collectionViewBlockStore();if(!n)return;const i=o.currentPropertyFiltersStore.state,r=fi().oA(e.map((e=>i.find((t=>t.id===e)))));vu().iU({environment:t,collectionContextStore:o,temporaryState:{...o.temporaryStateStore.state,propertyFilters:{value:r}}}),Wt().wd({environment:t,collectionContextStore:o,action:"reorder_filters"})}(e,a,l),onDragEnd:()=>g(),disabled:!u.canConfigureBlock}):d.map((e=>{const t=d.indexOf(e);return(0,C.jsx)(Uu,{collectionContextStore:l,filter:c[t],onClick:y},e)}))]}),(0,C.jsx)(q().Z,{focused:!1,icon:(0,no().R)(S.menuItemIcon),style:S.menuItem,title:(0,C.jsx)(I()._H,{defaultMessage:"Add filter",id:"database.viewSettings.filtersTab.newFilter.title"}),onClick:()=>{y(),function(e,t,o){Wt().wd({environment:e,collectionContextStore:o,action:"click_new_filter"}),s().H4({collectionSettingsStore:t,item:{type:"createFilter"}}),o.filtersBarOpenStore.setState(!0)}(a,t,l)}})]})})})}const Lu=n.memo(Ou,ni().Z);function Du(e){let{collectionContextStore:t}=e;return(0,C.jsx)(Hu().ZP,{context:Hu().R1.SettingsFilters,collectionContextStore:t})}function Eu(e){return!e.device.isMobile}function Nu(e){let{collectionContextStore:t}=e;const o=(0,i().O7)();return(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 10px"},children:[Eu(o)&&(0,C.jsx)(Ku().Z,{iconSize:12,style:{marginLeft:6,marginRight:6,opacity:.4,cursor:void 0}}),(0,C.jsx)(Fu().B,{context:Bu().Pt.SettingsFilters,collectionContextStore:t,collectionSettingsStore:t.filterOptionsCombinatorFilterSettingsStore})]})}function Uu(e){let{filter:t,collectionContextStore:o,onClick:n}=e;const l=(0,i().O7)(),a=(0,r().VK)((()=>o.getFilterOptionsItemSettingsStore(t)),[o,t]);return(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 10px"},children:[Eu(l)&&(0,C.jsx)(Ku().Z,{iconSize:12,style:{marginLeft:6,marginRight:6}}),(0,C.jsx)(Ru().Z,{id:t.id,context:Bu().Pt.SettingsFilters,collectionContextStore:o,collectionSettingsStore:a,onClick:n},t.id)]})}var zu=()=>o(691594),Wu=()=>o(608352),qu=()=>o(157593),Gu=()=>o(599291);const Yu=function(e){let{numberGroupBy:t,collectionContextStore:o,schema:n,onChange:i}=e;const l=(0,f().Fg)(),a=n[t.property];return(0,r().VK)((()=>o.collectionStore()),[o])&&a?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(ee().Z,{topBorder:!1,disableMobileBorders:!0,title:(0,C.jsx)(I()._H,{id:"database.groupMenu.numberGroupRange",defaultMessage:"Group range"}),isTitleUppercase:!1,children:(0,C.jsxs)("div",{style:{display:"flex",paddingLeft:14,paddingRight:14},children:[(0,C.jsx)($u,{onChange:i,numberGroupBy:t,inputKey:"start"}),(0,C.jsx)("span",{style:{color:l.mediumTextColor,margin:"0 8px"},children:"–"}),(0,C.jsx)($u,{onChange:i,numberGroupBy:t,inputKey:"end"})]})}),(0,C.jsx)(ee().Z,{topBorder:!1,disableMobileBorders:!0,title:(0,C.jsx)(I()._H,{id:"database.groupMenu.numberGroupSize",defaultMessage:"Group every"}),isTitleUppercase:!1,children:(0,C.jsxs)("div",{style:{paddingLeft:14,paddingRight:14},children:[(0,C.jsx)($u,{onChange:i,numberGroupBy:t,inputKey:"size"}),(0,C.jsxs)("span",{style:{color:l.mediumTextColor,fontSize:12},children:[(0,C.jsx)(qu().Z,{disabled:!0,groupBy:t,groupFormat:{property:t.property,value:{type:"number",value:{type:"range",start:t.start,end:t.start+t.size}}},schema:n,currentGroups:[],isHiddenGroup:!1,style:{display:"inline",paddingRight:0,paddingLeft:0},collectionContextStore:o}),", ",(0,C.jsx)(qu().Z,{disabled:!0,groupBy:t,groupFormat:{property:t.property,value:{type:"number",value:{type:"range",start:t.start+t.size,end:t.start+2*t.size}}},schema:n,currentGroups:[],isHiddenGroup:!1,style:{display:"inline",paddingRight:0,paddingLeft:0},collectionContextStore:o}),", ..."]})]})})]}):null};function $u(e){let{numberGroupBy:t,inputKey:o,onChange:n}=e;return(0,C.jsx)(Gu().V,{value:t[o],onChange:e=>{void 0!==e&&("size"===o&&e<=0&&(e=1),"start"===o&&e>t.end&&(e=t.end),"end"===o&&e<t.start&&(e=t.start),n({newNumberGroupBy:{...t,[o]:e}}))}})}const Qu=function(e){return(0,C.jsx)(B().ZP,{...e,title:(0,C.jsx)(Ju,{collectionSettingsStore:e.collectionSettingsStore,collectionContextStore:e.collectionContextStore}),children:(0,C.jsx)(Xu,{groupByKey:e.groupByKey,groupsFormatKey:e.groupsFormatKey,collectionContextStore:e.collectionContextStore})})};function Ju(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;const n=(0,r().VK)((()=>(0,Ye().n)(t)),[t]),i=(0,r().Kw)(o.normalizedSchemaStore),l=(0,r().Kw)(o.normalizedFormatStore);if(!n||"groupByNumber"!==n.type||"chart_config"===n.groupByKey)return null;const a=l[n.groupByKey];return a?(0,zu().cR)({groupBy:a,schema:i})??null:null}function Xu(e){let{groupByKey:t,groupsFormatKey:o,collectionContextStore:n}=e;const l=(0,i().O7)(),a=(0,r().VK)((()=>n.collectionViewStore()),[n]),s=(0,r().Kw)(n.normalizedSchemaStore),u=(0,r().Kw)(n.normalizedFormatStore),p=(0,r().VK)((()=>(0,Wu().b7)(u,t,o)),[u,t,o]);if(!p||!a)return null;const g=(0,zu().H5)(p);return g?(0,C.jsx)(Yu,{numberGroupBy:g,schema:s,onChange:e=>{if("number"===p.type)d().createAndCommit({userAction:"CollectionSettingsViewGroupByNumber.renderContent",environment:l,canUndo:!0,perform:n=>{c().FH({stores:[a],update:{[t]:e.newNumberGroupBy,[o]:void 0},transaction:n})}});else if("formula"===p.type){const n=fi().CE(e.newNumberGroupBy,"property"),i={...p,groupBy:n};d().createAndCommit({userAction:"CollectionSettingsViewGroupByNumber.renderContent",environment:l,canUndo:!0,perform:e=>{c().FH({stores:[a],update:{[t]:i,[o]:void 0},transaction:e})}})}Wt().wd({environment:l,collectionContextStore:n,action:"group_by_number_update",original_view_type:void 0,property_type:p.type})},collectionContextStore:n}):null}const ep=function(e){const{collectionContextStore:t,collectionSettingsStore:n,groupByKey:l,groupsFormatKey:a}=e,u=(0,i().O7)(),p=(0,r().VK)((()=>(0,Ye().n)(n)),[n]),g=(0,r().VK)((()=>t.collectionViewBlockStore()),[t]),m=(0,r().VK)((()=>t.collectionViewStore()),[t]),f=(0,r().VK)((()=>null==m?void 0:m.getType()),[m]),y=(0,r().VK)((()=>(0,Wu().b7)(t.normalizedFormatStore.state,l,a)),[t,l,a]),S=(0,r().Kw)(t.normalizedSchemaStore),h=(0,r().Kw)(t.normalizedFormatStore),x=(0,r().VK)((()=>void 0!==f&&(0,o(559729)._1)({viewType:f,groupByKey:l})),[l,f]),v=(0,r().VK)((()=>function(e){const t=e.normalizedSchemaStore.state,o=Object.entries(t).sort(tp).map((e=>e[0]));return o.filter((e=>{const o=t[e];return o&&(0,Wu().LG)(o)}))}(t)),[t]);return g&&m&&p&&f&&"groupByProperty"===p.type?(0,C.jsx)(B().ZP,{...e,collectionSettingsStore:n,title:(0,zu().cE)(p.groupByKey,f),children:(0,C.jsx)(Cu().Z,{schema:S,format:h,currentProperty:null==y?void 0:y.property,showNoneOption:x,getProperties:()=>v,onAccept:e=>function(e,t,o,n,i,r){const l=o.collectionViewStore(),a=o.normalizedSchemaStore.state;if(!l)return;if(e){const n=a[e];if(!n||!(0,Wu().LG)(n))return;const s=(0,Wu().fw)({property:e,propertySchema:n,isCollectionTypedView:"collectionTypedView"===o.contextType});d().createAndCommit({userAction:"CollectionSettingsViewGroupByProperty.handlePropertyAccept",environment:t,canUndo:!0,perform:e=>{c().FH({stores:[l],update:{[i]:s,[r]:void 0},transaction:e})}}),Wt().wd({environment:t,collectionContextStore:o,action:"group_by_property_accept",original_view_type:void 0,property_type:n.type})}else d().createAndCommit({userAction:"CollectionSettingsViewGroupByProperty.handlePropertyAccept",environment:t,canUndo:!0,perform:e=>{c().FH({stores:[l],update:{[i]:void 0,[r]:void 0},transaction:e})}}),Wt().wd({environment:t,collectionContextStore:o,action:"group_by_property_accept"});s().wl({collectionSettingsStore:n,item:{type:"main"}}),s().H4({collectionSettingsStore:n,item:{type:"group",groupByKey:i,groupsFormatKey:r}})}(e,u,t,n,l,a)})}):null};function tp(e,t){var o,n;const i=null==e||null===(o=e[1])||void 0===o?void 0:o.name,r=null==t||null===(n=t[1])||void 0===n?void 0:n.name;return i&&r?i.localeCompare(r,void 0,{sensitivity:"base"}):i?1:r?-1:0}const op=(0,I().XN)((function(e){const t=(0,r().VK)((()=>{const t=e.collectionContextStore.collectionViewStore();return"chart"===(null==t?void 0:t.getType())}),[e.collectionContextStore]),o=(0,r().VK)((()=>Mn().Z.state.isOpen),[]);return(0,C.jsx)(B().ZP,{...e,title:(0,C.jsx)(I()._H,{defaultMessage:"Layout",id:"database.viewSettings.layoutTab.title"}),desktopWidth:o?280:290,children:(0,C.jsx)(Pn().Z,{...e,showDoneButton:t})})}));var np=()=>o(818951),ip=()=>o(701182),rp=()=>o(473604);const lp=110,ap=210,sp=223,cp=25,dp=87;function up(e){const{propertyName:t}=e,o=(0,f().Fg)(),n=(0,f().yK)((e=>({dependenciesPreviewOutsideBorder:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:6,alignItems:"center",position:"relative",height:112,paddingLeft:19},svgContainer:{position:"absolute",width:"100%",height:"100%"},svgArrowTheme:{stroke:e.collectionValidDependencyArrow,strokeWidth:ip().lf},dependencyPropertyNamePreview:{fontSize:12,position:"absolute",background:e.buttonBackground,top:48,left:96},timelineItemPreview:{padding:4,margin:"0px 12px",display:"flex",fontSize:14,alignItems:"center",borderRadius:5,background:e.cardBackground,boxShadow:e.buttonBoxShadow,width:100,justifyContent:"center"}})),[]);return(0,C.jsx)(ee().Z,{children:(0,C.jsxs)("div",{style:n.dependenciesPreviewOutsideBorder,children:[(0,C.jsxs)("svg",{style:n.svgContainer,children:[(0,C.jsx)(rp().Z,{startPoint:{x:lp,y:cp},endPoint:{x:lp,y:dp},style:n.svgArrowTheme,showArrowHead:!0}),(0,C.jsx)(rp().Z,{startPoint:{x:ap,y:dp},endPoint:{x:sp,y:dp},style:n.svgArrowTheme,showArrowHead:!1}),(0,C.jsx)("circle",{cx:sp,cy:dp,r:ip().Wk,style:n.svgArrowTheme,fill:o.white})]}),(0,C.jsx)("div",{style:n.dependencyPropertyNamePreview,children:t}),(0,C.jsx)("div",{style:{...n.timelineItemPreview,marginTop:10,marginLeft:10},children:(0,C.jsx)("span",{children:"🌱"})}),(0,C.jsx)("div",{style:{...n.timelineItemPreview,marginTop:34,marginLeft:111},children:(0,C.jsx)("span",{children:"🌳"})})]})})}const pp=(0,I().vU)({subitemInputPlaceholder:{defaultMessage:"Sub-tasks…",id:"database.viewSettings.relationsPropertyTab.subitemInputPlaceholder"},timelineArrowsByInputPlaceholder:{defaultMessage:"Dependencies…",id:"database.viewSettings.relationsPropertyTab.timelineArrowsByInputPlaceholder"}});const gp=(0,I().XN)((function(e,t){const{collectionContextStore:l,collectionSettingsStore:a,formatSetting:u}=e,p=(0,i().Fy)(),g=(0,I().YB)(),m=(0,i().O7)(),S="collection_page_properties",[h]=(0,n.useState)("no_limit"),x="subitem"===u,v="timeline_arrows_by"===u,b=(0,r().VK)((()=>l.databaseType),[l]),w=(0,r().Kw)(l.normalizedSchemaStore),j=(0,r().VK)((()=>l.collectionStore()),[l]),_=(0,r().VK)((()=>(null==j?void 0:j.getFormat())??{}),[j]),M=(0,r().VK)((()=>l.collectionViewStore()),[l]),k=(0,r().VK)((()=>null==M?void 0:M.getFormat()),[M]),P=(null==k?void 0:k.subitem_display_mode)??"show",V=(0,r().VK)((()=>{var e;return x?null===(e=l.currentSubitemFormatStoreForCollectionStore.state)||void 0===e?void 0:e.property:v?l.currentArrowsByFormatStore.state:void 0}),[l,x,v]),A=(0,r().VK)((()=>{var e,t;return x?null===(e=l.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.subitem_property:v?null===(t=l.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.collection_default_arrows_by:void 0}),[l,x,v]),Z=(0,r().Kw)(l.permissionScopesStore),R=(0,r().VK)((()=>ht().NA(l,w)),[l,w]),K=(0,r().VK)((()=>l.normalizedSchemaStore.state),[l]),H=(0,r().VK)((()=>{var e;const t=l.currentSubitemFormatStoreForCollectionStore.state,o=l.currentArrowsByFormatStore.state;let n;return x?n=t?w[t.property]:void 0:v&&(n=o?w[o]:void 0),null===(e=n)||void 0===e?void 0:e.name}),[l,w,x,v]),O=(0,r().VK)((()=>{const e=l.collectionStore();return null!=e&&e.isDefined()?ht().m8(g,{targetCollectionStore:e,isSelfRelation:!0,sourceSchema:K,createUnique:!0,from:u}):g.formatMessage({id:"database.viewSettings.relationsPropertyTab.initialPropertyName.placeholder",defaultMessage:"Related to target"})}),[l,K,g,u]),[L,D]=(0,n.useState)(H||O),E=(0,r().VK)((()=>{const e=l.currentSubitemFormatStoreForCollectionStore.state,t=l.currentArrowsByFormatStore.state;let o;if(x?o=e?w[e.property]:void 0:v&&(o=t?w[t]:void 0),o&&"relation"===o.type){var n;const e=o.property;return e?null===(n=w[e])||void 0===n?void 0:n.name:void 0}}),[l,w,x,v]),N=(0,r().VK)((()=>{const e=l.collectionStore();return null!=e&&e.isDefined()?ht().aI(g,{sourceCollection:e.getModel(),isSelfRelation:!0,targetCollectionStore:e,createUnique:!0,from:u}):g.formatMessage({id:"database.viewSettings.relationsPropertyTab.inverseName.placeholder",defaultMessage:"Related to this database"})}),[l,g,u]),U=(0,r().VK)((()=>"title"===l.normalizedFormatStore.state.table_subitem_toggle_column),[l]),[z,W]=(0,n.useState)({hasInverseRelation:!0,inverseName:E,autoRelate:{enabled:!1}}),[q,Y]=(0,n.useState)(0===R.length),Q=(0,r().qz)(void 0,xt().Z),X=(0,r().Kw)(Q),te=(0,n.useCallback)((()=>ht().NA(l,w)),[l,w]),oe=(0,n.useCallback)((e=>{if(e){const t=w[e];if(t&&"relation"===t.type){const e=t.property;if(e){const t=w[e];if(t&&z){const e=t.name;W({hasInverseRelation:null==z?void 0:z.hasInverseRelation,inverseName:e,autoRelate:null==z?void 0:z.autoRelate})}}D(t.name)}}}),[w,z,D]),ne=(0,n.useCallback)((e=>{const{collectionViewStore:t,newProperty:o,transaction:n}=e;x?(0,fi().o8)(t.getFormat().table_subitem_toggle_column)&&c().FH({stores:[t],update:{table_subitem_toggle_column:"title"},transaction:n}):v&&lu().tF({collectionViewStore:t,newProperty:o,transaction:n})}),[x,v]),ie=(0,n.useCallback)((e=>{const{relationPropertyId:t,transaction:o}=e;x&&st().km({environment:m,collectionContextStore:l,relationPropertyId:t,transaction:o}),v&&lu()._p({collectionContextStore:l,relationPropertyId:t,transaction:o})}),[x,v,m,l]),re=(0,n.useCallback)((e=>{const t=l.collectionViewStore();t&&(d().createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handleDefaultPropertySelect",environment:m,canUndo:!0,perform:o=>{ne({collectionViewStore:t,newProperty:e,transaction:o}),ie({relationPropertyId:e,transaction:o})}}),oe(e),Y(!1),s().E3({collectionSettingsStore:a}),Wt().wd({action:x?"update_default_subitem":"update_default_timeline_arrows_by",original_view_type:void 0,property_type:e?"relation":void 0,environment:m,collectionContextStore:l}))}),[l,m,Y,oe,a,x,ne,ie]),le=(0,n.useCallback)((e=>{const t=l.collectionViewStore();t&&(d().createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handlePropertySelect",environment:m,canUndo:!0,perform:o=>{ne({collectionViewStore:t,newProperty:e,transaction:o})}}),oe(e),Y(!1),s().E3({collectionSettingsStore:a}),Wt().wd({action:x?"update_subitem":"update_timeline_arrows_by",original_view_type:void 0,property_type:e?"relation":void 0,environment:m,collectionContextStore:l}))}),[l,m,oe,a,x,ne]),ae=(0,n.useCallback)((()=>{ot().default.afterNextFlush((()=>{Y(!0),W({hasInverseRelation:!0,inverseName:N,autoRelate:{enabled:!1}}),D(O)}))}),[N,O]),se=(0,n.useCallback)((()=>{if(!z)return;const{hasInverseRelation:e,inverseName:t,autoRelate:o}=z,n=l.collectionStore(),i=n,r=l.collectionViewStore();n&&i&&(d().createAndCommit({userAction:"CollectionSettingsSetupRelation.handleAddRelation",environment:m,canUndo:!0,perform:a=>{const s=at().G3({environment:m,collectionStore:n,collectionViewArgs:r&&S?{collectionViewStore:r,format:r.getFormat(),formatKey:S}:void 0,propertyType:"relation",transaction:a});return Ms().n7({environment:m,collectionContextStore:l,collectionStore:n,property:s,propertyName:L,targetCollectionStore:i,hasInverseRelation:e,inverseName:t,autoRelate:o,propertyLimit:h,intl:g,transaction:a,from:u}),r&&(ne({collectionViewStore:r,newProperty:s,transaction:a}),ie({relationPropertyId:s,transaction:a})),s}}),s().z$({collectionSettingsStore:a}),s().H4({collectionSettingsStore:a,item:{type:"main"}}),Wt()._H({environment:m,collectionContextStore:l,from:u,property_type:"relation"}))}),[l,m,a,S,g,h,L,z,u,ne,ie]),ce=(0,n.useCallback)((()=>{const e=l.collectionViewStore();e&&(qt().d1({environment:m,collectionViewStore:e,currentValue:l.normalizedFormatStore.state.table_subitem_toggle_column}),Wt().wd({environment:m,collectionContextStore:l,action:"toggle_table_subitem_toggle_on_title"}))}),[l,m]),de=!Z.canConfigureBlock,ue=(0,f().yK)((e=>({emptyStateText:{color:e.mediumTextColor,fontSize:14,margin:"0px 12px"},useExistingTitle:{fontSize:12,color:e.mediumTextColor,marginLeft:12,marginTop:12},existingRelationButton:{margin:"6px 12px 6px 12px",width:"auto"}})),[]);if(!j)return null;const pe=x&&Z.canConfigureBlock&&H,ge=Z.canConfigureCollection,me=(e,t,n,i)=>(0,C.jsx)(o(106713).Z,{version:"v1",menuProps:e,property:t,defaultProperty:A,checkState:n,propertySchema:i,collectionContextStore:l,handleDefaultPropertySelect:re,handlePropertySelect:le});return(0,C.jsxs)(B().ZP,{...e,title:(0,C.jsx)(I()._H,{...(0,St().Gt)({feature:u,databaseType:b})}),footer:(0,C.jsxs)(ee().Z,{topBorder:R.length>0&&!q,children:[pe&&!q&&(0,C.jsx)(Yt().Z,{showImage:!de,caption:Co().Z.formatMessage(St().dH.toggleNestingOnTitleMenuItemTooltip),tooltipImage:y().Z.images.tooltips.collectionSettings.subitemsToggleOnTitlePng,tooltipImageScale:.3,render:e=>(0,C.jsx)(yc().Z,{...e,icon:e=>(0,zt().L)({width:11,height:11,marginRight:5,marginLeft:6,transform:"rotateZ(180deg)"}),title:(0,C.jsx)(I()._H,{defaultMessage:"Show nesting toggle on title",id:"database.viewSettings.layoutTab.tableSubitemToggleOnTitle"}),switcherProps:{disallowTabbing:!0,on:U},disabled:de,onClick:ce,isGray:!0})}),ge&&R.length>0&&!q&&(0,C.jsx)(F().Z,{icon:no().R,title:(0,C.jsx)(I()._H,{id:"database.viewSettings.subitemTab.newRelation",defaultMessage:"Create new relation"}),isGray:!0,onClick:ae}),!q&&(0,C.jsx)(C.Fragment,{children:Z.canConfigureBlock&&!Z.canConfigureCollection?(0,C.jsx)(F().Z,{title:(0,C.jsx)(I()._H,{id:"database.viewSettings.relationsPropertyTab.removeSubitemRelation.removeSubitemButton.title",defaultMessage:"Turn off for this view"}),isRed:!0,onClick:()=>le(void 0)}):Z.canConfigureBlock&&(0,C.jsx)(G().ZP,{popupType:p.isPhone?J().kQ.SlideUp:J().kQ.Popup,alignmentToOrigin:G().vR.End,placementToOrigin:G().pO.Bottom,originGap:0,renderOrigin:e=>(0,C.jsx)(C.Fragment,{children:!(!Z.canConfigureBlock||!V)&&(0,C.jsx)(F().Z,{isGray:!0,icon:T().y,title:(0,C.jsx)(I()._H,{...(0,St().nB)({feature:u,databaseType:b})}),isRed:!0,...e})}),render:e=>{let t;return t=p.isPhone?{menuType:na().o.ActionSheet}:{menuType:na().o.Popup,width:300},(0,C.jsx)($().Z,{...t,footer:(0,C.jsxs)(ee().Z,{topBorder:!0,children:[Z.canConfigureBlock&&(0,C.jsx)(F().Z,{title:(0,C.jsx)(I()._H,{id:"database.viewSettings.relationsPropertyTab.removeRelation.removeRelationButton.title",defaultMessage:"Turn off for this view"}),isRed:!0,onClick:()=>le(void 0)}),Z.canConfigureCollection&&(0,C.jsx)(F().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"Turn off for all new views",id:"database.viewSettings.relationsPropertyTab.removeRelation.removeAllDefaultButton.title"}),isRed:!0,onClick:()=>{re(void 0)}})]})})}})})]}),children:[x&&(0,C.jsx)(jt,{propertyName:L||O,inversePropertyName:(null==z?void 0:z.inverseName)||N,subitemsDisplayMode:P}),v&&(0,C.jsx)(up,{propertyName:L||O}),!q&&(0,C.jsx)("div",{style:ue.useExistingTitle,children:(0,C.jsx)(I()._H,{defaultMessage:"Use an existing relation",id:"database.viewSettings.relationsPropertyTab.useExistingRelation.title"})}),R.length>0&&!q?(0,C.jsx)("div",{style:{paddingBottom:"6px"},children:(0,C.jsx)(ee().Z,{children:(0,C.jsx)(G().ZP,{buttonPopupStore:Q,render:e=>{let t;return t=p.isPhone?{menuType:na().o.ActionSheet}:{menuType:na().o.Popup,width:300},(0,C.jsx)($().Z,{...t,footer:(0,C.jsx)(Cu().Z,{schema:w,format:_,getProperties:te,onAccept:Z.canConfigureBlock&&!Z.canConfigureCollection?le:fi().ZT,inputPlaceholder:Co().Z.formatMessage(x?pp.subitemInputPlaceholder:pp.timelineArrowsByInputPlaceholder),currentProperty:V,defaultShowPropertyCount:5,renderProperty:Z.canConfigureBlock&&!Z.canConfigureCollection?void 0:me})})},renderOrigin:e=>{var t;return(0,C.jsx)(F().Z,{title:(0,C.jsx)(I()._H,{id:"database.viewSettings.relationsPropertyTab.existingRelation",defaultMessage:"Property"}),showChevron:!0,right:V?null===(t=w[V])||void 0===t?void 0:t.name:void 0,rotateChevron:X.open,disabled:!1,icon:o(545914).v,...e})},popupType:p.isPhone?J().kQ.SlideUp:J().kQ.Popup,alignmentToOrigin:G().vR.End,placementToOrigin:G().pO.Bottom,originGap:0})})}):ge&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(ee().Z,{children:(0,C.jsx)("div",{style:ue.emptyStateText,children:(0,C.jsx)(I()._H,{defaultMessage:"Rename (optional)",id:"database.viewSettings.relationsPropertyTab.emptyStateDescription"})})}),(0,C.jsx)(ee().Z,{children:(0,C.jsx)(xo().ZP,{value:L,placeholder:L,onChange:e=>D(e.target.value),onBlur:fi().ZT,onSubmit:fi().ZT,focusInitial:!0,selectAll:!1})}),(0,C.jsx)(Vs,{collectionContextStore:l,targetCollectionStore:j,property:void 0,temporaryInverseState:z,setTemporaryInverseState:W,onSubmit:se}),R.length>0&&(0,C.jsx)("div",{style:{margin:"auto",textAlign:"center"},children:(0,C.jsx)(_o().D,{onClick:()=>{ot().default.afterNextFlush((()=>{Y(!1)}))},isGray:!0,style:ue.existingRelationButton,children:(0,C.jsx)(I()._H,{id:"database.viewSettings.relationsPropertyTab.newRelation",defaultMessage:"Use existing relation"})})})]})]})}));var mp=()=>o(119);function fp(e){let{context:t,collectionContextStore:o,collectionSettingsStore:n,fullHeight:l,hideDesktopHeader:a}=e;const c=(0,i().O7)(),[d,u,p,g,m,f]=(0,r().VK)((()=>[o.collectionViewStore(),(0,ft().Mj)(o),o.normalizedSchemaStore.state,o.normalizedFormatStore.state,o.permissionScopesStore.state,yp(o)]),[o]),y=t===Ir().HV.ViewSettings&&u;return d?(0,C.jsx)(B().ZP,{collectionSettingsStore:n,fullHeight:l,hideDesktopHeader:a,title:(0,C.jsx)(I()._H,{defaultMessage:"Sort",id:"database.viewSettings.sortTab.title"}),footer:y&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{style:{paddingTop:24}}),(0,C.jsx)(ee().Z,{topBorder:!0,children:(0,C.jsx)(Sp,{collectionContextStore:o})})]}),unconstrainedWidth:!0,children:(0,C.jsx)(mp().Z,{collectionContextStore:o,schema:p,format:g,sorts:f,disabled:!m.canConfigureBlock,parentStore:d,onChange:e=>function(e,t,o){!function(e,t,o){const n=t.collectionViewStore();if(!n)return;vu().iU({environment:o,collectionContextStore:t,temporaryState:{...t.temporaryStateStore.state,sorts:{value:e}}})}(e,o,t)}(e,c,o),showDeleteAll:!0,onDeleteAll:()=>function(e,t){t===Ir().HV.FilterBar&&s().E3({collectionSettingsStore:e})}(n,t)})}):null}function yp(e){return e.currentSortsStore.state}function Sp(e){let{collectionContextStore:t}=e;return(0,C.jsx)(Hu().ZP,{context:Hu().R1.SettingsSort,collectionContextStore:t})}const hp=2e4,xp=100;var vp=()=>o(530980),Cp=()=>o(122792);var bp=()=>o(996106);const wp={type:"aggregation",filter:void 0,aggregation:{aggregator:"count",property:"title"}};function jp(e){let{collectionContextStore:t}=e;const l=(0,I().YB)(),{isMobile:a}=(0,i().Fy)(),s=(0,f().yK)((e=>({menuItem:{color:e.mediumTextColor,paddingLeft:a?4:8},warningIcon:{fill:(0,tn().fi)("orange",e).fill,marginRight:14,width:12,alignSelf:"center"}})),[a]),c=(0,r().VK)((()=>{var e;return"row_limit_exceeded"===(null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormatStore())||void 0===e?void 0:e.getKeyStore("sync_state").getKeyStore("syncing").getValue())}),[t]),d=(0,r().VK)((()=>un().default.state.currentSpaceStore),[]),u=(0,r().VK)((()=>function(e){if(!e)return hp;const t=vp().kk5.fromSpace(e),o=t.getSetting("database_sync_row_limit");return void 0!==o?o:(0,Cp().QM)(t.getSubscriptionTier())?xp:hp}(null==d?void 0:d.getModel())),[d]),p=(0,r().VK)((()=>(0,Cp().QM)(null==d?void 0:d.getSubscriptionTier())),[d]),g=(0,n.useMemo)((()=>(0,C.jsx)(o(67901).Z,{id:"table:uncategorized:title:count",collectionContextStore:t,reducer:wp,render:e=>{const t=e.state;if(!t||"aggregation"!==t.type)return;if("number"!==t.aggregationResult.type)return;const o={...t.aggregationResult,value:t.aggregationResult.value&&Math.min(u,t.aggregationResult.value)};return(0,bp().uf)(o.value,"number_with_commas",l)}})),[t,l,u]);return(0,C.jsx)(Tr().ZP,{title:(0,C.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[c&&d&&p&&(0,C.jsx)(ro().Z,{placement:ao().Placement.Left,alignment:ao().Alignment.Center,renderTooltip:()=>(0,C.jsx)(I()._H,{id:"database.viewSettings.syncedSourceTab.limitFree.toolTip",defaultMessage:"Free Plans are limited to 1 synced database with up to 100 rows."}),render:e=>(0,C.jsx)("div",{...e,children:(0,id().t)(s.warningIcon)})}),(0,C.jsx)(I()._H,{defaultMessage:"Limit",id:"database.viewSettings.syncedSourceTab.limit"})]}),right:(0,C.jsx)(I()._H,{defaultMessage:"{value}/{limit} rows",id:"database.viewSettings.syncedSourceTab.limitRows",values:{value:g,limit:(0,bp().uf)(u,"number_with_commas",l)}}),style:s.menuItem})}const _p=n.memo(jp,ni().Z);var Mp=()=>o(562842);function kp(e){let{collectionContextStore:t}=e;const l=(0,i().O7)(),{isMobile:a}=l.device,c=(0,f().yK)((e=>({menuItem:{color:e.mediumTextColor,paddingLeft:a?4:8},menuItemIcon:{height:16,width:16,marginRight:2}})),[a]),d=(0,r().VK)((()=>t.collectionStore()),[t]),[u,p]=(0,r().VK)((()=>{const e=null==d?void 0:d.getFormatStore();return[null==e?void 0:e.getKeyStore("uri").getValue(),null==e?void 0:e.getKeyStore("bot_id").getValue()]}),[d]),g=(0,r().VK)((()=>un().default.state.currentSpaceStore),[]),m=(0,r().VK)((()=>{var e;const o=t.numberChildrenUnfurledStore.state,n=t.numberChildrenReceivedStore.state,i=o/n,r=!0===(null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormat().sync_state)||void 0===e?void 0:e.syncing);return o&&n&&i<1&&!a||r&&a}),[t,a]),y=(0,r().VK)((()=>{const e=g&&(0,Cp().QM)(g.getSubscriptionTier());return{defaultMessage:e?"Clear and sync database":"Sync database",description:e?"Clears and refreshes the database ":"Refreshes the synced database."}}),[g]),[S,h]=(0,n.useState)(void 0);(0,n.useEffect)((()=>{if(u&&p){const e=`${p}:${u}`,t=o(35980).Z.get({userId:l.currentUser.id,key:e});h(t)}}),[p,l,u]);const x=!S||S<Date.now();return u&&p?m?(0,C.jsx)(Tr().ZP,{title:(0,C.jsx)(I()._H,{defaultMessage:"Syncing",id:"database.viewSettings.syncedSourceTab.isSyncing"}),icon:(0,Mp().b)(c.menuItemIcon,"sync-spinner"),style:c.menuItem}):x?(0,C.jsx)(F().Z,{isGray:!0,title:(0,C.jsx)(I()._H,{defaultMessage:"{message}",id:"database.viewSettings.syncedSourceTab.syncNow",values:{message:y.defaultMessage,description:y.description}}),icon:Mp().b,onClick:async()=>{const e=null==d?void 0:d.id,t=!0===(null==d?void 0:d.getFormat().stale);e&&await s().R0({environment:l,uri:u,botId:p,collectionId:e,nextSync:S,setNextSync:h,isStale:t})}}):(0,C.jsx)(Tr().ZP,{title:(0,C.jsx)(I()._H,{defaultMessage:"Sync available in {timeToNextSync}",id:"database.viewSettings.syncedSourceTab.syncNow.disabled",values:{timeToNextSync:(0,o(176691).hH)(Date.now(),S)}}),icon:(0,o(973369).T)(c.menuItemIcon),style:c.menuItem}):null}const Pp=n.memo(kp,ni().Z);function Tp(e){var t;let{collectionContextStore:n}=e;const l=(0,i().O7)(),{isMobile:a}=l.device,s=(0,f().yK)((()=>({menuItemTitle:{paddingLeft:a?4:8},menuItemIcon:{height:16,width:16,marginRight:2}})),[a]),c=(0,r().VK)((()=>n.collectionStore()),[n]),[d,u,p]=(0,r().VK)((()=>{const e=null==c?void 0:c.getFormatStore();return[null==e?void 0:e.getKeyStore("uri").getValue(),null==e?void 0:e.getKeyStore("bot_id").getValue(),null==e?void 0:e.getKeyStore("original_url").getValue()]}),[c]),g=null==c||null===(t=c.pointer)||void 0===t?void 0:t.spaceId,m=(0,r().VK)((()=>(0,o(338855).wY)(p,g)),[g,p]),y=(0,r().VK)((()=>n.collectionViewBlockStore()),[n]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(ee().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"Source database",id:"database.viewSettings.syncedSourceTab.sourceDatabase"}),children:(0,C.jsx)(ro().Z,{placement:ao().Placement.Left,alignment:ao().Alignment.Center,renderTooltip:()=>y&&(0,C.jsx)(o(964118).Z,{store:y,compactFormat:!0}),render:e=>(0,C.jsx)(Tr().ZP,{...e,title:m,icon:(0,C.jsx)(fn().Z,{disabled:!0,icon:null==c?void 0:c.getIcon(),isEmptyPage:!1,size:20,style:s.menuItemIcon}),style:s.menuItemTitle})}),style:{paddingBottom:0}}),(0,C.jsx)(ee().Z,{children:(0,C.jsx)(_p,{collectionContextStore:n})}),(0,C.jsxs)(ee().Z,{topBorder:!0,children:[(0,C.jsx)(Pp,{collectionContextStore:n}),(0,C.jsx)(F().Z,{isGray:!0,title:(0,C.jsx)(I()._H,{defaultMessage:"Copy debugging information",id:"database.viewSettings.syncedSourceTab.copyDebugging"}),icon:vs().U,onClick:async()=>{const e=await rn().F.clipboardActions.load(),t={uri:d,botId:u,spaceId:g};e.copyString({environment:l,stringValue:JSON.stringify(t,null,2),copiedMessage:e.clipboardMessages.copiedToClipboard})}}),(0,C.jsx)(Y().Z,{href:`${o(205228).default.domainBaseUrl}?target=connected_apps`,children:(0,C.jsx)(F().Z,{icon:o(323218).g,title:(0,C.jsx)(I()._H,{defaultMessage:"Manage my connections",id:"database.viewSettings.syncedSourceTab.manageConnections"}),isGray:!0})}),(0,C.jsx)(gr().Z,{href:(0,ur().UY)("guides.syncedDatabases"),title:(0,C.jsx)(I()._H,{defaultMessage:"Learn about synced databases",id:"database.viewSettings.syncedSourceTab.learnMoreButton.title."}),analyticsFrom:"view_settings_source"})]})]})}const Ip=n.memo(Tp,ni().Z);function Vp(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,l=(0,i().O7)(),[a,c]=(0,r().VK)((()=>{var e;return[t.collectionViewBlockStore(),Boolean(null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.getCollectionViewSourceCollectionStore())]}),[t]),u=(0,n.useMemo)((()=>oi().default.createValue("")),[]);return a?(0,C.jsx)(B().ZP,{...e,title:(0,C.jsx)(I()._H,{defaultMessage:"Source",id:"database.viewSettings.sourceTab.title"}),handleClose:()=>s().E3({collectionSettingsStore:o}),children:c?(0,C.jsx)(Ip,{collectionContextStore:t}):(0,C.jsx)(Zi,{collectionContextStore:t,parentStore:a,onAccept:e=>function(e,t,o,n){d().createAndCommit({userAction:"CollectionSettingsViewSource.handleSourcePickerAccept",environment:t,canUndo:!0,perform:t=>{$n({collectionContextStore:o,source:{type:"collection",id:e.id,spaceId:e.getSpaceId()},transaction:t})}}),s().z$({collectionSettingsStore:n})}(e,l,t,o),context:Ir().S7.Source,inputStore:u})}):null}const Ap=n.memo(Vp);var Zp=()=>o(26970);function Bp(e){let{subscriptionTier:t,analyticsName:o}=e;const n=(0,i().O7)(),l=(0,r().VK)((()=>(0,Il().Fn)(n)),[n]),a=(0,f().yK)((e=>({container:{margin:"8px 14px",padding:"8px 12px",borderRadius:8,border:`1px solid ${e.stroke.secondary}`,color:e.text.primary,fontSize:14,lineHeight:"20px",display:"flex",justifyContent:"space-between",alignItems:"center"},nonWorkspaceAdmin:{border:"unset",backgroundColor:e.lightGrayButtonBackground}})),[]);return(0,C.jsx)(jo().Z,{...(0,Zp().iv)(a.container,!l&&a.nonWorkspaceAdmin),onClick:()=>{Pl().y(n,{from:o,upsell:{type:"product",product:t,limit:{type:"none"}}})},disabled:!l,children:l?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(I()._H,{id:"upsellBannerButton.title.workspaceAdmin",defaultMessage:"Upgrade to unlock"}),(0,C.jsx)(Rd().Z,{subscriptionTier:t,analyticsName:o,desktopStyle:{marginLeft:8},disableTooltip:!0})]}):(0,C.jsx)(I()._H,{id:"upsellBannerButton.title.nonWorkspaceAdmin",defaultMessage:"Contact your workspace owner to upgrade to unlock this feature"})})}var Fp=()=>o(994953),Rp=()=>o(839708),Kp=()=>o(623498),Hp=()=>o(12512);function Op(e){let{formBlockStore:t,disabled:o}=e;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Lp,{formBlockStore:t,disabled:o}),(0,C.jsx)(Dp,{formBlockStore:t,disabled:o})]})}function Lp(e){let{formBlockStore:t,disabled:o}=e;const n=(0,r().VK)((()=>t.getFormConfigStore().getKeyStore("custom_confirmation_screen_title")),[t]);return(0,C.jsx)(ee().Z,{title:(0,C.jsx)(I()._H,{id:"formCustomizeSettings.customizeConfirmationScreen.title",defaultMessage:"Confirmation title"}),style:{paddingBottom:8},children:(0,C.jsx)(Ep,{formBlockStore:t,disabled:o,textStore:n,settingName:"custom_confirmation_screen_title"})})}function Dp(e){let{formBlockStore:t,disabled:o}=e;const n=(0,r().VK)((()=>t.getFormConfigStore().getKeyStore("custom_confirmation_screen_body")),[t]);return(0,C.jsx)(ee().Z,{title:(0,C.jsx)(I()._H,{id:"formCustomizeSettings.customizeConfirmationScreen.body",defaultMessage:"Confirmation body"}),style:{paddingBottom:12},children:(0,C.jsx)(Ep,{formBlockStore:t,disabled:o,textStore:n,textarea:!0,settingName:"custom_confirmation_screen_body"})})}function Ep(e){let{formBlockStore:t,disabled:o,textStore:l,textarea:a,settingName:s}=e;const c=(0,i().O7)(),d=(0,f().yK)((e=>({input:{fontSize:14,lineHeight:"20px",borderRadius:6,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",padding:"3px 6px",margin:"0 14px",width:"auto",overflow:"hidden",height:a?68:28,textWrap:a?"wrap":"nowrap",opacity:o?.4:1}})),[a,o]),u=(0,r().VK)((()=>t.getSpaceId()),[t]),p=(0,fi().Ds)((0,n.useCallback)((()=>{(0,mt().j)({environment:c,event:{eventName:"form_settings_changed",eventProperties:{form_id:t.id,form_setting:s}}})}),[t.id,c,s]),1e3),g=(0,Rp().r)({textStore:l,parentStore:t,spaceId:u,disabled:!0});return o?(0,C.jsx)("div",{style:d.input,children:g}):(0,C.jsx)(Kp().Z,{disabled:o,store:l,pasteBehavior:"inline",inPageFind:Hp().B3.none,style:d.input,disabledMentionTypes:{page:!1,date:!1,user:!0,createPage:!0,inviteUserToWorkspace:!0,inviteUserToPage:!0,reminder:!0,bot:!0,heading:!0,group:!0,templateVariable:!0},disableSlashCommands:!0,disableEmbedMenu:!0,disableMobileActionBar:!0,disableComment:!0,disableEnter:!0,disableHorizontalEdgeScroll:!0,disableEquationInteraction:!0,disableTemplateVariableMentions:!0,disableFilters:!0,disableRightMarginHoverStyling:!0,disableSuggestEdit:!0,disableShiftEnter:!0,onChange:p,onTab:fi().yR,onUntab:fi().yR})}var Np=()=>o(933110),Up=()=>o(50366),zp=()=>o(7932),Wp=()=>o(242958),qp=()=>o(104088);const Gp=30,Yp=(0,I().vU)({submitButtonTextPlaceholder:{id:"formCustomizeSettings.customizeSubmitButton.text.placeholder",defaultMessage:"Submit"}});function $p(e){let{formBlockStore:t,disabled:o}=e;return(0,C.jsxs)(ee().Z,{title:(0,C.jsx)(I()._H,{id:"formCustomizeSettings.customizeSubmitButton.title",defaultMessage:"Submit button"}),children:[(0,C.jsx)(Qp,{formBlockStore:t,disabled:o}),(0,C.jsx)(Jp,{formBlockStore:t,disabled:o})]})}function Qp(e){let{formBlockStore:t,disabled:o}=e;const l=(0,i().Fy)(),{customSubmitButtonColorStore:a,currentColor:s}=(0,r().VK)((()=>{const e=t.getFormConfigStore().getKeyStore("custom_submit_button_color");return{customSubmitButtonColorStore:e,currentColor:(null==e?void 0:e.getValue())??"gray"}}),[t]),c=(0,C.jsx)(I()._H,{...bn().RR[s]}),u=(0,n.useCallback)((e=>{let{environment:o,color:n}=e;a&&(d().createAndCommit({userAction:"formSettings.setFormConfig.customSubmitButtonColor",environment:o,canUndo:!0,perform:e=>{Zn().sO({store:a,value:n,transaction:e})}}),(0,mt().j)({environment:o,event:{eventName:"form_settings_changed",eventProperties:{form_setting:"custom_submit_button_color",form_id:t.id}}}))}),[a,t.id]),p=(0,f().yK)((e=>({colorLabelWrapper:{display:"flex",alignItems:"center",gap:6},selectedCircle:{height:12,width:12,stroke:bn().Lr[e.mode][s],fill:bn().Lr[e.mode][s]},colorLabel:{fontSize:14,lineHeight:"18px"}})),[s]);return(0,C.jsx)(G().ZP,{popupType:l.isPhone?qp().k.SlideUp:qp().k.Popup,alignmentToOrigin:G().vR.End,placementToOrigin:G().pO.Bottom,disabled:o,originGap:0,renderOrigin:e=>(0,C.jsx)(F().Z,{...e,title:(0,C.jsx)(I()._H,{id:"formCustomizeSettings.customizeSubmitButton.color",defaultMessage:"Color"}),disabled:o,icon:Np().T,iconStyle:{height:20,width:20,marginRight:0},right:(0,C.jsxs)("div",{style:p.colorLabelWrapper,children:[(0,Up().U)(p.selectedCircle),(0,C.jsx)("div",{style:p.colorLabel,children:c})]}),showChevron:!0}),render:e=>(0,C.jsx)(Wp().Z,{parent:e,currentColor:s,onColorSelected:u}),style:{padding:"5px 0"}})}function Jp(e){let{formBlockStore:t,disabled:o}=e;const l=(0,i().O7)(),a=(0,I().YB)(),{customSubmitButtonTextStore:s,currentText:c}=(0,r().VK)((()=>{const e=t.getFormConfigStore().getKeyStore("custom_submit_button_text");return{customSubmitButtonTextStore:e,currentText:(null==e?void 0:e.getValue())??""}}),[t]),u=(0,n.useCallback)((e=>{s&&(d().createAndCommit({userAction:"formSettings.setFormConfig.customSubmitButtonText",environment:l,canUndo:!0,perform:t=>{Zn().sO({store:s,value:e,transaction:t})}}),(0,mt().j)({environment:l,event:{eventName:"form_settings_changed",eventProperties:{form_setting:"custom_submit_button_text",form_id:t.id}}}))}),[s,l,t.id]),p=(0,fi().Ds)(u,500);return(0,C.jsx)(Tr().ZP,{title:(0,C.jsx)(I()._H,{id:"formCustomizeSettings.customizeSubmitButton.text",defaultMessage:"Text"}),icon:(0,zp().V)({width:20,height:20}),right:(0,C.jsx)(kn().I,{disabled:o,initialValue:c,placeholder:a.formatMessage(Yp.submitButtonTextPlaceholder),onBlur:u,onSubmit:u,onChange:p,inputOuterStyle:{margin:0,width:160},maxLength:Gp,textWrapperStyle:{margin:0}}),style:{padding:"5px 4px",lineHeight:"28px"},disabled:o})}function Xp(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,n=(0,i().Fy)(),l=function(){const e=(0,i().O7)(),t=(0,On().r)(),o=e.currentUser.id,n=null==t?void 0:t.id;return(0,Ln().VX)({name:"form_customization",spaceId:n,userId:o})}(),a=!l,s=(0,r().VK)((()=>t.collectionViewStore()),[t]),c=(0,r().VK)((()=>{if(!s)throw new Error("No CollectionViewStore found");return s.getFormBlockStore()}),[s]);return s&&c?(0,C.jsx)(Fp().O,{children:(0,C.jsx)(B().ZP,{collectionSettingsStore:o,title:(0,C.jsx)(I()._H,{id:"formCustomizeSettings.menuTitle",defaultMessage:"Customize"}),menuScrollerStyle:n.isMobile?void 0:{maxHeight:600},children:(0,C.jsxs)("div",{style:{padding:"0 6px 8px"},children:[l?null:(0,C.jsx)(Bp,{subscriptionTier:"plus",analyticsName:"forms_customize_settings"}),(0,C.jsx)($p,{formBlockStore:c,disabled:a}),(0,C.jsx)(Op,{formBlockStore:c,disabled:a})]})})}):null}var eg=()=>o(215134),tg=()=>o(318220),og=()=>o(582025),ng=()=>o(375255),ig=()=>o(509572),rg=()=>o(641929);const lg=(0,v().IU)("collectionFormCheckboxQuestionType",{viewBox:"0 0 40 40",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("rect",{width:"10",height:"2",x:"22.5",y:"12.602",fill:"#E3E2E0",rx:"1"}),(0,C.jsx)("rect",{width:"10",height:"2",x:"22.5",y:"19.602",fill:"#E3E2E0",rx:"1"}),(0,C.jsx)("rect",{width:"25",height:"2",x:"7.5",y:"26.602",fill:"#E3E2E0",rx:"1"}),(0,C.jsx)("path",{fill:"#2383E2",fillOpacity:"0.57",d:"M9.568 22.602c-1.336 0-2.068-.727-2.068-2.057v-7.09c0-1.33.732-2.057 2.068-2.057h7.067c1.342 0 2.068.727 2.068 2.057v7.09c0 1.33-.726 2.057-2.068 2.057H9.568zm.164-1.512h6.739c.468 0 .72-.229.72-.727v-6.72c0-.498-.252-.733-.72-.733H9.732c-.468 0-.72.235-.72.733v6.72c0 .498.252.727.72.727zm2.76-1.307c-.246 0-.445-.111-.615-.322l-1.313-1.564a.692.692 0 01-.175-.457c0-.34.275-.61.615-.61.193 0 .351.076.498.258l.978 1.201 2.104-3.387c.14-.234.328-.351.545-.351.328 0 .633.24.633.586 0 .14-.065.287-.159.428l-2.513 3.884a.715.715 0 01-.598.334z"})]})}),ag=(0,v().IU)("collectionFormCheckboxQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("rect",{width:"10",height:"2",x:"22.5",y:"12.602",fill:"#fff",fillOpacity:"0.283",rx:"1"}),(0,C.jsx)("rect",{width:"10",height:"2",x:"22.5",y:"19.602",fill:"#fff",fillOpacity:"0.283",rx:"1"}),(0,C.jsx)("rect",{width:"25",height:"2",x:"7.5",y:"26.602",fill:"#fff",fillOpacity:"0.283",rx:"1"}),(0,C.jsx)("path",{fill:"#2383E2",d:"M9.568 22.602c-1.336 0-2.068-.727-2.068-2.057v-7.09c0-1.33.732-2.057 2.068-2.057h7.067c1.342 0 2.068.727 2.068 2.057v7.09c0 1.33-.726 2.057-2.068 2.057H9.568zm.164-1.512h6.739c.468 0 .72-.229.72-.727v-6.72c0-.498-.252-.733-.72-.733H9.732c-.468 0-.72.235-.72.733v6.72c0 .498.252.727.72.727zm2.76-1.307c-.246 0-.445-.111-.615-.322l-1.313-1.564a.692.692 0 01-.175-.457c0-.34.275-.61.615-.61.193 0 .351.076.498.258l.978 1.201 2.104-3.387c.14-.234.328-.351.545-.351.328 0 .633.24.633.586 0 .14-.065.287-.159.428l-2.513 3.884a.715.715 0 01-.598.334z"})]})}),sg=(0,v().IU)("collectionFormDateQuestionType",{viewBox:"0 0 40 40",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("path",{d:"M13.335 28.9893C11.2939 28.9893 10.2686 27.9834 10.2686 25.9619V14.0381C10.2686 12.0166 11.2939 11.0107 13.335 11.0107H26.6748C28.7158 11.0107 29.7314 12.0264 29.7314 14.0381V25.9619C29.7314 27.9736 28.7158 28.9893 26.6748 28.9893H13.335ZM13.1885 27.417H26.8018C27.6709 27.417 28.1592 26.958 28.1592 26.0498V16.8408C28.1592 15.9424 27.6709 15.4736 26.8018 15.4736H13.1885C12.3193 15.4736 11.8408 15.9424 11.8408 16.8408V26.0498C11.8408 26.958 12.3193 27.417 13.1885 27.417ZM18.1006 18.9795C17.7588 18.9795 17.6416 18.8818 17.6416 18.54V17.9639C17.6416 17.6221 17.7588 17.5146 18.1006 17.5146H18.6768C19.0186 17.5146 19.126 17.6221 19.126 17.9639V18.54C19.126 18.8818 19.0186 18.9795 18.6768 18.9795H18.1006ZM21.3428 18.9795C21.001 18.9795 20.8838 18.8818 20.8838 18.54V17.9639C20.8838 17.6221 21.001 17.5146 21.3428 17.5146H21.9189C22.2607 17.5146 22.3779 17.6221 22.3779 17.9639V18.54C22.3779 18.8818 22.2607 18.9795 21.9189 18.9795H21.3428ZM24.585 18.9795C24.2432 18.9795 24.1357 18.8818 24.1357 18.54V17.9639C24.1357 17.6221 24.2432 17.5146 24.585 17.5146H25.1611C25.5029 17.5146 25.6201 17.6221 25.6201 17.9639V18.54C25.6201 18.8818 25.5029 18.9795 25.1611 18.9795H24.585ZM14.8584 22.1729C14.5068 22.1729 14.3994 22.0752 14.3994 21.7334V21.1572C14.3994 20.8154 14.5068 20.7178 14.8584 20.7178H15.4248C15.7764 20.7178 15.8838 20.8154 15.8838 21.1572V21.7334C15.8838 22.0752 15.7764 22.1729 15.4248 22.1729H14.8584ZM18.1006 22.1729C17.7588 22.1729 17.6416 22.0752 17.6416 21.7334V21.1572C17.6416 20.8154 17.7588 20.7178 18.1006 20.7178H18.6768C19.0186 20.7178 19.126 20.8154 19.126 21.1572V21.7334C19.126 22.0752 19.0186 22.1729 18.6768 22.1729H18.1006ZM14.8584 25.376C14.5068 25.376 14.3994 25.2686 14.3994 24.9268V24.3506C14.3994 24.0088 14.5068 23.9111 14.8584 23.9111H15.4248C15.7764 23.9111 15.8838 24.0088 15.8838 24.3506V24.9268C15.8838 25.2686 15.7764 25.376 15.4248 25.376H14.8584ZM18.1006 25.376C17.7588 25.376 17.6416 25.2686 17.6416 24.9268V24.3506C17.6416 24.0088 17.7588 23.9111 18.1006 23.9111H18.6768C19.0186 23.9111 19.126 24.0088 19.126 24.3506V24.9268C19.126 25.2686 19.0186 25.376 18.6768 25.376H18.1006Z",fill:"#E3E2E0"}),(0,C.jsx)("rect",{x:"21.0049",y:"20.7861",width:"4.74121",height:"4.74121",rx:"1",fill:"#2383E2",fillOpacity:"0.57"})]})}),cg=(0,v().IU)("collectionFormDateQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("path",{d:"M13.335 28.9893C11.2939 28.9893 10.2686 27.9834 10.2686 25.9619V14.0381C10.2686 12.0166 11.2939 11.0107 13.335 11.0107H26.6748C28.7158 11.0107 29.7314 12.0264 29.7314 14.0381V25.9619C29.7314 27.9736 28.7158 28.9893 26.6748 28.9893H13.335ZM13.1885 27.417H26.8018C27.6709 27.417 28.1592 26.958 28.1592 26.0498V16.8408C28.1592 15.9424 27.6709 15.4736 26.8018 15.4736H13.1885C12.3193 15.4736 11.8408 15.9424 11.8408 16.8408V26.0498C11.8408 26.958 12.3193 27.417 13.1885 27.417ZM18.1006 18.9795C17.7588 18.9795 17.6416 18.8818 17.6416 18.54V17.9639C17.6416 17.6221 17.7588 17.5146 18.1006 17.5146H18.6768C19.0186 17.5146 19.126 17.6221 19.126 17.9639V18.54C19.126 18.8818 19.0186 18.9795 18.6768 18.9795H18.1006ZM21.3428 18.9795C21.001 18.9795 20.8838 18.8818 20.8838 18.54V17.9639C20.8838 17.6221 21.001 17.5146 21.3428 17.5146H21.9189C22.2607 17.5146 22.3779 17.6221 22.3779 17.9639V18.54C22.3779 18.8818 22.2607 18.9795 21.9189 18.9795H21.3428ZM24.585 18.9795C24.2432 18.9795 24.1357 18.8818 24.1357 18.54V17.9639C24.1357 17.6221 24.2432 17.5146 24.585 17.5146H25.1611C25.5029 17.5146 25.6201 17.6221 25.6201 17.9639V18.54C25.6201 18.8818 25.5029 18.9795 25.1611 18.9795H24.585ZM14.8584 22.1729C14.5068 22.1729 14.3994 22.0752 14.3994 21.7334V21.1572C14.3994 20.8154 14.5068 20.7178 14.8584 20.7178H15.4248C15.7764 20.7178 15.8838 20.8154 15.8838 21.1572V21.7334C15.8838 22.0752 15.7764 22.1729 15.4248 22.1729H14.8584ZM18.1006 22.1729C17.7588 22.1729 17.6416 22.0752 17.6416 21.7334V21.1572C17.6416 20.8154 17.7588 20.7178 18.1006 20.7178H18.6768C19.0186 20.7178 19.126 20.8154 19.126 21.1572V21.7334C19.126 22.0752 19.0186 22.1729 18.6768 22.1729H18.1006ZM14.8584 25.376C14.5068 25.376 14.3994 25.2686 14.3994 24.9268V24.3506C14.3994 24.0088 14.5068 23.9111 14.8584 23.9111H15.4248C15.7764 23.9111 15.8838 24.0088 15.8838 24.3506V24.9268C15.8838 25.2686 15.7764 25.376 15.4248 25.376H14.8584ZM18.1006 25.376C17.7588 25.376 17.6416 25.2686 17.6416 24.9268V24.3506C17.6416 24.0088 17.7588 23.9111 18.1006 23.9111H18.6768C19.0186 23.9111 19.126 24.0088 19.126 24.3506V24.9268C19.126 25.2686 19.0186 25.376 18.6768 25.376H18.1006Z",fill:"white",fillOpacity:"0.283"}),(0,C.jsx)("rect",{x:"21.0049",y:"20.7861",width:"4.74121",height:"4.74121",rx:"1",fill:"#2383E2"})]})}),dg=(0,v().IU)("collectionFormEmailQuestionType",{viewBox:"0 0 40 40",svg:(0,C.jsx)("g",{children:(0,C.jsx)("path",{fill:"#2383E2",fillOpacity:"0.57",d:"M10.798 20.026c0-5.625 3.867-9.386 9.404-9.386 5.265 0 9 3.34 9 8.42 0 3.41-1.59 5.748-4.183 5.748-1.415 0-2.453-.712-2.69-1.89h-.123c-.492 1.204-1.476 1.898-2.812 1.898-2.32 0-3.903-1.95-3.903-4.763 0-2.769 1.565-4.667 3.806-4.667 1.283 0 2.329.641 2.777 1.705h.132v-.72c0-.616.343-.985.94-.985.598 0 .94.369.94.984v5.397c0 .914.476 1.45 1.32 1.45 1.274 0 2.065-1.609 2.065-4 0-4.402-3.2-6.951-7.286-6.951-4.527 0-7.568 3.19-7.568 7.813 0 4.773 3.19 7.638 7.972 7.638 1.037 0 1.793-.14 2.645-.325.185-.036.343-.062.475-.062.475 0 .756.308.756.712 0 .387-.202.694-.774.896-.755.255-1.96.422-3.392.422-5.555 0-9.501-3.577-9.501-9.334zm9.026 3.05c1.389 0 2.277-1.169 2.277-3.023 0-1.82-.88-2.953-2.268-2.953-1.371 0-2.232 1.151-2.232 2.98 0 1.854.852 2.996 2.223 2.996z"})})}),ug=(0,v().IU)("collectionFormEmailQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,C.jsx)("g",{children:(0,C.jsx)("path",{fill:"#2383E2",d:"M10.798 20.026c0-5.625 3.867-9.386 9.404-9.386 5.265 0 9 3.34 9 8.42 0 3.41-1.59 5.748-4.183 5.748-1.415 0-2.453-.712-2.69-1.89h-.123c-.492 1.204-1.476 1.898-2.812 1.898-2.32 0-3.903-1.95-3.903-4.763 0-2.769 1.565-4.667 3.806-4.667 1.283 0 2.329.641 2.777 1.705h.132v-.72c0-.616.343-.985.94-.985.598 0 .94.369.94.984v5.397c0 .914.476 1.45 1.32 1.45 1.274 0 2.065-1.609 2.065-4 0-4.402-3.2-6.951-7.286-6.951-4.527 0-7.568 3.19-7.568 7.813 0 4.773 3.19 7.638 7.972 7.638 1.037 0 1.793-.14 2.645-.325.185-.036.343-.062.475-.062.475 0 .756.308.756.712 0 .387-.202.694-.774.896-.755.255-1.96.422-3.392.422-5.555 0-9.501-3.577-9.501-9.334zm9.026 3.05c1.389 0 2.277-1.169 2.277-3.023 0-1.82-.88-2.953-2.268-2.953-1.371 0-2.232 1.151-2.232 2.98 0 1.854.852 2.996 2.223 2.996z"})})}),pg=(0,v().IU)("collectionFormFileQuestionType",{viewBox:"0 0 40 40",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("path",{fill:"#2383E2",fillOpacity:"0.57",d:"M20.824 31.179c0 .455-.38.821-.824.821a.828.828 0 01-.824-.821V26.15l.065-1.808-.921.976-.976 1.021a.813.813 0 01-.585.255c-.445 0-.759-.322-.759-.765 0-.256.098-.444.271-.6l3.122-2.94c.228-.211.401-.289.607-.289.206 0 .38.078.607.288l3.122 2.941a.761.761 0 01.271.6.74.74 0 01-.759.765.795.795 0 01-.585-.255l-.976-1.02-.921-.977.065 1.808v5.029z"}),(0,C.jsx)("path",{fill:"#E3E2E0",fillRule:"evenodd",d:"M11 28.595c0 2.236 1.102 3.35 3.318 3.35h3.488a2.304 2.304 0 01-.13-.766v-.958h-3.284c-1.102 0-1.67-.588-1.67-1.659v-16.17c0-1.06.568-1.67 1.681-1.67h4.762v6.219c0 1.348.675 2.011 2.012 2.011h6.1v9.61c0 1.07-.567 1.66-1.68 1.66h-3.273v.957c0 .27-.046.527-.13.765h3.489c2.215 0 3.317-1.123 3.317-3.35v-9.716c0-1.381-.16-1.98-1.017-2.858l-5.896-6.003C21.273 9.182 20.599 9 19.4 9h-5.083C12.113 9 11 10.134 11 12.36v16.235zm15.945-11.258H21.37c-.428 0-.589-.172-.589-.6v-5.682l6.164 6.282z",clipRule:"evenodd"})]})}),gg=(0,v().IU)("collectionFormFileQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("path",{fill:"#2383E2",d:"M20.824 31.179c0 .455-.38.821-.824.821a.828.828 0 01-.824-.821V26.15l.065-1.808-.921.976-.976 1.021a.813.813 0 01-.585.255c-.445 0-.759-.322-.759-.765 0-.256.098-.444.271-.6l3.122-2.94c.228-.211.401-.289.607-.289.206 0 .38.078.607.288l3.122 2.941a.761.761 0 01.271.6.74.74 0 01-.759.765.795.795 0 01-.585-.255l-.976-1.02-.921-.977.065 1.808v5.029z"}),(0,C.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M11 28.595c0 2.236 1.102 3.35 3.318 3.35h3.488a2.304 2.304 0 01-.13-.766v-.958h-3.284c-1.102 0-1.67-.588-1.67-1.659v-16.17c0-1.06.568-1.67 1.681-1.67h4.762v6.219c0 1.348.675 2.011 2.012 2.011h6.1v9.61c0 1.07-.567 1.66-1.68 1.66h-3.273v.957c0 .27-.046.527-.13.765h3.489c2.215 0 3.317-1.123 3.317-3.35v-9.716c0-1.381-.16-1.98-1.017-2.858l-5.896-6.003C21.273 9.182 20.599 9 19.4 9h-5.083C12.113 9 11 10.134 11 12.36v16.235zm15.945-11.258H21.37c-.428 0-.589-.172-.589-.6v-5.682l6.164 6.282z",clipRule:"evenodd"})]})}),mg=(0,v().IU)("collectionFormMultiSelectQuestionType",{viewBox:"0 0 40 40",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("rect",{x:"17",y:"10",width:"14",height:"2",rx:"1",fill:"#E3E2E0"}),(0,C.jsx)("rect",{x:"17",y:"19",width:"14",height:"2",rx:"1",fill:"#E3E2E0"}),(0,C.jsx)("rect",{x:"17",y:"28",width:"14",height:"2",rx:"1",fill:"#E3E2E0"}),(0,C.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 12.5C11.8284 12.5 12.5 11.8284 12.5 11C12.5 10.1716 11.8284 9.5 11 9.5C10.1716 9.5 9.5 10.1716 9.5 11C9.5 11.8284 10.1716 12.5 11 12.5ZM11 14C12.6569 14 14 12.6569 14 11C14 9.34315 12.6569 8 11 8C9.34315 8 8 9.34315 8 11C8 12.6569 9.34315 14 11 14Z",fill:"#2383E2",fillOpacity:"0.57"}),(0,C.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 21.5C11.8284 21.5 12.5 20.8284 12.5 20C12.5 19.1716 11.8284 18.5 11 18.5C10.1716 18.5 9.5 19.1716 9.5 20C9.5 20.8284 10.1716 21.5 11 21.5ZM11 23C12.6569 23 14 21.6569 14 20C14 18.3431 12.6569 17 11 17C9.34315 17 8 18.3431 8 20C8 21.6569 9.34315 23 11 23Z",fill:"#2383E2",fillOpacity:"0.57"}),(0,C.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 30.5C11.8284 30.5 12.5 29.8284 12.5 29C12.5 28.1716 11.8284 27.5 11 27.5C10.1716 27.5 9.5 28.1716 9.5 29C9.5 29.8284 10.1716 30.5 11 30.5ZM11 32C12.6569 32 14 30.6569 14 29C14 27.3431 12.6569 26 11 26C9.34315 26 8 27.3431 8 29C8 30.6569 9.34315 32 11 32Z",fill:"#E3E2E0"})]})}),fg=(0,v().IU)("collectionFormMultiSelectQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("rect",{x:"17",y:"10",width:"14",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,C.jsx)("rect",{x:"17",y:"19",width:"14",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,C.jsx)("rect",{x:"17",y:"28",width:"14",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,C.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 12.5C11.8284 12.5 12.5 11.8284 12.5 11C12.5 10.1716 11.8284 9.5 11 9.5C10.1716 9.5 9.5 10.1716 9.5 11C9.5 11.8284 10.1716 12.5 11 12.5ZM11 14C12.6569 14 14 12.6569 14 11C14 9.34315 12.6569 8 11 8C9.34315 8 8 9.34315 8 11C8 12.6569 9.34315 14 11 14Z",fill:"#2383E2"}),(0,C.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 21.5C11.8284 21.5 12.5 20.8284 12.5 20C12.5 19.1716 11.8284 18.5 11 18.5C10.1716 18.5 9.5 19.1716 9.5 20C9.5 20.8284 10.1716 21.5 11 21.5ZM11 23C12.6569 23 14 21.6569 14 20C14 18.3431 12.6569 17 11 17C9.34315 17 8 18.3431 8 20C8 21.6569 9.34315 23 11 23Z",fill:"#2383E2"}),(0,C.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 30.5C11.8284 30.5 12.5 29.8284 12.5 29C12.5 28.1716 11.8284 27.5 11 27.5C10.1716 27.5 9.5 28.1716 9.5 29C9.5 29.8284 10.1716 30.5 11 30.5ZM11 32C12.6569 32 14 30.6569 14 29C14 27.3431 12.6569 26 11 26C9.34315 26 8 27.3431 8 29C8 30.6569 9.34315 32 11 32Z",fill:"white",fillOpacity:"0.283"})]})}),yg=(0,v().IU)("collectionFormNumberQuestionType",{viewBox:"0 0 40 40",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("path",{d:"M26.3063 25.1304C24.5768 25.1304 23.4557 24.4263 22.943 23.4351C22.8131 23.1958 22.7584 22.9702 22.7584 22.7378C22.7584 22.2729 23.0524 21.979 23.5445 21.979C23.9068 21.979 24.1256 22.1362 24.3102 22.4985C24.652 23.2437 25.2467 23.688 26.3268 23.688C27.4479 23.688 28.2067 23.0454 28.2067 22.1499C28.2135 21.0972 27.4479 20.5093 26.1832 20.5093H25.6227C25.1852 20.5093 24.9254 20.2427 24.9254 19.853C24.9254 19.4634 25.1852 19.1968 25.6227 19.1968H26.1422C27.2291 19.1968 27.9537 18.5747 27.9537 17.6997C27.9537 16.8452 27.3932 16.271 26.2994 16.271C25.3697 16.271 24.8297 16.6538 24.5016 17.4263C24.3102 17.8501 24.1188 18.0073 23.7086 18.0073C23.2164 18.0073 22.9566 17.7202 22.9566 17.269C22.9566 17.0229 23.0045 16.8042 23.1275 16.5649C23.5924 15.5874 24.6861 14.8696 26.2926 14.8696C28.3365 14.8696 29.649 15.936 29.649 17.4604C29.649 18.6978 28.7672 19.5249 27.5777 19.771V19.8052C29.0338 19.9419 29.9977 20.8169 29.9977 22.1909C29.9977 23.9409 28.4664 25.1304 26.3063 25.1304Z",fill:"#2383E2",fillOpacity:"0.57"}),(0,C.jsx)("path",{d:"M15.4749 24.9321C14.928 24.9321 14.6409 24.6313 14.6409 24.187C14.6409 23.8452 14.7571 23.6401 15.1331 23.2847L18.1478 20.2974C19.4056 19.0532 19.72 18.5542 19.72 17.8022C19.72 16.9204 19.0433 16.2847 18.0931 16.2847C17.2044 16.2847 16.5823 16.7358 16.2337 17.6245C16.056 17.98 15.8509 18.1646 15.4476 18.1646C14.969 18.1646 14.6819 17.8706 14.6819 17.4331C14.6819 17.3032 14.7024 17.1802 14.7366 17.064C15.0032 15.9976 16.1858 14.8696 18.1067 14.8696C20.0823 14.8696 21.4427 16.0386 21.4427 17.6929C21.4427 18.8481 20.889 19.6274 19.2552 21.2271L16.9925 23.4556V23.4897H20.93C21.3948 23.4897 21.6819 23.7769 21.6819 24.2144C21.6819 24.645 21.3948 24.9321 20.93 24.9321H15.4749Z",fill:"#2383E2",fillOpacity:"0.57"}),(0,C.jsx)("path",{d:"M11.6299 25.0688C11.1172 25.0688 10.7617 24.7134 10.7617 24.1802V16.7769H10.7275L9.13477 17.8843C8.96387 18.0073 8.82715 18.0552 8.63574 18.0552C8.2666 18.0552 8 17.7886 8 17.3989C8 17.1255 8.10938 16.9204 8.40332 16.7153L10.4199 15.3003C10.8574 14.9927 11.1309 14.9312 11.5 14.9312C12.1221 14.9312 12.498 15.3071 12.498 15.9155V24.1802C12.498 24.7134 12.1426 25.0688 11.6299 25.0688Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),Sg=(0,v().IU)("collectionFormNumberQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("path",{d:"M26.3063 25.1304C24.5768 25.1304 23.4557 24.4263 22.943 23.4351C22.8131 23.1958 22.7584 22.9702 22.7584 22.7378C22.7584 22.2729 23.0524 21.979 23.5446 21.979C23.9069 21.979 24.1256 22.1362 24.3102 22.4985C24.652 23.2437 25.2467 23.688 26.3268 23.688C27.4479 23.688 28.2067 23.0454 28.2067 22.1499C28.2135 21.0972 27.4479 20.5093 26.1832 20.5093H25.6227C25.1852 20.5093 24.9254 20.2427 24.9254 19.853C24.9254 19.4634 25.1852 19.1968 25.6227 19.1968H26.1422C27.2291 19.1968 27.9537 18.5747 27.9537 17.6997C27.9537 16.8452 27.3932 16.271 26.2994 16.271C25.3698 16.271 24.8297 16.6538 24.5016 17.4263C24.3102 17.8501 24.1188 18.0073 23.7086 18.0073C23.2164 18.0073 22.9567 17.7202 22.9567 17.269C22.9567 17.0229 23.0045 16.8042 23.1276 16.5649C23.5924 15.5874 24.6862 14.8696 26.2926 14.8696C28.3365 14.8696 29.649 15.936 29.649 17.4604C29.649 18.6978 28.7672 19.5249 27.5778 19.771V19.8052C29.0338 19.9419 29.9977 20.8169 29.9977 22.1909C29.9977 23.9409 28.4664 25.1304 26.3063 25.1304Z",fill:"#2383E2"}),(0,C.jsx)("path",{d:"M15.4749 24.9321C14.928 24.9321 14.6409 24.6313 14.6409 24.187C14.6409 23.8452 14.7571 23.6401 15.1331 23.2847L18.1478 20.2974C19.4056 19.0532 19.72 18.5542 19.72 17.8022C19.72 16.9204 19.0433 16.2847 18.0931 16.2847C17.2044 16.2847 16.5823 16.7358 16.2337 17.6245C16.056 17.98 15.8509 18.1646 15.4476 18.1646C14.9691 18.1646 14.6819 17.8706 14.6819 17.4331C14.6819 17.3032 14.7025 17.1802 14.7366 17.064C15.0032 15.9976 16.1859 14.8696 18.1068 14.8696C20.0823 14.8696 21.4427 16.0386 21.4427 17.6929C21.4427 18.8481 20.889 19.6274 19.2552 21.2271L16.9925 23.4556V23.4897H20.93C21.3948 23.4897 21.6819 23.7769 21.6819 24.2144C21.6819 24.645 21.3948 24.9321 20.93 24.9321H15.4749Z",fill:"#2383E2"}),(0,C.jsx)("path",{d:"M11.6299 25.0688C11.1172 25.0688 10.7617 24.7134 10.7617 24.1802V16.7769H10.7275L9.13477 17.8843C8.96387 18.0073 8.82715 18.0552 8.63574 18.0552C8.2666 18.0552 8 17.7886 8 17.3989C8 17.1255 8.10938 16.9204 8.40332 16.7153L10.4199 15.3003C10.8574 14.9927 11.1309 14.9312 11.5 14.9312C12.1221 14.9312 12.498 15.3071 12.498 15.9155V24.1802C12.498 24.7134 12.1426 25.0688 11.6299 25.0688Z",fill:"#2383E2"})]})}),hg=(0,v().IU)("collectionFormPersonQuestionType",{viewBox:"0 0 40 40",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("path",{d:"M11.7881 19.5371C10.4756 19.5371 9.375 18.3682 9.375 16.8916C9.36816 15.4424 10.4824 14.2939 11.7881 14.2939C13.0938 14.2939 14.208 15.4219 14.208 16.8848C14.208 18.3682 13.1006 19.5371 11.7881 19.5371ZM27.6338 19.5371C26.3145 19.5371 25.2139 18.3682 25.2139 16.8848C25.2139 15.4219 26.3281 14.2939 27.6338 14.2939C28.9395 14.2939 30.0537 15.4424 30.0469 16.8916C30.0469 18.3682 28.9463 19.5371 27.6338 19.5371ZM8.04883 25.7646C7.0918 25.7646 6.74316 25.3545 6.74316 24.6367C6.74316 22.8115 8.75293 20.5762 11.7881 20.5762C12.9912 20.5762 13.9756 20.9248 14.7207 21.3965C13.1348 22.6543 12.3828 24.7119 13.1211 25.7646H8.04883ZM31.373 25.7646H26.3008C27.0391 24.7119 26.2871 22.6543 24.7012 21.3965C25.4463 20.9248 26.4307 20.5762 27.6338 20.5762C30.6689 20.5762 32.6787 22.8115 32.6787 24.6367C32.6787 25.3545 32.3301 25.7646 31.373 25.7646Z",fill:"#E3E2E0"}),(0,C.jsx)("path",{d:"M19.7178 19.3867C18.207 19.3867 16.9492 18.0469 16.9424 16.3447C16.9424 14.6836 18.2139 13.3574 19.7178 13.3574C21.2217 13.3574 22.4932 14.6631 22.4932 16.3311C22.4932 18.0469 21.2285 19.3867 19.7178 19.3867ZM15.4795 25.7646C14.3174 25.7646 13.9209 25.4023 13.9209 24.7529C13.9209 22.9961 16.1699 20.5898 19.7178 20.5898C23.2588 20.5898 25.5078 22.9961 25.5078 24.7529C25.5078 25.4023 25.1113 25.7646 23.9492 25.7646H15.4795Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),xg=(0,v().IU)("collectionFormPersonQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("path",{d:"M11.7881 19.5371C10.4756 19.5371 9.375 18.3682 9.375 16.8916C9.36816 15.4424 10.4824 14.2939 11.7881 14.2939C13.0938 14.2939 14.208 15.4219 14.208 16.8848C14.208 18.3682 13.1006 19.5371 11.7881 19.5371ZM27.6338 19.5371C26.3145 19.5371 25.2139 18.3682 25.2139 16.8848C25.2139 15.4219 26.3281 14.2939 27.6338 14.2939C28.9395 14.2939 30.0537 15.4424 30.0469 16.8916C30.0469 18.3682 28.9463 19.5371 27.6338 19.5371ZM8.04883 25.7646C7.0918 25.7646 6.74316 25.3545 6.74316 24.6367C6.74316 22.8115 8.75293 20.5762 11.7881 20.5762C12.9912 20.5762 13.9756 20.9248 14.7207 21.3965C13.1348 22.6543 12.3828 24.7119 13.1211 25.7646H8.04883ZM31.373 25.7646H26.3008C27.0391 24.7119 26.2871 22.6543 24.7012 21.3965C25.4463 20.9248 26.4307 20.5762 27.6338 20.5762C30.6689 20.5762 32.6787 22.8115 32.6787 24.6367C32.6787 25.3545 32.3301 25.7646 31.373 25.7646Z",fill:"white",fillOpacity:"0.283"}),(0,C.jsx)("path",{d:"M19.7178 19.3867C18.207 19.3867 16.9492 18.0469 16.9424 16.3447C16.9424 14.6836 18.2139 13.3574 19.7178 13.3574C21.2217 13.3574 22.4932 14.6631 22.4932 16.3311C22.4932 18.0469 21.2285 19.3867 19.7178 19.3867ZM15.4795 25.7646C14.3174 25.7646 13.9209 25.4023 13.9209 24.7529C13.9209 22.9961 16.1699 20.5898 19.7178 20.5898C23.2588 20.5898 25.5078 22.9961 25.5078 24.7529C25.5078 25.4023 25.1113 25.7646 23.9492 25.7646H15.4795Z",fill:"#2383E2"})]})}),vg=(0,v().IU)("collectionFormPhoneNumberQuestionType",{viewBox:"0 0 40 40",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("path",{fill:"#2383E2",fillOpacity:"0.57",d:"M12.283 23.691C10.415 21.831 9 19.581 9 17.727c0-.82.278-1.564.905-2.165.38-.368.82-.562 1.247-.562.349 0 .672.136.892.446l1.389 1.958c.22.304.323.556.323.788 0 .297-.174.556-.459.853l-.459.472a.327.327 0 00-.096.24c0 .096.038.186.07.258.207.4.795 1.085 1.429 1.718.64.634 1.324 1.222 1.725 1.435a.608.608 0 00.259.071.348.348 0 00.245-.103l.459-.453c.297-.29.562-.458.853-.458.233 0 .491.103.788.31l1.984 1.409c.304.22.427.53.427.852 0 .44-.214.886-.556 1.267-.588.646-1.318.937-2.152.937-1.855 0-4.123-1.441-5.99-3.309z"}),(0,C.jsx)("circle",{cx:"22",cy:"17",r:"2",fill:"#E3E2E0"}),(0,C.jsx)("circle",{cx:"29",cy:"17",r:"2",fill:"#E3E2E0"})]})}),Cg=(0,v().IU)("collectionFormPhoneNumberQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("path",{fill:"#2383E2",d:"M12.283 23.691C10.415 21.831 9 19.581 9 17.727c0-.82.278-1.564.905-2.165.38-.368.82-.562 1.247-.562.349 0 .672.136.892.446l1.389 1.958c.22.304.323.556.323.788 0 .297-.174.556-.459.853l-.459.472a.327.327 0 00-.096.24c0 .096.038.186.07.258.207.4.795 1.085 1.429 1.718.64.634 1.324 1.222 1.725 1.435a.608.608 0 00.259.071.348.348 0 00.245-.103l.459-.453c.297-.29.562-.458.853-.458.233 0 .491.103.788.31l1.984 1.409c.304.22.427.53.427.852 0 .44-.214.886-.556 1.267-.588.646-1.318.937-2.152.937-1.855 0-4.123-1.441-5.99-3.309z"}),(0,C.jsx)("circle",{cx:"22",cy:"17",r:"2",fill:"#fff",fillOpacity:"0.283"}),(0,C.jsx)("circle",{cx:"29",cy:"17",r:"2",fill:"#fff",fillOpacity:"0.283"})]})}),bg=(0,v().IU)("collectionFormRelationQuestionType",{viewBox:"0 0 40 40",svg:(0,C.jsx)("g",{children:(0,C.jsx)("path",{d:"M27.4707 23.5723C27.4707 24.2852 26.9141 24.832 26.2598 24.832C25.6055 24.832 25.0781 24.2754 25.0781 23.5918V19.9102L25.2344 16.2773L23.6719 18.0254L14.6484 27.0391C14.3848 27.3027 14.082 27.4395 13.7598 27.4395C13.1055 27.4395 12.5195 26.834 12.5195 26.1992C12.5195 25.8867 12.666 25.5645 12.9199 25.3105L21.9336 16.2871L23.6816 14.7344L19.9023 14.8711H16.3574C15.6836 14.8711 15.127 14.3438 15.127 13.6992C15.127 13.0449 15.6543 12.498 16.377 12.498H26.1816C26.9531 12.498 27.4609 13.0156 27.4609 13.7773L27.4707 23.5723Z",fill:"#E3E2E0"})})}),wg=(0,v().IU)("collectionFormRelationQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,C.jsx)("g",{children:(0,C.jsx)("path",{d:"M27.4707 23.5723C27.4707 24.2852 26.9141 24.832 26.2598 24.832C25.6055 24.832 25.0781 24.2754 25.0781 23.5918V19.9102L25.1336 18.6198C25.1674 17.8334 24.1964 17.4385 23.6719 18.0254L14.6484 27.0391C14.3848 27.3027 14.082 27.4395 13.7598 27.4395C13.1055 27.4395 12.5195 26.834 12.5195 26.1992C12.5195 25.8867 12.666 25.5645 12.9199 25.3105L21.9336 16.2871C22.5227 15.7638 22.1325 14.7904 21.3451 14.8189L19.9023 14.8711H16.3574C15.6836 14.8711 15.127 14.3438 15.127 13.6992C15.127 13.0449 15.6543 12.498 16.377 12.498H26.1816C26.9531 12.498 27.4609 13.0156 27.4609 13.7773L27.4707 23.5723Z",fill:"white",fillOpacity:"0.283"})})}),jg=(0,v().IU)("collectionFormSelectQuestionType",{viewBox:"0 0 40 40",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("rect",{x:"20",y:"12",width:"13",height:"2",rx:"1",fill:"#E3E2E0"}),(0,C.jsx)("rect",{x:"20",y:"25",width:"13",height:"2",rx:"1",fill:"#E3E2E0"}),(0,C.jsx)("path",{d:"M12.5 18C10.0464 18 8 15.964 8 13.5104C8 11.0464 10.036 9 12.5 9C14.9536 9 17 11.0464 17 13.5104C17 15.964 14.9536 18 12.5 18ZM11.9675 15.9223C12.1972 15.9223 12.3852 15.8179 12.5 15.6299L14.6821 12.2053C14.7761 12.0487 14.8179 11.9234 14.8179 11.7773C14.8179 11.5162 14.5673 11.2865 14.2749 11.2865C14.087 11.2865 13.9304 11.391 13.8051 11.5789L11.9466 14.565L11.1323 13.5313C10.9965 13.3538 10.8503 13.2703 10.652 13.2703C10.3701 13.2703 10.1404 13.5104 10.1404 13.8132C10.1404 13.9803 10.1717 14.1056 10.2761 14.2204L11.4455 15.6299C11.6021 15.8074 11.7483 15.9223 11.9675 15.9223Z",fill:"#2383E2",fillOpacity:"0.57"}),(0,C.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.5 29.5C14.1569 29.5 15.5 28.1569 15.5 26.5C15.5 24.8431 14.1569 23.5 12.5 23.5C10.8431 23.5 9.5 24.8431 9.5 26.5C9.5 28.1569 10.8431 29.5 12.5 29.5ZM12.5 31C14.9853 31 17 28.9853 17 26.5C17 24.0147 14.9853 22 12.5 22C10.0147 22 8 24.0147 8 26.5C8 28.9853 10.0147 31 12.5 31Z",fill:"#E3E2E0"})]})}),_g=(0,v().IU)("collectionFormSelectQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("rect",{x:"20",y:"12",width:"13",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,C.jsx)("rect",{x:"20",y:"25",width:"13",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,C.jsx)("path",{d:"M12.5 18C10.0464 18 8 15.964 8 13.5104C8 11.0464 10.036 9 12.5 9C14.9536 9 17 11.0464 17 13.5104C17 15.964 14.9536 18 12.5 18ZM11.9675 15.9223C12.1972 15.9223 12.3852 15.8179 12.5 15.6299L14.6821 12.2053C14.7761 12.0487 14.8179 11.9234 14.8179 11.7773C14.8179 11.5162 14.5673 11.2865 14.2749 11.2865C14.087 11.2865 13.9304 11.391 13.8051 11.5789L11.9466 14.565L11.1323 13.5313C10.9965 13.3538 10.8503 13.2703 10.652 13.2703C10.3701 13.2703 10.1404 13.5104 10.1404 13.8132C10.1404 13.9803 10.1717 14.1056 10.2761 14.2204L11.4455 15.6299C11.6021 15.8074 11.7483 15.9223 11.9675 15.9223Z",fill:"#2383E2"}),(0,C.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.5 29.5C14.1569 29.5 15.5 28.1569 15.5 26.5C15.5 24.8431 14.1569 23.5 12.5 23.5C10.8431 23.5 9.5 24.8431 9.5 26.5C9.5 28.1569 10.8431 29.5 12.5 29.5ZM12.5 31C14.9853 31 17 28.9853 17 26.5C17 24.0147 14.9853 22 12.5 22C10.0147 22 8 24.0147 8 26.5C8 28.9853 10.0147 31 12.5 31Z",fill:"white",fillOpacity:"0.283"})]})}),Mg=(0,v().IU)("collectionFormTextQuestionType",{viewBox:"0 0 40 40",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("rect",{x:"19.5",y:"11",width:"13",height:"2",rx:"1",fill:"#E3E2E0"}),(0,C.jsx)("rect",{x:"19.5",y:"17",width:"13",height:"2",rx:"1",fill:"#E3E2E0"}),(0,C.jsx)("rect",{x:"7.5",y:"23",width:"25",height:"2",rx:"1",fill:"#E3E2E0"}),(0,C.jsx)("rect",{x:"7.5",y:"29",width:"25",height:"2",rx:"1",fill:"#E3E2E0"}),(0,C.jsx)("path",{d:"M12.0176 19.1406C9.50977 19.1406 7.93945 17.4883 7.93945 14.7754C7.93945 12.0859 9.50977 10.3984 12.0176 10.3984C14.5195 10.3984 16.0898 12.0859 16.0898 14.7754C16.0898 16.2637 15.6152 17.459 14.7422 18.1797L15.2168 18.8711C15.334 19.0527 15.3809 19.1875 15.3809 19.3691C15.3809 19.7559 15.082 20.0312 14.6602 20.0312C14.373 20.0312 14.1855 19.9258 14.0098 19.6562L13.4941 18.9121C13.043 19.0645 12.5508 19.1406 12.0176 19.1406ZM12.0176 17.6816C12.2344 17.6816 12.4336 17.6523 12.6211 17.5996L12.2168 17.0137C12.0996 16.8379 12.0527 16.6855 12.0527 16.5391C12.0527 16.1582 12.334 15.8887 12.7148 15.8887C12.9609 15.8887 13.1309 15.9766 13.2773 16.1816L13.6699 16.7148C14.0625 16.2578 14.2852 15.5898 14.2852 14.7754C14.2852 13 13.4004 11.8574 12.0176 11.8574C10.6289 11.8574 9.74414 13 9.74414 14.7754C9.74414 16.5449 10.6289 17.6816 12.0176 17.6816Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),kg=(0,v().IU)("collectionFormTextQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("rect",{x:"19.5",y:"11",width:"13",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,C.jsx)("rect",{x:"19.5",y:"17",width:"13",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,C.jsx)("rect",{x:"7.5",y:"23",width:"25",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,C.jsx)("rect",{x:"7.5",y:"29",width:"25",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,C.jsx)("path",{d:"M12.0176 19.1406C9.50977 19.1406 7.93945 17.4883 7.93945 14.7754C7.93945 12.0859 9.50977 10.3984 12.0176 10.3984C14.5195 10.3984 16.0898 12.0859 16.0898 14.7754C16.0898 16.2637 15.6152 17.459 14.7422 18.1797L15.2168 18.8711C15.334 19.0527 15.3809 19.1875 15.3809 19.3691C15.3809 19.7559 15.082 20.0312 14.6602 20.0312C14.373 20.0312 14.1855 19.9258 14.0098 19.6562L13.4941 18.9121C13.043 19.0645 12.5508 19.1406 12.0176 19.1406ZM12.0176 17.6816C12.2344 17.6816 12.4336 17.6523 12.6211 17.5996L12.2168 17.0137C12.0996 16.8379 12.0527 16.6855 12.0527 16.5391C12.0527 16.1582 12.334 15.8887 12.7148 15.8887C12.9609 15.8887 13.1309 15.9766 13.2773 16.1816L13.6699 16.7148C14.0625 16.2578 14.2852 15.5898 14.2852 14.7754C14.2852 13 13.4004 11.8574 12.0176 11.8574C10.6289 11.8574 9.74414 13 9.74414 14.7754C9.74414 16.5449 10.6289 17.6816 12.0176 17.6816Z",fill:"#2383E2"})]})}),Pg=(0,v().IU)("collectionFormUrlQuestionType",{viewBox:"0 0 40 40",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("rect",{width:"25",height:"2",x:"7.5",y:"23",fill:"#E3E2E0",rx:"1"}),(0,C.jsx)("rect",{width:"25",height:"2",x:"7.5",y:"29",fill:"#E3E2E0",rx:"1"}),(0,C.jsx)("path",{fill:"#2383E2",fillOpacity:"0.57",d:"M26 21.238c-.498 0-.855-.304-.855-.89v-6.88c0-.573.351-.878.843-.878s.844.305.844.885v.34h.035c.34-.739 1.037-1.196 1.945-1.196 1.594 0 2.573 1.213 2.573 3.24 0 2.022-.973 3.24-2.543 3.24-.914 0-1.617-.445-1.951-1.154h-.035v2.403c0 .586-.352.89-.856.89zm2.238-3.515c.856 0 1.395-.721 1.395-1.864 0-1.136-.54-1.869-1.395-1.869-.838 0-1.388.744-1.388 1.87 0 1.136.55 1.863 1.388 1.863zm-7.152-.328v-3.387h-.328c-.404 0-.662-.246-.662-.645 0-.398.258-.644.662-.644h.328v-.697c0-.551.322-.891.855-.891.534 0 .856.34.856.89v.698h.603c.405 0 .657.252.657.644 0 .393-.252.645-.657.645h-.603v3.006c0 .445.152.633.521.662l.112.012c.422.046.65.222.65.62 0 .505-.492.762-1.213.762h-.058c-1.143 0-1.723-.568-1.723-1.675zm-4.516 0v-3.387h-.328c-.404 0-.662-.246-.662-.645 0-.398.258-.644.662-.644h.328v-.697c0-.551.323-.891.856-.891.533 0 .855.34.855.89v.698h.604c.404 0 .656.252.656.644 0 .393-.252.645-.656.645h-.604v3.006c0 .445.153.633.522.662l.111.012c.422.046.65.222.65.62 0 .505-.492.762-1.212.762h-.059c-1.143 0-1.723-.568-1.723-1.675zm-6.83 1.728c-.498 0-.855-.305-.855-.89v-6.938c0-.55.316-.879.844-.879.527 0 .837.328.837.879v2.543h.036c.333-.791 1.02-1.236 1.974-1.236 1.395 0 2.192.902 2.192 2.355v3.275c0 .586-.352.891-.856.891-.498 0-.855-.305-.855-.89V15.32c0-.808-.399-1.3-1.178-1.3-.809 0-1.283.568-1.283 1.394v2.818c0 .586-.352.891-.856.891z"})]})}),Tg=(0,v().IU)("collectionFormUrlQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,C.jsxs)("g",{children:[(0,C.jsx)("rect",{width:"25",height:"2",x:"7.5",y:"23",fill:"#fff",fillOpacity:"0.283",rx:"1"}),(0,C.jsx)("rect",{width:"25",height:"2",x:"7.5",y:"29",fill:"#fff",fillOpacity:"0.283",rx:"1"}),(0,C.jsx)("path",{fill:"#2383E2",d:"M26 21.238c-.498 0-.855-.304-.855-.89v-6.88c0-.573.351-.878.843-.878s.844.305.844.885v.34h.035c.34-.739 1.037-1.196 1.945-1.196 1.594 0 2.573 1.213 2.573 3.24 0 2.022-.973 3.24-2.543 3.24-.914 0-1.617-.445-1.951-1.154h-.035v2.403c0 .586-.352.89-.856.89zm2.238-3.515c.856 0 1.395-.721 1.395-1.864 0-1.136-.54-1.869-1.395-1.869-.838 0-1.388.744-1.388 1.87 0 1.136.55 1.863 1.388 1.863zm-7.152-.328v-3.387h-.328c-.404 0-.662-.246-.662-.645 0-.398.258-.644.662-.644h.328v-.697c0-.551.322-.891.855-.891.534 0 .856.34.856.89v.698h.603c.405 0 .657.252.657.644 0 .393-.252.645-.657.645h-.603v3.006c0 .445.152.633.521.662l.112.012c.422.046.65.222.65.62 0 .505-.492.762-1.213.762h-.058c-1.143 0-1.723-.568-1.723-1.675zm-4.516 0v-3.387h-.328c-.404 0-.662-.246-.662-.645 0-.398.258-.644.662-.644h.328v-.697c0-.551.323-.891.856-.891.533 0 .855.34.855.89v.698h.604c.404 0 .656.252.656.644 0 .393-.252.645-.656.645h-.604v3.006c0 .445.153.633.522.662l.111.012c.422.046.65.222.65.62 0 .505-.492.762-1.212.762h-.059c-1.143 0-1.723-.568-1.723-1.675zm-6.83 1.728c-.498 0-.855-.305-.855-.89v-6.938c0-.55.316-.879.844-.879.527 0 .837.328.837.879v2.543h.036c.333-.791 1.02-1.236 1.974-1.236 1.395 0 2.192.902 2.192 2.355v3.275c0 .586-.352.891-.856.891-.498 0-.855-.305-.855-.89V15.32c0-.808-.399-1.3-1.178-1.3-.809 0-1.283.568-1.283 1.394v2.818c0 .586-.352.891-.856.891z"})]})});var Ig=()=>o(469753);const Vg={light:{text:Mg,select:jg,title:Mg,multi_select:mg,relation:bg,date:sg,person:hg,file:pg,number:yg,checkbox:lg,email:dg,url:Pg,phone_number:vg},dark:{text:kg,select:_g,title:kg,multi_select:fg,relation:wg,date:cg,person:xg,file:gg,number:Sg,checkbox:ag,email:ug,url:Tg,phone_number:Cg}},Ag=o(726457).S;function Zg(e){const{style:t,propertyType:o}=e,i="dark"===(0,f().Fg)().mode?"dark":"light",l=(0,n.useMemo)((()=>({...t})),[t]);return(0,r().VK)((()=>(0,Ig().s0)(o)?Vg[i][o](l):Ag(l)),[o,i,l])}var Bg=()=>o(491925),Fg=()=>o(247724),Rg=()=>o(99537),Kg=()=>o(204927),Hg=()=>o(72766);function Og(e){const{questionStore:t,name:o}=e,{collectionStore:n}=(0,$a().J9)(),i=(0,r().VK)((()=>{const e=t.getPropertyId();if(!n||!e)return;const o=n.getSchema();return(0,ka().Qm)({schema:o,property:e})}),[n,t]);if(!i)return null;const l=i.type;return(0,C.jsx)(Hg().z,{...e,icon:(0,C.jsx)(Zg,{propertyType:i.type}),name:o,subText:Kn().SO[l],disabled:!1})}var Lg=()=>o(285645);function Dg(e){const{area:t,moduleId:o,parentModuleId:n,parentConditionalGroupId:l,collectionContextStore:a}=e,s=(0,i().Fy)(),c=(0,I().YB)(),{layoutStore:d}=(0,$a().J9)();return(0,r().VK)((()=>(null==d?void 0:d.getFormQuestionsForFormLayout())??[]),[d]).length>=Ig().h0?(0,C.jsx)(B().ZP,{...e,title:c.formatMessage(Ig().tU.questionLimitReachedTitle),children:(0,C.jsx)("div",{style:{padding:16,paddingTop:2,fontSize:12},children:c.formatMessage(Ig().tU.questionLimitReachedSubtitle)})}):(0,C.jsx)(B().ZP,{...e,title:(0,C.jsx)(I()._H,{id:"formQuestionCreateSettings.menuTitle",defaultMessage:"Select type"}),menuScrollerStyle:s.isMobile?void 0:{maxHeight:600},children:(0,C.jsx)(Ng,{area:t,moduleId:o,parentModuleId:n,parentConditionalGroupId:l,collectionContextStore:a})})}const Eg=(0,I().vU)({showMore:{defaultMessage:"Show {numAdditionalProperties} more",id:"formQuestionCreateSettings.showMore"}});function Ng(e){const{area:t,moduleId:o,parentModuleId:l,parentConditionalGroupId:a,collectionContextStore:s}=e,[c,u]=(0,n.useState)(!1),p=function(e){const{area:t,collectionContextStore:o,moduleId:n,parentModuleId:l,parentConditionalGroupId:a}=e,s=(0,i().O7)(),{layoutStore:c,collectionStore:d}=(0,$a().J9)(),u=(0,r().VK)((()=>{var e;return Boolean(null===(e=o.collectionViewStore())||void 0===e||null===(e=e.getFormBlockStore())||void 0===e?void 0:e.hasPublicPermission())}),[o]),p=Ug({area:t,moduleId:n,parentModuleId:l,parentConditionalGroupId:a,collectionContextStore:o}),g=(0,Bg().nI)({layoutStore:c,collectionStore:d});return(0,r().VK)((()=>{if(!d)return[];const e=d.getSchema(),t=g.map((t=>{const o=(0,ka().Qm)({schema:e,property:t});if(!o)return;const n=(0,Ig().Hz)({environment:s,propertyType:o.type,propertySchema:o,isPublicForm:u});let i=null;return"invalid_property_type_for_public_form"===n?i=(0,C.jsx)(I()._H,{...Bg().hW.unsupportedPublicQuestionType}):"related_collection_not_public"===n&&(i=(0,C.jsx)(I()._H,{...Bg().hW.relatedCollectionNotPublic})),{key:t,keywords:[o.name],render:e=>{let{ref:o,...r}=e;return(0,C.jsx)("div",{style:{width:"100%"},children:(0,C.jsx)(Kg().R,{...r,propertyId:t,tooltip:i,disabled:Boolean(n)})})},action:()=>{p({type:"existingProperty",propertyId:t})}}})).filter(N().$K);return t}),[d,g,s,u,p])}({area:t,collectionContextStore:s,moduleId:o,parentModuleId:l,parentConditionalGroupId:a}),g=function(e){const{area:t,moduleId:o,parentModuleId:n,parentConditionalGroupId:l,collectionContextStore:a}=e,s=(0,i().O7)(),c=(0,r().VK)((()=>{var e;return Boolean(null===(e=a.collectionViewStore())||void 0===e||null===(e=e.getFormBlockStore())||void 0===e?void 0:e.hasPublicPermission())}),[a]),d=Ug({area:t,moduleId:o,parentModuleId:n,parentConditionalGroupId:l,collectionContextStore:a}),u=(0,Lg().c)({actionHandler:e=>d({type:"newProperty",propertyType:(0,go().TN)(e)}),renderIcon:e=>(0,C.jsx)(Zg,{propertyType:(0,go().TN)(e)}),tooltip:e=>{if("invalid_property_type_for_public_form"===(0,Ig().Hz)({environment:s,propertyType:(0,go().TN)(e),isPublicForm:c}))return{image:void 0,caption:Bg().hW.unsupportedPublicQuestionType}},disabled:e=>{const t=(0,Ig().Hz)({environment:s,propertyType:(0,go().TN)(e),isPublicForm:c});return Boolean(t)}});return(0,r().VK)((()=>Ig().MW.filter((e=>"select"!==e)).map((e=>{if("relation"!==e&&(0,Ig().s0)(e))return"title"!==e?u(e):void 0})).filter(N().$K)),[u])}({area:t,moduleId:o,parentModuleId:l,parentConditionalGroupId:a,collectionContextStore:s}),m=function(e,t,o){const l=(0,i().O7)(),{layoutStore:a,collectionStore:s,setModuleSelection:c,sessionId:u}=(0,$a().J9)(),p=(0,r().VK)((()=>a.getModules()),[a]),g=(0,r().VK)((()=>(0,tg().i)(p).filter((e=>"formQuestion"===e.type))),[p]),m=(0,r().VK)((()=>{const t=[];let n=o??e;for(;void 0!==n;){const e=(0,eg().h7)(p,(e=>e.id===n));if(!e||!(0,og().B)(e.module,"form_conditional_modules"))break;t.push(n),n=e.module.parentModuleId??void 0}return t}),[p,e,o]),f=(0,n.useCallback)((o=>{void 0!==t&&void 0!==e&&(d().createAndCommit({userAction:"FormQuestionCreateSettings.moveExistingQuestion",canUndo:!0,environment:l,perform:n=>{(0,Rg().ST)({position:{type:"absolute",area:"form_conditional_modules",parentConditionalGroupId:t,parentModuleId:e},moduleId:o.id,environment:l,layoutStore:a,transaction:n,sessionId:u})}}),c({type:"existing_module",moduleId:o.id,isDragging:!1}))}),[l,t,e,a,c,u]);return(0,r().VK)((()=>{if(!s)return[];const e=g.map((e=>{const o=void 0===e.parentConditionalGroupId;if((e.parentConditionalGroupId!==t||o)&&!m.includes(e.id)){const t=W().cq.createChildStore(a,{table:"form_question",id:e.formQuestionId,spaceId:a.getSpaceId()??""});if(void 0===t)return;const o=(0,ng().Xh)({textValue:t.getNameStore().getValue(),getRecordModel:t.getRecordModel,deterministic:!0,userTimeZone:(0,cu().r)(),intl:Co().Z.getIntl()});return{key:t.id,keywords:[o],render:e=>{let{ref:n,...i}=e;return(0,C.jsx)("div",{style:{width:"100%"},children:(0,C.jsx)(Og,{...i,name:o,questionStore:t})})},action:()=>{f(e)}}}})).filter(N().$K);return e}),[s,f,m,t,g,a])}(l,a,o),y=(0,f().yK)((e=>({showMoreIcon:{width:16,height:16,marginLeft:4,marginRight:4,fill:e.lightIconColor},showMoreButton:{height:42,color:e.lightTextColor,marginLeft:0}})),[]),S=function(e){const{key:t,title:o,items:n,limit:i}=e,r={key:"show-more",keywords:[],action:()=>{},render:e=>(0,C.jsx)(q().Z,{...e,id:Fg().hIF,icon:(0,gi().o)({...y.showMoreIcon}),title:Co().Z.formatMessage(Eg.showMore,{numAdditionalProperties:i?n.length-i:n.length}),desktopIconStyle:{marginLeft:7,marginRight:5},style:y.showMoreButton,onClick:e=>{u(!0),e.stopPropagation()}})},l=void 0!==i&&n.length>i,a=[...l?n.slice(0,i):n,...l?[r]:[]];return{key:t,render:e=>(0,C.jsx)(ee().Z,{title:o,...e,style:{display:"flex",flexDirection:"column",alignItems:"center",paddingLeft:"8px",paddingRight:"8px",paddingTop:"new-properties"===t&&p.length>0?8:0,paddingBottom:0},desktopTitleStyle:{alignSelf:"flex-start",paddingLeft:"8px"}}),items:a}},h=c?void 0:5,x=S({key:"existing-properties",title:(0,C.jsx)(I()._H,{id:"formQuestionCreateSettings.existingPropertiesSectionTitle",defaultMessage:"Existing properties"}),items:p,limit:h}),v=S({key:"new-properties",title:p.length>0||m.length>0?(0,C.jsx)(I()._H,{id:"formQuestionCreateSettings.newPropertiesSectionTitle",defaultMessage:"New question"}):void 0,items:g}),b=S({key:"existing-questions",title:m.length>0?(0,C.jsx)(I()._H,{id:"formQuestionCreateSettings.existingQuestionsSectionTitle",defaultMessage:"Existing questions"}):void 0,items:m});return(0,C.jsx)(ee().Z,{children:(0,C.jsx)(Q().ZP,{initialFocus:0,type:Q().iW.Vertical,sections:[...m.length>0&&void 0!==l&&void 0!==a?[b]:[],...p.length>0?[x]:[],...g.length>0?[v]:[]]})})}function Ug(e){const{area:t,moduleId:o,parentModuleId:r,parentConditionalGroupId:l,collectionContextStore:a}=e,s=(0,i().O7)(),{layoutStore:c,collectionStore:u,setModuleSelection:p,sessionId:g}=(0,$a().J9)(),{autofocusedQuestionTextStore:m}=(0,rg().Y)();return(0,n.useCallback)((e=>{d().createAndCommit({userAction:"FormQuestionCreateSettings.createFormQuestion",environment:s,canUndo:!0,undoCheckpoint:`form_layout_new_question_${o}`,perform:n=>{if(!u)throw new Error("Collection store not found");const i=(()=>{if("existingProperty"===e.type)return e.propertyId;const t=e.propertyType;return at().G3({environment:s,collectionStore:u,collectionViewArgs:void 0,propertyName:Kn().SO[t],propertyType:t,transaction:n})})();if(!("form_conditional_modules"!==t||r&&l))throw new Error("Parent module ID and parent conditional group ID are required for nested modules");const{updatedModuleId:d}=(0,ig().createFormQuestionAndUpdateOrCreateModule)({environment:s,transaction:n,layoutStore:c,moduleId:o,propertyId:i,initialQuestionTitle:(()=>{if("existingProperty"===e.type){const e=u.getSchema()[i];return e?e.name:""}{const t=e.propertyType;if((0,Ig().s0)(t)&&"select"!==t)return Ig().Cu[t]}})()??"",shouldSyncQuestionNameToPropertyName:"newProperty"===e.type,collectionContextStore:a,autofocusTitle:{shouldAutofocus:!0,autofocusedQuestionTextStore:m},sessionId:g,..."form_conditional_modules"===t&&r&&l?{area:t,parentModuleId:r,parentConditionalGroupId:l}:{area:"form_layout_schema"}});p({type:"existing_module",moduleId:d,isDragging:!1})}})}),[s,g,u,c,o,a,m,t,r,l,p])}const zg=function(e){return(0,C.jsx)(Fp().O,{children:(0,C.jsx)(Dg,{...e})})};var Wg=()=>o(765973);const qg=(0,v().IU)("asterisk",{viewBox:"0 0 12 13",svg:(0,C.jsx)("path",{d:"M5.95312 12.6172C5.15625 12.6172 4.89258 12.3945 4.89258 11.627V8.67383L2.34375 10.1445C2.0918 10.291 1.89258 10.3613 1.7168 10.3613C1.41797 10.3613 1.20117 10.1621 0.949219 9.72852L0.914062 9.6582C0.75 9.38281 0.667969 9.16016 0.667969 8.97266C0.667969 8.69141 0.849609 8.48047 1.24805 8.24609L3.80273 6.76953L1.24219 5.29883C0.84375 5.07031 0.662109 4.85352 0.662109 4.57812C0.662109 4.38477 0.744141 4.16211 0.914062 3.875L0.949219 3.81641C1.20703 3.38281 1.41797 3.17188 1.7168 3.17188C1.89258 3.17188 2.0918 3.24805 2.33789 3.38867L4.89258 4.87109V1.91797C4.89258 1.15039 5.15625 0.927734 5.95312 0.927734H6.0293C6.83203 0.927734 7.08984 1.15039 7.08984 1.91797V4.87109L9.65625 3.38867C9.90234 3.24805 10.1016 3.17188 10.2715 3.17188C10.5703 3.17188 10.7871 3.38281 11.0449 3.81641L11.0801 3.875C11.2441 4.16211 11.3262 4.38477 11.3262 4.57812C11.3262 4.85352 11.1504 5.07031 10.752 5.29883L8.19141 6.76953L10.7461 8.24609C11.1387 8.48047 11.3262 8.69141 11.3262 8.97266C11.3262 9.16016 11.2441 9.38281 11.0801 9.6582L11.0449 9.72852C10.7871 10.1621 10.5703 10.3613 10.2773 10.3613C10.1016 10.3613 9.90234 10.291 9.64453 10.1445L7.08984 8.67383V11.627C7.08984 12.3945 6.83203 12.6172 6.0293 12.6172H5.95312Z"})}),Gg=(0,v().IU)("collectionFormAddDescription",{viewBox:"0 0 16 16",svg:(0,C.jsx)("path",{d:"M7.58203 9.83472C7.72266 9.83472 7.84375 9.88354 7.94531 9.9812C8.04297 10.0828 8.0918 10.2058 8.0918 10.3503C8.0918 10.491 8.04297 10.6121 7.94531 10.7136C7.84375 10.8152 7.72266 10.866 7.58203 10.866L1.43945 10.866C1.29492 10.866 1.17188 10.8152 1.07031 10.7136C0.96875 10.6121 0.917969 10.491 0.917969 10.3503C0.917969 10.2058 0.96875 10.0828 1.07031 9.9812C1.17188 9.88354 1.29492 9.83472 1.43945 9.83472L7.58203 9.83472ZM8.58203 6.7644C8.72266 6.7644 8.84375 6.81323 8.94531 6.91089C9.04297 7.01245 9.0918 7.1355 9.0918 7.28003C9.0918 7.42456 9.04297 7.54565 8.94531 7.64331C8.84375 7.74487 8.72266 7.79565 8.58203 7.79565L1.43945 7.79565C1.29492 7.79565 1.17188 7.74487 1.07031 7.64331C0.968751 7.54565 0.917969 7.42456 0.917969 7.28003C0.917969 7.1355 0.968751 7.01245 1.07031 6.91089C1.17188 6.81323 1.29492 6.7644 1.43945 6.7644L8.58203 6.7644ZM12.4902 3.62964C12.6348 3.62964 12.7578 3.67847 12.8594 3.77612C12.957 3.87378 13.0059 3.99487 13.0059 4.1394C13.0059 4.28784 12.957 4.41089 12.8594 4.50854C12.7578 4.61011 12.6348 4.66089 12.4902 4.66089L1.43945 4.66089C1.29492 4.66089 1.17188 4.61011 1.07031 4.50854C0.968751 4.41089 0.91797 4.28784 0.91797 4.1394C0.91797 3.99487 0.968751 3.87378 1.07031 3.77612C1.17188 3.67847 1.29492 3.62964 1.43945 3.62964L12.4902 3.62964ZM12.9824 7.74487C13.3965 7.74487 13.7852 7.823 14.1484 7.97925C14.5117 8.1355 14.832 8.35229 15.1094 8.62964C15.3867 8.91089 15.6055 9.23315 15.7656 9.59644C15.9219 9.95972 16 10.3484 16 10.7625C16 11.1765 15.9219 11.5652 15.7656 11.9285C15.6055 12.2917 15.3867 12.6121 15.1094 12.8894C14.832 13.1707 14.5117 13.3894 14.1484 13.5457C13.7852 13.7019 13.3965 13.78 12.9824 13.78C12.5684 13.78 12.1797 13.7019 11.8164 13.5457C11.4531 13.3894 11.1328 13.1726 10.8555 12.8953C10.5781 12.6179 10.3613 12.2957 10.2051 11.9285C10.0449 11.5652 9.96484 11.1765 9.96484 10.7625C9.96484 10.3523 10.0449 9.96362 10.2051 9.59644C10.3613 9.23315 10.5801 8.91284 10.8613 8.6355C11.1387 8.35815 11.4609 8.1394 11.8281 7.97925C12.1914 7.823 12.5762 7.74487 12.9824 7.74487ZM12.9824 8.85229C12.8613 8.85229 12.7656 8.8894 12.6953 8.96362C12.6211 9.03784 12.584 9.13354 12.584 9.25073L12.584 10.364L11.4707 10.364C11.3535 10.364 11.2578 10.3992 11.1836 10.4695C11.1094 10.5437 11.0723 10.6414 11.0723 10.7625C11.0723 10.8835 11.1094 10.9792 11.1836 11.0496C11.2578 11.1238 11.3535 11.1609 11.4707 11.1609L12.584 11.1609L12.584 12.2742C12.584 12.3914 12.6211 12.4871 12.6953 12.5613C12.7656 12.6355 12.8613 12.6726 12.9824 12.6726C13.1035 12.6726 13.2012 12.6355 13.2754 12.5613C13.3457 12.4871 13.3809 12.3914 13.3809 12.2742L13.3809 11.1609L14.4941 11.1609C14.6113 11.1609 14.707 11.1238 14.7813 11.0496C14.8555 10.9792 14.8926 10.8835 14.8926 10.7625C14.8926 10.6414 14.8555 10.5437 14.7813 10.4695C14.707 10.3992 14.6113 10.364 14.4941 10.364L13.3809 10.364L13.3809 9.25073C13.3809 9.13354 13.3457 9.03784 13.2754 8.96362C13.2012 8.8894 13.1035 8.85229 12.9824 8.85229Z"})}),Yg=(0,v().IU)("collectionFormQuestionType",{viewBox:"0 0 14 14",svg:(0,C.jsx)("path",{d:"M3.25391 6.53809C1.59961 6.53809 0.25293 5.18457 0.25293 3.53711C0.25293 1.90332 1.59961 0.549805 3.25391 0.549805C4.90137 0.549805 6.24805 1.90332 6.24805 3.53711C6.24805 5.18457 4.90137 6.53809 3.25391 6.53809ZM10.7461 6.53809C9.08496 6.53809 7.74512 5.18457 7.74512 3.53711C7.74512 1.90332 9.08496 0.549805 10.7461 0.549805C12.3867 0.549805 13.7402 1.90332 13.7402 3.53711C13.7402 5.18457 12.3867 6.53809 10.7461 6.53809ZM3.25391 5.29395C4.23145 5.29395 5.00391 4.52832 5.00391 3.54395C5.00391 2.56641 4.23145 1.77344 3.25391 1.77344C2.2627 1.77344 1.49707 2.56641 1.49707 3.54395C1.49707 4.52832 2.2627 5.29395 3.25391 5.29395ZM10.7461 5.29395C11.7236 5.29395 12.4961 4.52832 12.4961 3.54395C12.4961 2.56641 11.7236 1.77344 10.7461 1.77344C9.75488 1.77344 8.98242 2.56641 8.98242 3.54395C8.98242 4.52832 9.75488 5.29395 10.7461 5.29395ZM3.25391 13.5791C1.59961 13.5791 0.25293 12.2256 0.25293 10.5781C0.25293 8.94434 1.59961 7.58398 3.25391 7.58398C4.90137 7.58398 6.24805 8.94434 6.24805 10.5781C6.24805 12.2256 4.90137 13.5791 3.25391 13.5791ZM10.7461 13.5791C9.08496 13.5791 7.74512 12.2256 7.74512 10.5781C7.74512 8.94434 9.08496 7.58398 10.7461 7.58398C12.3867 7.58398 13.7402 8.94434 13.7402 10.5781C13.7402 12.2256 12.3867 13.5791 10.7461 13.5791ZM3.25391 12.3281C4.23145 12.3281 5.00391 11.5625 5.00391 10.5781C5.00391 9.60059 4.23145 8.80762 3.25391 8.80762C2.2627 8.80762 1.49707 9.60059 1.49707 10.5781C1.49707 11.5625 2.2627 12.3281 3.25391 12.3281ZM10.7461 12.3281C11.7236 12.3281 12.4961 11.5625 12.4961 10.5781C12.4961 9.60059 11.7236 8.80762 10.7461 8.80762C9.75488 8.80762 8.98242 9.60059 8.98242 10.5781C8.98242 11.5625 9.75488 12.3281 10.7461 12.3281Z"})});var $g=()=>o(466222),Qg=()=>o(336533);const Jg=(0,v().IU)("formQuestionSyncPropertyName",{viewBox:"0 0 16 16",svg:(0,C.jsx)("path",{d:"M4.16455 15.1821C3.76676 15.1821 3.40495 15.0848 3.0791 14.8901C2.75326 14.6955 2.493 14.4331 2.29834 14.103C2.10368 13.7772 2.00635 13.4154 2.00635 13.0176C2.00635 12.624 2.10368 12.2643 2.29834 11.9385C2.493 11.6084 2.75326 11.3481 3.0791 11.1577C3.40495 10.9631 3.76676 10.8657 4.16455 10.8657C4.56234 10.8657 4.92415 10.9631 5.25 11.1577C5.57585 11.3481 5.8361 11.6084 6.03076 11.9385C6.22542 12.2643 6.32275 12.624 6.32275 13.0176C6.32275 13.4154 6.22542 13.7772 6.03076 14.103C5.8361 14.4331 5.57585 14.6955 5.25 14.8901C4.92415 15.0848 4.56234 15.1821 4.16455 15.1821ZM11.4834 5.13379C11.0856 5.13379 10.7238 5.03646 10.3979 4.8418C10.0721 4.64714 9.81185 4.38688 9.61719 4.06104C9.42253 3.73096 9.3252 3.36702 9.3252 2.96924C9.3252 2.57145 9.42253 2.20964 9.61719 1.88379C9.81185 1.55794 10.0721 1.2998 10.3979 1.10938C10.7238 0.914714 11.0856 0.817383 11.4834 0.817383C11.8812 0.817383 12.243 0.914714 12.5688 1.10938C12.8989 1.2998 13.1613 1.55794 13.356 1.88379C13.5506 2.20964 13.6479 2.57145 13.6479 2.96924C13.6479 3.36702 13.5506 3.73096 13.356 4.06104C13.1613 4.38688 12.8989 4.64714 12.5688 4.8418C12.243 5.03646 11.8812 5.13379 11.4834 5.13379ZM11.4834 3.96582C11.7669 3.96582 12.0039 3.87061 12.1943 3.68018C12.3848 3.48551 12.48 3.24854 12.48 2.96924C12.48 2.68994 12.3826 2.45719 12.188 2.271C11.9976 2.08057 11.7627 1.98535 11.4834 1.98535C11.2083 1.98535 10.9735 2.08057 10.7788 2.271C10.5884 2.45719 10.4932 2.68994 10.4932 2.96924C10.4932 3.24854 10.5884 3.48551 10.7788 3.68018C10.9735 3.87061 11.2083 3.96582 11.4834 3.96582ZM5.89746 8.47266C4.61523 8.3457 3.64404 7.9987 2.98389 7.43164C2.32796 6.86035 2 6.11979 2 5.20996C2 4.61751 2.14388 4.10335 2.43164 3.66748C2.7194 3.23161 3.12354 2.89518 3.64404 2.6582C4.16878 2.42122 4.78874 2.30273 5.50391 2.30273H9.76953V3.55322H5.50391C4.7972 3.55322 4.24495 3.70133 3.84717 3.99756C3.44938 4.29378 3.25049 4.69792 3.25049 5.20996C3.25049 5.73047 3.48324 6.15788 3.94873 6.49219C4.41423 6.8265 5.12728 7.04443 6.08789 7.146L9.73779 7.52686C11.0243 7.65381 11.9976 8.00293 12.6577 8.57422C13.3179 9.14128 13.6479 9.87972 13.6479 10.7896C13.6479 11.382 13.5041 11.8962 13.2163 12.332C12.9285 12.7679 12.5202 13.1043 11.9912 13.3413C11.4665 13.5783 10.8486 13.6968 10.1377 13.6968H5.87842V12.4463H10.1377C10.8444 12.4463 11.3966 12.2982 11.7944 12.002C12.1965 11.7057 12.3975 11.3016 12.3975 10.7896C12.3975 10.269 12.1647 9.84163 11.6992 9.50732C11.2337 9.17301 10.5207 8.95508 9.56006 8.85352L5.89746 8.47266Z"})});var Xg=()=>o(121183),em=()=>o(922646),tm=()=>o(87849);function om(e){const{environment:t,questionStore:o,autofocusedQuestionTextStore:n,currValue:i}=e;d().createAndCommit({userAction:"formQuestion.toggleShowDescription",environment:t,canUndo:!0,perform:e=>{const t=!i;d().applyOperation({store:o,operation:{pointer:o.pointer,path:["config","showDescription"],command:"set",args:t},transaction:e}),t||function(e){var t;const{questionStore:o,autofocusedQuestionTextStore:n,transaction:i}=e;void 0===(null===(t=o.getConfig())||void 0===t?void 0:t.description)&&d().applyOperation({store:o,operation:{pointer:o.pointer,path:["config","description"],command:"set",args:(0,D().TPx)("")},transaction:i});n.autofocusQuestionDescription({questionId:o.id})}({questionStore:o,autofocusedQuestionTextStore:n,transaction:e})}})}var nm=()=>o(801670),im=()=>o(579012),rm=()=>o(227199);function lm(e){let{children:t}=e;return(0,C.jsx)(ro().Z,{renderTooltip:()=>(0,C.jsx)(I()._H,{id:"FormSettingsNameSyncTooltip.tooltip",defaultMessage:"Renaming a question also renames its linked database property. Disable to keep names separate."}),placement:ao().Placement.Left,alignment:ao().Alignment.Center,textWrap:!0,render:e=>(0,C.jsx)("div",{...e,children:t})})}function am(e){let{tooltipState:t,disableTooltip:o,children:i}=e;const r=(0,n.useMemo)((()=>{if(!t)return null;switch(t){case"deleted_property":return(0,C.jsx)(I()._H,{id:"FormSettingsComingSoonTooltip.deletedProperty",defaultMessage:"The linked property has been deleted."});case"invalid_property_type":return(0,C.jsx)(I()._H,{id:"FormSettingsComingSoonTooltip.invalidProperty",defaultMessage:"The linked property is an unsupported type."});case"invalid_property_type_for_public_form":return(0,C.jsx)(I()._H,{...Bg().hW.unsupportedPublicQuestionType});case"related_collection_not_public":return(0,C.jsx)(I()._H,{...Bg().hW.relatedCollectionNotPublic});case"generic_error":return(0,C.jsx)(I()._H,{id:"FormSettingsErrorTooltip.genericError",defaultMessage:"There is an issue with this linked property."});default:(0,N().t1)(t)}}),[t]);return(0,C.jsx)(ro().Z,{renderTooltip:()=>r,disableTooltip:o,placement:ao().Placement.Left,render:e=>(0,C.jsx)("div",{...e,children:i})})}function sm(e){const{collectionContextStore:t,collectionSettingsStore:o,formQuestionId:n,moduleId:l}=e,a=(0,i().O7)(),{collectionViewStore:s,formBlockStore:c}=(0,r().VK)((()=>{var e;return{collectionViewStore:t.collectionViewStore(),formBlockStore:null===(e=t.collectionViewStore())||void 0===e?void 0:e.getFormBlockStore()}}),[t]),d=(0,r().VK)((()=>{if(!s)throw new Error("no collectionViewStore found");const e=s.getSpaceId();if(!e)throw new Error("no spaceId found");return rm().c.createChildStore(s,{table:"form_question",id:n,spaceId:e})}),[s,n]),u=(0,r().VK)((()=>{var e;return null===(e=d.getConfig())||void 0===e?void 0:e.propertyId}),[d]),p=(0,r().VK)((()=>{if(!u)return;return t.normalizedSchemaStore.state[u]}),[t.normalizedSchemaStore,u]),g=(0,r().VK)((()=>{const e=t.normalizedSchemaStore.state;return d?d.getQuestionErrorState(a,e,null==c?void 0:c.hasPublicPermission()):"generic_error"}),[t.normalizedSchemaStore,a,c,d]),m=(0,r().VK)((()=>{if(p)return p.type}),[p]);return u?(0,C.jsx)(Fp().O,{children:(0,C.jsxs)(B().ZP,{...e,title:(0,C.jsx)(I()._H,{id:"formQuestionEditSettings.menuTitle",defaultMessage:"Question options"}),footer:(0,C.jsx)("div",{style:{marginBottom:4}}),children:[(0,C.jsxs)(ee().Z,{children:[(0,C.jsx)(um,{collectionContextStore:t,formQuestionStore:d}),(0,C.jsx)(xm,{collectionContextStore:t,formQuestionStore:d}),(0,C.jsx)(dm,{collectionContextStore:t,propertySchema:p,formQuestionStore:d})]}),(0,C.jsxs)(ee().Z,{topBorder:!0,children:[(0,C.jsx)(cm,{collectionSettingsStore:o,collectionContextStore:t,formQuestionStore:d,propertyId:u,propertyType:m,questionErrorState:g}),(0,C.jsx)(Sm,{collectionSettingsStore:o,collectionContextStore:t,formQuestionStore:d,questionErrorState:g}),(0,C.jsx)(pm,{collectionContextStore:t,formQuestionStore:d})]}),(0,C.jsxs)(ee().Z,{topBorder:!0,children:[(0,C.jsx)(vm,{moduleId:l}),(0,C.jsx)(Cm,{collectionSettingsStore:o,collectionContextStore:t,moduleId:l,propertyId:u,propertySchema:p,formQuestionStore:d}),(0,C.jsx)(hm,{collectionSettingsStore:o,collectionContextStore:t,moduleId:l,formQuestionStore:d})]})]})}):null}function cm(e){let{collectionSettingsStore:t,collectionContextStore:o,formQuestionStore:n,propertyId:l,propertyType:a,questionErrorState:s}=e;const c=(0,i().O7)(),{layoutStore:u}=(0,$a().J9)(),{isCollectionEmpty:p}=(0,rg().Y)(),{collectionStore:g,collectionSchema:m,collectionViewStore:y,formatKey:S}=(0,r().VK)((()=>({collectionStore:o.collectionStore(),collectionSchema:o.normalizedSchemaStore.state,collectionViewStore:o.collectionViewStore(),formatKey:o.getPropertyFormatKey()})),[o]),h=(0,r().VK)((()=>a&&(0,Ig().s0)(a)?"select"===a?"multi_select":a:"not_found"),[a]),x=(0,r().VK)((()=>s?id().t:Yg),[s]),v=(0,f().yK)((e=>({iconContainer:{background:"light"===e.mode?e.white:e.accentColors.translucentGray[100],borderWidth:1,borderStyle:"solid",borderColor:"light"===e.mode?e.accentColors.gray[100]:e.accentColors.translucentGray[300],minWidth:32,width:32,height:32,borderRadius:4,overflow:"hidden"}})),[]),b=(0,Bg().nI)({layoutStore:u,collectionStore:g}),w=(0,r().VK)((()=>{const e=[];return Ig().MW.forEach((t=>{"select"!==t&&e.push({key:t,type:"button",title:Ig().Cu[t],hideOption:"title"===t&&!b.includes(go().iw)||"relation"===t,icon:(0,C.jsx)("div",{style:v.iconContainer,children:(0,C.jsx)(Zg,{propertyType:t})})})})),e.push({key:"not_found",type:"button",hideOption:!0,title:(0,C.jsx)(I()._H,{id:"formQuestionEditSettings.questionType.propertyNotFound",defaultMessage:"Not Found"})}),e}),[v.iconContainer,b]),j=(0,r().VK)((()=>null==g?void 0:g.getDatabaseType()),[g]);return g?(0,C.jsx)(am,{tooltipState:s,disableTooltip:void 0===s,children:(0,C.jsx)(vt().Z,{icon:x,options:w,disabled:"not_found"===h||void 0!==j,title:(0,C.jsx)(I()._H,{defaultMessage:"Question type",id:"formQuestionEditSettings.questionType.menuTitle"}),selectedKey:h,menuItemOptionsStyle:{paddingTop:4,paddingBottom:4},onChange:e=>{"not_found"!==e&&(Wt().$q({environment:c,collectionContextStore:o,property:l,new_property_type:e,from:"form_editor",action:"change_type"}),d().createAndCommit({userAction:"CollectionSettingsProperty.handlePropertyTypeAccept",environment:c,canUndo:!0,perform:t=>{if(a===go().iw){const o=at().G3({environment:c,collectionStore:g,propertyType:e,transaction:t,collectionViewArgs:y&&S?{collectionViewStore:y,format:y.getFormat(),formatKey:S}:void 0});Zn().sO({store:n.getConfigStore().getKeyStore("propertyId"),value:o,transaction:t})}else e===go().iw?(Zn().sO({store:n.getConfigStore().getKeyStore("propertyId"),value:go().iw,transaction:t}),p&&(at().E2({environment:c,collectionStore:g,schema:m,property:l,transaction:t}),t.postSubmitCallbacks.push((e=>{e||nm().formEditorActions.maybeSyncQuestionNameToPropertyName({environment:c,questionStore:n,collectionStore:g,collectionContextStore:o})})))):at().LC({environment:c,collectionStore:g,property:l,type:e,transaction:t})}}))}})}):null}function dm(e){const{propertySchema:t,formQuestionStore:o,collectionContextStore:n}=e,i=(0,r().VK)((()=>{const e=null==t?void 0:t.type;if(e&&!(0,Ig().s0)(e)||!e)return null;switch(e){case"title":case"text":return(0,C.jsx)(ym,{formQuestionStore:o,propertyType:e,collectionContextStore:n});case"multi_select":case"relation":case"person":return(0,C.jsx)(fm,{formQuestionStore:o,propertySchema:t,collectionContextStore:n});case"date":return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(gm,{formQuestionStore:o,collectionContextStore:n}),(0,C.jsx)(mm,{formQuestionStore:o,collectionContextStore:n})]});case"select":case"file":case"number":case"checkbox":case"email":case"url":case"phone_number":return(0,C.jsx)(C.Fragment,{});default:(0,N().t1)(e)}}),[n,o,t]);return(0,C.jsx)(C.Fragment,{children:i})}function um(e){let{collectionContextStore:t,formQuestionStore:o}=e;const l=(0,r().VK)((()=>o.isRequired()),[o]),a=(0,i().O7)(),s=(0,n.useCallback)((()=>{!function(e){const{questionStore:t,environment:o,currValue:n}=e;d().createAndCommit({userAction:"formQuestion.toggleRequired",environment:o,canUndo:!0,perform:e=>{d().applyOperation({store:t,operation:{pointer:t.pointer,path:["config","required"],command:"set",args:!n},transaction:e})}})}({environment:a,questionStore:o,currValue:o.isRequired()})}),[a,o]),c=bm({collectionContextStore:t,formQuestionStore:o});return(0,C.jsx)(yc().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"Required",id:"formQuestionEditSettings.isRequired.title"}),switcherProps:{on:l},iconStyle:{height:12},icon:qg,onClick:s,disabled:c})}function pm(e){let{collectionContextStore:t,formQuestionStore:o}=e;const l=(0,r().VK)((()=>o.shouldSyncQuestionNameToPropertyName()),[o]),a=(0,i().O7)(),s=(0,n.useCallback)((()=>{!function(e){const{questionStore:t,environment:o,currValue:n}=e;d().createAndCommit({userAction:"formQuestion.toggleShouldSyncQuestionNameToPropertyName",environment:o,canUndo:!0,perform:e=>{d().applyOperation({store:t,operation:{pointer:t.pointer,path:["config","shouldSyncQuestionNameToPropertyName"],command:"set",args:!n},transaction:e})}})}({environment:a,questionStore:o,currValue:o.shouldSyncQuestionNameToPropertyName()})}),[a,o]),c=bm({collectionContextStore:t,formQuestionStore:o});return(0,C.jsx)(lm,{children:(0,C.jsx)(yc().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"Sync with property name",id:"formQuestionEditSettings.shouldSyncQuestionNameToPropertyName.title"}),switcherProps:{on:l},icon:Jg,onClick:s,disabled:c})})}function gm(e){let{collectionContextStore:t,formQuestionStore:o}=e;const l=(0,i().O7)(),a=(0,r().VK)((()=>{var e;return(null===(e=o.getPropertyTypeSpecificConfig("date"))||void 0===e?void 0:e.endDate)??!1}),[o]),s=(0,n.useCallback)((()=>{!function(e){const{questionStore:t,environment:o,currValue:n}=e;d().createAndCommit({userAction:"formQuestion.changeEndDateSetting",environment:o,canUndo:!0,perform:e=>{d().applyOperation({store:t,operation:{pointer:t.pointer,path:["config","propertyTypeSpecificConfig","date","endDate"],command:"set",args:!n},transaction:e})}})}({environment:l,questionStore:o,currValue:a})}),[a,l,o]),c=bm({collectionContextStore:t,formQuestionStore:o});return(0,C.jsx)(yc().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"End date",id:"formQuestionEditSettings.date.endDate.title"}),switcherProps:{on:a},icon:x().C,onClick:s,disabled:c})}function mm(e){let{collectionContextStore:t,formQuestionStore:o}=e;const l=(0,i().O7)(),a=(0,r().VK)((()=>{var e;return(null===(e=o.getPropertyTypeSpecificConfig("date"))||void 0===e?void 0:e.includeTime)??!1}),[o]),s=(0,n.useCallback)((()=>{!function(e){const{questionStore:t,environment:o,currValue:n}=e;d().createAndCommit({userAction:"formQuestion.changeIncludeTimeSetting",environment:o,canUndo:!0,perform:e=>{d().applyOperation({store:t,operation:{pointer:t.pointer,path:["config","propertyTypeSpecificConfig","date","includeTime"],command:"set",args:!n},transaction:e})}})}({environment:l,questionStore:o,currValue:a})}),[a,l,o]),c=bm({collectionContextStore:t,formQuestionStore:o});return(0,C.jsx)(yc().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"Include time",id:"formQuestionEditSettings.date.includeTime.title"}),switcherProps:{on:a},icon:h().r,onClick:s,disabled:c})}function fm(e){let{collectionContextStore:t,formQuestionStore:o,propertySchema:l}=e;const a=(0,i().O7)(),s=(0,I().YB)(),c=(0,Dn().E)("forms_max_selection_custom_options");let u=(0,r().VK)((()=>c?[{key:"unlimited",title:"Unlimited",type:"button"},{key:"1",title:"1",type:"button"},{key:"2",title:"2",type:"button"},{key:"3",title:"3",type:"button"},{key:"4",title:"4",type:"button"},{key:"5",title:"5",type:"button"},{key:"10",title:"10",type:"button"}]:[{key:"unlimited",title:"Unlimited",type:"button"},{key:"1",title:"1",type:"button"}]),[c]);const p=u.map((e=>e.key)),{selectedKey:g,maxSelection:m}=(0,r().VK)((()=>{const e=(0,Bg().vp)(l,o),t=null==e?void 0:e.toString();let n="custom";return void 0===e?n="unlimited":t&&p.includes(t)&&(n=t),{selectedKey:n,maxSelection:e}}),[o,l,p]),[f,y]=(0,n.useState)("custom"===g?null==m?void 0:m.toString():""),S=(0,n.useCallback)(((e,t,n)=>{let i;switch(e){case"unlimited":i=void 0;break;case"custom":if(!n)return;i=parseInt(n,10);break;default:i=parseInt(e,10)}void 0!==i&&(isNaN(i)||!Number.isInteger(i)||i<1||i>1e3)?y(""):d().createAndCommit({environment:a,userAction:"MaxSelectionComponent.handleUpdateSelection",canUndo:!0,perform:e=>{Zn().sO({store:o.getKeyStore("config").getKeyStore("propertyTypeSpecificConfig").getKeyStore(l.type).getKeyStore("maxSelectionCount"),value:i,transaction:e})}})}),[a,o,l.type,y]);function h(e){const t=/[^0-9]/g;t.test(e)&&xr().oV({label:(0,C.jsx)(I()._H,{id:"formQuestionEditSettings.maxSelection.nonNumberWarning",defaultMessage:"Please enter a number."})});const o=e.replace(t,"");y(o)}u=(0,r().VK)((()=>c?[...u,{key:"custom",type:"input",isInput:!0,inputValue:f,onSubmit:S,onChange:h}]:u),[u,S,c,f]);const x=bm({collectionContextStore:t,formQuestionStore:o});return(0,C.jsx)(ro().Z,{textWrap:!0,alignment:ao().Alignment.Center,placement:ao().Placement.Left,disableTooltip:!((0,ka().ln)(l)&&l.limit),renderTooltip:()=>{if((0,ka().ln)(l)&&void 0!==l.limit)return(0,C.jsx)(I()._H,{id:"formQuestionEditSettings.maxSelection.error.tooltip",defaultMessage:"A limit of 1 has been set on the linked property. Please remove the limit on the linked property in order to configure this question's max selection."})},render:e=>(0,C.jsx)(vt().Z,{...e,title:(0,C.jsx)(I()._H,{id:"formQuestionEditSettings.maxSelection.title",defaultMessage:"Max selection"}),icon:Xg().J,selectedKey:g,options:u,onChange:S,disabled:x||(0,ka().ln)(l)&&void 0!==l.limit,inputPlaceholder:s.formatMessage({id:"formQuestionEditSettings.maxSelection.inputPlaceholder",defaultMessage:"Custom"})})})}function ym(e){let{collectionContextStore:t,formQuestionStore:o,propertyType:l}=e;const a=(0,r().VK)((()=>{var e;return(null===(e=o.getPropertyTypeSpecificConfig(l))||void 0===e?void 0:e.longAnswer)??!1}),[o,l]),s=(0,i().O7)(),c=(0,n.useCallback)((()=>{!function(e){const{questionStore:t,environment:o,currValue:n,propertyType:i}=e;d().createAndCommit({userAction:"formQuestion.changeName",environment:o,canUndo:!0,perform:e=>{d().applyOperation({store:t,operation:{pointer:t.pointer,path:["config","propertyTypeSpecificConfig",i,"longAnswer"],command:"set",args:!n},transaction:e})}})}({environment:s,questionStore:o,currValue:a,propertyType:l})}),[a,s,o,l]),u=bm({collectionContextStore:t,formQuestionStore:o});return(0,C.jsx)(yc().Z,{title:(0,C.jsx)(I()._H,{defaultMessage:"Long answer",id:"formQuestionEditSettings.longAnswer.title"}),switcherProps:{on:a},icon:Wg().Z,onClick:c,disabled:u})}function Sm(e){let{collectionContextStore:t,collectionSettingsStore:o,formQuestionStore:n,questionErrorState:l}=e;const a=(0,f().Fg)(),c=(0,i().O7)(),d=(0,r().VK)((()=>{var e;return null===(e=n.getConfig())||void 0===e?void 0:e.propertyId}),[n]),u=(0,r().VK)((()=>{if(!d)return;const e=t.normalizedSchemaStore.state[d];return e?e.name:void 0}),[t.normalizedSchemaStore,d]),{layoutStore:p,collectionStore:g}=(0,$a().J9)(),m=(0,Bg().nI)({layoutStore:p,collectionStore:g}),y=(0,r().VK)((()=>{const e=[];return m.forEach((o=>{const n=t.normalizedSchemaStore.state[o];n&&(0,Ig().I0)(n)&&e.push({key:o,type:"button",title:n.name,icon:(0,C.jsx)(mo().ZP,{type:n.type,theme:a,icon:void 0,size:16,style:{fill:a.regularIconColor}})})})),e.push({key:"not_found",type:"button",hideOption:!0,title:(0,C.jsx)(I()._H,{id:"formQuestionEditSettings.linkedProperty.propertyNotFound",defaultMessage:"Not Found"})}),e}),[a,t.normalizedSchemaStore,m]);return(u||l)&&d?"deleted_property"===l?(0,C.jsx)(vt().Z,{disabled:y.every((e=>!0===e.hideOption)),icon:$g().v,title:(0,C.jsx)(I()._H,{defaultMessage:"Linked property",id:"formQuestionEditSettings.linkedProperty.title"}),selectedKey:"not_found",onChange:e=>nm().formEditorActions.remapQuestionToNewProperty({environment:c,formQuestionStore:n,newPropertyId:e}),options:y}):(0,C.jsx)(F().Z,{icon:$g().v,title:(0,C.jsx)(I()._H,{defaultMessage:"View linked property",id:"formQuestionEditSettings.viewLinkedProperty.title"}),showChevron:!0,onClick:()=>{s().H4({collectionSettingsStore:o,item:{type:"property",formatKey:void 0,property:d}})}}):null}function hm(e){let{collectionContextStore:t,collectionSettingsStore:o,moduleId:l,formQuestionStore:a}=e;const{layoutStore:s,sessionId:c}=(0,$a().J9)(),{isCollectionEmpty:u}=(0,rg().Y)(),p=(0,i().O7)(),g=(0,r().VK)((()=>(0,eg().bF)({modulesByArea:s.getModules(),find:e=>l===e.id})),[s,l]),m=(0,n.useCallback)((()=>{void 0!==g&&d().createAndCommit({userAction:"formActions.deleteFormQuestion",environment:p,canUndo:!0,perform:e=>{(0,tm().r)({environment:p,module:g.module,sessionId:c,layoutStore:s,transaction:e,collectionSettingsStore:o,isCollectionEmpty:u,collectionContextStore:t,area:g.area,updateParentModule:!0})}})}),[t,o,p,u,s,c,g]);return(0,C.jsx)(F().Z,{icon:T().y,title:(0,C.jsx)(I()._H,{id:"formQuestionEditSettings.deleteQuestion.title",defaultMessage:"Delete question"}),onClick:m})}function xm(e){let{formQuestionStore:t,collectionContextStore:o}=e;const l=(0,i().O7)(),{autofocusedQuestionTextStore:a}=(0,rg().Y)(),s=(0,r().VK)((()=>{var e;return Boolean(null===(e=t.getConfig())||void 0===e?void 0:e.showDescription)}),[t]),c=(0,n.useCallback)((()=>{om({environment:l,questionStore:t,autofocusedQuestionTextStore:a,currValue:s})}),[a,l,t,s]),d=bm({collectionContextStore:o,formQuestionStore:t});return(0,C.jsx)(yc().Z,{icon:Gg,title:(0,C.jsx)(I()._H,{id:"formQuestionEditSettings.addDescription.title",defaultMessage:"Description"}),onClick:c,disabled:d,switcherProps:{on:s}})}function vm(e){let{moduleId:t}=e;const o=(0,i().O7)(),{layoutStore:l,sessionId:a}=(0,$a().J9)(),s=(0,r().VK)((()=>{var e;return null==l||null===(e=l.getModules().form_conditional_modules)||void 0===e?void 0:e[t]}),[l,t]),c=(0,n.useCallback)((()=>{s&&"formQuestion"===s.type&&em().wm({environment:o,layoutStore:l,formQuestionModule:s,sessionId:a})}),[o,l,s,a]);return s?(0,C.jsx)(F().Z,{icon:Qg().L,title:(0,C.jsx)(I()._H,{id:"formQuestionEditSettings.removeFromConditionalGroup.title",defaultMessage:"Remove from conditional group"}),onClick:c}):null}function Cm(e){let{collectionContextStore:t,moduleId:o,propertyId:l,formQuestionStore:a,propertySchema:s}=e;const{layoutStore:c}=(0,$a().J9)(),u=(0,r().VK)((()=>a.getConfig()),[a]),{collectionStore:p,autofocusedQuestionTextStore:g}=(0,rg().Y)(),m=(0,i().O7)(),f=(0,I().YB)(),y=(0,r().VK)((()=>c.getSpaceId()),[c]),S=(0,im().K)(),h=(0,r().VK)((()=>{var e;return(null===(e=c.getFormQuestionsForFormLayout())||void 0===e?void 0:e.length)??0}),[c]),x=(0,n.useCallback)((async()=>{if(!y)return;if(h>=Ig().h0)return void xr().oV({label:f.formatMessage(Ig().tU.questionLimitReachedFullMessage)});const e=p.getSchema(),n=await(0,dt().xy)({environment:m,schema:e,property:l,parentStore:p,propertyGroups:void 0,spaceId:y});n&&d().createAndCommit({userAction:"CollectionSettingsProperty.handleDuplicateClick",environment:m,canUndo:!0,perform:e=>{(0,Jl().x)({environment:m,collectionStore:p,update:{[n.newProperty]:n.newPropertySchema},transaction:e}),(0,ig().createFormQuestionAndModuleForNewlyDuplicatedProperty)({environment:m,transaction:e,layoutStore:c,collectionStore:p,propertyId:n.newProperty,position:{type:"module_relative",area:"form_layout_schema",relativeToModuleId:o,direction:"below"},addLayoutModule:S,collectionContextStore:t,autofocusTitle:{shouldAutofocus:!0,autofocusedQuestionTextStore:g},existingFormQuestionConfig:u})}})}),[S,g,t,p,m,c,o,l,u,y,h,f]);return s&&(0,go().g0)(s)&&y?(0,C.jsx)(F().Z,{icon:Ta().a,title:(0,C.jsx)(I()._H,{id:"formQuestionEditSettings.duplicateQuestion.title",defaultMessage:"Duplicate question"}),onClick:x}):null}function bm(e){let{collectionContextStore:t,formQuestionStore:o}=e;const n=(0,i().O7)(),{collectionStore:l,formBlockStore:a}=(0,r().VK)((()=>{var e;return{collectionViewStore:t.collectionViewStore(),collectionStore:t.collectionStore(),formBlockStore:null===(e=t.collectionViewStore())||void 0===e?void 0:e.getFormBlockStore()}}),[t]);return void 0!==(0,r().VK)((()=>{if(!l)return"generic_error";const e=l.getSchema();return e&&o?o.getQuestionErrorState(n,e,null==a?void 0:a.hasPublicPermission()):"generic_error"}),[l,n,a,o])}const wm=(0,I().vU)({suggested:{defaultMessage:"Suggested",id:"database.viewSettings.createViewTab.suggested"},link:{defaultMessage:"Link...",id:"database.viewSettings.searchCollections.link"},search:{defaultMessage:"Search...",id:"database.viewSettings.searchCollections.search"},linkOrCreate:{defaultMessage:"Link or create...",id:"database.viewSettings.searchCollections.linkedOrCreate"}});function jm(e){let{existingCollectionStore:t,onCollectionPicked:o}=e;const l=(0,i().O7)(),[a,s]=(0,n.useState)(""),c=(0,gt().Y$)(),[d,u]=(0,r().VK)((()=>[c.settingsStore,c.settingsStore.state.hideSettingsHeader]),[c]),p=(0,r().VK)((()=>{const e=c.collectionViewBlockStore();if(!e)throw new Error("collectionViewBlockStore is required");return e}),[c]),g=(0,r().qz)(void 0,li().Z),m=(0,n.useCallback)((e=>{ei({collectionContextStore:c,environment:l,collectionStore:e,collectionSettingsStore:d,createdCollectionStore:t,userAction:"LinkToDatabaseMenu.handleAcceptExistingSource"}),null==o||o(e)}),[c,d,t,l,o]),{resultsSection:f,fetchMoreResults:y,searchSessionId:S,searchSessionFlowNumber:h}=_i({input:a,collectionContextStore:c,hideSearchTitle:u,parentStore:p,context:Ti.Source,handleAcceptExistingCollection:m,showSuggestions:!0}),x=ui(c),v=(0,n.useRef)(0);(0,n.useEffect)((()=>{v.current=h}),[h]);const b=(0,r().VK)((()=>"on"===$e().default.getEligibleGroup({experimentId:"search_surfaces_collection_search",defaultGroup:"unassigned"})),[]);(0,n.useEffect)((()=>((0,mt().j)({environment:l,event:{eventName:"source_collection_search_open",eventProperties:{search_session_id:S,using_secondary_search_surfaces_hook:b,source:"source"}}}),()=>{(0,mt().j)({environment:l,event:{eventName:"source_collection_search_close",eventProperties:{search_session_id:S,source:"source",using_secondary_search_surfaces_hook:b,search_session_flow_number:v.current}}})})),[l,b,S]);const w=(0,r().VK)((()=>null!=c&&c.isInHomeWidgetStore.state?wm.search:wm.link),[c]);return(0,C.jsxs)(B().ZP,{collectionSettingsStore:d,title:"Link to existing database",children:[(0,C.jsx)(ee().Z,{shouldShowBottomDivider:!1,children:(0,C.jsx)(xo().ZP,{value:a,onChange:e=>{s(e.target.value),g.setState({focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})},focusInitial:!0,placeholder:Co().Z.formatMessage(w),showClearButton:!0})}),(0,C.jsx)(Q().ZP,{type:Q().iW.Vertical,initialFocus:void 0,resetFocusOnMouseOut:!0,sections:[f,x].filter(N().$K)}),b?(0,C.jsx)(ii().Z,{onChange:(e,t)=>{y&&e<ri().Z.incrementScrollOffset&&y()}}):null]})}function _m(e){var t;const{collectionSettingsStore:o,collectionContextStore:l}=e,c=(0,i().O7)(),[d,u]=(0,n.useState)(),p=(0,r().VK)((()=>(0,Ye().n)(o)),[o]),m=(0,r().VK)((()=>l.getViewType()),[l]),f=(0,r().VK)((()=>l.allowScrollingWhenCollectionSettingsSidebarOpen()),[l]),y=(0,r().VK)((()=>o.state.closeOnEscape),[o]);(0,qe().Z)({capture:!f,preventType:Ge().Z.Y});const S=(0,r().VK)((()=>{if("property"===(null==p?void 0:p.type))return(0,tt().KV)({collectionContextStore:l,property:p.property})}),[l,p]);(0,n.useEffect)((()=>{var e,t,o,n,i,r,s;p&&d!==p&&("propertyType"===p.type?a().r5(c,{view_type:m,menu:p.type,is_database_name_empty:!Boolean(null==l||null===(e=l.collectionStore())||void 0===e||null===(e=e.getName())||void 0===e?void 0:e.toString()),collection_id:null===(t=l.collectionStore())||void 0===t?void 0:t.id,collection_view_id:null===(o=l.collectionViewStore())||void 0===o?void 0:o.id,collection_view_block_id:null===(n=l.collectionViewBlockStore())||void 0===n?void 0:n.id,database_visit_id:l.visitSessionId,..."button"===(null==S?void 0:S.type)&&{builder_type:"modal"}}):a().r5(c,{view_type:m,menu:p.type,collection_id:null===(i=l.collectionStore())||void 0===i?void 0:i.id,collection_view_id:null===(r=l.collectionViewStore())||void 0===r?void 0:r.id,collection_view_block_id:null===(s=l.collectionViewBlockStore())||void 0===s?void 0:s.id,database_visit_id:l.visitSessionId,builder_type:"modal"}));u(p)}),[l,p,c,d,null==S?void 0:S.type,m]);const h=function(e){return{main:t=>(0,C.jsx)(Mm,{tab:t,...e}),source:()=>(0,C.jsx)(Ap,{...e}),createViewSource:t=>(0,C.jsx)(gf,{tab:t,...e}),createSyncedViewSource:t=>(0,C.jsx)(Pm,{tab:t,...e}),selectAccountForExternalSource:t=>(0,C.jsx)(Tm,{tab:t,...e}),shareSyncedView:t=>(0,C.jsx)(Im,{tab:t,...e}),propertyType:t=>(0,C.jsx)(Vm,{tab:t,...e}),propertyAiAutofill:t=>(0,C.jsx)(Am,{tab:t,...e}),createView:()=>(0,C.jsx)(Tn,{...e}),duplicateExistingView:()=>(0,C.jsx)(Bm,{...e}),properties:t=>(0,C.jsx)(Zm,{tab:t,...e}),property:t=>(0,C.jsx)(Fm,{tab:t,...e}),deletedProperties:t=>(0,C.jsx)(Rm,{tab:t,...e}),selectRelationSource:t=>(0,C.jsx)(Km,{tab:t,...e}),setupRelation:t=>(0,C.jsx)(Hm,{tab:t,...e}),selectViewsModuleSource:t=>(0,C.jsx)(Om,{tab:t,...e}),setupViewsModule:t=>(0,C.jsx)(Lm,{tab:t,...e}),layout:()=>(0,C.jsx)(op,{...e}),group:t=>(0,C.jsx)(Dm,{tab:t,...e}),groupByProperty:t=>(0,C.jsx)(Em,{tab:t,...e}),subitem:t=>(0,C.jsx)(Um,{tab:t,...e}),arrowsBy:t=>(0,C.jsx)(Wm,{tab:t,...e}),githubConfig:t=>(0,C.jsx)(Ym,{tab:t,...e}),filters:()=>(0,C.jsx)(Lu,{...e}),groupByNumber:t=>(0,C.jsx)(Nm,{tab:t,...e}),filter:t=>(0,C.jsx)($m,{tab:t,...e}),createFilter:()=>(0,C.jsx)(ju,{...e}),createSort:()=>(0,C.jsx)(Iu,{...e}),sort:()=>(0,C.jsx)(fp,{...e}),page:()=>(0,C.jsx)(km,{...e}),automationSettings:t=>(0,C.jsx)(Qm,{tab:t,...e}),mobileCreateAutomation:t=>(0,C.jsx)(ef,{tab:t,...e}),mobileEditAutomation:t=>(0,C.jsx)(tf,{tab:t,...e}),mobileEditButtonAutomation:t=>(0,C.jsx)(of,{tab:t,...e}),externalProjectsSyncSettings:t=>(0,C.jsx)(Jm,{tab:t,...e}),connectedRelationDatabaseActions:t=>(0,C.jsx)(Xm,{tab:t,...e}),dependencies:t=>(0,C.jsx)(qm,{tab:t,...e}),relationFeaturesAdvancedSettings:t=>(0,C.jsx)(Gm,{tab:t,...e}),subitemV2:t=>(0,C.jsx)(zm,{tab:t,...e}),sprintSettings:t=>(0,C.jsx)(nf,{tab:t,...e}),customize:t=>(0,C.jsx)(sf,{tab:t,...e}),confirmAddTemplate:t=>(0,C.jsx)(cf,{tab:t,...e}),views:t=>(0,C.jsx)(df,{tab:t,...e}),linked_collections:t=>(0,C.jsx)(uf,{tab:t,...e}),connectionFeatures:t=>(0,C.jsx)(pf,{tab:t,...e}),formQuestionEditSettings:t=>(0,C.jsx)(rf,{tab:t,...e}),formQuestionCreateSettings:t=>(0,C.jsx)(lf,{tab:t,...e}),formCustomizeSettings:t=>(0,C.jsx)(af,{tab:t,...e}),linkToDatabase:t=>(0,C.jsx)(mf,{tab:t,...e}),databaseSettings:t=>(0,C.jsx)(ff,{tab:t,...e}),databaseProperties:t=>(0,C.jsx)(yf,{tab:t,...e})}}(e);return p?(0,C.jsx)(g().Z,{debugName:"CollectionSettings",capture:!0,onEsc:y??1?t=>function(e,t){(0,We().ZP)({event:e,context:We().Af.CollectionSettingsClick,callback:()=>{s().E3({collectionSettingsStore:t})}})}(t,e.collectionSettingsStore):void 0,children:null===(t=h[p.type])||void 0===t?void 0:t.call(h,p)}):null}function Mm(e){const{collectionContextStore:t,tab:o}=e,n=(0,r().VK)((()=>{var e;return null===(e=t.collectionViewStore())||void 0===e?void 0:e.id}),[t]),i=(0,r().VK)((()=>t.collectionViewStore()),[t]);return"main"===o.type&&i?(0,C.jsx)(Cr().ZP,{selectViewNameInitial:o.selectViewNameInitial,collectionViewStore:i,...e},n):null}function km(e){const{collectionContextStore:t}=e,o=(0,i().O7)(),n=(0,r().VK)((()=>t.collectionViewStore()),[t]);return n?(0,C.jsx)(B().ZP,{...e,title:"Select page to display",children:(0,C.jsx)("div",{style:{margin:12},children:(0,C.jsx)(p().Z,{showClearButton:!0,placeholder:"Enter page ID",focusInitial:!0,onChange:e=>{Qe().Z.setState({pageId:e.target.value})},onSubmit:()=>{const e=Qe().Z.state.pageId;if(!e)return null;d().createAndCommit({userAction:"collectionSettings.pageView.selectPage",environment:o,canUndo:!0,perform:t=>{c().FH({stores:[n],update:{page_pointer:{id:(0,l().Mt)(e),spaceId:t.spaceId,table:"block"}},transaction:t})}})}})})}):null}function Pm(e){const{tab:t}=e;return"createSyncedViewSource"!==t.type?null:(0,C.jsx)(hn,{...e,...t})}function Tm(e){const{tab:t}=e;return"selectAccountForExternalSource"!==t.type?null:(0,C.jsx)(co,{...e,...t})}function Im(e){const{tab:t}=e;return"shareSyncedView"!==t.type?null:(0,C.jsx)(hu,{...e,...t})}function Vm(e){const{tab:t}=e;return"propertyType"!==t.type?null:(0,C.jsx)(Ld,{...e,...t})}function Am(e){const{tab:t}=e;return"propertyAiAutofill"!==t.type?null:(0,C.jsx)(vd,{...e,...t})}function Zm(e){const{tab:t}=e;return"properties"!==t.type?null:(0,C.jsx)(np().Z,{...e,timelineViewTab:t.timelineViewTab})}function Bm(e){return(0,C.jsx)(Ur,{...e})}function Fm(e){const{tab:t}=e;return"property"!==t.type?null:(0,C.jsx)(hc,{...e,...t,titleOverride:e.collectionSettingsPropertyTitleOverride},t.property)}function Rm(e){const{tab:t}=e;return"deletedProperties"!==t.type?null:(0,C.jsx)(Br,{...t,...e})}function Km(e){const{tab:t}=e;return"selectRelationSource"!==t.type?null:(0,C.jsx)(iu,{...e,...t})}function Hm(e){const{tab:t}=e;return"setupRelation"!==t.type?null:(0,C.jsx)(su,{...e,...t})}function Om(e){const{tab:t}=e;return"selectViewsModuleSource"!==t.type?null:(0,C.jsx)(ru,{...e,...t})}function Lm(e){const{tab:t}=e;return"setupViewsModule"!==t.type?null:(0,C.jsx)(pu,{...e,...t})}function Dm(e){const{tab:t}=e;return"group"!==t.type?null:(0,C.jsx)(zu().ZP,{...e,...t})}function Em(e){const{tab:t}=e;return"groupByProperty"!==t.type?null:(0,C.jsx)(ep,{...e,...t})}function Nm(e){const{tab:t}=e;return"groupByNumber"!==t.type?null:(0,C.jsx)(Qu,{...e,...t})}function Um(e){const{tab:t}=e;return"subitem"!==t.type?null:(0,C.jsx)(gp,{...e,...t,formatSetting:"subitem"})}function zm(e){const{tab:t}=e;return"subitemV2"!==t.type?null:(0,C.jsx)(Rt,{...e,feature:"subitem",from:t.from})}function Wm(e){const{tab:t}=e;return"arrowsBy"!==t.type?null:(0,C.jsx)(gp,{...e,...t,formatSetting:"timeline_arrows_by"})}function qm(e){const{tab:t}=e;return"dependencies"!==t.type?null:(0,C.jsx)(Rt,{...e,feature:"timeline_arrows_by",from:t.from})}function Gm(e){const{tab:t}=e;return"relationFeaturesAdvancedSettings"!==t.type?null:(0,C.jsx)(to,{...e,feature:t.feature})}function Ym(e){const{tab:t}=e;return"githubConfig"!==t.type?null:(0,C.jsx)(Ma,{...e,property:t.property})}function $m(e){const{tab:t}=e;return"filter"!==t.type?null:(0,C.jsx)(Zu,{...e})}function Qm(e){const{tab:t}=e;return"automationSettings"!==t.type?null:(0,C.jsx)(Oe,{...e,tabSettings:t})}function Jm(e){const{tab:t}=e;return"externalProjectsSyncSettings"!==t.type?null:(0,C.jsx)(Hl,{...e,tabSettings:t})}function Xm(e){const{tab:t}=e;return"connectedRelationDatabaseActions"!==t.type?null:(0,C.jsx)(Jo,{...e,tabSettings:t})}function ef(e){const{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"mobileCreateAutomation"!==t.type?null:(0,C.jsx)(u().S,{collectionSettingsStore:n,collectionContextStore:o,mode:"create",from:t.from,source:t.source})}function tf(e){const{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;if("mobileEditAutomation"!==t.type)return null;const{automationId:i}=t;return(0,C.jsx)(u().S,{collectionSettingsStore:n,collectionContextStore:o,mode:"update",source:t.source,automationId:i})}function of(e){const{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"mobileEditButtonAutomation"!==t.type?null:(0,C.jsx)(u().Z,{collectionSettingsStore:n,collectionContextStore:o,propertyId:t.propertyId,propertySchema:t.propertySchema})}function nf(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"sprintSettings"!==t.type?null:(0,C.jsx)(ve,{collectionContextStore:o,collectionSettingsStore:n,from:t.from})}function rf(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"formQuestionEditSettings"!==t.type?null:(0,C.jsx)(sm,{collectionContextStore:o,collectionSettingsStore:n,formQuestionId:t.formQuestionId,moduleId:t.moduleId})}function lf(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"formQuestionCreateSettings"!==t.type?null:(0,C.jsx)(zg,{collectionContextStore:o,collectionSettingsStore:n,moduleId:t.moduleId,area:t.area,parentModuleId:t.parentModuleId,parentConditionalGroupId:t.parentConditionalGroupId})}function af(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"formCustomizeSettings"!==t.type?null:(0,C.jsx)(Xp,{collectionContextStore:o,collectionSettingsStore:n})}function sf(e){const{tab:t,collectionContextStore:o}=e,n=(0,i().O7)();(0,et().Y)(o);const l=(0,r().VK)((()=>{const e=o.collectionStore();return(0,Xe().Hq)({environment:n,collectionStore:e})}),[n,o]),a=(0,r().VK)((()=>l&&$e().default.checkGate({gateName:"workflow_templates_prototype"})),[l]);return"customize"!==t.type?null:l&&a?(0,C.jsx)(Ne,{collectionTemplate:l}):(0,C.jsx)(De,{...e})}function cf(e){let{tab:t,collectionSettingsStore:o}=e;return"confirmAddTemplate"!==t.type?null:(0,C.jsx)(Je().gb,{template:t.template,collectionSettingsStore:o})}function df(e){let{tab:t,collectionSettingsStore:o,collectionContextStore:n}=e;return"views"!==t.type?null:(0,C.jsx)(Je().So,{collectionSettingsStore:o,collectionContextStore:n})}function uf(e){let{tab:t}=e;return"linked_collections"!==t.type?null:(0,C.jsx)(Je()._1,{})}function pf(e){const{tab:t}=e;return"connectionFeatures"!==t.type?null:(0,C.jsx)(ze,{...e})}function gf(e){const{tab:t}=e;return"createViewSource"!==t.type?null:(0,C.jsx)(ir,{existingCollectionStore:t.existingCollectionStore,createdCollectionRecordPointerMap:t.createdCollectionRecordPointerMap,onCollectionPicked:t.onCollectionPicked,...e})}function mf(e){const{tab:t}=e;return"linkToDatabase"!==t.type?null:(0,C.jsx)(jm,{existingCollectionStore:t.existingCollectionStore,onCollectionPicked:t.onCollectionPicked,...e})}function ff(e){const{tab:t}=e;return"databaseSettings"!==t.type?null:(0,C.jsx)(wr,{...e})}function yf(e){const{tab:t}=e;return"databaseProperties"!==t.type?null:(0,C.jsx)(yr,{...e})}},675334:(e,t,o)=>{"use strict";o.d(t,{Z:()=>d});o(667294);var n=()=>o(219727),i=()=>o(846550),r=()=>o(714230),l=()=>o(788860),a=()=>o(707513),s=()=>o(396439),c=o(785893);function d(e){const t=(0,l().YB)(),o=function(e){const{isMobile:t}=(0,n().Fy)(),o=t?18:14,r=1,l=6,s=20;return(0,i().yK)((t=>({githubContainer:{display:"flex",alignSelf:"center",flexDirection:"column",width:e||"90%",padding:s,border:`${r}px solid ${t.tableDividerColor}`,borderRadius:l,borderBottomRightRadius:6,cursor:"default"},githubPrTitleRow:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",width:`calc(100% + ${s}px)`,overflow:"hidden"},githubPrTitle:{display:"inline-flex",fontSize:o,fontWeight:500,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",background:t.whiteButtonBackground,padding:"2px 4px",borderTopLeftRadius:5,borderBottomLeftRadius:5,borderLeft:`2px solid ${t.blueColor}`,borderTop:`2px solid ${t.blueColor}`,borderBottom:`2px solid ${t.blueColor}`,width:"100%"},githubTask:{background:"light"===t.mode?t.accentColors.blue[50]:t.accentColors.blue[400]},githubPrInfoRow:{display:"inline-flex"},githubPrInfoPill:{display:"flex",flexDirection:"row",alignItems:"center",width:"fit-content",padding:"4px 10px",borderRadius:"2em",background:"#238636",flexShrink:0,...a().Yu},githubPrInfoOpenText:{color:"white",fontSize:o-2,fontWeight:500},githubPrInfoMergeInto:{display:"inline-flex",alignItems:"center",fontSize:o-2,color:t.lightTextColor,...a().Yu},githubPrInfoMain:{padding:"0px 4px",fontFamily:a().Gl.githubMono,background:t.cardPressedBackground,borderRadius:l,color:t.regularTextColor,verticalAlign:"text-bottom",...a().Yu}})),[o,e])}(e.width),d=(0,c.jsx)("div",{id:"github-preview-github-pr-title-row",style:o.githubPrTitleRow,children:(0,c.jsxs)("div",{id:"github-preview-github-pr-title-wrapper",style:o.githubPrTitle,children:[(0,c.jsx)(s().Z,{size:2}),"[",(0,c.jsxs)("div",{id:"github-preview-github-pr-task",style:o.githubTask,children:[e.uniqueIdPrefix||t.formatMessage(u.idPrefix),e.uniqueIdValue?`-${e.uniqueIdValue}`:"-1"]}),"]",(0,c.jsx)(s().Z,{size:2}),t.formatMessage(u.prTitle)]})}),p=(0,c.jsxs)("div",{id:"github-preview-github-pr-info-row",style:o.githubPrInfoRow,children:[(0,c.jsxs)("div",{id:"github-preview-github-open-pr-pill",style:o.githubPrInfoPill,children:[(0,c.jsx)("img",{src:r().Z.images.externalIntegrations.githubPullOpenIconWhitePng,style:{width:16,height:16}}),(0,c.jsx)(s().Z,{size:2}),(0,c.jsx)("div",{style:o.githubPrInfoOpenText,children:t.formatMessage(u.open)})]}),(0,c.jsx)(s().Z,{size:8}),(0,c.jsx)("div",{id:"github-preview-github-merge-into-main",style:o.githubPrInfoMergeInto,children:(0,c.jsxs)("span",{style:o.githubPrInfoMergeInto,children:[t.formatMessage(u.mergeInto),(0,c.jsx)(s().Z,{size:4}),(0,c.jsx)("span",{style:o.githubPrInfoMain,children:t.formatMessage(u.main)})]})})]});return(0,c.jsxs)("div",{id:"github-preview-github-container",style:o.githubContainer,children:[d,(0,c.jsx)(s().Z,{size:12}),p]})}const u=(0,l().vU)({dismissButtonAriaLabel:{defaultMessage:"A button to dismiss the user education preview.",id:"database.viewSettings.githubConfigTab.preview.dismissButtonAriaLabel"},idPrefix:{defaultMessage:"TASK",id:"database.viewSettings.githubConfigTab.preview.idPrefix"},prTitle:{defaultMessage:"GitHub PR Title",id:"database.viewSettings.githubConfigTab.preview.prTitle"},open:{defaultMessage:"Open",id:"database.viewSettings.githubConfigTab.preview.open"},mergeInto:{defaultMessage:"Merge into",id:"database.viewSettings.githubConfigTab.preview.mergeInto"},main:{defaultMessage:"main",id:"database.viewSettings.githubConfigTab.preview.main"}})},821159:(e,t,o)=>{"use strict";o.d(t,{Y:()=>d,s:()=>c});o(667294);var n=()=>o(219727),i=()=>o(846550),r=()=>o(707513),l=()=>o(827973),a=()=>o(641506),s=o(785893);function c(e){let{environment:t}=e;return{padding:t.device.isMobile?"12px 2px":"6px 4px",alignItems:"center"}}function d(e){let{buttonMenuItemProps:t,title:o,caption:d,icon:u,onClick:p,right:g,isDisabled:m}=e;const f=(0,n().O7)(),y=(0,i().yK)((e=>({menuItem:{display:"flex",...c({environment:f}),opacity:m?.4:void 0},title:{fontSize:f.device.isMobile?16:14,...r().Yu},caption:{fontSize:(0,a().yv)(f,"UISmall"),overflow:"hidden",color:e.mediumTextColor,whiteSpace:"nowrap",textOverflow:"ellipsis"}})),[f,m]),S={};return p&&(S.onClick=p),(0,s.jsx)(l().Z,{...t,style:y.menuItem,disabled:m,title:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:y.title,children:o}),d&&(0,s.jsx)("div",{style:y.caption,children:d})]}),icon:u,right:g,...S})}},777898:(e,t,o)=>{"use strict";o.d(t,{Z:()=>d});var n=o(667294),i=()=>o(846550),r=()=>o(568017),l=()=>o(654133),a=()=>o(73478),s=()=>o(998901),c=o(785893);function d(e){const{render:t,showImage:o,caption:d,description:u,tooltipImage:p,placement:g,tooltipDelayThreshold:m,hideTooltipBeforeImageLoaded:f,imageContainerStyle:y}=e,S=e.tooltipImageScale||1,[h,x]=n.useState(!1),[v,C]=n.useState({width:0,height:0});n.useEffect((()=>{if(p){const e=new Image;e.src=p,e.onload=()=>{C({width:"number"==typeof S?e.width*S:S.widthPx,height:"number"==typeof S?e.width*S:S.heightPx}),x(!0)}}}),[p,S]);const b=(0,i().yK)((()=>({tooltip:{whiteSpace:"break-spaces"},description:{fontWeight:"normal",color:r().ZP.uiLightGray}})),[]),w=(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{children:d}),u&&(0,c.jsx)("div",{style:b.description,children:u})]});return(0,c.jsx)(l().Z,{placement:g??s().Placement.Left,disableTooltip:void 0===d||!h&&f,delayThreshold:m,style:b.tooltip,render:t,renderTooltip:()=>p&&h&&o?(0,c.jsx)(a().Z,{caption:w,imageURL:p,imageWidth:v.width,imageHeight:v.height,imageContainerStyle:y}):w})}},96868:(e,t,o)=>{"use strict";o.d(t,{I:()=>d});var n=o(667294),i=()=>o(142735),r=()=>o(762478),l=()=>o(740046),a=()=>o(95352),s=o(785893);const c=o(263184).default.createClass("",{name:"InputStore"}),d=n.forwardRef((function(e,t){const{placeholder:d,focusInitial:u,selectAll:p,disabled:g,inputOuterStyle:m,iconButton:f,inputRightButton:y,initialValue:S,onBlur:h,onSubmit:x,onChange:v,maxLength:C,textWrapperStyle:b,textarea:w}=e,j=(0,o(219727).O7)(),[_,M]=(0,n.useState)(S||""),k=(0,i().qz)(e.inputStore,c),P=(0,i().Kw)(k)||_,T=(0,n.useCallback)((()=>{h(P)}),[P,h]),I=(0,n.useCallback)((()=>{x(P)}),[P,x]),V=(0,n.useCallback)((e=>{const t=e.target.value;M(t),k&&k.setState(t),v&&v(t)}),[k,v]),A=(0,o(840521).g)();return(0,n.useEffect)((()=>{e.inputStore&&k.setState(S)}),[]),(0,n.useEffect)((()=>()=>{A.current&&S!==P&&h(P)}),[S,P,A,h]),(0,s.jsx)(l().ZP,{ref:t,focusInitial:u,selectAll:p,value:P,onChange:V,onBlur:T,onSubmit:I,placeholder:d,disabled:g,textWrapperStyle:{opacity:g?.4:void 0,...b},maxlength:C,inputOuterStyle:m,left:f&&(0,s.jsx)(l().DO,{icon:f.icon,iconStyle:f.iconStyle,onClick:e=>function(e,t,n){if(!(n&&e.target instanceof Element))return;const i=o(527278).Z.getIntl(),{onSubmit:l,enforceIconColor:s,includeEmojiTab:c}=n;r().$(t,{originRect:e.target.getBoundingClientRect(),originGap:3,popupHeight:a().DQ,popupWidth:a().rw,showArrow:!0,title:i.formatMessage({defaultMessage:"Icon",id:"mediaPicker.tabs.icon"}),currentTab:"icon",tabs:c?[{type:"emoji",onChange:(e,t)=>{l(e),t&&t.keepVisible||r().Z()}},{type:"icon",enforceIconColor:s,onChange:(e,t)=>{l(e),t&&t.keepVisible||r().Z()}}]:[{type:"icon",enforceIconColor:s,onChange:(e,t)=>{l(e),t&&t.keepVisible||r().Z()}}],onDelete:()=>{l(),r().Z()}})}(e,j,f),disabled:g,style:{opacity:g?.4:void 0},backgroundColor:f.backgroundColor}),showClearButton:!1,inputRight:y,textarea:w})}))},864295:(e,t,o)=>{"use strict";o.d(t,{P:()=>s});o(667294);var n=()=>o(846550),i=()=>o(205248),r=()=>o(707513),l=()=>o(154186),a=o(785893);function s(e){const{title:t,icon:o,style:s,children:c,right:d,showCloseButton:u,onClose:p}=e,g=(0,n().Fg)(),m=(0,a.jsx)(l().Z,{onClick:p,style:{display:"flex",alignItems:"center",justifyContent:"center",background:void 0,borderRadius:6,width:16,height:16},children:(0,i().D)({width:14,fill:g.mediumTextColor})});return(0,a.jsxs)("div",{style:{padding:"12px 16px",margin:"4px 12px",fontSize:12,background:g.accentColors.orange[50],borderRadius:6,...s},children:[t&&(0,a.jsxs)("div",{style:{display:"flex",marginBottom:2,alignItems:"center"},children:[o,(0,a.jsx)("div",{style:{fontWeight:r().Ue.medium,flexGrow:1,...r().Yu},children:t}),u?m:d]}),c]})}},910007:(e,t,o)=>{"use strict";o.d(t,{z:()=>q,S:()=>$});o(267602),o(470928),o(241792);var n=o(667294),i=()=>o(219727),r=()=>o(142735),l=()=>o(846550),a=()=>o(834458),s=()=>o(235819),c=()=>o(177634),d=()=>o(374289),u=()=>o(996106),p=()=>o(788860),g=()=>o(568017),m=()=>o(696459),f=()=>o(707513),y=()=>o(250303),S=()=>o(269299),h=()=>o(612427),x=()=>o(154186),v=()=>o(448419),C=()=>o(291198),b=()=>o(967092),w=()=>o(86048),j=()=>o(594072),_=()=>o(388284),M=()=>o(471645),k=()=>o(654133),P=()=>o(619186),T=()=>o(35980),I=()=>o(527278),V=()=>o(352230),A=()=>o(827973),Z=()=>o(255577),B=o(785893);const F="LastUsedCurrency",R=o(263184).default.createClass("",{name:"NumberFormatFilterStore"});const K=function(e){let{collectionStore:t,property:l,schema:a,onClose:s}=e;const c=(0,i().O7)(),d=(0,r().qz)(void 0,o(692304).Z),p=(0,r().qz)(void 0,R),g=(0,n.useCallback)((e=>function(e,t,o){t.setState(e.target.value),o.setState({...o.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}(e,p,d)),[p,d]),m=(0,r().Kw)(p),f=(0,r().VK)((()=>function(e,t,o,n,i,r){const l=T().Z.get({userId:e.currentUser.id,key:F}),a=(0,P().ZP)(i.state,(0,u().jD)(l),(e=>e));return a.map((i=>{const l={key:i,render:e=>(0,B.jsx)(H,{name:i,props:e}),action:()=>function(e,t,o,n,i,r){const l=n[o];if(!l)return;if("number"!==l.type&&"formula"!==l.type)return;const a={...l,number_format:e,..."percent"===e&&void 0!==(null==l?void 0:l.show_as)?{show_as:{...null==l?void 0:l.show_as,maxValue:1}}:{}};"number"===l.type&&(0,u().b3)(e)&&T().Z.set({userId:i.currentUser.id,key:F,value:e});S().createAndCommit({userAction:"NumberFormatMenu.handleNumberFormatChange",environment:i,canUndo:!0,perform:e=>{(0,h().x)({environment:i,collectionStore:t,update:{[o]:a},transaction:e})}}),null==r||r()}(i,t,o,n,e,r)};return l}))}(c,t,l,a,p,s)),[c,t,l,a,p,s]),{device:y}=c;let x;x=y.isMobile?{menuType:V().o.ActionSheet}:{menuType:V().o.Popup};const v=!y.isMobile&&(0,B.jsx)(_().Z,{isInput:!0,children:(0,B.jsx)(o(740046).ZP,{value:m,onChange:g,focus:!0,focusAfterAnimation:!0,placeholder:I().Z.getIntl().formatMessage({defaultMessage:"Filter formats…",id:"blockPropertyValue.filterForNumberFormats.placeholder"}),preventCaptureDeleteWhenEmpty:!0})});return(0,B.jsx)(o(198829).Z,{...x,header:v,children:(0,B.jsx)(Z().ZP,{type:Z().iW.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,B.jsx)(_().Z,{...e}),items:f}],store:d})})};function H(e){let{name:t,props:o}=e;return(0,B.jsx)(A().Z,{...o,title:(0,u().Bo)(I().Z.getIntl(),t)})}var O=()=>o(129636),L=()=>o(125659),D=()=>o(667247),E=()=>o(26796),N=()=>o(998901),U=()=>o(529048),z=()=>o(446955),W=()=>o(508858);function q(e){let{collectionContextStore:t,property:o}=e;const{propertySchema:n,numberFormat:i,numberPrecision:l}=(0,r().VK)((()=>{const e=t.collectionStore();if(!e)return{};const n=t.normalizedSchemaStore.state[o];if(!n)return{};if("number"===n.type)return{propertySchema:n,numberFormat:n.number_format??u().dk,numberPrecision:n.number_precision??u().N3};if("formula"===n.type)return"number"===(0,a().getFormulaPropertySchemaResultType)(n)?{propertySchema:n,numberFormat:n.number_format??u().dk,numberPrecision:n.number_precision??u().N3}:n.formula2&&"number"===(0,c().aL)(n.formula2.result_type).type?{propertySchema:n,numberFormat:n.number_format??u().dk,numberPrecision:u().N3}:{};if("rollup"===n.type){var i;if(n.aggregation&&"show_unique"!==n.aggregation){var r;const i=null===(r=(0,s().gT)({property:o,schema:t.normalizedSchemaStore.state,getRecordModel:e.getRecordModel}))||void 0===r?void 0:r.targetPropertySchema;if(void 0===(null==i?void 0:i.type))return{};const l=(0,D().SD)(n.aggregation,(0,D().SD)(n.aggregation,"number_format"in i?i.number_format:void 0));return l?{propertySchema:n,numberFormat:l,numberPrecision:u().N3}:{}}const l=null===(i=(0,s().gT)({property:o,schema:t.normalizedSchemaStore.state,getRecordModel:e.getRecordModel}))||void 0===i?void 0:i.targetPropertySchema;if("number"===(null==l?void 0:l.type)||"formula"===(null==l?void 0:l.type)&&"number"===(0,a().getFormulaPropertySchemaBaseResultType)(l))return{propertySchema:n,numberFormat:l.number_format??u().dk,numberPrecision:u().N3}}return{}}),[t,o]);if(!n)return null;const d="rollup"!==n.type,p="formula"===n.type&&"number"!==(0,a().getFormulaPropertySchemaResultType)(n),g="rollup"!==n.type&&!p;return(0,B.jsxs)(B.Fragment,{children:[d&&(0,B.jsx)(G,{numberFormat:i,property:o}),g&&(0,B.jsx)(Y,{numberPrecision:l,property:o}),(0,B.jsx)(Q,{property:o,propertySchema:n,numberFormat:i})]})}function G(e){const{numberFormat:t,property:o}=e,l=(0,p().YB)(),{isMobile:a}=(0,i().Fy)(),s=(0,L().Y$)(),c=(0,r().qz)(void 0,U().Z),d=(0,n.useCallback)((e=>(0,B.jsx)(z().Z,{title:(0,B.jsx)(p()._H,{defaultMessage:"Number format",id:"database.viewSettings.numberOptions.numberFormat"}),right:(0,B.jsx)("span",{style:{...f().Yu},children:(0,u().Bo)(l,u().dX.find((e=>e===t))??u().dk)}),showChevron:!0,rotateChevron:c.state.open,...e})),[c,l,t]),g=(0,n.useCallback)((e=>{const t=s.collectionStore(),n=s.normalizedSchemaStore.state;if(t)return(0,B.jsx)(K,{collectionStore:t,property:o,schema:n,onClose:e.close})}),[s,o]);return(0,B.jsx)(v().ZP,{popupType:a?b().kQ.SlideUp:b().kQ.Popup,alignmentToOrigin:v().vR.End,renderOrigin:d,render:g,buttonPopupStore:c})}function Y(e){const{numberPrecision:t,property:o}=e,l=(0,p().YB)(),s=(0,i().O7)(),c=(0,L().Y$)(),d=(0,r().VK)((()=>c.collectionStore()),[c]),g=(0,r().Kw)(c.normalizedSchemaStore),m=(0,n.useMemo)((()=>{const e=g[o];if(!e)return;const t="formula"===e.type&&"number"===(0,a().getFormulaPropertySchemaResultType)(e);return"number"===e.type||t?e:void 0}),[o,g]),f=(0,n.useMemo)((()=>u().yF.map((e=>({key:e,type:"button",title:$(l,e)})))),[l]),y=(0,n.useCallback)((e=>{if(!d||!m)return;const t={...m,number_precision:e};S().createAndCommit({userAction:"NumberFormatMenu.handleNumberPrecisionChange",environment:s,canUndo:!0,perform:e=>{(0,h().x)({environment:s,collectionStore:d,update:{[o]:t},transaction:e})}})}),[d,s,o,m]);return(0,B.jsx)(k().Z,{placement:N().Placement.Right,textWrap:!0,renderTooltip:()=>(0,B.jsx)(p()._H,{defaultMessage:"Round to a specified number of decimal places. The underlying remains unchanged.",id:"database.viewSettings.numberOptions.numberPrecision.tooltip"}),render:e=>(0,B.jsx)(W().Z,{...e,title:(0,B.jsx)(p()._H,{defaultMessage:"Decimal places",id:"database.viewSettings.numberOptions.numberPrecision"}),selectedKey:t,options:f,onChange:y})})}function $(e,t){switch(t){case"precision_uncapped":return e.formatMessage({id:"collection.numberFormat.precisionUncapped",defaultMessage:"Default"});case"precision_0":return e.formatMessage({id:"collection.numberFormat.precision0",defaultMessage:"0"});case"precision_1":return e.formatMessage({id:"collection.numberFormat.precision1",defaultMessage:"1"});case"precision_2":return e.formatMessage({id:"collection.numberFormat.precision2",defaultMessage:"2"});case"precision_3":return e.formatMessage({id:"collection.numberFormat.precision3",defaultMessage:"3"});case"precision_4":return e.formatMessage({id:"collection.numberFormat.precision4",defaultMessage:"4"});case"precision_5":return e.formatMessage({id:"collection.numberFormat.precision5",defaultMessage:"5"});default:(0,m().t1)(t)}}function Q(e){const{property:t,propertySchema:o,numberFormat:a}=e,{show_as:s}=o,c=(0,i().O7)(),u=(0,l().Fg)(),m=(0,L().Y$)(),b=(0,n.useRef)({color:(null==s?void 0:s.color)??"green",maxValue:(null==s?void 0:s.maxValue)??100,showValue:(null==s?void 0:s.showValue)??!0}),k=(0,r().VK)((()=>E().Z.state.isOpen),[]),P={type:(null==s?void 0:s.type)??"number",color:(null==s?void 0:s.color)??b.current.color,maxValue:(null==s?void 0:s.maxValue)??b.current.maxValue,showValue:(null==s?void 0:s.showValue)??b.current.showValue},T=(0,l().yK)((e=>({card:{boxSizing:"content-box",height:36,flex:1,margin:1,boxShadow:`0 0 0 1px ${e.regularDividerColor}`,color:e.mediumTextColor,borderRadius:6,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",paddingLeft:12,paddingRight:12,paddingTop:6,paddingBottom:6,cursor:"pointer",background:k?e.cardContentBackground:void 0},cardHoveredStyle:{background:k?e.cardContentBackground:void 0},cardPressedStyle:{background:k?e.cardContentBackground:void 0},selectedCard:{boxShadow:`0 0 0 2px ${e.blueColor}`,color:e.blueColor},cardVisual:{height:20,marginBottom:4,width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},cardText:{lineHeight:1,fontSize:12},progressBar:{width:"100%"},showAsTypeOption:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginLeft:k?12:16,marginRight:16,marginTop:6,gap:12},extraOptionStyle:{display:"flex",flexDirection:"row",alignItems:"center",paddingLeft:16,paddingRight:16,gap:16,height:28,width:"100%"}})),[k]),I=(0,n.useCallback)((e=>{const n=m.collectionStore();o&&n&&(S().createAndCommit({userAction:"CollectionSettingsProperty.handleNumberShowAsChange",environment:c,canUndo:!0,perform:i=>{(0,h().x)({environment:c,collectionStore:n,update:{[t]:{...o,show_as:e}},transaction:i})}}),y().$q({environment:c,collectionContextStore:m,property:t,from:"view_settings",action:"number_change_show_as",number_show_as:(null==e?void 0:e.type)??"number"}))}),[m,c,t,o]),V=[{key:"number",visual:(0,B.jsx)("div",{style:{fontSize:16,fontWeight:f().Ue.medium},children:"42"}),text:(0,B.jsx)(p()._H,{defaultMessage:"Number",id:"database.viewSettings.numberOptions.showAsNumber"})},{key:"bar",visual:(0,B.jsx)(w().k,{percentage:50,filledColor:"bar"===P.type?u.blueColor:u.accentColors.translucentGray[500],unfilledColor:"bar"===P.type?u.accentColors.uiBlue[300]:u.accentColors.translucentGray[300],style:{width:"100%"}}),text:(0,B.jsx)(p()._H,{defaultMessage:"Bar",id:"database.viewSettings.numberOptions.showAsBar"})},{key:"ring",visual:(0,B.jsx)(j().e,{size:20,percentage:40,filledColor:"ring"===P.type?u.blueColor:u.accentColors.translucentGray[500],unfilledColor:"ring"===P.type?u.accentColors.uiBlue[300]:u.accentColors.translucentGray[300],style:{width:"100%"}}),text:(0,B.jsx)(p()._H,{defaultMessage:"Ring",id:"database.viewSettings.numberOptions.showAsRing"})}],A=(0,B.jsx)("div",{style:T.showAsTypeOption,children:V.map((e=>{const t=P.type===e.key;return(0,B.jsxs)(x().Z,{onClick:()=>{const t="number"===e.key?void 0:{type:e.key,color:P.color,maxValue:"percent"===a?1:P.maxValue,showValue:P.showValue};void 0!==t&&(b.current=t),I(t)},style:{...T.card,...t?T.selectedCard:{}},hoveredStyle:T.cardHoveredStyle,pressedStyle:T.cardPressedStyle,children:[(0,B.jsx)("div",{style:T.cardVisual,children:e.visual}),(0,B.jsx)("div",{style:T.cardText,children:e.text})]},e.key)}))}),Z=e=>{const t="number"!==P.type?{...P,type:P.type,...e}:void 0;void 0!==t&&(b.current=t),I(t)},F="number"!==P.type?(0,B.jsxs)("div",{style:T.extraOptionStyle,children:[(0,B.jsx)("div",{style:{flex:6,fontSize:14},children:(0,B.jsx)(p()._H,{defaultMessage:"Color",id:"database.viewSettings.numberOptions.color"})}),(0,B.jsx)("div",{style:{display:"flex",flexWrap:"wrap",flex:6,gap:7},children:(0,B.jsx)(v().ZP,{popupType:c.device.isMobile?v().Z4.SlideUp:v().Z4.Popup,renderOrigin:e=>(0,B.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"end"},...e,children:(0,B.jsx)(O().Z,{color:P.color,focused:!1,buttonStyle:{width:"auto",marginLeft:0,marginRight:0,borderRadius:6,color:u.lightTextColor},style:{minHeight:36},right:(0,d().i)({width:12,height:12})})}),render:e=>{const t=g().AP.map((t=>(0,B.jsx)(O().Z,{color:t,checkState:t===P.color,focused:!1,style:{width:"100%"},onClick:()=>{Z({color:t}),e.close()}},t)));return(0,B.jsx)("div",{style:{minWidth:150,paddingTop:8,paddingBottom:8},children:t})}})})]}):null,R="number"!==P.type?"percent"!==a&&(0,B.jsxs)("div",{style:T.extraOptionStyle,children:[(0,B.jsx)("div",{style:{flex:6,fontSize:14},children:(0,B.jsx)(p()._H,{defaultMessage:"Divide by",id:"database.viewSettings.numberOptions.divideBy"})}),(0,B.jsx)("div",{style:{flex:6},children:(0,B.jsx)(C().Z,{value:P.maxValue.toString(),onChange:e=>{const t=e.target.value.replace(/[^0-9]/g,""),o=parseFloat(t);!isNaN(o)&&o>0&&Z({maxValue:o})},inputStyle:{textAlign:"right"}})})]}):null,K="number"!==P.type?(0,B.jsxs)("div",{style:T.extraOptionStyle,children:[(0,B.jsx)("div",{style:{flex:6,fontSize:14},children:(0,B.jsx)(p()._H,{defaultMessage:"Show number",id:"database.viewSettings.numberOptions.showValue"})}),(0,B.jsx)("div",{style:{flex:6,display:"flex",justifyContent:"flex-end"},children:(0,B.jsx)(M().Z,{on:P.showValue,onClick:()=>{Z({showValue:!P.showValue})},disabled:!1})})]}):null,H=Boolean(F||R||K)?(0,B.jsxs)("div",{style:{backgroundColor:k?u.cardContentBackground:u.accentColors.gray[30],boxShadow:k?`0 0 0 1px ${u.regularDividerColor}`:void 0,borderRadius:5,marginTop:12,marginLeft:k?12:16,marginRight:16,paddingTop:12,paddingBottom:12,maxHeight:1e3,transition:"max-height 0.5s ease-in-out",overflow:"hidden",display:"flex",flexDirection:"column",alignItems:"center",gap:8},children:[F,R,K]}):null;return(0,B.jsxs)(_().Z,{title:(0,B.jsx)(p()._H,{defaultMessage:"Show as",id:"database.viewSettings.numberPercentOptions.showAs"}),topBorder:!0,disableMobileBorders:!0,children:[A,H,!k&&(0,B.jsx)("div",{style:{marginTop:12,marginLeft:18,marginRight:18,fontSize:12,color:u.lightTextColor},children:(0,B.jsx)(p()._H,{id:"database.CollectionSettings.NumberOptions.applyAllViews",defaultMessage:"Changes apply to all views showing this property."})})]})}},106713:(e,t,o)=>{"use strict";o.d(t,{Z:()=>d});o(667294);var n=()=>o(219727),i=()=>o(142735),r=()=>o(846550),l=()=>o(235605),a=()=>o(788860),s=()=>o(951877),c=o(785893);function d(e){const{menuProps:t,property:o,defaultProperty:r,checkState:l,propertySchema:a,collectionContextStore:d,handleDefaultPropertySelect:p,handlePropertySelect:g,...m}=e,f=((0,n().MO)(),(0,i().Kw)(d.permissionScopesStore));return(0,c.jsx)(s().N,{...t,disabled:!f.canConfigureBlock,propertySchema:a,format:s().L.Name,onClick:()=>p(o),right:(0,c.jsx)(u,{property:o,checkState:o===r,collectionContextStore:d,defaultProperty:void 0})})}function u(e){const{property:t,defaultProperty:o,checkState:s,collectionContextStore:d}=e,u=(0,n().MO)(),p=(0,i().VK)((()=>{var e;return null===(e=d.collectionStore())||void 0===e||null===(e=e.getName())||void 0===e?void 0:e.toString()}),[d]),g=(0,r().yK)((e=>({defaultText:{color:e.mediumTextColor,fontSize:12,fontWeight:500,textTransform:"uppercase",marginRight:4}})),[]);return(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("div",{style:{...g.defaultText},children:t===o&&(0,c.jsx)(a()._H,{defaultMessage:"Default",id:"database.viewSettings.setViewPropertyDefault.defaultProperty.tag",values:{databaseName:p}})}),s&&(0,c.jsx)("div",{style:{...u?{marginLeft:"auto",marginRight:20,minWidth:0,flexShrink:0}:{marginLeft:"auto",marginRight:12,minWidth:0,flexShrink:0},width:u?16:14,flexShrink:0},children:(0,l().k)()})]})}},796427:(e,t,o)=>{"use strict";o.d(t,{aA:()=>Be,V4:()=>Ae,Zj:()=>ze,$$:()=>Ke,ZP:()=>Ie});o(821057),o(267602),o(653476);var n=o(667294),i=()=>o(219727),r=()=>o(142735),l=()=>o(846550),a=()=>o(109477),s=()=>o(928374),c=()=>o(259739),d=()=>o(827282),u=o(785893);const p=(0,d().IU)("groupByHorizontal",{viewBox:"0 0 16 16",svg:(0,u.jsx)("path",{d:"M2.1416 14.4492H13.8516C15.3281 14.4492 16.0938 13.6904 16.0938 12.2344V3.9082C16.0938 2.45215 15.3281 1.69336 13.8516 1.69336H2.1416C0.665039 1.69336 -0.100586 2.44531 -0.100586 3.9082V12.2344C-0.100586 13.6904 0.665039 14.4492 2.1416 14.4492ZM2.22363 13.1094C1.58789 13.1094 1.23926 12.7812 1.23926 12.1182V4.02441C1.23926 3.36133 1.58789 3.02637 2.22363 3.02637H4.86914V13.1094H2.22363ZM6.18164 13.1094V3.02637H9.81152V13.1094H6.18164ZM13.7695 3.02637C14.3984 3.02637 14.7539 3.36133 14.7539 4.02441V12.1182C14.7539 12.7812 14.3984 13.1094 13.7695 13.1094H11.124V3.02637H13.7695Z"})}),g=(0,d().IU)("groupByVertical",{viewBox:"0 0 16 16",svg:(0,u.jsx)("path",{d:"M0.952148 1.83008H15.041C15.3691 1.83008 15.5879 1.59082 15.5879 1.24219C15.5879 0.893555 15.3691 0.647461 15.041 0.647461H0.952148C0.624023 0.647461 0.405273 0.886719 0.405273 1.24219C0.405273 1.59082 0.624023 1.83008 0.952148 1.83008ZM1.875 7.44238H3.2832C4.26758 7.44238 4.75293 6.95703 4.75293 5.94531V4.58496C4.75293 3.57324 4.26758 3.09473 3.2832 3.09473H1.875C0.890625 3.09473 0.405273 3.57324 0.405273 4.58496V5.94531C0.405273 6.95703 0.890625 7.44238 1.875 7.44238ZM7.28906 7.44238H8.69727C9.68164 7.44238 10.167 6.95703 10.167 5.94531V4.58496C10.167 3.57324 9.68164 3.09473 8.69727 3.09473H7.28906C6.30469 3.09473 5.81934 3.57324 5.81934 4.58496V5.94531C5.81934 6.95703 6.30469 7.44238 7.28906 7.44238ZM12.71 7.44238H14.1182C15.1025 7.44238 15.5879 6.95703 15.5879 5.94531V4.58496C15.5879 3.57324 15.1025 3.09473 14.1182 3.09473H12.71C11.7188 3.09473 11.2402 3.57324 11.2402 4.58496V5.94531C11.2402 6.95703 11.7188 7.44238 12.71 7.44238ZM1.88184 6.31445C1.64258 6.31445 1.52637 6.19824 1.52637 5.94531V4.57812C1.52637 4.33887 1.64258 4.21582 1.88184 4.21582H3.26953C3.50879 4.21582 3.625 4.33887 3.625 4.57812V5.94531C3.625 6.19824 3.50879 6.31445 3.26953 6.31445H1.88184ZM7.30273 6.31445C7.05664 6.31445 6.94727 6.19824 6.94727 5.94531V4.57812C6.94727 4.33887 7.05664 4.21582 7.30273 4.21582H8.69043C8.92969 4.21582 9.0459 4.33887 9.0459 4.57812V5.94531C9.0459 6.19824 8.92969 6.31445 8.69043 6.31445H7.30273ZM12.7168 6.31445C12.4775 6.31445 12.3613 6.19824 12.3613 5.94531V4.57812C12.3613 4.33887 12.4775 4.21582 12.7168 4.21582H14.1045C14.3438 4.21582 14.46 4.33887 14.46 4.57812V5.94531C14.46 6.19824 14.3438 6.31445 14.1045 6.31445H12.7168ZM0.952148 9.82812H15.041C15.3691 9.82812 15.5879 9.58887 15.5879 9.24023C15.5879 8.8916 15.3691 8.64551 15.041 8.64551H0.952148C0.624023 8.64551 0.405273 8.88477 0.405273 9.24023C0.405273 9.5957 0.624023 9.82812 0.952148 9.82812ZM1.88184 15.4404H3.29004C4.27441 15.4404 4.75977 14.9619 4.75977 13.9434V12.583C4.75977 11.5713 4.27441 11.0928 3.29004 11.0928H1.88184C0.897461 11.0928 0.412109 11.5713 0.412109 12.583V13.9434C0.412109 14.9619 0.897461 15.4404 1.88184 15.4404ZM7.2959 15.4404H8.7041C9.68848 15.4404 10.1738 14.9619 10.1738 13.9434V12.583C10.1738 11.5713 9.68848 11.0928 8.7041 11.0928H7.2959C6.31152 11.0928 5.82617 11.5713 5.82617 12.583V13.9434C5.82617 14.9619 6.31152 15.4404 7.2959 15.4404ZM12.7168 15.4404H14.1182C15.1094 15.4404 15.5879 14.9619 15.5879 13.9434V12.583C15.5879 11.5713 15.1094 11.0928 14.1182 11.0928H12.7168C11.7256 11.0928 11.2471 11.5713 11.2471 12.583V13.9434C11.2471 14.9619 11.7256 15.4404 12.7168 15.4404ZM1.88867 14.3125C1.64941 14.3125 1.5332 14.1963 1.5332 13.9502V12.583C1.5332 12.3369 1.64941 12.2139 1.88867 12.2139H3.27637C3.51562 12.2139 3.63184 12.3369 3.63184 12.583V13.9502C3.63184 14.1963 3.51562 14.3125 3.27637 14.3125H1.88867ZM7.30957 14.3125C7.06348 14.3125 6.9541 14.1963 6.9541 13.9502V12.583C6.9541 12.3369 7.06348 12.2139 7.30957 12.2139H8.69727C8.93652 12.2139 9.05273 12.3369 9.05273 12.583V13.9502C9.05273 14.1963 8.93652 14.3125 8.69727 14.3125H7.30957ZM12.7236 14.3125C12.4844 14.3125 12.3682 14.1963 12.3682 13.9502V12.583C12.3682 12.3369 12.4844 12.2139 12.7236 12.2139H14.1113C14.3506 12.2139 14.4668 12.3369 14.4668 12.583V13.9502C14.4668 14.1963 14.3506 14.3125 14.1113 14.3125H12.7236Z"})});var m=()=>o(456681),f=()=>o(447490),y=()=>o(12663),S=()=>o(168741),h=()=>o(928595),x=()=>o(788860),v=()=>o(696459),C=()=>o(707513),b=()=>o(208949),w=()=>o(250303),j=()=>o(139224),_=()=>o(140798),M=()=>o(269299),k=()=>o(915687),P=()=>o(757216),T=()=>o(535014),I=()=>o(864295),V=()=>o(67961);function A(e){const{style:t}=e,o=(0,l().Fg)(),n=(0,i().MO)(),r=(0,u.jsx)("div",{style:{marginTop:1},children:(0,T().b)({width:14,marginRight:8,height:void 0})}),a=(0,u.jsx)(V().Z,{style:{color:o.regularTextColor,lineHeight:C().Nv.UISmall.desktop},isSmall:!0,children:(0,u.jsx)(x()._H,{defaultMessage:"You're a content editor",id:"database.viewSettings.mainTab.contentOnlyEditorPill.title"})});return(0,u.jsx)(I().P,{icon:r,title:a,style:n?{backgroundColor:o.surface.wash,boxShadow:o.shadow2XS,margin:void 0,borderRadius:void 0,...t}:{background:"rgba(196, 196, 196, 0.13)",margin:"8px 14px",...t},showCloseButton:!1,children:(0,u.jsx)(V().Z,{style:{marginLeft:22},isSmall:!0,isMultiline:!0,children:(0,u.jsx)(x()._H,{defaultMessage:"Content editors can edit pages, but cannot change view and database settings.",id:"database.viewSettings.mainTab.contentOnlyEditorPill.subtitle"})})})}var Z=()=>o(727039),B=()=>o(308186),F=()=>o(388284);(0,x().vU)({learn:{id:"CollectionTaskTypeBadge.MoreMenu.LearnMore.title",defaultMessage:"Learn more"}});var R=()=>o(200528),K=()=>o(718959),H=()=>o(561933),O=()=>o(867601),L=()=>o(527278),D=()=>o(122479),E=()=>o(66417),N=()=>o(91502),U=()=>o(466970),z=()=>o(384334),W=()=>o(496291),q=()=>o(170210),G=()=>o(452404),Y=()=>o(876822),$=()=>o(810374),Q=()=>o(947961),J=()=>o(678523),X=(o(241792),()=>o(421654));const ee=function(e){let{collectionContextStore:t}=e;const n=(0,i().O7)(),l=(0,r().Kw)(t.normalizedFormatStore),s=(0,r().Kw)(t.isFullScreenStore),c=(0,r().VK)((()=>function(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}(t)),[t]),d=(0,r().VK)((()=>function(e){const t=e.normalizedFormatStore.state;return(0,a().rx)(t.inline_collection_first_load_limit,Boolean(t.collection_group_by))}(t)),[t]),p=(0,r().Kw)(t.permissionScopesStore);return l.collection_group_by||"feed"===c||!s&&"calendar"!==c?(0,u.jsx)(o(508858).Z,{title:(0,u.jsx)(x()._H,{defaultMessage:"Load limit",id:"database.viewSettings.layoutTab.firstLoadLimitSetting"}),selectedKey:d,popupStyle:{minWidth:190},options:a().jk.map((e=>({key:e,type:"button",title:(0,u.jsx)(x()._H,{defaultMessage:"{limit} pages",values:{limit:e.limit},id:"database.viewSettings.layoutTab.limitPagesTitle"})}))),onChange:e=>function(e,t,o){const n=o.collectionViewStore();if(!n)return;M().createAndCommit({userAction:"CollectionSettingsFirstLoadLimit.handleFirstLoadLimitChange",environment:t,canUndo:!0,perform:t=>{X().FH({stores:[n],update:{inline_collection_first_load_limit:e},transaction:t})}}),o.groupsStore.resetAllLimits(),w().wd({environment:t,collectionContextStore:o,action:"set_first_load_limit"})}(e,n,t),disabled:!p.canConfigureBlock,icon:o(682890).M}):null};var te=()=>o(205951),oe=()=>o(446955),ne=()=>o(691594),ie=()=>o(43143),re=()=>o(861343),le=()=>o(95886),ae=()=>o(453999);const se=function(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,i().O7)(),{collectionViewBlockStore:l,permissionScopes:a,isLinkedCollectionView:s}=(0,r().VK)((()=>{const e=t.collectionViewBlockStore();return{collectionViewBlockStore:e,permissionScopes:t.permissionScopesStore.state,isLinkedCollectionView:null==e?void 0:e.isLinkedCollectionView()}}),[t]),c=(0,r().VK)((()=>a.canConfigureBlock),[a.canConfigureBlock]),d=(0,r().VK)((()=>1===(null==l?void 0:l.getCollectionViewIds().length)),[l]);if(!l||!c)return null;const p=s&&d?(0,u.jsx)(x()._H,{defaultMessage:"Delete view",id:"database.viewSettings.mainTab.deleteLinkedDatabaseWithOneViewButton.title"}):s?(0,u.jsx)(x()._H,{defaultMessage:"Delete all views",id:"database.viewSettings.mainTab.deleteLinkedDatabaseWithMultipleViewsButton.title"}):(0,u.jsx)(x()._H,{defaultMessage:"Delete database",id:"database.viewSettings.mainTab.deleteDatabaseButton.title"});return(0,u.jsx)(oe().Z,{icon:le().y,title:p,isRed:!0,onClick:()=>function(e,t,o){var n;const i=t.collectionViewBlockStore();if(!i)return;const r=i.isLinkedCollectionView();w().wd({environment:e,collectionContextStore:t,action:"click_delete_database",original_view_type:null===(n=t.collectionViewStore())||void 0===n?void 0:n.getType()}),B().vC({showCancel:!0,keepFocus:!1,message:r?(0,u.jsx)(x()._H,{defaultMessage:"Are you sure you want to delete this linked view?",id:"database.viewSettings.mainTab.deleteLinkedDatabaseConfirm.text"}):(0,u.jsx)(x()._H,{defaultMessage:"Are you sure you want to delete this database?",id:"database.viewSettings.mainTab.deleteDatabaseConfirm.text"}),items:[{label:(0,u.jsx)(x()._H,{defaultMessage:"Delete",id:"database.viewSettings.deleteDatabaseButton.text"}),color:"red",onAccept:async()=>{await ae().Qw({environment:e,blocks:[i],shouldCheckSuggestEdit:!0})}}]})}(n,t)})};var ce=()=>o(812531),de=()=>o(543020),ue=()=>o(307190),pe=(o(492176),o(7961),()=>o(887860)),ge=()=>o(159732),me=()=>o(766537),fe=()=>o(210349),ye=()=>o(148126),Se=()=>o(162178),he=()=>o(274860),xe=()=>o(385337),ve=()=>o(815277),Ce=()=>o(576447),be=()=>o(994953);function we(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,n=(0,r().VK)((()=>t.collectionViewStore()),[t]),i=(0,r().VK)((()=>{if(!n)throw new Error("No CollectionViewStore found");return n.getFormBlockStore()}),[n]),l=(0,r().VK)((()=>{const e=t.collectionViewBlockStore();return!!e&&e.getCollectionViewIds().length>1}),[t]);return n&&i?(0,u.jsxs)(be().O,{children:[(0,u.jsxs)(F().Z,{children:[(0,u.jsx)(je,{}),(0,u.jsx)(Be,{collectionSettingsStore:o,collectionContextStore:t}),(0,u.jsx)(_e,{collectionSettingsStore:o})]}),(0,u.jsxs)(F().Z,{topBorder:!0,children:[l&&(0,u.jsx)(Me,{collectionSettingsStore:o,collectionContextStore:t,collectionViewStore:n,formBlockStore:i}),(0,u.jsx)(ke,{})]})]}):null}function je(){const{layoutStore:e,canEditLayout:t}=(0,Se().J9)(),o=(0,r().VK)((()=>{var t;const o=e.getModules().form_layout_schema;if(e.isReady()&&0===o.length)throw new Error("No modules found in form_layout_schema");const n=o.filter((e=>(0,fe().s)(e)));if(0===n.length){var i;if(0===o.filter((e=>(0,me().VC)("form_layout_schema",e))).length)throw new Error("Expected at least one non-configurable header module in form_layout_schema");return null===(i=o.at(-1))||void 0===i?void 0:i.id}return null===(t=n.at(-1))||void 0===t?void 0:t.id}),[e]),n=(0,he().G)({area:"form_layout_schema",afterModuleId:o});return(0,u.jsx)(oe().Z,{icon:ge().R,title:(0,u.jsx)(x()._H,{id:"formEditSettings.newQuestion.title",defaultMessage:"New question"}),onClick:n,disabled:!t})}function _e(e){let{collectionSettingsStore:t}=e;const{userId:o,spaceId:n}=(0,r().VK)((()=>{var e,t;return{userId:null===(e=Y().default.state.currentUserStore)||void 0===e?void 0:e.id,spaceId:null===(t=Y().default.state.currentSpaceStore)||void 0===t?void 0:t.id}}),[]),i=(0,ve().oo)({name:"form_customization",spaceId:n,userId:o}),l="upsell"===(null==i?void 0:i.type)&&i.upsell;return(0,u.jsx)(oe().Z,{onClick:()=>{j().H4({collectionSettingsStore:t,item:{type:"formCustomizeSettings"}})},icon:pe().a,title:(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",height:20},children:[(0,u.jsx)(x()._H,{defaultMessage:"Customize form",id:"formEditSettings.customizeForm.title"}),l&&(0,u.jsx)(xe().R,{upsell:i.upsell,analyticsName:"forms_customize_settings",desktopStyle:{marginLeft:5}})]}),showChevron:!0})}function Me(e){let{collectionContextStore:t,collectionSettingsStore:o,collectionViewStore:r,formBlockStore:l}=e;const{canEditLayout:a}=(0,Se().J9)(),s=(0,i().O7)(),c=(0,n.useCallback)((async()=>{await j().TT({environment:s,collectionContextStore:t,collectionViewStore:r,collectionSettingsStore:o,additionalBlocksToDelete:[l],from:"view_settings"})}),[s,t,r,o,l]);return(0,u.jsx)(oe().Z,{icon:le().y,title:(0,u.jsx)(x()._H,{id:"formEditSettings.deleteForm.title",defaultMessage:"Delete form"}),onClick:c,disabled:!a})}function ke(){return(0,u.jsx)(Ce().Z,{title:(0,u.jsx)(x()._H,{defaultMessage:"Learn about forms",id:"formEditSettings.learnAboutForms.title"}),href:(0,ye().UY)("guides.forms"),analyticsFrom:"form_edit_settings"})}var Pe=()=>o(291308);const Te=o(263184).default.createClass(!1,{name:"ShowViewDescriptionStore"});const Ie=function(e){const{collectionContextStore:t,collectionViewStore:l,selectViewNameInitial:a,collectionSettingsStore:s}=e,c=(0,i().O7)(),d=(0,r().qz)(void 0,Te),p=(0,r().VK)((()=>t.isInHomeWidgetStore.state),[t]),g=(0,r().VK)((()=>{var e;const o=null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.id;return!!o&&(0,K().qG)(o)}),[t]),m=(0,n.useCallback)((e=>function(e,t,o,n){const i=null==n?void 0:n.getFormat().description;if(!n||e===i)return;M().createAndCommit({userAction:"CollectionSettingsViewMain.handleDescriptionChange",environment:t,canUndo:!0,perform:t=>{(0,P().i)({collectionViewStore:n,update:{format:{...n.getFormat(),description:e}},transaction:t})}}),w().wd({environment:t,collectionContextStore:o,action:"set_description"})}(e,c,t,l)),[c,t,l]),f=(0,r().VK)((()=>t.collectionViewBlockStore()),[t]),y=(0,r().VK)((()=>l.isDefined()),[l]),{description:S}=(0,r().VK)((()=>l.getFormat()),[l]),h=(0,r().VK)((()=>l.getType()),[l]),v=(0,r().Kw)(d),C=(0,r().VK)((()=>"viewsMain"===t.viewsModuleContextStore.getViewModuleType()),[t]);if(!y||!f)return null;const b=(0,u.jsx)(o(498922).Z,{collectionViewStore:l,collectionContextStore:t,showViewDescriptionStore:d,selectViewNameInitial:a});if("page"===h)return(0,u.jsxs)(te().ZP,{...e,title:(0,u.jsx)(x()._H,{defaultMessage:"View options",id:"database.viewSettings.mainTab.title"}),children:[b,v&&(0,u.jsx)(J().i,{initialDescription:S,handleSaveDescription:m})]});let j;if("chart"===h)j=(0,u.jsx)(Ne,{collectionContextStore:t,collectionSettingsStore:s});else if("form_editor"===h)j=(0,u.jsx)(we,{collectionContextStore:t,collectionSettingsStore:s});else{if(p)return(0,u.jsx)(We,{collectionContextStore:t,collectionSettingsStore:s,viewNameInput:b});j=(0,u.jsx)(Ue,{collectionContextStore:t,collectionSettingsStore:s,isMyTasks:g,isConfiguringViewsMainModule:C})}return(0,u.jsxs)(te().ZP,{...e,title:"form_editor"===h?(0,u.jsx)(x()._H,{defaultMessage:"Form options",id:"database.viewSettings.formTab.title"}):(0,u.jsx)(x()._H,{defaultMessage:"View options",id:"database.viewSettings.mainTab.title"}),children:[(0,u.jsx)(Ae,{collectionContextStore:t}),b,v&&(0,u.jsx)(J().i,{initialDescription:S,handleSaveDescription:m}),j]})};function Ve(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}function Ae(e){let{collectionContextStore:t}=e;return(0,r().VK)((()=>{const e=t.collectionViewBlockStore();return e&&"content_only_editor"!==e.getRole()}),[t])?null:(0,u.jsx)(A,{})}function Ze(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;const n=(0,r().Kw)(o.currentSubitemFormatStoreForCollectionStore),i=(0,r().VK)((()=>o.databaseType),[o]),l=(0,r().VK)((()=>(0,$().Xy)({feature:"subitem",collectionContextStore:o})),[o]),a=(0,r().VK)((()=>function(e,t){const o=t.permissionScopesStore.state,n=(0,v().$K)(e),i=o.canConfigureBlock;return n||i}(n,o)),[o,n]),s=(0,r().VK)((()=>function(e){let t;return t=e?E().dH.relationFeatureOnMessage:E().dH.relationFeatureOffMessage,L().Z.formatMessage(t)}(l)),[l]);return(0,u.jsx)(oe().Z,{icon:f().Y,title:(0,u.jsx)(x()._H,{...(0,E().Gt)({feature:"subitem",databaseType:i})}),showChevron:!0,right:s,onClick:()=>{j().H4({collectionSettingsStore:t,item:{type:"subitemV2",from:"view_options"}})},disabled:!a})}function Be(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,i().O7)(),l=(0,r().VK)((()=>(0,O().cB)(t)),[t]),a=(0,r().Kw)(t.aliveAutomationCountStore),c=(0,r().VK)((()=>(0,O().Li)({collectionStore:t.collectionStore()})),[t]);return l?(0,u.jsx)(oe().Z,{icon:s().M,onClick:()=>{const e=b().X(o);!c||a>0?j().H4({collectionSettingsStore:o,item:{source:"collection_view_settings",type:"automationSettings",from:e}}):k().b({environment:n,mode:"create_automation",collectionContextStore:t,collectionSettingsStore:o,from:e})},right:a>0?a:(0,u.jsx)(x()._H,{id:"database.viewSettings.mainTab.automations.none",defaultMessage:"None"}),showChevron:!0,title:(0,u.jsx)(x()._H,{defaultMessage:"Automations",id:"database.viewSettings.mainTab.automations.title"})}):null}function Fe(e){const{collectionContextStore:t,collectionSettingsStore:o,disabled:n=!1}=e,l=(0,i().O7)(),a=(0,r().VK)((()=>Ve(t)),[t]),s="board"===a?{groupByKey:"board_columns_by",groupsFormatKey:"board_columns"}:{groupByKey:"collection_group_by",groupsFormatKey:"collection_groups"},c=(0,r().Kw)(t.normalizedSchemaStore),d=(0,r().Kw)(t.normalizedFormatStore)[s.groupByKey],m=(0,r().Kw)(t.permissionScopesStore);return"calendar"!==a?(0,u.jsx)(oe().Z,{icon:"board"===a?p:g,title:(0,u.jsx)(x()._H,{defaultMessage:"Group",id:"database.viewSettings.mainTab.groupButton.title"}),showChevron:!0,right:(0,ne().bc)(d?c[d.property]:void 0),onClick:()=>{var e;w().wd({environment:l,collectionContextStore:t,action:"click_group",original_view_type:a,property_type:d?null===(e=c[d.property])||void 0===e?void 0:e.type:void 0}),t.isLoadingStore.state||t.loadingDetailsStore.setState({type:"load_groups_menu"}),j().H4({collectionSettingsStore:o,item:d?{type:"group",...s}:{type:"groupByProperty",...s}})},disabled:n||!d&&!m.canConfigureBlock}):null}function Re(e){const{collectionContextStore:t,collectionSettingsStore:o,disabled:n=!1}=e,l=(0,i().O7)(),a=(0,r().VK)((()=>Ve(t)),[t]),s=(0,r().Kw)(t.normalizedSchemaStore),c=(0,r().Kw)(t.normalizedFormatStore).collection_group_by,d={groupByKey:"collection_group_by",groupsFormatKey:"collection_groups"},p=(0,r().Kw)(t.permissionScopesStore);return"board"===a?(0,u.jsx)(oe().Z,{icon:g,title:(0,u.jsx)(x()._H,{defaultMessage:"Sub-group",id:"database.viewSettings.mainTab.subGroupButton.title"}),showChevron:!0,right:(0,ne().bc)(c?s[c.property]:void 0),onClick:()=>{var e;w().wd({environment:l,collectionContextStore:t,action:"click_subgroup",original_view_type:a,property_type:c?null===(e=s[c.property])||void 0===e?void 0:e.type:void 0}),t.isLoadingStore.state||t.loadingDetailsStore.setState({type:"load_groups_menu"}),j().H4({collectionSettingsStore:o,item:c?{type:"group",...d}:{type:"groupByProperty",...d}})},disabled:n||!c&&!p.canConfigureBlock}):null}function Ke(e){const{collectionContextStore:t,collectionSettingsStore:o,disabled:n=!1}=e,l=(0,i().O7)(),a=(0,i().MO)(),s=(0,r().VK)((()=>t.collectionViewStore()),[t]),c=(0,r().VK)((()=>null==s?void 0:s.getType()),[s]);return s&&c?(0,u.jsx)(oe().Z,{disabled:n,icon:H().aW[c],iconStyle:{width:24,height:a?18:16},isPadded:!0,title:(0,u.jsx)(x()._H,{defaultMessage:"Layout",id:"database.viewSettings.mainTab.layoutButton.title"}),showChevron:!0,right:H().Bh[c],onClick:()=>{w().wd({environment:l,collectionContextStore:t,action:"click_layout"}),j().H4({collectionSettingsStore:o,item:{type:"layout"}})}}):null}function He(e){const{collectionContextStore:t,collectionSettingsStore:o,disabled:n=!1}=e,l=(0,i().O7)(),s=(0,r().Kw)(t.normalizedFormatStore),c=(0,r().VK)((()=>Ve(t)),[t]),d=(0,r().VK)((()=>(0,a().oz)(c)),[c]);if("chart"===c||"form_editor"===c)return(0,u.jsx)(u.Fragment,{});const p=((d?s[d]:void 0)||[]).filter((e=>Boolean(e.visible))).length;return(0,u.jsx)(oe().Z,{icon:y().N,disabled:n,title:(0,u.jsx)(x()._H,{defaultMessage:"Properties",id:"database.viewSettings.mainTab.propertiesButton.title"}),showChevron:!0,right:(0,u.jsx)(x()._H,{defaultMessage:"{propertiesShown} shown",id:"database.viewSettings.mainTab.propertiesButton.propertiesShown.title",values:{propertiesShown:p}}),onClick:()=>{w().wd({environment:l,collectionContextStore:t,action:"click_properties"}),j().H4({collectionSettingsStore:o,item:{type:"properties",timelineViewTab:"timeline"}})}})}function Oe(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,i().O7)(),l=(0,r().VK)((()=>t.currentSortsStore.state.length),[t]);return(0,u.jsx)(oe().Z,{icon:h().j,isPadded:!0,title:(0,u.jsx)(x()._H,{defaultMessage:"Sort",id:"database.viewSettings.mainTab.sortButton.title"}),showChevron:!0,right:l>0?(0,u.jsx)(x()._H,{defaultMessage:"{numberOfSorts, plural, one {{numberOfSorts} sort} other {{numberOfSorts} sorts}}",values:{numberOfSorts:l},id:"database.viewSettings.mainTab.sortButton.oneOrMoreSorts.title"}):(0,u.jsx)(x()._H,{defaultMessage:"None",id:"database.viewSettings.mainTab.sortButton.noSorts.title"}),onClick:()=>{w().wd({environment:n,collectionContextStore:t,action:"click_sort"}),0===l?j().H4({collectionSettingsStore:o,item:{type:"createSort"}}):j().H4({collectionSettingsStore:o,item:{type:"sort"}})}})}function Le(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,r().Kw)(t.permissionScopesStore),i=(0,r().VK)((()=>t.collectionStore()),[t]),l=(0,r().VK)((()=>null==i?void 0:i.isSyncedCollection()),[i]),a=(0,r().VK)((()=>t.contextType),[t]);return(0,r().VK)((()=>n.canConfigureCollection),[n])||l||"collectionTypedView"===a?null:(0,u.jsx)(Ze,{collectionSettingsStore:o,collectionContextStore:t})}function De(e){const t=(0,i().O7)(),o=(0,r().VK)((()=>{const e=Y().default.state.mainEditorCurrentBlockStore;return Boolean(e&&(0,K().qG)(e.id))}),[]),n=(0,r().VK)((()=>{if(!(0,N().QI)())return!1;const t=e.collectionContextStore.collectionViewBlockStore();return!(!t||!(0,K().qG)(t.id))}),[e.collectionContextStore]),a=(0,l().yK)((e=>({icon:Ee(e).iconStyles,title:Ee(e).menuItemStyles})),[]);if(!n)return null;const s=o?"home_tasks":"home_tile_tasks";return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Z().CollectionTasksEmptyStateModal,{from:s}),(0,u.jsx)(oe().Z,{showChevron:!1,icon:m().m,iconStyle:a.icon,title:(0,u.jsx)(x()._H,{defaultMessage:"Don't see your tasks?",id:"tasksEmptyState.noDatabases.title"}),textWrapperStyle:a.title,onClick:()=>{G().Z.setState(!0),(0,z().Aq)({environment:t,from:s})}})]})}function Ee(e){const t=(0,q().$K)(e);return{menuItemStyles:{color:t.text},iconStyles:{width:16,marginLeft:4,marginRight:2,fill:t.icon}}}function Ne(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;return(0,u.jsx)(u.Fragment,{children:(0,u.jsx)(Q()._,{collectionSettingsStore:o})})}function Ue(e){let{collectionContextStore:t,collectionSettingsStore:o,isMyTasks:n,isConfiguringViewsMainModule:r}=e;const l=(0,i().O7)(),{device:a}=l,s=(0,U().E)("delete_database_from_view_settings");return(0,u.jsxs)(u.Fragment,{children:[a.isMobile?(0,u.jsxs)(F().Z,{topBorder:!0,children:[(0,u.jsx)(ue().Z,{collectionContextStore:t,collectionSettingsStore:o,disabled:r}),(0,u.jsx)(Ke,{collectionContextStore:t,collectionSettingsStore:o}),(0,u.jsx)(He,{collectionContextStore:t,collectionSettingsStore:o}),(0,u.jsx)(de().Z,{collectionContextStore:t,collectionSettingsStore:o}),(0,u.jsx)(Oe,{collectionContextStore:t,collectionSettingsStore:o}),(0,u.jsx)(Fe,{collectionContextStore:t,collectionSettingsStore:o}),(0,u.jsx)(Re,{collectionContextStore:t,collectionSettingsStore:o}),(0,u.jsx)(Le,{collectionContextStore:t,collectionSettingsStore:o}),(0,u.jsx)(Be,{collectionContextStore:t,collectionSettingsStore:o}),(0,u.jsx)(ee,{collectionContextStore:t})]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(F().Z,{children:[(0,u.jsx)(ue().Z,{collectionContextStore:t,collectionSettingsStore:o,disabled:r}),(0,u.jsx)(Ke,{collectionContextStore:t,collectionSettingsStore:o})]}),(0,u.jsxs)(F().Z,{topBorder:!0,children:[(0,u.jsx)(He,{collectionContextStore:t,collectionSettingsStore:o}),(0,u.jsx)(de().Z,{collectionContextStore:t,collectionSettingsStore:o}),(0,u.jsx)(Oe,{collectionContextStore:t,collectionSettingsStore:o}),(0,u.jsx)(Fe,{collectionContextStore:t,collectionSettingsStore:o}),(0,u.jsx)(Re,{collectionContextStore:t,collectionSettingsStore:o}),(0,u.jsx)(Le,{collectionContextStore:t,collectionSettingsStore:o}),(0,u.jsx)(Be,{collectionContextStore:t,collectionSettingsStore:o}),(0,u.jsx)(ee,{collectionContextStore:t})]})]}),(0,u.jsx)(ze,{collectionContextStore:t,collectionSettingsStore:o}),(0,u.jsxs)(F().Z,{topBorder:!0,children:[(0,u.jsx)(Pe().Z,{collectionContextStore:t}),(0,u.jsx)(ie().Z,{collectionContextStore:t}),(0,u.jsx)(ce().Z,{collectionContextStore:t,collectionSettingsStore:o}),(0,u.jsx)(re().Z,{collectionContextStore:t,collectionSettingsStore:o}),n&&(0,u.jsx)(De,{collectionContextStore:t}),s&&(0,u.jsx)(se,{collectionContextStore:t,collectionSettingsStore:o})]})]})}function ze(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,i().MO)(),a=(0,R().UL)(t),s=(0,l().yK)((e=>({icon:{marginTop:2,width:16,marginLeft:4,marginRight:n?void 0:2},title:{display:"flex",alignItems:"center"}})),[n]),c=(0,r().VK)((()=>void 0!==t.viewsModuleContextStore.state),[t]),d=(0,r().VK)((()=>{const e=t.permissionScopesStore.state;if(!(e.canConfigureCollection||e.canConfigureBlock))return!0;const o=t.collectionStore();return!o||((0,D().EY)(o)||(0,D().Aw)(o))}),[t]);return c?null:(0,u.jsx)(F().Z,{topBorder:!0,children:(0,u.jsx)(oe().Z,{icon:()=>(0,S().H)(s.icon),title:(0,u.jsx)("div",{style:s.title,children:(0,u.jsx)("div",{style:C().Yu,children:(0,u.jsx)(x()._H,{defaultMessage:"Customize {databaseName}",id:"database.viewSettings.mainTab.customizeButton.title",values:{databaseName:a}})})}),caption:(0,u.jsx)("div",{children:(0,u.jsx)(x()._H,{defaultMessage:"Change settings, add new features",id:"database.viewSettings.mainTab.customizeButton.caption"})}),shouldWrapCaption:!0,showChevron:!0,onClick:()=>{j().H4({collectionSettingsStore:o,item:{type:"customize"}})},disabled:d})})}function We(e){let{collectionContextStore:t,collectionSettingsStore:o,viewNameInput:n}=e;const a=(0,i().O7)(),s=(0,x().YB)(),d=(0,l().yK)((()=>({container:{minWidth:te().P4},nameInput:{paddingBottom:0}})),[]),p=(0,r().VK)((()=>{var e;const o=null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.id;return!!o&&(0,K().qG)(o)}),[t]),g=(0,r().VK)((()=>p?{feature:"tasks",from:"tasks_more_menu"}:{feature:"custom_db",from:"custom_db_more_menu"}),[p]);return(0,u.jsxs)("div",{style:d.container,children:[(0,u.jsx)(F().Z,{style:d.nameInput,children:n}),(0,u.jsx)(F().Z,{children:(0,u.jsx)(Ke,{collectionContextStore:t,collectionSettingsStore:o})}),(0,u.jsxs)(F().Z,{topBorder:!0,children:[(0,u.jsx)(He,{collectionContextStore:t,collectionSettingsStore:o}),(0,u.jsx)(de().Z,{collectionContextStore:t,collectionSettingsStore:o}),(0,u.jsx)(Oe,{collectionContextStore:t,collectionSettingsStore:o}),(0,u.jsx)(Fe,{collectionContextStore:t,collectionSettingsStore:o}),(0,u.jsx)(Re,{collectionContextStore:t,collectionSettingsStore:o})]}),(0,u.jsxs)(F().Z,{topBorder:!0,children:[!p&&(0,u.jsx)(ue().Z,{collectionContextStore:t,collectionSettingsStore:o}),!p&&(0,u.jsx)(re().Z,{collectionContextStore:t,collectionSettingsStore:o}),(0,u.jsx)(oe().Z,{icon:c().D,isPadded:!0,title:s.formatMessage(W().Iu.hide),showChevron:!1,onClick:()=>{Y().default.state.currentSpaceViewStore&&_().aG({environment:a,currentSpaceViewStore:Y().default.state.currentSpaceViewStore,...g})}}),p&&(0,u.jsx)(De,{collectionContextStore:t})]})]})}},43143:(e,t,o)=>{"use strict";o.d(t,{Z:()=>a});o(667294);var n=()=>o(788860),i=()=>o(250303),r=()=>o(139224),l=o(785893);const a=function(e){let{collectionContextStore:t}=e;const a=(0,o(219727).O7)(),{viewName:s,viewType:c,isViewsModule:d}=(0,o(142735).VK)((()=>{var e,o;return{viewType:null===(e=t.collectionViewStore())||void 0===e?void 0:e.getType(),viewName:null===(o=t.collectionViewStore())||void 0===o?void 0:o.getName(),isViewsModule:Boolean(t.viewsModuleContextStore.state)}}),[t]);if(!c||d)return null;let u=(0,l.jsx)(n()._H,{defaultMessage:"Copy link to view",id:"database.viewSettings.mainTab.copyLinkButton.title"});return"chart"===c?u=(0,l.jsx)(n()._H,{defaultMessage:"Copy link to chart",id:"database.viewSettings.mainTab.copyLinkButton.title.chart"}):s&&(u=(0,l.jsx)(n()._H,{defaultMessage:"Copy link to {viewName}",id:"database.viewSettings.mainTab.copyLinkButton.title.viewName",values:{viewName:s}})),(0,l.jsx)(o(446955).Z,{icon:o(237874).N,title:u,onClick:()=>function(e,t){const o=t.collectionViewStore();o&&(r().Ol({environment:e,collectionContextStore:t,collectionViewStore:o}),i().wd({environment:e,collectionContextStore:t,action:"click_copy_link",original_view_type:o.getType()}))}(a,t)})}},861343:(e,t,o)=>{"use strict";o.d(t,{Z:()=>s});o(667294);var n=()=>o(142735),i=()=>o(788860),r=()=>o(250303),l=()=>o(139224),a=o(785893);const s=function(e){let{collectionContextStore:t,collectionSettingsStore:s}=e;const c=(0,o(219727).O7)(),{collectionViewBlockStore:d,permissionScopes:u,viewType:p,viewName:g}=(0,n().VK)((()=>{var e,o;return{collectionViewBlockStore:t.collectionViewBlockStore(),permissionScopes:t.permissionScopesStore.state,viewType:null===(e=t.collectionViewStore())||void 0===e?void 0:e.getType(),viewName:null===(o=t.collectionViewStore())||void 0===o?void 0:o.getName()}}),[t]),m=(0,n().VK)((()=>{const e=1===(null==d?void 0:d.getCollectionViewIds().length),o=t.isEditableHomeCollectionStore.state;return!u.canConfigureBlock||"collectionTypedView"===t.contextType||e&&!o}),[t,d,u.canConfigureBlock]);if(!d||m||!p)return null;let f=(0,a.jsx)(i()._H,{defaultMessage:"Delete view",id:"database.viewSettings.mainTab.deleteTheOnlyViewButton.title"});return"chart"===p?f=(0,a.jsx)(i()._H,{defaultMessage:"Delete chart",id:"database.viewSettings.mainTab.deleteButton.title.chart"}):g&&(f=(0,a.jsx)(i()._H,{defaultMessage:"Delete {viewName}",id:"database.viewSettings.mainTab.deleteButton.title.viewName",values:{viewName:g}})),(0,a.jsx)(o(446955).Z,{icon:o(95886).y,title:f,isRed:!0,onClick:()=>function(e,t,o){const n=t.collectionViewStore();n&&(l().TT({environment:e,collectionContextStore:t,collectionViewStore:n,collectionSettingsStore:o,from:"view_settings"}),r().wd({environment:e,collectionContextStore:t,action:"click_delete",original_view_type:n.getType()}))}(c,t,s)})}},812531:(e,t,o)=>{"use strict";o.d(t,{Z:()=>s});o(667294);var n=()=>o(142735),i=()=>o(788860),r=()=>o(250303),l=()=>o(139224),a=o(785893);const s=function(e){let{collectionContextStore:t,collectionSettingsStore:s}=e;const c=(0,o(219727).O7)(),d=(0,i().YB)(),u=(0,n().Kw)(t.permissionScopesStore),p=(0,n().VK)((()=>!u.canConfigureBlock||"collectionTypedView"===t.contextType),[t,u]),{viewName:g,viewType:m}=(0,n().VK)((()=>{var e,o;return{viewName:null===(e=t.collectionViewStore())||void 0===e?void 0:e.getName(),viewType:null===(o=t.collectionViewStore())||void 0===o?void 0:o.getType()}}),[t]);if(p||!m)return null;let f=(0,a.jsx)(i()._H,{defaultMessage:"Duplicate view",id:"database.viewSettings.mainTab.duplicateButton.title"});return"chart"===m?f=(0,a.jsx)(i()._H,{defaultMessage:"Duplicate chart",id:"database.viewSettings.mainTab.duplicateButton.title.chart"}):g&&(f=(0,a.jsx)(i()._H,{defaultMessage:"Duplicate {viewName}",id:"database.viewSettings.mainTab.duplicateButton.title.viewName",values:{viewName:g}})),(0,a.jsx)(o(446955).Z,{icon:o(44037).a,title:f,onClick:()=>function(e,t,o,n){const i=t.collectionViewStore();i&&(l().zt({environment:e,collectionContextStore:t,collectionViewStore:i,collectionSettingsStore:o,intl:n,from:"view_settings_duplicate"}),r().wd({environment:e,collectionContextStore:t,action:"click_duplicate",original_view_type:i.getType()}))}(c,t,s,d)})}},543020:(e,t,o)=>{"use strict";o.d(t,{Z:()=>a});o(667294);var n=()=>o(142735),i=()=>o(788860),r=()=>o(139224),l=o(785893);const a=function(e){let{collectionContextStore:t,collectionSettingsStore:a,disabled:s}=e;const c=(0,o(219727).O7)(),d=(0,n().Kw)(t.permissionScopesStore),u=(0,n().VK)((()=>t.currentPropertyFiltersStore.state.length+(t.currentCombinatorFilterStore.state&&d.canConfigureBlock?1:0)),[t,d]);return(0,l.jsx)(o(446955).Z,{disabled:s,icon:o(185056).Q,title:(0,l.jsx)(i()._H,{defaultMessage:"Filter",id:"database.viewSettings.mainTab.filterButton.title"}),showChevron:!0,right:u>0?(0,l.jsx)(i()._H,{defaultMessage:"{numberOfFilters, plural, one {{numberOfFilters} filter} other {{numberOfFilters} filters}}",values:{numberOfFilters:u},id:"database.viewSettings.mainTab.filterButton.filters.title"}):(0,l.jsx)(i()._H,{defaultMessage:"None",id:"database.viewSettings.mainTab.filterButton.noFilters.title"}),onClick:()=>{o(250303).wd({environment:c,collectionContextStore:t,action:"click_filters"}),0===u?r().H4({collectionSettingsStore:a,item:{type:"createFilter"}}):r().H4({collectionSettingsStore:a,item:{type:"filters"}})}})}},498922:(e,t,o)=>{"use strict";o.d(t,{L:()=>y,Z:()=>h});o(667294);var n=()=>o(219727),i=()=>o(142735),r=()=>o(714230),l=()=>o(955620),a=()=>o(788860),s=()=>o(250303),c=()=>o(421654),d=()=>o(970105),u=()=>o(269299),p=()=>o(757216),g=()=>o(210900),m=()=>o(718959),f=o(785893);const y=(0,a().vU)({viewNamePlaceholderMessage:{defaultMessage:"View name",id:"database.viewSettings.mainTab.viewNamePlaceholder.title"},formNamePlaceholderMessage:{defaultMessage:"Form name",id:"database.viewSettings.mainTab.formNamePlaceholder.title"},addDescriptionTooltip:{defaultMessage:"Add view description",id:"database.viewSettings.mainTab.addDescriptionTooltip.title"},editDescriptionTooltip:{defaultMessage:"Edit view description",id:"database.viewSettings.mainTab.editDescriptionTooltip.title"}});function S(e,t,o){const n=o.collectionViewBlockStore(),i=o.collectionViewStore();if(!n||!i||!i.isDefined())return;const r=(0,m().qG)(n.id);i.getName()!==e&&u().createAndCommit({userAction:"CollectionSettingsViewMain.handleViewNameSubmit",environment:t,canUndo:!0,perform:t=>{if((0,p().i)({collectionViewStore:i,update:{name:e},transaction:t}),r){const o=(0,l().TPx)(e);d().sO({environment:n.environment,store:n.getBlockTitleStore(),value:o,transaction:t})}}}),s().wd({environment:t,collectionContextStore:o,action:"rename",original_view_type:i.getType()})}const h=function(e){const{collectionViewStore:t,collectionContextStore:l,selectViewNameInitial:d,showViewDescriptionStore:p}=e,h=(0,n().O7)(),x=(0,a().YB)(),v=(0,o(846550).Fg)(),C=(0,n().Fy)(),b=(0,i().VK)((()=>t.getType()),[t]),w=(0,i().VK)((()=>t.getName()),[t]),{description:j,collection_view_icon:_}=(0,i().VK)((()=>t.getFormat()),[t]),M=(0,i().Kw)(p),k=(0,i().Kw)(l.permissionScopesStore),P=(0,i().Kw)(l.isEditableHomeCollectionStore),T=(0,i().VK)((()=>t.getAppConfigUri()),[t]),I=!T||(0,o(110232).R8)(T);return(0,f.jsx)(o(388284).Z,{title:C.isMobile&&(0,f.jsx)(a()._H,{defaultMessage:"View name",id:"database.viewSettings.mainTab.viewNameSection.title"}),children:(0,f.jsx)(o(96868).I,{initialValue:w||"",placeholder:x.formatMessage("form_editor"===b?y.formNamePlaceholderMessage:y.viewNamePlaceholderMessage),onBlur:e=>S(e,h,l),onSubmit:e=>S(e,h,l),focusInitial:d,selectAll:d,disabled:!k.canConfigureBlock||!I,iconButton:{icon:e=>(0,f.jsx)(o(716025).F,{color:"gray",viewIcon:_,viewType:b}),iconStyle:{fill:o(890085).Lr[v.mode].gray},enforceIconColor:"gray",onSubmit:e=>function(e,t,o){const n=t.collectionViewStore(),i=t.collectionViewBlockStore();if(!i||!n||!n.isDefined())return;const l=(0,m().qG)(i.id);u().createAndCommit({userAction:"CollectionSettingsViewMain.handleViewIconSubmit",environment:e,canUndo:!0,perform:e=>{if(l){const t=o||r().Z.images.appPackages.taskDbIconSvg;(0,g().U)({collectionViewStore:n,icon:t,transaction:e}),c().FH({stores:[i],update:{page_icon:t},transaction:e})}else(0,g().U)({collectionViewStore:n,icon:o,transaction:e})}}),s().wd({environment:e,collectionContextStore:t,action:"change_icon",icon:o})}(h,l,e)},inputRightButton:P||"form_editor"===b?null:(0,f.jsx)(o(705670).l,{description:j,showTooltip:!M,onClick:()=>p.setState(!M),addDescriptionText:x.formatMessage(y.addDescriptionTooltip),editDescriptionText:x.formatMessage(y.editDescriptionTooltip),disabled:!k.canConfigureBlock})})})}},307190:(e,t,o)=>{"use strict";o.d(t,{Z:()=>C});o(267602),o(470928);var n=o(667294),i=()=>o(142735),r=()=>o(109477),l=()=>o(452024),a=()=>o(788860),s=()=>o(513670),c=()=>o(239730),d=()=>o(139224),u=()=>o(986286),p=()=>o(251932),g=()=>o(594546),m=()=>o(64509),f=()=>o(148976),y=()=>o(876822),S=()=>o(138912),h=()=>o(446955),x=o(785893);function v(e){let{environment:t,collectionStore:o,collectionSettingsStore:v,flowId:C}=e;const b=(0,i().VK)((()=>null==o?void 0:o.getFormat()),[o]),w=(0,i().VK)((()=>{var e;return!0===(null===(e=y().default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.seen_jira_sync_source_tooltip)}),[]),{bot_id:j,synced_collection_external_url:_,external_collection_type:M}=b||{},k=M?m().I[M]:"",P=(0,i().VK)((()=>Boolean(S().default.externalAuthentications.state.find((e=>e.id===j&&e.user_id===t.currentUser.id)))),[j,t]),T=(0,n.useRef)(null);return(0,i().VK)((()=>(0,f().pv)()),[])&&M===r().Vj.Jira&&b.sync_state&&!w?(0,x.jsxs)("div",{ref:T,style:{boxShadow:c().v.outlineBlueInputBoxShadow.light,borderRadius:6},children:[(0,x.jsx)(h().Z,{icon:l().v,onClick:()=>{(0,g().j)({environment:t,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:"jira",actionType:"source_option_click",flowId:C,identifier:_,botId:j,isSyncOwner:P}}}),d().H4({collectionSettingsStore:v,item:{source:"external_source",type:"externalProjectsSyncSettings"}})},right:(0,x.jsxs)(p().gq,{alignItems:"center",children:[(0,x.jsx)("img",{style:{height:12,width:12,marginRight:6},src:k,alt:"External intergration icon"}),(0,x.jsx)(a()._H,{id:"database.viewSettings.mainTab.source.sourceName",defaultMessage:"{integrationName}",values:{integrationName:(0,s().kC)(M)}})]}),showChevron:!0,title:(0,x.jsx)(a()._H,{defaultMessage:"Source",id:"database.viewSettings.mainTab.source.title"})}),(0,x.jsx)(u().Rs,{origin:T})]}):(0,x.jsx)(h().Z,{icon:l().v,onClick:()=>{(0,g().j)({environment:t,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:"jira",actionType:"source_option_click",flowId:C,identifier:_,botId:j,isSyncOwner:P}}}),d().H4({collectionSettingsStore:v,item:{source:"external_source",type:"externalProjectsSyncSettings"}})},right:(0,x.jsxs)(p().gq,{alignItems:"center",children:[(0,x.jsx)("img",{style:{height:12,width:12,marginRight:6},src:k,alt:"External intergration icon"}),(0,x.jsx)(a()._H,{id:"database.viewSettings.mainTab.source.sourceName",defaultMessage:"{integrationName}",values:{integrationName:(0,s().kC)(M)}})]}),showChevron:!0,title:(0,x.jsx)(a()._H,{defaultMessage:"Source",id:"database.viewSettings.mainTab.source.title"})})}const C=function(e){let{collectionContextStore:t,collectionSettingsStore:n,disabled:r}=e;const s=(0,o(219727).O7)(),c=(0,i().VK)((()=>t.collectionStore()),[t]),u=(0,i().VK)((()=>null==c?void 0:c.isExternalSyncedCollection()),[c]),p=(0,i().Kw)(t.permissionScopesStore),g=(0,i().VK)((()=>(0,f().K6)()),[]),m=(0,i().VK)((()=>t.collectionViewBlockStore()),[t]),y=(0,i().VK)((()=>o(308939).ZP.getFlowId()),[]),S=(0,i().VK)((()=>{const e=t.collectionStore(),o=t.collectionViewBlockStore(),n=t.collectionViewStore();if(!e||!o||!n)return!1;if(e.isSyncedCollection())return!0;if(e.isSystemCollection())return!1;return void 0===o.getCollectionViewSourceCollectionStore()}),[t]),C=(0,i().VK)((()=>null==c?void 0:c.getIcon()),[c]);return g&&u&&c&&p.canConfigureBlock?(0,x.jsx)(v,{environment:s,collectionStore:c,collectionSettingsStore:n,flowId:y}):c&&m&&S?(0,x.jsx)(h().Z,{icon:l().v,title:(0,x.jsx)(a()._H,{defaultMessage:"Source",id:"database.viewSettings.mainTab.sourceButton.title"}),showChevron:!0,right:(0,x.jsxs)(x.Fragment,{children:[C&&(0,x.jsx)(o(943620).Z,{icon:C,isEmptyPage:!1,size:20,disabled:!0,style:{marginRight:4,opacity:.6}}),(0,x.jsx)(o(384241).Z,{store:c})]}),textWrapperStyle:{flexShrink:0},rightStyle:{flexShrink:1},disabled:!p.canConfigureBlock||r,onClick:()=>{o(250303).wd({environment:s,collectionContextStore:t,action:"click_source"}),d().H4({collectionSettingsStore:n,item:{type:"source"}})}}):null}},604185:(e,t,o)=>{"use strict";o.d(t,{Z:()=>a});o(667294);var n=()=>o(788860),i=()=>o(568017),r=()=>o(67961),l=o(785893);function a(e){return(0,l.jsx)(r().Z,{isMultiline:!0,style:{paddingTop:8,marginLeft:16,marginRight:16,color:i().ZP.red,...e.styles},children:(0,l.jsx)(n()._H,{id:"database.viewSettings.propertyTab.duplicatePropertyNameError",defaultMessage:"A property named {propertyName} already exists in this database.",values:{propertyName:e.propertyName}})})}},994953:(e,t,o)=>{"use strict";o.d(t,{O:()=>s});o(667294);var n=()=>o(142735),i=()=>o(641929),r=()=>o(125659),l=()=>o(162178),a=o(785893);function s(e){const{children:t}=e,o=(0,r().Y$)(),s=(0,n().Kw)(o.formsBaseLayoutEditorContextValueStore),c=(0,n().Kw)(o.formsSpecificLayoutEditorContextValueStore);return s&&c?(0,a.jsx)(l().Dt.Provider,{value:s,children:(0,a.jsx)(i().E.Provider,{value:c,children:t})}):null}},291308:(e,t,o)=>{"use strict";o.d(t,{Z:()=>p});o(667294);var n=()=>o(219727),i=()=>o(142735),r=()=>o(535014),l=()=>o(326034),a=()=>o(250303),s=()=>o(441530),c=()=>o(347577),d=()=>o(446955),u=o(785893);function p(e){let{collectionContextStore:t}=e;const o=(0,n().O7)(),p=(0,i().VK)((()=>t.collectionViewBlockStore()),[t]),g=(0,i().VK)((()=>null==p?void 0:p.getCollectionViewSourceCollectionStore()),[p]),m=(0,i().VK)((()=>null==p?void 0:p.isLocked()),[p]),f=(0,i().VK)((()=>g?g.canEditCollection():null==p?void 0:p.canEditCollection()),[p,g]),y=(0,i().VK)((()=>null==p?void 0:p.isCollectionViewPageWithContent()),[p]),S=(0,i().VK)((()=>void 0!==t.viewsModuleContextStore.state),[t]);return p&&f&&!S?(0,u.jsx)(d().Z,{icon:m?l().U:r().b,title:(0,c().L2)(Boolean(g),y,m),onClick:()=>function(e,t){const o=t.collectionViewBlockStore();if(!o)return;s().bo({environment:e,store:o,lock:!o.isLocked()}),a().wd({environment:e,collectionContextStore:t,action:"click_toggle_lock"})}(o,t)}):null}},210900:(e,t,o)=>{"use strict";o.d(t,{U:()=>i});var n=()=>o(421654);function i(e){const{icon:t,collectionViewStore:o,transaction:i}=e;n().FH({stores:[o],update:{collection_view_icon:t},transaction:i})}},599291:(e,t,o)=>{"use strict";o.d(t,{V:()=>c});var n=o.n(o(150811)),i=o(667294),r=()=>o(846550),l=()=>o(513670),a=()=>o(291198),s=o(785893);function c(e){let{value:t,onChange:o,onBlur:c,onKeyDown:d,inputProps:u}=e;const[p,g]=(0,i.useState)(""),m=(0,i.useRef)(""),f=(0,i.useRef)(t);(0,i.useEffect)((()=>{const e=void 0===t?"":t.toString();g(e),m.current=e,f.current=t}),[t]);const y=(0,i.useCallback)((e=>l().Ds((e=>{null==o||o(e)}),300)(e)),[o]),S=(0,i.useCallback)((e=>{const t=e.target.value;if(g(t),m.current=t,o){const e=n()(t);y(isNaN(e)?void 0:e)}}),[y,o]),h=(0,i.useCallback)((e=>{const t=n()(e.target.value);null==c||c(isNaN(t)?void 0:t)}),[c]),x=(0,i.useRef)(c),v=(0,i.useCallback)((e=>{if("Enter"===e.key){const e=n()(p);null==d||d(isNaN(e)?void 0:e)}}),[p,d]);(0,i.useEffect)((()=>()=>{var e;if((null===(e=f.current)||void 0===e?void 0:e.toString())!==m.current){var t;const e=n()(m.current);null===(t=x.current)||void 0===t||t.call(x,isNaN(e)?void 0:e)}}),[]);const C=(0,r().yK)((e=>({input:{background:e.contentBackground}})),[]);return(0,s.jsx)(a().Z,{type:"number",value:p,inputClassName:"input-hide-arrows",style:C.input,onChange:S,onBlur:c?h:void 0,onKeyDown:d?v:void 0,...u})}},530671:(e,t,o)=>{"use strict";o.d(t,{Z:()=>V,t:()=>I});var n=o(667294),i=()=>o(219727),r=()=>o(142735),l=()=>o(332143),a=()=>o(226413),s=()=>o(374289),c=()=>o(788860),d=()=>o(491927),u=()=>o(446955),p=()=>o(125659),g=()=>o(667247),m=()=>o(861026),f=()=>o(352230),y=()=>o(164079),S=()=>o(529048),h=()=>o(826955),x=()=>o(827973),v=()=>o(448419),C=()=>o(255577),b=()=>o(967092),w=()=>o(388284),j=()=>o(654133),_=()=>o(899316),M=()=>o(103163),k=()=>o(951877),P=()=>o(360197),T=o(785893);let I=function(e){return e[e.BlockPropertyOverlay=0]="BlockPropertyOverlay",e[e.ViewSettings=1]="ViewSettings",e}({});const V=function(e){let{context:t,schema:n,property:l,parentStore:a,onDismiss:s,disabled:d,analyticsFrom:p,onChange:g}=e;const m=(0,o(846550).Fg)(),h=(0,i().O7)(),x=(0,r().qz)(void 0,S().Z),w=(0,r().qz)(void 0,S().Z),M=(0,r().qz)(void 0,S().Z),k=(0,i().Fy)(),P=(0,r().VK)((()=>A(n,l,a)),[n,l,a]),V=Boolean(null==P?void 0:P.propertySchema.relation_property),R=Boolean((null==P?void 0:P.propertySchema.relation_property)&&(null==P?void 0:P.propertySchema.target_property)),K=(0,r().VK)((()=>o(513670).oA([E(h,m,d,n,l,a,p,M,g),N(V,h,m,d,n,l,a,p,w,g),U(R,h,m,d,n,l,a,p,x,g)])),[V,R,h,m,d,n,l,a,p,g,x,M,w]),H=(0,r().VK)((()=>x.state.open),[x]),z=(0,r().VK)((()=>M.state.open),[M]),W=(0,r().VK)((()=>w.state.open),[w]);if(!P)return null;if(t===I.BlockPropertyOverlay){let e;return e=k.isMobile?{menuType:f().o.Modal,title:P.propertySchema.name,right:(0,T.jsx)(o(470386).DoneMenuText,{}),onClickRight:s}:{menuType:f().o.Popup},(0,T.jsx)(o(198829).Z,{...e,children:(0,T.jsx)(C().ZP,{type:C().iW.Vertical,initialFocus:void 0,sections:K})})}return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(v().ZP,{popupType:k.isMobile?b().kQ.SlideUp:b().kQ.Popup,alignmentToOrigin:v().vR.End,renderOrigin:e=>(0,T.jsx)(u().Z,{title:(0,T.jsx)(c()._H,{defaultMessage:"Relation",id:"database.viewSettings.rollupOptions.relationProperty"}),disabled:d,showChevron:!0,rotateChevron:z,right:P.relationPropertySchema?(0,T.jsx)(_().ZP,{propertySchema:P.relationPropertySchema,showIcon:!0}):(0,T.jsx)(c()._H,{id:"database.viewSettings.rollupOptions.selectRelation",defaultMessage:"Select"}),...e}),render:e=>(0,T.jsx)(O,{parent:e,analyticsFrom:p,schema:n,property:l,parentStore:a,onChange:g}),buttonPopupStore:M}),(0,T.jsx)(j().Z,{renderTooltip:()=>(0,T.jsx)(B,{}),disableTooltip:V,render:e=>(0,T.jsx)(v().ZP,{popupType:k.isMobile?b().kQ.SlideUp:b().kQ.Popup,alignmentToOrigin:v().vR.End,renderOrigin:t=>(0,T.jsx)(u().Z,{title:(0,T.jsx)("span",{style:{...!R&&{color:m.mediumTextColor}},children:(0,T.jsx)(c()._H,{defaultMessage:"Property",id:"database.viewSettings.rollupOptions.targetProperty"})}),disabled:!V||d,showChevron:!0,rotateChevron:W,right:V&&(P.targetPropertySchema?(0,T.jsx)(_().ZP,{propertySchema:P.targetPropertySchema,showIcon:!0}):(0,T.jsx)(c()._H,{id:"database.viewSettings.rollupOptions.selectTargetProperty",defaultMessage:"Select"})),...(0,y().Z)(e,t)}),render:e=>(0,T.jsx)(L,{parent:e,analyticsFrom:p,schema:n,property:l,parentStore:a,onChange:g}),buttonPopupStore:w})}),(0,T.jsx)(j().Z,{renderTooltip:()=>(0,T.jsx)(F,{}),disableTooltip:R,render:e=>(0,T.jsx)(v().ZP,{popupType:k.isMobile?b().kQ.SlideUp:b().kQ.Popup,alignmentToOrigin:v().vR.End,renderOrigin:t=>(0,T.jsx)(u().Z,{disabled:!R||d,title:(0,T.jsx)("span",{style:{...!R&&{color:m.mediumTextColor}},children:(0,T.jsx)(c()._H,{defaultMessage:"Calculate",id:"database.viewSettings.rollupOptions.calculate"})}),showChevron:!0,rotateChevron:H,right:R&&(0,T.jsx)(Z,{schema:n,property:l,parentStore:a}),...(0,y().Z)(e,t)}),render:e=>(0,T.jsx)(D,{parent:e,analyticsFrom:p,schema:n,property:l,parentStore:a,onChange:g}),buttonPopupStore:x})})]})};function A(e,t,o){var n;const i=e[t];if(!i)return;let r,l;if(i.relation_property){const t=e[i.relation_property];t&&"relation"===t.type&&(r=t)}if(r){const e=a().j0(r);l=e?h().NW.createChildStore(o,e):void 0}const s=null===(n=l)||void 0===n?void 0:n.getValue(),c=s?a().oC(s):{};let d;if(s&&i.target_property){var u;d=c[(null===(u=l)||void 0===u?void 0:u.getMappedProperty(i.target_property))??i.target_property]}return{propertySchema:i,relationPropertySchema:r,relatedCollectionValue:s,relatedCollectionSchema:c,targetPropertySchema:d}}function Z(e){let{schema:t,property:o,parentStore:n}=e;const i=(0,r().VK)((()=>A(t,o,n)),[n,o,t]);return i?i.propertySchema.aggregation?(0,T.jsx)(T.Fragment,{children:g().VN[(0,l().gu)(i.propertySchema.aggregation)]}):(0,T.jsx)(c()._H,{id:"database.rollupProperty.aggregate.showOriginal",defaultMessage:"Show original"}):null}function B(){return(0,T.jsx)(c()._H,{id:"database.rollupProperty.editProperty.tooltip",defaultMessage:"Select an existing relation first."})}function F(){return(0,T.jsx)(c()._H,{id:"database.rollupProperty.editAggregate.tooltip",defaultMessage:"Select an existing relation and property first."})}function R(e,t){return e?void 0:(0,s().i)({width:11,fill:t.mediumIconColor})}function K(e){return"relation"===e.type}function H(e){return"rollup"!==e.type&&!a().Eu.includes(e.type)}function O(e){let{parent:t,analyticsFrom:o,schema:r,property:l,parentStore:a,onChange:s}=e;const c=(0,i().O7)(),u=(0,p().Y$)(),g=(0,n.useCallback)((e=>function(e,t,o,n,i,r,l,a){const s=A(n,i,r);if(!s)return;const c={...s.propertySchema,relation_property:e,target_property:"title",target_property_type:"title",aggregation:void 0};null==l||l({propertySchema:c}),d().Zr(t,{...(0,m().Pn)(a),from:o})}(e,c,o,r,l,a,s,u)),[c,o,r,l,a,s,u]);return(0,T.jsx)(P().Z,{schema:r,isRelationProperty:!0,onAccept:g,onClose:t.close,allowProperty:K})}function L(e){let{parent:t,analyticsFrom:o,schema:l,property:a,parentStore:s,onChange:c}=e;const u=(0,i().O7)(),g=(0,p().Y$)(),f=(0,n.useCallback)((e=>function(e,t,o,n,i,r,l,a){const s=A(n,i,r);if(!s||!s.relatedCollectionValue||!s.relatedCollectionSchema)return;const c=s.relatedCollectionSchema[e];if(!c)return;const u={...s.propertySchema,target_property:e,target_property_type:c.type,aggregation:void 0};null==l||l({propertySchema:u}),d().yj(t,{...(0,m().Pn)(a),from:o,property_type:c.type})}(e,u,o,l,a,s,c,g)),[u,o,l,a,s,c,g]),y=(0,r().VK)((()=>A(l,a,s)),[s,a,l]);return y?(0,T.jsx)(P().Z,{isRelationProperty:!1,schema:y.relatedCollectionSchema,onAccept:f,allowProperty:H,onClose:t.close}):null}function D(e){let{parent:t,analyticsFrom:o,schema:a,property:s,parentStore:u,onChange:g}=e;const f=(0,i().O7)(),y=(0,p().Y$)(),S=(0,n.useCallback)((e=>function(e,t,o,n,i,r,a,s){const c=A(n,i,r);if(!c)return;const u={...c.propertySchema,aggregation:e,show_as:void 0};null==a||a({propertySchema:u});const p=e?(0,l().gu)(e):void 0;d().en(t,{...(0,m().Pn)(s),from:o,aggregation:p})}(e,f,o,a,s,u,g,y)),[f,o,a,s,u,g,y]),h=(0,r().VK)((()=>A(a,s,u)),[u,s,a]);return h&&h.propertySchema.target_property?(0,T.jsx)(M().Z,{property:h.propertySchema.target_property,schema:h.relatedCollectionSchema,currentAggregation:h.propertySchema.aggregation?{aggregator:h.propertySchema.aggregation,property:h.propertySchema.target_property}:void 0,onChange:S,onClose:t.close,noneText:(0,T.jsx)(c()._H,{id:"database.rollupProperty.aggregate.showOriginal",defaultMessage:"Show original"}),source:"rollupPropertyMenu"}):null}function E(e,t,o,n,i,r,l,a,s){const{device:d}=e,u=A(n,i,r);if(u)return{key:0,render:e=>(0,T.jsx)(w().Z,{...e,title:(0,T.jsx)(c()._H,{id:"database.rollupProperty.editRelation.title",defaultMessage:"Relation"}),isTitleUppercase:!0}),items:[{key:0,render:e=>(0,T.jsx)(v().ZP,{popupType:d.isMobile?b().kQ.SlideUp:b().kQ.Popup,renderOrigin:n=>u.relationPropertySchema?(0,T.jsx)(k().N,{...(0,y().Z)(e,n),propertySchema:u.relationPropertySchema,format:k().L.Name,right:R(o,t),disabled:o}):(0,T.jsx)(x().Z,{...(0,y().Z)(e,n),title:(0,T.jsx)(c()._H,{id:"database.rollupProperty.editRelation.buttonTitle",defaultMessage:"Select an existing relation…"}),right:R(o,t),style:{color:t.mediumTextColor},disabled:o}),render:e=>(0,T.jsx)(O,{parent:e,analyticsFrom:l,schema:n,property:i,parentStore:r,onChange:s}),buttonPopupStore:a},e.key),action:()=>{a.setState({open:!0})}}]}}function N(e,t,o,n,i,r,l,a,s,d){const{device:u}=t,p=A(i,r,l);if(p)return{key:1,render:e=>(0,T.jsx)(w().Z,{...e,title:(0,T.jsx)(c()._H,{id:"database.rollupProperty.editProperty.title",defaultMessage:"Property"}),topBorder:!0,isTitleUppercase:!0}),items:[{key:0,render:t=>(0,T.jsx)(j().Z,{renderTooltip:()=>(0,T.jsx)(B,{}),disableTooltip:e,render:g=>(0,T.jsx)(v().ZP,{popupType:u.isMobile?b().kQ.SlideUp:b().kQ.Popup,renderOrigin:i=>p.targetPropertySchema?(0,T.jsx)(k().N,{...(0,y().Z)(t,i),propertySchema:p.targetPropertySchema,format:k().L.Name,right:R(n,o),disabled:n}):(0,T.jsx)(x().Z,{...(0,y().Z)(t,g),title:(0,T.jsx)(c()._H,{id:"database.rollupProperty.editProperty.buttonTitle",defaultMessage:"Select a property to display…"}),right:R(!e||n,o),disabled:!e||n,disabledFeedback:!0}),render:e=>(0,T.jsx)(L,{parent:e,analyticsFrom:a,schema:i,property:r,parentStore:l,onChange:d}),buttonPopupStore:s})},t.key),action:()=>{s.setState({open:!0})}}]}}function U(e,t,o,n,i,r,l,a,s,d){const{device:u}=t;if(A(i,r,l))return{key:2,render:e=>(0,T.jsx)(w().Z,{...e,title:(0,T.jsx)(c()._H,{id:"database.rollupProperty.editAggregate.title",defaultMessage:"Calculate"}),topBorder:!0,isTitleUppercase:!0}),items:[{key:0,render:t=>(0,T.jsx)(j().Z,{renderTooltip:()=>(0,T.jsx)(F,{}),disableTooltip:e,render:p=>e?(0,T.jsx)(v().ZP,{popupType:u.isMobile?b().kQ.SlideUp:b().kQ.Popup,renderOrigin:e=>(0,T.jsx)(x().Z,{...(0,y().Z)(t,e),title:(0,T.jsx)(Z,{schema:i,property:r,parentStore:l}),right:R(n,o),disabled:n}),render:e=>(0,T.jsx)(D,{parent:e,analyticsFrom:a,schema:i,property:r,parentStore:l,onChange:d}),buttonPopupStore:s}):(0,T.jsx)(x().Z,{...(0,y().Z)(t,p),title:(0,T.jsx)(c()._H,{id:"database.rollupProperty.aggregate.showOriginal",defaultMessage:"Show original"}),right:R(n,o),disabled:!0,disabledFeedback:!0})},t.key),action:()=>{s.setState({open:!0})}}]}}},277443:(e,t,o)=>{"use strict";o.d(t,{_:()=>H});o(670560),o(267602),o(653476),o(470928),o(749411),o(241792);var n=o(667294),i=()=>o(219727),r=()=>o(142735),l=()=>o(38883),a=()=>o(702491),s=()=>o(330814),c=()=>o(95886),d=()=>o(752778),u=()=>o(788860),p=()=>o(568017),g=()=>o(513670),m=()=>o(707513),f=()=>o(491927),y=()=>o(250303),S=()=>o(971928),h=()=>o(308186),x=()=>o(705670),v=()=>o(678523),C=()=>o(508858),b=()=>o(125659),w=()=>o(861026),j=()=>o(352230),_=()=>o(104088),M=()=>o(709917),k=()=>o(855238),P=()=>o(740046),T=()=>o(198829),I=()=>o(255577),V=()=>o(470386),A=()=>o(967092),Z=()=>o(388284),B=()=>o(129636),F=()=>o(246471),R=o(785893);const K=o(263184).default.createClass(!1,{name:"ShowSelectDescriptionStore"});function H(e){let{onClose:t,collectionId:o,propertySchema:l,property:a,onChange:s,option:c,analyticsFrom:d,statusGroup:u,origin:p,open:g,alignmentToOrigin:m}=e;const f=(0,i().O7)(),y=(0,b().Y$)(),S=(0,r().qz)(void 0,K),[h,x]=(0,n.useState)(""),v=(0,n.useRef)(g);(0,n.useEffect)((()=>{!v.current&&g&&x(c.value),v.current=g}),[g,c.value]);const C=(0,n.useCallback)((()=>(0,R.jsx)(O,{collectionContextStore:y,onClose:t,collectionId:o,propertySchema:l,property:a,onChange:s,option:c,analyticsFrom:d,statusGroup:u,renameInputValue:h,setRenameInputValue:x,showSelectDescriptionStore:S})),[y,t,o,l,a,s,c,d,u,h,x,S]),w=(0,n.useCallback)((()=>function(e,t,o,n,i,r,l,a,s){o(),L(e,t,n,i,r,l,a,s)}(f,y,t,o,l,a,s,c,h)),[f,y,t,o,l,a,s,c,h]),{device:j}=f;return(0,R.jsx)(A().ZP,{popupType:j.isMobile?_().k.SlideUp:_().k.Popup,open:g,onDismiss:w,origin:p,render:C,alignmentToOrigin:m})}function O(e){let{collectionContextStore:t,onClose:o,collectionId:g,propertySchema:y,property:b,onChange:_,option:A,analyticsFrom:K,statusGroup:H,renameInputValue:O,setRenameInputValue:D,showSelectDescriptionStore:E}=e;const N=(0,u().YB)(),U=(0,i().O7)(),z=(0,r().VK)((()=>t.collectionStore()),[t]),W=(0,n.useCallback)((e=>function(e,t){const o=e.target.value.replace(/,/g,"");t(o)}(e,D)),[D]),q=(0,n.useCallback)((()=>function(e,t,o,n,i,r,l,a,s){o(),L(e,t,n,i,r,l,a,s)}(U,t,o,g,y,b,_,A,O)),[U,t,o,g,y,b,_,A,O]),G=(0,n.useCallback)((()=>{if(z)return function(e,t,o,n,i,r,l,a,s){S().yW({environment:e,option:t,property:i,propertySchema:n,collectionStore:l,statusGroup:a}),r(),f().$q(e,{...(0,w().Pn)(s),property_type:n.type,action:"select_delete_option",from:o})}(U,A,K,y,b,o,z,H,t)}),[U,A,z,K,y,b,o,H,t]),{device:Y}=U,$=(0,r().Kw)(E),Q=[];$&&Q.push({key:"description",render:e=>(0,R.jsx)(Z().Z,{...e,desktopStyle:{paddingTop:0},title:Y.isMobile?N.formatMessage(v().k.descriptionHeader):void 0}),items:[{key:"description",render:e=>(0,R.jsx)(v().i,{...e,initialDescription:A.description,handleSaveDescription:e=>function(e,t,o,n,i,r,l,a){if(e===(a.description??""))return;const s={...a,description:e},c={pointer:{table:d().vF,id:n},command:"keyedObjectListUpdate",path:["schema",i,"options"],args:{value:s}};o([c]),f().$q(t,{property_type:r.type,action:"select_set_description",from:l})}(e,U,_,g,b,y,K,A),disableAutoSection:!0}),action:()=>{}}]});const J={key:"action",render:e=>(0,R.jsx)(Z().Z,{...e}),items:[]};Q.push(J),J.items.push({key:"delete",render:e=>(0,R.jsx)(k().Z,{...e,title:(0,R.jsx)(u()._H,{id:"database.selectPropertyOptionEditMenu.deleteLabel",defaultMessage:"Delete"}),svg:c().y}),action:G}),H&&"status"===y.type&&(J.items.push({key:"setAsDefault",render:e=>(0,R.jsx)(k().Z,{...e,title:(0,R.jsx)(u()._H,{id:"database.selectPropertyOptionEditMenu.setAsDefault",defaultMessage:"Set as default"}),svg:s().z}),action:()=>async function(e,t,o,n,i,r,l,a,s){if("status"!==o.type||!s)return;if(r.value===o.defaultOption)return;if(void 0!==o.defaultOption){const{accept:e}=await h().gt({mode:"wide",message:(0,R.jsx)(u()._H,{defaultMessage:'Change default to "{defaultValue}"?',id:"database.editProperty.setAsDefault.confirm.title",values:{defaultValue:r.value}}),description:(0,R.jsx)(u()._H,{defaultMessage:"New pages will start with {defaultValue} as the default status. Existing pages <b>without a status explicitly set</b> will switch to {defaultValue}.",id:"database.editProperty.setAsDefault.confirm.description",values:{defaultValue:r.value,b:e=>(0,R.jsx)("span",{style:{fontWeight:m().Ue.semibold},children:e})}}),acceptLabel:(0,R.jsx)(u()._H,{defaultMessage:"Continue",id:"database.editProperty.setAsDefault.confirm.continueButton"})});if(!e)return}const c={table:d().vF,id:e},p=[],g={pointer:c,command:"update",path:["schema",t],args:{defaultOption:r.value}};p.push(g),n(p),l(),f().$q(a,{property_type:o.type,action:"status_set_default",from:i,collection_id:e})}(g,b,y,_,K,A,o,U,H)}),J.items.push({key:"Group",render:e=>(0,R.jsx)("div",{...e,children:(0,R.jsx)(C().Z,{...e,title:(0,R.jsx)(u()._H,{id:"database.selectPropertyOptionEditMenu.Group",defaultMessage:"Group"}),selectedKey:H.name,options:(y.groups??[]).map((e=>({key:e.name,type:"button",title:M().ZA[e.name]??e.name}))),icon:e=>(0,a().V)({...e,width:16,marginRight:0}),onChange:e=>{!function(e,t,o,n,i,r,l,a,s){if("status"!==l.type||!s)return;const c={table:d().vF,id:t},u=[],p=l.groups??[],g=p.findIndex((e=>e.id===s.id)),m=p.findIndex((t=>t.name===e));if(g===m)return;const y={pointer:c,command:"listRemove",path:["schema",n,"groups",g,"optionIds"],args:{id:o.id}},S={pointer:c,command:"listAfter",path:["schema",n,"groups",m,"optionIds"],args:{id:o.id}};u.push(y,S);const h=l.options??[],x=p.flatMap((e=>{const t=e.optionIds??[],o=h.filter((e=>t.includes(e.id)));return o})),v={pointer:c,command:"set",path:["schema",n,"options"],args:x};u.push(v),i(u),f().$q(a,{property_type:l.type,action:"status_set_default",from:r,collection_id:t})}(e,g,A,b,_,K,y,U,H)}})}),action:()=>{}}));const X=p().AP.map((e=>{const t={key:e,render:t=>(0,R.jsx)(B().Z,{...t,color:e,checkState:A.color===e}),action:()=>{!function(e,t,o,n,i,r,l,a){const s={...t,color:e},c={pointer:{table:d().vF,id:o},command:"keyedObjectListUpdate",path:["schema",n,"options"],args:{value:s}};r([c]),f().$q(a,{property_type:i.type,action:"select_change_color",from:l,collection_id:o})}(e,A,g,b,y,_,K,U)}};return t})),ee={key:"color",render:e=>(0,R.jsx)(Z().Z,{...e,title:(0,R.jsx)(u()._H,{id:"database.selectPropertyOptionEditMenu.colorsSection",defaultMessage:"Colors"}),isTitleUppercase:!0,topBorder:!0}),items:X};let te;return Q.push(ee),te=Y.isMobile?{menuType:j().o.Modal,title:(0,R.jsx)(F().a,{format:l().lo.Large,value:A.value,color:A.color,showRemoveButton:!1,isSingle:!0}),right:(0,R.jsx)(V().DoneMenuText,{}),onClickRight:q}:{menuType:j().o.Popup,width:220},(0,R.jsxs)(T().Z,{...te,children:[(0,R.jsx)(Z().Z,{isInput:!0,children:(0,R.jsx)(P().ZP,{focusInitial:!0,selectAll:!Y.isMobile,value:O,maxlength:180,onChange:W,onSubmit:q,showClearButton:!1,inputRight:(0,R.jsx)(x().l,{onClick:()=>E.setState(!$),description:A.description,showTooltip:!$})})}),(0,R.jsx)(I().ZP,{type:I().iW.Vertical,disableKeyboard:!0,initialFocus:void 0,sections:Q})]})}function L(e,t,o,n,i,r,l,a){const s=a,c=n.options||[],p=c.find((e=>e.id!==l.id&&e.value.trim().toLowerCase()===s.trim().toLowerCase()));if(l.value!==s)if(s)if(p)h().UW((0,R.jsx)(u()._H,{defaultMessage:"This select option already exists.",id:"database.editProperty.errorDialog.duplicateSelectValue.message"}));else{const a=c.find((e=>e.id===l.id));if(!a)return;const u=s.trim(),p={...a,value:u},m={pointer:{table:d().vF,id:o},command:"keyedObjectListUpdate",path:["schema",i,"options"],args:{value:p}},f="status"===n.type&&l.value===n.defaultOption?{pointer:{table:d().vF,id:o},command:"update",path:["schema",i],args:{defaultOption:u}}:void 0;r(g().oA([m,f])),y().$q({environment:e,collectionContextStore:t,property:i,from:"view_settings",action:"select_rename_option",option_value_char_count:u.length})}else h().UW((0,R.jsx)(u()._H,{defaultMessage:"Please type a value.",id:"database.editProperty.errorDialog.missingSelectValue.message"}))}},393308:(e,t,o)=>{"use strict";o.d(t,{TB:()=>b,Xh:()=>x,Y7:()=>C,ZP:()=>v,qQ:()=>h});var n=o(667294),i=()=>o(142735),r=()=>o(846550),l=()=>o(109477),a=()=>o(949489),s=()=>o(996106),c=()=>o(255393),d=()=>o(788860),u=()=>o(351763),p=()=>o(446955),g=()=>o(641702),m=()=>o(897257),f=()=>o(292518),y=()=>o(654133),S=o(785893);function h(e){let{collectionStore:t,propertySchema:o}=e;const n=(0,i().VK)((()=>(0,g().Xh)(t.getName(),t)),[t]),r=(0,i().VK)((()=>{var e;const t=(null===(e=m().subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return(0,c().de)(t)}),[]);return(0,S.jsxs)("div",{children:[(0,S.jsx)("div",{style:{color:"white",fontWeight:500,wordWrap:"break-word",whiteSpace:"pre-wrap"},children:(0,S.jsx)(d()._H,{...u().fillAllPagesMessages.fillAllPagesTooltip,values:{hasNames:Boolean(n)&&Boolean(o.name),collectionName:n,propertyName:o.name}})}),!r&&(0,S.jsx)("div",{style:{color:"#ACABA9",fontWeight:500},children:(0,S.jsx)(d()._H,{...u().fillAllPagesMessages.fillAllPagesAddOnMessage})})]})}function x(e){let{updateAiInferencesTaskStatus:t,iconStyle:o,progressIconStyle:n}=e;const i=(0,r().Fg)();return t.isRunning?(0,S.jsx)("div",{style:n,children:(0,S.jsx)(f().Z,{})}):(0,a().y)({width:14,color:i.accentColors.purple[400],...o})}function v(e){let{updateAiInferencesTaskStatus:t,style:o}=e;const n=(0,d().YB)();return(0,S.jsx)("div",{style:o,children:t.isRunning?(0,S.jsx)("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:void 0===t.numPagesFilled||void 0===t.numPagesRequested?(0,S.jsx)(d()._H,{defaultMessage:"Autofilling all pages",id:"aiAutofill.fillallPages.updatingAllPages"}):(0,S.jsx)(d()._H,{defaultMessage:"{numPagesRequested, plural, one {Autofilling {numPagesFilled} of {numPagesRequested} page} other {Updating {numPagesFilled} of {numPagesRequested} pages}}",id:"aiAutofill.fillallPages.updatingAllPagesWithProgress",values:{numPagesFilled:(0,s().uf)(t.numPagesFilled,"compact",n),numPagesRequested:(0,s().uf)(t.numPagesRequested,"compact",n)}})}):(0,S.jsx)(d()._H,{defaultMessage:"Autofill all pages",id:"aiAutofill.fillAllPages.buttonTitle"})})}function C(e){let{updateAiInferencesTaskStatus:t}=e;const{numPagesFilled:o,numPagesRequested:n}={numPagesFilled:void 0,numPagesRequested:void 0,...t},i=(0,r().yK)((e=>({inner:{background:e.accentColors.purple[400],height:"100%",transition:"width .5s"},outer:{background:e.accentColors.gray[100],height:3,borderRadius:2,minWidth:120,overflow:"hidden",marginTop:8}})),[]);return void 0===o||void 0===n?null:(0,S.jsx)("div",{style:i.outer,role:"progressbar",children:(0,S.jsx)("div",{style:{...i.inner,width:100*Math.min(o/n,1)+"%"}})})}function b(e){const{environment:t,collectionContextStore:o,collectionStore:r,property:a,propertySchema:s,doesUserHaveAIAddOn:c,isAutofillSetupEnabled:d}=e,g=(0,i().VK)((()=>{const e=o.collectionStore();return e?(0,l().De)(e.getFormat(),a):{isRunning:!1,numPagesFilled:void 0,numPagesRequested:void 0}}),[o,a]),m=(0,n.useCallback)((async()=>{const e=o.collectionStore();e&&s&&await u().autofillPropertyForCollection({environment:t,collectionStore:e,propertySchema:s,property:a})}),[t,s,a,o]);return(0,S.jsx)(y().Z,{disableTooltip:c,renderTooltip:()=>(0,S.jsx)(h,{collectionStore:r,propertySchema:s}),render:e=>(0,S.jsx)(p().Z,{icon:e=>(0,S.jsx)(x,{updateAiInferencesTaskStatus:g,iconStyle:e,progressIconStyle:{marginTop:4,marginLeft:4,marginRight:2}}),title:(0,S.jsx)(v,{updateAiInferencesTaskStatus:g}),caption:void 0!==g.numPagesFilled&&void 0!==g.numPagesRequested&&(0,S.jsx)(C,{updateAiInferencesTaskStatus:g}),focused:!1,onClick:m,disabled:g.isRunning||!d,...e})})}},8225:(e,t,o)=>{"use strict";o.d(t,{Z:()=>D});o(122556),o(582845),o(250570),o(533019),o(721473),o(788208),o(22624),o(241792);var n=o(667294),i=()=>o(504008),r=()=>o(219727),l=()=>o(142735),a=()=>o(846550),s=()=>o(834458),c=()=>o(520509),d=()=>o(38883),u=()=>o(92960),p=()=>o(756191),g=()=>o(177634),m=()=>o(998411),f=()=>o(565630),y=()=>o(530980),S=()=>o(788860),h=()=>o(855741),x=()=>o(707513),v=()=>o(491927),C=()=>o(125659),b=()=>o(141735),w=()=>o(641702),j=()=>o(861026),_=()=>o(615676),M=()=>o(57687),k=()=>o(527278),P=()=>o(352230),T=()=>o(817606),I=()=>o(677559),V=()=>o(466970),A=()=>o(998901),Z=()=>o(658096),B=()=>o(876822),F=()=>o(749826),R=()=>o(517084),K=()=>o(198829),H=()=>o(418297),O=o(785893);const L=200;function D(e){var t,o,a,d;const{property:S,disabled:x,formulas:A,getRecordModel:R,propertySchema:D,collectionStore:N,handleSave:z,handleClose:W,blockStore:q,analyticsFrom:G}=e,Y=(0,r().O7)(),$=(0,C().Y$)(),{value:Q}=(0,I().XJ)(b().F.formulas),[J,X]=(0,n.useState)(null==D||null===(t=D.formula2)||void 0===t?void 0:t.code),ee=(0,f().Kt)(J,L,Object.is),[te,oe]=(0,n.useState)(),ne=(0,n.useRef)(null===(o=D.formula2)||void 0===o?void 0:o.code),ie=(0,n.useRef)(J),re=(0,n.useRef)(null==D||null===(a=D.formula2)||void 0===a?void 0:a.result_type),le=(0,n.useCallback)((e=>{ie.current=e,X(e)}),[]),ae=(0,n.useCallback)((e=>{re.current=e}),[]),[se,ce]=(0,n.useState)((()=>i().Z.withListenerIgnored((()=>U.state??!1)))),[de,ue]=(0,n.useState)([]),pe=(0,r().Fy)();(0,n.useEffect)((()=>()=>{const e=ne.current,t=ie.current,o=re.current;if(t!==e||void 0!==ve){z({newValue:t,newType:(0,s().removeFunctionsFromType)(o??{type:"unknown"}),propertySchema:D,collectionStore:N,property:S});const e=(0,w().Xh)(t,N);v().$q(Y,{...(0,j().Pn)($),property_type:D.type,action:"formula_v2_edit",from:G,formula_char_count:e.length})}}),[]);const ge=(0,l().VK)((()=>N.pointer),[N.pointer]),me=(0,n.useMemo)((()=>{const e={type:"block",collection:ge};return{kind:u().FormulaContextValueKind.ThisRow,type:e}}),[ge]),fe=(0,l().VK)((()=>Z().default.state.publicPageData),[]),ye=(0,l().VK)((()=>{var e;return null===(e=B().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),Se=(0,l().VK)((()=>(0,_().W)()),[]),he=(0,V().E)("collections_xws"),xe=(0,n.useMemo)((()=>{if(!ye)return;const e=y().s85.fromGetRecordModelFn(R);return{sourceProperty:S,valueTypes:[me],handleDataRequest:(0,c().yf)({collectionFeatureGates:Se,experimentService:F().default,getRecordModel:R,loadRecordModel:e}),formulaPropertyNames:J&&(0,g().Ny)(J),publicPageDataCollection:{id:null==fe?void 0:fe.collectionId,schema:null==fe?void 0:fe.collectionSchema},spaceId:ye,restrictUnaccessibleProperties:he?"cross_space_only":void 0,featureGates:Se}}),[ye,R,S,me,J,null==fe?void 0:fe.collectionId,null==fe?void 0:fe.collectionSchema,Se,he]),ve=(0,l().VK)((()=>{if("v2"!==D.version&&D.formula)return A.convertCollectionFormulaToFormula2(D.formula,ge,N.getSchema())}),[ge,N,A,D.formula,D.version]),Ce=(0,n.useRef)(!1);(0,n.useEffect)((()=>{!async function(){if(!ve||Ce.current||!xe)return;const e=await A.analyzeFormula(ve,xe);let t;t=h().x.isFail(e)?{type:"unknown"}:e.value.type??{type:"unknown"},Ce.current=!0,le(ve),ae(t)}()}),[N,A,le,ae,S,D,ve,xe]);const be=(0,n.useMemo)((()=>{var e;const t="v2"===D.version?null===(e=D.formula2)||void 0===e?void 0:e.code:ve;return ne.current=t,t}),[null===(d=D.formula2)||void 0===d?void 0:d.code,D.version,ve]),we=(0,T()._)(),je=(0,l().VK)((()=>{ue([]);const e=null==q?void 0:q.getModel(),t=null==q?void 0:q.getRecordModel;if(!e||!ee||!t||M().il||!Q)return;const o=se?Q.evaluateRawCollectionFormula2({block:e,property:S,formulaCode:ee,getRecordModel:t,intl:k().Z.getIntl(),userTimeZone:(0,m().r)(),depth:0,visitedProperties:new Set,formulaTimeoutTimestampMs:Date.now()+we,resultCache:new Map,regExpCache:new Map,publicPageDataCollection:{id:null==fe?void 0:fe.collectionId,schema:null==fe?void 0:fe.collectionSchema},experimentService:F().default,collectionFeatureGates:(0,_().W)()}):Q.evaluateCollectionFormula2WithoutCache({block:e,property:S,formulaCode:ee,getRecordModel:t,intl:k().Z.getIntl(),userTimeZone:(0,m().r)(),depth:0,visitedProperties:new Set,formulaTimeoutTimestampMs:Date.now()+we,resultCache:new Map,regExpCache:new Map,publicPageDataCollection:{id:null==fe?void 0:fe.collectionId,schema:null==fe?void 0:fe.collectionSchema},experimentService:F().default,collectionFeatureGates:(0,_().W)()});if(o){if(!h().x.isFail(o))return oe(re.current),o.value;(0,p().y_)(o.error)&&ue([o.error])}}),[q,ee,se,S,we,fe,Q]);return xe&&ye?(0,O.jsx)(K().Z,{menuType:pe.isMobile?P().o.Modal:P().o.Popup,hideMobileTopbar:!0,width:pe.isMobile?void 0:740,disableBottomPadding:!0,maxHeight:"unset",disableHeaderBorder:!0,disableScroller:!0,children:(0,O.jsx)(H().a,{initialCode:be,outputFooter:void 0!==q&&(0,O.jsx)(E,{formulaResult:je,isAdvancedMode:se,setIsAdvancedMode:ce,formulaType:te,blockStore:q,formulaSchema:D}),formulas:A,getRecordModel:R,focus:!0,disabled:x,parentSpaceId:ye,typecheckContext:xe,onCodeChange:le,onTypeChange:ae,handleClose:W,parentCollectionStore:N,evaluationErrors:de})}):null}const E=n.memo((function(e){let{formulaResult:t,formulaType:i,blockStore:r,formulaSchema:l,isAdvancedMode:c,setIsAdvancedMode:u}=e;const p=(0,a().yK)((e=>({output:{display:"flex",alignItems:"center",zIndex:1,fontSize:x().JB.UISmall.desktop,height:38,padding:10,width:"100%",borderTop:`1px solid ${e.outlineButtonBorder}`,overflow:"hidden"},equals:{fontSize:x().JB.UIRegular.desktop,color:e.mediumTextColor,marginRight:6,marginLeft:2},type:{fontSize:x().JB.UISmall.desktop,color:e.mediumTextColor,marginLeft:6},iconStyle:{height:16,width:16},iconButtonStyle:{marginLeft:"auto"}})),[]),g=(0,n.useMemo)((()=>({baseStyles:{sizing:"small",tokenFormat:d().lo.Small,textStyle:{overflow:"hidden",textOverflow:"ellipsis",textWrap:"nowrap"},tokenWrapStyle:{display:"flex",flexWrap:"nowrap",...o(603885).RQ[d().lo.Medium]}},store:r,isEmpty:!1,isReadOnly:!0,canComment:!1,shouldRenderTooltip:!1,shouldWrap:!1,collectionContextStore:void 0,templateVariableContext:void 0,property:void 0,propertyFormat:void 0,propertySchema:c?void 0:l,trackEditBlockProperty:()=>{},format:0,containerRef:null})),[r,l,c]),m=(0,n.useMemo)((()=>i?(0,s().getHumanReadableType)(i):o(193962).l7.unknown),[i]);return(0,O.jsx)(o(96778).OU.Provider,{value:g,children:(0,O.jsxs)("div",{style:p.output,children:[(0,O.jsx)("span",{style:p.equals,children:"="}),t&&(0,O.jsx)(N,{value:t,withComma:!1,blockStore:r,formulaSchema:l,isAdvancedMode:c,renderWrapper:!0}),c&&Boolean(t)&&(0,O.jsx)("span",{style:p.type,children:(0,O.jsx)(S()._H,{...m})}),(0,O.jsx)(o(654133).Z,{renderTooltip:()=>c?(0,O.jsx)(S()._H,{defaultMessage:"Hide details",id:"formulas.editor.toggleAdvancedModeOff"}):(0,O.jsx)(S()._H,{defaultMessage:"Show details",id:"formulas.editor.toggleAdvancedModeOn"}),placement:A().Placement.Top,alignment:A().Alignment.Center,render:e=>(0,O.jsx)(o(1910).Z,{icon:c?o(259739).D:o(682547).N,onClick:()=>{const e=!c;u(e),U.setState(e)},iconStyle:p.iconStyle,style:p.iconButtonStyle,ariaLabel:"Toggle advanced mode on formula editor",...e})})]})})})),N=n.memo((function e(t){let{value:i,withComma:r,blockStore:s,formulaSchema:c,isAdvancedMode:d,renderWrapper:u}=t;const[p,g]=(0,l().VK)((()=>{var e;if(!i)return[[],"text"];if("undefined"===i.type&&d)return[[R().eL],"empty"];const t=(0,o(134418).$I)(i,s.getRecordModel,(0,m().r)());return[t,(null===(e=t[0])||void 0===e?void 0:e.type)??"text"]}),[s.getRecordModel,d,i]),f=(0,a().yK)((e=>({rightBracket:{color:e.mediumTextColor,fontSize:x().JB.UISmall.desktop,marginLeft:2},leftBracket:{color:e.mediumTextColor,fontSize:x().JB.UISmall.desktop,marginRight:2},comma:{color:e.mediumTextColor,fontSize:x().JB.UISmall.desktop,marginRight:2}})),[]);let y;if("array"===i.type)y=(0,O.jsxs)(n.Fragment,{children:[d?(0,O.jsx)("span",{style:f.leftBracket,children:"["}):null,i.values.map(((t,o)=>(0,O.jsx)(e,{value:t,withComma:o<i.values.length-1,blockStore:s,formulaSchema:c,isAdvancedMode:d,renderWrapper:!1},o))),d?(0,O.jsx)("span",{style:f.rightBracket,children:"]"}):null,r?(0,O.jsx)("span",{style:f.comma,children:", "}):""]});else{const e=r&&!d&&(0,R().vQ)(g,c);y=null==p?void 0:p.map(((t,o)=>(0,O.jsxs)(n.Fragment,{children:[(0,O.jsx)(R().gZ,{token:t,targetPropertySchema:c,blockStore:s,withComma:e,numberRightAlign:!1,shouldTruncate:!1,disableLinks:!1}),d&&r?(0,O.jsx)("span",{style:f.comma,children:", "}):null]},`${t.id}-${o}`)))}return u&&!d?(0,O.jsx)(R().E1,{propertyType:g,rootPropertySchema:c,numberRightAlign:!1,children:y}):(0,O.jsx)(n.Fragment,{children:y})})),U=new(o(41158).D)({key:"formulas_show_details",namespace:o(149310).$p,important:!0,trackingType:"preference"})},591909:(e,t,o)=>{"use strict";o.d(t,{O:()=>s,U:()=>a});o(122556),o(582845),o(250570),o(533019),o(721473),o(788208),o(22624),o(267602),o(653476),o(241792);var n=o.n(o(443261)),i=(o(667294),()=>o(788860)),r=()=>o(102182),l=o(785893);function a(e,t){const o=new Map,i=t.map((e=>{const t=[e.name,e.description].join(" ");return o.set(e.name,t),t})),r=new Set(n().filter(e,i).map((e=>{let{original:t}=e;return t})));return t.filter((e=>{const t=o.get(e.name);return t&&r.has(t)}))}function s(e){const{featureName:t}=e;r().oV({label:(0,l.jsx)(i()._H,{id:"database.viewSettings.customizeMenu.successToastAfterFeatureAddition",defaultMessage:"Added {featureName} to this database.",values:{featureName:t}})})}},854579:(e,t,o)=>{"use strict";o.d(t,{AH:()=>j,D3:()=>_,Y4:()=>w});o(267602),o(470928),o(241792),o(667294);var n=()=>o(492788),i=()=>o(142735),r=()=>o(846550),l=()=>o(799891),a=()=>o(429600),s=()=>o(396136),c=()=>o(255933),d=()=>o(306164),u=()=>o(696459),p=()=>o(139224),g=()=>o(360746),m=()=>o(253335),f=()=>o(110232),y=()=>o(777898),S=()=>o(427886),h=()=>o(164079),x=()=>o(503375),v=()=>o(295929),C=()=>o(200528),b=o(785893);function w(e){var t,o;const{collectionContextStore:n,feature:l,itemProps:s,icon:c,onClick:d}=e,u=(0,i().VK)((()=>n.databaseType),[n]),p=function(e,t){var o;const n=function(e){const{collectionContextStore:t,feature:o}=e,n=(0,C().MG)(t);return(0,i().VK)((()=>{if((0,x().I)(o))return;if((0,f().BQ)(o))return o.dependencies.find((e=>"property"===e.type));if((0,f().EU)(o))return o.dependencies.find((e=>"property"===e.type));const e=(0,C().ZJ)(o,null==n?void 0:n.allFeatures).find((e=>(0,C().qs)({collectionContextStore:t,feature:e})));return null==e?void 0:e.dependencies.find((e=>"property"===e.type))}),[n,t,o])}({collectionContextStore:e,feature:t}),r=(0,i().VK)((()=>{var t;return null===(t=e.collectionStore())||void 0===t?void 0:t.getSchema()}),[e]),l=(0,i().VK)((()=>{var t;return null===(t=e.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.app_uri_map}),[e]);if(!n||"property"!==n.type)return;const a=(null==l?void 0:l[n.uri])??n.uri,s=null==r?void 0:r[a];switch(null==s?void 0:s.type){case"select":case"multi_select":case"status":return null===(o=s.options)||void 0===o?void 0:o.map((e=>e.value)).join(", ");default:return}}(n,l),g=(0,r().yK)((e=>({addedIconStyle:{width:12,fill:e.lightIconColor,marginLeft:6,transition:"transform 200ms ease-in-out"}})),[]),m=(0,v().fA)(l,u),S=p??m;return(0,b.jsx)(y().Z,{showImage:!0,caption:m,tooltipImage:null===(t=l.tooltipImage)||void 0===t?void 0:t.img,tooltipImageScale:null===(o=l.tooltipImage)||void 0===o?void 0:o.scale,render:e=>(0,b.jsx)(v().Ny,{collectionContextStore:n,feature:l,caption:S,buttonMenuItemProps:{...(0,h().Z)(s,e)},icon:c,right:(0,a().o)(g.addedIconStyle),onClick:d})})}function j(e){const{environment:t,feature:o,collectionContextStore:i,collectionSettingsStore:r,appConfig:a}=e;if(o.uri===(0,m().EG)().uri)return()=>p().H4({collectionSettingsStore:r,item:{type:"subitemV2",from:"customize_menu"}});if(o.uri===(0,m().tQ)().uri)return()=>p().H4({collectionSettingsStore:r,item:{type:"dependencies",from:"customize_menu"}});if((0,f().BQ)(o)||(0,f().EU)(o)){if(0===o.dependencies.length)return()=>{l().log({level:"error",from:"FeaturesList",type:"FeatureWithNoDependencies",error:{miscDataString:`Feature ${o.name} has no dependencies.`}})};const e=o.dependencies[0],a=i.collectionStore();if(o.isAi)return()=>{const t=e.uri,o=null==a?void 0:a.getSchema()[t],n=i.settingsStore;p().H4({collectionSettingsStore:n,item:{type:"property",property:t,formatKey:i.getPropertyFormatKey()}}),"text"===(null==o?void 0:o.type)&&p().H4({collectionSettingsStore:n,item:{type:"propertyAiAutofill",propertySchema:o,property:t}})};if((0,f().BQ)(o)&&("collection_view"===e.type||"collection_view_block"===e.type||"sub_external_collection"===e.type))return async()=>{await async function(e){const{feature:t,collectionContextStore:o,environment:i,collectionSettingsStore:r}=e;if(1!==t.dependencies.length)return;const l=t.dependencies[0];if("collection_view"===l.type){const e=o.collectionViewStore(),t=o.collectionViewBlockStore();if(!e||!t)return;const a=null==t?void 0:t.getParentStore();if(!a||a.table!==c().bx&&a.table!==s().iU&&a.table!==d().e0)return;const u=(await(0,g().Q7)({environment:i,collectionViewBlockStore:t,appParentStore:a})).find((e=>{var t;return(null===(t=e.getFormat())||void 0===t?void 0:t.app_config_uri)===l.collectionViewBlockUri})),m=(0,f().kB)({collectionViewBlockStore:u,dependencyUri:l.uri});if(!m)return;(0,S().f)({environment:i,collectionContextStore:o,collectionViewId:m.id,isFullScreen:o.isFullScreenStore.state,isRootChild:o.isRootChildStore.state,isInPeekRenderer:o.isInPeekRendererStore.state}),n().default.afterNextFlush((()=>{p().r$({collectionContextStore:o,collectionSettingsStore:r})}))}}({feature:o,collectionContextStore:i,environment:t,collectionSettingsStore:r})};if("property"===e.type){var y;const t=((null==a||null===(y=a.getFormat())||void 0===y?void 0:y.app_uri_map)??{})[e.uri]??e.uri;return()=>{_({collectionContextStore:i,property:t})}}return()=>{l().log({level:"error",from:"FeaturesList",type:"UnsupportedFeatureDependency",error:{miscDataString:`Feature ${o.name} has an unsupported dependency type: ${e.type}`}})}}if((0,f().Dl)(o)){const e=(0,C().ZJ)(o,null==a?void 0:a.allFeatures);return 0===e.length?()=>{l().log({level:"error",from:"FeaturesList",type:"UnsupportedFeatureWithVariants",error:{miscDataString:`Feature ${o.name} has no variants.`}})}:()=>{1===e[0].dependencies.length&&_({collectionContextStore:i,property:e[0].dependencies[0].uri})}}(0,u().t1)(o)}function _(e){const{collectionContextStore:t,property:o}=e;p().H4({collectionSettingsStore:t.settingsStore,item:{type:"property",property:o,formatKey:t.getPropertyFormatKey()}})}},367404:(e,t,o)=>{"use strict";o.d(t,{Ar:()=>x,xR:()=>S});var n=o(667294),i=()=>o(219727),r=()=>o(142735),l=()=>o(846550),a=()=>o(697945),s=()=>o(293641),c=()=>o(788860),d=()=>o(139224),u=()=>o(446955),p=()=>o(796427),g=()=>o(388284),m=()=>o(142730),f=()=>o(378773),y=o(785893);function S(e){const{collectionContextStore:t,collectionSettingsStore:o,showTopBorder:n,children:r}=e,a=(0,i().Fy)(),s=(0,l().yK)((()=>({header:{fontSize:a.isMobile?14:12},section:{marginBottom:6}})),[a]);return(0,y.jsxs)(g().Z,{topBorder:n,title:(0,y.jsx)("div",{style:s.header,children:(0,y.jsx)(c()._H,{id:"database.viewSettings.customizeMenu.advanced.title",defaultMessage:"Advanced"})}),style:s.section,children:[(0,y.jsx)(p().aA,{collectionContextStore:t,collectionSettingsStore:o}),(0,y.jsx)(x,{collectionContextStore:t,collectionSettingsStore:o}),(0,y.jsx)(h,{collectionContextStore:t}),!1,r]})}function h(e){let{collectionContextStore:t}=e;const o=(0,i().O7)(),l=(0,r().VK)((()=>t.collectionViewBlockStore()),[t]),a=(0,n.useCallback)((()=>{const e=t.collectionStore();l&&e&&(0,m().IR)({environment:o,blockStore:l,collectionStore:e,collectionViewStore:t.collectionViewStore(),from:"customize_database_button_in_customize_menu"})}),[t,l,o]),d=(0,f().V)({environment:o,blockStore:l});return l&&d?(0,y.jsx)(u().Z,{icon:s().J,onClick:a,title:(0,y.jsx)(c()._H,{defaultMessage:"Customize page layout",id:"database.viewSettings.customizeMenu.customizeLayout"})}):null}function x(e){const{collectionSettingsStore:t}=e;return(0,y.jsx)(u().Z,{icon:a().L,onClick:()=>d().H4({collectionSettingsStore:t,item:{type:"connectionFeatures"}}),showChevron:!0,title:(0,y.jsx)(c()._H,{defaultMessage:"Connections",id:"database.viewSettings.customizeMenu.connections.title"})})}},864709:(e,t,o)=>{"use strict";o.d(t,{i:()=>h});o(667294);var n=()=>o(846550),i=()=>o(197874),r=()=>o(445520),l=()=>o(874650),a=()=>o(135796),s=()=>o(644760),c=()=>o(491630),d=()=>o(820717),u=()=>o(386961),p=()=>o(630824),g=()=>o(790663),m=()=>o(253335),f=()=>o(10829),y=o(785893);const S={[(0,m().oK)().uri]:o(161906)._,[(0,m().AE)().uri]:a().C,[(0,o(178741).pc)().uri]:c().C,[(0,g().Lm)().uri]:o(870960).w,[(0,g().nt)().uri]:o(150345).O,[(0,g().Gn)().uri]:d().v,[(0,g().Hs)().uri]:a().C,[(0,g().Si)().uri]:u().V,[(0,g().hZ)().uri]:c().C,[(0,g().JD)().uri]:l().r,[(0,g().Iq)().uri]:l().r,[(0,f().dr)().uri]:o(519454).R,[(0,f().B4)().uri]:o(825350).Q,[(0,f().ad)().uri]:o(25702).F,[(0,m().EG)().uri]:o(447490).Y,[(0,m().tQ)().uri]:o(373069).I,[(0,p().Tg)().uri]:d().v,[(0,p().ir)().uri]:u().V};function h(e){const{feature:t}=e,o=(0,n().yK)((e=>{var o,n;return{featureIconWrapper:{height:28,width:28,padding:"6px 0px",backgroundColor:null===(o=x(t,e))||void 0===o?void 0:o[30],borderRadius:4},featureIcon:{width:16,height:16,alignItems:"center",margin:"auto",fill:null===(n=x(t,e))||void 0===n?void 0:n[400]}}}),[t]),i=(0,n().Fg)();if(!t.icon){const e=S[t.uri]??s().A;return(0,y.jsx)("div",{style:o.featureIconWrapper,children:e(o.featureIcon)})}return(0,y.jsx)("div",{style:o.featureIconWrapper,children:(0,y.jsx)(r().Z,{icon:t.icon,theme:i,size:16,style:o.featureIcon})})}function x(e,t){return e.isAi?t.accentColors.purple:(0,i().Ao)(e.collectionUri,t)}},295929:(e,t,o)=>{"use strict";o.d(t,{Ny:()=>f,Ob:()=>h,fA:()=>S});o(667294);var n=()=>o(219727),i=()=>o(142735),r=()=>o(846550),l=()=>o(696459),a=()=>o(253335),s=()=>o(110232),c=()=>o(827973),d=()=>o(527278),u=()=>o(66417),p=o(785893);const g=(0,o(788860).vU)({property:{id:"customizeMenu.propertyMetadataDescription",defaultMessage:"Adds {dependencyCount, plural, one {# property} other {# properties}} to {databaseName}"},view:{id:"customizeMenu.viewMetadataDescription",defaultMessage:"Adds {dependencyCount, plural, one {# view} other {# views}} to {databaseName}"}}),m={property:g.property,collection_view:g.view,collection:void 0,sub_external_collection:void 0,collection_view_block:void 0,page_template:void 0,block:void 0,database_template:void 0};function f(e){const{collectionContextStore:t,buttonMenuItemProps:o,feature:l,caption:a,onClick:s,isDisabled:d,icon:u,right:g}=e,m=(0,n().Fy)(),f=(0,i().VK)((()=>t.databaseType),[t]),S=(0,r().yK)((()=>({menuItem:{display:"flex",padding:m.isMobile?"12px 2px":"6px 2px",alignItems:"center",opacity:d?.4:void 0},featureName:{fontSize:m.isMobile?16:13},featureCaption:{fontSize:m.isMobile?14:12,overflow:"hidden",color:"gray",whiteSpace:"nowrap",textOverflow:"ellipsis"},featureTextWrapper:{lineHeight:m.isMobile?"20px":"18px"}})),[m,d]);return(0,p.jsx)(c().Z,{...o,style:S.menuItem,icon:u,title:(0,p.jsxs)("div",{style:S.featureTextWrapper,children:[(0,p.jsx)("div",{style:S.featureName,children:y(l,f)}),(0,p.jsx)("div",{style:S.featureCaption,children:a})]}),disabled:d,onClick:s,right:!d&&g})}function y(e,t){if("notion://tasks/sub_task_feature"===e.uri){const{values:e,...o}=(0,u().Gt)({feature:"subitem",databaseType:t});return d().Z.formatMessage(o,e)}return e.name}function S(e,t){if("notion://tasks/sub_task_feature"===e.uri){const{values:e,...o}=(0,u().qi)({feature:"subitem",databaseType:t});return d().Z.formatMessage(o,e)}return e.description}function h(e,t){if(e.uri!==(0,a().EG)().uri&&e.uri!==(0,a().tQ)().uri&&((0,s().BQ)(e)||(0,s().EU)(e))){const o={property:0,collection_view:0,collection:0,sub_external_collection:0,collection_view_block:0,page_template:0,block:0,database_template:0};for(const t of e.dependencies)t.type in o&&o[t.type]++;let n="";for(const e of(0,l().Yd)(m))if(o[e]>0){const i=m[e];if(!i)continue;n+=`${d().Z.formatMessage(i,{dependencyCount:o[e],databaseName:t})}\n`}return n}}},145656:(e,t,o)=>{"use strict";o.d(t,{H:()=>b,a:()=>C});o(667294);var n=()=>o(219727),i=()=>o(142735),r=()=>o(846550),l=()=>o(788860),a=()=>o(568017),s=()=>o(513670),c=()=>o(853292),d=()=>o(110232),u=()=>o(777898),p=()=>o(827973),g=()=>o(397540),m=()=>o(164079),f=()=>o(529048),y=()=>o(591909),S=()=>o(864709),h=()=>o(295929),x=()=>o(200528),v=o(785893);function C(e){var t,o;const{collectionContextStore:r,collectionSettingsStore:l,feature:a,itemProps:C}=e,w=(0,n().O7)(),j=(0,x().MG)(r),_=(0,x().k3)(r,l),M=(0,i().VK)((()=>r.databaseType),[r]),k=(0,x().UL)(r),P=(0,h().fA)(a,M),T=(0,h().Ob)(a,k);return(0,v.jsx)(u().Z,{showImage:!0,caption:P,description:T,tooltipImage:null===(t=a.tooltipImage)||void 0===t?void 0:t.img,tooltipImageScale:null===(o=a.tooltipImage)||void 0===o?void 0:o.scale,render:e=>{if((0,d().BQ)(a)||(0,d().EU)(a))return(0,v.jsx)(h().Ny,{collectionContextStore:r,buttonMenuItemProps:{...(0,m().Z)(C,e)},feature:a,caption:P,onClick:()=>_(a),icon:(0,v.jsx)(S().i,{feature:a}),right:(0,v.jsx)(b,{focused:C.focused})});{const t=new(f().Z),o=(0,x().ZJ)(a,null==j?void 0:j.allFeatures);return(0,v.jsx)(g().Z,{buttonPopupStore:t,items:o,getKey:e=>e.name,renderItem:e=>(0,v.jsx)(p().Z,{...e,title:e.value.name,shouldWrapCaption:!0,shouldWrapTitle:!0}),onSelect:async e=>{await c().G0({environment:w,feature:e,collectionContextStore:r,addFeatureFrom:"customize_menu"}),(0,y().O)({featureName:e.name})},selectedItem:void 0,renderOrigin:o=>(0,v.jsx)(h().Ny,{collectionContextStore:r,buttonMenuItemProps:{focused:Boolean(C.focused),...(0,m().Z)(s().CE(C,"onClick","focused"),(0,m().Z)(e,o))},feature:a,caption:P,onClick:()=>{t.setState({open:!0})},icon:(0,v.jsx)(S().i,{feature:a}),right:(0,v.jsx)(b,{focused:C.focused})})})}}})}function b(e){const{focused:t}=e,o=(0,r().yK)((e=>({addButton:{fontSize:12,fontWeight:500,color:e.blueColor,background:t?a().ZP.diffBackground:e.accentColors.gray[75],padding:"3px 10px",borderRadius:16}})),[t]);return(0,v.jsx)("div",{style:o.addButton,children:(0,v.jsx)(l()._H,{defaultMessage:"Add",id:"database.viewSettings.customizeMenu.addButton"})})}},259083:(e,t,o)=>{"use strict";o.d(t,{$e:()=>oe,XR:()=>ie,l9:()=>L,w_:()=>Y,x1:()=>se,xb:()=>E,xg:()=>te,yM:()=>ne});o(267602),o(653476),o(470928),o(241792),o(667294);var n=()=>o(219727),i=()=>o(142735),r=()=>o(846550),l=()=>o(926724),a=()=>o(714230),s=()=>o(226413),c=()=>o(235484),d=()=>o(799891),u=()=>o(544672),p=()=>o(788860),g=()=>o(696459),m=()=>o(250303),f=()=>o(139224),y=()=>o(853292),S=()=>o(308186),h=()=>o(269299),x=()=>o(360746),v=()=>o(253335),C=()=>o(110232),b=()=>o(777898),w=()=>o(518242),j=()=>o(731738),_=()=>o(527278),M=()=>o(164079),k=()=>o(129338),P=()=>o(338855),T=()=>o(91502),I=()=>o(876822),V=()=>o(138912),A=()=>o(530261),Z=()=>o(591909),B=()=>o(503375),F=()=>o(854579),R=()=>o(295929),K=()=>o(200528),H=()=>o(145656),O=o(785893);function L(e){const t=se(),o=function(e){const t=(0,K().MG)(e),o=(0,i().VK)((()=>{var o;const n=(0,T().QI)()||(0,C().rm)(),i=null===(o=e.collectionStore())||void 0===o?void 0:o.getDatabaseType(),r=void 0===t||i===l().Ym;return n&&r?[E]:[]}),[e,t]);return o}(e),n=function(e){const t=(0,i().VK)((()=>{const t=e.databaseType;let o;if(t===l().p$){const t=e.collectionStore();o=Boolean(t&&(0,j().Dl)(t))}else o=t===l().Ym&&function(e){const t=e.collectionStore();if(!t)return!1;const o=t.getMappedProperty(l().Es.TaskToSprintRelation),n=t.getSchema()[o];if(!n)return!0;const i=(0,k().ny)(e,n);return Boolean(i&&(0,j().Dl)(i))}(e);return o?[Y]:[]}),[e]);return t}(e);return[...t,...o,...n]}const D=(0,p().vU)({taskName:{id:"feature.turnIntoTasks.name",defaultMessage:"Tasks"},taskDescription:{id:"feature.turnIntoTasks.description",defaultMessage:"See your tasks in Home, manage tasks in sprints, and more"}}),E={uri:"notion://feature/turn_into_tasks_feature",name:_().Z.formatMessage(D.taskName),description:_().Z.formatMessage(D.taskDescription),tooltipImage:{img:a().Z.images.tooltips.collectionSettings.turnIntoTasksPng,scale:.5},icon:"",collectionUri:B().x,isFeatureAdded:function(e,t){var o;if(e.uri!==E.uri)return!1;return(null===(o=t.collectionStore())||void 0===o?void 0:o.getDatabaseType())===l().Ym},getSuggestedFeatureMenuItem:e=>(0,O.jsx)(N,{collectionContextStore:e.collectionContextStore,feature:e.feature,itemProps:e.itemProps}),getAddedFeatureMenuItem:e=>(0,O.jsx)(U,{collectionContextStore:e.collectionContextStore,feature:e.feature,itemProps:e.itemProps})};function N(e){var t,o;const{collectionContextStore:i,feature:a,itemProps:s}=e,c=(0,n().O7)(),d=(0,K().X7)(),p=(0,r().yK)((e=>({featureIconWrapper:{...d.featureIconWrapper,backgroundColor:e.accentColors.blue[30]},featureIcon:{...d.featureIcon,fill:e.accentColors.blue[400]}})),[d]);return(0,O.jsx)(b().Z,{showImage:!0,caption:a.description,tooltipImage:null===(t=a.tooltipImage)||void 0===t?void 0:t.img,tooltipImageScale:null===(o=a.tooltipImage)||void 0===o?void 0:o.scale,render:e=>(0,O.jsx)(R().Ny,{collectionContextStore:i,feature:a,caption:a.description,buttonMenuItemProps:{...(0,M().Z)(s,e)},icon:(0,O.jsx)("div",{style:p.featureIconWrapper,children:(0,u().r)(p.featureIcon)}),right:(0,O.jsx)(H().H,{focused:s.focused}),onClick:()=>function(e){const{collectionContextStore:t,environment:o}=e;A().Z.setState({isModalOpen:!0,databaseType:l().Ym,collectionContextStore:t}),m().gd({environment:o,database_type:l().Ym,collectionContextStore:t})}({environment:c,collectionContextStore:i})})})}function U(e){const{collectionContextStore:t,feature:o,itemProps:i}=e,l=(0,n().O7)(),a=(0,K().X7)(),s=(0,r().yK)((e=>({featureIconWrapper:{...a.featureIconWrapper,backgroundColor:e.accentColors.blue[30]},featureIcon:{...a.featureIcon,fill:e.accentColors.blue[400]}})),[a]);return(0,O.jsx)(F().Y4,{collectionContextStore:t,feature:o,itemProps:i,icon:(0,O.jsx)("div",{style:s.featureIconWrapper,children:(0,u().r)(s.featureIcon)}),onClick:q({environment:l,collectionContextStore:t})})}function z(){const e=(0,r().yK)((e=>({confirmationModalDescription:{fontSize:12,display:"flex",textAlign:"center"}})),[]);return(0,O.jsx)("span",{style:e.confirmationModalDescription,children:(0,O.jsx)(p()._H,{id:"CollectionTaskTypeBadge.MoreMenu.RemoveFromHome.description",defaultMessage:"Tasks from this database will no longer appear in Home or work with Sprints."})})}function W(){const e=(0,r().yK)((e=>({confirmationModalTitle:{fontWeight:500},wrapper:{textAlign:"center"}})),[]);return(0,O.jsx)("div",{style:e.wrapper,children:(0,O.jsx)("span",{style:e.confirmationModalTitle,children:(0,O.jsx)(p()._H,{id:"CollectionTaskTypeBadge.UntypeDatabase.modal.title",defaultMessage:"Undo Task Database?"})})})}function q(e){const{environment:t,collectionContextStore:o}=e,n=[{label:(0,O.jsx)(p()._H,{id:"CollectionTaskTypeBadge.UntypeDatabase.modal.confirm",defaultMessage:"Remove"}),color:"red",onAccept:()=>{h().createAndCommit({environment:t,userAction:"CollectionTaskTypeBadge.untypeDatabase",canUndo:!0,perform:e=>{x().RQ({environment:t,collectionContextStore:o,transaction:e})}})}}];return()=>{S().vC({message:(0,O.jsx)(W,{}),description:(0,O.jsx)(z,{}),showCancel:!0,keepFocus:!0,items:n})}}const G=(0,p().vU)({featureName:{id:"feature.sprints.name",defaultMessage:"Sprints"},featureDescription:{id:"feature.sprints.description",defaultMessage:"Plan tasks in cycles with sprints"}}),Y={uri:"notion://feature/sprints_feature",name:_().Z.formatMessage(G.featureName),description:_().Z.formatMessage(G.featureDescription),tooltipImage:{img:a().Z.images.tooltips.properties.sprintsPng,scale:.5},icon:"/icons/run_gray.svg",collectionUri:B().x,isFeatureAdded:function(e,t){var o;if(e.uri!==Y.uri)return!1;const n=null===(o=t.sprintSettingsContextStore.state)||void 0===o?void 0:o.permissionsContext;if(!n)return!1;return n.canEdit&&n.sprintsEnabled},getSuggestedFeatureMenuItem:e=>(0,O.jsx)($,{collectionContextStore:e.collectionContextStore,collectionSettingsStore:e.collectionSettingsStore,feature:e.feature,itemProps:e.itemProps}),getAddedFeatureMenuItem:e=>(0,O.jsx)(Q,{collectionContextStore:e.collectionContextStore,collectionSettingsStore:e.collectionSettingsStore,feature:e.feature,itemProps:e.itemProps})};function $(e){var t,o;const{collectionContextStore:n,collectionSettingsStore:i,feature:l,itemProps:a}=e,s=(0,K().X7)(),c=(0,r().yK)((e=>({featureIconWrapper:{...s.featureIconWrapper,backgroundColor:e.accentColors.blue[30]},featureIcon:{...s.featureIcon,fill:e.accentColors.blue[400]}})),[s]);return(0,O.jsx)(b().Z,{showImage:!0,caption:l.description,tooltipImage:null===(t=l.tooltipImage)||void 0===t?void 0:t.img,tooltipImageScale:null===(o=l.tooltipImage)||void 0===o?void 0:o.scale,render:e=>(0,O.jsx)(R().Ny,{collectionContextStore:n,feature:l,caption:l.description,buttonMenuItemProps:{...(0,M().Z)(a,e)},icon:(0,O.jsx)("div",{style:c.featureIconWrapper,children:(0,u().r)(c.featureIcon)}),right:(0,O.jsx)(H().H,{focused:a.focused}),onClick:()=>f().H4({collectionSettingsStore:i,item:{type:"sprintSettings",from:"customize_menu"}})})})}function Q(e){const{collectionContextStore:t,collectionSettingsStore:o,feature:n,itemProps:i}=e,l=(0,K().X7)(),a=(0,r().yK)((e=>({featureIconWrapper:{...l.featureIconWrapper,backgroundColor:e.accentColors.blue[30]},featureIcon:{...l.featureIcon,fill:e.accentColors.blue[400]}})),[l]);return(0,O.jsx)(F().Y4,{collectionContextStore:t,feature:n,itemProps:i,icon:(0,O.jsx)("div",{style:a.featureIconWrapper,children:(0,u().r)(a.featureIcon)}),onClick:()=>f().H4({collectionSettingsStore:o,item:{type:"sprintSettings",from:"customize_menu"}})})}const J=(0,p().vU)({githubFeatureDescription:{id:"customizeMenu.github.featureDescription",defaultMessage:"Link PRs and set up automated task status updates based on PR changes"},googleDriveFeatureDescription:{id:"customizeMenu.googleDrive.featureDescription",defaultMessage:"Link Google Drive files"},figmaFeatureDescription:{id:"customizeMenu.figma.featureDescription",defaultMessage:"Link Figma pages"},zendeskFeatureDescription:{id:"customizeMenu.zendesk.featureDescription",defaultMessage:"Link Zendesk tickets"}}),X=[c().f3,c().U9,c().mQ,c().Nw],ee="notion://feature/connection_",te=`${ee}${c().U9}`,oe=`${ee}${c().f3}`,ne=`${ee}${c().mQ}`,ie=`${ee}${c().Nw}`,re={[c().U9]:`${ee}property_${c().U9}`,[c().f3]:`${ee}property_${c().f3}`,[c().mQ]:`${ee}property_${c().mQ}`,[c().Nw]:`${ee}property_${c().Nw}`},le={[c().U9]:J.githubFeatureDescription,[c().f3]:J.googleDriveFeatureDescription,[c().mQ]:J.figmaFeatureDescription,[c().Nw]:J.zendeskFeatureDescription},ae={[c().U9]:a().Z.images.tooltips.properties.githubSyncPullStatusPng,[c().f3]:a().Z.images.tooltips.properties.googleDrivePng,[c().mQ]:a().Z.images.tooltips.properties.figmaPng,[c().Nw]:a().Z.images.tooltips.properties.zendeskPng};function se(){const e=(0,i().VK)((()=>{var e;return null===(e=I().default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit()}),[]),t=(0,i().VK)((()=>V().default.integrations.state),[]);return(0,i().VK)((()=>e?X.map((e=>{const o=t.find((t=>t.id===e));if(!o)return;const n=o.id===c().U9?(0,v().GT)().name:o.name;return{uri:`${ee}${e}`,name:n,description:_().Z.formatMessage(le[e]),icon:o.info.icon,tooltipImage:{img:ae[e],scale:.5},collectionUri:B().x,integrationId:e,isFeatureAdded:(e,t)=>Boolean(ue(t,e.integrationId)),getSuggestedFeatureMenuItem:e=>(0,O.jsx)(ce,{collectionContextStore:e.collectionContextStore,feature:e.feature,itemProps:e.itemProps}),getAddedFeatureMenuItem:e=>(0,O.jsx)(de,{collectionContextStore:e.collectionContextStore,feature:e.feature,itemProps:e.itemProps})}})).filter(g().$K):[]),[e,t])}function ce(e){var t,o;const{collectionContextStore:i,feature:r,itemProps:l}=e,a=(0,n().O7)(),s=(0,p().YB)(),d=(0,K().X7)();return(0,O.jsx)(b().Z,{showImage:!0,caption:r.description,tooltipImage:null===(t=r.tooltipImage)||void 0===t?void 0:t.img,tooltipImageScale:null===(o=r.tooltipImage)||void 0===o?void 0:o.scale,render:e=>(0,O.jsx)(R().Ny,{collectionContextStore:i,feature:r,caption:r.description,buttonMenuItemProps:{...(0,M().Z)(l,e)},icon:(0,O.jsx)("div",{style:d.featureIconWrapper,children:(0,O.jsx)(w().ZP,{style:d.featureIcon,src:r.icon})}),right:(0,O.jsx)(H().H,{focused:l.focused}),onClick:()=>async function(e){var t;const{environment:o,collectionContextStore:n,feature:i,intl:r}=e,l=V().default.integrations.state.find((e=>e.id===i.integrationId)),a=null==l||null===(t=l.info.original_url_patterns)||void 0===t?void 0:t.find((e=>{var t;return null===(t=e.additional_types)||void 0===t?void 0:t.connectedRelation}));if(!l||!a||!i.integrationId)return;const s={name:l.id===c().U9?(0,v().GT)().name:(0,P().ni)({pattern:a,integration:l}),pattern:a,integration:l};await y().Jw({environment:o,collectionContextStore:n,connectedRelationProperty:s,intl:r,from:"customize_menu",untypedFeatureArgs:{propertyId:re[i.integrationId]},propertyGroupId:void 0}),(0,Z().O)({featureName:i.name})}({environment:a,collectionContextStore:i,intl:s,feature:r})})})}function de(e){const{collectionContextStore:t,feature:o,itemProps:n}=e,i=(0,K().X7)(),r=o.integrationId;return r?(0,O.jsx)(F().Y4,{collectionContextStore:t,feature:o,itemProps:n,icon:(0,O.jsx)("div",{style:i.featureIconWrapper,children:(0,O.jsx)(w().ZP,{style:i.featureIcon,src:o.icon})}),onClick:()=>{const e=ue(t,r);e?(0,F().D3)({collectionContextStore:t,property:e}):d().log({level:"error",from:"CustomComponentFeatures",type:"ConnectionFeatureMissingPropertyId",error:{miscDataString:`Feature ${o.name} has no relation property ID.`}})}}):(d().log({level:"error",from:"CustomComponentFeatures",type:"ConnectionFeatureMissingIntegrationId",error:{miscDataString:`Feature ${o.name} has no integration ID.`}}),null)}function ue(e,t){var o;const n=null===(o=e.collectionStore())||void 0===o?void 0:o.getSchema();if(n&&t)for(const[i,r]of Object.entries(n))if(r&&(0,s().NK)(r)&&r.connectedRelation.integration_id===t)return i}},200528:(e,t,o)=>{"use strict";o.d(t,{MG:()=>R,UL:()=>ee,X7:()=>X,Xf:()=>G,ZJ:()=>Q,fX:()=>O,k3:()=>J,qs:()=>$});o(670560),o(267602),o(916054),o(653476),o(470928),o(30005),o(241792),o(228244);var n=o(667294),i=()=>o(219727),r=()=>o(142735),l=()=>o(846550),a=()=>o(926724),s=()=>o(197874),c=()=>o(570270),d=()=>o(788860),u=()=>o(18610),p=()=>o(513670),g=()=>o(250303),m=()=>o(139224),f=()=>o(853292),y=()=>o(269299),S=()=>o(763707),h=()=>o(2971),x=()=>o(630824),v=()=>o(790663),C=()=>o(178741),b=()=>o(261333),w=()=>o(253335),j=()=>o(10829),_=()=>o(110232),M=()=>o(810374),k=()=>o(427886),P=()=>o(527278),T=()=>o(549813),I=()=>o(876822),V=()=>o(584989),A=()=>o(591909),Z=()=>o(503375),B=()=>o(259083);const F=(0,d().vU)({databaseNamePlaceholder:{id:"customizeMenu.databaseNamePlaceholder",defaultMessage:"database"}});function R(e){return(0,r().VK)((()=>{var t;if(!e)return;const o=null===(t=e.collectionStore())||void 0===t?void 0:t.getDatabaseType();return o?(0,_().YB)((0,h().appConfigs)(),o):void 0}),[e])}function K(e){const{collectionFormat:t,feature:o}=e,n=t.app_config_uri;return o.collectionUri===n&&o.dependencies.some((e=>"property"===e.type&&e.collectionUri===n&&(0,s().Pf)(e.uri)))}function H(e){const{environment:t,collectionStore:o,collectionFormat:n,collectionViewBlockStore:i,feature:r}=e;if(1!==r.dependencies.length||"collection_view"!==r.dependencies[0].type)return!1;if(r.uri===(0,w().yf)().uri)return!1;const l=r.dependencies[0];return l.collectionViewBlockUri===i.getFormat().app_config_uri&&l.collectionUri===n.app_config_uri&&(0,_().Ep)({environment:t,viewDependency:l,collectionStore:o})}function O(e,t){const o=(0,i().O7)(),n=R(e),l=[(0,w().EG)(),(0,w().tQ)(),...j().rc],s=(0,B().l9)(e);return(0,r().VK)((()=>{var t,i;if(!n){return q([...l,...s],a().br)}const r=null===(t=e.collectionStore())||void 0===t?void 0:t.getFormat(),c=null===(i=e.collectionStore())||void 0===i?void 0:i.getSchema(),d=e.collectionStore(),u=e.collectionViewBlockStore();if(!(r&&c&&d&&u))return[];const g={};n.allFeatures.forEach((e=>{(0,_().Dl)(e)&&e.variants.every((e=>Boolean(n.allFeatures.find((t=>t.uri===e&&(0,_().BQ)(t)&&K({collectionFormat:r,feature:t}))))))&&(g[e.uri]=e.variants)}));const m=Object.values(g).flat(),f=[];for(const e of n.allFeatures)if(!f.find((t=>t.uri===e.uri)))if(!m.find((t=>t===e.uri))&&(0,_().BQ)(e)){const t=K({collectionFormat:r,feature:e}),n=H({environment:o,collectionStore:d,collectionFormat:r,collectionViewBlockStore:u,feature:e});(t||n)&&f.push(e)}else(0,_().Dl)(e)&&Boolean(g[e.uri])&&f.push(e);const y=[...l,...s,...f];return q(p().mN(y,"uri"),e.databaseType)}),[n,e,l,s,o])}const L={[(0,w().EG)().uri]:1,[(0,w().tQ)().uri]:2,[B().xb.uri]:3,[(0,j().my)().uri]:4,[(0,j().B4)().uri]:5,[(0,j().ad)().uri]:6,[(0,j().dr)().uri]:7,[B().xg]:8,[B().$e]:9,[B().yM]:10,[B().XR]:11},D={[(0,w().Mh)().uri]:1,[(0,w().EG)().uri]:2,[(0,w().tQ)().uri]:3,[B().xb.uri]:4,[(0,w().PW)().uri]:5,[(0,w().FK)().uri]:6,[(0,w().bJ)().uri]:7,[(0,j().my)().uri]:8,[(0,j().B4)().uri]:9,[(0,j().ad)().uri]:10,[(0,j().dr)().uri]:11,[(0,w().yf)().uri]:12,[(0,w().yt)().uri]:13,[(0,w().jJ)().uri]:14,[(0,w().iB)().uri]:15,[(0,w().oK)().uri]:16,[(0,w().AE)().uri]:17,[B().w_.uri]:18,[B().$e]:19,[B().xg]:20,[B().yM]:21,[B().XR]:22},E={[(0,C().eh)().uri]:1,[(0,w().EG)().uri]:2,[(0,w().tQ)().uri]:3,[(0,C().LO)().uri]:4,[(0,j().my)().uri]:5,[(0,j().B4)().uri]:6,[(0,j().ad)().uri]:7,[(0,j().dr)().uri]:8,[(0,C().xU)().uri]:9,[(0,C().QN)().uri]:10,[(0,C().LM)().uri]:11,[(0,C().f3)().uri]:12,[(0,C().Np)().uri]:13,[B().$e]:14,[B().yM]:15,[B().XR]:16},N={[B().w_.uri]:1,[(0,b().YI)().uri]:2,[(0,w().EG)().uri]:3,[(0,w().tQ)().uri]:4,[(0,C().LO)().uri]:5,[(0,j().my)().uri]:6,[(0,j().B4)().uri]:7,[(0,j().ad)().uri]:8,[(0,j().dr)().uri]:9,[(0,b().Ez)().uri]:10,[B().$e]:11,[B().yM]:12,[B().XR]:13},U={[(0,w().EG)().uri]:1,[(0,w().tQ)().uri]:2,[(0,v().Gn)().uri]:3,[(0,v().nt)().uri]:4,[(0,v().Si)().uri]:5,[(0,v().Lm)().uri]:6,[(0,v().nt)().uri]:7,[(0,v().Hs)().uri]:8,[(0,j().my)().uri]:9,[(0,j().B4)().uri]:10,[(0,j().ad)().uri]:11,[(0,j().dr)().uri]:12,[B().$e]:13,[B().yM]:14,[B().XR]:15},z={[(0,w().EG)().uri]:1,[(0,w().tQ)().uri]:2,[(0,x().Tg)().uri]:3,[(0,x().ir)().uri]:4,[(0,j().my)().uri]:7,[(0,j().B4)().uri]:8,[(0,j().ad)().uri]:9,[(0,j().dr)().uri]:10,[B().$e]:11,[B().yM]:12,[B().XR]:13},W={[a().br]:L,[a().Ym]:D,[a().wW]:E,[a().p$]:N,[a().Fi]:U,[a().zU]:z};function q(e,t){if(!t)return e;const o=W[t];return o?e.filter((e=>void 0!==o[e.uri])).sort(((e,t)=>(o[e.uri]??1/0)-(o[t.uri]??1/0))):e}function G(e,t){const o=R(e);return(0,r().VK)((()=>{const n=e.collectionStore(),i=e.collectionViewBlockStore(),r=[],l=[];if(!n||!i)return{addedFeatures:r,suggestedFeatures:l};for(const a of t)Y({collectionContextStore:e,feature:a,appConfig:o})?r.push(a):l.push(a);return{addedFeatures:r,suggestedFeatures:l}}),[t,o,e])}function Y(e){const{collectionContextStore:t,feature:o,appConfig:n}=e;if((0,Z().I)(o))return o.isFeatureAdded(o,t);if((0,_().BQ)(o)||(0,_().EU)(o))return $({collectionContextStore:t,feature:o});return Q(o,null==n?void 0:n.allFeatures).some((e=>$({collectionContextStore:t,feature:e})))}function $(e){const{collectionContextStore:t,feature:o}=e,n=t.collectionStore();if(o.uri===(0,w().EG)().uri)return Boolean(t.currentSubitemFormatStoreForCollectionStore.state);if(o.uri===(0,w().tQ)().uri){const e=(0,M().Xy)({feature:"timeline_arrows_by",collectionContextStore:t});return Boolean(e)}const i=c().aQ.derivePropertyUris((null==n?void 0:n.getSchema())??{},null==n?void 0:n.getPropertyMapping());return o.dependencies.some((e=>{const o="property"===e.type&&function(e){var t;const{collectionContextStore:o,dependency:n,propertyUris:i}=e,r=null===(t=o.collectionStore())||void 0===t?void 0:t.getDatabaseType();if(n.collectionUri===r)return(0,s().Pf)(n.uri)&&i.has(n.uri);if((0,s().Tx)(n.collectionUri))return(0,s().ky)(n.uri)&&i.has(n.uri);return!1}({dependency:e,collectionContextStore:t,propertyUris:i}),n="collection_view"===e.type&&function(e){var t;const{collectionContextStore:o,dependency:n}=e,i=o.collectionViewBlockStore(),r=null===(t=o.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.app_config_uri;if(!i||!r)return!1;var l,a;return n.collectionUri===r?n.collectionViewBlockUri===i.getFormat().app_config_uri&&n.uri in((null===(l=i.getFormat())||void 0===l?void 0:l.app_uri_map)??{}):!!(0,s().Tx)(n.collectionUri)&&n.uri in((null===(a=i.getFormat())||void 0===a?void 0:a.app_uri_map)??{})}({dependency:e,collectionContextStore:t});return o||n}))}function Q(e,t){return p().oA(e.variants.map((e=>{const o=null==t?void 0:t.find((t=>t.uri===e));if(o&&(0,_().BQ)(o))return o})))}function J(e,t){const o=(0,i().O7)(),l=function(e){const t=(0,i().O7)(),o=R(e),l=(0,r().VK)((()=>I().default.state.currentSpaceViewStore),[]),a=(0,r().VK)((()=>e.collectionViewBlockStore()),[e]);return(0,n.useCallback)(((n,i)=>{if(!a||!o||!l)return;const r=a.getParentStore();if(!r||"block"!==r.table&&"space"!==r.table&&"team"!==r.table)return;if(1!==n.dependencies.length)return;const s=n.dependencies[0];y().createAndCommit({userAction:"CollectionViewSuggestedViews.createView",environment:t,canUndo:!0,perform:c=>{var d;S().applyTypedFeatures({environment:t,spaceViewStore:l,appParentStore:r,appUri:o.uri,features:[{type:"simple",featureUri:n.uri}],appCollectionViewBlockStores:[a],createOrModify:"modify",transaction:c});const u=((null===(d=a.getFormat())||void 0===d?void 0:d.app_uri_map)??{})[s.uri];(0,k().f)({environment:t,collectionContextStore:e,collectionViewId:u,isFullScreen:e.isFullScreenStore.state,isRootChild:e.isRootChildStore.state,isInPeekRenderer:e.isInPeekRendererStore.state}),g().xb({environment:t,collectionContextStore:e,view_type:s.value.type,view_config_uri:n.uri,feature:{id:u,from:i,type:n.uri}})}})}),[a,o,l,t,e])}(e);return(0,n.useCallback)((async n=>{if(n.uri===(0,w().EG)().uri)m().H4({collectionSettingsStore:t,item:{type:"subitemV2",from:"customize_menu"}});else if(n.uri===(0,w().tQ)().uri)m().H4({collectionSettingsStore:t,item:{type:"dependencies",from:"customize_menu"}});else{const t=n.dependencies[0];"collection_view"===t.type||"collection_view_block"===t.type||"sub_external_collection"===t.type?(l(n,"customize_menu"),V().ZP.setState({...V().ZP.state,shouldReset:!1}),(0,A().O)({featureName:n.name})):(await f().G0({environment:o,feature:n,collectionContextStore:e,addFeatureFrom:"customize_menu"}),(0,A().O)({featureName:n.name}))}}),[o,e,t,l])}function X(){return(0,l().yK)((()=>({featureIconWrapper:{height:28,width:28,padding:"6px 0px",borderRadius:4},featureIcon:{width:16,height:16,alignItems:"center",margin:"auto"}})),[])}function ee(e){const t=(0,i().O7)(),o=(0,d().YB)();return(0,r().VK)((()=>{var n;const i=(null===(n=I().default.state.currentUserSettingsStore)||void 0===n||null===(n=n.getSettings())||void 0===n?void 0:n.preferred_locale)||u().al;if("ja-JP"===i||"ko-KR"===i)return"";const r=e.collectionStore();return null!=r&&r.getName()?(0,T().vU)({environment:t,intl:o,store:r,untitledFallback:F.databaseNamePlaceholder}):P().Z.formatMessage(F.databaseNamePlaceholder)}),[t,o,e])}},503375:(e,t,o)=>{"use strict";o.d(t,{I:()=>i,x:()=>n});const n="custom_component";function i(e){return!("dependencies"in e)&&e.collectionUri===n}},64509:(e,t,o)=>{"use strict";o.d(t,{I:()=>r});var n=()=>o(714230),i=()=>o(109477);const r={[i().Vj.Jira]:n().Z.images.externalIntegrations.jiraPng,[i().Vj.Salesforce]:n().Z.images.externalIntegrations.salesforcePng}},766463:(e,t,o)=>{"use strict";o.d(t,{s:()=>N});o(670560),o(122556),o(582845),o(250570),o(533019),o(721473),o(788208),o(22624),o(267602),o(653476),o(241792),o(228244);var n=o(667294),i=()=>o(629013),r=()=>o(219727),l=()=>o(142735),a=()=>o(511115),s=()=>o(364402),c=()=>o(565630),d=()=>o(647834),u=()=>o(752778),p=()=>o(899133),g=()=>o(788860),m=()=>o(513670),f=()=>o(855741),y=()=>o(696459),S=()=>o(326966),h=()=>o(824462),x=()=>o(505789),v=()=>o(594546),C=()=>o(43721),b=()=>o(15981),w=()=>o(549813),j=()=>o(8),_=()=>o(90065),M=()=>o(778265),k=()=>o(620218),P=()=>o(828946),T=()=>o(98228),I=()=>o(870391),V=()=>o(876822),A=()=>o(804217),Z=()=>o(749826),B=()=>o(63317),F=()=>o(485014),R=()=>o(21965),K=()=>o(826955);class H extends(()=>o(263184))().default{getInitialState(){return{query:void 0,localResults:[],numTotalLocalResults:0,serverResults:[],numTotalServerResults:0,searchSessionId:(0,o(956057).Il)(),isResultsLoading:!1}}}const O=H;var L=()=>o(677559),D=()=>o(466970),E=()=>o(358565);function N(e){var t;const{searchQuery:o,limit:H,source:N,type:W,disable:q,overrideSpaceStore:G,overrideSearchSessionId:Y,usePrefetch_EXPERIMENTAL:$,isTitleOnly:Q=!0}=e,J=(0,r().O7)(),X=(0,g().YB)(),ee=(0,c().D9)(o),te=(0,c().D9)(e.filters),oe=(0,n.useRef)(0),ne=(0,n.useRef)(!0),ie=(0,l().VK)((()=>A().default.state.online),[]),re=(0,l().VK)((()=>e.isLocalOnlyMode||!ie),[ie,e.isLocalOnlyMode]),le=(0,M().P)(),ae=(0,n.useMemo)((()=>new O),[]),se=(0,l().VK)((()=>Y&&Y!==ae.state.searchSessionId?(ae.update((e=>({...e,searchSessionId:Y}))),Y):ae.state.searchSessionId),[ae,Y]),ce=(0,D().E)("search_quickfind_only_show_title_matches"),{searchLocalResults:de,searchServerResults:ue,isResultsLoading:pe,numTotalLocalResults:ge,numTotalServerResults:me}=(0,l().VK)((()=>({searchLocalResults:ae.state.localResults,searchServerResults:ae.state.serverResults,isResultsLoading:ae.state.isResultsLoading,numTotalLocalResults:ae.state.numTotalLocalResults,numTotalServerResults:ae.state.numTotalServerResults})),[ae]),fe=(0,l().VK)((()=>{if(re||pe&&ne.current)return de;let e=[];return e="mini_quick_find"===N?function(e){const{localResults:t,serverResults:o,includeNonTitleMatches:n,query:i,environment:r,intl:l}=e,a=t.map((e=>e.store.id)),s=new Set(a),c=o.filter((e=>!s.has(e.store.id))),d=c.filter((e=>{const t=(0,w().V)(e.store,l,r,!1);return(0,I().B)({query:i,resultText:t??"",isLastQueryTermPartialMatchOK:!0})})),u=c.filter((e=>!d.includes(e)));if(n)return[...t,...d,...u];return[...t,...d]}({localResults:de,serverResults:ue,includeNonTitleMatches:!ce,query:o,environment:J,intl:X}):function(e){const{localResults:t,serverResults:o}=e,n=t.map((e=>e.store.id)),i=new Set(n),r=o.filter((e=>!i.has(e.store.id)));return[...t,...r]}({localResults:de,serverResults:ue}),W===p().n8.CollectionsInSpace&&(e=z(e)),e}),[re,pe,de,ue,W,o,N,J,X,ce]),ye=(0,l().VK)((()=>G||V().default.state.currentSpaceStore),[G]),Se=(0,l().VK)((()=>"on"===Z().default.getEligibleGroup({experimentId:"search-use-local-reranker-layered",parameter:"shouldUseLocalReranker",defaultGroup:"control"})),[]),he=(0,l().VK)((()=>re&&ie&&Boolean($)),[re,ie,$]),xe=(0,l().VK)((()=>(0,j().bC)(J).hasPublicAccessPermission),[J]),ve=(0,n.useMemo)((()=>{const t={navigableBlockContentOnly:Q,...e.filters};return(0,p().u4)(t)}),[e.filters,Q]),Ce=(0,n.useMemo)((()=>{var t;return function(e){const{blockTypes:t,queryType:o}=e;switch(o){case p().n8.CollectionsInSpace:return["collection_view","collection_view_page"];case p().n8.BlocksInCollection:return["page","collection_view_page"];case p().n8.BlocksInSpace:default:return[...t??[]]}}({blockTypes:null===(t=e.filters)||void 0===t?void 0:t.blockTypes,queryType:W})}),[null===(t=e.filters)||void 0===t?void 0:t.blockTypes,W]),be=(0,n.useCallback)(((e,t)=>{const{isSuccess:o,totalResultsCount:n,localCacheMetadata:i,query:r}=t;k().default.measure(e,{environment:J,data:{start_time:e.startTime,success:o,surface:N,num_results:n,search_session_id:se,local_cache_metadata:i,local_cache_readiness_timings:F().Z.state.readinessTimings,query_length:r.length}})}),[J,N,se]),we=(0,n.useCallback)(((e,t)=>{const{isSuccess:o,totalResultsCount:n,query:i}=t;k().default.measure(e,{environment:J,data:{start_time:e.startTime,success:o,surface:N,num_results:n,search_session_id:se,search_session_flow_number:oe.current,query_length:i.length}})}),[J,N,se]),je=(0,L().XJ)(P().x.searchActions),_e=(0,n.useCallback)((e=>{const t=k().default.mark("rum.local_quick_search_query"),{query:o,spaceStore:n}=e,i=le&&!ie&&(0,y().DE)(p().gT,N);if("resolved"!==je.status)return;const r=W===p().n8.CollectionsInSpace;let l=[];0===o.length&&r&&(l=function(e){const{spaceStore:t,environment:o}=e,n=(0,x().l)({currentUserId:o.currentUser.id,spaceId:t.id}).map((e=>{const o=K().NW.createChildStore(t,{table:u().vF,id:e}).getParentBlockStore();if(null==o?void 0:o.pathIsAccessibleAndAlive())return o}));return(0,m().oA)(n)}({environment:J,spaceStore:n}).map(((e,t)=>({store:e,originalPosition:t,id:e.id,score:0,spaceId:e.getSpaceId(),sources:[p().vp.Local],featureGroups:[],serverEventProperties:void 0}))));const a=F().Z.state.localSearchableBlocksCache,s=(0,C().U)({environment:J,overrideCurrentUserId:J.currentUser.id,overrideSpaceId:n.id,overrideLocalSearchableBlocksCache:a}),c=(0,E().NH)({environment:J,parentStore:n,isOnline:ie,requestInput:{query:{text:o,filters:{...ve,blockTypes:Ce,isOfflineOnly:i},sort:{field:"relevance"}},limit:re?H:Math.min(H,5)},localSearchCache:a,shouldUseNewRerankerDebugOverrideEnabled:Se,shouldLimitLocalResultsWhenOnline:!re,hasPublicAccessPermission:xe}),d=he?U({query:o,serverResults:Ke.current}):[],g=c&&f().x.unwrapOr(c,void 0),S=(null==g?void 0:g.results)??[],h=(null==g?void 0:g.total)??0;let v=m().mN([...l,...S,...d],(e=>e.id));v=r?z(v):v,ae.update((e=>e.query!==o?e:(Oe.current=v.map((e=>e.id)),be(t,{query:o,isSuccess:Boolean(g),totalResultsCount:h,localCacheMetadata:s}),{...e,localResults:v,isResultsLoading:!re&&e.isResultsLoading,numTotalLocalResults:h})))}),[Ce,J,ve,xe,re,ie,le,H,je.status,ae,Se,W,be,he,N]),Me="mini_quick_find"===N?40:T().E5,ke=(0,i().y)(_e,Me),Pe=(0,n.useCallback)((e=>{const{result:t,isMetaClick:n,context:i}=e,r=(0,w().V)(t.store,X,J,!1),l=(0,I().B)({query:o,resultText:r??"",isLastQueryTermPartialMatchOK:!0});(0,v().j)({environment:J,event:{eventName:"select_search_item",eventProperties:{sources:t.sources,localSources:Array.from(t.localSource||new Set),searchSessionId:se,searchSessionFlowNumber:oe.current,context:i,queryStringLength:o.length,isTitleMatch:l,totalSearchResultCount:ge+me,numLocalResults:de.length,numTotalLocalResults:ge,isMobile:J.device.isMobile,isMetaClick:n,hasFilters:Boolean(ve),originalPosition:t.originalPosition,selectedItemIndex:t.originalPosition,selectedSearchResultMetadata:{blockId:t.id,blockType:t.store.getModel().type},searchSource:N,verificationState:(0,_().T7)(t.store)}}})}),[J,ge,me,de,o,se,oe,ve,N,X]),Te=ee===o,Ie=m().Xy(te,e.filters),Ve=Boolean(ee&&!o),Ae=Ie&&Te,Ze=!q&&ye&&!Ae,Be=Ve||!Ie,Fe=(0,n.useRef)(!1),Re=(0,n.useRef)([]),Ke=(0,n.useRef)([]),He=(0,n.useRef)([]),Oe=(0,n.useRef)([]),Le=(0,l().VK)((()=>{if("mention_menu"!==N)return;return R().Z.getMentionedIds(J.currentUser.id)}),[J.currentUser.id,N]),De=(0,n.useCallback)((async e=>{const t=k().default.mark("rum.server_quick_search_query"),{query:o,spaceStore:n,size:i}=e,r=n.id;if(re&&!he)return;const l=!ne.current&&Ie?Re.current:[],a=he?U({query:o,serverResults:Ke.current}):[];if(he&&(o.length<=1||a.length>=5||He.current.some((e=>e===o))))return;He.current.push(o);const c=await h().callApi({eventName:"search",environment:J,data:{type:W,query:o,spaceId:r,collectionId:(null==ve?void 0:ve.parentId)??"",limit:"mini_quick_find"===N?10:i+1,filters:ve,sort:{field:"relevance"},source:N,searchSessionId:se,searchSessionFlowNumber:oe.current,recentlyMentionedPageIds:Le,recentPagesForBoosting:(0,b().Wk)(B().Z.getWithoutSubscribing(r)),excludedBlockIds:m().jj([...l.map((e=>e.id)),...Oe.current||[],...Ke.current.map((e=>e.id))]),ignoresHighlight:!0}});if(!c||"failed"===c.type)return;const u=c.data.total,p=(0,S().m8)((0,y().qP)(c.data.trackEventProperties).map((e=>{let[t,o]=e;return[`server-${t}`,o]}))),g=c.data.results.slice(0,i).map(((e,t)=>{const o=K().G.createChildStore(n,{id:e.id,spaceId:e.spaceId,table:"block"}),i=he?function(e){const{result:t,store:o,environment:n}=e;if(t.terms)return t.terms;const i=o.getModel();if(!i)return[];const r=n.defaultRecordCache.inMemoryRecordCache.makeGetRecordValueFn(n.currentUser.id),l=(0,d().$B)((0,s().ut)({blockValue:i,getRecordValue:r}).text);if(!l)return[];return(0,I().y)(l)}({environment:J,store:o,result:e}):e.terms;return{store:o,originalPosition:t,...e,serverEventProperties:p,terms:i}}));Fe.current=!(u<=i);const f=[...l,...g];Re.current=f,Ke.current=m().mN([...he?g:[],...Ke.current],(e=>e.id)),he||(ae.update((e=>e.query!==o?e:(we(t,{query:o,isSuccess:"success"===c.type,totalResultsCount:u}),{...e,serverResults:f,isResultsLoading:!1,numTotalServerResults:u}))),oe.current+=1)}),[re,Ie,J,W,ve,N,se,Le,Oe,ae,we,he]),Ee=(0,n.useCallback)((e=>{!q&&ye&&Fe.current&&!pe&&ie&&(ae.update((e=>({...e,isResultsLoading:!0}))),Fe.current=!1,ne.current=!1,De({query:o,spaceStore:ye,size:e??20}))}),[ye,q,De,ie,pe,o,ae]),Ne="mini_quick_find"===N?100:T().rE,Ue=(0,a().z)(Ee,Ne),ze=(0,i().y)(De,he?0:T().rE);return(0,n.useEffect)((()=>{if(Be){const e=ae.getInitialState();ae.update((t=>({...e,searchSessionId:t.searchSessionId}))),Ke.current=[],He.current=[]}Ze&&(ne.current=!0,ae.update((e=>({...e,isResultsLoading:!0,query:o}))),ke({query:o,spaceStore:ye}),ze({query:o,spaceStore:ye,size:H}))}),[ye,ke,ze,H,o,Ze,ae,Be]),{results:fe,isResultsLoading:pe,searchSessionId:se,fetchAdditionalServerResultsOnChange:!q&&!re&&Fe.current&&Ae?Ue:void 0,searchSessionFlowNumber:oe.current,hasMoreResults:Fe.current,searchAnalytics:{trackSelectSearchItem:Pe}}}function U(e){const{query:t,serverResults:o}=e;return t?o.filter((e=>(0,I().B)({query:t,resultText:(e.terms??[]).join(" "),isLastQueryTermPartialMatchOK:!0}))):[]}function z(e){const t=new Set;return e.filter((e=>{const o=e.store.getCollectionViewSourceCollectionStore();return!(!o||t.has(o.id))&&(t.add(o.id),!0)}))}},754664:(e,t,o)=>{"use strict";o.d(t,{aq:()=>x,pd:()=>h});o(821057);var n=()=>o(890085),i=()=>o(956057),r=()=>o(792197),l=()=>o(308240),a=()=>o(215134),s=()=>o(396136),c=()=>o(139978),d=()=>o(543172),u=()=>o(636340),p=()=>o(269299),g=()=>o(487270),m=()=>o(527278),f=()=>o(826955),y=()=>o(99537),S=()=>o(455962);function h(e){var t,o;const{environment:n,layoutStore:s,relationPropertyId:c,targetCollectionPointer:u,viewName:g,viewIcon:m}=e,h=null===(t=s.getModel())||void 0===t?void 0:t.firstRawModuleOfType("editor"),v=null===(o=s.getModel())||void 0===o?void 0:o.firstRawModuleOfType("viewsMain");if(!h&&!v)throw new Error("Invalid state: no editor or viewsMain module");const{performResult:C}=p().createAndCommit({environment:n,canUndo:!0,perform:e=>{const{inMemoryRecordCache:t}=s;let o,C=v;if(C){var b;if("viewsMain"!==(null===(b=C)||void 0===b?void 0:b.type))throw new Error("Invalid state: editor or viewsMain module is not of the expected type");o=f().G.createChildStore(s,C.collection_view_block_pointer)}else{const t=(0,d().ZP)(),{collectionViewBlockStore:c}=(0,S().O)({environment:n,layoutStore:s,transaction:e});o=c,C={id:t,type:"viewsMain",collection_view_block_pointer:{...o.pointer,spaceId:o.getSpaceId()}};const u=(0,a().B1)(s.getModules(),(e=>"editor"===e.type));if(!u||!h||"form_conditional_modules"===u.area)throw new Error("Invalid state: no editor module");if("views_main_tab_modules"===u.area)throw new Error("Cannot add views main module when editor is already in views main module");p().applyOperation({store:s,transaction:e,operation:r().CI.deleteModuleInArea({pointer:s.pointer,area:l().mt[u.area],moduleId:h.id})}),(0,y().sW)({position:{type:"absolute",area:u.area,index:u.index},module:C,layoutStore:s,transaction:e,environment:n,sessionId:(0,i().Il)(),isPropertyCreation:!1})}if(!C)throw new Error("Invalid state: no views main module");const w=x({environment:n,transaction:e,targetCollectionPointer:u,collectionViewBlockStore:o,viewName:g,viewIcon:m,relationPropertyId:c,inMemoryRecordCache:t});return{viewsMainModule:C,collectionViewBlockPointer:o.pointer,collectionViewPointer:w}},userAction:"viewsModuleActions.addViewToViewsMainModule"});if(!C)throw new Error("Transaction to add collection view to views main module failed");return{viewsMainModule:C.viewsMainModule,collectionViewPointer:C.collectionViewPointer,collectionViewBlockPointer:C.collectionViewBlockPointer}}function x(e){let{environment:t,transaction:o,targetCollectionPointer:r,collectionViewBlockStore:l,viewName:a,viewIcon:d,relationPropertyId:y,inMemoryRecordCache:S}=e;const h=(0,g().$x)({environment:t,table:c().np,spaceId:l.getSpaceId()}).id;let x=d;if(!x&&r){const e=f().t1.createChildStore(l,r).getIcon();null!=e&&e.icon&&(0,n().V2)(e.icon)&&(x=e.icon)}const C={id:h,type:"table",parent_id:l.pointer.id,parent_table:s().iU,space_id:l.getSpaceId(),alive:!0,name:a??m().Z.formatMessage(v.view),format:{hide_linked_collection_name:!0,collection_pointer:r,collection_view_icon:x,...y?{property_filters:[{id:i().Il(),filter:{property:y,filter:{operator:"relation_contains",value:{type:"relative",value:{type:"current_page_in_related_collection"}}}}}]}:{},subitem_display_mode:y?"disabled":void 0}};return p().applyOperation({store:l,operation:{pointer:l.pointer,path:["view_ids"],command:"listAfter",args:{id:h}},transaction:o}),u().ae({environment:t,table:c().np,value:C,inMemoryRecordCache:S,transaction:o}),{id:h,table:c().np,spaceId:l.getSpaceId()}}const v=(0,o(788860).vU)({view:{defaultMessage:"View",id:"pageLayout.viewsModuleActions.defaultViewName"}})},455962:(e,t,o)=>{"use strict";o.d(t,{O:()=>p,c:()=>g});o(821057);var n=()=>o(396136),i=()=>o(139978),r=()=>o(332542),l=()=>o(636340),a=()=>o(269299),s=()=>o(487270),c=()=>o(527278),d=()=>o(826955),u=()=>o(844650);function p(e){const{environment:t,layoutStore:o,transaction:n,options:i}=e,{inMemoryRecordCache:a}=o,s=o.getSpaceId(),c=o.getParentPointer();if(!c||"collection"!==c.table)throw new Error("Invalid state: no collection pointer");if(!s)throw new Error("Cannot add collection view to views main module -- Invalid state: no space id");const d=l().j4({environment:t,type:"collection_view",inMemoryRecordCache:a,transaction:n});r().jG({childStore:d,parentStore:o,transaction:n});const{collectionViewStore:u}=g({environment:t,transaction:n,layoutStore:o,collectionViewBlockStore:d,options:i});return{collectionViewStore:u,collectionViewBlockStore:d}}function g(e){const{environment:t,transaction:o,layoutStore:r,collectionViewBlockStore:p,options:g}=e,{inMemoryRecordCache:m}=r,f=r.getParentPointer();if(!f||"collection"!==f.table)throw new Error("Invalid state: no collection pointer");const y=r.getSpaceId();if(!y)throw new Error("Cannot add collection view to views main module -- Invalid state: no space id");const S=(0,s().$x)({environment:t,table:i().np,spaceId:y}),h={id:S.id,type:"page",parent_id:p.pointer.id,parent_table:n().iU,space_id:y,alive:!0,name:c().Z.formatMessage(u().B.editor),format:{collection_pointer:f,hide_linked_collection_name:!0}};return null!=g&&g.viewsTabId&&(h.format={...h.format,page_layout_pointer:{...r.pointer,views_main_tab_id:g.viewsTabId}}),l().ae({environment:t,table:i().np,value:h,inMemoryRecordCache:m,transaction:o}),a().applyOperation({store:p,operation:{pointer:p.pointer,path:["view_ids"],command:"listBefore",args:{id:S.id}},transaction:o}),{collectionViewStore:d().Xr.createChildStore(p,S)}}},72766:(e,t,o)=>{"use strict";o.d(t,{z:()=>l});var n=o(667294),i=()=>o(251932),r=o(785893);const l=n.forwardRef(((e,t)=>{const{icon:n,name:l,subText:a,disabled:s,...c}=e,d=(0,o(846550).yK)((e=>({iconContainer:{background:"light"===e.mode?e.white:e.accentColors.translucentGray[100],borderWidth:1,borderStyle:"solid",borderColor:"light"===e.mode?e.accentColors.gray[100]:e.accentColors.translucentGray[300],minWidth:32,width:32,height:32,borderRadius:4,overflow:"hidden"},buttonMenuItem:{padding:6},subText:{color:e.lightTextColor,fontSize:12}})),[]);return(0,r.jsx)(o(827973).Z,{...c,disabled:s,disabledFeedback:s,buttonStyle:{margin:0,width:"100%"},style:d.buttonMenuItem,itemMarginLeft:0,ref:t,title:(0,r.jsxs)(i().gq,{gap:8,alignItems:"center",children:[(0,r.jsx)(i().gq,{style:d.iconContainer,alignItems:"center",justifyContent:"center",children:n}),(0,r.jsxs)(i().Ht,{children:[(0,r.jsx)("span",{children:l}),a?(0,r.jsx)("span",{style:d.subText,children:a}):null]})]})})}));l.displayName="AddPageLayoutModuleMenuButton"},204927:(e,t,o)=>{"use strict";o.d(t,{R:()=>m});o(667294);var n=()=>o(142735),i=()=>o(846550),r=()=>o(532850),l=()=>o(766933),a=()=>o(654133),s=()=>o(561933),c=()=>o(164079),d=()=>o(998901),u=()=>o(162178),p=()=>o(72766),g=o(785893);function m(e){const{propertyId:t}=e,{collectionStore:o}=(0,u().J9)(),m=(0,i().Fg)(),f=(0,n().VK)((()=>{if(!o)return;const e=o.getSchema();return(0,r().Qm)({schema:e,property:t})}),[o,t]);if(!f)return null;const y=f.type;return(0,g.jsx)(a().Z,{textWrap:!0,placement:d().Placement.Left,renderTooltip:()=>e.tooltip,disableTooltip:!e.tooltip,render:t=>(0,g.jsx)(p().z,{...(0,c().Z)(t,e),icon:(0,g.jsx)(l().ZP,{size:16,theme:m,icon:f.icon,type:y}),name:f.name,subText:s().SO[y],disabled:e.disabled})})}},579012:(e,t,o)=>{"use strict";o.d(t,{K:()=>s});var n=o(667294),i=()=>o(219727),r=()=>o(142735),l=()=>o(99537),a=()=>o(162178);function s(){const{layoutStore:e,currentModuleSelection:t,setModuleSelection:o,sessionId:s}=(0,a().J9)(),c=(0,i().O7)(),d=(0,r().VK)((()=>{var t;return null===(t=e.getModel())||void 0===t?void 0:t.getLayoutType()}),[e]),u="form"===d?"form_layout_schema":"new_module"===(null==t?void 0:t.type)?t.area:void 0;return(0,n.useCallback)((n=>{const{layoutModule:i,transaction:r}=n;if(!e.getModel()||!u||"form_conditional_modules"===u)return;let a;if("form"===d)a=n.position??{type:"area_relative",area:"form_layout_schema",location:"end_moveable"};else{if("new_module"!==(null==t?void 0:t.type))return;if("form_conditional_modules"===t.area)return;a="views_main_tab_modules"===t.area?{type:"area_relative",area:t.area,viewId:t.viewsMainTabId,location:"end_moveable"}:{type:"area_relative",area:t.area,location:"end_moveable"}}(0,l().sW)({environment:c,sessionId:s,layoutStore:e,position:a,module:i,transaction:r,isPropertyCreation:!1}),o({type:"existing_module",moduleId:i.id,isDragging:!1})}),[u,t,c,e,d,s,o])}},285645:(e,t,o)=>{"use strict";o.d(t,{c:()=>M});var n=o(667294),i=()=>o(142735),r=()=>o(226413),l=()=>o(469753),a=()=>o(561933),s=()=>o(162178),c=()=>o(788860),d=()=>o(654133),u=()=>o(73478),p=()=>o(125659),g=()=>o(998901),m=()=>o(72766),f=()=>o(219727),y=()=>o(61951),S=()=>o(984871),h=()=>o(207874),x=()=>o(269299),v=()=>o(445294),C=()=>o(967092),b=()=>o(347577),w=o(785893);function j(e){var t;const{open:o,originRef:r,settingsViewToOpen:l,propertyType:c,isPropertyEditComplete:d,onPropertyEditComplete:u,onDismiss:p,rollbackIfEditIncomplete:m,collectionContextStore:j,collectionSettingsStore:_}=e,M=null===(t=r.current)||void 0===t?void 0:t.getBoundingClientRect(),k=(0,f().O7)(),{collectionStore:P}=(0,s().PP)(),[T,I]=(0,n.useState)(null),[V,A]=(0,n.useState)(!1),[Z,B]=(0,n.useState)(null);(0,y().Z)((()=>{const e=`CollectionPropertySettingsPopup.createNewProperty.${c}.${Date.now()}`,{performResult:t}=x().createAndCommit({userAction:"CollectionPropertySettingsPopup.createNewProperty",environment:k,canUndo:!0,undoCheckpoint:e,perform:e=>S().G3({environment:k,collectionStore:P,collectionViewArgs:void 0,propertyName:a().SO[c],propertyType:c,transaction:e})});_.update((e=>({...e,stack:[{...l,property:t}],open:!0}))),I(t),B(e)}),o);const F=(0,i().VK)((()=>{if(!T)return!1;const e=P.getSchema()[T];return!!e&&d(e)}),[P,d,T]);(0,n.useEffect)((()=>{F&&T&&!V&&(u(T),A(!0))}),[F,u,T,V]);const{setModuleSelection:R}=(0,s().J9)();return T?(0,w.jsx)(C().ZP,{open:o,popupType:C().kQ.Popup,render:()=>(0,w.jsx)(v().CollectionSettings,{context:b().HV.TopbarFilterPopup,collectionContextStore:j,collectionSettingsStore:_,hideDesktopHeader:!0}),originRect:M,alignmentToOrigin:g().Alignment.Center,placementToOrigin:g().Placement.Bottom,enableOutsideClickDismiss:!0,originGap:4,onDismiss:()=>{!F&&m&&(Z&&h().qB({environment:k,namedRevisionId:Z}),R(void 0)),p()}}):null}function _(e){const{icon:t,name:o,disabled:i,tooltip:l,propertySettingsPopup:a,propertyType:s,...f}=e,{image:y,caption:S}=l||{},h=(0,p().Y$)(),x=n.useRef(null),v=n.useCallback((e=>(0,w.jsx)("div",{style:{width:"100%"},...e,children:(0,w.jsx)(m().z,{icon:t,name:o,disabled:i,...f,ref:x})})),[i,t,o,f]);let C;return!y&&S?C=(0,w.jsx)(d().Z,{textWrap:!0,placement:g().Placement.Left,render:v,renderTooltip:()=>(0,w.jsx)(c()._H,{...S})}):y&&S&&(C=(0,w.jsx)(d().Z,{placement:g().Placement.Left,render:v,renderTooltip:()=>(0,w.jsx)(u().Z,{caption:(0,w.jsx)(c()._H,{...S}),imageURL:y,imageWidth:140,imageHeight:100,imageContainerStyle:{backgroundColor:"white"}})})),(0,w.jsxs)(w.Fragment,{children:[C||(0,w.jsx)(v,{}),a&&a.open&&(0,w.jsx)(j,{originRef:x,propertyType:(0,r().TN)(s),collectionContextStore:h,collectionSettingsStore:h.settingsStore,...a})]})}function M(e){let{actionHandler:t,renderIcon:o,tooltip:c,disabled:d,propertySettingsPopupProps:u}=e;const[p,g]=n.useState(null),{layoutStore:m}=(0,s().J9)(),f=(0,i().VK)((()=>m.getLayoutType()),[m]);return(0,n.useCallback)((e=>({key:e,keywords:[a().SO[e]],render:t=>{let{ref:n,...i}=t;const s=null==u?void 0:u(e);let m=a().SO[e];const y=(0,r().TN)(e);return"form"===f&&(0,l().s0)(y)&&"select"!==y&&(m=l().Cu[y]),(0,w.jsx)(_,{icon:o(e),name:m,disabled:null==d?void 0:d(e),propertyType:e,propertySettingsPopup:s?{...s,open:p===e,onDismiss:()=>{g(null)}}:void 0,tooltip:null==c?void 0:c(e),ref:n,...i})},action:()=>{null!=u&&u(e)?g(e):t(e)}})),[t,d,f,p,u,o,c])}},946650:(e,t,o)=>{"use strict";o.d(t,{l:()=>u,w:()=>p});var n=o(667294),i=()=>o(219727),r=()=>o(142735),l=()=>o(269299),a=()=>o(348141),s=()=>o(718959),c=()=>o(876822);function d(e){let{userSettingsDismissibleKey:t}=e;const o=(0,i().O7)(),d=(0,r().VK)((()=>c().default.state.currentUserSettingsStore),[]),u=(0,r().VK)((()=>{const e=null==d?void 0:d.getSettings();return!e||Boolean(e[t])}),[t,d]),p=(0,r().VK)((()=>{const e=(0,s().B7)(o),t=null==d?void 0:d.getSettings();return Boolean(e)&&Boolean(t)&&!o.device.isMobile&&!u}),[o,d,u]),g=n.useCallback((()=>{d&&!u&&p&&l().createAndCommit({environment:o,userAction:"LayoutInfoPanelButtonEducationTooltip.dismiss",canUndo:!1,perform:e=>{a().d2({userSettingsStore:d,transaction:e,data:{[t]:Date.now()}})}})}),[o,p,t,d,u]);return{shouldShowTooltip:p,dismissTooltip:g}}function u(){return d({userSettingsDismissibleKey:"layout_info_panel_button_education_tooltip_dismissed_at"})}function p(){return d({userSettingsDismissibleKey:"layout_builder_add_module_button_education_tooltip_dismissed_at"})}},274860:(e,t,o)=>{"use strict";o.d(t,{G:()=>s});var n=o(667294),i=()=>o(543172),r=()=>o(579012),l=()=>o(946650),a=()=>o(162178);function s(e){const{setModuleSelection:t,layoutStore:o}=(0,a().J9)(),s=(0,r().K)(),{dismissTooltip:c}=(0,l().w)();return(0,n.useCallback)((()=>{var n;"form"===(null===(n=o.getModel())||void 0===n?void 0:n.getLayoutType())&&"form_conditional_modules"!==e.area?s({layoutModule:{type:"placeholder",id:(0,i().ZP)()},position:e.afterModuleId?{type:"module_relative",area:e.area,direction:"below",relativeToModuleId:e.afterModuleId}:void 0}):(t({type:"new_module",isDragging:!1,..."views_main_tab_modules"===e.area?{area:"views_main_tab_modules",viewsMainTabId:e.viewsMainTabId}:{area:e.area}}),"page_main"===e.area&&c())}),[o,e,s,t,c])}},536909:(e,t,o)=>{"use strict";o.d(t,{Z:()=>l});var n=o(667294),i=o(785893);function r(e){let{...t}=e;const n=(0,o(788860).YB)(),r=(0,o(846550).yK)((e=>({buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,height:24,width:24},threeDotIcon:{width:12,height:12,fill:e.mediumIconColor}})),[]),l=n.formatMessage({defaultMessage:"View options",id:"PersonalHomePanel.moreDropdownButton.tooltip"});return(0,i.jsx)(o(154186).Z,{ariaLabel:l,style:r.buttonStyle,mobileFeedback:!1,...t,children:(0,o(641772).o)(r.threeDotIcon)})}const l=n.memo(r)},496291:(e,t,o)=>{"use strict";o.d(t,{Iu:()=>s,P2:()=>c,ZP:()=>u});o(267602),o(30005),o(241792);var n=o(667294),i=()=>o(788860),r=()=>o(448419),l=()=>o(255577),a=o(785893);const s=(0,i().vU)({hide:{id:"PersonalHomePanel.moreDropdown.hide.title",defaultMessage:"Hide from Home"}}),c=20;function d(e){let{actions:t}=e;const d=(0,o(846550).yK)((e=>({hideButtonIcon:{height:c,width:c,fill:e.regularIconColor}})),[]),u=(0,i().YB)(),p=(0,n.useMemo)((()=>{const e={};return t.forEach((t=>{"custom"===t.type&&(e[t.item.key]=t.closeOnAccept)})),e}),[t]),g=[{key:"all",render:e=>(0,a.jsx)(o(388284).Z,{...e}),items:t.map((e=>{switch(e.type){case"hide":return{key:"hide",render:e=>(0,a.jsx)(o(827973).Z,{...e,icon:(0,o(259739).D)(d.hideButtonIcon),title:u.formatMessage(s.hide),style:{borderRadius:o(170210).bS}}),action:e.hide};case"custom":return e.item;default:(0,o(696459).t1)(e)}}))}];return(0,a.jsx)(r().ZP,{popupType:r().Z4.Popup,alignmentToOrigin:r().vR.Center,originGap:2,renderOrigin:e=>(0,a.jsx)(o(536909).Z,{...e}),render:e=>(0,a.jsx)(o(198829).Z,{menuType:o(352230).o.Popup,children:(0,a.jsx)(l().ZP,{onAccept:t=>((e,t)=>{p[e.key]&&t.close()})(t,e),type:l().iW.Vertical,sections:g,initialFocus:void 0})})})}const u=n.memo(d)},454860:(e,t,o)=>{"use strict";o.d(t,{Z:()=>i});class n extends(()=>o(263184))().default{getInitialState(){return{searchQuery:"",searchLimit:n.limitIncrement,searchPopupOpen:!1,addingPage:!1}}}n.limitIncrement=20,n.resultsCacheTTL=2*o(326966).hM,n.incrementScrollOffset=200;const i=n},974442:(e,t,o)=>{"use strict";o.d(t,{Z:()=>n});const n=o(263184).default.createValue({open:!1},{name:"ConfirmOverwriteModalStore"})},530261:(e,t,o)=>{"use strict";o.d(t,{Z:()=>i});class n extends(()=>o(263184))().default{getInitialState(){return{isModalOpen:!1,collectionContextStore:void 0}}}const i=new n},697360:(e,t,o)=>{"use strict";o.d(t,{kj:()=>s,zY:()=>a});o(821057);var n=()=>o(139224),i=()=>o(427886),r=()=>o(382474);const l={property:function(e){let{template:t,collectionStore:i,collectionViewStore:l,collectionSettingsStore:a}=e;const s=(0,r().ZQ)({collectionStore:i,templateId:t.templateId,instancePointerType:"property"});if(!s)throw new Error(`No property instance found for property template ${t.templateId}`);const c=l.getType();n().H4({collectionSettingsStore:a,item:{type:"property",property:s.id,formatKey:c?o(109477).oz(c):void 0}})},collection_view:function(e){let{template:t,environment:o,collectionStore:n,collectionContextStore:i}=e;const l=(0,r().ZQ)({collectionStore:n,templateId:t.templateId,instancePointerType:"collection_view"});if(!l)throw new Error(`No collection view instance found for property template ${t.templateId}`);s({environment:o,collectionContextStore:i,collectionViewId:l.id})},compound:function(e){}};function a(e){l[e.template.type](e)}function s(e){var t;let{environment:o,collectionContextStore:r,collectionViewId:l}=e;(null===(t=r.collectionViewStore())||void 0===t?void 0:t.id)!==l&&(0,i().f)({environment:o,collectionContextStore:r,collectionViewId:l,isFullScreen:r.isFullScreenStore.state,isRootChild:r.isRootChildStore.state,isInPeekRenderer:r.isInPeekRendererStore.state}),n().H4({collectionSettingsStore:r.settingsStore,item:{type:"main"}})}},535645:(e,t,o)=>{"use strict";o.d(t,{N:()=>M,r:()=>k});o(821057),o(241792),o(667294);var n=()=>o(219727),i=()=>o(142735),r=()=>o(846550),l=()=>o(353329),a=()=>o(226413),s=()=>o(696459),c=()=>o(139224),d=()=>o(269299),u=()=>o(821159),p=()=>o(887430),g=()=>o(594546),m=()=>o(527278),f=()=>o(938938),y=()=>o(122252),S=()=>o(697360),h=()=>o(281236),x=()=>o(382474),v=()=>o(822909),C=()=>o(741119),b=()=>o(792329),w=()=>o(563452),j=()=>o(499819),_=o(785893);function M(e){let{environment:t,template:o,isInSuggestedSection:n,collectionContextStore:i}=e;return{key:o.templateId,action:()=>{if(n)k({environment:t,template:o,collectionContextStore:i,suggestedFeatureAnalytics:void 0});else{const{collectionStore:e,collectionViewStore:n,collectionSettingsStore:r}=(0,v().B)(i);(0,S().zY)({template:o,environment:t,collectionStore:e,collectionViewStore:n,collectionSettingsStore:r,collectionContextStore:i})}},render:e=>(0,_.jsx)(P,{buttonMenuItemProps:e,template:o,isInSuggestedSection:n})}}function k(e){let{environment:t,collectionContextStore:o,template:n,suggestedFeatureAnalytics:i}=e;const r=o.collectionStore();if(!r)throw new Error("collectionStore not found");const a=r.getWorkflowTemplateId();i&&(0,g().j)({environment:t,event:{eventName:"suggested_feature_template_clicked",eventProperties:{origin:i.origin,selected_index:i.selectedIndex,template_ids_shown:i.shownTemplateIds,template_id_clicked:n.templateId,collection_template_id:a}}});const s=o.settingsStore;if((0,b().isWorkflowTemplateWithConfirmStep)(n))c().H4({collectionSettingsStore:s,item:{type:"confirmAddTemplate",template:n}});else if((0,l().yw)(n)){const{relatedCollectionTemplateId:e}=n;!function(e){var t;let{environment:o,template:n,collectionStore:i,relatedCollectionTemplateId:r}=e;const l=null===(t=i.getParentBlockStore())||void 0===t?void 0:t.getParentStore();if(!l)throw new Error(`parentStore not found for ${i.id}`);if(!(0,h().isCollectionTemplateParentStore)(l))throw new Error(`Incorrect parent store: ${l.table} ${l.id}`);const a=h().globalWorkflowTemplates.fromIdOfType({templateId:r,type:"collection"});(0,f().openSelectedTemplateOnboardingModalForInAppFlows)({environment:o,template:a,origin:"suggested_feature_template",parentStore:l,navigateToOnFinish:"skip",relationInfos:[{type:"source",collectionStore:i,relationPropertyTemplate:n}],aiPrompt:void 0})}({environment:t,template:n,collectionStore:r,relatedCollectionTemplateId:e})}else d().createAndCommit({userAction:"FeatureTemplateMenuItem.addFeatureTemplateToTarget",environment:t,canUndo:!0,perform:e=>{y().rU({environment:t,transaction:e,collectionStore:r,template:n,logger:new(h().WorkflowTemplateLogger),origin:"suggested_feature"}),i&&(0,g().j)({environment:t,event:{eventName:"suggested_feature_template_added",eventProperties:{origin:i.origin,template_id_added:n.templateId,collection_template_id:a}}});const l=o.collectionViewStore();l&&S().zY({template:n,environment:t,collectionStore:r,collectionViewStore:l,collectionSettingsStore:s,collectionContextStore:o})}})}function P(e){let{buttonMenuItemProps:t,template:o,isInSuggestedSection:l}=e;const c=(0,r().yK)((e=>({iconContainer:{height:28,width:28,display:"flex",alignItems:"center",justifyContent:"center"},icon:{fill:e.regularIconColor}})),[]),{collectionStore:d}=(0,v().M)(),g=(0,n().O7)(),f=(0,i().VK)((()=>(0,x().w2)({environment:g,collectionStore:d,templateId:o.templateId})),[g,d,o.templateId]),y=(0,i().VK)((()=>function(e){let{template:t,collectionStore:o}=e;const{type:n}=t;switch(n){case"property":const{value:e}=t;if((0,a().t)(e)){const n=function(e){let{templateId:t,propertyTemplateSchema:o,collectionStore:n}=e;const i=(0,x().ZQ)({collectionStore:n,templateId:t,instancePointerType:"property"});if(!i)return o.options??[];const r=n.getSchema()[i.id];if(!r||!(0,a().t)(r))return[];return r.options??[]}({templateId:t.templateId,propertyTemplateSchema:e,collectionStore:o}).map((e=>e.value));return(0,h().getWorkflowTemplateItemsCaption)(n)}return;case"collection_view":return`${m().Z.formatMessage(p().b1[t.value.type])} view`;case"compound":return;default:(0,s().t1)(n)}}({template:o,collectionStore:d})),[o,d]),S=(0,h().getWorkflowTemplateName)(o);return l?(0,_.jsx)(u().Y,{buttonMenuItemProps:t,title:S,icon:(0,_.jsx)(j().$,{template:o}),right:(0,_.jsx)(w().a,{isAdded:f})}):(0,_.jsx)(u().Y,{buttonMenuItemProps:t,title:S,caption:y,icon:(0,_.jsx)("div",{style:c.iconContainer,children:(0,_.jsx)(j().l,{template:o,iconStyle:c.icon})}),right:(0,_.jsx)(C().K,{})})}},741119:(e,t,o)=>{"use strict";o.d(t,{K:()=>l});o(667294);var n=()=>o(846550),i=()=>o(429600),r=o(785893);function l(){const e=(0,n().yK)((e=>({icon:{width:12,fill:e.lightIconColor,marginLeft:6,transition:"transform 200ms ease-in-out"}})),[]);return(0,r.jsx)(r.Fragment,{children:(0,i().o)(e.icon)})}},792329:(e,t,o)=>{"use strict";o.r(t),o.d(t,{WorkflowSettingsConfirmAddTemplate:()=>k,isWorkflowTemplateWithConfirmStep:()=>I});o(821057);var n=o(667294),i=()=>o(219727),r=()=>o(846550),l=()=>o(353329),a=()=>o(788860),s=()=>o(513670),c=()=>o(139224),d=()=>o(269299),u=()=>o(205951),p=()=>o(477253),g=()=>o(18748),m=()=>o(906651),f=()=>o(388284),y=()=>o(125659),S=()=>o(594546),h=()=>o(122252),x=()=>o(697360),v=()=>o(281236),C=(o(241792),()=>o(38883)),b=()=>o(246471),w=o(785893);function j(e){let{template:t,style:o}=e;const n=(0,r().yK)((e=>({container:{...o,padding:12,border:`1px solid ${e.regularDividerColor}`,borderRadius:6}})),[o]),i=function(e){if((0,l().U2)(e,"property")&&(0,l().kw)(e)){const{options:t=[]}=e.value;if(0===t.length)return;return(0,w.jsx)(_,{options:t})}}(t);return i?(0,w.jsx)("div",{style:n.container,children:i}):null}function _(e){let{options:t}=e;const o=(0,r().yK)((()=>({container:{display:"flex",flexDirection:"column",gap:8}})),[]);return(0,w.jsx)("div",{style:o.container,children:t.map((e=>(0,w.jsx)("div",{children:(0,w.jsx)(b().a,{format:C().lo.Medium,isSingle:!0,value:e.value,color:e.color,showRemoveButton:!1})},e.id)))})}var M=()=>o(499819);function k(e){let{template:t,collectionSettingsStore:o}=e;const[l,s]=(0,n.useState)("sample"===t.propertyOptionsType),{device:{isMobile:c}}=(0,i().O7)(),d=(0,r().yK)((e=>{const t={display:"flex",flexDirection:"column",minHeight:0};return{shrinkableHeight:t,noShrink:{flexShrink:0},featurePreviewWrapper:{...t,width:"-webkit-fill-available"},featurePreviewBody:{...t,gap:16,...c?{margin:"16px 0"}:{margin:0}},featurePreview:{...t,overflow:"auto"},addButtonContainer:{...c?{margin:"12px 0"}:{marginBottom:6}}}}),[c]),m=(0,v().getWorkflowTemplateName)(t);return(0,w.jsxs)(u().ZP,{collectionSettingsStore:o,title:(0,w.jsx)(a()._H,{id:"workflowTemplateSettings.confirmAddTemplate.title",defaultMessage:"Turn on {templateName}",values:{templateName:m}}),disableScroller:!0,menuScrollerStyle:d.shrinkableHeight,innerContentWrapperStyle:d.shrinkableHeight,children:[(0,w.jsx)(f().Z,{style:d.shrinkableHeight,children:(0,w.jsx)(g().ZP,{style:d.shrinkableHeight,textWrapperStyle:d.featurePreviewWrapper,bodyStyle:d.featurePreviewBody,body:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(P,{template:t,style:d.noShrink}),(0,w.jsx)(j,{template:t,style:d.featurePreview})]})})}),(0,w.jsx)(f().Z,{style:d.noShrink,children:t.value.options&&t.value.options.length>0&&(0,w.jsx)(p().Z,{title:(0,w.jsx)(a()._H,{id:"workflowTemplateSettings.confirmAddTemplate.propertyOptionsToggle",defaultMessage:"Set my own options"}),switcherProps:{on:l,disallowTabbing:!0},onClick:()=>{s(!l)}})}),(0,w.jsx)(f().Z,{style:d.noShrink,children:(0,w.jsx)(g().ZP,{body:(0,w.jsx)(T,{template:t,startEmpty:l}),bodyStyle:d.addButtonContainer})})]})}function P(e){let{template:t,style:o}=e;const n=(0,i().Fy)(),a=(0,r().yK)((()=>({container:{...o,display:"flex",alignItems:"center",gap:12},textWrapper:{lineHeight:n.isMobile?"20px":"18px"},title:{fontSize:n.isMobile?16:13},caption:{fontSize:n.isMobile?14:12,overflow:"hidden",color:"gray",whiteSpace:"nowrap",textOverflow:"ellipsis"}})),[n,o]),s=(0,v().getWorkflowTemplateName)(t),c=(0,l().ym)(t);return(0,w.jsxs)("div",{style:a.container,children:[(0,w.jsx)(M().$,{template:t,backgroundSize:32}),(0,w.jsxs)("div",{style:a.textWrapper,children:[(0,w.jsx)("div",{style:a.title,children:s}),c&&(0,w.jsx)("div",{style:a.caption,children:c})]})]})}function T(e){let{template:t,startEmpty:o}=e;const n=(0,r().yK)((()=>({section:{paddingTop:12,paddingBottom:12},button:{width:"100%"}})),[]),l=(0,i().O7)(),u=(0,y().Y$)(),p=(0,v().getWorkflowTemplateName)(t),g=s().Xh(t);return o&&delete g.value.options,(0,w.jsx)(m().Z,{style:n.button,isLarge:!0,onClick:()=>{d().createAndCommit({userAction:"WorkflowSettingsConfirmAddTemplate.addFeatureTemplateToTarget",environment:l,canUndo:!0,perform:e=>{const o=u.collectionStore();if(!o)throw new Error("collectionStore not found");h().rU({environment:l,transaction:e,collectionStore:o,template:g,logger:new(v().WorkflowTemplateLogger),origin:"suggested_feature"});const n=u.settingsStore;c().z$({collectionSettingsStore:n});const i=o.getWorkflowTemplateId();(0,S().j)({environment:l,event:{eventName:"suggested_feature_template_added",eventProperties:{origin:"suggested_properties",template_id_added:t.templateId,collection_template_id:i}}});const r=u.collectionViewStore();r&&(0,x().zY)({template:t,environment:l,collectionStore:o,collectionViewStore:r,collectionSettingsStore:n,collectionContextStore:u})}})},children:(0,w.jsx)(a()._H,{id:"workflowTemplateSettings.confirmAddTemplate.button",defaultMessage:"Add {templateName}",values:{templateName:p}})})}function I(e){return"property"===e.type&&("select"===e.value.type||"multi_select"===e.value.type)}},563452:(e,t,o)=>{"use strict";o.d(t,{a:()=>a});o(667294);var n=()=>o(846550),i=()=>o(286977),r=()=>o(490670),l=o(785893);function a(e){let{isAdded:t}=e;const o=(0,n().yK)((e=>({circle:{height:24,width:24,borderRadius:50,display:"flex",alignItems:"center",justifyContent:"center",background:t?"dark"===e.mode?e.accentColors.blue[100]:e.accentColors.blue[50]:e.lightGrayButtonBackground},plusIcon:{height:15,width:15,fill:e.mediumIconColor},checkIcon:{height:12,width:12,fill:e.blueColor}})),[t]);return(0,l.jsx)("div",{style:o.circle,children:t?(0,i().e)(o.checkIcon):(0,r().f)(o.plusIcon)})}},925880:(e,t,o)=>{"use strict";o.d(t,{c:()=>a});var n=()=>o(219727),i=()=>o(142735),r=()=>o(520186),l=()=>o(932200);function a(e){const t=(0,n().O7)();return(0,l().Y)(e),(0,i().VK)((()=>{const o=e.collectionStore();return o?(0,r().r)(t,o):[]}),[t,e])}},182722:(e,t,o)=>{"use strict";o.d(t,{J:()=>a});var n=o(667294),i=()=>o(219727),r=()=>o(142735),l=()=>o(594546);function a(e){let{collectionContextStore:t,shownTemplateIds:o,origin:a}=e;const s=(0,i().O7)(),c=(0,r().VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getWorkflowTemplateId()}),[t]),d=(0,n.useRef)(!1);(0,n.useEffect)((()=>{!d.current&&o.length>0&&((0,l().j)({environment:s,event:{eventName:"suggested_feature_templates_shown",eventProperties:{origin:a,collection_template_id:c,template_ids_shown:o}}}),d.current=!0)}))}},822909:(e,t,o)=>{"use strict";o.d(t,{B:()=>a,M:()=>l});var n=()=>o(142735),i=()=>o(349220),r=()=>o(125659);function l(){const e=(0,r().Y$)(),{collectionStore:t,collectionViewStore:o,collectionSettingsStore:i}=(0,n().VK)((()=>a(e)),[e]);return{collectionStore:t,collectionViewStore:o,collectionSettingsStore:i,collectionContextStore:e}}function a(e){return{collectionStore:(0,i().TO)(e.collectionStore(),"collectionStore not found"),collectionViewStore:(0,i().TO)(e.collectionViewStore(),"collectionViewStore not found"),collectionSettingsStore:e.settingsStore}}},118795:(e,t,o)=>{"use strict";var n=()=>o(677559);const i={WorkflowTemplatesBuilderNotInProd:new(n().Ss)("WorkflowTemplateBuilderNotInProd",(async()=>await Promise.all([o.e(52774),o.e(53329),o.e(72586),o.e(49498),o.e(77289),o.e(6532)]).then(o.bind(o,729728)))),CollectionItemNameConfigMenuItemNotInProd:new(n().Ss)("CollectionItemNameConfigMenuItemNotInProd",(async()=>await o.e(53784).then(o.bind(o,691482))))};(0,n().kF)(i.WorkflowTemplatesBuilderNotInProd,(e=>e.WorkflowTemplatesBuilderNotInProd)),(0,n().kF)(i.CollectionItemNameConfigMenuItemNotInProd,(e=>e.CollectionItemNameConfigMenuItemNotInProd))},919758:(e,t,o)=>{"use strict";o.d(t,{Ll:()=>a,Lt:()=>l});var n=()=>o(926724),i=()=>o(235484),r=()=>o(109477);const l=new Map([[n().Es.Status,"status"],["title","title"],[n().Es.Priority,"priority"],[n().Es.Tags,"tags"],[n().Es.Assign,"assignee"],[n().Es.DueDate,"duedate"],[n().Es.SubTaskRelation,"subtasks"],[n().Es.ParentTaskRelation,"parent_task"],[n().Es.BlockingRelation,"blocking_tasks"],[n().Es.BlockedRelation,"blocked_by_tasks"],[n().Es.TaskToProjectRelation,"task_to_project"]]);new Map([[n().zI.Status,"status"],["title","title"],[n().zI.Priority,"priority"],[n().zI.Collaborators,"collaborators"],[n().zI.CompletionRollup,"completion_rollup"],[n().zI.People,"people"],[n().zI.ProjectDates,"project_dates"],[n().zI.ProjectToTaskRelation,"project_to_task"]]),r().Vj.Jira,i().mC,r().Vj.Salesforce,i().bF;function a(e){let{isUserOnEnterprisePlan:t,twoWaySyncEnabled:o,canEdit:n,isEditableProperty:i}=e;return t?o?i?n?"full_access":"connect_to_integration":"property_not_editable":"two_way_sync_not_enabled":"upgrade_to_enterprise"}},963979:(e,t,o)=>{"use strict";o.d(t,{E:()=>l,S:()=>r});var n=()=>o(803021);const i={"de-DE":{time:{"12h":"LT","24h":"H:mm",hidden:n().n3},month:"MMMM YYYY"},"da-DK":{time:{"12h":"LT","24h":"H:mm",hidden:n().n3},month:"MMMM YYYY"},"fi-FI":{time:{"12h":"LT","24h":"H:mm",hidden:n().n3},month:"MMMM YYYY"},"nb-NO":{time:{"12h":"LT","24h":"H:mm",hidden:n().n3},month:"MMMM YYYY"},"nl-NL":{time:{"12h":"LT","24h":"H:mm",hidden:n().n3},month:"MMMM YYYY"},"sv-SE":{time:{"12h":"LT","24h":"H:mm",hidden:n().n3},month:"MMMM YYYY"},"en-US":{time:{"12h":"LT","24h":"H:mm",hidden:n().n3},month:"MMMM YYYY"},"es-ES":{time:{"12h":"LT","24h":"H:mm",hidden:n().n3},month:"MMMM YYYY"},"es-LA":{time:{"12h":"LT","24h":"H:mm",hidden:n().n3},month:"MMMM YYYY"},"fr-FR":{time:{"12h":"LT","24h":"H:mm",hidden:n().n3},month:"MMMM YYYY"},"pt-BR":{time:{"12h":"LT","24h":"H:mm",hidden:n().n3},month:"MMMM YYYY"},"ko-KR":{time:{"12h":"LT","24h":"H:mm",hidden:n().n3},month:"YYYY[년] MMMM"},"zh-CN":{time:{"12h":"LT","24h":"H:mm",hidden:n().n3},month:"YYYY[年]MMM"},"zh-TW":{time:{"12h":"LT","24h":"H:mm",hidden:n().n3},month:"YYYY[年]MMM"},"ja-JP":{time:{"12h":"A h:mm","24h":"H:mm",hidden:n().n3},month:"YYYY[年]MMM"},pseudo:{time:{"12h":"A h:mm","24h":"H:mm",hidden:n().n3},month:"MMMM YYYY"}},r=["de-DE","fr-FR"];function l(e){return i[e]}},765973:(e,t,o)=>{"use strict";o.d(t,{Z:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("arrowsHorizontal",{viewBox:"0 0 64 64",svg:(0,n.jsx)("path",{d:"m62.24,32l-18,18-4.24-4.24,10.76-10.76H13.24l10.76,10.76-4.24,4.24L1.76,32,19.76,14l4.24,4.24-10.76,10.76h37.51l-10.76-10.76,4.24-4.24,18,18Z"})})},689271:(e,t,o)=>{"use strict";o.d(t,{O:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("arrowsLeftRight",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M13.7791 3.59799C13.9305 3.74539 14.004 3.9196 13.9998 4.1206C13.9998 4.32607 13.9263 4.50251 13.7791 4.64992L10.5317 8.0268C10.3888 8.1742 10.2269 8.24791 10.0462 8.24791C9.84861 8.24791 9.68676 8.1809 9.56065 8.0469C9.43874 7.91736 9.37779 7.74986 9.37779 7.54439C9.37779 7.34785 9.44295 7.18481 9.57326 7.05528L10.9227 5.66834L11.8937 4.77722L10.5506 4.83082L2.66857 4.83082C2.4752 4.83082 2.31546 4.76382 2.18935 4.62982C2.06323 4.49581 2.00018 4.32831 2.00018 4.1273C2.00018 3.91736 2.06323 3.74539 2.18935 3.61139C2.31546 3.48185 2.4752 3.41708 2.66857 3.41708L10.5506 3.41709L11.8937 3.47069L10.9227 2.57286L9.57326 1.19263C9.44295 1.05863 9.37779 0.893355 9.37779 0.696817C9.37779 0.491345 9.43874 0.323841 9.56065 0.194305C9.68676 0.0647681 9.84861 -1.81463e-07 10.0462 -1.72827e-07C10.2269 -1.64925e-07 10.3888 0.0737017 10.5317 0.221105L13.7791 3.59799ZM2.21457 12.4087C2.06744 12.2568 1.99597 12.0804 2.00018 11.8794C2.00018 11.6784 2.07164 11.5042 2.21457 11.3568L5.47459 7.9799C5.61331 7.8325 5.77516 7.75879 5.96012 7.75879C6.1577 7.75879 6.31744 7.82356 6.43935 7.9531C6.56126 8.0871 6.62222 8.25684 6.62222 8.46231C6.62222 8.65438 6.55916 8.81742 6.43305 8.95142L5.08364 10.3317L4.10626 11.2295L5.44937 11.1759L13.3314 11.1759C13.5248 11.1759 13.6845 11.2429 13.8107 11.3769C13.9368 11.5109 13.9998 11.6784 13.9998 11.8794C13.9998 12.0849 13.9368 12.2546 13.8107 12.3886C13.6845 12.5226 13.5248 12.5896 13.3314 12.5896L5.44937 12.5896L4.10626 12.536L5.08364 13.4338L6.43305 14.8141C6.55916 14.9436 6.62222 15.1066 6.62222 15.3032C6.62222 15.5087 6.56126 15.6762 6.43935 15.8057C6.31744 15.9352 6.1577 16 5.96012 16C5.77516 16 5.61331 15.9285 5.47459 15.7856L2.21457 12.4087Z"})})},933110:(e,t,o)=>{"use strict";o.d(t,{T:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("collectionChartColor",{viewBox:"0 0 20 20",svg:(0,n.jsx)("path",{d:"M10.5947 17.0645C9.24121 17.0645 8.01074 16.8981 6.90332 16.5654C5.7959 16.2327 4.83887 15.7588 4.03223 15.1436C3.23014 14.5329 2.61263 13.8037 2.17969 12.9561C1.74674 12.1038 1.53027 11.1582 1.53027 10.1191C1.53027 9.05273 1.75814 8.08203 2.21387 7.20703C2.67415 6.32747 3.32585 5.57096 4.16895 4.9375C5.0166 4.30404 6.02604 3.81641 7.19727 3.47461C8.37305 3.12826 9.67415 2.95508 11.1006 2.95508C12.2035 2.95508 13.2061 3.06901 14.1084 3.29688C15.0107 3.52018 15.7855 3.84147 16.4326 4.26074C17.0843 4.68001 17.5856 5.18132 17.9365 5.76465C18.292 6.34798 18.4697 6.9974 18.4697 7.71289C18.4697 8.19596 18.374 8.61068 18.1826 8.95703C17.9912 9.29883 17.7428 9.59277 17.4375 9.83887C17.1367 10.085 16.8177 10.2969 16.4805 10.4746C16.1432 10.6478 15.8219 10.8073 15.5166 10.9531C15.2158 11.099 14.9697 11.2471 14.7783 11.3975C14.5869 11.5433 14.4912 11.7096 14.4912 11.8965C14.4912 12.097 14.5482 12.277 14.6621 12.4365C14.7806 12.5915 14.9128 12.7533 15.0586 12.9219C15.209 13.0905 15.3411 13.291 15.4551 13.5234C15.5736 13.7513 15.6328 14.0407 15.6328 14.3916C15.6328 14.9202 15.4209 15.3851 14.9971 15.7861C14.5778 16.1872 13.9899 16.4993 13.2334 16.7227C12.4814 16.9505 11.6019 17.0645 10.5947 17.0645ZM10.5947 15.6221C11.6794 15.6221 12.5475 15.4922 13.1992 15.2324C13.8555 14.9727 14.1836 14.6263 14.1836 14.1934C14.1836 13.9837 14.1243 13.7992 14.0059 13.6396C13.8919 13.4756 13.7598 13.3115 13.6094 13.1475C13.459 12.9834 13.3245 12.7988 13.2061 12.5938C13.0921 12.3887 13.0352 12.138 13.0352 11.8418C13.0352 11.4954 13.1309 11.2061 13.3223 10.9736C13.5137 10.7412 13.762 10.5384 14.0674 10.3652C14.3727 10.1921 14.694 10.028 15.0312 9.87305C15.373 9.71354 15.6943 9.54036 15.9951 9.35352C16.3005 9.16667 16.5488 8.94336 16.7402 8.68359C16.9316 8.41927 17.0273 8.0957 17.0273 7.71289C17.0273 7.05208 16.7812 6.47331 16.2891 5.97656C15.8014 5.47526 15.1133 5.08561 14.2246 4.80762C13.3359 4.52962 12.2946 4.39062 11.1006 4.39062C9.87467 4.39062 8.7627 4.52734 7.76465 4.80078C6.7666 5.06966 5.90983 5.45703 5.19434 5.96289C4.47884 6.46875 3.92741 7.07259 3.54004 7.77441C3.15723 8.47624 2.96582 9.25781 2.96582 10.1191C2.96582 10.944 3.14583 11.6937 3.50586 12.3682C3.87044 13.0426 4.3877 13.6237 5.05762 14.1113C5.72754 14.5944 6.52962 14.9658 7.46387 15.2256C8.40267 15.4899 9.44629 15.6221 10.5947 15.6221ZM10.0068 14.0566C9.65592 14.0566 9.33464 13.9701 9.04297 13.7969C8.7513 13.6237 8.5166 13.3913 8.33887 13.0996C8.16569 12.8034 8.0791 12.4775 8.0791 12.1221C8.0791 11.7712 8.16569 11.4499 8.33887 11.1582C8.5166 10.8665 8.7513 10.6341 9.04297 10.4609C9.33464 10.2832 9.65592 10.1943 10.0068 10.1943C10.3623 10.1943 10.6859 10.2832 10.9775 10.4609C11.2692 10.6341 11.5016 10.8665 11.6748 11.1582C11.8525 11.4499 11.9414 11.7712 11.9414 12.1221C11.9414 12.4867 11.8548 12.8148 11.6816 13.1064C11.513 13.3981 11.2806 13.6305 10.9844 13.8037C10.6927 13.9723 10.3669 14.0566 10.0068 14.0566ZM10.0068 13.1611C10.2028 13.1611 10.3783 13.1156 10.5332 13.0244C10.6927 12.9333 10.818 12.8079 10.9092 12.6484C11.0003 12.4889 11.0459 12.3135 11.0459 12.1221C11.0459 11.8988 10.9958 11.7119 10.8955 11.5615C10.7952 11.4111 10.6654 11.2949 10.5059 11.2129C10.3464 11.1309 10.1755 11.0921 9.99316 11.0967C9.81543 11.0967 9.64909 11.14 9.49414 11.2266C9.33919 11.3086 9.21387 11.4248 9.11816 11.5752C9.02246 11.7256 8.97461 11.9079 8.97461 12.1221C8.97461 12.3135 9.02018 12.4889 9.11133 12.6484C9.20703 12.8079 9.33236 12.9333 9.4873 13.0244C9.64225 13.1156 9.81543 13.1611 10.0068 13.1611ZM5.25586 11.042C4.95052 11.042 4.6862 10.9303 4.46289 10.707C4.23958 10.4792 4.12793 10.2103 4.12793 9.90039C4.12793 9.58594 4.23958 9.31934 4.46289 9.10059C4.6862 8.87728 4.95052 8.76562 5.25586 8.76562C5.57031 8.76562 5.83691 8.87728 6.05566 9.10059C6.27441 9.31934 6.38379 9.58594 6.38379 9.90039C6.38379 10.2103 6.27441 10.4792 6.05566 10.707C5.83691 10.9303 5.57031 11.042 5.25586 11.042ZM7.7168 8.875C7.32031 8.875 6.98307 8.73828 6.70508 8.46484C6.43164 8.19141 6.29492 7.85417 6.29492 7.45312C6.29492 7.06576 6.43164 6.73763 6.70508 6.46875C6.98307 6.19531 7.32031 6.05859 7.7168 6.05859C8.10872 6.05859 8.44141 6.19531 8.71484 6.46875C8.99284 6.73763 9.13184 7.06576 9.13184 7.45312C9.13184 7.85417 8.99284 8.19141 8.71484 8.46484C8.44141 8.73828 8.10872 8.875 7.7168 8.875ZM11.1348 7.78809C10.8203 7.78809 10.5492 7.67643 10.3213 7.45312C10.098 7.22982 9.98633 6.96094 9.98633 6.64648C9.98633 6.33203 10.098 6.06315 10.3213 5.83984C10.5492 5.61654 10.8203 5.50488 11.1348 5.50488C11.4492 5.50488 11.7158 5.61654 11.9346 5.83984C12.1579 6.05859 12.2695 6.32747 12.2695 6.64648C12.2695 6.96094 12.1579 7.22982 11.9346 7.45312C11.7158 7.67643 11.4492 7.78809 11.1348 7.78809ZM14.2041 8.21875C13.9489 8.21875 13.7279 8.12988 13.541 7.95215C13.3587 7.76986 13.2676 7.54883 13.2676 7.28906C13.2676 7.03841 13.3587 6.82194 13.541 6.63965C13.7279 6.45736 13.9489 6.36621 14.2041 6.36621C14.4593 6.36621 14.6758 6.45736 14.8535 6.63965C15.0358 6.82194 15.127 7.03841 15.127 7.28906C15.127 7.54883 15.0358 7.76986 14.8535 7.95215C14.6758 8.12988 14.4593 8.21875 14.2041 8.21875Z"})})},373069:(e,t,o)=>{"use strict";o.d(t,{I:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("collectionDependenciesArrowRight",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{transform:"translate(3,3)",d:"M1.34.302a.701.701 0 00-.383.095.708.708 0 00-.24.253 1.074 1.074 0 00-.109.322 3.26 3.26 0 00-.054.465c-.01.173-.014.36-.014.56 0 1.609.353 2.791 1.06 3.548.71.752 1.857 1.128 3.438 1.128h4.525l1.634-.089L9.16 8.423 7.643 9.968a.798.798 0 00-.164.239.785.785 0 00-.055.294c0 .205.068.376.205.513a.736.736 0 00.533.205c.196 0 .378-.082.547-.246l4.498-4.485a.78.78 0 00.246-.567.743.743 0 00-.246-.56L8.695.854A.76.76 0 008.162.63a.736.736 0 00-.533.205.696.696 0 00-.205.513c0 .104.018.202.055.294a.715.715 0 00.164.232L9.16 3.419l2.037 1.852-1.634-.102h-4.43c-.76 0-1.366-.11-1.818-.328a1.94 1.94 0 01-.963-1.04c-.196-.473-.294-1.09-.294-1.852 0-.191.002-.358.006-.499.01-.141.014-.278.014-.41a.721.721 0 00-.205-.533.721.721 0 00-.533-.205z"})})},466222:(e,t,o)=>{"use strict";o.d(t,{v:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("databaseOutline",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M7.98145 15.3584C4.38574 15.3584 2 13.9775 2 12.0088V3.78516C2 1.9873 4.39258 0.763672 7.98145 0.763672C11.5771 0.763672 13.9697 1.9873 13.9697 3.78516V12.0088C13.9697 13.9775 11.584 15.3584 7.98145 15.3584ZM7.98145 5.58301C10.7773 5.58301 12.6709 4.83105 12.6709 3.78516C12.6709 2.69141 10.7842 1.91895 7.98145 1.91895C5.18555 1.91895 3.29883 2.69141 3.29883 3.78516C3.29883 4.83105 5.19238 5.58301 7.98145 5.58301ZM7.98145 6.80664C5.97852 6.80664 4.35156 6.42383 3.29883 5.77441V8.69336C4.42676 9.37695 6.19043 9.81445 7.98145 9.81445C9.7793 9.81445 11.543 9.37695 12.6709 8.69336V5.77441C11.6182 6.42383 9.99121 6.80664 7.98145 6.80664ZM7.98145 11.0449C6.23828 11.0449 4.5293 10.6621 3.29883 10.0332V12.0088C3.29883 13.2051 5.11035 14.1348 7.98145 14.1348C10.8594 14.1348 12.6709 13.2051 12.6709 12.0088V10.0332C11.4404 10.6621 9.73145 11.0449 7.98145 11.0449Z"})})},447490:(e,t,o)=>{"use strict";o.d(t,{Y:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("nest",{viewBox:"0 0 16 16",svg:(0,n.jsxs)("g",{children:[(0,n.jsx)("path",{d:"M5.59375 4.52344H14.3984C14.7607 4.52344 15.0479 4.23633 15.0479 3.87402C15.0479 3.51172 14.7607 3.22461 14.3984 3.22461H5.59375C5.23145 3.22461 4.94434 3.51172 4.94434 3.87402C4.94434 4.23633 5.22461 4.52344 5.59375 4.52344ZM8 8.7207H14.3984C14.7607 8.7207 15.0479 8.43359 15.0479 8.07129C15.0479 7.70898 14.7607 7.42188 14.3984 7.42188H8C7.6377 7.42188 7.35059 7.70898 7.35059 8.07129C7.35059 8.43359 7.63086 8.7207 8 8.7207ZM10 12.918H14.3984C14.7607 12.918 15.0479 12.6309 15.0479 12.2686C15.0479 11.9062 14.7607 11.6191 14.3984 11.6191H10C9.6377 11.6191 9.35059 11.9062 9.35059 12.2686C9.35059 12.6309 9.63086 12.918 10 12.918Z"}),(0,n.jsx)("path",{d:"M1.66386 4.7627L0.898238 3.46387C0.713668 3.14941 0.829878 2.80762 1.19218 2.80762H2.85332C3.22929 2.80762 3.33867 3.14258 3.14726 3.46387L2.36113 4.7627C2.21074 5.01562 1.82109 5.02246 1.66386 4.7627Z"}),(0,n.jsx)("path",{d:"M3.85358 8.94885L3.08795 7.65002C2.90338 7.33557 3.01275 6.99377 3.3819 6.99377H5.03619C5.41217 6.99377 5.52838 7.32874 5.33014 7.65002L4.55084 8.94885C4.40045 9.20178 4.0108 9.20862 3.85358 8.94885Z"}),(0,n.jsx)("path",{d:"M6.90723 12.6377L5.6084 13.4033C5.29395 13.5878 4.95215 13.4716 4.95215 13.1093V11.4482C4.95215 11.0722 5.28711 10.9628 5.6084 11.1543L6.90723 11.9404C7.16016 12.0908 7.16699 12.4804 6.90723 12.6377Z"})]})})},326034:(e,t,o)=>{"use strict";o.d(t,{U:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("unlocked",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M2.49023 14.7227H8.89551C9.94824 14.7227 10.4746 14.1963 10.4746 13.0479V8.20801C10.4746 7.22363 10.085 6.69727 9.29883 6.57422V4.83105C9.29883 3.22461 10.3174 2.35645 11.541 2.35645C12.7646 2.35645 13.79 3.22461 13.79 4.83105V6.28711C13.79 6.76562 14.0703 7.01855 14.4395 7.01855C14.8018 7.01855 15.082 6.7793 15.082 6.28711V4.96094C15.082 2.36328 13.3525 1.1123 11.541 1.1123C9.72949 1.1123 8 2.36328 8 4.96094V6.54004H2.49023C1.43066 6.54004 0.911133 7.06641 0.911133 8.20801V13.0479C0.911133 14.1963 1.43066 14.7227 2.49023 14.7227ZM2.68848 13.5059C2.3877 13.5059 2.2373 13.3623 2.2373 13V8.25586C2.2373 7.89355 2.3877 7.76367 2.68848 7.76367H8.7041C9.00488 7.76367 9.14844 7.89355 9.14844 8.25586V13C9.14844 13.3623 9.00488 13.5059 8.7041 13.5059H2.68848ZM7.99316 21.1123C6.5918 21.1123 5.2793 21.8779 4.75293 23.375L5.78516 24.4141C5.94922 23.0811 6.87891 22.3564 7.99316 22.3564C9.2168 22.3564 10.2422 23.2246 10.2422 24.8311V26.54H7.9248L9.1416 27.7637H11.0078C11.3086 27.7637 11.4521 27.8936 11.4521 28.2559V30.0742L12.7783 31.4072V28.208C12.7783 27.2031 12.3682 26.6768 11.541 26.5674V24.9609C11.541 22.3633 9.81152 21.1123 7.99316 21.1123ZM13.749 35.126C13.9609 35.3379 14.3164 35.3379 14.5215 35.126C14.7266 34.9072 14.7334 34.5723 14.5215 34.3535L2.46973 22.3154C2.25781 22.1035 1.90918 22.0967 1.69043 22.3154C1.48535 22.5205 1.48535 22.876 1.69043 23.0811L13.749 35.126ZM4.79395 34.7227H11.1992C11.5 34.7227 11.7598 34.6816 11.9785 34.5928L10.8711 33.4922C10.8096 33.499 10.7549 33.5059 10.6865 33.5059H4.99219C4.69141 33.5059 4.54102 33.3623 4.54102 33V28.2559C4.54102 27.9004 4.68457 27.7637 4.97852 27.7637H5.14258L4.04883 26.6631C3.48828 26.8818 3.21484 27.3809 3.21484 28.208V33.0479C3.21484 34.1963 3.73438 34.7227 4.79395 34.7227Z"})})},973369:(e,t,o)=>{"use strict";o.d(t,{T:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("unsync",{viewBox:"0 0 30 30",svg:(0,n.jsxs)("g",{children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.768 23.295l1.353 1.351a11.298 11.298 0 01-6.118 1.81c-5.862 0-10.781-4.538-11.387-10.254h-1.55c-.809 0-1.011-.55-.573-1.168l2.516-3.572c.37-.527.91-.516 1.269 0l2.515 3.583c.427.606.225 1.157-.572 1.157H5.536a9.496 9.496 0 009.467 8.344c1.74 0 3.366-.454 4.765-1.251zM10.233 6.723l-1.361-1.36a11.26 11.26 0 016.131-1.818c5.851 0 10.782 4.548 11.388 10.265h1.539c.808 0 1.021.539.572 1.167l-2.504 3.572c-.37.528-.91.516-1.27 0l-2.515-3.583c-.427-.617-.224-1.156.573-1.156h1.673a9.503 9.503 0 00-9.456-8.356 9.55 9.55 0 00-4.77 1.27z"}),(0,n.jsx)("path",{d:"M27.067 28.551c.41.41 1.094.41 1.49 0 .41-.41.41-1.08 0-1.49L2.937 1.454a1.06 1.06 0 00-1.505 0c-.396.396-.396 1.08 0 1.49l25.635 25.607z"})]})})},150811:function(e){(function(){var t,o,n;n=[],t={},e.exports=o=function(e,o,i){var r,l,a,s,c,d,u,p;if(null==i&&(i=!0),"string"==typeof o){if(2!==o.length)throw{name:"ArgumentException",message:"The format for string options is '<thousands><decimal>' (exactly two characters)"};p=o[0],r=o[1]}else if(Array.isArray(o)){if(2!==o.length)throw{name:"ArgumentException",message:"The format for array options is ['<thousands>','[<decimal>'] (exactly two elements)"};p=o[0],r=o[1]}else p=(null!=o?o.thousands:void 0)||(null!=o?o.group:void 0)||t.thousands,r=(null!=o?o.decimal:void 0)||t.decimal;return null==(c=n[d=""+p+r+i])&&(a=i?3:1,c=n[d]=new RegExp("^\\s*([+-]?(?:(?:\\d{1,3}(?:\\"+p+"\\d{"+a+",3})+)|\\d*))(?:\\"+r+"(\\d*))?\\s*$")),null==(u=e.match(c))||3!==u.length?NaN:(s=u[1].replace(new RegExp("\\"+p,"g"),""),l=u[2],parseFloat(s+"."+l))},e.exports.setOptions=function(e){var o,n;for(o in e)n=e[o],t[o]=n},e.exports.factoryReset=function(){t={thousands:",",decimal:"."}},e.exports.withOptions=function(e,t){return null==t&&(t=!0),function(n){return o(n,e,t)}},e.exports.factoryReset()}).call(this)}}]);