"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[93191],{336795:(e,t,n)=>{n.r(t),n.d(t,{pauseTranscription:()=>_,runSummarization:()=>M,setToggleState:()=>j,startTranscribingBlockOnPage:()=>A,startTranscription:()=>T,stopTranscription:()=>C,updatePreferredSummarizationFormat:()=>I});n(492176),n(7961);var r=()=>n(730120),o=()=>n(803021),i=()=>n(874459),s=()=>n(998411),a=()=>n(396136),c=()=>n(989478),l=()=>n(955620),d=()=>n(342792),u=()=>n(959137),p=()=>n(421654),m=()=>n(332542),g=()=>n(970105),f=()=>n(269299),h=()=>n(254940),y=()=>n(298721),b=()=>n(964433),x=()=>n(876822),v=()=>n(852559),k=()=>n(648587),S=()=>n(874023);function j(e){const{blockId:t,state:n}=e;k().i.setOpen(t,n)}function T(e){var t;const{environment:n,blockStore:a,transaction:d}=e;k().i.setCurrentlyListeningBlockId(a.id),k().i.setSettingsOpenForBlockId(void 0);const u=a.getContentStores().at(-1)??a;S().DictationManager.startDictation({environment:n,blockStore:u,from:"transcription_block",preCreateDictationBlock:!0});const m=null===(t=x().default.state.currentUserStore)||void 0===t?void 0:t.id;if(!m)return;const h=a.getBlockTitleStore(),y=e=>{const t=r().ou.now(),d=[l().YCD(l().pZr({type:"datetime",start_date:t.toFormat(i().Iq),start_time:t.toFormat(o().jK),time_zone:(0,s().r)(),date_format:"relative"}))];g().sO({environment:n,store:h,value:d,transaction:e}),p().FH({stores:[a],update:{transcription_state:{state:"transcribing",transcriber_id:m,transcriber_table:c().KJ}},transaction:e})};d&&!d.committed?y(d):f().createAndCommit({userAction:"transcriptionBlockActions.initializeTitle",environment:n,canUndo:!0,perform:y})}async function C(e){await w({...e,state:{state:"idle"}})}async function _(e){await w({...e,disableSummarization:!0,state:{state:"paused"}})}async function w(e){const{environment:t,blockStore:n,state:r,disableSummarization:o}=e;k().i.setCurrentlyListeningBlockId(void 0),k().i.setSettingsOpenForBlockId(void 0),R({environment:t,blockStore:n,state:r}),S().DictationManager.stopDictation({environment:t,from:"transcription_block"}),o||await M({environment:t,blockStore:n})}async function M(e){const{environment:t,blockStore:n}=e;if(!x().default.state.mainEditorCurrentBlockStore)return;const r=n.pointer.spaceId;if(!r)return;const o=n.getParentStore();if((null==o?void 0:o.table)!==a().iU)return;let i=n;R({environment:t,blockStore:n,state:{state:"summarizing"}}),B({environment:t,blockStore:n});const s={...n.pointer,spaceId:r},c=await b().p.load(),l=await u().F.clipboardActions.load();await(0,y()._O)({environment:t,onResponse:e=>{if("summarize-transcript-response"!==e.type)return;B({environment:t,blockStore:n});const r=e.response;f().createAndCommit({userAction:"transcriptionBlockActions.summarizeTranscript",environment:t,canUndo:!0,perform:e=>{const s=l.markdownToBlocks({environment:t,text:r,inMemoryRecordCache:n.inMemoryRecordCache,transaction:e,markdownOptions:{},markdownLinkifyIt:c,tinyMceMicrosoftWordPasteFilter:void 0});if(s){(0,h().postProcessAICreatedStores)(t,s),p().FH({stores:s,update:{created_by_transcription_block_id:n.id},transaction:e});for(const t of s)m().jG({childStore:t,parentStore:o,transaction:e,after:i.id}),i=t}}})},data:{transcript:[{id:(0,d().ZP)(),type:"config",value:{type:"summarize-transcript",transcriptPointer:s}},{id:(0,d().ZP)(),type:"summarize-transcript"}],traceId:(0,d().ZP)(),spaceId:r,generateTitle:!1},upsellFrom:"transcription_block"}),R({environment:t,blockStore:n,state:{state:"idle"}})}function B(e){const{environment:t,blockStore:n}=e,r=(0,v().Sn)({blockStore:n});r.length>0&&f().createAndCommit({userAction:"transcriptionBlockActions.deletePreviousSummarizationBlocks",environment:t,canUndo:!0,perform:e=>{for(const t of r){const n=t.getParentStore();(null==n?void 0:n.table)===a().iU&&m().hr({childStore:t,parentStore:n,transaction:e})}}})}function A(e){const{environment:t}=e,n=x().default.state.mainEditorCurrentBlockStore;if(!n)return;const r=(0,v().mH)(n);r.sort(((e,t)=>t.getCreatedTime()-e.getCreatedTime()));const o=r[0];o&&T({environment:t,blockStore:o})}async function I(e){var t;const{environment:n,blockStore:r,format:o}=e;if((null===(t=r.getFormat())||void 0===t?void 0:t.transcription_summarization_format_type)===o)return;f().createAndCommit({userAction:"transcriptionBlockActions.updatePreferredSummarizationFormat",environment:n,canUndo:!0,perform:e=>{p().FH({stores:[r],update:{transcription_summarization_format_type:o},transaction:e})}});(0,v().Sn)({blockStore:r}).length>0&&await M({environment:n,blockStore:r})}function R(e){const{environment:t,blockStore:n,state:r}=e;f().createAndCommit({userAction:"transcriptionBlockActions.setTranscriptionState",environment:t,canUndo:!0,perform:e=>{p().FH({stores:[n],update:{transcription_state:r},transaction:e})}})}},492961:(e,t,n)=>{n.d(t,{h:()=>y});n(670560),n(409045),n(453627),n(994774),n(995194),n(520522),n(200082),n(379976),n(724224),n(761121),n(637133),n(267602),n(241792),n(731107);var r=n(667294),o=()=>n(142735),i=()=>n(846550),s=()=>n(283444),a=()=>n(201741),c=()=>n(360666),l=n(785893);const d=50,u=7e3,p=(d+u)/2,m=(d+p)/2,g=(p+u)/2,f=1.5,h=1.3;function y(e){const{fillWidth:t=!1,forceRender:n=!1}=e,p=(0,o().VK)((()=>a().default.state.audioRecorder),[]),y=(0,o().Kw)(c().Z),b=(0,r.useRef)(null),[x,v]=(0,r.useState)(8),[k,S]=(0,r.useState)([]),j=t?2*f:f,T=t?3*h:h;(0,r.useEffect)((()=>{if(!t||!p&&!n)return;const e=()=>{if(b.current){const e=b.current.clientWidth,t=j+T,n=Math.max(1,Math.floor(e/t));v(n),S(new Array(n).fill(1))}};e();const r=new ResizeObserver(e);return b.current&&r.observe(b.current),()=>r.disconnect()}),[p,t,j,T,n]),(0,r.useEffect)((()=>{if(p&&y){const e=new AbortController,t=e.signal,n=()=>{const{mediaStream:e}=p;if(e){const n=y.createAnalyser();n.fftSize=2048;const r=(()=>{const t=y.createMediaStreamSource(e),r=y.createBiquadFilter();r.type="highpass",r.frequency.setValueAtTime(m,y.currentTime);const o=y.createBiquadFilter();return o.type="lowpass",o.frequency.setValueAtTime(g,y.currentTime),[t,r,o,n]})();for(let e=0;e<r.length-1;e++)r[e].connect(r[e+1]);const o=()=>{for(const e of r)e.disconnect()};y.resume();const i=new Uint8Array(n.frequencyBinCount),s=()=>{if(t.aborted)return void o();n.getByteFrequencyData(i);const e=y.sampleRate/2/n.frequencyBinCount,r=Math.round(d/e),a=Math.round(u/e),c=i.slice(r,a+1),l=Math.floor(c.length/x),p=[];for(let t=0;t<x;t++){const e=c.slice(t*l,t<x-1?(t+1)*l:c.length+1),n=e.reduce(((e,t)=>e+t),0)/e.length,r=Math.max(3,Math.min(12,n/3));p.push(r)}S(p),requestAnimationFrame(s)},a=requestAnimationFrame(s);return()=>{cancelAnimationFrame(a),o()}}};let r=n();const o=()=>{"function"==typeof r&&r(),r=n()};return p.emitter.on(s().oF,o),()=>{p.emitter.off(s().oF,o),"function"==typeof r&&r(),e.abort()}}n&&S(new Array(x).fill(3))}),[p,x,y,n]);const C=(0,i().yK)((e=>({barStyle:{flexShrink:0,bottom:"0",width:`${j}px`,backgroundColor:e.icon.secondary,borderRadius:t?"4px":"1px"}})),[j,t]);return p||n?(0,l.jsx)("div",{ref:b,style:{height:"20px",display:"flex",justifyContent:"center",alignItems:"center",position:"relative",gap:T,flex:t?1:void 0},children:k.map(((e,t)=>(0,l.jsx)("div",{style:{...C.barStyle,height:`${e}px`}},t)))}):(0,l.jsx)("div",{style:{fontSize:"8px",width:t?"100%":void 0},children:"No audio"})}},124333:(e,t,n)=>{n.d(t,{l:()=>_,$:()=>C});n(241792);var r=n(667294),o=()=>n(219727),i=()=>n(142735),s=()=>n(846550),a=()=>n(429600),c=()=>n(456681),l=()=>n(235605),d=()=>n(707513),u=()=>n(265640),p=()=>n(827973),m=()=>n(448419),g=()=>n(255577),f=()=>n(388284),h=()=>n(442531),y=()=>n(677559),b=()=>n(385485),x=()=>n(452701),v=()=>n(354986),k=()=>n(761588),S=()=>n(247724),j=n(785893);function T(e){const t=(0,o().O7)(),{parent:n}=e,r=(0,i().VK)((()=>Object.keys(k().jH).indexOf((0,v()._A)(t.currentUser.id))),[t.currentUser.id]),s=[{key:"languages",render:e=>(0,j.jsx)(f().Z,{...e,topBorder:0!==e.index}),items:(0,v().TG)().map((e=>{let[r,[o]]=e;const i={key:r,render:e=>(0,j.jsx)(p().Z,{...e,title:o}),action:()=>{(0,v().Yg)(t,r),n.close()}};return i}))}];return(0,j.jsx)("div",{className:S().tXr,style:{display:"flex",flexDirection:"column",width:150},children:(0,j.jsx)(g().ZP,{type:g().iW.Vertical,initialFocus:r,sections:s})})}function C(e){const{languagePopupStore:t}=e,n=(0,o().O7)(),l=(0,i().VK)((()=>(0,v()._A)(n.currentUser.id)),[n.currentUser.id]);(0,r.useEffect)((()=>{b().ZP.updateMediaDevices()}),[]);const p=(0,s().yK)((e=>({container:{padding:"8px 0px",display:"flex",flexDirection:"column",alignItems:"flex-start",width:300,gap:8},microphoneText:{marginLeft:12,fontSize:12,fontWeight:d().Ue.medium,color:e.text.secondary},microphoneSection:{display:"flex",flexDirection:"column",width:"100%"},languageText:{fontSize:14,color:e.text.primary},languageSection:{padding:"0px 14px",display:"flex",alignItems:"center",width:"100%",justifyContent:"space-between"},rightChevronStyle:{width:13,height:13,opacity:.5,color:e.icon.secondary},line:{width:"100%",height:1,backgroundColor:e.icon.tertiary,opacity:.3},languageButtonStyle:{fontSize:14,display:"flex",alignItems:"center",gap:10,color:e.text.secondary},helpSection:{padding:"5px 14px",display:"flex",alignItems:"center",justifyContent:"flex-start",gap:4,cursor:"pointer"},helpText:{fontSize:12,color:e.text.tertiary},helpIcon:{width:16,height:16,color:e.icon.tertiary}})),[]),g=(0,r.useMemo)((()=>(0,a().o)(p.rightChevronStyle)),[p.rightChevronStyle]),f=(0,r.useMemo)((()=>(0,c().m)(p.helpIcon)),[p.helpIcon]),{value:x}=(0,y().XJ)(h().io);if(!x)return null;const{motion:k}=x;return(0,j.jsxs)("div",{style:p.container,children:[(0,j.jsxs)("div",{style:p.microphoneSection,children:[(0,j.jsx)("div",{style:p.microphoneText,children:"Microphone"}),(0,j.jsx)(_,{})]}),(0,j.jsx)("div",{style:p.line}),(0,j.jsxs)("div",{style:p.languageSection,children:[(0,j.jsx)("div",{style:p.languageText,children:"Language"}),(0,j.jsx)(m().ZP,{buttonPopupStore:t,renderOrigin:e=>(0,j.jsxs)(u().D,{style:p.languageButtonStyle,...e,children:[l," ",g]}),stopClickPropagation:!0,popupType:m().Z4.Popup,render:e=>(0,j.jsx)(T,{parent:e})})]}),(0,j.jsx)("div",{style:p.line}),(0,j.jsxs)(k.div,{style:p.helpSection,onClick:()=>window.open("https://www.notion.so/help/audio-dictation","_blank"),variants:{hover:{opacity:.6},tap:{opacity:1}},whileHover:"hover",whileTap:"tap",transition:{duration:.2},children:[f,(0,j.jsx)("div",{style:p.helpText,children:"Learn about Dictation"})]})]})}function _(){const e=(0,i().Kw)(b().UR),t=(0,i().Kw)(b().TZ),n=(0,i().VK)((()=>e.findIndex((e=>e.deviceId===(null==t?void 0:t.deviceId)))),[e,t]),r=[{key:"devices",render:e=>(0,j.jsx)(f().Z,{...e,topBorder:0!==e.index}),items:e.map((e=>({key:e.deviceId,render:n=>(0,j.jsx)(p().Z,{...n,title:e.label,right:e.deviceId===(null==t?void 0:t.deviceId)?(0,l().k)({width:14,height:14}):void 0}),action:()=>{x().Z.setState(e)}})))}];return(0,j.jsx)("div",{style:{display:"flex",flexDirection:"column",width:"100%"},children:(0,j.jsx)(g().ZP,{type:g().iW.Vertical,initialFocus:n,sections:r})})}},143550:(e,t,n)=>{n.r(t),n.d(t,{TranscriptionBlock:()=>ze,TranscriptionBlockImpl:()=>Ee});var r=n(667294),o=n(111681),i=()=>n(219727),s=()=>n(142735),a=()=>n(846550),c=()=>n(494488),l=()=>n(156642),d=()=>n(808839),u=()=>n(641772),p=()=>n(396136),m=()=>n(788860),g=()=>n(879952),f=()=>n(58836),h=()=>n(154186),y=()=>n(448419),b=()=>n(1910),x=()=>n(690122),v=()=>n(967092),k=()=>n(842574),S=()=>n(654133),j=()=>n(98275),T=()=>n(627990),C=()=>n(623498),_=()=>n(12512),w=()=>n(856546),M=()=>n(480089),B=()=>n(439871),A=()=>n(857719),I=()=>n(998901),R=()=>n(520849),F=()=>n(561280),Z=()=>n(965903),E=()=>n(336795),z=()=>n(876822);function D(e){return(0,s().VK)((()=>{var t,n;const r=null===(t=z().default.state.currentUserStore)||void 0===t?void 0:t.id,o=null===(n=e.getModel())||void 0===n?void 0:n.getFormat(),i=null==o?void 0:o.transcription_state;return"transcribing"===(null==i?void 0:i.state)&&(null==i?void 0:i.transcriber_id)===r}),[e])}function U(e){return(0,s().VK)((()=>{var t;const n=null===(t=e.getModel())||void 0===t?void 0:t.getFormat();return(null==n?void 0:n.transcription_state)??{state:"idle"}}),[e])}var L=()=>n(648587),O=()=>n(492961),P=()=>n(696459),N=()=>n(707513),K=()=>n(292518),H=()=>n(164079),V=n(785893);const W=(0,m().vU)({transcribing:{id:"dictation.transcriptionBlock.recordingButton.stop",defaultMessage:"Stop"},summarizing:{id:"dictation.transcriptionBlock.recordingButton.summarizing",defaultMessage:"Summarizing"},paused:{id:"dictation.transcriptionBlock.recordingButton.paused",defaultMessage:"Resume"}}),q=(0,m().vU)({stopButtonTooltip:{id:"dictation.transcriptionBlock.recordingButton.stopButtonTooltip",defaultMessage:"Stop and summarize"}});function Y(e){const{store:t,...n}=e,r=(0,i().O7)(),o=(0,s().VK)((()=>{var e;return(null===(e=t.getFormat())||void 0===e||null===(e=e.transcription_state)||void 0===e?void 0:e.state)??"idle"}),[t]);return"idle"===o?null:"transcribing"===o?(0,V.jsx)(X,{...n,onClick:()=>{(0,E().stopTranscription)({environment:r,blockStore:t})}}):"summarizing"===o?(0,V.jsx)($,{}):"paused"===o?(0,V.jsx)(J,{...n,onClick:()=>{(0,E().startTranscription)({environment:r,blockStore:t})}}):(0,P().t1)(o)}function $(){const e=(0,a().yK)((e=>({text:{fontSize:14,fontWeight:N().Ue.medium,color:e.lightTextColor}})),[]);return(0,V.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,V.jsx)(K().Z,{isTriColored:!0}),(0,V.jsx)("span",{style:e.text,children:(0,V.jsx)(m()._H,{...W.summarizing})})]})}function X(e){const[t,n]=(0,r.useState)(!1),o=ee(t);return(0,V.jsx)(S().Z,{render:t=>{const r={onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1)};return(0,V.jsxs)(h().Z,{...(0,H().Z)(t,{...e,mouseHoverEvents:r}),style:o.container,hoveredStyle:o.hoveredStyle,children:[(0,V.jsx)(Q,{}),(0,V.jsx)("span",{style:o.text,children:(0,V.jsx)(m()._H,{...W.transcribing})})]})},renderTooltip:()=>(0,V.jsx)(m()._H,{...q.stopButtonTooltip})})}function J(e){const[t,n]=(0,r.useState)(!1),o=ee(t);return(0,V.jsxs)(h().Z,{...e,style:o.container,hoveredStyle:o.hoveredStyle,onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),children:[(0,V.jsx)(G,{}),(0,V.jsx)("span",{style:o.text,children:(0,V.jsx)(m()._H,{...W.paused})})]})}function G(e){const t=ee(!1),n=(0,a().yK)((()=>({icon:{...t.recordIcon,...e.style}})),[e.style,t.recordIcon]);return(0,V.jsx)("div",{style:n.icon})}function Q(e){const t=ee(!1),n=(0,a().yK)((()=>({icon:{...t.stopIcon,...e.style}})),[e.style,t.stopIcon]);return(0,V.jsx)("div",{style:n.icon})}function ee(e){return(0,a().yK)((t=>({container:{height:20,display:"flex",justifyContent:"center",alignItems:"center",gap:6,paddingTop:14,paddingBottom:14,paddingLeft:12,paddingRight:12,borderRadius:16,border:"none",cursor:"pointer",background:t.lightGrayButtonBackground},hoveredStyle:{background:t.accentColors.red[50]},recordIcon:{width:12,height:12,borderRadius:"50%",backgroundColor:t.redButtonBackground},stopIcon:{width:12,height:12,display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.1s ease-in-out",borderRadius:3,backgroundColor:t.redButtonBackground},text:{fontSize:14,color:e?t.redButtonBackground:t.lightTextColor,fontWeight:N().Ue.medium}})),[e])}n(267602),n(470928),n(241792);var te=()=>n(732811),ne=()=>n(567195),re=()=>n(481889),oe=()=>n(957744),ie=()=>n(825886),se=()=>n(190129);const ae=(0,m().vU)({autoTitle:{id:"transcriptionSummarizationFormat.label.auto",defaultMessage:"Auto"},autoSubtitle:{id:"transcriptionSummarizationFormat.subtitle.auto",defaultMessage:"Notion AI chooses the best format"},salesCallTitle:{id:"transcriptionSummarizationFormat.label.salesCall",defaultMessage:"Sales Call"},salesCallSubtitle:{id:"transcriptionSummarizationFormat.subtitle.salesCall",defaultMessage:"Customer insights, needs, follow-ups"},standupTitle:{id:"transcriptionSummarizationFormat.label.standup",defaultMessage:"Standup"},standupSubtitle:{id:"transcriptionSummarizationFormat.subtitle.standup",defaultMessage:"Progress, blockers, action items"},teamMeetingTitle:{id:"transcriptionSummarizationFormat.label.teamMeeting",defaultMessage:"Team Meeting"},teamMeetingSubtitle:{id:"transcriptionSummarizationFormat.subtitle.teamMeeting",defaultMessage:"Updates, decisions, action items"}}),ce=[{type:"auto",title:ae.autoTitle,subtitle:ae.autoSubtitle},{type:"sales-call",title:ae.salesCallTitle,subtitle:ae.salesCallSubtitle,instructions:"\nThis conversation is a sales call. Make sure to capture:\n- Any needs or asks the customer has brought up.\n- Background information about the customer, such as the customer's role, company, if they are using the product or service, etc.\n- A detailed but concise summary of the conversation.\n- Decisions or commitments that were made during the call if any.\n- Next steps.\n- Action items to be taken after the call.\n"},{type:"standup",title:ae.standupTitle,subtitle:ae.standupSubtitle,instructions:"\nThis conversation is a standup. Make sure to capture:\n- Progress on any projects or tasks.\n- Any blockers or issues that need to be addressed.\n- Action items to be taken after the standup. If possible, include who is responsible for each action item and a deadline for when it should be completed.\n"},{type:"team-meeting",title:ae.teamMeetingTitle,subtitle:ae.teamMeetingSubtitle,instructions:"\nThis conversation is a team meeting. Make sure to capture:\n- Updates on any projects or tasks.\n- Any decisions that were made.\n- Action items to be taken after the meeting. If possible, include who is responsible for each action item and a deadline for when it should be completed.\n"}];var le=()=>n(827973),de=()=>n(198829),ue=()=>n(18748),pe=()=>n(255577),me=()=>n(388284),ge=()=>n(981583),fe=()=>n(868744),he=()=>n(352230),ye=()=>n(226994),be=()=>n(826955),xe=()=>n(852559),ve=()=>n(385485),ke=()=>n(124333);const Se=(0,m().vU)({stopAndTranscribe:{defaultMessage:"Stop and transcribe",id:"transcriptionBlockSettings.stopAndTranscribe"},summarizeTranscript:{defaultMessage:"Summarize transcript",id:"transcriptionBlockSettings.summarizeTranscript"},pauseTranscription:{defaultMessage:"Pause transcription",id:"transcriptionBlockSettings.pauseTranscription"},resumeTranscription:{defaultMessage:"Resume transcription",id:"transcriptionBlockSettings.resumeTranscription"},retrySummary:{defaultMessage:"Retry summary",id:"transcriptionBlockSettings.retrySummary"}});function je(e){const t=D(e.transcriptionBlockStore),n=(0,s().VK)((()=>L().i.getCurrentlyListeningBlockId()===e.transcriptionBlockStore.id),[e.transcriptionBlockStore.id]),r=U(e.transcriptionBlockStore);return t&&n?(0,V.jsx)(we,{...e}):"transcribing"===r.state?(0,V.jsx)(_e,{state:r,transcriptionBlockStore:e.transcriptionBlockStore}):(0,V.jsx)(Te,{transcriptionBlockStore:e.transcriptionBlockStore})}function Te(e){const{transcriptionBlockStore:t}=e,n=(0,i().O7)(),o=Fe(),a=(0,s().VK)((()=>{var e;return(null===(e=t.getModel())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.transcription_summarization_format_type)??"auto"}),[t]),[c,l]=(0,r.useState)(!1);(0,te().Q)((()=>{l((0,xe().MT)(t)||(0,xe().rU)({blockStore:t}))}));const d=ce.find((e=>e.type===a))??ce[0],u=(0,r.useCallback)((e=>{(0,E().updatePreferredSummarizationFormat)({environment:n,blockStore:t,format:e}),L().i.setSettingsOpenForBlockId(void 0)}),[n,t]);return(0,V.jsx)(pe().ZP,{type:pe().iW.Vertical,initialFocus:0,style:o.menuList,sections:[...c?[Me(n,t)]:[],{key:"formatting-options",render:e=>(0,V.jsx)(me().Z,{...e,topBorder:!0}),items:[{key:"format",render:(e,t)=>(0,V.jsx)(fe().Z,{...e,onFocus:t.onFocus,renderOrigin:(e,t)=>(0,V.jsx)(le().Z,{...e,ref:t,icon:(0,oe().E)(o.icon),title:(0,V.jsxs)("div",{style:o.sectionTitle,children:[(0,V.jsx)(m()._H,{id:"transcriptionBlockSettings.format.title",defaultMessage:"Format"}),(0,V.jsx)("div",{style:o.selection,children:(0,V.jsx)(m()._H,{...d.title})})]})}),renderExtension:()=>(0,V.jsx)(Ce,{selectedFormat:d,onFormatChange:u})}),action:()=>{}}]}]})}function Ce(e){const{selectedFormat:t}=e,n=Fe();return(0,V.jsx)(pe().ZP,{type:pe().iW.Vertical,initialFocus:0,style:n.menuList,sections:[{key:"formatting-options",render:e=>(0,V.jsx)(me().Z,{...e}),items:ce.map((n=>({key:n.type,render:e=>(0,V.jsx)(le().Z,{...e,checkState:t.type===n.type,title:(0,V.jsx)(m()._H,{...n.title}),caption:(0,V.jsx)(m()._H,{...n.subtitle})}),action:()=>{e.onFormatChange(n.type)}})))}]})}function _e(e){const{state:t}=e,n=(0,ye().Z)(t.transcriber_id),r=Fe(),o=(0,s().VK)((()=>be().U6.createChildStore(e.transcriptionBlockStore,{table:t.transcriber_table,id:t.transcriber_id})),[e.transcriptionBlockStore,t.transcriber_id,t.transcriber_table]);return(0,V.jsx)(pe().ZP,{type:pe().iW.Vertical,initialFocus:0,style:r.menuList,sections:[{key:"audio-capture",render:e=>(0,V.jsx)(me().Z,{...e}),items:[{key:"transcriber",render:e=>(0,V.jsx)(ue().ZP,{...e,icon:(0,V.jsx)(ge().Z,{userValue:o.getModel(),size:18,style:{borderRadius:12}}),title:(0,V.jsx)(m()._H,{id:"transcriptionBlockSettings.transcriber.title",defaultMessage:"{userName} is transcribing",values:{userName:n}})}),action:()=>{}}]}]})}function we(e){const t=(0,i().O7)(),n=Fe(),r=(0,s().Kw)(ve().TZ);return(0,V.jsx)(pe().ZP,{type:pe().iW.Vertical,initialFocus:0,style:n.menuList,sections:[Me(t,e.transcriptionBlockStore),{key:"audio-input",render:e=>(0,V.jsx)(me().Z,{...e,topBorder:!0}),items:[{key:"microphone",render:(e,t)=>(0,V.jsx)(fe().Z,{...e,onFocus:t.onFocus,renderOrigin:(e,t)=>(0,V.jsx)(le().Z,{...e,ref:t,icon:(0,ie().q)(n.icon),title:(0,V.jsxs)("div",{style:n.sectionTitle,children:[(0,V.jsx)(m()._H,{id:"transcriptionBlockSettings.microphone.title",defaultMessage:"Mic"}),(0,V.jsx)("div",{style:n.selection,children:null==r?void 0:r.label})]})}),renderExtension:()=>(0,V.jsx)(ke().l,{})}),action:()=>{}},{key:"system-audio",render:(e,t)=>(0,V.jsx)(fe().Z,{...e,onFocus:t.onFocus,renderOrigin:(e,t)=>(0,V.jsx)(le().Z,{...e,ref:t,icon:(0,re().l)(n.icon),title:(0,V.jsxs)("div",{style:n.sectionTitle,children:[(0,V.jsx)(m()._H,{id:"transcriptionBlockSettings.systemAudio.title",defaultMessage:"Audio"}),(0,V.jsx)("div",{style:n.selection,children:(0,V.jsx)(m()._H,{id:"transcriptionBlockSettings.systemAudio.selection",defaultMessage:"System"})})]})}),renderExtension:(e,t)=>(0,V.jsx)(de().Z,{menuType:he().o.Popup,...e,children:(0,V.jsx)(pe().ZP,{type:pe().iW.Vertical,initialFocus:0,sections:[{key:"system-audio-options",render:e=>(0,V.jsx)(me().Z,{...e,title:"Coming soon!"}),items:[]}]})})}),action:()=>{}}]}]})}function Me(e,t){return{key:"transcription-state",render:e=>(0,V.jsx)(me().Z,{...e,topBorder:!0}),items:[{key:"transcription-state",render:e=>(0,V.jsx)(Be,{transcriptionBlockStore:t,...e}),action:()=>{}},{key:"summarize-transcription",render:e=>(0,V.jsx)(Re,{transcriptionBlockStore:t,...e}),action:()=>{}}]}}function Be(e){const t=U(e.transcriptionBlockStore);return"summarizing"===t.state?null:"transcribing"===t.state?(0,V.jsx)(Ae,{...e}):(0,V.jsx)(Ie,{...e})}function Ae(e){const{transcriptionBlockStore:t}=e,n=(0,i().O7)(),r=Se.pauseTranscription;return(0,V.jsx)(le().Z,{...e,onClick:()=>{(0,E().pauseTranscription)({environment:n,blockStore:t})},icon:(0,se().l)({height:18,width:18}),title:(0,V.jsx)(m()._H,{...r})})}function Ie(e){const{transcriptionBlockStore:t}=e,n=(0,i().O7)(),r=Se.resumeTranscription;return(0,V.jsx)(le().Z,{...e,onClick:()=>{(0,E().startTranscription)({environment:n,blockStore:t})},icon:(0,V.jsx)(G,{style:{marginLeft:2,width:14,height:14}}),title:(0,V.jsx)(m()._H,{...r})})}function Re(e){const{transcriptionBlockStore:t}=e,n=(0,i().O7)(),r=U(t),o="transcribing"===r.state?Se.stopAndTranscribe:"summarizing"===r.state?Se.retrySummary:Se.summarizeTranscript;return(0,V.jsx)(le().Z,{...e,onClick:()=>{(0,E().stopTranscription)({environment:n,blockStore:t})},icon:(0,ne().d)({height:18,width:18}),title:(0,V.jsx)(m()._H,{...o})})}function Fe(){return(0,a().yK)((e=>({menuList:{minWidth:250},sectionTitle:{display:"flex",flexDirection:"row",alignItems:"center",gap:8},icon:{height:18,width:18},selection:{flex:1,color:e.lightTextColor,maxWidth:140,...N().Yu}})),[])}const Ze=(0,m().vU)({moreOptions:{defaultMessage:"Options",id:"transcriptionBlock.options"},toggleTranscript:{defaultMessage:"Toggle transcript",id:"transcriptionBlock.toggleTranscript"},showTranscript:{defaultMessage:"Show transcript",id:"transcriptionBlock.showTranscriptTooltip"},hideTranscript:{defaultMessage:"Hide transcript",id:"transcriptionBlock.hideTranscriptTooltip"}});function Ee(e,t){const n=(0,i().O7)(),o=(0,r.useRef)(null),z=(0,r.useRef)(null),P=(0,s().qz)(void 0,F().Z),N=(0,m().YB)(),K=(0,s().VK)((()=>L().i.isOpen(e.store.id)),[e.store.id]),H=(0,s().VK)((()=>e.store.getBlockTitleStore()),[e.store]),W=(0,s().VK)((()=>e.store.getContentStore()),[e.store]),q=(0,s().VK)((()=>L().i.isSettingsOpenForBlockId(e.store.id)),[e.store.id]),$=D(e.store),X=U(e.store),J=(0,s().VK)((()=>e.store.getTitleValue().length>0),[e.store]),G=(0,s().VK)((()=>(0,w().b)(e.store)||!e.store.isDefaultRecordCache()),[e.store]),Q=(0,s().VK)((()=>L().i.getCurrentlyListeningBlockId()===e.store.id),[e.store.id]),ee=(0,B().M)();(0,r.useEffect)((()=>{if(!$)return()=>{};const t=()=>{(0,E().stopTranscription)({environment:n,blockStore:e.store,disableSummarization:!0})};return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}}),[n,e.store,$]);const te=(0,r.useCallback)((()=>{(0,E().setToggleState)({blockId:e.store.id,state:!K})}),[K,e.store.id]),ne=(0,r.useCallback)((()=>{(0,E().startTranscription)({environment:n,blockStore:e.store})}),[n,e.store]),re=(0,M().rv)(e.store,!0),oe=(0,a().yK)((t=>({root:{paddingTop:12,paddingBottom:12,paddingLeft:20,paddingRight:20,background:t.accentColors.gray[50],borderRadius:4,...re,...e.style},container:{display:"flex",alignItems:"flex-start"},content:{display:"flex",flexDirection:"column",width:"100%",borderLeft:`3px solid ${t.accentColors.gray[500]}`,paddingLeft:14,paddingRight:14,marginTop:8},controlRowContainer:{display:"flex",justifyContent:"flex-end",alignItems:"center",gap:8,minHeight:24},scrollerContainer:{position:"relative",overflow:"hidden"},scroller:{display:"flex",gap:8,padding:8},snippetContainer:{alignSelf:"flex-start",flexShrink:0},snippet:{color:t.lightTextColor},placeholder:{fontSize:"inherit",width:"100%",borderRadius:4,caretColor:t.lightTextColor,...c().ZD,marginTop:2},placeholderText:{color:t.lightTextColor},moreIconButton:{width:24,height:24},toggleTranscriptIcon:{color:K?t.icon.lightGrayPrimary:t.icon.lightGraySecondary}})),[re,e.style,K]),ie=(0,V.jsx)(h().Z,{style:oe.placeholder,disabled:e.disabled,onClick:ne,children:(0,V.jsx)("span",{style:oe.placeholderText,children:(0,V.jsx)(m()._H,{id:"transcription_block.placeholder",defaultMessage:"Your transcript will appear here. Click to begin recording."})})}),se=(0,V.jsxs)(T().ZP,{style:oe.root,ref:o,children:[(0,V.jsx)(f().p,{allowSelectionWithin:!1,children:(0,V.jsxs)("div",{style:oe.controlRowContainer,children:[J?(0,V.jsx)("div",{style:oe.scrollerContainer,children:(0,V.jsx)(k().T,{role:"title","aria-label":"Transcription title",type:R().Z.X,store:P,ref:z,style:oe.scroller,className:A().us,children:(0,V.jsx)("div",{style:oe.snippetContainer,children:(0,V.jsx)(C().Z,{store:H,disabled:!0,inPageFind:_().B3.block_match})})})}):null,Q||"paused"===X.state?(0,V.jsx)(O().h,{fillWidth:!0,forceRender:"paused"===X.state}):void 0,(0,V.jsx)(S().Z,{renderTooltip:()=>K?(0,V.jsx)(m()._H,{...Ze.hideTranscript}):(0,V.jsx)(m()._H,{...Ze.showTranscript}),render:e=>(0,V.jsx)(b().Z,{...e,icon:d().H,isDarkIconColor:K,hovered:K,ariaLabel:N.formatMessage(Ze.toggleTranscript),onClick:te})}),(0,V.jsx)(Y,{store:e.store}),(0,V.jsx)(y().ZP,{renderOrigin:e=>(0,V.jsx)(b().Z,{icon:u().o,style:oe.moreIconButton,ariaLabel:N.formatMessage(Ze.moreOptions),...e}),render:t=>(0,V.jsx)(je,{transcriptionBlockStore:e.store}),popupType:v().kQ.Popup,placementToOrigin:I().Placement.Bottom,alignmentToOrigin:I().Alignment.End,open:q,onClick:()=>{L().i.setSettingsOpenForBlockId(e.store.id)},onClose:()=>{L().i.setSettingsOpenForBlockId(void 0)}})]})}),K&&(0,V.jsx)(x().Z,{id:ee,loaded:G,spinnerSize:"relative",showSpinnerTimeout:500,innerStyle:oe.content,style:oe.container,children:(0,V.jsx)(j().Z,{store:W,emptyPlaceholder:ie,disabled:e.disabled,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:!0,disableDrag:e.disableDrag})})]});return(0,M().ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"transcription",getNode:()=>o.current,getBlockStore:()=>e.store,handleCreated(){const t=e.store.getParentStore();if((null==t?void 0:t.table)!==p().iU||!t.isType(l().Ti.callout))return;Z().default.state.stores.includes(t)&&g().Ys({environment:n,store:e.store,selectMode:g().W7.TOGGLE})}})),[e.store,n]),se)}const ze=r.memo(r.forwardRef(Ee),o.wU)},852559:(e,t,n)=>{n.d(t,{MT:()=>o,Sn:()=>s,mH:()=>i,rU:()=>a});n(670560),n(267602),n(653476);var r=()=>n(852465);function o(e){const t=e.getContentStores().filter((e=>!e.isEmptyTitle()||e.hasContent()));return t.length>0}function i(e,t){const n=t??[];e.isType("transcription")&&n.push(e);const r=e.getContentStores();for(const o of r)i(o,n);return n}function s(e){const t=[];for(const n of c({blockStore:e.blockStore}))t.push(n);return t}function a(e){for(const t of c({blockStore:e.blockStore}))return!0;return!1}function*c(e){const{blockStore:t}=e,n=t.getNavigableBlockStore();if(!n)return;const o=(0,r().MI)({blockStore:n,transclusionReferences:"omit",childPages:"omit"});for(const r of o){const e=r.getFormatStore();(null==e?void 0:e.getKeyValue("created_by_transcription_block_id"))===t.id&&(yield r)}}},795597:(e,t,n)=>{n.d(t,{Z:()=>o});class r extends(()=>n(263184))().default{constructor(){super()}getInitialState(){}}const o=new r},360666:(e,t,n)=>{n.d(t,{Z:()=>o});class r extends(()=>n(263184))().default{constructor(){super()}getInitialState(){}setState(e){this.instanceState&&this.instanceState.close(),super.setState(e)}addListener(e){super.addListener(e),this.instanceState||this.setState((0,n(982774).k)(24e3))}removeListener(e){super.removeListener(e),0===this.listenerCount()&&this.setState(void 0)}}const o=new r},648587:(e,t,n)=>{n.d(t,{i:()=>o});class r extends(()=>n(263184))().default{getInitialState(){return{toggleMap:{},currentlyListeningBlockId:void 0,settingsOpenForBlockId:void 0}}setOpen(e,t){this.setState({...this.state,toggleMap:{...this.state.toggleMap,[e]:t}})}isOpen(e){return!!this.state.toggleMap[e]}setCurrentlyListeningBlockId(e){this.setState({...this.state,currentlyListeningBlockId:e})}getCurrentlyListeningBlockId(){return this.state.currentlyListeningBlockId}setSettingsOpenForBlockId(e){this.setState({...this.state,settingsOpenForBlockId:e})}isSettingsOpenForBlockId(e){return this.state.settingsOpenForBlockId===e}}const o=new r},439871:(e,t,n)=>{n.d(t,{M:()=>o});var r=n(667294);function o(e){const t=(0,r.useId)();return e??t}},226994:(e,t,n)=>{n.d(t,{Z:()=>c,s:()=>l});var r=()=>n(142735),o=()=>n(989478),i=()=>n(788860),s=()=>n(876822),a=()=>n(826955);function c(e){const t=(0,i().YB)();return(0,r().VK)((()=>{const{currentSpaceStore:n}=s().default.state;if(!n||!e)return;return a().U6.createChildStore(n,{table:o().KJ,id:e}).getDisplayName(t)}),[t,e])}function l(){const e=(0,i().YB)();return(0,r().VK)((()=>{const{currentUserStore:t}=s().default.state,n=null!=t&&t.isDefined()?t.getModel():void 0;return n?n.getDisplayName(e):void 0}),[e])}},857719:(e,t,n)=>{n.d(t,{J7:()=>j,Nx:()=>x,Pb:()=>b,Vc:()=>p,Vw:()=>v,Xg:()=>u,a3:()=>T,uI:()=>C,us:()=>h,w3:()=>m});n(241792);var r=n.n(n(294184)),o=n(667294),i=()=>n(846550),s=()=>n(696459),a=()=>n(802911),c=()=>n(78078),l=()=>n(521635),d=n(785893);const u=o.forwardRef((function(e,t){const{children:o,type:i,gap:s,withBottomPadding:a,style:c,onMouseDown:u,onClick:p,onDoubleClick:m,onContextMenu:g}=e,f=(0,n(309797).n1)(i),h=(0,n(142735).VK)((()=>l().Z.getPanelState("peek").isOpen&&"static_sidebar"===l().Z.getPanelState("peek").displayStyle),[]);return(0,d.jsx)("div",{className:r()("layout",{"layout-wide":"wide"===i,"layout-wide-right-margin-expanded":"wide-right-margin-expanded"===i,"layout-side-peek":"side-peek"===i,"layout-center-peek":"center-peek"===i&&!h,"layout-center-peek-with-layout-panel":"center-peek"===i&&h,"layout-home":"home"===i,"layout-home-phone":"home-phone"===i,"layout-home-redesign-desktop":"home-redesign-desktop"===i,"layout-form":"form"===i,"layout-form-viewer":"form-viewer"===i,"layout-form-viewer-embed":"form-viewer-embed"===i,"layout-phone":"phone"===i,"layout-tablet":"tablet"===i,"layout-template-preview":"template-preview"===i,"layout-chat":"chat"===i,"layout-layout-editor":"layout-editor"===i,"layout-layout-editor-wide":"layout-editor-wide"===i,"layout-layout-editor-narrow":"layout-editor-narrow"===i,"layout-marketplace":"marketplace"===i,"layout-marketplace-mobile":"marketplace-mobile"===i,"layout-team-home":"team-home"===i,"layout-team-home-mobile":"team-home-mobile"===i,"layout-create-post":"create-post"===i}),style:{paddingBottom:a?f:void 0,gap:s,...c},ref:t,onMouseDown:u,onClick:p,onDoubleClick:m,onContextMenu:g,children:o})})),p="layout-content",m="layout-full",g="layout-margin-right",f="layout-nested-grid",h="hide-scrollbar",y="layout-column",b=o.forwardRef((function(e,t){return(0,d.jsx)("div",{className:r()(p,e.className),style:e.style,ref:t,children:e.children})}));function x(e){return(0,d.jsx)("div",{className:m,style:e.style,children:e.children})}function v(e){return(0,d.jsx)("div",{className:g,style:{...e.style,pointerEvents:"none"},children:e.children})}const k=(0,o.forwardRef)((function(e,t){return(0,d.jsx)("div",{className:r()(f,e.className),onClick:e.onClick,style:e.style,role:e.role,id:e.id,"aria-labelledby":e["aria-labelledby"],ref:t,children:e.children})}));function S(e){return"left-aligned"===e?"flex-start":"centered"===e?"center":"right-tabs"===e?"flex-end":void(0,s().t1)(e)}function j(e){const{items:t,style:n,index:r,setIndex:s,title:l}=e,u=(0,o.useRef)([]),p="centered"===n||"right-tabs"===n,m=(0,i().yK)((e=>({icon:{width:16,height:16,fill:"currentColor"},label:{fontSize:14,fontWeight:600},header:"right-tabs"===n?{display:"flex",justifyContent:"space-between",alignItems:"baseline"}:{},tablist:"right-tabs"===n?{display:"flex"}:{},tab:p?{cursor:"pointer",border:"none",padding:"6px 12px",borderRadius:20,color:e.text.secondary,background:"none"}:{cursor:"pointer",border:"none",borderBottom:"2px solid",borderColor:"transparent",padding:"6px 8px 12px",color:e.text.secondary,background:"none"},tabSelected:p?{color:e.text.primary,background:e.tint.regular}:{color:e.text.primary,borderColor:e.regularTextColor}})),[p,n]),g=(0,o.useId)(),f=(0,o.useCallback)((e=>`${g}-tab-${e}`),[g]),h=(0,o.useCallback)((e=>`${g}-tabpanel-${e}`),[g]),y=(0,o.useCallback)((e=>{let n;var o;("ArrowLeft"===e.key?(e.preventDefault(),n=(r+t.length-1)%t.length):"ArrowRight"===e.key&&(e.preventDefault(),n=(r+1)%t.length),void 0!==n)&&(s(n),null===(o=u.current[n])||void 0===o||o.focus())}),[r,s,t.length]);return(0,d.jsx)(a().Z,{name:"PageLayoutTabs",children:(0,d.jsxs)(k,{children:[(0,d.jsx)(b,{children:(0,d.jsxs)("div",{style:m.header,children:["right-tabs"===n&&l,(0,d.jsx)("div",{role:"tablist",style:m.tablist,children:(0,d.jsx)(c().X2,{justifyContent:S(n),children:t.map(((e,t)=>{var n;return(0,d.jsx)("button",{ref:e=>{e&&(u.current[t]=e)},id:f(t),role:"tab","aria-controls":h(t),"aria-selected":t===r,tabIndex:t===r?void 0:-1,onKeyDown:y,style:{...m.tab,...t===r&&m.tabSelected},onClick:e=>{e.stopPropagation(),s(t)},children:(0,d.jsxs)(c().X2,{gap:4,alignItems:"center",children:[null===(n=e.icon)||void 0===n?void 0:n.call(e,m.icon),e.label&&(0,d.jsx)("div",{style:m.label,children:e.label})]})},e.key)}))})})]})}),(0,d.jsx)(k,{id:h(r),role:"tabpanel","aria-labelledby":f(r),children:t[r]?t[r].children:null})]})})}function T(e){return(0,d.jsx)("div",{className:r()(y,e.className),style:{"--min-column-width":e.minWidth?`${e.minWidth}px`:"100%",...e.style},children:e.children})}function C(e){return(0,d.jsxs)(T,{minWidth:e.minWidth,className:e.className,style:e.style,children:[e.left,e.right]})}},157955:(e,t,n)=>{n.r(t),n.d(t,{DEFAULT_MAX_RECURRENCE_DUPLICATION_PER_TASK:()=>B,MAXIMUM_DAILY_RECURRENCES_IN_PATH:()=>S,MAXIMUM_NESTED_RECURRENCE_LEVEL:()=>k,MAX_RECURRENCE_INTERVAL:()=>h,MAX_RECURRENCE_NUMBER_OF_RUNS:()=>y,RRULE_WEEKDAYS_MAP:()=>f,convertFromUnpersistedRecurrenceConfig:()=>F,convertToUnpersistedRecurrenceConfig:()=>A,getFormattedEndCondition:()=>M,getFormattedNextRecurrenceTime:()=>w,getNewEndTimestamp:()=>I,getNextDateUtc:()=>_,getRecurrenceAfter:()=>T,isRunningBetweenMidnightAnd3AM:()=>C,isValidRecurrenceInterval:()=>b,isValidRecurrenceNumberOfRuns:()=>x,rruleFromRecurrence:()=>v,templateAncestorsViolateRecurrenceNesting:()=>j});n(267602),n(653476),n(241792);var r=()=>n(730120);n(670560);function o(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(0===n.length)return e.map((e=>[e]));const i=[];for(const s of e)i.push(...o(n[0],...n.slice(1)).map((e=>[s,...e])));return i}var i=()=>n(696459),s=()=>n(326966),a=()=>n(803021),c=()=>n(646574),l=()=>n(998411),d=()=>n(578292);class u extends(()=>n(484885))().Ci{constructor(e,t){super(e,t)}after(e,t){return super.after(e,t)}}var p=()=>n(494616);const m=(0,n(788860).vU)({dateAtTime:{id:"automations.recurrenceHelpers.dateAtTime",defaultMessage:"{date} at {time}"},dateBetweenMidnightAnd3AM:{id:"automations.recurrenceHelpers.dateBetweenMidnightAnd3AM",defaultMessage:"{date} between 12â€“3 AM"},numberEndConditionDescription:{id:"automations.recurrenceHelpers.numberEndConditionDescription",defaultMessage:"{number, plural, one {After {number} run} other {After {number} runs}}"},noEndCondition:{id:"automations.recurrenceHelpers.noEndCondition",defaultMessage:"Never"}}),g={day:u.DAILY,week:u.WEEKLY,month:u.MONTHLY,year:u.YEARLY},f={MO:u.MO,TU:u.TU,WE:u.WE,TH:u.TH,FR:u.FR,SA:u.SA,SU:u.SU},h=99,y=999;function b(e){return(0,s().hj)(e)&&Number.isInteger(e)&&e>0&&e<=h}function x(e){return(0,s().hj)(e)&&Number.isInteger(e)&&e>0&&e<=y}function v(e){const{start_date:t,frequency:n,interval:r,weekdays:s,timezone:c,hour:l,minute:d}=e,p="week"===n&&s?s.map((e=>f[e])):void 0,m={};return(0,i().$K)(e.end_condition)&&("date"===e.end_condition.type?m.until=(0,a().pd)(e.end_condition.end_at):"number"===e.end_condition.type?m.count=e.end_condition.number_of_occurrences:(0,i().t1)(e.end_condition)),"month"===e.frequency&&(0,i().$K)(e.monthly_restriction)&&("monthdays"===e.monthly_restriction.type?m.bymonthday=e.monthly_restriction.monthdays:"weekdays_in_month"===e.monthly_restriction.type?m.byweekday=o(e.monthly_restriction.weekdays,e.monthly_restriction.week_numbers).map((e=>{let[t,n]=e;return f[t].nth(n)})):(0,i().t1)(e.monthly_restriction)),new u({freq:g[n],dtstart:(0,a().pd)(t),interval:r,byweekday:p,tzid:c,byhour:l??0,byminute:d??0,bysecond:0,...m})}const k=1,S=1;function j(e){var t;if(0===e.length)return{violatesConstraint:!1,templateNestingExceedsMaxDepth:!1,ancestorHasDailyTemplate:!1,nestedDepthOfAutomationAncestors:void 0,immediateAncestorRecurrenceType:void 0};const n=e.filter((e=>{var t;return"day"===(null===(t=e.getRecurrence())||void 0===t?void 0:t.frequency)})),r=e.length,o=null===(t=e[0].getRecurrence())||void 0===t?void 0:t.frequency,i=r>k,s=n.length>=S;return{violatesConstraint:i||s,templateNestingExceedsMaxDepth:i,ancestorHasDailyTemplate:s,nestedDepthOfAutomationAncestors:r,immediateAncestorRecurrenceType:o}}function T(e){const{recurrence:t,afterDate:n}=e;if((0,p().nA)(t)){const e=(0,a().kq)(n);return t.start_date>=e?new Date(t.start_date):void 0}{const e=v(t).after((0,a().pd)(n));if(!e)return;return(0,a().YL)(e)}}function C(e){return 0===e.hour||1===e.hour||2===e.hour}function _(e){return v(e).after((0,a().pd)((0,a().Jh)()))||void 0}function w(e){const{recurrence:t,intl:n}=e,o=_(F(t));if(!o)return;const i=C(t),s=r().ou.fromJSDate(o).toUTC().setZone("local",{keepLocalTime:!0}).setLocale((0,d().E2)(n)).setZone(t.timezone),a=(0,c().p6)({date:s,dateFormat:"relative",allowRelativeDates:!0,intl:n,shortenDate:!0});if(i)return n.formatMessage(m.dateBetweenMidnightAnd3AM,{date:a});{let e=s.toLocaleString(r().ou.TIME_SIMPLE);return t.timezone!==(0,l().r)()&&(e+=` ${s.toFormat("ZZZZ")}`),n.formatMessage(m.dateAtTime,{date:a,time:e})}}function M(e,t){return(0,i().$K)(e)?"number"===e.type?t.formatMessage(m.numberEndConditionDescription,{number:e.number_of_occurrences}):"date"===e.type?(0,c().p6)({date:r().ou.fromMillis(e.end_at),dateFormat:"relative",allowRelativeDates:!0,intl:t,shortenDate:!0}):void(0,i().t1)(e):t.formatMessage(m.noEndCondition)}const B=100;function A(e){return{...e,start_date:(0,a().kq)(e.start_date),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?{type:"date",end_at:(0,a().kq)(e.end_condition.end_at)}:(0,i().t1)(e.end_condition):void 0}}function I(e,t,n){return e.plus(n-t)}function R(e,t){const n=r().ou.fromMillis(t.end_at).set({hour:e.hour??0,minute:e.minute??0});return{type:"date",end_at:(0,a().Jh)(n.toJSDate())}}function F(e){return{...e,start_date:(0,a().Jh)(new Date(e.start_date)),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?R(e,e.end_condition):(0,i().t1)(e.end_condition):void 0}}}}]);