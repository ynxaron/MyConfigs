"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[71704],{51820:(e,t,s)=>{s.d(t,{Z:()=>o});var n=()=>s(983946),i=()=>s(619013),r=()=>s(13882);function o(e,t){(0,r().Z)(2,arguments);var s=(0,i().Z)(e).getTime(),o=(0,n().Z)(t);return new Date(s+o)}},86300:(e,t,s)=>{s.r(t),s.d(t,{default:()=>ct});s(670560),s(122556),s(582845),s(250570),s(533019),s(721473),s(788208),s(22624),s(267602),s(916054),s(653476),s(30005),s(241792),s(228244);var n=()=>s(983946),i=()=>s(51820),r=()=>s(13882),o=6e4;var a=s(667294),c=()=>s(219727),l=()=>s(142735),d=()=>s(846550),u=()=>s(506347),h=()=>s(135857),p=()=>s(998411),m=()=>s(565630),g=()=>s(801812),v=()=>s(811799),f=()=>s(754048),x=()=>s(134029),S=()=>s(197033),y=()=>s(48966),I=()=>s(460561),b=()=>s(741633),C=()=>s(375255),M=()=>s(471125),k=()=>s(196442),j=()=>s(899133),w=()=>s(467171),T=()=>s(788860),V=()=>s(513670),P=()=>s(707513),R=()=>s(824462),K=()=>s(959137),_=()=>s(231077),Z=()=>s(956057),B=()=>s(325490),A=()=>s(660259),E=()=>s(11750),O=()=>s(789168),L=()=>s(726143),N=()=>s(250625),U=()=>s(487270),F=()=>s(876822),D=()=>s(379072);var q=()=>s(67338),Q=()=>s(205228),z=()=>s(718959),G=()=>s(43721),H=()=>s(15981),W=()=>s(750858),$=()=>s(358565),X=()=>s(766463),Y=()=>s(370590),J=()=>s(183922),ee=()=>s(696459),te=()=>s(957042),se=()=>s(635596),ne=()=>s(749826);const ie=50;class re extends(()=>s(263184))().default{getInitialState(){return{pageIdToUsers:{},similarUserIdToLastVisitedPageId:{}}}getPageIdToActiveSimilarUsersCount(){const e={};for(const[t,s]of(0,ee().qP)(this.state.pageIdToUsers))e[t]=(null==s?void 0:s.length)??0;return e}}const oe=new re;var ae=()=>s(615389),ce=()=>s(863606);const le=6e4;function de(){const e=(0,c().O7)(),t=e.currentUser.id,s=(0,l().VK)((()=>{ne().default.checkGate({gateName:"similar_user_page_presence_store"});return!1}),[]),n=(0,l().VK)((()=>{if(!s)return[];const e=ae().O.state;if(!e)return[];return(0,ee().qP)(e).sort(((e,t)=>{let[s,n]=e,[i,r]=t;return r-n})).slice(0,ie).map((e=>{let[t]=e;return t}))}),[t,s]),i=(0,a.useCallback)(((e,t)=>{const s=function(e){if(!e||"object"!=typeof e||!("userPageVisit"in e)||!function(e){const t=(0,te().Gu)(Y().mI,e);return void 0===t}(e.userPageVisit))return;return e.userPageVisit}(t);if(!s)return;const n=e.split("/")[1],{visitedAt:i,blockId:r}=s,o={userId:n,visitedAt:i};oe.update((e=>{var t;const s=(0,V().oA)(null===(t=e.pageIdToUsers[r])||void 0===t?void 0:t.filter((e=>e.userId!==n)));return{...e,similarUserIdToLastVisitedPageId:{...e.similarUserIdToLastVisitedPageId,[n]:r},pageIdToUsers:{...e.pageIdToUsers,[r]:[o,...s]}}}))}),[]);(0,a.useEffect)((()=>{if(!s)return;const t=n.map((t=>se().ZP.addListener((0,J().Ns)(t),i,void 0,e)));return()=>{t.forEach((t=>{t&&se().ZP.removeListener(t,e)}))}}),[e,i,s,n]),(0,ce().W)((()=>{oe.update((e=>{const t={...e};for(const[s,n]of(0,ee().qP)(t.pageIdToUsers)){const e=null==n?void 0:n.filter((e=>{const s=ue({timestamp:{timestamp:e.visitedAt}.timestamp,numberOfMinutes:10});return s&&delete t.similarUserIdToLastVisitedPageId[e.userId],!s}));0===(null==e?void 0:e.length)?delete t.pageIdToUsers[s]:t.pageIdToUsers[s]=e}return t}))}),le,s)}function ue(e){return Date.now()-e.timestamp>=e.numberOfMinutes*le}var he=()=>s(944039),pe=()=>s(156045),me=()=>s(115129),ge=()=>s(787306),ve=()=>s(546155),fe=()=>s(998901),xe=()=>s(520849),Se=()=>s(524434),ye=()=>s(255810),Ie=()=>s(485014),be=()=>s(692304),Ce=()=>s(147542),Me=()=>s(127519),ke=()=>s(571699),je=()=>s(135217),we=()=>s(265640),Te=()=>s(827973),Ve=()=>s(78078),Pe=()=>s(1910),Re=()=>s(206352),Ke=()=>s(291198),_e=()=>s(94967),Ze=()=>s(312578),Be=()=>s(255577),Ae=()=>s(708518),Ee=()=>s(967092),Oe=()=>s(679063),Le=()=>s(842574),Ne=()=>s(906769),Ue=()=>s(388284),Fe=()=>s(654133),De=()=>s(627990),qe=()=>s(259878),Qe=()=>s(821671),ze=()=>s(648776),Ge=()=>s(206112),He=s(785893);const We=7,$e=20;function Xe(){const e=(0,c().O7)(),t=(0,T().YB)(),s=(0,l().VK)((()=>F().default.state.currentSpaceViewStore),[]),v=(0,l().Kw)(Ce().Z);de();const f=(0,l().VK)((()=>{const e=F().default.state.currentSpaceStore;if("deep_dive"!==v.surface||!e)return;const s=v.store.getValue();return(0,C().Xh)({textValue:s,getRecordModel:e.getRecordModel,userTimeZone:(0,p().r)(),intl:t})}),[v,t]),x=(0,l().VK)((()=>"deep_dive"===v.surface?(null==f?void 0:f.trim())??"":v.query.trim()),[v,f]);(0,a.useEffect)((()=>{v.isOpen&&Ce().Z.update((e=>({...e,openedTimeMs:Date.now()})))}),[v.isOpen]);const I=(0,me().P)();(0,g().r5)((async()=>{if(!I.botId)return;const t="two_days",n=(0,ge().$X)(t);await(0,he().YZ)({environment:e,currentSpaceViewStore:s,forceRefetch:!1,reason:"background_load",botId:I.botId,timeRange:{key:t,...n}})}),[I.botId,s,e]);const M=(0,l().VK)((()=>"on"===ne().default.getEligibleGroup({experimentId:"search_quickfind_prefetch"})),[]),P=0===x.length,{results:K,searchSessionId:Q,searchSessionFlowNumber:G,isResultsLoading:Y,searchAnalytics:J}=(0,X().s)({searchQuery:x,limit:We,source:"mini_quick_find",type:j().n8.BlocksInSpace,disable:P,isLocalOnlyMode:!1,isTitleOnly:!0,usePrefetch_EXPERIMENTAL:M,overrideSearchSessionId:v.sessionId}),[ee,te]=(0,a.useState)("recents"),se=(0,m().D9)(ee),ie=(0,a.useMemo)((()=>(0,k().A7)({searchSessionId:Q,searchSessionFlowNumber:G})),[Q,G]),re=(0,l().VK)((()=>v.isNewElectronTab),[v.isNewElectronTab],{debugName:"MiniSearch.isNewElectronTab"}),oe=(0,l().VK)((()=>ye().default.state.tabs),[],{debugName:"MiniSearch.electronTabs"}),ae=(0,l().VK)((()=>{if(0===x.length)return[];return(0,$().GQ)({query:x,environment:e,searchMode:"nav-local-only"})??[]}),[e,x],{debugName:"MiniSearch.matchingActions"}),le=(0,a.useCallback)((t=>{var s;const n=null===(s=Ce().Z.state.previousTextSelection)||void 0===s?void 0:s.multiSelection;(0,je().lO)({openedTimeMs:v.openedTimeMs??0,searchSessionId:v.sessionId??"",environment:e}),Ce().Z.update((e=>({...e,isOpen:!1,query:t.shouldResetQuery?"":x,isNewElectronTab:!1,openedTimeMs:t.shouldResetMetricsState?void 0:e.openedTimeMs,sessionId:t.shouldResetMetricsState?void 0:e.sessionId,previousTextSelection:void 0}))),Je(!1),Ge(!1),Fe($e),n&&"editing"!==Me().default.state.mode&&Me().default.setState({forceExtendAnnotations:{},mode:"editing",multiSelection:n})}),[e,v,x]),ue=(0,a.useCallback)((t=>(0,Qe().V)({environment:e,result:t,action:()=>le({shouldResetQuery:!0,shouldResetMetricsState:!1}),queryId:ie,isMiniSearch:!0,desktopProps:{electronTabs:oe,isNewElectronTabSearch:Boolean(re)}})),[le,oe,e,re,ie]),Ie=(0,a.useMemo)((()=>{const e=[];return ae.forEach((t=>{const{eventName:s}=t;"full_search"!==s&&"full_search_deep_dive"!==s&&"deep_dive"!==s&&e.push(ue(t))})),e}),[ue,ae]),we=(0,l().VK)((()=>"default"===v.surface&&"center"===v.position),[v]),Te=function(){const e=(0,c().O7)(),[t,s]=(0,a.useState)([]),d=(0,l().VK)((()=>ve().Z.getEvents()),[]),u=(0,l().VK)((()=>F().default.state.currentSpaceStore),[]),h=(0,a.useCallback)((()=>{const e=Date.now();if(!u)return[];const t=d.filter((t=>{var s;if(t.isAllDay||"declined"===t.responseStatus)return!1;const a=function(e,t){(0,r().Z)(2,arguments);var s=(0,n().Z)(t);return(0,i().Z)(e,s*o)}(new Date(t.end.dateTime),5);return((null===(s=t.attachments)||void 0===s?void 0:s.length)??0)>0&&a.getTime()>=e}));return t}),[u,d]);(0,ce().W)((()=>{const e=h(),n=e.map((e=>e.id)),i=t.map((e=>e.id));(0,V().e5)(n,i).length>0&&s(e)}),12e4,!0);const p=2,m=(0,l().VK)((()=>{const s=[];for(const n of t){const{attachments:t}=n;if(s.length===p)break;const i=(0,V().oA)(null==t?void 0:t.map((t=>{const s=t.fileUrl;return(0,pe().G)({environment:e,fileUrl:s,currentSpaceStore:u})}))),r=i.length>0?i[0]:void 0;r&&!s.includes(r)&&s.push(r)}return s}),[t,e,u]);return m}(),Ve=(0,l().VK)((()=>(0,z().np)()),[]),Pe=(0,l().VK)((()=>F().default.state.currentSpaceStore),[]),Ze=(0,l().VK)((()=>null==Pe?void 0:Pe.id),[null==Pe?void 0:Pe.id]),[Oe,Fe]=(0,a.useState)($e),[qe,Ge]=(0,a.useState)(!1),[Xe,Je]=(0,a.useState)(!1),tt=(0,l().VK)((()=>H().X4.state.filter((e=>e.pageId!==(null==Ve?void 0:Ve.id)&&!Te.some((t=>t.id===e.pageId)))).slice(0,Oe-Te.length)),[null==Ve?void 0:Ve.id,Oe,Te]),st=(0,a.useCallback)((t=>{Ze&&(0,ze().nl)({environment:e,offsetFromBottom:t,spaceId:Ze,setIsLoadingRecents:Ge,setEndOfRecentsReached:Je,numRecents:Oe,setNumRecents:Fe,endOfRecentsReached:Xe,isLoadingRecents:qe,incrementBy:$e})}),[Xe,e,qe,Oe,Ze]),ct=u().tY.MiniQuickFind,lt=(0,a.useMemo)((()=>"results"===ee?"query_results":"recent_pages"),[ee]),dt=(0,l().VK)((()=>e.device.isElectron),[e]),ut=(0,l().VK)((()=>(0,W().b)(e)),[e]),ht=(0,a.useCallback)((t=>{const s=t.store;return{action:n=>{let{event:i}=n;const r=(0,N().DJ)(i);if(J.trackSelectSearchItem({result:t,isMetaClick:Boolean(r),context:lt}),r||le({shouldResetQuery:!0,shouldResetMetricsState:!1}),dt&&ut){const e=(0,h().Z)({pageModel:s.getModel(),pageId:s.id,pageVisitSource:ct,queryId:ie});_().openQuickSearchResult(e)}else q().PR({searchResult:{type:"custom",store:s},environment:e,pageVisitSource:ct,queryId:ie,openInNew:r,electronTabSearch:{tabs:oe,isNewTab:Boolean(re)},context:lt})},key:s.id,render:e=>{var n,i;const r={verified:!1,is_template:!1,most_viewed:!1,popular_this_week:Boolean(null===(n=t.localSource)||void 0===n?void 0:n.has("topPages7dPageView")),verified_expired:!1};return null===(i=t.badges)||void 0===i||i.forEach((e=>{r[e.type]=!0})),(0,He.jsx)(et,{...e,store:s,currentView:ee,badges:r})}}}),[le,lt,oe,e,ut,dt,re,ct,J,ie,ee]),pt=(0,l().VK)((()=>K.map((e=>ht(e)))),[ht,K],{debugName:"MiniSearch.resultItems"}),mt=(0,l().VK)((()=>{const e=new Map;return tt.forEach(((t,s)=>{const n=(0,H()._5)(t.visitedAt),i=Ye({blockStore:t.store,idx:s,resultFeatureNames:["RECENT_ALIVE_PAGES"]}),r=ht(i);var o;e.has(n)?null===(o=e.get(n))||void 0===o||o.push(r):e.set(n,[r])})),e}),[ht,tt],{debugName:"MiniSearch.resultsByBucket"}),gt=(0,a.useMemo)((()=>{const e=[...Ie,...pt];if(0!==e.length)return{items:e,key:"results",render:e=>(0,He.jsx)(Ue().Z,{...e,title:t.formatMessage(ot.quickMatchesSectionTitle)})}}),[t,Ie,pt]),vt=(0,a.useCallback)((async t=>{le({shouldResetQuery:!0,shouldResetMetricsState:!1}),await ke().W({environment:e,menuListItemAction:t.menuListItemAction,query:x,isNewElectronTab:re,searchSessionId:Q,surface:v.surface})}),[le,e,re,v.surface,x,Q]),ft=(0,a.useCallback)((async t=>{le({shouldResetQuery:!0,shouldResetMetricsState:!1}),await async function(e){var t;const{environment:s,menuListItemAction:n,query:i,isNewElectronTab:r,searchSessionId:o}=e;if(!i||0===i.trim().length)return;const a=r?(0,N().DJ)(null==n?void 0:n.event)||"tab":(0,N().DJ)(null==n?void 0:n.event);(0,O().openFullPageChat)({primeTextInput:i,environment:s,shouldFocusInput:!1,openInNew:a,query:i,deepFindRequestedForNewTabOrWindow:!0,from:"research_mode"});const{sessionId:c}=await(0,A().resetAndInitializeAssistantSession)({environment:s,deepFindRequested:!0,searchSessionId:o}),l=D().default.getSessionContext(c);if(!l)return;const d=(0,U().TS)({environment:s,table:B().kL,spaceId:null===(t=F().default.state.currentSpaceStore)||void 0===t?void 0:t.id});l.addClientStep({type:"assistantStartResearchMode",message:i,inferenceId:Z().Il(),threadId:d}),await(0,E().upsertStepToChatSessionHistory)({sessionId:c,environment:s,assistantSurfaceType:L().FP.fullPage.type,forceOverrideSessionContext:l})}({environment:e,menuListItemAction:t.menuListItemAction,query:x,isNewElectronTab:re,searchSessionId:Q,surface:v.surface})}),[le,e,re,v.surface,x,Q]),xt=(0,l().VK)((()=>{const e=function(e){const{onClick:t}=e;return{action:t,key:"deep-find-entry-point",render:e=>(0,He.jsx)(it,{menuListProps:e,title:(0,He.jsx)(T()._H,{...ot.deepFindTitle}),subtitle:(0,He.jsx)(T()._H,{...ot.deepFindSubtitle}),renderIcon:e=>(0,S().q)(e)})}}({onClick:e=>vt({menuListItemAction:e})}),t=[e];if(Se().KR.isResearchModeMiniSearchEnabled()){const e=function(e){const{onClick:t}=e;return{action:t,key:"research-mode-entry-point",render:e=>(0,He.jsx)(it,{menuListProps:e,title:(0,He.jsx)(T()._H,{...ot.researchModeTitle}),subtitle:(0,He.jsx)(T()._H,{...ot.researchModeSubtitle}),renderIcon:e=>(0,He.jsx)(rt,{styles:e})})}}({onClick:e=>ft({menuListItemAction:e})});t.push(e)}return{items:t,key:"search",render:e=>(0,He.jsx)(Ue().Z,{...e})}}),[vt,ft]),St=(0,a.useMemo)((()=>{if(re)return(0,ze().De)({environment:e,intl:t,electronTabs:oe,isNewElectronTab:re})}),[e,t,re,oe]),yt=(0,l().VK)((()=>{const e=[];if(St&&e.push({items:[St],key:"new-page",render:e=>(0,He.jsx)(Ue().Z,{...e})}),Te.length>0){const s=Te.map(((e,t)=>Ye({blockStore:e,idx:t,resultFeatureNames:["UPCOMING_MEETING_ATTACHMENTS"]})));e.push({items:s.map(ht),key:"upcoming-meeting-attachments",render:e=>(0,He.jsx)(Ue().Z,{...e,title:t.formatMessage(ot.fromCalendarEvents)})})}return H()._k.forEach((t=>{const s=mt.get(t);s&&0!==s.length&&e.push({items:s,key:`recent-pages-${t}`,render:e=>(0,He.jsx)(Ue().Z,{...e,title:(0,He.jsx)(ze().Kg,{bucket:t})})})})),e}),[ht,t,St,Te,mt]),It=(0,a.useMemo)((()=>{const e=[xt];return gt&&e.push(gt),e}),[gt,xt]),bt=(0,a.useMemo)((()=>new(be().Z)),[]),Ct=(0,a.useCallback)((e=>{bt.setState({focus:{section:e.section??0,indexLocal:e.indexLocal,indexGlobal:e.indexGlobal,footerFocused:!1}})}),[bt]),Mt=K.length>0,kt=Y&&"recents"===se&&!P&&!Mt;(0,a.useEffect)((()=>{te(P?"recents":"results"),Ct({indexLocal:0,indexGlobal:0,section:0})}),[Ct,P,Mt]),(0,a.useEffect)((()=>{v.isOpen&&Ze&&(R().callApi({eventName:"warmSearchCache",environment:e,data:{spaceId:Ze}}),R().callApi({eventName:"warmVectorDBCache",environment:e,data:{spaceId:Ze},headers:(0,b().Bb)({spaceId:Ze})}))}),[v.isOpen,e,Ze]);const jt=(0,a.useCallback)((e=>{const t=e.trim();0===t.length&&te("recents"),Ce().Z.update((e=>({...e,query:t})))}),[]),wt=x.length>0&&"default"===v.surface&&0===K.length&&!kt&&0===Ie.length&&"results"===ee,Tt=function(e){const{shouldUseCenterModal:t,isElectron:s}=e,n=(0,c().O7)(),{isDeepDive:i,isSidebarPosition:r}=(0,l().VK)((()=>{const e=Ce().Z.state;return{isDeepDive:"deep_dive"===e.surface,isSidebarPosition:"default"===e.surface&&"sidebar"===e.position}}),[]),o=(0,a.useMemo)((()=>s?(0,w().R6)(n.device.isElectronMac)-8:void 0),[n.device.isElectronMac,s]);return(0,d().yK)((e=>{const n=r?500:400;return{searchIcon:{color:e.mediumIconColor,width:20,height:20,marginLeft:4,marginRight:4},input:{margin:"10px 10px",width:"auto",fontSize:14},container:{width:t?600:i?"100%":420,display:"flex",flexDirection:"column"},scroller:{width:"100%",minHeight:i?0:n,maxHeight:n,position:"relative",display:"flex",flexDirection:"column"},popup:{marginTop:r&&s?o:0}}}),[r,t,i,s,o])}({shouldUseCenterModal:we,isElectron:dt}),Vt=(0,a.useMemo)((()=>{if("deep_dive"===v.surface)return null;const e={placeholder:t.formatMessage(re?ot.openInNewTabPlaceholder:ot.defaultInputPlaceHolder),left:re?(0,y().z)(Tt.searchIcon):(0,S().q)(Tt.searchIcon)};return(0,He.jsx)(Re().Z,{capture:!0,debugName:"MiniSearch",children:(0,He.jsx)(_e().Z,{capture:!0,debugName:"MiniSearch",onEsc:()=>le({shouldResetQuery:!1,shouldResetMetricsState:!0}),children:(0,He.jsx)(Ke().Z,{...e,value:x,focus:!0,onChange:e=>jt(e.target.value),format:Ke().B.Transparent,style:Tt.input,autoFocus:!0,focusInitial:!0})})})}),[le,t,re,v.surface,x,jt,Tt.input,Tt.searchIcon]),Pt=(0,l().VK)((()=>(0,He.jsxs)("div",{style:Tt.container,children:[Vt,(0,He.jsxs)(Le().T,{type:xe().Z.Y,style:Tt.scroller,children:[(0,He.jsx)(Be().ZP,{type:Be().iW.Vertical,initialFocus:0,sections:"recents"===ee?yt:It,disableKeyboardArrowWrap:!0,store:bt}),wt?(0,He.jsx)(at,{}):null,"recents"===ee?(0,He.jsx)(Ne().Z,{onChange:st}):null]}),(0,He.jsx)(nt,{})]})),[Tt.container,Tt.scroller,Vt,ee,yt,It,bt,wt,st]);return we?(0,He.jsx)(Ae().Z,{open:v.isOpen,onDismiss:()=>le({shouldResetQuery:!1,shouldResetMetricsState:!0}),render:()=>Pt,transitionAppearance:"none",isWaxPaper:!0,backgroundStyle:{background:"transparent"},innerStyle:{width:"max-content",height:"max-content"},style:{display:"flex",alignItems:"center"}}):(0,He.jsx)(Ee().ZP,{open:v.isOpen,popupType:Ee().kQ.Popup,originRect:"default"===v.surface?void 0:v.domRect,sameWidthAsOrigin:"deep_dive"===v.surface,style:Tt.popup,placementToOrigin:fe().Placement.Bottom,alignmentToOrigin:De().v2.Start,keepFocus:"deep_dive"===v.surface,disableMouseCapture:"deep_dive"===v.surface,preventCaptureEsc:"deep_dive"===v.surface,render:()=>Pt,onDismiss:()=>le({shouldResetQuery:!1,shouldResetMetricsState:!0})})}function Ye(e){const{blockStore:t,idx:s,resultFeatureNames:n}=e;return{id:t.id,score:0,spaceId:t.getSpaceId(),sources:[j().vp.Local],featureGroups:n?[{groupName:"custom",features:n.map((e=>({name:e,value:1})))}]:[],store:t,originalPosition:s,localSource:new Set,serverEventProperties:void 0}}function Je(e){const{spaceStore:t,similarUsers:n,isUserPresentOnPage:i}=e;if(!t)return[];return[...n].sort(((e,t)=>{const s=i({userId:e.userId,visitedAt:e.visitedAt});return s!==i({userId:t.userId,visitedAt:t.visitedAt})?s?-1:1:t.visitedAt-e.visitedAt})).slice(0,4).map((e=>{const n=s(277533).U.createChildStore(t,{table:s(989478).KJ,id:e.userId});return n.load(),{store:n,visitedAt:e.visitedAt,isPresent:i({userId:e.userId,visitedAt:e.visitedAt})}}))}const et=a.memo(a.forwardRef((function(e,t){const{store:n,focused:i,currentView:r,badges:o}=e,c=(0,T().YB)(),u=(0,l().VK)((()=>(0,Oe().Lk)(n)),[n]),h=(0,l().VK)((()=>(0,He.jsx)(Oe().ZP,{store:n,showFullPathInTooltip:!0})),[n]),p=(0,l().VK)((()=>F().default.state.currentSpaceStore),[]),m=(0,l().VK)((()=>n.id),[n]),g=(0,l().VK)((()=>oe.state.pageIdToUsers[m]??[]),[m]),v=(0,l().VK)((()=>(0,He.jsx)(s(384241).Z,{store:n,style:{fontWeight:P().Ue.medium}})),[n]),x=(0,l().VK)((()=>n.getIcon()),[n]),S=(0,l().VK)((()=>n.isEmptyPage()),[n]),y=(0,l().VK)((()=>(0,He.jsx)(s(943620).Z,{disabled:!0,icon:x,isEmptyPage:S,size:20})),[x,S]),I=(0,l().VK)((()=>oe.state.similarUserIdToLastVisitedPageId),[]),b=(0,a.useCallback)((e=>function(e){return!ue({timestamp:e.timestamp,numberOfMinutes:2})}({timestamp:e.visitedAt})&&I[e.userId]===m),[I,m]),C=(0,l().VK)((()=>Je({spaceStore:p,similarUsers:g,isUserPresentOnPage:b})),[b,g,p]),M=(0,l().VK)((()=>C.every((e=>e.store.isReady()))),[C]),k=(0,a.useMemo)((()=>{if(!M)return null;const e=C.length;return(0,He.jsx)("div",{style:{display:"flex"},children:C.map(((t,s)=>{let{store:n,visitedAt:i,isPresent:r}=t;return(0,He.jsx)("span",{style:{zIndex:e-s},children:(0,He.jsx)(tt,{userStore:n,isPresent:r})},`search-user-presence-${n.id}-${m}-${i}`)}))})}),[M,m,C]),w=(0,d().yK)((e=>({enterIcon:{width:12,height:12,color:e.text.secondary,display:i?"block":"none"},divider:{color:e.text.tertiary},databaseIcon:{color:e.text.secondary,width:14,height:14},verifiedIcon:{width:15,height:15,color:e.text.uiBluePrimary}})),[i]),V=(0,a.useMemo)((()=>(0,He.jsxs)(Ve().X2,{gap:12,alignItems:"center",children:[k,(0,He.jsx)("div",{children:(0,f().U)(w.enterIcon)})]})),[k,w.enterIcon]),R="recents"===r,K=(0,l().VK)((()=>{if(R)return null;return n.isType("link_to_collection")||n.isType("collection_view_page")||n.isType("collection_view")?(0,s(466222).v)(w.databaseIcon):null}),[R,n,w.databaseIcon]);return(0,He.jsx)(Te().Z,{...e,ref:t,buttonStyle:{padding:"4px 0px"},hoveredStyle:{padding:"4px 0px"},title:(0,He.jsxs)(Ve().X2,{gap:4,alignItems:"center",children:[v,K,o.verified&&(0,s(269309).A)(w.verifiedIcon),o.is_template&&(0,He.jsx)(Ge().zW,{label:c.formatMessage(j().Pe.template)}),o.popular_this_week&&(0,He.jsx)(Ge().Br,{label:c.formatMessage(j().Pe.popularThisWeek)}),u&&R?(0,He.jsxs)(He.Fragment,{children:[(0,He.jsx)("span",{style:w.divider,children:"—"}),h]}):null]}),caption:u&&!R?(0,He.jsx)(Ve().X2,{gap:4,children:h}):void 0,icon:y,right:V,className:"notranslate"})})));function tt(e){const{userStore:t,isPresent:n}=e,i=(0,T().YB)(),r=(0,qe().dY)((e=>(0,s(568017).iY)(t.id,e)),n),{name:o,email:a}=(0,l().VK)((()=>({name:(0,s(499110).Nz)(i,t.getModel()),email:t.getEmail()})),[i,t]),c=(0,d().yK)((e=>({avatarOuterOutline:{...r.avatarOuterOutline,outlineColor:n?r.avatarOuterOutline.outlineColor:e.accentColors.gray[100]}})),[n,r.avatarOuterOutline]);return(0,He.jsx)(Fe().Z,{textWrap:!0,renderTooltip:()=>(0,He.jsxs)("div",{children:[(0,He.jsx)("div",{children:o}),(0,He.jsx)("div",{children:a})]}),render:e=>(0,He.jsx)("div",{style:c.avatarOuterOutline,...e,children:(0,He.jsx)("div",{style:r.avatarBorder,children:(0,He.jsx)(s(981583).Z,{iconStyle:r.avatarInnerOutline,style:r.uiUserAvatarStyles,size:qe().IX,isOffline:!n,userStore:t,avatarShouldShowShadow:!0,initialOverrideStyle:r.initialColor})})})})}function st(e){var t,s,n,i;const r=(0,c().O7)(),o=(0,l().VK)((()=>(0,G().U)({environment:r})),[r]),{readinessTimings:u}=(0,l().Kw)(Ie().Z),h=(0,a.useCallback)((async()=>{const e=await K().F.clipboardActions.load();await e.copyString({environment:r,stringValue:JSON.stringify({cacheStats:o,readinessTimings:u},null,2),copiedMessage:e.clipboardMessages.copiedToClipboard})}),[o,r,u]),p=(0,d().yK)((e=>({buttonContainer:{display:"flex",alignItems:"center",justifyContent:"center",marginLeft:4},devMessage:{color:e.text.secondary},indexBuilding:{color:e.text.tertiary,fontSize:12,display:"flex"}})),[]),m=(0,a.useMemo)((()=>{var e,t,s,n;return(0,He.jsxs)(Ve().sg,{gap:8,children:[o.localSearchableBlocksCacheLoaded&&(0,He.jsxs)(Ve().sg,{gap:2,children:[(0,He.jsx)("div",{children:`Pages: ${o.localSearchableBlocksCacheSize} `}),(0,He.jsx)("div",{children:`Recents: ${null===(e=o.localSearchableBlocksCacheBlockSourceCount)||void 0===e?void 0:e.recentVisit}`}),(0,He.jsx)("div",{children:`Frecency: ${null===(t=o.localSearchableBlocksCacheBlockSourceCount)||void 0===t?void 0:t.frecencyStore}`}),(0,He.jsx)("div",{children:`Similar: ${null===(s=o.localSearchableBlocksCacheBlockSourceCount)||void 0===s?void 0:s.similarUser1dRecentPages}`}),(0,He.jsx)("div",{children:`Popular: ${null===(n=o.localSearchableBlocksCacheBlockSourceCount)||void 0===n?void 0:n.topPages7dPageView}`})]}),!o.hasPersistedRecordCache&&(0,He.jsx)("div",{children:"NO RECORD CACHE"}),(0,He.jsx)("div",{style:p.devMessage,children:"[Dev] Click to copy index metadata"})]})}),[o.hasPersistedRecordCache,null===(t=o.localSearchableBlocksCacheBlockSourceCount)||void 0===t?void 0:t.frecencyStore,null===(s=o.localSearchableBlocksCacheBlockSourceCount)||void 0===s?void 0:s.recentVisit,null===(n=o.localSearchableBlocksCacheBlockSourceCount)||void 0===n?void 0:n.similarUser1dRecentPages,null===(i=o.localSearchableBlocksCacheBlockSourceCount)||void 0===i?void 0:i.topPages7dPageView,o.localSearchableBlocksCacheLoaded,o.localSearchableBlocksCacheSize,p.devMessage]),g=o.localSearchableBlocksCacheLoaded;return(0,a.useMemo)((()=>(0,He.jsx)(Fe().Z,{placement:fe().Placement.Bottom,renderTooltip:()=>m,render:e=>(0,He.jsxs)(Ve().X2,{gap:8,alignItems:"center",children:[(0,He.jsx)(Pe().Z,{...e,style:p.buttonContainer,iconStyle:{height:15,width:15},icon:v().G,onClick:h,ariaLabel:"Button to copy local/client search index readiness"}),g?null:(0,He.jsx)("div",{style:p.indexBuilding,children:(0,He.jsxs)(Ve().X2,{gap:4,alignItems:"center",children:[(0,He.jsx)(Ze().Z,{style:{height:12,width:12}}),"Building..."]})})]})})),[h,m,g,p.buttonContainer,p.indexBuilding])}function nt(){const e=(0,T().YB)(),t=(0,d().yK)((e=>({container:{padding:"6px 8px",color:e.text.secondary,display:"flex",justifyContent:"space-between",borderTop:`1px solid ${e.lightDividerColor}`,marginTop:1},button:{fontSize:13,gap:4,paddingLeft:10,color:e.text.grayTertiary},icon:{width:12,height:12}})),[]);return(0,He.jsxs)("div",{style:t.container,children:[(0,M().x5)(Q().default)?(0,He.jsx)(st,{styles:t}):null,(0,He.jsx)(we().D,{icon:I().z,iconStyle:t.icon,isLightGray:!0,style:t.button,onClick:()=>window.open("https://notion.enterprise.slack.com/archives/C07CXLHAV7A","_blank"),children:e.formatMessage(ot.giveSearchFeedback)})]})}function it(e){const{menuListProps:t,title:s,subtitle:n,renderIcon:i}=e,{focused:r}=t,o=(0,d().yK)((e=>({container:{padding:"8px 0px",borderRadius:6},titleContainer:{display:"flex",alignItems:"center",gap:8},title:{fontWeight:P().Ue.medium},subtitle:{color:e.text.secondary,fontSize:12},divider:{color:e.text.secondary,fontSize:12},enterIcon:{width:12,height:12,color:e.text.secondary},searchIcon:{width:20,height:20}})),[]),c=(0,a.useMemo)((()=>{if(r)return(0,He.jsx)("div",{children:(0,f().U)(o.enterIcon)})}),[o.enterIcon,r]);return(0,He.jsx)(Te().Z,{...t,title:(0,He.jsxs)("div",{style:o.titleContainer,children:[(0,He.jsx)("span",{style:o.title,children:s}),(0,He.jsx)("span",{style:o.divider,children:"—"}),(0,He.jsx)("span",{style:o.subtitle,children:n})]}),icon:i(o.searchIcon),style:o.container,right:c})}function rt(e){const{styles:t}=e,s=(0,d().yK)((e=>({iconColor:{color:e.accentColors.red[400]}})),[]);return(0,x().Q)({...t,...s.iconColor})}const ot=(0,T().vU)({openInNewTabPlaceholder:{defaultMessage:"Open in new tab...",id:"MiniSearch.openInNewTab"},defaultInputPlaceHolder:{defaultMessage:"Search or ask anything",id:"MiniSearch.defaultInputPlaceHolder"},giveSearchFeedback:{defaultMessage:"Give search feedback",id:"MiniSearch.giveSearchFeedback"},fromCalendarEvents:{id:"miniSearch.fromCalendarEvents",defaultMessage:"From calendar events"},noQuickResultsFound:{id:"miniSearch.noQuickResultsFound",defaultMessage:"No quick results found"},searchMoreSources:{id:"miniSearch.searchMoreSources",defaultMessage:"Press {returnButton} to expand your search"},returnKey:{id:"miniSearch.returnKey",defaultMessage:"Return"},quickMatchesSectionTitle:{id:"miniSearch.quickMatches.sectionTitle",defaultMessage:"Quick matches"},researchModeTitle:{id:"miniSearch.researchMode.title",defaultMessage:"Deep research"},researchModeSubtitle:{id:"miniSearch.researchMode.subtitle",defaultMessage:"Start an analysis for complex questions"},deepFindTitle:{id:"miniSearch.deepFind.title",defaultMessage:"Search"},deepFindSubtitle:{id:"miniSearch.deepFind.subtitle",defaultMessage:"Get more results & AI summary"}});function at(){const e=(0,d().yK)((e=>({wrapper:{display:"grid",alignItems:"center",height:"100%",width:"100%",userSelect:"none",flex:1},container:{textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",gap:4},iconContainer:{display:"flex",gap:4,alignItems:"center",marginBottom:16},logoIcon:{width:32,height:32,padding:6},iconWrapper:{padding:2,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",marginLeft:-12,background:e.white,border:`1.5px solid ${e.lightDividerColor}`},heading:{fontSize:14,fontWeight:500,color:e.text.secondary,display:"flex",alignItems:"center",gap:8},subtext:{fontSize:14,color:e.text.secondary},returnIcon:{width:12,height:12},returnText:{display:"flex",alignItems:"center",gap:6,fontSize:12,border:`1px solid ${e.stroke.secondary}`,padding:"2px 4px",borderRadius:4,color:e.text.secondary,fontFamily:"monospace",fontWeight:400}})),[]),t=(0,He.jsxs)("span",{style:e.returnText,children:[(0,f().U)(e.returnIcon),(0,He.jsx)(T()._H,{...ot.returnKey})]});return(0,He.jsx)("div",{style:e.wrapper,children:(0,He.jsxs)("div",{style:e.container,children:[(0,He.jsx)("div",{style:e.heading,children:(0,He.jsx)(T()._H,{...ot.noQuickResultsFound})}),(0,He.jsx)("div",{style:e.heading,children:(0,He.jsx)(T()._H,{...ot.searchMoreSources,values:{returnButton:t}})})]})})}const ct=function(){return(0,l().VK)((()=>Se().KR.isQuickFindEnabled()),[])?(0,He.jsx)(Xe,{}):null}},994875:(e,t,s)=>{s.r(t),s.d(t,{default:()=>i});class n extends(()=>s(263184))().default{getInitialState(){return{discussionIdToExpansionStartPointMap:{}}}}const i=new n},811799:(e,t,s)=>{s.d(t,{G:()=>i});s(667294);var n=s(785893);const i=(0,s(827282).IU)("computerChip",{viewBox:"0 0 64 64",svg:(0,n.jsx)("path",{d:"m58,21.5v-3l-6-1.5v-1c0-2.47-1.53-4-4-4h-1l-1.5-6h-3l-1.5,6h-6l-1.5-6h-3l-1.5,6h-6l-1.5-6h-3l-1.5,6h-1c-2.47,0-4,1.53-4,4v1l-6,1.5v3l6,1.5v6l-6,1.5v3l6,1.5v6l-6,1.5v3l6,1.5v1c0,2.47,1.53,4,4,4h1l1.5,6h3l1.5-6h6l1.5,6h3l1.5-6h6l1.5,6h3l1.5-6h1c2.47,0,4-1.53,4-4v-1l6-1.5v-3l-6-1.5v-6l6-1.5v-3l-6-1.5v-6l6-1.5Zm-10,26.5H16V16h32v32Zm-4-28h-24v24h24v-24Zm-17,10c-1.66,0-3-1.34-3-3s1.34-3,3-3,3,1.34,3,3-1.34,3-3,3Z"})})},466222:(e,t,s)=>{s.d(t,{v:()=>i});s(667294);var n=s(785893);const i=(0,s(827282).IU)("databaseOutline",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M7.98145 15.3584C4.38574 15.3584 2 13.9775 2 12.0088V3.78516C2 1.9873 4.39258 0.763672 7.98145 0.763672C11.5771 0.763672 13.9697 1.9873 13.9697 3.78516V12.0088C13.9697 13.9775 11.584 15.3584 7.98145 15.3584ZM7.98145 5.58301C10.7773 5.58301 12.6709 4.83105 12.6709 3.78516C12.6709 2.69141 10.7842 1.91895 7.98145 1.91895C5.18555 1.91895 3.29883 2.69141 3.29883 3.78516C3.29883 4.83105 5.19238 5.58301 7.98145 5.58301ZM7.98145 6.80664C5.97852 6.80664 4.35156 6.42383 3.29883 5.77441V8.69336C4.42676 9.37695 6.19043 9.81445 7.98145 9.81445C9.7793 9.81445 11.543 9.37695 12.6709 8.69336V5.77441C11.6182 6.42383 9.99121 6.80664 7.98145 6.80664ZM7.98145 11.0449C6.23828 11.0449 4.5293 10.6621 3.29883 10.0332V12.0088C3.29883 13.2051 5.11035 14.1348 7.98145 14.1348C10.8594 14.1348 12.6709 13.2051 12.6709 12.0088V10.0332C11.4404 10.6621 9.73145 11.0449 7.98145 11.0449Z"})})},269309:(e,t,s)=>{s.d(t,{A:()=>i});s(667294);var n=s(785893);const i=(0,s(827282).IU)("verified",{viewBox:"0 0 20 20",svg:(0,n.jsx)("path",{d:"M18.125 10C18.125 8.73755 17.1875 7.69692 15.9719 7.52817C16.2875 7.10942 16.4781 6.59067 16.4781 6.02505C16.4781 4.6438 15.3594 3.52505 13.9781 3.52505C13.4125 3.52505 12.8938 3.71567 12.475 4.0313C12.3063 2.81567 11.2656 1.87817 10.0031 1.87817C8.74063 1.87817 7.70001 2.81567 7.53126 4.0313C7.11251 3.71567 6.59376 3.52505 6.02813 3.52505C4.64688 3.52505 3.52813 4.6438 3.52813 6.02505C3.52813 6.59067 3.71876 7.10942 4.03438 7.52817C2.81876 7.69692 1.88126 8.73755 1.88126 10C1.88126 11.2625 2.81876 12.3032 4.03438 12.4719C3.71876 12.8907 3.52813 13.4094 3.52813 13.975C3.52813 15.3563 4.64688 16.475 6.02813 16.475C6.59376 16.475 7.11251 16.2844 7.53126 15.9688C7.70001 17.1844 8.74063 18.1219 10.0031 18.1219C11.2656 18.1219 12.3063 17.1844 12.475 15.9688C12.8938 16.2844 13.4125 16.475 13.9781 16.475C15.3594 16.475 16.4781 15.3563 16.4781 13.975C16.4781 13.4094 16.2875 12.8907 15.9719 12.4719C17.1875 12.3032 18.125 11.2625 18.125 10ZM9.06251 13.8251L5.62501 10.3875L6.95001 9.06255L9.06251 11.175L13.3625 6.87505L14.6875 8.20005L9.06251 13.8251Z"})})}}]);