"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[67601],{960597:(e,t,o)=>{o.r(t),o.d(t,{TooltipWithSubtitle:()=>y,automationErrorMessages:()=>f,getErrorMessagesForActionValidationFailure:()=>g,getValidationErrorsForAction:()=>v,useErrorComponentForAction:()=>m,useRequiresSubscriptionUpgradeError:()=>T});o(267602),o(653476),o(667294);var i=()=>o(142735),r=()=>o(846550),n=()=>o(95886),a=()=>o(788860),s=()=>o(513670),l=()=>o(855741),u=()=>o(696459),c=()=>o(466970),d=()=>o(637118),p=o(785893);const f=(0,a().vU)({missingTargetDatabase:{id:"clientAutomationHelpers.errorMessages.missingTargetDatabase",defaultMessage:"Missing a target database"},missingNotificationCollectionPointer:{id:"clientAutomationHelpers.errorMessages.missingNotificationCollectionPointer",defaultMessage:"Missing database for property target"},missingNotificationTarget:{id:"clientAutomationHelpers.errorMessages.missingNotificationTarget",defaultMessage:"Missing notification recipients"},missingRecipients:{id:"clientAutomationHelpers.errorMessages.missingRecipients",defaultMessage:"Missing notification recipients"},missingEmailSubject:{id:"clientAutomationHelpers.errorMessages.missingEmailSubject",defaultMessage:"Missing email subject"},missingEmailBody:{id:"clientAutomationHelpers.errorMessages.missingEmailBody",defaultMessage:"Missing notification email body"},missingNotificationMessage:{id:"clientAutomationHelpers.errorMessages.missingNotificationMessage",defaultMessage:"Missing notification message"},missingNotificationPropertyId:{id:"clientAutomationHelpers.errorMessages.missingPropertyId",defaultMessage:"Missing target property"},missingNotificationFormulaValue:{id:"clientAutomationHelpers.errorMessages.missingFormulaValue",defaultMessage:"Missing recipients"},invalidNotificationFormulaValue:{id:"clientAutomationHelpers.errorMessages.invalidFormulaValue",defaultMessage:"Invalid recipients"},invalidNotificationPropertyId:{id:"clientAutomationHelpers.errorMessages.invalidPropertyId",defaultMessage:"Invalid property type"},deletedNotificationPropertyId:{id:"clientAutomationHelpers.errorMessages.deletedPropertyId",defaultMessage:"Property was deleted"},missingTargetPage:{id:"clientAutomationHelpers.errorMessages.missingTargetPage",defaultMessage:"Missing a target"},invalidTemplatePage:{id:"clientAutomationHelpers.errorMessages.invalidTemplatePage",defaultMessage:"Invalid template."},noActions:{id:"clientAutomationHelpers.errorMessages.noActions",defaultMessage:"This button has no actions"},createPageButtonError:{id:"clientAutomationHelpers.errorMessages.createPageButtonError",defaultMessage:"Add page is missing a target database"},collectionInTrashButtonError:{id:"clientAutomationHelpers.errorMessages.collectionInTrashButtonError",defaultMessage:"Target database is in trash"},collectionNotFoundButtonError:{id:"clientAutomationHelpers.errorMessages.collectionNotFoundButtonError",defaultMessage:"Target database not found"},blockInTrashButtonError:{id:"clientAutomationHelpers.errorMessages.blockInTrashButtonError",defaultMessage:"Target block is in trash"},createPageButtonTemplateError:{id:"clientAutomationHelpers.errorMessages.createPageWithTemplateError",defaultMessage:"Add page has an invalid template"},openPageOrUrlButtonError:{id:"clientAutomationHelpers.errorMessages.openPageFormOrUrlButtonError",defaultMessage:"Open page, form, or URL is missing a target"},updatePagesButtonError:{id:"clientAutomationHelpers.errorMessages.editPagesButtonError",defaultMessage:"Edit pages is missing a target database"},slackNotificationAuthenticationError:{id:"clientAutomationHelpers.errorMessages.slackNotificationError",defaultMessage:"Slack notification is missing an authentication."},slackNotificationTargetError:{id:"clientAutomationHelpers.errorMessages.slackNotificationTargetError",defaultMessage:"Slack notification is missing a target channel."},sendGmailNotificationMissingAuthenticationError:{id:"clientAutomationHelpers.errorMessages.sendGmailNotificationMissingAuthenticationError",defaultMessage:"Gmail notification is missing an authentication."},sendGmailNotificationInvalidAuthenticationError:{id:"clientAutomationHelpers.errorMessages.sendGmailNotificationInvalidAuthenticationError",defaultMessage:"Requires a re-authentication with Gmail"},missingRequiredRecordError:{id:"clientAutomationHelpers.errorMessages.missingRequiredRecordError",defaultMessage:"Action is missing access to a record"},invalidConfig:{id:"clientAutomationHelpers.errorMessages.invalidConfig",defaultMessage:"Unsupported settings"},invalidFormulaParseError:{id:"clientAutomationHelpers.errorMessages.invalidFormulaParseError",defaultMessage:"Formula contains a parsing error"},invalidFormulaTypeError:{id:"clientAutomationHelpers.errorMessages.invalidFormulaTypeError",defaultMessage:"Formula contains a type error"},invalidFormulaMissingReturnType:{id:"clientAutomationHelpers.errorMessages.invalidFormulaMissingReturnType",defaultMessage:"Formula does not have a return type"},invalidSendWebhookActionUrl:{id:"clientAutomationHelpers.errorMessages.invalidSendWebhookActionUrl",defaultMessage:"URL is invalid"},invalidSendWebhookActionCustomHeaderField:{id:"clientAutomationHelpers.errorMessages.invalidSendWebhookActionCustomHeaderField",defaultMessage:"Custom header field is invalid"},tooManyCustomHeaders:{id:"clientAutomationHelpers.errorMessages.tooManyCustomHeaders",defaultMessage:"Too many custom headers"},missingTargetVariable:{id:"clientAutomationHelpers.errorMessages.missingTargetVariable",defaultMessage:"Unable to find target variable"},crossSpaceRelation:{id:"clientAutomationHelpers.errorMessages.crossSpaceRelation",defaultMessage:"Cross-workspace features are restricted in automations and will not work"},crossSpacePropertyInFilter:{id:"clientAutomationHelpers.errorMessages.crossSpacePropertyInFilter",defaultMessage:"Filter contains a cross-workspace property"},invalidFormulaCrossSpace:{id:"clientAutomationHelpers.errorMessages.invalidFormulaCrossSpace",defaultMessage:"Cross-workspace features are restricted in automations and will not work"},requiresSubscription:{id:"clientAutomationHelpers.errorMessages.requiresSubscription",defaultMessage:"Upgrade plan or delete this step to enable the automation"},requiresSubscriptionButton:{id:"clientAutomationHelpers.errorMessages.requiresSubscriptionButton",defaultMessage:"Upgrade plan or delete connected steps to enable the button"},generalErrorMessage:{id:"clientAutomationHelpers.errorMessages.generalErrorMessage",defaultMessage:"Fix any errors or delete this step to enable this automation"},actionIncompleteErrorMessage:{id:"clientAutomationHelpers.errorMessages.actionIncompleteErrorMessage",defaultMessage:"Add a property to edit or delete this step to enable this automation"},destinationInTrashTooltip:{id:"clientAutomationHelpers.errorMessages.destinationInTrashTooltip",defaultMessage:"Restore destination or delete step to enable this automation"},destinationMissingTooltip:{id:"clientAutomationHelpers.errorMessages.destinationMissingTooltip",defaultMessage:"Add destination or delete step to enable this automation"},destinationNotFoundTooltip:{id:"clientAutomationHelpers.errorMessages.destinationNotFoundTooltip",defaultMessage:"Change destination or delete step to enable this automation"},notificationMissingCollectionPointer:{id:"clientAutomationHelpers.errorMessages.notificationMissingCollectionPointer",defaultMessage:"Change destination or delete step to enable this automation"},notificationMissingTarget:{id:"clientAutomationHelpers.errorMessages.notificationMissingTarget",defaultMessage:"Add a recipient or delete step to enable this automation"},notificationMissingRecipients:{id:"clientAutomationHelpers.errorMessages.notificationMissingRecipients",defaultMessage:"Add a recipient or delete step to enable this automation"},notificationMissingEmailSubject:{id:"clientAutomationHelpers.errorMessages.notificationMissingEmailSubject",defaultMessage:"Add an email subject or delete step to enable this automation"},notificationMissingEmailBody:{id:"clientAutomationHelpers.errorMessages.notificationMissingEmailBody",defaultMessage:"Add an email body or delete step to enable this automation"},notificationMissingMessage:{id:"clientAutomationHelpers.errorMessages.notificationMissingNotificationMessage",defaultMessage:"Add an email message or delete step to enable this automation"},notificationMissingPropertyId:{id:"clientAutomationHelpers.errorMessages.notificationMissingPropertyId",defaultMessage:"Change the target property or delete step to enable this automation"},notificationMissingFormulaValue:{id:"clientAutomationHelpers.errorMessages.notificationMissingFormulaValue",defaultMessage:"Add a recipient or delete step to enable this automation"},sendGmailMissingAccount:{id:"clientAutomationHelpers.errorMessages.sendGmailMissingAccount",defaultMessage:"Select an account to send from or delete step to enable this automation"},sendGmailMissingRecipients:{id:"clientAutomationHelpers.errorMessages.sendGmailMissingRecipients",defaultMessage:"Add recipients or delete step to enable this automation"},sendGmailMissingSubject:{id:"clientAutomationHelpers.errorMessages.sendGmailMissingSubject",defaultMessage:"Add email subject or delete step to enable this automation"},sendGmailMissingBody:{id:"clientAutomationHelpers.errorMessages.sendGmailMissingBody",defaultMessage:"Add email body or delete step to enable this automation"}});function g(e){const{failure:t,hasAutomationUpdatedErrorStatesEnabled:o}=e;if("create_page"===t.actionType){if("empty_config"===t.type)return{forAction:o?f.destinationMissingTooltip:f.missingTargetDatabase,forButtonTooltip:f.createPageButtonError};if("collection_not_found"===t.type)return{forAction:o?f.destinationNotFoundTooltip:f.collectionNotFoundButtonError,forButtonTooltip:f.collectionNotFoundButtonError};if("missing_required_config"===t.type){if("collection"===t.key)return{forAction:o?f.destinationMissingTooltip:f.missingTargetDatabase,forButtonTooltip:f.createPageButtonError};(0,u().t1)(t)}else{if("invalid_optional_config"===t.type)return{forAction:f.invalidTemplatePage,forButtonTooltip:f.createPageButtonTemplateError};if("collection_in_trash"===t.type)return{forAction:o?f.destinationInTrashTooltip:f.collectionInTrashButtonError,forButtonTooltip:f.collectionInTrashButtonError,forActionIcon:n().y};if("invalid_formula_parse_error"===t.type)return{forAction:f.invalidFormulaParseError,forButtonTooltip:f.invalidFormulaParseError,forButtonSubtitleTooltip:void 0};if("invalid_formula_type_error"===t.type)return{forAction:f.invalidFormulaTypeError,forButtonTooltip:f.invalidFormulaTypeError,forButtonSubtitleTooltip:void 0};if("invalid_formula_missing_return_type"===t.type)return{forAction:f.invalidFormulaMissingReturnType,forButtonTooltip:f.invalidFormulaMissingReturnType,forButtonSubtitleTooltip:void 0};if("cross_space_relation"===t.type)return{forAction:f.crossSpaceRelation,forButtonTooltip:f.crossSpaceRelation,forButtonSubtitleTooltip:void 0};if("invalid_formula_cross_space"===t.type)return{forAction:f.invalidFormulaCrossSpace,forButtonTooltip:f.invalidFormulaCrossSpace,forButtonSubtitleTooltip:void 0};(0,u().t1)(t)}}else if("update_pages"===t.actionType)if("missing_required_config"===t.type){if("target"===t.key)return{forAction:o?f.destinationMissingTooltip:f.missingTargetDatabase,forButtonTooltip:f.updatePagesButtonError};if("property"===t.key)return{forAction:f.actionIncompleteErrorMessage,forButtonTooltip:f.updatePagesButtonError};(0,u().t1)(t)}else{if("collection_in_trash"===t.type)return{forAction:o?f.destinationInTrashTooltip:f.collectionInTrashButtonError,forButtonTooltip:f.collectionInTrashButtonError,forActionIcon:n().y};if("block_in_trash"===t.type)return{forAction:f.blockInTrashButtonError,forButtonTooltip:f.blockInTrashButtonError};if("invalid_formula_parse_error"===t.type)return{forAction:f.invalidFormulaParseError,forButtonTooltip:f.invalidFormulaParseError,forButtonSubtitleTooltip:void 0};if("invalid_formula_type_error"===t.type)return{forAction:f.invalidFormulaTypeError,forButtonTooltip:f.invalidFormulaTypeError,forButtonSubtitleTooltip:void 0};if("invalid_formula_missing_return_type"===t.type)return{forAction:f.invalidFormulaMissingReturnType,forButtonTooltip:f.invalidFormulaMissingReturnType,forButtonSubtitleTooltip:void 0};if("missing_target_variable"===t.type)return{forAction:f.missingTargetVariable,forButtonTooltip:f.missingTargetVariable,forButtonSubtitleTooltip:void 0};if("cross_space_relation"===t.type)return{forAction:f.crossSpaceRelation,forButtonTooltip:f.crossSpaceRelation,forButtonSubtitleTooltip:void 0};if("invalid_formula_cross_space"===t.type)return{forAction:f.invalidFormulaCrossSpace,forButtonTooltip:f.invalidFormulaCrossSpace,forButtonSubtitleTooltip:void 0};if("cross_space_property_in_filter"===t.type)return{forAction:f.crossSpacePropertyInFilter,forButtonTooltip:f.crossSpacePropertyInFilter,forButtonSubtitleTooltip:void 0};(0,u().t1)(t)}else if("open_page"===t.actionType)if("missing_required_config"===t.type){if("target"===t.key)return{forAction:o?f.destinationNotFoundTooltip:f.missingTargetPage,forButtonTooltip:f.openPageOrUrlButtonError};(0,u().t1)(t)}else(0,u().t1)(t);else if("slack_notification"===t.actionType)if("missing_required_config"===t.type){if("external_bot_id"===t.key)return{forAction:f.slackNotificationAuthenticationError,forButtonTooltip:f.slackNotificationAuthenticationError};if("target"===t.key)return{forAction:f.slackNotificationTargetError,forButtonTooltip:f.slackNotificationTargetError};(0,u().t1)(t)}else if("missing_required_value"===t.type){if("external_bot_id"===t.key)return{forAction:f.slackNotificationAuthenticationError,forButtonTooltip:f.slackNotificationAuthenticationError};(0,u().t1)(t)}else(0,u().t1)(t);else if("send_in_app_notification"===t.actionType)if("missing_required_config"===t.type){if("target"===t.key)return{forAction:o?f.notificationMissingTarget:f.missingNotificationTarget,forButtonTooltip:f.missingNotificationTarget};if("notification_message"===t.key)return{forAction:o?f.notificationMissingMessage:f.missingNotificationMessage,forButtonTooltip:f.missingNotificationMessage};if("collectionPointer"===t.key)return{forAction:o?f.notificationMissingCollectionPointer:f.missingNotificationCollectionPointer,forButtonTooltip:f.missingNotificationCollectionPointer};if("propertyId"===t.key)return{forAction:o?f.notificationMissingPropertyId:f.missingNotificationPropertyId,forButtonTooltip:f.missingNotificationPropertyId};if("formulaValue"===t.key)return{forAction:o?f.notificationMissingFormulaValue:f.missingNotificationFormulaValue,forButtonTooltip:f.missingNotificationFormulaValue};(0,u().t1)(t)}else if("invalid_required_config"===t.type){if("propertyId"===t.key)return{forAction:f.invalidNotificationPropertyId,forButtonTooltip:f.invalidNotificationPropertyId};if("formulaValue"===t.key)return{forAction:f.invalidNotificationFormulaValue,forButtonTooltip:f.invalidNotificationFormulaValue};(0,u().t1)(t)}else if("deleted_required_config"===t.type){if("propertyId"===t.key)return{forAction:o?f.notificationMissingPropertyId:f.deletedNotificationPropertyId,forButtonTooltip:f.deletedNotificationPropertyId};(0,u().t1)(t)}else{if("invalid_formula_parse_error"===t.type)return{forAction:f.invalidFormulaParseError,forButtonTooltip:f.invalidFormulaParseError};if("invalid_formula_type_error"===t.type)return{forAction:f.invalidFormulaTypeError,forButtonTooltip:f.invalidFormulaTypeError};if("invalid_formula_missing_return_type"===t.type)return{forAction:f.invalidFormulaMissingReturnType,forButtonTooltip:f.invalidFormulaMissingReturnType};if("invalid_formula_cross_space"===t.type)return{forAction:f.invalidFormulaCrossSpace,forButtonTooltip:f.invalidFormulaCrossSpace,forButtonSubtitleTooltip:void 0};(0,u().t1)(t)}else if("send_gmail_notification"===t.actionType)if("missing_required_config"===t.type){if("to"===t.key)return{forAction:o?f.sendGmailMissingRecipients:f.missingRecipients,forButtonTooltip:f.missingRecipients};if("email_subject"===t.key)return{forAction:o?f.sendGmailMissingSubject:f.missingEmailSubject,forButtonTooltip:f.missingEmailSubject};if("email_body"===t.key)return{forAction:o?f.sendGmailMissingBody:f.missingEmailBody,forButtonTooltip:f.missingEmailBody};if("formulaValue"===t.key)return{forAction:f.missingNotificationFormulaValue,forButtonTooltip:f.missingNotificationFormulaValue};if("external_bot_id"===t.key)return{forAction:o?f.sendGmailMissingAccount:f.sendGmailNotificationMissingAuthenticationError,forButtonTooltip:f.sendGmailNotificationMissingAuthenticationError};(0,u().t1)(t)}else if("invalid_required_config"===t.type){if("to"===t.key)return{forAction:f.invalidNotificationFormulaValue,forButtonTooltip:f.invalidNotificationFormulaValue};if("cc"===t.key)return{forAction:f.invalidNotificationFormulaValue,forButtonTooltip:f.invalidNotificationFormulaValue};if("bcc"===t.key)return{forAction:f.invalidNotificationFormulaValue,forButtonTooltip:f.invalidNotificationFormulaValue};if("reply_to"===t.key)return{forAction:f.invalidNotificationFormulaValue,forButtonTooltip:f.invalidNotificationFormulaValue};if("external_bot_id"===t.key)return{forAction:f.sendGmailNotificationInvalidAuthenticationError,forButtonTooltip:f.sendGmailNotificationInvalidAuthenticationError};(0,u().t1)(t)}else{if("invalid_formula_parse_error"===t.type)return{forAction:f.invalidFormulaParseError,forButtonTooltip:f.invalidFormulaParseError};if("invalid_formula_type_error"===t.type)return{forAction:f.invalidFormulaTypeError,forButtonTooltip:f.invalidFormulaTypeError};if("invalid_formula_missing_return_type"===t.type)return{forAction:f.invalidFormulaMissingReturnType,forButtonTooltip:f.invalidFormulaMissingReturnType};if("invalid_formula_cross_space"===t.type)return{forAction:f.invalidFormulaCrossSpace,forButtonTooltip:f.invalidFormulaCrossSpace,forButtonSubtitleTooltip:void 0};if("requires_subscription_upgrade"===t.type)return{forAction:f.requiresSubscription,forButtonTooltip:f.requiresSubscriptionButton};(0,u().t1)(t)}else if("define_variables"===t.actionType){if("invalid_formula_parse_error"===t.type)return{forAction:f.invalidFormulaParseError,forButtonTooltip:f.invalidFormulaParseError,forButtonSubtitleTooltip:void 0};if("invalid_formula_type_error"===t.type)return{forAction:f.invalidFormulaTypeError,forButtonTooltip:f.invalidFormulaTypeError,forButtonSubtitleTooltip:void 0};if("invalid_formula_missing_return_type"===t.type)return{forAction:f.invalidFormulaMissingReturnType,forButtonTooltip:f.invalidFormulaMissingReturnType,forButtonSubtitleTooltip:void 0};if("invalid_formula_cross_space"===t.type)return{forAction:f.invalidFormulaCrossSpace,forButtonTooltip:f.invalidFormulaCrossSpace,forButtonSubtitleTooltip:void 0};(0,u().t1)(t)}else if("http_request"===t.actionType){if("invalid_url"===t.type)return{forAction:f.invalidSendWebhookActionUrl,forButtonTooltip:f.invalidSendWebhookActionUrl};if("empty_custom_header_field"===t.type)return{forAction:f.invalidSendWebhookActionCustomHeaderField,forButtonTooltip:f.invalidSendWebhookActionCustomHeaderField};if("requires_subscription_upgrade"===t.type)return{forAction:f.requiresSubscription,forButtonTooltip:f.requiresSubscriptionButton};if("too_many_custom_headers"===t.type)return{forAction:f.tooManyCustomHeaders,forButtonTooltip:f.tooManyCustomHeaders};(0,u().t1)(t)}else if("modal_confirmation"===t.actionType){if("invalid_formula_parse_error"===t.type)return{forAction:f.invalidFormulaParseError,forButtonTooltip:f.invalidFormulaParseError};if("invalid_formula_type_error"===t.type)return{forAction:f.invalidFormulaTypeError,forButtonTooltip:f.invalidFormulaTypeError};if("invalid_formula_missing_return_type"===t.type)return{forAction:f.invalidFormulaMissingReturnType,forButtonTooltip:f.invalidFormulaMissingReturnType};if("invalid_formula_cross_space"===t.type)return{forAction:f.invalidFormulaCrossSpace,forButtonTooltip:f.invalidFormulaCrossSpace,forButtonSubtitleTooltip:void 0};(0,u().t1)(t)}else if("publish_site"===t.actionType)if("missing_required_config"===t.type){if("target"===t.key)return{forAction:f.missingTargetDatabase,forButtonTooltip:f.updatePagesButtonError};(0,u().t1)(t)}else{if("missing_target_variable"===t.type)return{forAction:f.missingTargetVariable,forButtonTooltip:f.missingTargetVariable,forButtonSubtitleTooltip:void 0};if("invalid_context_value_type"===t.type)return{forAction:f.invalidFormulaTypeError,forButtonTooltip:f.invalidFormulaTypeError};(0,u().t1)(t)}else(0,u().t1)(t)}function m(e){const{actionId:t,shouldShow:o,errorKey:r,errorKeys:n}=e,{typecheckResult:l}=(0,d().DZ)(),u=(0,c().E)("automation_updated_error_states");return(0,i().VK)((()=>{if(!o||!l)return{errorMessage:void 0,errorIcon:void 0,errorMessageDescriptor:void 0};let e=v(l,t);(r||n)&&(e=e.filter((e=>"key"in e&&(e.key===r||(null==n?void 0:n.includes(e.key))))));const i=(0,s().Ps)(e);if(!i)return{errorMessage:void 0,errorIcon:void 0,errorMessageDescriptor:void 0};const c=g({failure:i,hasAutomationUpdatedErrorStatesEnabled:u});return{errorMessage:(0,p.jsx)(y,{content:(0,p.jsx)(a()._H,{...c.forAction})}),errorIcon:c.forActionIcon,errorMessageDescriptor:c.forAction}}),[o,l,t,r,n,u])}function y(e){const{content:t,subtitle:o}=e,i=(0,r().yK)((e=>({wrap:{display:"flex",flexDirection:"column",alignItems:"center"},subtitle:{color:e.mediumInvertedTextColor}})),[]);return(0,p.jsxs)("div",{style:i.wrap,children:[(0,p.jsx)("div",{children:t}),o&&(0,p.jsx)("div",{style:i.subtitle,children:o})]})}function v(e,t){return l().x.isFail(e)?[]:e.value.actionValidationFailures[t]??[]}function T(e){const{shouldShow:t,actionId:o}=e,{typecheckResult:r}=(0,d().DZ)(),n=(0,c().E)("automation_updated_error_states");return(0,i().VK)((()=>{if(!t||!r)return;const e=v(r,o).filter((e=>"requires_subscription_upgrade"===e.type)),i=(0,s().Ps)(e);if(!i)return;const l=g({failure:i,hasAutomationUpdatedErrorStatesEnabled:n});return(0,p.jsx)(a()._H,{...l.forAction})}),[t,r,o,n])}},867601:(e,t,o)=>{o.d(t,{Cf:()=>q,EF:()=>C,JO:()=>h,Li:()=>F,cB:()=>H,i1:()=>E,pw:()=>V,qM:()=>I,qk:()=>b,rU:()=>N,sA:()=>R,sM:()=>k,vM:()=>P,wB:()=>B});o(821057),o(267602),o(916054),o(653476),o(241792),o(228244);var i=o.n(o(443261)),r=()=>o(912203),n=()=>o(473304),a=()=>o(455947),s=()=>o(226413),l=()=>o(871379),u=()=>o(177634),c=()=>o(956057),d=()=>o(528514),p=()=>o(752778),f=()=>o(955620),g=()=>o(513670),m=()=>o(855741),y=()=>o(696459),v=()=>o(960597),T=()=>o(749826),_=()=>o(826955),M=()=>o(815277),A=()=>o(561933),S=()=>o(122479);function b(e){const{automationStore:t,collectionStore:o,typecheckResult:i}=e,n=o.getSchema(),a=t.getKeyStore("properties").getKeyStore("name").getValue();if(null==a||!a.trim())return!1;if(!(0,r().Of)({automationTrigger:t.getTrigger(),collectionSchema:n}))return!1;const s=t.getActionStores().filter((e=>e.isDefined()));return 0!==s.length&&s.every((e=>h({actionStore:e,collectionStore:o,typecheckResult:i})))}function h(e){const{actionStore:t,collectionStore:o,typecheckResult:i}=e;if((0,v().getValidationErrorsForAction)(i,t.id).length>0)return!1;if(t.isType("slack_notification"))return(0,y().$K)(t.getConfigStore().getKeyStore("external_bot_id").getValue())&&(0,y().$K)(t.getConfigStore().getKeyStore("target").getValue());if(t.isType("send_gmail_notification")){const e=t.getConfigStore(),o=e.getKeyStore("to").getValue(),i=e.getKeyStore("email_subject").getValue(),r=e.getKeyStore("email_body").getValue();return!(!i||!r||(0,f().PgY)(i.value)||(0,f().PgY)(r.value))&&!(!(o&&o.value&&o.value.value)||g().xb(o.value.value))}if(t.isType("update_pages")){const e=t.getConfigStore().getKeyStore("target").getValue(),n=t.getConfigStore().getKeyStore("properties").getValue()??[];if(!(0,y().$K)(e)||0===n.length)return!1;if("collection"===e.type){const t=_().NW.createChildStore(o,e.collection).getSchema();if(n.some((e=>(0,r().LF)({property:e,collectionSchema:t})||(0,r().Jy)({collectionSchema:t,property:e,type:"action"}))))return!1}else if("variable"===e.type){const a=(0,u().MY)(e.id);if("global"===a.source&&"button_page"===a.global){const e=o.getSchema();if(n.some((t=>(0,r().LF)({property:t,collectionSchema:e})||(0,r().Jy)({collectionSchema:e,property:t,type:"action"}))))return!1}else{if(m().x.isFail(i))return!1;const o=(0,u().vx)(i.value.valueTypes,e.id),a=o?B(o,t):void 0;if(!a)return!1;const s=a.getSchema();if(n.some((e=>(0,r().LF)({property:e,collectionSchema:s})||(0,r().Jy)({collectionSchema:s,property:e,type:"action"}))))return!1}}else{if("page"===e.type)return!1;(0,y().t1)(e)}return!0}if(t.isType("create_page")){const e=t.getConfigStore().getKeyStore("collection").getValue();if(!(0,y().$K)(e))return!1;const i=_().NW.createChildStore(o,e).getSchema();return!(t.getConfigStore().getKeyStore("properties").getValue()??[]).some((e=>(0,r().LF)({property:e,collectionSchema:i})||(0,r().Jy)({collectionSchema:i,property:e,type:"action"})))}if(t.isType("send_in_app_notification")){const e=t.getConfigStore(),o=e.getKeyStore("target").getValue(),i=e.getKeyStore("notification_message").getValue();if(!o||!i||(0,f().PgY)(i.value))return!1;switch(o.type){case"property":if(!o.propertyId||!o.collectionPointer)return!1;break;case"formula":if(!o.value||!o.value.value||g().xb(o.value.value))return!1}return!0}if(t.isType("define_variables"))return!0;if(t.isType("http_request"))return!0;if(t.isType("publish_site")){const e=t.getConfigStore().getKeyStore("target").getValue();return!!(0,y().$K)(e)}throw new Error(`isActionStoreComplete not implemented for ${t.getType()}`)}function B(e,t){let o;return"block"===e.type.type&&e.type.collection?o=_().NW.createChildStore(t,e.type.collection):"array"===e.type.type&&"block"===e.type.of.type&&e.type.of.collection&&(o=_().NW.createChildStore(t,e.type.of.collection)),o}function F(e){const{collectionStore:t}=e;if(!t||(0,S().EY)(t)||(0,S().Aw)(t))return!1;const o=(0,M().DE)(t.environment,{name:"premium_automations",spaceId:t.getSpaceId(),userId:t.userId});if((t.getFormat().automation_ids??[]).length>=n().ss&&!o)return!1;const i=t.pointer,r=t.getSpaceId();return(0,l().IC)({targetTriggerType:"event",targetParentPointer:i,targetSpaceId:r}).every((e=>{let{pointer:o,minimumRequiredRole:i}=e;const r=t.getRecordRole(o);return!!r&&(0,d().yY)(r,i)}))}function E(e){const{automationStore:t,actionStores:o,collectionStore:i}=e,r=t.getParentStore();if(!r||(0,S().EY)(r)||(0,S().Aw)(i))return!1;const n=t.getMinimumFieldsForPermissions();if(!n)return!1;if(!o.every((e=>e.isDefined())))return!1;const a=o.some((e=>!e.isType("slack_notification")));if(!(0,M().DE)(i.environment,{name:"premium_automations",spaceId:i.getSpaceId(),userId:i.userId})&&a)return!1;return(0,l().fz)({automationValue:n,actionValues:o.map((e=>({config:e.getConfig(),type:e.getType()})))}).every((e=>{let{pointer:o,minimumRequiredRole:i}=e;const r=t.getRecordRole(o);return!!r&&(0,d().yY)(r,i)}))}function I(e){const{automationStore:t,collectionStore:o}=e,i=t.getParentStore();if(!i||(0,S().EY)(i)||(0,S().Aw)(o))return!1;const r=t.getMinimumFieldsForPermissions();if(!r)return!1;return(0,l().bM)(r).every((e=>{let{pointer:o,minimumRequiredRole:i}=e;const r=t.getRecordRole(o);return!!r&&(0,d().yY)(r,i)}))}function P(e){const{automationStore:t,collectionStore:o}=e;if(!t.isTriggerType("event")&&!t.isTriggerType("notification_event"))return!1;const i=t.getEventConfiguration();if(!i||void 0===i.source||i.source.type===p().vF||"filter"===i.source.type)return!1;const r=_().Xr.createChildStore(o,i.source.pointer);return function(e){const t=N(e),o=k(e);return(0,y().$K)(t)||(0,y().$K)(o)}({collectionSchema:o.getSchema(),collectionViewStore:r})}function k(e){var t;if(!T().default.checkGate({gateName:"collections_xws"}))return;const{collectionViewStore:o,collectionSchema:i}=e,r=o.getPropertyFiltersStore().getValue()??[],n=null===(t=o.getQuery(i))||void 0===t?void 0:t.filter,l={operator:"and",filters:(0,a().OH)({propertyFilters:r,combinatorFilter:n,schema:i})},u=(0,a().SH)(l,(e=>{if((0,a().aN)(e)){const t=i[e.property];return!!t&&(0,s().W2)(o.getSpaceId(),t,i)}return!1}));return u&&(0,a().aN)(u)?u.property:void 0}function N(e){var t;const{collectionViewStore:o,collectionSchema:i}=e,n=o.getPropertyFiltersStore().getValue()??[],s=null===(t=o.getQuery(i))||void 0===t?void 0:t.filter,l={operator:"and",filters:(0,a().OH)({propertyFilters:n,combinatorFilter:s,schema:i})},u=(0,a().SH)(l,(e=>{if((0,a().aN)(e)){const t=i[e.property];return!!t&&!(0,r().TX)(t)}return!1}));if(u)return(0,a().aN)(u)?u.property:(0,a().Mm)(u)?u.timestamp:void 0}function H(e){if("collectionTypedView"===e.contextType)return!1;const t=e.collectionStore();return!!t&&(!(t.isSyncedCollection()&&!T().default.checkGate({gateName:"support_synced_database_automations"}))&&void 0===e.viewsModuleContextStore.state)}function C(e){const{collectionSchema:t,propertyIds:o,searchTerm:r}=e;if(!r)return o.slice(0);const n=new Map,a=o.map((e=>{const o=t[e],i=o?`${o.name} ${A().SO[o.type]}`:"";return n.set(e,i),i})),s=i().filter(r,a).map((e=>{let{original:t}=e;return t}));return o.filter((e=>s.includes(n.get(e)??"")))}function V(e){return{pagesAdded:!1,pagePropertiesEdited:{type:"none"},source:{pointer:e.getSpaceShardedPointer(),type:p().vF}}}function R(e){const{automationId:t,automationName:o,collectionStore:i,userId:r}=e;return function(e){const{actionIds:t,automationId:o,collectionStore:i,eventConfiguration:r,lastEditedTime:n,properties:a,userId:s}=e,l=Date.now();return{action_ids:t,alive:!0,created_by_id:s,created_by_table:"notion_user",created_time:l,id:o,last_edited_by_id:s,last_edited_by_table:"notion_user",last_edited_time:n??l,parent_id:i.id,parent_table:p().vF,properties:a??{},space_id:i.getSpaceId(),status:"active",trigger:{event:r,id:c().Il(),type:"event"},version:1}}({actionIds:[],automationId:t,collectionStore:i,eventConfiguration:V(i),properties:{name:o},userId:r})}function q(e){const{tab:t}=e;return!!t&&("automationSettings"===t.type||"mobileCreateAutomation"===t.type||"mobileEditAutomation"===t.type||"mobileEditButtonAutomation"===t.type)}}}]);