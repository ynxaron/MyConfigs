"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[59822,95986],{86609:(e,t,n)=>{n.d(t,{KV:()=>K,Rh:()=>Q,U6:()=>X,Wu:()=>te,Xx:()=>W,YD:()=>ee,g9:()=>Y,jc:()=>q,m8:()=>$,ys:()=>G,zX:()=>z});n(122556),n(582845),n(250570),n(533019),n(721473),n(788208),n(22624),n(267602),n(30005),n(241792),n(228244);var o=()=>n(730120),r=()=>n(506347),i=()=>n(926724),a=()=>n(271896),s=()=>n(226413),c=()=>n(803021),l=()=>n(874459),d=()=>n(956057),u=()=>n(528514),p=()=>n(494616),m=()=>n(922713),g=()=>n(396136),f=()=>n(752778),S=()=>n(255933),v=()=>n(306164),y=()=>n(856466),w=()=>n(126301),C=()=>n(955620),_=()=>n(253335),h=()=>n(110232),k=()=>n(285755),x=()=>n(23151),b=()=>n(757216),T=()=>n(544903),V=()=>n(594546),M=()=>n(487270),R=()=>n(527278),A=()=>n(876822),E=()=>n(826955),I=()=>n(250303),D=()=>n(824462),F=()=>n(984871),B=()=>n(139224),j=()=>n(421654),Z=()=>n(636340),U=()=>n(511614),O=()=>n(269299),H=()=>n(663366),L=()=>n(348141);const N="week";function W(e){var t;const{environment:n,transaction:o,tasksBlockStore:r,sprintsBlockStore:i}=e,a=null===(t=i.getFormat())||void 0===t?void 0:t.collection_pointer,s=r.getFormat().collection_pointer;if(!a||!s)return;const c=E().NW.createChildStore(i,a),l=c.getRole()??"none";if(!(0,u().yY)(l,"editor"))return;c.getAutomationStores().some((e=>e.isCompleteSprintAutomation()))||P({environment:n,transaction:o,sprintCollectionStore:c,taskCollectionStore:E().NW.createChildStore(r,s),sprintSettingsConfig:y().iZ})}function P(e){const{environment:t,sprintSettingsConfig:n,transaction:o,sprintCollectionStore:r,taskCollectionStore:i}=e,a=r.getSpaceId(),s=(0,M().TS)({environment:t,table:p().cv,spaceId:a}),c=(0,M().TS)({environment:t,table:m().Xj,spaceId:a});Z().ae({environment:t,table:p().cv,inMemoryRecordCache:r.inMemoryRecordCache,value:{id:s,parent_id:r.id,parent_table:r.table,alive:!0,space_id:a,status:n.autoCompleteSprints?"active":"disabled",trigger:{id:d().Il(),type:"recurrence",recurrence:oe(n)},action_ids:[c]},transaction:o}),j().FH({stores:[r],update:{automation_ids:[...r.getFormat().automation_ids??[],s]},transaction:o}),Z().ae({environment:t,table:m().Xj,inMemoryRecordCache:r.inMemoryRecordCache,transaction:o,value:{id:c,parent_id:s,parent_table:p().cv,type:"complete_sprint",alive:!0,space_id:a,config:{sprint_collection:r.getSpaceShardedPointer(),task_collection:i.getSpaceShardedPointer(),complete_sprint_action:n.actionConfig.complete_sprint_action}}})}function K(e){const{environment:t,automationStore:n,transaction:o,newDuration:r,currentSprintBlockStore:i}=e;Z().sW({store:n.getTriggerStore().getKeyStore("recurrence"),data:{interval:r},transaction:o}),J({environment:t,transaction:o,automationStore:n,currentSprintBlockStore:i})}function Y(e){const{environment:t,automationStore:n,transaction:o,newWeekday:r,currentSprintBlockStore:i}=e;Z().sW({store:n.getTriggerStore().getKeyStore("recurrence"),data:{weekdays:[r]},transaction:o}),J({environment:t,transaction:o,automationStore:n,currentSprintBlockStore:i})}function q(e){const{environment:t,actionStore:n,automationStore:o,transaction:r,newAutocompleteStatus:i,currentSprintBlockStore:s}=e;Z().sW({store:o,data:{status:i?"active":"disabled"},transaction:r}),J({environment:t,transaction:r,automationStore:o,currentSprintBlockStore:s});const c=o.getParentPointer();if(!c||c.table!==f().vF)return;const l=(0,V().mc)(t),d={automation_id:o.id,automation_actions:[{automation_action_id:n.id,type:"complete_sprint"}],automation_triggers:[{type:"recurrence"}],collection_id:c.id};i?(0,a().Rt)(l,d):(0,a().ai)(l,d)}function J(e){const{automationStore:t,currentSprintBlockStore:n,transaction:r,environment:a}=e;if(!t.isActive())return;const s=t.getRecurrence();if(!s)return;const l=(0,w().Su)(s);if(!l)return;const d=n.getPropertyValue(i().b0.Dates);if(!d)return;const u=(0,C().nai)(d)[0];if(!u||"daterange"!==u.type)return;const p=u.start_date,{start_date:m,end_date:g}=(0,w().DW)({currentSprintStartDate:p,sprintSchedule:l});Z().sW({store:t.getTriggerStore().getKeyStore("recurrence"),data:{start_date:(0,c().Jh)(o().ou.fromISO(m).plus({minutes:1}).toJSDate())},transaction:r}),x().xD({store:n,propertyId:i().b0.Dates,transaction:r,environment:a,type:"dateValue",dateValue:{type:"daterange",start_date:p,end_date:g}})}function X(e){const{transaction:t,newRemainingTasksBehavior:n,actionStore:o}=e;Z().sW({store:o.getConfigStore(),data:{complete_sprint_action:n},transaction:t})}async function G(e){var t;const{appTemplatesSetupActions:n,appTemplatesSprintBoardActions:o,appConfigs:a}=await T().vF.load(),{environment:s,collectionContextStore:c,from:l}=e,{currentSpaceViewStore:d}=A().default.state,u=c.collectionStore(),p=null==u?void 0:u.getParentBlockStore(),m=null==p?void 0:p.getParentStore(),f=null==u||null===(t=u.getFormat())||void 0===t?void 0:t.app_config_uri,y=f&&(0,h().YB)(a(),f);if(!u||!p||!m||!d||m.table!==S().bx&&m.table!==g().iU&&m.table!==v().e0||!y)return;const w=p.getFormat().app_id,C=w?await D().callApi({eventName:"getCollectionViewBlocksByAppId",environment:s,data:{spaceId:p.getSpaceId(),appId:w}}):void 0,k="success"===(null==C?void 0:C.type)&&C.data.result.length?C.data.result.map((e=>E().G.createChildStore(m,{table:g().iU,id:e.blockId,spaceId:p.getSpaceId()}))):[p];await ne({environment:s,taskCollectionStore:u,executeFn:()=>{const e=O().createAndCommit({userAction:"sprintSettingsActions.handleTurnOnSprints",environment:s,canUndo:!0,perform:e=>{const t=(0,_().eu)(),r=n.applyTypedFeatures({environment:s,spaceViewStore:d,appParentStore:m,appUri:y.uri,features:[{type:"simple",featureUri:t.uri}],transaction:e,createOrModify:"modify",appCollectionViewBlockStores:k}),a=o.createSprintPage({environment:s,spaceViewStore:d,appParentStore:m,transaction:e,blockStores:r,creationEntryPoint:{type:"sprint_settings"}});if(B().E3({collectionSettingsStore:c.settingsStore}),!a)return;const u=l?{feature:{id:i().Es.TaskToSprintRelation,from:l,type:"notion://projects/tasks_with_sprints_feature"}}:{};return I()._H({environment:s,collectionContextStore:c,from:"view_settings",property:i().Es.TaskToSprintRelation,property_type:"relation",is_suggested_property:!0,...u}),a}});e.serverCommitResult.then((()=>{const t=e.performResult;t&&U().r({environment:s,store:t,pageVisitSource:r().tY.Create})}))}})}async function $(e){const{environment:t,collectionContextStore:n,sprintSettingsContext:o,sprintBoardViewBlockIds:a}=e,{sprintCollectionStore:s,automationContext:c,currentCollectionViewBlockStore:l,sprintCollectionViewBlockStore:d,taskCollectionStore:u,taskCollectionViewBlockStore:p}=o;if(!s||!d||!c)return;const m=p.getSpaceId(),f=[d,...a.map((e=>new(E().G)(t,{id:e,table:g().iU,spaceId:m})))];l.id===p.id?B().E3({collectionSettingsStore:n.settingsStore}):U().r({environment:t,store:p,pageVisitSource:r().tY.LeaveOrRemove});const{automationActions:S}=await k().Sm.automations.load(),{automationStore:v}=c;await ne({environment:t,taskCollectionStore:u,executeFn:()=>{O().createAndCommit({userAction:"sprintSettingsActions.handleTurnOffSprints",environment:t,canUndo:!0,perform:e=>{!function(e){const{transaction:t,blocksToDelete:n,environment:o,taskCollectionStore:r,sprintCollectionStore:a}=e;Z().sW({store:a,transaction:t,data:{alive:!1}}),F().E2({environment:o,collectionStore:r,schema:r.getSchema(),property:i().Es.TaskToSprintRelation,transaction:t,permanentlyDelete:!0}),H().y8({environment:o,blocks:n,transaction:t,permanentlyDelete:!0})}({environment:t,transaction:e,blocksToDelete:f,sprintCollectionStore:s,taskCollectionStore:u}),S.disableAutomation({automationStore:v,environment:t,transaction:e}),S.deleteAutomation({automationStore:v,environment:t,transaction:e})}}),I().y9({environment:t,collectionContextStore:n,property_type:"relation",from:"view_settings",property:i().Es.TaskToSprintRelation})}})}function z(e){const{environment:t,userSettingsStore:n}=e;O().createAndCommit({userAction:"sprintSettingsActions.handleSeenSprintsEngagementBanner",environment:t,canUndo:!0,perform:e=>{L().d2({userSettingsStore:n,data:{seen_sprint_settings_engagement_banner:!0},transaction:e})}})}function Q(e){e.settingsStore.setState({open:!0,stack:[{type:"main"},{type:"sprintSettings"}]})}function ee(e){const{environment:t,collectionContextStore:n,currentViewBlockStore:o,taskCollectionViewBlockStore:r}=e,a=n.collectionViewStore();if(!a)return;const s=a.getFormat(),c=a.getRawQuery();O().createAndCommit({userAction:"sprintSettingsActions.handleManageSprintFromThisView",environment:t,canUndo:!0,perform:e=>{if((0,b().i)({collectionViewStore:a,transaction:e,update:{name:R().Z.formatMessage(_().sY.tasksCurrentSprintV2ViewName),query2:{...c,filter:void 0},format:{...s,collection_view_icon:"/icons/playback-play-button_gray.svg",property_filters:_().Jt,app_config_uri:i().g3,hide_linked_collection_name:!0}}}),o.id===r.id){var t;const n=(null===(t=o.getFormat())||void 0===t?void 0:t.app_uri_map)??{},c=s.app_config_uri;c&&delete n[c],j().FH({stores:[r],update:{app_uri_map:{...n,[i().g3]:a.id}},transaction:e})}}})}function te(e){const{environment:t,sprintSettingsContext:n}=e;if(!n)return;const o=n.sprintCollectionStore,r=(null==o?void 0:o.getRole())??"none";o&&(0,u().yY)(r,"editor")&&n.automationContextLoaded&&!n.automationContext&&O().createAndCommit({userAction:"sprintSettingsActions.ensureCompleteSprintAutomation",environment:t,canUndo:!0,perform:e=>{P({environment:t,transaction:e,sprintCollectionStore:o,taskCollectionStore:n.taskCollectionStore,sprintSettingsConfig:y().iZ})}})}async function ne(e){const{executeFn:t,environment:n,taskCollectionStore:o}=e;await async function(e){var t;const{environment:n,taskCollectionStore:o}=e,r=o.getFormat().app_uri_map,a=i().Es.TaskToSprintRelation,c=o.getSchema(),l=(null==r?void 0:r[a])??a,d=c[l];if(!d||!(0,s().p_)(d))return;const u=null===(t=(0,s().j0)(d))||void 0===t?void 0:t.id;if(!u)return;const p=new Set([l]);Object.entries(c).forEach((e=>{var t;let[n,o]=e;o&&(0,s().p_)(o)&&(null===(t=(0,s().j0)(o))||void 0===t?void 0:t.id)===u&&p.add(n)}));const{serverCommitResult:m}=O().createAndCommit({userAction:"sprintSettingsActions.clearSprintRelationDataFromTaskCollection",environment:n,canUndo:!0,perform:e=>{for(const t of p)F().E2({environment:n,transaction:e,permanentlyDelete:!0,collectionStore:o,schema:c,property:t});null==r||delete r[a],r&&j().FH({stores:[o],transaction:e,update:{app_uri_map:r}})}});await m}({environment:n,taskCollectionStore:o}),t()}function oe(e){return{frequency:N,interval:e.recurrenceConfig.interval,weekdays:e.recurrenceConfig.weekdays,start_date:(0,c().Jh)(o().ou.local().set({hour:0,minute:0,second:0,millisecond:0}).toJSDate()),timezone:(0,l().Sv)(),hour:0,minute:0}}},5317:(e,t,n)=>{n.d(t,{Z:()=>m});n(667294);var o=()=>n(219727),r=()=>n(846550),i=()=>n(64272),a=()=>n(788860),s=()=>n(250303),c=()=>n(269299),l=()=>n(827973),d=()=>n(677559),u=()=>n(688725),p=n(785893);function m(e){const{collectionContextStore:t,onClose:n,focused:m,isCompact:g}=e,f=(0,o().O7)(),{value:S}=(0,d().XJ)(u().formsEditorDependency),v=(0,r().yK)((e=>({newFormButton:{color:e.mediumTextColor,display:"flex",flexDirection:"row"}})),[]);function y(){c().createAndCommit({userAction:"CollectionViewTabBar.createGenericViewType",environment:f,canUndo:!0,perform:e=>{S&&S.formEditorActions.createAndFocusCollectionFormEditorView({environment:f,collectionContextStore:t,transaction:e})}}),n(),s().xb({environment:f,collectionContextStore:t,view_type:"form_editor"})}if(!S)return null;const w=(0,p.jsx)(l().Z,{focused:m,onClick:y,title:(0,p.jsx)("div",{style:v.newFormButton,children:(0,p.jsx)(a()._H,{defaultMessage:"New form",id:"database.collectionViewSelect.newFormButtonTitle"})}),style:{padding:"1 0"},icon:(0,i().E)({width:14,fill:v.newFormButton.color,marginRight:2})}),C=(0,p.jsx)(l().Z,{focused:m,onClick:y,title:(0,p.jsx)("div",{style:{display:"flex",flexDirection:"row"},children:(0,p.jsx)(a()._H,{defaultMessage:"Form",id:"CollectionViewTabBar.newFormItem.title"})}),icon:(0,i().E)({width:16}),shouldWrapCaption:!0,caption:(0,p.jsx)(a()._H,{defaultMessage:"Create a form to input data directly into this database",id:"CollectionViewTabBar.newFormItem.description"})});return g?w:C}},446955:(e,t,n)=>{n.d(t,{Z:()=>r});n(667294);var o=n(785893);const r=function(e){const{icon:t,iconStyle:r,title:i,caption:a,right:s,rightStyle:c,isRed:l,isGray:d,isOrange:u,isPadded:p,onClick:m,onMouseDown:g,onMouseEnter:f,onMouseLeave:S,disabled:v,showChevron:y,chevronStyle:w,rotateChevron:C,showDragHandle:_,focused:h,textWrapperStyle:k,shouldWrapCaption:x,desktopIconStyle:b,buttonStyle:T}=e,V=(0,n(219727).O7)(),{isMobile:M}=V.device,R=(0,n(846550).yK)((e=>({style:{color:d?e.mediumTextColor:u?"dark"===e.mode?e.accentColors.orange[500]:e.accentColors.orange[400]:e.regularTextColor,fill:d?e.mediumIconColor:u?"dark"===e.mode?e.accentColors.orange[500]:e.accentColors.orange[400]:e.regularIconColor,opacity:v?.4:void 0,...T},leftIconStyle:{width:24,height:p?24:M?18:16,marginRight:-2,...t===n(641772).o&&{height:3},...r},rightStyle:{display:"flex",alignItems:"center",color:v?e.regularTextColor:e.lightTextColor,fill:v?e.regularIconColor:e.lightIconColor,flexShrink:0,...c},rightIconStyle:{width:12,fill:e.lightIconColor,marginLeft:6,transition:"transform 200ms ease-in-out",...w},rightIconRotatedStyle:{transform:"rotate(90deg)"}})),[d,u,v,r,p,M,t,w,c,T]),[A]=(0,n(288141).o$)();return(0,o.jsx)(n(827973).Z,{ref:A,icon:null==t?void 0:t(R.leftIconStyle),focused:h||!1,disabled:v,title:i,caption:a,shouldWrapCaption:x,desktopTitleStyle:{flexGrow:1,flexShrink:1},showDragHandle:_,buttonStyle:R.style,rightStyle:R.rightStyle,isRedOnHover:l,ignoreLocalHoverState:!!v||void 0,right:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{style:{...n(707513).Yu,display:"flex"},children:s}),!v&&y&&(0,n(429600).o)({...R.rightIconStyle,...C&&R.rightIconRotatedStyle})]}),onClick:m,onMouseDown:g,onMouseEnter:f,onMouseLeave:S,textWrapperStyle:k,desktopIconStyle:b})}},368199:(e,t,n)=>{n.r(t),n.d(t,{CollectionNewViewsPopupComponent:()=>L});n(267602),n(653476),n(241792);var o=n(667294),r=()=>n(219727),i=()=>n(142735),a=()=>n(846550),s=()=>n(353329),c=()=>n(159253),l=()=>n(159732),d=()=>n(788860),u=()=>n(250303),p=()=>n(269299),m=()=>n(763707),g=()=>n(2971),f=()=>n(110232),S=()=>n(5317),v=()=>n(827973),y=()=>n(573357),w=()=>n(198829),C=()=>n(255577),_=()=>n(470386),h=()=>n(388284),k=()=>n(654133),x=()=>n(527278),b=()=>n(352230),T=()=>n(998901),V=()=>n(876822),M=()=>n(535645),R=()=>n(499819),A=()=>n(281236),E=()=>n(925880),I=()=>n(182722),D=()=>n(697132),F=()=>n(427886),B=()=>n(887430),j=()=>n(716025),Z=n(785893);const U=3;function O(e){let{numberOfSuggestedViews:t,isShowingMoreSuggestions:n}=e;return t>=5&&!n}function H(e){let{suggestedWorkflowTemplateViews:t,isShowingMoreSuggestions:n}=e;const o=t.map((e=>e.templateId));return O({numberOfSuggestedViews:o.length,isShowingMoreSuggestions:n})?o.slice(0,U):o}function L(e){let{collectionContextStore:t,onClose:n,showNewViewItems:L}=e;const N=(0,r().O7)(),W=N.device,[P,K]=(0,o.useState)(!1),Y=(0,a().yK)((e=>({showMoreLabel:{color:e.mediumTextColor}})),[]),q=(0,i().VK)((()=>{const e=t.collectionStore(),n=t.collectionViewBlockStore();if(!e||!n)return[];const o=e.getFormat().app_config_uri,r=o?(0,f().YB)((0,g().appConfigs)(),o):void 0;return r?(0,f().$L)({environment:N,appConfig:r,collectionStore:e,collectionViewBlockStore:n}):[]}),[t,N]),J=(0,i().VK)((()=>(0,B().kn)(t,W)),[t,W]),X=(0,E().c)(t).filter((e=>(0,s().U2)(e,"collection_view"))),G=(0,o.useCallback)((e=>({key:e,render:t=>(0,Z.jsx)(v().Z,{title:x().Z.formatMessage(B().b1[e]),icon:(0,Z.jsx)(j().F,{color:"regular",viewType:e}),...t}),action:()=>{p().createAndCommit({userAction:"CollectionViewTabBar.createGenericViewType",environment:N,canUndo:!0,perform:n=>{(0,D().M)({environment:N,collectionContextStore:t,newViewType:e,transaction:n,skipOpenSettings:!1})}}),u().xb({environment:N,collectionContextStore:t,view_type:e})}})),[N,t]),{renderSuggestedTypedView:$}=function(e,t){const n=(0,r().O7)(),a=(0,i().VK)((()=>V().default.state.currentSpaceViewStore),[]),s=(0,i().VK)((()=>e.collectionViewBlockStore()),[e]),c=(0,i().VK)((()=>e.collectionStore()),[e]),l=(0,i().VK)((()=>{var e;if(!c)return;const t=null===(e=c.getFormat())||void 0===e?void 0:e.app_config_uri;return t?(0,f().YB)((0,g().appConfigs)(),t):void 0}),[c]),d=o.useCallback((t=>{if(!s||!l||!a)return;const o=s.getParentStore();if(!o||"block"!==o.table&&"space"!==o.table&&"team"!==o.table)return;if(1!==t.dependencies.length)return;const r=t.dependencies[0];p().createAndCommit({userAction:"CollectionViewSuggestedViews.createView",environment:n,canUndo:!0,perform:i=>{var c;m().applyTypedFeatures({environment:n,spaceViewStore:a,appParentStore:o,appUri:l.uri,features:[{type:"simple",featureUri:t.uri}],appCollectionViewBlockStores:[s],createOrModify:"modify",transaction:i});const d=((null===(c=s.getFormat())||void 0===c?void 0:c.app_uri_map)??{})[r.uri];(0,F().f)({environment:n,collectionContextStore:e,collectionViewId:d,isFullScreen:e.isFullScreenStore.state,isRootChild:e.isRootChildStore.state,isInPeekRenderer:e.isInPeekRendererStore.state}),u().xb({environment:n,collectionContextStore:e,view_type:r.value.type,view_config_uri:t.uri,feature:{id:d,from:"suggested_view",type:t.uri}})}})}),[s,l,a,n,e]),S=o.useCallback((e=>{const n=(e,t)=>{var n;const o=e.dependencies[0],r=(0,Z.jsx)(j().F,{color:"regular",viewIcon:null===(n=o.value.format)||void 0===n?void 0:n.collection_view_icon,viewType:o.value.type});return(0,Z.jsx)(v().Z,{title:o.value.name?o.value.name:"New View",icon:r,...t})};return{key:e.uri,render:t=>(0,Z.jsx)(k().Z,{placement:T().Placement.Left,render:o=>n(e,{...t,...o,onMouseEnter:e=>{var n,r;null===(n=o.onMouseEnter)||void 0===n||n.call(o,e),null===(r=t.onMouseEnter)||void 0===r||r.call(t,e)}}),renderTooltip:()=>e.description}),action:()=>{d(e),t()}}}),[d,t]);return{renderSuggestedTypedView:S}}(t,n),{renderSuggestedWorkflowTemplateView:z}=function(e,t){const n=(0,r().O7)(),o=(0,a().yK)((e=>({icon:{fill:e.regularIconColor}})),[]);return{renderSuggestedWorkflowTemplateView:(r,i,a)=>({key:`workflow.${r.templateId}`,action:()=>{(0,M().r)({environment:n,collectionContextStore:e,template:r,suggestedFeatureAnalytics:{origin:"suggested_views",shownTemplateIds:a,selectedIndex:i}}),t()},render:e=>(0,Z.jsx)(v().Z,{...e,icon:(0,Z.jsx)(R().l,{template:r,size:16,iconStyle:o.icon}),title:(0,A().getWorkflowTemplateName)(r)})})}}(t,n),Q={key:"showMore",render:e=>(0,Z.jsx)(v().Z,{...e,style:Y.showMoreLabel,icon:(0,c().O)({width:14,marginRight:2}),title:(0,Z.jsx)(d()._H,{defaultMessage:"More...",id:"collectionViewSuggestedViews.showMore.label"})}),action:()=>{K(!0)}},ee={key:"emptyView",render:e=>(0,Z.jsx)(v().Z,{title:(0,Z.jsx)(d()._H,{defaultMessage:"Empty view",id:"collectionTabBar.newEmptyView.title"}),icon:(0,l().R)({width:16}),...e}),action:()=>{p().createAndCommit({userAction:"CollectionViewTabBar.createGenericViewType",environment:N,canUndo:!0,perform:e=>{(0,D().M)({environment:N,collectionContextStore:t,newViewType:"table",transaction:e,skipOpenSettings:!1})}}),u().xb({environment:N,collectionContextStore:t,view_type:"table"})}},te=["table","board","chart","list","timeline","calendar","gallery"].map((e=>G(e)));let ne;ne=q.length?q.map((e=>$(e))):X.length?X.map(((e,t)=>z(e,t,H({suggestedWorkflowTemplateViews:X,isShowingMoreSuggestions:P})))):te,(0,I().J)({collectionContextStore:t,origin:"suggested_views",shownTemplateIds:H({suggestedWorkflowTemplateViews:X,isShowingMoreSuggestions:P})});const oe={key:"genericViews",render:e=>(0,Z.jsx)(h().Z,{title:(0,Z.jsx)(d()._H,{defaultMessage:"New view",id:"database.collectionTabBar.newViews"}),...e}),items:(X.length||q.length)&&O({numberOfSuggestedViews:ne.length,isShowingMoreSuggestions:P})?[ee,...ne.slice(0,U),Q]:[ee,...ne]},re={key:"form",render:e=>(0,Z.jsx)(h().Z,{topBorder:!0,...e}),items:[{key:"formViewItem",action:()=>{},render:e=>(0,Z.jsx)(S().Z,{collectionContextStore:t,onClose:n,focused:e.focused,isCompact:!1})}]};return(0,Z.jsx)(y().Z,{capture:!0,allowEsc:!0,render:e=>{let t;return t=W.isPhone?{menuType:b().o.Modal,right:(0,Z.jsx)(_().DoneMenuText,{}),onClickRight:n,...e}:{menuType:b().o.Popup,minWidth:290,maxWidth:320,maxHeight:"50vh",...e},(0,Z.jsx)(w().Z,{...t,children:(0,Z.jsx)(C().ZP,{type:C().iW.Vertical,initialFocus:void 0,sections:[oe,...L&&!J?[re]:[]],onAccept:e=>{"showMore"!==e.key&&n()}})})}})}},246471:(e,t,n)=>{n.d(t,{F:()=>d,a:()=>l});n(667294);var o=()=>n(846550),r=()=>n(568017),i=()=>n(707513),a=()=>n(827618),s=()=>n(78014),c=n(785893);function l(e){const{value:t,color:n,format:l,showEllipsis:d,onClickRemove:u,showRemoveButton:p,isSingle:m,shouldShrink:g,hideTooltip:f,description:S,tooltipPlacement:v,...y}=e,w=(0,o().Fg)(),C=(0,o().yK)((e=>({token:{...d&&i().Yu}})),[d]),{textColor:_,backgroundColor:h}=(0,r().KR)(w,n);return t?(0,c.jsx)(s().Z,{format:l,value:(0,c.jsx)(a().Z,{children:t}),description:S,onClickRemove:u,showRemoveButton:p,isSingle:m,color:_,backgroundColor:h,shouldShrink:g,tooltipPlacement:v,showTooltip:f?"never":"overflow",style:C.token,...y}):null}function d(e){const{value:t,color:n,format:l,showEllipsis:d,onClickRemove:u,showRemoveButton:p,isSingle:m,shouldShrink:g,groupColor:f,tooltipPlacement:S,description:v,hideTooltip:y,...w}=e,C=(0,o().Fg)(),_=(0,o().yK)((()=>({token:{...d&&i().Yu}})),[d]);if(!t)return null;const{textColor:h,backgroundColor:k}=(0,r().KR)(C,n??f??"gray");let x;return x=n||(f||"gray"),(0,c.jsx)(s().Z,{format:l,value:(0,c.jsx)(a().Z,{children:t}),description:v,onClickRemove:u,showRemoveButton:p,isSingle:m,color:h,backgroundColor:k,shouldShrink:g,showTooltip:y?"never":"overflow",style:_.token,isRound:!0,showColoredDot:x,tooltipPlacement:S,...w})}},877727:(e,t,n)=>{n.d(t,{QZ:()=>a,SV:()=>r,mq:()=>i});var o=()=>n(749826);function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().default.checkGate({gateName:"workflow_templates_settings_dev",disableExposureLogging:e.disableExposureLogging})&&o().default.checkGate({gateName:"packaging_m3.1",disableExposureLogging:e.disableExposureLogging})}function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().default.checkGate({gateName:"packaging_m3.1",disableExposureLogging:e.disableExposureLogging})}function a(e){return!e.device.isPhone}},932200:(e,t,n)=>{n.d(t,{Y:()=>S,j:()=>v});var o=()=>n(219727),r=()=>n(142735),i=()=>n(29488),a=()=>n(801812),s=()=>n(255933),c=()=>n(293307),l=()=>n(824462),d=()=>n(677559),u=()=>n(876822),p=()=>n(985866),m=()=>n(601952),g=()=>n(999582);const f=!1;function S(e){var t;const n=null===(t=(0,d().XJ)(c().iL).value)||void 0===t?void 0:t.loadWorkflowTemplateInstances;(0,r().VK)((()=>{if(!n)return;const t=e instanceof p().Z?e.collectionStore():e;t&&n(t)}),[n,e])}function v(){const e=(0,o().O7)(),t=(0,r().VK)((()=>{var e;if(function(){const e=m().default.state.initialRenderCompleted;f&&!e&&console.log("Initial page render is not yet completed, delaying refresh of workflow template instances.");return e}())return null===(e=u().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]);(0,a().r5)((async()=>{if(!t)return;(g().Z.debug||f)&&console.log("Refreshing workflow template instance map for space",t);const n={table:s().bx,id:t,spaceId:t},o=await l().callApi({eventName:"getWorkflowTemplateInstances",environment:e,data:{spaceId:n.spaceId,scopeTable:n.table,scopeId:n.id,enableInstanceRobustness:!0}});if("success"===o.type){const e=(0,i().O)(n);g().Z.setState({...g().Z.state,[e]:o.data.instanceMap[e]})}}),[e,t])}},925880:(e,t,n)=>{n.d(t,{c:()=>s});var o=()=>n(219727),r=()=>n(142735),i=()=>n(520186),a=()=>n(932200);function s(e){const t=(0,o().O7)();return(0,a().Y)(e),(0,r().VK)((()=>{const n=e.collectionStore();return n?(0,i().r)(t,n):[]}),[t,e])}},182722:(e,t,n)=>{n.d(t,{J:()=>s});var o=n(667294),r=()=>n(219727),i=()=>n(142735),a=()=>n(594546);function s(e){let{collectionContextStore:t,shownTemplateIds:n,origin:s}=e;const c=(0,r().O7)(),l=(0,i().VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getWorkflowTemplateId()}),[t]),d=(0,o.useRef)(!1);(0,o.useEffect)((()=>{!d.current&&n.length>0&&((0,a().j)({environment:c,event:{eventName:"suggested_feature_templates_shown",eventProperties:{origin:s,collection_template_id:l,template_ids_shown:n}}}),d.current=!0)}))}},999582:(e,t,n)=>{n.d(t,{Z:()=>i});class o extends(()=>n(263184))().default{getInitialState(){return{}}}const r=new o;n(947115).exposeDebugValue("SpaceWorkflowTemplateInstanceMapStore",r);const i=r},29488:(e,t,n)=>{function o(e){return`${e.table}:${e.id}`}n.d(t,{O:()=>o})},157955:(e,t,n)=>{n.r(t),n.d(t,{DEFAULT_MAX_RECURRENCE_DUPLICATION_PER_TASK:()=>R,MAXIMUM_DAILY_RECURRENCES_IN_PATH:()=>h,MAXIMUM_NESTED_RECURRENCE_LEVEL:()=>_,MAX_RECURRENCE_INTERVAL:()=>S,MAX_RECURRENCE_NUMBER_OF_RUNS:()=>v,RRULE_WEEKDAYS_MAP:()=>f,convertFromUnpersistedRecurrenceConfig:()=>D,convertToUnpersistedRecurrenceConfig:()=>A,getFormattedEndCondition:()=>M,getFormattedNextRecurrenceTime:()=>V,getNewEndTimestamp:()=>E,getNextDateUtc:()=>T,getRecurrenceAfter:()=>x,isRunningBetweenMidnightAnd3AM:()=>b,isValidRecurrenceInterval:()=>y,isValidRecurrenceNumberOfRuns:()=>w,rruleFromRecurrence:()=>C,templateAncestorsViolateRecurrenceNesting:()=>k});n(267602),n(653476),n(241792);var o=()=>n(730120);n(670560);function r(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if(0===n.length)return e.map((e=>[e]));const i=[];for(const a of e)i.push(...r(n[0],...n.slice(1)).map((e=>[a,...e])));return i}var i=()=>n(696459),a=()=>n(326966),s=()=>n(803021),c=()=>n(646574),l=()=>n(998411),d=()=>n(578292);class u extends(()=>n(484885))().Ci{constructor(e,t){super(e,t)}after(e,t){return super.after(e,t)}}var p=()=>n(494616);const m=(0,n(788860).vU)({dateAtTime:{id:"automations.recurrenceHelpers.dateAtTime",defaultMessage:"{date} at {time}"},dateBetweenMidnightAnd3AM:{id:"automations.recurrenceHelpers.dateBetweenMidnightAnd3AM",defaultMessage:"{date} between 12–3 AM"},numberEndConditionDescription:{id:"automations.recurrenceHelpers.numberEndConditionDescription",defaultMessage:"{number, plural, one {After {number} run} other {After {number} runs}}"},noEndCondition:{id:"automations.recurrenceHelpers.noEndCondition",defaultMessage:"Never"}}),g={day:u.DAILY,week:u.WEEKLY,month:u.MONTHLY,year:u.YEARLY},f={MO:u.MO,TU:u.TU,WE:u.WE,TH:u.TH,FR:u.FR,SA:u.SA,SU:u.SU},S=99,v=999;function y(e){return(0,a().hj)(e)&&Number.isInteger(e)&&e>0&&e<=S}function w(e){return(0,a().hj)(e)&&Number.isInteger(e)&&e>0&&e<=v}function C(e){const{start_date:t,frequency:n,interval:o,weekdays:a,timezone:c,hour:l,minute:d}=e,p="week"===n&&a?a.map((e=>f[e])):void 0,m={};return(0,i().$K)(e.end_condition)&&("date"===e.end_condition.type?m.until=(0,s().pd)(e.end_condition.end_at):"number"===e.end_condition.type?m.count=e.end_condition.number_of_occurrences:(0,i().t1)(e.end_condition)),"month"===e.frequency&&(0,i().$K)(e.monthly_restriction)&&("monthdays"===e.monthly_restriction.type?m.bymonthday=e.monthly_restriction.monthdays:"weekdays_in_month"===e.monthly_restriction.type?m.byweekday=r(e.monthly_restriction.weekdays,e.monthly_restriction.week_numbers).map((e=>{let[t,n]=e;return f[t].nth(n)})):(0,i().t1)(e.monthly_restriction)),new u({freq:g[n],dtstart:(0,s().pd)(t),interval:o,byweekday:p,tzid:c,byhour:l??0,byminute:d??0,bysecond:0,...m})}const _=1,h=1;function k(e){var t;if(0===e.length)return{violatesConstraint:!1,templateNestingExceedsMaxDepth:!1,ancestorHasDailyTemplate:!1,nestedDepthOfAutomationAncestors:void 0,immediateAncestorRecurrenceType:void 0};const n=e.filter((e=>{var t;return"day"===(null===(t=e.getRecurrence())||void 0===t?void 0:t.frequency)})),o=e.length,r=null===(t=e[0].getRecurrence())||void 0===t?void 0:t.frequency,i=o>_,a=n.length>=h;return{violatesConstraint:i||a,templateNestingExceedsMaxDepth:i,ancestorHasDailyTemplate:a,nestedDepthOfAutomationAncestors:o,immediateAncestorRecurrenceType:r}}function x(e){const{recurrence:t,afterDate:n}=e;if((0,p().nA)(t)){const e=(0,s().kq)(n);return t.start_date>=e?new Date(t.start_date):void 0}{const e=C(t).after((0,s().pd)(n));if(!e)return;return(0,s().YL)(e)}}function b(e){return 0===e.hour||1===e.hour||2===e.hour}function T(e){return C(e).after((0,s().pd)((0,s().Jh)()))||void 0}function V(e){const{recurrence:t,intl:n}=e,r=T(D(t));if(!r)return;const i=b(t),a=o().ou.fromJSDate(r).toUTC().setZone("local",{keepLocalTime:!0}).setLocale((0,d().E2)(n)).setZone(t.timezone),s=(0,c().p6)({date:a,dateFormat:"relative",allowRelativeDates:!0,intl:n,shortenDate:!0});if(i)return n.formatMessage(m.dateBetweenMidnightAnd3AM,{date:s});{let e=a.toLocaleString(o().ou.TIME_SIMPLE);return t.timezone!==(0,l().r)()&&(e+=` ${a.toFormat("ZZZZ")}`),n.formatMessage(m.dateAtTime,{date:s,time:e})}}function M(e,t){return(0,i().$K)(e)?"number"===e.type?t.formatMessage(m.numberEndConditionDescription,{number:e.number_of_occurrences}):"date"===e.type?(0,c().p6)({date:o().ou.fromMillis(e.end_at),dateFormat:"relative",allowRelativeDates:!0,intl:t,shortenDate:!0}):void(0,i().t1)(e):t.formatMessage(m.noEndCondition)}const R=100;function A(e){return{...e,start_date:(0,s().kq)(e.start_date),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?{type:"date",end_at:(0,s().kq)(e.end_condition.end_at)}:(0,i().t1)(e.end_condition):void 0}}function E(e,t,n){return e.plus(n-t)}function I(e,t){const n=o().ou.fromMillis(t.end_at).set({hour:e.hour??0,minute:e.minute??0});return{type:"date",end_at:(0,s().Jh)(n.toJSDate())}}function D(e){return{...e,start_date:(0,s().Jh)(new Date(e.start_date)),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?I(e,e.end_condition):(0,i().t1)(e.end_condition):void 0}}},29248:(e,t,n)=>{n.d(t,{K:()=>r});n(667294);var o=n(785893);const r=(0,n(827282).IU)("boltFilled",{svg:(0,o.jsx)("path",{d:"M0 12.117c0 .38.293.664.703.664h5.518l-2.91 7.91c-.381 1.006.664 1.543 1.318.723l8.877-11.094c.166-.205.254-.4.254-.625 0-.371-.293-.664-.703-.664H7.539l2.91-7.91C10.83.115 9.785-.422 9.131.408L.254 11.492c-.166.215-.254.41-.254.625z"}),viewBox:"0 0 14 22"})},293641:(e,t,n)=>{n.d(t,{J:()=>r});n(667294);var o=n(785893);const r=(0,n(827282).IU)("layout",{viewBox:"0 0 14 14",svg:(0,o.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.39999 2.19999C2.28953 2.19999 2.19999 2.28953 2.19999 2.39998V11.5999C2.19999 11.7103 2.28953 11.7999 2.39999 11.7999H4.99997C5.11042 11.7999 5.19997 11.7103 5.19997 11.5999V2.39998C5.19997 2.28953 5.11042 2.19999 4.99997 2.19999H2.39999ZM1 2.39998C1 1.6268 1.62679 1 2.39999 1H4.99997C5.77316 1 6.39995 1.6268 6.39995 2.39998V11.5999C6.39995 12.3731 5.77316 12.9999 4.99997 12.9999H2.39999C1.62679 12.9999 1 12.3731 1 11.5999V2.39998ZM9 8.80036C8.88954 8.80036 8.8 8.88991 8.8 9.00036V11.6003C8.8 11.7108 8.88954 11.8003 9 11.8003H11.6C11.7105 11.8003 11.8 11.7108 11.8 11.6003V9.00036C11.8 8.88991 11.7105 8.80036 11.6 8.80036H9ZM7.60001 9.00036C7.60001 8.22717 8.2268 7.60037 9 7.60037H11.6C12.3731 7.60037 13 8.22717 13 9.00036V11.6003C13 12.3736 12.3731 13.0003 11.6 13.0003H9C8.2268 13.0003 7.60001 12.3736 7.60001 11.6003V9.00036ZM8.79994 2.39998C8.79994 2.28953 8.88949 2.19999 8.99994 2.19999H11.5999C11.7104 2.19999 11.7999 2.28953 11.7999 2.39998V4.99997C11.7999 5.11043 11.7104 5.19996 11.5999 5.19996H8.99994C8.88949 5.19996 8.79994 5.11043 8.79994 4.99997V2.39998ZM8.99994 1C8.22675 1 7.59995 1.6268 7.59995 2.39998V4.99997C7.59995 5.77316 8.22675 6.39995 8.99994 6.39995H11.5999C12.3731 6.39995 12.9999 5.77316 12.9999 4.99997V2.39998C12.9999 1.6268 12.3731 1 11.5999 1H8.99994Z"})})},490670:(e,t,n)=>{n.d(t,{f:()=>r});n(667294);var o=n(785893);const r=(0,n(827282).IU)("plusThick",{viewBox:"0 0 14 14",svg:(0,o.jsx)("path",{d:"M2 7.16357C2 7.59692 2.36011 7.95093 2.78735 7.95093H6.37622V11.5398C6.37622 11.9731 6.73022 12.3271 7.16357 12.3271C7.59692 12.3271 7.95093 11.9731 7.95093 11.5398V7.95093H11.5398C11.9731 7.95093 12.3271 7.59692 12.3271 7.16357C12.3271 6.73022 11.9731 6.37622 11.5398 6.37622H7.95093V2.78735C7.95093 2.36011 7.59692 2 7.16357 2C6.73022 2 6.37622 2.36011 6.37622 2.78735V6.37622H2.78735C2.36011 6.37622 2 6.73022 2 7.16357Z"})})},749166:(e,t,n)=>{n.d(t,{w:()=>r});n(667294);var o=n(785893);const r=(0,n(827282).IU)("templates",{viewBox:"0 0 20 20",svg:(0,o.jsxs)("g",{children:[(0,o.jsx)("path",{d:"M6.39733 5.67853C5.89764 5.50234 5.36002 5.40649 4.8 5.40649C2.14904 5.40649 0 7.55432 0 10.2038C0 12.8533 2.14904 15.0011 4.8 15.0011C6.52165 15.0011 8.0316 14.0952 8.87867 12.7343L5.26487 12.0975L6.39733 5.67853Z"}),(0,o.jsx)("path",{d:"M17.3126 3.66609L7.85843 2L6.19141 11.4489L10.6545 12.2354L14.3998 5.81854L16.3449 9.15116L17.3126 3.66609Z"}),(0,o.jsx)("path",{d:"M8.80078 17L14.4008 7.4054L20.0008 17H8.80078Z"})]})})},856466:(e,t,n)=>{n.d(t,{$X:()=>a,F_:()=>s,iZ:()=>i});n(267602),n(470928);var o=()=>n(926724),r=()=>n(295617);const i={autoCompleteSprints:!1,actionConfig:{complete_sprint_action:"complete_sprint_and_move_incomplete_tasks_to_next_sprint"},recurrenceConfig:{interval:2,weekdays:["MO"]}};function a(e){const{eventTracker:t,properties:n}=e;t.DO_NOT_USE_commonTrackEvent({eventName:"complete_sprint_action",properties:n})}function s(e,t){var n;return null===(n=t.groups)||void 0===n||null===(n=n.find((t=>t.id===o().nl||(null==t?void 0:t.name)===r().RW||(null==t?void 0:t.name)===e.formatMessage(r().ct.statusGroupNameComplete))))||void 0===n?void 0:n.name}},126301:(e,t,n)=>{n.d(t,{DW:()=>s,IX:()=>a,Su:()=>r,rP:()=>i});var o=()=>n(730120);function r(e){if("week"===e.frequency&&e.weekdays&&1===e.weekdays.length)return{weekday:e.weekdays[0],duration:e.interval}}function i(e){const{currentSprintEndDate:t,sprintSchedule:n}=e;return c({startDate:d({dateToAdjust:o().ou.fromISO(t),weekday:n.weekday,wrapForEqualDays:!0}),duration:n.duration})}function a(e){const{userTimeZone:t,sprintSchedule:n}=e;return c({startDate:o().ou.local({zone:t}),duration:n.duration})}function s(e){const{currentSprintStartDate:t,sprintSchedule:n}=e,r=d({dateToAdjust:o().ou.fromISO(t),weekday:n.weekday,wrapForEqualDays:!1}),{end_date:i}=c({startDate:r,duration:n.duration});let a=o().ou.fromISO(i);const s=o().ou.now().startOf("day");for(;a.diff(s,"days").days<0;)a=a.plus({weeks:1});return{type:"daterange",start_date:a.plus({days:1}).minus({weeks:n.duration}).toISODate(),end_date:a.toISODate()}}function c(e){const{startDate:t,duration:n}=e,o=t.plus({weeks:n}).minus({days:1});return{type:"daterange",start_date:t.toISODate(),end_date:o.toISODate()}}const l={SU:0,MO:1,TU:2,WE:3,TH:4,FR:5,SA:6};function d(e){const{dateToAdjust:t,weekday:n,wrapForEqualDays:o}=e,r=u({currentWeekday:t.weekday%7,nextWeekday:l[n],wrapForEqualDays:o});return t.plus({days:r})}function u(e){const{currentWeekday:t,nextWeekday:n,wrapForEqualDays:o}=e,r="number"==typeof t?t:l[t],i="number"==typeof n?n:l[n];if(r===i)return o?7:0;let a=r,s=0;for(;a!==i;)a===l.SA?a=0:a+=1,s+=1;return s}}}]);