"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[82164],{178498:(e,t,r)=>{r.d(t,{Z:()=>l});var o=r(667294),i=r(785893);function n(e,t){return(0,i.jsx)(r(18748).ZP,{...e,ref:t,style:{background:"none",borderBottom:"none",boxShadow:"",marginTop:2,marginBottom:6,paddingTop:4,paddingBottom:4,minHeight:"none",...e.style}})}const l=(0,o.forwardRef)(n)},903639:(e,t,r)=>{r.d(t,{default:()=>Z});r(267602),r(653476),r(470928),r(241792);var o=r(667294),i=()=>r(219727),n=()=>r(142735),l=()=>r(846550),s=()=>r(766933),p=()=>r(94250),a=()=>r(717956),d=()=>r(788860),c=()=>r(513670),y=()=>r(707513),u=()=>r(917881),h=()=>r(421654),m=()=>r(269299),g=()=>r(352230),x=()=>r(129338),b=()=>r(998901),f=()=>r(178498),v=()=>r(356321),j=()=>r(827973),S=()=>r(119891),P=()=>r(1910),k=()=>r(198829),C=()=>r(255577),T=()=>r(388284),w=r(785893);const Z=function(e){let{collectionStore:t,targetCollectionStore:s,property:p,disabled:a,rowType:c}=e;const y=(0,l().Fg)(),u=(0,i().O7)(),h=(0,n().qz)(void 0,r(692304).Z),{format:m}=(0,o.useContext)(r(459217).m),g=(0,n().VK)((()=>{const e=x().U1({collectionStore:t,property:p}),r=Object.keys(s.getSchema()).map((t=>e.find((e=>e.property===t))??{property:t,visible:!1})),o=e.map((e=>e.property)),i=e=>{const t=o.indexOf(e);return-1!==t?t:1/0};return r.sort(((e,t)=>i(e.property)-i(t.property))),r}),[t,s,p]),f=(0,o.useCallback)((e=>(0,w.jsx)(F,{parent:e,collectionStore:t,property:p,disabled:a,targetCollectionStore:s,menuListStore:h,allRelatedTargetProperties:g})),[t,p,a,s,h,g]);return(0,i().MO)()&&"section"!==c||m===v().C.FormEditor||m===v().C.FormViewer?null:(0,w.jsx)(r(654133).Z,{renderTooltip:()=>(0,w.jsx)(d()._H,{id:"database.RelationCustomizeLayoutMenu.tooltip.button.message",defaultMessage:"Customize shown properties"}),placement:"section"===c?b().Placement.Top:b().Placement.Right,render:e=>(0,w.jsx)(r(448419).ZP,{popupType:r(967092).kQ.Popup,alignmentToOrigin:b().Alignment.Start,...e,renderOrigin:t=>(0,w.jsx)(P().Z,{icon:r(641772).o,iconStyle:{width:16,color:y.mediumIconColor,fill:y.mediumIconColor},...t,...e}),onClick:()=>{r(491927).gP(u,{from:"section"===c?"relation_section":"configure_relation_modal"})},originGap:16,render:f})})};function _(e){const{props:t,children:r}=e;return(0,w.jsx)(T().Z,{...t,noTextOverflow:!0,isTitleUppercase:!1,title:(0,w.jsx)(d()._H,{defaultMessage:"Hidden in relation",id:"database.relationMenu.hiddenInRelationTitle"}),desktopTitleStyle:{height:19},children:r,disableDesktopPadding:!0})}function M(e,t,r,o,i,n,l){const{properties:d,visibility:h}=e;return c().oA(d.map((e=>function(e,t,r,o,i,n,l){const{propertyFormat:d,visibility:c}=e,h=!c,m=i.getSchema();if(!m)return;const g=m[d.property];return g?{key:d.property,render:e=>(0,w.jsx)(j().Z,{...e,showDragHandle:!l,title:(0,w.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,w.jsx)(s().ZP,{icon:g.icon,type:g.type,size:16,theme:r,style:{fill:r.regularIconColor}}),(0,w.jsx)("span",{style:{marginLeft:8,...y().Yu},children:g.name})]}),right:(0,w.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,w.jsx)(P().Z,{icon:h?a().B:p().c,iconStyle:{width:16,height:16},isDarkIconColor:!h,onClick:()=>{u().qK({propertyFormat:d,visibility:c,collectionStore:o,property:n,environment:t})},disabled:l||"title"===d.property})})}),action:()=>{}}:void 0}({propertyFormat:e,visibility:h},t,r,o,i,n,l))))}function O(e){const t=(0,i().O7)(),{collectionStore:r,property:o,menuListStore:n,disabled:l,visibleProperties:s,hiddenProperties:p,children:a}=e,d=c().oA([...s.map((e=>e.property)),s.length>0&&p.length>0&&{key:"group-header-hidden-property",draggable:!1},...p.map((e=>e.property))]);return(0,w.jsx)(S().ZP,{direction:"vertical",keys:d,renderKey:(e,t)=>a[t],onDrop:e=>{!function(e,t,r,o,i){const{newPropertyKeys:n}=e,l=x().U1({collectionStore:r,property:o}),s=n.indexOf("group-header-hidden-property"),p=c().oA(n.filter((e=>!e.startsWith("group-header-"))).map(((e,t)=>{const r=l.find((t=>t.property===e));return r?s>0?"title"===e&&t>=s?r:{...r,visible:Boolean(t<s)}:r:{property:e,visible:!(s>0)||Boolean(t<s)}}))),a=l.filter((e=>!n.includes(e.property))),d={...x().ZI(r)};d[o]||(d[o]={}),d[o].related_properties=[...p,...a],m().createAndCommit({userAction:"RelationPropertyCustomizeLayoutMenu.handlePropertyReorder",environment:t,canUndo:!0,perform:e=>{h().FH({stores:[r],update:{collection_relation_options:d},transaction:e})}}),i.reset()}({newPropertyKeys:e},t,r,o,n)},disabled:l})}function F(e){let{parent:t,collectionStore:r,property:o,disabled:s,targetCollectionStore:p,menuListStore:a,allRelatedTargetProperties:y}=e;const u=(0,l().Fg)(),h=(0,i().O7)(),m=y.filter((e=>e.visible)),x=y.filter((e=>!e.visible)),b=(0,n().VK)((()=>M({properties:m,visibility:!0},h,u,r,p,o,s)),[m,h,u,r,p,o,s]),v=(0,n().VK)((()=>M({properties:x,visibility:!1},h,u,r,p,o,s)),[x,h,u,r,p,o,s]);return y?(0,w.jsxs)(k().Z,{menuType:g().o.Popup,maxWidth:240,maxHeight:500,children:[0===y.length&&(0,w.jsx)(T().Z,{children:(0,w.jsx)(f().Z,{caption:(0,w.jsx)(d()._H,{defaultMessage:"No properties",id:"database.relationMenu.noProperties"})})}),y.length>0&&(0,w.jsx)(C().ZP,{type:C().iW.Vertical,store:a,initialFocus:void 0,sections:c().oA([m.length>0&&{key:"visible_and_hidden_properties",render:e=>(0,w.jsx)(T().Z,{...e,noTextOverflow:!0,isTitleUppercase:!1,title:(0,w.jsx)(d()._H,{defaultMessage:"Shown in relation",id:"database.relationMenu.shownInRelationTitle"}),desktopTitleStyle:{height:18},children:(0,w.jsx)(O,{collectionStore:r,property:o,disabled:s,menuListStore:a,visibleProperties:m,hiddenProperties:x,children:e.children})}),items:c().oA([...b,x.length>0&&{key:"group-header-hidden-property",render:e=>(0,w.jsx)(_,{props:e,children:(0,w.jsx)(w.Fragment,{})}),action:()=>{}},...v])},0===m.length&&x.length>0&&{key:"hidden_properties",render:e=>(0,w.jsx)(_,{props:e,children:(0,w.jsx)(O,{collectionStore:r,property:o,disabled:s,menuListStore:a,visibleProperties:m,hiddenProperties:x,children:e.children})}),items:v}])})]}):null}},94250:(e,t,r)=>{r.d(t,{c:()=>i});r(667294);var o=r(785893);const i=(0,r(827282).IU)("eye",{viewBox:"0 0 32 32",svg:(0,o.jsx)("path",{d:"M16.006 25.812c8.863 0 14.994-7.17 14.994-9.406C31 14.16 24.858 7 16.006 7 7.252 7 1 14.16 1 16.406c0 2.236 6.252 9.406 15.006 9.406zm0-3.242a6.194 6.194 0 01-6.197-6.164c-.012-3.452 2.744-6.164 6.197-6.164 3.419 0 6.185 2.711 6.185 6.164 0 3.364-2.766 6.164-6.185 6.164zm0-3.94c1.228 0 2.246-1.007 2.246-2.224 0-1.228-1.018-2.235-2.246-2.235-1.24 0-2.258 1.007-2.258 2.235 0 1.217 1.018 2.224 2.258 2.224z"})})}}]);