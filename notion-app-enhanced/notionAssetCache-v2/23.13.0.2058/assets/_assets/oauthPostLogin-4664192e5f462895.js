"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[14464],{859672:(e,t,i)=>{i.r(t),i.d(t,{default:()=>T});var n=i(667294),o=()=>i(219727),l=()=>i(61951),a=()=>i(836273),r=()=>i(916673),s=()=>i(799891),c=()=>i(824462);var d=()=>i(632599),u=()=>i(466970),m=()=>i(142735),g=()=>i(846550),h=()=>i(922622),f=()=>i(933868),p=()=>i(47667),y=()=>i(788860),x=()=>i(568017),b=()=>i(707513),v=()=>i(205228),C=()=>i(661297),j=()=>i(906651),_=()=>i(943620),k=()=>i(765513),w=()=>i(949818),S=i(785893);function M(e){const{confirmationData:t}=e,{clientName:i,clientCapability:l}=t,a=(0,n.useMemo)((()=>!i||!(null!=l&&l.read_user_email_name_photo)),[i,l]),r=function(e){const{WindowSizeStore:t}=e.environment,i=(0,m().VK)((()=>t.state.width>500),[t]),n=(0,m().VK)((()=>t.state.height<900),[t]);return(0,g().yK)((e=>({layoutContainer:{height:"100%",overflow:"auto",backgroundColor:i?x().ZP.frontCreamBackground:x().ZP.white},pageContainer:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},contentBox:{width:"500px",minHeight:"480px",borderRadius:5,backgroundColor:x().ZP.white,boxShadow:i?e.shadowSM:"none",display:"flex",flexDirection:"column",fontSize:b().JB.UIRegular.desktop,marginTop:n?16:i?"calc((100vh - 900px) / 2)":0,marginBottom:40,transition:"all 0.2s ease"},contentBody:{paddingLeft:40,paddingRight:40,paddingTop:25,paddingBottom:25,flex:1,display:"flex",flexDirection:"column"}})),[i,n])}({environment:(0,o().O7)()});return(0,S.jsx)("div",{style:r.layoutContainer,children:(0,S.jsx)("div",{style:r.pageContainer,children:(0,S.jsxs)("div",{style:r.contentBox,children:[(0,S.jsx)(w().Z,{disableAccountSwitcher:!0,onSpaceSwitch:async e=>{},useEmailAccount:!0}),(0,S.jsx)("div",{style:r.contentBody,children:a?(0,S.jsx)(O,{...e}):(0,S.jsx)(B,{...e})})]})})})}function O(e){const{setCanRedirect:t,setRedirectUrl:i}=e,[l,a]=(0,n.useState)(!1),r=function(){const{isMobile:e}=(0,o().Fy)(),t=e?25:48,i=e?18:20;return(0,g().yK)((()=>({container:{textAlign:"center",flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},icon:{fill:x().ZP.red,width:t,height:t,marginBottom:20,display:"inline-block"},title:{fontSize:i,margin:"0 50px 32px",textAlign:"center",fontWeight:b().Ue.medium,marginBottom:12},body:{marginTop:0,marginBottom:24,width:"80%"}})),[t,i])}(),s=(0,S.jsx)(y()._H,{id:"globalOauthConfirmationPage.error.title",defaultMessage:"Something went wrong."}),c=(0,n.useCallback)((()=>{a(!0),i(v().default.domainBaseUrl),t(!0)}),[a,i,t]);return(0,S.jsxs)("section",{style:r.container,children:[(0,h().l)(r.icon),(0,S.jsx)("header",{style:r.title,children:s}),(0,S.jsx)("p",{style:r.body,children:(0,S.jsx)(y()._H,{id:"globalOauthConfirmationPage.error.detail",defaultMessage:"Please try again or contact Notion support."})}),(0,S.jsx)("div",{style:r.body,children:(0,S.jsx)(j().Z,{isLarge:!0,onClick:c,disabled:l,children:(0,S.jsx)(y()._H,{id:"globalOauthConfirmationPage.error.returnHome",defaultMessage:"Return to home"})})})]})}function B(e){const{clientId:t,confirmationData:i,setCanRedirect:l,setRedirectUrl:a}=e,{clientName:r,clientMetadata:s,clientCapability:c}=i,[d,u]=(0,n.useState)(!1),m=(0,n.useMemo)((()=>!!c&&(0,f().p8)(c)),[c]),h=(0,n.useCallback)((()=>{u(!0),a(v().default.domainBaseUrl),l(!0)}),[u,a,l]),x=(0,n.useCallback)((()=>{u(!0),l(!0)}),[l,u]),w=function(){const{isMobile:e}=(0,o().Fy)();return(0,g().yK)((t=>({title:{fontSize:e?18:20,margin:"0 50px 22px",textAlign:"center",fontWeight:b().Ue.medium},inlineTextLink:{color:"black",textDecoration:"none"},buttonGroup:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:34},footer:{fontSize:b().JB.UISmall.desktop,color:t.mediumTextColor,paddingTop:20,paddingBottom:16},innerFooterContainer:{color:t.regularTextColor,fontWeight:b().Ue.semibold,marginBottom:4}})),[e])}(),M=null!=s&&s.logo_url?{pointer:{table:p().S,id:t},icon:s.logo_url}:void 0;return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{style:{padding:15},children:(0,S.jsx)(_().Z,{icon:M,disabled:!0,title:r,size:54,isEmptyPage:!1,style:{margin:"auto"}})}),(0,S.jsx)("div",{style:w.title,children:(0,S.jsx)(y()._H,{id:"globalOauthConfirmationPage.permissions.title",defaultMessage:"<inlinetextlink>{clientName}</inlinetextlink> is requesting access to your name, email, and profile photo.",values:{clientName:r,inlinetextlink:e=>null!=s&&s.website_url?(0,S.jsx)(k().Z,{style:w.inlineTextLink,href:null==s?void 0:s.website_url,children:e}):e}})}),m&&(0,S.jsx)("div",{style:{textAlign:"center"},children:(0,S.jsx)(y()._H,{id:"globalOauthConfirmationPage.permissions.noWorkspaceAccess",defaultMessage:"{clientName} will not have access to any of your Notion workspaces.",values:{clientName:r}})}),(0,S.jsxs)("div",{style:w.buttonGroup,children:[(0,S.jsx)(C().Z,{size:"lg",onClick:h,style:{height:32},disabled:d,children:(0,S.jsx)(y()._H,{id:"globalOauthConfirmationPage.permissions.cancel",defaultMessage:"Cancel"})}),(0,S.jsx)(j().Z,{isLarge:!0,onClick:x,disabled:d,children:(0,S.jsx)(y()._H,{id:"globalOauthConfirmationPage.permissions.allow",defaultMessage:"Allow"})})]}),(0,S.jsx)("footer",{style:w.footer,children:(0,S.jsx)("div",{children:(0,S.jsx)(y()._H,{id:"globalOauthConfirmationPage.permissions.warning.body",defaultMessage:"By allowing access, you consent to sharing info with {clientName}. Learn how <inlinetextlink>{clientName}</inlinetextlink> handles your data by reviewing their <privacypolicylink>Privacy Policy</privacypolicylink> and <termsofservicelink>Terms of Service</termsofservicelink>.",values:{clientName:r,inlinetextlink:e=>null!=s&&s.website_url?(0,S.jsx)(k().Z,{href:null==s?void 0:s.website_url,children:e}):e,privacypolicylink:e=>null!=s&&s.privacy_policy_url?(0,S.jsx)(k().Z,{href:null==s?void 0:s.privacy_policy_url,children:e}):e,termsofservicelink:e=>null!=s&&s.terms_of_use_url?(0,S.jsx)(k().Z,{href:null==s?void 0:s.terms_of_use_url,children:e}):e}})})})]})}function T(e){const t=(0,o().O7)(),{clientId:i,redirectUri:m,csrfState:g,responseType:h,scope:f}=e,p=(0,u().E)("global_oauth_confirmation_ui"),[y,x]=(0,n.useState)(!1),[b,v]=(0,n.useState)(void 0),[C,j]=(0,n.useState)(void 0);return(0,n.useEffect)((()=>{const e=r().bf({url:`${a()._j.globalOauthAuthorization}`,query:{client_id:i,state:g,redirect_uri:m,scope:f,response_type:h,skip_confirmation:"true"}});j(e),p||x(!0)}),[i,m,g,h,f,j,x,p]),(0,l().Z)((()=>{(async()=>{const e=await async function(e){const{environment:t,clientId:i,requestedScopes:n}=e,o=await c().callApi({eventName:"getOauthMetadata",environment:t,data:{clientId:i,requestedScopes:n}});return"failed"!==o.type&&o.data?{clientName:o.data.clientName,clientMetadata:o.data.clientMetadata,clientCapability:o.data.clientCapability,previouslyConfirmedOauth:o.data.issuedValidToken}:(s().log({level:"warning",type:"requestFaileOrMissingData",from:"globalOauthActions",data:{miscDataToConvertToString:{clientId:i,currentUserId:t.currentUser.id}}}),{previouslyConfirmedOauth:!1})}({environment:t,clientId:i,requestedScopes:[f]}),{previouslyConfirmedOauth:n}=e;n&&x(!0),v(e)})()}),!y&&p),(0,n.useEffect)((()=>{y&&C&&(window.location.href=C)}),[y,C]),p&&b&&!b.previouslyConfirmedOauth?(0,S.jsx)(M,{clientId:i,confirmationData:b,setCanRedirect:x,setRedirectUrl:j}):(0,S.jsx)(d().Z,{})}}}]);