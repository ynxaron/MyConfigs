"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[54041],{57194:(e,t,o)=>{o.d(t,{r:()=>r});var n=()=>o(974442);async function r(e){return new Promise((t=>{n().Z.setState({open:!0,onClose:()=>{n().Z.setState({open:!1}),t(!1)},onConfirm:()=>{n().Z.setState({open:!1}),t(!0)},...e})}))}},501912:(e,t,o)=>{o.d(t,{T:()=>y});o(670560),o(667294);var n=()=>o(788860),r=()=>o(707513),i=()=>o(360746),l=()=>o(384241),a=()=>o(129338),s=()=>o(90065),c=()=>o(688745),d=()=>o(382474),p=()=>o(917881),u=()=>o(308186),m=()=>o(269299),f=o(785893);async function y(e){const{environment:t,collectionContextStore:o,property:y,handleDeleteAccept:g}=e,h=o.collectionStore();if(!h)return;if(h.isTypedProperty(y)){if(await i().w0({environment:t,property:y,collectionContextStore:o,theme:e.theme,from:e.from}))return}const S=(0,d()._U)({environment:t,collectionStore:h,propertyId:y});if(S.length>0){if((0,c().Ym)({environment:t,collectionStore:h,propertyId:y,compoundTemplateInstancesToDelete:S,collectionContextStore:o,from:e.from}))return}else if(((0,s().e_)(y)||(0,s().TJ)({collectionStore:h,propertyId:y}))&&(0,s().sA)(h)&&(0,s().tj)()){if((0,c().D5)({environment:t,collectionStore:h,propertyId:y,collectionContextStore:o,from:e.from}))return}const v=o.normalizedSchemaStore.state,C=v[y],x=a().ny(o,C);await(null==x?void 0:x.load());const b=x&&a().OP(o,y,x),I=x&&a().gZ(x),_=x&&h.id===x.id,A=[{label:(0,f.jsx)(n()._H,{id:"database.viewSettings.propertyTab.deleteProperty.modal.confirmButton",defaultMessage:"Delete"}),color:"red",onAccept:g}];let w;if(b&&h&&I&&!_&&A.push({label:(0,f.jsx)(n()._H,{id:"database.tableHeaderCell.deleteProperty.modal.inverseConfirmButton",defaultMessage:"Delete, but keep related property"}),color:"red",onAccept:()=>{m().createAndCommit({userAction:"collectionPropertyActions.showDeletePropertyDialog",environment:t,canUndo:!0,perform:e=>{if(C&&"relation"===C.type&&C.property&&x){const o=C.property,n=x.getSchema();p().q0({environment:t,collectionStore:x,propertySchema:n[o],property:o,targetPropertyID:void 0,autoRelate:h.isSyncedCollection()&&!x.isSyncedCollection()?{enabled:!1}:C.autoRelate,transaction:e})}p().kQ({environment:t,collectionStore:h,property:y,transaction:e})}})}}),"auto_increment_id"===(null==C?void 0:C.type))w=a().pR(v)?(0,f.jsx)(n()._H,{id:"database.tableHeaderCell.deleteUniqueIdWithGithubProperty.modal.prompt",defaultMessage:"You will no longer be able to link new GitHub PRs and status automations will stop working."}):(0,f.jsx)(n()._H,{id:"database.tableHeaderCell.deleteUniqueIdProperty.modal.prompt",defaultMessage:"The ID property will be permanently deleted."});else if("status"===(null==C?void 0:C.type)){const e=a().Pi(v);if(e){const t=e.connectedRelation.automation;t&&t[y]&&(w=(0,f.jsx)(n()._H,{id:"database.tableHeaderCell.deleteStatusProperty.modal.prompt",defaultMessage:"Deleting this status property will stop the GitHub Pull Requests status automation."}))}}else x&&I&&!_&&b&&(w=(0,f.jsx)(n()._H,{id:"database.tableHeaderCell.deleteRelatedProperty.modal.prompt",defaultMessage:"This property has a related property on {relationTargetName} which will also be deleted.",values:{relationTargetName:(0,f.jsx)(l().Z,{style:{display:"inline",fontWeight:r().Ue.medium},store:x})}}));u().vC({message:(0,f.jsx)("span",{children:(0,f.jsx)(n()._H,{id:"database.tableHeaderCell.deleteProperty.modal.prompt",defaultMessage:"Delete this property from {databaseName}? It will be removed from all views.",values:{databaseName:(0,f.jsx)(l().Z,{style:{display:"inline",fontWeight:r().Ue.bold},shouldWrap:!0,store:h})}})}),description:w,showCancel:!0,keepFocus:!0,items:A,mode:"wide"})}},351763:(e,t,o)=>{o.r(t),o.d(t,{autofillPropertyForBlocks:()=>$,autofillPropertyForCollection:()=>Y,fillAllPagesMessages:()=>V,getDefaultAiInference:()=>J,getPropertyCompletionForBlock:()=>X,saveOrRemovePropertyAiInference:()=>Q,submitFeedbackForAiAutofill:()=>G,triggerAiAutofillUpsell:()=>W});o(670560),o(122556),o(582845),o(250570),o(533019),o(721473),o(788208),o(22624),o(267602),o(653476),o(470928),o(30005),o(241792);var n=o(667294),r=()=>o(66077),i=()=>o(226413),l=()=>o(532850),a=()=>o(956057),s=()=>o(481529),c=()=>o(255393),d=()=>o(788860),p=()=>o(956898),u=()=>o(696459),m=()=>o(562109),f=()=>o(250303),y=()=>o(824462),g=()=>o(959137),h=()=>o(57194),S=()=>o(308186),v=()=>o(421654),C=()=>o(102182),x=()=>o(970105),b=()=>o(269299),I=()=>o(187920),_=()=>o(82548),A=()=>o(78078),w=()=>o(312446),k=o(785893);const P=function(e){let{environment:t,inferenceIds:r,aiInference:i}=e;const l=(0,o(142735).VK)((()=>{const{state:e}=_().CollectionsAiAutofillProgressStore;return"uninitialized"===e.type?null:{numBlocksToAutofill:e.numBlocksToAutofill,numBlocksAutofilled:e.numBlocksAutofilled,propertySchema:e.propertySchema,collectionId:e.collectionId,sessionId:e.sessionId,haveAllBlocksCompletedAutofill:e.haveAllBlocksCompletedAutofill}}),[]),a=(0,n.useCallback)((()=>{l&&(r.forEach((e=>{m().qG(t,{ai_inference_type:i.type,type:"undo_from_snackbar",inference_id:e,collection_id:l.collectionId,session_id:l.sessionId})})),o(207874).Yw(t,!0),C().rN(),_().CollectionsAiAutofillProgressStore.setState({type:"filling",...l,didInterruptStreaming:!0}))}),[l,t,i,r]);if(!l)return null;const{numBlocksToAutofill:s,numBlocksAutofilled:c,propertySchema:{name:p}}=l;return c===s?(0,k.jsxs)(A().X2,{gap:4,alignItems:"center",children:[(0,o(235605).k)({width:16}),(0,k.jsx)(d()._H,{defaultMessage:'AI updated "{propertyName}" on {numPages, plural, one {1 page} other {# pages}}',id:"snackbar.aiAutofill.autofillInProgress",values:{propertyName:p,numPages:s}}),(0,k.jsx)(w().Pn,{onClick:a,children:(0,k.jsx)(d()._H,{defaultMessage:"Undo",id:"snackbar.aiAutofill.undo"})}),(0,k.jsx)(w().Pn,{onClick:()=>{C().rN()},children:(0,k.jsx)(d()._H,{defaultMessage:"Close",id:"snackbar.aiAutofill.close"})})]}):(0,k.jsxs)(A().X2,{gap:4,alignItems:"center",children:[(0,k.jsx)(o(312578).Z,{}),0===c?(0,k.jsx)(d()._H,{defaultMessage:'AI updating "{propertyName}" on {numPages, plural, one {1 page} other {# pages}}',id:"snackbar.aiAutofill.autofillStarting",values:{propertyName:p,numPages:s}}):(0,k.jsx)(d()._H,{defaultMessage:'AI updated "{propertyName}" on {numFilledPages} of {numTotalPages} pages',id:"snackbar.aiAutofill.completedAutofill",values:{propertyName:p,numFilledPages:c,numTotalPages:s}}),(0,k.jsx)(w().Pn,{onClick:a,children:(0,k.jsx)(d()._H,{defaultMessage:"Stop & undo",id:"snackbar.aiAutofill.undoAndStop"})})]})};var T=()=>o(964433),j=()=>o(542058),M=()=>o(527278),H=()=>o(549813),F=()=>o(876822),Z=()=>o(826955),O=()=>o(584989),R=()=>o(965014),B=()=>o(897257),D=()=>o(254940);const V=(0,d().vU)({fillAllPagesTooltip:{defaultMessage:"{hasNames, select, true {Autofill {propertyName} for all pages in {collectionName}} other {Autofill this property for all pages in the database}}",id:"aiAutofill.fillAllPages.buttonTooltip"},fillAllPagesAddOnMessage:{defaultMessage:"Only with Notion AI add-on",id:"aiAutofill.fillAllPages.onlyWithAiAddOnMessageInTooltip"}});function L(e){const{environment:t,propertyId:o,propertySchema:n,storesWithCompletions:r,blockIdToInferenceId:i,useTemporaryStore:l,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s,clipboardActions:c,doneStreaming:d,aiInferenceOverride:p}=e;b().createAndCommit({userAction:"BlockPropertyValue.handleActionButtonClick.aiAutofill",environment:t,canUndo:!Boolean(l),undoCheckpoint:!0,perform:e=>{N({environment:t,propertyId:o,propertySchema:n,storesWithCompletions:r,blockIdToInferenceId:i,useTemporaryStore:l,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s,clipboardActions:c,doneStreaming:d,aiInferenceOverride:p,transaction:e})}})}function N(e){var t;const{environment:o,propertyId:n,propertySchema:r,storesWithCompletions:a,blockIdToInferenceId:s,useTemporaryStore:c,markdownLinkifyIt:d,tinyMceMicrosoftWordPasteFilter:p,clipboardActions:m,doneStreaming:f,aiInferenceOverride:y,transaction:g}=e;for(const{store:h,temporaryStore:S,completion:C}of a){const e=c?S:h;let a;switch(r.type){case"text":a=m.getInlineTitleValueFromClipboardTextHtml({text:C.trim(),stripText:!1,stripSurroundingWhitespace:!0,markdownLinkifyIt:d,tinyMceMicrosoftWordPasteFilter:p});break;case"multi_select":case"select":const e=c?null===(t=h.getAssociatedCollectionStore())||void 0===t?void 0:t.clone(S.inMemoryRecordCache):h.getAssociatedCollectionStore(),o=y??r.select_ai_inference;let s=C.trim().split(",").map((e=>e.trim()));if(f||(s=s.slice(0,-1)),e&&null!=o&&o.add_options){const t=(0,i().RR)({newTokenValues:s.length>0&&"select"===r.type?[[s[0]]]:[s],property:n,propertySchema:r,collectionId:e.id});if(t)for(const o of t)b().applyOperation({store:e,operation:o,transaction:g})}null!=o&&o.add_options||(s=s.filter((e=>{var t;return null===(t=r.options)||void 0===t?void 0:t.find((t=>t.value===e))}))),a=(0,l().zq)(s);break;default:(0,u().t1)(r)}x().sO({environment:o,store:e.getPropertyStore(n),value:a,transaction:g});const I=e.getFormat().ai_property_inference_map??{},_=s[h.id]??"";v().FH({stores:[e],update:{ai_property_inference_map:{...I,[n]:{inference_id:_,created_time:Date.now()}}},transaction:g})}}const q=(0,d().vU)({FAILED_TO_AUTOFILL:{defaultMessage:"Something went wrong. Please try again later",id:"propertyCompletionActions.error.unableToAutofill"},INVALID_PROPERTY_FOR_AUTOFILL:{defaultMessage:"Invalid property configuration for AI autofill",id:"propertyCompletionActions.error.invalidPropertyForAutofill"},NO_BLOCKS_TO_AUTOFILL:{defaultMessage:"Nothing to update with AI",id:"propertyCompletionActions.error.noBlocksToAutofill"}}),U=(0,d().vU)({featureUnavailable:{id:"completionActions.featureNotEnabledError",defaultMessage:"This feature is not currently enabled"}});function K(e){let{autofillPropertyResult:t}=e;const o=M().Z.formatMessage(q[t]);C().rN(),S().RL(o)}const z={ai_limit_property_autofill:(0,k.jsx)(d()._H,{defaultMessage:"This workspace has used all of its free AI responses. Contact your workspace owner to add Notion AI.",id:"aiAutofill.outOfAiUpsellDialogMessage"}),ai_autofill_on_page_edit:(0,k.jsx)(d()._H,{defaultMessage:"Auto-update requires the Notion AI Add-on. Contact your workspace owner to add Notion AI.",id:"aiAutofill.autoUpdateOnPageEditUpsellDialogMessage"}),ai_autofill_fill_all_pages:(0,k.jsx)(d()._H,{defaultMessage:"Updating all pages requires the Notion AI Add-on. Contact your workspace owner to add Notion AI.",id:"aiAutofill.fillAllPagesUpsellDialogMessage"}),ai_autofill_bulk_fill:(0,k.jsx)(d()._H,{defaultMessage:"Filling more pages at once requires the Notion AI Add-on. Contact your workspace owner to add Notion AI.",id:"aiAutofill.bulkFillUpsellDialogMessage"})};function W(e){var t;let{environment:o,from:n}=e;null!==(t=F().default.state.currentSpaceStore)&&void 0!==t&&t.canAdmin()||S().RL(z[n]),R().y(o,{from:n,upsell:{type:"product",product:"ai",limit:{type:"none"}}})}function E(e){let{errorCode:t,environment:o}=e;return 405===t?C().oV({label:M().Z.formatMessage(U.featureUnavailable)}):(402===t&&(C().rN(),W({environment:o,from:"ai_limit_property_autofill"})),D().showCompletionErrorWithCode(t))}async function $(e){var t;let{environment:o,stores:n,property:l,propertySchema:s,userEventForAnalytics:c,sessionIdForAnalytics:d,collectionContextStore:h,from:S,isBulkAction:v,aiInferenceOverride:x,transaction:b}=e;const I=d||a().Il(),A=l,w=n.map((e=>({spaceId:e.getSpaceId(),...e.pointer,propertyId:A,inferenceId:a().Il()}))),M=n[0].getAssociatedCollectionId()??(null===(t=n[0].getCollectionStore())||void 0===t?void 0:t.id),H=new(r().Z)({name:"propertyCompletionActions.autofillPropertyForBlocks"});if(_().CollectionsAiAutofillProgressStore.setIsWriting({stores:n,propertySchema:s,sessionIdForAnalytics:d}),"uninitialized"!==_().CollectionsAiAutofillProgressStore.state.type&&(0,i().qQ)(s)&&M){C().oV({label:(0,k.jsx)(P,{environment:o,inferenceIds:w.map((e=>e.inferenceId)),aiInference:(0,i().q3)(s)}),durationMs:O().JY});try{var Z;if(o.defaultRecordCache.inMemoryRecordCache.addCacheOverride(H),!(0,u().Of)(w))return K({autofillPropertyResult:"NO_BLOCKS_TO_AUTOFILL"});const e=x||(0,i().q3)(s);if(!e)return K({autofillPropertyResult:"INVALID_PROPERTY_FOR_AUTOFILL"});w.forEach((t=>{m().qG(o,{type:c,inference_id:t.inferenceId,ai_inference_type:e.type,collection_id:M,session_id:I})})),null!==(Z=F().default.state.currentSpaceStore)&&void 0!==Z&&Z.id&&y().callApi({eventName:"publishAiSession",environment:o,data:{inference_type:"autofill",id:I,spaceId:F().default.state.currentSpaceStore.id,metadata:{blockPropertyPointers:w,aiInference:e,collection_id:M}}});const t=await y().callStreamApi({eventName:"getCompletionForProperty",environment:o,data:{blockPropertyPointers:w,aiInference:e,aiSessionId:I,model:"default"}});if("success"!==t.type)return K({autofillPropertyResult:"FAILED_TO_AUTOFILL"});h&&f().rv({block_id:n[0].pointer.id,property:A,property_type:s.type,from:S,environment:o,collectionContextStore:h,isFromBulkActionsToolbar:v});const r=Object.fromEntries(n.map((e=>[e.pointer.id,{store:e,temporaryStore:e.clone(H),completion:""}]))),l=Object.fromEntries(w.map((e=>[e.id,e.inferenceId]))),a=new Set,[d,C,k]=await Promise.all([T().p.load(),j().m.load(),g().F.clipboardActions.load()]);if(p().H1.is(t.data)){for await(const e of t.data){if("error"===e.type)return _().CollectionsAiAutofillProgressStore.setState({..._().CollectionsAiAutofillProgressStore.state,didInterruptStreaming:!0}),E({errorCode:e.errorCode,environment:o});if(_().CollectionsAiAutofillProgressStore.state.didInterruptStreaming)return;const t=r[e.blockPropertyPointer.id],n=t.completion+e.completion;r[e.blockPropertyPointer.id]={...t,completion:n},a.add(e.blockPropertyPointer.id),b?N({environment:o,propertyId:A,propertySchema:s,storesWithCompletions:Object.values(r),blockIdToInferenceId:l,useTemporaryStore:!0,markdownLinkifyIt:d,tinyMceMicrosoftWordPasteFilter:C,clipboardActions:k,doneStreaming:!0,aiInferenceOverride:x,transaction:b}):L({environment:o,propertyId:A,propertySchema:s,storesWithCompletions:Object.values(r),blockIdToInferenceId:l,useTemporaryStore:!0,markdownLinkifyIt:d,tinyMceMicrosoftWordPasteFilter:C,clipboardActions:k,aiInferenceOverride:x}),_().CollectionsAiAutofillProgressStore.setState({..._().CollectionsAiAutofillProgressStore.state,numBlocksAutofilled:a.size})}_().CollectionsAiAutofillProgressStore.setState({..._().CollectionsAiAutofillProgressStore.state,haveAllBlocksCompletedAutofill:!0})}o.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(H),b?N({environment:o,propertyId:A,propertySchema:s,storesWithCompletions:Object.values(r),blockIdToInferenceId:l,useTemporaryStore:!1,markdownLinkifyIt:d,tinyMceMicrosoftWordPasteFilter:C,clipboardActions:k,doneStreaming:!0,aiInferenceOverride:x,transaction:b}):L({environment:o,propertyId:A,propertySchema:s,storesWithCompletions:Object.values(r),blockIdToInferenceId:l,useTemporaryStore:!1,markdownLinkifyIt:d,tinyMceMicrosoftWordPasteFilter:C,clipboardActions:k,doneStreaming:!0,aiInferenceOverride:x})}finally{o.defaultRecordCache.inMemoryRecordCache.hasCacheOverride(H)&&o.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(H)}}}function G(e){const{environment:t,inferenceId:o,feedbackType:n,userContent:r,shareWithNotion:i}=e;m().NF(t,{type:"property_autofill",inference_id:o,feedback_type:n,timestamp:(new Date).toUTCString(),user_comment:r,share_with_notion:i})}async function Y(e){var t;let{environment:o,collectionStore:n,propertySchema:r,property:l,sessionIdForAnalytics:d}=e;if(!(0,i().qQ)(r))return;const p=(0,i().q3)(r);if(!n||!r||!p)return;const u=(null===(t=B().subscriptionDataStoreInstance.state)||void 0===t?void 0:t.addOns)??[];if(!(0,c().de)(u))return void W({environment:o,from:"ai_autofill_fill_all_pages"});const f=M().Z.getIntl(),y=(0,H().vU)({environment:o,intl:f,store:n});if(!(await h().r({sourceAction:"fill_all_pages",propertyName:r.name,collectionName:y})))return;m().qG(o,{type:"generate_from_fill_all_pages",inference_id:a().Il(),ai_inference_type:p.type,collection_id:n.id,session_id:d??a().Il()});const g=[];g.push(s().op.update({pointer:n.pointer,path:["format","update_ai_inferences_status"],args:{[l]:{type:"requested",created_time:Date.now()}}})),(0,I().H)({environment:o,collectionStore:n,performTransaction:e=>{for(const t of g)b().applyOperation({store:(0,Z().Kv)(n,t.pointer),operation:t,transaction:e})}})}function Q(e){const{environment:t,propertySchema:o,collectionStore:n,property:r,draftAiInference:l}=e;let a="";switch(o.type){case"text":a="ai_inference";break;case"select":case"multi_select":a="select_ai_inference";break;default:return}const s=[];if(s.push({pointer:n.pointer,command:"set",path:["schema",r,a],args:l}),l)m()._e(t,{type:"set_ai_inference",ai_inference_type:l.type,collection_id:n.id});else{const e=(0,i().q3)(o);m()._e(t,{type:"remove_ai_inference",ai_inference_type:null==e?void 0:e.type,collection_id:n.id})}(0,I().H)({environment:t,collectionStore:n,performTransaction:e=>{for(const t of s)b().applyOperation({store:(0,Z().Kv)(n,t.pointer),operation:t,transaction:e})}})}async function X(e){var t;let{environment:o,store:n,property:r,propertySchema:i,userEventForAnalytics:l,sessionIdForAnalytics:s}=e;const c=s||a().Il(),d=r,u={spaceId:n.getSpaceId(),...n.pointer,propertyId:d,inferenceId:a().Il()},f=n.getAssociatedCollectionId()??(null===(t=n.getCollectionStore())||void 0===t?void 0:t.id),g=J(i,!1);if(!g)return"";m().qG(o,{type:l,inference_id:u.inferenceId,ai_inference_type:g.type,collection_id:f,session_id:c});const h=a().Il();y().callApi({eventName:"publishAiSession",environment:o,data:{inference_type:"autofill",id:h,metadata:{blockPropertyPointers:[u],aiInference:g,collection_id:f}}});const S=await y().callStreamApi({eventName:"getCompletionForProperty",environment:o,data:{blockPropertyPointers:[u],aiInference:g,aiSessionId:h,model:"default"}});if("success"!==S.type)return"";let v="";if(p().H1.is(S.data))for await(const a of S.data)"error"!==a.type&&(v+=a.completion);return v}function J(e,t){if(!(0,i().qQ)(e))return;const o=(0,i().q3)(e);return!o&&(0,i().cu)(e)?{type:e.type,auto_update_on_edit:t,add_options:!1}:o}},705670:(e,t,o)=>{o.d(t,{l:()=>f});o(667294);var n=()=>o(219727),r=()=>o(846550),i=()=>o(367250),l=()=>o(788860),a=()=>o(154186),s=()=>o(654133),c=()=>o(514),d=()=>o(644248),p=()=>o(998901),u=o(785893);const m=(0,l().vU)({addDescriptionTooltip:{id:"database.description.addDescriptionTooltip",defaultMessage:"Add description"},editDescriptionTooltip:{id:"database.description.editDescriptionTooltip",defaultMessage:"Edit description"}});function f(e){let{onClick:t,description:o,showTooltip:f,addDescriptionText:y,editDescriptionText:g,disabled:h}=e;const{isMobile:S}=(0,n().Fy)(),[v,C]=(0,d().C)(),x=(0,l().YB)(),b=(0,r().yK)((e=>({button:{flexShrink:0,flexGrow:0,borderRadius:S?24:20,marginLeft:4},info:{width:S?18:16,height:S?18:16,fill:C&&!h?e.regularIconColor:e.mediumIconColor}})),[C,S,h]);return(0,u.jsx)(s().Z,{renderTooltip:e=>(0,u.jsx)("div",{...e,children:null!=o&&o.length?o:y??x.formatMessage(m.addDescriptionTooltip)}),disableTooltip:!f||h,style:c().F6,placement:p().Placement.Top,render:e=>(0,u.jsx)(a().Z,{...e,ref:v,onClick:t,"aria-label":null!=o&&o.length?y:g??x.formatMessage(m.editDescriptionTooltip),style:b.button,disabled:h,disabledFeedback:h,children:(0,i().N)(b.info)})})}},678523:(e,t,o)=>{o.d(t,{i:()=>m,k:()=>p});var n=o(667294),r=()=>o(219727),i=()=>o(846550),l=()=>o(788860),a=()=>o(740046),s=()=>o(388284),c=()=>o(514),d=o(785893);const p=(0,l().vU)({descriptionHeader:{id:"database.viewSettings.propertyTab.description.title",defaultMessage:"Description"},addDescription:{id:"database.viewSettings.propertyTab.description.addDescription",defaultMessage:"Add a description..."}}),u=60;function m(e){let{initialDescription:t,handleSaveDescription:o,disableAutoSection:m}=e;const[f,y]=(0,n.useState)(t??""),g=(0,n.useRef)(f),{isMobile:h}=(0,r().Fy)(),S=(0,l().YB)(),v=(0,i().yK)((e=>({title:{display:"flex",alignItems:"center",gap:4,cursor:"default",color:e.mediumTextColor},infoTooltip:{width:300,whiteSpace:"normal"},menuItem:{padding:h?"8px 0":"4px 0"},descriptionInput:{lineHeight:"20px",fontSize:h?14:13}})),[h]),C=(0,n.useCallback)((()=>o(g.current)),[o]);(0,n.useEffect)((()=>()=>C()),[C]);const x=(0,n.useMemo)((()=>(0,d.jsx)(a().ZP,{value:f,onChange:e=>{y(e.target.value),g.current=e.target.value},onBlur:C,onSubmit:C,placeholder:S.formatMessage(p.addDescription),focusInitial:!0,disabled:!1,style:v.menuItem,inputOuterStyle:v.descriptionInput,textarea:!0,textareaSubmitOnEnter:!0,maxlength:c().pT,autosize:!0,autosizeMaxHeight:u,showClearButton:!1})),[f,S,C,v.descriptionInput,v.menuItem]);return h&&!m?(0,d.jsx)(s().Z,{topBorder:!0,title:(0,d.jsx)("span",{style:v.title,children:S.formatMessage(p.descriptionHeader)}),children:x}):x}},96868:(e,t,o)=>{o.d(t,{I:()=>d});var n=o(667294),r=()=>o(142735),i=()=>o(762478),l=()=>o(740046),a=()=>o(95352),s=o(785893);const c=o(263184).default.createClass("",{name:"InputStore"}),d=n.forwardRef((function(e,t){const{placeholder:d,focusInitial:p,selectAll:u,disabled:m,inputOuterStyle:f,iconButton:y,inputRightButton:g,initialValue:h,onBlur:S,onSubmit:v,onChange:C,maxLength:x,textWrapperStyle:b,textarea:I}=e,_=(0,o(219727).O7)(),[A,w]=(0,n.useState)(h||""),k=(0,r().qz)(e.inputStore,c),P=(0,r().Kw)(k)||A,T=(0,n.useCallback)((()=>{S(P)}),[P,S]),j=(0,n.useCallback)((()=>{v(P)}),[P,v]),M=(0,n.useCallback)((e=>{const t=e.target.value;w(t),k&&k.setState(t),C&&C(t)}),[k,C]),H=(0,o(840521).g)();return(0,n.useEffect)((()=>{e.inputStore&&k.setState(h)}),[]),(0,n.useEffect)((()=>()=>{H.current&&h!==P&&S(P)}),[h,P,H,S]),(0,s.jsx)(l().ZP,{ref:t,focusInitial:p,selectAll:u,value:P,onChange:M,onBlur:T,onSubmit:j,placeholder:d,disabled:m,textWrapperStyle:{opacity:m?.4:void 0,...b},maxlength:x,inputOuterStyle:f,left:y&&(0,s.jsx)(l().DO,{icon:y.icon,iconStyle:y.iconStyle,onClick:e=>function(e,t,n){if(!(n&&e.target instanceof Element))return;const r=o(527278).Z.getIntl(),{onSubmit:l,enforceIconColor:s,includeEmojiTab:c}=n;i().$(t,{originRect:e.target.getBoundingClientRect(),originGap:3,popupHeight:a().DQ,popupWidth:a().rw,showArrow:!0,title:r.formatMessage({defaultMessage:"Icon",id:"mediaPicker.tabs.icon"}),currentTab:"icon",tabs:c?[{type:"emoji",onChange:(e,t)=>{l(e),t&&t.keepVisible||i().Z()}},{type:"icon",enforceIconColor:s,onChange:(e,t)=>{l(e),t&&t.keepVisible||i().Z()}}]:[{type:"icon",enforceIconColor:s,onChange:(e,t)=>{l(e),t&&t.keepVisible||i().Z()}}],onDelete:()=>{l(),i().Z()}})}(e,_,y),disabled:m,style:{opacity:m?.4:void 0},backgroundColor:y.backgroundColor}),showClearButton:!1,inputRight:g,textarea:I})}))},604185:(e,t,o)=>{o.d(t,{Z:()=>a});o(667294);var n=()=>o(788860),r=()=>o(568017),i=()=>o(67961),l=o(785893);function a(e){return(0,l.jsx)(i().Z,{isMultiline:!0,style:{paddingTop:8,marginLeft:16,marginRight:16,color:r().ZP.red,...e.styles},children:(0,l.jsx)(n()._H,{id:"database.viewSettings.propertyTab.duplicatePropertyNameError",defaultMessage:"A property named {propertyName} already exists in this database.",values:{propertyName:e.propertyName}})})}},73597:(e,t,o)=>{o.d(t,{A:()=>s,E:()=>c});var n=()=>o(250303),r=()=>o(984871),i=()=>o(501912),l=()=>o(435168),a=()=>o(269299);async function s(e){let{theme:t,collectionContextStore:o,environment:n,property:r,from:l,schema:a,onDeleteCompleted:s,...d}=e;await i().T({environment:n,collectionContextStore:o,property:r,handleDeleteAccept:async()=>{await c({collectionContextStore:o,environment:n,property:r,schema:a,from:l,...d}),null==s||s()},theme:t,from:l})}async function c(e){const{collectionContextStore:t,environment:o,property:i,schema:s,from:c,...d}=e,p=t.collectionStore();if(!p)return;const u=p.getSchema()[i];await a().createAndCommitAsync({environment:o,userAction:"TableHeaderCell.handleDeleteAccept",waitForServerCommit:!1,perform:async e=>{await r().yV({environment:o,collectionStore:p,schema:s,property:i,transaction:e}),d.updateFrozenColumn&&l().oz({environment:o,collectionContextStore:t,currentIndex:d.columnIndex,entrypoint:d.updateFrozenColumnEntrypoint,transaction:e,propertyAction:"delete"})}}),u&&n().y9({environment:o,collectionContextStore:t,property_type:u.type,from:c,property:i})}},267730:(e,t,o)=>{o.d(t,{e:()=>s});var n=o(667294),r=()=>o(142735),i=()=>o(360240),l=o(785893);const a=14,s=n.memo(n.forwardRef((function(e,t){let{collectionContextStore:s,property:c,iconTransformer:d=(e=>e),iconSize:p=a,getTitleOverride:u,...m}=e;const{isMobile:f}=(0,o(219727).Fy)(),y=(0,r().VK)((()=>s.collectionStore()),[s]),g=(0,r().VK)((()=>null==y?void 0:y.getDatabaseType()),[y]),h=(0,r().VK)((()=>Boolean(y&&g&&o(110232).cR((0,o(2971).appConfigs)(),g,c,y))),[y,g,c]),S=(0,n.useCallback)((e=>(0,i().A7)(g,e)),[g]),v=(0,n.useCallback)((e=>(0,l.jsx)(o(827973).Z,{...m,...e,disabled:h,disabledFeedback:h,title:(null==u?void 0:u({isRequiredProperty:h}))??(0,l.jsx)(o(788860)._H,{defaultMessage:"Delete property",id:"database.tableHeaderCell.deleteProperty"}),caption:f&&h?(0,i().A7)(g):null,icon:d(h?(0,l.jsx)("div",{...e,children:(0,o(667067).Q)({width:p})}):(0,o(95886).y)({width:p})),isRedOnHover:!0})),[g,u,p,d,f,h,m]);return(0,l.jsx)(o(654133).Z,{placement:o(998901).Placement.Left,disableTooltip:!h,renderTooltip:S,render:v})})))},490875:(e,t,o)=>{o.r(t),o.d(t,{TableHeaderCellMenu:()=>H});o(670560),o(267602),o(653476),o(470928),o(241792);var n=o(667294),r=()=>o(219727),i=()=>o(142735),l=()=>o(846550),a=()=>o(226413),s=()=>o(532850),c=()=>o(956057),d=()=>o(989478),p=()=>o(788860),u=()=>o(513670),m=()=>o(250303),f=()=>o(151861),y=()=>o(984871),g=()=>o(139224),h=()=>o(435168),S=()=>o(269299),v=()=>o(678523),C=()=>o(552009),x=()=>o(393308),b=()=>o(827973),I=()=>o(255577),_=()=>o(388284),A=()=>o(654133),w=()=>o(514),k=()=>o(982855),P=()=>o(352230),T=()=>o(164079),j=()=>o(998901),M=o(785893);const H=n.memo((function(e){const{allowHidingTitle:t,collectionContextStore:H,columnIndex:R,format:B,formatKey:D,parent:V,property:L,schema:N}=e,q=(0,p().YB)(),U=(0,r().O7)(),{isPhone:K,isMobile:z}=(0,r().Fy)(),W=(0,l().Fg)(),E=(0,i().VK)((()=>H.collectionStore()),[H]),$=(0,i().VK)((()=>H.collectionViewStore()),[H]),G=(0,i().VK)((()=>H.settingsStore),[H]),Y=(0,i().VK)((()=>null==E?void 0:E.isNonEditableState()),[E]),Q=(0,i().VK)((()=>null==E?void 0:E.getFormat()),[E]),X=(0,i().Kw)(H.permissionScopesStore),J=(0,i().Kw)(H.isInHomeWidgetStore),ee=(0,i().VK)((()=>null==$?void 0:$.getType()),[$]),te=(0,i().VK)((()=>"collectionTypedView"===H.contextType),[H]),oe=(0,i().VK)((()=>{const{frozenIndex:e}=H.frozoneStore.state;return Boolean(R===e)}),[H,R]),ne=(0,i().VK)((()=>{const{frozenIndex:e,scrollerWidth:t}=H.frozoneStore.state;if(void 0===e)return!1;const o=(null==$?void 0:$.getTableMaxFrozenColumnIndex(t,H.normalizedFormatStore.state))??-1;return R>o}),[H,$,R]),re=(0,i().VK)((()=>{var e;return!(!$||"timeline"===ee)&&Boolean($.getFormat().table_wrap||(null===(e=Z({format:B,formatKey:D,property:L}))||void 0===e?void 0:e.wrap))}),[$,B,D,L,ee]),ie=(0,n.useMemo)((()=>Q?o(109477).De(Q,L):null),[Q,L]),le=(0,i().VK)((()=>(null==ie?void 0:ie.isRunning)||!E||!(0,k().mX)(U,o(890324).Z.getMode(U,E),E)),[E,U,ie]),ae=(0,i().VK)((()=>(0,k().Zt)(U)),[U]),{isTypedProperty:se,databaseType:ce}=(0,i().VK)((()=>E?{isTypedProperty:E.isTypedProperty(L),databaseType:E.getDatabaseType()}:{isTypedProperty:!1,databaseType:void 0}),[E,L]),de=(0,i().qz)(void 0,o(529048).Z),pe=(0,i().VK)((()=>{const e=N[L];return o(129338).ny(H,e)}),[H,L,N]),[ue,me]=(0,n.useState)(!1),[fe,ye]=(0,n.useState)("");(0,n.useEffect)((()=>{const e=N[L];e&&ye(e.name||"")}),[L,N]),(0,n.useEffect)((()=>{const e=N[L];e&&"relation"===e.type&&(null==pe||pe.load())}),[L,N,pe]);const ge=(0,n.useCallback)((e=>{!function(e){const{collectionContextStore:t,environment:o,inputValue:n,name:r,property:i,schema:l}=e;if(O({property:i,schema:l,inputValue:n}))return;const a=t.collectionStore();if(!a)return;const s=a.getSchema(),c=s[i];if((null==c?void 0:c.name)===r)return;S().createAndCommit({userAction:"TableHeaderCell.handlePropertyNameSubmit",environment:o,canUndo:!0,perform:e=>{y().Bv({collectionStore:a,property:i,name:r,transaction:e})}}),m().$q({environment:o,collectionContextStore:t,property:i,from:"view_settings",action:"rename"})}({collectionContextStore:H,environment:U,inputValue:fe,name:e,property:L,schema:N})}),[H,U,fe,L,N]),he=(0,n.useCallback)((e=>{ye(e)}),[]),Se=(0,l().yK)((e=>({rightStyle:{display:"flex",alignItems:"center",color:e.lightTextColor,fill:e.lightIconColor,flexShrink:0},rightIconStyle:{width:12,fill:e.lightIconColor,marginLeft:6,transition:"transform 200ms ease-in-out"},rightIconRotatedStyle:{transform:"rotate(90deg)"}})),[]),ve=(0,i().VK)((()=>{const e=N[L];if(!$||!e)return[];const n=(0,o(15607).w)(L),r="title"===e.type,i=[];if(n&&"person"===e.type){const t=[];i.push(t),t.push({key:"synced_person",render:t=>(0,M.jsx)(o(18748).ZP,{...t,title:e.name||"",icon:(0,o(409873).D)({width:14}),caption:(0,M.jsx)("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",minWidth:300,maxWidth:350},children:(0,M.jsx)(p()._H,{defaultMessage:"People synced from external sources may require additional set up. Visit <helpcenterlink>the help center</helpcenterlink> for more information.",id:"database.tableHeaderCell.syncedPersonPropertyCaption",values:{helpcenterlink:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,M.jsx)(o(765513).Z,{href:(0,o(148126).UY)("guides.syncedContent"),children:t})}}})})}),action:()=>{}})}const l=[];if(i.push(l),!X.canConfigureCollection||n||X.isExternallyImportedAndSyncedCollection||(l.push({key:"rename",render:t=>(0,M.jsxs)(_().Z,{children:[(0,M.jsx)(o(96868).I,{...t,initialValue:e.name||"",placeholder:o(527278).Z.formatMessage(o(475692).Z.inputPlaceholder),focusInitial:!0,onChange:he,onBlur:ge,onSubmit:ge,iconButton:{icon:t=>(0,M.jsx)(o(766933).ZP,{type:e.type,icon:e.icon,size:16,theme:W,style:t}),iconStyle:{fill:o(890085).Lr[W.mode].gray},enforceIconColor:"gray",onSubmit:(e,t)=>function(e,t,o,n,r){const i=t.collectionStore();if(!i)return;S().createAndCommit({userAction:"TableHeaderCell.handlePropertyIconSubmit",environment:o,canUndo:!0,perform:t=>{y().OK({collectionStore:i,property:e,icon:n,transaction:t})}}),m().$q({environment:o,collectionContextStore:t,property:e,icon:n,from:"table",action:"change_icon"})}(L,H,U,e)},inputRightButton:(0,M.jsx)(o(705670).l,{description:e.description,showTooltip:!ue,onClick:()=>me(!ue),addDescriptionText:q.formatMessage(w().aB.addPropertyDescriptionTooltip),editDescriptionText:q.formatMessage(w().aB.editPropertyDescriptionTooltip)})}),O({property:L,schema:N,inputValue:fe})&&(0,M.jsx)(o(604185).Z,{propertyName:fe,styles:z?{paddingBottom:5,paddingLeft:16,paddingRight:16,margin:0,boxShadow:`inset 0 -1px 0 ${W.regularDividerColor}`}:{}})]}),action:()=>{m().wd({environment:U,collectionContextStore:H,action:"table_header_rename"}),(0,C().n)({collectionContextStore:H}),V.close()}}),ue&&l.push({key:"description",render:t=>(0,M.jsx)(_().Z,{...t,desktopStyle:{paddingTop:0},title:z?q.formatMessage(v().k.descriptionHeader):void 0,children:(0,M.jsx)(v().i,{initialDescription:e.description,handleSaveDescription:e=>function(e){var t;const{collectionContextStore:n,description:r,environment:i,property:l}=e,a=n.collectionStore(),s=null==a||null===(t=a.getSchema())||void 0===t?void 0:t[l];if(!a||void 0===s||r===s.description)return;S().createAndCommit({userAction:"CollectionSettingsProperty.handleDescriptionChange",environment:i,canUndo:!0,perform:e=>{(0,o(612427).x)({environment:i,collectionStore:a,update:{[l]:{...s,description:r}},transaction:e})}}),m().$q({environment:i,collectionContextStore:n,property:l,from:"view_properties",action:"set_description"})}({collectionContextStore:H,description:e,environment:U,property:L}),disableAutoSection:!0})}),action:u().ZT})),X.canConfigureBlock&&!n&&!Y&&!X.isExternallyImportedAndSyncedCollection)if((0,a().D1)(e)){const t=te||(0,s().sh)({property:L,propertySchema:e,isTypedProperty:se});l.push({key:"button_property_change_type",render:e=>(0,M.jsx)(A().Z,{placement:j().Placement.Left,render:n=>(0,M.jsx)("div",{...(0,T().Z)(e,n),role:"button",children:(0,M.jsx)(o(765458).yA,{disabled:t,isTypedProperty:se,collectionUri:ce,collectionContextStore:H,formatKey:D,propertyTypeButtonPopupStore:de,property:L})}),style:{whiteSpace:"normal"},renderTooltip:()=>(0,M.jsx)(p()._H,{defaultMessage:"Change property type",id:"database.tableHeaderCell.buttonPropertyChangeTypeTooltip"})}),action:()=>{V.close()}}),l.push({key:"button_property_edit_automation",render:e=>(0,M.jsx)(A().Z,{placement:j().Placement.Left,render:t=>(0,M.jsx)(b().Z,{title:(0,M.jsx)(p()._H,{defaultMessage:"Edit automation",id:"database.tableHeaderCell.buttonPropertyEditAutomationLeft"}),right:(0,M.jsx)("div",{style:Se.rightStyle,children:(0,o(429600).o)(Se.rightIconStyle)}),...(0,T().Z)(e,t)}),style:{whiteSpace:"normal"},renderTooltip:()=>(0,M.jsx)(p()._H,{defaultMessage:"Edit button automation",id:"database.tableHeaderCell.buttonPropertyTooltip"})}),action:()=>{V.close(),o(915687).b({environment:U,mode:"edit_button_property",collectionSettingsStore:G,collectionContextStore:H,propertyId:L,propertySchema:e})}})}else{const e=!X.canConfigureCollection;l.push({key:"edit_property",render:t=>(0,M.jsx)(A().Z,{placement:j().Placement.Left,render:n=>(0,M.jsx)(b().Z,{buttonStyle:{opacity:e?.5:1},disabled:e,title:(0,M.jsx)(p()._H,{defaultMessage:"Edit property",id:"database.tableHeaderCell.editProperty"}),icon:e?(0,o(443417).Y)({width:20,marginLeft:-4}):(0,o(199264).W)({width:14}),...(0,T().Z)(t,n)}),style:{whiteSpace:"normal"},renderTooltip:()=>e?(0,M.jsx)(p()._H,{defaultMessage:"You don't have permission to edit this property",id:"database.tableHeaderCell.editPropertyTooltipDisabled"}):(0,M.jsx)(p()._H,{defaultMessage:"Edit property name, type, and other options...",id:"database.tableHeaderCell.editPropertyTooltip"})}),action:()=>{m().wd({environment:U,collectionContextStore:H,action:"table_header_edit"}),(0,C().n)({collectionContextStore:H}),V.close(),g().r$({collectionContextStore:H,collectionSettingsStore:G}),g().H4({collectionSettingsStore:G,item:{type:"properties",timelineViewTab:"table"}}),g().H4({collectionSettingsStore:G,item:{type:"property",formatKey:D,property:L}})}})}if(X.canConfigureCollection&&!n&&!X.isExternallyImportedAndSyncedCollection&&E&&ie&&ae&&(0,a().qQ)(e)){(0,a().q3)(e)?l.push({key:"fill_all_pages",render:t=>(0,M.jsx)(A().Z,{placement:j().Placement.Left,renderTooltip:()=>(0,M.jsx)(x().qQ,{collectionStore:E,propertySchema:e}),render:e=>(0,M.jsx)(b().Z,{titleStyle:{color:le?W.lightTextColor:void 0},disabled:le,icon:(0,M.jsx)(x().Xh,{updateAiInferencesTaskStatus:ie,iconStyle:{marginLeft:-1,marginRight:-1},progressIconStyle:{marginTop:4,marginLeft:0,marginRight:-3}}),title:(0,M.jsx)(x().ZP,{updateAiInferencesTaskStatus:ie}),caption:void 0!==ie.numPagesFilled&&void 0!==ie.numPagesRequested&&(0,M.jsx)(x().Y7,{updateAiInferencesTaskStatus:ie}),...(0,T().Z)(t,e)})}),action:async()=>{await o(351763).autofillPropertyForCollection({environment:U,collectionStore:E,propertySchema:e,property:L})}}):l.push({key:"autofill_with_ai",render:e=>(0,M.jsx)(b().Z,{disabled:void 0===E,title:(0,M.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,M.jsx)(p()._H,{defaultMessage:"Set up AI autofill",id:"database.tableHeaderCell.autofillWithAI"}),(0,M.jsx)(o(663631).Z,{style:{display:"inline-block"}})]}),icon:(0,o(949489).y)({width:14,fill:W.aiPurpleColor}),...e}),action:()=>{E&&(V.close(),g().r$({collectionContextStore:H,collectionSettingsStore:G}),g().H4({collectionSettingsStore:G,item:{type:"properties",timelineViewTab:"table"}}),g().H4({collectionSettingsStore:G,item:{type:"property",formatKey:D,property:L}}),"text"===e.type&&g().H4({collectionSettingsStore:G,item:{type:"propertyAiAutofill",propertySchema:e,property:L}}))}})}if(X.canConfigureBlock&&((0,s().bA)(e)||(0,s().Kf)(e))){const t=[];i.push(t),(0,s().bA)(e)&&(t.push({key:"sort_asc",render:e=>(0,M.jsx)(b().Z,{...e,title:(0,M.jsx)(p()._H,{defaultMessage:"Sort ascending",id:"database.tableHeaderCell.sortAscending"}),icon:(0,o(214993).Z)({width:14})}),action:()=>{m().wd({environment:U,collectionContextStore:H,action:"table_header_sort_asc"}),V.close(),function(e){const{property:t,collectionContextStore:o,schema:n,environment:r}=e;F({collectionContextStore:o,environment:r,isAscending:!0,property:t,schema:n})}({collectionContextStore:H,environment:U,property:L,schema:N})}}),t.push({key:"sort_desc",render:e=>(0,M.jsx)(b().Z,{...e,title:(0,M.jsx)(p()._H,{defaultMessage:"Sort descending",id:"database.tableHeaderCell.sortDescending"}),icon:(0,o(682890).M)({width:14})}),action:()=>{m().wd({environment:U,collectionContextStore:H,action:"table_header_sort_desc"}),V.close(),function(e){const{property:t,collectionContextStore:o,schema:n,environment:r}=e;F({collectionContextStore:o,environment:r,isAscending:!1,property:t,schema:n})}({collectionContextStore:H,environment:U,property:L,schema:N})}})),(0,s().Kf)(e)&&t.push({key:"filter",render:e=>(0,M.jsx)(b().Z,{...e,title:(0,M.jsx)(p()._H,{defaultMessage:"Filter",id:"database.tableHeaderCell.filter"}),icon:(0,o(185056).Q)({width:14})}),action:()=>{"collectionSystemView"!==H.contextType&&(m().wd({environment:U,collectionContextStore:H,action:"table_header_filter"}),V.close(),function(e){const{collectionContextStore:t,environment:n,property:r,schema:i}=e,l=t.currentPropertyFiltersStore.state,a=t.collectionViewBlockStore(),s=(null==a?void 0:a.getRecordModel)??o(530980).omK.constant(void 0);let d=l.find((e=>{let{filter:t}=e;return t.property===r}));if(!d){const e=(0,o(576868).H_)({property:r,schema:i,getRecordModel:s});if(!e)return;const a={id:c().Il(),filter:e};t.filtersBarOpenStore.setState(!0),f().iU({environment:n,collectionContextStore:t,temporaryState:{...t.temporaryStateStore.state,propertyFilters:{value:[...l,a]}}}),d=a}if(!d)return;const p=t.isInHomeWidgetStore.state;if(p)return void g().wl({collectionSettingsStore:t.settingsStore,item:{type:"filters"}});t.filtersBarOpenStore.setState(!0);const u=t.getFilterBarItemSettingsStore(d);g().wl({collectionSettingsStore:u,item:{type:"filter"}}),(0,C().n)({collectionContextStore:t})}({collectionContextStore:H,environment:U,property:L,schema:N}))}})}const I=[];if(i.push(I),(t||"title"!==e.type)&&X.canConfigureBlock&&I.push({key:"hide",render:e=>(0,M.jsx)(b().Z,{...e,title:(0,M.jsx)(p()._H,{defaultMessage:"Hide in view",id:"database.tableHeaderCell.hideInView"}),icon:(0,o(259739).D)({width:22,marginLeft:-4,marginRight:-4})}),action:()=>{m().wd({environment:U,collectionContextStore:H,action:"table_header_hide"}),V.close(),function(e){const{collectionContextStore:t,columnIndex:n,environment:r,format:i,formatKey:l,property:a}=e,s=t.collectionViewStore();if(!s)return;const c=i[l]||[],d=c.map((e=>e.property===a?{...e,visible:!1}:e)),p={...i,[l]:d};S().createAndCommit({userAction:"TableHeaderCell.updatePropertyFormat",environment:r,canUndo:!0,perform:e=>{(0,o(757216).i)({collectionViewStore:s,update:{format:p},transaction:e}),h().oz({environment:r,collectionContextStore:t,currentIndex:n,entrypoint:"TableHeaderCell",transaction:e,propertyAction:"hide"})}})}({collectionContextStore:H,columnIndex:R,environment:U,format:B,formatKey:D,property:L})}}),!X.canConfigureBlock||J||K||I.push({key:"freeze_column",render:e=>(0,M.jsx)(A().Z,{placement:j().Placement.Left,disableTooltip:!ne,renderTooltip:e=>(0,M.jsx)(p()._H,{...e,defaultMessage:"Insufficient space to freeze columns",id:"database.tableHeaderCell.freezePropertyTooltip",description:"If the width of the frozen columns is wider than the screen, show the user this tooltip warning."}),render:t=>(0,M.jsx)(b().Z,{...e,...t,disabled:ne,buttonStyle:{color:ne?W.text.quaternary:void 0},title:oe?(0,M.jsx)(p()._H,{defaultMessage:"{numberFrozenColumns, plural, one {Unfreeze column} other {Unfreeze columns}}",values:{numberFrozenColumns:R+1},id:"database.tableHeaderCell.unfreezeColumns"}):(0,M.jsx)(p()._H,{defaultMessage:"Freeze up to column",id:"database.tableHeaderCell.freezeUpToColumn"}),icon:oe?(0,o(233687).A)({width:14}):(0,o(179633).P)({width:12,margin:"0px 1px"})})}),action:()=>{!function(e){const{collectionContextStore:t,columnIndex:o,environment:n}=e;S().createAndCommit({userAction:"TableHeaderCell.handleFreezeColumns",environment:n,canUndo:!0,perform:e=>{h().oz({environment:n,collectionContextStore:t,currentIndex:o,transaction:e,entrypoint:"TableHeaderCell",propertyAction:"toggle"})}})}({collectionContextStore:H,columnIndex:R,environment:U})}}),!(0,a().g0)(e)||!X.canConfigureCollection||n||r||X.isExternallyImportedAndSyncedCollection||I.push({key:"duplicate",render:e=>(0,M.jsx)(b().Z,{...e,title:(0,M.jsx)(p()._H,{defaultMessage:"Duplicate property",id:"database.tableHeaderCell.duplicateProperty"}),icon:(0,o(44037).a)({width:14})}),action:async()=>{m().wd({environment:U,collectionContextStore:H,action:"table_header_duplicate"}),V.close(),await async function(e){const{collectionContextStore:t,columnIndex:n,environment:r,format:i,formatKey:l,property:a}=e,s=Z({format:i,formatKey:l,property:a}),c=t.collectionStore(),p=t.collectionViewStore(),u=t.normalizedFormatStore.state[l]||[],f=null==c?void 0:c.getSpaceId();if(!(c&&p&&f&&s))return;const y=c.getSchema(),g=y[a];if(!g)return;const v=c.getNormalizedPropertyGroups(),C=await(0,o(887430).xy)({environment:r,schema:y,property:a,properties:u,propertyGroups:v,parentStore:c,spaceId:f});if(!C)return;const x=r.currentUser.id,b=x?{id:x,table:d().KJ}:void 0,{automationActions:I}=await o(285755).Sm.automations.load(),_={...y,[C.newProperty]:C.newPropertySchema},A=c.getFormat(),w={...A,collection_page_properties:C.newProperties,property_groups:C.newPropertyGroups};S().createAndCommit({userAction:"TableHeaderCell.handleDuplicate",environment:r,canUndo:!0,perform:e=>{(0,o(518645).R)({environment:r,collectionStore:c,update:{schema:_,format:w},transaction:e}),h().oz({environment:r,collectionContextStore:t,currentIndex:n,entrypoint:"TableHeaderCell",transaction:e,propertyAction:"duplicate"}),(0,o(696459).$K)(C.automationUpdate)&&I.duplicateAutomation({actorPointer:b,environment:r,sourceAutomationStore:C.automationUpdate.sourceAutomationStore,targetAutomationId:C.automationUpdate.targetAutomationId,transaction:e}),l&&o(421654).FH({stores:[p],update:{[l]:C.newProperties},transaction:e})}}),m().wd({environment:r,collectionContextStore:t,action:"duplicate_property",original_view_type:null==p?void 0:p.getType(),property_type:g.type})}({collectionContextStore:H,columnIndex:R,environment:U,format:B,formatKey:D,property:L})}}),!a().Tr.includes(e.type)||!X.canConfigureCollection||n||r||X.isExternallyImportedAndSyncedCollection||I.push({key:"delete",render:e=>(0,M.jsx)(o(267730).e,{...e,property:L,collectionContextStore:H}),action:async()=>{V.close(),await(0,o(73597).A)({collectionContextStore:H,columnIndex:R,updateFrozenColumnEntrypoint:"TableHeaderCell",updateFrozenColumn:!0,environment:U,property:L,schema:N,theme:W,from:"table_column"})}}),X.canConfigureBlock&&"timeline"!==ee){const e=[];i.push(e),e.push({key:"wrap_cell",render:e=>(0,M.jsx)(o(667637).Z,{...e,title:(0,M.jsx)(p()._H,{defaultMessage:"Wrap column",id:"database.tableHeaderCell.wrapColumn"}),on:re}),action:()=>{h().K4({currentValue:re,environment:U,property:L,collectionViewStore:$,format:B,formatKey:D}),m().wd({environment:U,collectionContextStore:H,action:"table_header_wrap_column"})}})}return i}),[t,de,ne,H,G,E,$,R,ce,U,B,D,he,ge,fe,q,le,ae,J,z,te,Y,K,oe,se,V,X.canConfigureBlock,X.canConfigureCollection,X.isExternallyImportedAndSyncedCollection,L,N,ue,Se.rightIconStyle,Se.rightStyle,ie,W,ee,re]),Ce=(0,n.useMemo)((()=>u().oA(ve.map(((e,t)=>{if(e.length>0)return{key:t,render:e=>(0,M.jsx)(_().Z,{...e,topBorder:0!==t}),items:e}})))),[ve]);return(0,M.jsx)(o(198829).Z,{menuType:z?P().o.ActionSheet:P().o.Popup,minWidth:z?void 0:220,children:(0,M.jsx)(I().ZP,{type:I().iW.Vertical,initialFocus:void 0,sections:Ce})})}));function F(e){const{collectionContextStore:t,environment:o,isAscending:n,property:r,schema:i}=e;if(!i[r])return;const l=[{property:r,direction:n?"ascending":"descending"}];t.filtersBarOpenStore.setState(!0),f().iU({environment:o,collectionContextStore:t,temporaryState:{...t.temporaryStateStore.state,sorts:{value:l}}}),(0,C().n)({collectionContextStore:t})}function Z(e){var t;const{format:o,formatKey:n,property:r}=e;return null===(t=o[n])||void 0===t?void 0:t.find((e=>e.property===r))}function O(e){const{inputValue:t,property:o,schema:n}=e,r=Object.keys(n).find((e=>{var r;return e!==o&&(null===(r=n[e])||void 0===r?void 0:r.name)===t}));return Boolean(r)}},552009:(e,t,o)=>{o.d(t,{n:()=>i});var n=()=>o(275200),r=()=>o(472753);function i(e){const{collectionContextStore:t}=e,o=t.collectionViewBlockStore();if(o){const e=r().R.findCollectionViewBlockFromStore(o);if(e){const t=e.getNode();t&&(0,n().Wr)(t,{edgeDist:0,animate:!1})}}}},95352:(e,t,o)=>{o.d(t,{DQ:()=>ee,rw:()=>te,OF:()=>G,L6:()=>Y,$1:()=>re});o(670560),o(267602),o(653476),o(241792);var n=o(667294),r=()=>o(219727),i=()=>o(732811),l=()=>o(142735),a=()=>o(846550),s=()=>o(659278),c=()=>o(801812),d=()=>o(245015),p=()=>o(788860),u=()=>o(568017),m=()=>o(513670),f=()=>o(707513),y=()=>o(571896),g=()=>o(150569),h=()=>o(709344),S=()=>o(527278),v=()=>o(876822),C=()=>o(808985),x=()=>o(692304),b=()=>o(178498),I=()=>o(312578),_=()=>o(255577),A=()=>o(906769),w=()=>o(388284),k=()=>o(890085),P=()=>o(164079),T=()=>o(529048),j=()=>o(154186),M=()=>o(448419),H=()=>o(206352),F=()=>o(94967),Z=()=>o(654133),O=o(785893);function R(e){let{shouldOpenVariations:t,icon:o,focused:n,color:r,onClick:i,onMouseEnter:a,variations:s,hideTooltip:c,insertIcon:d}=e;const p=(0,l().qz)(void 0,T().Z);return t?(0,O.jsx)(q,{icon:o,focused:n,color:r,onClick:i,onMouseEnter:a,variations:s,hideTooltip:c,insertIcon:d,buttonPopupStore:p}):(0,O.jsx)(L,{icon:o,focused:n,color:r,onClick:i,onMouseEnter:a,variations:s,hideTooltip:c})}const B=R;function D(e){const{device:t}=e;return t.isMobile?{width:g().mz,height:g().mz,fontSize:g().jo}:{width:g().T8,height:g().T8,fontSize:g().WB}}function V(e){return{iconButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,...D(e)},variationMenu:{display:"flex",padding:2,gap:1},iconImage:{...e.device.isMobile?{width:g().jo,height:g().jo}:{width:g().WB,height:g().WB}}}}function L(e){let{events:t,icon:o,focused:n,color:i,onClick:l,onMouseEnter:s,variations:c,hideTooltip:d}=e;const p=(0,a().Fg)(),u=(0,r().O7)(),m=c.tooltip?c.tooltip:o,f="dark"===p.mode?c.dark:c.light;return(0,O.jsx)(Z().Z,{allowHover:Boolean(o&&!d),disableTooltip:d,renderTooltip:()=>m.replaceAll("-"," ").replaceAll("_"," "),closeDelay:0,render:e=>(0,O.jsx)(j().Z,{focused:n,onClick:l,...(0,P().Z)(t||{},(0,P().Z)({onMouseEnter:s},e)),ignoreLocalHoverState:!0,style:V(u).iconButton,children:(0,O.jsx)("img",{src:`data:image/svg+xml;utf8,${encodeURIComponent(f[i])}`,style:V(u).iconImage,onContextMenu:e=>e.preventDefault()})},o)})}function N(e){const{parent:t,icon:o,variations:n,insertIcon:i}=e,l=(0,a().Fg)(),s=(0,r().O7)(),c="dark"===l.mode?n.light:n.dark,d=Object.keys(c).sort(((e,t)=>k().Oe.indexOf(e)-k().Oe.indexOf(t))).map((r=>{const l=`${o}_${r}`;return{key:l,action:e=>{t.close(),i(`/icons/${l}.svg`)},render:t=>(0,O.jsx)(R,{...e,...t,icon:l,color:r,variations:n,shouldOpenVariations:!1,hideTooltip:!0})}}));return(0,O.jsx)(H().Z,{debugName:"IconPickerMenuItem",capture:!0,allowEsc:!0,children:(0,O.jsx)(_().ZP,{type:_().iW.Grid,getItemsPerRowForSection:()=>5,initialFocus:0,sections:[{key:"variations",render:e=>(0,O.jsx)("div",{...e}),items:d}],renderRow:(e,t)=>(0,O.jsx)("div",{style:V(s).variationMenu,children:e},t)})})}function q(e){let{icon:t,focused:o,color:r,onClick:i,onMouseEnter:l,variations:a,hideTooltip:s,insertIcon:c,buttonPopupStore:d}=e;const p=(0,n.useCallback)((()=>function(e){e.setState({...e.state,open:!1})}(d)),[d]),u=(0,n.useCallback)((e=>function(e,t){e.preventDefault(),t.setState({...t.state,open:!0})}(e,d)),[d]);return(0,O.jsx)(F().Z,{debugName:"IconPickerMenuItem",capture:o,onEnter:u,children:(0,O.jsx)(M().ZP,{buttonPopupStore:d,popupType:M().Z4.Popup,renderOrigin:e=>(0,O.jsx)(L,{icon:t,focused:o,color:r,onClick:i,onMouseEnter:l,variations:a,hideTooltip:s,events:e}),render:e=>(0,O.jsx)(F().Z,{debugName:"IconPickerMenuItem.VariationMenuComponent",capture:o,onEsc:p,children:(0,O.jsx)(N,{parent:e,icon:t,variations:a,insertIcon:c})})})},t)}const U={display:"flex",flexDirection:"column"},K="recentIcons",z=100,W=12,E=g().tg,$=g().Nm,G=g().II,Y=g().pq,Q=g().$P,X=g().qJ,J=g().PS,ee=356,te=g().T8*W+2*J,oe=g().vP,ne=(0,p().vU)({noResults:{defaultMessage:"No results",id:"emojiPicker.noResults.message"}});function re(e){const{filter:t,enforceIconColor:o,onSubmit:u,menuRef:k,iconLoggingData:P,onNoResults:T}=e,j=(0,r().O7)(),M=(0,a().Fg)(),{isDesktop:H,isMobile:F}=(0,r().Fy)(),[Z,R]=(0,n.useState)(!0),[D,V]=(0,n.useState)(void 0),{loadIconCount:L,recentIcons:N}=(0,l().Kw)(C().default),q=(0,l().qz)(void 0,x().Z),ee=(0,l().VK)((()=>{var e;return null===(e=v().default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.icon_picker_color}),[]),te=(0,l().VK)((()=>Math.floor(function(e,t){var o,n;const{device:r,WindowSizeStore:i}=e;if(r.isPhone)return(window.innerWidth-i.getSafePaddingLeftPx(Q)-i.getSafePaddingRightPx(X))/g().mz;if(r.isTablet)return E;if(null==t||null===(o=t.current)||void 0===o||!o.offsetWidth)return W;return((null==t||null===(n=t.current)||void 0===n?void 0:n.offsetWidth)-2*J)/g().T8}(j,k))),[j,k]),oe=(0,l().VK)((()=>function(e){return e.device.isMobile?Y:G}(j)),[j]);(0,i().K)((()=>{const e=d().Z.get(K);C().default.update((t=>({...t,recentIcons:e||[]})))}));const[re]=(0,c().r5)((async()=>{try{const e=await async function(e,t,o){if(!m().xb(o.allIcons))return o.allIcons;const n=await(0,h().default)({environment:t,url:e,method:"GET",format:"json",mode:"cors"});if("success"===n.type)return C().default.setState({...o,allIcons:n.data}),n.data;throw n.error}("/icons/all",j,C().default.state);V(e),R(!1)}catch(e){throw e}}),[j]),le=(0,n.useMemo)((()=>s().rJ(e.filter)??""),[e.filter]),ae=(0,n.useCallback)((e=>{const t=function(e){return e.replace("_dark","")}(e);u(t);const o=t.split(/[/_.]/),n=o[2],r=o[3];!function(e,t){const o=d().Z.get(K),n=m().G0([e],o),r=m().qn(n,t);d().Z.set(K,r),C().default.update((e=>({...e,recentIcons:r})))}(n,te*$),P&&y().fA(j,"pick_colored_icon",{icon:n,color:r,...P})}),[j,u,P,te]),se=(0,n.useCallback)(((e,t)=>{const n=o??ee,r=`/icons/${`${e}${n?`_${n}`:""}`}.svg`;return{key:r,action:()=>ae(r),render:o=>(0,O.jsx)(B,{...o,icon:e,color:n??"gray",variations:t,insertIcon:ae,shouldOpenVariations:!Boolean(n)})}}),[o,ae,ee]),ce=(0,n.useCallback)((e=>{if(!e)return[];const o=function(e,t){const o=m().oA(Object.keys(e).map((o=>{const n=e[o],r=((null==n?void 0:n.tooltip)??o).replace("-"," "),i=[r,...n.tags],l=i.findIndex((e=>e===t));if(-1!==l)return[0===l?100:50,o];const a=i.findIndex((e=>e.startsWith(t))),s=r.includes(t);return 0!==a&&s?[40,o]:-1!==a?[0===a?80:30,o]:void 0})));return m().MR(o,(e=>-e[0])).map((e=>e[1]))}(e,t.toLowerCase());return 0===o.length?[]:[{key:"search-results",items:o.map((t=>se(t,e[t]))),render:e=>(0,O.jsx)(w().Z,{children:(0,O.jsx)("div",{style:ie(j,M),children:e.children})},e.key)}]}),[t,se,j,M]),de=(0,n.useCallback)(((e,t)=>{if(!t)return;let o=[];return o="recent"===e.id?N||[]:Object.keys(t),0!==o.length?{key:e.id,items:o.map((e=>{if(void 0!==t[e])return se(e,t[e])})).filter(Boolean),render:t=>(0,O.jsx)(w().Z,{isTitleUppercase:!0,title:e.title,children:(0,O.jsx)("div",{style:ie(j,M),children:t.children})},t.key)}:void 0}),[N,se,j,M]),pe=(0,n.useCallback)((e=>{const o=m().oA(function(e){return m().oA([!e&&{id:"recent",title:(0,O.jsx)(p()._H,{id:"iconPicker.section.recent",defaultMessage:"Recent"})},!e&&{id:"icons",title:(0,O.jsx)(p()._H,{id:"iconPicker.section.icons",defaultMessage:"Icons"})}])}(t).map((t=>de(t,e))));return t&&le?ce(e):o}),[t,le,de,ce]),ue=(0,n.useCallback)((e=>{const t=pe(e);let o=0;for(const n of t)o+=n.items.length;return o}),[pe]),me=(0,n.useCallback)((e=>{let t=L;0===L&&(t+=te*oe);const o=[],n=pe(e);let r=0;for(const i of n){if(!(r+i.items.length<=t)){o.push({...i,items:i.items.slice(0,t-r)});break}o.push(i),r+=i.items.length}return o}),[pe,L,te,oe]),fe=(0,n.useMemo)((()=>({type:_().iW.Grid,getItemsPerRowForSection:()=>te,renderRow:(e,t)=>(0,O.jsx)("div",{style:{display:"flex"},children:e},t)})),[te]),ye=(0,n.useCallback)((e=>{if(Math.abs(e)<z){const{loadIconCount:e,allIcons:t}=C().default.state,o=te*oe,n=Math.max(o,ue(t));C().default.setState({...C().default.state,loadIconCount:Math.min(n,e+o)})}}),[oe,te,ue]),ge=(0,n.useMemo)((()=>{const e=me(D),t=H&&e.length>0?0:void 0;return"resolved"===re.status&&0===e.length&&(T&&T(),e.push({key:"no results",items:[{key:"no results",action:m().ZT,render:e=>(0,O.jsx)(b().Z,{...e,style:{fontWeight:f().Ue.medium,marginBottom:2,marginLeft:2,height:20,boxSizing:"content-box"},caption:S().Z.formatMessage(ne.noResults)})}],render:e=>(0,O.jsx)(w().Z,{...e})})),(0,O.jsxs)("div",{style:U,children:[(0,O.jsx)("div",{style:{flexGrow:1},children:(0,O.jsx)(_().ZP,{...fe,store:q,initialFocus:t,sections:e,disableKeyboardArrowWrap:!0,unfocusOnScroll:F})}),(0,O.jsx)(A().Z,{onChange:ye})]})}),[me,D,H,fe,q,F,ye,re.status,T]);return(0,O.jsxs)("div",{children:[Z&&(0,O.jsx)("div",{style:{display:"flex",width:"100%",height:"100%",justifyContent:"center",alignItems:"center",paddingBottom:"10px"},children:(0,O.jsx)(I().Z,{})}),ge]})}function ie(e,t){const{device:o,WindowSizeStore:n}=e;return{display:"flex",flexDirection:"column",flexWrap:"wrap",alignItems:"flex-start",...o.isPhone?{background:t.popoverBackground,paddingTop:10,paddingBottom:10,paddingLeft:n.getSafePaddingLeftCSS(Q),paddingRight:n.getSafePaddingLeftCSS(X),boxShadow:`0 1px 0 ${t.regularDividerColor}`,marginBottom:1}:{background:u().ZP.transparent,paddingLeft:o.isTablet?oe:J,paddingRight:o.isTablet?oe:J}}}},393308:(e,t,o)=>{o.d(t,{TB:()=>b,Xh:()=>v,Y7:()=>x,ZP:()=>C,qQ:()=>S});var n=o(667294),r=()=>o(142735),i=()=>o(846550),l=()=>o(109477),a=()=>o(949489),s=()=>o(996106),c=()=>o(255393),d=()=>o(788860),p=()=>o(351763),u=()=>o(446955),m=()=>o(641702),f=()=>o(897257),y=()=>o(292518),g=()=>o(654133),h=o(785893);function S(e){let{collectionStore:t,propertySchema:o}=e;const n=(0,r().VK)((()=>(0,m().Xh)(t.getName(),t)),[t]),i=(0,r().VK)((()=>{var e;const t=(null===(e=f().subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return(0,c().de)(t)}),[]);return(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{color:"white",fontWeight:500,wordWrap:"break-word",whiteSpace:"pre-wrap"},children:(0,h.jsx)(d()._H,{...p().fillAllPagesMessages.fillAllPagesTooltip,values:{hasNames:Boolean(n)&&Boolean(o.name),collectionName:n,propertyName:o.name}})}),!i&&(0,h.jsx)("div",{style:{color:"#ACABA9",fontWeight:500},children:(0,h.jsx)(d()._H,{...p().fillAllPagesMessages.fillAllPagesAddOnMessage})})]})}function v(e){let{updateAiInferencesTaskStatus:t,iconStyle:o,progressIconStyle:n}=e;const r=(0,i().Fg)();return t.isRunning?(0,h.jsx)("div",{style:n,children:(0,h.jsx)(y().Z,{})}):(0,a().y)({width:14,color:r.accentColors.purple[400],...o})}function C(e){let{updateAiInferencesTaskStatus:t,style:o}=e;const n=(0,d().YB)();return(0,h.jsx)("div",{style:o,children:t.isRunning?(0,h.jsx)("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:void 0===t.numPagesFilled||void 0===t.numPagesRequested?(0,h.jsx)(d()._H,{defaultMessage:"Autofilling all pages",id:"aiAutofill.fillallPages.updatingAllPages"}):(0,h.jsx)(d()._H,{defaultMessage:"{numPagesRequested, plural, one {Autofilling {numPagesFilled} of {numPagesRequested} page} other {Updating {numPagesFilled} of {numPagesRequested} pages}}",id:"aiAutofill.fillallPages.updatingAllPagesWithProgress",values:{numPagesFilled:(0,s().uf)(t.numPagesFilled,"compact",n),numPagesRequested:(0,s().uf)(t.numPagesRequested,"compact",n)}})}):(0,h.jsx)(d()._H,{defaultMessage:"Autofill all pages",id:"aiAutofill.fillAllPages.buttonTitle"})})}function x(e){let{updateAiInferencesTaskStatus:t}=e;const{numPagesFilled:o,numPagesRequested:n}={numPagesFilled:void 0,numPagesRequested:void 0,...t},r=(0,i().yK)((e=>({inner:{background:e.accentColors.purple[400],height:"100%",transition:"width .5s"},outer:{background:e.accentColors.gray[100],height:3,borderRadius:2,minWidth:120,overflow:"hidden",marginTop:8}})),[]);return void 0===o||void 0===n?null:(0,h.jsx)("div",{style:r.outer,role:"progressbar",children:(0,h.jsx)("div",{style:{...r.inner,width:100*Math.min(o/n,1)+"%"}})})}function b(e){const{environment:t,collectionContextStore:o,collectionStore:i,property:a,propertySchema:s,doesUserHaveAIAddOn:c,isAutofillSetupEnabled:d}=e,m=(0,r().VK)((()=>{const e=o.collectionStore();return e?(0,l().De)(e.getFormat(),a):{isRunning:!1,numPagesFilled:void 0,numPagesRequested:void 0}}),[o,a]),f=(0,n.useCallback)((async()=>{const e=o.collectionStore();e&&s&&await p().autofillPropertyForCollection({environment:t,collectionStore:e,propertySchema:s,property:a})}),[t,s,a,o]);return(0,h.jsx)(g().Z,{disableTooltip:c,renderTooltip:()=>(0,h.jsx)(S,{collectionStore:i,propertySchema:s}),render:e=>(0,h.jsx)(u().Z,{icon:e=>(0,h.jsx)(v,{updateAiInferencesTaskStatus:m,iconStyle:e,progressIconStyle:{marginTop:4,marginLeft:4,marginRight:2}}),title:(0,h.jsx)(C,{updateAiInferencesTaskStatus:m}),caption:void 0!==m.numPagesFilled&&void 0!==m.numPagesRequested&&(0,h.jsx)(x,{updateAiInferencesTaskStatus:m}),focused:!1,onClick:f,disabled:m.isRunning||!d,...e})})}},974442:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o(263184).default.createValue({open:!1},{name:"ConfirmOverwriteModalStore"})},808985:(e,t,o)=>{o.d(t,{default:()=>r});class n extends(()=>o(263184))().default{getInitialState(){return{allIcons:{},recentIcons:[],loadIconCount:0}}}const r=new n},688745:(e,t,o)=>{o.d(t,{D5:()=>A,Ym:()=>_,cP:()=>I});o(821057),o(267602),o(916054),o(653476),o(241792),o(667294);var n=()=>o(146947),r=()=>o(780741),i=()=>o(481529),l=()=>o(494616),a=()=>o(396136),s=()=>o(752778),c=()=>o(139978),d=()=>o(483791),p=()=>o(212360),u=()=>o(788860),m=()=>o(513670),f=()=>o(696459),y=()=>o(250303),g=()=>o(984871),h=()=>o(308186),S=()=>o(269299),v=()=>o(90065),C=()=>o(826955),x=()=>o(382474),b=o(785893);function I(e){let{transaction:t,collectionStore:o,templateId:n,instance:r,logger:u}=e;u.debug(`Creating/updating ${p().qB} record for "${n}".`);const m=o.getSpaceId(),y=r.id;if("automation"===r.type){const e={table:l().cv,id:y,spaceId:m};S().applyOperation({store:C().Mz.createChildStore(o,e),operation:i().op.set({pointer:e,path:["properties","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("block"===r.type){const e={table:a().iU,id:y,spaceId:m};S().applyOperation({store:C().G.createChildStore(o,e),operation:i().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("collection"===r.type){const e={table:s().vF,id:y,spaceId:m};S().applyOperation({store:o,operation:i().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("collection_view"===r.type){const e={table:c().np,id:y,spaceId:m};S().applyOperation({store:C().Xr.createChildStore(o,e),operation:i().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("layout"===r.type){const e={table:d().Bh,id:y,spaceId:m};S().applyOperation({store:C().xj.createChildStore(o,e),operation:i().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("compound"===r.type){if(r.instancePointers.length<2)throw new Error(`Compound template instance ${r.id} must contain 2 or more instances`);const e=r.instancePointers.map((e=>{switch(e.type){case"automation":return{type:"automation",id:e.id};case"block":return{type:"block",id:e.id};case"collection_view":return{type:"collection_view",id:e.id};case"layout":return{type:"layout",id:e.id};case"property":return{type:"property",id:e.id}}(0,f().t1)(e)}));S().applyOperation({store:o,operation:{command:"keyedObjectListUpdate",pointer:o.pointer,path:["format","compound_workflow_template_instances"],args:{value:{template_id:n,id:r.id,instance_pointers:e}}},transaction:t})}else"property"===r.type?S().applyOperation({store:o,operation:i().op.update({pointer:o.pointer,path:["schema",r.id],args:{workflow_template_instance:{template_id:n}}}),transaction:t}):(0,f().t1)(r)}function _(e){let{environment:t,collectionStore:o,propertyId:n,compoundTemplateInstancesToDelete:i,collectionContextStore:l,from:a}=e;if(!i.every((e=>e.templateId===r()._5)))return!1;if(!(0,v().tj)())return!1;const s=(0,x().OA)({environment:t,collectionStore:o,compoundTemplateInstancesToDelete:i}),c=m().jj(s.filter((e=>"property"===e.type&&e.id!==n)).map((e=>e.id)));return w({environment:t,collectionStore:o,clickedPropertyId:n,otherPropertyIds:c,collectionContextStore:l,from:a}),!0}function A(e){let{environment:t,collectionStore:o,propertyId:n,collectionContextStore:r,from:i}=e;const l=o.getSchema(),a=Object.keys(l).filter((e=>e!==n&&((0,v().TJ)({collectionStore:o,propertyId:e})||(0,v().e_)(e))));return w({environment:t,collectionStore:o,clickedPropertyId:n,otherPropertyIds:a,collectionContextStore:r,from:i}),!0}function w(e){var t;let{environment:o,collectionStore:r,clickedPropertyId:i,otherPropertyIds:l,collectionContextStore:a,from:s}=e;const c=[i,...l],d=[{label:(0,b.jsx)(u()._H,{id:"workflowTemplateInstanceActions.deleteRequiredProperty.deleteOption",defaultMessage:"{count, plural, one {Delete {count} property} other {Delete {count} properties}}",values:{count:c.length}}),color:"red",onAccept:()=>function(e){let{environment:t,collectionStore:o,collectionContextStore:n,propertyIds:r,from:i}=e;S().createAndCommit({userAction:"workflowTemplateInstanceActions.handleDeleteAccept",environment:t,canUndo:!0,perform:e=>{const l=o.getSchema();for(const a of r){g().E2({environment:t,collectionStore:o,schema:l,property:a,transaction:e});const r=l[a];r&&y().y9({environment:t,collectionContextStore:n,property_type:r.type,from:i,property:a})}}})}({environment:o,collectionStore:r,collectionContextStore:a,propertyIds:c,from:s})}],p=r.getSchema(),m=l.map((e=>{if(e===i)return;const t=p[e];return null==t?void 0:t.name})).filter(f().$K),v=null===(t=p[i])||void 0===t?void 0:t.name,C=new Intl.ListFormat(n().locale,{style:"long",type:"conjunction"}),x=(0,b.jsx)(u()._H,{id:"workflowTemplateInstanceActions.deleteRequiredProperty.deletePropertyFromDb",defaultMessage:"{hasPropertyName, select, true {Delete {propertyName} from this database? This will also delete the following properties: {otherPropertyNames}} other {Delete this property from this database? This will also delete the following properties: {otherPropertyNames}}}",values:{hasPropertyName:Boolean(v),propertyName:v,otherPropertyNames:C.format(m)}});h().vC({message:(0,b.jsx)("span",{children:x}),showCancel:!0,keepFocus:!0,innerStyle:{width:400},items:d})}},214993:(e,t,o)=>{o.d(t,{Z:()=>r});o(667294);var n=o(785893);const r=(0,o(827282).IU)("arrowUp",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M8 14.5586C8.44434 14.5586 8.74512 14.251 8.74512 13.7998V5.30957L8.69043 3.83984L10.4951 5.84961L12.0469 7.38086C12.1836 7.51074 12.3682 7.59961 12.5801 7.59961C12.9902 7.59961 13.291 7.28516 13.291 6.86816C13.291 6.66992 13.2158 6.49219 13.0586 6.32812L8.55371 1.81641C8.40332 1.66602 8.20508 1.57715 8 1.57715C7.79492 1.57715 7.59668 1.66602 7.44629 1.81641L2.94141 6.32812C2.78418 6.49219 2.70898 6.66992 2.70898 6.86816C2.70898 7.28516 3.0166 7.59961 3.42676 7.59961C3.63184 7.59961 3.82324 7.51074 3.95312 7.38086L5.50488 5.84961L7.30957 3.83301L7.25488 5.30957V13.7998C7.25488 14.251 7.5625 14.5586 8 14.5586Z"})})},443417:(e,t,o)=>{o.d(t,{Y:()=>r});o(667294);var n=o(785893);const r=(0,o(827282).IU)("lock",{viewBox:"0 0 20 20",svg:(0,n.jsx)("path",{d:"M6.8 16.702q-.779 0-1.182-.424-.403-.417-.403-1.257v-4.847q0-.834.403-1.251t1.183-.417h6.398q.78 0 1.183.417t.403 1.25v4.848q0 .84-.403 1.257-.403.424-1.183.424H6.801Zm.192-1.23h6.016a.42.42 0 0 0 .328-.13q.116-.123.116-.37V10.23q0-.247-.116-.37a.43.43 0 0 0-.328-.123H6.992a.44.44 0 0 0-.328.123q-.116.124-.116.37v4.744q0 .246.116.369a.43.43 0 0 0 .328.13ZM6.466 9.08V6.906q0-1.264.492-2.112.5-.855 1.306-1.285A3.6 3.6 0 0 1 10 3.079q.93 0 1.736.43.807.43 1.3 1.285.498.848.498 2.112V9.08h-1.278V6.783q0-.8-.315-1.346a2.1 2.1 0 0 0-.82-.841A2.26 2.26 0 0 0 10 4.309q-.61 0-1.121.287a2.1 2.1 0 0 0-.82.84q-.308.547-.308 1.347V9.08z"})})},179633:(e,t,o)=>{o.d(t,{P:()=>r});o(667294);var n=o(785893);const r=(0,o(827282).IU)("pin",{viewBox:"0 0 13 19",svg:(0,n.jsx)("path",{d:"M1.25 12.875h4.227v3.648c0 1.196.5 2.188.695 2.188.187 0 .687-.992.687-2.188v-3.648h4.227c.703 0 1.148-.438 1.148-1.102 0-1.648-1.32-3.304-3.359-4.109L8.617 4c.992-.648 1.93-1.383 2.328-1.914.211-.266.305-.531.305-.758 0-.476-.367-.828-.914-.828H2.008c-.555 0-.914.352-.914.828 0 .227.093.492.297.758.398.531 1.343 1.266 2.328 1.914L3.46 7.664C1.42 8.47.1 10.125.1 11.774c0 .664.446 1.101 1.149 1.101zm4.922-5.719c-.5 0-.984.047-1.438.14l.235-3.874c.008-.11-.008-.149-.086-.188-1.172-.601-2.078-1.312-2.14-1.468-.063-.102 0-.164.085-.164h6.68c.086 0 .148.062.086.164-.063.156-.969.867-2.14 1.468-.071.04-.095.079-.079.188l.234 3.875a7.177 7.177 0 00-1.437-.14zm-4.61 4.54c-.18 0-.257-.102-.226-.313.172-1.406 1.969-3.086 4.836-3.086 2.86 0 4.656 1.68 4.828 3.086.031.21-.047.312-.227.312h-9.21z"})})},233687:(e,t,o)=>{o.d(t,{A:()=>r});o(667294);var n=o(785893);const r=(0,o(827282).IU)("pinStrikethrough",{viewBox:"0 0 15 19",svg:(0,n.jsx)("path",{d:"M3.094 1.328c0 .227.094.492.297.758.398.531 1.343 1.266 2.328 1.914l-.055.86 1.149 1.156.156-2.594c.008-.11-.008-.149-.086-.188-1.172-.601-2.078-1.312-2.14-1.468-.063-.102.007-.164.085-.164h6.68c.086 0 .148.062.086.164-.063.156-.961.867-2.14 1.468-.071.04-.087.079-.079.188l.234 3.875a7.12 7.12 0 00-1.437-.14h-.203l1.203 1.226c2.164.219 3.758 1.984 3.758 3.234 0 .04-.008.078-.008.117l.844.97c.257-.157.468-.477.468-.93 0-1.649-1.32-3.313-3.359-4.11L10.617 4c.992-.648 1.93-1.383 2.336-1.914.203-.266.297-.531.297-.758 0-.476-.367-.828-.914-.828H4.008c-.555 0-.914.352-.914.828zM.367 2.656l14.125 14.11a.603.603 0 00.852 0 .597.597 0 000-.852L1.227 1.804a.606.606 0 00-.86 0 .618.618 0 000 .852zm1.735 9.117c0 .665.445 1.102 1.148 1.102h4.234v3.648c0 1.196.493 2.188.688 2.188.195 0 .687-.992.687-2.188V12.97h.446L8.03 11.695H3.562c-.171 0-.257-.101-.226-.312.094-.875.828-1.805 1.984-2.399l-.82-.82c-1.477.867-2.398 2.234-2.398 3.61z"})})}}]);