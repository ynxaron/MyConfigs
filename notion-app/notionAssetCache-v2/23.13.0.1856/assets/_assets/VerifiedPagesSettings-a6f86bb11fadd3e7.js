"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[19454],{378341:(e,t,i)=>{i.r(t),i.d(t,{VerifiedPagesSettings:()=>E});i(267602),i(653476),i(241792);var r=i(667294),n=()=>i(219727),a=()=>i(142735),s=()=>i(846550),o=()=>i(899133),d=()=>i(788860),l=()=>i(696459),g=()=>i(285473),c=()=>i(312578),f=()=>i(67961),p=()=>i(677243),h=()=>i(237427),u=()=>i(543771),S=()=>i(630029),x=()=>i(504117),w=()=>i(868614),v=()=>i(868982),m=()=>i(718959),y=()=>i(527278),j=()=>i(90065),H=()=>i(766463),b=(i(821057),i(470928),()=>i(146947)),P=()=>i(506347),C=()=>i(646574),O=()=>i(448419),M=()=>i(729775),T=()=>i(92175),Z=()=>i(166124),k=()=>i(654133),I=()=>i(239444),_=()=>i(795126),K=()=>i(429725),R=()=>i(826955),V=()=>i(838266),B=i(785893);const L=10;function z(e){let{pageStore:t}=e;const i=(0,a().VK)((()=>(0,K().Hu)({store:t,pageVisitSource:P().tY.VerifiedPagesSettings})),[t]),n=(0,r.useCallback)((e=>{e.metaKey||V().default.setState({...V().default.state,open:!1})}),[]),o=(0,s().yK)((()=>({container:{width:"100%"},linkBox:{width:"100%"},linkBoxHover:{marginLeft:-L,paddingLeft:L,width:`calc(100% + ${L}px)`}})),[]);return(0,B.jsx)("div",{style:o.container,children:(0,B.jsx)(M().Z,{href:i,style:o.linkBox,hoveredStyle:o.linkBoxHover,onClick:n,children:(0,B.jsx)(Z().o,{blockStore:t})})})}function D(e){let{pageStore:t,filteredOwnerIds:i}=e;const r=(0,s().yK)((()=>({ownerCell:{display:"flex",alignItems:"center"},owner:{width:"fit-content"}})),[]),{verificationOwners:n}=(0,a().VK)((()=>(0,j().zV)({blockStore:t})),[t]),o=n.map((e=>R().t1.createChildStore(t,e))).filter((e=>e instanceof R().U6));if(0===o.length)throw Error("Verified page has no verification owner");const d=o.find((e=>i.includes(e.id)))??o[0],l=o.filter((e=>e.id!==d.id));return(0,B.jsxs)("div",{style:r.ownerCell,children:[(0,B.jsx)(I().Z,{userStore:d,avatarSize:20,style:r.owner},`${t.id}-owner`),l.length>0&&(0,B.jsx)(F,{hiddenOwners:l})]})}function F(e){let{hiddenOwners:t}=e;const i=(0,s().yK)((e=>({hiddenOwnersCount:{marginLeft:4},hiddenOwner:{margin:"4px 0px",color:e.regularInvertedTextColor},tooltip:{width:200},tooltipHeader:{color:e.mediumInvertedTextColor,marginBottom:6}})),[]);return(0,B.jsx)(k().Z,{allowHover:!0,originGap:7,style:i.tooltip,renderTooltip:e=>(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(f().Z,{isSmall:!0,style:i.tooltipHeader,children:(0,B.jsx)(d()._H,{id:"verifiedPagesSettings.hiddenOwners.tooltipHeader",defaultMessage:"Owners"})}),(0,B.jsx)("div",{...e,children:t.map((e=>(0,B.jsx)(I().Z,{userStore:e,avatarSize:20,style:i.hiddenOwner},e.id)))})]}),render:e=>(0,B.jsx)("div",{...e,style:i.hiddenOwnersCount,children:(0,B.jsx)(f().Z,{isSecondaryColor:!0,children:`+${t.length}`})})})}function U(e){let{pageStore:t,verificationState:i}=e;const r=(0,n().Fy)();return(0,B.jsx)(O().ZP,{renderOrigin:e=>(0,B.jsx)(T().Z,{isSmall:!0,isLightGray:"expired"===i.type,...e,children:$({verificationState:i})}),render:e=>(0,B.jsx)(_().D,{parent:e,blockStore:t}),popupType:r.isMobile?O().Z4.SlideUp:O().Z4.Popup})}function $(e){let{verificationState:t}=e;if("none"===t.type)throw new Error("Verified page has no verification state");return"expired"===t.type?(0,B.jsx)(d()._H,{id:"verifiedPagesSettings.verificationStatus.expired",defaultMessage:"Expired"}):"verified"===t.type?t.isIndefinite?(0,B.jsx)(d()._H,{id:"verifiedPagesSettings.verificationStatus.indefinite",defaultMessage:"Indefinitely"}):(0,C().$b)(t.dateTimeRange.end.toMillis(),b().locale,y().Z.getIntl(),void 0,"medium"):void(0,l().t1)(t)}function E(e){let{spaceStore:t}=e;const i=(0,n().O7)(),[g,c]=(0,r.useState)(""),[f,b]=(0,r.useState)(i.currentUser.id?[i.currentUser.id]:[]),[P,C]=(0,r.useState)([]),[O,M]=(0,r.useState)([]),T={ancestors:O,inTeams:P,verificationOwners:f},Z=(0,a().VK)((()=>m().Pw(i)),[i]),{results:k,isResultsLoading:I,fetchAdditionalServerResultsOnChange:_}=(0,H().s)({disable:!1,searchQuery:g,limit:20,type:o().n8.BlocksInSpace,source:"verified_pages_settings",filters:T}),K=(0,a().VK)((()=>function(e){return e.map((e=>{const t=(0,j().T7)(e);if("none"===t.type)return;return{id:e.id,isClickable:!1,pageStore:e,verificationState:t}})).filter(l().$K)}(k.map((e=>e.store)))),[k]),R=(0,s().yK)((()=>({filterBar:{display:"flex",marginBottom:20}})),[]);return(0,B.jsxs)(x().ZP,{children:[(0,B.jsx)(w().Z,{large:!0,divider:"full",children:(0,B.jsx)(d()._H,{id:"verifiedPages.heading.title",defaultMessage:"Verified pages"})}),(0,B.jsx)(v().ON,{mode:v().p3.OnChange,query:g,setQueryFilter:c,placeholderText:y().Z.formatMessage(v()._7.titleOnlyPlaceholder)}),Z&&(0,B.jsxs)("div",{style:R.filterBar,children:[(0,B.jsx)(h().Z,{mode:S().z.Pill,focused:!1,title:(0,B.jsx)(d()._H,{id:"verifiedPagesSettings.searchFilter.owner",defaultMessage:"Owner"}),parentStore:Z,userIds:f,onChange:b}),(0,B.jsx)(p().Z,{mode:S().z.Pill,focused:!1,title:(0,B.jsx)(d()._H,{id:"verifiedPagesSettings.searchFilter.ancestor",defaultMessage:"In"}),parentStore:Z,blockIds:O,onChange:M}),(0,B.jsx)(u().Z,{mode:S().z.Pill,focused:!1,title:(0,B.jsx)(d()._H,{id:"verifiedPagesSettings.searchFilter.teamspace",defaultMessage:"Teamspace"}),parentStore:Z,teamIds:P,onChange:C})]}),(0,B.jsx)(N,{loading:I,verifiedPageRows:K??[],onLoadMore:_,filteredOwnerIds:f})]})}function N(e){let{loading:t,verifiedPageRows:i,onLoadMore:n,filteredOwnerIds:a}=e;const o=function(e){const t=(0,s().yK)((e=>({pageStoreHeaderStyle:{boxShadow:`\n\t\t\t\t\tinset 0 1px 0 ${e.tableDividerColor},\n\t\t\t\t\tinset 0 -1px 0 ${e.tableDividerColor}\n\t\t\t\t`},pageStoreRowStyle:{boxShadow:void 0}})),[]);return(0,r.useMemo)((()=>({pageTitle:{id:"pageTitle",headerTitle:(0,B.jsx)(d()._H,{id:"verifiedPagesSettings.tableHeader.pageName",defaultMessage:"Page name"}),renderCell:e=>(0,B.jsx)(z,{pageStore:e.pageStore}),widthData:{width:100,maxWidth:400},sortable:!1,headerStyle:t.pageStoreHeaderStyle,rowStyle:t.pageStoreRowStyle},owner:{id:"owner",headerTitle:(0,B.jsx)(d()._H,{id:"verifiedPagesSettings.tableHeader.owner",defaultMessage:"Owner"}),renderCell:t=>(0,B.jsx)(D,{pageStore:t.pageStore,filteredOwnerIds:e}),widthData:{width:150,maxWidth:200},sortable:!1},verifiedUntil:{id:"verifiedUntil",headerTitle:(0,B.jsx)(d()._H,{id:"verifiedPagesSettings.tableHeader.verifiedUntil",defaultMessage:"Verified until"}),renderCell:e=>(0,B.jsx)(U,{pageStore:e.pageStore,verificationState:e.verificationState}),widthData:{width:100,maxWidth:200},sortable:!1}})),[t,e])}(a),p=(0,l().Yd)(o).map((e=>o[e])),h=(0,s().yK)((e=>(0,g().bE)({columnRenderInfo:p,theme:e,containerMarginTop:0})),[p]),u=(0,s().yK)((()=>({emptyQuery:{marginTop:15,marginBottom:40,textAlign:"center"},loadingSpinner:{margin:"24px auto 24px"}})),[]);return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(g().Dp,{setStickyHeaderRow:!0,hideHeaderRowPadding:!0,showRowBorders:!0,allowHorizontalScroll:!0,maxHeight:500,columnRenderInfo:p,rows:i,loadMoreMethod:n?{type:"scroll",onLoadMore:n}:void 0,renderNoRowsComponent:()=>(0,B.jsx)(f().Z,{isSmall:!0,style:u.emptyQuery,children:!t&&0===i.length&&(0,B.jsx)(d()._H,{id:"settings.verifiedPagesSettings.searchTable.empty",defaultMessage:"No verified pages to display."})}),styles:h}),t&&(0,B.jsx)(c().Z,{style:u.loadingSpinner})]})}}}]);