"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[93895],{94130:(e,t,o)=>{o.d(t,{m:()=>s});var n=()=>o(250303),i=()=>o(497065),l=()=>o(250625),r=()=>o(887430);function s(e){const{environment:t,collectionContextStore:o,event:s,buttonPopupParent:c}=e,a=(0,r().ay)(o);if(!a)return null;const d=l().DJ(s);i().c4({environment:t,url:a,openInNew:d}),d||null==c||c.close(),n().wd({environment:t,collectionContextStore:o,action:"click_source_view"})}},894704:(e,t,o)=>{o.d(t,{x:()=>J,Z:()=>L});var n=o(667294),i=()=>o(219727),l=()=>o(142735),r=()=>o(846550),s=()=>o(788860),c=()=>o(513670),a=()=>o(707513),d=()=>o(250303),u=()=>o(421654),h=()=>o(636340),x=()=>o(879952),g=()=>o(990966),f=()=>o(269299),p=o(785893);const y=function(e){const{store:t,titleStyle:n,actionButton:i}=e,r=(0,l().VK)((()=>t.getParentBlockStore()),[t]);return(0,p.jsx)("div",{children:(0,p.jsxs)("div",{style:{display:"flex"},children:[(0,p.jsx)(o(732388).v,{step:"demo_collection",store:r,children:(0,p.jsx)(o(384241).Z,{store:t,style:n})}),i]})})};var S=()=>o(628370),m=()=>o(827973),w=()=>o(448419),v=()=>o(1910),C=()=>o(729775),k=()=>o(198829),j=()=>o(255577),b=()=>o(967092),V=()=>o(943620),I=()=>o(388284),K=()=>o(345837),T=()=>o(473244),A=()=>o(12512),B=()=>o(352230),D=()=>o(550054),O=()=>o(338217),R=()=>o(314379),W=()=>o(681245),P=()=>o(965913),_=()=>o(953293),Z=()=>o(94130),z=()=>o(887430),M=()=>o(583632);const E=22;function H(e){let{store:t,collectionContextStore:n,isFullScreen:r,canEdit:s,showHoverActionsStore:c}=e;const a=(0,i().O7)(),d=(0,l().VK)((()=>{const e=o(482162).default.state;return(0,z().Ks)(t)||!(0,o(942226).wq)(t)&&e.open&&e.isClosing}),[t]),u=(0,l().VK)((()=>n.collectionStore()),[n]),h=(0,l().VK)((()=>n.collectionViewBlockStore()),[n]),x=(0,l().VK)((()=>Boolean(null==u?void 0:u.isSyncedCollection())),[u]),{WindowSizeStore:g}=a,f=(0,l().VK)((()=>Math.min(o(191586).zL,g.state.width)),[g]);return u&&h?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{style:{...(r||d)&&(0,o(275200).eA)(a)&&{position:"sticky",left:0},paddingTop:8,boxSizing:d?"content-box":void 0,width:d?f:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,p.jsx)(J,{collectionContextStore:n,showHoverActionsStore:c}),x&&(0,p.jsx)("div",{style:{display:"flex"},children:(0,p.jsx)(o(989560).Z,{canEdit:s,store:h,buttonStyle:{margin:0}})})]}),(0,p.jsx)(o(160740).Z,{collectionStore:u,collectionContextStore:n}),(0,p.jsx)(o(986286).yY,{store:u})]}):null}const L=n.memo(H);function U(e){return{fontWeight:a().Ue.bold,fontSize:22,...e?{}:{display:"-webkit-box",lineClamp:1,WebkitLineClamp:1,WebkitBoxOrient:"vertical",overflow:"hidden"}}}function N(e,t){return{width:24,height:t?24:16,fill:e.regularIconColor}}function q(e){let{parent:t,collectionContextStore:o}=e;const n=(0,r().Fg)(),a=(0,i().O7)(),h=(0,i().Fy)(),x=(0,l().Kw)(o.permissionScopesStore),y=(0,l().VK)((()=>o.collectionStore()),[o]),S=(0,l().VK)((()=>null==y?void 0:y.isSyncedCollection()),[y]),w=(0,l().VK)((()=>Boolean(null==y?void 0:y.isSystemCollection())),[y]);if(!y)return null;const v=c().oA([!w&&{key:"view",render:e=>(0,p.jsx)(m().Z,{...e,title:(0,p.jsx)(s()._H,{id:"database.source.viewDatabase.title",defaultMessage:"View database"}),icon:(0,O().J)(N(n))}),action:e=>{(0,Z().m)({environment:a,collectionContextStore:o,event:e.event,buttonPopupParent:t})}},x.canConfigureCollection&&!S&&{key:"edit_name",render:e=>(0,p.jsx)(m().Z,{...e,title:(0,p.jsx)(s()._H,{id:"database.source.editTitle.title",defaultMessage:"Edit database title"}),icon:(0,_().R)(N(n))}),action:()=>{g().selectAllText({environment:a,store:y.getNameStore(),canSelectAllBlocks:!1}),t.close(),d().wd({environment:a,collectionContextStore:o,action:"click_source_edit_title"})}}]),C={key:"show_title",render:e=>(0,p.jsx)(m().Z,{...e,icon:(0,W().D)(N(n,!0)),title:(0,p.jsx)(s()._H,{id:"database.source.hideTitle.title",defaultMessage:"Hide database title"})}),action:()=>{const e=o.collectionViewStore();if(!e)return null;f().createAndCommit({userAction:"CollectionViewBlockSource.showTitleItem",environment:a,canUndo:!0,perform:t=>{u().FH({stores:[e],update:{hide_linked_collection_name:!0},transaction:t})}}),t.close(),d().wd({environment:a,collectionContextStore:o,action:"click_source_hide_title"})}};return(0,p.jsx)(k().Z,{menuType:h.isMobile?B().o.ActionSheet:B().o.Popup,children:(0,p.jsx)(j().Z,{type:j().i.Vertical,onAccept:t.close,sections:c().oA([v.length>0&&{key:"actions",render:e=>(0,p.jsx)(I().Z,{...e}),items:v},x.canConfigureBlock&&{key:"show_title",render:e=>(0,p.jsx)(I().Z,{...e,topBorder:!0}),items:[C]}]),initialFocus:void 0})})}function F(e){let{showHoverActionsStore:t,collectionContextStore:o}=e;const n=(0,i().O7)(),r=(0,l().Kw)(t);return(0,p.jsx)(S().Z,{visible:r,animate:{opacity:1},initial:{opacity:0},exit:{opacity:0},style:{display:"flex",alignItems:"center",marginLeft:4},children:(0,p.jsx)(w().ZP,{popupType:n.device.isMobile?b().kQ.SlideUp:b().kQ.Popup,render:e=>(0,p.jsx)(q,{parent:e,collectionContextStore:o}),renderOrigin:e=>(0,p.jsx)(v().Z,{icon:R().o,...e}),style:{width:240},originGap:4})})}function Y(e){x().ZH({environment:e})}function G(e){let{disabled:t,collectionContextStore:o}=e;const n=(0,r().Fg)(),s=(0,i().O7)(),c=(0,l().VK)((()=>o.collectionStore()),[o]),a=(0,l().VK)((()=>o.collectionViewBlockStore()),[o]),d=(0,l().VK)((()=>null==c?void 0:c.getIcon()),[c]),u=(0,l().VK)((()=>{var e;return Boolean((null==c||null===(e=c.getParentBlockStore())||void 0===e?void 0:e.id)===(null==a?void 0:a.id))}),[c,a]),x=(0,l().VK)((()=>null==a?void 0:a.getType()),[a]),g=(0,r().yK)((e=>({iconStyle:{width:E,height:E,marginRight:4}})),[]);return c&&a?d?(0,p.jsxs)("div",{style:{position:"relative",width:E+2,height:E+2,marginRight:4},children:[t?(0,p.jsx)(V().Z,{disabled:!0,bucket:"secure",store:c,icon:d,isEmptyPage:!1,style:g.iconStyle,size:E}):(0,p.jsx)(V().Z,{disabled:!1,bucket:"secure",store:c,icon:d,isEmptyPage:!1,style:g.iconStyle,size:E,iconLoggingData:{recordTable:c.table,source:"inline_collection",block_type:x,collection_id:c.id},onChange:e=>function(e,t,o){const n=o.collectionStore();if(!n)return;const i=n&&n.getIconStore();i&&f().createAndCommit({userAction:"CollectionViewBlockSource.handleRecordIconChange",environment:t,canUndo:!0,perform:t=>{h().sO({store:i,value:e,transaction:t})}})}(e,s,o)}),!u&&(0,P().Y)({position:"absolute",width:"50%",height:"50%",right:0,bottom:0,fill:"dark"===n.mode?n.regularTextColor:"#3E3C38",stroke:"dark"===n.mode?n.surface.wash:"white",strokeWidth:"dark"===n.mode?"1.85px":"1.5px"})]}):u?null:(0,p.jsx)("div",{style:{width:20,marginRight:4},children:(0,O().J)({width:20})}):null}function J(e){let{collectionContextStore:t,showHoverActionsStore:o,titleStyle:n}=e;const[i,r,s]=(0,l().VK)((()=>[t.collectionStore(),t.collectionViewBlockStore(),t.permissionScopesStore.state]),[t]),c=(0,l().VK)((()=>i&&(0,T().AO)(i.inMemoryRecordCache)),[i]),d=(0,l().VK)((()=>t.viewsModuleContextStore.isInLayoutBuilder()),[t]),u=(0,l().VK)((()=>{const e=t.collectionStore();if(!e)return!1;const o=e.getNameStore();return Boolean((0,D().J5)(o))}),[t]),h=(0,l().VK)((()=>{var e;return Boolean((null==i||null===(e=i.getParentBlockStore())||void 0===e?void 0:e.id)===(null==r?void 0:r.id))}),[i,r]),x=(0,l().VK)((()=>Boolean(null==i?void 0:i.isSyncedCollection())),[i]),g=(h||u)&&s.canConfigureCollection&&!x;return i&&(c||d)?(0,p.jsxs)("div",{style:{width:"max-content",maxWidth:"100%",marginRight:4,display:"flex",alignItems:"center",...a().Yu},children:[(0,p.jsx)(G,{collectionContextStore:t,disabled:!0}),(0,p.jsx)(y,{store:i,titleStyle:{...U(),...n}})]}):g?(0,p.jsx)(X,{collectionContextStore:t,showHoverActionsStore:o,titleStyle:{...U(u),...n}}):(0,p.jsx)($,{collectionContextStore:t,showHoverActionsStore:o,titleStyle:{...U(),...n}})}function $(e){let{collectionContextStore:t,showHoverActionsStore:o,titleStyle:n}=e;const r=(0,i().O7)(),s=(0,l().VK)((()=>t.collectionStore()),[t]),c=(0,l().VK)((()=>t.collectionViewBlockStore()),[t]),u=(0,l().VK)((()=>Boolean(null==s?void 0:s.isSystemCollection())),[s]),h=(0,l().VK)((()=>{if(!u)return(0,z().ay)(t)}),[t,u]);return s&&c?(0,p.jsxs)(C().Z,{disabled:u,style:{width:"max-content",maxWidth:"100%",marginRight:4,...a().Yu},innerStyle:{paddingLeft:4,paddingRight:4,display:"flex",alignItems:"center",borderRadius:4},href:h,onClick:()=>function(e,t){d().wd({environment:e,collectionContextStore:t,action:"click_collection_name_link_button"})}(r,t),children:[(0,p.jsx)(G,{collectionContextStore:t,disabled:!0}),(0,p.jsx)(y,{actionButton:(0,p.jsx)(F,{showHoverActionsStore:o,collectionContextStore:t}),store:s,titleStyle:n})]}):null}function X(e){let{collectionContextStore:t,showHoverActionsStore:o,titleStyle:n}=e;const r=(0,i().O7)(),c=(0,s().YB)(),a=(0,l().VK)((()=>t.collectionStore()),[t]),u=(0,l().VK)((()=>t.collectionViewBlockStore()),[t]),h=(0,l().VK)((()=>null==a?void 0:a.getNameStore()),[a]),x=(0,l().VK)((()=>{var e;return(null==a||null===(e=a.getModel())||void 0===e?void 0:e.getEmptyTitlePlaceholder({intl:c}))||c.formatMessage(M().i.titlePlaceholder)}),[a,c]);return a&&u&&h?(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center",marginLeft:4,marginRight:4},children:[(0,p.jsx)(G,{collectionContextStore:t,disabled:!1}),(0,p.jsx)(K().Z,{store:h,style:{...n,marginRight:4},disabled:!1,disableSlashCommands:!0,disableEmojiCommands:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableMobileActionBar:!1,disableComment:!0,placeholder:x,onEnter:()=>Y(r),onEsc:()=>Y(r),onClick:()=>function(e,t){d().wd({environment:e,collectionContextStore:t,action:"click_collection_name_input"})}(r,t),disableShiftEnter:!0,pasteBehavior:"inline",inPageFind:A().B3.none},h.id),(0,p.jsx)(F,{showHoverActionsStore:o,collectionContextStore:t})]}):null}},105348:(e,t,o)=>{o.d(t,{Z:()=>b,f:()=>j});o(821057),o(492176),o(7961);var n=o(667294),i=()=>o(219727),l=()=>o(142735),r=()=>o(846550),s=()=>o(492522),c=()=>o(139224),a=()=>o(990966),d=()=>o(765458),u=()=>o(830700),h=()=>o(628370),x=()=>o(573357),g=()=>o(967092),f=()=>o(247724),p=()=>o(347577),y=()=>o(706363),S=()=>o(949842),m=()=>o(164079),w=()=>o(466970),v=()=>o(128119),C=o(785893);function k(e){const{collectionContextStore:t,headerSizeObserver:o,contentSizeObserver:n,paddingRight:c,shouldScrollIntoView:d,settingsOpen:u}=e,g=(0,i().O7)(),p=(0,l().VK)((()=>{const e=o.rect.state;return g.WindowSizeStore.state.height-(e.top+y().LO)}),[g.WindowSizeStore,o.rect]),w=(0,l().VK)((()=>n.rect.state.height),[n.rect]),v=(0,l().VK)((()=>t.isInPeekRendererStore.state),[t.isInPeekRendererStore]),k=(0,l().Kw)(e.headerHeightStore),j=(0,l().VK)((()=>t.allowScrollingWhenCollectionSettingsSidebarOpen()),[t]),b=(0,r().yK)((e=>({topLevelDiv:{position:"absolute",top:k,right:-c,background:v?e.cardContentBackground:e.contentBackground,borderLeft:`1px solid ${e.tableDividerColor}`,paddingRight:c,zIndex:s().Nm,...j?{height:w,minHeight:p}:{height:p}},nestedDiv:{boxShadow:`inset 0 1px 0 ${e.tableDividerColor}`}})),[k,c,v,j,w,p]);return u?(0,C.jsx)(x().Z,{capture:!0,allowMobileAutoScroll:!0,allowUndo:!0,render:e=>(0,C.jsx)(h().Z,{initial:{opacity:0,translateX:12},animate:{opacity:1,translateX:0},exit:{opacity:0,translateX:12},style:b.topLevelDiv,className:f().Dkf,...(0,m().Z)({onMouseDown:e=>function(e,t){(0,S().ZP)({event:e,context:S().Af.EditorMouseDown,callback:()=>{a().clear({environment:t})}})}(e,g)},e),children:(0,C.jsxs)("div",{style:{display:"flex",...j?{height:"fit-content",position:"sticky",top:0}:{height:"100%"}},children:[(0,C.jsx)("div",{style:b.nestedDiv,children:(0,C.jsx)(V,{collectionContextStore:t,shouldScrollIntoView:d,isSidebar:!0})}),(0,C.jsx)("div",{style:{width:c}})]})})}):null}function j(e){const{collectionContextStore:t,placementToOrigin:o,alignmentToOrigin:r,originGap:s,marginTop:a,settingsOpen:d,shouldScrollIntoView:h,originRect:x}=e,y=(0,l().VK)((()=>t.settingsStore.state.stack.at(-1)),[t.settingsStore]),m=(0,i().O7)(),v=(0,n.useCallback)((e=>(0,C.jsx)(V,{collectionContextStore:t,shouldScrollIntoView:h,isSidebar:e})),[t,h]),k=(0,u().o)({collectionContextStore:t}),j=(0,w().E)("mobile_use_bottom_sheet_popup_container");return(0,C.jsx)(g().ZP,{popupType:m.device.isMobile?j?g().kQ.BottomSheet:g().kQ.SlideUp:g().kQ.Popup,bottomSheetInitialState:k?"half":"full",className:`${f().Dkf} ${f().D4r}`,open:d,placementToOrigin:o,alignmentToOrigin:r,style:{marginTop:a,...k&&!j&&{maxHeight:p().DQ,height:p().DQ,position:"inherit"}},origin:(0,C.jsx)("div",{}),originGap:s,render:v,onDismiss:t=>{!function(e,t){(0,S().ZP)({event:e,context:S().Af.CollectionSettingsClick,callback:()=>{c().E3({collectionSettingsStore:t.settingsStore})}})}(t,e.collectionContextStore),"createViewSource"===(null==y?void 0:y.type)&&c().YN({environment:m,collectionContextStore:e.collectionContextStore})},originRect:x,keepFocus:!0,trapFocus:!0,preventScaleTransition:!0,preventOpacityTransition:!0})}const b=function(e){const{collectionContextStore:t,headerSizeObserver:r,contentSizeObserver:s,settingsHeaderSizeObserver:c,placementStore:a,placementToOrigin:d=v().Iw.Bottom,alignmentToOrigin:u=v().lU.Start,marginTop:h=-1,originGap:x,headerRef:g}=e,f=(0,i().O7)(),y=(0,l().Kw)(a),[S,m]=(0,n.useState)(!1),w=(0,l().VK)((()=>t.isInPeekRendererStore.state),[t.isInPeekRendererStore]),b=(0,l().Kw)(t.isFullScreenStore),[V,I]=(0,n.useState)(!1),K=(0,l().VK)((()=>function(e){const t=e.settingsStore.state;return t.open&&!0!==t.hideSettingsPopup}(t)),[t]),T=(0,l().VK)((()=>function(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}(e.collectionContextStore)),[e.collectionContextStore]),A=(0,l().VK)((()=>{const e=r.rect.state;return 0!==e.width?(0,p().GC)(t,f.device.isMobile,e.width):"popup"}),[t,f.device.isMobile,r.rect]);(0,n.useEffect)((()=>{K&&(r.recompute(),c.recompute(),a.setState(A)),K&&!b&&"form_editor"!==T&&m(!0)}),[K,b,a,r,c,T,A]);const B=(0,l().VK)((()=>function(e){var t;return null===(t=e.settingsStore.state.ref)||void 0===t||null===(t=t.current)||void 0===t?void 0:t.getBoundingClientRect()}(t)||DOMRect.fromRect({x:c.rect.state.right-2,y:c.rect.state.y-2,width:0,height:c.rect.state.height})),[t,c.rect]);return(0,n.useEffect)((()=>{if(S){const e=null==g?void 0:g.current;if(e){const t=e.getBoundingClientRect();f.WindowSizeStore.state.height-t.top<o(205951).Lm&&((0,o(275200).Wr)(e,{edgeDist:0,animate:!1}),r.recompute(),c.recompute())}m(!1)}}),[t,f.WindowSizeStore,r,c,w,S,g]),(0,n.useEffect)((()=>{I(!!K)}),[K]),"sidebar"===y?(0,C.jsx)(k,{collectionContextStore:t,headerSizeObserver:r,contentSizeObserver:s,paddingRight:e.paddingRight,shouldScrollIntoView:S,headerHeightStore:e.headerHeightStore,settingsOpen:V,isInPeekRenderer:w}):(0,C.jsx)(j,{collectionContextStore:t,placementToOrigin:d,alignmentToOrigin:u,originGap:x??0,marginTop:h,settingsOpen:V,shouldScrollIntoView:S,originRect:B})};function V(e){let{isSidebar:t,collectionContextStore:o,shouldScrollIntoView:n}=e;return n?null:(0,C.jsx)(d().PJ,{context:p().HV.ViewSettings,collectionContextStore:o,collectionSettingsStore:o.settingsStore,fullHeight:t})}},583632:(e,t,o)=>{o.d(t,{i:()=>n});const n=(0,o(788860).vU)({titlePlaceholder:{defaultMessage:"Untitled",id:"database.source.titlePlaceholder"}})},168275:(e,t,o)=>{o.d(t,{Y:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("commentReply",{viewBox:"0 0 12 12",svg:(0,n.jsx)("path",{d:"M11.2324 7.2832C11.2324 4.95117 9.66211 3.33984 7.00195 3.33984H3.32227L1.96875 3.4043L2.99414 2.53711L4.48242 1.08398C4.59961 0.972656 4.67578 0.826172 4.67578 0.632812C4.67578 0.263672 4.41797 0 4.03711 0C3.87305 0 3.69141 0.0761719 3.5625 0.199219L0.205078 3.50977C0.0703125 3.63867 0 3.81445 0 3.99609C0 4.17188 0.0703125 4.34766 0.205078 4.47656L3.5625 7.78711C3.69141 7.91016 3.87305 7.98633 4.03711 7.98633C4.41797 7.98633 4.67578 7.72266 4.67578 7.35352C4.67578 7.16016 4.59961 7.01953 4.48242 6.90234L2.99414 5.44922L1.96875 4.58789L3.32227 4.64648H7.03125C8.90625 4.64648 9.94336 5.71289 9.94336 7.23633C9.94336 8.75977 8.90625 9.87305 7.03125 9.87305H5.66016C5.27344 9.87305 4.99805 10.166 4.99805 10.5234C4.99805 10.8809 5.27344 11.1738 5.66602 11.1738H7.07812C9.69141 11.1738 11.2324 9.63281 11.2324 7.2832Z"})})},13234:(e,t,o)=>{o.d(t,{C:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("databaseEmpty",{viewBox:"0 0 20 20",svg:(0,n.jsx)("path",{fillRule:"evenodd",d:"M10 1.75c-1.996 0-3.835.288-5.202.776-.68.243-1.284.55-1.732.928-.444.375-.816.894-.816 1.546v10c0 .652.372 1.17.816 1.546.448.378 1.052.685 1.732.928 1.367.488 3.206.776 5.202.776s3.835-.288 5.202-.776c.68-.243 1.284-.55 1.732-.928.444-.375.816-.894.816-1.546V5c0-.652-.372-1.17-.816-1.546-.448-.378-1.052-.685-1.732-.928-1.367-.488-3.206-.776-5.202-.776zM3.75 5c0-.039.02-.177.284-.4.26-.22.682-.452 1.269-.661C6.469 3.522 8.13 3.25 10 3.25s3.531.272 4.697.689c.587.209 1.009.44 1.269.66.264.224.284.362.284.401 0 .039-.02.177-.284.4-.26.22-.682.452-1.268.661-1.167.417-2.828.689-4.698.689-1.87 0-3.531-.272-4.697-.689-.587-.209-1.008-.44-1.269-.66C3.77 5.176 3.75 5.038 3.75 5zm12.5 2.01c-.317.175-.67.33-1.048.464-1.367.488-3.206.776-5.202.776s-3.835-.288-5.202-.776A7.105 7.105 0 013.75 7.01V10c0 .039.02.177.284.4.26.22.682.452 1.269.662 1.166.416 2.827.688 4.697.688s3.531-.272 4.697-.688c.587-.21 1.009-.442 1.269-.662.264-.223.284-.361.284-.4V7.01zm-12.5 5c.317.175.67.33 1.048.464 1.367.488 3.206.776 5.202.776s3.835-.288 5.202-.776c.377-.135.731-.29 1.048-.465V15c0 .039-.02.177-.284.4-.26.22-.682.452-1.268.661-1.167.417-2.828.689-4.698.689-1.87 0-3.531-.272-4.697-.689-.587-.209-1.008-.44-1.269-.66-.264-.224-.284-.362-.284-.401v-2.99z",clipRule:"evenodd"})})},781443:(e,t,o)=>{o.d(t,{v:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("databaseOutline",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M7.98145 15.3584C4.38574 15.3584 2 13.9775 2 12.0088V3.78516C2 1.9873 4.39258 0.763672 7.98145 0.763672C11.5771 0.763672 13.9697 1.9873 13.9697 3.78516V12.0088C13.9697 13.9775 11.584 15.3584 7.98145 15.3584ZM7.98145 5.58301C10.7773 5.58301 12.6709 4.83105 12.6709 3.78516C12.6709 2.69141 10.7842 1.91895 7.98145 1.91895C5.18555 1.91895 3.29883 2.69141 3.29883 3.78516C3.29883 4.83105 5.19238 5.58301 7.98145 5.58301ZM7.98145 6.80664C5.97852 6.80664 4.35156 6.42383 3.29883 5.77441V8.69336C4.42676 9.37695 6.19043 9.81445 7.98145 9.81445C9.7793 9.81445 11.543 9.37695 12.6709 8.69336V5.77441C11.6182 6.42383 9.99121 6.80664 7.98145 6.80664ZM7.98145 11.0449C6.23828 11.0449 4.5293 10.6621 3.29883 10.0332V12.0088C3.29883 13.2051 5.11035 14.1348 7.98145 14.1348C10.8594 14.1348 12.6709 13.2051 12.6709 12.0088V10.0332C11.4404 10.6621 9.73145 11.0449 7.98145 11.0449Z"})})},662406:(e,t,o)=>{o.d(t,{m:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("sliders",{viewBox:"0 0 16 13",svg:(0,n.jsx)("g",{children:(0,n.jsx)("path",{d:"M10.536 12.066c-.323 0-.62-.08-.889-.239a1.826 1.826 0 01-.635-.642 1.674 1.674 0 01-.24-.882c0-.32.08-.61.24-.875.16-.27.371-.483.635-.643.27-.16.566-.24.89-.24.318 0 .61.08.874.24.269.16.483.374.643.643.16.264.239.556.239.875 0 .323-.08.617-.24.882a1.803 1.803 0 01-.642.642 1.66 1.66 0 01-.875.24zm0-.922a.8.8 0 00.588-.24.818.818 0 00.246-.601.796.796 0 00-.246-.595.799.799 0 00-.588-.24.83.83 0 00-.601.24.807.807 0 00-.24.595c0 .237.08.437.24.601a.83.83 0 00.601.24zm-1.169-1.49v1.298h-7.78a.625.625 0 01-.457-.191.637.637 0 01-.185-.458c0-.178.062-.33.185-.458a.625.625 0 01.458-.192h7.78zm5.059 0c.168 0 .314.063.437.19a.64.64 0 01.185.459.64.64 0 01-.185.458.588.588 0 01-.437.191h-2.653V9.653h2.653zM5.539 7.807c-.324 0-.62-.08-.889-.24a1.846 1.846 0 01-.635-.635 1.697 1.697 0 01-.24-.882c0-.324.08-.618.24-.882.16-.269.371-.483.635-.643.27-.16.565-.239.89-.239.318 0 .61.08.874.24.269.159.483.373.643.642.16.264.239.558.239.882 0 .319-.08.613-.24.882a1.817 1.817 0 01-.642.635c-.264.16-.556.24-.875.24zm0-.923a.822.822 0 00.834-.834.816.816 0 00-.834-.841.816.816 0 00-.84.84c0 .233.079.431.239.596a.83.83 0 00.601.239zm-3.978-1.49h2.761v1.298H1.561a.59.59 0 01-.431-.184.637.637 0 01-.185-.458c0-.183.062-.337.185-.465a.58.58 0 01.43-.191zm12.837 0a.61.61 0 01.458.19.633.633 0 01.192.466c0 .178-.064.33-.192.458a.622.622 0 01-.458.184h-7.71V5.395h7.71zm-3.862-1.846c-.323 0-.62-.08-.889-.24a1.845 1.845 0 01-.635-.635 1.697 1.697 0 01-.24-.882c0-.324.08-.618.24-.882.16-.269.371-.483.635-.642.27-.16.566-.24.89-.24.318 0 .61.08.874.24.269.16.483.373.643.642.16.264.239.558.239.882 0 .319-.08.613-.24.882a1.828 1.828 0 01-.642.636c-.264.16-.556.239-.875.239zm0-.923a.788.788 0 00.588-.246.81.81 0 00.246-.595.796.796 0 00-.246-.595.788.788 0 00-.588-.246.818.818 0 00-.601.246.807.807 0 00-.24.595c0 .233.08.43.24.595a.818.818 0 00.601.246zM9.401 1.143V2.44H1.588a.625.625 0 01-.458-.191.637.637 0 01-.185-.458c0-.178.062-.33.185-.458a.625.625 0 01.458-.191H9.4zm5.025 0c.168 0 .314.063.437.191s.185.28.185.458-.062.33-.185.458a.588.588 0 01-.437.191H11.69V1.143h2.735z"})})})},588491:(e,t,o)=>{o.r(t),o.d(t,{WorkflowEditor:()=>st});var n=o(667294),i=()=>o(219727),l=()=>o(142735),r=()=>o(846550),s=()=>o(922065),c=()=>o(921981),a=()=>o(251932),d=()=>o(267553),u=()=>o(876822),h=()=>o(814866),x=()=>o(275582),g=o.n(o(294184)),f=()=>o(467171),p=()=>o(707513),y=()=>o(92175),S=()=>o(943620),m=()=>o(384241),w=()=>o(916095),v=()=>o(247724),C=()=>o(518530),k=()=>o(725751),j=()=>o(325490),b=()=>o(513670),V=()=>o(269299),I=()=>o(144628),K=()=>o(906651),T=()=>o(15409),A=()=>o(826955),B=()=>o(452435),D=()=>o(286427),O=o(785893);function R(e){const{threadId:t,store:o,clientStore:r}=e,s=(0,l().VK)((()=>{const{currentSpaceStore:e}=u().default.state;if(e&&t)return A().V3.createChildStore(e,{table:j().kL,id:t,spaceId:e.id})}),[t]),c=(0,x().D)(o),a=(0,l().VK)((()=>{if(!s)return;if(r.state.loading||void 0!==(null==s?void 0:s.getCurrentInferenceId()))return;const e=function(e){const{clientStore:t,threadStore:o}=e,n=(0,I().G)({clientStore:t,threadStore:o});for(let i=n.length-1;i>=0;i--){const e=n[i];if("workflow"===e.type&&e.value)return e}}({clientStore:r,threadStore:s});if(!e)return;if(!c)return{threadStore:s,currentWorkflowValue:void 0,updatedWorkflowStep:e};const t=(0,D().x)(c);return e&&!b().Xy(e.value,t)?{threadStore:s,currentWorkflowValue:t,updatedWorkflowStep:e}:void 0}),[r,s,c]),d=(0,i().O7)(),h=(0,n.useCallback)((()=>{V().createAndCommit({userAction:"AIChatTranscript.SaveWorkflowButton.handleClick",environment:d,canUndo:!0,perform:e=>{var t;a&&(c?(0,B().U0)({workflowStore:c,environment:d,workflow:a.updatedWorkflowStep.value,transaction:e}):(0,B().Ux)({environment:d,workflow:a.updatedWorkflowStep.value,workflowBlockId:null==a||null===(t=a.updatedWorkflowStep)||void 0===t?void 0:t.workflow_block_id,transaction:e,threadStore:a.threadStore,step:a.updatedWorkflowStep}))}})}),[a,d,c]);return(0,O.jsx)(K().Z,{icon:T().e,isLarge:!0,onClick:h,disabled:void 0===a,children:"Save"})}function W(e){const{store:t,threadId:o,clientStore:s}=e,c=(0,i().O7)(),{device:a}=c,{isElectron:d,isElectronMac:u}=a,h=(0,l().VK)((()=>!!d&&!k().default.state.isShowingTabBar),[d]),x=(0,l().VK)((()=>(0,f().R6)(u)),[u]),j=(0,n.useContext)(w().gv),b=(0,r().yK)((e=>({header:{zIndex:1,padding:"12px 16px"},headerContent:{display:"flex",position:"relative",justifyContent:"space-between",alignItems:"center"},topbarPlaceholder:{minHeight:x,background:e.onboardingPreviewBackground,borderBottom:`1px solid ${e.stroke.primary}`},leftColumn:{flex:"1 0 0",display:"flex",justifyContent:"flex-start"},centerColumn:{flex:"2 0 0",display:"flex",justifyContent:"center"},rightColumn:{flex:"1 0 0",display:"flex",justifyContent:"flex-end"},titleContainer:{display:"flex",alignItems:"center",gap:"4px",fontWeight:p().Ue.medium,fontSize:17,...p().Yu},titlePreviewElementContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",maxWidth:400,overflow:"hidden"},cancelButton:{fontSize:17,fontWeight:p().Ue.medium},cancelIcon:{width:16,height:16}})),[x]),V=(0,l().VK)((()=>t?{icon:null==t?void 0:t.getIcon(),role:null==t?void 0:t.getRole(),isEmptyPage:null==t?void 0:t.isEmptyPage(),type:null==t?void 0:t.getType()}:void 0),[t]);return(0,O.jsxs)("header",{style:b.header,children:[h?(0,O.jsx)("div",{style:b.topbarPlaceholder,className:g()({[v().lIT]:!0,[v().pMC]:!0})}):null,(0,O.jsxs)("div",{style:b.headerContent,children:[(0,O.jsx)("div",{style:b.leftColumn,children:(0,O.jsx)(y().Z,{onClick:j,isLarge:!0,icon:C().U,iconStyle:b.cancelIcon,style:b.cancelButton,children:"Exit"})}),(0,O.jsx)("div",{style:b.centerColumn,children:(0,O.jsx)("div",{style:b.titleContainer,children:t?(0,O.jsxs)(O.Fragment,{children:[V&&(0,O.jsx)(S().Z,{disabled:!0,icon:V.icon,isEmptyPage:V.isEmptyPage,role:V.role,size:28,largeIcon:!0}),(0,O.jsx)(m().Z,{shouldWrap:!1,maxLines:1,store:t})]}):"New workflow"})}),(0,O.jsx)("div",{style:b.rightColumn,children:(0,O.jsx)(R,{threadId:o,store:t,clientStore:s})})]})]})}o(821057),o(670560),o(267602),o(653476),o(470928),o(30005),o(241792);var P=()=>o(752778),_=()=>o(846940),Z=()=>o(788860),z=()=>o(661727),M=()=>o(139224),E=()=>o(894704),H=()=>o(105348),L=()=>o(963310),U=()=>o(154186),N=()=>o(1910),q=()=>o(842574),F=()=>o(654133),Y=()=>o(125659),G=()=>o(641702),J=()=>o(832924),$=()=>o(466970),X=()=>o(228772),Q=()=>o(850790),ee=()=>o(756085),te=()=>o(759190),oe=()=>o(363253),ne=()=>o(168275),ie=()=>o(869851),le=()=>o(13234),re=()=>o(781443),se=()=>o(590470);const ce=(0,o(827282).IU)("exclamationArrowCircle",{viewBox:"0 0 20 20",svg:(0,O.jsx)("path",{d:"M1.646 10.078 3.28 7.781q.192-.26.438-.253.252 0 .437.253l1.627 2.304q.232.308.13.554t-.492.246H4.395q.136 1.026.622 1.907.492.882 1.237 1.545a5.5 5.5 0 0 0 1.709 1.025q.957.37 2.037.37 1.23 0 2.297-.486a5.5 5.5 0 0 0 1.832-1.32q.246-.238.52-.245.28-.014.485.177a.61.61 0 0 1 .205.479q.007.288-.24.533a7 7 0 0 1-2.269 1.64q-1.32.615-2.83.616a6.9 6.9 0 0 1-2.563-.479 7.1 7.1 0 0 1-2.154-1.34 7.2 7.2 0 0 1-1.552-1.989 6.8 6.8 0 0 1-.752-2.433h-.97q-.398 0-.492-.246-.096-.246.13-.56ZM4.9 5.258a7.1 7.1 0 0 1 2.263-1.64A6.66 6.66 0 0 1 10 3.003a6.8 6.8 0 0 1 2.55.485 7 7 0 0 1 2.16 1.34 7.2 7.2 0 0 1 1.552 1.99q.601 1.134.758 2.433h.95q.398 0 .493.246.102.246-.123.56l-1.627 2.297q-.192.26-.444.26-.246-.005-.431-.26l-1.634-2.296q-.226-.315-.13-.56.104-.247.492-.247h1.04a5.5 5.5 0 0 0-.636-1.9 5.6 5.6 0 0 0-1.23-1.545 5.5 5.5 0 0 0-1.703-1.033A5.5 5.5 0 0 0 10 4.397q-1.223 0-2.297.493a5.7 5.7 0 0 0-1.832 1.312q-.246.24-.526.246a.65.65 0 0 1-.479-.184.62.62 0 0 1-.219-.472q0-.287.253-.533ZM9.993 11.2q-.594 0-.615-.601l-.096-3.323a.61.61 0 0 1 .185-.492.7.7 0 0 1 .512-.191q.315 0 .52.198.205.192.191.485l-.109 3.323q-.014.6-.588.601m0 2.27a.84.84 0 0 1-.574-.212.71.71 0 0 1-.232-.54.69.69 0 0 1 .232-.533.82.82 0 0 1 .574-.22q.329 0 .56.213a.69.69 0 0 1 .24.54.69.69 0 0 1-.24.54.82.82 0 0 1-.56.212"})});var ae=()=>o(383507),de=()=>o(397643),ue=()=>o(443471),he=()=>o(721840),xe=()=>o(965913),ge=()=>o(421887),fe=()=>o(521777),pe=()=>o(435797),ye=()=>o(662406),Se=()=>o(844958),me=()=>o(315136),we=()=>o(998901),ve=()=>o(520849),Ce=()=>o(187435),ke=()=>o(152399),je=()=>o(832770),be=()=>o(338215),Ve=()=>o(699640),Ie=()=>o(868997),Ke=()=>o(905086),Te=()=>o(753970),Ae=()=>o(762382);const Be=800;function De(e){const{store:t}=e,o=(0,x().D)(t),n=(0,l().VK)((()=>o?(0,D().x)(o):void 0),[o]),i=(0,h().oD)(),s=null==i?void 0:i.settingsPane,c=(0,r().yK)((e=>({container:{width:"100%",maxWidth:"100%",height:"100%",margin:"0 auto",display:"flex",flexDirection:"column",padding:"16px 0",gap:36}})),[]);return o&&n&&s?(0,O.jsxs)("div",{style:c.container,children:[(0,O.jsx)(Oe,{store:t,settingsPane:s}),"instructions"===s.type&&(0,O.jsx)(We,{workflow:n,workflowStore:o,store:t,collectionContextStore:e.collectionContextStore}),"module"===s.type&&(0,O.jsx)(qe,{moduleKey:s.key,workflow:n,workflowStore:o,store:t},s.key),"database"===s.type&&(0,O.jsx)(Fe,{collectionId:s.collectionId,workflow:n,workflowStore:o,store:t,collectionContextStore:e.collectionContextStore}),"trigger"===s.type&&(0,O.jsx)(Ye,{triggerKey:s.key,workflow:n,workflowStore:o,store:t},s.key),"function"===s.type&&(0,O.jsx)(Je,{functionKey:s.key,workflow:n,workflowStore:o,store:t},s.key),"runs"===s.type&&(0,O.jsx)(Ie().r,{store:t,workflowStore:o}),"debug"===s.type&&(0,O.jsx)(Ge,{store:t,workflowStore:o})]}):null}function Oe(e){const{settingsPane:t,store:o}=e,n=(0,h().Xe)(o),i=(0,r().yK)((e=>({container:{width:Be,maxWidth:"100%",alignSelf:"center",padding:2,display:"flex",borderRadius:10,backgroundColor:e.accentColors.translucentGray[100]},tab:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:5,color:e.mediumTextColor,borderRadius:8,gap:6},selectedTab:{background:e.buttonBackground,color:e.regularTextColor},icon:{width:16,height:16,marginRight:8,display:"flex",alignItems:"center",fill:"currentColor"},tabContent:{display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,lineHeight:1.2},divider:{width:1,background:e.outlineButtonBorder}})),[]),l="runs"===t.type;return(0,O.jsxs)("div",{style:i.container,children:[(0,O.jsx)(U().Z,{style:{...i.tab,...l?{}:i.selectedTab},onClick:()=>n({type:"instructions"}),"aria-selected":!l,children:(0,O.jsxs)("div",{style:i.tabContent,children:[(0,ye().m)(i.icon),(0,O.jsx)("span",{children:"Configure"})]})}),(0,O.jsx)(U().Z,{style:{...i.tab,...l?i.selectedTab:{}},onClick:()=>n({type:"runs"}),"aria-selected":l,children:(0,O.jsxs)("div",{style:i.tabContent,children:[(0,te().Y)(i.icon),(0,O.jsx)("span",{children:"Run history"})]})})]})}function Re(){return(0,r().yK)((e=>({container:{width:Be,maxWidth:"100%",alignSelf:"center",display:"flex",flexDirection:"column",gap:28},sectionContainer:{display:"flex",flexDirection:"column",gap:2},sectionTitle:{fontWeight:p().Ue.semibold,fontSize:17,display:"flex",flexDirection:"row",alignItems:"center",gap:8},sectionContent:{},triggerIcon:{fill:e.icon.yellowPrimary}})),[])}function We(e){var t;const{workflow:o,workflowStore:r,store:s,collectionContextStore:c}=e,a=(0,i().O7)(),d=(0,h().Xe)(s),u=Re(),x=(null==o?void 0:o.modules)||[],g=(0,l().VK)((()=>(s.getCollectionPointers()??[]).map((e=>A().NW.createChildStore(s,e)))),[s]),f=(0,l().VK)((()=>c.settingsStore.state.open),[c]),p=(0,n.useRef)(null),y=x.filter((e=>"database"!==e.type&&"users"!==e.type&&"files"!==e.type&&"agent"!==e.type)),S=x.filter((e=>"agent"===e.type)),{runtimeActorHasSufficientAccess:m,grantAccess:w}=(0,Ke().fv)({workflowStore:r,store:s});return(0,O.jsxs)("div",{style:u.container,children:[(0,O.jsxs)("div",{style:u.sectionContainer,children:[(0,O.jsx)("div",{style:u.sectionTitle,children:"Description"}),(0,O.jsx)("div",{style:u.sectionContent,children:o.description})]}),!m&&(0,O.jsx)(Ee,{icon:se().G,label:"Allow read and write access to all databases?",right:(0,O.jsx)(Me,{onClick:w,icon:T().e,children:"Allow"})}),g.length>0&&(0,O.jsxs)("div",{style:u.sectionContainer,children:[(0,O.jsxs)("div",{style:u.sectionTitle,children:["Databases",(0,O.jsx)(N().Z,{ariaLabel:"Add database",icon:fe().R,ref:p,onClick:()=>{M().r$({collectionContextStore:e.collectionContextStore,collectionSettingsStore:e.collectionContextStore.settingsStore}),M().wl({collectionSettingsStore:e.collectionContextStore.settingsStore,item:{type:"createViewSource",existingCollectionStore:void 0,createdCollectionRecordPointerMap:void 0,onCollectionPicked:e=>{V().createAndCommit({userAction:"WorkflowEditor.addDatabase",environment:a,perform:t=>{(0,Ce().TR)({workflowStore:r,pointer:{table:P().vF,id:e.id,spaceId:e.getSpaceId()},transaction:t})}})}}})}}),f&&(0,O.jsx)(Y().L1,{value:e.collectionContextStore,children:(0,O.jsx)(H().f,{collectionContextStore:e.collectionContextStore,placementToOrigin:we().Placement.Bottom,alignmentToOrigin:we().Alignment.Start,originGap:0,marginTop:0,settingsOpen:!0,shouldScrollIntoView:!1,originRect:null===(t=p.current)||void 0===t?void 0:t.getBoundingClientRect()})})]}),(0,O.jsx)("div",{style:u.sectionContent,children:(0,O.jsx)(_e,{modules:x,collectionStores:g,workflowStore:r,store:s,collectionContextStore:c})})]}),y.length>0&&(0,O.jsxs)("div",{style:u.sectionContainer,children:[(0,O.jsx)("div",{style:u.sectionTitle,children:"Connections"}),(0,O.jsx)("div",{style:u.sectionContent,children:y.map((e=>(0,O.jsx)(He,{module:e,workflowStore:r,store:s,onClick:()=>d({type:"module",key:e.key})},e.key)))})]}),S.length>0&&(0,O.jsxs)("div",{style:u.sectionContainer,children:[(0,O.jsx)("div",{style:u.sectionTitle,children:"Agents"}),(0,O.jsx)("div",{style:u.sectionContent,children:S.map((e=>(0,O.jsx)(He,{module:e,workflowStore:r,store:s,onClick:()=>d({type:"module",key:e.key})},e.key)))})]}),o.triggers&&o.triggers.length>0&&(0,O.jsxs)("div",{style:u.sectionContainer,children:[(0,O.jsx)("div",{style:u.sectionTitle,children:"Automations"}),(0,O.jsx)("div",{style:u.sectionContent,children:o.triggers.map((e=>(0,O.jsx)(ze,{label:e.name,icon:Q().K,iconStyles:u.triggerIcon,onClick:()=>d({type:"trigger",key:e.key}),right:(0,O.jsx)(Ae().P,{trigger:e})},e.key)))})]}),o.functions&&o.functions.length>0&&(0,O.jsxs)("div",{style:u.sectionContainer,children:[(0,O.jsx)("div",{style:u.sectionTitle,children:"Functions"}),(0,O.jsx)("div",{style:u.sectionContent,children:o.functions.map((e=>(0,O.jsx)(ze,{label:e.name,icon:oe().z,onClick:()=>d({type:"function",key:e.key}),right:(0,O.jsx)(Ze,{fn:e})},e.key)))})]}),(0,O.jsx)(tt,{store:s})]})}function Pe(e,t){var o;return"database"===e.type&&(null===(o=e.state)||void 0===o||null===(o=o.pointer)||void 0===o?void 0:o.id)===t}function _e(e){const{store:t,collectionContextStore:o,workflowStore:n,collectionStores:i,modules:s}=e,c=(0,h().Xe)(t),a=(0,r().yK)((e=>({pageLinkIcon:{position:"absolute",width:"50%",height:"50%",right:0,bottom:0,fill:"dark"===e.mode?e.regularTextColor:"#3E3C38",stroke:"dark"===e.mode?e.surface.wash:"white"}})),[]),{databaseModules:d,unattachedDatabases:u}=(0,l().VK)((()=>{const e=[],n=[];return i.forEach((i=>{const l=s.find((e=>Pe(e,i.pointer.id)));if(l)e.push(l);else{const{name:e,icon:l}=function(e){var t;const{collectionStore:o,store:n,collectionContextStore:i,pageLinkStyles:l}=e,r=(0,G().Xh)(o.getName(),n),s=o.getParentId()===(null===(t=i.collectionViewBlockStore())||void 0===t?void 0:t.id),c=o.getIcon();return{name:r,icon:e=>{const t=c?(0,O.jsx)(S().Z,{icon:c,isEmptyPage:!1,size:20,disabled:!0,style:e}):(0,le().C)(e),o=s?void 0:(0,xe().Y)(l);return(0,O.jsxs)("div",{style:{...e,position:"relative"},children:[t,o]})}}}({collectionStore:i,store:t,collectionContextStore:o,pageLinkStyles:a.pageLinkIcon});n.push({name:e,icon:l,pointer:i.pointer})}})),{databaseModules:e,unattachedDatabases:n}}),[i,s,t,o,a.pageLinkIcon]);return(0,O.jsxs)(O.Fragment,{children:[d.map((e=>(0,O.jsx)(He,{module:e,workflowStore:n,store:t,onClick:()=>{var t;return c({type:"database",collectionId:(null===(t=e.state)||void 0===t||null===(t=t.pointer)||void 0===t?void 0:t.id)??""})}},e.key))),u.map((e=>{let{name:t,icon:o,pointer:n}=e;return(0,O.jsx)(ze,{label:t,icon:o,onClick:()=>{c({type:"database",collectionId:n.id})}},n.id)}))]})}function Ze(e){var t,o;const{fn:n}=e,i=(0,r().yK)((e=>({container:{color:e.text.tertiary}})),[]),l=(null===(t=n.tests)||void 0===t?void 0:t.length)??0,s=(null===(o=n.tests)||void 0===o?void 0:o.filter((e=>{var t;return null===(t=e.result)||void 0===t?void 0:t.passed})).length)??0;return(0,O.jsx)(F().Z,{renderTooltip:()=>(0,O.jsx)("div",{children:`${s} of ${l} functional tests passing`}),placement:we().Placement.Top,render:e=>(0,O.jsx)("span",{...e,style:i.container,children:`${s}/${l}`})})}function ze(e){const{label:t,icon:o,onClick:n,right:i,iconStyles:l}=e,s=(0,r().yK)((e=>({container:{fontWeight:p().Ue.medium,textOverflow:"ellipsis",whiteSpace:"nowrap",padding:"6px 8px",display:"flex",alignItems:"center",gap:8,height:"auto",margin:"0 -8px"},icon:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,flexGrow:0,width:24,height:24,fill:e.icon.secondary,margin:0},labelContainer:{display:"flex",alignItems:"center",alignSelf:"stretch",flex:1,minWidth:0},labelText:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",minWidth:0}})),[]);return(0,O.jsxs)(y().Z,{shouldShrink:!1,icon:o,iconStyle:{...s.icon,...l},onClick:n,style:s.container,children:[(0,O.jsx)("div",{style:s.labelContainer,children:(0,O.jsx)("div",{style:s.labelText,children:t})}),(0,O.jsx)("div",{style:{flexShrink:0}}),i]})}function Me(e){const{icon:t,children:o,onClick:n}=e,i=(0,r().yK)((e=>({buttonStyle:{display:"inline-flex",alignItems:"center",flexShrink:0,whiteSpace:"nowrap",height:28,borderRadius:6,fontSize:14,lineHeight:1.2,minWidth:0,paddingLeft:t?6:8,paddingRight:8,color:e.text.contrastPrimary,background:e.text.uiYellowPrimary},hoveredStyle:{background:e.accentColors.yellow[600]},pressedStyle:{background:(0,z().Fq)(e.text.uiYellowPrimary,.8)},iconStyle:{width:14,height:14,fill:e.text.contrastPrimary,marginRight:6}})),[t]);return(0,O.jsxs)(U().Z,{style:i.buttonStyle,hoveredStyle:i.hoveredStyle,pressedStyle:i.pressedStyle,onClick:n,children:[t&&t(i.iconStyle),o]})}function Ee(e){const{icon:t,label:o,right:n}=e,i=(0,r().yK)((e=>({container:{display:"flex",backgroundColor:e.accentColors.yellow[100],borderRadius:10,padding:"8px 8px 8px 10px",alignItems:"center",justifyContent:"space-between"},labelContainer:{display:"flex",alignItems:"center",gap:8},label:{color:e.text.primary},icon:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,flexGrow:0,width:16,height:16,color:e.accentColors.yellow[400]},rightContainer:{display:"flex",alignItems:"center",gap:4}})),[]);return(0,O.jsxs)("div",{style:i.container,children:[(0,O.jsxs)("div",{style:i.labelContainer,children:[t(i.icon),(0,O.jsx)("span",{style:i.label,children:o})]}),(0,O.jsx)("div",{style:i.rightContainer,children:n})]})}function He(e){const{module:t,workflowStore:o,store:n,onClick:i}=e,s=(0,Z().YB)(),c=(0,r().yK)((e=>({failedIcon:{width:16,height:16,fill:e.accentColors.red[400]}})),[]),a=ke()._T.getName(t,s),d=(0,l().VK)((()=>ke()._T.isValidAndConnected(t,o,n)),[t,o,n]);return(0,O.jsx)(ze,{label:a,icon:Le(t),onClick:i,right:d?void 0:(0,se().G)(c.failedIcon)})}function Le(e){return"database"===e.type?re().v:"slack"===e.type?pe().P:"search"===e.type?he().v:"users"===e.type?ge().f:"agent"===e.type?ae().Q:"recurrence"===e.type?ue().r:"files"===e.type?de().R:"ai"===e.type?Se().t:"discussions"===e.type?ne().Y:ie().L}function Ue(e){const{store:t}=e,o=(0,r().yK)((e=>({container:{padding:2,alignSelf:"flex-start",color:e.text.tertiary,fontWeight:p().Ue.medium},icon:{fill:e.icon.tertiary,marginRight:4,width:16,height:16}})),[]),i=(0,h().Xe)(t),l=(0,n.useCallback)((()=>{i({type:"instructions"})}),[i]);return(0,O.jsx)(y().Z,{shouldShrink:!1,icon:ee().f,iconStyle:o.icon,onClick:l,style:o.container,children:"Back"})}function Ne(e){const{left:t,right:o,store:n}=e,i=(0,r().yK)((e=>({container:{display:"flex",flexDirection:"column",gap:4},titleContainer:{display:"flex",alignItems:"center",justifyContent:"space-between"},sideContainer:{display:"flex",alignItems:"center",gap:8}})),[]);return(0,O.jsxs)("div",{style:i.container,children:[(0,O.jsx)(Ue,{store:n}),(0,O.jsxs)("div",{style:i.titleContainer,children:[(0,O.jsx)("div",{style:i.sideContainer,children:t}),(0,O.jsx)("div",{style:i.sideContainer,children:o})]})]})}function qe(e){var t;const{workflow:o,workflowStore:n,store:i,moduleKey:s}=e,c=(0,Z().YB)(),a=(0,r().yK)((e=>({container:{width:Be,maxWidth:"100%",alignSelf:"center",display:"flex",flexDirection:"column",gap:4},failedIcon:{width:16,height:16,fill:e.accentColors.red[400]},errorMessageContainer:{display:"flex",flexDirection:"column",gap:8,padding:8,borderRadius:4,backgroundColor:e.accentColors.red[100]},errorMessage:{display:"flex",alignItems:"center",gap:8},titleIcon:{width:40,height:40,fill:e.icon.primary},titleText:{fontSize:32,fontWeight:p().Ue.bold}})),[]),d=(0,l().VK)((()=>{var e;const t=null===(e=o.modules)||void 0===e?void 0:e.find((e=>e.key===s));if("database"===(null==t?void 0:t.type))throw new Error("Database modules should be handled by WorkflowDatabaseSection");return t}),[o,s]),u=(0,l().VK)((()=>{if(d&&!ke()._T.isValidAndConnected(d,n,i))return ke()._T.getMessageIfNotValid(d,c)}),[d,n,i,c]);if(!d)return null;const h=ke()._T.getName(d,c),x=Le(d),g=_().O[d.type];return g?(0,O.jsxs)("div",{style:a.container,children:[(0,O.jsx)(Ne,{store:i,left:(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("span",{style:a.titleIcon,children:x(a.titleIcon)}),(0,O.jsx)("span",{style:a.titleText,children:h})]}),right:(0,O.jsx)(Ve().DV,{module:d,store:i,workflowStore:n})}),"oauth2"===(null===(t=g.authentication)||void 0===t?void 0:t.type)&&i&&n&&(0,O.jsx)(Ve().BT,{store:i,module:d,workflowStore:n}),"ai"===d.type&&n&&(0,O.jsx)(Ve().ti,{workflowStore:n,module:d}),u&&(0,O.jsx)("div",{style:a.errorMessageContainer,children:(0,O.jsxs)("div",{style:a.errorMessage,children:[(0,se().G)(a.failedIcon),u]})}),(0,O.jsx)(et,{children:(0,O.jsx)(ot,{module:d,workflowStore:n})})]}):null}function Fe(e){const{collectionId:t,workflow:o,workflowStore:s,store:c,collectionContextStore:a}=e,d=(0,i().O7)(),u=(0,X().r)(),h=(0,n.useMemo)((()=>{if(!u)return;const e={table:P().vF,id:t,spaceId:u.id};return new(A().NW)(d,e)}),[t,u,d]),x=(0,l().VK)((()=>{var e;if(!t)return;const n=null===(e=o.modules)||void 0===e?void 0:e.find((e=>Pe(e,t)));if(!n)return;return{module:n,isValidAndConnected:ke()._T.isValidAndConnected(n,s,c)}}),[o,t,s,c]),g=(0,r().yK)((e=>({headerContainer:{paddingLeft:96,paddingRight:40},titleContainer:{display:"flex",alignItems:"center",gap:8},titleIcon:{width:40,height:40,fill:e.icon.primary}})),[]),[f,p]=(0,n.useState)(void 0),y=(0,l().VK)((()=>a.collectionViewBlockStore()),[a]),S=(0,n.useCallback)((e=>{J().default.PageScroller=e}),[]),m=(0,l().SI)((()=>!1),[]),[w,v]=(0,n.useState)(!1),C=(0,n.useCallback)((()=>{v(!0)}),[]),k=(0,n.useCallback)((e=>{v(e)}),[]);return y&&h?(0,O.jsxs)(q().Z,{style:{flex:1},ref:S,type:ve().Z.Y,children:[x&&(0,O.jsx)(Te().o,{store:c,workflowStore:s,module:x.module,open:w,onOpenChange:k}),(0,O.jsxs)("div",{style:g.headerContainer,children:[(0,O.jsx)(Ue,{store:c}),x&&!x.isValidAndConnected&&(0,O.jsx)(Ee,{icon:ce,label:"This database has unsynced changes. Sync to keep things running smoothly.",right:(0,O.jsx)(Me,{onClick:C,icon:me().b,children:"Sync changes"})}),(0,O.jsx)("div",{style:g.titleContainer,children:f&&(0,O.jsx)(E().x,{collectionContextStore:f,showHoverActionsStore:m,titleStyle:{fontSize:32}})})]}),(0,O.jsx)(L().DZ,{store:y,isFullScreen:!0,disabled:!1,headerAllowedActions:["filter","sort","automations","search","viewSettings"],headerActionsBehavior:"always_show",setCollectionContextStore:e=>{p(e),e.setContext({type:"collectionSettings",collectionViewBlockStore:y,collectionStore:h})}})]}):null}function Ye(e){const{workflow:t,workflowStore:o,store:n,triggerKey:i}=e,s=(0,r().yK)((e=>({container:{width:Be,maxWidth:"100%",alignSelf:"center",display:"flex",flexDirection:"column",gap:4},titleText:{fontSize:17,fontWeight:p().Ue.semibold}})),[]),c=(0,l().VK)((()=>{var e;return null===(e=t.triggers)||void 0===e?void 0:e.find((e=>e.key===i))}),[t,i]);return c?(0,O.jsxs)("div",{style:s.container,children:[(0,O.jsx)(Ne,{left:(0,O.jsx)("span",{style:s.titleText,children:c.name}),store:n}),(0,O.jsx)(Ae().i,{triggerKey:i,store:n,workflowStore:o,hideTitle:!0}),(0,O.jsx)(et,{children:(0,O.jsx)(nt,{trigger:c,workflowStore:o})})]}):null}function Ge(e){const{store:t,workflowStore:o}=e,n=Re(),i=(0,r().yK)((e=>({titleText:{fontSize:17,fontWeight:p().Ue.semibold}})),[]),s=(0,h().Xe)(t),c=(0,l().VK)((()=>{var e;return null===(e=o.getData())||void 0===e?void 0:e.modules}),[o]);return(0,O.jsxs)("div",{style:n.container,children:[(0,O.jsx)(Ne,{left:(0,O.jsx)("span",{style:i.titleText,children:"Debug"}),store:t}),(0,O.jsxs)("div",{style:n.sectionContainer,children:[(0,O.jsx)("div",{style:n.sectionTitle,children:"All modules"}),(0,O.jsx)("div",{style:n.sectionContent,children:null==c?void 0:c.map((e=>(0,O.jsx)(He,{module:e,workflowStore:o,store:t,onClick:()=>s({type:"module",key:e.key})},e.key)))})]}),(0,O.jsx)(Ke().ur,{workflowStore:o,hideTitle:!0})]})}function Je(e){const{workflow:t,workflowStore:o,store:n,functionKey:i}=e,s=(0,r().yK)((e=>({container:{width:Be,maxWidth:"100%",alignSelf:"center",display:"flex",flexDirection:"column",gap:4},titleText:{fontSize:17,fontWeight:p().Ue.semibold}})),[]),c=(0,l().VK)((()=>{var e;return null===(e=t.functions)||void 0===e?void 0:e.find((e=>e.key===i))}),[t,i]);return c?(0,O.jsxs)("div",{style:s.container,children:[(0,O.jsx)(Ne,{left:(0,O.jsx)("span",{style:s.titleText,children:c.name}),store:n}),(0,O.jsx)(be().H,{functionKey:i,workflowStore:o,hideTitle:!0}),(0,O.jsx)($e,{fn:c,workflow:t,workflowStore:o,functionKey:i}),(0,O.jsx)(et,{children:(0,O.jsx)(it,{fn:c,workflowStore:o})})]}):null}function $e(e){var t;const{fn:o,workflowStore:n,functionKey:i}=e,l=(0,r().yK)((e=>({container:{display:"flex",flexDirection:"column",gap:4,borderTop:`1px solid ${e.accentColors.gray[100]}`,marginTop:12,paddingTop:8},titleText:{fontSize:17,fontWeight:p().Ue.semibold},sideContainer:{display:"flex",alignItems:"center",gap:8}})),[]);return(0,$().E)("workflows_debug_tools")?(0,O.jsxs)("div",{style:l.container,children:[(0,O.jsx)("span",{style:l.titleText,children:"Tests"}),null===(t=o.tests)||void 0===t?void 0:t.map((e=>(0,O.jsx)(Xe,{test:e,workflowStore:n,functionKey:i},e.description.name)))]}):null}function Xe(e){var t;const{test:o,workflowStore:l,functionKey:s}=e,[c,a]=(0,n.useState)(!1),d=(0,i().O7)(),u=(0,r().yK)((e=>({container:{display:"flex",flexDirection:"column",gap:4},titleButton:{justifyContent:"space-between"},sideContainer:{display:"flex",alignItems:"center",gap:8},passedIcon:{width:14,height:14,fill:e.accentColors.green[400]},failedIcon:{width:16,height:16,fill:e.accentColors.red[400]}})),[]),h=(0,n.useCallback)((e=>{if(!l)return;const t=JSON.parse(e);V().createAndCommit({userAction:"WorkflowTest.handleSaveTest",environment:d,canUndo:!0,perform:e=>(0,B().gM)({workflowStore:l,functionKey:s,test:t,transaction:e})})}),[l,s,d]),x=(0,n.useCallback)((()=>a((e=>!e))),[]);return(0,O.jsxs)("div",{style:u.container,children:[(0,O.jsxs)(y().Z,{onClick:x,style:u.titleButton,children:[o.description.name,null!==(t=o.result)&&void 0!==t&&t.passed?(0,T().e)(u.passedIcon):(0,C().U)(u.failedIcon)]}),c&&(0,O.jsx)(je().c,{value:Qe(o),onSave:h,disabled:!l,language:"json"})]})}function Qe(e){return JSON.stringify(e,null,2)}function et(e){const{children:t}=e,[o,i]=(0,n.useState)(!1),l=(0,$().E)("workflows_debug_tools"),s=(0,r().yK)((e=>({container:{display:"flex",flexDirection:"column",gap:4,borderTop:`1px solid ${e.accentColors.gray[100]}`,marginTop:12,paddingTop:8}})),[]),c=(0,n.useCallback)((()=>i((e=>!e))),[]);return l?(0,O.jsxs)("div",{style:s.container,children:[(0,O.jsx)(y().Z,{onClick:c,isGray:!0,children:o?"Hide debug JSON":"View debug JSON"}),o&&t]}):null}function tt(e){const{store:t}=e,o=(0,$().E)("workflows_debug_tools"),i=(0,h().Xe)(t),l=(0,n.useCallback)((()=>{i({type:"debug"})}),[i]),s=(0,r().yK)((e=>({container:{display:"flex",flexDirection:"column",gap:4,borderTop:`1px solid ${e.accentColors.gray[100]}`,marginTop:12,paddingTop:8}})),[]);return o?(0,O.jsx)("div",{style:s.container,children:(0,O.jsx)(y().Z,{onClick:l,isGray:!0,children:"View debug information"})}):null}function ot(e){const{module:t,workflowStore:o}=e,l=(0,i().O7)(),r=(0,n.useCallback)((e=>{const t=JSON.parse(e);V().createAndCommit({userAction:"WorkflowEditorSettings.DebugModuleTools.handleSave",environment:l,canUndo:!0,perform:e=>(0,B().mJ)({workflowStore:o,module:t,transaction:e})})}),[o,l]);return(0,O.jsx)(je().c,{value:Qe(t),onSave:r,language:"json"})}function nt(e){const{trigger:t,workflowStore:o}=e,l=(0,i().O7)(),r=(0,n.useCallback)((e=>{const t=JSON.parse(e);V().createAndCommit({userAction:"WorkflowEditorSettings.DebugTriggerTools.handleSave",environment:l,canUndo:!0,perform:e=>(0,B().DE)({workflowStore:o,trigger:t,transaction:e})})}),[o,l]);return(0,O.jsx)(je().c,{value:Qe(t),onSave:r,language:"json"})}function it(e){const{fn:t,workflowStore:o}=e,l=(0,i().O7)(),r=(0,n.useCallback)((e=>{const t=JSON.parse(e);V().createAndCommit({userAction:"WorkflowEditorSettings.DebugFunctionTools.handleSave",environment:l,canUndo:!0,perform:e=>(0,B().Kj)({workflowStore:o,functionValue:t,transaction:e})})}),[o,l]);return(0,O.jsx)(je().c,{value:Qe(t),onSave:r,language:"json"})}var lt=()=>o(420645);function rt(e){const{workflowBlockStore:t,collectionContextStore:o,threadId:n,onThreadChange:i,clientStore:r}=e,s=(0,l().VK)((()=>({type:"workflow",workflowBlockId:t.id})),[t]);return(0,O.jsx)(lt().C,{threadId:n,config:s,onThreadChange:i,collectionContextStore:o,clientStore:r})}function st(){const e=(0,r().yK)((e=>({container:{width:"100%",backgroundColor:e.surface.wash,cursor:"default"},innerContainer:{overflowY:"auto",padding:"20px 20px 0 20px",height:"100%",marginTop:-20,minWidth:d().DJ,zIndex:0,position:"relative"},splitViewContainer:{height:"100%",background:e.contentBackground,flexDirection:"row",flexGrow:1,borderRadius:"12px 12px 0 0",boxShadow:"0px 9px 12px 0px rgba(15, 15, 15, 0.1)",borderColor:e.accentColors.gray[75],borderWidth:1,overflowY:"auto",display:"flex"},sidebarContainer:{flex:1,display:"flex",flexDirection:"column",borderRightWidth:1,borderRightStyle:"solid",borderRightColor:e.accentColors.gray[75]},detailsContainer:{height:"100%",flex:2,display:"flex",flexDirection:"column",overflowY:"auto"}})),[]),t=(0,i().O7)(),o=void 0!==(0,h().oD)(),g=(0,l().VK)((()=>{const e=u().default.state.mainEditorCurrentBlockStore;return null!=e&&e.isCollectionView()?e:void 0}),[]),f=(0,n.useCallback)((()=>{g&&(0,h().r3)({environment:t,store:g})}),[t,g]),p=(0,h().Y$)(),y=(0,x().D)(g),[S,m]=(0,n.useState)(void 0),w=(0,n.useCallback)((e=>{let{id:t}=e;m(t)}),[]);if(!g||!p)return null;const v=s().r;return(0,O.jsx)(c().c,{isOpen:o,onDismiss:f,areaConstraint:{width:{type:"fill"},height:{type:"fill"}},render:()=>(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(W,{store:g,threadId:S,clientStore:v}),(0,O.jsx)(a().gq,{style:e.innerContainer,children:(0,O.jsxs)("div",{style:e.splitViewContainer,children:[(0,O.jsx)("div",{style:e.sidebarContainer,children:(0,O.jsx)(rt,{workflowBlockStore:g,workflowStore:y,collectionContextStore:p,threadId:S,onThreadChange:w,clientStore:v})}),(0,O.jsx)("div",{style:e.detailsContainer,children:(0,O.jsx)(De,{collectionContextStore:p,store:g})})]})})]})})}},275582:(e,t,o)=>{o.d(t,{D:()=>r});var n=()=>o(142735),i=()=>o(361929),l=()=>o(826955);function r(e){return(0,n().VK)((()=>{var t;if(!e)return;const o=null===(t=e.getFormat())||void 0===t?void 0:t.workflow_id;return o?l().hA.createChildStore(e,{table:i().An,id:o,spaceId:e.getSpaceId()}):void 0}),[e])}}}]);