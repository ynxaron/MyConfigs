"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[18216],{418216:(e,t,i)=>{i.r(t),i.d(t,{measurePageRenderMetrics:()=>k,setInitialRenderCompleted:()=>T,setSubMetric:()=>f,setSubMetricsAtRenderCallback:()=>S,updateMetricData:()=>v,updateMetricDataWithIsPushTag:()=>b});var a=()=>i(469691),r=()=>i(990352),n=()=>i(22648),o=()=>i(594546),s=()=>i(512258),l=()=>i(138892),c=()=>i(410329),d=()=>i(148126),m=()=>i(275200),u=()=>i(620218),_=()=>i(749826),g=()=>i(601952),h=()=>i(235044),p=()=>i(842918);function S(e){const{mainStartTime:t,prefetchInitiatedTime:i,statsigBootupBlockingStartTime:a,renderStartTime:n,renderEndTime:o}=e,s=r().getAppStartTime();if(!s)return;const l={app_start_to_main_start:{startTime:s,endTime:t},main_start_to_prefetch_initiated:{startTime:t,endTime:i},prefetch_initiated_to_statsig_bootup_blocking_start:{startTime:i,endTime:a},statsig_bootup_blocking:{startTime:a,endTime:n},render_start_to_render_end:{startTime:n,endTime:o}};g().default.state.subMetricsStore.update((e=>({...e,...l})))}function f(e){const{name:t,endTime:i}=e,a=e.startTime(g().default.state.subMetricsStore.state);a&&g().default.state.subMetricsStore.update((e=>({...e,[t]:{startTime:a,endTime:i}})))}function v(e){g().default.state.metricDataStore.update((t=>({...t,...e})))}function T(){g().default.update((e=>({...e,initialRenderCompleted:!0})))}function b(e){const t=e.RouterStore.state;let i;var a;"page"===t.route.name&&(i=t.route.mobileData,v({is_push:null===(a=i)||void 0===a?void 0:a.isPush}))}function k(e){let{environment:t,isEditable:i,isHomePage:n,isWikiHome:l,isPageWithCustomLayout:c,idSchema:S}=e;const{initialRoute:{name:v},route:b}=t.RouterStore.state,{initialRenderCompleted:k,initialRenderAfterLoginCompleted:C}=g().default.state,I=s().isPrewarmedTabInitialRender(t),y=(0,d().Sr)(t);k?C||"login"!==v?function(e,t){const i="page"===t.name?t.mobileData:void 0,a=p().Z.popTimings();if(a){const{navigationStart:t,requestFirstChunkStart:r,requestFirstChunkEnd:n,requestFirstChunkSource:s,pageViewBlockRender:l}=a,c=performance.now();u().default.measure({metricName:"navigation_page_render",startTime:t,endTime:c},{environment:e,data:{is_push:(null==i?void 0:i.isPush)??!1,wasm_sqlite_initialized:g().default.state.metricDataStore.state.wasm_sqlite_initialized,wasm_sqlite_storage:g().default.state.metricDataStore.state.wasm_sqlite_storage,is_load_cached_page_chunk_v2:_().default.checkGate({gateName:"load_cached_page_chunk_multi_cell_enabled"}),enable_modern_scroller:m().ug()}}),(0,o().Vi)({eventName:"navigation_page_render_sub_metric",sampling:{behavior:"statsig",fallbackBehavior:"statsig",statsigNotAvailableBehavior:"drop"}}).then((i=>{if(!i)return;const a=t=>({environment:e,data:{type:t,enable_modern_scroller:m().ug(),chunk_source:s},sampleDecision:i});r&&u().default.measure({metricName:"navigation_page_render_sub_metric",startTime:t,endTime:r},a("navigation_start_to_request_first_chunk_start")),r&&n&&u().default.measure({metricName:"navigation_page_render_sub_metric",startTime:r,endTime:n},a("request_first_chunk_start_to_request_first_chunk_end")),n&&l&&u().default.measure({metricName:"navigation_page_render_sub_metric",startTime:n,endTime:l},a("request_first_chunk_end_to_pvb_render")),l&&u().default.measure({metricName:"navigation_page_render_sub_metric",startTime:l,endTime:c},a("pvb_render_to_handle_navigation_render"))}))}h().Z.state.isMeasuring&&h().Z.update((e=>({...e,isMeasuring:!1})))}(t,b):function(e){u().default.DO_NOT_USE_measureLegacy("initial_page_render_after_login",{environment:e}),g().default.update((e=>({...e,initialRenderAfterLoginCompleted:!0})))}(t):I?function(e){let{environment:t,initialRoute:i,isEditable:a,isHomePage:r,isWikiHome:n,isPageWithCustomLayout:o,isPublicDomain:s,idSchema:l}=e;T();const c=performance.now();f({name:"await_page_chunk_end_to_browser_repaint_start",startTime:e=>{var t;return null===(t=e.await_page_chunk_start_to_await_page_chunk_end)||void 0===t?void 0:t.endTime},endTime:c});const d=g().default.state.prewarmedTabAppStartTimeOverride;d&&u().default.measure({metricName:"initial_page_render",startTime:d,endTime:c},{environment:t,data:P({initialRoute:i,isEditable:a,isHomePage:r,isWikiHome:n,isPageWithCustomLayout:o,isPublicDomain:s,idSchema:l,isPrewarmedTab:!0,prewarmedTabNavigationStart:d}),shouldSendIfStatsigNotInitialized:!0});h().Z.state.isMeasuring&&h().Z.update((e=>({...e,isMeasuring:!1})))}({environment:t,initialRoute:v,isEditable:i,isHomePage:n,isWikiHome:l,isPageWithCustomLayout:c,isPublicDomain:y,idSchema:S}):function(e){var t;let{environment:i,initialRoute:n,isEditable:o,isHomePage:s,isWikiHome:l,isPageWithCustomLayout:c,isPublicDomain:d,idSchema:m}=e;const{initialLoadCachedPageChunkCalledAt:_}=g().default.state;T();const h=Boolean(null===(t=performance)||void 0===t?void 0:t.mark)?performance.mark("initial_page_render").startTime:performance.now();a().h1.mark("initial_page_render"),f({name:"await_page_chunk_end_to_browser_repaint_start",startTime:e=>{var t;return null===(t=e.await_page_chunk_start_to_await_page_chunk_end)||void 0===t?void 0:t.endTime},endTime:h});const p=r().getAppStartTime();p&&f({name:"page_origin_to_app_start",startTime:r().getPageOriginTime,endTime:p});u().default.measureFromPageOrigin({metricName:"initial_page_render",endTime:h},{environment:i,data:P({initialRoute:n,isEditable:o,isHomePage:s,isWikiHome:l,isPageWithCustomLayout:c,isPublicDomain:d,idSchema:m,prefetchedQueryCollection:w(i),isPrewarmedTab:!1}),shouldSendIfStatsigNotInitialized:!0}),void 0!==_&&u().default.DO_NOT_USE_measureFromPageOriginLegacy({metricName:"load_cached_page_chunk_wait_time",endTime:_},{environment:i,data:{initial_route:n},shouldSendIfStatsigNotInitialized:!0,sendToStatsig:!0})}({environment:t,initialRoute:v,isEditable:i,isHomePage:n,isWikiHome:l,isPageWithCustomLayout:c,isPublicDomain:y,idSchema:S})}function P(e){const{initialRoute:t,isEditable:i,isHomePage:a,isWikiHome:n,isPageWithCustomLayout:o,isPublicDomain:l,isPrewarmedTab:d,idSchema:m,prefetchedQueryCollection:u}=e;return{...s().getSubMetricsAndMetricDataForTracking(e.isPrewarmedTab?{isPrewarmedTab:!0,prewarmedTabNavigationStart:e.prewarmedTabNavigationStart}:{isPrewarmedTab:!1}),initial_route:t,is_editable:i,is_home_page:a,is_page_with_custom_layout:o,is_public_domain:l,profiling_tool:(0,c().getProfilingToolForSession)(),is_wiki_home:n,time_origin_to_app_start:r().getAppStartTime(),includes_page_origin_to_app_start:!0,is_load_cached_page_chunk_v2:_().default.checkGate({gateName:"load_cached_page_chunk_multi_cell_enabled"}),id_schema:m,prefetched_cvb:u,is_prewarmed_tab:d}}function w(e){var t;const i=e.RouterStore.state.route;if("page"!==i.name||!i.blockId)return!1;const a=n()._x.lookupViewId(i.blockId),r=(0,l().Z)(a),o=null===(t=e.prefetchCache)||void 0===t?void 0:t.getPrefetchAnalytic(r);return"hit-match"===(null==o?void 0:o.type)||"attempted"===(null==o?void 0:o.type)||"hit-mismatch"===(null==o?void 0:o.type)}},22648:(e,t,i)=>{i.d(t,{$W:()=>c,KV:()=>d,_x:()=>l});i(267602),i(30005);var a=()=>i(732811),r=()=>i(70186),n=()=>i(245015),o=()=>i(138892),s=()=>i(466970);const l=new class{constructor(){this.currentPageId=void 0,this.cacheIntoLocalStorage=!1,this._localStorage=void 0}startCachingViewIds(e){this.currentPageId=e,this.cacheIntoLocalStorage=!0}stopCachingViewIds(){this.currentPageId=void 0,this.cacheIntoLocalStorage=!1}registerForCurrentPage(e,t){if(!this.cacheIntoLocalStorage||this.currentPageId!==e)return;const i=this.entryForPage(e);if(this.cacheIntoLocalStorage=!1,i.v.includes(t))return i.t=Date.now(),void this.writeToLocalStorage();i.v=[t],i.t=Date.now(),this.writeToLocalStorage()}lookupViewId(e){const t=this.localStorage[e];return null==t?void 0:t.v[0]}clear(){this.currentPageId=void 0,this.cacheIntoLocalStorage=!1,this._localStorage=void 0}get localStorage(){return this._localStorage??(this._localStorage=n().Z.get(o().q)||Object.create(null))}entryForPage(e){let t=this.localStorage[e];return t||(t={v:[],t:0},this.localStorage[e]=t),t}writeToLocalStorage(){this.limitLocalStorageSize(),n().Z.set(o().q,this.localStorage)}limitLocalStorageSize(){const e=Object.keys(this.localStorage);if(e.length>=100){const t={timestamp:Number.MAX_SAFE_INTEGER,key:void 0};e.forEach((e=>{e!==this.currentPageId&&this.localStorage[e].t<t.timestamp&&(t.timestamp=this.localStorage[e].t,t.key=e)})),t.key&&delete this.localStorage[t.key]}}};function c(e){let{collectionContextStore:t,isFullScreen:i,wasCreatedThisSessionStore:r,environment:n}=e;const o=(0,s().E)("prefetch_inline_collection");(0,a().K)((()=>{var e;if(i||!o||r.state)return;const a=null===(e=t.collectionViewStore())||void 0===e?void 0:e.id,s=n.RouterStore.state.route;if("page"!==s.name)return;const c=s.blockId;c&&a&&l.registerForCurrentPage(c,a)}))}function d(e){let{pageId:t,isFrameContext:i}=e;(0,a().K)((()=>{i&&l.startCachingViewIds(t)})),(0,r().L)((()=>{i&&l.stopCachingViewIds()}))}}}]);