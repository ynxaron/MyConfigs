"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[31655],{579217:(e,t,o)=>{o.d(t,{_:()=>a,s:()=>i});var n=()=>o(677559);const i=(0,n().kF)(new(n().Ss)("UniversalQnaModals",(async()=>await Promise.all([o.e(62743),o.e(52774),o.e(90698),o.e(84885),o.e(37358),o.e(5242),o.e(7312),o.e(90424),o.e(81580),o.e(84325),o.e(31189),o.e(69343),o.e(46293),o.e(2971),o.e(80741),o.e(72586),o.e(53335),o.e(71896),o.e(46616),o.e(54940),o.e(49396),o.e(98721),o.e(98032),o.e(57229),o.e(63707),o.e(86609),o.e(91253),o.e(4642),o.e(5006),o.e(6612),o.e(61171),o.e(23179),o.e(75377),o.e(31020),o.e(2942),o.e(73682),o.e(58591),o.e(54803),o.e(1953),o.e(10216),o.e(58565),o.e(69197),o.e(42055),o.e(38739),o.e(44751),o.e(81567),o.e(58183)]).then(o.bind(o,260685)))),(e=>e.UniversalQnaModals)),a=(0,n().kF)(new(n().Ss)("SlackConnectionOptions",(async()=>await o.e(16982).then(o.bind(o,945272)))),(e=>e.SlackConnectionOptions))},380549:(e,t,o)=>{o.r(t),o.d(t,{AutomationWorkflowEditor:()=>fa,AutomationWorkflowEditorActionSection:()=>da,ButtonBlockUrlPreviewPopup:()=>wa,PlacedButtonBlockEditor:()=>xa,automationActions:()=>i(),automationExecutionActions:()=>n});var n={};o.r(n),o.d(n,{executeClientAutomation:()=>je});var i=()=>o(49396),a=(o(670560),o(122556),o(582845),o(250570),o(533019),o(721473),o(788208),o(22624),o(267602),o(916054),o(653476),o(241792),o(228244),()=>o(969583)),r=()=>o(513670),l=()=>o(855741),s=()=>o(696459),c=()=>o(360517),u=()=>o(870691),d=()=>o(227666);const p=(0,c().Fd)((async function(e){const{context:t,executeAutomationActionFn:o}=e,{actionModels:n,automationModel:i,contextType:a,runtimeStats:p}=t;let g=t.values;const h=performance.now();let y,f={value:{success:!0}};if("button_block"===a||"button_property"===a){if(!i.isButtonType())return{error:new(c()._z)({message:`Automation trigger (${i.getTriggerType()}) does not match context type (${a}).`})};const e=i.getTrigger();y=(0,d().o)(i.getTriggerType()).execute(t,e)}else if("event"===a){if(!i.isEventType()&&!i.isNotificationType())return{error:new(c()._z)({message:`Automation trigger (${i.getTriggerType()}) does not match context type (${a}).`})};const e=i.getTrigger();y=(0,d().o)(i.getTriggerType()).execute(t,e)}else if("recurrence"===a){if(!i.isRecurrenceType())return{error:new(c()._z)({message:`Automation trigger (${i.getTriggerType()}) does not match context type (${a}).`})};const e=i.getTrigger();y=(0,d().o)(i.getTriggerType()).execute(t,e)}else(0,s().t1)(t);if(l().x.isFail(y))return y;g=g.concat((0,r().d9)(y.value.values));const v=o??m;for(const r of n){const e=await v({action:r,values:g,executionContext:t});if(l().x.isFail(e)){f=e;break}if(g=g.concat(e.value.values),e.value.stopExecution)break}const x=await t.executeEffectMap.updateLastRunTimesForObservability({automationModel:t.automationModel,executeResult:f});l().x.isFail(x)&&(f=x);const S=Math.trunc(performance.now()-h);p&&(p.executionStartTime=h,p.executionDurationMs=S,p.executionSuccess=l().x.isSuccess(f),u().Fv.aggregate(p));return f}),(e=>e.context.automationModel.id));async function m(e){const{action:t,values:o,executionContext:n}=e,i=(0,a().getActionRegistryItem)(t.getType());return i.requiresPriorTransactionsCommitted&&await n.executeEffectMap.waitForTransactionsCommitted(),await i.execute({...n,values:o},t)}var g=()=>o(92960),h=()=>o(955620),y=()=>o(473304);var f=()=>o(520509),v=()=>o(799891),x=()=>o(998411),S=()=>o(422894),b=()=>o(989478),C=()=>o(342792),k=()=>o(207874),j=()=>o(102182),M=()=>o(205228),T=()=>o(718048),w=()=>o(141735),A=()=>o(594546),I=()=>o(615676),_=()=>o(527278),P=()=>o(749826),V=()=>o(697623),B=()=>o(620218);const R={...u().Fv,logNotionPerformance(e){const{automationStats:t,environment:o}=e;if((0,u().uz)(t)){var n;const e={metricName:"automation.client.execution_duration_ms",startTime:t.executionStartTime,endTime:t.executionStartTime+t.executionDurationMs};B().default.DO_NOT_USE_measureLegacy(e,{environment:o,data:{success:t.executionSuccess,has_formulas:((null===(n=t.formulaStats)||void 0===n?void 0:n.totalFormulas)??0)>0}})}for(const a of Object.values(t.actionStats))if((0,u().Ov)(a)){var i;const e={metricName:"automation.client.action_execution_duration_ms",startTime:a.executionStartTime,endTime:a.executionStartTime+a.executionDurationMs};B().default.DO_NOT_USE_measureLegacy(e,{data:{automation_action_type:a.actionType,success:a.executionSuccess,has_formulas:((null===(i=a.formulaStats)||void 0===i?void 0:i.totalFormulas)??0)>0},environment:o})}}};var K=()=>o(926724),F=()=>o(788860);const Z=(0,F().vU)({genericSuccessMessage:{id:"automations.buttonTrigger.genericSuccessMessage",defaultMessage:"Button automation ran successfully"},createdBlocks:{defaultMessage:"Created {numBlocksDuplicated, plural, one {1 block} other {{numBlocksDuplicated} blocks}} on page",id:"automations.buttonTrigger.createdBlocks"},createdSprintsUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.createdSprints"},updatedSprintsUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.updatedSprints"},createdSprintsLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.createdSprintsLowercase"},updatedSprintsLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.updatedSprintsLowercase"},createdTasksUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.createdTasks"},updatedTasksUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.updatedTasks"},createdTasksLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.createdTasksLowercase"},updatedTasksLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.updatedTasksLowercase"},createdProjectsUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.createdProjects"},updatedProjectsUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.updatedProjects"},createdProjectsLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.createdProjectsLowercase"},updatedProjectsLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.updatedProjectsLowercase"},createdPagesUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.createdPages"},updatedPagesUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.updatedPages"},createdPagesLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.createdPagesLowercase"},updatedPagesLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.updatedPagesLowercase"}}),L=["sprint","task","project","page"],E={[K().wW]:"project",[K().Ym]:"task",[K().zU]:"page",[K().Fi]:"page",[K().p$]:"sprint",[K().GZ]:"page",[K().nG]:"page",[K().Be]:"page",[K().u2]:"page"};function H(e){const{typedAutomationExecutionSummary:t,numBlocksDuplicated:o,intl:n}=e,i=function(e){const{typedAutomationExecutionSummary:t,intl:o}=e,n=[];for(const a of L){const e=t[a];if(e){const{numPagesCreated:t,numPagesEdited:o}=e;t>0&&n.push({pageType:a,modificationType:"created",numPagesModified:t}),o>0&&n.push({pageType:a,modificationType:"updated",numPagesModified:o})}}const i=n.slice(0,D).map(((e,t)=>{let{pageType:n,modificationType:i,numPagesModified:a}=e;const r=O[n][i],l=0===t?r.start:r.append;return o.formatMessage(l,{numPagesModified:a})}));if(i.length>0)return o.formatList(i,{type:"conjunction",style:"long"})}({typedAutomationExecutionSummary:t,intl:n});return i||(o>0?n.formatMessage(Z.createdBlocks,{numBlocksDuplicated:o}):n.formatMessage(Z.genericSuccessMessage))}const D=3;const O={sprint:{created:{start:Z.createdSprintsUppercase,append:Z.createdSprintsLowercase},updated:{start:Z.updatedSprintsUppercase,append:Z.updatedSprintsLowercase}},task:{created:{start:Z.createdTasksUppercase,append:Z.createdTasksLowercase},updated:{start:Z.updatedTasksUppercase,append:Z.updatedTasksLowercase}},project:{created:{start:Z.createdProjectsUppercase,append:Z.createdProjectsLowercase},updated:{start:Z.updatedProjectsUppercase,append:Z.updatedProjectsLowercase}},page:{created:{start:Z.createdPagesUppercase,append:Z.createdPagesLowercase},updated:{start:Z.updatedPagesUppercase,append:Z.updatedPagesLowercase}}};var N=()=>o(396136),U=()=>o(826955);o(821057),o(492176),o(7961);var W=()=>o(492788),z=()=>o(506347),G=()=>o(481529),$=()=>o(839002),Y=()=>o(824462),q=()=>o(332542),X=()=>o(636340),J=()=>o(497065),Q=()=>o(879952),ee=()=>o(269299),te=()=>o(429725),oe=()=>o(32969),ne=()=>o(876822),ie=()=>o(407121),ae=()=>o(499411),re=()=>o(625230),le=()=>o(990966),se=()=>o(529318),ce=()=>o(11750),ue=()=>o(845622);function de(e,t){const o=()=>{t(e.getState())};return e.addListener(o),()=>e.removeListener(o)}var pe=()=>o(554398),me=()=>o(726143),ge=()=>o(339523),he=()=>o(965014),ye=()=>o(644329),fe=()=>o(78815),ve=()=>o(127519),xe=()=>o(18281),Se=()=>o(404791);function be(e){const{pageStore:t,buttonBlockStore:o,textBlockStore:n}=e,i=ve().default.state;if("editing"!==i.mode)throw new Error("Not editing");const a=o.getRecordStoreUIParent();if(!a)throw new Error("No current parent");return{type:"cursor",currentPage:t,origin:o,scrollerStore:(0,ye().Dj)(t),textSelection:i.multiSelection,currentBlock:n,currentParent:a,isPageTitle:!1}}async function Ce(e){const{environment:t,automationId:o,automationName:n,instructions:i,pageStore:a,buttonBlockStore:r,subscriptionDataStore:l}=e;if(function(e){const{environment:t,subscriptionDataStore:o}=e;if(!function(e){var t;const{environment:o,subscriptionDataStore:n}=e,i=(0,xe().GJ)(n.state),a=!o.device.isMobileNative;return!0!==(null===(t=Se().Z.state)||void 0===t?void 0:t.isEligible)&&i&&a}({environment:t,subscriptionDataStore:o}))return!1;return(0,he().y)(t,{from:"ai_assistant_limit_in_app",upsell:{type:"product",product:"ai",limit:{type:"none"}}}),!0}({environment:t,subscriptionDataStore:l}))return!1;!function(e){const{environment:t,automationId:o}=e;(0,A().j)({environment:t,event:{eventName:"assistant_basic_action",eventProperties:{automation_id:o,skill_type:"custom"}}}),re().j({name:"assistant_basic_action",args:{skill_type:"custom"}})}({environment:t,automationId:o});const s=function(e){const{automationName:t,instructions:o}=e;return{clientSkill:{...(0,fe().createClientGlobalSkill)("custom"),displayName:{id:"notTranslated.runAssistantWithInstructions.customName",defaultMessage:t}},parameterValues:{name:t,instructions:o,initialUserPrompt:[]}}}({automationName:n,instructions:i});return P().default.checkGate({gateName:"assistant_basic_writer_mode"})?await async function(e){const{environment:t,pageStore:o,buttonBlockStore:n,clientSkillWithParameterValues:i}=e,a=function(e){const{environment:t,relativeToBlockStore:o}=e,n=oe().C.findSelectableFromStore(o);if(!n)throw new Error("Could not find a selectable");let i;if(ee().createAndCommit({userAction:"runAssistantAutomationActions.newEmptyTextBlock",environment:t,canUndo:!0,perform:e=>{i=X().j4({environment:t,type:"text",inMemoryRecordCache:o.inMemoryRecordCache,transaction:e,spaceId:o.getSpaceId()}),n.props.onInsertBelow&&n.props.onInsertBelow({insertStores:[i],transaction:e})}}),!i)throw new Error("Failed to create a new empty text block");return i}({environment:t,relativeToBlockStore:n});!function(e){const t=(0,ge().mh)(e);if(!t)throw new Error("Could not get block edit store");le().setSelectionAtStart({store:t})}(a);const r=await async function(e){const{environment:t,pageStore:o,buttonBlockStore:n,textBlockStore:i}=e;return await se().completionInitialPromptActions.toggleInitialPrompt({environment:t,from:"automation_button",context:be({pageStore:o,buttonBlockStore:n,textBlockStore:i})}),function(){const e=ue().default.state;if(!(0,ye().wM)(e))throw new Error("Not an assistant completion popup");return e}()}({environment:t,pageStore:o,buttonBlockStore:n,textBlockStore:a}),l=(0,ae().Oy)();await(0,pe().triggerAssistantSkillCompletion)({environment:t,context:r.context,clientSkillWithParameterValues:i,updater:ue().default.createUpdater(),sessionId:l,from:"automation_button",assistantSurfaceType:t.device.isMobile?"mobileWriter":"writer"}),function(e){const{didEndSession:t}=e;if(!t)return()=>{};if("assistantCompletionPopup"!==ue().default.state.type)return()=>{};const o=[];function n(){o.forEach((e=>e())),o.length=0}o.push(de(ue().default,(e=>{"assistantCompletionPopup"!==e.type&&(n(),null==t||t())})))}({didEndSession:()=>{!function(e){const{environment:t,textBlockStore:o}=e;if(0!==o.getTitleValue().length)return!1;ee().createAndCommit({userAction:"runAssistantAutomationActions.removeEmptyTextBlock",environment:t,canUndo:!0,perform:e=>{q().zo({blockStore:o,transaction:e})}})}({environment:t,textBlockStore:a})}})}({environment:t,buttonBlockStore:r,pageStore:a,clientSkillWithParameterValues:s}):await async function(e){const{environment:t,clientSkillWithParameterValues:o}=e;await(0,ce().handleActivateNewSkill)({environment:t,clientSkillWithParameterValues:o,assistantSurface:me().FP.corner,from:"automation_button",shouldOpenAfterStart:!0})}({environment:t,automationId:o,clientSkillWithParameterValues:s}),!0}class ke{constructor(e){this.environment=void 0,this.clientContext=void 0,this.automationModel=void 0,this.numBlocksDuplicated=0,this.transactionServerCommitResults=[],this.saveTransactionInfos=[],this.undoCheckpointName=void 0,this.waitForTransactionsCommitted=async()=>{await Promise.all(this.transactionServerCommitResults),this.transactionServerCommitResults=[]},this.getCollectionSchema=async e=>{const t=await this.clientContext.parentRecordStore.loadRecordModel(e.pointer);return t?{value:{collectionSchema:t.getNormalizedSchema()}}:{error:new(c().Do)({actionId:e.actionId,pointer:e.pointer})}},this.logMessage=e=>{v().log(e)},this.runAssistantWithInstructions=async e=>{const{automationId:t,instructions:n}=e;if("button_block"!==this.clientContext.type)return{error:new(c().iR)({contextType:this.clientContext.type})};const i=this.clientContext.blockStore,a=this.clientContext.pageStore,r=this.environment,l=o(897257).subscriptionDataStoreInstance,s=_().Z.getIntl(),u=this.clientContext.automationStore.getNameWithDefault(s);if(!a)return{error:new(c().mK)({actionId:e.actionId,pointer:this.clientContext.pageStore})};try{return await Ce({environment:r,automationId:t,automationName:u,instructions:n,subscriptionDataStore:l,pageStore:a,buttonBlockStore:i}),{value:void 0}}catch(d){return d instanceof c().fH?{error:d}:d instanceof Error?{error:new(c().EP)({actionId:e.actionId,message:d.message})}:{error:new(c().EP)({actionId:e.actionId,message:"Unknown error in runAssistantWithInstructions"})}}},this.queryCollection=async e=>{const t=await o(96724).tA(this.environment,{source:"automation",parentRecordStore:this.clientContext.parentRecordStore,collectionPointer:e.collection,filter:e.filter,sort:e.sort,limit:e.limit});return l().x.isFail(t)?{error:new(c().Pn)({actionId:e.actionId,type:t.error.type,message:t.error.message,cause:t.error})}:{value:{blockIds:t.value.blockIds}}},this.saveTransaction=e=>{const{info:t,operations:n}=e,i=[];if(this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.saveTransaction",environment:this.environment,perform:e=>{for(const t of n)if((0,o(386616).Qf)(t)){const o=U().G.createChildStore(this.clientContext.parentRecordStore,t.pointer);ee().applyCrdtTextOperation({store:o,operation:t,invertedOperation:void 0,transaction:e})}else if((0,G().V_)(t)||(0,G().SH)(t)){const o=(0,U().Kv)(this.clientContext.parentRecordStore,t.pointer);ee().applyOperation({store:o,operation:t,transaction:e})}else(0,s().t1)(t);i.push(e.id)}}),this.saveTransactionInfos.push(t),"create_page"===t.type)o(54512).W(this.environment,{type:"page",automation_id:this.automationModel.id,from:"button_automation",new_page_id:t.pageId,creating_block_id:t.pageId});else if("update_pages"===t.type){const{editedProperties:e,pageIds:n}=t;for(const t of n)for(const{id:n,type:i}of e)o(491927).rv(this.environment,{block_id:t,property:n,property_type:i,from:"button_automation",automation_id:this.automationModel.id},!1)}else"publish_site"===t.type||(0,s().t1)(t);return Promise.resolve({value:{stats:{totalOperations:n.length,transactionIds:i}}})},this.navigateToPage=e=>{const t=ne().default.state.mainEditorCurrentBlockStore;if(!t)return;const n=U().G.createChildStore(t,e.page),i="full_page"===e.openIn?(0,te().ZP)({store:n,fullyQualified:!1,pageVisitSource:z().tY.ButtonAutomation}):(0,te().ZP)({store:t,peekViewBlockId:n.id,peekMode:(0,o(482162).getUrlParamFromPeekMode)(e.openIn),fullyQualified:!1,pageVisitSource:z().tY.ButtonAutomation});J().c4({environment:this.environment,url:i})},this.openUrl=e=>{J().c4({environment:this.environment,url:e.url,openInNew:"tab"})},this.sendSlackNotification=async e=>{const{action:t}=e;return(0,A().j)({environment:this.environment,event:{eventName:"button_automation_slack_action",eventProperties:{type:this.clientContext.type}}}),this.executeServerSideEffect({effect:"send_slack_notification",actionPointer:t.pointer,contextType:this.clientContext.type})},this.duplicateBlockChildren=async e=>{if("button_block"!==this.clientContext.type)return{error:new(c().iR)({contextType:this.clientContext.type})};const t=this.clientContext.blockStore,n=t.getRecordStoreUIParent();if(!n)return{value:{}};const i={};let a,r=t;if("before"===e.insertionPoint)a=!0;else if("after"===e.insertionPoint)a=!1;else if("topOfPage"===e.insertionPoint){let e;if(a=!0,this.clientContext.pageStore?e=this.clientContext.pageStore:n&&n.isTable(N().iU)&&n.getAncestorRecordStoreAtRootPath()&&(e=n.getAncestorRecordStoreAtRootPath()),!e)return{error:new(c().fH)("invalid_record","Missing page store in client context for top of page insertion")};r=e.getContentStores().at(0)||t}else if("bottomOfPage"===e.insertionPoint){let e;if(a=!1,this.clientContext.pageStore?e=this.clientContext.pageStore:n&&n.isTable(N().iU)&&n.getAncestorRecordStoreAtRootPath()&&(e=n.getAncestorRecordStoreAtRootPath()),!e)return{error:new(c().fH)("invalid_record","Missing page store in client context for bottom of page insertion")};r=e.getContentStores().at(-1)||t}else(0,s().t1)(e.insertionPoint);const l=U().G.createChildStore(n,e.blockPointer);await l.load();const u=l.getContentStores();a||u.reverse();const d=oe().C.findSelectableFromStore(r),p=[],m=this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.duplicateBlockChildren",environment:this.environment,perform:e=>{const t=u.map((t=>{const[n,i]=o(872308).duplicateBlock({environment:this.environment,stores:[t],transaction:e,addCopyName:!1,deepCopyTransclusionContainers:!1,resolveTemplateVariables:!0,targetSpaceId:(0,o(81954).J)(t.pointer.spaceId),baseUrl:M().default.domainBaseUrl,publicDomainName:M().default.publicDomainName,preferDuplicateLocation:"local",analyticsFrom:"button_automation"}),r=n[0];return d&&(a?d.props.onInsertAbove&&p.push(d.props.onInsertAbove({insertStores:[r],transaction:e})[0]):d.props.onInsertBelow&&p.push(d.props.onInsertBelow({insertStores:[r],transaction:e})[0])),{copy:r,onComplete:i}}));return R.aggregateActionStats(i,{transactionIds:[e.id]}),t}}).performResult;return a||p.reverse(),Q().Z5({environment:this.environment,stores:p}),await $().qd(m,10,(e=>e.onComplete)),W().default.afterNextFlush((()=>{for(const e of p){if(o(576828).dM({environment:this.environment,isAtStartOfLine:!1,store:e}))break}})),this.numBlocksDuplicated+=p.length,R.aggregateActionStats(i,{blocksCreated:this.getNumBlocksDuplicated()}),{value:{stats:i}}},this.displayModal=async e=>{ie().Z.setState({open:!0,format:e.format,recordStore:this.clientContext.parentRecordStore}),await ie().Z.waitUntil((()=>!ie().Z.state.open));const t=ie().Z.state;let o;return t.open||(o=t.result),o=o??"continue",{value:{result:o}}},this.initializeTemplateInDatabase=async e=>{const t=this.clientContext.parentRecordStore,n={},i=U().G.createChildStore(t,{table:N().iU,id:e.templateId});await i.load();const a=U().NW.createChildStore(t,e.collection),r=(0,o(487270).TS)({environment:this.environment,table:N().iU,spaceId:a.pointer.spaceId}),{performResult:l}=this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.initializeTemplateInDatabase",environment:this.environment,perform:l=>{const s=X().j4({environment:this.environment,transaction:l,inMemoryRecordCache:t.inMemoryRecordCache,type:o(156642).Ti.page,id:r});return q().zw({parentStore:a,childStore:s,transaction:l}),o(295274).ob({environment:this.environment,store:s,transaction:l,templateStore:i,title:"template",isCreateIn:!1,isKeyboard:!1,from:"automation_actions"}),o(576808).b({environment:this.environment,store:s,properties:e.propertyUpdates,transaction:l}),R.aggregateActionStats(n,{transactionIds:[l.id]}),s}});return this.saveTransactionInfos.push({type:"create_page",pageId:r,collection:e.collection}),await l.load(),l.isDefined()?{value:{pageId:r,pageModel:l.getModel(),stats:n}}:{error:new(c().Do)({actionId:e.actionId,pointer:l.pointer})}},this.sendInAppNotification=async e=>{const{actionPointer:t,targets:o,message:n,pagePointer:i}=e;return this.executeServerSideEffect({effect:"send_in_app_notification",actionPointer:t,contextType:this.clientContext.type,args:{targets:o,message:n,pagePointer:i}})},this.sendGmailNotification=async e=>{var t;const{action:o,to:n,cc:i,bcc:a,replyTo:r,fromName:l,subject:s,body:c}=e,u="button_block"===this.clientContext.type||"button_property"===this.clientContext.type?null===(t=this.clientContext.pageStore)||void 0===t?void 0:t.pointer:void 0;return this.executeServerSideEffect({effect:"send_gmail_notification",actionPointer:o.pointer,contextType:this.clientContext.type,args:{bcc:a,body:c,cc:i,fromName:l,pagePointer:u,replyTo:r,subject:s,to:n}})},this.updateLastRunTimesForObservability=async e=>{const{automationModel:t,executeResult:o}=e,n=this.clientContext.parentRecordStore,i=U().Mz.createChildStore(n,t.pointer);return this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.updateLastRunTimesForObservability",environment:this.environment,skipUpdatingEditedMetadata:!0,perform:e=>{const t=Date.now();X().sW({data:{last_executed_time:t},store:i,transaction:e}),l().x.isFail(o)&&X().sW({data:{last_failed_time:t},store:i,transaction:e})}}),Promise.resolve({value:void 0})},this.sendHttpRequest=async e=>{const{action:t,pagePointer:o,eventId:n}=e;return this.executeServerSideEffect({effect:"send_http_request",actionPointer:t.pointer,contextType:this.clientContext.type,args:{pagePointer:o,eventId:n}})},this.executeServerSideEffect=async e=>{const t=await Y().callApi({eventName:"executeAutomationActionEffect",environment:this.environment,headers:{},data:e});return"failed"===t.type?{error:new(c().Nz)({actionId:e.actionPointer.id,message:"Failure in execution of the executeAutomationActionEffect endpoint",cause:t.error})}:t.data},this.environment=e.environment,this.clientContext=e.clientContext,this.automationModel=e.automationModel,this.undoCheckpointName=`execute-client-automation-${o(956057).Il()}`}getNumBlocksDuplicated(){return this.numBlocksDuplicated}createAndCommitForEffect(e){const t=ee().createAndCommit({...e,undoCheckpoint:this.undoCheckpointName});return this.transactionServerCommitResults.push(t.serverCommitResult),t}}async function je(e){var t,o;const{clientContext:n,environment:r,onUndo:c}=e,u=await w().F.formulas.load(),d=await w().F.simpleFormulas.load();await n.automationStore.load();const m=n.automationStore.getModel();if(!m||!m.isButtonType()&&!m.isRecurrenceType())return;const M=m.spaceId,B=n.automationStore.getActionStores().map((e=>e.getModel())).filter(s().$K),K=m.getTriggerType(),F="button_block"===n.type?n.blockStore.id:"button_property"===n.type?null===(t=n.pageStore)||void 0===t?void 0:t.id:"recurrence"===n.type?void 0:(0,s().t1)(n),Z=(0,V().zt)();(0,A().j)({environment:r,event:{eventName:"automation_triggered",eventProperties:{actions:B.map((e=>e.getType())),automation_id:m.id,block_id:F,context_type:n.type,space_id:M,subscription_tier:Z,trigger:K}}});const L=new ke({automationModel:m,clientContext:n,environment:r}),D=(0,f().yf)(n.parentRecordStore.getRecordModel,n.parentRecordStore.loadRecordModel,P().default,(0,I().W)()),O=P().default.getConfigKey("automation_settings","client_formula_timeout_ms"),W=r.currentUser.id?{id:r.currentUser.id,table:b().KJ}:void 0,z="recurrence"!==n.type?null===(o=n.pageStore)||void 0===o?void 0:o.getModel():void 0,G=[];if("recurrence"===n.type&&"completeSprint"===n.recurrence.type){const{values:e}=function(e){const{nextSprintDateRange:t,completeSprintActionType:o}=e;return{values:[{kind:g().FormulaContextValueKind.ContextValue,id:y().Pv,value:{type:"date",value:t}},{kind:g().FormulaContextValueKind.ContextValue,id:y().JL,value:{type:"text",value:(0,h().TPx)(o)}}]}}({completeSprintActionType:n.recurrence.completeSprintActionType,nextSprintDateRange:n.recurrence.nextSprintDateRange});G.push(...e)}const $=R.create(m.pointer,"client"),Y={author:W,automationModel:m,actionModels:B,contextType:n.type,formulaVariableResolution:{executingUserPointer:W,executingUserTimeZone:(0,x().r)(),thisPageBlockModel:z},values:G,executeEffectMap:L,executeContextualFormula:async(e,t)=>{if(!t)return{value:{type:"undefined"}};const o=Date.now()+O;return await u.executeFormulaAsync(t,{...e,depth:0,throwOnDownstreamParseFailures:!0,handleDataRequest:D,intl:n.intl,resultCache:new Map,regExpCache:new Map,userTimeZone:(0,x().r)(),visitedProperties:new Set,formulaTimeoutTimestampMs:o,experimentService:P().default,spaceId:M})},formulasModule:u,handleDataRequest:D,loadRecordModel:n.parentRecordStore.loadRecordModel,makeGetRecordModelFn:async e=>Promise.resolve(n.parentRecordStore.getRecordModel),userTimeZone:(0,x().r)(),intl:n.intl,depth:0,throwOnDownstreamParseFailures:!0,visitedProperties:new Set,resultCache:new Map,regExpCache:new Map,eventTracker:(0,A().mc)(r),runtimeRecordPointerSet:new(S().X),runtimeStats:$,spaceIdCreator:await r.idCreator.getSpaceIdCreator(M),simpleFormulasModule:d,useCrdtDefault:(0,T().WA)(n.automationStore.getSpaceStore()),experimentService:P().default,collectionFeatureGates:(0,I().W)(),spaceId:M,eventId:(0,C().ZP)()},q=await p({context:Y});R.logNotionPerformance({automationStats:$,environment:r});const X={automationContextType:n.type,automationId:m.id,automationRuntime:$,spaceId:M,userId:null==W?void 0:W.id};if(l().x.isFail(q)){const{error:e}=q;0,v().log({actor:W,data:X,error:e,from:"automationActions",level:"error",type:"AutomationExecutionError"}),(0,A().j)({environment:r,event:{eventName:"automation_execution_fail",eventProperties:{automation_id:m.id,block_id:F,context_type:n.type,error_type:e.type,execution_duration_ms:$.executionDurationMs,subscription_tier:Z,trigger:K}}});const t=function(e){if("query_collection_too_many_items"===e.type)return i().messages.errorQueryCollectionTooManyPages;if("record_pointer_in_trash"===e.type)return i().messages.errorRecordInTrash;return i().messages.genericErrorMessage}(e),o=_().Z.formatMessage(t);j().oV({label:o})}else(0,A().j)({environment:r,event:{eventName:"automation_execution_success",eventProperties:{automation_id:m.id,block_id:F,context_type:n.type,execution_duration_ms:$.executionDurationMs,subscription_tier:Z,trigger:K}}}),v().log({actor:W,data:X,from:"automationActions",level:"info",type:"AutomationExecutionSuccess"}),function(e){if(e.some((e=>Me.has(e.type))))return!1;return!e.every((e=>!(0,a().getActionRegistryItem)(e.type).hasSideEffects))}(B)&&await async function(e){const{actionModels:t,environment:o,saveTransactionInfos:n,clientContext:i,undoCheckpointName:r,numBlocksDuplicated:l,onUndo:c}=e,u=function(e){const{saveTransactionInfos:t,parentRecordStore:o}=e,n={},i=new Set;for(const u of t)if("create_page"===u.type){var a,r;if(i.has(u.pageId))continue;const e=U().NW.createChildStore(o,u.collection).getDatabaseType(),t=(e&&E[e])??"page",l=(null===(a=n[t])||void 0===a?void 0:a.numPagesEdited)??0,s=(null===(r=n[t])||void 0===r?void 0:r.numPagesCreated)??0;n[t]={numPagesCreated:s+1,numPagesEdited:l},i.add(u.pageId)}else if("update_pages"===u.type){var l,c;const e=U().NW.createChildStore(o,u.collection).getDatabaseType(),t=(e&&E[e])??"page",i=(null===(l=n[t])||void 0===l?void 0:l.numPagesEdited)??0,a=(null===(c=n[t])||void 0===c?void 0:c.numPagesCreated)??0;n[t]={numPagesCreated:a,numPagesEdited:i+u.pageIds.length}}else"publish_site"===u.type?n.page={numPagesCreated:0,numPagesEdited:1}:(0,s().t1)(u);return n}({saveTransactionInfos:n,parentRecordStore:i.parentRecordStore}),d=H({typedAutomationExecutionSummary:u,numBlocksDuplicated:l,intl:i.intl}),p=await async function(e){const{saveTransactionInfos:t,clientContext:o}=e;let n;for(const r of t.slice().reverse()){if("create_page"===r.type){var i;n=U().G.createChildStore(o.parentRecordStore,{table:N().iU,id:r.pageId,spaceId:null===(i=r.collection)||void 0===i?void 0:i.spaceId});break}if("update_pages"===r.type){if(1===r.pageIds.length){var a;n=U().G.createChildStore(o.parentRecordStore,{table:N().iU,id:r.pageIds[0],spaceId:null===(a=r.collection)||void 0===a?void 0:a.spaceId})}else{const e=U().NW.createChildStore(o.parentRecordStore,r.collection);await e.load();const t=e.getParentBlockStore();if(!t)continue;n=t}break}if("publish_site"===r.type)break;(0,s().t1)(r)}return n}({saveTransactionInfos:n,clientContext:i}),m=function(e){let t;for(const o of e){const e=(0,a().getActionRegistryItem)(o.type);if(!1===e.invertible)return!1;!0===e.invertible&&(t=!0)}return t}(t),g=!0===m&&k().hv(r)?()=>{k().qB({environment:o,namedRevisionId:r}),j().rN(),c&&c(r)}:void 0;j().d8({blockToOpenStore:p,item:{label:d},performUndo:g})}({actionModels:B,clientContext:n,environment:r,numBlocksDuplicated:L.getNumBlocksDuplicated(),onUndo:c,saveTransactionInfos:L.saveTransactionInfos,undoCheckpointName:L.undoCheckpointName})}const Me=new Set(["assistant_basic"]);var Te=o(667294),we=()=>o(219727),Ae=()=>o(142735),Ie=()=>o(846550),_e=()=>o(707513),Pe=()=>o(58836),Ve=()=>o(291198),Be=()=>o(967092),Re=()=>o(906651),Ke=()=>o(842574),Fe=()=>o(949842),Ze=()=>o(407544),Le=()=>o(520849),Ee=()=>o(637118),He=()=>o(486896),De=()=>o(200027),Oe=()=>o(492135),Ne=()=>o(676279),Ue=()=>o(269853),We=()=>o(359620),ze=()=>o(545444),Ge=()=>o(762478),$e=()=>o(1910),Ye=()=>o(943620),qe=()=>o(654133),Xe=()=>o(150569),Je=()=>o(164079),Qe=()=>o(112213),et=o(785893);const tt=(0,F().vU)({icon:{defaultMessage:"Icon",id:"buttonBlock.button.iconHeading"},addIconButtonAriaLabel:{defaultMessage:"Add icon",id:"buttonBlock.button.addIconButtonAriaLabel"}});function ot(e){const{disabled:t,currentIcon:o,handleIconChange:n,store:i}=e,a=(0,we().O7)(),r=(0,F().YB)(),l=(0,Te.useCallback)((e=>{Ge().$(a,{originRect:e.currentTarget.getBoundingClientRect(),originGap:4,popupWidth:Xe().FZ,popupHeight:Xe().kX,isSmallWidth:!1,title:r.formatMessage(tt.icon),currentTab:"icon",tabs:[{type:"icon",onChange:e=>{n(e),Ge().Z()}},{type:"emoji",onChange:(e,t)=>{n(e),Ge().Z()}}],onDelete:o?()=>{n(void 0),Ge().Z()}:void 0})}),[a,n,r,o]),s=(0,Ie().yK)((e=>({iconButton:{background:"transparent",boxShadow:e.automationIconPickerShadow,width:28,height:28},icon:{width:16,height:16}})),[]),c=e=>(0,et.jsx)($e().Z,{ariaLabel:r.formatMessage(tt.addIconButtonAriaLabel),style:s.iconButton,iconStyle:s.icon,hasBackground:!0,disabled:t,showShadow:!0,icon:e=>o?(0,et.jsx)(Ye().Z,{disabled:!0,isEmptyPage:!1,size:24,icon:{icon:o,pointer:i.pointer},style:e}):(0,Qe().o)(e),...(0,Je().Z)(e??{},{onClick:l})});return o?c():(0,et.jsx)(qe().Z,{renderTooltip:()=>(0,et.jsx)(F()._H,{defaultMessage:"Add an icon",id:"buttonBlock.button.addIcon"}),delayThreshold:300,render:c})}var nt=()=>o(206352),it=()=>o(687982),at=()=>o(195245);function rt(e){const{value:t,onChange:o,wrapStyle:n,onBlur:i,...a}=e,[r,l]=(0,Te.useState)(!1),s=(0,we().O7)(),c=(0,it().Z)(!0),u=(0,Te.useCallback)((()=>{l(!1),null==i||i()}),[i]),d=(0,Te.useCallback)((e=>o(e.currentTarget.value)),[o]),p=(0,Te.useCallback)((()=>{"empty"!==ve().default.state.mode&&Q().ZH({environment:s,preventDismissMobileKeyboard:!0}),l(!0)}),[s]);return(0,et.jsx)(nt().Z,{debugName:"AutomationPlainTextInput",capture:r,children:(0,et.jsx)("div",{...c,style:n,children:(0,et.jsx)(Ve().Z,{...a,onBlur:u,onChange:d,onFocus:p,value:t})})})}function lt(e){const{onChange:t,store:o,...n}=e,{maybePersistedTransactionActions:i}=(0,at().i)(),a=(0,Ae().VK)((()=>o.getValue()??""),[o]),r=(0,Te.useCallback)((e=>{i.createAndCommit({userAction:"AutomationPlainTextInput.setValue",perform:t=>{X().sO({store:o,transaction:t,value:e})}}),null==t||t(e)}),[i,t,o]);return(0,et.jsx)(rt,{value:a,onChange:r,...n})}var st=()=>o(87781),ct=()=>o(196007),ut=()=>o(285755),dt=()=>o(827973),pt=()=>o(448419),mt=()=>o(119891),gt=()=>o(677559),ht=()=>o(135515),yt=()=>o(529048),ft=()=>o(280977),vt=()=>o(210968),xt=()=>o(590259);const St=new(gt().Ss)("AssistantBasicStandalone",(async()=>await o.e(3928).then(o.bind(o,495102)))),bt=(0,gt().kF)(St,(e=>e.AssistantBasicStandalone));var Ct=()=>o(985571),kt=()=>o(903098),jt=()=>o(296227),Mt=()=>o(982614);var Tt=()=>o(360240),wt=()=>o(466970),At=()=>o(960597),It=()=>o(309841);function _t(e){return!e.pathIsDead()&&e.isDefined()}function Pt(e){if(!(0,s().$K)(e))return[];return e.getTemplatePageStores().filter((e=>_t(e)))}var Vt=()=>o(752348),Bt=()=>o(38883),Rt=()=>o(384241),Kt=()=>o(772265),Ft=()=>o(790819),Zt=()=>o(311419);function Lt(e){const{actionStore:t,currentValue:o,onChange:n,disabled:i,errorMessage:a,errorIcon:r,skipVariables:l}=e,c=(0,we().O7)(),{typecheckResult:u}=(0,Ee().DZ)(),d=(0,wt().E)("automation_updated_error_states"),p=(0,Ae().qz)(void 0,yt().Z),m=t.id,g=(0,kt().z)({actionId:m}),h=(0,Ae().VK)((()=>o&&"collection"===o.type?U().NW.createChildStore(t,o.collection):void 0),[o,t]),y=(0,Ae().VK)((()=>{if(m&&u&&o&&"variable"===o.type)return(0,Vt().getContextValueForActionById)(u,m,o.id)}),[o,u,m]),f=(0,Te.useCallback)((e=>{"collection"!==e.type&&"variable"!==e.type||(n(e),p.reset(),(0,It().GV)(((o,n,i)=>{const a=(0,It().TI)({automationActionStore:t,formulaAnalyticsModule:n,formulasModule:o,simpleFormulasModule:i});(0,s().$K)(a)&&(0,A().j)({environment:c,event:{eventName:"automation_target_pick",eventProperties:{automation_action:a,automation_id:t.getParentId(),target_type:e.type}}})})))}),[n,p,t,c]),v=(0,Te.useCallback)((()=>p.reset()),[p]),x=(0,Ne().d)(),S=Boolean(h||y);return(0,et.jsx)(pt().ZP,{buttonPopupStore:p,popupType:x,alignmentToOrigin:pt().vR.Center,placementToOrigin:pt().pO.Bottom,originGap:0,disabled:i,renderOrigin:e=>(0,et.jsx)(Ft().S,{...e,disabled:i,isCompact:!0,isError:Boolean(a),hasActionRequired:!S,tooltipMessage:!d&&a,errorIcon:r,dropdownButtonType:"dropdown",children:h?(0,et.jsx)(Rt().Z,{store:h}):y?(0,et.jsx)(Kt().F,{format:Bt().lo.Medium,isSingle:!0,value:y,style:{background:"transparent",color:"unset",margin:"-1.5px 0",padding:0}}):(0,et.jsx)(F()._H,{id:"automations.databasePicker.buttonPlaceholder",defaultMessage:"Select database"})}),render:e=>(0,et.jsx)(Zt().L,{formulaTypecheckContextValues:g,onChange:f,onClose:v,parentRecordStore:t,selectedTarget:o,skipPages:!0,skipVariables:l})})}var Et=()=>o(953744),Ht=()=>o(198829),Dt=()=>o(255577),Ot=()=>o(388284),Nt=()=>o(918745);function Ut(e){const{collectionStore:t,currentTemplateId:o,onChange:n,disabled:i,errorMessage:a}=e,r=(0,we().O7)(),{device:l}=r,s=(0,wt().E)("automation_updated_error_states"),c=(0,Ae().VK)((()=>{if(!t)return;if(o){const e=U().G.createChildStore(t,{id:o,spaceId:t.getSpaceId(),table:N().iU});if(!e.pathIsDead())return e}const e=t.getDefaultTemplatePageStore();return e&&!e.pathIsDead()?e:void 0}),[t,o]),u=(0,Ne().d)(),d=(0,Ae().VK)((()=>Pt(t)),[t]),p=Boolean(o);return(0,et.jsx)(pt().ZP,{popupType:u,alignmentToOrigin:pt().vR.Center,placementToOrigin:pt().pO.Bottom,originGap:0,disabled:i,renderOrigin:e=>(0,et.jsx)(Ft().S,{...e,disabled:i,isCompact:!0,isError:Boolean(a),style:{minWidth:50},tooltipMessage:!s&&a,dropdownButtonType:"dropdown",children:c&&(p||_t(c))?(0,et.jsx)(Rt().Z,{store:c}):(0,et.jsx)(F()._H,{id:"automations.templatePicker.buttonPlaceholder",defaultMessage:"Empty"})}),render:e=>{const o=(0,Nt().U)({device:l,width:280});return(0,et.jsx)(Ht().Z,{...o,children:t&&(0,et.jsx)(Wt,{collectionStore:t,templatePageStores:d,parent:e,onChange:n})})}})}function Wt(e){const{collectionStore:t,templatePageStores:o,parent:n,onChange:i}=e,a=(0,we().O7)(),{device:l}=a,s=(0,Ae().VK)((()=>t.getDefaultTemplatePageStore()),[t]),c=o.map((e=>{const o={key:e.id,render:o=>(0,Te.createElement)(Et().Z,{...o,key:e.id,isOverlay:!0,collectionStore:t,canConfigureCollection:!1,templateStore:e,isMobile:l.isMobile,locked:!0,isDefault:s===e,onCancelClick:r().ZT,draggable:!1}),action:t=>{i(e.id),n.close()}};return o})),u={key:"empty",render:e=>(0,Te.createElement)(Et().Z,{...e,key:"empty",isOverlay:!0,collectionStore:t,canConfigureCollection:!1,templateStore:void 0,isMobile:l.isMobile,locked:!0,onCancelClick:r().ZT,draggable:!1}),action:e=>{i(void 0),n.close()}};return(0,et.jsx)(Dt().Z,{type:Dt().i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>(0,et.jsx)(Ot().Z,{...e,title:(0,et.jsx)(F()._H,{id:"automations.templatePicker.menuHeader",defaultMessage:"Select template"})}),items:r().oA([...c,s?void 0:u])}]})}function zt(e){const{actionStore:t,disabled:o,errorMessage:n,onChange:i,value:a,errorIcon:r}=e,l=(0,wt().E)("automation_updated_error_states"),s=(0,Ae().VK)((()=>{let e;if("collection"===(null==a?void 0:a.type)){const o=t.getRecordModel(a.collection);e=null==o?void 0:o.getDatabaseType()}return(0,Tt().sN)(e)}),[t,a]);return(0,et.jsx)(F()._H,{defaultMessage:"Add {itemType} to{collectionPicker}",id:"automations.CreatePageActionV2.header.title",values:{collectionPicker:(0,et.jsx)(Lt,{actionStore:t,currentValue:a,disabled:o,errorMessage:n,errorIcon:l?r:void 0,onChange:i,skipVariables:!0}),itemType:s}})}function Gt(e){const{collectionStore:t,disabled:o,errorMessage:n,onChange:i,value:a}=e;return(0,et.jsx)(F()._H,{defaultMessage:"as{collectionTemplatePicker}",id:"automations.CreatePageActionV2.header.template",values:{collectionTemplatePicker:(0,et.jsx)(Ut,{collectionStore:t,currentTemplateId:a,disabled:o,errorMessage:n,onChange:i})}})}var $t=()=>o(212493),Yt=()=>o(922713),qt=()=>o(543172),Xt=()=>o(658517);function Jt(e,t){const o=e.getConfigStore().getKeyStore("values"),n=o.getValue(),i=null==n?void 0:n[t];return(0,s().$K)(i)?{valueConfig:i,valueStore:o}:{valueConfig:void 0,valueStore:void 0}}var Qt=()=>o(92175);function eo(e){const{disabled:t,onClick:o}=e,n=(0,Ie().yK)((e=>({button:{color:e.text.secondary},children:{..._e().Yu,flex:"1 1 auto"}})),[]);return(0,et.jsx)(Qt().Z,{disabled:t,disabledFeedback:t,onClick:o,shouldShrink:!0,style:n.button,children:(0,et.jsx)("div",{style:n.children,children:(0,et.jsx)(F()._H,{defaultMessage:"Define another variable…",id:"automations.DefineVariablesAction.addVariableButton.label"})})})}var to=()=>o(907874),oo=()=>o(585270),no=()=>o(214206),io=()=>o(411766),ao=()=>o(486539),ro=()=>o(998901),lo=()=>o(732811),so=()=>o(834458),co=()=>o(193962),uo=()=>o(178498),po=()=>o(740046),mo=()=>o(802600),go=()=>o(953293),ho=()=>o(739479),yo=()=>o(382047),fo=()=>o(735501);function vo(){const e=(0,Ie().yK)((e=>({warningIcon:{fill:e.icon.uiRedPrimary,height:14,width:15}})),[]);return(0,fo().t)(e.warningIcon)}function xo(){}function So(e){const{analyzedFormulaOutput:t,onClearClick:o,onDeleteClick:n,onDuplicateClick:i,onEditFormulaClick:a,onEditTextClick:r,onVariableNameChange:l,onVariableNameSubmit:c,variableName:u}=e,{parseErrors:d,type:p,typeErrors:m}=t??{},g=(0,F().YB)(),h=(0,Te.useMemo)((()=>(0,io().M)(g,d??[],m??[])),[g,d,m]),y=(0,s().$K)(h),f=(0,wt().E)("automation_updated_error_states"),v=(0,Nt().F)({width:265}),x=(0,Ie().yK)((e=>({duplicateIcon:{height:17,width:17},formulaErrorCaptionMenuItem:{marginBlockStart:0,paddingBlockStart:0,paddingInline:4},formulaIcon:{height:17,width:17},formulaReturnTypeDesktopIcon:{marginBlockStart:4,marginInlineStart:12},formulaReturnTypeCaptionMenuItem:{marginBlock:0,paddingInline:4},formulaErrorCaption:{...f&&y&&{color:e.text.uiRedPrimary}},nameInputMenuItem:{marginBlock:6},simpleFormulaIcon:{height:17,width:17},trashIcon:{height:17,width:17}})),[f,y]),S=(0,Te.useMemo)((()=>p?(0,so().getHumanReadableType)(p):co().l7.unknown),[p]),b=(0,we().O7)();(0,lo().K)((()=>{le().clear({environment:b})}));const C=[];if((0,s().$K)(u)){const e=(0,s().$K)(l);C.push({items:[{action:()=>null,key:"variable-name-input-item",render:t=>(0,et.jsx)(po().ZP,{...t,disabled:!e,focus:!0,onChange:l??xo,onSubmit:c,placeholder:g.formatMessage(Yt().eC),style:x.nameInputMenuItem,value:u})}],key:"variable-name-input-section",render:e=>(0,et.jsx)(Ot().Z,{...e,enableActionSheetTitle:!0})})}if((0,s().$K)(r)||(0,s().$K)(a)||(0,s().$K)(i)){const e=[];(0,s().$K)(r)&&e.push({action:r,key:"variable-name-manage-edit-text",render:e=>(0,et.jsx)(dt().Z,{...e,icon:(0,go().R)(x.simpleFormulaIcon),title:(0,et.jsx)(F()._H,{defaultMessage:"Edit as text",id:"EditVariableMenu.editSimpleFormulaButtonMenuItem.label"})})}),(0,s().$K)(a)&&e.push({action:a,key:"variable-name-manage-edit-formula",render:e=>(0,et.jsx)(dt().Z,{...e,icon:(0,yo().D)(x.formulaIcon),title:(0,et.jsx)(F()._H,{defaultMessage:"Edit as formula",id:"EditVariableMenu.editFormulaButtonMenuItem.label"})})}),(0,s().$K)(i)&&e.push({action:i,key:"variable-name-manage-duplicate",render:e=>(0,et.jsx)(dt().Z,{...e,icon:(0,mo().a)(x.duplicateIcon),title:(0,et.jsx)(F()._H,{defaultMessage:"Duplicate",id:"EditVariableMenu.duplicateFormulaButtonMenuItem.label"})})});const t=C.length>0;C.push({items:e,key:"variable-name-manage-actions",render:e=>(0,et.jsx)(Ot().Z,{...e,enableActionSheetTitle:!0,topBorder:t})})}if((0,s().$K)(n)||(0,s().$K)(o)){const e=[];(0,s().$K)(n)&&e.push({action:n,key:"variable-name-destructive-delete",render:e=>(0,et.jsx)(dt().Z,{...e,icon:(0,ho().y)(x.trashIcon),title:(0,et.jsx)(F()._H,{defaultMessage:"Delete",id:"EditVariableMenu.deleteFormulaButtonMenuItem.label"})})}),(0,s().$K)(o)&&e.push({action:o,key:"variable-name-destructive-clear",render:e=>(0,et.jsx)(dt().Z,{...e,icon:(0,ho().y)(x.trashIcon),title:(0,et.jsx)(F()._H,{defaultMessage:"Clear variable",id:"EditVariableMenu.clearFormulaButtonMenuItem.label"})})});const t=C.length>0;C.push({items:e,key:"variable-name-destructive-actions",render:e=>(0,et.jsx)(Ot().Z,{...e,enableActionSheetTitle:!0,topBorder:t})})}const k=C.length>0,j=[{action:()=>{},key:"variable-name-typecheck-return-type",render:e=>(0,et.jsx)(uo().Z,{...e,caption:(0,et.jsx)("span",{style:x.formulaErrorCaption,children:(0,et.jsx)(F()._H,{defaultMessage:"Type: {formulaType}",id:"EditVariableMenu.formulaReturnType.label",values:{formulaType:(0,et.jsx)(F()._H,{...S})}})}),desktopIconStyle:x.formulaReturnTypeDesktopIcon,dontShrinkIcon:!0,icon:y?(0,et.jsx)(vo,{}):null,shouldWrapCaption:!0,style:x.formulaReturnTypeCaptionMenuItem})}];return y&&j.push({action:()=>{},key:"variable-name-typecheck-error",render:e=>(0,et.jsx)(uo().Z,{...e,caption:(0,et.jsx)(F()._H,{...h}),shouldWrapCaption:!0,style:x.formulaErrorCaptionMenuItem})}),C.push({items:j,key:"variable-name-typecheck",render:e=>(0,et.jsx)(Ot().Z,{...e,enableActionSheetTitle:!0,topBorder:k})}),0===C.length?null:(0,et.jsx)(Ht().Z,{...v,children:(0,et.jsx)(Dt().Z,{initialFocus:0,sections:C,type:Dt().i.Vertical})})}var bo=()=>o(177634);const Co={type:"unknown"};function ko(e){const{type:t}=e,o=(0,Ie().yK)((e=>({icon:{fill:e.icon.secondary,width:16,height:16}})),[]);return(0,bo().RX)(t??Co)(o.icon)}function jo(e){const{analyzedFormulaOutput:t,buttonPopupStore:o,children:n,disabled:i,errorMessage:a,onClearClick:r,onDeleteClick:l,onDuplicateClick:s,onEditFormulaClick:c,onEditTextClick:u,onVariableNameChange:d,variableName:p}=e,{parseErrors:m,typeErrors:g}=t,h=Boolean(a),y=Boolean(m&&m.length>0),f=Boolean(g&&g.length>0),v=h||y||f,x=(0,wt().E)("automation_updated_error_states"),S=(0,Ie().yK)((e=>({button:{color:e.text.secondary,padding:"0 6px",gap:2},chevronIcon:{fill:e.icon.secondary,flex:"0 0 auto",height:14,width:14},children:{..._e().Yu,color:v?e.errorText:e.text.secondary,flex:"1 1 auto",...v&&x&&{fontWeight:_e().Ue.medium}},iconWrap:{marginInlineEnd:2}})),[x,v]),b=(0,Ne().d)(),C=(0,Ae().qz)(o,yt().Z),k=(0,Te.useCallback)((()=>a??null),[a]),j=(0,Te.useCallback)((()=>{C.reset()}),[C]);return(0,et.jsx)(pt().ZP,{alignmentToOrigin:pt().vR.Start,buttonPopupStore:C,disabled:i,originGap:0,placementToOrigin:pt().pO.Bottom,popupType:b,renderOrigin:e=>(0,et.jsx)(qe().Z,{delayThreshold:0,disableTooltip:!h,placement:ro().Placement.Bottom,render:o=>(0,et.jsxs)(Qt().Z,{...e,...o,disabled:i,disabledFeedback:i,shouldShrink:!0,style:S.button,children:[(0,et.jsx)("div",{style:S.iconWrap,children:v?(0,et.jsx)(vo,{}):(0,et.jsx)(ko,{type:t.type})}),(0,et.jsx)("div",{style:S.children,children:n}),(0,ao().Y)(S.chevronIcon)]}),renderTooltip:k}),render:e=>(0,et.jsx)(So,{analyzedFormulaOutput:t,onClearClick:r,onDeleteClick:l,onDuplicateClick:s,onEditFormulaClick:c,onEditTextClick:u,onVariableNameChange:d,onVariableNameSubmit:j,variableName:p}),trapFocus:!0})}function Mo(e){var t,o;const{actionStore:n,variableId:a}=e,r=(0,we().O7)(),{automationStore:l,contextType:c}=(0,Ee().YC)(),{disabled:u,maybePersistedTransactionActions:d,suppressActionErrors:p}=(0,at().i)(),m=(0,F().YB)(),{value:g}=(0,gt().XJ)(w().F.formulas),{value:h}=(0,gt().XJ)(ut().Sm.automationTypecheck),y=(0,Ae().qz)(void 0,yt().Z),f=Te.useRef(null),v=(0,Ae().qz)(void 0,yt().Z),x=(0,Ae().VK)((()=>l.getActionStores()),[l]),[S,b]=(0,Ae().VK)((()=>[n.id,n.getSpaceId()]),[n]),C=(0,kt().z)({actionId:S}),{onTextStoreSelect:k,onTextStoreUnselect:j}=(0,Ct().w)(n),M=(0,Ae().VK)((()=>n.getConfig()),[n]),T=(0,Ae().VK)((()=>{var e;return null==M||null===(e=M.values)||void 0===e?void 0:e[a]}),[M,a]),A="formula"===(null==T||null===(t=T.value)||void 0===t?void 0:t.type),_=(0,Ae().VK)((()=>{if(g&&b)return(0,to().analyzeSimpleFormulaOrFormulaSync)({context:{handleDataRequest:g.createFormulaDataRequestSyncHandler(n.getRecordModel),spaceId:b,valueTypes:C.slice(0),featureGates:(0,I().W)()},value:null==T?void 0:T.value})}),[b,n.getRecordModel,C,g,null==T?void 0:T.value]),P=(0,Te.useMemo)((()=>!p.includes(n.id)),[p,n]),{errorMessage:V}=(0,At().TU)({actionId:n.id,errorKey:a,shouldShow:P}),B=(0,Te.useCallback)((e=>{const t=e.target.value;d.createAndCommit({perform:e=>{!function(e){const{automationActionStore:t,transaction:o,variableId:n,variableName:i}=e,{valueConfig:a,valueStore:r}=Jt(t,n);(0,s().$K)(a)&&(0,s().$K)(r)&&X().sW({data:{[n]:{...a,name:i}},store:r,transaction:o})}({automationActionStore:n,transaction:e,variableId:a,variableName:t})},userAction:"DefineVariablesAction.editVariableName"}),(0,It().yE)(r,{automationStore:l,automationActionStore:n})}),[n,l,r,d,a]),R=(0,Te.useCallback)((()=>{d.createAndCommit({perform:e=>{!function(e){const{automationActionStore:t,automationActionStores:o,transaction:n,variableId:i}=e,{valueConfig:a,valueStore:r}=Jt(t,i);if(!(0,s().$K)(a)||!(0,s().$K)(r))return;const l=(0,qt().ZP)(),c=(0,Xt().h)(o,a.name);X().sW({data:{[l]:{...a,name:c}},store:r,transaction:n}),ee().applyOperation({operation:{args:{id:l},command:"listAfter",path:["config","variableIds"],pointer:t.pointer},store:t,transaction:n})}({automationActionStore:n,automationActionStores:x,transaction:e,variableId:a})},userAction:"DefineVariables.duplicateVariable"}),y.reset(),(0,It().yE)(r,{automationStore:l,automationActionStore:n})}),[n,x,l,y,r,d,a]),K=(0,Te.useCallback)((e=>{g&&h&&(d.createAndCommit({perform:t=>{!function(e){const{automationActionStore:t,transaction:o,variableId:n,variableValue:i}=e,{valueConfig:a,valueStore:r}=Jt(t,n);(0,s().$K)(a)&&(0,s().$K)(r)&&X().sW({data:{[n]:{...a,value:i}},store:r,transaction:o})}({automationActionStore:n,transaction:t,variableValue:e,variableId:a}),(0,i().clearInvalidVariables)({automationStore:l,automationTypecheckModule:h,contextType:c,formulasModule:g,intl:m,transaction:t})},userAction:"DefineVariables.editVariableValue"}),(0,It().yE)(r,{automationStore:l,automationActionStore:n}))}),[n,l,h,c,r,g,m,d,a]),Z=(0,Te.useMemo)((()=>{if(null==M||!M.variableIds||1===M.variableIds.length)return function(){y.setState({open:!1}),K({type:"simple",value:void 0})}}),[null==M?void 0:M.variableIds,y,K]),L=(0,Te.useMemo)((()=>{if(!(0,s().$K)(Z))return function(){d.createAndCommit({perform:e=>{!function(e){const{automationActionStore:t,transaction:o,variableId:n}=e,{valueStore:i}=Jt(t,n);(0,s().$K)(i)&&(X().sW({data:{[n]:null},store:i,transaction:o}),ee().applyOperation({operation:{args:{id:n},command:"listRemove",path:["config","variableIds"],pointer:t.pointer},store:t,transaction:o}))}({automationActionStore:n,transaction:e,variableId:a})},userAction:"DefineVariables.deleteVariable"}),y.reset(),(0,It().yE)(r,{automationStore:l,automationActionStore:n})}}),[n,l,y,r,d,Z,a]),E=(0,Te.useCallback)((async()=>{var e,t;if(A){if(!(await(0,no().bs)()))return}null===(e=f.current)||void 0===e||e.focus(),y.setState({open:!1}),K({type:"simple",value:null==T||null===(t=T.value)||void 0===t?void 0:t.value})}),[y,A,K,null==T||null===(o=T.value)||void 0===o?void 0:o.value]),H=(0,Te.useCallback)((()=>{var e;null===(e=f.current)||void 0===e||e.blur(),y.setState({open:!1}),v.setState({open:!0})}),[y,v]),D=(0,Ie().yK)((()=>({textInput:{width:"100%"}})),[]),O=(0,Te.useCallback)((()=>{le().clear({environment:r})}),[r]);if(!b||!T||!_)return null;const N=T.name||m.formatMessage(Yt().eC),{parseErrors:U=[],typeErrors:W=[]}=_,z=U.length>0||W.length>0;return(0,et.jsxs)($t().jX,{direction:"column",gap:7,children:[(0,et.jsx)($t().jX,{direction:"row",width:"hug",children:(0,et.jsx)(jo,{analyzedFormulaOutput:_,buttonPopupStore:y,errorMessage:V,onClearClick:Z,onDeleteClick:L,onDuplicateClick:R,onEditFormulaClick:H,onEditTextClick:E,onVariableNameChange:B,variableName:T.name,children:(0,et.jsx)("span",{style:_e().Yu,children:N})})}),(0,et.jsx)(oo().w,{disabled:u,formulaInputButtonPopupStore:v,formulaTypecheckContextValues:C,onChange:K,onTextStoreSelect:k,onTextStoreUnselect:j,onTextEsc:O,parentRecordStore:n,ref:f,spaceId:b,style:D.textInput,value:T.value,shouldShowErrorStyles:z}),(0,et.jsx)(io().g,{analyzedFormulaOutput:_})]},a)}o(470928);var To=()=>o(28832),wo=()=>o(98275),Ao=()=>o(307369),Io=()=>o(247724);const _o=(0,F().vU)({aboveMenuItemLabel:{id:"automations.DuplicateBlocksAction.aboveButtonLabel",defaultMessage:"Above button"},aboveTitle:{id:"automations.DuplicateBlocksAction.aboveTitle",defaultMessage:"above button"},belowMenuItemLabel:{id:"automations.DuplicateBlocksAction.belowButtonLabel",defaultMessage:"Below button"},belowTitle:{id:"automations.DuplicateBlocksAction.belowTitle",defaultMessage:"below button"},title:{defaultMessage:"Insert blocks {insertionPicker}",id:"automations.DuplicateBlocksAction.title"},topOfPageMenuItemLabel:{id:"automations.DuplicateBlocksAction.topOfPageButtonLabel",defaultMessage:"At top of page"},topOfPageTitle:{id:"automations.DuplicateBlocksAction.topOfPageTitle",defaultMessage:"at top of page"},bottomOfPageMenuItemLabel:{id:"automations.DuplicateBlocksAction.bottomOfPageButtonLabel",defaultMessage:"At bottom of page"},bottomOfPageTitle:{id:"automations.DuplicateBlocksAction.bottomOfPageTitle",defaultMessage:"at bottom of page"}}),Po={before:{icon:(0,o(679620).M)({width:16}),key:"before",menuItemLabel:_o.aboveMenuItemLabel,title:_o.aboveTitle},after:{icon:(0,o(253608).s)({width:16}),key:"after",menuItemLabel:_o.belowMenuItemLabel,title:_o.belowTitle},topOfPage:{icon:(0,o(756459).U)({width:16}),key:"topOfPage",menuItemLabel:_o.topOfPageMenuItemLabel,title:_o.topOfPageTitle},bottomOfPage:{icon:(0,o(753463).$)({width:16}),key:"bottomOfPage",menuItemLabel:_o.bottomOfPageMenuItemLabel,title:_o.bottomOfPageTitle}},Vo=Po.after;function Bo(e){const{currentOption:t,disabled:o,insertTopBottomPageEnabled:n,onChange:i}=e,a=(0,F().YB)(),r=(0,Ne().d)(),l=(0,Ae().qz)(void 0,yt().Z),s=(0,Te.useCallback)((e=>{i&&t.key!==e&&i(e),l.setState({open:!1})}),[l,t,i]);return(0,et.jsx)(pt().ZP,{alignmentToOrigin:pt().vR.Center,buttonPopupStore:l,disabled:o,originGap:0,placementToOrigin:pt().pO.Bottom,popupType:r,render:()=>(0,et.jsx)(Ro,{currentOption:t,insertTopBottomPageEnabled:n,onChange:s}),renderOrigin:e=>(0,et.jsx)(Ft().S,{...e,disabled:o,isCompact:!0,dropdownButtonType:"dropdown",children:a.formatMessage(t.title)})})}function Ro(e){const{currentOption:t,insertTopBottomPageEnabled:o,onChange:n}=e,i=(0,F().YB)(),a=(0,Nt().F)({maxWidth:360}),r=Object.values(Po).filter((e=>o||"before"===e.key||"after"===e.key)).map((e=>({key:e.key,render:o=>(0,et.jsx)(dt().Z,{...o,checkState:t.key===e.key,icon:e.icon,title:i.formatMessage(e.menuItemLabel)}),action:()=>n(e.key)})));return(0,et.jsx)(Ht().Z,{...a,children:(0,et.jsx)(Dt().Z,{initialFocus:0,sections:[{key:0,render:e=>(0,et.jsx)(Ot().Z,{enableActionSheetTitle:!0,...e}),items:r}],type:Dt().i.Vertical})})}function Ko(e){const{actionStore:t,disabled:o,contentParentPointer:n,buttonPlacement:a}=e,r=(0,we().O7)(),l=(0,Ie().yK)((e=>({listWrap:{background:e.contentBackground,borderRadius:5,boxShadow:e.inputBoxShadow,fontSize:14,minHeight:64,paddingBlock:3,paddingInline:10,cursor:"text",..."dark"===e.mode?{backgroundColor:e.inputBackground}:{}},emptyPlaceholder:{caretColor:e.mediumTextColor,color:e.lightTextColor,fontSize:14,padding:"5px 0",display:"inline-block"}})),[]),s=(0,Ae().VK)((()=>U().G.createChildStore(t,n)),[t,n]),c=(0,Ae().VK)((()=>s.getContentStore()),[s]),u=(0,Te.useCallback)((()=>{(c.getValue()??[]).length>0||ee().createAndCommit({userAction:"DuplicateBlocksAction.handleListClick",environment:r,canUndo:!0,perform:e=>{const t=i().insertEmptyTextInDuplicateBlockAction({environment:r,contentStore:c,transaction:e});Q().eP({environment:r,store:t}),le().setSelectionAtStart({store:t.getBlockTitleStore()})}})}),[r,c]);if(!c)return null;const d="inline"===(null==a?void 0:a.type);return(0,et.jsx)(Ao().Z,{store:s,analyticsName:"duplicate_blocks_action",isListContainer:!0,children:(0,et.jsx)(Pe().p,{allowSelectionWithin:!0,children:(0,et.jsx)("div",{style:l.listWrap,onClick:u,className:Io().Wh_,children:(0,et.jsx)(To().O,{displayName:"DuplicateBlocksActionContent",disabled:o,children:(0,et.jsx)(wo().Z,{disabled:o,store:c,emptyPlaceholder:(0,et.jsx)("div",{style:l.emptyPlaceholder,children:d?(0,et.jsx)(F()._H,{id:"automations.DuplicateBlocksAction.emptyPlaceholder",defaultMessage:"Click to edit or drop blocks here…"}):(0,et.jsx)(F()._H,{id:"automations.DuplicateBlocksAction.emptyCannotDropPlaceholder",defaultMessage:"Click to edit blocks here…"})}),disableCommentMenu:!0,disableHoverMenu:!1,disableDrag:!1})})})})})}var Fo=()=>o(22183),Zo=()=>o(494616),Lo=()=>o(661641);function Eo(e){const{analyzedFormulaOutput:t,labelMessageDescriptor:o,isOptional:n,errorMessageDescriptor:i}=e,a=(0,F().YB)(),r=(0,wt().E)("automation_updated_error_states"),l=(0,Ae().VK)((()=>(0,io().M)(a,null==t?void 0:t.parseErrors,null==t?void 0:t.typeErrors)),[t,a]),{isMobile:s}=(0,we().Fy)(),c=(0,Ie().yK)((e=>({inputLabel:{display:"flex",alignItems:"center",color:e.text.secondary,fontSize:s?_e().JB.UIRegular.mobile:_e().JB.UIRegular.desktop,lineHeight:s?_e().Nv.UIRegular.mobile:_e().Nv.UIRegular.desktop,fontWeight:_e().Ue.regular},messageInput:{width:"100%"},warningIcon:{color:e.errorText,fill:e.errorText,height:12,flex:"0 0 auto",width:12,display:"flex",marginRight:4},inputLabelInner:{flex:"1 1 auto",...r&&(i||l)&&{color:e.text.uiRedPrimary,fontWeight:_e().Ue.medium}},warningError:{color:e.text.uiRedPrimary}})),[i,l,r,s]);return(0,et.jsxs)($t().jX,{direction:"column",gap:6,children:[(0,et.jsxs)("label",{style:c.inputLabel,children:[l&&(0,fo().t)(c.warningIcon),(0,et.jsxs)("div",{style:c.inputLabelInner,children:[(0,et.jsx)(F()._H,{...o}),n&&(0,et.jsx)(Ho,{})]})]}),(0,et.jsxs)($t().jX,{direction:"column",gap:6,children:[(0,et.jsx)(oo().w,{...e,style:c.messageInput,shouldShowErrorStyles:!!l||e.shouldShowErrorStyles}),l&&(0,et.jsx)(io().g,{analyzedFormulaOutput:t}),!l&&i&&r&&(0,et.jsx)(Lo().q,{colorName:"secondary",styleName:"UISmall-12px/Regular",style:c.warningError,children:(0,et.jsx)(F()._H,{...i})})]})]})}function Ho(){const e=(0,Ie().yK)((e=>({optionalLabel:{color:e.text.tertiary,marginLeft:4}})),[]);return(0,et.jsx)("span",{style:e.optionalLabel,children:(0,et.jsx)(F()._H,{defaultMessage:"{openParenthesis}Optional{closeParenthesis}",id:"automations.SimpleFormulaTextInputWithError.optionalLabel",values:{openParenthesis:"(",closeParenthesis:")"}})})}const Do=(0,F().vU)({confirmationMessageLabel:{defaultMessage:"Confirmation message",id:"automations.BaseModalAction.confirmationMessageLabel"},continueButtonTextLabel:{defaultMessage:"Continue button text",id:"automations.BaseModalAction.continueButtonTextLabel"},cancelButtonTextLabel:{defaultMessage:"Cancel button text",id:"automations.BaseModalAction.cancelButtonTextLabel"}});var Oo=()=>o(912203),No=()=>o(860285);function Uo(e){const{actionStore:t,disabled:o,errorMessage:n,includeThisPage:i,onChange:a,target:r,urlBehavior:l}=e,c=(0,we().O7)(),{typecheckResult:u}=(0,Ee().DZ)(),d=(0,Ae().qz)(void 0,yt().Z),[p,m]=(0,Ae().VK)((()=>[t.id,t.getSpaceId()]),[t]),g=(0,kt().z)({actionId:p}),h=(0,Ae().VK)((()=>{if(r)if("variable"===r.type){if(!u)return;const e=(0,Vt().getContextValueForActionById)(u,p,r.id);if(e)return{type:"variable",contextValue:e}}else{if("page"===r.type||"url"===r.type)return r;(0,s().t1)(r)}}),[r,u,p]),y=(0,Ne().d)(),f=(0,Te.useCallback)((e=>{"page"!==e.type&&"variable"!==e.type&&"url"!==e.type||(a(e),d.reset(),(0,It().GV)(((o,n,i)=>{const a=(0,It().TI)({automationActionStore:t,formulaAnalyticsModule:n,formulasModule:o,simpleFormulasModule:i});(0,s().$K)(a)&&(0,A().j)({environment:c,event:{eventName:"automation_target_pick",eventProperties:{automation_action:a,automation_id:t.getParentId(),target_type:e.type}}})})))}),[a,d,t,c]),v=(0,Te.useCallback)((()=>d.reset()),[d]);let x;return h?"page"===h.type?x=(0,et.jsx)(Rt().Z,{store:U().G.createChildStore(t,h.page),style:{paddingBlock:1}}):"variable"===h.type?x=(0,et.jsx)(Kt().F,{value:h.contextValue,format:Bt().lo.Medium,isSingle:!0,style:{background:"transparent",color:"unset",margin:"-1.5px 0",padding:0}}):"url"===h.type?x=(0,et.jsx)("div",{children:h.url}):(0,s().t1)(h):x="allow"===l?(0,et.jsx)(F()._H,{id:"automations.AutomationPagePicker.pagesDropdown.labelWithUrl",defaultMessage:"Select page, form, or URL"}):(0,et.jsx)(F()._H,{id:"automations.AutomationPagePicker.pagesDropdown.label",defaultMessage:"Select page"}),(0,et.jsx)(pt().ZP,{buttonPopupStore:d,popupType:y,alignmentToOrigin:pt().vR.Center,placementToOrigin:pt().pO.Bottom,originGap:0,disabled:o,renderOrigin:e=>(0,et.jsx)(Ft().S,{...e,disabled:o,isCompact:!0,isError:Boolean(n),hasActionRequired:!Boolean(r),tooltipMessage:n,dropdownButtonType:"dropdown",children:x}),render:e=>(0,et.jsx)(Zt().L,{formulaTypecheckContextValues:g,includeThisPage:i,onChange:f,onClose:v,parentRecordStore:t,selectedTarget:r,skipCollections:!0,spaceId:m,urlBehavior:l})})}function Wo(e){const{actionStore:t,disabled:o,errorMessage:n,onChange:i,value:a,urlBehavior:r}=e,l=(0,Ie().yK)((()=>({picker:{display:"inline-flex",minWidth:50},span:{flex:0,display:"flex",alignItems:"center"},title:{display:"inline-flex",minWidth:50,gap:6}})),[]);return(0,et.jsxs)("div",{style:l.title,children:[(0,et.jsx)(F()._H,{defaultMessage:"<span>Open </span>{pagePicker}",id:"automations.OpenPageAction.action.title",values:{pagePicker:(0,et.jsx)("div",{style:l.picker,children:(0,et.jsx)(Uo,{urlBehavior:r,actionStore:t,disabled:o,errorMessage:n,onChange:i,target:a})}),span:e=>(0,et.jsx)("span",{style:l.span,children:e})}})," "]})}function zo(e){const{actionStore:t,disabled:o,onChange:n}=e,i=(0,Ie().yK)((()=>({picker:{display:"inline-flex",minWidth:50},span:{flex:0,display:"flex",alignItems:"center"},title:{display:"inline-flex",minWidth:50,gap:6}})),[]),a=(0,Ae().VK)((()=>t.getOpenPageIn()),[t]);return(0,et.jsx)("div",{style:i.title,children:(0,et.jsx)(F()._H,{defaultMessage:"<span>in </span>{peekModePicker}",id:"automations.OpenPageAction.peekMode.title",values:{peekModePicker:(0,et.jsx)("div",{style:i.picker,children:(0,et.jsx)(Go,{disabled:o,onChange:n,value:a})}),span:e=>(0,et.jsx)("span",{style:i.span,children:e})}})})}function Go(e){const{disabled:t,onChange:o,value:n}=e,i=(0,Ie().Fg)(),a=(0,Ae().qz)(void 0,yt().Z),r=(0,Ae().VK)((()=>(0,No().v)({currentViewType:void 0,theme:i}).find((e=>e.key===n))),[n,i]),l=(0,Te.useCallback)((()=>a.reset()),[a]),s=(0,Te.useCallback)((e=>{e!==(null==r?void 0:r.key)&&o(e),l()}),[l,null==r?void 0:r.key,o]),c=(0,Ne().d)();return r?(0,et.jsx)(pt().ZP,{alignmentToOrigin:pt().vR.Center,buttonPopupStore:a,disabled:t,originGap:0,placementToOrigin:pt().pO.Bottom,popupType:c,renderOrigin:e=>(0,et.jsx)(Ft().S,{...e,disabled:t,isCompact:!0,dropdownButtonType:"dropdown",children:r.title}),render:e=>(0,et.jsx)($o,{onChange:s,value:n})}):null}function $o(e){const{onChange:t,value:o}=e,n=(0,Ie().Fg)(),i=(0,Ie().yK)((()=>({menuItem:{paddingBlock:8}})),[]),a=(0,Nt().F)({maxWidth:360,width:280}),r=(0,Ae().VK)((()=>(0,No().v)({currentViewType:void 0,theme:n}).map(((e,n)=>({action:()=>t(e.key),key:n,render:t=>(0,et.jsx)(dt().Z,{...t,body:e.body,caption:e.caption,checkState:o===e.key,disabled:!1,icon:e.icon,style:i.menuItem,title:e.title})})))),[t,i.menuItem,n,o]),l=[{key:0,render:e=>(0,et.jsx)(Ot().Z,{enableActionSheetTitle:!0,...e}),items:r}];return(0,et.jsx)(Ht().Z,{...a,children:(0,et.jsx)(Dt().Z,{initialFocus:0,sections:l,type:Dt().i.Vertical})})}var Yo=()=>o(838003),qo=()=>o(471645),Xo=()=>o(667637),Jo=()=>o(67961),Qo=()=>o(352230),en=()=>o(696347),tn=()=>o(594539),on=()=>o(492077),nn=()=>o(128119);function an(e){const{actionStore:t,disabled:o,errorMessage:n,onTargetChange:i,value:a}=e;return(0,et.jsx)(F()._H,{defaultMessage:"Publish{pagePicker}",id:"automations.PublishSiteAction.header.title",values:{pagePicker:(0,et.jsx)(Uo,{actionStore:t,disabled:o,errorMessage:n,includeThisPage:!0,onChange:i,target:a})}})}function rn(){const e=(0,we().Fy)(),t=(0,Ie().yK)((e=>({outerContainer:{paddingTop:15,display:"flex",flexDirection:"column",gap:6},siteSettingsContainer:{borderRadius:10,border:`1px solid ${e.regularDividerColor}`,padding:2},sectionMenuItem:{padding:"6px 2px"},button:{marginLeft:0,marginRight:0,width:"100%",paddingTop:2,paddingBottom:2,background:"transparent"},itemInnerContainer:{marginLeft:0,paddingLeft:8,minWidth:"auto",background:"transparent"}})),[]),o={type:"public_permission",role:"reader",expiration_timestamp:void 0},n=[{key:"linkExpiration",render:e=>(0,et.jsx)(tn().Z,{...e,disabled:!1,permissionItem:o,onChange:e=>{},hideIcon:!0}),action:()=>{}},{key:"enableQna",render:o=>(0,et.jsx)(Xo().Z,{...o,isMobile:e.isMobile,buttonStyle:t.button,textWrapperStyle:t.itemInnerContainer,title:(0,et.jsx)(F()._H,{defaultMessage:"Enable QnA",id:"automations.PublishSiteAction.action.siteSettingsEnableQna.title"}),on:!0,onClick:()=>{}}),action:()=>{}},{key:"enableSeo",render:o=>(0,et.jsx)(Xo().Z,{...o,isMobile:e.isMobile,buttonStyle:t.button,textWrapperStyle:t.itemInnerContainer,title:(0,et.jsx)(F()._H,{defaultMessage:"Search engine indexing",id:"automations.PublishSiteAction.action.siteSettingsEnableSEO.title"}),on:!1,onClick:()=>{}}),action:()=>{}}],i=(0,r().oA)([{key:0,render:e=>(0,et.jsx)(Ot().Z,{style:t.sectionMenuItem,...e}),items:n}]);return(0,et.jsxs)("div",{style:t.outerContainer,children:[(0,et.jsx)("label",{children:(0,et.jsx)(F()._H,{defaultMessage:"Settings",id:"automations.PublishSiteAction.action.siteSettingsTitle"})}),(0,et.jsx)(Dt().Z,{type:Dt().i.Vertical,sections:i,initialFocus:void 0,resetFocusOnMouseOut:!0,style:t.siteSettingsContainer})]})}function ln(){const e=(0,Ie().yK)((e=>({outerContainer:{paddingTop:15,display:"flex",flexDirection:"column",gap:6},siteSettingsContainer:{borderRadius:10,border:`1px solid ${e.regularDividerColor}`,padding:2},sectionMenuItem:{padding:"6px 2px"},button:{marginLeft:0,marginRight:0,width:"100%",paddingTop:2,paddingBottom:2,background:"transparent"},itemInnerContainer:{marginLeft:0,paddingLeft:8,minWidth:"auto",background:"transparent"}})),[]),t=[{key:"theme",render:t=>(0,et.jsx)(sn,{...t,style:e.sectionMenuItem}),action:()=>{}},{key:"header",render:t=>(0,et.jsx)(dn,{...t,style:e.sectionMenuItem}),action:()=>{}},{key:"googleAnalytics",render:t=>(0,et.jsx)(mn,{...t,style:e.sectionMenuItem}),action:()=>{}}],o=(0,r().oA)([{key:0,render:t=>(0,et.jsx)(Ot().Z,{style:e.sectionMenuItem,...t}),items:t}]);return(0,et.jsxs)("div",{style:e.outerContainer,children:[(0,et.jsx)("label",{children:(0,et.jsx)(F()._H,{defaultMessage:"Site customization",id:"automations.PublishSiteAction.action.siteCustomizationTitle"})}),(0,et.jsx)(Dt().Z,{type:Dt().i.Vertical,sections:o,initialFocus:void 0,resetFocusOnMouseOut:!0,style:e.siteSettingsContainer})]})}const sn=Te.forwardRef(((e,t)=>{const o=(0,we().Fy)(),n=(0,Ie().yK)((e=>({chevronIcon:{height:12,width:12,fill:e.icon.tertiary,transform:"rotate(90deg)"}})),[]),i=(0,Te.useCallback)((e=>{}),[]),a="system";return(0,et.jsx)(Yo().Z,{...e,popupType:o.isMobile?pt().Z4.SlideUp:pt().Z4.Popup,renderOrigin:t=>(0,et.jsx)(on().C,{...(0,Je().Z)(e,t),title:(0,et.jsx)(F()._H,{defaultMessage:"Theme",id:"automations.PublishSiteAction.action.siteCustomization.themeTitle"}),right:(0,et.jsxs)(et.Fragment,{children:[(0,et.jsx)(cn,{value:a}),(0,en().o)(n.chevronIcon)]})}),alignmentToOrigin:nn().lU.End,placementToOrigin:nn().Iw.Bottom,render:e=>(0,et.jsx)(un,{value:a,onChange:i,onClose:()=>{e.close()}})})}));function cn(e){const{value:t}=e,o=(0,Ie().yK)((e=>({container:{color:e.text.secondary}})),[]);return t?"system"===t?(0,et.jsx)(Jo().Z,{style:o.container,children:(0,et.jsx)(F()._H,{defaultMessage:"System",id:"automations.PublishSiteAction.action.siteCustomization.themeOptions.system"})}):"light"===t?(0,et.jsx)(Jo().Z,{style:o.container,children:(0,et.jsx)(F()._H,{defaultMessage:"Light",id:"automations.PublishSiteAction.action.siteCustomization.themeOptions.light"})}):"dark"===t?(0,et.jsx)(Jo().Z,{style:o.container,children:(0,et.jsx)(F()._H,{defaultMessage:"Dark",id:"automations.PublishSiteAction.action.siteCustomization.themeOptions.dark"})}):void(0,s().t1)(t):null}function un(e){const{value:t,onChange:o,onClose:n}=e,i=(0,we().Fy)(),a=(0,Te.useCallback)((e=>{void 0!==e&&e!==t&&o(e),n()}),[t,o,n]),r=["system","light","dark"].map((e=>({key:e,render:t=>(0,et.jsx)(dt().Z,{...t,title:(0,et.jsx)(cn,{value:e})}),action:()=>{a(e)}}))),l=[{key:0,render:e=>(0,et.jsx)(Ot().Z,{...e}),items:r}];return(0,et.jsx)(Ht().Z,{menuType:i.isMobile?Qo().o.ActionSheet:Qo().o.Popup,width:240,children:(0,et.jsx)(Dt().Z,{type:Dt().i.Vertical,initialFocus:r.findIndex((e=>e.key===t)),sections:l})})}sn.displayName="ThemeCustomizationItem";const dn=Te.forwardRef(((e,t)=>{const o=(0,we().Fy)(),n=(0,Ie().yK)((e=>({chevronIcon:{height:12,width:12,fill:e.icon.tertiary,transform:"rotate(90deg)"}})),[]),i=(0,Te.useCallback)((e=>{}),[]),a={};return(0,et.jsx)(Yo().Z,{...e,popupType:o.isMobile?pt().Z4.SlideUp:pt().Z4.Popup,renderOrigin:t=>(0,et.jsx)(on().C,{...(0,Je().Z)(e,t),title:(0,et.jsx)(F()._H,{defaultMessage:"Header",id:"automations.PublishSiteAction.action.siteCustomization.headerTitle"}),right:(0,et.jsxs)(et.Fragment,{children:[(0,et.jsx)(F()._H,{defaultMessage:"Default",id:"automations.PublishSiteAction.action.siteCustomization.headerDefaultValue"}),(0,en().o)(n.chevronIcon)]})}),alignmentToOrigin:nn().lU.End,placementToOrigin:nn().Iw.Bottom,render:e=>(0,et.jsx)(pn,{value:a,onChange:i,onClose:()=>{e.close()}})})}));function pn(e){const{value:t}=e,o=(0,we().Fy)(),n=[{key:"breadcrumbs",render:e=>(0,et.jsx)(on().C,{...e,title:(0,et.jsx)(F()._H,{defaultMessage:"Breadcrumbs",id:"automations.PublishSiteAction.action.siteCustomization.headerOptionBreadcrumb"}),right:(0,et.jsx)(qo().Z,{...e,on:!(null!=t&&t.hideBreadcrumbs)})}),action:()=>{}},{key:"search",render:e=>(0,et.jsx)(on().C,{...e,title:(0,et.jsx)(F()._H,{defaultMessage:"Search",id:"automations.PublishSiteAction.action.siteCustomization.headerOptionSearch"}),right:(0,et.jsx)(qo().Z,{...e,on:!(null!=t&&t.hideSearch)})}),action:()=>{}},{key:"watermark",render:e=>(0,et.jsx)(on().C,{...e,disabled:!0,title:(0,et.jsx)(F()._H,{defaultMessage:"Watermark",id:"automations.PublishSiteAction.action.siteCustomization.headerOptionWatermark"}),right:(0,et.jsx)(qo().Z,{...e,disabled:!0,on:!(null!=t&&t.hideWatermark)})}),action:()=>{}}],i=[{key:0,render:e=>(0,et.jsx)(Ot().Z,{...e}),items:n}];return(0,et.jsx)(Ht().Z,{menuType:o.isMobile?Qo().o.ActionSheet:Qo().o.Popup,width:240,children:(0,et.jsx)(Dt().Z,{type:Dt().i.Vertical,initialFocus:n.findIndex((e=>e.key===t)),sections:i})})}dn.displayName="HeaderCustomizationItem";const mn=Te.forwardRef(((e,t)=>{const o=(0,Te.useRef)(null);return(0,et.jsx)(on().C,{...e,title:(0,et.jsx)(F()._H,{defaultMessage:"Google Analytics",id:"automations.PublishSiteAction.action.siteCustomization.googleAnalyticsTitle"}),right:(0,et.jsx)(gn,{ref:o,value:undefined}),onClick:()=>{var e;return null===(e=o.current)||void 0===e?void 0:e.focus()}})}));mn.displayName="GoogleAnalyticsCustomizationSetting";const gn=Te.forwardRef(((e,t)=>{const{value:o}=e,[n,i]=(0,Te.useState)(!1),a=!1,r=(0,Ie().yK)((e=>({inputContainer:{background:e.surface.page,borderRadius:4,boxShadow:n?"0px 0px 0px 1px #2383E2 inset, 0px 0px 0px 2px rgba(35, 131, 226, 0.35)":`${e.regularDividerColor} 0px 0px 0px 1px inset`,height:28,padding:8,fontWeight:_e().Ue.regular,fontSize:14,lineHeight:1.3,color:e.text.secondary},input:{marginLeft:-6,paddingLeft:0,color:e.text.primary},wrapper:{paddingTop:4,paddingBottom:4}})),[a,n]);return(0,et.jsx)("div",{style:r.wrapper,children:(0,et.jsx)(Ve().Z,{ref:t,type:"text",style:r.inputContainer,inputStyle:r.input,value:o,onChange:e=>{},format:Ve().B.Transparent,onFocus:()=>i(!0),onBlur:()=>i(!1),left:"G-",disabled:a})})}));gn.displayName="GoogleAnalyticsInput";o(749411);var hn=()=>o(309968),yn=()=>o(235484),fn=()=>o(154186),vn=()=>o(71194),xn=()=>o(821149),Sn=()=>o(138912),bn=()=>o(339352);o(30005);function Cn(e){const t=(0,we().O7)();(0,Ae().VK)((()=>{(0,h().lcG)(e).forEach((e=>{new(U().U6)(t,{table:b().KJ,id:e},{userId:e}).isDefined()}))}),[t,e])}var kn=()=>o(3425),jn=()=>o(400836),Mn=()=>o(209956),Tn=(o(731107),()=>o(226413)),wn=()=>o(446866),An=()=>o(619186),In=()=>o(801812),_n=()=>o(981583),Pn=()=>o(815325),Vn=()=>o(122671),Bn=()=>o(654723),Rn=()=>o(828946),Kn=()=>o(98228),Fn=()=>o(692304),Zn=()=>o(96735),Ln=()=>o(874101),En=()=>o(793041),Hn=()=>o(267842);function Dn(e){let{handleRemoveToken:t,token:o,format:n,style:i,addQuotes:a,renderAvatar:r,isDisabled:l}=e;const s=(0,Ie().Fg)();if(!(0,wn().oH)(o))return null;const c=a?`“${o}”`:o;return(0,et.jsx)(En().ZP,{title:c,format:n??Bt().lo.Small,renderAvatar:r||(e=>(0,Hn().a)({width:e,height:e,padding:2,marginRight:6})),showRemoveButton:Boolean(t)&&!l,onClickRemove:e=>{null==e||e.stopPropagation(),t&&t(o)},style:{background:s.accentColors.gray[75],...i},shouldShrink:!0,isSingle:!1})}var On=()=>o(887766);const Nn=["gmail.com","yahoo.com","outlook.com"],Un=["com","net","org"];var Wn=()=>o(838367),zn=()=>o(470386),Gn=()=>o(497459),$n=()=>o(122890),Yn=()=>o(534801),qn=()=>o(879931);function Xn(e){let{email:t,disabled:o,menuArgs:n}=e;const i=(0,qn().L)();return(0,et.jsx)(dt().Z,{...n,title:(0,et.jsx)(Dn,{token:t,format:Bt().lo.Inline,addQuotes:!0,style:{background:void 0,padding:void 0}}),disabled:o,style:o?i.disabledMenuItem:void 0,isTokenTitle:!0})}function Jn(e){let{token:t,disabled:o,menuArgs:n,type:i}=e;const a=(0,qn().L)(),r=(0,Ie().Fg)();return(0,et.jsx)(dt().Z,{...n,title:(0,et.jsx)(On().Z,{token:t,type:i,format:Bt().lo.Inline,style:{color:r.darkTextColor,background:void 0,padding:void 0}}),disabled:o,style:{...o?a.disabledMenuItem:void 0},isTokenTitle:!0})}var Qn=()=>o(816512),ei=()=>o(864832);function ti(e){let{annotation:t,disabled:o,getRecordModel:n,menuArgs:i}=e;const a=(0,qn().L)(),r=(0,Ae().VK)((()=>{if((0,to().isAnnotationSimpleValueToken)(t)&&(0,h().IWo)(t)){const e=(0,h().zEN)(t);return e?(0,Qn().Hl)({pointer:{table:b().KJ,id:e},getRecordModel:n,getRecordValue:void 0}):void 0}}),[t,n]);return null!=r&&r.asActor&&r.table===b().KJ?(0,et.jsx)(dt().Z,{...i,title:(0,et.jsx)(oi,{actor:r}),disabled:o,style:o?a.disabledMenuItem:void 0,isTokenTitle:!0}):null}function oi(e){let{actor:t}=e;const o=(0,Ie().yK)((e=>({root:{margin:"4px 0"},actor:{margin:"0 10px 0 0"},email:{color:e.actionMenuButtonTextColor,margin:"0 0 0 26px"}})),[]),n=(0,Ae().VK)((()=>t.getName()),[t]),i=(0,Ae().VK)((()=>t.getEmail()),[t]);return(0,et.jsxs)("div",{style:o.root,children:[(0,et.jsx)(ei().ZP,{actor:t,format:Bt().lo.Medium,shouldShrink:!0,isSingle:!1,style:o.actor},t.id),n&&(0,et.jsx)(En().ZP,{title:i,format:Bt().lo.ExtraSmall,isSingle:!1,style:o.email})]})}function ni(e){const{action:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:n,formulaValueContext:i,getRecordModel:a,isDisabled:l,limit:s,menuProps:c,onChange:u,onClose:d,onFormulaButtonClick:p,showFormulaValueItems:m=!1,value:y,pageProperties:f,parentRecordStore:v,showInputErrorStyles:x}=e,S=(0,we().Fy)(),b=(0,Ie().Fg)(),{errorMessage:C,isLoading:k,menuListStore:j,noResultsMessage:M,searchInput:T,userItems:w,valueItems:A,pagePropertyItems:I,emailItems:_}=function(e){var t,o,n;const{action:i,formulaTypecheckContextValues:a,formulaValueContext:l,isDisabled:s=!1,limit:c,onChange:u,onClose:d,onFormulaButtonClick:p,unlimitedCurrentSimpleFormulaValueTokens:m,value:y,pageProperties:f,parentRecordStore:v,showInputErrorStyles:x}=e,S=(0,we().O7)(),b=(0,F().YB)(),{collectionStore:C,property:k}="collection"===l.type?l:{collectionStore:void 0,property:void 0},j=v.getRecordModel,M=(0,no().Mv)(l),T=M(m,"first"),w=a.filter((e=>(0,bo().uy)(e.type,{type:"person"}))),A=(0,Ie().yK)((e=>({personToken:{background:e.accentColors.gray[75],borderRadius:"6px"},formulaValueToken:{background:e.buttonBackground},searchInput:{maxHeight:6*parseInt(Vn().go,10),width:"100%",margin:0,minHeight:32,background:e.accentColors.gray[30],...x&&{border:`1px solid ${e.text.uiRedPrimary}`,boxShadow:"none"}},clearButton:{height:20},clearButtonIcon:{height:15,width:15,fill:e.lightIconColor},actionButtonGroup:{alignSelf:"end",cursor:"unset",justifyContent:"end"}})),[x]),[I,_]=(0,Te.useState)(""),P=(0,Te.useRef)(null),V=(0,Te.useRef)(""),B=(0,Ae().qz)(void 0,Fn().Z),R=(0,Ae().VK)((()=>(null==C?void 0:C.getSchema())??{}),[C]),K=(0,Ae().VK)((()=>{if(R&&k){const e=R[k];if(e&&(0,Tn().en)(e))return 1===e.limit}return!1}),[R,k]),[Z]=(0,In().r5)((async()=>{const e=I?(0,An().ZP)(I,w,(e=>e.kind===g().FormulaContextValueKind.ContextValue?e.name:"")):w,t=I?(0,An().ZP)(I,f,(e=>(0,h().pxR)(e).name??"")):f,o=await Rn().x.searchActions.load(),n=await o.searchVisibleSpaceUsers({environment:S,query:I,membersOnly:!1}),i=(0,to().fromSimpleFormulaArrayValue)(null==y?void 0:y.value).reduce(((e,t)=>(t&&(0,to().isAnnotationSimpleValueToken)(t)&&(0,h().IWo)(t)&&e.push(t[1]),e)),[]);let a=0,r=n[a];const l=[];for(;r&&l.length<20;)i.includes(r.id)||l.push(r.id),a+=1,r=n[a];return{valueResults:e,userResults:l,pagePropertyResults:t}}),[S,I,w,null==y?void 0:y.value,f],{debounce:Kn().vp}),L=(0,Te.useCallback)((()=>{var e;_(""),null===(e=P.current)||void 0===e||e.focus(),B.setState({...B.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}),[B]),E=(0,Te.useCallback)(((e,t)=>{u(e||y,t||i)}),[i,u,y]),H=(0,Te.useCallback)((e=>{const t=M(e,"last");E({type:"simple",value:(0,to().toSimpleFormulaArrayValue)(t)}),L()}),[M,E,L]),D=(0,Te.useCallback)((()=>{H(T.slice(0,T.length-1))}),[T,H]),O=(0,Te.useCallback)((e=>{null==H||H((0,to().simpleFormulaValueWithoutToken)(T,e))}),[T,H]),N=Boolean(c&&T.length>=c),U=r().oA(T.map(((e,t)=>{if("boolean"==typeof e)return null;if("string"==typeof e)return(0,et.jsx)(Dn,{handleRemoveToken:O,token:e,isDisabled:s,renderAvatar:t=>(0,_n().Z)({avatar:{email:e},style:{marginRight:4}}),style:A.personToken},t);if((0,h().IWo)(e))return(0,et.jsx)(Zn().Z,{handleRemoveToken:O,token:e,isDisabled:s,style:A.personToken,preventOnClickPropagation:!0},t);if((0,h().wjk)(e))return(0,et.jsx)(Ln().Z,{formulaTypecheckContextValues:a,handleRemoveToken:O,isDisabled:s,style:A.formulaValueToken,token:e,preventOnClickPropagation:!0},t);if((0,h().Lyt)(e)){var o;const n=(0,h().pxR)(e);return(0,et.jsx)(On().Z,{type:null===(o=R[n.property])||void 0===o?void 0:o.type,isDisabled:s,handleRemoveToken:O,token:e},t)}return null}))),z=new Set(r().oA(T.map((e=>(0,to().isAnnotationSimpleValueToken)(e)&&(0,h().wjk)(e)&&(0,h().vmO)(e).id)))),G=new Set(r().oA(T.map((e=>(0,to().isAnnotationSimpleValueToken)(e)&&(0,h().IWo)(e)&&(0,h().zEN)(e))))),$=r().oA(((null===(t=Z.value)||void 0===t?void 0:t.valueResults)||[]).map((e=>{const t=e.kind===g().FormulaContextValueKind.ContextValue&&e.id||"";if(!t||!z.has(t))return{action:"append",currentSimpleFormulaValueTokens:T,isDisabled:s||N,id:t,getRecordModel:j,setCurrentTokens:H,value:e}}))),Y=r().oA(((null===(o=Z.value)||void 0===o?void 0:o.userResults)||[]).map((e=>{const t=G.has(e);if(t)return;const o=(0,h().tEo)(e);return{action:()=>{t?O(o):H([...T,o]),K&&W().default.afterNextFlush((()=>{d()}))},annotation:o,getRecordModel:j,id:e,isDisabled:s||N,userId:e,isSelected:t}}))),q=new Set(T.filter((e=>(0,to().isAnnotationSimpleValueToken)(e)&&(0,h().Lyt)(e))).map((e=>(0,h().pxR)(e).property))),X=r().oA(null===(n=Z.value)||void 0===n?void 0:n.pagePropertyResults.map((e=>{var t;const o=(0,h().pxR)(e);if(!q.has(o.property))return{id:o.property,type:null===(t=R[o.property])||void 0===t?void 0:t.type,isDisabled:s||N,action:()=>{H([...T,e])},propertyAnnotation:e}}))),J=(0,Te.useCallback)((e=>{(0,wn().oH)(e)&&H([...T,e])}),[T,H]),Q=(0,Te.useCallback)((()=>{J(V.current)}),[J]);(0,Te.useEffect)((()=>{V.current=I}),[I]),(0,Te.useEffect)((()=>{const e=P.current;return e&&e.addEventListener("blur",Q),()=>{e&&e.removeEventListener("blur",Q)}}),[Q]);const ee=(0,wn().oH)(I)?[I]:[];if(0===ee.length){const[e,t]=I.split("@");if(t){const[o,n]=t.split(".");(!n||n.length<=1)&&ee.push(...Un.map((t=>`${e}@${o}.${t}`)).filter(wn().oH))}else ee.push(...Nn.map((t=>`${e}@${t}`)).filter(wn().oH))}const te=ee.map((e=>({action:()=>J(e),isDisabled:s||N,email:e}))),oe=[...$,...Y,...X,...te],ne=(0,wt().E)("gmail_action_formula_recipients");return{errorMessage:Z.error&&b.formatMessage(Pn().s.somethingWentWrong),header:b.formatMessage(Pn().s.genericMenuHeader),isLoading:!Z.value&&!Z.error,menuListStore:B,noResultsMessage:0===oe.length&&Z.value&&b.formatMessage(Pn().s.noResults),searchInput:e=>(0,et.jsx)(Vn().ZP,{ref:P,style:A.searchInput,right:(0,et.jsxs)($t().jX,{direction:"row",style:A.actionButtonGroup,children:[ne&&p&&(0,et.jsx)(jn().p,{disabled:s,onClick:e=>{e.stopPropagation(),p(e)},value:y}),(0,et.jsx)($e().Z,{ariaLabel:"Clear",disabled:s,disabledFeedback:s,onClick:e=>{e.stopPropagation(),H([])},style:A.clearButton,icon:Bn().X,iconStyle:A.clearButtonIcon})]}),disabled:s||N,format:Vn().UR.FilterValue,onChange:e=>_(e.target.value),onRemoveLastToken:D,placeholder:"",onClick:e,tokens:U,value:I}),userItems:Y,valueItems:$,pagePropertyItems:X,emailItems:te}}({action:t,formulaTypecheckContextValues:n,formulaValueContext:i,isDisabled:l,limit:s,onChange:u,onClose:d,onFormulaButtonClick:p,unlimitedCurrentSimpleFormulaValueTokens:o,value:y,pageProperties:f,parentRecordStore:v,showInputErrorStyles:x})||{},P=(0,Te.useMemo)((()=>A&&m?A.map((e=>{const{annotation:t,itemAction:o}=(0,Yn().A)({action:e.action,currentSimpleFormulaValueTokens:e.currentSimpleFormulaValueTokens,setCurrentTokens:e.setCurrentTokens,value:e.value});return{key:e.id,render:o=>(0,et.jsx)($n().Z,{annotation:t,disabled:e.isDisabled,formulaTypecheckContextValues:n,menuArgs:o,style:{background:void 0,color:b.darkTextColor,padding:void 0},parentRecordStore:v}),action:o}})):[]),[A,m,n,b,v]),V=(0,Te.useMemo)((()=>w?w.map((e=>({key:e.userId,render:t=>(0,et.jsx)(ti,{annotation:e.annotation,disabled:e.isDisabled,menuArgs:t,getRecordModel:a||e.getRecordModel}),action:e.action}))):[]),[a,w]),B=[...P,...(0,Te.useMemo)((()=>I?I.map((e=>({key:e.id,render:t=>(0,et.jsx)(Jn,{disabled:e.isDisabled,menuArgs:t,type:e.type,token:e.propertyAnnotation}),action:e.action}))):[]),[I])],R=[];B.length>0&&R.push({key:"properties",render:e=>(0,et.jsx)(Ot().Z,{...e,title:"Property",topBorder:!1}),items:B}),V.length>0&&R.push({key:"users",render:e=>(0,et.jsx)(Ot().Z,{...e,title:"Person",topBorder:B.length>0}),items:V});const K=(0,Te.useMemo)((()=>_?_.map((e=>({key:e.email,action:e.action,render:t=>(0,et.jsx)(Xn,{email:e.email,disabled:e.isDisabled,menuArgs:t})}))):[]),[_]);let Z;K.length>0&&R.push({key:"emails",render:e=>(0,et.jsx)(Ot().Z,{...e,title:"Email",topBorder:B.length>0||V.length>0}),items:K}),Z=S.isMobile?{menuType:Qo().o.Modal,right:(0,et.jsx)(zn().DoneMenuText,{}),minWidth:"100%"}:{menuType:Qo().o.Popup,maxHeight:"50vh",minWidth:"100%",disableHeaderBorder:!0};const L={width:"260px"},E=(0,et.jsxs)(et.Fragment,{children:[C&&(0,et.jsx)(Ot().Z,{style:L,children:(0,et.jsx)(Wn().Z,{title:C})}),M&&(0,et.jsx)(Ot().Z,{style:L,children:(0,et.jsx)(Wn().Z,{title:M})}),k&&(0,et.jsx)(Ot().Z,{style:L,children:(0,et.jsx)(Gn().Z,{})}),R.length>0&&(0,et.jsx)(Dt().Z,{type:Dt().i.Vertical,initialFocus:0,sections:R,store:j,style:L})]});return{searchInput:T,innerComponents:E,emailRecipientsMenu:(0,et.jsx)(Ht().Z,{...Z,...c,children:E})}}function ii(e){const{currentValue:t,onChange:o,parentRecordStore:n,spaceId:i,formulaTypecheckContextValues:a,disabled:r}=e;return"formula"===(null==t?void 0:t.type)?(0,et.jsx)(li,{parentRecordStore:n,spaceId:i,value:t,formulaTypecheckContextValues:a,isDisabled:r,onChange:o}):(0,et.jsx)(ai,{...e})}function ai(e){const{currentValue:t,collectionStore:o,onChange:n,formulaTypecheckContextValues:i,limit:a,pageProperties:r,disabled:l,parentRecordStore:c,errorMessage:u}=e,d=o?{type:"collection",collectionStore:o,property:"person"}:{type:"empty"},p={menuType:Qo().o.Popup},m=(0,Ae().VK)((()=>(0,to().fromSimpleFormulaArrayValue)(null==t?void 0:t.value)),[t]),{searchInput:g,emailRecipientsMenu:h}=ni({currentSimpleFormulaValueTokens:m,formulaTypecheckContextValues:i,formulaValueContext:d,limit:a,menuProps:p,onChange:n,onClose:window.parent.close,onFormulaButtonClick:e=>{e.stopPropagation(),n({type:"formula",value:null==t?void 0:t.value})},showFormulaValueItems:!0,showGenericHeader:!0,value:t,pageProperties:r,isDisabled:l,parentRecordStore:c,showInputErrorStyles:(0,s().$K)(u)});return(0,et.jsx)(pt().ZP,{renderOrigin:e=>{let{onClick:t}=e;return null==g?void 0:g(t)},popupType:pt().Z4.Popup,render:()=>h})}const ri=[{type:"person"},{type:"text"},{type:"array",of:{type:"person"}},{type:"array",of:{type:"text"}}];function li(e){const{formulaTypecheckContextValues:t,parentRecordStore:o,spaceId:n,value:i,onChange:a,isDisabled:r}=e,l=(0,Ie().yK)((e=>({containerWrap:{width:"100%"},formulaText:{whiteSpace:"pre-wrap",cursor:"pointer"},scroller:{flexGrow:1,width:"100%"},textWrap:{cursor:"text",display:"flex",flexWrap:"wrap",justifyContent:"end",width:"100%"},wrap:{background:e.inputBackground,boxShadow:e.inputBoxShadow,boxSizing:"border-box",cursor:"text",padding:"4px 8px"},actionButtonGroup:{alignSelf:"end",cursor:"unset",justifyContent:"end"}})),[]),s=async e=>{e.stopPropagation();await(0,no().bs)()&&(null==a||a({type:"simple",value:null==i?void 0:i.value}))},c=(0,Ae().qz)(void 0,yt().Z),u=(0,Te.useCallback)((()=>c.setState({open:!1})),[c]);return(0,et.jsx)(pt().ZP,{buttonPopupStore:c,renderOrigin:e=>(0,et.jsx)("div",{...e,style:l.containerWrap,children:(0,et.jsx)($t().jX,{align:"center",className:Io().Wh_,direction:"column",gap:4,style:l.wrap,children:(0,et.jsxs)("div",{style:l.textWrap,children:[(0,et.jsx)(Ke().Z,{style:l.scroller,type:Le().Z.Y,children:(0,et.jsx)("div",{style:l.formulaText,children:(0,et.jsx)(kn().I,{formulaTypecheckContextValues:t,parentRecordStore:o,spaceId:n,value:i})})}),(0,et.jsx)("div",{children:(0,et.jsx)($t().jX,{direction:"row",gap:2,style:l.actionButtonGroup,children:(0,et.jsx)(jn().p,{disabled:r,onClick:s,value:i})})})]})})}),popupType:pt().Z4.Popup,render:()=>(0,et.jsx)(Mn().Z,{allowedReturnTypes:ri,disabled:r,formulaTypecheckContextValues:t??[],onChange:a,onClose:u,parentRecordStore:o,value:i,spaceId:n})})}var si=()=>o(714230),ci=()=>o(388915),ui=()=>o(423402),di=()=>o(18748),pi=()=>o(286338),mi=()=>o(817771),gi=()=>o(388957);const hi=(0,F().vU)({gmailAccountMenuPickerHeader:{defaultMessage:"Select Account",id:"automations.gmailAccountPicker.menuHeader"},gmailAccountMenuPickerHeaderInvalidAccount:{defaultMessage:"Invalid Account",id:"automations.gmailAccountPicker.menuHeaderInvalidAccount"},gmailAccountMenuPickerHeaderInvalidAccountTooltip:{defaultMessage:"Connect a valid account or delete this step",id:"automations.gmailAccountPicker.menuHeaderInvalidAccountTooltip"},addGmailAccountLabel:{id:"automations.gmailAccountPicker.setupAnotherGmailAccount.label",defaultMessage:"Add Gmail Account"},manageAccountInfoCaption:{id:"automations.gmailAccountPicker.manageAccountInfo.caption",defaultMessage:"Manage connected accounts in the “My Connections” tab of Settings"},connectGmailAccountMobileLabel:{id:"automations.gmailAccountPicker.connectGmailAccountMobile.label",defaultMessage:"Connect Gmail Account"},connectGmailAccountMobileCaption:{id:"automations.gmailAccountPicker.connectGmailAccountMobile.caption",defaultMessage:"Open desktop or web app to connect"},connectGmailAccountLabel:{id:"automations.gmailAccountPicker.connectGmailAccount.label",defaultMessage:"Connect Gmail Account"},connectGmailAccountCaption:{id:"automations.gmailAccountPicker.connectGmailAccount.caption",defaultMessage:"Allow Notion to send email on your behalf"}});function yi(e){const{currentGmailAuthentication:t,gmailAuthentications:o,disabled:n,errorMessage:i,onAccountChange:a}=e,r=(0,we().O7)(),l=(0,we().Fy)(),s=(0,Ae().VK)((()=>{var e;return null===(e=ne().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),c="collection_view_settings",u=(0,Ae().VK)((()=>Sn().default.integrations.state.find((e=>e.id===yn().aG))),[]),d=Boolean(i),p=(0,Ae().qz)(void 0,yt().Z),m=(0,Te.useCallback)((e=>{a(e),(0,A().j)({environment:r,event:{eventName:"gmail_action_account_click",eventProperties:{}}}),p.reset()}),[a,p,r]),g=(0,Ne().d)(),h=(0,Nt().F)(),y=(0,Ie().yK)((e=>({infoItem:{color:e.text.secondary,cursor:"default"},connectAccount:{paddingRight:"32px"},externalLinkIcon:{color:e.icon.tertiary,width:18,height:"auto"},plusMediumIcon:{width:16,height:"auto",marginRight:8,marginLeft:1},manageAccountCaption:{color:e.text.tertiary},errorText:{color:e.errorText}})),[]);if(!u)return null;const f=[{items:o.map(((e,o)=>({action:()=>null,key:e.id,render:()=>{const o=(null==t?void 0:t.id)===e.id;return(0,et.jsx)(dt().Z,{focused:(null==t?void 0:t.id)===e.id,onClick:async()=>{if(s)if(o&&d){const e=await fi(r,u,s,c);if("success"!==e.status)return void p.reset();m(e.externalAuthentication.id)}else m(e.id)},title:e.account_name,left:(0,et.jsx)(_n().Z,{avatar:{email:e.account_name},style:{marginRight:8}}),right:d?(0,fo().t)({width:12,height:"auto",marginLeft:12}):(0,mi().A)({width:18,height:"auto",marginLeft:12}),rightStyle:{visibility:o?"visible":"hidden"},style:{...o&&d&&y.errorText},bodyStyle:{minWidth:"280px"}},e.id)}}))),key:"gmailAccounts",render:e=>(0,et.jsx)(Ot().Z,{topBorder:!0,...e,enableActionSheetTitle:!0})}];f.push({key:"add-another-gmail-account-section",items:[{key:"add-another-gmail-account-item",action:async()=>{if(!s)return;const e=await fi(r,u,s,c);"success"===e.status&&(a(e.externalAuthentication.id),p.reset())},render:e=>(0,et.jsx)(dt().Z,{...e,left:(0,ht().A)(y.plusMediumIcon),right:(0,gi().K)(y.externalLinkIcon),title:(0,et.jsx)(F()._H,{...hi.addGmailAccountLabel}),bodyStyle:{marginLeft:1}})}],render:e=>(0,et.jsx)(Ot().Z,{...e,topBorder:!0})}),f.push({key:"manage-account-info-section",items:[{key:"manage-account-info-item",action:()=>null,render:e=>(0,et.jsx)(dt().Z,{...e,style:y.infoItem,focused:!1,caption:(0,et.jsx)(di().W0,{caption:(0,et.jsx)(F()._H,{...hi.manageAccountInfoCaption}),shouldWrapCaption:!0,captionStyle:y.manageAccountCaption})})}],render:e=>(0,et.jsx)(Ot().Z,{...e,topBorder:!0})});const v={key:"connect-gmail-account-mobile-item",action:()=>null,render:e=>(0,et.jsx)(dt().Z,{...e,icon:(0,et.jsx)("img",{src:si().Z.images.externalIntegrations.gmailIconPng,style:{width:18,height:"auto"}}),focused:!1,disabled:!0,buttonStyle:y.connectAccount,title:(0,et.jsx)(F()._H,{...hi.connectGmailAccountMobileLabel}),caption:(0,et.jsx)(di().W0,{caption:(0,et.jsx)(F()._H,{...hi.connectGmailAccountMobileCaption}),shouldWrapCaption:!0})})},x={key:"connect-gmail-account-item",action:async()=>{if(p.reset(),!s)return;const e=await fi(r,u,s,c);"success"===e.status&&a(e.externalAuthentication.id)},render:e=>(0,et.jsx)(dt().Z,{...e,icon:(0,et.jsx)("img",{src:si().Z.images.externalIntegrations.gmailIconPng,style:{width:18,height:"auto"}}),focused:!1,buttonStyle:y.connectAccount,title:(0,et.jsx)(F()._H,{...hi.connectGmailAccountLabel}),caption:(0,et.jsx)(di().W0,{caption:(0,et.jsx)(F()._H,{...hi.connectGmailAccountCaption}),shouldWrapCaption:!0})})},S=[{key:"connectGmailAccount",items:[l.isMobile?v:x],render:e=>(0,et.jsx)(Ot().Z,{topBorder:!0,...e,enableActionSheetTitle:!0})}];return(0,et.jsx)(pt().ZP,{buttonPopupStore:p,popupType:g,alignmentToOrigin:pt().vR.End,placementToOrigin:pt().pO.Bottom,originGap:0,disabled:n,renderOrigin:e=>(0,et.jsx)(Ft().S,{...e,disabled:n,isCompact:!0,isError:d,hasActionRequired:!Boolean(t),dropdownButtonType:"dropdown",children:t?(0,et.jsx)(qe().Z,{renderTooltip:()=>i,disableTooltip:!d,render:e=>(0,et.jsx)("span",{...e,children:null==t?void 0:t.account_name})}):(0,et.jsx)(qe().Z,{renderTooltip:()=>(0,et.jsx)(F()._H,{...hi.gmailAccountMenuPickerHeaderInvalidAccountTooltip}),disableTooltip:!d,render:e=>(0,et.jsx)("span",{...e,children:(0,et.jsx)(F()._H,{...d?hi.gmailAccountMenuPickerHeaderInvalidAccount:hi.gmailAccountMenuPickerHeader})})})}),render:e=>(0,et.jsx)(Ht().Z,{...h,children:(0,et.jsx)(Dt().Z,{type:Dt().i.Vertical,sections:0===o.length?S:f,initialFocus:0})})})}async function fi(e,t,o,n){const i=await ci().hM({environment:e,integration:t,spaceId:o,from:n,preventRedirectToLastVisitedPage:(0,pi().Xj)()});return l().x.isFail(i)?{status:"failure"}:i.value.externalAuthentication?{externalAuthentication:i.value.externalAuthentication,status:"success"}:(await ui().pJ({environment:e}),{status:"re-auth"})}const vi=(0,F().vU)({toLabel:{defaultMessage:"To",id:"automations.SendGmailNotificationAction.toLabel"},ccLabel:{defaultMessage:"CC",id:"automations.SendGmailNotificationAction.ccLabel"},bccLabel:{defaultMessage:"BCC",id:"automations.SendGmailNotificationAction.bccLabel"},replyToLabel:{defaultMessage:"Send replies to",id:"automations.SendGmailNotificationAction.replyToLabel"},fromNameLabel:{defaultMessage:"Send with display name",id:"automations.SendGmailNotificationAction.fromNameLabel"},subjectLabel:{defaultMessage:"Subject",id:"automations.SendGmailNotificationAction.subjectLabel"},bodyLabel:{defaultMessage:"Message",id:"automations.SendGmailNotificationAction.bodyLabel"},gmailAccountPickerHidden:{defaultMessage:"Hidden",id:"automations.SendGmailNotificationAction.gmailAccountPickerHidden"}}),xi=["subject","body","fromName"],Si={cc:!1,bcc:!1,replyTo:!1,displayName:!1},bi={displayName:!1,replyTo:!1},Ci={cc:vi.ccLabel.defaultMessage,bcc:vi.bccLabel.defaultMessage,replyTo:vi.replyToLabel.defaultMessage,displayName:vi.fromNameLabel.defaultMessage};function ki(e){var t,o,n,i,l,c,u,d,p,m,y,f,v,x,S;const{actionStore:C,currentGmailAuthentication:k,gmailAuthentications:j}=e,{automationStore:M,contextType:T}=(0,Ee().YC)(),{disabled:A,maybePersistedTransactionActions:_,suppressActionErrors:P}=(0,at().i)(),V=(0,bn().w)(M,T),B=(0,Ae().VK)((()=>Boolean(A)),[A]),R=(0,a().getActionRegistryItem)("send_gmail_notification"),K=(0,Ae().VK)((()=>C.getSpaceId()),[C]),Z=(0,Ae().VK)((()=>{var e,t,o,n;return{to:null==C||null===(e=C.getConfig())||void 0===e?void 0:e.to,cc:null==C||null===(t=C.getConfig())||void 0===t?void 0:t.cc,bcc:null==C||null===(o=C.getConfig())||void 0===o?void 0:o.bcc,reply_to:null==C||null===(n=C.getConfig())||void 0===n?void 0:n.reply_to}}),[C]),[L,E]=(0,Te.useState)(Si),[H,D]=(0,Te.useState)(bi),O=(0,we().O7)();Cn(Object.values(Z).flatMap((e=>{var t;return(null==e||null===(t=e.value)||void 0===t?void 0:t.value)||[]})));const{actionId:N,currentFromName:W,currentSubject:z,currentBody:G,externalBotId:$}=(0,Ae().VK)((()=>{var e,t,o;return{currentFromName:null===(e=C.getConfig())||void 0===e?void 0:e.from_name,currentSubject:null===(t=C.getConfig())||void 0===t?void 0:t.email_subject,currentBody:null===(o=C.getConfig())||void 0===o?void 0:o.email_body,actionId:C.id,externalBotId:C.getConfigStore().getKeyStore("external_bot_id").getValue()}}),[C]);(0,lo().K)((()=>{E((e=>{var t,o,n;return{...e,cc:Boolean(null==Z||null===(t=Z.cc)||void 0===t||null===(t=t.value)||void 0===t?void 0:t.value),bcc:Boolean(null==Z||null===(o=Z.bcc)||void 0===o||null===(o=o.value)||void 0===o?void 0:o.value),replyTo:Boolean(null==Z||null===(n=Z.reply_to)||void 0===n||null===(n=n.value)||void 0===n?void 0:n.value),displayName:Boolean(null==W?void 0:W.value)}}))}));const Y=(0,kt().z)({actionId:N}),{value:q}=(0,gt().XJ)(w().F.formulas),J=function(e,t){return(0,Ae().VK)((()=>t&&e?r().oA(Object.entries(e.getSchema()).map((e=>{let[t,o]=e;const n=new Set(["person","email"]),i=null==o?void 0:o.type;if(!i)return;return n.has(i)||"rollup"===i&&o.target_property_type&&n.has(o.target_property_type)?(0,h().kbv)({contextValueId:(0,hn().Vl)(),name:o.name,property:t,valueSnapshot:"current"}):void 0}))):[]),[e,t])}(V,(0,Te.useMemo)((()=>{if(q)return Y.filter((e=>(null==e?void 0:e.kind)===g().FormulaContextValueKind.ContextValue)).find((e=>(null==e?void 0:e.id)===(0,hn().Vl)()))}),[Y,q])),Q=(0,Ae().qz)(void 0,yt().Z),ee=(0,Te.useCallback)((()=>Q.reset()),[Q]),te=(0,Te.useMemo)((()=>(0,et.jsx)(jt().e,{actionStore:C,closeMenu:ee})),[C,ee]),oe=(0,Te.useMemo)((()=>!P.includes(C.id)),[P,C]),ne=function(e){const{actionId:t,shouldShowError:o}=e,n={};return n.external_bot_id=(0,At().TU)({actionId:t,shouldShow:o,errorKey:"external_bot_id"}),n.to=(0,At().TU)({actionId:t,shouldShow:o,errorKey:"to"}),n.cc=(0,At().TU)({actionId:t,shouldShow:o,errorKey:"cc"}),n.bcc=(0,At().TU)({actionId:t,shouldShow:o,errorKey:"bcc"}),n.reply_to=(0,At().TU)({actionId:t,shouldShow:o,errorKey:"reply_to"}),n.email_body=(0,At().TU)({actionId:t,shouldShow:o,errorKey:"email_body"}),n.email_subject=(0,At().TU)({actionId:t,shouldShow:o,errorKey:"email_subject"}),n}({actionId:C.id,shouldShowError:oe}),ie=(0,At().SP)({actionId:C.id,shouldShow:oe}),ae=Boolean(ie),re=(0,wt().E)("automation_updated_error_states"),se=(0,Te.useMemo)((()=>{if(re)return Object.values(ne).filter((e=>(0,s().$K)(e.errorMessage)))[0]}),[ne,re]),ce=(0,Te.useCallback)((e=>{const t=Sn().default.externalAuthentications.state.find((t=>t.integration_id===yn().aG&&t.id===e)),o=$!==(null==t?void 0:t.id);t&&o&&_.createAndCommit({perform:e=>{X().sW({data:{external_bot_id:t.id},store:C.getConfigStore(),transaction:e})},userAction:"SendGmailNotificationAction.setExternalBotId"})}),[C,$,_]);(0,Ae().VK)((()=>{$||1===j.length&&ce(j[0].id)}),[j,ce,$]);const ue=(0,Te.useCallback)((e=>t=>{if(!t)return;if("formula"===t.type)return void _.createAndCommit({perform:o=>{X().sW({data:{[e]:{type:"formula",value:t}},store:C.getConfigStore(),transaction:o})},userAction:"SendGmailNotificationAction.setRecipient.formula"});const o=(0,h().lzi)(t.value).filter((e=>{const t=(0,h().lcG)([e]);if(0===t.length)return!0;return!new(U().U6)(O,{table:b().KJ,id:t[0]},{userId:t[0]}).getIsDeleted()}));_.createAndCommit({perform:t=>{X().sW({data:{[e]:{type:"formula",value:{type:"simple",value:o}}},store:C.getConfigStore(),transaction:t})},userAction:"SendGmailNotificationAction.setRecipient.simple"}),(0,It().yE)(O,{automationStore:M,automationActionStore:C})}),[C,_,O,M]),de=(0,Te.useCallback)((e=>{_.createAndCommit({perform:t=>{X().sW({data:{from_name:e},store:C.getConfigStore(),transaction:t})},userAction:"SendGmailNotificationAction.setFromName"}),(0,It().yE)(O,{automationStore:M,automationActionStore:C})}),[C,_,O,M]),pe=(0,Te.useCallback)((e=>{_.createAndCommit({perform:t=>{X().sW({data:{email_subject:e},store:C.getConfigStore(),transaction:t})},userAction:"SendGmailNotificationAction.setSubject"}),(0,It().yE)(O,{automationStore:M,automationActionStore:C})}),[C,_,O,M]),me=(0,Te.useCallback)((e=>{_.createAndCommit({perform:t=>{X().sW({data:{email_body:e},store:C.getConfigStore(),transaction:t})},userAction:"SendGmailNotificationAction.setBody"}),(0,It().yE)(O,{automationStore:M,automationActionStore:C})}),[C,_,O,M]),{onTextStoreSelect:ge,onTextStoreUnselect:he}=(0,Ct().w)(C),ye=(0,Ae().VK)((()=>{if(!q||!K)return{};const{createFormulaDataRequestSyncHandler:e}=q,t={subject:z,body:G,fromName:W};return Object.fromEntries(xi.map((o=>{const n=t[o];return n?[o,(0,to().analyzeSimpleFormulaOrFormulaSync)({context:{handleDataRequest:e(C.getRecordModel),spaceId:K,valueTypes:Y.slice(0),featureGates:(0,I().W)()},value:n})]:[o,""]})))}),[C.getRecordModel,z,G,W,Y,q,K]),fe=(0,Te.useCallback)(((e,t)=>{e.stopPropagation(),e.preventDefault(),E((e=>({...e,[t]:!0}))),"displayName"===t&&D((e=>({...e,displayName:!1})))}),[]),ve=(0,Te.useCallback)((e=>{D((t=>({...t,[e]:!t[e]})))}),[]),xe=(0,Te.useCallback)((e=>{var t,o,n;return!("displayName"!==e||null==W||!W.value)||(!("cc"!==e||null==Z||null===(t=Z.cc)||void 0===t||null===(t=t.value)||void 0===t||!t.value)||(!("bcc"!==e||null==Z||null===(o=Z.bcc)||void 0===o||null===(o=o.value)||void 0===o||!o.value)||!("replyTo"!==e||null==Z||null===(n=Z.reply_to)||void 0===n||null===(n=n.value)||void 0===n||!n.value)))}),[W,Z]),Se=(0,Te.useCallback)((async(e,t)=>{e.stopPropagation(),e.preventDefault();if(xe(t)){if(!(await(0,vn().n8)({fieldName:`"${Ci[t]}"`})))return}"displayName"===t&&de(void 0),"cc"!==t&&"bcc"!==t||ue(t)({type:"simple",value:void 0}),"replyTo"===t&&ue("reply_to")({type:"simple",value:void 0}),E((e=>({...e,[t]:!1})))}),[de,xe,ue]),be=(0,Te.useCallback)((()=>{le().clear({environment:O})}),[O]),{isMobile:Ce}=(0,we().Fy)(),ke=(0,Ie().yK)((e=>{var t;const o={color:e.text.secondary,fontSize:Ce?_e().JB.UIRegular.mobile:_e().JB.UIRegular.desktop,lineHeight:Ce?_e().Nv.UIRegular.mobile:_e().Nv.UIRegular.desktop,fontWeight:_e().Ue.regular};return{inputLabel:{...o},toInputLabel:{...o,...re&&(0,s().$K)(null===(t=ne.to)||void 0===t?void 0:t.errorMessage)&&{color:e.text.uiRedPrimary,fontWeight:_e().Ue.medium}},toErrorLabel:{color:e.text.uiRedPrimary},toggleableInputLabel:{...o,cursor:"pointer",padding:2,transform:"translateX(-2px)",display:"flex",width:"fit-content"},toggleableInputLabelHovered:{...o,cursor:"pointer",backgroundColor:e.buttonHoveredBackground,transform:"translateX(-2px)",display:"flex",width:"fit-content",borderRadius:"4px",padding:2},messageInput:{width:"100%"},replyToInputContainer:{display:"flex",justifyContent:"space-between"},replyToInputField:{width:"100%",fontSize:Ce?_e().JB.UIRegular.mobile:_e().JB.UIRegular.desktop},ccBccToggle:{padding:"6px 12px",color:e.lightTextColor,borderRadius:"6px",marginLeft:8,alignSelf:"flex-start"},container:{overflow:"visible"},toggleFieldGridContainer:{display:"grid",gridTemplateRows:"auto auto",gridTemplateColumns:"1fr auto",alignItems:"center",columnGap:8,rowGap:6},toggleFieldGridLabel:{gridRow:"1",gridColumn:"1"},toggleFieldGridInput:{gridRow:"2",gridColumn:"1"},toggleFieldGridTrashIconButton:{gridRow:"2",gridColumn:"2",alignSelf:"flex-start",height:32,width:32},toggleFieldTrashIconButtonForTextInput:{gridRow:"1",gridColumn:"2",alignSelf:"flex-start",marginTop:26,height:32,width:32},trashIcon:{width:16,height:16}}}),[ne,re,Ce]);function je(e,t){return e||t?!e&&t?ke.toggleableInputLabelHovered:ke.inputLabel:ke.toggleableInputLabel}if(!K)return null;const Me={collectionStore:V,limit:Ti,disabled:B,formulaTypecheckContextValues:Y,spaceId:K,pageProperties:J};return(0,et.jsxs)(Mt().Ao,{actionMenu:te,buttonPopupStore:Q,disabled:B,actionId:C.id,canCollapse:!ae,hideDragHandle:ae,children:[(0,et.jsx)(Mt().vu,{actionId:C.id,actionRegistryItem:R,disabled:B,errorMessage:ie||(null==se?void 0:se.errorMessage),styles:{headerWrap:{paddingRight:32},titleWrap:{display:"flex",flexWrap:"wrap",gap:4}},children:(0,et.jsx)(ji,{currentGmailAuthentication:k,gmailAuthentications:j,disabled:B,isError:ae,onGmailAccountChange:ce,accountPickerErrorMessage:null===(t=ne.external_bot_id)||void 0===t?void 0:t.errorMessage})}),k&&(0,et.jsx)(Mt().R7,{children:(0,et.jsxs)($t().jX,{direction:"column",gap:16,children:[(0,et.jsxs)($t().jX,{direction:"column",gap:6,children:[(0,et.jsx)("label",{style:ke.toInputLabel,children:(0,et.jsx)(F()._H,{...vi.toLabel})}),(0,et.jsxs)("div",{className:"to-input-and-ccBcc-container",style:ke.replyToInputContainer,children:[(0,et.jsx)(Mi,{...Me,recipients:null==Z||null===(o=Z.to)||void 0===o?void 0:o.value,onChange:ue("to"),errorMessage:null===(n=ne.to)||void 0===n?void 0:n.errorMessage,style:ke.replyToInputField}),(!L.cc||!L.bcc)&&(0,et.jsx)(fn().Z,{onClick:e=>{L.cc||fe(e,"cc"),L.bcc||fe(e,"bcc")},style:ke.ccBccToggle,children:L.cc||L.bcc?(0,et.jsx)(F()._H,{id:"automations.SendGmailNotificationAction.ccOrBccToggleLabel",defaultMessage:"{showCCLabel, select, true {CC} other {BCC}}",values:{showCCLabel:!L.cc&&L.bcc}}):(0,et.jsx)(F()._H,{id:"automations.SendGmailNotificationAction.ccAndBccToggleLabel",defaultMessage:"CC/BCC"})})]}),re&&(0,s().$K)(null===(i=ne.to)||void 0===i?void 0:i.errorMessage)&&(0,et.jsx)(Lo().q,{colorName:"secondary",styleName:"UISmall-12px/Regular",style:ke.toErrorLabel,children:(0,et.jsx)(F()._H,{...null===(l=ne.to)||void 0===l?void 0:l.errorMessageDescriptor})})]}),L.cc&&(0,et.jsx)($t().jX,{direction:"column",gap:16,children:(0,et.jsxs)("div",{style:ke.toggleFieldGridContainer,children:[(0,et.jsxs)("label",{style:ke.inputLabel,children:[(0,et.jsx)(F()._H,{...vi.ccLabel}),(0,et.jsx)(Ho,{})]}),(0,et.jsx)(Mi,{...Me,recipients:null==Z||null===(c=Z.cc)||void 0===c?void 0:c.value,onChange:ue("cc"),errorMessage:null===(u=ne.cc)||void 0===u?void 0:u.errorMessage,style:ke.toggleFieldGridInput}),(0,et.jsx)($e().Z,{icon:ho().y,ariaLabel:"Remove Field",onClick:e=>Se(e,"cc"),style:ke.toggleFieldGridTrashIconButton,iconStyle:ke.trashIcon})]})}),L.bcc&&(0,et.jsx)($t().jX,{direction:"column",gap:16,children:(0,et.jsxs)("div",{style:ke.toggleFieldGridContainer,children:[(0,et.jsxs)("label",{style:{...ke.inputLabel},children:[(0,et.jsx)(F()._H,{...vi.bccLabel}),(0,et.jsx)(Ho,{})]}),(0,et.jsx)(Mi,{...Me,recipients:null==Z||null===(d=Z.bcc)||void 0===d?void 0:d.value,onChange:ue("bcc"),errorMessage:null===(p=ne.bcc)||void 0===p?void 0:p.errorMessage,style:ke.toggleFieldGridInput}),(0,et.jsx)($e().Z,{icon:ho().y,ariaLabel:"Remove Field",onClick:e=>Se(e,"bcc"),style:ke.toggleFieldGridTrashIconButton,iconStyle:ke.trashIcon})]})}),(0,et.jsx)(Eo,{disabled:B,disableMobileActionBar:!1,disableNewLines:!0,disableStyleAnnotations:!0,disableTemplateVariableMentions:!1,formulaTypecheckContextValues:Y,onChange:pe,onTextStoreSelect:ge,onTextStoreUnselect:he,onTextEsc:be,parentRecordStore:C,spaceId:K,style:ke.messageInput,value:z,analyzedFormulaOutput:ye.subject,labelMessageDescriptor:vi.subjectLabel,errorMessageDescriptor:null===(m=ne.email_subject)||void 0===m?void 0:m.errorMessageDescriptor,shouldShowErrorStyles:re&&(0,s().$K)(null===(y=ne.email_subject)||void 0===y?void 0:y.errorMessage)}),(0,et.jsx)(Eo,{disabled:B,disableMobileActionBar:!1,disableTemplateVariableMentions:!1,formulaTypecheckContextValues:Y,onChange:me,onTextStoreSelect:ge,onTextStoreUnselect:he,onTextEsc:be,parentRecordStore:C,rows:4,spaceId:K,style:ke.messageInput,value:G,analyzedFormulaOutput:ye.body,labelMessageDescriptor:vi.bodyLabel,errorMessageDescriptor:null===(f=ne.email_body)||void 0===f?void 0:f.errorMessageDescriptor,shouldShowErrorStyles:re&&(0,s().$K)(null===(v=ne.email_body)||void 0===v?void 0:v.errorMessage)}),!L.displayName&&(0,et.jsx)("label",{children:(0,et.jsxs)("span",{onClick:e=>fe(e,"displayName"),onMouseEnter:()=>ve("displayName"),onMouseLeave:()=>ve("displayName"),style:je(L.displayName,H.displayName),children:[(0,et.jsx)(F()._H,{...vi.fromNameLabel}),"..."]})}),L.displayName&&(0,et.jsxs)("div",{style:{...ke.toggleFieldGridContainer,rowGap:0},children:[(0,et.jsx)("div",{style:ke.toggleFieldGridLabel,children:(0,et.jsx)(Eo,{disabled:B,disableMobileActionBar:!1,disableTemplateVariableMentions:!1,formulaTypecheckContextValues:Y,disableNewLines:!0,disableStyleAnnotations:!0,onChange:de,onTextStoreSelect:ge,onTextStoreUnselect:he,onTextEsc:be,parentRecordStore:C,rows:1,spaceId:K,value:W,analyzedFormulaOutput:ye.fromName,labelMessageDescriptor:vi.fromNameLabel,isOptional:!0})}),(0,et.jsx)($e().Z,{icon:ho().y,ariaLabel:"Remove Field",onClick:e=>Se(e,"displayName"),style:ke.toggleFieldTrashIconButtonForTextInput,iconStyle:ke.trashIcon})]}),(0,et.jsxs)("div",{style:ke.toggleFieldGridContainer,children:[(0,et.jsx)("label",{style:ke.toggleFieldGridLabel,children:(0,et.jsxs)("span",{onClick:e=>fe(e,"replyTo"),onMouseEnter:()=>ve("replyTo"),onMouseLeave:()=>ve("replyTo"),style:je(L.replyTo,H.replyTo),children:[(0,et.jsx)(F()._H,{...vi.replyToLabel}),!L.replyTo&&"...",L.replyTo&&(0,et.jsx)(Ho,{})]})}),L.replyTo&&(0,et.jsxs)(et.Fragment,{children:[(0,et.jsx)(Mi,{...Me,recipients:null==Z||null===(x=Z.reply_to)||void 0===x?void 0:x.value,onChange:ue("reply_to"),errorMessage:null===(S=ne.reply_to)||void 0===S?void 0:S.errorMessage,limit:1,style:ke.toggleFieldGridInput}),(0,et.jsx)($e().Z,{icon:ho().y,ariaLabel:"Remove Field",onClick:e=>Se(e,"replyTo"),style:ke.toggleFieldGridTrashIconButton,iconStyle:ke.trashIcon})]})]})]})})]})}function ji(e){const{currentGmailAuthentication:t,gmailAuthentications:o,disabled:n,isError:i,onGmailAccountChange:a,accountPickerErrorMessage:r}=e,l=(0,Ie().yK)((()=>({b:{fontWeight:_e().Ue.medium},picker:{display:"inline-flex",minWidth:50,marginLeft:4},span:{flex:0,display:"flex",alignItems:"center"},title:{display:"inline-flex",minWidth:50,flexWrap:"wrap",gap:6}})),[]),s=function(){const{isMobile:e}=(0,we().Fy)(),t=e?_e().JB.UISmall.mobile:_e().JB.UISmall.desktop;return(0,Ie().yK)((()=>({container:{alignItems:"baseline",display:"inline-flex",gap:2,minWidth:50,width:"100%"},lockIcon:{alignSelf:"center",height:"auto",width:t}})),[t])}();return i?(0,et.jsx)("div",{style:l.title,children:(0,et.jsx)(F()._H,{defaultMessage:"Send mail",id:"automations.SendGmailNotificationAction.header.titleError"})}):(0,et.jsx)("div",{style:l.title,children:(0,et.jsx)(F()._H,{defaultMessage:"Send mail from{gmailAccountPicker}",id:"automations.SendGmailNotificationAction.header.title",values:{gmailAccountPicker:n?(0,et.jsxs)("div",{style:s.container,children:[(0,xn().b)(s.lockIcon),(0,et.jsx)("span",{style:_e().Yu,children:(0,et.jsx)(F()._H,{...vi.gmailAccountPickerHidden})})]}):(0,et.jsx)(yi,{currentGmailAuthentication:t,gmailAuthentications:o,disabled:n,onAccountChange:a,errorMessage:r})}})})}function Mi(e){const{recipients:t,style:o,collectionStore:n,...i}=e,{automationStore:a}=(0,Ee().YC)();return(0,et.jsx)("div",{style:o,children:(0,et.jsx)(ii,{currentValue:t,collectionStore:n,parentRecordStore:a,...i})})}const Ti=20;var wi=()=>o(307473);const Ai=(0,F().vU)({defaultMenuHeader:{defaultMessage:"Select people",id:"automationPersonPicker.defaultMenuHeaderMessage"},personValuePickerPlaceholder:{defaultMessage:"Select up to {maxSelected} people...",id:"automations.personPicker.buttonPlaceholder"}});function Ii(e){const{currentValue:t,collectionStore:o,disabled:n,onChange:i,formulaTypecheckContextValues:a,menuHeader:r,limit:l,errorMessage:s,parentRecordStore:c,spaceId:u,style:d}=e,p={type:"person_array"},m=(0,F().YB)(),g=o?{type:"collection",collectionStore:o,property:"person"}:{type:"empty"},h={menuType:Qo().o.Popup,header:(0,et.jsx)(Ot().Z,{style:{paddingBottom:0},title:r?m.formatMessage(r):m.formatMessage(Ai.defaultMenuHeader)})};return(0,et.jsx)(wi().e,{allowedReturnTypes:Oo().Y_.person,formulaTypecheckContextValues:a,disabled:n,simpleFormulaContext:g,onChange:i,type:p,value:t,menuProps:h,placeholder:l?m.formatMessage(Ai.personValuePickerPlaceholder,{maxSelected:l}):void 0,limit:l,errorMessage:s,parentRecordStore:c,spaceId:u,style:d})}var _i=()=>o(61313);const Pi=(0,F().vU)({property:{id:"automationAction.sendInAppNotification.targetType.property",defaultMessage:"Person property"},formula:{id:"automationAction.sendInAppNotification.targetType.formula",defaultMessage:"Specific people"},default:{id:"automations.targetPicker.targetTypePlaceholder",defaultMessage:"Select recipients"}});function Vi(e){const{disabled:t,errorMessage:o,selectedTargetType:n,onSelectedTargetTypeChange:i}=e,a=(0,Ae().qz)(void 0,yt().Z),r=(0,Ne().d)(),l=(0,wt().E)("automation_updated_error_states"),s=(0,Te.useCallback)((e=>{e!==n&&(i(e),a.reset())}),[i,a,n]);return(0,et.jsx)(pt().ZP,{buttonPopupStore:a,popupType:r,alignmentToOrigin:pt().vR.End,placementToOrigin:pt().pO.Bottom,originGap:0,disabled:t,renderOrigin:e=>(0,et.jsx)(Ft().S,{...e,disabled:t,isCompact:!0,isError:Boolean(o),hasActionRequired:!Boolean(n),tooltipMessage:!l&&o,dropdownButtonType:"dropdown",children:n?(0,et.jsx)(F()._H,{...Pi[n]}):(0,et.jsx)(F()._H,{...Pi.default})}),render:e=>(0,et.jsx)(Bi,{handleChange:s,selectedTargetType:n})})}function Bi(e){const{handleChange:t}=e,o=(0,Nt().F)(),n=[(0,Te.useMemo)((()=>({action:()=>null,key:"selectUsers",render:e=>(0,et.jsx)(dt().Z,{...e,onClick:()=>t("formula"),title:(0,et.jsx)(F()._H,{...Pi.formula})})})),[t]),(0,Te.useMemo)((()=>({action:()=>null,key:"selectPersonProperty",render:e=>(0,et.jsx)(dt().Z,{...e,onClick:()=>t("property"),title:(0,et.jsx)(F()._H,{...Pi.property})})})),[t])].filter(s().$K);if(0===n.length)return null;const i={items:n,key:"targetType",render:e=>(0,et.jsx)(Ot().Z,{topBorder:!0,...e,enableActionSheetTitle:!0})};return(0,et.jsx)(Ht().Z,{...o,children:(0,et.jsx)(Dt().Z,{type:Dt().i.Vertical,sections:[i],initialFocus:0})})}const Ri=(0,F().vU)({notificationMessageLabel:{defaultMessage:"Message",id:"automations.BaseModalAction.notificationMessageLabel"},personPropertyTargetTypeLabel:{defaultMessage:"Property",id:"automations.SendInAppNotificationAction.personPropertyTargetTypeLabel"},usersTargetTypeLabel:{defaultMessage:"People",id:"automations.SendInAppNotificationAction.usersTargetTypeLabel"},propertyPickerPlaceholder:{defaultMessage:"Select a property",id:"automations.SendInAppNotificationAction.propertyPickerPlaceholder"},personValuePickerMenuHeader:{defaultMessage:"Send notification to",id:"automations.personPicker.menuHeader"}});function Ki(e){const{noCollection:t,targetsErrorMessage:o,selectedTargetType:n,disabled:i,onTargetTypeChange:a}=e;return t?(0,et.jsx)(F()._H,{defaultMessage:"Send notification to specific people",id:"automations.SendInAppNotificationAction.header.titleButtonBlock",values:{placeholder:"specific people"}}):(0,et.jsx)(F()._H,{defaultMessage:"Send notification to{targetTypePicker}",id:"automations.SendInAppNotificationAction.header.title",values:{targetTypePicker:(0,et.jsx)(Vi,{onSelectedTargetTypeChange:a,disabled:i,errorMessage:o,selectedTargetType:n})}})}function Fi(e){const{isError:t,isMobile:o,selectedTargetType:n}=e,i=(0,Ie().yK)((e=>({inputLabel:{color:t?e.text.uiRedPrimary:e.text.secondary,fontSize:o?_e().JB.UIRegular.mobile:_e().JB.UIRegular.desktop,lineHeight:o?_e().Nv.UIRegular.mobile:_e().Nv.UIRegular.desktop,fontWeight:_e().Ue.regular}})),[t,o]),a=(0,Ae().VK)((()=>{switch(n){case"property":return Ri.personPropertyTargetTypeLabel;case"formula":return Ri.usersTargetTypeLabel;default:(0,s().t1)(n)}}),[n]);return(0,et.jsx)("label",{style:i.inputLabel,children:(0,et.jsx)(F()._H,{...a})})}const Zi=20;function Li(e){const{collectionStore:t,currentProperties:o,currentTargetValue:n,disabled:i,errorMessage:a,formulaTypecheckContextValues:r,onTargetValueChange:l,parentRecordStore:c,spaceId:u}=e,d=n.type;switch(d){case"formula":return(0,et.jsx)(Ii,{collectionStore:t,currentValue:n.value,disabled:Boolean(i),onChange:e=>l({type:"formula",value:e}),parentRecordStore:c,formulaTypecheckContextValues:r,menuHeader:Ri.personValuePickerMenuHeader,limit:Zi,errorMessage:a,spaceId:u,style:{width:"100%"}});case"property":return t?(0,et.jsx)(_i().X,{availablePropertyIds:o,currentValue:n.propertyId,collectionStore:t,onChange:e=>l({type:"property",propertyId:e}),disabled:Boolean(i),alreadyHaveProperties:Boolean(n.propertyId),placeholderMessage:Ri.propertyPickerPlaceholder,errorMessage:a}):null;default:(0,s().t1)(d)}}function Ei(e,t){if("formula"===t.type||!(0,s().$K)(t.value))return{type:"simple",value:void 0};const o=t.value.filter((t=>{if(!(0,h().km_)(t))return!1;const o=(0,h().hDy)(t),n=(0,h().hH9)(o);if(n){const t=(0,h().zEN)(n);return!new(U().U6)(e,{id:t,table:b().KJ},{userId:t}).getIsDeleted()}return(0,h().sP4)(o)}));return{type:"simple",value:(0,to().toSimpleFormulaArrayValue)((0,to().filterTextValueToSimpleFormulaValueTokens)(o))}}var Hi=()=>o(869963),Di=()=>o(251932),Oi=()=>o(747381);const Ni=(0,F().vU)({addCustomHeader:{defaultMessage:"Add custom header",id:"automations.BaseModalAction.addCustomHeader"},customHeaderKeyLabel:{defaultMessage:"Key",id:"automations.BaseModalAction.customHeaderKeyLabel"},customHeaderValueLabel:{defaultMessage:"Value",id:"automations.BaseModalAction.customHeaderValueLabel"},removeCustomHeaderAriaLabel:{defaultMessage:"Remove custom header",id:"automations.BaseModalAction.removeCustomHeaderAriaLabel"}});function Ui(e){const{actionStore:t}=e,o=(0,F().YB)(),n=ra(),{suppressActionErrors:i}=(0,at().i)(),{typecheckResult:a}=(0,Ee().YC)(),[r,s]=(0,Te.useState)(new Set),[c,u]=(0,Te.useState)((()=>new(Oi().Z))),d=(0,Ae().VK)((()=>{if(!l().x.isSuccess(a))return new(Oi().Z);const e=i.includes(t.id),o=a.value.actionValidationFailures[t.id]||[],n=new(Oi().Z);return o.forEach((t=>{if("empty_custom_header_field"===t.type){const[o,i,a]=t.key;n.set({id:i,field:a},!e&&!r.has(i)||(c.get({id:i,field:a})||!1))}})),n}),[a,i,t.id,c,r]),{maybePersistedTransactionActions:p}=(0,at().i)(),m=(0,Ie().yK)((()=>({customHeadersContainer:{display:"flex",flexDirection:"column",gap:12,marginTop:12},customHeaderInputsContainer:{display:"grid",gridTemplateRows:"auto auto",gridTemplateColumns:"1fr 1fr auto",alignItems:"center",columnGap:8,rowGap:4},customHeaderKeyLabel:{...n.inputLabel,gridRow:1,gridColumn:1},customHeaderValueLabel:{...n.inputLabel,gridRow:1,gridColumn:2},customHeaderKeyInput:{...n.input,gridRow:2,gridColumn:1},customHeaderValueInput:{...n.input,gridRow:2,gridColumn:2},customHeaderRemoveButton:{gridRow:2,gridColumn:3,width:32,height:32},customHeaderRemoveButtonIcon:{width:18,height:18},addCustomHeaderButton:{marginLeft:-8,marginTop:8}})),[n]),g=(0,Ae().VK)((()=>t.getConfigStore().getKeyStore("customHeaders")),[t]),h=(0,Ae().VK)((()=>(g.getValue()||[]).map((e=>({...e,id:e.id||(0,qt().ZP)()})))),[g]),y=(0,Te.useCallback)(((e,t)=>()=>{const o=new(Oi().Z)({from:c.entries()});o.set({id:e,field:t},!0),u(o)}),[c]),f=(0,Te.useCallback)(((e,t)=>o=>{const n=(g.getValue()||[]).map((n=>n.id===e?{...n,[t]:o}:n));p.createAndCommit({userAction:"AutomationPlainTextInput.setValue",perform:e=>{X().sO({store:g,transaction:e,value:n})}})}),[g,p]),v=(0,Te.useCallback)((()=>{p.createAndCommit({userAction:"AutomationPlainTextInput.setValue",perform:e=>{const t={id:(0,qt().ZP)(),key:"",value:""};X().sO({store:g,transaction:e,value:[...h,t]}),s((e=>{const o=new Set(e);return o.add(t.id),o}))}})}),[h,g,p]),x=(0,Te.useCallback)((e=>()=>{const t=h.filter((t=>t.id!==e));p.createAndCommit({userAction:"AutomationPlainTextInput.setValue",perform:e=>{X().sO({store:g,transaction:e,value:t})}})}),[h,g,p]),S=h.length>0&&(0,et.jsx)("div",{style:m.customHeadersContainer,children:h.map((e=>(0,et.jsxs)("div",{style:m.customHeaderInputsContainer,children:[(0,et.jsx)("label",{style:m.customHeaderKeyLabel,children:(0,et.jsx)(F()._H,{...Ni.customHeaderKeyLabel})}),(0,et.jsx)("label",{style:m.customHeaderValueLabel,children:(0,et.jsx)(F()._H,{...Ni.customHeaderValueLabel})}),(0,et.jsx)("div",{}),(0,et.jsx)(rt,{style:m.customHeaderKeyInput,value:e.key,onChange:f(e.id,"key"),errorOutline:d.get({id:e.id,field:"key"}),onBlur:y(e.id,"key"),autoFocus:!e.key,maxlength:Hi().aB}),(0,et.jsx)(rt,{style:m.customHeaderValueInput,value:e.value,onChange:f(e.id,"value"),errorOutline:d.get({id:e.id,field:"value"}),onBlur:y(e.id,"value"),maxlength:Hi().aB}),(0,et.jsx)($e().Z,{icon:ho().y,ariaLabel:o.formatMessage(Ni.removeCustomHeaderAriaLabel),style:m.customHeaderRemoveButton,iconStyle:m.customHeaderRemoveButtonIcon,onClick:x(e.id)})]},e.id)))});return(0,et.jsxs)(et.Fragment,{children:[S,h.length<Hi().Qb&&(0,et.jsx)(Di().gq,{children:(0,et.jsx)(Qt().Z,{isGray:!0,onClick:v,style:m.addCustomHeaderButton,children:(0,et.jsx)(F()._H,{...Ni.addCustomHeader})})})]})}var Wi=()=>o(407391),zi=()=>o(108714),Gi=()=>o(148126),$i=()=>o(653457);function Yi(e){const t=(0,we().O7)(),o=(0,F().YB)();return(0,et.jsx)(qe().Z,{renderTooltip:()=>(0,et.jsx)(F()._H,{defaultMessage:"Learn more",id:"webhookAction.helpButton.tooltip"}),render:e=>(0,et.jsx)(zi().Z,{...e,href:(0,Gi().UY)("guides.webhookAction"),onClick:()=>Wi().Fs(t,{from:"webhookAction"}),external:!0,children:(0,et.jsx)($e().Z,{...e,ariaLabel:o.formatMessage({id:"webhookAction.helpButton.ariaLabel",defaultMessage:"Learn about webhook actions"}),icon:$i().m})})})}Yi.displayName="SendWebhookActionHelpLink";var qi=()=>o(532850),Xi=()=>o(766933);const Ji=new Set(["title","text","relation","checkbox","number","person","file","url","email","phone_number","created_time","created_by","last_edited_time","last_edited_by","last_visited_time","formula","rollup","select","multi_select","date","status","auto_increment_id","location","verification"]);const Qi=(0,F().vU)({selectAllPropertiesDescription:{defaultMessage:"New properties will not be included automatically",id:"automations.BaseModalAction.selectAllPropertiesDescription"},selectAllProperties:{defaultMessage:"Select all existing properties",id:"automations.BaseModalAction.selectAllProperties"},propertyPickerLabel:{defaultMessage:"Content",id:"automations.BaseModalAction.propertyPickerLabel"},propertyDisabledMissingPermissionTooltip:{defaultMessage:"This property references a database you don't have access to",id:"automations.SendWebhookActionPropertyPicker.propertyDisabledMissingPermissionTooltip"},propertyDisabledUnsupportedTypeTooltip:{defaultMessage:"This property type is not supported",id:"automations.SendWebhookActionPropertyPicker.propertyDisabledUnsupportedTypeTooltip"}});function ea(){return(0,Ie().yK)((e=>({buttonMenuItemContent:{height:34},buttonMenuItem:{borderRadius:4}})),[])}function ta(e){let{collectionStore:t,value:o,onChange:n}=e;const i=ea(),a=ra(),l=(0,Ae().VK)((()=>t.getSchema()),[t]),s=(0,Te.useMemo)((()=>new Set("some"===o.type?o.some||[]:Object.keys(l))),[l,o]),c=function(e){const{value:t}=(0,gt().XJ)(w().F.formulas),{value:o}=(0,gt().XJ)(w().F.formulaPermissions),n=(0,wt().E)("collections_xws"),i=(0,Ae().VK)((()=>{if(!t)return;const o=(0,I().W)();return{allowedReturnTypes:[{type:"unknown"}],handleDataRequest:(0,f().yf)(e.getRecordModel,e.loadRecordModel,P().default,o),restrictUnaccessibleProperties:n?"cross_space_and_read_permissions":"read_permissions_only",spaceId:e.getSpaceId(),valueTypes:[],featureGates:o}}),[t,e,n]),[a]=(0,In().r5)((async()=>{if(!t||!i||!o)return;const n=e.getSchema(),a=Object.keys(n),r=await(0,$().qd)(a,3,(async t=>{const a=(0,qi().Qm)({schema:n,property:t});if(a)return Ji.has(a.type)?await o.hasAccessToProperty({collectionPointer:e.pointer,collectionSchema:n,context:i,propertyId:t,hasAccessFn:o.hasAccessDefaultFn})?void 0:"missing_permission":"unsupported_property_type"})),l=new Map;return r.forEach(((e,t)=>{l.set(a[t],e)})),l.size>0?l:void 0}),[e,i,t,o]);return a}(t),u=(0,Te.useMemo)((()=>c.value||new Map),[c]),d=(0,Te.useMemo)((()=>new Set(Array.from(u.entries()).filter((e=>{let[t,o]=e;return void 0===o})).map((e=>{let[t]=e;return t})))),[u]),p=(0,Te.useMemo)((()=>"some"===o.type&&function(e,t){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}(s,d)),[o.type,s,d]),m=(0,Te.useRef)(null),g=(0,Te.useCallback)((e=>{s.has(e)?s.delete(e):s.add(e),n({type:"some",some:Array.from(s)})}),[s,n]),h=(0,Ie().yK)((e=>({sectionMenuItem:{padding:"6px 2px"},propertyPickerContainer:{display:"flex",flexDirection:"column",gap:12,border:`1px solid ${e.regularDividerColor}`,borderRadius:10,maxHeight:212,overflowY:"auto",marginBottom:2},selectAllPropertiesButton:{height:34},selectAllPropertiesButtonTitle:{display:"flex",alignItems:"center",gap:6,marginLeft:9},selectAllPropertiesCheckboxContainer:{height:13},selectAllPropertiesCheckbox:{cursor:"pointer"}})),[]),y=(0,Te.useCallback)((()=>{n(p?{type:"some",some:[]}:{type:"some",some:Array.from(d.values())})}),[p,n,d]);(0,Te.useEffect)((()=>{m.current&&(m.current.indeterminate=s.size>0&&!p)}),[p,s,o.type]);const v=Object.keys(l),x=(0,Te.useMemo)((()=>v.sort(((e,t)=>{const o=(0,qi().Qm)({schema:l,property:e}),n=(0,qi().Qm)({schema:l,property:t});if("title"===(null==o?void 0:o.type))return-1;if("title"===(null==n?void 0:n.type))return 1;const i=(null==o?void 0:o.name)||"",a=(null==n?void 0:n.name)||"";return i.localeCompare(a)}))),[v,l]);if(!u)return null;const S=(0,r().oA)(x.map((e=>{const t=(0,qi().Qm)({schema:l,property:e});if(!t)return null;return{key:e,render:o=>(0,et.jsx)(oa,{...o,propertySchema:t,selected:s.has(e),noAccessReason:u.get(e),buttonStyle:i.buttonMenuItem,style:i.buttonMenuItemContent}),action:()=>{g(e)}}}))),b=(0,r().oA)([{key:0,render:e=>(0,et.jsx)(Ot().Z,{...e,style:h.sectionMenuItem}),items:[{key:0,render:e=>(0,et.jsx)(dt().Z,{...e,style:i.buttonMenuItemContent,buttonStyle:i.buttonMenuItem,title:(0,et.jsxs)("div",{style:h.selectAllPropertiesButtonTitle,children:[(0,et.jsx)(F()._H,{...Qi.selectAllProperties}),(0,et.jsx)(na,{})]}),leftStyle:h.selectAllPropertiesCheckboxContainer,left:(0,et.jsx)("input",{type:"checkbox",readOnly:!0,checked:p,ref:m,style:h.selectAllPropertiesCheckbox})}),action:y}]},{key:1,render:e=>(0,et.jsx)(Ot().Z,{topBorder:!0,style:h.sectionMenuItem,...e}),items:S}]);return(0,et.jsxs)(et.Fragment,{children:[(0,et.jsx)("label",{style:a.inputLabel,children:(0,et.jsx)(F()._H,{...Qi.propertyPickerLabel})}),(0,et.jsx)("div",{style:h.propertyPickerContainer,children:(0,et.jsx)(Dt().Z,{type:Dt().i.Vertical,sections:b,initialFocus:void 0,resetFocusOnMouseOut:!0})})]})}function oa(e){const{propertySchema:t,noAccessReason:o}=e,n=(0,Ie().Fg)(),i=(0,we().O7)(),{name:a,type:r,icon:l}=t,s=ea(),c=(0,Ie().yK)((e=>({buttonMenuItemTitle:{color:o?e.lightTextColor:e.regularTextColor},propertyIcon:{fill:o?e.lightIconColor:e.regularIconColor,marginLeft:6,marginRight:2},checkBoxInput:{cursor:o?void 0:"pointer"}})),[o]),u=(0,et.jsx)(dt().Z,{title:a,disabled:Boolean(o),style:s.buttonMenuItemContent,titleStyle:c.buttonMenuItemTitle,icon:(0,et.jsx)(Xi().ZP,{icon:l,type:r,size:i.device.isMobile?18:16,theme:n,style:c.propertyIcon}),left:(0,et.jsx)(Di().gq,{alignItems:"center",children:(0,et.jsx)("input",{type:"checkbox",readOnly:!0,checked:e.selected,disabled:Boolean(o),style:c.checkBoxInput})}),...e});return o?(0,et.jsx)(ia,{noAccessReason:o,children:u}):u}function na(){const e=(0,Ie().yK)((e=>({helpIcon:{width:14,height:14,fill:e.icon.secondary}})),[]),t=(0,Ae().VK)((()=>(0,$i().m)(e.helpIcon)),[e.helpIcon]);return(0,et.jsx)(qe().Z,{renderTooltip:()=>(0,et.jsx)(F()._H,{...Qi.selectAllPropertiesDescription}),render:e=>(0,et.jsx)("div",{...e,children:t}),placement:ro().Placement.Top})}function ia(e){const{children:t,noAccessReason:o}=e;return(0,et.jsx)(qe().Z,{renderTooltip:()=>"missing_permission"===o?(0,et.jsx)(F()._H,{...Qi.propertyDisabledMissingPermissionTooltip}):"unsupported_property_type"===o?(0,et.jsx)(F()._H,{...Qi.propertyDisabledUnsupportedTypeTooltip}):void(0,s().t1)(o),originGap:0,render:e=>(0,et.jsx)("div",{...e,children:t}),placement:ro().Placement.Left})}const aa=(0,F().vU)({urlInputLabel:{defaultMessage:"URL",id:"automations.BaseModalAction.urlInputLabel"}});function ra(){const{isMobile:e}=(0,we().Fy)();return(0,Ie().yK)((t=>({inputLabel:{color:t.mediumTextColor,fontSize:e?_e().JB.UIRegular.mobile:_e().JB.UIRegular.desktop},input:{backgroundColor:t.contentBackground,paddingTop:6,paddingBottom:6},helpText:{color:t.mediumTextColor,fontSize:e?_e().JB.UISmall.mobile:_e().JB.UISmall.desktop}})),[e])}const la={create_page:function(e){const{actionStore:t}=e,n=(0,we().O7)(),{automationStore:i}=(0,Ee().YC)(),{disabled:r,maybePersistedTransactionActions:l,suppressActionErrors:c}=(0,at().i)(),u=(0,a().getActionRegistryItem)("create_page"),[d,p]=(0,Ae().VK)((()=>{const e=t.getConfig();return[null==e?void 0:e.properties,null==e?void 0:e.values]}),[t]),[m,g]=(0,Ae().VK)((()=>{const e=t.getCollectionStore();return null!=e&&e.isDefined()?[e,{collection:e.getSpaceShardedPointer(),type:"collection"}]:[void 0,void 0]}),[t]),h=(0,Ae().VK)((()=>Pt(m).length>0),[m]),y=(0,Ae().VK)((()=>{var e;return null===(e=t.getConfig())||void 0===e?void 0:e.template_page_id}),[t]),f=(0,Te.useMemo)((()=>({values:p??{},properties:d??[]})),[p,d]),v=(0,Ae().qz)(void 0,yt().Z),x=(0,Te.useCallback)((()=>v.reset()),[v]),S=(0,Te.useMemo)((()=>(0,et.jsx)(jt().e,{actionStore:t,closeMenu:x})),[t,x]),b=(0,Ae().VK)((()=>(0,s().$K)(t.getConfigStore().getKeyStore("collection").getValue())),[t]),C=(0,Te.useCallback)((e=>{"collection"===e.type&&(l.createAndCommit({perform:o=>{X().sW({data:{collection:e.collection,properties:["title"],template_page_id:null,values:null},store:t.getConfigStore(),transaction:o})},userAction:"CreatePageAction.setCollection"}),(0,It().yE)(n,{automationStore:i,automationActionStore:t}))}),[l,n,i,t]),k=(0,Te.useCallback)((e=>{const{properties:o,values:a}=f;let r=!1;if(e&&o&&1===o.length&&o.includes("title")){var s;const e=null==a?void 0:a.title;e&&null!==(s=e.value)&&void 0!==s&&s.value||(r=!0)}l.createAndCommit({perform:o=>{X().sW({store:t.getConfigStore(),data:{template_page_id:e??null,...r&&{properties:[]}},transaction:o})},userAction:"CreatePageAction.onTemplateChange"}),(0,It().yE)(n,{automationStore:i,automationActionStore:t})}),[f,l,n,i,t]),j=(0,Te.useMemo)((()=>!c.includes(t.id)),[c,t]),{errorMessage:M,errorIcon:T}=(0,At().TU)({actionId:t.id,errorKeys:["collection","config",t.id],shouldShow:j}),{errorMessage:w}=(0,At().TU)({actionId:t.id,errorKey:"template",shouldShow:j}),A=Boolean(r),I=(0,wt().E)("automation_updated_error_states");return(0,et.jsxs)(Mt().Ao,{actionId:t.id,actionMenu:S,buttonPopupStore:v,canCollapse:b,disabled:A,children:[(0,et.jsxs)(Mt().vu,{actionId:t.id,actionRegistryItem:u,disabled:A,errorMessage:I?M||w:void 0,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"flex",flexWrap:"wrap",gap:4}},children:[(0,et.jsx)(zt,{actionStore:t,disabled:A,errorMessage:M,errorIcon:T,onChange:C,value:g}),(0,s().$K)(m)&&h&&(0,et.jsx)(Gt,{collectionStore:m,disabled:A,errorMessage:w,onChange:k,value:y})]}),m&&(0,et.jsx)(Mt().R7,{disabled:A,styles:{bodyWrap:{display:"grid",gap:8,gridTemplateColumns:"1fr",minWidth:0}},children:(0,et.jsx)(o(883293).QF,{actionStore:t,collectionStore:m,disabled:A,showSetPropertyActions:!1})})]})},update_pages:o(502550).B,query_collection:function(){return null},open_page:function(e){const{actionStore:t}=e,{disabled:o,maybePersistedTransactionActions:n,suppressActionErrors:i}=(0,at().i)(),r=(0,Ae().qz)(void 0,yt().Z),l=(0,a().getActionRegistryItem)("open_page"),s=(0,Ae().VK)((()=>{var e;return null===(e=t.getConfig())||void 0===e?void 0:e.target}),[t]),{contextType:c}=(0,Ee().YC)(),u=(0,Ae().VK)((()=>{if(!(0,Oo().fo)(c))return;const e=t.getIndex();return(0,Oo().GQ)(e)?"allow":"disallow_with_message"}),[t,c]),d=(0,Ae().VK)((()=>s&&"url"!==s.type),[s]),p=(0,Te.useMemo)((()=>({headerWrap:{paddingInlineEnd:32},titleWrap:{display:"inline-flex",flexWrap:"wrap",gap:"6px 0"}})),[]),m=(0,Te.useCallback)((e=>{n.createAndCommit({perform:o=>{X().sW({store:t.getConfigStore(),data:{target:e},transaction:o})},userAction:"OpenPageAction.setTarget"})}),[n,t]),g=(0,Te.useCallback)((e=>{n.createAndCommit({perform:o=>{X().sW({store:t.getConfigStore(),data:{open_in:e},transaction:o})},userAction:"OpenPageAction.setPeekMode"})}),[n,t]),h=(0,Te.useCallback)((()=>r.reset()),[r]),y=(0,Te.useMemo)((()=>!i.includes(t.id)),[i,t]),{errorMessage:f}=(0,At().TU)({actionId:t.id,shouldShow:y}),v=(0,Te.useMemo)((()=>(0,et.jsx)(jt().e,{actionStore:t,closeMenu:h})),[t,h]),x=Boolean(o);return(0,et.jsx)(Mt().Ao,{actionMenu:v,buttonPopupStore:r,actionId:t.id,canCollapse:!1,children:(0,et.jsxs)(Mt().vu,{actionId:t.id,actionRegistryItem:l,disabled:x,styles:p,children:[(0,et.jsx)(Wo,{actionStore:t,disabled:x,errorMessage:f,onChange:m,value:s,urlBehavior:u}),d?(0,et.jsx)(zo,{actionStore:t,disabled:x,onChange:g}):null]})})},duplicate_blocks:function(e){const{actionStore:t}=e,{disabled:o,editorPlacement:n}=(0,at().i)(),i=(0,we().O7)(),l=(0,wt().E)("automation_insert_blocks_top_bottom_page"),s=(0,Ie().yK)((()=>({title:{display:"inline-flex",flexWrap:"wrap",gap:6,whiteSpace:"pre-wrap"}})),[]),c=(0,Ae().VK)((()=>(0,r().Ps)(t.getBlockPointers())),[t],{useDeepEqual:!0}),u=(0,Ae().VK)((()=>function(e,t){const o=Object.values(Po).filter((e=>t||"before"===e.key||"after"===e.key)),n=o.find((t=>t.key===e));return n??Vo}(t.getInsertionPoint(),l)),[t,l]),d=(0,Te.useCallback)((e=>function(e,t,o){ee().createAndCommit({userAction:"DuplicateBlocksAction.setInsertionPoint",environment:e,canUndo:!0,perform:e=>{X().sW({store:t.getConfigStore(),data:{insertion_point:o},transaction:e})}})}(i,t,e)),[t,i]),p=(0,Ae().qz)(void 0,yt().Z),m=(0,Te.useCallback)((()=>p.reset()),[p]),g=(0,Te.useMemo)((()=>(0,et.jsx)(jt().e,{actionStore:t,closeMenu:m})),[t,m]),h=(0,a().getActionRegistryItem)("duplicate_blocks"),y=Boolean(o);return(0,et.jsxs)(Mt().Ao,{actionMenu:g,buttonPopupStore:p,disabled:y,actionId:t.id,canCollapse:!0,children:[(0,et.jsx)(Mt().vu,{actionId:t.id,actionRegistryItem:h,disabled:y,children:(0,et.jsx)("div",{style:s.title,children:(0,et.jsx)(F()._H,{..._o.title,values:{insertionPicker:(0,et.jsx)(Bo,{currentOption:u,disabled:y,insertTopBottomPageEnabled:l,onChange:d})}})})}),(0,et.jsx)(Mt().R7,{disabled:y,children:c?(0,et.jsx)(Ko,{actionStore:t,buttonPlacement:n,contentParentPointer:c,disabled:y}):null})]})},modal_confirmation:function(e){const{actionStore:t}=e,o=(0,we().O7)(),{isMobile:n}=(0,we().Fy)(),{automationStore:i}=(0,Ee().YC)(),r=(0,F().YB)(),{disabled:l,maybePersistedTransactionActions:s}=(0,at().i)(),c=Boolean(l),u=(0,a().getActionRegistryItem)("modal_confirmation"),[d,p]=(0,Ae().VK)((()=>[t.id,t.getSpaceId()]),[t]),m=(0,kt().z)({actionId:d}),g=(0,Ie().yK)((e=>({wrap:{display:"flex",flexDirection:"column",gap:10},input:{backgroundColor:e.contentBackground,paddingTop:6,paddingBottom:6},inputLabel:{color:e.lightTextColor,fontSize:n?14:12,lineHeight:1.3,fontWeight:_e().Ue.medium,display:"flex",alignItems:"center"}})),[n]),h=(0,Ae().qz)(void 0,yt().Z),y=(0,Te.useCallback)((()=>h.reset()),[h]),f=(0,Te.useMemo)((()=>(0,et.jsx)(jt().e,{actionStore:t,closeMenu:y})),[t,y]),v=(0,Ae().VK)((()=>t.getConfigStore().getKeyStore("text")),[t]),x=(0,Ae().VK)((()=>v.getValue()),[v]),S=(0,Ae().VK)((()=>{if(p)return(0,to().analyzeSimpleFormulaOrFormulaSync)({context:{handleDataRequest:(0,Fo().createFormulaDataRequestSyncHandler)(t.getRecordModel),spaceId:p,valueTypes:m.slice(0),featureGates:(0,I().W)()},value:x})}),[p,t.getRecordModel,m,x]),b=(0,Ae().VK)((()=>t.getConfigStore().getKeyStore("continue_button").getKeyStore("text")),[t]),C=(0,Ae().VK)((()=>t.getConfigStore().getKeyStore("cancel_button").getKeyStore("text")),[t]),k=(0,Te.useCallback)((e=>{s.createAndCommit({userAction:"BaseModalAction.handleTextChange",perform:t=>{X().sO({store:v,value:e,transaction:t})}}),(0,It().yE)(o,{automationStore:i,automationActionStore:t})}),[t,i,o,s,v]),j=(0,Te.useCallback)((()=>{(0,It().yE)(o,{automationStore:i,automationActionStore:t})}),[t,i,o]),{onTextStoreSelect:M,onTextStoreUnselect:T}=(0,Ct().w)(t);return p&&S?(0,et.jsxs)(Mt().Ao,{actionMenu:f,buttonPopupStore:h,disabled:c,actionId:t.id,canCollapse:!0,children:[(0,et.jsx)(Mt().vu,{actionId:t.id,actionRegistryItem:u,disabled:c,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"inline-flex",flexWrap:"wrap",gap:"6px 0"}},children:(0,et.jsx)(F()._H,{...u.display.name})}),(0,et.jsx)(Mt().R7,{disabled:c,styles:{bodyWrap:{display:"grid",gap:8,gridTemplateColumns:"1fr",minWidth:0}},children:(0,et.jsxs)($t().jX,{direction:"column",gap:16,children:[(0,et.jsx)(Eo,{disabled:c,disableMobileActionBar:!0,formulaTypecheckContextValues:m,onChange:k,onTextStoreSelect:M,onTextStoreUnselect:T,parentRecordStore:t,placeholder:r.formatMessage(Do.confirmationMessageLabel),rows:4,spaceId:p,value:x,analyzedFormulaOutput:S,labelMessageDescriptor:Do.confirmationMessageLabel}),(0,et.jsxs)($t().jX,{direction:"column",gap:6,children:[(0,et.jsx)("label",{style:g.inputLabel,children:(0,et.jsx)(F()._H,{...Do.continueButtonTextLabel})}),(0,et.jsx)(lt,{disabled:c,maxlength:Zo().OO,onChange:j,style:g.input,store:b})]}),(0,et.jsxs)($t().jX,{direction:"column",gap:6,children:[(0,et.jsx)("label",{style:g.inputLabel,children:(0,et.jsx)(F()._H,{...Do.cancelButtonTextLabel})}),(0,et.jsx)(lt,{disabled:c,maxlength:Zo().OO,onChange:j,style:g.input,store:C})]})]})})]}):null},slack_notification:o(592479).eQ,send_in_app_notification:function(e){var t;const{actionStore:o}=e,{isMobile:n}=(0,we().Fy)(),{automationStore:i,contextType:r}=(0,Ee().YC)(),{disabled:l,maybePersistedTransactionActions:c,suppressActionErrors:u}=(0,at().i)(),d=(0,bn().w)(i,r),p=!(0,s().$K)(d),m=Boolean(l),g=(0,a().getActionRegistryItem)("send_in_app_notification"),h=(0,Ae().VK)((()=>o.getSpaceId()),[o]),y=(0,Ae().VK)((()=>null==d?void 0:d.getSpaceShardedPointer()),[d]),f=(0,Ae().VK)((()=>{if(!d)return[];return(0,Oo().NO)({collectionFormat:d.getFormat(),collectionSchema:d.getSchema(),spaceId:d.getSpaceId(),restrictCrossSpace:P().default.checkGate({gateName:"collections_xws"})})}),[d]),v=(0,Ae().VK)((()=>{var e;return null==o||null===(e=o.getConfig())||void 0===e?void 0:e.target}),[o]),x=(0,kt().z)({actionId:o.id}),S=(0,we().O7)();Cn("formula"===(null==v?void 0:v.type)?null==v||null===(t=v.value)||void 0===t?void 0:t.value:void 0);const b=(0,Ae().VK)((()=>{var e;return null===(e=o.getConfig())||void 0===e?void 0:e.notification_message}),[o]),C=(0,Ae().VK)((()=>{if(h)return(0,to().analyzeSimpleFormulaOrFormulaSync)({context:{handleDataRequest:(0,Fo().createFormulaDataRequestSyncHandler)(o.getRecordModel),spaceId:h,valueTypes:x.slice(0),featureGates:(0,I().W)()},value:b})}),[o.getRecordModel,b,x,h]),k=(0,Ae().qz)(void 0,yt().Z),j=(0,Te.useCallback)((()=>k.reset()),[k]),M=(0,Te.useMemo)((()=>(0,et.jsx)(jt().e,{actionStore:o,closeMenu:j})),[o,j]),T=(0,Te.useMemo)((()=>!u.includes(o.id)),[u,o]),w=(0,wt().E)("automation_updated_error_states"),{errorMessages:A,errorMessageDescriptors:_}=function(e){const{actionId:t,shouldShowError:o}=e,n={},i={};n.target=(0,At().TU)({actionId:t,shouldShow:o,errorKey:"target"}).errorMessage;const a=(0,At().TU)({actionId:t,shouldShow:o,errorKey:"notification_message"});return n.notification_message=a.errorMessage,i.notification_message=a.errorMessageDescriptor,n.collectionPointer=(0,At().TU)({actionId:t,shouldShow:o,errorKey:"collectionPointer"}).errorMessage,n.propertyId=(0,At().TU)({actionId:t,shouldShow:o,errorKey:"propertyId"}).errorMessage,n.formulaValue=(0,At().TU)({actionId:t,shouldShow:o,errorKey:"formulaValue"}).errorMessage,{errorMessages:n,errorMessageDescriptors:i}}({actionId:o.id,shouldShowError:T}),V=(0,Ae().VK)((()=>(0,s().$K)(o.getConfigStore().getKeyStore("target").getValue())),[o]),B=(0,Te.useCallback)((e=>{c.createAndCommit({perform:t=>{X().sW({data:{target:{type:e}},store:o.getConfigStore(),transaction:t})},userAction:"SendInAppNotificationAction.setTargetType"})}),[o,c]);(0,Te.useEffect)((()=>{!v&&p&&B("formula")}),[v,p,B]);const R=(0,Te.useCallback)((e=>{const t=e.value;if(!t)return;let n;"formula"===t.type?n={type:"formula",value:t}:"simple"===t.type?n={type:"formula",value:Ei(S,t)}:(0,s().t1)(t.type),c.createAndCommit({perform:e=>{X().sW({data:{target:{type:"formula",value:n.value}},store:o.getConfigStore(),transaction:e})},userAction:"SendInAppNotificationAction.setTarget"}),(0,It().yE)(S,{automationStore:i,automationActionStore:o})}),[i,o,S,c]),K=(0,Te.useCallback)((e=>{c.createAndCommit({perform:t=>{X().sW({data:{target:{...e,collectionPointer:y}},store:o.getConfigStore(),transaction:t})},userAction:"SendInAppNotificationAction.setTarget"}),(0,It().yE)(S,{automationStore:i,automationActionStore:o})}),[o,i,y,S,c]),F=(0,Te.useCallback)((e=>{switch(e.type){case"formula":return R(e);case"property":return K(e);default:(0,s().t1)(e)}}),[R,K]),Z=(0,Te.useCallback)((e=>{c.createAndCommit({perform:t=>{X().sW({data:{notification_message:e},store:o.getConfigStore(),transaction:t})},userAction:"SendInAppNotificationAction.setNotificationMessage"}),(0,It().yE)(S,{automationStore:i,automationActionStore:o})}),[o,i,S,c]),{onTextStoreSelect:L,onTextStoreUnselect:E}=(0,Ct().w)(o),H=(0,Te.useCallback)((()=>{le().clear({environment:S})}),[S]);return h&&C?(0,et.jsxs)(Mt().Ao,{actionMenu:M,buttonPopupStore:k,disabled:m,actionId:o.id,canCollapse:V,children:[(0,et.jsx)(Mt().vu,{actionId:o.id,actionRegistryItem:g,disabled:l,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"flex",flexWrap:"wrap",gap:4}},children:(0,et.jsx)(Ki,{noCollection:p,targetsErrorMessage:A.target,selectedTargetType:null==v?void 0:v.type,onTargetTypeChange:B,disabled:Boolean(l)})}),v&&(0,et.jsx)(Mt().R7,{children:(0,et.jsxs)($t().jX,{direction:"column",gap:16,children:[(0,et.jsxs)($t().jX,{direction:"column",gap:6,children:[(0,et.jsx)(Fi,{isMobile:n,selectedTargetType:v.type,isError:w&&Boolean("property"===v.type?A.propertyId:A.formulaValue)}),(0,et.jsx)("div",{children:(0,et.jsx)(Li,{collectionStore:d,disabled:Boolean(l),formulaTypecheckContextValues:x,currentTargetValue:v,currentProperties:f,onTargetValueChange:F,errorMessage:"property"===v.type?A.propertyId:A.formulaValue,parentRecordStore:o,spaceId:h})})]}),(0,et.jsx)(Eo,{analyzedFormulaOutput:C,labelMessageDescriptor:Ri.notificationMessageLabel,disabled:m,disableMobileActionBar:!0,disableTemplateVariableMentions:!0,errorMessageDescriptor:_.notification_message,formulaTypecheckContextValues:x,onChange:Z,onTextStoreSelect:L,onTextStoreUnselect:E,onTextEsc:H,parentRecordStore:o,rows:3,spaceId:h,value:b})]})})]}):null},send_gmail_notification:function(e){const{actionStore:t}=e,o=function(e){return(0,Ae().VK)((()=>{const t=e.getConfigStore().getKeyStore("external_bot_id").getValue();if(!t)return;return Sn().default.externalAuthentications.state.find((e=>e.integration_id===yn().aG&&t===e.id))}),[e])}(t),n=(0,Ae().VK)((()=>Sn().default.externalAuthentications.state.filter((e=>e.integration_id===yn().aG))),[]);return(0,et.jsx)(ki,{actionStore:t,gmailAuthentications:n,currentGmailAuthentication:o,allGmailAuthentications:n})},assistant_basic:function(e){const{actionStore:t}=e,o=(0,Ae().VK)((()=>{var e;return null===(e=ne().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),n=(0,Ae().VK)((()=>t.id),[t]),{disabled:i,maybePersistedTransactionActions:a}=(0,at().i)(),r=(0,Ae().qz)(void 0,yt().Z),l=(0,Te.useCallback)((()=>r.reset()),[r]),s=(0,Ae().VK)((()=>t.getConfigStore()),[t]),c=(0,Ae().VK)((()=>null==s?void 0:s.getValue()),[s]),u=(0,Te.useCallback)((e=>{a.createAndCommit({userAction:"AssistantBasicAction.setValue",perform:t=>{X().sO({store:s,value:e,transaction:t})}})}),[s,a]),d=(0,kt().z)({actionId:n}),{onTextStoreSelect:p,onTextStoreUnselect:m}=(0,Ct().w)(t);return o?(0,et.jsx)(Mt().Ao,{buttonPopupStore:r,disabled:i,actionMenu:(0,et.jsx)(jt().e,{actionStore:t,closeMenu:l}),actionId:t.id,canCollapse:!0,children:(0,et.jsx)(bt,{disabled:i??!1,config:c,onChangeConfig:u,simpleFormulaTextInputProps:{actionStore:t,spaceId:o,formulaTypecheckContextValues:d,onTextStoreSelect:p,onTextStoreUnselect:m}})}):null},define_variables:function(e){const{actionStore:t}=e,o=(0,we().O7)(),n=(0,F().YB)(),{automationStore:i}=(0,Ee().YC)(),{disabled:r,maybePersistedTransactionActions:l}=(0,at().i)(),s=Boolean(r),c=(0,a().getActionRegistryItem)("define_variables"),u=(0,Ae().VK)((()=>i.getActionStores()),[i]),d=(0,Ae().VK)((()=>{const e=t.getConfigStore().getValue();return{values:(null==e?void 0:e.values)??{},variableIds:(null==e?void 0:e.variableIds)??[]}}),[t]),p=(0,Ae().qz)(void 0,yt().Z),m=(0,Te.useCallback)((()=>p.reset()),[p]),g=(0,Te.useMemo)((()=>(0,et.jsx)(jt().e,{actionStore:t,closeMenu:m})),[t,m]),h=(0,Te.useCallback)((()=>{l.createAndCommit({perform:e=>{!function(e){const{automationActionStore:t,automationActionStores:o,intl:n,transaction:i}=e,a=(0,qt().ZP)(),r={name:(0,Xt().h)(o,n.formatMessage(Yt().eC)),value:{type:"simple",value:[[""]]}};X().sW({data:{[a]:r},store:t.getConfigStore().getKeyStore("values"),transaction:i}),ee().applyOperation({operation:{args:{id:a},command:"listAfter",path:["config","variableIds"],pointer:t.pointer},store:t,transaction:i})}({automationActionStore:t,automationActionStores:u,intl:n,transaction:e})},userAction:"DefineVariablesAction.addVariable"}),(0,It().yE)(o,{automationStore:i,automationActionStore:t})}),[t,u,i,o,n,l]),y=(0,Ie().yK)((()=>({headerWrap:{paddingRight:32},titleWrap:{whiteSpace:"pre-wrap"},footer:{display:"flex",overflow:"hidden"}})),[]);return(0,et.jsxs)(Mt().Ao,{actionMenu:g,buttonPopupStore:p,disabled:s,actionId:t.id,canCollapse:!0,children:[(0,et.jsx)(Mt().vu,{actionId:t.id,actionRegistryItem:c,disabled:s,styles:{headerWrap:y.headerWrap,titleWrap:y.titleWrap},children:(0,et.jsx)(F()._H,{...c.display.name})}),(0,et.jsx)(Mt().R7,{disabled:s,children:(0,et.jsxs)($t().jX,{direction:"column",gap:16,children:[d.variableIds.length>0&&(0,et.jsx)($t().jX,{direction:"column",gap:14,children:d.variableIds.map((e=>d.values[e]?(0,et.jsx)(Mo,{actionStore:t,variableId:e},e):null))}),(0,et.jsx)("footer",{style:y.footer,children:(0,et.jsx)(eo,{disabled:s,onClick:h})})]})})]})},http_request:function(e){const{actionStore:t}=e,{disabled:n,maybePersistedTransactionActions:i,suppressActionErrors:r}=(0,at().i)(),{automationStore:s,contextType:c,typecheckResult:u}=(0,Ee().YC)(),d=(0,bn().w)(s,c),p=Boolean(n),m=(0,a().getActionRegistryItem)("http_request"),g=ra(),h=(0,Ae().qz)(void 0,yt().Z),y=(0,Te.useCallback)((()=>h.reset()),[h]),f=(0,Te.useMemo)((()=>(0,et.jsx)(jt().e,{actionStore:t,closeMenu:y})),[t,y]),v=(0,Ae().VK)((()=>t.getConfigStore().getKeyStore("url")),[t]),x=(0,Ae().VK)((()=>t.getConfigStore().getKeyStore("selectedProperties")),[t]),S=(0,Ae().VK)((()=>x.getValue()||{type:"some",some:[]}),[x]),b=(0,Te.useCallback)((e=>{i.createAndCommit({userAction:"AutomationPlainTextInput.setValue",perform:t=>{X().sO({store:x,transaction:t,value:e})}})}),[x,i]),C=(0,Ie().yK)((e=>({divider:{marginBottom:8,marginTop:8},dividerColor:{color:e.stroke.secondary},errorMessage:{color:e.text.redTertiary}})),[]),[k,j]=(0,Te.useState)(!1),M=(0,Te.useMemo)((()=>!r.includes(t.id)||k),[r,t.id,k]),T=(0,Ae().VK)((()=>{if(!l().x.isSuccess(u)||!M)return!1;return(u.value.actionValidationFailures[t.id]||[]).some((e=>"invalid_url"===e.type))}),[u,t,M]),w=(0,At().SP)({actionId:t.id,shouldShow:M}),A=Boolean(w),I=(0,Te.useCallback)((()=>{j(!0)}),[]);return(0,et.jsxs)(Mt().Ao,{actionMenu:f,buttonPopupStore:h,disabled:p,actionId:t.id,canCollapse:!A,hideDragHandle:A,children:[(0,et.jsx)(Mt().vu,{actionId:t.id,actionRegistryItem:m,disabled:p,errorMessage:w,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"inline-flex",flexWrap:"wrap",gap:"6px 0"}},children:(0,et.jsx)(F()._H,{...m.display.name})}),(0,et.jsxs)(Mt().R7,{disabled:p,styles:{bodyWrap:{display:"grid",gap:4,gridTemplateColumns:"1fr",minWidth:0}},children:[(0,et.jsx)("label",{style:g.inputLabel,children:(0,et.jsxs)(Di().gq,{alignItems:"center",gap:4,children:[(0,et.jsx)(F()._H,{...aa.urlInputLabel}),(0,et.jsx)(Yi,{})]})}),(0,et.jsx)(lt,{disabled:p,style:g.input,store:v,errorOutline:T,onBlur:I,maxlength:Hi().Y6}),T&&(0,et.jsx)("div",{style:C.errorMessage,children:(0,et.jsx)(F()._H,{id:"SendWebhookAction.invalidUrl",defaultMessage:"Invalid URL"})}),(0,et.jsx)(Ui,{actionStore:t}),d&&(0,et.jsxs)(et.Fragment,{children:[(0,et.jsx)(o(666414).Z,{size:1,style:C.divider,dividerColor:C.dividerColor.color}),(0,et.jsx)(ta,{collectionStore:d,value:S,onChange:b})]})]})]})},publish_site:function(e){const{actionStore:t}=e,{disabled:o,maybePersistedTransactionActions:n,suppressActionErrors:i}=(0,at().i)(),r=(0,Ae().VK)((()=>{var e;return null===(e=t.getConfig())||void 0===e?void 0:e.target}),[t]),l=Boolean(o),s=(0,a().getActionRegistryItem)("publish_site"),c=(0,Ae().qz)(void 0,yt().Z),u=(0,Te.useCallback)((e=>{"url"!==e.type&&n.createAndCommit({perform:o=>{X().sW({store:t.getConfigStore(),data:{target:e},transaction:o})},userAction:"PublishSiteAction.setTarget"})}),[n,t]),d=(0,Te.useCallback)((()=>c.reset()),[c]),p=(0,Te.useMemo)((()=>!i.includes(t.id)),[i,t]),{errorMessage:m}=(0,At().TU)({actionId:t.id,shouldShow:p}),g=(0,Te.useMemo)((()=>(0,et.jsx)(jt().e,{actionStore:t,closeMenu:d})),[t,d]);return(0,et.jsxs)(Mt().Ao,{actionMenu:g,buttonPopupStore:c,disabled:l,actionId:t.id,canCollapse:!0,children:[(0,et.jsx)(Mt().vu,{actionId:t.id,actionRegistryItem:s,disabled:l,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"flex",flexWrap:"wrap",gap:4}},children:(0,et.jsx)(an,{actionStore:t,disabled:l,errorMessage:m,onTargetChange:u,value:r})}),(0,et.jsxs)(Mt().R7,{disabled:l,styles:{sectionBodyWrap:{display:"grid",gap:4,gridTemplateColumns:"1fr",minWidth:0}},children:[(0,et.jsx)(rn,{}),(0,et.jsx)(ln,{})]})]})}};var sa=()=>o(703760);function ca(e){const{children:t}=e,{isMobile:o}=(0,we().Fy)(),n=(0,Ie().yK)((e=>({wrap:{color:e.lightTextColor,fontSize:o?14:12,lineHeight:1.3,fontWeight:_e().Ue.medium}})),[o]);return(0,et.jsx)("div",{style:n.wrap,children:t})}const ua=(0,F().vU)({newActionLabel:{defaultMessage:"New action",id:"AutomationActionSelectButton.actionSection.newAction"},addActionLabel:{defaultMessage:"Add action",id:"AutomationActionSelectButton.actionSection.addAction"},addActionAriaLabel:{id:"collectionSettings.editAutomationView.addAction.iconButton",defaultMessage:"Add action"},builderModalActionTitle:{defaultMessage:"Do",id:"builderModal.editAutomationView.actionSection.title"}});function da(e){let{isEditable:t}=e;const{automationStore:o}=(0,Ee().YC)(),{disabled:n}=(0,at().i)(),i=(0,vt().p)(),{contextType:a}=(0,Ee().YC)(),r="button_block"===a||"button_property"===a,l=(0,Ae().VK)((()=>o.getActionStores().map((e=>e.isDefined()&&e.hasConcern("display")?e:null)).filter(s().K0)),[o]),c=l.length>0,u=(0,Ie().yK)((e=>({section:{display:"flex",flexDirection:"column",gap:4,width:"100%",...r&&{marginTop:20}},header:{alignItems:"center",display:"flex",flexDirection:"row",height:24},headerAdd:{marginLeft:"auto",flexGrow:0,flexShrink:0},list:{display:"flex",flexDirection:"column"}})),[r]),d=!n&&t&&i.length>0;return(0,et.jsxs)("section",{style:u.section,children:[(0,et.jsx)("header",{style:u.header,children:(0,et.jsx)(ca,{children:(0,et.jsx)(F()._H,{...ua.builderModalActionTitle})})}),(0,et.jsxs)("div",{style:u.list,children:[t?(0,et.jsx)(ma,{actionStores:l}):(0,et.jsx)(pa,{actionStores:l}),d&&(0,et.jsx)("footer",{children:(0,et.jsx)(ya,{disabled:n,hasAnyActions:c,variant:"button"})})]})]})}function pa(e){let{actionStores:t}=e;const o=(0,ct().RD)();return(0,et.jsx)("div",{style:o.wrap,children:(0,et.jsx)("div",{style:o.list,children:t.map((e=>(0,et.jsx)("div",{className:ct().dN,children:(0,et.jsx)(ga,{actionStore:e})},e.id)))})})}function ma(e){let{actionStores:t}=e;const o=(0,we().O7)(),{automationStore:n,contextType:a}=(0,Ee().YC)(),{disabled:r,onActionDragStart:l,onActionDragEnd:c,maybePersistedTransactionActions:u}=(0,at().i)(),d=(0,F().YB)(),{value:p}=(0,gt().XJ)(w().F.formulas),{value:m}=(0,gt().XJ)(ut().Sm.automationTypecheck),g=(0,Ae().VK)((()=>{const e=n.getActionStores();return new Map(e.map((e=>{if(e.isDefined()&&e.hasConcern("display"))return[e.id,e]})).filter(s().$K))}),[n]),h=(0,Te.useMemo)((()=>Array.from(g.keys())),[g]),y=(0,Ae().qz)(void 0,ft().Z),f=(0,Te.useCallback)((e=>{const t=e.state;if(t.willDrag){const e=g.get(t.draggingKey);(0,s().$K)(e)&&(0,s().$K)(l)&&l(e)}else t.willDrag||t.isDragging||null==c||c()}),[g,c,l]);(0,Te.useEffect)((()=>(y.addListener(f),()=>y.removeListener(f))),[g,y,f]);const v=(0,Te.useCallback)(((e,t)=>{p&&m&&u.createAndCommit({userAction:"AutomationButtonAction.moveAction",perform:r=>{i().reorderAutomationActions({environment:o,automationStore:n,automationTypecheckModule:m,contextType:a,formulasModule:p,intl:d,newActionIds:e,transaction:r,from:"drag_and_drop",movedActionId:t.key})}})}),[n,a,m,p,d,u,o]),x=(0,Te.useMemo)((()=>!r&&t.length>1),[r,t]),S=(0,Te.useCallback)(((e,t)=>{const o=g.get(e);return(0,s().$K)(o)?(0,et.jsx)(ga,{actionStore:o},o.id):null}),[g]);return t.length>0?(0,et.jsx)(ha,{draggableListStore:y,hasDragging:x,keys:h,onDrop:v,renderKey:S}):null}function ga(e){const{actionStore:t}=e,o=(0,Ae().VK)((()=>t.getType()),[t]);if(!o)return null;const n=la[o];return(0,et.jsx)(n,{actionStore:t})}function ha(e){const{draggableListStore:t,hasDragging:o,keys:n,onDrop:i,renderKey:a}=e,{isMobile:r}=(0,we().Fy)(),l=(0,ct().RD)();return(0,et.jsx)("div",{style:l.wrap,children:(0,et.jsx)(mt().ZP,{childClassName:ct().dN,direction:"vertical",disabled:!o||r,keys:n,onDrop:i,renderKey:a,store:t,style:l.list})})}function ya(e){const{disabled:t,hasAnyActions:o,variant:n}=e,{isMobile:i}=(0,we().Fy)(),a=(0,Ne().d)(),r=(0,F().YB)(),l=(0,Te.useMemo)((()=>({availableActions:[],hasUpdateThisPagePropertyActions:!0,hasSearch:!0,type:"eventActions"})),[]),s=(0,Ae().qz)(void 0,yt().Z),c=(0,Te.useCallback)((()=>s.reset()),[s]),u=(0,Ie().yK)((e=>({buttonWrap:{boxShadow:"initial",background:"transparent"},button:{color:e.mediumTextColor,fill:e.mediumIconColor,margin:0,width:"100%"},buttonIcon:{height:i?18:16,width:24}})),[i]),d=Boolean(t);return(0,et.jsx)(pt().ZP,{alignmentToOrigin:pt().vR.Start,buttonPopupStore:s,disabled:d,placementToOrigin:pt().pO.Bottom,popupType:a,render:()=>(0,et.jsx)(xt().Z,{initialState:l,onClose:c}),renderOrigin:e=>"icon"===n?(0,et.jsx)($e().Z,{...e,ariaLabel:r.formatMessage(ua.addActionAriaLabel),disabled:d,disabledFeedback:d,icon:ht().A}):"button"===n?(0,et.jsx)(sa().D,{...e,ariaLabel:r.formatMessage(ua.addActionAriaLabel),disabled:d,icon:(0,ht().A)({height:16,width:16}),title:(0,et.jsx)(F()._H,{...o?ua.addActionLabel:ua.newActionLabel})}):(0,et.jsx)(dt().Z,{...e,buttonStyle:u.button,disabled:d,disabledFeedback:d,focused:!1,icon:(0,ht().A)(u.buttonIcon),style:u.buttonWrap,title:o?(0,et.jsx)(F()._H,{id:"automations.addActionButton.nonEmpty.label",defaultMessage:"Add another step"}):(0,et.jsx)(F()._H,{id:"automations.addActionButton.empty.label",defaultMessage:"Add a step"})})})}function fa(e){const{areActionsEditable:t,areTriggersEditable:o,footer:n}=e,{isMobile:i}=(0,we().Fy)(),a=(0,Ie().yK)((e=>({verticalRule:{background:e.stroke.primary,borderRadius:2,height:56,marginBottom:5,marginLeft:0,marginTop:16,width:2},container:{alignItems:"center",display:"flex",flexDirection:"column",justifyContent:"center",padding:i?"0 16px":void 0}})),[i]);return(0,et.jsxs)("div",{style:a.container,children:[(0,et.jsx)(ct().nT,{isEditable:o}),(0,et.jsx)("div",{style:a.verticalRule}),(0,et.jsx)(da,{isEditable:t}),n]})}const va=(0,F().vU)({editButtonAriaLabel:{defaultMessage:"Edit button",id:"buttonBlock.button.editButtonAriaLabel"},buttonPlaceholder:{defaultMessage:"New button",id:"buttonBlock.button.placeholder"},buttonInsufficientPermissions:{defaultMessage:"You don’t have permission to run this button",id:"buttonBlock.button.insufficientPermissions"},clickToEdit:{defaultMessage:"Click to edit button",id:"buttonBlock.button.clickToEdit"},done:{defaultMessage:"Done",id:"buttonBlock.button.done"},noEditError:{defaultMessage:"You don't have full access to edit this button",id:"buttonBlock.button.noEditError"}});function xa(e){var t,o,n;const{buttonBlockStore:i}=e,a=(0,Ae().VK)((()=>i.state.editing?i.state:void 0),[i]),r=(0,Ie().yK)((e=>{var t;return{popup:{width:400},editor:{background:e.contentBackground,..."inline"===(null==a||null===(t=a.placement)||void 0===t?void 0:t.type)?{marginTop:6,borderRadius:6,border:`1px solid ${e.regularDividerColor}`,maxWidth:600}:{}}}}),[null==a||null===(t=a.placement)||void 0===t?void 0:t.type]),l=(0,Ne().d)({tabletBehavior:"slideUp"});return a&&a.placement?"popup"===(null===(o=a.placement)||void 0===o?void 0:o.type)?(0,et.jsx)(Be().ZP,{open:!0,popupType:l,render:()=>(0,et.jsx)(Sa,{...e,style:r.editor}),originRect:a.placement.originRect,style:r.popup,originGap:4,onDismiss:()=>{i.stopEditing()}}):"inline"===(null===(n=a.placement)||void 0===n?void 0:n.type)?(0,et.jsx)(Sa,{...e,style:r.editor}):void(0,s().t1)(a.placement):null}function Sa(e){const{disabled:t,store:o,buttonBlockStore:n}=e,i=(0,we().O7)(),[a,r]=(0,Ze().e)(),l=(0,Ie().yK)((e=>({scroller:{maxHeight:"75vh"},factoryButtonDeprecationBanner:{margin:"12px 12px 6px 12px"},container:{fontFamily:_e().Gl.sans},footerButton:{height:32,width:"100%"},upgradeMessageWrap:{margin:8},footerButtonWrap:{width:"100%",display:"flex",flexDirection:"column",paddingTop:24}})),[]),s=(0,Ae().VK)((()=>o.getAutomationStore()),[o]),c=(0,Ae().VK)((()=>null==s?void 0:s.getSpaceId()),[s]),{maybePersistedAutomationStore:u,maybePersistedTransactionActions:d}=(0,We().$)({automationId:null==s?void 0:s.id,spaceId:c,defaultValue:void 0,persist:!0}),p=(0,Ue().Rg)({store:o,automationStore:u}),m=(0,Ae().VK)((()=>{var e;return o.canEdit()&&"sufficient"===(null==p||null===(e=p.state)||void 0===e?void 0:e.editPermissionStatus)}),[o,p]),g=(0,Ae().VK)((()=>n.state.editing?n.state.placement:void 0),[n]),h=(0,Te.useCallback)((e=>{(0,Fe().ZP)({event:e,context:Fe().Af.EditorClick,callback:()=>{le().clear({environment:i}),Q().ZH({environment:i})}})}),[i]),y=(0,Te.useCallback)((()=>{n.stopEditing(),(0,A().j)({environment:i,event:{eventName:"click_configure_button_done",eventProperties:{block_id:o.id,automation_id:null==u?void 0:u.id}}}),P().default.logEvent("click_configure_button_done")}),[n,i,o,u]),f=(0,Ae().VK)((()=>n.state.suppressErrorsForActionIds),[n]),v=(0,Te.useCallback)((e=>n.suppressErrorsForAction(e.id)),[n]),x=(0,Te.useCallback)((()=>{he().y(i,{from:"button_block_automation_header_message",upsell:{type:"product",product:"plus",limit:{type:"none"}}})}),[i]),S=(0,Oe().a)(),b=t||!m,C=(0,Ae().VK)((()=>{var e;return!(null==p||null===(e=p.state)||void 0===e||!e.typecheckResult)&&(0,De().A)({environment:i,typecheckResult:p.state.typecheckResult,automationStore:u})}),[p,i,u]);return u?(0,et.jsx)("div",{ref:a,style:{...l.container,...e.style},onClick:h,children:(0,et.jsx)(Ee().Jj,{automationStore:u,contextType:"button_block",children:(0,et.jsxs)(He().$,{value:{disabled:b,editorPlacement:g,editorWidth:r,maybePersistedTransactionActions:d,onActionAdded:v,suppressActionErrors:f,hideDragHandle:C,...S},defaultCollapseActions:C,children:[(0,et.jsx)(ba,{blockStore:o,disabled:b}),(0,et.jsxs)(Ke().Z,{style:l.scroller,type:Le().Z.Y,children:[C&&(0,et.jsx)("div",{style:l.upgradeMessageWrap,children:(0,et.jsx)(st().c,{onUpsellClick:x})}),!m&&(0,et.jsx)("div",{style:l.upgradeMessageWrap,children:(0,et.jsx)(ze().k,{children:(0,et.jsx)(F()._H,{...va.noEditError})})}),(0,et.jsx)("section",{style:{paddingBlock:8,paddingInline:8},children:(0,et.jsx)(fa,{areActionsEditable:!C,areTriggersEditable:!1,footer:(0,et.jsx)("div",{style:l.footerButtonWrap,children:(0,et.jsx)(Re().Z,{onClick:y,style:l.footerButton,children:(0,et.jsx)(F()._H,{...va.done})})})})})]})]})})}):null}function ba(e){const{blockStore:t,disabled:o}=e,{automationStore:n}=(0,Ee().YC)(),i=(0,we().O7)(),a=(0,Ie().yK)((e=>({wrap:{display:"flex",flexDirection:"column",padding:12,gap:6},inputs:{display:"flex",alignItems:"center",gap:6,borderBottom:`1px solid ${e.stroke.secondary}`,paddingBottom:12},nameInputWrap:{flexGrow:"1"},nameInput:{background:"transparent",boxShadow:"none",padding:4}})),[]),r=(0,Ae().VK)((()=>n.getNameStore()),[n]),l=(0,Ae().VK)((()=>n.getIconStore()),[n]),s=(0,Ae().VK)((()=>(null==r?void 0:r.getValue())??""),[r]),c=(0,Ae().VK)((()=>null==l?void 0:l.getValue()),[l]),u=(0,Te.useCallback)(((e,t)=>{ee().createAndCommit({userAction:"ButtonBlock.updateProperty",environment:i,canUndo:!0,perform:o=>{X().sW({store:n.getPropertiesStore(),transaction:o,data:{[e]:t??null}})}})}),[n,i]),d=(0,Te.useCallback)((e=>u("icon",e)),[u]),p=(0,Te.useCallback)((e=>u("name",e)),[u]);return(0,et.jsx)(Pe().p,{allowSelectionWithin:!0,style:a.wrap,children:(0,et.jsxs)("div",{style:a.inputs,children:[(0,et.jsx)(ot,{disabled:o,currentIcon:c,handleIconChange:d,store:t}),(0,et.jsx)(rt,{onChange:p,value:s,disabled:o,placeholder:_().Z.formatMessage(va.buttonPlaceholder),wrapStyle:a.nameInputWrap,style:a.nameInput,format:Ve().B.ExtraLarge,autoFocus:!s})]})})}var Ca=()=>o(565630),ka=()=>o(250625),ja=()=>o(34683),Ma=()=>o(863406);function Ta(e){var t;const{url:o,parentStore:n,onMouseEnter:i,onMouseLeave:a}=e,r=(0,we().O7)(),[l]=(0,In().r5)((async()=>{var e,t;const n=await Y().callApi({eventName:"getDataForLinkMention",environment:r,data:{url:o,spaceId:(null===(e=ne().default.state.currentSpaceStore)||void 0===e?void 0:e.id)??(null===(t=ne().default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.getSpaceId()),source:"button_hover"}});if("success"===n.type){if("error"in n.data)throw new Error(`Error in iframely response: ${n.data.status} ${n.data.error}`);return n.data}throw n.error}),[r,o]);let s;return s=null!==(t=l.value)&&void 0!==t&&t.iframe?(0,et.jsx)(ja().g,{hoverData:l.value,iframe_url:l.value.iframe,height:l.value.height,padding:l.value.padding,padding_top:l.value.padding_top,store:n,href:o,showEditButton:!1}):(0,et.jsx)(Ma().Y,{hoverData:l.value,href:o,showEditButton:!1,store:n,loading:"pending"===l.status}),(0,et.jsx)("div",{onMouseEnter:i,onMouseLeave:a,children:s})}function wa(e){const{renderOrigin:t}=e;return(0,we().Fy)().isMobile?(0,et.jsx)(et.Fragment,{children:t()}):(0,et.jsx)(Aa,{...e})}function Aa(e){const{renderOrigin:t,urlToPreview:o,parentStore:n}=e,[i,a]=(0,Te.useState)(!1),l=(0,Te.useMemo)((()=>({onMouseEnter:()=>{a(!0)},onMouseLeave:()=>{a(!1)}})),[]),s=function(e){const{targetHovered:t}=e,[o,n]=(0,Te.useState)(!1),i=(0,Ca().Kt)(t,400,Object.is),[a,l]=(0,Te.useState)(!1),s=a||!o&&i,c=(0,Te.useCallback)((()=>l(s)),[s]),u=(0,Te.useCallback)((()=>{l(!1)}),[]),d=(0,Te.useCallback)((()=>{u(),n(!0)}),[u]);return(0,Te.useEffect)((()=>{n(!1)}),[i]),(0,Te.useEffect)((()=>{const e=r().P2((()=>{d()}),200,{leading:!0});return ka().lj(window,"scroll",e,!0),()=>ka().ZV(window,"scroll",e,!0)}),[d]),{state:s,pinPopup:c,unpinPopup:u}}({targetHovered:i});return(0,et.jsx)(Be().ZP,{disableMouseCapture:!0,preventCaptureEsc:!0,preventScaleTransition:!0,originGap:6,preventOpacityTransition:!0,open:s.state,popupType:Be().kQ.Popup,alignmentToOrigin:ro().Alignment.Start,placementToOrigin:ro().Placement.Bottom,render:()=>(0,et.jsx)(Ta,{url:o,parentStore:n,onMouseEnter:s.pinPopup,onMouseLeave:s.unpinPopup}),origin:t(l)})}},883293:(e,t,o)=>{o.d(t,{QF:()=>O});o(267602),o(653476),o(241792);var n=o(667294),i=()=>o(219727),a=()=>o(142735),r=()=>o(846550),l=()=>o(912203),s=()=>o(21463),c=()=>o(473304),u=()=>o(22183),d=()=>o(907874),p=()=>o(752778),m=()=>o(788860),g=()=>o(513670),h=()=>o(696459),y=()=>o(636340),f=()=>o(990966),v=()=>o(212493),x=()=>o(827973),S=()=>o(448419),b=()=>o(291198),C=()=>o(198829),k=()=>o(255577),j=()=>o(388284),M=()=>o(585270),T=()=>o(307473),w=()=>o(615676),A=()=>o(749826),I=()=>o(637118),_=()=>o(960597),P=()=>o(309841),V=()=>o(195245),B=()=>o(985571),R=()=>o(903098),K=()=>o(918745),F=()=>o(676279),Z=()=>o(790819),L=()=>o(61313),E=()=>o(411766),H=o(785893);const D=(0,m().vU)({replaceActionLabel:{id:"automations.AutomationActionSetPropertiesSection.replaceAction.label",defaultMessage:"Replace with"},appendActionLabel:{id:"automations.AutomationActionSetPropertiesSection.appendAction.label",defaultMessage:"Add"},removeActionLabel:{id:"automations.AutomationActionSetPropertiesSection.removeAction.label",defaultMessage:"Remove"},toggleActionLabel:{id:"automations.AutomationActionSetPropertiesSection.toggleAction.label",defaultMessage:"Toggle"},titlePlaceholder:{id:"automations.AutomationActionSetPropertiesSection.titlePlaceholder",defaultMessage:"Untitled"},automationActionPropertyDeleted:{id:"automations.AutomationActionSetPropertiesSection.automationActionPropertyDeleted",defaultMessage:"This property was deleted"},automationActionPropertyUnsupported:{id:"automations.AutomationActionSetPropertiesSection.automationActionPropertyUnsupported",defaultMessage:"This property is unsupported"}});function O(e){const{actionStore:t,collectionStore:o,disabled:r,showSetPropertyActions:l}=e,s=(0,i().O7)(),{automationStore:c}=(0,I().YC)(),{maybePersistedTransactionActions:u}=(0,V().i)(),d=(0,a().VK)((()=>{var e;return(null===(e=t.getConfig())||void 0===e?void 0:e.values)??{}}),[t]),p=(0,a().VK)((()=>{var e;return(null===(e=t.getConfig())||void 0===e?void 0:e.properties)??[]}),[t]),m=(0,n.useCallback)((e=>{const o=p.concat([e]),n={...d,[e]:void 0};u.createAndCommit({userAction:"AutomationActionSetPropertiesSection.propertiesChange",perform:e=>{N({configStore:t.getConfigStore(),properties:o,transaction:e,values:n})}}),(0,P().yE)(s,{automationActionStore:t,automationStore:c})}),[p,d,u,s,c,t]),g=(0,n.useCallback)(((e,o)=>{const n=p.indexOf(e);if(-1===n)return;const i=p.slice(0);i[n]=o;const a={...d,[o]:void 0};u.createAndCommit({userAction:"AutomationActionSetPropertiesSection.setProperties",perform:e=>{N({configStore:t.getConfigStore(),properties:i,transaction:e,values:a})}}),(0,P().yE)(s,{automationActionStore:t,automationStore:c})}),[p,d,u,s,c,t]),h=(0,n.useCallback)((e=>{const o=p.filter((t=>t!==e)),n={...d,[e]:void 0};u.createAndCommit({userAction:"AutomationActionSetPropertiesSection.removeProperty",perform:e=>{N({configStore:t.getConfigStore(),properties:o,transaction:e,values:n})}}),(0,P().yE)(s,{automationActionStore:t,automationStore:c})}),[p,d,u,s,c,t]),y=(0,n.useCallback)(((e,o)=>{const n={...d,[e]:o};u.createAndCommit({userAction:"AutomationActionSetPropertiesSection.handleValueChange",perform:e=>{N({configStore:t.getConfigStore(),properties:p,transaction:e,values:n})}}),(0,P().yE)(s,{automationActionStore:t,automationStore:c})}),[d,u,s,t,c,p]);return(0,H.jsx)(U,{actionStore:t,collectionStore:o,disabled:r,onPropertyAdd:m,onPropertyChange:g,onPropertyRemove:h,onPropertyValueChange:y,showSetPropertyActions:l})}function N(e){const{configStore:t,properties:o,transaction:n,values:i}=e;y().sW({store:t,data:{properties:o,values:i},transaction:n})}function U(e){const{actionStore:t,collectionStore:o,onPropertyAdd:n,onPropertyChange:i,onPropertyRemove:s,onPropertyValueChange:c,disabled:u,showSetPropertyActions:d}=e,p=(0,r().yK)((e=>({addPropertyValuePlaceholder:{color:e.mediumTextColor,flexGrow:1,textAlign:"right"},addPropertyRow:{display:"flex",alignItems:"center"}})),[]),m=(0,a().VK)((()=>t.getConfigStore().getKeyStore("properties").getValue()??[]),[t]),g=(0,a().VK)((()=>(0,l().cO)({collectionFormat:o.getFormat(),collectionSchema:o.getSchema(),filter:e=>{let[t]=e;return!m.includes(t)},spaceId:o.getSpaceId(),restrictCrossSpace:A().default.checkGate({gateName:"collections_xws"})})),[o,m]),h=0===g.length;return(0,H.jsxs)(H.Fragment,{children:[m.length>0&&(0,H.jsx)(W,{actionStore:t,availablePropertyIds:g,collectionStore:o,disabled:u,onPropertyChange:i,onPropertyRemove:s,onPropertyValueChange:c,showSetPropertyActions:d}),!u&&!h&&(0,H.jsx)("div",{style:p.addPropertyRow,children:(0,H.jsx)(L().X,{availablePropertyIds:g,currentValue:void 0,collectionStore:o,onChange:n,disabled:u,alreadyHaveProperties:m.length>0})})]})}function W(e){const{actionStore:t,availablePropertyIds:o,collectionStore:n,onPropertyChange:l,onPropertyRemove:s,onPropertyValueChange:c,showSetPropertyActions:u,disabled:d}=e,{isMobile:p}=(0,i().Fy)(),m=p,g=(0,r().yK)((()=>({wrap:{alignItems:"start",columnGap:4,display:"grid",gridTemplateColumns:m?"100%":"160px 1fr",minWidth:0,rowGap:m?4:8},propertyValue:{...m?{fontSize:14,marginBlockEnd:16}:{}},lastPropertyValue:{...m?{fontSize:14,marginBlockEnd:0}:{}}})),[m]),[h,y]=(0,a().VK)((()=>{const e=t.getConfig();return[(null==e?void 0:e.properties)??[],(null==e?void 0:e.values)??{}]}),[t]);return(0,H.jsx)("div",{style:g.wrap,children:h.map(((e,i)=>{const a=i===h.length-1;return(0,H.jsx)(z,{actionStore:t,availablePropertyIds:o,collectionStore:n,disabled:d,onPropertyChange:l,onPropertyRemove:s,onPropertyValueChange:c,property:e,showSetPropertyActions:u,value:y[e],valueStyle:a?g.lastPropertyValue:g.propertyValue},e)}))})}function z(e){const{actionStore:t,availablePropertyIds:o,collectionStore:i,disabled:g,onPropertyChange:h,onPropertyRemove:y,onPropertyValueChange:f,property:x,showSetPropertyActions:S,value:C,valueStyle:k}=e,j={type:"collection",collectionStore:i,property:x},M=(0,m().YB)(),T=(0,r().yK)((e=>({propertyName:{display:"flex"},propertyValue:{display:"flex",gap:4,minWidth:50,...k},propertyValueInput:{minWidth:50}})),[k]),A=(0,n.useMemo)((()=>{if("title"===x)return M.formatMessage(D.titlePlaceholder)}),[M,x]),P=(0,a().VK)((()=>i.getSchema()[x]||i.getDeletedSchema()[x]),[i,x]),B=(0,a().VK)((()=>Boolean(!i.getSchema()[x])),[i,x]),K=(0,a().VK)((()=>{if(P)return(0,d().setPropertyValueToSimpleFormulaReturnType)({table:p().vF,id:i.id,spaceId:i.getSpaceId()},x,P)}),[i,P,x]),F=(0,n.useMemo)((()=>{if(P&&(0,l().SF)(P))return P.type}),[P]),Z=(0,n.useMemo)((()=>P&&!(0,l().SF)(P)),[P]),O=null==C?void 0:C.value,N=(0,a().VK)((()=>(0,c().o9)(C)),[C]),{automationStore:U}=(0,I().YC)(),W=(0,a().VK)((()=>U.getSpaceId()),[U]),z=(0,R().z)({actionId:t.id}),$=(0,a().VK)((()=>{if(F&&W)return(0,d().analyzeSimpleFormulaOrFormulaSync)({context:{allowedReturnTypes:l().Y_[F],handleDataRequest:(0,u().createFormulaDataRequestSyncHandler)(t.getRecordModel),spaceId:W,valueTypes:z.slice(0),featureGates:(0,w().W)()},value:null==C?void 0:C.value})}),[t.getRecordModel,z,W,F,null==C?void 0:C.value]),{suppressActionErrors:Y}=(0,V().i)(),X=(0,n.useMemo)((()=>!Y.includes(t.id)),[Y,t]),{errorMessage:J}=(0,_().TU)({actionId:t.id,errorKey:x,shouldShow:X}),Q=(0,n.useCallback)((e=>{h(x,e)}),[h,x]),ee=(0,n.useCallback)((()=>y(x)),[y,x]),te=(0,n.useCallback)((e=>{f(x,e)}),[f,x]),oe=(0,n.useCallback)((e=>{te({action:e,value:O})}),[O,te]),ne=(0,n.useCallback)((e=>{te({action:N,value:e})}),[N,te]);if(!W)return null;const ie=function(e){if("email"===e||"phone_number"===e||"url"===e)return{disableEmojiCommands:!0,disableFormattingAndMentions:!0};return{}}(F);let ae;return B?ae=(0,H.jsx)(m()._H,{...D.automationActionPropertyDeleted}):Z?ae=(0,H.jsx)(m()._H,{...D.automationActionPropertyUnsupported}):J&&(ae=J),(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)("div",{style:T.propertyName,children:(0,H.jsx)(L().X,{availablePropertyIds:o,currentValue:x,collectionStore:i,onChange:Q,disabled:g,onRemove:ee,errorMessage:ae})}),(0,H.jsxs)("div",{style:T.propertyValue,children:[!B&&S&&P&&s().Y[P.type]&&(0,H.jsx)(G,{disabled:g,onChange:oe,value:N}),B?(0,H.jsx)(b().Z,{disabled:!0,placeholder:M.formatMessage(D.automationActionPropertyDeleted)}):Z?(0,H.jsx)(b().Z,{disabled:!0,placeholder:M.formatMessage(D.automationActionPropertyUnsupported)}):F&&K?(0,H.jsxs)(v().jX,{direction:"column",gap:7,style:T.propertyValueInput,children:[(0,H.jsx)(q,{...ie,analyzedFormulaOutput:$,automationActionStore:t,disabled:g,disableMobileActionBar:!0,disableTemplateVariableMentions:!0,simpleFormulaContext:j,formulaTypecheckContextValues:z,onChange:ne,parentRecordStore:t,placeholder:A,propertyType:F,spaceId:W,type:K,value:null==C?void 0:C.value}),$&&(0,H.jsx)(E().g,{analyzedFormulaOutput:$})]}):null]})]})}function G(e){const{disabled:t,onChange:o,value:n}=e,i=(0,r().yK)((e=>({button:{boxShadow:e.inputBoxShadow,minWidth:120}})),[]),a=(0,F().d)();return(0,H.jsx)(S().ZP,{popupType:a,alignmentToOrigin:S().vR.End,placementToOrigin:S().pO.Bottom,originGap:0,disabled:t,renderOrigin:e=>(0,H.jsx)(Z().S,{...e,disabled:t,style:i.button,dropdownButtonType:"button",children:(0,H.jsx)(Y,{action:n})}),render:e=>(0,H.jsx)($,{onChange:o,parent:e,value:n})})}function $(e){const{value:t,onChange:o,parent:n}=e,i=(0,K().F)({width:250}),a=g().oA(c().E2.map(((e,i)=>({key:i,render:o=>(0,H.jsx)(x().Z,{...o,disabled:!1,title:(0,H.jsx)(Y,{action:e}),checkState:t===e}),action:()=>{e!==t&&o(e),n.close()}}))));return(0,H.jsx)(C().Z,{...i,children:(0,H.jsx)(k().Z,{type:k().i.Vertical,sections:[{key:0,render:e=>(0,H.jsx)(j().Z,{enableActionSheetTitle:!0,...e}),items:a}],initialFocus:0})})}function Y(e){const{action:t}=e;return"replace"===t?(0,H.jsx)(m()._H,{...D.replaceActionLabel}):"append"===t?(0,H.jsx)(m()._H,{...D.appendActionLabel}):"remove"===t?(0,H.jsx)(m()._H,{...D.removeActionLabel}):"toggle"===t?(0,H.jsx)(m()._H,{...D.toggleActionLabel}):void(0,h().t1)(t)}function q(e){const{analyzedFormulaOutput:t={},automationActionStore:o,disabled:a,disableEmojiCommands:s,disableFormattingAndMentions:c,disableMobileActionBar:u,disableTemplateVariableMentions:d,formulaTypecheckContextValues:p,onChange:m,parentRecordStore:g,placeholder:h,propertyType:y,simpleFormulaContext:v,spaceId:x,type:S,value:b}=e,{parseErrors:C=[],typeErrors:k=[]}=t,j=C.length>0||k.length>0,{onTextStoreSelect:w,onTextStoreUnselect:A}=(0,B().w)(o),I=(0,r().yK)((e=>({input:{width:"100%"}})),[]),_=(0,i().O7)(),P=(0,n.useCallback)((()=>{f().clear({environment:_})}),[_]);return"text"===S.type?(0,H.jsx)(M().w,{allowedReturnTypes:l().Y_[y],disabled:a,disableEmojiCommands:s,disableMobileActionBar:u,disableTemplateVariableMentions:d,formulaTypecheckContextValues:p,onChange:m,onTextStoreSelect:w,onTextStoreUnselect:A,onTextEsc:P,parentRecordStore:g,spaceId:x,placeholder:h,style:I.input,shouldShowErrorStyles:j,value:b}):"number"===S.type?(0,H.jsx)(M().w,{allowedReturnTypes:l().Y_[y],disabled:a,disableEmojiCommands:!0,disableInsertedDeletedAnnotations:!0,disableMentions:!0,disableMobileActionBar:!0,disableStyleAnnotations:!0,formulaTypecheckContextValues:p,onChange:m,onTextStoreSelect:w,onTextStoreUnselect:A,onTextEsc:P,parentRecordStore:g,spaceId:x,style:I.input,shouldShowErrorStyles:j,value:b}):(0,H.jsx)(T().e,{allowedReturnTypes:l().Y_[y],disabled:a,disableEmojiCommands:s,disableFormattingAndMentions:c,disableMobileActionBar:u,disableTemplateVariableMentions:d,formulaTypecheckContextValues:p,onChange:m,parentRecordStore:g,placeholder:h,simpleFormulaContext:v,spaceId:x,type:S,value:b})}},545444:(e,t,o)=>{o.d(t,{k:()=>l});o(667294);var n=()=>o(219727),i=()=>o(846550),a=()=>o(168441),r=o(785893);function l(e){const{children:t,icon:o}=e,l=function(){const{isMobile:e}=(0,n().Fy)();return(0,i().yK)((t=>({iconWrap:{flexGrow:0,flexShrink:0},messageWrap:{flexGrow:1},lockedIcon:{fill:t.icon.secondary,height:"100%",width:"100%"},lockedIconWrap:{background:t.fill.lightGraySecondary,borderRadius:4,height:20,padding:2,width:20},paragraph:{color:t.text.secondary,fontSize:e?14:12,margin:0},wrap:{alignItems:"center",display:"flex",flexDirection:"row",marginBottom:6,gap:10},wrapWrap:{padding:e?"0 12px 12px":"0 0 6px 0"}})),[e])}();return(0,r.jsx)("div",{style:l.wrapWrap,children:(0,r.jsxs)("div",{style:l.wrap,children:[(0,r.jsx)("div",{style:l.iconWrap,children:(0,r.jsx)("div",{style:l.lockedIconWrap,children:o||(0,a().Q)(l.lockedIcon)})}),(0,r.jsx)("div",{style:l.messageWrap,children:(0,r.jsx)("p",{style:l.paragraph,children:t})})]})})}},61313:(e,t,o)=>{o.d(t,{X:()=>f});var n=o(667294),i=()=>o(219727),a=()=>o(142735),r=()=>o(846550),l=()=>o(766933),s=()=>o(788860),c=()=>o(707513),u=()=>o(949719),d=()=>o(448419),p=()=>o(198829),m=()=>o(918745),g=()=>o(676279),h=()=>o(790819),y=o(785893);function f(e){const{alreadyHaveProperties:t,availablePropertyIds:o,collectionStore:f,currentValue:v,disabled:x,onChange:S,onRemove:b,placeholderMessage:C,errorMessage:k,hideErrorMessageTooltip:j}=e,M=(0,i().O7)(),T=(0,r().Fg)(),{device:w}=M,A=(0,a().VK)((()=>f.getSchema()??{}),[f]),I=(0,a().VK)((()=>f.getFormat()??{}),[f]),_=(0,a().VK)((()=>v?f.getSchema()[v]:void 0),[v,f]),P=(0,a().VK)((()=>v?f.getDeletedSchema()[v]:void 0),[v,f]),V=(0,r().yK)((e=>{const t={fill:e.lightTextColor,height:"auto",marginRight:4,width:16};return{propertyIcon:t,deletedPropertyIcon:{...t,fill:e.text.uiRedPrimary},propertyTitle:{fontWeight:c().Ue.regular,...c().Yu},deletedPropertyTitle:{color:e.text.uiRedPrimary,fontWeight:c().Ue.regular,...c().Yu}}}),[]),B=(0,n.useCallback)((()=>o),[o]),R=(0,g().d)(),K=(0,a().VK)((()=>_?function(e){return(0,y.jsx)(l().ZP,{icon:void 0,size:16,style:{...e,...V.propertyIcon},theme:T,type:_.type})}:P?function(e){return(0,y.jsx)(l().ZP,{icon:void 0,type:P.type,size:16,theme:T,style:{...e,...V.deletedPropertyIcon}})}:void 0),[P,_,V.deletedPropertyIcon,V.propertyIcon,T]),F=Boolean(k),Z=!Boolean(_)&&!Boolean(t),L=!Boolean(t);return(0,y.jsx)(d().ZP,{popupType:R,alignmentToOrigin:d().vR.Center,placementToOrigin:d().pO.Bottom,originGap:0,disabled:x,renderOrigin:e=>(0,y.jsx)(h().S,{...e,disabled:x,icon:K,isError:F,hasActionRequired:Z,isSecondary:L,tooltipMessage:!j&&k,dropdownButtonType:"button",children:_?(0,y.jsx)("div",{style:V.propertyTitle,children:_.name}):P?(0,y.jsx)("div",{style:V.deletedPropertyTitle,children:P.name}):C?(0,y.jsx)(s()._H,{...C}):t?(0,y.jsx)(s()._H,{id:"automations.propertyPicker.buttonPlaceholderAlreadyHaveProperties",defaultMessage:"Edit property"}):(0,y.jsx)(s()._H,{id:"automations.propertyPicker.buttonPlaceholder",defaultMessage:"Edit a property"})}),render:e=>{const t=(0,m().U)({device:w,width:280,paddingTop:4});return(0,y.jsx)(p().Z,{...t,children:(0,y.jsx)(u().Z,{schema:A,format:I,showRemoveOption:Boolean(b),currentProperty:v,getProperties:B,onAccept:t=>{t&&t!==v?S(t):void 0===t&&(null==b||b(v)),e.close()}})})}})}},87781:(e,t,o)=>{o.d(t,{c:()=>d});o(667294);var n=()=>o(846550),i=()=>o(788860),a=()=>o(707513),r=()=>o(212493),l=()=>o(92175),s=()=>o(637118),c=o(785893);const u=(0,i().vU)({automationRequiresSubscription:{defaultMessage:"To edit or run this automation, upgrade your plan.",id:"AutomationHeaderView.automationRequiresSubscription"},automationRequiresSubscriptionButton:{defaultMessage:"To edit or run this automation, upgrade your plan or remove any connected action steps.",id:"AutomationHeaderView.automationRequiresSubscriptionButton"},automationRequiresSubscriptionTitle:{defaultMessage:"Upgrade to use connected actions",id:"AutomationHeaderView.automationRequiresSubscriptionTitle"},automationRequiresSubscriptionUpgradeButton:{defaultMessage:"Upgrade",id:"AutomationHeaderView.automationRequiresSubscriptionUpgradeButton"}});function d(e){const{onUpsellClick:t}=e,{contextType:o}=(0,s().YC)(),d="button_block"===o||"button_property"===o,p=d?u.automationRequiresSubscriptionButton:u.automationRequiresSubscription,m=(0,n().yK)((e=>({wrap:{fontSize:14,background:e.surface.wash,border:`1px solid ${e.surface.wash}`,borderRadius:6,padding:12,marginBottom:12},button:{fontWeight:a().Ue.medium,borderRadius:6,border:`1px solid ${e.stroke.primary}`,alignSelf:"flex-start"},title:{color:e.text.primary,fontWeight:a().Ue.medium,margin:0},text:{color:e.text.secondary,margin:0}})),[]);return(0,c.jsxs)(r().jX,{direction:"column",gap:4,style:m.wrap,children:[d&&(0,c.jsx)("p",{style:m.title,children:(0,c.jsx)(i()._H,{...u.automationRequiresSubscriptionTitle})}),(0,c.jsx)("p",{style:m.text,children:(0,c.jsx)(i()._H,{...p})}),(0,c.jsx)(l().Z,{onClick:t,style:m.button,children:(0,c.jsx)(i()._H,{...u.automationRequiresSubscriptionUpgradeButton})})]})}},411766:(e,t,o)=>{o.d(t,{M:()=>d,g:()=>u});o(492176),o(7961);var n=o(667294),i=()=>o(756191),a=()=>o(788860),r=()=>o(696459),l=()=>o(661641),s=()=>o(466970),c=o(785893);function u(e){const{analyzedFormulaOutput:t}=e,{parseErrors:o,typeErrors:i}=t,u=(0,a().YB)(),p=(0,s().E)("automation_updated_error_states"),m=(0,n.useMemo)((()=>d(u,o??[],i??[])),[u,o,i]);return(0,r().$K)(m)?(0,c.jsx)(l().q,{colorName:p?"uiRedPrimary":"secondary",styleName:"UISmall-12px/Regular",children:(0,c.jsx)(a()._H,{...m})}):null}function d(e,t,o){const n=null==t?void 0:t.at(0);if((0,r().$K)(n))return(0,i().sG)(n);const a=null==o?void 0:o.at(0);return(0,r().$K)(a)?(0,i().ic)(e,a):void 0}},296227:(e,t,o)=>{o.d(t,{e:()=>K});o(267602),o(653476),o(228244);var n=o(667294),i=()=>o(219727),a=()=>o(142735),r=()=>o(846550),l=()=>o(788860),s=()=>o(696459),c=()=>o(285755),u=()=>o(827973),d=()=>o(108714),p=()=>o(292518),m=()=>o(198829),g=()=>o(255577),h=()=>o(388284),y=()=>o(141735),f=()=>o(677559),v=()=>o(404553),x=()=>o(253608),S=()=>o(679620),b=()=>o(536635),C=()=>o(802600),k=()=>o(653457),j=()=>o(953293),M=()=>o(739479),T=()=>o(49396),w=()=>o(637118),A=()=>o(195245),I=()=>o(918745),_=()=>o(210968),P=()=>o(502550),V=()=>o(590259),B=o(785893);const R=(0,l().vU)({learnAboutVariablesMenuItemLabel:{defaultMessage:"Learn about variables",id:"automations.actionContextMenu.learnAboutVariablesMenuItemLabel"},learnAboutWebhooksMenuItemLabel:{defaultMessage:"Learn about webhooks",id:"automations.actionContextMenu.learnAboutWebhooksMenuItemLabel"},addStepAboveMenuItemLabel:{defaultMessage:"Add action above",id:"automations.actionContextMenu.addStepAboveMenuItemLabel"},addStepBelowMenuItemLabel:{defaultMessage:"Add action below",id:"automations.actionContextMenu.addStepBelowMenuItemLabel"},deleteMenuItemLabel:{defaultMessage:"Delete",id:"automations.actionContextMenu.deleteMenuItemLabel"},duplicateMenuItemLabel:{defaultMessage:"Duplicate",id:"automations.actionContextMenu.duplicateMenuItemLabel"},duplicatingMenuItemLabel:{defaultMessage:"Duplicating…",id:"automations.actionContextMenu.duplicatingMenuItemLabel"},editMenuItemLabel:{defaultMessage:"Edit",id:"automations.actionContextMenu.editMenuItemLabel"},moveDownMenuItemLabel:{defaultMessage:"Move down",id:"automations.actionContextMenu.moveDownMenuItemLabel"},moveUpMenuItemLabel:{defaultMessage:"Move up",id:"automations.actionContextMenu.moveUpMenuItemLabel"}});function K(e){const{actionStore:t,closeMenu:o}=e,{maybePersistedTransactionActions:r}=(0,A().i)(),{automationStore:s,contextType:u}=(0,w().YC)(),d=(0,l().YB)(),p=(0,i().O7)(),{value:m}=(0,f().XJ)(y().F.formulas),{value:g}=(0,f().XJ)(c().Sm.automationTypecheck),[h,v]=(0,n.useState)(),x=(0,a().VK)((()=>s.getActionIds()),[s]),S=(0,a().VK)((()=>x.indexOf(t.id)),[t.id,x]),b=(0,a().VK)((()=>(0,P().r)(u,t)),[t,u]),C=(0,a().VK)((()=>{if(!b||!t.isType("update_pages"))return;const e=t.getConfigStore().getKeyStore("properties").getValue();return null==e?void 0:e[0]}),[t,b]),k=0===S,j=S===x.length-1,M=(0,n.useCallback)((()=>{v(void 0),null==o||o()}),[o]),I=(0,_().p)(),K=(0,a().VK)((()=>I.some((e=>e.type===t.getType()))),[t,I]),Z=(0,n.useMemo)((()=>{if(s&&K)return async()=>{const e=r.createAndCommit({perform:e=>T().duplicateAutomationAction({sourceActionStore:t,environment:p,includeParenting:!0,insertionPoint:{afterActionId:t.id},transaction:e}),userAction:"ActionContextMenu.duplicateAction"});await e.performResult.onComplete,M()}}),[t,s,p,M,r,K]),E=(0,n.useCallback)((()=>{if(m&&g)return r.createAndCommit({perform:e=>{T().removeAutomationAction({actionStore:t,automationStore:s,automationTypecheckModule:g,contextType:u,environment:p,formulasModule:m,intl:d,transaction:e})},userAction:"ActionContextMenu.removeAction"}),M(),Promise.resolve()}),[t,s,g,u,p,m,M,d,r]),H=(0,n.useMemo)((()=>{if(!k&&m&&g)return()=>{r.createAndCommit({perform:e=>{const o=L(x,S-1,S);T().reorderAutomationActions({environment:p,automationStore:s,automationTypecheckModule:g,contextType:u,formulasModule:m,intl:d,newActionIds:o,transaction:e,from:"action_menu",movedActionId:t.id})},userAction:"ActionContextMenu.moveAction"}),M()}}),[k,r,M,x,m,S,s,u,d,p,t,g]),D=(0,n.useMemo)((()=>{if(!j&&m&&g)return()=>{r.createAndCommit({perform:e=>{const o=L(x,S+1,S);T().reorderAutomationActions({environment:p,automationStore:s,automationTypecheckModule:g,contextType:u,formulasModule:m,intl:d,newActionIds:o,transaction:e,from:"action_menu",movedActionId:t.id})},userAction:"ActionContextMenu.moveAction"}),M()}}),[j,r,M,x,S,s,u,d,m,p,t,g]),O=(0,n.useMemo)((()=>{if(b&&C)return function(){v({initialState:{actionId:t.id,propertyId:C,type:"eventActionProperty"},insertionPoint:void 0})}}),[t.id,b,C]),N=(0,n.useMemo)((()=>{if(0!==I.length)return()=>{v({initialState:{availableActions:[],hasUpdateThisPagePropertyActions:!0,hasSearch:!0,type:"eventActions"},insertionPoint:{beforeActionId:t.id}})}}),[I.length,t.id]),U=(0,n.useMemo)((()=>{if(0!==I.length)return()=>{v({initialState:{availableActions:[],hasUpdateThisPagePropertyActions:!0,hasSearch:!0,type:"eventActions"},insertionPoint:{afterActionId:t.id}})}}),[I.length,t.id]),W=(0,a().VK)((()=>"define_variables"===t.getType()?{link:"https://www.notion.so/help/database-automations#database-automation-actions",label:R.learnAboutVariablesMenuItemLabel}:"http_request"===t.getType()?{link:"https://www.notion.so/help/webhook-actions",label:R.learnAboutWebhooksMenuItemLabel}:void 0),[t]);return(0,B.jsxs)(B.Fragment,{children:[!h&&(0,B.jsx)(F,{onAddStepAbove:N,onAddStepBelow:U,onDelete:E,onDuplicate:Z,onEdit:O,onMoveDown:D,onMoveUp:H,learnAbout:W}),h&&(0,B.jsx)(V().Z,{initialState:h.initialState,insertionPoint:h.insertionPoint,onClose:M})]})}function F(e){const{onAddStepAbove:t,onAddStepBelow:o,onDelete:i,onDuplicate:a,onEdit:c,onMoveDown:u,onMoveUp:p,learnAbout:y}=e,f=(0,I().F)();let T=!1;const w=function(e){const{hasSeparator:t,onEdit:o}=e,i=(0,n.useMemo)((()=>{if(o)return{action:o,key:"edit",render:e=>(0,B.jsx)(Z,{...e,icon:(0,j().R)({height:16,width:16}),children:(0,B.jsx)(l()._H,{...R.editMenuItemLabel})})}}),[o]),a=[i].filter(s().$K);if(0===a.length)return;return{items:a,key:"editActions",render:e=>(0,B.jsx)(h().Z,{enableActionSheetTitle:!0,topBorder:t,...e})}}({hasSeparator:T,onEdit:c});T||=Boolean(w);const A=function(e){const{hasSeparator:t,onMoveDown:o,onMoveUp:i}=e,a=(0,n.useMemo)((()=>{if(i)return{action:i,key:"moveUp",render:e=>(0,B.jsx)(Z,{...e,icon:(0,b().Z)({height:16,width:16}),children:(0,B.jsx)(l()._H,{...R.moveUpMenuItemLabel})})}}),[i]),r=(0,n.useMemo)((()=>{if(o)return{action:o,key:"moveDown",render:e=>(0,B.jsx)(Z,{...e,icon:(0,v().M)({height:16,width:16}),children:(0,B.jsx)(l()._H,{...R.moveDownMenuItemLabel})})}}),[o]),c=[a,r].filter(s().$K);if(0===c.length)return;return{items:c,key:"moveSteps",render:e=>(0,B.jsx)(h().Z,{enableActionSheetTitle:!0,topBorder:t,...e})}}({hasSeparator:T,onMoveDown:u,onMoveUp:p});T||=Boolean(A);const _=function(e){const{hasSeparator:t,onAddStepAbove:o,onAddStepBelow:i}=e,a=(0,n.useMemo)((()=>{if(o)return{action:o,key:"addStepAbove",render:e=>(0,B.jsx)(Z,{...e,icon:(0,S().M)({height:16,width:16}),children:(0,B.jsx)(l()._H,{...R.addStepAboveMenuItemLabel})})}}),[o]),r=(0,n.useMemo)((()=>{if(i)return{action:i,key:"addStepBelow",render:e=>(0,B.jsx)(Z,{...e,icon:(0,x().s)({height:16,width:16}),children:(0,B.jsx)(l()._H,{...R.addStepBelowMenuItemLabel})})}}),[i]),c=[a,r].filter(s().$K);if(0===c.length)return;return{items:c,key:"addSteps",render:e=>(0,B.jsx)(h().Z,{enableActionSheetTitle:!0,topBorder:t,...e})}}({hasSeparator:T,onAddStepAbove:t,onAddStepBelow:o});T||=Boolean(_);const P=function(e){const{hasSeparator:t,onDuplicate:o,onDelete:i}=e,[a,r]=(0,n.useState)(!1),c=(0,n.useMemo)((()=>{if(o)return{action:async()=>{r(!0);try{await o()}finally{r(!1)}},key:"duplicate",render:e=>(0,B.jsx)(Z,{...e,icon:(0,C().a)({height:16,width:16}),isLoading:a,children:a?(0,B.jsx)(l()._H,{...R.duplicatingMenuItemLabel}):(0,B.jsx)(l()._H,{...R.duplicateMenuItemLabel})})}}),[a,o]),u=(0,n.useMemo)((()=>{if(i)return{action:i,key:"delete",render:e=>(0,B.jsx)(Z,{...e,icon:(0,M().y)({height:16,width:16}),isRedOnHover:!0,children:(0,B.jsx)(l()._H,{...R.deleteMenuItemLabel})})}}),[i]),d=[c,u].filter(s().$K);if(0===d.length)return;return{items:d,key:"otherActions",render:e=>(0,B.jsx)(h().Z,{enableActionSheetTitle:!0,topBorder:t,...e})}}({hasSeparator:T,onDuplicate:a,onDelete:i});T||=Boolean(P);const V=function(e){const{hasSeparator:t,learnAbout:o}=e,n=(0,r().yK)((e=>({icon:{height:16,width:16,fill:e.mediumTextColor},textWrapper:{color:e.mediumTextColor}})),[]);if(!o)return;return{items:[{action:()=>{},key:"learnAbout",render:e=>(0,B.jsx)(Z,{...e,icon:(0,k().m)(n.icon),textWrapperStyle:n.textWrapper,children:(0,B.jsx)(d().Z,{href:o.link,external:!0,children:(0,B.jsx)(l()._H,{...o.label})})})}],key:"learnSteps",render:e=>(0,B.jsx)(h().Z,{topBorder:t,...e})}}({hasSeparator:T,learnAbout:y});return T||=Boolean(V),(0,B.jsx)(m().Z,{...f,children:(0,B.jsx)(g().Z,{type:g().i.Vertical,sections:[w,A,_,P,V].filter(s().$K),initialFocus:0})})}function Z(e){const{children:t,icon:o,isLoading:n,...i}=e,a=n?(0,B.jsx)(p().Z,{}):o;return(0,B.jsx)(u().Z,{...i,disabled:n,disabledFeedback:n,icon:a,title:t})}function L(e,t,o){if(t<0||t>=e.length||o<0||o>=e.length)return e;const n=[...e];return n[t]=e[o],n[o]=e[t],n}},590259:(e,t,o)=>{o.d(t,{z:()=>ze,Z:()=>Ge});var n=o(667294),i=()=>o(142735),a=()=>o(696459),r=()=>o(414108),l=(o(670560),o(122556),o(582845),o(250570),o(533019),o(721473),o(788208),o(22624),o(267602),o(653476),o(241792),o(731107),o.n(o(443261))),s=()=>o(219727),c=()=>o(846550),u=()=>o(271896),d=()=>o(779247),p=()=>o(922713),m=()=>o(259408),g=()=>o(788860),h=()=>o(513670),y=()=>o(285755),f=()=>o(827973),v=()=>o(198829),x=()=>o(255577),S=()=>o(603692),b=()=>o(989377),C=()=>o(388284),k=()=>o(654133),j=()=>o(594546),M=()=>o(487270),T=()=>o(527278),w=()=>o(677559);function A(){const e=(0,s().O7)();return(0,n.useMemo)((()=>(0,j().mc)(e)),[e])}var I=()=>o(696347),_=()=>o(356140),P=()=>o(998901),V=()=>o(876822),B=()=>o(965014),R=()=>o(815277),K=()=>o(49396),F=()=>o(637118),Z=()=>o(339352),L=()=>o(195245),E=()=>o(918745),H=()=>o(210968),D=(o(749411),()=>o(912203)),O=()=>o(740046),N=()=>o(270315),U=()=>o(749826),W=o(785893);function z(){return(0,c().yK)((e=>({chevronIcon:{marginInlineStart:6,width:12,height:"auto"}})),[])}function G(e){const{automationStore:t,collectionStore:o,searchInput:n}=e,i=new Set(t.getActionStores().flatMap((e=>e.isType("update_pages")?e.getConfigStore().getKeyStore("properties").getValue()??[]:[]))),r=o.getFormat(),s=o.getSchema(),c=(0,D().cO)({collectionFormat:r,collectionSchema:s,filter:e=>{let[t]=e;return!i.has(t)},spaceId:o.getSpaceId(),restrictCrossSpace:U().default.checkGate({gateName:"collections_xws"})}),u=new Map,d=c.map((e=>{const t=s[e];if(t){const o=`${t.name} ${N().SO[t.type]}`;return u.set(e,o),o}})).filter(a().$K),p=new Set(l().filter(n,d).map((e=>{let{original:t}=e;return t})));return c.filter((e=>{const t=u.get(e);return t&&p.has(t)}))}function $(e){const{onChange:t,value:o,placeholder:n}=e;return{items:[{action:()=>{},key:"search-input",render:e=>(0,W.jsx)(Y,{...e,onChange:t,value:o,placeholder:n})}],key:"search",render:e=>(0,W.jsx)(C().Z,{...e})}}const Y=(0,n.forwardRef)((function(e,t){const{onChange:o,value:n,placeholder:i,...a}=e,r=(0,g().YB)(),l=(0,c().yK)((()=>({input:{margin:0,padding:0}})),[]),{isMobile:u}=(0,s().Fy)();return(0,W.jsx)(O().ZP,{...a,focus:!u,inputOuterStyle:{margin:0},onChange:o,placeholder:r.formatMessage(i),ref:t,style:l.input,value:n})}));var q=()=>o(40696);const X=(0,g().vU)({searchInputPlaceholder:{id:"UpdateThisPagePropertiesActionMenu.searchInputPlaceholder ",defaultMessage:"Search for a property…"},editProperty:{id:"automationEventActionMenu.pagePropertiesEditedSection.title",defaultMessage:"Edit property"},backButtonAriaLabel:{id:"UpdateThisPagePropertiesActionMenu.backButtonAriaLabel",defaultMessage:"Back to previous step"}});function J(e){const{automationActionMenuStore:t,onClose:o}=e,{automationStore:a,contextType:r}=(0,F().YC)(),l=(0,Z().w)(a,r),[s,c]=(0,n.useState)(""),u=(0,i().VK)((()=>l&&a?G({automationStore:a,collectionStore:l,searchInput:s}):[]),[a,l,s]),d=(0,i().VK)((()=>null==l?void 0:l.getSchema()),[l]),p=(0,n.useMemo)((()=>{const e=[];e.push($({onChange:e=>c(e.target.value),value:s,placeholder:X.searchInputPlaceholder}));const o=d&&Q({automationActionMenuStore:t,propertyIds:u,normalizedBlockSchema:d,includeTitle:!1});return o&&e.push(o),e}),[t,u,d,s]),m=(0,q().F)({automationTriggerActionMenuStore:t,customMenuProps:{leftOuterStyle:{flexGrow:0},rightOuterStyle:{flexGrow:0},titleOuterStyle:{minWidth:0}},onClose:o,title:(0,W.jsx)("div",{style:{display:"inline-flex",minWidth:0,whiteSpace:"pre"},children:(0,W.jsx)(g()._H,{...X.editProperty})})});return(0,W.jsx)(v().Z,{...m,children:(0,W.jsx)(x().Z,{initialFocus:0,sections:p,type:x().i.Vertical})})}function Q(e){const{automationActionMenuStore:t,hasTopBorder:o,normalizedBlockSchema:n,propertyIds:i,includeTitle:r}=e,l=i.map((e=>{const o=n[e];if(o)return function(e){const{automationActionMenuStore:t,propertyId:o,propertySchema:n}=e;return{action:()=>{t.pushSettingsItem({actionId:void 0,propertyId:o,type:"eventActionProperty"})},key:`update_this_page_property_${o}_action`,render:e=>(0,W.jsx)(ee,{...e,propertySchema:n})}}({automationActionMenuStore:t,propertyId:e,propertySchema:o})})).filter(a().$K);if(0!==l.length)return{key:"automation_update_this_page_section",items:l,render:e=>(0,W.jsx)(C().Z,{...e,title:r?(0,W.jsx)(g()._H,{...X.editProperty}):void 0,topBorder:o})}}const ee=(0,n.forwardRef)((function(e,t){const{propertySchema:o,...n}=e,i=z();return(0,W.jsx)(f().Z,{...n,icon:(0,W.jsx)(te,{propertySchema:o}),ref:t,right:(0,I().o)(i.chevronIcon),title:o.name})}));function te(e){const{propertySchema:t}=e,n=(0,c().Fg)(),i=(0,c().yK)((e=>({icon:{fill:e.icon.secondary,width:12},iconWrap:{alignItems:"center",borderRadius:4,display:"flex",height:20,justifyContent:"center",width:20}})),[]);return(0,W.jsx)("div",{style:i.iconWrap,children:(0,W.jsx)(o(766933).ZP,{icon:t.icon,size:16,style:i.icon,theme:n,type:t.type})})}const oe=(0,g().vU)({searchInputPlaceholder:{id:"automationEventActionMenu.searchInputPlaceholder.label",defaultMessage:"Search actions…"},updateThisPagePropertiesMenuItemCaption:{defaultMessage:"Edit property…",id:"automationEventActionMenu.updateThisPagePropertiesMenuItem.caption"},upgrade:{defaultMessage:"Upgrade to Plus",id:"automationEventActionMenu.upsellFeatures.title"},disabledActionTooltipHeader:{defaultMessage:"Disabled in your workspace",id:"automationEventActionMenu.disabledActionTooltipHeader"},disabledActionTooltipBody:{defaultMessage:"Contact a workspace admin to modify this setting.",id:"automationEventActionMenu.disabledActionTooltipBody"}}),ne=["automation_actions","update_this_page_actions"],ie=["update_this_page_actions","automation_actions"];function ae(e){const{automationActionMenuStore:t,hasSearch:o,hasUpdateThisPagePropertyActions:r,onClose:b}=e,{isMobile:k}=(0,s().Fy)(),I=(0,s().O7)(),P=(0,g().YB)(),D=A(),{value:O}=(0,w().XJ)(y().Sm.automationActionRegistry),{automationStore:N,contextType:U}=(0,F().YC)(),{maybePersistedTransactionActions:z,onActionAdded:Y}=(0,L().i)(),q=(0,Z().w)(N,U),X=(0,H().p)(),J="event"===U,ee=(0,n.useMemo)((()=>J?ie:ne),[J]),te=(0,i().VK)((()=>t.getInsertionPoint()),[t]),[ae,le]=n.useState(""),se=(0,i().VK)((()=>o?function(e){const{automationActionRegistryModule:t,availableActions:o,searchInput:n}=e;if(!t||0===o.length)return[];const i=new Map,a=o.map((e=>{const t=T().Z.formatMessage(e.display.name);return i.set(e.type,t),t})),r=new Set(l().filter(n,a).map((e=>{let{original:t}=e;return t})));return o.filter((e=>{const t=i.get(e.type);return t&&r.has(t)}))}({automationActionRegistryModule:O,availableActions:X,searchInput:ae}):X),[X,o,ae,O]),ce=(0,i().VK)((()=>N.getActionStores().map((e=>e.getType())).filter(a().$K)),[N]),ue=(0,n.useCallback)((e=>{if(!N)return;const t=N.getSpaceId(),{performResult:o}=z.createAndCommit({userAction:"AutomationActionList.addAction",perform:o=>K().addAutomationAction({actionId:(0,M().TS)({environment:I,table:p().Xj,spaceId:t}),actionType:e,automationStore:N,environment:I,insertionPoint:te,intl:P,transaction:o,builderType:"modal"})});o&&((0,u().eI)(D,{automation_id:N.id,automation_action_id:o.id,automation_action_type:e,builder_type:"modal"}),null==Y||Y(o)),b()}),[N,z,b,I,te,P,D,Y]),pe=(0,i().VK)((()=>r&&q&&N?G({automationStore:N,collectionStore:q,searchInput:ae}):[]),[N,q,r,ae]),me=(0,i().VK)((()=>Boolean(r&&q&&N&&G({automationStore:N,collectionStore:q,searchInput:""}).length>0)),[N,q,r]),ge=(0,i().VK)((()=>null==q?void 0:q.getSchema()),[q]),he=(0,_().W)(),ye=(0,i().VK)((()=>{var e;return null===(e=V().default.state.currentUserStore)||void 0===e?void 0:e.getModel()}),[]),fe=(0,R().oo)({name:"premium_automations",spaceId:he,userId:null==ye?void 0:ye.id}),ve=function(e){let{onClose:t,upsell:o}=e;const i=(0,s().O7)();return(0,n.useCallback)((()=>{t(),o&&B().y(i,{from:"database_automation_modal_action_item",upsell:o})}),[i,t,o])}({onClose:b,upsell:null==fe?void 0:fe.upsell}),xe=(0,m()._e)(fe),Se=(0,c().yK)((e=>({unavailableHeader:{display:"inline-flex",minWidth:0,whiteSpace:"pre",cursor:"pointer",color:e.text.secondary},unavailableLinkIcon:{fill:e.icon.secondary}})),[]),be=(0,i().VK)((()=>{const e=[],n="button_block"===U||"button_property"===U,i=!n&&!xe,r=n&&!xe;o&&!i&&e.push($({onChange:e=>le(e.target.value),value:ae,placeholder:oe.searchInputPlaceholder}));const l=ee.reduce(((e,o)=>{if("automation_actions"===o)if(i||r){const[o,n]=h().uK(se,(e=>i?"slack_notification"===e.type:r?"send_gmail_notification"!==e.type&&"http_request"!==e.type:void 0)),l=re({key:"automation_actions_available_section",actionRegistryItems:o,hasTopBorder:e.length>0,onMenuItemClick:ue,automationActionMenuStore:t,shouldShowUpdateThisPageProperties:"button_property"===U}),s=re({key:"automation_actions_unavailable_section",actionRegistryItems:n,hasTopBorder:(0,a().$K)(l),hideChevron:!0,onMenuItemClick:ve,onClick:ve,automationActionMenuStore:t,shouldShowUpdateThisPageProperties:"event"===U,title:(0,W.jsxs)("div",{style:Se.unavailableHeader,onClick:ve,children:[(0,W.jsx)(g()._H,{...oe.upgrade}),(0,W.jsx)(S().y,{iconGroup:d().T,variantName:"small",style:Se.unavailableLinkIcon})]})});l&&e.push(l),s&&e.push(s)}else{const o=re({actionRegistryItems:se,hasTopBorder:e.length>0,onMenuItemClick:ue,automationActionMenuStore:t,shouldShowUpdateThisPageProperties:me&&"button_block"!==U&&(!ae||de(ae))});o&&e.push(o)}else if("update_this_page_actions"===o){const o=ge&&(xe||!J)&&ae.length>0&&Q({automationActionMenuStore:t,hasTopBorder:e.length>0,normalizedBlockSchema:ge,propertyIds:pe,includeTitle:!0});o&&e.push(o)}else(0,a().t1)(o);return e}),[]);return 0===l.length?e.push({key:"no_results_section",items:[{key:"no_results_item",action:()=>{},render:e=>(0,W.jsx)(f().Z,{...e,disabled:!0,disabledFeedback:!0,title:(0,W.jsx)(g()._H,{defaultMessage:"No results",id:"automations.automationEventActionMenu.noResultsItem"})})}],render:e=>(0,W.jsx)(C().Z,{...e})}):e.push(...l),e}),[t,xe,pe,se,ge,U,o,me,J,ue,ve,ae,ee,Se.unavailableHeader,Se.unavailableLinkIcon]);(0,n.useEffect)((()=>{(0,j().j)({environment:I,event:{eventName:"automation_action_menu_opened",eventProperties:{automation_id:N.id,automation_context_type:U,existing_action_types:ce,available_action_types:X.map((e=>e.type))}}})}),[X,U,ce,N,I]);let Ce=(0,E().F)({paddingBottom:6,paddingTop:6,width:266});return k||(Ce={...Ce,maxHeight:"50vh"}),(0,W.jsx)(v().Z,{...Ce,children:(0,W.jsx)(x().Z,{initialFocus:0,sections:be,type:x().i.Vertical})})}function re(e){const{actionRegistryItems:t,hasTopBorder:o,onMenuItemClick:n,onClick:i,automationActionMenuStore:r,shouldShowUpdateThisPageProperties:l,key:s,title:c,hideChevron:u}=e,d=h().oA([l?ce({hideChevron:u,onClick:()=>{(0,a().$K)(i)?i():r.pushSettingsItem({type:"updateThisPageProperties"})}}):void 0,...t.map((e=>function(e){const{actionRegistryItem:t,onClick:o}=e;return{action:()=>o(t.type),key:`${t.type}_action`,render:e=>(0,W.jsx)(le,{...e,actionRegistryItem:t})}}({actionRegistryItem:e,onClick:n})))]);if(0!==d.length)return{key:s||"automation_actions_section",items:d,render:e=>(0,W.jsx)(C().Z,{...e,topBorder:o,title:c})}}const le=(0,n.forwardRef)((function(e,t){const{actionRegistryItem:r,...l}=e,s=r.display,{automationStore:u,contextType:d}=(0,F().YC)(),p=(0,i().VK)((()=>(0,o(985575).uV)(u,d)),[u,d]),m=(0,_().W)(),h=(0,i().VK)((()=>{var e;return null===(e=V().default.state.currentUserStore)||void 0===e?void 0:e.getModel()}),[]),y=(0,R().VX)({name:"premium_automations",spaceId:m,userId:null==h?void 0:h.id}),v=(0,n.useMemo)((()=>{if(y)return!1;return"button_block"===d||"button_property"===d?"send_gmail_notification"===r.type||"http_request"===r.type:"slack_notification"!==r.type}),[r.type,d,y]),x=(0,i().VK)((()=>!!((0,a().$K)(r)&&(0,a().$K)(p)&&(0,a().$K)(r.isDisabledForContext))&&r.isDisabledForContext(p)),[r,p]),S=(0,c().yK)((e=>({row:{display:"grid",gridTemplateColumns:"auto auto auto",justifyContent:"flex-start",...(v||x)&&{color:e.text.tertiary,cursor:"default"}},badge:{...(v||x)&&{color:e.text.tertiary,backgroundColor:e.accentColors.translucentGray[75]}},tooltipHeader:{width:200},tooltipBody:{color:e.text.secondary}})),[x,v]),C=(0,n.useMemo)((()=>{switch(r.type){case"send_gmail_notification":return(0,W.jsx)(o(663631).Z,{style:S.badge});case"assistant_basic":return(0,W.jsx)(b().Z,{newBadgeKey:"assistant_basic",didUserEngage:!1,style:S.badge});case"http_request":return(0,W.jsx)(b().Z,{newBadgeKey:"http_request_automation_action",didUserEngage:!1,style:S.badge});case"define_variables":return(0,W.jsx)(b().Z,{newBadgeKey:"define_variables_automation_action",didUserEngage:!1,style:S.badge});default:return}}),[r.type,S.badge]);return s?(0,W.jsx)(k().Z,{textWrap:!0,placement:P().Placement.Right,alignment:P().Alignment.End,disableTooltip:!x,renderTooltip:()=>(0,W.jsxs)("div",{style:S.tooltipHeader,children:[(0,W.jsx)("div",{children:(0,W.jsx)(g()._H,{...oe.disabledActionTooltipHeader})}),(0,W.jsx)("div",{style:S.tooltipBody,children:(0,W.jsx)(g()._H,{...oe.disabledActionTooltipBody})})]}),render:e=>(0,W.jsx)(f().Z,{...l,...e,disabled:x,icon:(0,W.jsx)(se,{type:"actionRegistry",actionRegistryItem:r,disabled:x||v}),ref:t,right:C,title:(0,W.jsx)(g()._H,{...s.name}),style:S.row})}):null}));function se(e){const t="actionRegistry"===e.type&&"send_gmail_notification"===e.actionRegistryItem.type,o=(0,c().yK)((o=>({icon:{fill:e.disabled?o.text.tertiary:o.icon.secondary,height:"auto",width:16,opacity:t&&e.disabled?.4:1},iconWrap:{alignItems:"center",borderRadius:4,display:"flex",height:20,justifyContent:"center",width:20}})),[t,e.disabled]);return(0,W.jsx)("div",{style:o.iconWrap,children:"actionRegistry"===e.type?e.actionRegistryItem.display.icon(o.icon):"icon"===e.type?e.icon(o.icon):(0,a().t1)(e)})}function ce(e){const{onClick:t,hideChevron:o}=e;return{action:()=>t(),key:"update_this_page_properties",render:e=>(0,W.jsx)(ue,{...e,hideChevron:o})}}const ue=(0,n.forwardRef)((function(e,t){const{hideChevron:n}=e,a=z(),{contextType:r}=(0,F().YC)(),l=(0,_().W)(),s=(0,i().VK)((()=>{var e;return null===(e=V().default.state.currentUserStore)||void 0===e?void 0:e.getModel()}),[]),u=(0,R().VX)({name:"premium_automations",spaceId:l,userId:null==s?void 0:s.id}),d=(0,c().yK)((e=>({row:{...!u&&"event"===r&&{color:e.text.tertiary}}})),[r,u]);return(0,W.jsx)(f().Z,{...e,icon:(0,W.jsx)(se,{type:"icon",icon:o(453710).N}),ref:t,right:!n&&(0,I().o)(a.chevronIcon),title:(0,W.jsx)(g()._H,{...oe.updateThisPagePropertiesMenuItemCaption}),style:d.row})}));function de(e){const t=T().Z.formatMessage(oe.updateThisPagePropertiesMenuItemCaption);return l().test(e,t)}o(470928);var pe=()=>o(473304),me=()=>o(309968),ge=()=>o(721927),he=()=>o(226413),ye=()=>o(907874),fe=()=>o(955620),ve=()=>o(707513),xe=()=>o(636340),Se=()=>o(98235),be=()=>o(903098);const Ce=(0,g().vU)({menuHeaderTitle:{defaultMessage:"Set {propertyName} to",id:"automations.eventActionProperty.menuHeaderTitle"},menuHeaderEditTitle:{defaultMessage:"Edit {propertyName}",id:"automations.eventActionProperty.menuHeaderEditTitle"}});function ke(e){var t;const{actionId:o,automationActionMenuStore:r,onClose:l,propertyId:c}=e,{automationStore:d,contextType:m}=(0,F().YC)(),h=(0,Z().w)(d,m),{maybePersistedTransactionActions:y,onActionAdded:f}=(0,L().i)(),v=(0,g().YB)(),x=(0,s().O7)(),S=A(),b=(0,i().VK)((()=>r.getInsertionPoint()),[r]),C=(0,n.useMemo)((()=>h?{collectionStore:h,property:c,type:"collection"}:void 0),[h,c]),j=(0,i().VK)((()=>d.getSpaceId()),[d]),T=o??(0,M().TS)({environment:x,table:p().Xj,spaceId:j}),w=(0,i().VK)((()=>{const e=((null==d?void 0:d.getActionStores())??[]).find((e=>e.id===T));if(e&&e.isType("update_pages"))return e}),[d,T]),I=(0,i().VK)((()=>null==h?void 0:h.getSchema()[c]),[h,c]),_=(0,n.useMemo)((()=>{if(I&&(0,D().SF)(I))return D().Y_[I.type]}),[I]),V=(0,n.useMemo)((()=>!!I&&("multi_select"===I.type||(0,he().en)(I)&&1!==I.limit)),[I]),B=Boolean(I&&"button"!==I.type&&"rollup"!==I.type&&"formula"!==I.type&&"text"===(0,ge().vc)(I.type)),R=Boolean(I&&"button"!==I.type&&"rollup"!==I.type&&"formula"!==I.type&&"number"===(0,ge().vc)(I.type)),E=Boolean(I&&"date"===I.type),H=Boolean(I&&"status"===I.type),O=(0,i().VK)((()=>{if(h&&I)return(0,ye().setPropertyValueToSimpleFormulaReturnType)(h.getSpaceShardedPointer(),c,I)}),[h,I,c]),N=(0,i().VK)((()=>{if(w)return w.getConfigStore().getKeyStore("values").getKeyStore(c).getValue()}),[w,c]),[U,z]=(0,n.useState)(N),G=(0,n.useRef)({action:(null==N?void 0:N.action)||pe().z8,value:null==N?void 0:N.value}),$=(0,n.useMemo)((()=>{var e;return(0,ye().fromSimpleFormulaArrayValue)(null==U||null===(e=U.value)||void 0===e?void 0:e.value)}),[null==U||null===(t=U.value)||void 0===t?void 0:t.value]),Y=(0,be().z)({actionId:null==w?void 0:w.id}),X=(0,n.useCallback)((e=>{let{action:t,value:o}=e;if(!d)return;const{performResult:n}=y.createAndCommit({perform:e=>{if(!w)return K().addAutomationAction({actionId:T,actionType:"update_pages",automationStore:d,config:{properties:[c],target:{id:(0,me().Vl)(),type:"variable"},values:{[c]:{action:t,value:o}}},environment:x,intl:v,insertionPoint:b,transaction:e,builderType:"modal"});xe().sW({data:{[c]:{action:t,value:o}},store:w.getConfigStore().getKeyStore("values"),transaction:e})},userAction:"UpdateThisPagePropertyActionMenu.saveChanges"});n&&((0,u().eI)(S,{automation_id:d.id,automation_action_id:n.id,automation_action_type:"update_pages"}),null==f||f(n))}),[w,d,x,S,T,b,v,y,f,c]),J=(0,n.useCallback)((()=>{X(G.current),l()}),[X,l]),Q=(0,n.useCallback)(((e,t)=>{const o=t||pe().z8,n=G.current.value;G.current={value:e,action:o};if("formula"===(null==e?void 0:e.type))return void z({action:o,value:e});if("formula"===(null==n?void 0:n.type))z({action:o,value:e});else if(B||R||V||(0,a().$K)(t))z({action:o,value:e});else if(E){const t=(0,ye().fromSimpleFormulaArrayValue)(null==e?void 0:e.value)[0];if((0,a().$K)(t)&&(0,ye().isAnnotationSimpleValueToken)(t)&&(0,fe().fpG)(t))return void z({action:o,value:e});J()}}),[E,B,R,V,J]),ee="person"===(null==I?void 0:I.type)||"relation"===(null==I?void 0:I.type)||"multi_select"===(null==I?void 0:I.type),te=ee?Ce.menuHeaderEditTitle:Ce.menuHeaderTitle,oe=(0,q().F)({automationTriggerActionMenuStore:r,customMenuProps:{leftOuterStyle:{flexGrow:0},rightOuterStyle:{flexGrow:0},titleOuterStyle:{minWidth:0}},onClose:J,onDone:V||B||R||ee?J:void 0,title:(0,W.jsx)("div",{style:{display:"inline-flex",minWidth:0,whiteSpace:"pre"},children:v.formatMessage(te,{propertyName:(0,W.jsx)(k().Z,{placement:P().Placement.Bottom,render:e=>(0,W.jsx)("div",{...e,style:{...ve().Yu},children:(null==I?void 0:I.name)??""}),renderTooltip:()=>(null==I?void 0:I.name)??""})})})});return I&&O&&C?(0,W.jsx)(Se().a,{allowedFormulaReturnTypes:_,formulaValueContext:C,currentSimpleFormulaValueTokens:$,formulaTypecheckContextValues:Y,menuProps:oe,onChange:Q,onClose:J,parentRecordStore:d,showClearButton:!H,type:O,value:null==U?void 0:U.value,action:(0,pe().o9)(U),showReplaceAddRemoveToggle:ee}):null}var je=()=>o(714230),Me=()=>o(235484),Te=()=>o(525807),we=()=>o(855741),Ae=()=>o(388915),Ie=()=>o(92175),_e=()=>o(906651),Pe=()=>o(762300),Ve=()=>o(138912),Be=()=>o(826955);function Re(e){const{type:t,automationActionMenuStore:o,onClose:n}=e,a=Ee(),r=(0,i().VK)((()=>{var e;return null===(e=V().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),l=(0,i().VK)((()=>V().default.state.currentUserStore),[]),s="connectToSlackReconnect"===t?e.externalBotId:void 0,c=(0,i().VK)((()=>{if(void 0!==s&&l)return(0,Be().Kv)(l,{table:Te().PJ,id:s,spaceId:r}).getValue()}),[s,l,r]);let u,d=Le({viewType:"connectToSlackDefault"});if("connectToSlackReconnect"===t){if(!c)return null;const{accountName:e,organizationName:t}=(0,Pe().jg)(c);u=(0,Pe().jc)(c),d=Le({viewType:"connectToSlackReconnect",accountName:e,organizationName:t})}return(0,W.jsx)(q().Z,{type:"custom",automationTriggerActionMenuStore:o,onClose:n,children:(0,W.jsx)(C().Z,{children:(0,W.jsxs)("div",{style:a.container,children:[(0,W.jsx)(Fe,{}),(0,W.jsxs)("div",{style:a.connectToSlackBody,children:[(0,W.jsx)("div",{style:a.connectToSlackTitleText,children:Ze(t)}),(0,W.jsx)("div",{style:a.connectToSlackDescriptionText,children:d})]}),(0,W.jsx)(Ke,{...e,slackWorkspaceId:u})]})})})}function Ke(e){const{automationActionMenuStore:t,slackWorkspaceId:o}=e,n=(0,s().O7)(),r=Ee(),l=(0,i().VK)((()=>{var e;return null===(e=V().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),c=(0,i().VK)((()=>Ve().default.integrations.state.find((e=>e.id===Me().nO))),[]);return c&&l?(0,W.jsxs)("div",{style:r.buttonGroup,children:[(0,W.jsx)(_e().Z,{style:r.connectToSlackButton,isLarge:!0,onClick:async()=>{const i=await Ae().hM({environment:n,integration:c,spaceId:l,from:"collection_view_settings",options:{slackWorkspaceId:o}});we().x.isFail(i)?t.replaceSettingsItem({actionStore:e.actionStore,type:"selectWorkspace"}):"connectToSlackReconnect"===e.type||("connectToSlackDefault"===e.type?i.value.externalAuthentication?t.replaceSettingsItem({type:"selectChannelNew",currentExternalAuthentication:i.value.externalAuthentication,actionStore:e.actionStore}):t.replaceSettingsItem({actionStore:e.actionStore,type:"selectWorkspace"}):(0,a().t1)(e))},children:(0,W.jsx)(g()._H,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.connectButton.label",defaultMessage:"Connect"})}),(0,W.jsx)(Ie().Z,{style:r.cancelButton,isLarge:!0,onClick:()=>{t.popSettingsItem()},children:(0,W.jsx)(g()._H,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.cancelButton.label",defaultMessage:"Cancel"})})]}):null}function Fe(){const e=Ee();return(0,W.jsx)("div",{children:(0,W.jsx)("img",{src:je().Z.images.externalIntegrations.slackIconPng,style:e.slackIcon})})}function Ze(e){return"connectToSlackDefault"===e?(0,W.jsx)(g()._H,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.title",defaultMessage:"Connect to Slack"}):"connectToSlackReconnect"===e?(0,W.jsx)(g()._H,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.reconnect.title",defaultMessage:"Reconnect to Slack"}):void(0,a().t1)(e)}function Le(e){const{viewType:t}=e;return"connectToSlackDefault"===t?(0,W.jsx)(g()._H,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.description",defaultMessage:"Get notified in channels, see rich previews, and more."}):"connectToSlackReconnect"===t?(0,W.jsx)(g()._H,{id:"AutomationSlackConnectToSlackView.reconnect.description",defaultMessage:'Reconnect your Slack account ({accountName}) on {hasOrganizationName, select, true {"{organizationName}"} other {your Slack workspace}} to resume your notifications.',values:{accountName:e.accountName,hasOrganizationName:(0,a().$K)(e.organizationName),organizationName:e.organizationName}}):void(0,a().t1)(t)}function Ee(){return(0,c().yK)((e=>({container:{display:"flex",flexDirection:"column",margin:"10px 15px",justifyContent:"center",textAlign:"center"},connectToSlackBody:{margin:"0px 25px"},connectToSlackTitleText:{marginBottom:2,fontWeight:ve().Ue.semibold},connectToSlackDescriptionText:{fontSize:13,color:e.mediumTextColor},slackIcon:{width:23,height:"auto"},buttonGroup:{margin:"10px 10px 0px 10px"},connectToSlackButton:{width:"100%"},cancelButton:{color:e.mediumTextColor,width:"100%",justifyContent:"center",fontWeight:ve().Ue.medium,fontSize:13,marginTop:8}})),[])}var He=()=>o(953349);function De(e){const{actionStore:t,automationActionMenuStore:o,onClose:i}=e,{maybePersistedTransactionActions:r}=(0,L().i)(),l=n.useCallback(((e,o)=>{t&&r.createAndCommit({perform:n=>{xe().sW({data:{config:{external_bot_id:o,target:{id:e.id,name:"",type:e.type}}},store:t,transaction:n})},userAction:"SlackSelectChannelMenu.handleChannelSelect"}),i()}),[t,r,i]),s=(0,n.useCallback)((()=>{const e=o.getState().stack;e.length<2||("selectWorkspace"===e[e.length-2].type?o.popSettingsItem():o.replaceSettingsItem({actionStore:t,type:"selectWorkspace"}))}),[t,o]),c="selectChannelNew"===e.type?void 0:"selectChannelUpdate"===e.type?e.currentNotificationChannel:(0,a().t1)(e),u=(0,n.useMemo)((()=>c?[c]:void 0),[c]);return(0,W.jsx)(He().ZP,{currentExternalAuthentication:e.currentExternalAuthentication,currentNotificationChannels:u,onClose:i,onNotificationChannelSelect:l,onNewSlackAccountAdded:s,renderMenu:e=>(0,W.jsx)(q().Z,{type:"default",automationTriggerActionMenuStore:o,headerTitle:(0,W.jsx)(g()._H,{id:"notificationRuleSettings.selectChannelView.title",defaultMessage:"Select Slack channel"}),sections:e,onClose:i})})}var Oe=()=>o(270820);const Ne=(0,g().vU)({workspaceSearchPlaceholder:{id:"notificationRuleSettings.selectWorkspaceView.searchInput.placeholder",defaultMessage:"Search…"}});function Ue(e){const{onWorkspaceSelect:t,renderMenu:o,workspaceFilter:a,onNewSlackAccountAdded:r}=e,l=(0,s().O7)(),{isMobile:u}=(0,s().Fy)(),d=(0,i().VK)((()=>{var e;return null===(e=V().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),p=(0,i().VK)((()=>(0,Pe().P9)(Ve().default.completeSlackAuthentications.state,a)),[a]),m=(0,i().VK)((()=>Ve().default.integrations.state.find((e=>e.id===Me().nO))),[]),[h,y]=n.useState(""),v=(0,c().yK)((e=>({chevronRight:{width:12,height:"auto",color:e.lightIconColor}})),[]);if(!m)return null;const x=Object.entries((0,Pe().YJ)(p,h)).map(((e,o)=>{let[n,i]=e;return{key:n,items:i.map((e=>{let{workspaceName:o,externalAuthentication:n}=e;return{key:n.id,action:()=>{t(n)},render:e=>(0,W.jsx)(f().Z,{...e,title:o??(0,W.jsx)(g()._H,{id:"notificationRuleSettings.selectWorkspace.untitledWorkspace",defaultMessage:"Slack workspace"}),right:(0,I().o)(v.chevronRight)})}})),render:e=>(0,W.jsx)(C().Z,{...e,title:n,topBorder:0!==o})}}));return x.unshift({key:"search-input-section",items:[{key:"search-input-item",action:()=>{},render:e=>(0,W.jsx)("div",{children:(0,W.jsx)(O().ZP,{...e,inputLeft:(0,W.jsx)(O().f_,{icon:Oe().R}),showClearButton:!0,placeholder:T().Z.formatMessage(Ne.workspaceSearchPlaceholder),focus:!u||void 0,value:h,onChange:e=>{y(e.target.value)}})})}],render:e=>(0,W.jsx)(C().Z,{...e})}),x.push({key:"add-another-slack-account-section",items:[{key:"add-another-slack-account-item",action:async()=>{if(!d)return;const e=await Ae().hM({environment:l,integration:m,spaceId:d,from:"collection_view_settings"});we().x.isFail(e)||e.value.externalAuthentication&&(t(e.value.externalAuthentication),null==r||r())},render:e=>(0,W.jsx)(f().Z,{...e,icon:(0,W.jsx)("img",{src:je().Z.images.externalIntegrations.slackIconPng,style:{width:18,height:"auto"}}),title:(0,W.jsx)(g()._H,{id:"notificationRuleSettings.selectWorkspaceView.setupAnotherSlackAccount.label",defaultMessage:"Add another Slack account"})})}],render:e=>(0,W.jsx)(C().Z,{...e,topBorder:!0})}),(0,W.jsx)(W.Fragment,{children:o(x)})}function We(e){const{automationActionMenuStore:t,onClose:o}=e,i=n.useCallback((o=>{t.pushSettingsItem({actionStore:e.actionStore,type:"selectChannelNew",currentExternalAuthentication:o})}),[t,e.actionStore]);return(0,W.jsx)(Ue,{onWorkspaceSelect:i,renderMenu:e=>(0,W.jsx)(q().Z,{type:"default",automationTriggerActionMenuStore:t,headerTitle:(0,W.jsx)(g()._H,{id:"notificationRuleSettings.selectSlackWorkspace.title",defaultMessage:"Select Slack workspace"}),sections:e,onClose:o})})}const ze=(0,n.createContext)({menuStore:void 0});function Ge(e){const{initialState:t,insertionPoint:o,onClose:l}=e,s=(0,i().VK)((()=>{const e=new(r().H0);return e.setState({insertionPoint:o,stack:[t]}),e}),[t,o]),c=(0,i().VK)((()=>s.getCurrentTab()),[s]),u=(0,n.useCallback)((()=>null==l?void 0:l()),[l]);if(!c)return null;let d;if("connectToSlackDefault"===c.type)d=(0,W.jsx)(Re,{actionStore:c.actionStore,automationActionMenuStore:s,onClose:u,type:"connectToSlackDefault"});else if("connectToSlackReconnect"===c.type)d=(0,W.jsx)(Re,{actionStore:c.actionStore,automationActionMenuStore:s,externalBotId:c.externalBotId,notificationActionConfigStore:c.notificationActionConfigStore,onClose:u,type:"connectToSlackReconnect"});else if("selectWorkspace"===c.type)d=(0,W.jsx)(ze.Provider,{value:{menuStore:s},children:(0,W.jsx)(We,{actionStore:c.actionStore,automationActionMenuStore:s,onClose:u})});else if("selectChannelNew"===c.type)d=(0,W.jsx)(De,{actionStore:c.actionStore,automationActionMenuStore:s,currentExternalAuthentication:c.currentExternalAuthentication,onClose:u,type:"selectChannelNew"});else if("selectChannelUpdate"===c.type)d=(0,W.jsx)(De,{actionStore:c.actionStore,automationActionMenuStore:s,currentExternalAuthentication:c.currentExternalAuthentication,currentNotificationChannel:c.currentNotificationChannel,onClose:u,type:"selectChannelUpdate"});else if("eventActions"===c.type)d=(0,W.jsx)(ae,{automationActionMenuStore:s,hasUpdateThisPagePropertyActions:c.hasUpdateThisPagePropertyActions,hasSearch:c.hasSearch,onClose:u});else if("eventActionProperty"===c.type){const{propertyId:e,actionId:t}=c;d=(0,W.jsx)(ke,{actionId:t,automationActionMenuStore:s,onClose:u,propertyId:e})}else"updateThisPageProperties"===c.type?d=(0,W.jsx)(J,{automationActionMenuStore:s,onClose:u}):(0,a().t1)(c);return(0,W.jsx)(ze.Provider,{value:{menuStore:s},children:d})}ze.displayName="AutomationActionMenuContext"},592479:(e,t,o)=>{o.d(t,{eQ:()=>I,pZ:()=>V});o(267602),o(470928);var n=o(667294),i=()=>o(219727),a=()=>o(142735),r=()=>o(846550),l=()=>o(969583),s=()=>o(788860),c=()=>o(513670),u=()=>o(696459),d=()=>o(707513),p=()=>o(448419),m=()=>o(953349),g=()=>o(718959),h=()=>o(122479),y=()=>o(821149),f=()=>o(529048),v=()=>o(138912),x=()=>o(385010),S=()=>o(637118),b=()=>o(960597),C=()=>o(195245),k=()=>o(676279),j=()=>o(296227),M=()=>o(590259),T=()=>o(790819),w=()=>o(982614),A=o(785893);function I(e){const{actionStore:t}=e,{automationStore:o}=(0,S().YC)(),{disabled:i,suppressActionErrors:r}=(0,C().i)(),c=(0,l().getActionRegistryItem)("slack_notification"),u=Boolean(i),d=E(o)?(0,A.jsx)(b().So,{content:(0,A.jsx)(s()._H,{...b().Mm.slackNotificationAuthenticationError})}):null,p=(0,a().qz)(void 0,f().Z),m=(0,n.useCallback)((()=>p.reset()),[p]),g=(0,n.useMemo)((()=>(0,A.jsx)(j().e,{actionStore:t,closeMenu:m})),[t,m]),h=(0,n.useMemo)((()=>!r.includes(t.id)),[r,t]),{errorMessage:y}=(0,b().TU)({actionId:t.id,errorKey:"external_bot_id",shouldShow:h}),{errorMessage:v}=(0,b().TU)({actionId:t.id,errorKey:"target",shouldShow:h});return(0,A.jsx)(w().Ao,{actionMenu:g,buttonPopupStore:p,disabled:u,actionId:t.id,canCollapse:!1,children:(0,A.jsx)(w().vu,{actionId:t.id,actionRegistryItem:c,disabled:u,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"flex",flexWrap:"wrap",gap:4}},children:(0,A.jsx)(_,{actionStore:t,automationStore:o,disabled:u,errorMessage:d??y??v})})})}function _(e){const{actionStore:t,automationStore:o,disabled:n,errorMessage:i}=e;return(0,A.jsx)(s()._H,{defaultMessage:"Notify{slackTargetPicker}",id:"automations.slackNotificationAction.action.title",values:{slackTargetPicker:(0,A.jsx)(P,{actionStore:t,automationStore:o,disabled:n,errorMessage:i})}})}function P(e){const{actionStore:t,automationStore:o,disabled:i,errorMessage:r}=e,l=(0,a().VK)((()=>{const e=t.getConfigStore(),o=e.getKeyStore("external_bot_id").getValue();if((0,c().xb)(o))return!1;const n=e.getKeyStore("target").getValue();return!(0,c().xb)(null==n?void 0:n.id)}),[t]),d=(0,a().qz)(void 0,f().Z),m=(0,n.useCallback)((()=>d.reset()),[d]),g=function(e){const{actionStore:t,automationStore:o}=e,[n,i]=(0,a().VK)((()=>{const e=t.getConfigStore();return[e.getKeyStore("target").getValue(),e.getKeyStore("external_bot_id").getValue()]}),[t]),r=E(o),l=L(t),s=(0,a().VK)((()=>v().default.completeSlackAuthentications.state.length??0),[]);if((0,u().$K)(n)&&(0,u().$K)(i))return r?{actionStore:t,externalBotId:i,notificationActionConfigStore:t,type:"connectToSlackReconnect"}:(0,u().$K)(l)?{actionStore:t,currentExternalAuthentication:l,currentNotificationChannel:n,type:"selectChannelUpdate"}:{actionStore:t,type:"connectToSlackDefault"};return 0===s?{actionStore:t,type:"connectToSlackDefault"}:s>1?{actionStore:t,type:"selectWorkspace"}:{actionStore:t,type:"selectChannelNew"}}({actionStore:t,automationStore:o}),h=(0,k().d)();return(0,A.jsx)(p().ZP,{alignmentToOrigin:p().vR.End,buttonPopupStore:d,disabled:i,originGap:0,placementToOrigin:p().pO.Bottom,popupType:h,renderOrigin:e=>(0,A.jsx)(T().S,{...e,disabled:i,isCompact:!0,isError:Boolean(r),hasActionRequired:!l,dropdownButtonType:"dropdown",children:l?(0,A.jsx)(V,{actionStore:t}):(0,A.jsx)(s()._H,{id:"slackNotificationAction.targetPicker.noTarget",defaultMessage:"Select Slack channel"})}),render:()=>(0,A.jsx)(M().Z,{initialState:g,onClose:m})})}function V(e){const{actionStore:t}=e,o=(0,i().O7)(),r=(0,a().VK)((()=>{const e=(0,g().RM)();return!(0,u().$K)(e)||Boolean((0,h().IJ)(o,e))}),[o]),l=function(e){const t=(0,i().O7)(),o=(0,a().VK)((()=>{var t;return null===(t=e.getConfig())||void 0===t||null===(t=t.target)||void 0===t?void 0:t.id}),[e]),r=L(e);return n.useEffect((()=>{r&&(0,m().uV)({environment:t,spaceId:r.space_id,externalAuthConfig:{type:"external",botId:r.id}})}),[t,r]),(0,a().VK)((()=>{if(r&&o){const e=x().l.getStateForBot({type:"external",botId:r.id}).channels[o];if(e)return e}}),[o,r])}(t);return L(t)?r||!(0,u().$K)(l)?(0,A.jsx)(F,{}):"me"===l.type?(0,A.jsx)(K,{channelName:l.name}):"private"===l.type?(0,A.jsx)(R,{channelName:l.name}):"public"===l.type?(0,A.jsx)(B,{channelName:l.name}):void(0,u().t1)(l.type):(0,A.jsx)(Z,{})}function B(e){return(0,A.jsx)("span",{style:d().Yu,children:`#${e.channelName}`})}function R(e){const{channelName:t}=e,o=H();return(0,A.jsxs)("div",{style:o.container,children:[(0,y().b)(o.lockIcon),(0,A.jsx)("span",{style:d().Yu,children:t})]})}function K(e){const{channelName:t}=e;return(0,A.jsx)("span",{style:d().Yu,children:`@${t}`})}function F(){const e=H();return(0,A.jsxs)("div",{style:e.container,children:[(0,y().b)(e.lockIcon),(0,A.jsx)("span",{style:d().Yu,children:(0,A.jsx)(s()._H,{defaultMessage:"Hidden channel",id:"slackNotificationAction.slackTargetChannel.hiddenName"})})]})}function Z(){const e=H();return(0,A.jsx)("div",{style:e.container,children:(0,A.jsx)("span",{style:d().Yu,children:(0,A.jsx)(s()._H,{defaultMessage:"Invalid channel",id:"slackNotificationAction.slackTargetChannel.invalidChannel"})})})}function L(e){return(0,a().VK)((()=>{const t=e.getConfigStore().getKeyStore("external_bot_id").getValue();if(t)return v().default.completeSlackAuthentications.state.find((e=>t===e.id))}),[e])}function E(e){return(0,a().VK)((()=>"disabled_auth"===e.getStatus()),[e])}function H(){const{isMobile:e}=(0,i().Fy)(),t=e?d().JB.UISmall.mobile:d().JB.UISmall.desktop;return(0,r().yK)((()=>({container:{alignItems:"baseline",display:"inline-flex",gap:2,minWidth:50,width:"100%"},lockIcon:{alignSelf:"center",height:"auto",width:t}})),[t])}},502550:(e,t,o)=>{o.d(t,{B:()=>je,r:()=>Me});var n=o(667294),i=()=>o(142735),a=()=>o(177634),r=()=>o(637118),l=(o(821057),o(267602),o(653476),()=>o(219727)),s=()=>o(846550),c=()=>o(969583),u=()=>o(752348),d=()=>o(455947),p=()=>o(892981),m=()=>o(38883),g=()=>o(788860),h=()=>o(696459),y=()=>o(707513),f=()=>o(636340),v=()=>o(269299),x=()=>o(360240),S=()=>o(448419),b=()=>o(384241),C=()=>o(772265),k=()=>o(594546),j=()=>o(867601),M=()=>o(466970),T=()=>o(529048),w=()=>o(826955),A=()=>o(960597),I=()=>o(309841),_=()=>o(195245),P=()=>o(903098),V=()=>o(676279),B=()=>o(296227),R=()=>o(883293),K=()=>o(790819),F=()=>o(311419),Z=()=>o(982614),L=()=>o(446955),E=()=>o(347558),H=()=>o(384547),D=()=>o(198829),O=()=>o(388284),N=()=>o(125659),U=()=>o(918745),W=o(785893);function z(e){const{filter:t,onChange:o,onClose:a,collectionStore:r}=e,l=(0,N().DK)(),s=(0,i().VK)((()=>r.getSchema()),[r]),c=(0,U().F)({minWidth:300,tabletBehavior:"actionSheet"}),u=(0,n.useCallback)(((e,t)=>o(t)),[o]),p=(0,n.useCallback)((()=>{o(void 0),a()}),[o,a]);return(0,W.jsxs)(D().Z,{...c,children:[(0,W.jsx)(H().D,{children:(0,W.jsx)(E().Pq,{collectionViewId:"Automation.FilterMenu",collectionContextStore:l,collectionViewType:"table",combinatorFilter:t||d().hh,index:0,level:0,onChange:u,parentStore:r,schema:s})}),(0,W.jsx)(O().Z,{topBorder:!0,children:(0,W.jsx)(L().Z,{title:(0,W.jsx)(g()._H,{defaultMessage:"Delete filter",id:"automations.AutomationCombinatorFilterPopup.deleteFilter.label"}),onClick:p})})]})}const G=(0,g().vU)({multipleTargetsFilter:{defaultMessage:"<span>Edit </span>{filterPicker}",id:"automations.UpdatePagesAction.multipleTargetsFilter"},multipleTargetsPicker:{defaultMessage:"<span>in </span>{targetPicker}",id:"automations.UpdatePagesAction.multipleTargetsPicker"},singleTarget:{defaultMessage:"<span>Edit </span>{targetPicker}",id:"automations.UpdatePagesAction.singleTarget"}});function $(e){const{actionStore:t}=e,o=(0,l().O7)(),{automationStore:a,typecheckResult:s}=(0,r().YC)(),{disabled:d,suppressActionErrors:m}=(0,_().i)(),y=(0,M().E)("automation_updated_error_states"),x=(0,i().VK)((()=>t.getTargetStore()),[t]),S=(0,i().VK)((()=>Q(t,(0,u().getAllContextValues)(s))),[t,s]),b=(0,i().VK)((()=>{var e;const o=t.getCollectionTargetStore(),n=null==o||null===(e=o.getKeyStore("filter"))||void 0===e?void 0:e.getValue();if(n)return(0,p().Ih)(n,(null==S?void 0:S.getSchema())||{})}),[t,S]),C=(0,i().VK)((()=>{const e=t.getVariableTargetStore();if(e)return e.getValue();const o=t.getCollectionTargetStore();if(o){const e=o.getKeyStore("collection").getValue();if(e)return{collection:e,type:"collection"}}}),[t]),k=(0,i().VK)((()=>{if(!C||"variable"!==C.type)return!1;const e=(0,u().getContextValueForActionById)(s,t.id,C.id),o=null==e?void 0:e.type;return!!o&&("block"===o.type||"array"===o.type&&"block"===o.of.type)}),[t.id,C,s]),w=(0,i().qz)(void 0,T().Z),P=(0,n.useCallback)((()=>w.reset()),[w]),V=(0,n.useMemo)((()=>(0,W.jsx)(B().e,{actionStore:t,closeMenu:P})),[t,P]),K=(0,n.useMemo)((()=>!m.includes(t.id)),[m,t]),F=(0,i().VK)((()=>{if(S&&y)return K&&!(0,j().JO)({actionStore:t,collectionStore:S,typecheckResult:s})?(0,W.jsx)(g()._H,{...A().Mm.actionIncompleteErrorMessage}):void 0}),[t,S,y,K,s]),{errorMessage:L,errorIcon:E}=(0,A().TU)({actionId:t.id,shouldShow:K,errorKeys:["target","collection","block"]}),{errorMessage:H,errorIcon:D}=(0,A().TU)({actionId:t.id,errorKey:"filter",shouldShow:K}),O=(0,i().VK)((()=>(0,h().$K)(t.getConfigStore().getKeyStore("target").getValue())),[t]),N=(0,n.useCallback)((e=>{v().createAndCommit({userAction:"UpdatePagesAction.filterChange",environment:o,canUndo:!0,perform:t=>{f().sW({data:{filter:e},store:x,transaction:t})}}),(0,I().yE)(o,{automationStore:a,automationActionStore:t})}),[t,a,o,x]),U=(0,n.useCallback)((e=>{let n;if("collection"===e.type)n="UpdatePageAction.updateCollection";else if("variable"===e.type)n="UpdatePageAction.updateVariable";else{if("page"===e.type||"property"===e.type||"formula"===e.type||"url"===e.type)throw new Error("Not implemented yet.");(0,h().t1)(e)}v().createAndCommit({userAction:n,environment:o,canUndo:!0,perform:o=>{f().sW({data:{properties:null,target:e,values:null},store:t.getConfigStore(),transaction:o})}}),(0,I().yE)(o,{automationStore:a,automationActionStore:t})}),[o,a,t]),z=Boolean(d),G=(0,c().getActionRegistryItem)("update_pages");return(0,W.jsxs)(Z().Ao,{actionMenu:V,buttonPopupStore:w,disabled:z,actionId:t.id,canCollapse:O,children:[(0,W.jsx)(Z().vu,{actionId:t.id,actionRegistryItem:G,disabled:z,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"grid",gridTemplateColumns:"auto 1fr"}},errorMessage:y?L||H||F:void 0,children:k||!S?(0,W.jsx)(Y,{actionStore:t,disabled:z,errorMessage:L,errorIcon:E,onTargetChange:U,value:C}):(0,W.jsx)(q,{actionStore:t,collectionStore:S,disabled:z,errorMessage:L,errorIcon:E,filterErrorIcon:D,filterErrorMessage:H,filter:b,onFilterChange:N,onTargetChange:U,value:C})}),S&&(0,W.jsx)(Z().R7,{disabled:z,styles:{bodyWrap:{display:"grid",gap:8,gridTemplateColumns:"1fr",minWidth:0}},children:(0,W.jsx)(R().QF,{actionStore:t,collectionStore:S,disabled:z,showSetPropertyActions:!0})})]})}function Y(e){const{actionStore:t,disabled:o,errorMessage:n,onTargetChange:i,value:a,errorIcon:r}=e,l=(0,M().E)("automation_updated_error_states"),c=(0,s().yK)((()=>({b:{fontWeight:y().Ue.medium},picker:{display:"inline-flex",minWidth:50},span:{flex:0,display:"flex",alignItems:"center"},title:{display:"inline-flex",minWidth:50,gap:6}})),[]);return(0,W.jsx)("div",{style:c.title,children:(0,W.jsx)(g()._H,{...G.singleTarget,values:{b:e=>(0,W.jsx)("b",{style:c.b,children:e}),targetPicker:(0,W.jsx)(J,{actionStore:t,disabled:o,errorMessage:n,errorIcon:l?r:void 0,onChange:i,value:a}),span:e=>(0,W.jsx)("span",{style:c.span,children:e})}})})}function q(e){const{actionStore:t,collectionStore:o,disabled:n,errorMessage:i,errorIcon:a,filterErrorMessage:r,filterErrorIcon:l,filter:c,onFilterChange:u,onTargetChange:d,value:p}=e,m=(0,s().yK)((()=>({b:{fontWeight:y().Ue.medium},picker:{display:"inline-flex",minWidth:50},span:{flex:0,display:"flex",alignItems:"center"},title:{display:"inline-flex",minWidth:50,gap:6}})),[]);return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)("div",{style:m.title,children:[(0,W.jsx)(g()._H,{...G.multipleTargetsFilter,values:{filterPicker:(0,W.jsx)(X,{collectionStore:o,disabled:n,errorMessage:r,errorIcon:l,filter:c,onChange:u}),span:e=>(0,W.jsx)("span",{style:m.span,children:e})}})," "]}),(0,W.jsx)("div",{style:m.title,children:(0,W.jsx)(g()._H,{...G.multipleTargetsPicker,values:{targetPicker:(0,W.jsx)(J,{actionStore:t,disabled:n,errorMessage:i,errorIcon:a,onChange:d,value:p}),span:e=>(0,W.jsx)("span",{style:m.span,children:e})}})})]})}function X(e){var t;const{collectionStore:o,disabled:a,errorMessage:r,filter:l,onChange:s,errorIcon:c}=e,u=(0,i().qz)(void 0,T().Z),p=(0,V().d)({tabletBehavior:"slideUp"}),m=(0,n.useCallback)((()=>u.reset()),[u]),h=(0,i().VK)((()=>{const e=o.getModel(),t=null==e?void 0:e.getDatabaseType();return(0,x().Q_)(t)}),[o]),y=(null==l||null===(t=l.filters)||void 0===t?void 0:t.length)||0;return(0,W.jsx)(S().ZP,{alignmentToOrigin:S().vR.Center,disabled:a,originGap:0,placementToOrigin:S().pO.Bottom,popupType:p,renderOrigin:e=>(0,W.jsx)(K().S,{...e,disabled:a,isCompact:!0,errorIcon:c,onClick:t=>{e.onClick(t),0===y&&s(d().TI)},dropdownButtonType:"dropdown",isError:Boolean(r),tooltipMessage:r,children:y>0?(0,W.jsx)(g()._H,{defaultMessage:"{itemType} that match {ruleCount, plural, one {{ruleCount} filter} other {{ruleCount} filters}}",id:"automations.UpdatePagesAction.FilterPicker.withRules",values:{itemType:h,ruleCount:y}}):(0,W.jsx)(g()._H,{defaultMessage:"all {itemType}",id:"automations.UpdatePagesAction.FilterPicker.noRules",values:{itemType:h}})}),render:()=>(0,W.jsx)(z,{collectionStore:o,disabled:a,filter:l,onChange:s,onClose:m})})}function J(e){const{actionStore:t,disabled:o,errorMessage:a,onChange:s,value:c,errorIcon:d}=e,p=(0,l().O7)(),{automationStore:y,typecheckResult:f}=(0,r().YC)(),v=(0,P().z)({actionId:t.id}),x=(0,i().VK)((()=>{if("collection"===(null==c?void 0:c.type))return w().NW.createChildStore(t,c.collection)}),[t,c]),j=(0,i().VK)((()=>{if(f&&c&&"variable"===c.type)return(0,u().getContextValueForActionById)(f,t.id,c.id)}),[f,c,t.id]),A=(0,i().qz)(void 0,T().Z),_=(0,V().d)(),B=(0,n.useCallback)((()=>A.reset()),[A]),R=(0,n.useCallback)((e=>{s(e),B(),(0,I().GV)(((o,n,i)=>{const a=(0,I().TI)({automationActionStore:t,formulasModule:o,formulaAnalyticsModule:n,simpleFormulasModule:i});(0,h().$K)(a)&&(0,k().j)({environment:p,event:{eventName:"automation_target_pick",eventProperties:{automation_action:a,automation_id:t.getParentId(),target_type:e.type}}})}))}),[s,B,t,p]),Z=(0,M().E)("automation_updated_error_states");return(0,W.jsx)(S().ZP,{buttonPopupStore:A,popupType:_,alignmentToOrigin:S().vR.Center,placementToOrigin:S().pO.Bottom,originGap:0,disabled:o,renderOrigin:e=>(0,W.jsx)(K().S,{...e,disabled:o,isCompact:!0,isError:Boolean(a),tooltipMessage:!Z&&a,errorIcon:d,hasActionRequired:!Boolean(c||j),dropdownButtonType:"dropdown",children:(0,h().$K)(x)?(0,W.jsx)(b().Z,{store:x,style:{paddingBlock:1}}):j?(0,W.jsx)(C().F,{format:m().lo.Medium,isSingle:!0,value:j,style:{background:"transparent",color:"unset",margin:"-1.5px 0",padding:0}}):(0,W.jsx)(g()._H,{id:"automations.UpdatePagesAction.pagesDropdown.label",defaultMessage:"Select database"})}),render:e=>(0,W.jsx)(F().L,{formulaTypecheckContextValues:v,onChange:R,onClose:B,parentRecordStore:y,selectedTarget:c,skipPages:!0})})}function Q(e,t){const o=e.getTargetStore().getValue();if(o){if("collection"===o.type)return w().NW.createChildStore(e,o.collection);if("variable"===o.type){if(!t)return;const n=(0,a().vx)(t,o.id);if(n)return(0,j().wB)(n,e)}else{if("page"===o.type)return;(0,h().t1)(o)}}}var ee=()=>o(912203),te=()=>o(473304),oe=()=>o(226413),ne=()=>o(590259),ie=()=>o(374784),ae=()=>o(49952),re=()=>o(152557);function le(e){const{actionMenu:t,buttonPopupStore:o,disabled:n,onClick:i,propertySchema:a}=e,r=(0,s().yK)((e=>({icon:{fill:e.text.uiRedPrimary},propertyType:{color:e.accentColors.red[700]}})),[]),l=function(e){const{propertySchema:t,styles:o}=e,n=t.name;return(0,W.jsx)(g()._H,{defaultMessage:"{propertyName} is a cross-workspace relation",id:"updateThisPageCrossSpaceRelationAction.crossSpaceRelation.title",values:{propertyName:(0,W.jsx)("span",{style:o.propertyType,children:n})}})}({propertySchema:a,styles:r}),c=function(e){const{propertySchema:t}=e,o=t.name;return(0,W.jsx)(g()._H,{defaultMessage:"{propertyName} is a cross-workspace relation. Cross-workspace features are restricted in automations and will not work.",id:"updateThisPageCrossSpaceRelationAction.crossSpaceRelation.text",values:{propertyName:o}})}({propertySchema:a});return(0,W.jsx)(re().gq,{actionMenu:t,buttonPopupStore:o,disabled:n,onClick:i,propertyType:a.type,styles:r,tooltip:c,children:l})}function se(e){const{actionId:t,renderOrigin:o}=e,a=(0,V().d)(),r=(0,i().qz)(void 0,T().Z),l=(0,n.useCallback)((()=>r.reset()),[r]);return(0,W.jsx)(S().ZP,{buttonPopupStore:r,popupType:a,render:()=>(0,W.jsx)(ae().qO,{actionId:t,closeMenu:l}),renderOrigin:o})}var ce=()=>o(839886),ue=()=>o(957250),de=()=>o(859127),pe=(o(241792),()=>o(563701)),me=()=>o(116291),ge=()=>o(239869);function he(e){const{action:t,actionMenu:o,buttonPopupStore:i,disabled:a,onClick:l,propertySchema:s,value:c}=e,{automationStore:d,typecheckResult:p}=(0,r().YC)(),m=(0,n.useMemo)((()=>(0,u().getAllContextValues)(p)),[p]),{title:g,tooltipTitle:h,styles:y}=(0,me().TY)({getRecordModel:d.getRecordModel,contextValues:m,messageType:"action",operator:t,propertySchema:s,value:c}),f=(0,n.useCallback)((e=>(0,W.jsx)(Z().YG,{...e,actionMenu:o,buttonPopupStore:i,disabled:a,icon:pe().O,onClick:l,children:(0,W.jsx)("div",{style:y.content,children:g})})),[o,i,a,l,y.content,g]);return(0,W.jsx)(ge().y,{renderOrigin:f,title:h})}var ye=()=>o(848854),fe=()=>o(317632);function ve(e){const{action:t,actionMenu:o,automationActionStore:i,buttonPopupStore:a,collectionStore:r,disabled:l,onClick:s,propertySchema:c,value:u}=e,d=(0,P().z)({actionId:i.id}),{tooltipTitle:p,title:m}=(0,fe().lr)({automationContextValues:d,collectionStore:r,messageType:"action",operator:t,propertySchema:c,value:u}),g=(0,n.useCallback)((e=>(0,W.jsx)(Z().YG,{...e,actionMenu:o,buttonPopupStore:a,disabled:l,icon:ye().v,onClick:s,children:m})),[o,a,l,s,m]);return(0,W.jsx)(ge().y,{renderOrigin:g,title:p})}var xe=()=>o(282895),Se=()=>o(395137),be=()=>o(96754);function Ce(e){var t;const{actionStore:o}=e,{disabled:a}=(0,_().i)(),[r,l]=(0,i().VK)((()=>[o.id,o.getConfig()]),[o]),s=(0,P().z)({actionId:r}),c=(0,i().VK)((()=>Q(o,s)),[o,s]),u=(0,i().VK)((()=>null==c?void 0:c.getSchema()),[c]),d=(0,i().VK)((()=>null==c?void 0:c.getDeletedSchema()),[c]),p=(0,i().qz)(void 0,T().Z),m=(0,n.useCallback)((()=>p.reset()),[p]),g=(0,n.useMemo)((()=>(0,W.jsx)(B().e,{actionStore:o,closeMenu:m})),[o,m]),h=(0,M().E)("collections_xws"),y=((null==l?void 0:l.properties)??[])[0],f=null==u?void 0:u[y],v=null==d?void 0:d[y],x=null==l||null===(t=l.values)||void 0===t?void 0:t[y],S=Boolean(a),b={automationActionStore:o,actionMenu:g,buttonPopupStore:p,disabled:S,value:null==x?void 0:x.value};return!f&&v?(0,W.jsx)(ue().RN,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,W.jsx)(ue().rV,{...e,...b,propertySchema:v})}):f||v?f&&c?(0,ee().SF)(f)?"person"===f.type?(0,W.jsx)(ke,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,W.jsx)(he,{...e,...b,propertySchema:f,action:(0,te().o9)(x)})}):"status"===f.type?(0,W.jsx)(ke,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,W.jsx)(Se().yr,{...e,...b,propertySchema:f})}):"select"===f.type?(0,W.jsx)(ke,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,W.jsx)(xe().D9,{...e,...b,propertySchema:f})}):"multi_select"===f.type?(0,W.jsx)(ke,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,W.jsx)(de().m,{...e,...b,propertySchema:f,action:(0,te().o9)(x)})}):"date"===f.type?(0,W.jsx)(ke,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,W.jsx)(ce().e,{...e,...b,propertySchema:f,valueContext:{collectionStore:c,property:y,type:"collection"}})}):"relation"===f.type&&h&&(0,oe().Qh)(c.pointer.spaceId,f)?(0,W.jsx)(se,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,W.jsx)(le,{...e,...b,propertySchema:f})}):"relation"===f.type?(0,W.jsx)(ke,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,W.jsx)(ve,{...e,...b,collectionStore:c,propertySchema:f,action:(0,te().o9)(x)})}):"checkbox"===f.type?(0,W.jsx)(ke,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,W.jsx)(ie().Q2,{...e,...b,propertySchema:f})}):"title"===f.type?(0,W.jsx)(ke,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,W.jsx)(be().QQ,{...e,...b,propertySchema:f})}):"text"===f.type?(0,W.jsx)(ke,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,W.jsx)(be().Vk,{...e,...b,propertySchema:f})}):"email"===f.type?(0,W.jsx)(ke,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,W.jsx)(be().Kh,{...e,...b,propertySchema:f})}):"url"===f.type?(0,W.jsx)(ke,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,W.jsx)(be().GJ,{...e,...b,propertySchema:f})}):"number"===f.type?(0,W.jsx)(ke,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,W.jsx)(be().go,{...e,...b,propertySchema:f})}):"phone_number"===f.type?(0,W.jsx)(ke,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,W.jsx)(be().gi,{...e,...b,propertySchema:f})}):null:(0,W.jsx)(re().l6,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,W.jsx)(re().OZ,{...e,...b,propertySchema:f})}):null:(0,W.jsx)(ue().RN,{actionId:o.id,renderOrigin:e=>(0,W.jsx)(ue().PO,{...e,...b})})}function ke(e){const{actionId:t,propertyId:o,renderOrigin:a}=e,r=(0,V().d)(),l=(0,i().qz)(void 0,T().Z),s=(0,n.useCallback)((()=>l.reset()),[l]),c=(0,n.useMemo)((()=>({actionId:t,propertyId:o,type:"eventActionProperty"})),[t,o]);return(0,W.jsx)(S().ZP,{buttonPopupStore:l,popupType:r,render:()=>(0,W.jsx)(ne().Z,{initialState:c,onClose:s}),renderOrigin:a})}function je(e){const{actionStore:t}=e,{contextType:o}=(0,r().DZ)();return(0,i().VK)((()=>Me(o,t)),[t,o])?(0,W.jsx)(Ce,{...e}):(0,W.jsx)($,{...e})}function Me(e,t){var o;if(!t.isType("update_pages"))return!1;const n=t.getConfig(),i="variable"===(null==n||null===(o=n.target)||void 0===o?void 0:o.type)?(0,a().MY)(n.target.id):void 0;return"event"===e&&i&&"global"===i.source&&"button_page"===i.global}},374784:(e,t,o)=>{o.d(t,{G7:()=>v,Q2:()=>f});var n=o(667294),i=()=>o(846550),a=()=>o(907874),r=()=>o(788860),l=()=>o(707513),s=()=>o(972350),c=()=>o(231750),u=()=>o(282628),d=()=>o(850505),p=()=>o(361726),m=()=>o(239869),g=()=>o(982614),h=()=>o(415764),y=o(785893);function f(e){const{actionMenu:t,buttonPopupStore:o,disabled:f,onClick:x,propertySchema:S,value:b}=e,C=(0,i().yK)((()=>({content:{alignItems:"center",display:"flex"},propertyName:{...l().Yu,fontWeight:l().Ue.medium}})),[]),k=function(e){const{propertySchema:t,styles:o,value:n}=e,i=(0,y.jsx)("span",{style:o.propertyName,children:t.name});let l;const d="formula"===(null==n?void 0:n.type);if(d)l=(0,y.jsx)(h().b,{returnType:{type:"checkbox"}});else{const e=(0,a().fromSimpleFormulaArrayValue)(null==n?void 0:n.value)[0],t=!0===e?(0,u().V)({width:12}):(0,c().z)({width:10});l=(0,y.jsx)(s().o,{icon:t,shouldTruncateChildren:!0,children:!0===e?(0,y.jsx)(r()._H,{...p().Bo.actionCheckboxPropertyChecked}):(0,y.jsx)(r()._H,{...p().Bo.actionCheckboxPropertyUnchecked})})}return(0,y.jsx)(r()._H,{...p().hW({propertyName:i,propertyValue:l})})}({propertySchema:S,styles:C,value:b}),j=v({propertySchema:S,value:b}),M=(0,n.useCallback)((e=>(0,y.jsx)(g().YG,{...e,actionMenu:t,buttonPopupStore:o,disabled:f,icon:d().r,onClick:x,children:(0,y.jsx)("div",{style:C.content,children:k})})),[t,o,f,x,C.content,k]);return(0,y.jsx)(m().y,{renderOrigin:M,title:j})}function v(e){const{propertySchema:t,value:o}=e;let n;if("formula"===(null==o?void 0:o.type))n=(0,y.jsx)(h().K,{});else{n=!0===(0,a().fromSimpleFormulaArrayValue)(null==o?void 0:o.value)[0]?(0,y.jsx)(r()._H,{...p().Bo.actionCheckboxPropertyChecked}):(0,y.jsx)(r()._H,{...p().Bo.actionCheckboxPropertyUnchecked})}return(0,y.jsx)(r()._H,{...p().hW({propertyName:t.name,propertyValue:n})})}},839886:(e,t,o)=>{o.d(t,{e:()=>T,k:()=>w});var n=o(667294),i=()=>o(142735),a=()=>o(846550),r=()=>o(38883),l=()=>o(646574),s=()=>o(177634),c=()=>o(907874),u=()=>o(998411),d=()=>o(955620),p=()=>o(788860),m=()=>o(696459),g=()=>o(707513),h=()=>o(772265),y=()=>o(214206),f=()=>o(78014),v=()=>o(866456),x=()=>o(361726),S=()=>o(903098),b=()=>o(239869),C=()=>o(982614),k=()=>o(887766),j=()=>o(415764),M=o(785893);function T(e){const{actionMenu:t,automationActionStore:o,buttonPopupStore:T,disabled:I,onClick:_,propertySchema:P,value:V,valueContext:B}=e,R=(0,p().YB)(),K=(0,a().yK)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"wrap",whiteSpace:"pre"},propertyName:{...g().Yu,fontWeight:g().Ue.medium}})),[]),F=(0,S().z)({actionId:o.id}),Z=(0,i().VK)((()=>function(e){const{intl:t,propertySchema:o,styles:n,typecheckContextValues:i,value:a,valueContext:v}=e,S=(0,M.jsx)("span",{style:n.propertyName,children:o.name});if(void 0===(null==a?void 0:a.value))return(0,M.jsx)(p()._H,{...x().Gx({propertyName:S})});let b;const C="formula"===a.type,T=(0,c().fromSimpleFormulaArrayValue)(null==a?void 0:a.value)[0];if(C)b=(0,M.jsx)(j().b,{returnType:{type:"date"}});else if(!(0,m().$K)(T)||"string"==typeof T||"boolean"==typeof T||(0,d().IWo)(T)||(0,d().STW)(T))b=(0,M.jsx)(f().Z,{format:r().lo.Medium,isRound:!0,isSingle:!0,shouldShrink:!0,showRemoveButton:!1,value:(0,M.jsx)("span",{style:g().Yu,children:(0,M.jsx)(p()._H,{...x().Bo.unknownValue})})});else if((0,d().wjk)(T)){const e=(0,d().vmO)(T).id,t=(0,s().vx)(i,e);b=t?(0,M.jsx)(h().F,{value:t,format:r().lo.Medium,isSingle:!1,shouldShrink:!0}):(0,M.jsx)(f().Z,{format:r().lo.Medium,isRound:!0,isSingle:!0,shouldShrink:!0,showRemoveButton:!1,value:(0,M.jsx)("span",{style:g().Yu,children:(0,M.jsx)(p()._H,{...x().Bo.unknownValue})})})}else if((0,d().fpG)(T)){const e=(0,y()._7)(v),o=(0,d().zyO)(T);b=o?(0,l().OB)({value:o,date_format:e.dateFormat,time_format:e.timeFormat,userTimeZone:(0,u().r)(),allowRelativeDates:!0,intl:t,shortenDateAndRange:!0,displayInUserTimezone:!0,formatValuesFn:e=>{let{endDate:t,endTime:o,startDate:n}=e;return(0,m().$K)(o)?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(A,{value:n})," → ",(0,M.jsx)(A,{value:o})]}):(0,m().$K)(t)?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(A,{value:n})," → ",(0,M.jsx)(A,{value:t})]}):(0,M.jsx)(A,{value:n})}}):null}else{if((0,d().Lyt)(T))return(0,M.jsx)(k().Z,{token:T});(0,m().t1)(T)}return void 0===b?void 0:(0,M.jsx)(p()._H,{...x().zU({propertyName:S,propertyValue:b})})}({intl:R,propertySchema:P,styles:K,typecheckContextValues:F,value:V,valueContext:B})),[R,P,K,F,V,B]),L=(0,i().VK)((()=>w({intl:R,propertySchema:P,typecheckContextValues:F,value:V,valueContext:B})),[R,P,F,V,B]),E=(0,n.useCallback)((e=>(0,M.jsx)(C().YG,{...e,actionMenu:t,buttonPopupStore:T,disabled:I,icon:v().V,onClick:_,children:(0,M.jsx)("div",{style:K.content,children:Z})})),[t,T,I,_,K.content,Z]);return Z&&L?(0,M.jsx)(b().y,{disable:I,renderOrigin:E,title:L}):null}function w(e){const{intl:t,propertySchema:o,typecheckContextValues:n,value:i,valueContext:a}=e,r=o.name;if(void 0===(null==i?void 0:i.value))return(0,M.jsx)(p()._H,{...x().Gx({propertyName:r})});let g;const h="formula"===i.type,f=(0,c().fromSimpleFormulaArrayValue)(i.value)[0];if(h)g=(0,M.jsx)(j().K,{});else if(!(0,m().$K)(f)||"string"==typeof f||"boolean"==typeof f||(0,d().IWo)(f)||(0,d().STW)(f)||(0,d().Lyt)(f))g=(0,M.jsx)(p()._H,{...x().Bo.unknownValue});else if((0,d().wjk)(f)){const e=(0,d().vmO)(f).id,t=(0,s().vx)(n,e);g=t?(0,s().NP)(t):(0,M.jsx)(p()._H,{...x().Bo.unknownValue})}else if((0,d().fpG)(f)){const e=(0,y()._7)(a),o=(0,d().zyO)(f);g=o?(0,l().ZV)({value:o,date_format:e.dateFormat,time_format:e.timeFormat,userTimeZone:(0,u().r)(),allowRelativeDates:!0,intl:t,shortenDateAndRange:!0,displayInUserTimezone:!0}):null}else(0,m().t1)(f);return void 0===g?void 0:(0,M.jsx)(p()._H,{...x().zU({propertyName:r,propertyValue:g})})}function A(e){const{value:t}=e,o=(0,a().yK)((e=>({token:{marginBlockEnd:4},tokenBackgroundColor:{backgroundColor:e.accentColors.gray[75]}})),[]);return(0,M.jsx)(f().Z,{backgroundColor:o.tokenBackgroundColor.backgroundColor,format:r().lo.Medium,isRound:!0,isSingle:!0,showRemoveButton:!1,style:o.token,value:t})}},859127:(e,t,o)=>{o.d(t,{H:()=>m,m:()=>g});var n=o(667294),i=()=>o(142735),a=()=>o(846550),r=()=>o(788860),l=()=>o(707513),s=()=>o(300729),c=()=>o(239869),u=()=>o(982614),d=()=>o(282895),p=o(785893);const m=5;function g(e){const{action:t,actionMenu:o,buttonPopupStore:g,disabled:h,limit:y=m,onClick:f,propertySchema:v,value:x}=e,S=(0,r().YB)(),b=(0,a().yK)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"wrap",whiteSpace:"pre",lineHeight:1.6},propertyName:{...l().Yu,fontWeight:l().Ue.medium}})),[]),C=(0,i().VK)((()=>(0,d().F0)({intl:S,limit:y,propertySchema:v,styles:b,operator:t,value:x})),[S,y,v,b,t,x]),k=(0,i().VK)((()=>(0,d().I7)({intl:S,limit:y,propertySchema:v,operator:t,value:x})),[t,S,y,v,x]),j=(0,n.useCallback)((e=>(0,p.jsx)(u().YG,{...e,actionMenu:o,buttonPopupStore:g,disabled:h,icon:s().A,onClick:f,children:(0,p.jsx)("div",{style:b.content,children:C})})),[o,g,h,f,b.content,C]);return(0,p.jsx)(c().y,{renderOrigin:j,title:k})}},282895:(e,t,o)=>{o.d(t,{D9:()=>C,F0:()=>j,I7:()=>M});o(267602),o(653476),o(241792);var n=o(667294),i=()=>o(142735),a=()=>o(846550),r=()=>o(907874),l=()=>o(788860),s=()=>o(513670),c=()=>o(696459),u=()=>o(707513),d=()=>o(603885),p=()=>o(246471),m=()=>o(78014),g=()=>o(303611),h=()=>o(682108),y=()=>o(361726),f=()=>o(239869),v=()=>o(982614),x=()=>o(253783),S=()=>o(415764),b=o(785893);function C(e){const{actionMenu:t,buttonPopupStore:o,disabled:r,onClick:s,propertySchema:c,value:d}=e,p=(0,l().YB)(),m=(0,a().yK)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"wrap",whiteSpace:"pre",lineHeight:1.6},propertyName:{...u().Yu,fontWeight:u().Ue.medium}})),[]),h=(0,i().VK)((()=>j({intl:p,propertySchema:c,styles:m,value:d})),[p,c,m,d]),y=(0,i().VK)((()=>M({intl:p,propertySchema:c,value:d})),[p,c,d]),x=(0,n.useCallback)((e=>(0,b.jsx)(v().YG,{...e,actionMenu:t,buttonPopupStore:o,disabled:r,icon:g().w,onClick:s,children:(0,b.jsx)("div",{style:m.content,children:h})})),[t,o,r,s,m.content,h]);return(0,b.jsx)(f().y,{renderOrigin:x,title:y})}function k(e,t){if(!e)return[];let o=(0,r().fromSimpleFormulaArrayValue)(e).filter((e=>(0,s().HD)(e)));return"select"===t.type&&(o=o.slice(0,1)),o}function j(e){const{intl:t,limit:o,operator:n,propertySchema:i,styles:a,tokenFormat:r,value:s}=e,u=(0,d().jV)(r),g=(0,b.jsx)("span",{style:a.propertyName,children:i.name});if("formula"===(null==s?void 0:s.type))return(0,b.jsx)(l()._H,{...y().rf({propertyName:g,propertyValue:(0,b.jsx)(S().b,{returnType:{type:"text"}})})});const h=y().oJ({limit:o,propertySchema:i,optionValues:k(null==s?void 0:s.value,i)}).map((e=>"deleted"===e.type?(0,b.jsx)(x().Z,{tokenFormat:u},`missing_option_value_${e.value}`):"option"===e.type?(0,b.jsx)(p().a,{color:e.value.color,format:u,isSingle:!0,showRemoveButton:!1,value:e.value.value},e.value.id):"truncation"===e.type?(0,b.jsx)(m().Z,{format:u,isRound:!0,isSingle:!0,showRemoveButton:!1,value:e.value},"More tokens"):void(0,c().t1)(e)));return"replace"===n||"append"===n||"remove"===n||"toggle"===n?(0,b.jsx)(l()._H,{...y().Lu({...y().DM({elements:h,intl:t}),operator:n,propertyName:g})}):0===h.length?(0,b.jsx)(l()._H,{...y().Gx({propertyName:g})}):(0,b.jsx)(l()._H,{...y().rf({propertyName:g,propertyValue:h[0]})})}function M(e){const{intl:t,limit:o,propertySchema:n,value:i,operator:a}=e,r=n.name;if("formula"===(null==i?void 0:i.type))return(0,b.jsx)(l()._H,{...y().rf({propertyName:r,propertyValue:(0,b.jsx)(S().K,{})})});const s=y().oJ({limit:o,propertySchema:n,optionValues:k(null==i?void 0:i.value,n)}).map((e=>"deleted"===e.type?y().ST(t):"option"===e.type?e.value.value:"truncation"===e.type?e.value:void(0,c().t1)(e)));return"replace"===a||"append"===a||"remove"===a||"toggle"===a?(0,b.jsx)(l()._H,{...y().Lu({propertyName:r,propertyValue:(0,h().H)(t.formatList(s,{style:"long",type:"conjunction"})),operator:a})}):0===s.length?(0,b.jsx)(l()._H,{...y().Gx({propertyName:r})}):(0,b.jsx)(l()._H,{...y().rf({propertyName:r,propertyValue:s[0]})})}},395137:(e,t,o)=>{o.d(t,{LQ:()=>f,yr:()=>y});var n=o(667294),i=()=>o(142735),a=()=>o(846550),r=()=>o(907874),l=()=>o(788860),s=()=>o(707513),c=()=>o(597487),u=()=>o(361726),d=()=>o(239869),p=()=>o(982614),m=()=>o(823718),g=()=>o(415764),h=o(785893);function y(e){const{actionMenu:t,buttonPopupStore:o,disabled:y,onClick:v,propertySchema:x,value:S}=e,b=(0,l().YB)(),C=(0,a().yK)((()=>({content:{alignItems:"baseline"},propertyName:{...s().Yu,fontWeight:s().Ue.medium}})),[]),k=(0,i().VK)((()=>function(e){const{intl:t,propertySchema:o,styles:n,value:i}=e;if(!i)return;const a=(0,h.jsx)("span",{style:n.propertyName,children:o.name});if("formula"===i.type)return(0,h.jsx)(l()._H,{...(0,u().Ig)({propertyName:a,propertyValue:(0,h.jsx)(g().b,{returnType:{type:"text"}})})});const s=(0,r().fromSimpleFormulaArrayValue)(null==i?void 0:i.value)[0];if("string"!=typeof s)return;const c=(0,m().L)({intl:t,groupValues:[],optionValues:[s],propertySchema:o});if(0===c.length)return;return(0,h.jsx)(l()._H,{...(0,u().Ig)({propertyName:a,propertyValue:c})})}({intl:b,propertySchema:x,styles:C,value:S})),[b,x,C,S]),j=(0,i().VK)((()=>f({intl:b,propertySchema:x,value:S})),[b,x,S]),M=(0,n.useCallback)((e=>(0,h.jsx)(p().YG,{...e,actionMenu:t,buttonPopupStore:o,disabled:y,icon:c().T,onClick:v,children:(0,h.jsx)("div",{style:C.content,children:k})})),[t,o,y,v,C.content,k]);return k&&j?(0,h.jsx)(d().y,{renderOrigin:M,title:j}):null}function f(e){const{intl:t,propertySchema:o,value:n}=e;if(!n)return;const i=o.name;if("formula"===n.type)return(0,h.jsx)(l()._H,{...(0,u().Ig)({propertyName:i,propertyValue:(0,h.jsx)(g().K,{})})});const a=(0,r().fromSimpleFormulaArrayValue)(null==n?void 0:n.value)[0];if("string"!=typeof a)return;const s=(0,m().L)({intl:t,isText:!0,groupValues:[],optionValues:[a],propertySchema:o});return 0!==s.length?(0,h.jsx)(l()._H,{...(0,u().Ig)({propertyName:i,propertyValue:s})}):void 0}},96754:(e,t,o)=>{o.d(t,{GJ:()=>_,Kh:()=>I,QQ:()=>w,Vk:()=>A,gi:()=>V,go:()=>P,lG:()=>T});var n=o(667294),i=()=>o(219727),a=()=>o(142735),r=()=>o(846550),l=()=>o(81954),s=()=>o(788860),c=()=>o(707513),u=()=>o(718611),d=()=>o(641702),p=()=>o(519710),m=()=>o(947189),g=()=>o(118006),h=()=>o(963966),y=()=>o(586365),f=()=>o(161149),v=()=>o(637118),x=()=>o(361726),S=()=>o(903098),b=()=>o(239869),C=()=>o(982614),k=()=>o(415764),j=o(785893);function M(e){const{actionMenu:t,automationActionStore:o,buttonPopupStore:p,disabled:m,icon:g,onClick:h,propertySchema:y,value:f}=e,{automationStore:M}=(0,v().YC)(),w=(0,i().O7)(),A=(0,r().Fg)(),I=(0,r().yK)((()=>({propertyName:{...c().Yu,fontWeight:c().Ue.medium,flexShrink:0}})),[]),_=(0,S().z)({actionId:o.id}),P=(0,a().VK)((()=>function(e){const{automationStore:t,environment:o,propertySchema:n,styles:i,theme:a,typecheckContextValues:r,value:p}=e,m=(0,j.jsx)("span",{style:i.propertyName,children:n.name}),g=void 0===(null==p?void 0:p.value);if(g)return(0,j.jsx)(s()._H,{...x().Gx({propertyName:m})});let h;const y="formula"===p.type;if(y)h=(0,j.jsx)(k().b,{returnType:{type:"text"}});else{const e=(0,d().IY)({disabled:!0,disableDateStyleAnnotations:!0,disableHover:!0,disableLinks:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableSuggestionAnnotations:!0,emojiType:(0,u().e_)(o),environment:o,formulaValueTypes:r,katex:o.KatexStore.getKatex(),parentStore:t,stopLinkPropagation:!0,textValue:{value:p.value??[],spaceId:(0,l().J)(t.pointer.spaceId)},theme:a});h=(0,j.jsxs)(j.Fragment,{children:['"',(0,j.jsx)("span",{style:c().Yu,children:e}),'"']})}return(0,j.jsx)(s()._H,{...x().vE({propertyName:m,propertyValue:h})})}({automationStore:M,environment:w,propertySchema:y,styles:I,theme:A,typecheckContextValues:_,value:f})),[M,w,y,I,A,_,f]),V=(0,a().VK)((()=>T({automationStore:M,environment:w,propertySchema:y,theme:A,typecheckContextValues:_,value:f})),[M,w,y,A,_,f]),B=(0,n.useCallback)((e=>(0,j.jsx)(C().YG,{...e,actionMenu:t,buttonPopupStore:p,disabled:m,icon:g,onClick:h,children:P})),[t,p,m,g,h,P]);return P&&V?(0,j.jsx)(b().y,{renderOrigin:B,title:V}):null}function T(e){const{automationStore:t,environment:o,propertySchema:n,theme:i,typecheckContextValues:a,value:r}=e,c=n.name;if(void 0===(null==r?void 0:r.value))return(0,j.jsx)(s()._H,{...x().Gx({propertyName:c})});let p;return p="formula"===r.type?(0,j.jsx)(k().K,{}):(0,d().IY)({disabled:!0,disableDateStyleAnnotations:!0,disableFormulaVariableStyles:!0,disableHover:!0,disableInsertedDeletedAnnotations:!0,disableLinks:!0,disableStyleAnnotations:!0,disableSuggestionAnnotations:!0,emojiType:(0,u().e_)(o),environment:o,formulaValueTypes:a,katex:o.KatexStore.getKatex(),parentStore:t,stopLinkPropagation:!0,textValue:{value:r.value??[],spaceId:(0,l().J)(t.pointer.spaceId)},theme:i}),(0,j.jsx)(s()._H,{...x().vE({propertyName:c,propertyValue:p})})}function w(e){return(0,j.jsx)(M,{...e,icon:y().c})}function A(e){return(0,j.jsx)(M,{...e,icon:h().p})}function I(e){return(0,j.jsx)(M,{...e,icon:p().n})}function _(e){return(0,j.jsx)(M,{...e,icon:f().O})}function P(e){return(0,j.jsx)(M,{...e,icon:m().J})}function V(e){return(0,j.jsx)(M,{...e,icon:g().u})}},294105:(e,t,o)=>{o.d(t,{b:()=>f});o(667294);var n=()=>o(219727),i=()=>o(846550),a=()=>o(788860),r=()=>o(696459),l=()=>o(94967),s=()=>o(198829),c=()=>o(470386),u=()=>o(921981),d=()=>o(247724),p=()=>o(352230),m=()=>o(861050),g=o(785893);const h=(0,a().vU)({createTitle:{id:"automations.builderModal.createTitle",defaultMessage:"Create automation"},updateTitle:{id:"automations.builderModal.updateTitle",defaultMessage:"Edit automation"},backAriaLabel:{defaultMessage:"Back",id:"automations.builderModal.backAriaLabel"},saveButton:{id:"automations.builderModal.saveButton",defaultMessage:"Save"}}),y=88;function f(e){const{children:t,handleOnDismiss:o,canSave:f,handleOnSave:v,mode:x}=e,S=(0,a().YB)(),{isMobile:b}=(0,n().Fy)(),C=(0,i().yK)((e=>({container:{padding:b?0:"12px 16px",display:"flex",flexDirection:"column",overflow:"hidden",...b?{}:{flexGrow:1}},mobileBackIcon:{width:14,height:14,fill:e.mediumIconColor,margin:"0 6px"}})),[b]);if(b){let e;return"create"===x?e=S.formatMessage(h.createTitle):"update"===x||"button_property"===x?e=S.formatMessage(h.updateTitle):"loading"===x?e=null:(0,r().t1)(x),(0,g.jsx)(s().Z,{menuType:p().o.Modal,whiteBackground:!0,title:e,left:(0,g.jsx)(g.Fragment,{children:(0,m().S)(C.mobileBackIcon)}),onClickLeft:o,rightDisabled:!f,right:"button_property"===x?(0,g.jsx)(c().DoneMenuText,{}):(0,g.jsx)(a()._H,{...h.saveButton}),onClickRight:v,children:(0,g.jsx)("div",{style:C.container,className:d().XEp,children:t})})}return(0,g.jsx)(u().c,{anchor:"top",minimumOutsideSpacing:{type:"axes",vertical:y},areaConstraint:{width:{type:"fixed",length:500},height:{type:"min",length:600,scroll:"disallow"}},allowDismissByEscape:!1,isOpen:!0,render:()=>(0,g.jsxs)("div",{style:C.container,className:d().XEp,children:[t,(0,g.jsx)(l().Z,{debugName:"AutomationBuilderModal",capture:!0,onEsc:e=>{o()}})]})})}},516463:(e,t,o)=>{o.d(t,{Z:()=>a});o(667294);var n=()=>o(312578),i=o(785893);function a(){return(0,i.jsx)("div",{style:{alignItems:"center",display:"flex",justifyContent:"center",minHeight:200,overflow:"hidden"},children:(0,i.jsx)(n().Z,{})})}},514e3:(e,t,o)=>{o.r(t),o.d(t,{AutomationBuilderModal:()=>nt,ButtonBuilderModal:()=>ht});o(670560),o(267602),o(653476),o(228244);var n=o(667294),i=()=>o(219727),a=()=>o(142735),r=()=>o(846550),l=()=>o(912203),s=()=>o(731424),c=()=>o(494616),u=()=>o(492522),d=()=>o(788860),p=()=>o(513670),m=()=>o(855741),g=()=>o(696459),h=()=>o(707513),y=()=>o(139224),f=()=>o(102182),v=()=>o(285755),x=()=>o(205951),S=()=>o(154186),b=()=>o(255577),C=()=>o(661297),k=()=>o(906651),j=()=>o(388284),M=()=>o(71194),T=()=>o(506347),w=()=>o(530980),A=()=>o(728670),I=()=>o(396136),_=()=>o(696056),P=()=>o(752778),V=()=>o(255933),B=()=>o(511614),R=()=>o(545444),K=()=>o(87781),F=()=>o(637118),Z=()=>o(92175),L=()=>o(765513),E=()=>o(141735),H=()=>o(594546),D=()=>o(985575),O=()=>o(122479),N=()=>o(677559),U=()=>o(850790),W=()=>o(739479),z=()=>o(735501),G=()=>o(826955),$=()=>o(965014),Y=o(785893);const q=(0,d().vU)({automationIncompatibleViewFilterAndOwner:{defaultMessage:"This automation may not work because the view has a non-supported filter",id:"AutomationHeaderView.incompatibleCollectionViewFilter.owner"},automationPublicAccess:{defaultMessage:"This automation is part of a public page",id:"AutomationHeaderView.automationPublicAccess"},automationUpgrade:{defaultMessage:"<anchor-upsell>Upgrade</anchor-upsell> to edit this automation or create your own",id:"AutomationHeaderView.automationUpgrade"},automationEditOnSite:{defaultMessage:"This automation can only be edited on notion.com",id:"AutomationHeaderView.automationEditOnSite"},automationExternalBotNoPermissions:{defaultMessage:"Ask {user} to edit this automation",id:"AutomationHeaderView.automationExternalBotNoPermissions"},automationExternalBotWithPermissions:{defaultMessage:"Ask {user} to edit this automation or <anchor-delete>delete</anchor-delete> it when necessary",id:"AutomationHeaderView.automationExternalBotWithPermissions"},automationMissingPermissionsNoPermissionsForDatabase:{defaultMessage:"You must have full access to target databases in this automation to edit it",id:"AutomationHeaderView.automationMissingPermissionsNoPermissionsForDatabase"},automationGenericFullAccess:{defaultMessage:"You must have full access to this database to edit automations",id:"AutomationHeaderView.automationGenericFullAccess"},automationCollectionInTrashedPage:{defaultMessage:"This database is in the trash and cannot be edited.",id:"AutomationHeaderView.automationCollectionInTrash"},automationCollectionInTrashedPageViewDeletedPageButton:{defaultMessage:"View deleted page",id:"AutomationHeaderView.automationCollectionInTrashedPageViewDeletedPageButton"},automationMissingActionFeature:{defaultMessage:"The {actionName} action is not available in your workspace",id:"AutomationHeaderView.automationMissingActionFeature"},mustBeWorkspaceMember:{defaultMessage:"You must be a workspace member to edit automations",id:"AutomationHeaderView.mustBeWorkspaceMember"}});function X(e){const{automationPermissionScope:t,collectionStore:o,collectionSettingsStore:r,onDelete:l,referencesIncompatibleCollectionViewFilter:s,requiresSubscriptionUpgrade:c}=e,u=(0,i().O7)(),{automationStore:p,contextType:m}=(0,F().YC)(),h=(0,d().YB)(),{value:f}=(0,N().XJ)(E().F.formulas),{value:x}=(0,N().XJ)(v().Sm.automationActionRegistry),{value:S}=(0,N().XJ)(v().Sm.automationTypecheck),b=(0,a().VK)((()=>Boolean((0,O().IJ)(u,p))),[p,u]),C=(0,a().VK)((()=>(0,D().$5)({automationStore:p,automationActionRegistryModule:x,automationTypecheckModule:S,contextType:m,formulasModule:f,intl:h,isLoggedIn:u.currentUser.isLoggedIn()})),[p,x,S,m,f,h,u]),k=(0,a().VK)((()=>{const e=(0,A().OJ)({recordPointer:o.pointer,getRecordModel:o.getRecordModel});if(!e||e.table!==I().iU)return;const t=e.pointer;return G().G.createChildStore(o,t)}),[o]),j=(0,n.useCallback)((()=>{$().y(u,{from:"database_automation_settings_header_message",upsell:{type:"product",product:"plus",limit:{type:"none"}}})}),[u]),M=te();if(c)return(0,Y.jsx)(K().c,{onUpsellClick:j});if(k)return(0,Y.jsx)(ee,{icon:(0,Y.jsx)("div",{style:M.lockedIconWrap,children:(0,W().y)(M.lockedIcon)}),children:(0,Y.jsxs)("div",{children:[(0,Y.jsx)("p",{style:M.paragraph,children:(0,Y.jsx)(d()._H,{...q.automationCollectionInTrashedPage})}),(0,Y.jsx)(Z().Z,{onClick:()=>{!function(e,t){(function(e){(0,H().K4)(e,"view_deleted_page_from_automation_edit_menu")})(t),B().r({environment:t,store:e,pageVisitSource:T().tY.LinkInPage})}(k,u),(0,g().$K)(r)&&y().E3({collectionSettingsStore:r})},style:M.restoreButton,isLightGray:!0,children:(0,Y.jsx)(d()._H,{...q.automationCollectionInTrashedPageViewDeletedPageButton})})]})});if(b)return(0,Y.jsx)(R().k,{children:(0,Y.jsx)(d()._H,{...q.automationPublicAccess})});if("insufficient"===C.editPermissionStatus){if("free_workspace"===C.reason)return(0,D().Rr)({contextType:m,environment:u})?(0,Y.jsx)(Q,{icon:(0,Y.jsx)("div",{style:M.boltIconWrap,children:(0,U().K)(M.boltIcon)}),children:(0,Y.jsx)("p",{style:M.paragraph,children:(0,Y.jsx)(d()._H,{...q.automationUpgrade,values:{"anchor-upsell":e=>(0,Y.jsx)(L().Z,{onClick:j,style:M.link,children:e})}})})}):(0,Y.jsx)(R().k,{children:(0,Y.jsx)(d()._H,{...q.automationEditOnSite})});if("feature_not_enabled"===C.reason)return(0,Y.jsx)(R().k,{children:(0,Y.jsx)(d()._H,{...q.automationMissingActionFeature,values:{actionName:C.actionName.toLocaleLowerCase()}})});var w,X,oe;if("missing_permissions"===C.reason)return(null===(w=C.relatedPointer)||void 0===w?void 0:w.table)===_().cZ?(0,Y.jsx)(J,{botId:C.relatedPointer.id,automationPermissionScope:t,onDelete:l,automationStore:p}):(null===(X=C.relatedPointer)||void 0===X?void 0:X.table)===P().vF&&C.relatedPointer.id!==o.id?(0,Y.jsx)(R().k,{children:(0,Y.jsx)(d()._H,{...q.automationMissingPermissionsNoPermissionsForDatabase})}):(null===(oe=C.relatedPointer)||void 0===oe?void 0:oe.table)===V().bx?(0,Y.jsx)(R().k,{children:(0,Y.jsx)(d()._H,{...q.mustBeWorkspaceMember})}):(0,Y.jsx)(R().k,{children:(0,Y.jsx)(d()._H,{...q.automationGenericFullAccess})});(0,g().t1)(C)}else{if("unknown"===C.editPermissionStatus)return(0,Y.jsx)(R().k,{children:(0,Y.jsx)(d()._H,{...q.automationGenericFullAccess})});if("sufficient"===C.editPermissionStatus)return s?(0,Y.jsx)(R().k,{icon:(0,z().t)(M.warningIcon),children:(0,Y.jsx)(d()._H,{...q.automationIncompatibleViewFilterAndOwner})}):null;(0,g().t1)(C)}}function J(e){const{botId:t,automationPermissionScope:o,onDelete:n,automationStore:i}=e,r=(0,d().YB)(),l=te(),s=(0,a().VK)((()=>{const e=G().Qx.createChildStore(i,{id:t,spaceId:i.getSpaceId(),table:_().cZ}).getCreatedByStore();return e?e.getDisplayName(r):r.formatMessage(w().T_T.messages.anonymousPlaceholder)}),[i,t,r]);return(0,Y.jsx)(R().k,{children:(0,Y.jsx)(d()._H,{..."readonly"===o?q.automationExternalBotNoPermissions:q.automationExternalBotWithPermissions,values:{"anchor-delete":e=>(0,Y.jsx)(L().Z,{onClick:n,style:l.link,children:e}),user:s}})})}function Q(e){const{children:t,icon:o}=e,n=te();return(0,Y.jsx)("div",{style:n.wrapWrap,children:(0,Y.jsxs)("div",{style:n.upsellWrap,children:[o&&(0,Y.jsx)("div",{style:n.iconWrap,children:o}),(0,Y.jsx)("div",{style:n.messageWrap,children:t})]})})}function ee(e){const{children:t,icon:o}=e,n=te();return(0,Y.jsx)("div",{style:n.wrapWrap,children:(0,Y.jsxs)("div",{style:n.trashPageWrap,children:[o&&(0,Y.jsx)("div",{style:n.iconWrap,children:o}),(0,Y.jsx)("div",{style:n.messageWrap,children:t})]})})}function te(){const{isMobile:e}=(0,i().Fy)();return(0,r().yK)((t=>({boltIcon:{fill:t.icon.yellowPrimary,height:"100%",width:"100%"},boltIconWrap:{height:20,padding:2,width:20},icon:{},iconWrap:{flexGrow:0,flexShrink:0},lockedIcon:{fill:t.icon.secondary,height:"100%",width:"100%"},lockedIconWrap:{background:t.fill.lightGraySecondary,borderRadius:4,height:20,padding:2,width:20},link:{color:t.text.uiBluePrimary},messageWrap:{flexGrow:1},paragraph:{color:t.text.secondary,fontSize:e?14:12,margin:0},restoreButton:{fontSize:e?14:12,fontWeight:h().Ue.medium,marginLeft:-8},warningIcon:{color:t.accentColors.orange[400],height:"100%",width:"100%"},warningIconWrap:{height:20,padding:2,width:20},wrap:{alignItems:"start",display:"flex",flexDirection:"row",gap:10},wrapWrap:{padding:e?"0 12px 12px":"0 0 6px 0"},upsellWrap:{alignItems:"center",background:t.accentColors.yellow[50],border:`1px solid ${t.accentColors.yellow[100]}`,borderRadius:6,display:"flex",flexDirection:"row",gap:10,padding:8},trashPageWrap:{alignItems:"start",display:"flex",flexDirection:"row",gap:10,background:t.accentColors.gray[30],padding:8,borderRadius:6},personBadgeQuestionMark:{fill:t.mediumIconColor,width:16,height:"auto"},personBadgeQuestionMarkWrap:{height:20,padding:2,width:20}})),[e])}var oe=()=>o(195245),ne=()=>o(471645),ie=()=>o(654133),ae=()=>o(641506);const re=(0,d().vU)({automationEnabledLabel:{defaultMessage:"Active",id:"collectionSettings.editAutomationView.automationEnabledLabel"},automationEnabledHiddenAriaLabel:{defaultMessage:"Automation is active.",id:"collectionSettings.editAutomationView.automationEnabledHiddenAriaLabel"},automationPausedHiddenAriaLabel:{defaultMessage:"Automation is paused.",id:"collectionSettings.editAutomationView.automationPausedHiddenAriaLabel"},automationDisabledTooltip:{defaultMessage:"Ask {user} to resume this automation.",id:"collectionSettings.editAutomationView.automationDisabledTooltip"},automationErrorsDisabledTooltip:{defaultMessage:"Fix any errors or remove failing steps to enable this automation",id:"collectionSettings.editAutomationView.automationErrorsDisabledTooltip"}});function le(e){const{automationId:t,automationOwner:o,disabled:a,isAutomationPaused:l,onPause:s,onResume:c}=e,{cantSaveDueToError:u}=(0,oe().i)(),{isMobile:p}=(0,i().Fy)(),m=`toggle-${t}`,g=(0,n.useCallback)((()=>{l?null==c||c():null==s||s()}),[l,c,s]),y=(0,r().yK)((e=>({labelWrap:{color:a?e.text.tertiary:e.text.secondary,flex:"1 1 auto",fontSize:p?h().JB.UIRegular.mobile:h().JB.UIRegular.desktop},sectionWrap:{alignItems:"start",display:"flex",flexDirection:"row",gap:6,marginBlockEnd:0},toggleWrap:{flex:"0 0 auto",paddingBlockStart:p?5:2}})),[a,p]),f=re.automationEnabledLabel,v=l?re.automationPausedHiddenAriaLabel:re.automationEnabledHiddenAriaLabel;return(0,Y.jsxs)("section",{style:y.sectionWrap,children:[(0,Y.jsx)("div",{style:y.toggleWrap,children:(0,Y.jsx)(ie().Z,{disableTooltip:!a||!l,renderTooltip:()=>u?(0,Y.jsx)(d()._H,{...re.automationErrorsDisabledTooltip}):(0,Y.jsx)(d()._H,{...re.automationDisabledTooltip,values:{user:o}}),render:e=>(0,Y.jsx)("div",{...e,children:(0,Y.jsx)(ne().Z,{disabled:a,inputId:m,on:!l,onClick:g})})})}),(0,Y.jsx)("div",{style:y.labelWrap,children:(0,Y.jsxs)("label",{htmlFor:m,children:[(0,Y.jsx)("span",{"aria-hidden":!0,children:(0,Y.jsx)(d()._H,{...f})}),(0,Y.jsx)("span",{style:ae().jy,children:(0,Y.jsx)(d()._H,{...v})})]})})]})}var se=()=>o(749826);var ce=()=>o(565276);function ue(e){const{shouldInvokeHandler:t,isMobile:o,onClick:i}=e;(0,n.useEffect)((()=>{async function e(e){const o=e.target instanceof Element&&((0,ce().Yj)(e.target)||(0,ce().Br)(e.target));e.eventPhase===Event.CAPTURING_PHASE&&t&&o&&(e.stopPropagation(),e.preventDefault(),await i())}if(!o)return window.addEventListener("click",e,{capture:!0}),()=>{window.removeEventListener("click",e,{capture:!0})}}),[t,o,i])}var de=()=>o(867601),pe=()=>o(712334),me=()=>o(487270),ge=()=>o(466970),he=()=>o(142109),ye=()=>o(688049),fe=()=>o(876822),ve=()=>o(486896),xe=()=>o(200027),Se=()=>o(166312),be=()=>o(807629),Ce=()=>o(492135);var ke=()=>o(359620);function je(){const{automationStore:e}=(0,oe().P)();return(0,a().VK)((()=>function(e){var t;const o=(null===(t=e.getTrigger())||void 0===t?void 0:t.type)??"event";return"event"===o||"notification_event"===o||"recurrence"!==o&&void(0,g().t1)(o)}(e)),[e])}var Me=()=>o(269299),Te=()=>o(291198),we=()=>o(740046);const Ae=(0,d().vU)({placeholder:{defaultMessage:"Automation name",id:"AutomationNameInput.placeholder"}});const Ie=(0,n.forwardRef)((function(e,t){const{disabled:l,autoSelectAllOnDesktop:s,placeholder:c,...u}=e,{automationStore:p}=(0,F().YC)(),{maybePersistedTransactionActions:m}=(0,oe().i)(),g=function(e){const{isMobile:t}=(0,i().Fy)(),{disabled:o}=e;return(0,r().yK)((e=>({automationNameInput:{marginBlockEnd:0},automationNameText:{color:o?e.text.tertiary:e.text.primary,marginInlineStart:t?12:0,marginInlineEnd:t?12:18,fontWeight:h().Ue.medium,padding:0},input:{background:"transparent",boxShadow:"unset",fontWeight:h().Ue.medium,padding:0}})),[t,o])}({showDeleteEnableDisableOptions:!1,disabled:l}),{isMobile:y}=(0,i().Fy)(),f=(0,d().YB)(),v=(0,a().VK)((()=>(null==p?void 0:p.getName())??""),[p]),x=(0,n.useRef)(null),S=(0,o(794623).Z)(x,t),b=c||f.formatMessage(Ae.placeholder),C=(0,n.useCallback)((e=>{m.createAndCommit({userAction:"Automation.updateName",perform:t=>{Me().applyOperation({store:p,operation:{path:["properties"],pointer:p.pointer,command:"update",args:{name:e}},transaction:t})}})}),[p,m]),k=(0,n.useCallback)((e=>{const t=e.currentTarget.value;C(t)}),[C]),j=(0,n.useCallback)((e=>{e.currentTarget.value||C(b)}),[C,b]);return(0,n.useEffect)((()=>{var e;s&&!y&&(null===(e=x.current)||void 0===e||null===(e=e.querySelector("input"))||void 0===e||e.select())}),[s,y]),(0,o(732811).K)((()=>{y&&!v&&C(b)})),(0,Y.jsx)(we().ZP,{style:g.automationNameInput,...u,value:v??"Loading...",onChange:k,disabled:l,onBlur:j,ref:S,inputOuterStyle:g.input,format:Te().B.ExtraLarge,textWrapperStyle:g.automationNameText,placeholder:b,inputStyle:{paddingLeft:0,paddingRight:0},autoFocus:!v})}));var _e=()=>o(294105),Pe=()=>o(139978),Ve=()=>o(448419),Be=()=>o(615634),Re=()=>o(676279),Ke=(o(241792),o(731107),()=>o(455947)),Fe=()=>o(716025),Ze=()=>o(900596),Le=()=>o(887430),Ee=()=>o(178498),He=()=>o(827973),De=()=>o(198829),Oe=()=>o(470386),Ne=()=>o(943620),Ue=()=>o(270315),We=()=>o(352230),ze=()=>o(549813),Ge=()=>o(817771),$e=()=>o(998901);const Ye=(0,d().vU)({forPagesIn:{id:"collectionSettings.editAutomationView.notifyForOption.title",defaultMessage:"For pages in"}});function qe(e){const{selectedSourcePointer:t,collectionContextStore:o,onSelect:l,onClose:s}=e,{isMobile:c}=(0,i().Fy)(),u=(0,d().YB)(),m=(0,i().O7)(),[h,y]=n.useState(""),f=(0,a().VK)((()=>o.collectionStore()),[o]),v=(0,a().VK)((()=>o.collectionViewBlockStore()),[o]),x=(0,a().VK)((()=>v&&f?v.getCollectionViewStores().filter((e=>{var t;const o=null===(t=e.getCollectionStore())||void 0===t?void 0:t.pointer;return(null==o?void 0:o.id)===f.id})):[]),[v,f]),S=(0,a().VK)((()=>{if(!f)return[];let e;t&&"collection_view"===t.table&&(e=G().Xr.createChildStore(f,t));return p().mN([...x,e].filter(g().$K),(e=>{let{id:t}=e;return t})).filter((e=>(0,Le().D)(e,h)))}),[f,x,h,t]),C=(0,a().VK)((()=>{if(f&&(0,Ue().r_)({collectionStore:f,environment:m,intl:u,queryForFilter:h}))return function(e){const{collectionStore:t,environment:o,selectedSourcePointer:n,onSelect:i,isMobile:a,intl:r}=e,l=t.getIcon(),s=(0,ze().vU)({environment:o,intl:r,store:t}),c=n&&"collection"===n.table&&n.id===t.id,u=t.getSpaceShardedPointer(),p={key:t.id,action:()=>{u&&i(u)},render:e=>(0,Y.jsx)(He().Z,{...e,icon:l&&(0,Y.jsx)(Ne().Z,{isEmptyPage:!1,size:a?18:16,disabled:!0,icon:l}),title:s,caption:(0,Y.jsx)(d()._H,{id:"AutomationCollectionSelectMenu.collection.caption",defaultMessage:"Entire database",values:{collectionName:s}}),right:c&&(0,Ge().A)({width:16,height:"auto"})})};return{key:"collection",items:[p],render:e=>(0,Y.jsx)(j().Z,{...e})}}({collectionStore:f,environment:m,selectedSourcePointer:t,onSelect:l,isMobile:c,intl:u})}),[f,m,u,c,l,h,t]),k=(0,a().VK)((()=>f&&v&&x?function(e){const{blockStore:t,filteredCollectionViewStores:o,collectionStore:n,selectedSourcePointer:i,onSelect:a,intl:r}=e,l=n.getSchema(),s=o.map((e=>{if("form_editor"===e.getType()||"chart"===e.getType())return;const o=e.getSpaceShardedPointer();if(e.isDefined()&&o){const s=i&&"collection_view"===i.table&&i.id===o.id,c=(0,de().rU)({collectionViewStore:e,collectionSchema:l}),u=(0,de().sM)({collectionViewStore:e,collectionSchema:l}),p=(0,g().$K)(c)||(0,g().$K)(u),m=e.getType(),h=e.getFormat().collection_view_icon,y=e.getName(),f=(o,n)=>(0,Y.jsx)(He().Z,{...o,...n,icon:(0,Y.jsx)(Fe().F,{color:"lightGray",viewType:m,viewIcon:h}),title:(0,Y.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",padding:0,gap:4},children:[(0,Y.jsx)(Ze().Z,{collectionViewType:m,collectionViewName:y}),p&&s&&(0,z().t)({width:16,height:"auto"})]}),caption:(0,Y.jsx)(Xe,{blockStore:t,collectionViewStore:e,intl:r,collectionSchema:l,referencesIncompatibleProperties:p}),right:s&&(0,Ge().A)({width:16,height:"auto"}),disabled:p,disabledFeedback:p});let v;if(p&&c){var n;const e=null===(n=l[c])||void 0===n?void 0:n.type,t=e?Ue().SO[e]:void 0,o=t?(0,Y.jsx)(d()._H,{id:"AutomationCollectionSelectMenu.tooltip.incompatibleFiltersWarning.specific",defaultMessage:"{propertyTypeName} properties are not supported",values:{propertyTypeName:t}}):(0,Y.jsx)(d()._H,{id:"AutomationCollectionSelectMenu.tooltip.incompatibleFiltersWarning.default",defaultMessage:"Some properties are not supported"});v=e=>(0,Y.jsx)(ie().Z,{placement:$e().Placement.Right,renderTooltip:()=>o,render:t=>f(e,t)})}else if((0,g().$K)(u)){const e=(0,Y.jsx)(d()._H,{id:"AutomationCollectionSelectMenu.tooltip.incompatibleFiltersWarning.crossSpace",defaultMessage:"Cross work-space properties are not supported"});v=t=>(0,Y.jsx)(ie().Z,{placement:$e().Placement.Right,renderTooltip:()=>e,render:e=>f(t,e)})}else v=f;return{key:e.id,action:()=>{a(o)},render:v}}}));return[...s].filter(g().$K)}({blockStore:v,collectionStore:f,filteredCollectionViewStores:S,selectedSourcePointer:t,onSelect:l,intl:u}):[]),[v,f,x,S,u,l,t]),M=function(e){const{menuListItems:t}=e;if(0===t.length)return;return{key:"collection-views",items:t,render:e=>(0,Y.jsx)(j().Z,{...e,topBorder:!0})}}({menuListItems:k}),T={key:"search",items:[{key:"search_item",action:()=>{},render:()=>(0,Y.jsx)(we().ZP,{value:h,focus:!0,style:I.searchBar,textWrapperStyle:I.searchText,onChange:e=>y(e.target.value),placeholder:u.formatMessage({defaultMessage:"Search views...",id:"collectionViewSelect.viewSearch.placeholder"})})}],render:e=>(0,Y.jsx)(j().Z,{...e})};let w;(0,g().$K)(C)||(0,g().$K)(M)||(w={key:"no-results-section",items:[{key:"no-results-item",action:p().ZT,render:()=>(0,Y.jsx)(Ee().Z,{caption:(0,Y.jsx)(d()._H,{defaultMessage:"No results",id:"collectionViewSelect.noResults.title"})})}],render:e=>(0,Y.jsx)(j().Z,{...e,topBorder:!0})});const A=[T,C,M,w].filter(g().$K),I=(0,r().yK)((e=>({searchBar:{marginTop:6},searchText:{marginLeft:8,marginRight:8}})),[]);if(!f)return null;let _;return _=c?{menuType:We().o.Modal,title:(0,Y.jsx)("div",{style:{display:"flex"},children:(0,Y.jsx)(d()._H,{...Ye.forPagesIn})}),right:(0,Y.jsx)(Oe().DoneMenuText,{}),onClickRight:()=>{s()}}:{menuType:We().o.Popup,width:230,maxHeight:"50vh"},(0,Y.jsx)(De().Z,{..._,children:(0,Y.jsx)(b().Z,{type:b().i.Vertical,sections:A,initialFocus:0,onAccept:()=>{s()}})})}function Xe(e){const{blockStore:t,collectionViewStore:o,intl:n,collectionSchema:r,referencesIncompatibleProperties:l}=e,s=(0,i().O7)(),c=(0,a().VK)((()=>!o.getAlive()),[o]),u=(0,a().VK)((()=>{const e=o.getParentBlockStore();if(e)return t.id!==e.id?(0,ze().vU)({environment:s,intl:n,store:e}):void 0}),[t.id,o,n,s]),p=(0,a().VK)((()=>{const e=o.getQuery(r);return(0,Ke().OH)({propertyFilters:o.getPropertyFiltersStore().getValue()??[],combinatorFilter:null==e?void 0:e.filter,schema:r}).reduce(((e,t)=>{if((0,Ke().aN)(t))return e+1;return e+(t.filters??[]).length}),0)}),[r,o]);return l?(0,Y.jsx)(d()._H,{id:"AutomationCollectionSelectMenu.collectionView.unsupportedView",defaultMessage:"Not supported"}):c?(0,Y.jsx)(d()._H,{id:"AutomationCollectionSelectMenu.collectionView.deletedView",defaultMessage:"<emphasis>View not found.</emphasis>",values:{emphasis:e=>(0,Y.jsx)("em",{children:e})}}):u?(0,Y.jsx)(d()._H,{id:"AutomationCollectionSelectMenu.collectionView.captionDifferentParent",defaultMessage:"<emphasis>View configured in {externalParentBlockName}</emphasis>",values:{emphasis:e=>(0,Y.jsx)("em",{children:e}),externalParentBlockName:u}}):0===p?(0,Y.jsx)(d()._H,{id:"AutomationCollectionSelectMenu.collectionView.captionWithNoFilters",defaultMessage:"Any page in this view"}):(0,Y.jsx)(d()._H,{id:"AutomationCollectionSelectMenu.collectionView.captionWithFilters",defaultMessage:"{ruleCount, plural, one {{ruleCount} filter} other {{ruleCount} filters}}",values:{ruleCount:p}})}function Je(e){const{pointer:t,collectionStore:o,intl:n}=e,l=(0,i().O7)(),s=(0,r().yK)((e=>({warningIcon:{width:16,height:"auto",color:e.accentColors.orange[400]},titleContainer:{display:"flex",flexDirection:"row",alignItems:"center",padding:0,gap:4,flex:"1 1 auto",minWidth:0},title:{...h().Yu},errorText:{color:e.errorText,fontWeight:h().Ue.medium}})),[]),c=(0,a().VK)((()=>t?G().t1.createChildStore(o,t):void 0),[o,t]),u=(0,a().VK)((()=>c?(0,ze().vU)({environment:l,intl:n,store:c}):(0,Y.jsx)("span",{style:s.errorText,children:(0,Y.jsx)(d()._H,{id:"AutomationCollectionSelectMenu.source.missing",defaultMessage:"Select database"})})),[l,n,s.errorText,c]),p=(0,a().VK)((()=>{if(!c||c.table===P().vF)return!1;const e=o.getSchema();return(0,g().$K)((0,de().rU)({collectionViewStore:c,collectionSchema:e}))}),[o,c]);return(0,Y.jsxs)("div",{style:s.titleContainer,children:[p&&(0,z().t)(s.warningIcon),(0,Y.jsx)("span",{style:s.title,children:u})]})}function Qe(e){const{collectionContextStore:t,disabled:o}=e,{isMobile:l}=(0,i().Fy)(),s=(0,d().YB)(),c=(0,r().yK)((e=>{const t=o?e.text.tertiary:e.text.secondary,n=l?h().JB.UIRegular.mobile:h().JB.UIRegular.desktop;return{wrap:{alignItems:"center",color:t,cursor:"default",display:"grid",fontSize:n,gridTemplateColumns:"auto auto"},button:{color:t,fontWeight:h().Ue.medium,fontSize:n,width:"100%",height:24,paddingLeft:6,paddingRight:6,marginLeft:1},icon:{width:10,marginLeft:4,fill:t}}}),[l,o]),{automationStore:u}=(0,F().YC)(),{maybePersistedTransactionActions:p}=(0,oe().i)(),m=(0,a().VK)((()=>t.collectionStore()),[t]),g=(0,a().VK)((()=>{const e=null==u?void 0:u.getTrigger();if(e&&("event"===e.type||"notification_event"===e.type)){const t=e.event.source;if(t&&"filter"!==t.type)return t.pointer}}),[u]),y=(0,n.useCallback)((e=>{const t=e.table===P().vF?{pointer:e,type:P().vF}:{pointer:e,type:Pe().np};p.createAndCommit({userAction:"Automation.updateSource",perform:e=>{Me().applyOperation({store:u,operation:{path:["trigger","event"],pointer:u.pointer,command:"update",args:{source:t}},transaction:e})}})}),[u,p]),f=(0,Re().d)(),v=m?(0,Y.jsx)(Je,{pointer:g,collectionStore:m,intl:s}):(0,Y.jsx)(n.Fragment,{}),x=(0,Y.jsx)(Ve().ZP,{alignmentToOrigin:Ve().vR.Start,placementToOrigin:Ve().pO.Bottom,popupType:f,render:e=>(0,Y.jsx)(qe,{selectedSourcePointer:g,onSelect:y,onClose:()=>{e.close()},collectionContextStore:t}),renderOrigin:e=>(0,Y.jsxs)(Z().Z,{...e,style:c.button,disabled:o,children:[v,(0,Be().i)(c.icon)]})});return(0,Y.jsx)("div",{style:c.wrap,children:(0,Y.jsx)(d()._H,{id:"automationBuilderModal.SourceInput.appliesTo",defaultMessage:"For all pages in {button}",values:{button:x}})})}function et(){const e=(0,i().O7)(),t=(0,d().YB)(),{isMobile:o}=(0,i().Fy)(),n=(0,r().yK)((e=>{const t=o?h().JB.UIRegular.mobile:h().JB.UIRegular.desktop;return{wrap:{color:e.text.secondary,fontSize:t},title:{color:e.text.secondary,fontWeight:h().Ue.medium,fontSize:t}}}),[o]),{collectionStore:l}=(0,oe().P)(),s=(0,a().VK)((()=>(0,ze().vU)({environment:e,intl:t,store:l})),[l,e,t]),c=(0,Y.jsx)("span",{style:n.title,children:s});return(0,Y.jsx)("div",{style:n.wrap,children:(0,Y.jsx)(d()._H,{id:"automationBuilderModal.SourceLabel.appliesTo",defaultMessage:"For {source}",values:{source:c}})})}const tt=(0,d().vU)({deleteButton:{id:"automationBuilderModal.editAutomationView.deleteButton",defaultMessage:"Delete"},createButton:{id:"automationBuilderModal.editAutomationView.createButton.label",defaultMessage:"Create"},saveButton:{id:"automationBuilderModal.editAutomationView.saveButton.label",defaultMessage:"Save"},cancelButton:{id:"automationBuilderModal.editAutomationView.cancelButton.label",defaultMessage:"Cancel"},doneButton:{id:"automationBuilderModal.editAutomationView.doneButton.label",defaultMessage:"Done"},enableButton:{id:"automationBuilderModal.editAutomationView.enableButton.label",defaultMessage:"Enable"},errorsFooterCaption:{id:"automationBuilderModal.editAutomationView.errorCaption",defaultMessage:"Fix errors to enable"}});function ot(){}function nt(e){const{collectionSettingsStore:t,collectionContextStore:o,fullHeight:T,source:w,...A}=e,I=(0,ge().E)("automation_updated_error_states"),[_]=(0,n.useState)((()=>A)),{mode:P}=_,V=(0,d().YB)(),B=(0,i().O7)(),{isMobile:R}=(0,i().Fy)(),{value:K}=(0,N().XJ)(E().F.formulas),{value:Z}=(0,N().XJ)(v().Sm.automationTypecheck),[L,D]=(0,n.useState)([]),O="create"===P,U=(0,he().$)("BuilderModal",{cacheFallback:B.defaultRecordCache.inMemoryRecordCache,isTemporaryData:!0}),W=(0,a().VK)((()=>fe().default.state.currentUserStore),[]),z=(0,a().VK)((()=>null==W?void 0:W.userId),[W]),$=(0,a().VK)((()=>null==W?void 0:W.getDisplayName(V)),[W,V]),q=(0,a().VK)((()=>o.collectionStore()),[o]),J=(0,a().VK)((()=>null==q?void 0:q.getSpaceId()),[q]),Q=(0,a().VK)((()=>null==q?void 0:q.id),[q]),ee=(0,n.useMemo)((()=>"update"===_.mode?_.automationId:(0,me().TS)({environment:B,table:c().cv,spaceId:J})),[_,B,J]),te=(0,a().Kw)(o.aliveAutomationCountStore),oe=(0,a().VK)((()=>{if(J&&q&&z)return new(G().Mz)(B,{id:ee,table:c().cv,spaceId:J})}),[ee,q,z,B,J]),ne=(0,a().VK)((()=>(0,s().XO)(V,$)),[$,V]),ie=(0,a().VK)((()=>{if(!J||!q||!z)return;const e={id:ee,table:c().cv,spaceId:J},t=U.getEntry({pointer:e,userId:z});return t?t.value.value:de().sA({automationId:ee,automationName:"",collectionStore:q,userId:z})}),[ee,q,z,J,U]),{maybePersistedAutomationStore:ae,maybePersistedTransactionActions:re,hasUnpersistedChanges:le}=(0,ke().$)({automationId:ee,spaceId:J,defaultValue:O?ie:void 0,persist:!1}),ce=(0,a().VK)((()=>{if(ae&&(0,pe().Xd)(ae))return ae}),[ae]),Se=(0,a().VK)((()=>(null==ce?void 0:ce.getName())??""),[ce]),je=(0,a().VK)((()=>((null==ce?void 0:ce.getActionStores())??[]).filter((e=>e.isDefined()))),[ce]),Me=(0,a().VK)((()=>(0,pe().Uk)((null==ce?void 0:ce.getTriggerType())??"event")),[ce]),Te=(0,a().VK)((()=>{const e=null==q?void 0:q.getParentBlockStore();return!!e&&e.pathIsDead()}),[q]),we=function(e){const{actionStores:t,automationStore:o,collectionStore:n,loadingStatus:i,mode:r}=e;return(0,a().VK)((()=>"create"===r?"edit":"resolved"===i&&o&&t&&n?(0,de().i1)({automationStore:o,actionStores:t,collectionStore:n})?"edit":(0,de().qM)({automationStore:o,collectionStore:n})?"readonly_with_delete":"readonly":"readonly"),[r,i,o,t,n])}({automationStore:ce,actionStores:je,collectionStore:q,loadingStatus:"resolved",mode:_.mode}),Ae=("readonly_with_delete"===we||"edit"===we&&!O)&&!Te,Pe=(0,a().VK)((()=>!(!ce||!q)&&de().vM({automationStore:ce,collectionStore:q})),[ce,q]),Ve=(0,a().VK)((()=>ce&&K&&Z?(0,be().k)({automationStore:ce,automationTypecheckModule:Z,contextType:Me,formulasModule:K,intl:V}):void 0),[ce,Me,K,Z,V]),Be=(0,a().VK)((()=>!!(q&&ce&&Ve)&&de().qk({automationStore:ce,collectionStore:q,typecheckResult:Ve})),[ce,q,Ve]),Re=(0,a().VK)((()=>!!Ve&&(0,xe().A)({environment:B,typecheckResult:Ve,automationStore:ce})),[ce,B,Ve]),Ke=(0,a().VK)((()=>oe&&K&&Z?(0,be().k)({automationStore:oe,automationTypecheckModule:Z,contextType:Me,formulasModule:K,intl:V}):void 0),[oe,Me,K,Z,V]),Fe=(0,a().VK)((()=>!!(q&&oe&&Ke)&&de().qk({automationStore:oe,collectionStore:q,typecheckResult:Ke})),[q,oe,Ke]),Ze=(0,a().VK)((()=>{if(!ce)return!0;let e;var t;(ce.isTriggerType("event")||ce.isTriggerType("notification_event"))&&(e=null===(t=ce.getEventConfiguration())||void 0===t?void 0:t.pagePropertiesEdited.type);const o=(0,g().$K)(e)&&"none"!==e,n=ce.getActionStores().length>0;if(!n&&!o)return!1;const i=!(0,l().Of)({automationTrigger:ce.getTrigger(),collectionSchema:null==q?void 0:q.getSchema()});if(o&&i)return!0;if(n&&(0,g().$K)(Ve)&&m().x.isSuccess(Ve)){if(Object.keys(Ve.value.actionValidationFailures).some((e=>!L.includes(e))))return!0}return!1}),[ce,q,L,Ve]);!function(e){const{automationStore:t,collectionStoreId:o,source:r}=e,l=(0,i().O7)(),[s,c]=(0,n.useState)(!1),u=(0,a().VK)((()=>(null==t?void 0:t.getActionIds().length)??0),[t]),d=(0,a().VK)((()=>{if(!t||!t.isTriggerType("event")&&!t.isTriggerType("notification_event"))return 0;const e=t.getTriggerStore().getKeyStore("event");let o=0;e.getKeyStore("pagesAdded").getValue()&&o++;const n=e.getKeyStore("pagePropertiesEdited").getValue();if("any"===(null==n?void 0:n.type))o++;else if("some"===(null==n?void 0:n.type)){var i;o+=(null===(i=n.some)||void 0===i?void 0:i.length)??0}else if("all"===(null==n?void 0:n.type)){var a;o+=(null===(a=n.all)||void 0===a?void 0:a.length)??0}return o}),[t]);(0,n.useEffect)((()=>{o&&!s&&t&&((0,H().j)({environment:l,event:{eventName:"automation_configure_view",eventProperties:{automation_id:t.id,automation_total_actions:u,automation_total_triggers:d,collection_id:o,source:r}}}),se().default.logEvent("automation_configure_view","true"),c(!0))}),[l,o,s,u,d,null==t?void 0:t.id,t,r])}({automationStore:ce,collectionStoreId:Q,source:e.source});const Le="edit"===we&&!Te&&!Re,Ee=(0,n.useCallback)((()=>{I&&D([])}),[I]),He=(0,n.useCallback)((()=>{q&&ce&&le&&("create"===P?function(e){const{automationStore:t,collectionSettingsStore:o,collectionStore:n,environment:i,intl:a,from:r}=e;M().aO({automationStore:t,collectionStore:n,environment:i,intl:a,from:r,builderType:"modal"}),f().oV({label:(0,Y.jsx)(d()._H,{id:"automations.editAutomationView.createdConfirmation",defaultMessage:"{automationName} created",values:{automationName:t.getName()}})}),y().z$({collectionSettingsStore:o})}({automationStore:ce,collectionSettingsStore:t,collectionStore:q,environment:B,intl:V,from:_.from}):"update"===P?function(e){const{automationStore:t,collectionSettingsStore:o,collectionStore:n,environment:i,source:a}=e;M().hY({automationStore:t,collectionStore:n,environment:i,builderType:"modal",source:a}),f().oV({label:(0,Y.jsx)(d()._H,{id:"automations.editAutomationView.updatedConfirmation",defaultMessage:"{automationName} updated",values:{automationName:t.getName()}})}),y().z$({collectionSettingsStore:o})}({automationStore:ce,collectionSettingsStore:t,collectionStore:q,environment:B,source:w}):(0,g().t1)(P))}),[ce,t,q,B,le,V,P,_,w]),De=(0,n.useCallback)((async()=>{ce&&q&&!O&&await M().SC({intl:V,environment:B,existingAutomationStore:ce,collectionStore:q,onDelete:()=>{1===te?y().wl({collectionSettingsStore:t,item:{type:"main"}}):y().z$({collectionSettingsStore:t})}})}),[te,ce,t,q,B,V,O]),Oe=(0,n.useCallback)((async()=>{if(le){await M().hL({automationName:Se,hasPendingChanges:le})&&y().z$({collectionSettingsStore:t})}else y().z$({collectionSettingsStore:t})}),[Se,t,le]);ue({shouldInvokeHandler:!0,onClick:Oe,isMobile:R});const Ne=(0,n.useCallback)((e=>{D([e.id])}),[]),Ue=(0,Ce().a)(),We=function(){const{isMobile:e}=(0,i().Fy)(),t=lt();return(0,r().yK)((o=>({header:{backgroundColor:o.surface.elevated,zIndex:u().R1,width:"100%",...e?{paddingBottom:0,paddingTop:0}:{paddingBottom:8,borderBottom:`1px solid ${o.stroke.secondary}`}},nameInput:{...e&&{paddingTop:8}},buttons:{backgroundColor:o.surface.elevated,display:"flex",flexDirection:"row",paddingBottom:e?16:4,paddingTop:12,justifyContent:"space-between",gap:e?"10px":0,width:"100%",zIndex:u().R1,...e&&{paddingLeft:it,paddingRight:it,flexDirection:"column-reverse"}},footerButton:{height:32,width:e?"100%":"auto"},footerErrorCaption:{color:o.text.tertiary,fontSize:h().JB.UISmall.desktop},footerRight:{alignItems:"center",display:"flex",gap:14,justifyContent:"space-between"},automationOptionIconDesktop:{marginInlineStart:12},wrap:{marginTop:e?16:17,marginBottom:e?20:0,paddingBottom:16,width:"100%",flexGrow:1,overflowY:"auto"},closeButtonContainer:{position:"absolute",top:10,right:10,zIndex:u().Ke},closeButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:o.tint.regular,width:24,height:24},closeButtonHover:{background:o.buttonPressedBackground},closeButtonIcon:{width:14,fill:o.icon.secondary},...t})),[e,t])}(),ze=[],Ge=le&&Be;Le&&!R&&ze.push((0,Y.jsxs)(j().Z,{style:We.buttons,mobileStyle:We.buttons,children:[(0,Y.jsx)(C().Z,{onClick:Oe,style:We.footerButton,children:(0,Y.jsx)(d()._H,{...tt.cancelButton})}),(0,Y.jsxs)("div",{style:We.footerRight,children:[I&&!Ge&&Ze&&(0,Y.jsx)("div",{style:We.footerErrorCaption,children:(0,Y.jsx)(d()._H,{...tt.errorsFooterCaption})}),(0,Y.jsx)(k().Z,{onClick:He,onMouseEnter:Ee,disabled:!Ge,style:We.footerButton,children:O?(0,Y.jsx)(d()._H,{...I?tt.enableButton:tt.createButton}):(0,Y.jsx)(d()._H,{...I?tt.doneButton:tt.saveButton})})]})]},"save"));const $e=(0,a().VK)((()=>q&&ce?(0,Y.jsx)(F().gJ,{automationStore:ce,children:(0,Y.jsxs)(ve().$,{value:{collectionStore:q,disabled:!Le,editorPlacement:{type:"inline"},editorWidth:x().P4,maybePersistedTransactionActions:re,onActionAdded:Ne,suppressActionErrors:L,hideDragHandle:Re,cantSaveDueToError:Ze,...Ue},defaultCollapseActions:Re,children:[!R&&(0,Y.jsx)("div",{style:We.closeButtonContainer,children:(0,Y.jsx)(S().Z,{onClick:Oe,style:We.closeButton,hoveredStyle:We.closeButtonHover,children:(0,ye().D)(We.closeButtonIcon)})}),(0,Y.jsx)("div",{style:We.header,children:(0,Y.jsx)(b().Z,{type:b().i.Vertical,initialFocus:void 0,sections:[{key:"automation_top_input",items:(0,p().oA)([{key:"automation_name",action:()=>{},render:e=>(0,Y.jsx)("div",{...e,style:We.nameInput,children:(0,Y.jsx)(Ie,{...e,disabled:!Le,autoSelectAllOnDesktop:Le&&"create"===P,placeholder:ne})})},at({showActiveAutomationToggle:Ae,isPersistedStateComplete:Fe,collectionContextStore:o,canEdit:Le,automationStore:ce})]),render:e=>(0,Y.jsx)(j().Z,{...e,disableMobilePadding:!0,desktopStyle:{paddingTop:0,paddingBottom:0}})}]})}),(0,Y.jsxs)("div",{style:We.wrap,children:[(0,Y.jsx)(X,{collectionStore:q,collectionSettingsStore:t,automationPermissionScope:we,referencesIncompatibleCollectionViewFilter:Pe,requiresSubscriptionUpgrade:Re,onDelete:De}),(0,Y.jsx)(v().IQ,{areActionsEditable:Le,areTriggersEditable:Le})]})]})}):null),[q,ce,Le,re,Ne,L,Re,Ue,R,We,Oe,Ae,Fe,o,Ze,t,we,Pe,De,P,ne]);return(0,Y.jsxs)(_e().b,{handleOnDismiss:Oe,handleOnSave:He,canSave:Ge,mode:P,children:[$e,ze]})}const it=16;function at(e){const{showActiveAutomationToggle:t,isPersistedStateComplete:o,collectionContextStore:n,canEdit:i}=e;return{key:"automation_toggle_and_source",action:ot,render:e=>(0,Y.jsx)(rt,{menuListItemProps:e,showActiveAutomationToggle:t,isPersistedStateComplete:o,collectionContextStore:n,canEdit:i})}}function rt(e){const{menuListItemProps:t,showActiveAutomationToggle:o,isPersistedStateComplete:l,collectionContextStore:s,canEdit:c}=e,u=(0,d().YB)(),{isMobile:p}=(0,i().Fy)(),m=(0,i().O7)(),g=(0,ge().E)("automation_updated_error_states"),h=lt(),y=(0,r().yK)((e=>({wrap:{display:"flex",...p?{flexDirection:"column",justifyContent:"center",alignItems:"flex-start",paddingInline:12,borderBottom:`1px solid ${e.stroke.primary}`,paddingBlock:12,gap:12}:{gap:8,minHeight:24,alignItems:"center"}},toggle:{display:"flex",alignItems:"center",marginLeft:1},...h})),[p,h]),{automationStore:f}=(0,F().YC)(),v=(0,a().VK)((()=>s.collectionStore()),[s]),x=(0,a().VK)((()=>{var e;return(null==f||null===(e=f.getOwnerStore())||void 0===e?void 0:e.getDisplayName(u))??""}),[u,f]),S="active"===(0,a().VK)((()=>(null==f?void 0:f.getStatus())??"disabled"),[f]),b=je(),C=(0,n.useCallback)((()=>{f&&v&&M().j3({automationStore:f,collectionStore:v,environment:m})}),[v,m,f]),k=(0,n.useCallback)((()=>{f&&v&&M().$K({automationStore:f,collectionStore:v,environment:m})}),[v,m,f]),j=(0,a().VK)((()=>!l||(0,Se().HH)(f)),[f,l]);return(0,Y.jsxs)("div",{...t,style:y.wrap,children:[(l||g&&!S)&&o&&(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)("div",{style:y.toggle,children:(0,Y.jsx)(le,{automationId:f.id,automationOwner:x,isAutomationPaused:!S,onPause:C,onResume:k,disabled:j})}),(0,Y.jsx)("div",{style:y.verticalDivider})]}),b?(0,Y.jsx)(Qe,{disabled:!c,collectionContextStore:s}):(0,Y.jsx)(et,{})]})}function lt(){const{isMobile:e}=(0,i().Fy)();return(0,r().yK)((t=>({verticalDivider:{background:t.stroke.secondary,height:16,width:1,borderRadius:1,display:e?"none":"block"}})),[e])}var st=()=>o(636340),ct=()=>o(269853),ut=()=>o(882886);const dt=(0,d().vU)({placeholder:{id:"automations.builderModal.buttonBuilderLabelInput.placeholder",defaultMessage:"Enter a name"},loading:{id:"automations.builderModal.buttonBuilderLabelInput.loading",defaultMessage:"Loading..."}}),pt=(0,n.forwardRef)((function(e,t){let{disabled:o,buttonName:a,handleNameChange:l,handleBlur:s,handleSubmit:c,...u}=e;const p=(0,d().YB)(),{isMobile:m}=(0,i().Fy)(),g=(0,r().yK)((e=>({buttonNamePropertyInput:{marginBlockEnd:0,boxShadow:"none"},buttonNameText:{marginInlineStart:m?12:0,marginInlineEnd:m?12:18},inputOuterStyle:{background:"transparent",boxShadow:"unset"}})),[m]),h=(0,n.useCallback)((e=>{l(e)}),[l]),y=(0,n.useCallback)((e=>{s(e.target.value)}),[s]),f=(0,n.useCallback)((()=>{c(a)}),[c,a]);return(0,Y.jsx)(we().ZP,{style:g.buttonNamePropertyInput,...u,value:a??p.formatMessage(dt.loading),onChange:h,disabled:o,ref:t,inputOuterStyle:g.inputOuterStyle,format:Te().B.ExtraLarge,textWrapperStyle:g.buttonNameText,placeholder:p.formatMessage(dt.placeholder),onBlur:y,onSubmit:f,autoFocus:!a})}));var mt=()=>o(516463);const gt=(0,d().vU)({saveButton:{defaultMessage:"Save",id:"database.buttonProperty.saveButtonLabel"},noEditError:{defaultMessage:"You don't have full access to edit this button",id:"database.buttonProperty.noEditError"}});function ht(e){const{collectionContextStore:t,propertySchema:o}=e,i=(0,a().VK)((()=>t.collectionStore()),[t]),r=(0,a().VK)((()=>null==i?void 0:i.getSpaceId()),[i]),l=(0,n.useMemo)((()=>{const e=o.automation_id;if(e&&r)return{id:e,spaceId:r,table:c().cv}}),[o.automation_id,r]);return(0,ut().N)(i,l)?(0,Y.jsx)(yt,{...e}):(0,Y.jsx)(mt().Z,{})}function yt(e){const{collectionContextStore:t,collectionSettingsStore:o,propertyId:l,propertySchema:s}=e,{isMobile:c}=(0,i().Fy)(),p=(0,i().O7)(),[m,g]=(0,n.useState)([]),h=(0,a().VK)((()=>t.collectionStore()),[t]),f=(0,a().VK)((()=>null==h?void 0:h.getSpaceId()),[h]),C=(0,a().VK)((()=>t.getPropertyFormatKey()),[t]),{maybePersistedAutomationStore:M,maybePersistedTransactionActions:T}=(0,ke().$)({automationId:s.automation_id,spaceId:f,defaultValue:void 0,persist:!0}),w=(0,a().VK)((()=>null==M?void 0:M.getTrigger()),[M]),A=(0,ct().C6)({automationStore:M,propertyId:l,propertySchema:s}),I=(0,a().VK)((()=>{var e;return"sufficient"===(null==A||null===(e=A.state)||void 0===e?void 0:e.editPermissionStatus)}),[A]),_=(0,a().VK)((()=>{var e;return!(null==A||null===(e=A.state)||void 0===e||!e.typecheckResult)&&(0,xe().A)({environment:p,typecheckResult:A.state.typecheckResult,automationStore:M})}),[A,p,M]),P=(0,a().VK)((()=>(null==M?void 0:M.getNameStore().getValue())??s.name),[M,s.name]),V=(0,a().VK)((()=>"collectionTypedView"===t.contextType),[t]),B=(0,n.useCallback)((e=>{if(!M)return;const t=e.currentTarget.value;T.createAndCommit({userAction:"ButtonBuilderModal.setName",perform:e=>{st().sO({store:M.getNameStore(),transaction:e,value:t})}})}),[M,T]),Z=(0,n.useCallback)((e=>{g((t=>[...t,e.id]))}),[]),L=(0,Ce().a)(),E=function(){const{isMobile:e}=(0,i().Fy)();return(0,r().yK)((t=>({header:{backgroundColor:"transparent",borderBottom:`1px solid ${t.stroke.secondary}`,paddingBottom:8,paddingTop:Ct,position:"absolute",top:0,width:`calc(100% - ${2*bt}px)`,zIndex:u().R1,...e&&{paddingBottom:0,paddingTop:0,width:"100%"}},buttons:{backgroundColor:"dark"===t.mode?t.accentColors.gray[100]:t.white,display:"flex",gap:4,paddingBlock:`${Ct}px ${bt}px`,position:"absolute",bottom:0,width:`calc(100% - ${2*bt}px)`,zIndex:u().R1,...e&&{paddingLeft:bt,paddingRight:bt,flexDirection:"column-reverse",width:"100%"}},label:{paddingTop:e?"10px":0},closeButtonContainer:{position:"absolute",top:10,right:10,zIndex:u().Ke},closeButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:t.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:t.buttonPressedBackground},closeButtonIcon:{width:16,fill:t.mediumTextColor},wrap:{overflowY:"auto",overflowX:"hidden",marginTop:e?xt:ft,marginBottom:e?St:vt,paddingInline:e?0:2,width:"100%"},desktopButtonLabelNameContainer:{paddingLeft:0,paddingRight:0,color:t.lightTextColor},mobileButtonLabelNameContainer:{paddingTop:Ct,paddingBottom:4,paddingLeft:bt,paddingRight:bt,color:t.lightTextColor},buttonLabelNameTextWrapperStyle:{marginLeft:e?bt:0,marginRight:e?bt:0},footerButton:{height:32,width:"100%"},inputStyle:{background:"transparent"},inputOuterStyle:{background:"transparent"}})),[e])}(),H=(0,n.useCallback)((()=>{y().FK({collectionSettingsStore:o,item:{type:"property",property:l,formatKey:C,showBuilderModal:!1}})}),[o,C,l]),D=(0,n.useCallback)((()=>{$().y(p,{from:"button_property_automation_header_message",upsell:{type:"product",product:"plus",limit:{type:"none"}}})}),[p]);ue({shouldInvokeHandler:!0,onClick:H,isMobile:c});const O=(0,n.useCallback)((e=>{M&&T.createAndCommit({userAction:"ButtonBuilderModal.setName",perform:t=>{st().sO({store:M.getNameStore(),transaction:t,value:e})}})}),[M,T]),N=(0,n.useMemo)((()=>h&&M&&w&&"button"===w.type?(0,Y.jsx)(F().Jj,{automationStore:M,contextType:"button_property",children:(0,Y.jsxs)(ve().$,{value:{collectionStore:h,disabled:!I,editorPlacement:{type:"inline"},editorWidth:x().P4,maybePersistedTransactionActions:T,onActionAdded:Z,suppressActionErrors:m,hideDragHandle:_,...L},defaultCollapseActions:_,children:[!c&&(0,Y.jsx)("div",{style:E.closeButtonContainer,children:(0,Y.jsx)(S().Z,{onClick:H,style:E.closeButton,hoveredStyle:E.closeButtonHover,children:(0,ye().D)(E.closeButtonIcon)})}),(0,Y.jsx)("div",{style:E.header,children:(0,Y.jsx)(b().Z,{type:b().i.Vertical,initialFocus:void 0,sections:[{key:"automation_top_input",items:[{key:"automation_name",action:()=>{},render:e=>(0,Y.jsx)(pt,{...e,disabled:V,buttonName:P,handleNameChange:B,handleBlur:O,handleSubmit:O})}],render:e=>(0,Y.jsx)(j().Z,{...e,disableMobilePadding:!0,shouldShowBottomDivider:!0,desktopStyle:{paddingTop:0}})}]})}),(0,Y.jsxs)("div",{style:E.wrap,children:[_&&(0,Y.jsx)(K().c,{onUpsellClick:D}),!I&&(0,Y.jsx)(R().k,{children:(0,Y.jsx)(d()._H,{...gt.noEditError})}),(0,Y.jsx)(v().IQ,{areActionsEditable:!_,areTriggersEditable:!1})]})]})}):null),[M,P,h,V,B,H,O,I,c,T,Z,E,m,w,L,_,D]),U=c?(0,Y.jsx)(n.Fragment,{}):(0,Y.jsx)(j().Z,{mobileStyle:E.buttons,style:E.buttons,children:(0,Y.jsx)(k().Z,{onClick:H,disabled:!I,style:E.footerButton,children:(0,Y.jsx)(d()._H,{...gt.saveButton})})});return h&&M&&w&&"button"===w.type?(0,Y.jsxs)(_e().b,{handleOnDismiss:H,canSave:!0,mode:"button_property",handleOnSave:H,children:[N,U]}):null}const ft=60,vt=60,xt=60,St=60,bt=16,Ct=12},887766:(e,t,o)=>{o.d(t,{Z:()=>d});o(667294);var n=()=>o(846550),i=()=>o(38883),a=()=>o(955620),r=()=>o(793041),l=()=>o(338217),s=()=>o(519710),c=()=>o(563701),u=o(785893);function d(e){let{handleRemoveToken:t,token:o,type:d,format:p,style:m,isDisabled:g}=e;const h=(0,a().pxR)(o).name,y=(0,n().Fg)();if(!h)return null;let f;switch(d){case"person":f=c().O;break;case"email":f=s().n;break;default:f=l().J}return(0,u.jsx)(r().ZP,{title:h,renderAvatar:e=>f({width:e,height:e,padding:2,marginRight:6}),style:{background:y.accentColors.gray[75],padding:"2px 4px",...m},showRemoveButton:Boolean(t)&&!g,onClickRemove:e=>{null==e||e.stopPropagation(),t&&t(o)},format:p??i().lo.Small,shouldShrink:!0,isSingle:!1})}},200027:(e,t,o)=>{o.d(t,{A:()=>r});o(267602),o(228244);var n=()=>o(855741),i=()=>o(696459),a=()=>o(150275);function r(e){const{environment:t,typecheckResult:o,automationStore:r}=e,l=null==r?void 0:r.getTriggerType();if((0,i().$K)(l)){if(!(0,a().n)({triggerType:l,environment:t,automationStore:r}))return!0}return!n().x.isFail(o)&&Object.values(o.value.actionValidationFailures).some((e=>null==e?void 0:e.some((e=>"requires_subscription_upgrade"===e.type))))}},492135:(e,t,o)=>{o.d(t,{a:()=>i});var n=o(667294);function i(){const[e,t]=(0,n.useState)(void 0),o=(0,n.useCallback)((e=>t(e.id)),[]),i=(0,n.useCallback)((()=>t(void 0)),[]);return(0,n.useMemo)((()=>({currentDraggingActionId:e,onActionDragStart:o,onActionDragEnd:i})),[e,i,o])}},985571:(e,t,o)=>{o.d(t,{w:()=>l});var n=o(667294),i=()=>o(855741),a=()=>o(583352),r=()=>o(637118);function l(e){const t=(0,r().DZ)();return{onTextStoreSelect:(0,n.useMemo)((()=>{if(t.defined&&i().x.isSuccess(t.typecheckResult)){const{automationStore:o,contextType:n,typecheckResult:i}=t;return function(){a().Z.focus({automationStore:o,contextType:n,typecheckResult:i.value,automationActionStore:e})}}}),[e,t]),onTextStoreUnselect:(0,n.useMemo)((()=>{if(t.defined&&i().x.isSuccess(t.typecheckResult)){const{automationStore:o,contextType:n,typecheckResult:i}=t;return function(){a().Z.blur({automationStore:o,contextType:n,typecheckResult:i.value,automationActionStore:e})}}}),[e,t])}}},210968:(e,t,o)=>{o.d(t,{p:()=>c});o(267602),o(653476);var n=()=>o(142735),i=()=>o(969583),a=()=>o(473304),r=()=>o(985575),l=()=>o(749826),s=()=>o(637118);function c(){const{automationStore:e,contextType:t}=(0,s().YC)(),o=(0,n().VK)((()=>(0,r().uV)(e,t)),[e,t]);return(0,n().VK)((()=>{if(!o)return[];const{automation:e,automationActions:t}=o;let n=e.getTriggerType();"notification_event"===n&&(n="event");const r=(0,a().PQ)({isGenericRecurrenceAllowed:l().default.checkGate({gateName:"automation_generalized_recurrence"})})[n],s="default_bound"===r.max?a().xZ:r.max;if(t.length>=s)return[];return function(e){const t=e=>e?1:-1;return e.slice().sort(((e,o)=>t(o.hasSideEffects)-t(e.hasSideEffects)))}((0,i().getActionRegistryItemsWithConcern)("display").filter((e=>e.isAvailableForContext({...o,isSubscribed:!0}))))}),[o])}},576447:(e,t,o)=>{o.d(t,{Z:()=>i});o(667294);var n=o(785893);const i=function(e){const{title:t,href:i,analyticsFrom:a}=e,r=(0,o(219727).O7)();return(0,n.jsx)(o(108714).Z,{href:i,onClick:()=>o(407391).Fs(r,{from:a}),external:!0,children:(0,n.jsx)(o(446955).Z,{icon:o(653457).m,title:t,isGray:!0})})}},508858:(e,t,o)=>{o.d(t,{Z:()=>p});o(267602),o(470928),o(241792);var n=o(667294),i=()=>o(142735),a=()=>o(513670),r=()=>o(448419),l=()=>o(255577),s=()=>o(967092),c=()=>o(388284),u=()=>o(352230),d=o(785893);const p=function(e){let{icon:t,iconStyle:p,title:m,selectedKey:g,onChange:h,onClick:y,popupStyle:f,menuItemOptionsStyle:v,menuStyle:x,disabled:S,collectionContextStore:b,openButtonPopup:C,hideCheck:k,children:j,disableParentClose:M,inputPlaceholder:T,...w}=e;const A=(0,o(219727).Fy)(),I="options"in w?w.options:a().xH(w.sections),_=I.find((e=>a().Xy(e.key,g))),P=(0,i().qz)(void 0,o(529048).Z),V=(0,i().Kw)(P);return(0,n.useEffect)((()=>{b&&C&&(P.setState({...P.state,open:C}),b.settingsStore.setState({...b.settingsStore.state,openButtonPopup:void 0})),_||o(799891).log({level:"error",from:"CollectionSettingsPickListMenuItem",type:"InvalidSelectedItem",error:(0,o(792409).Ui)("Selected key is invalid.")})})),(0,d.jsx)(r().ZP,{popupType:A.isMobile?s().kQ.SlideUp:s().kQ.Popup,alignmentToOrigin:r().vR.End,placementToOrigin:r().pO.Bottom,style:f,originGap:0,buttonPopupStore:P,disabled:S,onClick:y,renderOrigin:e=>(0,d.jsx)(o(446955).Z,{title:m,showChevron:!0,right:(0,d.jsx)("span",{style:o(707513).Yu,children:"input"===(null==_?void 0:_.type)?_.inputValue:null==_?void 0:_.title}),rotateChevron:V.open,disabled:S,icon:t,iconStyle:p,...(0,o(164079).Z)(e,w)}),render:e=>{let t;t=A.isMobile?{menuType:u().o.ActionSheet}:{menuType:u().o.Popup,width:250,...x};const n=(t,n)=>{if(t.hideOption)return null;let i;return i="input"===t.type?{key:n,render:n=>(0,d.jsx)(o(740046).ZP,{...n,style:{width:"100%",paddingTop:4,paddingBottom:4},value:t.inputValue??"",onChange:e=>{var o;null===(o=t.onChange)||void 0===o||o.call(t,e.target.value)},onSubmit:o=>{var n;null===(n=t.onSubmit)||void 0===n||n.call(t,t.key,e,t.inputValue),e.close()},placeholder:T,checkState:!k&&a().Xy(t.key,g)}),action:()=>{}}:{key:n,render:e=>(0,d.jsx)(o(827973).Z,{...e,disabled:!1,title:t.title,icon:t.icon,caption:t.caption,captionStyle:t.captionStyle,inline:t.captionInline,spacerStyle:t.inlineSpacerStyle,body:t.body,style:v,checkState:!k&&a().Xy(t.key,g)}),action:()=>{h(t.key,e),M||e.close()}},i},i="sections"in w?w.sections.map(((e,t)=>({key:t,render:e=>(0,d.jsx)(c().Z,{enableActionSheetTitle:!0,topBorder:t>0,...e}),items:a().oA(e.map(n))}))):[{key:0,render:e=>(0,d.jsx)(c().Z,{enableActionSheetTitle:!0,...e}),items:a().oA(I.map(n))}];return(0,d.jsxs)(o(198829).Z,{...t,children:[(0,d.jsx)(l().Z,{type:l().i.Vertical,sections:i,initialFocus:0,resetFocusOnMouseOut:!0}),j||null]})}})}},477253:(e,t,o)=>{o.d(t,{Z:()=>i});o(667294);var n=o(785893);const i=function(e){let{switcherProps:t,...i}=e;return(0,n.jsx)(o(446955).Z,{right:(0,n.jsx)(o(471645).Z,{onClick:i.onClick,disabled:i.disabled,...t}),...i})}},493843:(e,t,o)=>{o.d(t,{$o:()=>W,Fv:()=>E,IL:()=>Y,J4:()=>D,KA:()=>Z,Nf:()=>F,_p:()=>X,cQ:()=>z,f$:()=>H,fX:()=>U,j2:()=>K,k2:()=>$,mg:()=>J,mz:()=>N,oP:()=>L,tF:()=>q,td:()=>O,x:()=>G});o(670560),o(267602),o(470928),o(30005),o(241792),o(228244);var n=()=>o(730120),i=()=>o(492788),a=()=>o(506347),r=()=>o(926724),l=()=>o(331540),s=()=>o(874459),c=()=>o(998411),u=()=>o(35980),d=()=>o(513670),p=()=>o(696459),m=()=>o(250303),g=()=>o(384667),h=()=>o(366257),y=()=>o(139224),f=()=>o(421654),v=()=>o(636340),x=()=>o(531515),S=()=>o(47443),b=()=>o(794586),C=()=>o(879952),k=()=>o(970105),j=()=>o(990966),M=()=>o(269299),T=()=>o(932753),w=()=>o(887430),A=()=>o(861026),I=()=>o(804217),_=()=>o(826955),P=()=>o(965903),V=()=>o(807230),B=()=>o(701182),R=()=>o(645843);function K(e){const{collectionViewStore:t,collectionContextStore:o,timelineState:n,environment:i}=e,a=i.currentUser.id,r=(0,B().B8)(t.id),l=(0,B().pQ)(t,i),s=o.permissionScopesStore.state,c=d().Ds((()=>{if(n.destroyed)return;const e={zoomLevel:n.zoomLevel.state,centerTimestamp:(0,B().al)(n)};u().Z.set({userId:a,key:r,value:e})}),1e3),p=d().Ds((()=>{if(n.destroyed||!I().default.state.online||!i.currentUser.isLoggedIn()||!s.canConfigureBlock)return;const e={zoomLevel:n.zoomLevel.state,centerTimestamp:(0,B().al)(n)},o=t.getFormat().timeline_preference;d().Xy(o,e)||M().createAndCommit({userAction:"collectionTimelineViewActions.setRemotePreference",environment:i,canUndo:!0,perform:o=>{f().FH({stores:[t],update:{timeline_preference:e},transaction:o})}})}),5e3);n.savePreference=()=>{c(),p()},F({timelineState:n,environment:i,...l})}function F(e){const{timelineState:t,zoomLevel:o,centerTimestamp:n,environment:a}=e,{savePreference:r}=t,l=a.WindowSizeStore.state.width+2*B().Ge,s=(0,B().x2)(o,l),c=n-s/2,u=n+s/2;t.zoomLevel.setState(o),t.currentRange.setState({startTimestamp:c,endTimestamp:u}),i().default.afterNextFlush((()=>{Z({timelineState:t,centerTimestamp:n}),r&&r()}))}function Z(e){const{timelineState:t,centerTimestamp:o}=e,{horizontalScroller:n,outerSizeObserver:i}=t;if(!n)return;const a=t.zoomLevel.state,{startTimestamp:r,endTimestamp:l}=t.currentRange.state,s=i.rect.state.width;if(s===(0,B().e$)(a,l-r))return;const c=(0,B().e$)(a,o-r)-s/2;n.scrollLeft=c,t.scrollLeft.setState(c)}function L(e){const{environment:t,store:o,query:n,date:i,schema:a,transaction:r}=e,{timeline_by:l}=n;if(!l)return;const s=o.getAssociatedCollectionStore(),c=(null==s?void 0:s.getMappedProperty(l))??l,u=n.timeline_by_end?(null==s?void 0:s.getMappedProperty(n.timeline_by_end))??n.timeline_by_end:void 0,d=(0,B().TW)({store:o,dateValue:i,query:n,schema:(null==s?void 0:s.getSchema())??a}),p=o.getPropertyValue(c),m=u?o.getPropertyValue(u):void 0;return v().sW({store:o.getPropertiesStore(),data:d,transaction:r}),h().H({environment:t,store:o,dateProperty:{id:c,newValue:(null==d?void 0:d[c])??[],oldValue:p},otherDateProperty:u?{id:u,newValue:(null==d?void 0:d[u])??[],oldValue:m}:void 0}),o}function E(e){var t;const{environment:o,timelineState:i,collectionStore:a,collectionContextStore:r,store:l,query:u,groupFormat:d,transaction:p}=e,m=i.zoomLevel.state,h=(0,B().al)(i),{snapUnit:y,getDateRangePlaceholderDuration:f}=B().BJ[m],{timeline_by:v}=u;if(!v)return;const x=null===(t=r.groupsStore.getGroupState(d))||void 0===t?void 0:t.resultsStore.state;if(!x)return;const S=n().ou.fromMillis(h),b=(0,B().DS)(S,y),C=(0,B().DS)(f(S),y),k=(0,B().AZ)({startValue:(0,s().Lg)((0,c().r)()),snapUnit:y,desiredStart:b,desiredEnd:C});return L({environment:o,store:l,query:u,schema:a.getSchema(),date:k,transaction:p}),g().$T({environment:o,collectionStore:a,before:!0,store:x[0],insertStores:[l],collectionContextStore:r,groupsPointer:d?[d]:[],transaction:p}),l}function H(e){const{type:t,timelineState:o,store:n,startX:i,query:a,schema:r,intl:l,environment:s}=e,{horizontalScroller:c}=o,{startTimestamp:u}=o.currentRange.state;if(!c)return;C().Ys({environment:s,store:n});const p=c.scrollLeft,{stores:m}=P().default.state,g=d().oA(m.map((e=>{const t=(0,B().bk)({store:e,query:a,schema:r,userId:s.currentUser.id,intl:l,formulasModule:void 0});if(t)return{startValue:t,store:e}})));o.dragState.setState({type:t,startStore:n,stores:g.map((e=>{let{store:t}=e;return t})),startValues:g.map((e=>{let{startValue:t}=e;return t})),temporaryValues:g.map((e=>{let{startValue:t}=e;return t})),startX:i,startStartTimestamp:u,startScrollLeft:p})}function D(e){const{timelineState:t,store:o,startX:n,startY:i,schema:a,collectionContextStore:r,verticalScroller:l}=e,{horizontalScroller:s}=t,{startTimestamp:c}=t.currentRange.state;if(!s||!l)return;const u=s.scrollLeft,d=l.scrollTop,p=(0,B().YE)(r,o,a);t.drawState.setState({startStore:o,startDependencyRelationPointers:p,temporaryDependencyRelationPointers:[...p],startX:n,startY:i,startScrollLeft:u,startScrollTop:d,startStartTimestamp:c,xOffsetPx:0,yOffsetPx:0,tryToCompleteDrawnArrow:!1})}function O(e){const{timelineState:t,currentX:o}=e,{horizontalScroller:n}=t,i=t.zoomLevel.state,a=t.dragState.state,{startTimestamp:r}=t.currentRange.state;if(!a||!n)return;const{type:l,startStartTimestamp:c,startValues:u,startScrollLeft:m,startX:g,startStore:h,stores:y}=a,f=B().BJ[i],{snapUnit:v}=f,x=n.scrollLeft-m+(o-g)+(0,B().e$)(i,r-c),S=(0,B().x2)(i,x),b=u[y.indexOf(h)];let C;if(l===B().px.LeftResizer){const{start:e}=(0,B().XO)(b,v),t=e.plus(S);C=u.map((e=>{const o=(0,B().AZ)({startValue:e,snapUnit:v,desiredStart:t});return(0,s().gW)(o)}))}else if(l===B().px.RightResizer){const{end:e}=(0,B().XO)(b,v),t=e.plus(S);C=u.map((e=>{const o=(0,B().AZ)({startValue:e,snapUnit:v,desiredEnd:t});return(0,s().Qq)(o)}))}else l===B().px.ItemDrag?C=u.map((e=>{const{start:t,end:o}=(0,B().XO)(e,v),n=t.plus(S),i=n.plus(o.valueOf()-t.valueOf());return(0,B().AZ)({startValue:e,snapUnit:v,desiredStart:n,desiredEnd:i})})):(0,p().t1)(l);d().Xy(a.temporaryValues,C)||t.dragState.setState({...a,temporaryValues:C})}function N(e){const{timelineState:t,currentX:o,currentY:n,verticalScroller:i}=e,a=t.drawState.state,r=t.zoomLevel.state,{startTimestamp:l}=t.currentRange.state,{horizontalScroller:s}=t;if(!a||!s||!i)return;const{startDependencyRelationPointers:c,startStore:u,startX:p,startY:m,startScrollLeft:g,startScrollTop:h,startStartTimestamp:y}=a,f=s.scrollLeft,v=i.scrollTop,x=f-g+(o-p)+(0,B().e$)(r,l-y),S=v-h+(n-m),b=t.hoveredItem.state;if(b&&b!==u&&!c.some((e=>e.id===b.id))){const e=[...c,{table:"block",id:b.id,spaceId:b.getSpaceId()}];d().Xy(a.temporaryDependencyRelationPointers,e)||t.drawState.setState({...a,temporaryDependencyRelationPointers:e,xOffsetPx:void 0,yOffsetPx:void 0})}else t.drawState.setState({...a,temporaryDependencyRelationPointers:[...c],xOffsetPx:x,yOffsetPx:S})}function U(e){const{environment:t,collectionContextStore:o,timelineState:n,query:i,schema:a,transaction:r}=e,l=n.dragState.state,{timeline_by:s}=i;if(!l||!s)return;const{temporaryValues:c,stores:u}=l;c.forEach(((e,n)=>{const l=u[n];L({environment:t,store:l,query:i,schema:a,transaction:r,date:e}),m().rv({environment:t,collectionContextStore:o,block_id:l.id,property:s,property_type:"date",from:"timeline"})})),n.dragState.setState(void 0)}function W(e){var t;const{timelineState:o,environment:n,transaction:i,collectionContextStore:a,isFullScreen:r,isRootChild:l}=e,s=o.drawState.state,c=o.dateRangePlaceholder.state;if(!s)return;const{startStore:u,startDependencyRelationPointers:d,temporaryDependencyRelationPointers:p}=s;if(!u)return void o.drawState.setState(void 0);let g;if(c.active){const{date:e,store:t,parentStore:r,groupFormat:l,newTimelineItemProps:s,existingTimelineItemProps:d}=c;if(t&&d){const{query:o,schema:a}=d;L({environment:n,store:t,query:o,schema:a,date:e,transaction:i}),g={table:"block",id:t.id,spaceId:u.getSpaceId()}}else if(s){const{query:o,schema:c,isFullScreen:d,canEditTimelineItems:p,subitemPath:m}=s,h=J({environment:n,date:e,store:t,parentStore:r,query:o,schema:c,isFullScreen:d,groupFormat:l,canEditTimelineItems:p,collectionContextStore:a,subitemPath:m,transaction:i,from:"timeline_complete_draw"});h&&(g={table:"block",id:h.id,spaceId:u.getSpaceId()})}o.dateRangePlaceholder.setState({active:!1})}else g=p.find((e=>!d.includes(e)));const h=(0,B()._e)(a);if(h){const{property:e}=h;g&&(x().hE({environment:n,propertyWithInverse:h,sourceStore:u,destStore:_().G.createChildStore(u,g),position:{type:"after"},transaction:i}),m().rv({environment:n,collectionContextStore:a,block_id:u.id,property:e,property_type:"relation",from:"timeline",isFromBulkActionsToolbar:!1,isUnthrottled:!0})),o.drawState.setState(void 0)}else y().wl({item:{type:"dependencies",from:"view_options"},collectionSettingsStore:a.settingsStore}),o.drawState.setState({...s,tryToCompleteDrawnArrow:!0});const f=null===(t=g)||void 0===t?void 0:t.id;f&&(0,R().LE)(n,{...(0,A().Pn)(a),...(0,R().Ii)({environment:n,collectionContextStore:a,timelineState:o,isFullScreen:r,isRootChild:l}),dependenciesPropertyID:null==h?void 0:h.property,blockedByStoreID:u.id,blockingStoreID:f})}function z(e){const{timelineState:t,environment:o}=e;t.dragState.state&&(t.dragState.setState(void 0),C().ZH({environment:o}))}function G(e){const{timelineState:t,environment:o}=e;t.drawState.state&&(t.drawState.setState(void 0),C().ZH({environment:o}))}function $(e){const{stores:t,collectionViewStore:o,schema:n,transaction:i}=e,a=o.getType(),r=o.getQuery(n),l=[];r&&("calendar"===a?r.calendar_by&&l.push(r.calendar_by):"timeline"===a&&(r.timeline_by&&l.push(r.timeline_by),r.timeline_by_end&&l.push(r.timeline_by_end)));for(const s of t)for(const e of l)k().sO({environment:s.environment,store:s.getPropertyStore(e),value:void 0,transaction:i})}function Y(e){const{dependency:t,collectionContextStore:o,environment:n,timelineState:i,isFullScreen:a,isRootChild:r}=e,l=(0,B()._e)(o),s=o.collectionStore();if(!l||!s)return;const{property:c}=l,{store:u,relationPointer:d}=t,p=u.getSchema()[c];p&&"relation"===p.type&&(M().createAndCommit({userAction:"CollectionTimelineDependenciesOverlay.handleRemoveRelation",environment:n,canUndo:!0,perform:e=>{x().Bl({environment:n,propertyWithInverse:l,sourceStore:u,destStore:_().G.createChildStore(u,d),transaction:e}),m().rv({environment:n,block_id:d.id,property:c,property_type:p.type,from:"timeline",collectionContextStore:o,isFromBulkActionsToolbar:!1,isUnthrottled:!0})}}),(0,R().lf)(n,{...(0,A().Pn)(o),...(0,R().Ii)({environment:n,collectionContextStore:o,timelineState:i,isFullScreen:a,isRootChild:r}),dependenciesPropertyID:c,blockedByStoreID:u.id,blockingStoreID:d.id}))}function q(e){const{collectionViewStore:t,newProperty:o,transaction:n}=e;f().FH({stores:[t],update:{timeline_arrows_by:{property:o}},transaction:n})}function X(e){var t;const{collectionContextStore:o,relationPropertyId:n,transaction:i}=e,a=o.collectionStore();if(!a)return;const s=n?a.getSchema()[n]:void 0,c="relation"===(null==s?void 0:s.type)&&s.property&&"relation"===(null===(t=a.getSchema()[s.property])||void 0===t?void 0:t.type)?s.property:void 0;f().FH({stores:[a],update:{collection_default_arrows_by:n,...a.getFormat().app_config_uri===l().iS?{app_uri_map:{...a.getFormat().app_uri_map?a.getFormat().app_uri_map:{},[r().Es.BlockingRelation]:n,[r().Es.BlockedRelation]:c}}:{}},transaction:i})}function J(e){const{environment:t,transaction:o,date:n,parentStore:i,query:r,schema:l,isFullScreen:s,groupFormat:c,canEditTimelineItems:u,collectionContextStore:d,from:p}=e;if(!(0,V().ww)(t))return;const m=c?[c]:[],h=d.groupsStore.getGroupState(m);if(!h)return;if(i)return function(e){const{environment:t,transaction:o,date:n,store:i,parentStore:r,query:l,schema:s,groupFormat:c,canEditTimelineItems:u,collectionContextStore:d,subitemPath:p}=e;if(!i||!r)return;const m=c?[c]:[],h=g().yk({environment:t,collectionContextStore:d,groupsPointer:m,store:i,before:!1,collectionStore:r,transaction:o,subitemPath:p,subitemInsertDirection:"into"});if(h){if(L({environment:t,store:h,query:l,schema:s,date:n,transaction:o}),t.device.isMobile)S()._c({environment:t,store:h,pageVisitSource:a().tY.Create});else if(h&&u){const e=h.getBlockTitleStore();j().setSelectionAtStart({store:e})}return h}}(e);d.searchQueryStore.state&&T().Ug({searchQuery:"",collectionContextStore:d,isFullScreen:s});const y=g().IW({environment:t,collectionContextStore:d,groupsPointer:m,shouldCoerce:!0,templateStore:d.defaultPageTemplateStore.state,transaction:o,from:{createBlock:p},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache});if(!y)return;const f=y.coercionSucceeded,v=y.newStore;if(L({environment:t,store:v,query:r,schema:l,date:n,transaction:o}),t.device.isMobile)S()._c({environment:t,store:v,pageVisitSource:a().tY.Create});else if(f&&u){const e=v.getBlockTitleStore();j().setSelectionAtEnd({store:e})}else b().CH({environment:t,store:v,peekMode:(0,w().kr)(d),resultsStore:null==h?void 0:h.resultsStore,collectionContextStore:d,pageVisitSource:a().tY.Create});return v}},645843:(e,t,o)=>{o.d(t,{Al:()=>s,CB:()=>c,H6:()=>l,Ii:()=>g,LE:()=>p,gw:()=>u,iR:()=>a,lf:()=>m,ne:()=>d,zI:()=>r});o(267602),o(653476);var n=()=>o(594546),i=()=>o(701182);function a(e,t){n().lu(e,"timeline_view","timeline_view",5,t)}function r(e,t){n().K4(e,"timeline_zoom_level_update",t)}function l(e,t){n().K4(e,"timeline_today_click",t)}function s(e,t){n().K4(e,"timeline_shift_time_click",t)}function c(e,t){n().K4(e,"timeline_toggle_table_click",t)}function u(e,t){n().K4(e,"timeline_item_scroll_arrow_click",t)}function d(e,t){n().K4(e,"timeline_item_resize",t)}function p(e,t){n().K4(e,"timeline_dependency_arrow_add",t)}function m(e,t){n().K4(e,"timeline_dependency_arrow_delete",t)}function g(e){const{environment:t,collectionContextStore:o,timelineState:n,isFullScreen:a,isRootChild:r}=e,l=n.zoomLevel.state,s=o.normalizedFormatStore.state,c=(0,i().C1)({environment:t,format:s,isFullScreen:a,isRootChild:r}),u=c&&s.timeline_table_properties?s.timeline_table_properties.length:0,d=s.timeline_properties||[],p=d.filter((e=>"title"!==e.property));return{zoom_level:l,show_table:c,show_table_properties_count:u,show_timeline_title:d.length!==p.length,show_timeline_properties_count:p.length}}},788899:(e,t,o)=>{o.d(t,{Tp:()=>g,cn:()=>u,fg:()=>p,l0:()=>d});o(667294);var n=()=>o(219727),i=()=>o(573357),a=()=>o(198829),r=()=>o(18748),l=()=>o(470386),s=()=>o(352230),c=o(785893);const u=8,d=8,p=32,m={height:p+u-2,paddingTop:u-2};function g(e){let{title:t,helpButton:o,onCancel:r,desktopMinWidth:u,desktopMaxWidth:d,desktopWidth:p,children:m}=e;const{device:g}=(0,n().O7)();return(0,c.jsx)(i().Z,{capture:!0,allowEsc:!0,allowUndo:!0,render:e=>{let n;return n=g.isMobile?{menuType:s().o.Modal,title:t,right:(0,c.jsx)(l().DoneMenuText,{}),onClickRight:r,...e}:{menuType:s().o.Popup,...u&&{minWidth:u},...d&&{maxWidth:d},...p&&{width:p},...e},(0,c.jsx)(a().Z,{...n,header:t&&(0,c.jsx)(h,{title:t,helpButton:o}),children:m})}})}function h(e){let{title:t,helpButton:o}=e;return(0,n().O7)().device.isMobile?null:(0,c.jsx)(r().ZP,{style:m,title:t,right:o})}},900596:(e,t,o)=>{o.d(t,{Z:()=>a});o(667294);var n=()=>o(788860),i=o(785893);const a=function(e){let{collectionViewName:t,collectionViewType:a}=e;return t?(0,i.jsx)(o(827618).Z,{children:t}):"page"===a?(0,i.jsx)(n()._H,{id:"database.collectionView.untitledName.untitled",defaultMessage:"Untitled"}):(0,i.jsx)(n()._H,{...o(887430).b1[a]})}},292612:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(667294),i=o(785893);const a=n.forwardRef((function(e,t){const n=(0,o(846550).yK)((t=>({base:{color:e.isBlue?o(568017).ZP.blue:t.mediumTextColor},disabled:{cursor:"not-allowed"},buttonMenuItem:{...e.style,...e.disabled?{cursor:"not-allowed"}:{}}})),[e.disabled,e.isBlue,e.style]),{color:a}=n.base;return(0,i.jsx)(o(827973).Z,{ref:t,...e,title:(0,i.jsx)("div",{style:{color:a,fill:a},children:e.title}),icon:(0,i.jsx)(o(882292).Z,{icon:o(521777).R,styles:{fill:a}}),style:n.buttonMenuItem})}))},887330:(e,t,o)=>{o.d(t,{C:()=>i,L:()=>a});var n=()=>o(707513);function i(e){const{theme:t,isInHomeWidget:o}=e;return{display:"flex",alignItems:"center",fontSize:14,padding:6,...o?{height:24,width:24,color:t.lightTextColor,fill:t.lightIconColor}:{height:28,width:28,color:t.mediumIconColor,fill:t.mediumIconColor},fontWeight:n().Ue.regular,lineHeight:1,borderRadius:6}}function a(e){const{theme:t}=e;return{display:"flex",alignItems:"center",fontSize:14,height:28,padding:6,color:t.mediumIconColor,fontWeight:n().Ue.regular,lineHeight:1,borderRadius:4}}},12530:(e,t,o)=>{o.d(t,{N:()=>a,Z:()=>l});o(667294);var n=o(785893);const i={display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:16,height:16,fontSize:10,textAlign:"center",fontWeight:o(707513).Ue.semibold,borderRadius:4,color:o(568017).ZP.white,position:"static",marginLeft:6,WebkitFontSmoothing:"auto"};let a=function(e){return e[e.Red=0]="Red",e[e.Gray=1]="Gray",e}({});function r(e){return!!e&&e>0}const l=function(e){let{count:t,color:l,style:c,numberStyle:u,fadeIn:d}=e;const p=l===a.Red,m=(0,o(846550).yK)((e=>({badge:{...i,...c,...(t??0)>99&&{width:void 0,padding:2},background:p?e.redBadgeBackground:e.lightIconColor,...d&&{transition:"opacity 0.1s",opacity:r(t)?1:0}}})),[t,d,p,c]);return d||r(t)?(0,n.jsx)("div",{style:m.badge,children:(0,n.jsx)(s,{count:t,numberStyle:u})}):null};function s(e){let{count:t,numberStyle:o}=e;return t?1===t?(0,n.jsx)("span",{style:{marginLeft:-.5,...o},children:"1"}):t>99?(0,n.jsx)("span",{style:{letterSpacing:-.5,...o},children:"99+"}):t>9?(0,n.jsx)("span",{style:{letterSpacing:-.5,marginLeft:-.5,...o},children:t}):(0,n.jsx)("span",{style:{...o},children:t}):null}},44105:(e,t,o)=>{o.d(t,{Z:()=>j});var n=o(667294),i=()=>o(219727),a=()=>o(142735),r=()=>o(846550),l=()=>o(989478),s=()=>o(499110),c=()=>o(788860),u=()=>o(491927),d=()=>o(421654),p=()=>o(269299),m=()=>o(168441),g=()=>o(827282),h=o(785893);const y=(0,g().IU)("mobileLocked",{viewBox:"0 0 26 26",svg:(0,h.jsx)("path",{d:"M7.88672 23.417H18.1133C19.499 23.417 20.1758 22.7295 20.1758 21.2256V13.3408C20.1758 11.9873 19.6172 11.2891 18.4678 11.1709V8.46387C18.4678 4.41406 15.8145 2.45898 13 2.45898C10.1855 2.45898 7.53223 4.41406 7.53223 8.46387V11.2246C6.47949 11.3857 5.82422 12.0732 5.82422 13.3408V21.2256C5.82422 22.7295 6.50098 23.417 7.88672 23.417ZM9.26172 8.23828C9.26172 5.54199 10.9912 4.11328 13 4.11328C15.0088 4.11328 16.7383 5.54199 16.7383 8.23828V11.1602L9.26172 11.1709V8.23828Z"})}),f=(0,g().IU)("mobileUnlocked",{viewBox:"0 0 32 26",svg:(0,h.jsx)("path",{d:"M7.89355 23.417H18.1094C19.4951 23.417 20.1826 22.7295 20.1826 21.2256V13.3408C20.1826 12.0303 19.6562 11.332 18.582 11.1816V8.23828C18.582 5.54199 20.3115 4.11328 22.3203 4.11328C24.3291 4.11328 26.0586 5.54199 26.0586 8.23828V10.623C26.0586 11.2783 26.4346 11.6006 26.9287 11.6006C27.4014 11.6006 27.7881 11.3105 27.7881 10.623V8.46387C27.7881 4.41406 25.1348 2.45898 22.3203 2.45898C19.5059 2.45898 16.8525 4.41406 16.8525 8.46387V11.1602L8.1084 11.1816C6.72266 11.1816 5.82031 11.8584 5.82031 13.3408V21.2256C5.82031 22.7295 6.50781 23.417 7.89355 23.417Z"})}),v=(0,g().IU)("unlockedFilled",{viewBox:"0 0 16 16",svg:(0,h.jsx)("path",{d:"M2.33301 14.6338H8.94336C9.85938 14.6338 10.3105 14.1826 10.3105 13.1914V8.08496C10.3105 7.2168 9.95508 6.75195 9.24414 6.65625V4.83105C9.24414 3.22461 10.2627 2.35645 11.4863 2.35645C12.71 2.35645 13.7354 3.22461 13.7354 4.83105V6.28711C13.7354 6.76562 14.0156 7.01855 14.3848 7.01855C14.7471 7.01855 15.0273 6.7793 15.0273 6.28711V4.96094C15.0273 2.36328 13.2979 1.1123 11.4863 1.1123C9.6748 1.1123 7.94531 2.36328 7.94531 4.96094V6.64258L2.44922 6.64941C1.5332 6.64941 0.96582 7.10742 0.96582 8.08496V13.1914C0.96582 14.1826 1.41699 14.6338 2.33301 14.6338Z"})});var x=()=>o(482162),S=()=>o(826955),b=()=>o(154186),C=()=>o(654133),k=()=>o(49489);const j=function(e){let{store:t,disableTooltip:n,hideText:r,isInlineCollection:l,buttonStyle:s,lockStore:c}=e;const{isMobile:u}=(0,i().Fy)(),d=(0,a().qz)(c,o(385021).Z);return u?(0,h.jsx)(V,{store:t,lockStore:d,hideText:r}):(0,h.jsx)(P,{store:t,disableTooltip:n,hideText:r,isMobile:u,isInlineCollection:l,buttonStyle:s,lockStore:d})};function M(e,t,o){return{display:"flex",alignItems:"center",whiteSpace:"nowrap",fontSize:e?12:14,borderRadius:4,padding:"0 6px",marginRight:2,height:24,marginTop:e?1:0,marginLeft:e?0:-5,...t&&{marginLeft:e?8:12,marginRight:0},...o}}function T(e,t,o,n,i){return{...M(e,n,i),color:o.lightTextColor,fill:o.lightIconColor}}function w(e,t,o,n,i){return{...M(e,n,i),paddingLeft:5,border:`1px solid ${o.blueColor}`,color:o.blueColor,fill:o.blueColor}}function A(e){let{store:t}=e;const o=(0,r().Fg)(),n=(0,a().VK)((()=>t.getFormat().block_locked_by),[t]),i=(0,c().YB)(),u=(0,a().VK)((()=>n&&(0,s().Nz)(i,S().t1.createChildStore(t,{table:l().KJ,id:n}).getModel())),[n,i,t]);return n?(0,h.jsx)("div",{children:(0,h.jsx)(c()._H,{defaultMessage:"Locked by {lockedByPerson}{br}to prevent accidental editing.{br}<prompttext>Click to unlock</prompttext>",id:"pageLockIndicator.lockedTooltip",values:{lockedByPerson:(0,h.jsx)("b",{children:u}),br:(0,h.jsx)("br",{}),prompttext:e=>(0,h.jsx)("span",{style:{color:o.mediumInvertedTextColor},children:e})}})}):null}function I(e,t,o){p().createAndCommit({userAction:"PageLockTopbarIndicator.handleLockClick",environment:e,canUndo:!0,perform:o=>{d().Wq({environment:e,store:t,isLocked:!1,transaction:o})}}),o.setState({...o.state,justUnlocked:!0});const n=t.getType();if(n){var i;let o;t.isCollectionView()&&(o=t.getCollectionStore()),u().UJ(e,{from:"topbar",block_type:n,locked:!1,collection_id:null===(i=o)||void 0===i?void 0:i.id})}}function _(e,t,o){p().createAndCommit({userAction:"PageLockTopbarIndicator.handleUnlockClick",environment:e,canUndo:!0,perform:o=>{d().Wq({environment:e,store:t,isLocked:!0,transaction:o})}}),o.setState({...o.state,justUnlocked:!1});const n=t.getType();if(n){var i;let o;t.isCollectionView()&&(o=t.getCollectionStore()),u().UJ(e,{from:"topbar",block_type:n,locked:!0,collection_id:null===(i=o)||void 0===i?void 0:i.id})}}function P(e){let{store:t,disableTooltip:o,hideText:l,isMobile:s,isInlineCollection:u,buttonStyle:d,lockStore:p}=e;const g=(0,r().Fg)(),y=(0,i().O7)(),f=(0,n.useCallback)((()=>_(y,t,p)),[y,t,p]),S=(0,n.useCallback)((()=>I(y,t,p)),[y,t,p]),j=(0,a().VK)((()=>t.isLocked()),[t]),M=(0,a().VK)((()=>p.state.justUnlocked),[p]),P=(0,a().VK)((()=>x().default.state.open&&x().default.state.targetStore.id===t.id),[t.id]);return j?(0,h.jsx)(C().Z,{renderTooltip:()=>(0,h.jsx)(A,{store:t}),disableTooltip:o,render:e=>(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[P&&(0,h.jsx)(k().Z,{}),(0,h.jsxs)(b().Z,{style:T(s,0,g,u,d),onClick:S,...e,children:[(0,m().Q)({width:16,marginRight:l?void 0:4}),!l&&(0,h.jsx)("div",{style:{lineHeight:1},children:(0,h.jsx)(c()._H,{defaultMessage:"Locked",id:"pageLockIndicator.lockedButton.label"})})]})]})}):M?(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,h.jsx)(k().Z,{}),(0,h.jsxs)(b().Z,{style:w(s,0,g,u,d),onClick:f,hoveredStyle:{background:g.outlineBlueButtonHoveredBackground},pressedStyle:{background:g.outlineBlueButtonPressedBackground},children:[v({width:16,marginRight:l?void 0:4}),!l&&(0,h.jsx)("div",{style:{lineHeight:1},children:(0,h.jsx)(c()._H,{defaultMessage:"Re-lock",id:"pageLockIndicator.relockButton.label"})})]})]}):null}function V(e){let{store:t,lockStore:o,hideText:l}=e;const s=(0,r().Fg)(),u=(0,i().O7)(),d=(0,n.useCallback)((()=>_(u,t,o)),[u,t,o]),p=(0,n.useCallback)((()=>I(u,t,o)),[u,t,o]),m=(0,a().VK)((()=>t.isLocked()),[t]),{WindowSizeStore:g}=u,v=(0,a().VK)((()=>g.getSafePaddingLeftCSS(10)),[g]),x=(0,a().VK)((()=>g.getSafePaddingRightCSS(14)),[g]),S=(0,a().VK)((()=>o.state.justUnlocked),[o]);return m?(0,h.jsxs)(b().Z,{onClick:p,mobileFeedback:!0,style:{display:"flex",alignItems:"center",height:"100%",paddingLeft:v,paddingRight:x},children:[y({width:20,marginRight:6}),!l&&(0,h.jsx)("div",{children:(0,h.jsx)(c()._H,{defaultMessage:"Locked",id:"pageLockIndicator.mobileLockedButton.label"})})]}):S?(0,h.jsxs)(b().Z,{onClick:d,mobileFeedback:!0,style:{display:"flex",alignItems:"center",width:"100%",height:"100%",paddingLeft:v,paddingRight:x,color:s.blueColor,fill:s.blueColor},children:[f({height:26,width:32,marginRight:6}),!l&&(0,h.jsx)("div",{children:(0,h.jsx)(c()._H,{defaultMessage:"Re-lock",id:"pageLockIndicator.mobileRelockButton.label"})})]}):null}},307473:(e,t,o)=>{o.d(t,{e:()=>k});o(667294);var n=()=>o(219727),i=()=>o(142735),a=()=>o(846550),r=()=>o(907874),l=()=>o(707513),s=()=>o(790819),c=()=>o(466970),u=()=>o(529048),d=()=>o(448419),p=()=>o(967092),m=()=>o(209956),g=()=>o(98235),h=(o(241792),()=>o(788860)),y=()=>o(696459),f=()=>o(3425),v=()=>o(214206),x=()=>o(815325),S=o(785893);function b(e){const{context:t,currentSimpleFormulaValueTokens:o,disabled:n,formulaTypecheckContextValues:i,parentRecordStore:r,placeholder:l,spaceId:s,type:c,value:u}=e,d=(0,a().yK)((()=>({tokenWrap:{display:"flex",alignItems:"center",flexGrow:1,overflow:"hidden",marginTop:6}})),[]),p=(0,v().Mv)(t);if("formula"===(null==u?void 0:u.type)&&u.value)return(0,S.jsx)(f().I,{formulaTypecheckContextValues:i??[],parentRecordStore:r,spaceId:s,value:u});if("text"===c.type||"number"===c.type)return null;if("date"===c.type||"select"===c.type||"checkbox"===c.type){const e=o[0];return void 0===e?(0,S.jsx)(C,{placeholder:l}):(0,S.jsx)("div",{style:d.tokenWrap,children:(0,S.jsx)(g().K,{token:e,parentRecordStore:r,disabled:n,currentSimpleFormulaValueTokens:o,context:t})})}return"person_array"===c.type||"block_array"===c.type||"select_array"===c.type?0===o.length?(0,S.jsx)(C,{placeholder:l}):(0,S.jsx)("div",{style:d.tokenWrap,children:p(o,"first").map(((e,i)=>(0,S.jsx)(g().K,{token:e,parentRecordStore:r,disabled:n,currentSimpleFormulaValueTokens:o,context:t},i)))}):void(0,y().t1)(c)}function C(e){const{placeholder:t}=e,o=(0,a().yK)((e=>({placeholderText:{color:e.lightTextColor}})),[]);return(0,S.jsx)("div",{style:o.placeholderText,children:t?(0,S.jsx)(h()._H,{defaultMessage:"{placeholder}",values:{placeholder:t},id:"formulas.SimpleFormulaValuePicker.people.customPlaceholder"}):(0,S.jsx)(h()._H,{...x().s.personSelect})})}function k(e){const{allowedReturnTypes:t,disabled:o,disableEmojiCommands:h,disableFormattingAndMentions:y,disableMobileActionBar:f,disableTemplateVariableMentions:v,errorMessage:x,formulaTypecheckContextValues:C,limit:k,menuProps:j,onChange:M,parentRecordStore:T,placeholder:w,showClearButton:A,showInputMenuItem:I,simpleFormulaContext:_,spaceId:P,style:V,type:B,value:R}=e,K=(0,n().Fy)(),F=!R||"simple"===R.type,Z=(0,i().VK)((()=>(0,r().fromSimpleFormulaArrayValue)(null==R?void 0:R.value)),[R]),L=(0,c().E)("collections_xws"),E=(0,a().yK)((e=>({button:{boxShadow:e.inputBoxShadow,flexGrow:1,flexShrink:1,fontSize:"inherit",fontWeight:l().Ue.regular,...V}})),[V]),H=(0,i().qz)(void 0,u().Z),D=L?"cross_space_and_read_permissions":"read_permissions_only";return(0,S.jsx)(d().ZP,{alignmentToOrigin:d().vR.End,buttonPopupStore:H,disabled:o,originGap:0,placementToOrigin:d().pO.Bottom,popupType:K.isMobile?p().kQ.SlideUp:p().kQ.Popup,renderOrigin:e=>(0,S.jsx)(s().S,{...e,disabled:o,hasActionRequired:!Boolean(Z.length>0),isError:Boolean(x),style:E.button,tooltipMessage:x,dropdownButtonType:"button",children:(0,S.jsx)(b,{currentSimpleFormulaValueTokens:Z,context:_,disabled:!0,formulaTypecheckContextValues:C,parentRecordStore:T,placeholder:w,spaceId:P,type:B,value:R})}),render:e=>F?(0,S.jsx)(g().a,{currentSimpleFormulaValueTokens:Z,disableEmojiCommands:h,disableFormattingAndMentions:y,disableMobileActionBar:f,disableTemplateVariableMentions:v,formulaTypecheckContextValues:C,formulaValueContext:_,limit:k,menuProps:j,onChange:M,onClose:e.close,parentRecordStore:T,showClearButton:A,showInputMenuItem:I,type:B,value:R}):(0,S.jsx)(m().Z,{allowedReturnTypes:t,disabled:o,formulaTypecheckContextValues:C,onChange:M,onClose:e.close,parentRecordStore:T,restrictUnaccessibleProperties:D,spaceId:P,value:R})})}},98235:(e,t,o)=>{o.d(t,{a:()=>_e,K:()=>M});o(267602),o(470928);var n=o(667294),i=()=>o(219727),a=()=>o(142735),r=()=>o(226413),l=()=>o(532850),s=()=>o(38883),c=()=>o(177634),u=()=>o(907874),d=()=>o(955620),p=()=>o(855741),m=()=>o(696459),g=()=>o(253783),h=()=>o(887766),y=()=>o(96735),f=()=>o(637118),v=()=>o(715139),x=()=>o(308252),S=()=>o(328094),b=()=>o(246471),C=()=>o(772265),k=()=>o(214206),j=o(785893);function M(e){const{token:t,disabled:o,setCurrentTokens:n,currentSimpleFormulaValueTokens:M,context:T,parentRecordStore:w}=e,A=(0,i().Fy)(),{typecheckResult:I}=(0,f().DZ)(),_=(0,a().VK)((()=>{if("collection"===T.type)return(0,k()._7)(T)}),[T]),P=(0,a().VK)((()=>{if("collection"===T.type)return T.collectionStore.getSchema()[T.property]}),[T]);if("string"==typeof t){if(!P||!(0,r().t)(P))return null;const e=(0,l().i7)((null==P?void 0:P.options)??[],t);if(!e)return(0,j.jsx)(g().Z,{isSingle:!1,showRemoveButton:!o,onClickRemove:()=>{null==n||n((0,u().simpleFormulaValueWithoutToken)(M,t))}},`deleted_option_value_${t}`);const i={value:e.value,color:e.color,isSingle:!1,showRemoveButton:!o,format:A.isMobile?s().lo.Medium:s().lo.Small,onClickRemove:()=>{null==n||n((0,u().simpleFormulaValueWithoutToken)(M,t))}};if((0,r().gB)(P)){var V;const t=null===(V=P.groups)||void 0===V||null===(V=V.find((t=>{var o;return null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id)})))||void 0===V?void 0:V.color;return(0,j.jsx)(b().F,{...i,groupColor:t})}return(0,j.jsx)(b().a,{...i})}if("boolean"==typeof t)return(0,j.jsx)(v().Z,{checked:t,disabled:!0,size:16,checkSize:12,style:{marginBottom:6}},t.toString());if((0,d().IWo)(t))return(0,j.jsx)(y().Z,{handleRemoveToken:o?void 0:()=>{null==n||n((0,u().simpleFormulaValueWithoutToken)(M,t))},token:t});if((0,d().wjk)(t)){const e=(0,d().vmO)(t).id,i=I&&p().x.isSuccess(I)?(0,c().vx)(I.value.valueTypes,e):void 0;return i?(0,j.jsx)(C().F,{value:i,format:s().lo.Small,isSingle:!1,shouldShrink:!0,showRemoveButton:!o,onClickRemove:()=>{null==n||n((0,u().simpleFormulaValueWithoutToken)(M,t))},style:{margin:"0 6px 6px 0"}}):null}if((0,d().fpG)(t)){const e=M[0],t=e&&(0,u().isAnnotationSimpleValueToken)(e)&&(0,d().fpG)(e)?(0,d().zyO)(e):void 0;return t&&_?(0,j.jsx)(x().Z,{value:t,dateFormat:_.dateFormat,timeFormat:_.timeFormat,style:{marginBottom:6}}):null}if((0,d().STW)(t)){const e=(0,d().TOT)(t);return e?(0,j.jsx)(S().Z,{format:A.isMobile?s().lo.Medium:s().lo.Small,blockId:e,shouldWrap:!1,shouldShrink:!0,isSingle:!1,parentStore:w,showRemoveButton:!o,relationPropertySchema:void 0,onClickRemove:()=>{null==n||n((0,u().simpleFormulaValueWithoutToken)(M,t))}},e):null}if((0,d().Lyt)(t))return(0,j.jsx)(h().Z,{token:t});(0,m().t1)(t)}o(492176),o(7961);var T=()=>o(583352),w=()=>o(590259);function A(){const e=(0,f().DZ)(),{menuStore:t}=(0,n.useContext)(w().z),{automationActionId:o,insertionPoint:i}=(0,a().VK)((()=>{const e=null==t?void 0:t.getCurrentTab();return{automationActionId:"eventActionProperty"===(null==e?void 0:e.type)?e.actionId:void 0,insertionPoint:null==t?void 0:t.getInsertionPoint()}}),[t]),r=(0,a().VK)((()=>{var t;return o?null===(t=e.automationStore)||void 0===t?void 0:t.findActionStoreById(o):function(e,t){if(!e)return;const o=e.getActionIds(),n=e.getActionStores();if(!t)return;if("beforeActionId"in t){const e=o.indexOf(t.beforeActionId)-1;return e<=0?n.at(0):n.at(e)}if("afterActionId"in t){const e=o.indexOf(t.afterActionId);if(-1===e)return;return n.at(e+1)}(0,m().t1)(t)}(e.automationStore,i)}),[o,i,e.automationStore]);(0,n.useEffect)((()=>{if(e.defined&&p().x.isSuccess(e.typecheckResult)){const{automationStore:t,contextType:o,typecheckResult:n}=e;return T().Z.focus({automationStore:t,contextType:o,typecheckResult:n.value,automationActionStore:r}),function(){T().Z.blur({automationStore:t,contextType:o,typecheckResult:n.value,automationActionStore:r})}}}),[r,e])}var I=()=>o(466970),_=()=>o(876822),P=()=>o(209956),V=()=>o(311281),B=()=>o(44317),R=()=>o(749515),K=(o(670560),o(241792),()=>o(846550)),F=()=>o(568017),Z=(o(122556),o(582845),o(250570),o(533019),o(721473),o(788208),o(22624),o(653476),o(731107),()=>o(492788)),L=()=>o(92960),E=()=>o(619186),H=()=>o(788860),D=()=>o(513670),O=()=>o(815325),N=()=>o(836),U=()=>o(122671),W=()=>o(692304),z=()=>o(188301);function G(e){let{disabled:t,handleRemoveToken:o,propertySchema:a,token:c}=e;const u=(0,i().Fy)(),d=(0,n.useCallback)((()=>{o&&o(c)}),[o,c]);if("string"!=typeof c||!a||!(0,r().t)(a))return null;const p=(0,l().i7)((null==a?void 0:a.options)??[],c);if(!p)return(0,j.jsx)(g().Z,{isSingle:!1,showRemoveButton:!t,onClickRemove:d},`deleted_option_value_${c}`);if((0,r().gB)(a)){var m;const e=null===(m=a.groups)||void 0===m||null===(m=m.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(p.id)})))||void 0===m?void 0:m.color;return(0,j.jsx)(b().F,{color:p.color,format:u.isMobile?s().lo.Medium:s().lo.Small,groupColor:e,isSingle:!1,onClickRemove:d,showRemoveButton:!t,value:p.value})}return(0,j.jsx)(b().a,{color:p.color,format:u.isMobile?s().lo.Medium:s().lo.Small,isSingle:!1,onClickRemove:d,showRemoveButton:!t,value:p.value})}var $=()=>o(352230),Y=()=>o(198829),q=()=>o(255577),X=()=>o(838367),J=()=>o(470386),Q=()=>o(388284),ee=()=>o(122890),te=()=>o(534801),oe=()=>o(827973);function ne(e){let{checkState:t,checkType:o,menuArgs:n,onCheckboxClick:a,option:r}=e;const l=(0,i().Fy)();return(0,j.jsx)(oe().Z,{...n,..."single"===o?{checkState:t}:{},..."multi"===o?{icon:(0,j.jsx)(v().Z,{checked:t,size:14,onClick:a})}:{},title:(0,j.jsx)(b().a,{value:r.value,color:r.color,showRemoveButton:!1,isSingle:!0,shouldShrink:!0,format:l.isMobile?s().lo.Large:s().lo.Small}),isTokenTitle:!0})}function ie(e){let{checkState:t,checkType:o,menuArgs:n,onCheckboxClick:a,option:r,group:l}=e;const c=(0,i().Fy)();return(0,j.jsx)(oe().Z,{...n,..."single"===o?{checkState:t}:{},..."multi"===o?{icon:(0,j.jsx)(v().Z,{checked:t,size:14,onClick:a})}:{},title:(0,j.jsx)(b().F,{color:r.color,format:c.isMobile?s().lo.Large:s().lo.Small,groupColor:null==l?void 0:l.color,isSingle:!0,shouldShrink:!0,showRemoveButton:!1,value:r.value},r.value),isTokenTitle:!0})}function ae(e){const{action:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:l,formulaValueContext:s,isSingle:p,menuProps:g,onChange:h,onClose:y,showClearButton:f=!1,showInputMenuItem:v=!1,showReplaceAddRemoveToggle:x=!1,type:S,value:b,parentRecordStore:C}=e,k=(0,i().Fy)(),M=(0,K().yK)((e=>({headerDiv:{paddingBlockEnd:k.isMobile?0:6,borderBlockEnd:k.isMobile?"none":`1px solid ${F().ZP.dividerColor}`},replaceAddRemoveToggleButton:{marginLeft:"8px",marginRight:"8px",marginTop:"8px"}})),[k.isMobile]),{footer:T,groupedItems:w,menuListStore:A,noResultsMessage:I,replaceAddRemoveToggleButton:_,searchInput:P,selectItems:V,valueItems:B}=function(e){const{action:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:l,formulaValueContext:s,isSingle:p,onChange:g,onClose:h,showClearButton:y,showReplaceAddRemoveToggle:f,type:v,value:x}=e,[S,b]=(0,n.useState)(""),C=(0,a().qz)(void 0,W().Z),k=(0,i().Fy)(),M=(0,H().YB)(),{collectionStore:T,property:w}=s,A=(0,a().VK)((()=>T.getSchema()[w]),[T,w]),I=A&&(0,r().gB)(A),_=(0,a().VK)((()=>I?A.groups??[]:[]),[I,A]),P=(0,a().VK)((()=>A&&(0,r().t)(A)&&A.options||[]),[A]),V=(0,n.useMemo)((()=>l.filter((e=>(0,c().uy)(e.type,{type:"select",collection:v.collection,property:v.property})))),[l,v.collection,v.property]),B=(0,a().VK)((()=>({valueResults:S?(0,E().ZP)(S,V,(e=>e.kind===L().FormulaContextValueKind.ContextValue?e.name:"")):V,selectResults:S?(0,E().ZP)(S,P,(e=>e.value)):P})),[S,V,P]),R=(0,n.useCallback)((()=>{b(""),C.setState({...C.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}),[C]),K=(0,n.useCallback)(((e,o)=>{g(e||x,o||t)}),[t,g,x]),F=(0,n.useCallback)((()=>{p&&Z().default.afterNextFlush((()=>{h()}))}),[p,h]),$=(0,n.useCallback)((e=>{K({type:"simple",value:p?(0,u().toSimpleFormulaSingleValue)(e[0]):(0,u().toSimpleFormulaArrayValue)(e)}),F(),R()}),[K,p,F,R]),Y=(0,n.useCallback)((()=>{$(o.slice(0,o.length-1))}),[o,$]),q=(0,n.useCallback)((e=>{$((0,u().simpleFormulaValueWithoutToken)(o,e))}),[o,$]),X=(0,n.useMemo)((()=>D().oA(o.map(((e,t)=>(0,j.jsx)(G,{disabled:!1,handleRemoveToken:q,propertySchema:A,token:e},`select_option_token_${t}`))))),[o,q,A]),J=(0,n.useMemo)((()=>new Set(D().oA(o.map((e=>(0,u().isAnnotationSimpleValueToken)(e)&&(0,d().wjk)(e)&&(0,d().vmO)(e).id))))),[o]),Q=(0,n.useMemo)((()=>D().oA((B.valueResults??[]).map((e=>{const t=e.kind===L().FormulaContextValueKind.ContextValue&&e.id||"";if(!t||!J.has(t))return{action:p?"replace":"append",currentSimpleFormulaValueTokens:o,onCheckboxClick:F,id:t,isStatusProperty:Boolean(I),setCurrentTokens:$,value:e}})))),[J,o,F,p,I,B.valueResults,$]),ee=p?"single":"multi",te=(0,n.useMemo)((()=>D().oA(B.selectResults??[]).reduce(((e,t)=>{const n=Boolean(o.find((e=>"string"==typeof e&&e===t.value)));return e[t.id]={checkState:n,checkType:ee,group:void 0,id:t.id,isStatusProperty:Boolean(I),onCheckboxClick:()=>{$(p?n?[]:[t.value]:n?(0,u().simpleFormulaValueWithoutToken)(o,t.value):[...o,t.value]),p&&Z().default.afterNextFlush((()=>{h()}))},option:t},e}),{})),[ee,o,p,I,h,B.selectResults,$]),oe=(0,n.useMemo)((()=>Object.values(te)),[te]),ne=(0,n.useMemo)((()=>_.map((e=>({items:(e.optionIds??[]).map((e=>te[e])).filter(m().$K),group:e})))),[te,_]),ie=_.length>0&&0===ne.length||0===_.length&&0===oe.length,ae=(0,j.jsx)(U().ZP,{dontShowBorderBottom:k.isAndroid,focus:!k.isMobile||void 0,focusAfterAnimation:!0,format:U().UR.FilterValue,onChange:e=>b(e.target.value),onClearButtonClick:()=>$([]),onRemoveLastToken:Y,placeholder:M.formatMessage(O().s.searchPlaceHolder),showClearButton:y,tokens:X,value:S}),re=(0,j.jsx)(N().Z,{value:x,onChange:K}),le=(0,j.jsx)(z().Z,{action:t,handleOnChange:K});return{footer:re,groupedItems:ne,menuListStore:C,noResultsMessage:ie&&M.formatMessage(O().s.noResults),replaceAddRemoveToggleButton:!!f&&le,searchInput:ae,selectItems:oe,valueItems:Q}}({action:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:l,formulaValueContext:s,isSingle:p,onChange:h,onClose:y,showClearButton:f,showReplaceAddRemoveToggle:x,type:S,value:b})||{},R=(0,n.useMemo)((()=>B.map((e=>{const{annotation:t,itemAction:o}=(0,te().A)({action:e.action,currentSimpleFormulaValueTokens:e.currentSimpleFormulaValueTokens,setCurrentTokens:e.setCurrentTokens,value:e.value});return{key:e.id,render:e=>(0,j.jsx)(ee().Z,{annotation:t,disabled:!1,formulaTypecheckContextValues:l,menuArgs:e,parentRecordStore:C}),action:o}}))),[l,B,C]),{groupedMenuItems:oe,selectMenuItems:ae}=(0,n.useMemo)((()=>{let e=[],t=[];return w.length>0?e=w.map((e=>{let{group:t,items:o}=e;return{key:t.name,render:e=>(0,j.jsx)(Q().Z,{...e,title:t.name,topBorder:!0}),items:o.map((e=>({key:e.id,render:t=>(0,j.jsx)(ie,{...t,checkState:e.checkState,checkType:e.checkType,group:e.group,menuArgs:t,onCheckboxClick:e.onCheckboxClick,option:e.option}),action:e.onCheckboxClick})))}})):t=V.map((e=>({key:e.id,render:t=>(0,j.jsx)(ne,{...t,checkState:e.checkState,checkType:e.checkType,menuArgs:t,onCheckboxClick:e.onCheckboxClick,option:e.option}),action:e.onCheckboxClick}))),{groupedMenuItems:e,selectMenuItems:t}}),[w,V]),re=[...R,...ae];let le,se=[];re.length>0&&se.push({key:"options",render:e=>(0,j.jsx)(Q().Z,{...e}),items:re}),oe.length>0&&(se=[...se,...oe]),le=k.isMobile?{menuType:$().o.Modal,right:(0,j.jsx)(J().DoneMenuText,{}),onClickRight:y,footer:T&&(0,j.jsx)(Q().Z,{topBorder:!0,children:T})}:{menuType:$().o.Popup,maxHeight:"50vh",width:260,footer:T&&(0,j.jsx)(Q().Z,{topBorder:!0,children:T}),disableHeaderBorder:!0};const ce=(0,j.jsxs)("div",{style:M.headerDiv,children:[!k.isMobile&&(null==g?void 0:g.header),v&&P]});return(0,j.jsxs)(Y().Z,{...le,header:ce,children:[_&&(0,j.jsx)("div",{style:M.replaceAddRemoveToggleButton,children:_}),I&&(0,j.jsx)(Q().Z,{children:(0,j.jsx)(X().Z,{title:I})}),se.length>0&&(0,j.jsx)(q().Z,{type:q().i.Vertical,initialFocus:0,sections:se,store:A})]})}var re=()=>o(303926),le=(o(228244),o(821057),()=>o(816512)),se=()=>o(396136),ce=()=>o(989478),ue=()=>o(998901),de=()=>o(826955),pe=()=>o(231219),me=()=>o(654133),ge=()=>o(864832);const he=(0,H().vU)({maximumPeopleSelectedTooltip:{defaultMessage:"Maximum people selected",id:"valuePickerItem.maximumSelectedReached"}});function ye(e){const{args:t,checkState:o,checkType:n,context:g,disabled:y,onCheckboxClick:x,parentRecordStore:S,token:C}=e,k=(0,i().Fy)(),M=(0,a().VK)((()=>{if((0,u().isAnnotationSimpleValueToken)(C)&&(0,d().IWo)(C)){const e=(0,d().zEN)(C);if(e)return(0,le().Hl)({pointer:{table:ce().KJ,id:e},getRecordValue:S.getRecordModel})}}),[S.getRecordModel,C]),T=(0,a().VK)((()=>g.collectionStore.getSchema()[g.property]),[g]),w=(0,a().VK)((()=>T&&(0,r().t)(T)?T.options??[]:[]),[T]),A=(0,a().VK)((()=>T&&(0,r().gB)(T)?T.groups??[]:[]),[T]),{typecheckResult:I}=(0,f().DZ)(),_=(0,K().yK)((e=>({disabledMenuItem:{cursor:"not-allowed",opacity:.4}})),[]),P=Boolean(T&&(0,r().gB)(T)),V="single"===n?{checkState:o}:"multi"===n?{icon:(0,j.jsx)(v().Z,{style:y?_.disabledMenuItem:void 0,checked:o,size:14,onClick:x,disabled:y})}:{};if("string"==typeof C){if(P){const e=(0,l().i7)(w,C),o=A.find((t=>{var o;return e&&(null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id))}));return e?(0,j.jsx)(oe().Z,{...t,...V,title:(0,j.jsx)(b().F,{format:k.isMobile?s().lo.Large:s().lo.Small,isSingle:!0,value:e.value,color:e.color,groupColor:null==o?void 0:o.color,shouldShrink:!0,showRemoveButton:!1},C),isTokenTitle:!0,disabled:y,style:y?_.disabledMenuItem:void 0,...t}):null}{const e=(0,l().i7)(w,C);return e?(0,j.jsx)(oe().Z,{...t,...V,title:(0,j.jsx)(b().a,{value:e.value,color:e.color,showRemoveButton:!1,isSingle:!0,shouldShrink:!0,format:k.isMobile?s().lo.Large:s().lo.Small}),isTokenTitle:!0,disabled:y,style:y?_.disabledMenuItem:void 0,...t}):null}}if("boolean"==typeof C)return null;if((0,d().IWo)(C))return null!=M&&M.asActor&&M.table===ce().KJ?(0,j.jsx)(oe().Z,{...t,...V,title:y?(0,j.jsx)(me().Z,{renderTooltip:()=>(0,j.jsx)(H()._H,{...he.maximumPeopleSelectedTooltip}),placement:ue().Placement.Right,render:e=>(0,j.jsx)("div",{style:{width:"100%"},...e,children:(0,j.jsx)(ge().vw,{isSingle:!0,shouldShrink:!0,format:k.isMobile?ge().vw.Format.Large:ge().vw.Format.Medium,userValue:M.asActor})})}):(0,j.jsx)(ge().vw,{isSingle:!0,shouldShrink:!0,format:k.isMobile?ge().vw.Format.Large:ge().vw.Format.Medium,userValue:M.asActor}),disabled:y,style:y?_.disabledMenuItem:void 0,isTokenTitle:!0}):null;if((0,d().wjk)(C)){const e=(0,d().vmO)(C).id,n=I&&p().x.isSuccess(I)?(0,c().vx)(I.value.valueTypes,e):void 0;return n?(0,j.jsx)(ee().Z,{checkState:o,contextValue:n,disabled:Boolean(y),menuArgs:t,parentRecordStore:S}):null}if((0,d().fpG)(C))return null;if((0,d().STW)(C)){const e=(0,d().TOT)(C);if(!e)return null;const n=de().G.createChildStore(S,{id:e,table:se().iU});return(0,j.jsx)(pe().Z,{store:n,checkState:o,hidePath:!0,...t})}if((0,d().Lyt)(C))return(0,j.jsx)(h().Z,{token:C});(0,m().t1)(C)}function fe(e){const{currentSimpleFormulaValueTokens:t,value:o,setCurrentTokens:n,action:i,context:a,checkType:r,onCheckboxClick:l,isDisabled:s,parentRecordStore:c}=e;if(o.kind!==L().FormulaContextValueKind.ContextValue)throw new Error("Not implemented yet.");const p=Boolean(t.find((e=>(0,u().isAnnotationSimpleValueToken)(e)&&(0,d().wjk)(e)&&(0,d().vmO)(e).id===o.id))),m=(0,d()._QF)({id:o.id}),g=()=>{n("append"===i?p?(0,u().simpleFormulaValueWithoutToken)(t,m):[...t,m]:[m]),null==l||l()};return{key:o.id,render:e=>(0,j.jsx)(ye,{disabled:s,token:m,args:e,checkState:p,checkType:r,context:a,onCheckboxClick:g,parentRecordStore:c}),action:g}}function ve(e){const{context:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:a,menuProps:r,onChange:l,onClose:s,parentRecordStore:c,value:d}=e,p=(0,H().YB)(),m=(0,i().Fy)(),g=a.filter((e=>"checkbox"===e.type.type)),h=(0,n.useCallback)((e=>{l({type:"simple",value:void 0!==e[0]?(0,u().toSimpleFormulaSingleValue)(e[0]):void 0})}),[l]),y=(0,n.useCallback)((e=>{h(e),s()}),[h,s]),f=D().oA(g.map((e=>fe({currentSimpleFormulaValueTokens:o,value:e,setCurrentTokens:y,action:"replace",context:t,checkType:"single",parentRecordStore:c})))),v=[],x=o.some((e=>!0===e)),S=[...f,...[{key:0,render:e=>(0,j.jsx)(oe().Z,{title:(0,j.jsx)(H()._H,{...O().s.unchecked}),checkState:!x,...e}),action:()=>{y([!1])}},{key:1,render:e=>(0,j.jsx)(oe().Z,{title:(0,j.jsx)(H()._H,{...O().s.checked}),checkState:x,...e}),action:()=>{y([!0])}}]],b=void 0!==(null==r?void 0:r.header)?r.header:(0,j.jsx)(Q().Z,{style:{paddingBottom:0},title:p.formatMessage(O().s.genericMenuHeader)}),C=Boolean(b);v.push({key:"checkbox",render:e=>(0,j.jsx)(Q().Z,{...e,topBorder:C}),items:S});const k=(0,j.jsx)(Q().Z,{topBorder:!0,children:(0,j.jsx)(N().Z,{onChange:l,value:d})});let M;M=m.isMobile?{menuType:$().o.Modal,right:(0,j.jsx)(J().DoneMenuText,{}),onClickRight:s,footer:k}:{menuType:$().o.Popup,maxHeight:"50vh",width:260,disableHeaderBorder:!0,header:b,footer:k};const T={...M,...r,header:m.isMobile?null:b};return(0,j.jsx)(Y().Z,{...T,children:(0,j.jsx)(q().Z,{type:q().i.Vertical,initialFocus:0,sections:v})})}var xe=()=>o(866456),Se=()=>o(213715),be=()=>o(803021),Ce=()=>o(675393),ke=()=>o(718959),je=()=>o(677559),Me=()=>o(861050),Te=()=>o(1910),we=()=>o(92175);function Ae(e){const{context:t,currentSimpleFormulaValueTokens:o,disabled:i,onClose:r,setCurrentTokens:l,setInDatePicker:s}=e,c=o[0],p=c&&(0,u().isAnnotationSimpleValueToken)(c)&&d().fpG(c)?d().zyO(c):void 0,m=(0,H().YB)(),g=(0,a().Kw)(ke().AK),h=(0,n.useCallback)((()=>{s(!1)}),[s]),y=(0,n.useCallback)((e=>{e&&(0,be().U3)(e)?l([d().pZr(e)]):l([])}),[l]),f=(0,K().yK)((e=>({header:{display:"flex",alignItems:"center",fontSize:12,paddingInline:14,color:e.mediumTextColor,marginTop:8,fontWeight:500},iconWrap:{width:18,height:18,marginRight:4},icon:{width:12,height:12},title:{flex:"1 1 auto"}})),[]),v=(0,a().VK)((()=>(0,k()._7)(t)),[t]);return(0,j.jsx)(je().ev,{dependency:Ce().Di,children:e=>{let{DatePropertyMenu:t}=e;return(0,j.jsx)(t,{firstDayOfWeek:g,value:p,canConfigureCollection:!1,onChangeValue:y,dateFormat:v.dateFormat,timeFormat:v.timeFormat,onDismiss:r,disabled:i,shouldShowReminder:!1,header:(0,j.jsxs)("div",{style:f.header,children:[(0,j.jsx)(Te().Z,{ariaLabel:m.formatMessage(O().s.back),icon:Me().S,onClick:h,style:f.iconWrap,iconStyle:f.icon}),(0,j.jsx)("span",{style:f.title,children:(0,j.jsx)(H()._H,{...O().s.pickADate})}),(0,j.jsx)(we().Z,{onClick:r,isBlue:!0,children:(0,j.jsx)(J().DoneMenuText,{})})]}),isTemplatePage:!1})}})}function Ie(e){const{context:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:a,menuProps:r,onChange:l,onClose:s,parentRecordStore:c,value:d}=e,p=(0,H().YB)(),m=(0,i().Fy)(),[g,h]=(0,n.useState)(!1),y=a.filter((e=>"date"===e.type.type)),f=(0,n.useCallback)((e=>{l({type:"simple",value:void 0!==e[0]?(0,u().toSimpleFormulaSingleValue)(e[0]):void 0})}),[l]),v=(0,n.useCallback)((e=>{f(e),s()}),[f,s]),x=(0,n.useCallback)((()=>{h(!0)}),[]),S=(0,n.useCallback)((()=>{f([]),s()}),[f,s]);if(g)return(0,j.jsx)(Ae,{context:t,currentSimpleFormulaValueTokens:o,disabled:!1,onClose:s,setCurrentTokens:f,setInDatePicker:h});const b=void 0!==(null==r?void 0:r.header)?r.header:(0,j.jsx)(Q().Z,{style:{paddingBottom:0},title:p.formatMessage(O().s.genericMenuHeader)}),C=D().oA(y.map((e=>fe({currentSimpleFormulaValueTokens:o,value:e,setCurrentTokens:v,parentRecordStore:c,action:"replace",context:t,checkType:"single"})))),k=[];if(C.length>0){const e=Boolean(b);k.push({key:"values",render:t=>(0,j.jsx)(Q().Z,{topBorder:e,...t}),items:C})}const M=(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(Q().Z,{topBorder:!0,children:[(0,j.jsx)(Se().Z,{icon:xe().V,title:(0,j.jsx)(H()._H,{...O().s.pickADate}),onClick:x}),(0,j.jsx)(N().Z,{onChange:l,value:d})]}),o.length>0&&(0,j.jsx)(Q().Z,{topBorder:!0,children:(0,j.jsx)(oe().Z,{title:(0,j.jsx)(H()._H,{...O().s.clear}),focused:!1,onClick:S})})]});let T;T=m.isMobile?{menuType:$().o.Modal,right:(0,j.jsx)(J().DoneMenuText,{}),onClickRight:s,footer:M}:{menuType:$().o.Popup,maxHeight:"50vh",width:260,footer:M,disableHeaderBorder:!0};const w={...T,...r,header:m.isMobile?null:b};return(0,j.jsx)(Y().Z,{...w,children:(0,j.jsx)(q().Z,{type:q().i.Vertical,initialFocus:0,sections:k})})}function _e(e){const{action:t,allowedFormulaReturnTypes:o,currentSimpleFormulaValueTokens:i,disableEmojiCommands:r,disableFormattingAndMentions:l,disableMobileActionBar:s,disableTemplateVariableMentions:c,formulaTypecheckContextValues:u,formulaValueContext:d,limit:p,menuProps:g,onChange:h,onClose:y,parentRecordStore:f,showClearButton:v,showInputMenuItem:x,showReplaceAddRemoveToggle:S,type:b,value:C}=e;A();const k="formula"===(null==C?void 0:C.type),M=(0,a().VK)((()=>{var e;return null===(e=_().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),T=n.useCallback((()=>{h({type:"simple",value:null==C?void 0:C.value})}),[h,null==C?void 0:C.value]),w=(0,I().E)("collections_xws")?"cross_space_and_read_permissions":"read_permissions_only";return k&&M?(0,j.jsx)(P().Z,{allowedReturnTypes:o,disabled:!1,formulaTypecheckContextValues:u,onBack:T,onChange:h,onClose:y,parentRecordStore:f,restrictUnaccessibleProperties:w,spaceId:M,value:C}):"person_array"===b.type?(0,j.jsx)(Be,{action:t,currentSimpleFormulaValueTokens:i,formulaTypecheckContextValues:u,formulaValueContext:d,limit:p,menuProps:g,onChange:h,onClose:y,showClearButton:v??!0,showInputMenuItem:x??!0,showFormulaValueItems:!0,showGenericHeader:!0,showReplaceAddRemoveToggle:S,showPersonCheckbox:S,getRecordModel:f.getRecordModel,value:C,parentRecordStore:f}):"collection"!==d.type?null:"text"===b.type?(0,j.jsx)(Ve,{currentSimpleFormulaValueTokens:i,disableEmojiCommands:r,disableFormattingAndMentions:l,disableMobileActionBar:s,disableTemplateVariableMentions:c,formulaTypecheckContextValues:u,menuProps:g,onChange:h,onClose:y,parentRecordStore:f,showGenericHeader:!0,value:C}):"number"===b.type?(0,j.jsx)(Pe,{currentSimpleFormulaValueTokens:i,formulaTypecheckContextValues:u,menuProps:g,onChange:h,onClose:y,showGenericHeader:!0,value:C,parentRecordStore:f}):"checkbox"===b.type?(0,j.jsx)(ve,{context:d,currentSimpleFormulaValueTokens:i,formulaTypecheckContextValues:u,menuProps:g,onChange:h,onClose:y,parentRecordStore:f,value:C}):"date"===b.type?(0,j.jsx)(Ie,{context:d,currentSimpleFormulaValueTokens:i,formulaTypecheckContextValues:u,menuProps:g,onChange:h,onClose:y,parentRecordStore:f,value:C}):"block_array"===b.type?(0,j.jsx)(Re,{action:t,collection:"block_array"===b.type?b.collection:void 0,currentSimpleFormulaValueTokens:i,formulaTypecheckContextValues:u,formulaValueContext:d,menuProps:g,onChange:h,onClose:y,showClearButton:v??!0,showFormulaValueItems:!0,showGenericHeader:!0,showInputMenuItem:x??!0,showReplaceAddRemoveToggle:S,value:C,parentRecordStore:f}):"select"===b.type?(0,j.jsx)(ae,{currentSimpleFormulaValueTokens:i,formulaTypecheckContextValues:u,formulaValueContext:d,isSingle:!0,menuProps:g,onChange:h,onClose:y,showClearButton:v??!0,showInputMenuItem:x??!0,type:b,value:C,parentRecordStore:f}):"select_array"===b.type?(0,j.jsx)(ae,{action:t,currentSimpleFormulaValueTokens:i,formulaTypecheckContextValues:u,formulaValueContext:d,isSingle:!1,menuProps:g,onChange:h,onClose:y,showClearButton:v??!0,showInputMenuItem:x??!0,showReplaceAddRemoveToggle:S,type:b,value:C,parentRecordStore:f}):void(0,m().t1)(b)}function Pe(e){let{currentSimpleFormulaValueTokens:t,formulaTypecheckContextValues:o,menuProps:n,onChange:i,onClose:a,showGenericHeader:r,value:l,parentRecordStore:s}=e;const{numberMenu:c}=(0,V().Z)({currentSimpleFormulaValueTokens:t,formulaTypecheckContextValues:o,menuProps:n,onChange:i,onClose:a,showGenericHeader:r,value:l,parentRecordStore:s});return c}function Ve(e){let{currentSimpleFormulaValueTokens:t,formulaTypecheckContextValues:o,menuProps:n,onChange:i,onClose:a,parentRecordStore:r,showGenericHeader:l,value:s}=e;const{textMenu:c}=(0,re().Z)({currentSimpleFormulaValueTokens:t,formulaTypecheckContextValues:o,menuProps:n,onChange:i,onClose:a,parentRecordStore:r,showGenericHeader:l,value:s});return c}function Be(e){let{action:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:n,formulaValueContext:i,limit:a,menuProps:r,onChange:l,onClose:s,showClearButton:c,showInputMenuItem:u,showFormulaValueItems:d,showGenericHeader:p,showReplaceAddRemoveToggle:m,showPersonCheckbox:g,getRecordModel:h,value:y,parentRecordStore:f}=e;const{personArrayMenu:v}=(0,B().Z)({action:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:n,formulaValueContext:i,limit:a,menuProps:r,onChange:l,onClose:s,showClearButton:c,showInputMenuItem:u,showFormulaValueItems:d,showGenericHeader:p,showReplaceAddRemoveToggle:m,showPersonCheckbox:g,getRecordModel:h,value:y,parentRecordStore:f});return v}function Re(e){let{action:t,collection:o,currentSimpleFormulaValueTokens:n,formulaTypecheckContextValues:i,formulaValueContext:a,menuProps:r,onChange:l,onClose:s,showClearButton:c,showFormulaValueItems:u,showGenericHeader:d,showInputMenuItem:p,showReplaceAddRemoveToggle:m,value:g,parentRecordStore:h}=e;const{relationMenu:y}=(0,R().Z)({action:t,collection:o,currentSimpleFormulaValueTokens:n,formulaTypecheckContextValues:i,formulaValueContext:a,menuProps:r,onChange:l,onClose:s,showClearButton:c,showFormulaValueItems:u,showGenericHeader:d,showInputMenuItem:p,showReplaceAddRemoveToggle:m,value:g,parentRecordStore:h});return y}},49489:(e,t,o)=>{o.d(t,{Z:()=>i});o(667294);var n=o(785893);const i=function(){const e=(0,o(846550).yK)((e=>({separator:{height:14,width:1,marginLeft:6,marginRight:6,background:e.darkDividerColor}})),[]);return(0,n.jsx)("div",{style:e.separator})}},380754:(e,t,o)=>{o.r(t),o.d(t,{CollectionSettingsAutomationsView:()=>Zt});o(670560),o(122556),o(582845),o(250570),o(533019),o(721473),o(788208),o(22624),o(267602),o(653476),o(470928),o(30005),o(241792),o(228244);var n=o.n(o(443261)),i=o(667294),a=()=>o(219727),r=()=>o(142735),l=()=>o(846550),s=()=>o(816512),c=()=>o(912203),u=()=>o(969583),d=()=>o(473304),p=()=>o(455947),m=()=>o(226413),g=()=>o(532850),h=()=>o(907874),y=()=>o(827370),f=()=>o(788860),v=()=>o(696459),x=()=>o(707513),S=()=>o(139224),b=()=>o(239869),C=()=>o(637118),k=()=>o(166312),j=()=>o(205951),M=()=>o(740046),T=()=>o(108714),w=()=>o(906651),A=()=>o(388284),I=()=>o(777346),_=()=>o(654133),P=()=>o(594546),V=()=>o(270315),B=()=>o(867601),R=()=>o(122479),K=()=>o(466970),F=()=>o(787356),Z=()=>o(850790),L=()=>o(155350),E=()=>o(404437),H=()=>o(941954),D=()=>o(653457),O=()=>o(953293),N=()=>o(521777),U=()=>o(435797),W=()=>o(839678),z=()=>o(711857),G=()=>o(827282),$=o(785893);const Y=(0,G().IU)("typesLocation",{viewBox:"0 0 25 25",svg:(0,$.jsxs)("g",{children:[(0,$.jsx)("path",{d:"M12.105 24.21C18.7369 24.21 24.2121 18.7273 24.2121 12.105C24.2121 5.47312 18.7273 0 12.0954 0C5.47523 0 0 5.47312 0 12.105C0 18.7273 5.48484 24.21 12.105 24.21ZM12.105 21.8255C6.71085 21.8255 2.39412 17.4991 2.39412 12.105C2.39412 6.71085 6.70124 2.38452 12.0954 2.38452C17.4895 2.38452 21.8276 6.71085 21.8276 12.105C21.8276 17.4991 17.4991 21.8255 12.105 21.8255Z"}),(0,$.jsx)("path",{d:"M6.75703 16.5939C6.75703 17.4355 7.28742 17.9479 8.17266 17.9479H16.0416C16.9247 17.9479 17.4476 17.4355 17.4476 16.5939V12.0109L12.4683 7.82758C12.236 7.63047 11.9686 7.64008 11.7363 7.82758L6.75703 12.0013V16.5939ZM13.6692 16.7148H10.5429V12.9969C10.5429 12.7178 10.7283 12.5366 11.0128 12.5366H13.2014C13.4977 12.5366 13.6692 12.7178 13.6692 12.9969V16.7148ZM4.81055 11.2199C4.81055 11.5316 5.04469 11.8138 5.43211 11.8138C5.62593 11.8138 5.78554 11.7083 5.9271 11.5806L11.8111 6.65687C12.0145 6.47477 12.2093 6.49609 12.4052 6.65687L18.2775 11.5806C18.4383 11.7083 18.5883 11.8138 18.7725 11.8138C19.1194 11.8138 19.3941 11.5818 19.3941 11.2391C19.3941 11.0315 19.3228 10.873 19.1653 10.7336L13.0078 5.5661C12.4605 5.10508 11.7558 5.10508 11.2181 5.5661L5.03929 10.7357C4.89141 10.8751 4.81055 11.0507 4.81055 11.2199ZM15.8079 8.35282L17.4623 9.75391V6.88399C17.4623 6.62618 17.3004 6.44501 17.033 6.44501H16.249C15.9912 6.44501 15.8079 6.62618 15.8079 6.88399V8.35282Z"})]})});var q=()=>o(300729),X=()=>o(597487),J=()=>o(963966),Q=()=>o(985695),ee=()=>o(998901),te=()=>o(876822),oe=()=>o(749826),ne=()=>o(815277),ie=()=>o(71194),ae=()=>o(474788),re=()=>o(260799),le=()=>o(523733),se=()=>o(827973),ce=()=>o(448419),ue=()=>o(1910),de=()=>o(198829),pe=()=>o(255577),me=()=>o(667637),ge=()=>o(711498),he=()=>o(314379),ye=()=>o(802600),fe=()=>o(739479),ve=()=>o(529048),xe=()=>o(918745),Se=()=>o(676279);const be=(0,f().vU)({automationSummaryCardMoreButtonAriaLabel:{defaultMessage:"More",id:"automations.AutomationSummaryCard.MoreActionsButton.ariaLabel"},automationSummaryCardMoreMenuEditTitle:{defaultMessage:"Edit",id:"automations.AutomationSummaryCard.MoreActionsMenu.Edit.title"},automationSummaryCardMoreMenuDuplicateTitle:{defaultMessage:"Duplicate",id:"automations.AutomationSummaryCard.MoreActionsMenu.Duplicate.title"},automationSummaryCardMoreMenuDeleteTitle:{defaultMessage:"Delete",id:"automations.AutomationSummaryCard.MoreActionsMenu.Delete.title"},automationSummaryCardMoreMenuActiveTitle:{defaultMessage:"Active",id:"automations.AutomationSummaryCard.MoreActionsMenu.Active.title"}});function Ce(e){const{focused:t,style:o,onEdit:n,onDelete:a,onDuplicate:s,onDisable:c,onEnable:u}=e,d=(0,f().YB)(),p=(0,r().qz)(void 0,ve().Z),m=(0,Se().d)();(0,i.useEffect)((()=>{t||p.setState({open:!1})}),[t,p]);const g=(0,l().yK)((e=>({iconButton:{border:`1px solid ${e.regularDividerColor}`,height:26,width:26,...o},iconButtonIcon:{width:16}})),[o]);return(0,$.jsx)(ce().ZP,{stopClickPropagation:!0,popupType:m,alignmentToOrigin:ce().vR.Center,placementToOrigin:ce().pO.Bottom,originGap:0,renderOrigin:e=>(0,$.jsx)(ue().Z,{ariaLabel:d.formatMessage(be.automationSummaryCardMoreButtonAriaLabel),icon:he().o,iconStyle:g.iconButtonIcon,style:g.iconButton,hasBackground:!0,...e}),render:e=>(0,$.jsx)(ke,{onClose:()=>e.close(),onEdit:n,onDelete:a,onDuplicate:s,onDisable:c,onEnable:u}),buttonPopupStore:p})}function ke(e){const{onClose:t,onEdit:o,onDelete:n,onDuplicate:i,onDisable:a,onEnable:r}=e,l=(0,f().YB)(),s=(0,xe().F)(),c=o?{action:()=>{t(),o()},key:"edit",render:e=>(0,$.jsx)(se().Z,{...e,icon:(0,O().R)({height:16,width:16}),title:l.formatMessage(be.automationSummaryCardMoreMenuEditTitle)})}:void 0,u=i?{action:()=>{t(),i()},key:"duplicate",render:e=>(0,$.jsx)(se().Z,{...e,icon:(0,ye().a)({height:16,width:16}),title:l.formatMessage(be.automationSummaryCardMoreMenuDuplicateTitle)})}:void 0,d=r||a?{action:()=>{t(),r?r():a&&a()},key:"active",render:e=>(0,$.jsx)(me().Z,{...e,icon:(0,ge().M)({height:16,width:16}),title:l.formatMessage(be.automationSummaryCardMoreMenuActiveTitle),on:(0,v().$K)(a)})}:void 0,p=n?{action:()=>{t(),n()},key:"delete",render:e=>(0,$.jsx)(se().Z,{...e,icon:(0,fe().y)({height:16,width:16}),title:l.formatMessage(be.automationSummaryCardMoreMenuDeleteTitle),isRedOnHover:!0})}:void 0,m=[];return(0,v().$K)(d)&&m.push({items:[d],key:"active-inactive",render:e=>(0,$.jsx)(A().Z,{enableActionSheetTitle:!0,topBorder:!0,...e})}),m.push({items:[c,u,p].filter(v().$K),key:"items",render:e=>(0,$.jsx)(A().Z,{enableActionSheetTitle:!0,topBorder:!0,...e})}),(0,$.jsx)(de().Z,{...s,children:(0,$.jsx)(pe().Z,{type:pe().i.Vertical,sections:m,initialFocus:0})})}var je=()=>o(521632),Me=()=>o(154186),Te=()=>o(864832),we=()=>o(641506),Ae=()=>o(985481);const Ie=(0,G().IU)("pause",{viewBox:"0 0 6 8",svg:(0,$.jsx)("path",{d:"M1.008 7.473q-.294 0-.442-.149t-.144-.441V1.477q0-.29.148-.438.15-.148.438-.148h.937q.29.003.438.148.148.144.148.438v5.406q0 .292-.148.441-.15.15-.438.149zm3.047 0q-.297 0-.446-.149-.144-.149-.144-.441V1.477q0-.29.148-.438.149-.148.442-.148h.933q.293 0 .438.148.148.144.148.438v5.406q0 .292-.148.441-.145.15-.438.149z"})});var _e=()=>o(735501);const Pe=6;function Ve(e){const{actions:t,caption:o,focused:n,status:r,maxIcons:s,onBlur:c,onClick:u,onDelete:d,onDisable:p,onDuplicate:m,onEdit:g,onEnable:h,onFocus:y,onMouseDown:S,onMouseEnter:b,onMouseLeave:C,title:k,triggers:j}=e,{isMobile:M}=(0,a().Fy)(),T=(0,i.useRef)(null),[w,A]=(0,ae().Z)(),[I,_]=(0,re().Z)(),[P,V]=(0,i.useState)(!1),B=M||P||A||_,R=(0,K().E)("automation_updated_error_states"),F=(0,l().yK)((e=>({wrap:{background:e.surface.elevated,border:`1px solid ${e.regularDividerColor}`,borderRadius:10,display:"flex",flexDirection:"column",gap:11,paddingTop:16,paddingLeft:16,paddingRight:16,paddingBottom:13,position:"relative"},moreButtonWrap:{display:B?"block":"none",position:"absolute",right:8,top:8},iconList:{display:"flex",flexWrap:"wrap",gap:6,listStyle:"none",margin:"0 30px 0 0",padding:0},body:{display:"flex",flexDirection:"column",gap:M?4:0},titleWrap:{..."success"!==r?{alignItems:"center",display:"inline-flex",gap:4}:(0,we().pd)(2),fontSize:M?16:14,fontWeight:x().Ue.medium,lineHeight:"20px"},title:{..."success"!==r?x().Yu:{}},warning:{color:"error"===r?e.errorText:e.accentColors.orange[400],height:"auto",width:M?16:14},caption:{...(0,we().pd)(2),color:e.text.secondary,fontSize:M?14:12,fontWeight:x().Ue.regular,lineHeight:"16px",margin:0},invalidBadge:{backgroundColor:e.tint.uiRed,color:e.icon.uiRedPrimary},failingBadge:{backgroundColor:e.accentColors.yellow[50],color:e.accentColors.yellow[400]},pausedBadge:{backgroundColor:e.tint.regular,color:e.text.secondary},badgeContainer:{alignItems:"center",display:"flex",fontSize:10},icon:{width:10,height:10,marginRight:"4px"}})),[r,B,M]),Z=(0,i.useCallback)((e=>{V(!0),b&&b(e)}),[b]),L=(0,i.useCallback)((e=>{V(!1),C&&C(e)}),[C]);(0,i.useEffect)((()=>{n&&null!==T.current&&T.current.focus()}),[n]);const E=(0,le().lq)(T,w,I),H=function(e){const{actionIcons:t,maxIcons:o,triggerIcons:n}=e,i=n.length,a=t.length,r=i>0&&a>0,l=Math.max(o,3),s=r?l-1:l;let c=Math.max(Math.floor(s/2),1),u=Math.max(Math.ceil(s/2),1);if(i<c&&a>u){u+=c-i,c=i}else if(a<u&&i>c){c+=u-a,u=a}const d=[];if(i>0)if(i>c)if(1===c)d.push({color:"gray",type:"truncate",value:i});else{const e=i-(c-1);d.push(...n.slice(0,c-1)),d.push({color:"gray",type:"truncate",value:e})}else d.push(...n);r&&d.push({type:"arrow"});if(a>0)if(a>u)if(1===u)d.push({color:"gray",type:"truncate",value:a});else{const e=a-(u-1);d.push(...t.slice(0,u-1)),d.push({color:"gray",type:"truncate",value:e})}else d.push(...t);return d}({actionIcons:t,maxIcons:Ee(s),triggerIcons:j}),D=Boolean(d||p||h||m||g),O=(0,i.useMemo)((()=>{if(R){if("invalid"===r)return(0,$.jsx)(je().Z,{style:F.invalidBadge,content:(0,$.jsxs)("div",{style:F.badgeContainer,children:[(0,_e().t)(F.icon),(0,$.jsx)(f()._H,{defaultMessage:"Invalid",id:"automationSummaryCard.invalidToken"})]})});if("paused"===r)return(0,$.jsx)(je().Z,{style:F.pausedBadge,content:(0,$.jsxs)("div",{style:F.badgeContainer,children:[Ie(F.icon),(0,$.jsx)(f()._H,{defaultMessage:"Paused",id:"automationSummaryCard.pausedToken"})]})});if("failing"===r)return(0,$.jsx)(je().Z,{style:F.failingBadge,content:(0,$.jsx)("div",{style:F.badgeContainer,children:(0,$.jsx)(f()._H,{defaultMessage:"Failing",id:"automationSummaryCard.failingToken"})})});if("expired"===r)return(0,$.jsx)(je().Z,{style:F.pausedBadge,content:(0,$.jsx)("div",{style:F.badgeContainer,children:(0,$.jsx)(f()._H,{defaultMessage:"Completed",id:"automationSummaryCard.completedToken"})})});if("error"===r||"warning"===r||"success"===r)return;(0,v().t1)(r)}return"success"!==r?(0,_e().t)(F.warning):void 0}),[R,r,F]);return(0,$.jsxs)(Me().Z,{onBlur:c,onClick:u,onFocus:y,onMouseDown:S,onMouseEnter:Z,onMouseLeave:L,ref:E,style:F.wrap,children:[(0,$.jsxs)("header",{children:[D&&(0,$.jsx)("div",{style:F.moreButtonWrap,children:(0,$.jsx)(Ce,{focused:B,onDelete:d,onDisable:p,onEnable:h,onDuplicate:m,onEdit:g})}),(0,$.jsx)("ul",{"aria-hidden":"true",style:F.iconList,children:H.map(((e,t)=>(0,$.jsx)("li",{children:(0,$.jsx)(Be,{icon:e})},t)))})]}),(0,$.jsxs)("div",{style:F.body,children:[(0,$.jsxs)("div",{style:F.titleWrap,children:[(0,$.jsx)("span",{style:F.title,children:k}),O]}),o&&(0,$.jsx)("p",{style:F.caption,children:o})]})]})}function Be(e){const{icon:t}=e;return"property"===t.type||"page"===t.type||"misc"===t.type?(0,$.jsx)(Re,{color:t.color,icon:t.icon}):"person"===t.type?(0,$.jsx)(Le,{actor:t.actor}):"app"===t.type?(0,$.jsx)(Fe,{color:"default",icon:t.icon}):"arrow"===t.type?(0,$.jsx)(Ke,{}):"truncate"===t.type?(0,$.jsx)(Ze,{color:t.color,value:t.value}):void(0,v().t1)(t.type)}function Re(e){const{color:t,icon:o}=e,n=He(t);return(0,$.jsx)("div",{"aria-hidden":"true",style:n.iconWrap,children:o(n.icon)})}function Ke(){const e=He("default");return(0,$.jsx)("div",{style:{...e.iconWrap,...e.iconArrowWrap},children:(0,Ae().k)({...e.icon,...e.iconArrow})})}function Fe(e){const{icon:t}=e,o=He("default");return(0,$.jsx)("div",{"aria-hidden":"true",style:o.iconAppWrap,children:t(o.iconApp)})}function Ze(e){const{color:t,value:o}=e,n=He(t);return(0,$.jsxs)("div",{style:{...n.iconWrap,...n.truncateWrap},children:["+",o]})}function Le(e){const{actor:t}=e,o=He("default");return(0,$.jsx)("div",{"aria-hidden":"true",style:o.iconPersonWrap,children:(0,$.jsx)(Te().ZP,{actor:t,avatarSize:26,format:Te().ZP.Format.Inline,isSingle:!1,showRemoveButton:!1,style:{margin:0}})})}function Ee(e){return void 0===e||e<0?Pe:e}function He(e){const t="default"===e?"gray":e;return(0,l().yK)((e=>{const o="light"===e.mode?400:800,n="light"===e.mode?100:400;return{icon:{fill:e.accentColors[t][o],width:16},iconWrap:{background:e.accentColors[t][n],borderRadius:6,padding:6},iconApp:{width:14,height:14},iconAppWrap:{borderRadius:6,borderWidth:1,borderStyle:"solid",borderColor:e.accentColors.gray[n],padding:6},iconPerson:{display:"block",width:"100%"},iconPersonWrap:{alignItems:"center",display:"flex",height:28,justifyContent:"center",width:28},iconArrow:{fill:e.icon.secondary,width:14,height:14},iconArrowWrap:{background:void 0},truncateWrap:{alignItems:"center",background:e.accentColors.gray[n],color:e.accentColors[t][o],display:"inline-flex",fontSize:12,fontWeight:x().Ue.semibold,height:28,justifyContent:"center",padding:3,width:28}}}),[t])}var De=()=>o(752348),Oe=()=>o(38883),Ne=()=>o(446866),Ue=()=>o(989478),We=()=>o(955620),ze=()=>o(592479),Ge=()=>o(374784),$e=()=>o(839886),Ye=()=>o(859127),qe=()=>o(282895),Xe=()=>o(395137),Je=()=>o(96754),Qe=()=>o(152557),et=()=>o(492120),tt=()=>o(882701),ot=()=>o(236647),nt=()=>o(344470),it=()=>o(823718),at=()=>o(361726),rt=()=>o(605252),lt=()=>o(903098),st=()=>o(194930),ct=()=>o(116291),ut=()=>o(317632),dt=()=>o(796675),pt=()=>o(549813),mt=()=>o(826955);const gt=(0,f().vU)({automationSingleTargetDefault:{defaultMessage:"1 person",id:"database.viewSettings.automationTab.automationSingleTargetDefault"},recurrenceAutomationSummary:{defaultMessage:"Every {frequency}, {actions}",id:"automation.summaryCard.recurrenceCaption"}});function ht(e){const{intl:t,triggerConfig:o}=e;if(o){if("event"===o.type||"notification_event"===o.type){const n=function(e){const{hasAutomationUpdatedErrorStatesEnabled:t,collectionStore:o,environment:n,getRecordModel:i,intl:a,schema:r,typecheckResult:l,triggerConfig:s}=e,{event:u}=s,d=o.getSpaceId(),g=[];u.pagesAdded&&g.push(at().Mz(a));if("none"===u.pagePropertiesEdited.type);else if("any"===u.pagePropertiesEdited.type)g.push(at().c5(a));else if("some"===u.pagePropertiesEdited.type||"all"===u.pagePropertiesEdited.type){let e=[];"all"===u.pagePropertiesEdited.type?e=u.pagePropertiesEdited.all??[]:"some"===u.pagePropertiesEdited.type&&(e=u.pagePropertiesEdited.some??[]);for(const s of e){const e=r[s.property];if(!e){g.push(at().nf(a));continue}if(!c().Ym[e.type]){g.push((0,Qe().K1)({propertySchema:e,hasAutomationUpdatedErrorStatesEnabled:t}));continue}const{filter:u}=s;if("changes_to_any"===u.operator)g.push(at().$G(a,{propertyName:e.name}));else if(p().mv(u))g.push(at().Vf(a,{propertyName:e.name}));else if(c().bD(e))if("status"===e.type){if(!p().r2(u)||!p().vR(u)){g.push((0,rt().Tt)(e));continue}const t=p().wB(u),o=(0,it().L)({intl:a,groupValues:t.map((e=>"is_group"===e.type?e.value:void 0)).filter(v().$K),isText:!0,optionValues:t.map((e=>"is_option"===e.type?e.value:void 0)).filter(v().$K),propertySchema:e,tokenFormat:Oe().lo.Small}),n=a.formatList(o,{style:"long",type:"disjunction"});g.push(at().VO(a,{propertyName:e.name,propertyValues:n}))}else if("select"===e.type||"multi_select"===e.type){if(p().mv(u)||!p().dx(u)&&!p().NU(u)||"select"===e.type&&p().NU(u)||"multi_select"===e.type&&p().dx(u)){g.push((0,rt().Tt)(e));continue}const t=Array.isArray(u.value)?u.value:[u.value],o=(0,nt().zI)({intl:a,isText:!0,optionValues:t.map((e=>e.value)).filter(v().$K),propertySchema:e,tokenFormat:Oe().lo.Small}),n=a.formatList(o,{style:"long",type:"disjunction"}),i=(0,nt().O1)({filter:u,propertySchema:e});if(i){const t=(0,nt().JT)(i);g.push(t(a,{propertyName:e.name,propertyValues:n}))}}else if("checkbox"===e.type){if(!p().XA(u)){g.push((0,rt().Tt)(e));continue}g.push((0,et().l4)({filter:u,propertySchema:e,intl:a}))}else if("person"===e.type){if(!p().Gb(u)){g.push((0,rt().Tt)(e));continue}g.push((0,ct().Nv)({actorModels:(0,ot().S)(u,i),operator:u.operator,propertySchema:e,intl:a}))}else if("number"===e.type){if(!p().h6(u)){g.push((0,rt().Tt)(e));continue}g.push((0,st().MT)({messageType:"trigger",numberValue:u.value.value,operator:u.operator,propertySchema:e,intl:a}))}else if("email"===e.type||"url"===e.type||"text"===e.type||"phone_number"===e.type||"title"===e.type){if(!p().Ly(u)){g.push((0,rt().Tt)(e));continue}"string_is"!==u.operator&&"string_is_not"!==u.operator&&"string_contains"!==u.operator&&"string_does_not_contain"!==u.operator&&"string_starts_with"!==u.operator&&"string_ends_with"!==u.operator||g.push((0,dt().Sm)({messageType:"trigger",textValue:u.value.value,operator:u.operator,propertySchema:e,intl:a}))}else if("relation"===e.type){if(!p().e(u)){g.push((0,rt().Tt)(e));continue}if(m().Qh(d,e)){g.push((0,tt().Jw)({propertySchema:e}));continue}const t=(0,ut().RX)({collectionStore:o,filter:u}),i=(0,De().getAllContextValues)(l),r=(0,ut().vt)({collectionStore:o,filter:u,propertySchema:e});g.push((0,ut().OI)({availableTokens:r,collectionStore:o,environment:n,operator:u.operator,propertySchema:e,intl:a,relationPages:(0,ut().F2)({value:t.value,automationContextValues:i})}))}else(0,v().t1)(e)}}return a.formatList(g,{style:"long",type:"all"===u.pagePropertiesEdited.type?"conjunction":"disjunction"})}({...e,triggerConfig:o}),i=yt(e);return t.formatMessage({defaultMessage:"When {triggers}, {actions}",id:"automation.summaryCard.caption"},{actions:i,triggers:n})}if("recurrence"===o.type){if(!o.recurrence)return;const n=(0,k().De)({intl:t,recurrence:o.recurrence}),i=yt(e);return t.formatMessage(gt.recurrenceAutomationSummary,{frequency:n,actions:i})}"button"!==o.type&&(0,v().t1)(o)}}function yt(e){var t,o;const{actionStores:n,collectionStore:i,environment:a,intl:r,schema:l,typecheckResult:u,hasAutomationUpdatedErrorStatesEnabled:d}=e,p=[];for(const A of n)if(A.isType("slack_notification"))p.push((0,$.jsx)(f()._H,{defaultMessage:"notify {channel}",id:"CollectionSettingsAutomationsView.summaryCard.slackAction",values:{channel:(0,$.jsx)(ze().pZ,{actionStore:A})}}));else if(A.isType("update_pages")){const e=A.getConfig(),t=null==e?void 0:e.properties,o=null==e?void 0:e.values,n=null==e?void 0:e.target;if(!t||0===t.length||!n)continue;if("collection"===n.type)if((0,y().qo)(n.collection,i.pointer))p.push((0,$.jsx)(f()._H,{defaultMessage:"edit pages in this collection",id:"automation.summaryCard.updatePages.sameCollection"}));else{const e=mt().NW.createChildStore(i,n.collection),t=(0,pt().vU)({environment:a,intl:r,store:e});p.push((0,$.jsx)(f()._H,{defaultMessage:"edit pages in {collectionTitle}",id:"automation.summaryCard.updatePages.differentCollection",values:{collectionTitle:t}}))}else if("variable"===n.type){const e=t[0],n=l[e],a=null==o?void 0:o[e];if(!n){p.push(at().aD(r));continue}if(!a)continue;if(c().SF(n))if("person"===n.type)p.push((0,$.jsx)(kt,{collectionStore:i,contextValues:(0,De().getAllContextValues)(u),propertyActionValue:a,propertySchema:n}));else if("status"===n.type){const e=(0,$.jsx)(ft,{propertyActionValue:a,propertySchema:n});e&&p.push(e)}else if("select"===n.type||"multi_select"===n.type)p.push((0,$.jsx)(vt,{propertyActionValue:a,propertySchema:n}));else if("checkbox"===n.type)p.push((0,$.jsx)(xt,{propertyActionValue:a,propertySchema:n}));else if("relation"===n.type)p.push((0,$.jsx)(St,{collectionStore:i,propertyActionValue:a,propertySchema:n}));else if("date"===n.type){const t=(0,$.jsx)(bt,{automationActionId:A.id,collectionStore:i,propertyActionValue:a,propertyId:e,propertySchema:n});t&&p.push(t)}else"number"===n.type||"phone_number"===n.type||"text"===n.type||"title"===n.type||"email"===n.type||"url"===n.type?p.push((0,$.jsx)(Ct,{automationActionId:A.id,propertyActionValue:a,propertySchema:n})):(0,v().t1)(n);else p.push((0,Qe().K1)({propertySchema:n,hasAutomationUpdatedErrorStatesEnabled:d}))}}else if(A.isType("create_page")){var m;const e=null===(m=A.getConfig())||void 0===m?void 0:m.collection;if(!e)continue;e.id===i.pointer.id?p.push((0,$.jsx)(f()._H,{defaultMessage:"create a page in this database",id:"automation.summaryCard.createPageThisDatabase"})):p.push((0,$.jsx)(f()._H,{defaultMessage:"create a page in another database",id:"automation.summaryCard.createPageAnotherDatabase"}))}else if(A.isType("define_variables")){var g;p.push((0,$.jsx)(f()._H,{defaultMessage:"define {numVariables} custom {numVariables, plural, one {variable} other {variables}}",values:{numVariables:(null===(g=A.getConfig())||void 0===g||null===(g=g.variableIds)||void 0===g?void 0:g.length)??0},id:"automation.summaryCard.defineVariables"}))}else if(A.isType("send_in_app_notification")){var h;const e=null===(h=A.getConfig())||void 0===h?void 0:h.target;if(!e)continue;const n=e.type;switch(n){case"formula":const a=(0,We().lcG)(null===(t=e.value)||void 0===t?void 0:t.value),l=(0,We().oOk)(null===(o=e.value)||void 0===o?void 0:o.value),c=e=>{const t=A.getSpaceId()??"";return{table:Ue().KJ,id:e,spaceId:t}},u=a.map((e=>c(e))),d=u.map((e=>(0,s().Hl)({getRecordModel:i.getRecordModel,pointer:e}))).filter(v().$K).map((e=>(0,s().$4)(r,e)));p.push((0,$.jsx)(f()._H,{defaultMessage:"{numTargets, plural, one {send a notification to {singleTarget}} other {send a notification to {numTargets} people}}",values:{numTargets:u.length+l.length,singleTarget:u.length>0?d[0]:V().SO.created_by},id:"automation.summaryCard.sendNotificationUserTarget"}));break;case"property":if(!e.propertyId)break;let m;const g=i.getSchema()[e.propertyId];m=g?g.name??V().SO[g.type]:at().Bo.unknownPropertyTitle.defaultMessage,p.push((0,$.jsx)(f()._H,{defaultMessage:"send a notification to {propertyDisplayName}",values:{propertyDisplayName:m},id:"automation.summaryCard.sendNotificationPropertyTarget"}));break;default:(0,v().t1)(n)}}else if(A.isType("send_gmail_notification")){var x,S,b,C;const e=A.getConfig()??{},{to:t,cc:o,bcc:n}=e;if(null==t||null===(x=t.value)||void 0===x||!x.value)continue;if("formula"===(null==t||null===(S=t.value)||void 0===S?void 0:S.type)||"formula"===(null==o||null===(b=o.value)||void 0===b?void 0:b.type)||"formula"===(null==n||null===(C=n.value)||void 0===C?void 0:C.type))p.push((0,$.jsx)(f()._H,{defaultMessage:"send an email to recipients based on a formula",id:"automation.summaryCard.sendGmailNotificationUserFormulaTarget"}));else{var k,j,M,T,w;const e=[...null===(k=t.value)||void 0===k?void 0:k.value,...(null==o||null===(j=o.value)||void 0===j?void 0:j.value)||[],...(null==n||null===(M=n.value)||void 0===M?void 0:M.value)||[]],a=(0,We().lcG)(e),l=(0,We().oOk)(null===(T=t.value)||void 0===T?void 0:T.value),c=(0,We().jyE)(e),u=e=>{const t=A.getSpaceId()??"";return{table:Ue().KJ,id:e,spaceId:t}},d=a.map((e=>(0,s().Hl)({getRecordModel:i.getRecordModel,pointer:u(e)}))).filter(v().$K).map((e=>(0,s().$4)(r,e))),m=(0,Ne().CU)((0,We().Jcv)(e));d.push(...m);const g=d[0]||(null===(w=c[0])||void 0===w?void 0:w.name)||r.formatMessage(gt.automationSingleTargetDefault);p.push((0,$.jsx)(f()._H,{defaultMessage:"{numTargets, plural, one {send an email to {singleTarget}} other {send an email to {numTargets} people}}",values:{numTargets:new Set(d).size+l.length+c.length,singleTarget:g},id:"automation.summaryCard.sendGmailNotificationUserTarget"}))}}else A.isType("http_request")&&p.push((0,$.jsx)(f()._H,{defaultMessage:"send a webhook",id:"automation.summaryCard.sendWebRequest"}));return r.formatList(p,{style:"long",type:"conjunction"})}function ft(e){const{propertyActionValue:t,propertySchema:o}=e,n=(0,f().YB)(),i=(0,Xe().LQ)({intl:n,propertySchema:o,value:t.value});return i||null}function vt(e){const{propertyActionValue:t,propertySchema:o}=e,n=(0,f().YB)();return(0,r().VK)((()=>(0,qe().I7)({intl:n,limit:Ye().H,propertySchema:o,operator:null==t?void 0:t.action,value:t.value})),[n,null==t?void 0:t.action,t.value,o])}function xt(e){const{propertyActionValue:t,propertySchema:o}=e;return(0,Ge().G7)({propertySchema:o,value:t.value})}function St(e){const{collectionStore:t,propertyActionValue:o,propertySchema:n}=e,i=(0,f().YB)(),l=(0,a().O7)(),{typecheckResult:s}=(0,C().YC)(),c=o.value,u=(0,De().getAllContextValues)(s),d=(0,ut().F2)({automationContextValues:u,limit:n.limit,value:c});return(0,r().VK)((()=>(0,ut().wr)({collectionStore:t,environment:l,intl:i,operator:null==o?void 0:o.action,propertySchema:n,relationPages:d,value:c})),[t,l,i,null==o?void 0:o.action,n,d,c])}function bt(e){const{automationActionId:t,collectionStore:o,propertyActionValue:n,propertyId:a,propertySchema:l}=e,s=(0,f().YB)(),c=n.value,u=(0,lt().z)({actionId:t}),d=(0,i.useMemo)((()=>({type:"collection",collectionStore:o,property:a})),[o,a]),p=(0,r().VK)((()=>(0,$e().k)({intl:s,propertySchema:l,typecheckContextValues:u,value:c,valueContext:d})),[s,l,u,c,d]);return p||null}function Ct(e){const{automationActionId:t,propertyActionValue:o,propertySchema:n}=e,i=(0,a().O7)(),s=(0,l().Fg)(),{automationStore:c}=(0,C().YC)(),u=(0,lt().z)({actionId:t}),d=(0,r().VK)((()=>(0,Je().lG)({automationStore:c,environment:i,propertySchema:n,theme:s,typecheckContextValues:u,value:o.value})),[c,i,o.value,n,s,u]);return d||null}function kt(e){const{collectionStore:t,propertyActionValue:o,propertySchema:n,contextValues:i}=e,a=(0,f().YB)(),l=(0,r().VK)((()=>(0,ct().y3)({getRecordModel:t.getRecordModel,contextValues:i,intl:a,operator:o.action,propertySchema:n,value:o.value})),[t.getRecordModel,a,o.action,o.value,n,i]);return l||null}var jt=()=>o(730120),Mt=()=>o(794623),Tt=()=>o(779247),wt=()=>o(269299),At=()=>o(348141),It=()=>o(603692),_t=()=>o(917949),Pt=()=>o(644248),Vt=()=>o(397079);const Bt=(0,f().vU)({whatsNewTitle:{defaultMessage:"See what’s new",id:"database.viewSettings.automationTab.automationWhatsNewTitle"},whatsNewUrl:{defaultMessage:"URL to show what’s new",id:"database.viewSettings.automationTab.automationWhatsNewUrl"},tryRepeatingTriggersTitle:{defaultMessage:"Try repeating triggers",id:"database.viewSettings.automationTab.automationWhatsNew.tryRepeatingTriggersTitle"},tryRepeatingTriggersBody:{defaultMessage:"Automatically create and edit items on a schedule",id:"database.viewSettings.automationTab.automationWhatsNew.tryRepeatingTriggersBody"}}),Rt={try_repeating_triggers:{title:Bt.tryRepeatingTriggersTitle,body:Bt.tryRepeatingTriggersBody,url:"https://www.notion.com/help/database-automations#database-automation-triggers"}};function Kt(e){let{collectionStoreId:t,surface:o,type:n}=e;const[s,c]=(0,i.useState)(!0),[u,d]=(0,Pt().C)(),[p,m]=(0,Vt().V)(),g=(0,Mt().Z)(u,p),h=(0,a().O7)(),y=(0,r().VK)((()=>{const{currentUserSettingsStore:e}=te().default.state;if(!e||!e.isReady())return!1;const t=e.getSettingsStore().getKeyStore(`has_clicked_${n}_prompt`).getValue(),o=e.getSettingsStore().getKeyStore(`has_clicked_close_${n}_prompt`).getValue();if(t||o)return!1;const i=e.getSettingsStore().getKeyStore(`seen_${n}_prompt_at`).getValue();if((0,v().$K)(i)){const e=jt().ou.fromMillis(i),t=jt().ou.fromMillis(jt().ou.now().toMillis()).diff(e,["weeks"]),o=t.toObject().weeks??0;return(0,v().$K)(t.toObject().weeks)&&o<=5}return wt().createAndCommit({userAction:"AutomationsView.markPromptFirstSeen",environment:h,canUndo:!0,perform:t=>{At().d2({userSettingsStore:e,transaction:t,data:{[`seen_${n}_prompt_at`]:jt().ou.now().toMillis()}})}}),!0}),[h,n]),x=(0,l().yK)((e=>({title:{alignItems:"center",display:"flex",color:e.regularTextColor,lineHeight:"20px",flexDirection:"row",gap:"2px"},container:{background:e.tint.regular,borderRadius:10,cursor:"pointer",display:"block",height:"fit-content",textDecoration:"none",position:"relative"},description:{fontSize:"14px",lineHeight:"20px"},promptContainer:{padding:"9px 12px"},hoverPressedLayer:{backgroundColor:"transparent",borderRadius:10,height:"100%",position:"absolute",width:"100%",...d?{backgroundColor:"light"===e.mode?e.accentColors.translucentGray[50]:e.accentColors.translucentGray[200]}:{},...m?{backgroundColor:e.accentColors.translucentGray[300]}:{}},titleLinkButton:{marginLeft:"2px"},dismissIconStyles:{color:e.icon.secondary,display:d||m?"block":"none"},dismissButtonStyles:{alignItems:"center",borderRadius:4,display:"flex",height:20,justifyContent:"center",marginRight:-10,marginTop:-4,width:20}})),[d,m]),S=(0,i.useCallback)((()=>{if(!t)return;(0,P().j)({environment:h,event:{eventName:"automation_learn_click",eventProperties:{collection_id:t,specific_feature:n,surface:o}}});const{currentUserSettingsStore:e}=te().default.state;e&&e.isReady()&&wt().createAndCommit({userAction:"AutomationsView.markPromptLinkClicked",environment:h,canUndo:!0,perform:t=>{At().d2({userSettingsStore:e,transaction:t,data:{[`has_clicked_${n}_prompt`]:!0}})}})}),[t,n,o,h]),b=(0,i.useCallback)((e=>{if(e.preventDefault(),e.stopPropagation(),c(!1),!t)return;(0,P().j)({environment:h,event:{eventName:"automation_close_learn_prompt",eventProperties:{collection_id:t,specific_feature:n,surface:o}}});const{currentUserSettingsStore:i}=te().default.state;i&&i.isReady()&&wt().createAndCommit({userAction:"AutomationsView.markPromptDismissed",environment:h,canUndo:!0,perform:e=>{At().d2({userSettingsStore:i,transaction:e,data:{[`has_clicked_close_${n}_prompt`]:!0}})}})}),[t,h,o,n]);return s&&y?(0,$.jsx)("div",{ref:g,children:(0,$.jsxs)(T().Z,{href:Rt[n].url,external:!0,onClick:S,style:x.container,children:[(m||d)&&(0,$.jsx)("div",{style:x.hoverPressedLayer}),(0,$.jsx)(_t().N,{title:(0,$.jsxs)("div",{style:x.title,children:[(0,$.jsx)(f()._H,{...Rt[n].title}),(0,$.jsx)(It().y,{iconGroup:Tt().T,variantName:"mini",colorName:"secondary"})]}),description:(0,$.jsx)("span",{style:x.description,children:(0,$.jsx)(f()._H,{...Rt[n].body})}),onDismiss:b,customDismissIconStyles:x.dismissIconStyles,customContainerStyles:x.promptContainer,customDismissButtonStyles:x.dismissButtonStyles})]})}):null}const Ft=(0,f().vU)({automationTabTitle:{defaultMessage:"Automations",id:"database.viewSettings.automationTab.title"},automationTabFilterButton:{defaultMessage:"Filter",id:"database.viewSettings.automationTab.filterButton"},automationTabAddFilterButton:{defaultMessage:"Add filter",id:"database.viewSettings.automationTab.addFilterButton"},automationTabFilterMenuSearchInputPlaceholder:{defaultMessage:"Filter by…",id:"database.viewSettings.automationTab.filterMenuSearchInputPlaceholder"},automationTabFilterMenuNoResults:{defaultMessage:"No results",id:"database.viewSettings.automationTab.filterMenuNoResults"},automationNewAutomationTitle:{defaultMessage:"New automation",id:"database.viewSettings.automationTab.newAutomationTitle"},automationLearnAutomationTitle:{defaultMessage:"Learn about automations",id:"database.viewSettings.automationTab.learnAutomationTitle"},automationDisabledCaption:{defaultMessage:"Paused",id:"database.viewSettings.automationTab.disabledCaption"},automationEmptyViewEditorPublic:{defaultMessage:"Automatically edit properties, create pages, send updates, and more",id:"database.viewSettings.automationTab.automationEmptyViewEditorPublic"},automationEmptyViewReadOnly:{defaultMessage:"You're a content viewer. Content viewers cannot create automations.",id:"database.viewSettings.automationTab.automationEmptyViewReadOnly"},automationEmptyViewContentOnly:{defaultMessage:"You're a content editor. Content editors can edit pages, but cannot create automations.",id:"database.viewSettings.automationTab.automationEmptyViewContentOnly"},automationSearchPlaceholder:{defaultMessage:"Search automations…",id:"database.viewSettings.automationTab.automationSearchPlaceholder"},automationInvalidPausedCaption:{defaultMessage:"Fix any errors or remove failing steps to enable this automation",id:"database.viewSettings.automationTab.automationInvalidPausedCaption"},automationInvalidActiveCaption:{defaultMessage:"Fix any errors or remove failing steps to prevent this automation from pausing on failure",id:"database.viewSettings.automationTab.automationInvalidActiveCaption"}});function Zt(e){const{collectionContextStore:t,collectionSettingsStore:o,fullHeight:s,tabSettings:c}=e,u=(0,a().O7)(),d=(0,f().YB)(),{isMobile:p}=(0,a().Fy)(),[m,g]=(0,i.useState)(""),h=(0,r().VK)((()=>t.collectionStore()),[t]),x=(0,r().VK)((()=>t.collectionViewBlockStore()),[t]),b=(0,r().VK)((()=>h&&h.id),[h]),R=(0,r().VK)((()=>null==h?void 0:h.getSchema()),[h]),F=(0,r().VK)((()=>null==h?void 0:h.getFormat()),[h]),Z=(0,r().VK)((()=>function(e){const{collectionStore:t,collectionViewBlockStore:o}=e;if(!t||!o)return[];const n=t.getAutomationStores(),i=[];for(const a of n){const e=a.getModel();null!=e&&e.getAlive()&&(a.isDisplayableInCollectionSettings()&&i.push(a))}return i}({collectionStore:h,collectionViewBlockStore:x})),[h,x]),L=(0,r().VK)((()=>function(e){const{automationStores:t,collectionSchema:o,intl:i}=e,a=new Map,r=[];for(const n of t){var l;if(!n.isDefined())continue;const e=[],t=n.getName();void 0!==t&&e.push(t);const s=null===(l=n.getOwnerStore())||void 0===l?void 0:l.getDisplayName(i);if(void 0!==s&&e.push(s),n.isTriggerType("event")||n.isTriggerType("notification_event")){const t=n.getEventConfiguration(),a=null==t?void 0:t.pagePropertiesEdited;let r;if("some"===(null==a?void 0:a.type)?r=a.some:"all"===(null==a?void 0:a.type)&&(r=a.all),r)for(const n of r){const t=null==o?void 0:o[n.property];t&&e.push(`${t.name} ${V().SO[t.type]}`)}const l=Ot(n.getActionStores(),o,i);e.push(...l)}else if(n.isTriggerType("recurrence")){const t=n.getRecurrence();t&&e.push((0,k().De)({recurrence:t,intl:i,leadingPhrase:"every"}));const a=Ot(n.getActionStores(),o,i);e.push(...a)}const c=e.join(" ");a.set(n.id,c),r.push(c)}return function(e){const o=new Set(n().filter(e,r).map((e=>{let{original:t}=e;return t})));return t.filter((0,v().AO)((e=>{if(!e.isTriggerType("event")&&!e.isTriggerType("notification_event")&&!e.isTriggerType("recurrence"))return{false:e};const t=a.get(e.id);return t&&o.has(t)?{true:e}:{false:e}})))}}({automationStores:Z,collectionSchema:R,intl:d})),[Z,R,d]),E=(0,r().VK)((()=>L(m)),[L,m]),H=(0,r().VK)((()=>B().Li({collectionStore:h})),[h]),O=(0,i.useCallback)((()=>{S().Uk(o)}),[o]),U=(0,i.useCallback)((e=>g(e.target.value)),[]),W=(0,i.useCallback)((()=>{b&&(0,P().j)({environment:u,event:{eventName:"automation_learn_click",eventProperties:{collection_id:b}}})}),[u,b]);(0,i.useEffect)((()=>{b&&((0,P().j)({environment:u,event:{eventName:"automation_list_view",eventProperties:{source:c.source,collection_id:b}}}),oe().default.logEvent("automation_list_view","true"))}),[u,b,c]);const[z,G]=i.useState(!1),Y=(0,r().VK)((()=>function(e){var t;const o=null===(t=te().default.state.currentUserStore)||void 0===t?void 0:t.pointer,n=[],i=[];for(const a of e){const e=a.getCreatedByPointer();o&&e&&y().dr.isEqual(o,e)?n.push(a):i.push(a)}return n.sort(((e,t)=>t.getLastEditedTime()-e.getLastEditedTime())),i.sort(((e,t)=>t.getLastEditedTime()-e.getLastEditedTime())),{currentUserAutomations:n,otherUserAutomations:i}}(E)),[E]),q=(0,i.useMemo)((()=>{const{currentUserAutomations:e,otherUserAutomations:t}=Y;return z?[...e,...t]:e.length>0?e:t}),[Y,z]),X=E.length-q.length,J=!z&&X>0,Q=q.length>0,ie=!Q&&!(""!==m),ae=(0,K().E)("automation_generalized_recurrence"),{currentSpaceStoreId:re,currentUserStoreId:le}=(0,r().VK)((()=>{var e,t;return{currentSpaceStoreId:null===(e=te().default.state.currentSpaceStore)||void 0===e?void 0:e.id,currentUserStoreId:null===(t=te().default.state.currentUserStore)||void 0===t?void 0:t.id}}),[]),se=(0,ne().VX)({name:"premium_automations",spaceId:re,userId:le}),ce=(0,r().VK)((()=>B().Li({collectionStore:h})),[h]),ue=se&&ae&&ce,de=(0,l().yK)((e=>({buttonList:{display:"flex",flexDirection:"column",flexShrink:1,gap:12,overflow:"hidden auto",paddingBlockEnd:p?0:12,paddingBlockStart:p?12:0,paddingInline:12},emptyViewWrap:{paddingBlockEnd:12,paddingInline:12},menuScrollerStyle:{marginBlockStart:p?12:8},wrap:{display:"flex",flexDirection:"column"},showMoreButtonContainer:{marginLeft:12,marginBottom:12,marginRight:"auto"},showMoreButtonContent:{fontSize:12},noResultsTitle:{color:e.text.secondary,fontSize:12,margin:0},createSection:{paddingBlock:20},createButtonWrapper:{paddingInline:12},createButton:{width:"100%",display:"flex",gap:6},headerContainer:{alignItems:"center",display:"flex",gap:4},headerInfoIcon:{fill:e.mediumIconColor,height:14,width:14}})),[p]);return h&&R&&F&&x?(0,$.jsx)(j().ZP,{...e,fullHeight:s,header:!ie&&(0,$.jsx)(A().Z,{children:(0,$.jsx)(M().ZP,{focusInitial:!p,onChange:U,placeholder:d.formatMessage(Ft.automationSearchPlaceholder),showClearButton:!0,value:m})}),footer:(0,$.jsx)(A().Z,{style:de.createSection,topBorder:!1,children:H&&(0,$.jsx)("div",{style:de.createButtonWrapper,children:(0,$.jsxs)(w().Z,{style:de.createButton,onClick:O,children:[(0,N().R)({width:14,height:14}),(0,$.jsx)(f()._H,{...Ft.automationNewAutomationTitle})]})})}),menuScrollerStyle:de.menuScrollerStyle,title:Q||m?(0,$.jsxs)("div",{style:de.headerContainer,children:[(0,$.jsx)(f()._H,{...Ft.automationTabTitle}),(0,$.jsx)(_().Z,{placement:ee().Placement.Right,renderTooltip:()=>(0,$.jsx)(f()._H,{...Ft.automationLearnAutomationTitle}),render:e=>(0,$.jsx)(T().Z,{...e,href:"https://www.notion.so/help/database-automations",external:!0,onClick:W,children:(0,D().m)(de.headerInfoIcon)})})]}):null,children:(0,$.jsx)("div",{style:de.wrap,children:ie?(0,$.jsxs)("div",{style:de.emptyViewWrap,children:[(0,$.jsx)(Lt,{collectionStore:h}),ue&&(0,$.jsx)(Kt,{surface:"empty_automations_view",type:"try_repeating_triggers",collectionStoreId:b})]}):(0,$.jsxs)($.Fragment,{children:[(0,$.jsxs)("div",{style:de.buttonList,children:[ue&&(0,$.jsx)(Kt,{surface:"list_automations_view",type:"try_repeating_triggers",collectionStoreId:b}),q.length>0?q.map(((e,n)=>(0,$.jsx)(C().gJ,{automationStore:e,children:(0,$.jsx)(Ht,{collectionContextStore:t,collectionStore:h,collectionSettingsStore:o,focused:!1,schema:R})},e.id))):(0,$.jsx)("p",{style:de.noResultsTitle,children:(0,$.jsx)(f()._H,{defaultMessage:"No results",id:"collectionSettings.automationsView.noResults"})})]}),J&&(0,$.jsx)(I().Z,{style:de.showMoreButtonContainer,onClick:e=>{e.stopPropagation(),G(!0)},children:(0,$.jsx)("div",{style:de.showMoreButtonContent,children:(0,$.jsx)(f()._H,{id:"collectionSettings.automationsView.showMore",defaultMessage:"Show {number} more",values:{number:X}})})})]})})}):null}function Lt(e){const{collectionStore:t}=e,o=(0,a().O7)(),n=(0,l().yK)((e=>({wrap:{alignItems:"center",display:"flex",flexDirection:"column",gap:7.5,justifyContent:"center",minHeight:250,textAlign:"center"},icon:{fill:e.icon.yellowPrimary,height:24,width:24},title:{fontSize:17,fontWeight:x().Ue.medium,margin:0},copy:{color:e.text.secondary,fontSize:14,margin:0,lineHeight:1.5}})),[]),i=(0,r().VK)((()=>t.getRole()),[t]);let s;return s=(0,r().VK)((()=>Boolean((0,R().IJ)(o,t))),[t,o])||!i||"editor"===i?Ft.automationEmptyViewEditorPublic:"reader"===i||"comment_only"===i?Ft.automationEmptyViewReadOnly:"content_only_editor"===i||"read_and_write"===i?Ft.automationEmptyViewContentOnly:Ft.automationEmptyViewEditorPublic,(0,$.jsxs)("div",{style:n.wrap,children:[(0,$.jsx)("div",{"aria-hidden":!0,children:(0,Z().K)(n.icon)}),(0,$.jsx)("p",{style:n.title,children:(0,$.jsx)(f()._H,{...Ft.automationTabTitle})}),(0,$.jsx)("p",{style:n.copy,children:(0,$.jsx)(f()._H,{...s})})]})}const Et={text:J().p,number:o(947189).J,url:o(161149).O,file:o(208444).Z,date:o(866456).V,person:o(563701).O,email:o(519710).n,phone_number:o(118006).u,checkbox:o(850505).r,select:o(303611).w,multi_select:q().A,status:X().T,relation:o(848854).v,rollup:o(720927).G,formula:o(382047).D,created_time:W().I,created_by:z().H,title:o(586365).c,last_edited_time:W().I,last_edited_by:z().H,last_visited_time:W().I,button:X().T,auto_increment_id:o(221065).A,location:Y,verification:o(541402).f,ai_summary:o(34812).Y,ai_custom_prompt:o(257185).y,ai_extract:q().A,ai_translate:o(289271).Q,ai_keywords:o(684793).F};function Ht(e){const{collectionContextStore:t,collectionStore:o,collectionSettingsStore:n,focused:l,schema:u}=e,d=(0,f().YB)(),y=(0,a().O7)(),{automationStore:x,typecheckResult:j}=(0,C().YC)(),M=(0,r().VK)((()=>B().qk({automationStore:x,collectionStore:o,typecheckResult:j})),[x,o,j]),T=(0,r().VK)((()=>x.getActionStores()),[x]),w=(0,r().VK)((()=>x.getTriggerStore().getValue()),[x]),A=(0,r().VK)((()=>x.getNameWithDefault(d)),[d,x]),I=(0,r().VK)((()=>x.isActive()),[x]),_=(0,r().Kw)(t.aliveAutomationCountStore),P=(0,r().VK)((()=>B().i1({actionStores:T,automationStore:x,collectionStore:o})),[T,x,o]),V=(0,r().VK)((()=>B().qM({automationStore:x,collectionStore:o})),[x,o]),R=(0,i.useCallback)((async()=>{await ie().SC({collectionStore:o,environment:y,existingAutomationStore:x,intl:d,onDelete:()=>{1===_&&S().wl({collectionSettingsStore:n,item:{type:"main"}})}})}),[d,y,o,n,x,_]),Z=(0,i.useCallback)((()=>{ie().j3({automationStore:x,collectionStore:o,environment:y})}),[o,y,x]),D=(0,i.useCallback)((()=>{S().ID({collectionSettingsStore:n,item:{type:"automationEditSettings",automationId:x.id,source:"collection_settings_automation_view"}})}),[n,x.id]),W=(0,i.useCallback)((()=>{ie().$K({automationStore:x,collectionStore:o,environment:y})}),[o,y,x]),z=(0,i.useCallback)((()=>{ie().HF({automationStore:x,collectionStore:o,environment:y})}),[x,o,y]),G=(0,r().VK)((()=>w?function(e){const{schema:t,triggerConfig:o,collectionStore:n}=e,i=[];if("notification_event"===o.type||"event"===o.type){o.event.pagesAdded&&i.push({color:"blue",icon:N().R,type:"page"});const e=o.event.pagePropertiesEdited;if("any"===e.type)i.push({color:"blue",icon:O().R,type:"misc"});else if("some"===e.type||"all"===e.type){let o=[];"some"===e.type?o=e.some??[]:"all"===e.type&&(o=e.all??[]);for(const e of o){const o=t[e.property],a=e.filter;if(!o)continue;if(!c().Ym[o.type]){i.push({color:"gray",icon:Dt(o.type),type:"property"});continue}const r=m().gB(o),l=m().cu(o),u=m().KR(o),d=m().G$(o),h=(0,g().TN)(o.type),y=m().p_(o);if("changes_to_any"===a.operator)i.push({color:r||l?"gray":"blue",icon:Dt(o.type),type:"property"});else if(r&&!p().mv(a)&&p().r2(a)){const e=p().wB(a);if(e.length>1)i.push({color:"gray",icon:Dt(o.type),type:"property"});else if(1===e.length){const t=e[0];if("is_group"===t.type){const e=(o.groups??[]).find((e=>e.name===t.value));e&&i.push({color:e.color??"gray",icon:Dt(o.type),type:"property"})}else{const e=(o.options??[]).find((e=>e.value===t.value));e&&i.push({color:e.color??"gray",icon:Dt(o.type),type:"property"})}}}else if(l&&(p().dx(a)||p().NU(a))){const e=p().mv(a)?[]:p().dx(a)?p().mg(a):p().qC(a);if(1===e.length){const t=e[0],n=(o.options??[]).find((e=>e.value===t.value));n&&i.push({color:n.color??"gray",icon:Dt(o.type),type:"property"})}else(e.length>1||0===e.length)&&i.push({color:"gray",icon:Dt(o.type),type:"property"})}else if(u&&p().Gb(a)){const e=p().mv(a)?[]:p().R8(a);if(1===e.length){if(!p().mv(a)){const e=p().R8(a)[0];if("exact"===e.type&&e.value){const t=(0,s().Hl)({pointer:e.value,getRecordValue:n.getRecordValue});i.push({actor:t,type:"person"})}}}else(e.length>1||0===e.length)&&i.push({color:"gray",icon:Dt(o.type),type:"property"})}else(d&&p().h6(a)||h&&p().Ly(a)||y&&p().e(a))&&i.push({color:"is_empty"===a.operator?"gray":"blue",icon:Dt(o.type),type:"property"})}}}else"recurrence"===o.type?i.push({color:"blue",icon:L().C,type:"misc"}):"button"===o.type||(0,v().t1)(o);return i}({schema:u,triggerConfig:w,collectionStore:o}):[]),[u,w,o]),Y=(0,r().VK)((()=>function(e){const{actionStores:t,collectionStore:o,schema:n}=e,i=[];for(const d of t)if(d.isType("slack_notification"))i.push({icon:U().P,type:"app"});else if(d.isType("update_pages")){const e=d.getConfig(),t=(null==e?void 0:e.properties)??[];if(1===t.length){var a,r;const u=t[0],d=n[u],p=null==e||null===(a=e.values)||void 0===a?void 0:a[u];if(!d||!p)continue;if(!c().SF(d)){i.push({color:"gray",icon:Dt(d.type),type:"property"});continue}const y=(0,h().fromSimpleFormulaArrayValue)(null===(r=p.value)||void 0===r?void 0:r.value);if(m().gB(d)){const e=(d.options||[]).find((e=>e.value===y[0]));e&&i.push({color:e.color??"gray",icon:Dt(d.type),type:"property"})}else if(m().cu(d))if(1===y.length){const e=(d.options||[]).find((e=>e.value===y[0]));e&&i.push({color:e.color??"gray",icon:Dt(d.type),type:"property"})}else y.length>1&&i.push({color:"gray",icon:Dt(d.type),type:"property"});else if(m().KR(d)){var l;const e=(0,g().DW)({textValue:null===(l=p.value)||void 0===l?void 0:l.value,propertySchema:d,blockCreatorPointer:void 0}).map((e=>(0,s().Hl)({pointer:e,getRecordValue:o.getRecordValue})));1===e.length?i.push({actor:e[0],type:"person"}):i.push({color:"gray",icon:Dt(d.type),type:"property"})}else i.push({color:"gray",icon:Dt(d.type),type:"property"})}else t.length>1&&i.push({color:"gray",icon:O().R,type:"misc"})}else if(d.isType("create_page")){var u;(null===(u=d.getConfig())||void 0===u?void 0:u.collection)&&i.push({color:"blue",icon:N().R,type:"page"})}else d.isType("send_in_app_notification")?i.push({color:"blue",icon:F().t,type:"misc"}):d.isType("define_variables")?i.push({color:"gray",icon:J().p,type:"misc"}):d.isType("send_gmail_notification")?i.push({icon:H().w,type:"app"}):d.isType("http_request")&&i.push({color:"gray",icon:e=>(0,E().y)({transform:"scale(1.35)",...e}),type:"misc"});return i}({actionStores:T,collectionStore:o,schema:u})),[u,o,T]),q=(0,r().VK)((()=>{if(x.isTriggerType("event")||x.isTriggerType("notification_event")){return!x.getTrigger()||B().vM({automationStore:x,collectionStore:o})}return!1}),[x,o]),X=(0,i.useMemo)((()=>{if(j.error)return!0;const e=j.value.actionValidationFailures;return Object.values(e).flat().length>0}),[j]),Q=(0,K().E)("automation_updated_error_states"),te=(0,r().VK)((()=>{var e,t;const o=null===(e=x.getModel())||void 0===e?void 0:e.getLastFailedTime(),n=null===(t=x.getModel())||void 0===t?void 0:t.getLastExecutedTime();if(Q){if(X||q||!M)return"invalid";if(o&&n&&o>=n&&!I)return"failing";if(!I)return(0,k().HH)(x)?"expired":"paused"}else{if(X||q)return"error";if(!I)return"warning"}return"success"}),[x,Q,X,q,M,I]),{caption:oe,tooltipCaption:ne}=(0,r().VK)((()=>{const e=I||Q?ht({actionStores:T,collectionStore:o,environment:y,getRecordModel:x.getRecordModel,intl:d,schema:u,triggerConfig:w,typecheckResult:j,hasAutomationUpdatedErrorStatesEnabled:Q}):d.formatMessage(Ft.automationDisabledCaption);return{caption:e,tooltipCaption:Q&&"invalid"===te?(0,$.jsx)(f()._H,{...I?Ft.automationInvalidActiveCaption:Ft.automationInvalidPausedCaption}):e}}),[I,Q,d,T,o,y,x.getRecordModel,u,w,j,te]),ae=(0,i.useCallback)((e=>(0,i.createElement)(Ve,{...e,key:x.id,actions:Y,caption:oe,focused:l,status:te,onClick:D,onDelete:V?R:void 0,onDisable:I&&V&&M?Z:void 0,onDuplicate:P?z:void 0,onEdit:P?D:void 0,onEnable:!I&&V&&M?W:void 0,title:A,triggers:G})),[Y,x.id,P,V,oe,l,te,I,M,R,Z,z,D,W,A,G]);return(0,$.jsx)(b().y,{caption:ne,renderOrigin:ae,title:A,tooltipAlignment:ee().Alignment.Start,tooltipPlacement:ee().Placement.Left})}function Dt(e){return(0,v().$K)(e)?Et[e]??Q().S:Q().S}function Ot(e,t,o){const n=[];for(const a of e){const e=a.getType();if(e){const t=(0,u().getActionRegistryItem)(e);(0,d().Xp)(t)&&n.push(o.formatMessage(t.display.name))}if(a.isType("create_page")||a.isType("update_pages")){var i;const e=a.getConfig();null==e||null===(i=e.properties)||void 0===i||i.forEach((e=>{const o=null==t?void 0:t[e];o&&n.push(`${o.name} ${V().SO[o.type]}`)}))}}return n}},681035:(e,t,o)=>{o.d(t,{S:()=>a});var n=()=>o(677559);const i=new(n().Ss)("CollectionItemCover",(async()=>{const{CollectionItemCover:e}=await Promise.all([o.e(62743),o.e(37912)]).then(o.bind(o,682652));return{CollectionItemCover:e}})),a=(0,n().kF)(i,(e=>e.CollectionItemCover))},675393:(e,t,o)=>{o.d(t,{DG:()=>h,Di:()=>i,F7:()=>c,Lq:()=>u,Q3:()=>s,ZH:()=>p,aL:()=>l,aP:()=>f,db:()=>a,gS:()=>b,i4:()=>g,lG:()=>x,mN:()=>S,oC:()=>m,op:()=>y,pn:()=>d,q4:()=>r,w3:()=>v});var n=()=>o(677559);const i=new(n().Ss)("menus",(async()=>{const[{default:e},{TopbarPageAnalyticsOptOutMenu:t},{default:n},{default:i},{default:a},{default:r},{default:l},{default:s},{default:c},{default:u},{default:d},{SidebarTeamModal:p},{SidebarCreateTeamModal:m},{CreateTeamFromPageConfirmModal:g},{CollectionTypedDatabaseMigrationModal:h},{default:y},{default:f},{default:v}]=await Promise.all([Promise.all([o.e(62743),o.e(52774),o.e(44832),o.e(39938),o.e(90698),o.e(84885),o.e(37358),o.e(5242),o.e(7312),o.e(90424),o.e(81580),o.e(84325),o.e(31189),o.e(69343),o.e(46293),o.e(94556),o.e(78701),o.e(38804),o.e(17100),o.e(11846),o.e(70355),o.e(2971),o.e(80741),o.e(72586),o.e(53335),o.e(71896),o.e(46616),o.e(54940),o.e(49396),o.e(98721),o.e(98032),o.e(57229),o.e(63707),o.e(86609),o.e(91253),o.e(4642),o.e(5006),o.e(6612),o.e(61171),o.e(23179),o.e(75377),o.e(31020),o.e(2942),o.e(73682),o.e(58591),o.e(54803),o.e(1953),o.e(10216),o.e(58565),o.e(69197),o.e(42055),o.e(38739),o.e(44751),o.e(81567),o.e(63257),o.e(34291),o.e(1913),o.e(56054),o.e(95076),o.e(92341),o.e(82658),o.e(4163),o.e(69583),o.e(22759),o.e(20343),o.e(21820),o.e(46945),o.e(10553),o.e(67019),o.e(27039),o.e(25265),o.e(14581),o.e(38632),o.e(61651),o.e(88702),o.e(54307),o.e(43184),o.e(87647),o.e(75861),o.e(46257),o.e(15819),o.e(45376),o.e(74943),o.e(23721),o.e(58461),o.e(72329),o.e(19592),o.e(3331),o.e(98672),o.e(52658),o.e(44642),o.e(78),o.e(58586)]).then(o.bind(o,55351)),Promise.all([o.e(62743),o.e(52774),o.e(44832),o.e(39938),o.e(90698),o.e(84885),o.e(37358),o.e(5242),o.e(7312),o.e(90424),o.e(81580),o.e(84325),o.e(31189),o.e(69343),o.e(46293),o.e(94556),o.e(78701),o.e(38804),o.e(17100),o.e(11846),o.e(70355),o.e(2971),o.e(80741),o.e(72586),o.e(53335),o.e(71896),o.e(46616),o.e(54940),o.e(49396),o.e(98721),o.e(98032),o.e(57229),o.e(63707),o.e(86609),o.e(91253),o.e(4642),o.e(5006),o.e(6612),o.e(61171),o.e(23179),o.e(75377),o.e(31020),o.e(2942),o.e(73682),o.e(58591),o.e(54803),o.e(1953),o.e(10216),o.e(58565),o.e(69197),o.e(42055),o.e(38739),o.e(44751),o.e(81567),o.e(63257),o.e(34291),o.e(1913),o.e(56054),o.e(95076),o.e(92341),o.e(82658),o.e(4163),o.e(69583),o.e(22759),o.e(20343),o.e(21820),o.e(46945),o.e(10553),o.e(67019),o.e(27039),o.e(25265),o.e(14581),o.e(38632),o.e(61651),o.e(88702),o.e(54307),o.e(43184),o.e(87647),o.e(75861),o.e(46257),o.e(15819),o.e(45376),o.e(74943),o.e(23721),o.e(58461),o.e(72329),o.e(19592),o.e(3331),o.e(98672),o.e(52658),o.e(44642),o.e(78),o.e(58586)]).then(o.bind(o,83340)),Promise.all([o.e(62743),o.e(52774),o.e(44832),o.e(39938),o.e(90698),o.e(84885),o.e(37358),o.e(5242),o.e(7312),o.e(90424),o.e(81580),o.e(84325),o.e(31189),o.e(69343),o.e(46293),o.e(94556),o.e(78701),o.e(38804),o.e(17100),o.e(11846),o.e(70355),o.e(2971),o.e(80741),o.e(72586),o.e(53335),o.e(71896),o.e(46616),o.e(54940),o.e(49396),o.e(98721),o.e(98032),o.e(57229),o.e(63707),o.e(86609),o.e(91253),o.e(4642),o.e(5006),o.e(6612),o.e(61171),o.e(23179),o.e(75377),o.e(31020),o.e(2942),o.e(73682),o.e(58591),o.e(54803),o.e(1953),o.e(10216),o.e(58565),o.e(69197),o.e(42055),o.e(38739),o.e(44751),o.e(81567),o.e(63257),o.e(34291),o.e(1913),o.e(56054),o.e(95076),o.e(92341),o.e(82658),o.e(4163),o.e(69583),o.e(22759),o.e(20343),o.e(21820),o.e(46945),o.e(10553),o.e(67019),o.e(27039),o.e(25265),o.e(14581),o.e(38632),o.e(61651),o.e(88702),o.e(54307),o.e(43184),o.e(87647),o.e(75861),o.e(46257),o.e(15819),o.e(45376),o.e(74943),o.e(23721),o.e(58461),o.e(72329),o.e(19592),o.e(3331),o.e(98672),o.e(52658),o.e(44642),o.e(78),o.e(58586)]).then(o.bind(o,11070)),Promise.all([o.e(62743),o.e(52774),o.e(44832),o.e(39938),o.e(90698),o.e(84885),o.e(37358),o.e(5242),o.e(7312),o.e(90424),o.e(81580),o.e(84325),o.e(31189),o.e(69343),o.e(46293),o.e(94556),o.e(78701),o.e(38804),o.e(17100),o.e(11846),o.e(70355),o.e(2971),o.e(80741),o.e(72586),o.e(53335),o.e(71896),o.e(46616),o.e(54940),o.e(49396),o.e(98721),o.e(98032),o.e(57229),o.e(63707),o.e(86609),o.e(91253),o.e(4642),o.e(5006),o.e(6612),o.e(61171),o.e(23179),o.e(75377),o.e(31020),o.e(2942),o.e(73682),o.e(58591),o.e(54803),o.e(1953),o.e(10216),o.e(58565),o.e(69197),o.e(42055),o.e(38739),o.e(44751),o.e(81567),o.e(63257),o.e(34291),o.e(1913),o.e(56054),o.e(95076),o.e(92341),o.e(82658),o.e(4163),o.e(69583),o.e(22759),o.e(20343),o.e(21820),o.e(46945),o.e(10553),o.e(67019),o.e(27039),o.e(25265),o.e(14581),o.e(38632),o.e(61651),o.e(88702),o.e(54307),o.e(43184),o.e(87647),o.e(75861),o.e(46257),o.e(15819),o.e(45376),o.e(74943),o.e(23721),o.e(58461),o.e(72329),o.e(19592),o.e(3331),o.e(98672),o.e(52658),o.e(44642),o.e(78),o.e(58586)]).then(o.bind(o,487974)),Promise.all([o.e(62743),o.e(52774),o.e(44832),o.e(39938),o.e(90698),o.e(84885),o.e(37358),o.e(5242),o.e(7312),o.e(90424),o.e(81580),o.e(84325),o.e(31189),o.e(69343),o.e(46293),o.e(94556),o.e(78701),o.e(38804),o.e(17100),o.e(11846),o.e(70355),o.e(2971),o.e(80741),o.e(72586),o.e(53335),o.e(71896),o.e(46616),o.e(54940),o.e(49396),o.e(98721),o.e(98032),o.e(57229),o.e(63707),o.e(86609),o.e(91253),o.e(4642),o.e(5006),o.e(6612),o.e(61171),o.e(23179),o.e(75377),o.e(31020),o.e(2942),o.e(73682),o.e(58591),o.e(54803),o.e(1953),o.e(10216),o.e(58565),o.e(69197),o.e(42055),o.e(38739),o.e(44751),o.e(81567),o.e(63257),o.e(34291),o.e(1913),o.e(56054),o.e(95076),o.e(92341),o.e(82658),o.e(4163),o.e(69583),o.e(22759),o.e(20343),o.e(21820),o.e(46945),o.e(10553),o.e(67019),o.e(27039),o.e(25265),o.e(14581),o.e(38632),o.e(61651),o.e(88702),o.e(54307),o.e(43184),o.e(87647),o.e(75861),o.e(46257),o.e(15819),o.e(45376),o.e(74943),o.e(23721),o.e(58461),o.e(72329),o.e(19592),o.e(3331),o.e(98672),o.e(52658),o.e(44642),o.e(78),o.e(58586)]).then(o.bind(o,293660)),Promise.all([o.e(62743),o.e(52774),o.e(44832),o.e(39938),o.e(90698),o.e(84885),o.e(37358),o.e(5242),o.e(7312),o.e(90424),o.e(81580),o.e(84325),o.e(31189),o.e(69343),o.e(46293),o.e(94556),o.e(78701),o.e(38804),o.e(17100),o.e(11846),o.e(70355),o.e(2971),o.e(80741),o.e(72586),o.e(53335),o.e(71896),o.e(46616),o.e(54940),o.e(49396),o.e(98721),o.e(98032),o.e(57229),o.e(63707),o.e(86609),o.e(91253),o.e(4642),o.e(5006),o.e(6612),o.e(61171),o.e(23179),o.e(75377),o.e(31020),o.e(2942),o.e(73682),o.e(58591),o.e(54803),o.e(1953),o.e(10216),o.e(58565),o.e(69197),o.e(42055),o.e(38739),o.e(44751),o.e(81567),o.e(63257),o.e(34291),o.e(1913),o.e(56054),o.e(95076),o.e(92341),o.e(82658),o.e(4163),o.e(69583),o.e(22759),o.e(20343),o.e(21820),o.e(46945),o.e(10553),o.e(67019),o.e(27039),o.e(25265),o.e(14581),o.e(38632),o.e(61651),o.e(88702),o.e(54307),o.e(43184),o.e(87647),o.e(75861),o.e(46257),o.e(15819),o.e(45376),o.e(74943),o.e(23721),o.e(58461),o.e(72329),o.e(19592),o.e(3331),o.e(98672),o.e(52658),o.e(44642),o.e(78),o.e(58586)]).then(o.bind(o,743405)),Promise.all([o.e(62743),o.e(52774),o.e(44832),o.e(39938),o.e(90698),o.e(84885),o.e(37358),o.e(5242),o.e(7312),o.e(90424),o.e(81580),o.e(84325),o.e(31189),o.e(69343),o.e(46293),o.e(94556),o.e(78701),o.e(38804),o.e(17100),o.e(11846),o.e(70355),o.e(2971),o.e(80741),o.e(72586),o.e(53335),o.e(71896),o.e(46616),o.e(54940),o.e(49396),o.e(98721),o.e(98032),o.e(57229),o.e(63707),o.e(86609),o.e(91253),o.e(4642),o.e(5006),o.e(6612),o.e(61171),o.e(23179),o.e(75377),o.e(31020),o.e(2942),o.e(73682),o.e(58591),o.e(54803),o.e(1953),o.e(10216),o.e(58565),o.e(69197),o.e(42055),o.e(38739),o.e(44751),o.e(81567),o.e(63257),o.e(34291),o.e(1913),o.e(56054),o.e(95076),o.e(92341),o.e(82658),o.e(4163),o.e(69583),o.e(22759),o.e(20343),o.e(21820),o.e(46945),o.e(10553),o.e(67019),o.e(27039),o.e(25265),o.e(14581),o.e(38632),o.e(61651),o.e(88702),o.e(54307),o.e(43184),o.e(87647),o.e(75861),o.e(46257),o.e(15819),o.e(45376),o.e(74943),o.e(23721),o.e(58461),o.e(72329),o.e(19592),o.e(3331),o.e(98672),o.e(52658),o.e(44642),o.e(78),o.e(58586)]).then(o.bind(o,995744)),Promise.all([o.e(62743),o.e(52774),o.e(44832),o.e(39938),o.e(90698),o.e(84885),o.e(37358),o.e(5242),o.e(7312),o.e(90424),o.e(81580),o.e(84325),o.e(31189),o.e(69343),o.e(46293),o.e(94556),o.e(78701),o.e(38804),o.e(17100),o.e(11846),o.e(70355),o.e(2971),o.e(80741),o.e(72586),o.e(53335),o.e(71896),o.e(46616),o.e(54940),o.e(49396),o.e(98721),o.e(98032),o.e(57229),o.e(63707),o.e(86609),o.e(91253),o.e(4642),o.e(5006),o.e(6612),o.e(61171),o.e(23179),o.e(75377),o.e(31020),o.e(2942),o.e(73682),o.e(58591),o.e(54803),o.e(1953),o.e(10216),o.e(58565),o.e(69197),o.e(42055),o.e(38739),o.e(44751),o.e(81567),o.e(63257),o.e(34291),o.e(1913),o.e(56054),o.e(95076),o.e(92341),o.e(82658),o.e(4163),o.e(69583),o.e(22759),o.e(20343),o.e(21820),o.e(46945),o.e(10553),o.e(67019),o.e(27039),o.e(25265),o.e(14581),o.e(38632),o.e(61651),o.e(88702),o.e(54307),o.e(43184),o.e(87647),o.e(75861),o.e(46257),o.e(15819),o.e(45376),o.e(74943),o.e(23721),o.e(58461),o.e(72329),o.e(19592),o.e(3331),o.e(98672),o.e(52658),o.e(44642),o.e(78),o.e(58586)]).then(o.bind(o,795879)),Promise.all([o.e(62743),o.e(52774),o.e(44832),o.e(39938),o.e(90698),o.e(84885),o.e(37358),o.e(5242),o.e(7312),o.e(90424),o.e(81580),o.e(84325),o.e(31189),o.e(69343),o.e(46293),o.e(94556),o.e(78701),o.e(38804),o.e(17100),o.e(11846),o.e(70355),o.e(2971),o.e(80741),o.e(72586),o.e(53335),o.e(71896),o.e(46616),o.e(54940),o.e(49396),o.e(98721),o.e(98032),o.e(57229),o.e(63707),o.e(86609),o.e(91253),o.e(4642),o.e(5006),o.e(6612),o.e(61171),o.e(23179),o.e(75377),o.e(31020),o.e(2942),o.e(73682),o.e(58591),o.e(54803),o.e(1953),o.e(10216),o.e(58565),o.e(69197),o.e(42055),o.e(38739),o.e(44751),o.e(81567),o.e(63257),o.e(34291),o.e(1913),o.e(56054),o.e(95076),o.e(92341),o.e(82658),o.e(4163),o.e(69583),o.e(22759),o.e(20343),o.e(21820),o.e(46945),o.e(10553),o.e(67019),o.e(27039),o.e(25265),o.e(14581),o.e(38632),o.e(61651),o.e(88702),o.e(54307),o.e(43184),o.e(87647),o.e(75861),o.e(46257),o.e(15819),o.e(45376),o.e(74943),o.e(23721),o.e(58461),o.e(72329),o.e(19592),o.e(3331),o.e(98672),o.e(52658),o.e(44642),o.e(78),o.e(58586)]).then(o.bind(o,720940)),Promise.all([o.e(62743),o.e(52774),o.e(44832),o.e(39938),o.e(90698),o.e(84885),o.e(37358),o.e(5242),o.e(7312),o.e(90424),o.e(81580),o.e(84325),o.e(31189),o.e(69343),o.e(46293),o.e(94556),o.e(78701),o.e(38804),o.e(17100),o.e(11846),o.e(70355),o.e(2971),o.e(80741),o.e(72586),o.e(53335),o.e(71896),o.e(46616),o.e(54940),o.e(49396),o.e(98721),o.e(98032),o.e(57229),o.e(63707),o.e(86609),o.e(91253),o.e(4642),o.e(5006),o.e(6612),o.e(61171),o.e(23179),o.e(75377),o.e(31020),o.e(2942),o.e(73682),o.e(58591),o.e(54803),o.e(1953),o.e(10216),o.e(58565),o.e(69197),o.e(42055),o.e(38739),o.e(44751),o.e(81567),o.e(63257),o.e(34291),o.e(1913),o.e(56054),o.e(95076),o.e(92341),o.e(82658),o.e(4163),o.e(69583),o.e(22759),o.e(20343),o.e(21820),o.e(46945),o.e(10553),o.e(67019),o.e(27039),o.e(25265),o.e(14581),o.e(38632),o.e(61651),o.e(88702),o.e(54307),o.e(43184),o.e(87647),o.e(75861),o.e(46257),o.e(15819),o.e(45376),o.e(74943),o.e(23721),o.e(58461),o.e(72329),o.e(19592),o.e(3331),o.e(98672),o.e(52658),o.e(44642),o.e(78),o.e(58586)]).then(o.bind(o,515445)),Promise.all([o.e(62743),o.e(52774),o.e(44832),o.e(39938),o.e(90698),o.e(84885),o.e(37358),o.e(5242),o.e(7312),o.e(90424),o.e(81580),o.e(84325),o.e(31189),o.e(69343),o.e(46293),o.e(94556),o.e(78701),o.e(38804),o.e(17100),o.e(11846),o.e(70355),o.e(2971),o.e(80741),o.e(72586),o.e(53335),o.e(71896),o.e(46616),o.e(54940),o.e(49396),o.e(98721),o.e(98032),o.e(57229),o.e(63707),o.e(86609),o.e(91253),o.e(4642),o.e(5006),o.e(6612),o.e(61171),o.e(23179),o.e(75377),o.e(31020),o.e(2942),o.e(73682),o.e(58591),o.e(54803),o.e(1953),o.e(10216),o.e(58565),o.e(69197),o.e(42055),o.e(38739),o.e(44751),o.e(81567),o.e(63257),o.e(34291),o.e(1913),o.e(56054),o.e(95076),o.e(92341),o.e(82658),o.e(4163),o.e(69583),o.e(22759),o.e(20343),o.e(21820),o.e(46945),o.e(10553),o.e(67019),o.e(27039),o.e(25265),o.e(14581),o.e(38632),o.e(61651),o.e(88702),o.e(54307),o.e(43184),o.e(87647),o.e(75861),o.e(46257),o.e(15819),o.e(45376),o.e(74943),o.e(23721),o.e(58461),o.e(72329),o.e(19592),o.e(3331),o.e(98672),o.e(52658),o.e(44642),o.e(78),o.e(58586)]).then(o.bind(o,683850)),Promise.all([o.e(62743),o.e(52774),o.e(44832),o.e(39938),o.e(90698),o.e(84885),o.e(37358),o.e(5242),o.e(7312),o.e(90424),o.e(81580),o.e(84325),o.e(31189),o.e(69343),o.e(46293),o.e(94556),o.e(78701),o.e(38804),o.e(17100),o.e(11846),o.e(70355),o.e(2971),o.e(80741),o.e(72586),o.e(53335),o.e(71896),o.e(46616),o.e(54940),o.e(49396),o.e(98721),o.e(98032),o.e(57229),o.e(63707),o.e(86609),o.e(91253),o.e(4642),o.e(5006),o.e(6612),o.e(61171),o.e(23179),o.e(75377),o.e(31020),o.e(2942),o.e(73682),o.e(58591),o.e(54803),o.e(1953),o.e(10216),o.e(58565),o.e(69197),o.e(42055),o.e(38739),o.e(44751),o.e(81567),o.e(63257),o.e(34291),o.e(1913),o.e(56054),o.e(95076),o.e(92341),o.e(82658),o.e(4163),o.e(69583),o.e(22759),o.e(20343),o.e(21820),o.e(46945),o.e(10553),o.e(67019),o.e(27039),o.e(25265),o.e(14581),o.e(38632),o.e(61651),o.e(88702),o.e(54307),o.e(43184),o.e(87647),o.e(75861),o.e(46257),o.e(15819),o.e(45376),o.e(74943),o.e(23721),o.e(58461),o.e(72329),o.e(19592),o.e(3331),o.e(98672),o.e(52658),o.e(44642),o.e(78),o.e(58586)]).then(o.bind(o,7298)),Promise.all([o.e(62743),o.e(52774),o.e(44832),o.e(39938),o.e(90698),o.e(84885),o.e(37358),o.e(5242),o.e(7312),o.e(90424),o.e(81580),o.e(84325),o.e(31189),o.e(69343),o.e(46293),o.e(94556),o.e(78701),o.e(38804),o.e(17100),o.e(11846),o.e(70355),o.e(2971),o.e(80741),o.e(72586),o.e(53335),o.e(71896),o.e(46616),o.e(54940),o.e(49396),o.e(98721),o.e(98032),o.e(57229),o.e(63707),o.e(86609),o.e(91253),o.e(4642),o.e(5006),o.e(6612),o.e(61171),o.e(23179),o.e(75377),o.e(31020),o.e(2942),o.e(73682),o.e(58591),o.e(54803),o.e(1953),o.e(10216),o.e(58565),o.e(69197),o.e(42055),o.e(38739),o.e(44751),o.e(81567),o.e(63257),o.e(34291),o.e(1913),o.e(56054),o.e(95076),o.e(92341),o.e(82658),o.e(4163),o.e(69583),o.e(22759),o.e(20343),o.e(21820),o.e(46945),o.e(10553),o.e(67019),o.e(27039),o.e(25265),o.e(14581),o.e(38632),o.e(61651),o.e(88702),o.e(54307),o.e(43184),o.e(87647),o.e(75861),o.e(46257),o.e(15819),o.e(45376),o.e(74943),o.e(23721),o.e(58461),o.e(72329),o.e(19592),o.e(3331),o.e(98672),o.e(52658),o.e(44642),o.e(78),o.e(58586)]).then(o.bind(o,216867)),Promise.all([o.e(62743),o.e(52774),o.e(44832),o.e(39938),o.e(90698),o.e(84885),o.e(37358),o.e(5242),o.e(7312),o.e(90424),o.e(81580),o.e(84325),o.e(31189),o.e(69343),o.e(46293),o.e(94556),o.e(78701),o.e(38804),o.e(17100),o.e(11846),o.e(70355),o.e(2971),o.e(80741),o.e(72586),o.e(53335),o.e(71896),o.e(46616),o.e(54940),o.e(49396),o.e(98721),o.e(98032),o.e(57229),o.e(63707),o.e(86609),o.e(91253),o.e(4642),o.e(5006),o.e(6612),o.e(61171),o.e(23179),o.e(75377),o.e(31020),o.e(2942),o.e(73682),o.e(58591),o.e(54803),o.e(1953),o.e(10216),o.e(58565),o.e(69197),o.e(42055),o.e(38739),o.e(44751),o.e(81567),o.e(63257),o.e(34291),o.e(1913),o.e(56054),o.e(95076),o.e(92341),o.e(82658),o.e(4163),o.e(69583),o.e(22759),o.e(20343),o.e(21820),o.e(46945),o.e(10553),o.e(67019),o.e(27039),o.e(25265),o.e(14581),o.e(38632),o.e(61651),o.e(88702),o.e(54307),o.e(43184),o.e(87647),o.e(75861),o.e(46257),o.e(15819),o.e(45376),o.e(74943),o.e(23721),o.e(58461),o.e(72329),o.e(19592),o.e(3331),o.e(98672),o.e(52658),o.e(44642),o.e(78),o.e(58586)]).then(o.bind(o,253032)),Promise.all([o.e(62743),o.e(52774),o.e(44832),o.e(39938),o.e(90698),o.e(84885),o.e(37358),o.e(5242),o.e(7312),o.e(90424),o.e(81580),o.e(84325),o.e(31189),o.e(69343),o.e(46293),o.e(94556),o.e(78701),o.e(38804),o.e(17100),o.e(11846),o.e(70355),o.e(2971),o.e(80741),o.e(72586),o.e(53335),o.e(71896),o.e(46616),o.e(54940),o.e(49396),o.e(98721),o.e(98032),o.e(57229),o.e(63707),o.e(86609),o.e(91253),o.e(4642),o.e(5006),o.e(6612),o.e(61171),o.e(23179),o.e(75377),o.e(31020),o.e(2942),o.e(73682),o.e(58591),o.e(54803),o.e(1953),o.e(10216),o.e(58565),o.e(69197),o.e(42055),o.e(38739),o.e(44751),o.e(81567),o.e(63257),o.e(34291),o.e(1913),o.e(56054),o.e(95076),o.e(92341),o.e(82658),o.e(4163),o.e(69583),o.e(22759),o.e(20343),o.e(21820),o.e(46945),o.e(10553),o.e(67019),o.e(27039),o.e(25265),o.e(14581),o.e(38632),o.e(61651),o.e(88702),o.e(54307),o.e(43184),o.e(87647),o.e(75861),o.e(46257),o.e(15819),o.e(45376),o.e(74943),o.e(23721),o.e(58461),o.e(72329),o.e(19592),o.e(3331),o.e(98672),o.e(52658),o.e(44642),o.e(78),o.e(58586)]).then(o.bind(o,910002)),Promise.all([o.e(62743),o.e(52774),o.e(44832),o.e(39938),o.e(90698),o.e(84885),o.e(37358),o.e(5242),o.e(7312),o.e(90424),o.e(81580),o.e(84325),o.e(31189),o.e(69343),o.e(46293),o.e(94556),o.e(78701),o.e(38804),o.e(17100),o.e(11846),o.e(70355),o.e(2971),o.e(80741),o.e(72586),o.e(53335),o.e(71896),o.e(46616),o.e(54940),o.e(49396),o.e(98721),o.e(98032),o.e(57229),o.e(63707),o.e(86609),o.e(91253),o.e(4642),o.e(5006),o.e(6612),o.e(61171),o.e(23179),o.e(75377),o.e(31020),o.e(2942),o.e(73682),o.e(58591),o.e(54803),o.e(1953),o.e(10216),o.e(58565),o.e(69197),o.e(42055),o.e(38739),o.e(44751),o.e(81567),o.e(63257),o.e(34291),o.e(1913),o.e(56054),o.e(95076),o.e(92341),o.e(82658),o.e(4163),o.e(69583),o.e(22759),o.e(20343),o.e(21820),o.e(46945),o.e(10553),o.e(67019),o.e(27039),o.e(25265),o.e(14581),o.e(38632),o.e(61651),o.e(88702),o.e(54307),o.e(43184),o.e(87647),o.e(75861),o.e(46257),o.e(15819),o.e(45376),o.e(74943),o.e(23721),o.e(58461),o.e(72329),o.e(19592),o.e(3331),o.e(98672),o.e(52658),o.e(44642),o.e(78),o.e(58586)]).then(o.bind(o,270615)),Promise.all([o.e(62743),o.e(52774),o.e(44832),o.e(39938),o.e(90698),o.e(84885),o.e(37358),o.e(5242),o.e(7312),o.e(90424),o.e(81580),o.e(84325),o.e(31189),o.e(69343),o.e(46293),o.e(94556),o.e(78701),o.e(38804),o.e(17100),o.e(11846),o.e(70355),o.e(2971),o.e(80741),o.e(72586),o.e(53335),o.e(71896),o.e(46616),o.e(54940),o.e(49396),o.e(98721),o.e(98032),o.e(57229),o.e(63707),o.e(86609),o.e(91253),o.e(4642),o.e(5006),o.e(6612),o.e(61171),o.e(23179),o.e(75377),o.e(31020),o.e(2942),o.e(73682),o.e(58591),o.e(54803),o.e(1953),o.e(10216),o.e(58565),o.e(69197),o.e(42055),o.e(38739),o.e(44751),o.e(81567),o.e(63257),o.e(34291),o.e(1913),o.e(56054),o.e(95076),o.e(92341),o.e(82658),o.e(4163),o.e(69583),o.e(22759),o.e(20343),o.e(21820),o.e(46945),o.e(10553),o.e(67019),o.e(27039),o.e(25265),o.e(14581),o.e(38632),o.e(61651),o.e(88702),o.e(54307),o.e(43184),o.e(87647),o.e(75861),o.e(46257),o.e(15819),o.e(45376),o.e(74943),o.e(23721),o.e(58461),o.e(72329),o.e(19592),o.e(3331),o.e(98672),o.e(52658),o.e(44642),o.e(78),o.e(58586)]).then(o.bind(o,914038)),Promise.all([o.e(62743),o.e(52774),o.e(44832),o.e(39938),o.e(90698),o.e(84885),o.e(37358),o.e(5242),o.e(7312),o.e(90424),o.e(81580),o.e(84325),o.e(31189),o.e(69343),o.e(46293),o.e(94556),o.e(78701),o.e(38804),o.e(17100),o.e(11846),o.e(70355),o.e(2971),o.e(80741),o.e(72586),o.e(53335),o.e(71896),o.e(46616),o.e(54940),o.e(49396),o.e(98721),o.e(98032),o.e(57229),o.e(63707),o.e(86609),o.e(91253),o.e(4642),o.e(5006),o.e(6612),o.e(61171),o.e(23179),o.e(75377),o.e(31020),o.e(2942),o.e(73682),o.e(58591),o.e(54803),o.e(1953),o.e(10216),o.e(58565),o.e(69197),o.e(42055),o.e(38739),o.e(44751),o.e(81567),o.e(63257),o.e(34291),o.e(1913),o.e(56054),o.e(95076),o.e(92341),o.e(82658),o.e(4163),o.e(69583),o.e(22759),o.e(20343),o.e(21820),o.e(46945),o.e(10553),o.e(67019),o.e(27039),o.e(25265),o.e(14581),o.e(38632),o.e(61651),o.e(88702),o.e(54307),o.e(43184),o.e(87647),o.e(75861),o.e(46257),o.e(15819),o.e(45376),o.e(74943),o.e(23721),o.e(58461),o.e(72329),o.e(19592),o.e(3331),o.e(98672),o.e(52658),o.e(44642),o.e(78),o.e(58586)]).then(o.bind(o,969016))]);return{CustomizePageMenuRenderer:e,TopbarPageAnalyticsOptOutMenu:t,ImportModal:n,ExportModal:i,PageTemplateModal:a,GoogleAuthPromptModal:r,StudentNotEligibleModal:l,CookieModal:s,ForkPagePopup:c,DatePropertyMenu:u,ReportPageModal:d,SidebarCreateTeamModal:m,SidebarTeamModal:p,CreateTeamFromPageConfirmModal:g,CollectionTypedDatabaseMigrationModal:h,OpenInDesktopAppPopup:y,BlockMenu:f,ImportIntoNewPageModal:v}})),a=(0,n().kF)(i,(e=>e.CustomizePageMenuRenderer)),r=(0,n().kF)(i,(e=>e.TopbarPageAnalyticsOptOutMenu)),l=(0,n().kF)(i,(e=>e.PageTemplateModal)),s=(0,n().kF)(i,(e=>e.ImportModal)),c=(0,n().kF)(i,(e=>e.ExportModal)),u=(0,n().kF)(i,(e=>e.ReportPageModal)),d=(0,n().kF)(i,(e=>e.GoogleAuthPromptModal)),p=(0,n().kF)(i,(e=>e.StudentNotEligibleModal)),m=(0,n().kF)(i,(e=>e.CookieModal)),g=(0,n().kF)(i,(e=>e.BlockMenu)),h=(0,n().kF)(i,(e=>e.ForkPagePopup)),y=(0,n().kF)(i,(e=>e.CollectionTypedDatabaseMigrationModal)),f=(0,n().kF)(i,(e=>e.SidebarCreateTeamModal)),v=(0,n().kF)(i,(e=>e.SidebarTeamModal)),x=(0,n().kF)(i,(e=>e.CreateTeamFromPageConfirmModal)),S=(0,n().kF)(i,(e=>e.OpenInDesktopAppPopup)),b=(0,n().kF)(i,(e=>e.ImportIntoNewPageModal))},412511:(e,t,o)=>{o.d(t,{$G:()=>l,AN:()=>c,Xq:()=>d,du:()=>r});o(670560),o(267602),o(916054),o(653476),o(470928);var n=()=>o(730120),i=()=>o(803021),a=()=>o(526243);function r(e){const t=n().ou.fromMillis(e.startUnixTimestampMS),o=e.endUnixTimestampMS?n().ou.fromMillis(e.endUnixTimestampMS):void 0,i=n().ou.fromMillis(e.startOfWeekUnixTimestampMS),a=n().ou.fromMillis(e.endOfWeekUnixTimestampMS),r=t.startOf("day"),l=n().ou.max(i,r),s=Math.ceil(l.diff(i,"days").get("days"));let c=1;if(o){const e=o.endOf("day"),t=n().ou.min(a,e);c=Math.ceil(t.diff(l,"days").get("days"))}return{start:t,end:o,startOfWeek:i,endOfWeek:a,startColumn:s,columnCount:c}}function l(e){const t=(e.attendees||[]).filter((e=>!e.self&&!e.resource));return e.hasParticipants&&t.length>0&&t.every((e=>"declined"===e.responseStatus))}const s={upcomingMinsThreshold:10,startingMinsThreshold:5,startedMinsThreshold:15};function c(e){const t=e.filter((e=>{var t;if(!e.conferencing)return!1;return!function(e){if("declined"===e)return!0;return!1}((null===(t=e.attendees)||void 0===t?void 0:t.find((e=>e.self)))?e.responseStatus??"accepted":"accepted")&&!e.isAllDay}));if(0===t.length)return;const{upcomingMinsThreshold:o,startingMinsThreshold:i,startedMinsThreshold:a}=s,r=[],l=[],c=[],d=[],p=[];for(const s of t){if(s.isAllDay)continue;const e=u(s),t=n().ou.now(),m=e.start.diff(t,"minutes").minutes;m>=0&&m<=o?r.push(s):-m>=i?c.push(s):-m>=a?d.push(s):e.contains(t)?l.push(s):p.push(s)}return[...r,...c,...d,...l,...p][0]}function u(e){const t=n().ou.fromISO(e.start.dateTime,{zone:e.start.timeZone}),o=n().ou.fromISO(e.end.dateTime,{zone:e.end.timeZone});return n().Xp.fromDateTimes(t,o)}function d(e){let{newCalendarStart:t,newCalendarEnd:o,collectionViewId:n,currentUserId:r="0"}=e;(0,i().nQ)(t,o,Date.now())?a().ZP.clearLocalDateRangeStart({collectionViewId:n,currentUserId:r}):a().ZP.setLocalDateRangeStart({collectionViewId:n,currentUserId:r,dateRangeStart:t})}},397079:(e,t,o)=>{o.d(t,{V:()=>i});var n=o(667294);function i(){const e=(0,n.useRef)(null),[t,o]=(0,n.useState)(!1),[i,a]=(0,n.useState)(!1),r=(0,n.useCallback)((()=>{const t=e.current;t&&a(t.matches(":active"))}),[]),l=(0,n.useCallback)((t=>{e.current=t,r(),o(!0)}),[r]);return(0,n.useEffect)((()=>{const o=e.current;if(o&&t)return o.addEventListener("mousedown",r),o.addEventListener("mouseup",r),()=>{o.removeEventListener("mousedown",r),o.removeEventListener("mouseup",r)}}),[r,t]),[l,i,e]}},112213:(e,t,o)=>{o.d(t,{o:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("addPage",{viewBox:"0 0 14 14",svg:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 0c3.861 0 7 3.139 7 7s-3.139 7-7 7-7-3.139-7-7 3.139-7 7-7zM3.561 5.295a1.027 1.027 0 1 0 2.054 0 1.027 1.027 0 0 0-2.054 0zm5.557 1.027a1.027 1.027 0 1 1 0-2.054 1.027 1.027 0 0 1 0 2.054zm1.211 2.816a.77.77 0 0 0-.124-1.087.786.786 0 0 0-1.098.107c-.273.407-1.16.958-2.254.958-1.093 0-1.981-.55-2.244-.945a.788.788 0 0 0-1.107-.135.786.786 0 0 0-.126 1.101c.55.734 1.81 1.542 3.477 1.542 1.668 0 2.848-.755 3.476-1.541z"})})},267842:(e,t,o)=>{o.d(t,{a:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("addPerson",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M9.48242 7.91211C10.8076 7.91211 11.8352 6.77783 11.8352 5.35718C11.8352 4.00391 10.7908 2.84717 9.48242 2.84717C8.17407 2.84717 7.12964 4.00952 7.13525 5.36279C7.14087 6.77783 8.16284 7.91211 9.48242 7.91211ZM9.48242 8.87231C8.7356 8.87231 8.04492 8.99585 7.44409 9.22046C8.23022 9.95044 8.72437 10.9836 8.72437 12.1235C8.72437 12.511 8.66821 12.8872 8.55591 13.2466H12.8684C13.969 13.2466 14.3171 12.8479 14.3171 12.2302C14.3171 10.804 12.3967 8.87231 9.48242 8.87231ZM4.74316 15.1895C6.42212 15.1895 7.80347 13.7969 7.80347 12.1235C7.80347 10.4558 6.42212 9.06885 4.74316 9.06885C3.06982 9.06885 1.68286 10.4558 1.68286 12.1235C1.68286 13.7969 3.06982 15.1895 4.74316 15.1895ZM4.74316 14.1675C4.41187 14.1675 4.18726 13.9429 4.18726 13.6172V12.6907H3.27197C2.94629 12.6907 2.72168 12.4661 2.71606 12.1292C2.71045 11.7979 2.93506 11.5732 3.27197 11.5732H4.18726V10.6636C4.18726 10.3379 4.41187 10.1133 4.74316 10.1077C5.08008 10.1021 5.30469 10.3267 5.30469 10.6636V11.5732H6.22559C6.55127 11.5732 6.77588 11.7979 6.77588 12.1292C6.77588 12.4661 6.55127 12.6907 6.22559 12.6907H5.30469V13.6172C5.30469 13.9429 5.08008 14.1675 4.74316 14.1675Z"})})},253608:(e,t,o)=>{o.d(t,{s:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("arrowTurnDownRight",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M2.34326 2.5415C2.56201 2.5415 2.73975 2.60986 2.87646 2.74658C3.01318 2.8833 3.08154 3.06104 3.08154 3.27979C3.08154 3.41195 3.07699 3.54867 3.06787 3.68994C3.06331 3.83122 3.06104 3.99756 3.06104 4.18896C3.06104 4.95003 3.15902 5.56755 3.35498 6.0415C3.55094 6.51546 3.87223 6.86182 4.31885 7.08057C4.77002 7.29932 5.37614 7.40869 6.13721 7.40869H10.5669L12.2007 7.51123L10.1636 5.65869L8.646 4.11377C8.57764 4.04997 8.52295 3.97249 8.48193 3.88135C8.44548 3.7902 8.42725 3.69222 8.42725 3.5874C8.42725 3.38232 8.49561 3.21143 8.63232 3.07471C8.7736 2.93799 8.95133 2.86963 9.16553 2.86963C9.36149 2.86963 9.53923 2.94482 9.69873 3.09521L14.2104 7.6001C14.3745 7.75505 14.4565 7.94189 14.4565 8.16064C14.4565 8.37484 14.3745 8.56396 14.2104 8.72803L9.7124 13.2124C9.54378 13.3765 9.36149 13.4585 9.16553 13.4585C8.95133 13.4585 8.7736 13.3901 8.63232 13.2534C8.49561 13.1167 8.42725 12.9458 8.42725 12.7407C8.42725 12.6359 8.44548 12.5379 8.48193 12.4468C8.52295 12.3556 8.57764 12.2759 8.646 12.2075L10.1636 10.6626L12.2007 8.82373L10.5669 8.9126H6.0415C4.46012 8.9126 3.31396 8.53662 2.60303 7.78467C1.89665 7.02816 1.54346 5.84554 1.54346 4.23682C1.54346 4.0363 1.54801 3.84945 1.55713 3.67627C1.56624 3.50309 1.58447 3.34814 1.61182 3.21143C1.63005 3.10205 1.6665 2.99495 1.72119 2.89014C1.78044 2.78532 1.86019 2.70101 1.96045 2.63721C2.06071 2.5734 2.18831 2.5415 2.34326 2.5415Z"})})},679620:(e,t,o)=>{o.d(t,{M:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("arrowTurnUpRightIcon",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M2.34326 13.4585C2.18831 13.4585 2.06071 13.4243 1.96045 13.356C1.86019 13.2922 1.78044 13.2078 1.72119 13.103C1.6665 13.0028 1.63005 12.8957 1.61182 12.7817C1.58447 12.645 1.56624 12.4924 1.55713 12.3237C1.54801 12.1506 1.54346 11.9637 1.54346 11.7632C1.54346 10.1545 1.89665 8.97184 2.60303 8.21533C3.31396 7.45882 4.46012 7.08057 6.0415 7.08057H10.5669L12.2007 7.17627L10.1636 5.33057L8.646 3.78564C8.57764 3.71729 8.52295 3.63981 8.48193 3.55322C8.44548 3.46208 8.42725 3.36182 8.42725 3.25244C8.42725 3.04736 8.49561 2.87874 8.63232 2.74658C8.7736 2.60986 8.95133 2.5415 9.16553 2.5415C9.36149 2.5415 9.54378 2.62126 9.7124 2.78076L14.2104 7.27197C14.3745 7.42692 14.4565 7.61377 14.4565 7.83252C14.4565 8.04671 14.3745 8.23584 14.2104 8.3999L9.69873 12.8979C9.53923 13.0529 9.36149 13.1304 9.16553 13.1304C8.95133 13.1304 8.7736 13.062 8.63232 12.9253C8.49561 12.7886 8.42725 12.6177 8.42725 12.4126C8.42725 12.3078 8.44548 12.2098 8.48193 12.1187C8.52295 12.0229 8.57764 11.9409 8.646 11.8726L10.1636 10.3345L12.2007 8.48877L10.5669 8.58447H6.13721C5.37614 8.58447 4.77002 8.69385 4.31885 8.9126C3.87223 9.13135 3.55094 9.4777 3.35498 9.95166C3.15902 10.4256 3.06104 11.0454 3.06104 11.811C3.06104 11.9979 3.06331 12.1642 3.06787 12.3101C3.07699 12.4513 3.08154 12.5858 3.08154 12.7134C3.08154 12.9321 3.01318 13.1099 2.87646 13.2466C2.73975 13.3879 2.56201 13.4585 2.34326 13.4585Z"})})},756459:(e,t,o)=>{o.d(t,{U:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("arrowUpLine",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M13.2944 7.53857C13.2944 7.74821 13.2261 7.92139 13.0894 8.05811C12.9526 8.19482 12.7817 8.26318 12.5767 8.26318C12.4718 8.26318 12.3739 8.24495 12.2827 8.2085C12.1916 8.16748 12.1118 8.11279 12.0435 8.04443L10.4917 6.51318L8.21533 3.97705L8.6665 3.75146L8.74854 5.97998V14.4702C8.74854 14.6935 8.6779 14.8758 8.53662 15.0171C8.3999 15.1584 8.22217 15.229 8.00342 15.229C7.78011 15.229 7.59782 15.1584 7.45654 15.0171C7.31982 14.8758 7.25146 14.6935 7.25146 14.4702V5.97998L7.3335 3.75146L7.7915 3.97705L5.5083 6.51318L3.95654 8.04443C3.88818 8.11279 3.80843 8.16748 3.71729 8.2085C3.62614 8.24495 3.52816 8.26318 3.42334 8.26318C3.21826 8.26318 3.04736 8.19482 2.91064 8.05811C2.77393 7.92139 2.70557 7.74821 2.70557 7.53857C2.70557 7.33805 2.78304 7.15804 2.93799 6.99854L7.44287 2.48682C7.52035 2.40479 7.60693 2.34554 7.70264 2.30908C7.79834 2.26807 7.8986 2.24756 8.00342 2.24756C8.10368 2.24756 8.20166 2.26807 8.29736 2.30908C8.39762 2.34554 8.48421 2.40479 8.55713 2.48682L13.062 6.99854C13.217 7.15804 13.2944 7.33805 13.2944 7.53857ZM13.2944 1.50928C13.2944 1.71891 13.2261 1.89437 13.0894 2.03564C12.9526 2.17692 12.7817 2.24756 12.5767 2.24756H3.43701C3.22282 2.24756 3.04736 2.17692 2.91064 2.03564C2.77393 1.89437 2.70557 1.71891 2.70557 1.50928C2.70557 1.29964 2.77393 1.12419 2.91064 0.98291C3.04736 0.841634 3.22282 0.770996 3.43701 0.770996H12.5767C12.7817 0.770996 12.9526 0.841634 13.0894 0.98291C13.2261 1.12419 13.2944 1.29964 13.2944 1.50928Z"})})},787356:(e,t,o)=>{o.d(t,{t:()=>n().t});var n=()=>o(394480)},850790:(e,t,o)=>{o.d(t,{K:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("boltFilled",{svg:(0,n.jsx)("path",{d:"M0 12.117c0 .38.293.664.703.664h5.518l-2.91 7.91c-.381 1.006.664 1.543 1.318.723l8.877-11.094c.166-.205.254-.4.254-.625 0-.371-.293-.664-.703-.664H7.539l2.91-7.91C10.83.115 9.785-.422 9.131.408L.254 11.492c-.166.215-.254.41-.254.625z"}),viewBox:"0 0 14 22"})},684793:(e,t,o)=>{o.d(t,{F:()=>n().F});var n=()=>o(25702)},817771:(e,t,o)=>{o.d(t,{A:()=>n().A});var n=()=>o(242550)},756085:(e,t,o)=>{o.d(t,{f:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("chevronLeft",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M3.61816 8.06445C3.61816 8.29688 3.70703 8.49512 3.8916 8.67285L9.22363 13.8887C9.36719 14.0391 9.55859 14.1143 9.77734 14.1143C10.2217 14.1143 10.5703 13.7725 10.5703 13.3213C10.5703 13.1025 10.4814 12.9043 10.3311 12.7539L5.52539 8.06445L10.3311 3.375C10.4814 3.21777 10.5703 3.01953 10.5703 2.80078C10.5703 2.35645 10.2217 2.01465 9.77734 2.01465C9.55859 2.01465 9.36719 2.08984 9.22363 2.24023L3.8916 7.45605C3.70703 7.63379 3.625 7.83203 3.61816 8.06445Z"})})},404437:(e,t,o)=>{o.d(t,{y:()=>n().y});var n=()=>o(742922)},52446:(e,t,o)=>{o.d(t,{D:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("doubleChevronLeft",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M7.07031 13.8887C7.2207 14.0391 7.40527 14.1211 7.62402 14.1211C8.06836 14.1211 8.41699 13.7725 8.41699 13.3281C8.41699 13.1094 8.32812 12.9043 8.17773 12.7539L3.37207 8.05762L8.17773 3.375C8.32812 3.21777 8.41699 3.0127 8.41699 2.80078C8.41699 2.35645 8.06836 2.00781 7.62402 2.00781C7.40527 2.00781 7.2207 2.08984 7.07031 2.24023L1.73828 7.44922C1.56055 7.62012 1.46484 7.8252 1.46484 8.06445C1.46484 8.29688 1.55371 8.49512 1.73828 8.67969L7.07031 13.8887ZM13.1748 13.8887C13.3252 14.0391 13.5098 14.1211 13.7354 14.1211C14.1797 14.1211 14.5283 13.7725 14.5283 13.3281C14.5283 13.1094 14.4395 12.9043 14.2891 12.7539L9.4834 8.05762L14.2891 3.375C14.4395 3.21777 14.5283 3.0127 14.5283 2.80078C14.5283 2.35645 14.1797 2.00781 13.7354 2.00781C13.5098 2.00781 13.3252 2.08984 13.1748 2.24023L7.84961 7.44922C7.66504 7.62012 7.57617 7.8252 7.56934 8.06445C7.56934 8.29688 7.66504 8.49512 7.84961 8.67969L13.1748 13.8887Z"})})},68744:(e,t,o)=>{o.d(t,{t:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("doubleChevronRight",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M2.25781 14.1211C2.47656 14.1211 2.66797 14.0391 2.81836 13.8887L8.14355 8.67969C8.32812 8.49512 8.41699 8.29688 8.41699 8.06445C8.41699 7.8252 8.32812 7.62012 8.14355 7.44922L2.81836 2.24023C2.66797 2.08984 2.4834 2.00781 2.25781 2.00781C1.81348 2.00781 1.46484 2.35645 1.46484 2.80078C1.46484 3.0127 1.55371 3.21777 1.7041 3.375L6.50977 8.05762L1.7041 12.7539C1.55371 12.9043 1.46484 13.1094 1.46484 13.3281C1.46484 13.7725 1.81348 14.1211 2.25781 14.1211ZM8.36914 14.1211C8.58789 14.1211 8.77246 14.0391 8.92285 13.8887L14.2549 8.67969C14.4395 8.49512 14.5283 8.29688 14.5283 8.06445C14.5283 7.8252 14.4326 7.62012 14.2549 7.44922L8.92285 2.24023C8.77246 2.08984 8.58789 2.00781 8.36914 2.00781C7.9248 2.00781 7.56934 2.35645 7.56934 2.80078C7.56934 3.0127 7.66504 3.21777 7.81543 3.375L12.6211 8.05762L7.81543 12.7539C7.66504 12.9043 7.56934 13.1094 7.56934 13.3281C7.56934 13.7725 7.9248 14.1211 8.36914 14.1211Z"})})},388957:(e,t,o)=>{o.d(t,{K:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("externalLink",{viewBox:"0 0 17 16",svg:(0,n.jsx)("path",{d:"M4.94922 13.498C4.31641 13.498 3.83789 13.3359 3.51367 13.0117C3.18945 12.6914 3.02734 12.2188 3.02734 11.5938V4.46289C3.02734 3.83398 3.18945 3.35938 3.51367 3.03906C3.83789 2.71875 4.31641 2.55859 4.94922 2.55859H12.0449C12.6777 2.55859 13.1562 2.71875 13.4805 3.03906C13.8047 3.35938 13.9668 3.83398 13.9668 4.46289V11.5938C13.9668 12.2188 13.8047 12.6914 13.4805 13.0117C13.1562 13.3359 12.6777 13.498 12.0449 13.498H4.94922ZM5.01953 12.3438H11.9746C12.2441 12.3438 12.4512 12.2734 12.5957 12.1328C12.7402 11.9922 12.8125 11.7793 12.8125 11.4941V4.55664C12.8125 4.27539 12.7402 4.06445 12.5957 3.92383C12.4512 3.7832 12.2441 3.71289 11.9746 3.71289H5.01953C4.74609 3.71289 4.53711 3.7832 4.39258 3.92383C4.25195 4.06445 4.18164 4.27539 4.18164 4.55664V11.4941C4.18164 11.7793 4.25195 11.9922 4.39258 12.1328C4.53711 12.2734 4.74609 12.3438 5.01953 12.3438ZM10.334 9.54297C10.1855 9.54297 10.0664 9.49609 9.97656 9.40234C9.89062 9.30859 9.84766 9.17969 9.84766 9.01562V8.08398L9.93555 7.24609L9.15039 8.10156L7.09961 10.1465C6.99023 10.2559 6.85742 10.3105 6.70117 10.3105C6.55273 10.3105 6.42969 10.2637 6.33203 10.1699C6.23828 10.0762 6.19141 9.95117 6.19141 9.79492C6.19141 9.6582 6.24609 9.53516 6.35547 9.42578L8.41211 7.36914L9.2793 6.57227L8.47656 6.66602H7.48633C7.32617 6.66602 7.19727 6.62305 7.09961 6.53711C7.00586 6.45117 6.95898 6.33203 6.95898 6.17969C6.95898 6.03516 7.00586 5.91992 7.09961 5.83398C7.19727 5.74414 7.32422 5.69922 7.48047 5.69922H10.2227C10.4062 5.69922 10.5508 5.74609 10.6562 5.83984C10.7617 5.93359 10.8145 6.08398 10.8145 6.29102V9.00977C10.8145 9.16602 10.7695 9.29492 10.6797 9.39648C10.5938 9.49414 10.4785 9.54297 10.334 9.54297Z"})})},109806:(e,t,o)=>{o.d(t,{c:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("eye",{viewBox:"0 0 32 32",svg:(0,n.jsx)("path",{d:"M16.006 25.812c8.863 0 14.994-7.17 14.994-9.406C31 14.16 24.858 7 16.006 7 7.252 7 1 14.16 1 16.406c0 2.236 6.252 9.406 15.006 9.406zm0-3.242a6.194 6.194 0 01-6.197-6.164c-.012-3.452 2.744-6.164 6.197-6.164 3.419 0 6.185 2.711 6.185 6.164 0 3.364-2.766 6.164-6.185 6.164zm0-3.94c1.228 0 2.246-1.007 2.246-2.224 0-1.228-1.018-2.235-2.246-2.235-1.24 0-2.258 1.007-2.258 2.235 0 1.217 1.018 2.224 2.258 2.224z"})})},85876:(e,t,o)=>{o.d(t,{N:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("eyePadded",{viewBox:"0 0 24 24",svg:(0,n.jsx)("path",{d:"M12 17.9912C17.6055 17.9912 21.3857 13.4727 21.3857 12.0713C21.3857 10.6699 17.5986 6.1582 12 6.1582C6.47656 6.1582 2.60742 10.6699 2.60742 12.0713C2.60742 13.4727 6.46973 17.9912 12 17.9912ZM12 16.6787C7.63184 16.6787 4.15918 13.0283 4.15918 12.0713C4.15918 11.2715 7.63184 7.4707 12 7.4707C16.3613 7.4707 19.8408 11.2715 19.8408 12.0713C19.8408 13.0283 16.3613 16.6787 12 16.6787ZM12 15.7559C14.0508 15.7559 15.6914 14.0811 15.6914 12.0713C15.6914 10.0137 14.0508 8.39355 12 8.39355C9.94238 8.39355 8.29492 10.0137 8.30176 12.0713C8.31543 14.0811 9.94238 15.7559 12 15.7559ZM12 13.2607C11.3369 13.2607 10.7969 12.7275 10.7969 12.0713C10.7969 11.415 11.3369 10.8818 12 10.8818C12.6631 10.8818 13.1963 11.415 13.1963 12.0713C13.1963 12.7275 12.6631 13.2607 12 13.2607Z"})})},471654:(e,t,o)=>{o.d(t,{z:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("flag",{viewBox:"0 0 13 14",svg:(0,n.jsx)("path",{d:"M0.825195 13.8457C1.16699 13.8457 1.4541 13.5654 1.4541 13.2168V9.47754C1.63867 9.40918 2.21973 9.19727 3.10156 9.19727C5.59668 9.19727 7.25781 10.4414 9.66406 10.4414C10.7168 10.4414 11.1885 10.3115 11.7217 10.0654C12.207 9.84668 12.4941 9.4502 12.4941 8.82129V1.99219C12.4941 1.55469 12.1523 1.27441 11.6943 1.27441C11.3047 1.27441 10.6895 1.54102 9.58887 1.54102C7.20996 1.54102 5.52148 0.296875 3.0332 0.296875C1.99414 0.296875 1.5293 0.419922 0.975586 0.672852C0.49707 0.891602 0.196289 1.24707 0.196289 1.86914V13.2168C0.196289 13.5586 0.483398 13.8457 0.825195 13.8457ZM9.63672 9.16309C7.41504 9.16309 5.71289 7.92578 3.12207 7.92578C2.45215 7.92578 1.84375 8.00098 1.48145 8.14453V2.0332C1.59766 1.83496 2.11035 1.56836 3.05371 1.56836C5.38477 1.56836 7.09375 2.80566 9.56836 2.80566C10.2383 2.80566 10.792 2.73047 11.2158 2.61426V8.69824C11.0996 8.89648 10.5801 9.16309 9.63672 9.16309Z"})})},710125:(e,t,o)=>{o.d(t,{l:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("import",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M13.291 14.5723C13.291 14.1484 12.9902 13.834 12.5732 13.834H8.06836C8.24609 13.8203 8.42383 13.7314 8.56055 13.5947L13.0586 9.08301C13.2158 8.91895 13.291 8.74121 13.291 8.54297C13.291 8.12598 12.9902 7.81836 12.5801 7.81836C12.3682 7.81836 12.1836 7.90039 12.0469 8.03711L10.4951 9.56836L8.69043 11.585L8.75195 10.1084V1.61133C8.75195 1.16016 8.44434 0.852539 8 0.852539C7.5625 0.852539 7.25488 1.16016 7.25488 1.61133V10.1084L7.30957 11.5781L5.50488 9.56836L3.95312 8.03711C3.82324 7.90039 3.63184 7.81836 3.42676 7.81836C3.0166 7.81836 2.70898 8.12598 2.70898 8.54297C2.70898 8.74121 2.78418 8.91895 2.94141 9.08301L7.44629 13.5947C7.58301 13.7314 7.75391 13.8203 7.93848 13.834H3.44043C3.0166 13.834 2.70898 14.1484 2.70898 14.5723C2.70898 14.9893 3.0166 15.3037 3.44043 15.3037H12.5732C12.9902 15.3037 13.291 14.9893 13.291 14.5723Z"})})},257185:(e,t,o)=>{o.d(t,{y:()=>n().y});var n=()=>o(949489)},953293:(e,t,o)=>{o.d(t,{R:()=>n().R});var n=()=>o(519454)},960852:(e,t,o)=>{o.d(t,{N:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("repeat",{viewBox:"0 0 16 14",svg:(0,n.jsx)("path",{d:"M1.185 7.317a.689.689 0 00.697-.704v-.601c0-1.19.806-1.942 2.064-1.942H9.23v1.573c0 .328.199.52.527.52a.66.66 0 00.403-.144l2.68-2.236c.253-.212.26-.547 0-.765L10.16.782A.62.62 0 009.757.64c-.328 0-.527.184-.527.52v1.53H4.05C1.875 2.69.48 3.9.48 5.875v.738c0 .397.308.704.705.704zm13.624-.649a.689.689 0 00-.698.704v.608c0 1.19-.806 1.942-2.064 1.942H6.763V8.35c0-.329-.199-.52-.527-.52a.66.66 0 00-.403.144l-2.68 2.242c-.26.212-.26.547 0 .759l2.68 2.242a.66.66 0 00.403.143c.328 0 .527-.191.527-.52v-1.544h5.181c2.174 0 3.569-1.21 3.569-3.179v-.745a.695.695 0 00-.704-.704z"})})},850505:(e,t,o)=>{o.d(t,{r:()=>n().r});var n=()=>o(544672)},866456:(e,t,o)=>{o.d(t,{V:()=>n().V});var n=()=>o(587080)},519710:(e,t,o)=>{o.d(t,{n:()=>n().n});var n=()=>o(759366)},118006:(e,t,o)=>{o.d(t,{u:()=>n().u});var n=()=>o(984709)},848854:(e,t,o)=>{o.d(t,{v:()=>n().v});var n=()=>o(545914)},586365:(e,t,o)=>{o.d(t,{c:()=>n().c});var n=()=>o(562027)},161149:(e,t,o)=>{o.d(t,{O:()=>n().O});var n=()=>o(454069)},110372:(e,t,o)=>{o.d(t,{YF:()=>c,bl:()=>s,gF:()=>r,i6:()=>u,lZ:()=>l});var n=()=>o(954949),i=()=>o(594546),a=()=>o(749826);function r(e,t){const o=(0,n().Si)(t.callout_key);o&&(t.placement_key=(0,n().pU)(o)),(0,i().j)({environment:e,event:{eventName:"callout_show",eventProperties:t}}),a().default.logEvent("callout_show",t.callout_key)}function l(e,t){const o=(0,n().Si)(t.callout_key);o&&(t.placement_key=(0,n().pU)(o)),(0,i().j)({environment:e,event:{eventName:"callout_click",eventProperties:t}}),a().default.logEvent("callout_click",t.callout_key)}function s(e,t){const o=(0,n().Si)(t.callout_key);o&&(t.placement_key=(0,n().pU)(o)),(0,i().j)({environment:e,event:{eventName:"callout_dismiss",eventProperties:t}}),a().default.logEvent("callout_dismiss",t.callout_key)}function c(e,t){const{eligible_callouts:o,required_arg_timeout:n,required_args_run_duration:a,eligibility_timeouts:r,blocklist:l}=t;(0,i().j)({environment:e,event:{eventName:"callout_coordinator_resolved",eventProperties:{eligible_callouts:o,required_arg_timeout:n,required_args_run_duration:a,eligibility_timeouts:r,blocklist:l}}})}function u(e,t){(0,i().j)({environment:e,event:{eventName:"callout_feature_interaction",eventProperties:t}})}},356140:(e,t,o)=>{o.d(t,{W:()=>a});var n=()=>o(142735),i=()=>o(876822);function a(){const{currentSpaceStore:e}=(0,n().VK)((()=>i().default.state),[]);return null==e?void 0:e.id}},857719:(e,t,o)=>{o.d(t,{J7:()=>M,Nx:()=>S,Pb:()=>x,Vc:()=>p,Vw:()=>C,Xg:()=>d,a3:()=>T,bj:()=>b,uI:()=>w,us:()=>f,w3:()=>m});o(241792);var n=o.n(o(294184)),i=o(667294),a=()=>o(846550),r=()=>o(696459),l=()=>o(802911),s=()=>o(78078),c=()=>o(521635),u=o(785893);const d=i.forwardRef((function(e,t){const{children:i,type:a,gap:r,withBottomPadding:l,style:s,onMouseDown:d,onClick:p,onDoubleClick:m,onContextMenu:g}=e,h=(0,o(309797).n1)(a),y=(0,o(142735).VK)((()=>c().Z.getPanelState("peek").isOpen&&"static_sidebar"===c().Z.getPanelState("peek").displayStyle),[]);return(0,u.jsx)("div",{className:n()("layout",{"layout-wide":"wide"===a,"layout-wide-right-margin-expanded":"wide-right-margin-expanded"===a,"layout-side-peek":"side-peek"===a,"layout-center-peek":"center-peek"===a&&!y,"layout-center-peek-with-layout-panel":"center-peek"===a&&y,"layout-home":"home"===a,"layout-home-phone":"home-phone"===a,"layout-home-redesign-desktop":"home-redesign-desktop"===a,"layout-form":"form"===a,"layout-form-viewer":"form-viewer"===a,"layout-form-viewer-embed":"form-viewer-embed"===a,"layout-phone":"phone"===a,"layout-tablet":"tablet"===a,"layout-template-preview":"template-preview"===a,"layout-chat":"chat"===a,"layout-layout-editor":"layout-editor"===a,"layout-layout-editor-wide":"layout-editor-wide"===a,"layout-layout-editor-narrow":"layout-editor-narrow"===a,"layout-marketplace":"marketplace"===a,"layout-marketplace-mobile":"marketplace-mobile"===a,"layout-team-home":"team-home"===a,"layout-team-home-mobile":"team-home-mobile"===a,"layout-create-post":"create-post"===a}),style:{paddingBottom:l?h:void 0,gap:r,...s},ref:t,onMouseDown:d,onClick:p,onDoubleClick:m,onContextMenu:g,children:i})})),p="layout-content",m="layout-full",g="layout-margin-left",h="layout-margin-right",y="layout-nested-grid",f="hide-scrollbar",v="layout-column",x=i.forwardRef((function(e,t){return(0,u.jsx)("div",{className:n()(p,e.className),style:e.style,ref:t,children:e.children})}));function S(e){return(0,u.jsx)("div",{className:m,style:e.style,children:e.children})}function b(e){return(0,u.jsx)("div",{className:g,style:{...e.style,pointerEvents:"none"},children:e.children})}function C(e){return(0,u.jsx)("div",{className:h,style:{...e.style,pointerEvents:"none"},children:e.children})}const k=(0,i.forwardRef)((function(e,t){return(0,u.jsx)("div",{className:n()(y,e.className),onClick:e.onClick,style:e.style,role:e.role,id:e.id,"aria-labelledby":e["aria-labelledby"],ref:t,children:e.children})}));function j(e){return"left-aligned"===e?"flex-start":"centered"===e?"center":"right-tabs"===e?"flex-end":void(0,r().t1)(e)}function M(e){const{items:t,style:o,index:n,setIndex:r,title:c}=e,d=(0,i.useRef)([]),p="centered"===o||"right-tabs"===o,m=(0,a().yK)((e=>({icon:{width:16,height:16,fill:"currentColor"},label:{fontSize:14,fontWeight:600},header:"right-tabs"===o?{display:"flex",justifyContent:"space-between",alignItems:"baseline"}:{},tablist:"right-tabs"===o?{display:"flex"}:{},tab:p?{cursor:"pointer",border:"none",padding:"6px 12px",borderRadius:20,color:e.text.secondary,background:"none"}:{cursor:"pointer",border:"none",borderBottom:"2px solid",borderColor:"transparent",padding:"6px 8px 12px",color:e.text.secondary,background:"none"},tabSelected:p?{color:e.text.primary,background:e.tint.regular}:{color:e.text.primary,borderColor:e.regularTextColor}})),[p,o]),g=(0,i.useId)(),h=(0,i.useCallback)((e=>`${g}-tab-${e}`),[g]),y=(0,i.useCallback)((e=>`${g}-tabpanel-${e}`),[g]),f=(0,i.useCallback)((e=>{let o;var i;("ArrowLeft"===e.key?(e.preventDefault(),o=(n+t.length-1)%t.length):"ArrowRight"===e.key&&(e.preventDefault(),o=(n+1)%t.length),void 0!==o)&&(r(o),null===(i=d.current[o])||void 0===i||i.focus())}),[n,r,t.length]);return(0,u.jsx)(l().Z,{name:"PageLayoutTabs",children:(0,u.jsxs)(k,{children:[(0,u.jsx)(x,{children:(0,u.jsxs)("div",{style:m.header,children:["right-tabs"===o&&c,(0,u.jsx)("div",{role:"tablist",style:m.tablist,children:(0,u.jsx)(s().X2,{justifyContent:j(o),children:t.map(((e,t)=>{var o;return(0,u.jsx)("button",{ref:e=>{e&&(d.current[t]=e)},id:h(t),role:"tab","aria-controls":y(t),"aria-selected":t===n,tabIndex:t===n?void 0:-1,onKeyDown:f,style:{...m.tab,...t===n&&m.tabSelected},onClick:e=>{e.stopPropagation(),r(t)},children:(0,u.jsxs)(s().X2,{gap:4,alignItems:"center",children:[null===(o=e.icon)||void 0===o?void 0:o.call(e,m.icon),e.label&&(0,u.jsx)("div",{style:m.label,children:e.label})]})},e.key)}))})})]})}),(0,u.jsx)(k,{id:y(n),role:"tabpanel","aria-labelledby":h(n),children:t[n]?t[n].children:null})]})})}function T(e){return(0,u.jsx)("div",{className:n()(v,e.className),style:{"--min-column-width":e.minWidth?`${e.minWidth}px`:"100%",...e.style},children:e.children})}function w(e){return(0,u.jsxs)(T,{minWidth:e.minWidth,className:e.className,style:e.style,children:[e.left,e.right]})}},452220:(e,t,o)=>{o.d(t,{$:()=>l});o(667294);var n=()=>o(142735),i=()=>o(846550),a=()=>o(707513),r=o(785893);function l(e){const{children:t,style:o}=e,{store:l}=e.icon?e:{},s=(0,n().VK)((()=>{var e;return"hide"!==(null==l||null===(e=l.getAssociatedCollectionStore())||void 0===e||null===(e=e.getLayoutStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.property_icons_visibility)}),[l]),c=(0,i().yK)((e=>({title:{padding:"3px 0",fontSize:13,lineHeight:"18px",color:e.text.secondary,display:"flex",flexDirection:"row",alignItems:"center",fontWeight:a().Ue.medium,gap:2,...o},icon:{width:18,height:24,fill:e.icon.secondary}})),[o]);return(0,r.jsxs)("div",{style:c.title,children:[e.icon&&s&&e.icon(c.icon),(0,r.jsx)("div",{children:t})]})}},133049:(e,t,o)=>{o.d(t,{V:()=>ae});var n=o(667294),i=()=>o(142735),a=()=>o(788860),r=()=>o(58836),l=()=>o(251932),s=(o(122556),o(582845),o(250570),o(533019),o(721473),o(788208),o(22624),o(267602),o(653476),o(241792),()=>o(219727)),c=()=>o(846550),u=()=>o(839212),d=()=>o(293836),p=()=>o(722917),m=()=>o(513670),g=()=>o(696459),h=()=>o(326966),y=()=>o(342792),f=()=>o(959137),v=()=>o(661297),x=()=>o(205228),S=()=>o(710125),b=()=>o(599631),C=()=>o(749826),k=()=>o(629513),j=()=>o(507335),M=o(785893);const T=(0,a().vU)({linkCopied:{defaultMessage:"Link copied. Share it with others who may find this useful.",id:"ai.gtmFavoriteActions.linkCopied"},share:{defaultMessage:"Share as AI favorite",id:"ai.gtmFavoriteActions.share"},add:{defaultMessage:"Add to AI favorites",id:"ai.gtmFavoriteActions.add"}});function w(e){const{blockId:t}=e,o=(0,s().O7)(),i=(0,a().YB)(),r=(0,n.useCallback)((()=>{(0,k().importGtmFavorite)({environment:o,importArgs:{name:"aiGtmFavoriteImport",blockId:t}})}),[t,o]),l=(0,n.useCallback)((async()=>{const e=`${x().default.domainBaseUrl}/ai-gtm/${(0,y().cj)(t)}`;(await f().F.clipboardActions.load()).copyString({environment:o,stringValue:e,copiedMessage:T.linkCopied})}),[t,o]);return(0,M.jsxs)("div",{style:{marginTop:12,marginBottom:12},children:[(0,M.jsx)(v().Z,{onClick:l,icon:b().N,children:i.formatMessage(T.share)}),o.currentUser.isLoggedIn()&&(0,M.jsx)(v().Z,{onClick:r,style:{marginLeft:12},icon:S().l,children:i.formatMessage(T.add)})]})}var A=()=>o(233417),I=()=>o(407544),_=()=>o(311562),P=()=>o(864266),V=()=>o(177610),B=()=>o(796386),R=()=>o(794424),K=()=>o(60613),F=()=>o(686929);const Z=5;function L(e){const{collectionStore:t,schema:o,store:a,format:r,propertyIds:l,propertyGroupId:y,variant:f,customization:v,pagePropertiesStore:x,pageViewBlockContext:S}=e,[b,k]=(0,I().e)(),T=(0,i().qz)(void 0,A().Z),L=(0,s().Fy)(),E=(0,c().yK)((e=>({pageProperties:{width:"100%",fontSize:14},dragHandle:{marginLeft:-(P().C+10),marginRight:6},hidePropertiesButton:{margin:"0 0 10px"},showMoreButton:{margin:0},addPropertyButton:{margin:"4px 0 0"},moreProperties:{border:`1px solid ${"dark"===e.mode?e.accentColors.gray[300]:e.accentColors.gray[75]}`,borderRadius:4,padding:"8px 6px"},actionButtonsWithTopMargin:{marginTop:8}})),[]),H=(0,i().VK)((()=>"pinned"===f||Boolean(a.isAssociatedCollectionAPageTree())),[a,f]),D=(0,i().VK)((()=>{var e;return null===(e=t.getLayoutStore())||void 0===e?void 0:e.getModules()}),[t]);let O=(0,V().nd)({store:a,format:r,schema:o,collectionStore:t,propertyIds:l,propertyGroupId:y});const N=(0,n.useMemo)((()=>{const e={};for(const t of O)e[t.property]=t;return e}),[O]);v&&(O=function(e,t,o,n,i){const{hideEmptyProperties:a,neverShowEmptyPropertiesIfMoreThanNProperties:r,neverShowNotionSystemProperties:l,sortNonEmptyPropertiesFirst:s,neverShowPropertiesElsewhereInLayout:c}=t;a&&(e=e.map((e=>({...e,visibility:e.hasValue?e.visibility:"hide"}))));if(c&&o){const t=(0,d().m)({modulesByArea:o,collectionSchema:n,collectionFormat:i}),a=new Set(t);e=e.filter((e=>!a.has(e.property)))}l&&(e=e.filter((e=>!((0,p().S4)(e.property)||"show"!==e.visibility&&e.property.startsWith("notion://")))));void 0!==r&&e.length>r&&(e=e.filter((e=>e.hasValue)));s&&(e=m().MR(e,(e=>!e.hasValue)));return e}(O,v,D,o,r));const U=(0,i().VK)((()=>x.state.forceShowProperties),[x]),[W,z]=(0,n.useMemo)((()=>{if((0,h().z4)(f))return m().uK(O,(e=>{var t;return!!(null===(t=o[e.property])||void 0===t?void 0:t.type)&&function(e){if("section"===e.visibility)return!1;if("hide"===e.visibility)return!1;if("hide_if_empty"===e.visibility&&!e.hasValue)return!1;return!0}(e)}));if("pinned"===f){if(!l)return[[],[]];const e=l.map((e=>{var t;const n=o[e];if(n)return{property:e,visibility:"show",hasValue:(null===(t=N[e])||void 0===t?void 0:t.hasValue)??!1,name:n.name}})).filter(g().$K);return[e.slice(0,u().c),e.slice(u().c)]}(0,g().t1)(f)}),[O,N,l,o,f]),G=function(e){const t=(0,i().VK)((()=>{if(!C().default.checkGate({gateName:"ai_favorites"}))return!1;const t=(0,j().OF)();return!!t&&t.spaceId===e.getSpaceId()&&t.collectionId===e.id}),[e]);return t}(t),$=W.concat(z),{paddingLeft:Y,paddingRight:q,width:X}=e,J=Math.min(Z,W.length)*R().Uv,Q="pinned"===f?L.isMobile||k<K().h:k<J;let ee;if(null!=v&&v.dontRenderIfNoPropertiesDefaultShown&&0===W.length)return null;if(null!=v&&v.renderWhenCompletelyEmpty&&0===W.length&&0===z.length)return v.renderWhenCompletelyEmpty();if(H&&!Q)ee=(0,M.jsx)(R().ZP,{...e,rowLength:Z,compactProperties:W,hiddenProperties:z,variant:f,pageViewBlockContext:S});else{const t={stackPropertyLabelAndValue:null==v?void 0:v.stackPropertyLabelAndValue,heightVariant:null!=v&&v.stackPropertyLabelAndValue||H&&!Q?"small":"medium"},o=S===_().S.PeekView;ee=(0,M.jsxs)("div",{style:null!=v&&v.disableContainerPadding?{}:{paddingBottom:8},children:[(0,M.jsx)(B().Z,{...e,hideDragHandle:"pinned"===f,showHiddenProperties:U,mergedProperties:H?$:O,rowCustomization:t,disableLastRowBottomPadding:null==v?void 0:v.disableLastRowBottomPadding,isInPeekRenderer:o}),"pinned"===f?null:(0,M.jsx)(F().ZP,{...e,customization:t,isInPeekRenderer:o,mergedProperties:H?$:O,wrapperStyle:null!=v&&v.stackPropertyLabelAndValue?E.actionButtonsWithTopMargin:void 0})]})}return(0,M.jsx)("div",{style:E.pageProperties,onMouseEnter:()=>{T.setState({...T.state,mouseEntered:!0})},onMouseLeave:()=>{T.setState({...T.state,mouseEntered:!1})},ref:b,children:(0,M.jsxs)("div",{style:{width:X,maxWidth:"100%",padding:H||null!=v&&v.disableContainerPadding?void 0:"16px 0 8px 0",margin:"0 auto",...Y?{paddingLeft:Y}:{},...q?{paddingRight:q}:{}},children:[ee,G&&(0,M.jsx)(w,{blockId:a.id})]})})}var E=()=>o(191586),H=()=>o(480089),D=()=>o(876822),O=()=>o(279386),N=()=>o(121700),U=()=>o(763058),W=()=>o(27475),z=()=>o(482162),G=()=>o(896751),$=()=>o(452220),Y=()=>o(707513),q=()=>o(154186),X=()=>o(536691),J=()=>o(538230),Q=()=>o(857719);function ee(e){const{store:t,context:o,disabled:a,wrapper:l,forceGroupsOpenOrClosed:s,customization:u,moduleId:d}=e,p=(0,i().VK)((()=>t.getAssociatedCollectionStore()),[t]),m=(0,i().VK)((()=>(null==p?void 0:p.getNormalizedPropertyGroups({publicPageDataFallbackEnabled:!0}))||[]),[p]),g=(0,i().VK)((()=>{if(t.isCollectionViewPageWithContent())return{type:"hidden"};const e=t.getAssociatedCollectionStore();if(!e)return{type:"hidden"};const o=(0,E().y6)(t);return o?{type:"visible",store:t,format:o,collectionStore:e}:{type:"hidden"}}),[t]),h=(0,c().yK)((e=>({container:{cursor:"default"}})),[]);if("hidden"===g.type)return null;return(l||(e=>(0,M.jsx)(Q().Pb,{className:"layout-content",children:e})))((0,M.jsx)(Q().Pb,{children:(0,M.jsx)(r().p,{allowSelectionWithin:!0,children:(0,M.jsxs)("div",{style:h.container,children:[m.map(((e,t)=>(0,n.createElement)(te,{...g,key:e.id,context:o,disabled:a,propertyGroup:e,forceGroupOpenOrClosed:s,customization:u,isLast:t===m.length-1,moduleId:d}))),0===m.length&&(0,M.jsx)(te,{...g,context:o,disabled:a,propertyGroup:"virtualPropertiesGroup",forceGroupOpenOrClosed:s,customization:u,isLast:!0,moduleId:d})]})})}))}function te(e){const{store:t,context:o,disabled:r,propertyGroup:l,format:s,collectionStore:u,forceGroupOpenOrClosed:d,customization:p,isLast:m,moduleId:g}=e,h=(0,i().VK)((()=>"virtualPropertiesGroup"===l?{idForRememberingCollapsedState:`${g}_defaultGroup`,groupIdForSavingPropertyToGroup:void 0,title:(0,M.jsx)(a()._H,{id:"collapsiblePropertyGroups.defaultGroupTitle",defaultMessage:"Properties"})}:{idForRememberingCollapsedState:l.id,groupIdForSavingPropertyToGroup:l.id,title:l.title}),[g,l]),y=(0,i().VK)((()=>void 0!==d?"open"===d:J().Z.isPropertyGroupExpanded({groupId:h.idForRememberingCollapsedState})),[d,h.idForRememberingCollapsedState]),f=o===_().S.PeekView,v=(0,i().VK)((()=>t.isNonEditableState()),[t]),x=(0,i().VK)((()=>u.getSchema()),[u]),S=(0,i().VK)((()=>{var e,o;return t.id===(null===(e=D().default.state.mainEditorCurrentBlockStore)||void 0===e?void 0:e.id)?U().my.getNewEditorPagePropertiesStore(h.idForRememberingCollapsedState):t.id===(null===(o=z().default.peekTargetStore.state)||void 0===o?void 0:o.id)?U().UK.getNewEditorPagePropertiesStore(h.idForRememberingCollapsedState):new(U().pB)}),[h.idForRememberingCollapsedState,t.id]),b=(0,n.useCallback)((()=>{J().Z.togglePropertyGroupExpanded({groupId:h.idForRememberingCollapsedState})}),[h.idForRememberingCollapsedState]),C=(0,c().yK)((e=>({groupContent:{paddingLeft:0,paddingBottom:m?void 0:null!=p&&p.stackPropertyLabelAndValue?28:20},bottomButtonContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start"},propertyVisibilityButton:{borderRadius:4,height:34,paddingLeft:6,paddingRight:6,width:"auto",display:"flex",alignItems:"center",justifyContent:"center"},propertyVisibilityButtonMessage:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0,fontSize:"14px",color:e.lightTextColor}})),[null==p?void 0:p.stackPropertyLabelAndValue,m]);return(0,M.jsxs)("div",{children:[(0,M.jsx)(oe,{onClick:b,isExpanded:y,customization:p,children:h.title}),y&&(0,M.jsx)("div",{style:C.groupContent,children:(0,M.jsx)(L,{propertyGroupId:h.groupIdForSavingPropertyToGroup,pagePropertiesStore:S,schema:x,format:s,store:t,collectionStore:u,disabled:r,locked:v,blockPropertyValueOverlayStore:f?W().Z:N().Z,pageViewBlockContext:o,width:"100%",customization:{...p,neverShowPropertiesElsewhereInLayout:!0}})})]})}function oe(e){const{children:t,isExpanded:o,customization:n,onClick:i}=e,r=(0,a().YB)(),l=(0,s().Fy)(),u=Boolean(null==n?void 0:n.stackPropertyLabelAndValue);let d;d=o&&u?l.isTablet?0:l.isMobile?2:8:0;const p=(0,c().yK)((e=>({container:{height:34,display:"flex",alignItems:"center",justifyContent:"flex-start",paddingLeft:6,paddingRight:6,gap:6,marginBottom:d,borderRadius:6},label:{fontSize:13,color:e.text.secondary,fontWeight:Y().Ue.medium,...Y().Yu,height:20},button:{borderRadius:"100%"},icon:{transition:"transform .2s ease",width:12,height:12,transform:o?"rotate(0deg)":"rotate(-90deg)",fill:e.icon.tertiary},iconContainer:{display:"flex",alignItems:"center",justifyContent:"center"}})),[d,o]),m=(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("div",{style:p.label,children:t}),(0,M.jsx)("div",{style:p.iconContainer,children:(0,X().A)(p.icon)})]});return o?(0,M.jsx)(q().Z,{onClick:i,style:p.container,children:m}):(0,M.jsx)(q().Z,{style:p.container,onClick:i,ariaLabel:r.formatMessage(ne.showProperties),children:m})}const ne=(0,a().vU)({hideProperties:{id:"CollapsiblePropertyGroups.hideProperties",defaultMessage:"Hide properties in section"},showProperties:{id:"CollapsiblePropertyGroups.showProperties",defaultMessage:"Show properties in section"}});function ie(e){const{store:t,format:o,collectionStore:n,disabled:a,blockPropertyValueOverlayStore:r,variant:l,propertyIds:s,customization:c,pagePropertiesStore:u,pageViewBlockContext:d}=e,p=(0,i().VK)((()=>n.getSchema()),[n]),m=(0,i().VK)((()=>t.isNonEditableState()),[t]);return(0,M.jsx)(L,{store:t,collectionStore:n,schema:p,format:o,disabled:a,locked:m,width:"100%",blockPropertyValueOverlayStore:r,pageViewBlockContext:d,propertyIds:s,variant:l,customization:c,pagePropertiesStore:u,layoutModule:e.layoutModule})}function ae(e){const{store:t,context:o,disabled:n,variant:s,layoutModule:c,propertyIds:u,customization:d,wrapper:p,showDefaultTitle:m}=e,g=(0,H().PE)(t,n),h=(0,i().VK)((()=>O().MT.getMode(t)),[t]),{isMainEditor:y,isPeekEditor:f}=(0,i().VK)((()=>{var e,o;const n=Boolean(z().default.isSidePeekOpen()&&t.id===(null===(e=z().default.peekTargetStore.state)||void 0===e?void 0:e.id));return{isMainEditor:Boolean(!n&&t.id===(null===(o=D().default.state.mainEditorCurrentBlockStore)||void 0===o?void 0:o.id)),isPeekEditor:n}}),[t]),v=(0,i().VK)((()=>t.getAssociatedCollectionStore()),[t]),x=(0,i().VK)((()=>{if(t.isCollectionViewPageWithContent())return{type:"hidden"};if(!v)return{type:"hidden"};const e=(0,E().y6)(t);return e?{type:"visible",store:t,format:e,collectionStore:v}:{type:"hidden"}}),[v,t]),S=(0,G().K)({collectionStore:v,layoutModule:c}),b=(0,i().VK)((()=>S&&c&&!(null!=d&&d.doNotShowPropertyGroups)),[null==d?void 0:d.doNotShowPropertyGroups,S,c]),C=(0,i().VK)((()=>y?U().my.getNewEditorPagePropertiesStore():f?U().UK.getNewEditorPagePropertiesStore():new(U().pB)),[y,f]);if("hidden"===x.type)return null;const k=o===_().S.PeekView,j=b&&c?(0,M.jsx)(ee,{...e,wrapper:void 0,moduleId:c.id}):(0,M.jsxs)(l().Ht,{gap:8,children:[m&&(0,M.jsx)($().$,{style:{marginLeft:6},children:(0,M.jsx)(a()._H,{id:"pageLayout.propertiesModule.title",defaultMessage:"Properties"})}),(0,M.jsx)(r().p,{allowSelectionWithin:!0,children:(0,M.jsx)(ie,{...x,disabled:!g||"suggest"===h,pageViewBlockContext:o,blockPropertyValueOverlayStore:k?W().Z:N().Z,propertyIds:u,variant:s,layoutModule:c,customization:d,pagePropertiesStore:C})})]});return p((0,M.jsx)(M.Fragment,{children:j}))}},896751:(e,t,o)=>{o.d(t,{K:()=>a});var n=o(667294),i=()=>o(142735);function a(e){let{collectionStore:t,layoutModule:o}=e;const a=(0,i().VK)((()=>Boolean(null==t?void 0:t.getNormalizedPropertyGroups({publicPageDataFallbackEnabled:!0}))),[t]);return(0,n.useMemo)((()=>!(!o||!t)&&("properties"===o.type&&"pinned"!==o.variant&&a)),[t,a,o])}},492077:(e,t,o)=>{o.d(t,{C:()=>a});var n=o(667294),i=o(785893);const a=n.forwardRef(((e,t)=>{const n=(0,o(846550).yK)((t=>({buttonStyle:{paddingLeft:8,paddingRight:8,paddingTop:2,paddingBottom:2,width:"100%",marginLeft:0,background:"transparent"},menuItemStyle:{gap:6,background:"transparent"},innerContainer:{marginLeft:0,paddingLeft:0,minWidth:"auto",color:e.disabled?t.text.secondary:void 0,background:"transparent"},desktopIconStyle:{margin:0},rightStyle:{display:"flex",alignItems:"center",gap:6,color:t.text.secondary,margin:0,...e.rightStyle}})),[e.disabled,e.rightStyle]);return(0,i.jsx)(o(827973).Z,{role:"button",...e,ref:t,style:n.menuItemStyle,buttonStyle:n.buttonStyle,textWrapperStyle:n.innerContainer,desktopIconStyle:n.desktopIconStyle,rightStyle:n.rightStyle})}));a.displayName="SiteSettingButtonMenuItem"},594539:(e,t,o)=>{o.d(t,{Z:()=>P});o(670560),o(241792);var n=o(667294),i=()=>o(146947),a=()=>o(219727),r=()=>o(142735),l=()=>o(846550),s=()=>o(646574),c=()=>o(933868),u=()=>o(788860),d=()=>o(326966),p=()=>o(827973),m=()=>o(448419),g=()=>o(198829),h=()=>o(255577),y=()=>o(388284),f=()=>o(67961),v=()=>o(296034),x=()=>o(868744),S=()=>o(718959),b=()=>o(352230),C=()=>o(128119),k=()=>o(965014),j=()=>o(188296),M=()=>o(18281),T=o(785893);function w(e,t){const{permissionItem:n,hideIcon:i,onChange:r}=e,s=(0,a().Fy)(),c=(0,l().yK)((e=>({icon:{margin:0,height:16,width:16,fill:e.icon.secondary},chevronIcon:{height:12,width:12,fill:e.icon.tertiary,transform:"rotate(90deg)"}})),[]);return(0,T.jsx)(o(838003).Z,{...e,popupType:s.isMobile?m().Z4.SlideUp:m().Z4.Popup,renderOrigin:a=>(0,T.jsx)(o(492077).C,{...(0,o(164079).Z)(e,a),ref:t,title:(0,T.jsx)(u()._H,{defaultMessage:"Link expiration",id:"publishSiteSettings.linkExpiration.settingTitle"}),icon:!i&&(0,o(428275).r)(c.icon),right:(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(A,{permissionItem:n}),(0,o(696347).o)(c.chevronIcon)]})}),alignmentToOrigin:C().lU.End,placementToOrigin:C().Iw.Bottom,render:e=>(0,T.jsx)(I,{value:n.expiration_timestamp,onChange:r,onClose:()=>{e.close()}})})}function A(e){const{permissionItem:t}=e,o=(0,u().YB)(),n=(0,l().yK)((e=>({container:{color:e.text.secondary}})),[]);if(!t.expiration_timestamp||(0,c().o7)(t))return(0,T.jsx)(f().Z,{style:n.container,children:(0,T.jsx)(u()._H,{defaultMessage:"None",id:"publishSiteSettings.linkExpiration.never"})});const a=s().$b(t.expiration_timestamp,i().locale,o);return(0,T.jsx)(f().Z,{style:n.container,children:a})}function I(e){const{value:t,onChange:o,onClose:s}=e,c=(0,a().O7)(),m=c.device,f=(0,r().VK)((()=>!M().y$()),[]),v=(0,r().VK)((()=>M().M9(c)),[c]),x=(0,n.useCallback)((e=>{void 0!==e&&e<=(new Date).getTime()||(o(e),s())}),[o,s]),S=(0,l().yK)((e=>({disabledContainer:{display:"flex",gap:6},disabledText:{color:e.text.tertiary}})),[]),C=function(){const e=Date.now(),t=e+d().U6,o=e+d().A0,n=e+7*d().A0;return[{key:"none",time:void 0,title:(0,T.jsx)(u()._H,{defaultMessage:"None",id:"publishSiteSettings.linkExpiration.never"})},{key:"hour",time:t,title:(0,T.jsx)(u()._H,{defaultMessage:"In an hour",id:"publishSiteSettings.linkExpiration.oneHour"}),caption:new Intl.DateTimeFormat(i().locale,{hour:"numeric",minute:"numeric"}).format(t)},{key:"day",time:o,title:(0,T.jsx)(u()._H,{defaultMessage:"In a day",id:"publishSiteSettings.linkExpiration.oneDay"}),caption:new Intl.DateTimeFormat(i().locale,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(o)},{key:"week",time:n,title:(0,T.jsx)(u()._H,{defaultMessage:"In a week",id:"publishSiteSettings.linkExpiration.oneWeek"}),caption:new Intl.DateTimeFormat(i().locale,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(n)}]}().map((e=>({key:e.key,action:()=>{x(e.time)},render:t=>(0,T.jsx)(p().Z,{...t,title:e.title,titleStyle:f?S.disabledText:{},caption:e.caption,captionStyle:f?S.disabledText:{},disabled:f})}))),w=[{key:"predefined-expiration",render:e=>(0,T.jsx)(y().Z,{...e}),items:C},{key:"custom-expiration",render:e=>(0,T.jsx)(y().Z,{...e,topBorder:!0}),items:[_(x,t,f,S.disabledText)]}];return v&&f&&w.push({key:"upgrade-for-expiration",render:e=>(0,T.jsx)(y().Z,{...e,topBorder:!0}),items:[{key:"upsell",action:()=>{k().y(c,{from:"public_permission_item_expiration",upsell:{type:"product",product:v,limit:{type:"none"}}})},render:e=>(0,T.jsx)(p().Z,{...e,focused:e.focused,title:(0,T.jsxs)("div",{style:S.disabledContainer,children:[(0,T.jsx)(u()._H,{defaultMessage:"Unlock link expiration",id:"publishSiteSettings.linkExpiration.upgrade"}),(0,T.jsx)(j().Z,{subscriptionTier:v,analyticsName:"public_permission_item_expiration"})]})})}]}),(0,T.jsx)(g().Z,{menuType:m.isMobile?b().o.ActionSheet:b().o.Popup,width:240,children:(0,T.jsx)(h().Z,{type:h().i.Vertical,initialFocus:void 0,sections:w})})}function _(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return{key:"custom",action:()=>{window.parent.close()},render:(i,a)=>(0,T.jsx)(x().Z,{...i,renderOrigin:e=>(0,T.jsx)(p().Z,{...e,disabled:o,title:(0,T.jsx)(u()._H,{id:"publicPermissionItem.expiration.chooseDate",defaultMessage:"Choose date"}),titleStyle:o?n:{}}),onFocus:a.onFocus,disableDefaultClick:!0,renderExtension:(n,i)=>(0,T.jsx)("div",{style:{padding:"18px 14px 14px"},children:(0,T.jsx)(v().Z,{...n,firstDayOfWeek:S().AK.state,value:t||Date.now(),onChange:t=>{e(t),i.close()},disabledDays:o||{before:new Date}})})})}}const P=n.forwardRef(w)},583352:(e,t,o)=>{o.d(t,{Z:()=>a});var n=()=>o(632314);class i extends(()=>o(263184))().default{getInitialState(){return{automationActionStore:void 0,automationStore:void 0,contextType:void 0,typecheckResult:void 0}}blur(e){void 0!==this.state.automationStore&&(void 0===e||(0,n().Z)(this.state,e))&&this.setState({automationActionStore:void 0,automationStore:void 0,contextType:void 0,typecheckResult:void 0})}focus(e){(0,n().Z)(this.instanceState,e)||this.setState(e)}}const a=new i;(0,o(947115).exposeDebugValue)("AutomationFocusStore",i)},407121:(e,t,o)=>{o.d(t,{Z:()=>a});class n extends(()=>o(263184))().default{getInitialState(){return{open:!1}}}const i=new n;(0,o(947115).exposeDebugValue)("AutomationModalStore",i);const a=i},974442:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o(263184).default.createValue({open:!1},{name:"ConfirmOverwriteModalStore"})},779522:(e,t,o)=>{o.d(t,{Z:()=>i});const n=new(o(168469).q)((e=>{let{spaceId:t}=e;return t}),(async function(e,t){var n;let{spaceId:i}=t;const a=await Promise.resolve().then(o.bind(o,824462)),r=await a.callApi({eventName:"getInternalDomains",environment:e,data:{spaceId:i}});return"success"===r.type?null===(n=r.data)||void 0===n?void 0:n.internalDomainsWithInfo:void 0}));o(947115).exposeDebugValue("InternalDomainsStore",n);const i=n},385021:(e,t,o)=>{o.d(t,{Z:()=>i});class n extends(()=>o(263184))().default{getInitialState(){return{justUnlocked:!1}}}const i=n},994875:(e,t,o)=>{o.r(t),o.d(t,{default:()=>i});class n extends(()=>o(263184))().default{getInitialState(){return{discussionIdToExpansionStartPointMap:{}}}}const i=new n},815277:(e,t,o)=>{o.d(t,{CH:()=>m,DE:()=>s().DE,KQ:()=>s().KQ,Rv:()=>s().Rv,V5:()=>p().V5,VX:()=>g,eB:()=>s().eB,oo:()=>s().oo});var n=()=>o(255933),i=()=>o(779709),a=()=>o(205228),r=()=>o(845682),l=()=>o(30795),s=()=>o(546464),c=()=>o(404791),u=()=>o(897257),d=()=>o(18281),p=()=>o(259408);const m={guests:e=>{if(!u().subscriptionDataStoreInstance.state)return"loading";return{current:(0,d().s1)(e.environment,e.spaceId,u().subscriptionDataStoreInstance.state)}},team_self_promotion:e=>{},internal_guests:e=>{if(!u().subscriptionDataStoreInstance.state)return"loading";return{current:(0,d().s1)(e.environment,e.spaceId,u().subscriptionDataStoreInstance.state),hasLowGuestLimit:(0,o(548812).fc)()}},members:e=>{const t=u().subscriptionDataStoreInstance.state;return{current:t?(0,l().W)(e.environment,e.spaceId,t):0}},non_admin_members:e=>{},view_chart:e=>{},form_filesize:e=>{},form_customization:e=>{},premium_automations:e=>{},move_to:e=>{},claimable_spaces:e=>{},domain_settings:e=>{},managed_users:e=>{},invite_user_to_workspace_mentions:e=>{},saml:e=>{},scim:e=>{},export_members:e=>{},hipaa_compliance:e=>{},sites_multiple_public_domains:e=>{},custom_image_upload_favicon:e=>{},custom_public_sites_layout:e=>{},seo_title_and_description:e=>{},admin_transfer_private_content:e=>{},ai_slack_qna:e=>{},configurable_mention_invites:e=>{},configurable_retention:e=>{},unbranded_forms:e=>{},ai_google_drive_qna:e=>{},watermarkless_chart_export:e=>{},configurable_deletion_and_retention_settings:e=>{},sudo_mode:e=>{},ai_github_connector:e=>{},ai_jira_connector:e=>{},slack_imports_invite:e=>{},content_reprovisioning:e=>{},ai_space_usage:e=>{var t;let{environment:o,spaceId:s}=e;const d=new(r().H)(o,{table:n().bx,id:s}).getModel(),p=(0,i().oc)(a().default.promotions.ai,d),m=(null===(t=c().Z.state)||void 0===t?void 0:t.spaceUsage)??0,g=u().subscriptionDataStoreInstance.state;return{current:m,memberCount:g?(0,l().W)(o,s,g):0,aiPromotionConfig:p,space:d}},ai_user_usage:e=>{var t;let{environment:o,spaceId:s}=e;const d=new(r().H)(o,{table:n().bx,id:s}).getModel(),p=(0,i().oc)(a().default.promotions.ai,d),m=(null===(t=c().Z.state)||void 0===t?void 0:t.userUsage)??0,g=u().subscriptionDataStoreInstance.state;return{current:m,memberCount:g?(0,l().W)(o,s,g):0,aiPromotionConfig:p,space:d}},block_read_and_write_role:e=>{}};function g(e){return(0,s().Rv)(e)??!1}},877727:(e,t,o)=>{o.d(t,{C3:()=>l,D:()=>s,QZ:()=>r,fo:()=>a});var n=()=>o(146947),i=()=>o(749826);function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i().default.checkGate({gateName:"packaging_m2_additional_entrypoints"})&&r(e,t)}function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return!e.device.isPhone&&l(t)}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i().default.checkGate({gateName:"workflow_templates_prototype",...e})||"control"!==s(e)}function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n().locale.startsWith("en-")||i().default.checkGate({gateName:"packaging_m2_localize_templates"})?i().default.getEligibleGroup({experimentId:"packaging_m2_entry_point",defaultGroup:"control",...e}):"control"}},999582:(e,t,o)=>{o.d(t,{Z:()=>a});class n extends(()=>o(263184))().default{getInitialState(){return{}}}const i=new n;o(947115).exposeDebugValue("SpaceWorkflowTemplateInstanceMapStore",i);const a=i},184441:(e,t,o)=>{o.d(t,{default:()=>a});class n extends(()=>o(263184))().default{getInitialState(){return{open:!1,isShowingLoadingState:!1}}updateUserCustomizations(e,t){this.state.open&&this.state.collectionTemplate&&this.setState({...this.state,userCustomizations:{...this.state.userCustomizations,[e]:t}})}updateCollectionTemplate(e){this.state.open&&this.state.collectionTemplate&&this.setState({...this.state,collectionTemplate:e})}updatePreviewCollectionViewTemplateId(e){this.state.open&&this.state.collectionTemplate&&this.setState({...this.state,previewCollectionViewTemplateId:e})}getParentStore(){return this.state.open?this.state.parentStore:void 0}getShouldShowExpandedTemplateList(){return this.state.open&&this.state.shouldShowExpandedTemplateList}setShouldShowExpandedTemplateList(e){this.state.open&&this.setState({...this.state,shouldShowExpandedTemplateList:e})}close(e){var t,o;this.state.open&&(null===(t=(o=this.state).onClose)||void 0===t||t.call(o,e),this.setState({open:!1,isShowingLoadingState:!1}))}reset(){this.setState(this.getInitialState())}}const i=new n;(0,o(947115).exposeDebugValue)("InitializeWorkflowTemplateModalStore",i);const a=i},29488:(e,t,o)=>{function n(e){return`${e.table}:${e.id}`}o.d(t,{O:()=>n})},779247:(e,t,o)=>{o.d(t,{T:()=>n});const n=(0,o(827282).CZ)("arrowUpRight",{default:{loader:()=>o.e(60569).then(o.bind(o,960569))},small:{loader:()=>o.e(8130).then(o.bind(o,608130))},mini:{loader:()=>o.e(88672).then(o.bind(o,188672))},large:{loader:()=>o.e(85943).then(o.bind(o,485943))}})},242550:(e,t,o)=>{o.d(t,{A:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("checkMarkLine",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M6.79297 13.2871C6.48047 13.2871 6.21484 13.1523 5.99609 12.8828L2.96094 9.14453C2.875 9.04297 2.8125 8.94336 2.77344 8.8457C2.73828 8.74805 2.7207 8.64648 2.7207 8.54102C2.7207 8.30664 2.79883 8.11328 2.95508 7.96094C3.11133 7.80859 3.30859 7.73242 3.54688 7.73242C3.81641 7.73242 4.04297 7.84766 4.22656 8.07812L6.76953 11.3008L11.7324 3.4375C11.834 3.28125 11.9395 3.17188 12.0488 3.10938C12.1582 3.04297 12.2949 3.00977 12.459 3.00977C12.6973 3.00977 12.8926 3.08398 13.0449 3.23242C13.1973 3.38086 13.2734 3.57031 13.2734 3.80078C13.2734 3.89453 13.2578 3.98828 13.2266 4.08203C13.1953 4.17578 13.1465 4.27344 13.0801 4.375L7.5957 12.8594C7.4082 13.1445 7.14062 13.2871 6.79297 13.2871Z"})})},809461:(e,t,o)=>{o.d(t,{w:()=>a});o(667294);var n=o(785893);const i={viewBox:"0 0 20 20",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M10 7c-1.654 0-3 1.346-3 3s1.346 3 3 3 3-1.346 3-3-1.346-3-3-3m0 4.5c-.827 0-1.5-.673-1.5-1.5s.673-1.5 1.5-1.5 1.5.673 1.5 1.5-.673 1.5-1.5 1.5"}),(0,n.jsx)("path",{d:"M18.307 8.445a.7.7 0 0 0-.57-.56l-1.643-.283-.056-.138.973-1.378a.7.7 0 0 0 .008-.795 8.5 8.5 0 0 0-2.244-2.264.7.7 0 0 0-.8.006l-1.36.96-.138-.056-.289-1.661a.7.7 0 0 0-.554-.567 8.5 8.5 0 0 0-3.188-.015.7.7 0 0 0-.562.569l-.282 1.643-.139.056-1.377-.971a.7.7 0 0 0-.794-.01q-.68.457-1.284 1.06a8.5 8.5 0 0 0-.98 1.185.7.7 0 0 0 .005.799l.961 1.36q-.03.069-.057.139l-1.66.287a.7.7 0 0 0-.569.555 8.5 8.5 0 0 0-.015 3.188.7.7 0 0 0 .57.561l1.643.283.056.14-.971 1.375a.7.7 0 0 0-.01.793 8.6 8.6 0 0 0 2.244 2.267.7.7 0 0 0 .8-.006l1.36-.961.14.058.286 1.66a.7.7 0 0 0 .555.568 8.5 8.5 0 0 0 3.188.015.7.7 0 0 0 .561-.57l.283-1.643q.07-.027.138-.056l1.378.972a.7.7 0 0 0 .795.008 8.6 8.6 0 0 0 2.264-2.243.7.7 0 0 0-.006-.8l-.961-1.36.058-.138 1.66-.289a.7.7 0 0 0 .567-.554q.159-.806.16-1.656a8.5 8.5 0 0 0-.144-1.533m-1.314 2.45-1.567.271a.7.7 0 0 0-.545.47c-.09.27-.189.508-.303.726a.7.7 0 0 0 .05.728l.904 1.28a7 7 0 0 1-1.22 1.207l-1.297-.915a.7.7 0 0 0-.716-.055 5 5 0 0 1-.734.298.7.7 0 0 0-.476.548l-.267 1.549a7.2 7.2 0 0 1-1.717-.009l-.27-1.567a.7.7 0 0 0-.47-.545 5 5 0 0 1-.728-.303.69.69 0 0 0-.726.05l-1.281.904a7.2 7.2 0 0 1-1.208-1.22l.916-1.297a.7.7 0 0 0 .054-.717 5 5 0 0 1-.297-.732.7.7 0 0 0-.549-.477l-1.548-.267a7.2 7.2 0 0 1 .009-1.717l1.567-.27a.7.7 0 0 0 .545-.468c.09-.273.19-.512.303-.731a.7.7 0 0 0-.05-.726l-.904-1.28a7.2 7.2 0 0 1 1.22-1.208l1.298.916c.21.15.486.17.716.054a5 5 0 0 1 .732-.297.7.7 0 0 0 .478-.549l.266-1.548a7.3 7.3 0 0 1 1.717.008l.271 1.568a.7.7 0 0 0 .468.545c.271.09.51.19.73.303a.7.7 0 0 0 .725-.05l1.281-.904a7.2 7.2 0 0 1 1.208 1.22l-.916 1.298a.7.7 0 0 0-.054.716c.117.233.216.48.297.733.08.25.291.433.548.477l1.549.267a7 7 0 0 1-.009 1.716"})]})},a=(0,o(827282).IU)("gear",i)},519454:(e,t,o)=>{o.d(t,{R:()=>i});o(667294);var n=o(785893);const i=(0,o(827282).IU)("pencil",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M3.926 13.307H14.11c.183 0 .34-.066.472-.199a.644.644 0 00.198-.471.652.652 0 00-.198-.479.644.644 0 00-.472-.198H5.272l-1.346 1.347zm-.704-.636l7.683-7.684-1.312-1.319-7.69 7.684-.67 1.606c-.037.1-.017.191.06.273.083.082.174.105.274.069l1.655-.63zm8.34-8.326l.738-.732c.182-.187.278-.376.287-.567.009-.192-.068-.374-.232-.547l-.267-.267c-.169-.168-.351-.246-.547-.232-.196.014-.385.11-.567.287l-.739.732 1.327 1.326z"})})},839212:(e,t,o)=>{o.d(t,{c:()=>n});const n=4},259408:(e,t,o)=>{o.d(t,{$W:()=>p,KQ:()=>d,_e:()=>g,Ay:()=>f,fS:()=>u,t:()=>a(),V5:()=>h,Kz:()=>y});o(267602),o(653476);var n=()=>o(513670),i=()=>o(696459),a=()=>o(124199),r=()=>o(629719);const l=["student","personal","plus","business","enterprise"];function s(e){return(0,i().DE)(l,e)}var c=()=>o(122792);const u=["plus","business","enterprise","ai","sites_custom_hostnames"];function d(e,t,o,n){return g(p(e,t,o,n))}function p(e,t,o,n){const{name:a,scope:r,actor:l}=n,s={...n,billingData:r.billingData},c=r.premiumFeatureOverrides,u=a in c?function(e,t,o){const n={type:"contact_account_manager"},a=e[t.name].type;if("check"===a){const e={type:"none"};return!0===o?{type:"available",limit:e}:{type:"upsell",upsell:n,limit:e}}if("per_use"===a){const e=t.amount,i={type:"per_use",amount:o};return"unlimited"===o||o>e?{type:"available",limit:i}:{type:"upsell",upsell:n,limit:i}}if("cumulative"===a){const e=t.amount,i=t.data.current,a={type:"cumulative",current:i,total:o};return"unlimited"===o||o>=i+e?{type:"available",limit:a}:{type:"upsell",upsell:n,limit:a}}(0,i().t1)(a)}(t,n,c[a]):o[a](s);let d;if("available"===u.type){const e=u.upsell?m(r.billingData,u.upsell,n.supportedProducts):void 0;d={...u,upsell:e}}else if("blocked"===u.type){const e=m(r.billingData,u.upsell,n.supportedProducts);d={...u,upsell:e}}else{const e=m(r.billingData,u.upsell,n.supportedProducts),t=function(e){const{actor:t,supportedProducts:o,upsell:n}=e;if(!t.isSpaceAdmin)return"blocked";const a=n.type;switch(a){case"product":return o.includes(n.product)?"upsell":"blocked";case"contact_sales":case"contact_account_manager":return"upsell";default:(0,i().t1)(a)}}({actor:l,supportedProducts:n.supportedProducts,upsell:e});d={...u,type:t,upsell:e}}return Math.random()<.001&&e({level:"info",from:"premiumFeatureFramework",type:"getPremiumFeatureAvailability",data:{featureName:a,featureScope:r,featureActor:l,featureAvailability:u}}),d}function m(e,t,o){if((0,r().Rd)(e.subscription))return{type:"contact_account_manager"};if("product"!==(null==t?void 0:t.type)||o.includes(t.product)||!s(t.product))return t;const i=t.product,a=o.filter((e=>s(e))).filter((e=>"student"!==e)).filter((e=>c().rC[e]>=c().rC[i])),l=(0,n().F)(a,(e=>c().rC[e]));return l?{...t,product:l}:t}function g(e){return"available"===(null==e?void 0:e.type)}function h(e,t){const{available:o}=t;let n,a;return"unavailable"in t?(n=t.unavailable,a=t.unavailable):(n=t.blocked,a=t.upsell),"available"===e.type?o():"upsell"===e.type?a(e):"blocked"===e.type?n(e):(0,i().t1)(e)}function y(e,t){if(void 0!==e)return h(e,{available:()=>{},blocked:t,upsell:()=>{}})}function f(e){return a().object({required:e,optional:{}})}}}]);