"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[32324,95986,30795],{257185:(e,t,o)=>{o.d(t,{y:()=>r().y});var r=()=>o(949489)},953293:(e,t,o)=>{o.d(t,{R:()=>r().R});var r=()=>o(519454)},419273:(e,t,o)=>{o.d(t,{f:()=>n});o(667294);var r=o(785893);const n=(0,o(827282).IU)("plusThick",{viewBox:"0 0 14 14",svg:(0,r.jsx)("path",{d:"M2 7.16357C2 7.59692 2.36011 7.95093 2.78735 7.95093H6.37622V11.5398C6.37622 11.9731 6.73022 12.3271 7.16357 12.3271C7.59692 12.3271 7.95093 11.9731 7.95093 11.5398V7.95093H11.5398C11.9731 7.95093 12.3271 7.59692 12.3271 7.16357C12.3271 6.73022 11.9731 6.37622 11.5398 6.37622H7.95093V2.78735C7.95093 2.36011 7.59692 2 7.16357 2C6.73022 2 6.37622 2.36011 6.37622 2.78735V6.37622H2.78735C2.36011 6.37622 2 6.73022 2 7.16357Z"})})},913011:(e,t,o)=>{o.d(t,{H:()=>u});o(821057);var r=()=>o(792197),n=()=>o(308240),i=()=>o(215134),a=()=>o(6623),l=()=>o(639708),s=()=>o(269299),p=()=>o(590434),d=()=>o(655260),c=()=>o(772669);function u(e){let{environment:t,transaction:o,layoutStore:u,position:m,sessionId:y,beforePerformDeleteModule:_}=e;const f=u.getModules();if(!f)throw new Error("[deleteModuleAtPosition] modules by area not found for layout store");const h=(0,i().h7)(f,(e=>e.id===m.moduleId));if(!h)throw new Error("[deleteModuleAtPosition] module to delete not found");const{module:v,position:g}=h;if(!(0,a().Fo)(v))throw new Error("[deleteModuleAtPosition] module to delete is not removeable");var b;(s().createAndCommitOrAppend({environment:t,transaction:o,canUndo:!0,perform(e){!function(e){const{transaction:t,layoutStore:o,moduleLocation:i,moduleToDelete:a,beforePerformDeleteModule:d}=e;d&&d(t);if((0,l().Fc)(a)){const e=(0,p().m)(o,a);e&&(0,c().deleteViewsModuleDependencies)({layoutStore:o,module:e,transaction:t})}if("form_conditional_modules"===i.area){const e=r().CI.removeChildModule({pointer:o.pointer,modulesByArea:o.getModules(),module:a});for(const r of e)s().applyOperation({transaction:t,store:o,operation:r})}else{const e="views_main_tab_modules"===i.area?{area:i.area,viewId:i.viewId}:{area:n().mt[i.area]};s().applyOperation({transaction:t,store:o,operation:r().CI.deleteModuleInArea({...e,pointer:o.pointer,moduleId:a.id})})}}({environment:t,transaction:e,layoutStore:u,moduleLocation:g,moduleToDelete:v,beforePerformDeleteModule:_})},userAction:"pageLayout.deleteActions.deleteModuleAtPosition"}),y)&&d().DZ({environment:t,module:v,sessionId:y,collectionId:null===(b=u.getCollectionModel())||void 0===b?void 0:b.id,layoutId:u.id,context:(0,n().AR)(m.area),area:m.area})}},142730:(e,t,o)=>{o.d(t,{IR:()=>A,L0:()=>E,MF:()=>k,gm:()=>P,iQ:()=>R,m2:()=>C});o(821057),o(492176),o(7961),o(267602),o(653476);var r=()=>o(956057),n=()=>o(530980),i=()=>o(308240),a=()=>o(215134),l=()=>o(667932),s=()=>o(137785),p=()=>o(639708),d=()=>o(483791),c=()=>o(593515),u=()=>o(82937),m=()=>o(497065),y=()=>o(269299),_=()=>o(887430),f=()=>o(487270),h=()=>o(793935),v=()=>o(876822),g=()=>o(482162),b=()=>o(826955),S=()=>o(26796),w=()=>o(913011),I=()=>o(655260),M=()=>o(356117);function C(e){let{environment:t,transaction:o,collectionStore:r,userId:i,modules:a}=e;const s=(0,f().Ii)({environment:t,spaceId:r.getSpaceId(),table:d().Bh}),p=b().t1.createChildStore(r,s),{model:c,operations:[u]}=n().rp4.create({pointer:s,parent:r.pointer,createdByUserId:i,modules:a??(0,l()._P)()});y().applyOperation({transaction:o,store:p,operation:u});const m=n().kj1.setLayout(r.pointer,s);return y().applyOperation({transaction:o,store:r,operation:m}),{model:c,store:p}}function T(e){let t;return e?t=e:g().default.state.open&&g().default.state.targetStore?t=g().default.state.targetStore:v().default.state.mainEditorCurrentBlockStore&&(t=v().default.state.mainEditorCurrentBlockStore),t}function x(e){h().setUpdateExpand({environment:e,isExpanded:!1,from:"keyboard_default",saveDetailsSidebarPreference:!1}),u().xv({environment:e,from:"open_page_layout_editor",preventAnimation:!0})}function A(e){var t,o;let{environment:n,blockStore:i,collectionStore:a,collectionViewStore:l,from:s}=e;const p=function(e){var t;let o=T(e);if(null!==(t=o)&&void 0!==t&&t.isCollectionView()){const e=(0,_().fm)(o);o=e?e.resultsInViewOrder(1).at(0):void 0}return o}(i),d=window.location.href;x(n);const c=r().Il();S().Z.setState({isOpen:!0,mode:"layout-editor",collectionStore:a,pageStore:p,siteRootBlockStore:void 0,sessionId:c,initialSelectedModuleId:null==p||null===(t=p.getAssociatedCollectionStore())||void 0===t||null===(t=t.getLayoutStore())||void 0===t||null===(t=t.getModel())||void 0===t||null===(t=t.firstRawModuleOfType("titleWithIcon"))||void 0===t?void 0:t.id,urlOnOpen:d}),(0,I().Rt)({environment:n,from:s,context:"layout",sessionId:c,collectionId:null==a?void 0:a.id,existingLayoutId:null==a||null===(o=a.getLayoutStore())||void 0===o?void 0:o.id,collectionViewId:null==l?void 0:l.id})}function k(e){let{environment:t,store:o,siteRootBlockStore:n,from:i}=e;const a=T(o);x(t);const l=r().Il();S().Z.setState({isOpen:!0,mode:"site-settings-editor",collectionStore:void 0,pageStore:a,siteRootBlockStore:n,sessionId:l}),(0,I().Rt)({environment:t,context:"site",from:i,sessionId:l,collectionId:void 0,existingLayoutId:void 0})}function E(e){S().Z.getState().isOpen&&P(e)}function P(e){let{environment:t}=e;const o=S().Z.getState();if(!o.isOpen)throw new Error("Cannot close page layout editor. Page layout editor is not open.");"layout-editor"===o.mode&&o.urlOnOpen&&window.location.href!==o.urlOnOpen&&m().op(t),S().Z.setState({isOpen:!1})}function R(e){var t;let{environment:o,transaction:r,property:n,layoutStore:l}=e;const d=S().Z.getSessionId(),u=null===(t=l.getModel())||void 0===t?void 0:t.getRawModules(),m=l.getCollectionModel();if(!u||!m)return;const y=b().NW.createChildStore(l,m.pointer),_=(0,a()._i)(u,(e=>"titleWithIcon"===e.type));if(_&&(0,p().p9)(_.module)){var f;const{module:e,position:t}=_,a={...e,type:"titleWithIcon",propertyIds:null===(f=e.propertyIds)||void 0===f?void 0:f.filter((e=>e!==n))};(0,M().Uq)({environment:o,sessionId:d,transaction:r,layoutStore:l,position:{area:(0,i().Gc)(t.area),moduleId:e.id},updatedModule:(0,s().V)(a)})}const h=(0,a().MI)(u,(e=>"property"===e.type&&e.propertyId===n));for(const{module:a,position:s}of h){const e=a.id,t=(0,i().Gc)(s.area);(0,w().H)({environment:o,sessionId:d,transaction:r,layoutStore:l,position:{area:t,moduleId:e}})}const v=m.getFormat().collection_page_sections;if(v){const e=v.filter((e=>e.section!==n));c().Do({store:y,pageSectionFormats:e,transaction:r,environment:o})}}},356117:(e,t,o)=>{o.d(t,{Uq:()=>m,Wb:()=>_});o(821057),o(267602),o(470928),o(30005);var r=()=>o(109477),n=()=>o(530980),i=()=>o(308240),a=()=>o(712185),l=()=>o(215134),s=()=>o(667932),p=()=>o(639708),d=()=>o(827370),c=()=>o(421654),u=()=>o(269299);function m(e){let{environment:t,transaction:o,layoutStore:r,position:s,updatedModule:p,sessionId:d}=e;const c=i().mt[s.area],m=r.getRawModules();if("form_conditional_modules"===c){const e=null==m?void 0:m[c];if(!(null==e?void 0:e[s.moduleId]))throw new Error("Unable to find module being updated.");return void u().createAndCommitOrAppend({environment:t,transaction:o,canUndo:!0,perform(e){u().applyOperation({transaction:e,store:r,operation:n().CIp.updateNestedModule(r.pointer,c,(0,a().cm)(p))})},userAction:"BuilderLayoutModules.updateModule"})}if(!m)throw new Error("Unable to find modules");const y=(0,l().mT)(m,(e=>e.id===s.moduleId));if(!y||y.area!==c)throw new Error("Unable to find module being updated.");u().createAndCommitOrAppend({environment:t,transaction:o,canUndo:!0,perform(e){u().applyOperation({transaction:e,store:r,operation:n().CIp.updateModuleInArea({pointer:r.pointer,module:(0,a().cm)(p),..."views_main_tab_modules"===y.area?{area:y.area,viewId:y.viewId}:{area:y.area}})})},userAction:"BuilderLayoutModules.updateModule"})}function y(e){var t,o,r;let{collectionStore:n,layoutStore:i}=e;const a=new Map,l=n.getFormat(),s=[...null===(t=i.getModules())||void 0===t?void 0:t.page_main,...null===(o=i.getModules())||void 0===o?void 0:o.page_details],d=new Map;null===(r=l.property_visibility)||void 0===r||r.forEach((e=>{d.set(e.property,e)})),s.forEach((e=>{if(!(0,p().LP)(e))return(0,p().f)(e)?(a.set(e.propertyId,{property:e.propertyId}),void d.set(e.propertyId,{property:e.propertyId,visibility:"show"})):void 0;e.propertyIds.forEach((e=>{a.set(e,{property:e}),d.set(e,{property:e,visibility:"show"})}))}));const c=n.getNormalizedPropertyGroups();var u;c?c.forEach((e=>{var t;null===(t=e.propertyIds)||void 0===t||t.forEach((e=>{a.has(e)||a.set(e,{property:e})}))})):null===(u=l.collection_page_properties)||void 0===u||u.forEach((e=>{a.has(e.property)||a.set(e.property,e)}));return{propertiesFormat:Array.from(a.values()),propertyVisibility:Array.from(d.values())}}function _(e){let{environment:t,transaction:o,collectionStore:i,layoutStore:a}=e;const{propertiesFormat:l,propertyVisibility:m}=y({collectionStore:i,layoutStore:a});u().createAndCommitOrAppend({environment:t,transaction:o,canUndo:!0,perform(e){const t=a.getBlockChildrenPointers(),o=a.firstModuleOfType("viewsMain");o&&(0,p().aJ)(o)&&t.find((e=>d().dr.isEqual(e,o.collection_view_block_pointer)))&&u().applyOperation({transaction:e,store:a,operation:n().CIp.removeBlockChild(a.pointer,o.collection_view_block_pointer.id)}),u().applyOperation({transaction:e,store:a,operation:n().CIp.setModulesByAreas(a.pointer,(0,s()._P)())}),u().applyOperation({transaction:e,store:a,operation:n().CIp.deleteFormat(a.pointer)});const y=i.getFormat(),{page_section_visibility:_}=y;c().FH({stores:[i],update:{property_groups:void 0,collection_page_properties:l,property_visibility:m,..._?{page_section_visibility:r().dN}:void 0},transaction:e})},userAction:"BuilderLayoutModules.resetLayoutToDefault"})}},772669:(e,t,o)=>{o.r(t),o.d(t,{deleteViewsModuleDependencies:()=>i});var r=()=>o(349220),n=()=>o(332542);function i(e){const{layoutStore:t,module:o,transaction:i}=e,a=(0,r().TO)(o.getCollectionViewBlockStore());n().hr({childStore:a,parentStore:t,transaction:i})}},590434:(e,t,o)=>{o.d(t,{m:()=>i});var r=()=>o(826955);class n{constructor(e,t){this.parentStore=e,this.impl=t}getType(){return this.impl.type}getCollectionViewBlockStoreWithParent(e){return r().G.createChildStore(e,this.impl.collection_view_block_pointer)}getCollectionViewBlockStore(){return this.getCollectionViewBlockStoreWithParent(this.parentStore)}getInitialCollectionViewPointer(){const e=this.getCollectionViewBlockStoreWithParent(this.parentStore).getCollectionViewPointers();if(e.length>0)return e[0]}getId(){return this.impl.id}isUnlistedView(){return!1}createCollectionViewContext(){const e=this.getCollectionViewBlockStoreWithParent(this.parentStore),t=this.getInitialCollectionViewPointer();if(!t)return;const o=r().Xr.createChildStore(e,t);return{type:"collectionView",collectionViewBlockStore:e,collectionStore:o.getCollectionStore(),collectionViewStore:o,pageVisitSourceOverride:void 0}}}function i(e,t){if("views"===t.type||"viewsMain"===t.type)return new n(e,t)}},180546:(e,t,o)=>{o.r(t),o.d(t,{OutlinerToggleOpenSetupModalButton:()=>_});o(667294);var r=()=>o(219727),n=()=>o(142735),i=()=>o(846550),a=()=>o(306164),l=()=>o(788860),s=()=>o(696459),p=()=>o(154186),d=()=>o(654133),c=()=>o(419273),u=()=>o(998901),m=()=>o(833186),y=o(785893);function _(e){let{origin:t,parentStore:o,onClick:_}=e;const f=(0,r().Fy)(),h=(0,l().YB)(),v=(0,i().yK)((e=>{const t=f.isMobile?32:20;return{button:{height:t,width:t,border:"none",borderRadius:3,marginLeft:f.isMobile?0:4},plusIcon:{fill:f.isMobile?e.lightIconColor:e.mediumIconColor,...f.isMobile?{width:18,height:18}:{width:14,height:14}},plusIconContainer:{display:"flex",alignItems:"center",justifyContent:"center",color:e.legacyRedSelectColor,height:t,width:t}}}),[f.isMobile]),g=(0,n().VK)((()=>function(e){let{origin:t,parentStore:o,intl:r}=e;switch(t){case"team":{const e=o.table===a().e0?o.getName():void 0;return e?r.formatMessage({id:"outlinerToggleAddPageOrTemplateButton.team",defaultMessage:"Add to {teamName}"},{teamName:e}):r.formatMessage({id:"outlinerToggleAddPageOrTemplateButton.team.unknownTeamName",defaultMessage:"Add to teamspace pages"})}case"private":return r.formatMessage({id:"outlinerToggleAddPageOrTemplateButton.private",defaultMessage:"Add to private pages"});default:(0,s().t1)(t)}}({origin:t,parentStore:o,intl:h})),[t,o,h]);return(0,y.jsx)(d().Z,{textWrap:!1,renderTooltip:()=>g,placement:u().Placement.Top,render:e=>(0,y.jsx)(p().Z,{style:v.button,ariaLabel:g,onClick:()=>{null==_||_(),(0,m().openTemplateOnboardingModal)({parentStore:o,template:void 0,version:(0,m().getTemplateOnboardingVersion)({template:void 0}),origin:"team"===t?"sidebar_team_new_page":"sidebar_private_new_page"})},...e,children:(0,y.jsx)("div",{style:v.plusIconContainer,children:(0,c().f)(v.plusIcon)})})})}},877727:(e,t,o)=>{o.d(t,{C3:()=>l,D:()=>s,QZ:()=>a,fo:()=>i});var r=()=>o(146947),n=()=>o(749826);function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n().default.checkGate({gateName:"packaging_m2_additional_entrypoints"})&&a(e,t)}function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return!e.device.isPhone&&l(t)}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n().default.checkGate({gateName:"workflow_templates_prototype",...e})||"control"!==s(e)}function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r().locale.startsWith("en-")||n().default.checkGate({gateName:"packaging_m2_localize_templates"})?n().default.getEligibleGroup({experimentId:"packaging_m2_entry_point",defaultGroup:"control",...e}):"control"}},999582:(e,t,o)=>{o.d(t,{Z:()=>i});class r extends(()=>o(263184))().default{getInitialState(){return{}}}const n=new r;o(947115).exposeDebugValue("SpaceWorkflowTemplateInstanceMapStore",n);const i=n},184441:(e,t,o)=>{o.d(t,{default:()=>i});class r extends(()=>o(263184))().default{getInitialState(){return{open:!1,isShowingLoadingState:!1}}updateUserCustomizations(e,t){this.state.open&&this.state.collectionTemplate&&this.setState({...this.state,userCustomizations:{...this.state.userCustomizations,[e]:t}})}updateCollectionTemplate(e){this.state.open&&this.state.collectionTemplate&&this.setState({...this.state,collectionTemplate:e})}updatePreviewCollectionViewTemplateId(e){this.state.open&&this.state.collectionTemplate&&this.setState({...this.state,previewCollectionViewTemplateId:e})}getParentStore(){return this.state.open?this.state.parentStore:void 0}getShouldShowExpandedTemplateList(){return this.state.open&&this.state.shouldShowExpandedTemplateList}setShouldShowExpandedTemplateList(e){this.state.open&&this.setState({...this.state,shouldShowExpandedTemplateList:e})}close(e){var t,o;this.state.open&&(null===(t=(o=this.state).onClose)||void 0===t||t.call(o,e),this.setState({open:!1,isShowingLoadingState:!1}))}reset(){this.setState(this.getInitialState())}}const n=new r;(0,o(947115).exposeDebugValue)("InitializeWorkflowTemplateModalStore",n);const i=n},347628:(e,t,o)=>{o.d(t,{Ig:()=>a,Vr:()=>n,X$:()=>i,b:()=>r});const r="notion://projects_app",n="notion://wiki_app",i="notion://docs_app",a="notion://meetings_app"},29488:(e,t,o)=>{function r(e){return`${e.table}:${e.id}`}o.d(t,{O:()=>r})},912203:(e,t,o)=>{o.d(t,{$M:()=>f,GQ:()=>w,Jy:()=>C,LF:()=>M,NO:()=>m,Of:()=>T,SF:()=>c,TX:()=>S,XO:()=>h,Y_:()=>d,Ym:()=>_,bD:()=>g,cO:()=>u,fo:()=>I,rR:()=>y});o(267602),o(653476),o(228244);var r=()=>o(513670),n=()=>o(696459),i=()=>o(226413),a=()=>o(109477),l=()=>o(455222),s=()=>o(305580);(0,n().AO)((e=>(0,n().$K)(e)&&(0,n().$K)(e.target)&&(0,n().$K)(e.external_bot_id)?{true:{external_bot_id:e.external_bot_id,target:e.target}}:{false:e}));const p={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1},d={checkbox:[{type:"checkbox"}],date:[{type:"date"}],email:[{type:"text"}],multi_select:[{type:"text"},{of:{type:"text"},type:"array"}],number:[{type:"number"}],person:[{type:"person"},{of:{type:"person"},type:"array"}],phone_number:[{type:"text"}],relation:[{type:"block"},{of:{type:"block"},type:"array"}],select:[{type:"text"},{of:{type:"text"},type:"array"}],status:[{type:"text"},{of:{type:"text"},type:"array"}],text:void 0,title:void 0,url:[{type:"text"}]};function c(e){return Boolean(p[e.type]&&!(0,i().NK)(e)&&(!(0,i().qQ)(e)||void 0===(0,i().q3)(e)))}function u(e){const{collectionFormat:t,collectionSchema:o,filter:l,sort:p,sourcePropertyIds:d}=e,u=(d??(0,n().Yd)(o)).filter(((t,r,n)=>{const a=o[t];return!(!a||!c(a))&&(("relation"!==a.type||!e.restrictCrossSpace||!(0,i().Qh)(e.spaceId,a))&&(!l||l([t,a],r,o)))}));if(0===u.length)return[];if(!t||!1===p)return u;const m=(0,s().i)(t,o,void 0,a().j5.Page).collection_page_properties||[];return r().MR(u,(e=>m.findIndex((t=>t.property===e))))}function m(e){const{collectionFormat:t,collectionSchema:o,sort:l}=e,p=(0,n().Yd)(o).filter(((e,t,r)=>{const n=o[e];return!(!n||!(0,i().U8)(n))}));if(0===p.length)return[];if(!t||!1===l)return p;const d=(0,s().i)(t,o,void 0,a().j5.Page).collection_page_properties||[];return r().MR(p,(e=>d.findIndex((t=>t.property===e))))}function y(e){return e.type===l().$E.InvalidCharacter?{type:e.type,character:e.character}:e.type===l().$E.TokenExpected?{type:e.type,token:e.token}:e.type===l().FY.MissingSchemaPropertyOnThisRow||e.type===l().FY.MissingSchemaPropertyOnCollection?{type:e.type,collectionId:e.collectionId,property:e.property}:e.type===l().FY.ThisRowBlockPropertyMismatchCollection?{type:e.type,thisRowCollection:e.thisRowCollection}:e.type===l().FY.MissingContextVariable?{type:e.type,valueId:e.valueId}:e.type===l().FY.FunctionCallTooFewArguments?{type:e.type,numArguments:e.numArguments}:e.type===l().FY.FunctionCallUnexpectedArgument?{type:e.type,parameterIndex:e.parameterIndex}:e.type===l().FY.FunctionCallArgumentWrongType?{type:e.type,argumentType:e.argumentType,libraryFunctionName:e.libraryFunction.name,parameterIndex:e.parameterIndex}:e.type===l().FY.MissingDataDependencyBlock?{type:e.type,blockPointer:e.blockPointer}:e.type===l().FY.MissingDataDependencyPerson?{type:e.type,personPointer:e.personPointer}:e.type===l().FY.MemberPropertyMismatchCollection?{type:e.type,blockCollection:e.blockCollection}:e.type===l().FY.DownstreamParseFailure?{type:e.type,collectionId:e.collectionId,property:e.property}:e.type===l().FY.ContextVariableWrongType?{type:e.type,valueId:e.valueId,expectedType:e.expectedType,resultType:e.resultType}:e.type===l().FY.DisallowedValueType?{type:e.type,expressionValue:e.expressionValue,allowedValueTypes:e.allowedValueTypes}:e.type===l().FY.LibraryFunctionExecutionError?{type:e.type,error:e.error,libraryFunctionName:e.libraryFunction.name}:{type:e.type}}const _={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,button:!1,file:!1,verification:!1,auto_increment_id:!1,created_by:!1,created_time:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1};function f(e){return Boolean(_[e.type])}function h(e){const{collectionFormat:t,collectionSchema:o,filter:l,sort:p}=e,d=(0,n().Yd)(o).filter(((e,t,r)=>{var n;const a=o[e];return!(!a||!_[a.type])&&((!(0,i().qQ)(a)||null===(n=(0,i().q3)(a))||void 0===n||!n.auto_update_on_edit)&&(!l||l([e,a],t,o)))}));if(0===d.length)return[];if(!t||!1===p)return d;const c=(0,s().i)(t,o,void 0,a().j5.Page).collection_page_properties||[];return r().MR(d,(e=>c.findIndex((t=>t.property===e))))}const v={checkbox:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,date:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1};function g(e){return v[e.type]}const b={checkbox:!0,created_by:!0,created_time:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,last_edited_by:!0,last_edited_time:!0,auto_increment_id:!1,button:!1,file:!1,formula:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1};function S(e){return b[e.type]}function w(e){return 0===e}function I(e){return function(e){return"button_block"===e||"button_property"===e}(e)}function M(e){const{property:t,collectionSchema:o}=e;return!!o&&!o[t]}function C(e){const{collectionSchema:t,property:o,type:r}=e,n=null==t?void 0:t[o];return!n||("action"===r?!c(n):!_[n.type])}function T(e){let{automationTrigger:t,collectionSchema:o}=e;if("event"===(null==t?void 0:t.type)||"notification_event"===(null==t?void 0:t.type)){const{pagesAdded:e,pagePropertiesEdited:r,source:i}=t.event;if(void 0===i)return!1;const a="some"===r.type&&r.some,l="all"===r.type&&r.all;if((a||l||[]).some((e=>M({collectionSchema:o,property:e.property})||C({collectionSchema:o,property:e.property,type:"trigger"}))))return!1;const s="some"===r.type&&(!(0,n().$K)(r.some)||0===r.some.length),p="all"===r.type&&(!(0,n().$K)(r.all)||0===r.all.length);if(!e&&("none"===r.type||s||p))return!1}else{if("recurrence"!==(null==t?void 0:t.type))return!1;if(!t.recurrence)return!1}return!0}},157955:(e,t,o)=>{o.r(t),o.d(t,{DEFAULT_MAX_RECURRENCE_DUPLICATION_PER_TASK:()=>k,MAXIMUM_DAILY_RECURRENCES_IN_PATH:()=>w,MAXIMUM_NESTED_RECURRENCE_LEVEL:()=>S,MAX_RECURRENCE_INTERVAL:()=>f,MAX_RECURRENCE_NUMBER_OF_RUNS:()=>h,RRULE_WEEKDAYS_MAP:()=>_,convertFromUnpersistedRecurrenceConfig:()=>R,convertToUnpersistedRecurrenceConfig:()=>E,getFormattedEndCondition:()=>A,getFormattedNextRecurrenceTime:()=>x,getNextDateUtc:()=>T,getRecurrenceAfter:()=>M,isRunningBetweenMidnightAnd3AM:()=>C,isValidRecurrenceInterval:()=>v,isValidRecurrenceNumberOfRuns:()=>g,rruleFromRecurrence:()=>b,templateAncestorsViolateRecurrenceNesting:()=>I});o(267602),o(653476),o(241792);var r=()=>o(730120);o(670560);function n(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),r=1;r<t;r++)o[r-1]=arguments[r];if(0===o.length)return e.map((e=>[e]));const i=[];for(const a of e)i.push(...n(o[0],...o.slice(1)).map((e=>[a,...e])));return i}var i=()=>o(696459),a=()=>o(326966),l=()=>o(803021),s=()=>o(646574),p=()=>o(998411),d=()=>o(578292);class c extends(()=>o(484885))().Ci{constructor(e,t){super(e,t)}after(e,t){return super.after(e,t)}}var u=()=>o(494616);const m=(0,o(788860).vU)({dateAtTime:{id:"automations.recurrenceHelpers.dateAtTime",defaultMessage:"{date} at {time}"},dateBetweenMidnightAnd3AM:{id:"automations.recurrenceHelpers.dateBetweenMidnightAnd3AM",defaultMessage:"{date} between 12â€“3 AM"},numberEndConditionDescription:{id:"automations.recurrenceHelpers.numberEndConditionDescription",defaultMessage:"{number, plural, one {After {number} run} other {After {number} runs}}"},noEndCondition:{id:"automations.recurrenceHelpers.noEndCondition",defaultMessage:"Never"}}),y={day:c.DAILY,week:c.WEEKLY,month:c.MONTHLY,year:c.YEARLY},_={MO:c.MO,TU:c.TU,WE:c.WE,TH:c.TH,FR:c.FR,SA:c.SA,SU:c.SU},f=99,h=999;function v(e){return(0,a().hj)(e)&&Number.isInteger(e)&&e>0&&e<=f}function g(e){return(0,a().hj)(e)&&Number.isInteger(e)&&e>0&&e<=h}function b(e){const{start_date:t,frequency:o,interval:r,weekdays:a,timezone:s,hour:p,minute:d}=e,u="week"===o&&a?a.map((e=>_[e])):void 0,m={};return(0,i().$K)(e.end_condition)&&("date"===e.end_condition.type?m.until=(0,l().pd)(e.end_condition.end_at):"number"===e.end_condition.type?m.count=e.end_condition.number_of_occurrences:(0,i().t1)(e.end_condition)),"month"===e.frequency&&(0,i().$K)(e.monthly_restriction)&&("monthdays"===e.monthly_restriction.type?m.bymonthday=e.monthly_restriction.monthdays:"weekdays_in_month"===e.monthly_restriction.type?m.byweekday=n(e.monthly_restriction.weekdays,e.monthly_restriction.week_numbers).map((e=>{let[t,o]=e;return _[t].nth(o)})):(0,i().t1)(e.monthly_restriction)),new c({freq:y[o],dtstart:(0,l().pd)(t),interval:r,byweekday:u,tzid:s,byhour:p??0,byminute:d??0,bysecond:0,...m})}const S=1,w=1;function I(e){var t;if(0===e.length)return{violatesConstraint:!1,templateNestingExceedsMaxDepth:!1,ancestorHasDailyTemplate:!1,nestedDepthOfAutomationAncestors:void 0,immediateAncestorRecurrenceType:void 0};const o=e.filter((e=>{var t;return"day"===(null===(t=e.getRecurrence())||void 0===t?void 0:t.frequency)})),r=e.length,n=null===(t=e[0].getRecurrence())||void 0===t?void 0:t.frequency,i=r>S,a=o.length>=w;return{violatesConstraint:i||a,templateNestingExceedsMaxDepth:i,ancestorHasDailyTemplate:a,nestedDepthOfAutomationAncestors:r,immediateAncestorRecurrenceType:n}}function M(e){const{recurrence:t,afterDate:o}=e;if((0,u().nA)(t)){const e=(0,l().kq)(o);return t.start_date>=e?new Date(t.start_date):void 0}{const e=b(t).after((0,l().pd)(o));if(!e)return;return(0,l().YL)(e)}}function C(e){return 0===e.hour||1===e.hour||2===e.hour}function T(e){return b(e).after((0,l().pd)((0,l().Jh)()))||void 0}function x(e){const{recurrence:t,intl:o}=e,n=T(R(t));if(!n)return;const i=C(t),a=r().ou.fromJSDate(n).toUTC().setZone("local",{keepLocalTime:!0}).setLocale((0,d().E2)(o)).setZone(t.timezone),l=(0,s().p6)({date:a,dateFormat:"relative",allowRelativeDates:!0,intl:o,shortenDate:!0});if(i)return o.formatMessage(m.dateBetweenMidnightAnd3AM,{date:l});{let e=a.toLocaleString(r().ou.TIME_SIMPLE);return t.timezone!==(0,p().r)()&&(e+=` ${a.toFormat("ZZZZ")}`),o.formatMessage(m.dateAtTime,{date:l,time:e})}}function A(e,t){return(0,i().$K)(e)?"number"===e.type?t.formatMessage(m.numberEndConditionDescription,{number:e.number_of_occurrences}):"date"===e.type?(0,s().p6)({date:r().ou.fromMillis(e.end_at),dateFormat:"relative",allowRelativeDates:!0,intl:t,shortenDate:!0}):void(0,i().t1)(e):t.formatMessage(m.noEndCondition)}const k=100;function E(e){return{...e,start_date:(0,l().kq)(e.start_date),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?{type:"date",end_at:(0,l().kq)(e.end_condition.end_at)}:(0,i().t1)(e.end_condition):void 0}}function P(e,t){const o=r().ou.fromMillis(t.end_at).set({hour:e.hour??0,minute:e.minute??0});return{type:"date",end_at:(0,l().Jh)(o.toJSDate())}}function R(e){return{...e,start_date:(0,l().Jh)(new Date(e.start_date)),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?P(e,e.end_condition):(0,i().t1)(e.end_condition):void 0}}},519454:(e,t,o)=>{o.d(t,{R:()=>n});o(667294);var r=o(785893);const n=(0,o(827282).IU)("pencil",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M3.926 13.307H14.11c.183 0 .34-.066.472-.199a.644.644 0 00.198-.471.652.652 0 00-.198-.479.644.644 0 00-.472-.198H5.272l-1.346 1.347zm-.704-.636l7.683-7.684-1.312-1.319-7.69 7.684-.67 1.606c-.037.1-.017.191.06.273.083.082.174.105.274.069l1.655-.63zm8.34-8.326l.738-.732c.182-.187.278-.376.287-.567.009-.192-.068-.374-.232-.547l-.267-.267c-.169-.168-.351-.246-.547-.232-.196.014-.385.11-.567.287l-.739.732 1.327 1.326z"})})},667932:(e,t,o)=>{o.d(t,{KD:()=>s,_P:()=>d,l2:()=>c,x9:()=>p});o(267602),o(653476),o(241792);var r=()=>o(543172),n=()=>o(210349),i=()=>o(639708),a=()=>o(712185);const l={page_main:[{id:"cover",type:"cover"},{id:"title_with_icon",type:"normalizedTitleWithIcon",propertyIds:[]},{id:"properties",type:"properties"},{id:"discussions",type:"discussions"},{id:"editor",type:"editor"}],page_details:[],form_layout_schema:[]},s={page_main:[{id:"title_with_icon",type:"normalizedTitleWithIcon",propertyIds:[]},{id:"editor",type:"editor"}],page_details:[],form_layout_schema:[]};function p(e){return(0,a().Dl)({modulesByArea:l,collectionSchema:null==e?void 0:e.collectionSchema,collectionFormat:null==e?void 0:e.collectionFormat})}function d(){return{page_layout_schema:(0,a().L0)(l.page_main).map((e=>{if(!(0,i().zP)(e))return(0,n().T)(e)?{...e,id:(0,r().ZP)()}:e})).filter((e=>void 0!==e)),page_info_layout_schema:(0,a().L0)(l.page_details).map((e=>{if(!(0,i().zP)(e))return(0,n().T)(e)?{...e,id:(0,r().ZP)()}:e})).filter((e=>void 0!==e)),form_layout_schema:void 0}}function c(e,t){const o=void 0===t?[{id:(0,r().ZP)(),type:"formQuestion",formQuestionId:e}]:[{id:(0,r().ZP)(),type:"formQuestion",formQuestionId:e},{id:(0,r().ZP)(),type:"formQuestion",formQuestionId:t}];return{page_layout_schema:void 0,page_info_layout_schema:void 0,form_layout_schema:[{id:(0,r().ZP)(),type:"cover"},{id:(0,r().ZP)(),type:"formTitle"},...o,{id:(0,r().ZP)(),type:"formSubmit"}]}}},210349:(e,t,o)=>{o.d(t,{T:()=>a,s:()=>i});const r={normalizedTitleWithIcon:!0,properties:!0,property_number:!0,property_title:!0,property_person:!0,property_file:!0,property_text:!0,property_checkbox:!0,property_url:!0,property_email:!0,property_phone_number:!0,property_created_by:!0,property_last_edited_by:!0,property_button:!0,property_select:!0,property_multi_select:!0,property_status:!0,property_date:!0,property_created_time:!0,property_last_edited_time:!0,property_last_visited_time:!0,property_relation:!0,property_rollup:!0,property_formula:!0,property_auto_increment_id:!0,property_location:!0,property_verification:!0,views:!0,viewsMain:!0,relationsGroup:!0,formQuestion:!0,placeholder:!0,deleted_property:!1,cover:!1,inlinePageSections:!1,expandedBacklinks:!1,discussions:!1,bottomControls:!1,editor:!1,transcript:!1,formTitle:!1,formSubmit:!1},n={properties:!0,property:!0,relationsGroup:!0,formQuestion:!0,placeholder:!0,titleWithIcon:!0,cover:!1,inlinePageSections:!1,expandedBacklinks:!1,discussions:!1,bottomControls:!1,editor:!1,transcript:!1,formTitle:!1,formSubmit:!1,views:!0,viewsMain:!0,collectionView:!0,collectionViewV2:!0};function i(e,t){return!("editor"!==e.type||null==t||!t.isLayoutViewModuleEnabled||null!=t&&t.isLayoutViewModuleNextEnabled)||r[e.type]}function a(e){return n[e.type]}},6623:(e,t,o)=>{o.d(t,{Fo:()=>i,m7:()=>a});const r={property_number:!0,property_title:!0,property_person:!0,property_file:!0,property_text:!0,property_checkbox:!0,property_url:!0,property_email:!0,property_phone_number:!0,property_created_by:!0,property_last_edited_by:!0,property_button:!0,property_select:!0,property_multi_select:!0,property_status:!0,property_date:!0,property_created_time:!0,property_last_edited_time:!0,property_last_visited_time:!0,property_relation:!0,property_rollup:!0,property_formula:!0,property_auto_increment_id:!0,property_location:!0,property_verification:!0,deleted_property:!1,relationsGroup:!0,formSubmit:!0,formQuestion:!0,formTitle:!0,placeholder:!0,transcript:!0,cover:!1,normalizedTitleWithIcon:!1,properties:!1,inlinePageSections:!1,expandedBacklinks:!1,discussions:!1,bottomControls:!1,editor:!1,views:!0,viewsMain:!1},n={property_number:!0,property_title:!0,property_person:!0,property_file:!0,property_text:!0,property_checkbox:!0,property_url:!0,property_email:!0,property_phone_number:!0,property_created_by:!0,property_last_edited_by:!0,property_button:!0,property_select:!0,property_multi_select:!0,property_status:!0,property_date:!0,property_created_time:!0,property_last_edited_time:!0,property_last_visited_time:!0,property_relation:!0,property_rollup:!0,property_formula:!0,property_auto_increment_id:!0,property_location:!0,property_verification:!0,deleted_property:!1,formSubmit:!1,formQuestion:!1,formTitle:!1,placeholder:!1,transcript:!1,cover:!1,normalizedTitleWithIcon:!1,properties:!1,inlinePageSections:!1,expandedBacklinks:!1,discussions:!1,bottomControls:!1,relationsGroup:!0,editor:!1,views:!1,viewsMain:!1};function i(e){return r[e.type]}function a(e){return n[e.type]}}}]);