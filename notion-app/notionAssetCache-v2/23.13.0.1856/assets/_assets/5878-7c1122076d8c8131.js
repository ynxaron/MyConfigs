"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[5878],{13882:(e,t,n)=>{function a(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}n.d(t,{Z:()=>a})},983946:(e,t,n)=>{function a(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}n.d(t,{Z:()=>a})},777349:(e,t,n)=>{n.d(t,{Z:()=>i});var a=()=>n(983946),r=()=>n(619013),o=()=>n(13882);function i(e,t){(0,o().Z)(2,arguments);var n=(0,r().Z)(e),i=(0,a().Z)(t);return isNaN(i)?new Date(NaN):i?(n.setDate(n.getDate()+i),n):n}},616218:(e,t,n)=>{n.d(t,{Z:()=>i});var a=()=>n(983946),r=()=>n(619013),o=()=>n(13882);function i(e,t){(0,o().Z)(2,arguments);var n=(0,r().Z)(e),i=(0,a().Z)(t),c=n.getFullYear(),d=n.getDate(),l=new Date(0);l.setFullYear(c,i,15),l.setHours(0,0,0,0);var s=function(e){(0,o().Z)(1,arguments);var t=(0,r().Z)(e),n=t.getFullYear(),a=t.getMonth(),i=new Date(0);return i.setFullYear(n,a+1,0),i.setHours(0,0,0,0),i.getDate()}(l);return n.setMonth(i,Math.min(d,s)),n}},619013:(e,t,n)=>{n.d(t,{Z:()=>o});var a=()=>n(13882);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e){(0,a().Z)(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===r(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}},681035:(e,t,n)=>{n.d(t,{S:()=>o});var a=()=>n(677559);const r=new(a().Ss)("CollectionItemCover",(async()=>{const{CollectionItemCover:e}=await Promise.all([n.e(62743),n.e(37912)]).then(n.bind(n,682652));return{CollectionItemCover:e}})),o=(0,a().kF)(r,(e=>e.CollectionItemCover))},850790:(e,t,n)=>{n.d(t,{K:()=>r});n(667294);var a=n(785893);const r=(0,n(827282).IU)("boltFilled",{svg:(0,a.jsx)("path",{d:"M0 12.117c0 .38.293.664.703.664h5.518l-2.91 7.91c-.381 1.006.664 1.543 1.318.723l8.877-11.094c.166-.205.254-.4.254-.625 0-.371-.293-.664-.703-.664H7.539l2.91-7.91C10.83.115 9.785-.422 9.131.408L.254 11.492c-.166.215-.254.41-.254.625z"}),viewBox:"0 0 14 22"})},756085:(e,t,n)=>{n.d(t,{f:()=>r});n(667294);var a=n(785893);const r=(0,n(827282).IU)("chevronLeft",{viewBox:"0 0 16 16",svg:(0,a.jsx)("path",{d:"M3.61816 8.06445C3.61816 8.29688 3.70703 8.49512 3.8916 8.67285L9.22363 13.8887C9.36719 14.0391 9.55859 14.1143 9.77734 14.1143C10.2217 14.1143 10.5703 13.7725 10.5703 13.3213C10.5703 13.1025 10.4814 12.9043 10.3311 12.7539L5.52539 8.06445L10.3311 3.375C10.4814 3.21777 10.5703 3.01953 10.5703 2.80078C10.5703 2.35645 10.2217 2.01465 9.77734 2.01465C9.55859 2.01465 9.36719 2.08984 9.22363 2.24023L3.8916 7.45605C3.70703 7.63379 3.625 7.83203 3.61816 8.06445Z"})})},109806:(e,t,n)=>{n.d(t,{c:()=>r});n(667294);var a=n(785893);const r=(0,n(827282).IU)("eye",{viewBox:"0 0 32 32",svg:(0,a.jsx)("path",{d:"M16.006 25.812c8.863 0 14.994-7.17 14.994-9.406C31 14.16 24.858 7 16.006 7 7.252 7 1 14.16 1 16.406c0 2.236 6.252 9.406 15.006 9.406zm0-3.242a6.194 6.194 0 01-6.197-6.164c-.012-3.452 2.744-6.164 6.197-6.164 3.419 0 6.185 2.711 6.185 6.164 0 3.364-2.766 6.164-6.185 6.164zm0-3.94c1.228 0 2.246-1.007 2.246-2.224 0-1.228-1.018-2.235-2.246-2.235-1.24 0-2.258 1.007-2.258 2.235 0 1.217 1.018 2.224 2.258 2.224z"})})},944039:(e,t,n)=>{n.d(t,{Q4:()=>D,jJ:()=>M,nz:()=>k,XM:()=>U,YZ:()=>A,ai:()=>H,qL:()=>P,r:()=>O,fJ:()=>F,Xe:()=>E,jG:()=>W});n(267602),n(653476),n(470928);var a=()=>n(730120),r=()=>n(360866),o=()=>n(513670),i=()=>n(696459),c=()=>n(824462),d=()=>n(636340),l=()=>n(269299),s=()=>n(624712),u=()=>n(909859),m=()=>n(620218),v=()=>n(876822),f=()=>n(749826),p=()=>n(966266),g=()=>n(932370),h=(n(122556),n(582845),n(250570),n(533019),n(721473),n(788208),n(22624),n(916054),n(241792),()=>n(546155)),b=()=>n(936146);function S(e){return e.every((e=>{let{calendarId:t,accountId:n}=e;return h().Z.getCalendarFetchedTime({calendarId:t,accountId:n})}))}function y(e){let{oldMap:t,newMap:n,keyGetter:a}=e;const o=new(r().Z)(t.getOrderedValues(),a);for(const r of(null==n?void 0:n.getOrderedValues())??[]){const e=a(r);o.append(e,r,{keepOrdering:!0})}return o}var I=()=>n(787306),C=()=>n(124199);const w=C().object({required:{botId:C().uuid(),timeMin:C().number(),timeMax:C().number(),accounts:C().array(C().tuple([C().string(),C().object({required:{},optional:{}})])),calendars:C().array(C().tuple([C().string(),C().object({required:{},optional:{}})])),events:C().array(C().tuple([C().string(),C().object({required:{},optional:{}})])),calendarsToLastFetchedTime:C().record(C().string(),C().number())},optional:{}});const _=new class{constructor(){this.localStorageStore=new(n(149310).ZP)({namespace:"homeCalendarCache",important:!1,trackingType:"preference",maxValueLength:512e3})}get(e){let t;try{t=this.localStorageStore.get(e)}catch{}if(t&&null===w.validator(t))return function(e){return{...e,accounts:r().Z.fromJSON(e.accounts),calendars:r().Z.fromJSON(e.calendars),events:r().Z.fromJSON(e.events),calendarsToLastFetchedTime:Object.fromEntries(Object.entries(e.calendarsToLastFetchedTime).map((e=>{let[t,n]=e;return[t,a().ou.fromMillis(n)]})))}}(t);this.localStorageStore.remove(e)}set(e,t){try{this.localStorageStore.set(e,(n=t,{...n,accounts:n.accounts.toJSON(),calendars:n.calendars.toJSON(),events:n.events.toJSON(),calendarsToLastFetchedTime:Object.fromEntries(Object.entries(n.calendarsToLastFetchedTime).map((e=>{let[t,n]=e;return[t,n.toMillis()]})))}))}catch{}var n}remove(e){this.localStorageStore.remove(e)}};var V=()=>n(350777),x=()=>n(588331);class T{constructor(e,t,n,a){this.pendingInvocations=new Map,this.fn=e,this.coalesce=t,this.waitMs=n,this.options=a}enqueue(e){for(const[n,a]of this.pendingInvocations){const t=this.coalesce(n,e);if(t)return this.pendingInvocations.delete(n),this.pendingInvocations.set(t,a),void a.dequeueDebounced(t)}const t=(0,o().Ds)(this.dequeue.bind(this),this.waitMs,this.options);this.pendingInvocations.set(e,{dequeueDebounced:t}),t(e)}dequeue(e){this.pendingInvocations.delete(e),this.fn.apply(null,e)}}function M(e){let{environment:t,timeRange:n,panelState:a}=e;const{currentSpaceViewStore:r}=v().default.state;if(!r)return;const o=r.getHomeCalendarConfigStore().getKeyStore("time_range");l().createAndCommit({userAction:"homeCalendarActions.changeUpcomingEventsTimeRange",environment:t,canUndo:!0,perform:e=>{d().sO({transaction:e,store:o,value:n})}}),(0,V().WM)({environment:t,calendarPanelContext:(0,V().b$)(a),newValue:n})}function O(e){var t;let{environment:n,filter:a,panelState:r}=e;const{currentSpaceViewStore:o}=v().default.state;if(!o)return;const i=null===(t=o.getHomeCalendarConfigStore())||void 0===t||null===(t=t.getKeyStore("event_filters"))||void 0===t?void 0:t.getKeyStore(a),c=!(0,p().z)(a);l().createAndCommit({userAction:"homeCalendarActions.toggleCalendarEventFilter",environment:n,canUndo:!0,perform:e=>{d().sO({transaction:e,store:i,value:c})}});const s=(0,V().b$)(r);(0,V().bl)({environment:n,calendarPanelContext:s,filter:a,newValue:c})}function D(e){let{environment:t,botId:n,shouldLog:a,panelState:r}=e;const{currentSpaceViewStore:o}=v().default.state;if(!o)return;const i=o.getHomeCalendarConfigStore().getKeyStore("selected_calendar_bot_id");if(i.getValue()!==n&&(0,u().RI)().find((e=>e.id===n))&&(l().createAndCommit({userAction:"homeCalendarActions.changeSelectedCalendarBot",environment:t,canUndo:!0,perform:e=>{d().sO({transaction:e,store:i,value:n})}}),a)){const e=(0,V().b$)(r);(0,V().i_)({environment:t,botId:n,calendarPanelContext:e})}}function k(e){let{environment:t}=e;const{currentSpaceViewStore:n}=v().default.state;if(!n)return;const a=n.getHomeCalendarConfigStore().getKeyStore("selected_calendar_bot_id");a.getValue()&&l().createAndCommit({userAction:"homeCalendarActions.clearSelectedCalendarBot",environment:t,canUndo:!0,perform:e=>{d().sO({transaction:e,store:a,value:void 0})}})}async function A(e){let{environment:t,currentSpaceViewStore:n,botId:r,timeRange:u,calendarAndAccountIds:p,forceRefetch:I,updateMethod:C,reason:w}=e;if(!n||!n.isReady()||!n.canRead())return"failure";const V=f().default.checkGate({gateName:"calendar_home_tile_caching"});if(!I){var T;let e=h().Z.getStateForCurrentSpaceView();if(!e&&V&&(e=function(e){let{timeMin:t,botId:n}=e;const{currentSpaceViewStore:r}=v().default.state;if(!r)return;let o=_.get(r.id);if(o){const e=o.botId===n,i=t>=o.timeMin&&a().ou.fromMillis(t).plus({days:R}).toMillis()<=o.timeMax;e&&i?(o=N({state:o}).newState,h().Z.updateStateForCurrentSpaceView((()=>o))):(_.remove(r.id),o=void 0)}return o}({timeMin:u.timeMin,botId:r})),(null===(T=e)||void 0===T?void 0:T.botId)===r)if(p){if(S(p))return"skipped"}else if(S((0,x().CX)({botId:r,currentSpaceViewStore:n})))return"skipped"}const M=(0,x().bU)({spaceViewStore:n,botId:r,specificCalendars:p}),O=m().default.DO_NOT_USE_markLegacy("home.calendar.get_calendar_events_all"),D=await c().callApi({eventName:"getCalendarEvents",environment:t,data:{botId:r,timeMin:u.timeMin,timeMax:u.timeMax,orderBy:"startTime",calendars:p,calendarVisibilityOverrides:"mirrorWithCron"===M.type?void 0:M.calendarOverrides,userTimeZone:(0,s().NX)().timeZone,reason:Array.isArray(w)?(0,o().jj)(w).sort().join(","):w}});if("success"!==D.type)return"failure";p||m().default.DO_NOT_USE_measureLegacy(O,{environment:t});const{accounts:k,calendars:A,events:Z}=D.data,H=function(e){let{specificCalendarsFetched:t,calendarVisibilityOverrides:n,calendarApiResponse:a}=e;const r=new Set((t??[]).map(b().D)),c="calendarOverrides"===n.type?n.calendarOverrides:[],d=(0,o().KX)(c,b().D);return a.filter((e=>{const n=(0,b().D)(e);if(void 0!==t)return r.has(n);const a=d[n];return(0,i().$K)(a)?a.visible:e.selected})).map((e=>{let{id:t,accountId:n}=e;return{calendarId:t,accountId:n}}))}({calendarApiResponse:A,specificCalendarsFetched:p,calendarVisibilityOverrides:M});return h().Z.updateStateForCurrentSpaceView((e=>{let t;switch(C){case void 0:case"merge":t=e;break;case"replace":t=void 0;break;default:(0,i().P)(C)}const o=function(e){let{oldState:t,newState:n,updatedCalendars:a,fetchTime:r}=e;const o=!t||n.botId!==t.botId,c=function(e){let{calendarsThatWereUpdated:t,oldCalendarFetchedTimes:n,fetchTime:a}=e;const r={...n};for(const o of t)(!r[o]||r[o]<a)&&(r[o]=a);return r}({calendarsThatWereUpdated:a.map(b().D),oldCalendarFetchedTimes:o||null==t?void 0:t.calendarsToLastFetchedTime,fetchTime:r});if(!t||o)return{...n,calendarsToLastFetchedTime:c};const d={...t,calendarsToLastFetchedTime:c};for(const l of(0,i().qP)(n))switch(l[0]){case"accounts":d.accounts=y({oldMap:t.accounts,newMap:n.accounts,keyGetter:e=>{let{id:t}=e;return t}});break;case"events":d.events=(0,g().xO)({events:t.events,calendars:t.calendars,updatedCalendarAndAccountIds:a,newEvents:n.events.getOrderedValues()});break;case"botId":d.botId=n.botId;break;case"timeMin":d.timeMin=Math.max(t.timeMin,n.timeMin);break;case"timeMax":d.timeMax=Math.min(t.timeMax,n.timeMax);break;case"calendars":d.calendars=y({oldMap:t.calendars,newMap:n.calendars,keyGetter:b().D});break;default:(0,i().P)(l[0])}return d}({oldState:t,newState:(0,g().Xb)({botId:r,accounts:k,calendars:A,events:Z,timeMin:u.timeMin,timeMax:u.timeMax}),updatedCalendars:H,fetchTime:a().ou.now()});return V&&_.set(n.id,o),o})),function(e){let{environment:t,spaceViewStore:n,botId:a,calendarResponse:r}=e;const o=n.getHomeCalendarVisibilityConfig(a);if((0,x().gV)({spaceViewStore:n,botId:a}))return;const i=(0,x().XT)({currentConfig:null==o?void 0:o.calendarVisibility,calendars:r});if("noChanges"===i.result)return;l().createAndCommit({userAction:"homeCalendarActions.populateCalendarConfigWithCalendarResponse",environment:t,canUndo:!0,perform:e=>{d().sO({transaction:e,store:n.getHomeCalendarConfigStore().getKeyStore("shownCalendars").getKeyStore(a).getKeyStore("calendarVisibility"),value:i.newConfig})}})}({environment:t,spaceViewStore:n,botId:r,calendarResponse:A}),"success"}const Z=(0,o().Ds)(A,1e3,{leading:!1,trailing:!0});const H=function(e,t,n,a){const r=new T(e,t,n,a);return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.enqueue(t)}}(A,(function(e,t){let n,[a]=e,[r]=t;if(a.environment!==r.environment||a.currentSpaceViewStore!==r.currentSpaceViewStore||a.botId!==r.botId||a.timeRange.key!==r.timeRange.key)return!1;const i={environment:a.environment,currentSpaceViewStore:a.currentSpaceViewStore,botId:a.botId,timeRange:{key:a.timeRange.key,timeMin:Math.max(a.timeRange.timeMin,r.timeRange.timeMin),timeMax:Math.max(a.timeRange.timeMax,r.timeRange.timeMax)},reason:(0,o().xH)([a.reason,r.reason]),forceRefetch:a.forceRefetch||r.forceRefetch};return n=a.calendarAndAccountIds&&r.calendarAndAccountIds?{...i,calendarAndAccountIds:(0,o().mN)([...a.calendarAndAccountIds,...r.calendarAndAccountIds],b().D)}:{...i,updateMethod:"replace"===a.updateMethod||"replace"===r.updateMethod?"replace":"merge"},[n]}),2e3+2e3*Math.random(),{maxWait:5e3});function F(e){let{environment:t,botId:n,mirrorWithNotionCalendar:a,panelState:r}=e;const{currentSpaceViewStore:o}=v().default.state;if(!o)return;const i=o.getHomeCalendarConfigStore().getKeyStore("shownCalendars").getKeyStore(n);l().createAndCommit({userAction:"homeCalendarActions.toggleCalendarMirroring",environment:t,canUndo:!0,perform:e=>{const t=a?void 0:(0,x().Bv)(h().Z.getCurrentCalendars()??[]);d().sO({transaction:e,store:i,value:{mirrorWithNotionCalendar:a,calendarVisibility:t}})}});const c=(0,V().b$)(r),s=a;(0,V().Qg)({environment:t,calendarPanelContext:c,newValue:s}),Z({environment:t,currentSpaceViewStore:o,botId:n,timeRange:(0,I().Lf)(),forceRefetch:!1,reason:"toggle_mirroring"})}function W(e){let{environment:t,botId:n,calendarId:a,accountId:r,newIsVisible:o,panelState:i}=e;const{currentSpaceViewStore:c}=v().default.state;if(!c)return;const s=c.getCalendarVisibilityStore({botId:n,calendarId:a,accountId:r});l().createAndCommit({userAction:"homeCalendarActions.toggleCalendarVisibility",environment:t,canUndo:!0,perform:e=>{d().sO({transaction:e,store:s,value:o})}}),(0,V().Yb)({environment:t,calendarPanelContext:(0,V().b$)(i),calendarId:a,accountId:r,newValue:o}),Z({environment:t,currentSpaceViewStore:c,botId:n,timeRange:(0,I().Lf)(),calendarAndAccountIds:[{calendarId:a,accountId:r}],forceRefetch:!1,reason:"toggle_calendar_visibility"})}function E(e){var t;let{environment:n,botId:a,calendarId:r,accountId:i,newIsVisible:c}=e;const{currentSpaceViewStore:d}=v().default.state;if(!d)return;const l=h().Z.getCalendar({calendarId:r,accountId:i});if(!l||l.selected===c)return;h().Z.updateStateForCurrentSpaceView((e=>{if(!e)return;const t=(0,o().Xh)(e),n=t.calendars.get((0,b().D)({accountId:i,calendarId:r}));if(!n||n.selected===c)return e;n.selected=c;return f().default.checkGate({gateName:"calendar_home_tile_caching"})&&_.set(d.id,t),t}));((null===(t=d.getHomeCalendarVisibilityConfig(a))||void 0===t?void 0:t.mirrorWithNotionCalendar)??!1)&&c&&H({currentSpaceViewStore:d,environment:n,botId:a,timeRange:(0,I().Lf)(),calendarAndAccountIds:[{calendarId:r,accountId:i}],forceRefetch:!1,reason:"calendar_visibility_change"})}function N(e){let{now:t=a().ou.now(),state:n}=e;const{events:o}=n,{timeZone:i}=(0,s().NX)(),c=new(r().Z)(o.getOrderedValues().filter((e=>!(0,g().SG)(e,t,i))),b().y);return c.length===o.length?{didChange:!1,newState:n}:{didChange:!0,newState:{...n,timeMin:t.toMillis(),events:c}}}function P(e){let{now:t=a().ou.now(),currentSpaceViewStore:n}=e;if(!n)return;const r=h().Z.getStateForCurrentSpaceView();if(!r)return;const{didChange:o,newState:i}=N({now:t,state:r});if(o){h().Z.updateStateForCurrentSpaceView((()=>i));f().default.checkGate({gateName:"calendar_home_tile_caching"})&&_.set(n.id,i)}}const R=1;function U(){const{currentSpaceViewStore:e}=v().default.state;e&&(h().Z.clearStateForCurrentSpaceView(),_.remove(e.id))}},156045:(e,t,n)=>{n.d(t,{G:()=>W,Z:()=>E});n(241792);var a=n(667294),r=()=>n(219727),o=()=>n(142735),i=()=>n(846550),c=()=>n(506347),d=()=>n(572680),l=()=>n(396136),s=()=>n(788860),u=()=>n(707513),m=()=>n(752127),v=()=>n(794586),f=()=>n(75982),p=()=>n(448419),g=()=>n(198829),h=()=>n(255577),b=()=>n(92175),S=()=>n(943620),y=()=>n(384241),I=()=>n(388284),C=()=>n(205228),w=()=>n(337897),_=()=>n(352230),V=()=>n(599631),x=()=>n(998901),T=()=>n(876822),M=()=>n(826955),O=n(785893);const D=4,k=4,A={height:20,paddingTop:2,paddingBottom:2,marginTop:-2,marginBottom:-2,paddingLeft:4,paddingRight:4,marginLeft:-D,marginRight:-k};function Z(e){let{event:t,onClick:n}=e;const a=(0,r().O7)(),o=(0,i().yK)((()=>({container:{display:"flex",flexDirection:"row",justifyItems:"center",width:"fit-content",maxWidth:"100%",gap:6}})),[]),{attachments:c}=t,[l,...s]=function(e){let{environment:t,attachments:n}=e;if(!n)return[];const a=n.findIndex((e=>"page"===(0,d().parseRoute)({url:e.fileUrl,isMobile:t.device.isMobile,baseUrl:C().default.domainBaseUrl,publicDomainName:C().default.publicDomainName,protocol:C().default.protocol,currentUrl:window.location.href}).name));if(-1===a)return n;return[n[a],...n.slice(0,a),...n.slice(a+1)]}({environment:a,attachments:c});return c&&l?(0,O.jsxs)("div",{style:o.container,children:[(0,O.jsx)(H,{attachment:l,attachmentIndex:0,onClick:n}),(0,O.jsx)(F,{attachments:s,onClickAttachment:n})]}):null}function H(e){let{attachment:t,attachmentIndex:n,menuListItemProps:d,onClick:l}=e;const{fileUrl:s,iconLink:p}=t,g=0===n,h=(0,i().yK)((e=>({button:{gap:4,flexShrink:1,...g?{maxWidth:`calc(100% + ${D+k}px)`}:{width:"100%"},...g&&A},title:{...g?{...(0,w().z0)(e),fontWeight:u().Ue.medium}:{maxWidth:200},...u().Yu},icon:{height:16},linkIcon:{height:16,width:16,fill:e.mediumIconColor}})),[g]),I=(0,r().O7)(),C=(0,o().VK)((()=>{const{currentSpaceStore:e}=T().default.state;return W({environment:I,fileUrl:s,currentSpaceStore:e})}),[I,s]),_=(0,o().VK)((()=>{const e=null==C?void 0:C.getIcon();return C&&e?(0,O.jsx)(S().Z,{icon:e,isEmptyPage:C.isEmptyPage(),size:16,disabled:!0}):p?(0,O.jsx)("img",{style:h.icon,src:p,alt:`Icon image for the Notion calendar event attachment entitled "${t.title}"`}):(0,V().N)(h.linkIcon)}),[t.title,C,p,h.icon,h.linkIcon]),x=C?(0,O.jsx)(y().Z,{store:C,underline:g}):(0,O.jsx)("div",{style:h.title,children:t.title?t.title:(0,O.jsx)(f().tI,{textValue:[[t.fileUrl]]})}),M=(0,a.useCallback)((e=>{if(e.preventDefault(),!s)return;l({index:n,attachmentType:C?"notion":"other",attachmentBlockId:null==C?void 0:C.id});const t=e.metaKey||e.ctrlKey;C?v().CH({environment:I,openInNew:t?"tab":void 0,store:C,pageVisitSource:c().tY.PersonalHomeCalendarAttachment,peekMode:"center_peek",resultsStore:void 0,collectionContextStore:void 0}):m().D({environment:I,url:s})}),[n,C,I,s,l]);return(0,O.jsxs)(b().Z,{style:h.button,href:s,metaHref:s,...d,onClick:M,children:[_,x]})}function F(e){let{attachments:t,onClickAttachment:n}=e;const a=(0,r().MO)(),o=(0,i().yK)((e=>({button:{color:e.mediumTextColor,...A,marginRight:0},sectionMenuItem:{display:"flex",flexDirection:"column",padding:4,width:"100%"}})),[]);return t&&0!==t.length?(0,O.jsx)(p().ZP,{alignmentToOrigin:x().Alignment.Start,placementToOrigin:x().Placement.Bottom,renderOrigin:e=>(0,O.jsx)(b().Z,{style:o.button,...e,children:(0,O.jsx)(s()._H,{id:"EventCalendarAttachments.plusMoreAttachments",defaultMessage:"+{numRemainingAttachments}",values:{numRemainingAttachments:t.length}})}),popupType:a?p().Z4.SlideUp:p().Z4.Popup,render:e=>(0,O.jsx)(g().Z,{menuType:_().o.Popup,maxWidth:300,children:(0,O.jsx)(h().Z,{onAccept:e.close,type:h().i.Vertical,sections:[{key:"all",render:e=>(0,O.jsx)(I().Z,{...e,style:o.sectionMenuItem}),items:t.map(((e,t)=>({key:e.fileUrl,render:a=>(0,O.jsx)(H,{menuListItemProps:a,attachment:e,attachmentIndex:t+1,onClick:n},e.fileUrl),action:()=>{}})))}],initialFocus:0})})}):(0,O.jsx)(O.Fragment,{})}function W(e){const{environment:t,currentSpaceStore:n}=e;let a=e.fileUrl;if(!n)return;C().default.isLocalhost&&(a=a.replace("dev.notion.so","localhost:3000").replace("https","http"));const r=(0,d().parseRoute)({url:a,isMobile:t.device.isMobile,baseUrl:C().default.domainBaseUrl,publicDomainName:C().default.publicDomainName,protocol:C().default.protocol,currentUrl:window.location.href}),o="page"===r.name?r.blockId:void 0;if(!o)return;const i=M().G.createChildStore(n,{table:l().iU,id:o});return i.load(),i.isReady()?i:void 0}const E=a.memo(Z)},115129:(e,t,n)=>{n.d(t,{P:()=>u});n(267602),n(653476),n(470928),n(228244);var a=n(667294),r=()=>n(219727),o=()=>n(142735),i=()=>n(235484),c=()=>n(876822),d=()=>n(749826),l=()=>n(138912),s=()=>n(944039);function u(){const e=(0,r().O7)(),t=(0,a.useRef)(void 0);return(0,o().VK)((()=>{if(void 0===t.current){if(!d().default.isStatsigReady())return{loading:!0,botId:void 0,botSpaceId:void 0,botUserId:void 0};t.current=d().default.checkGate({gateName:"calendar_home_tile_caching"})}if(t.current){var n;const{currentSpaceViewStore:t}=c().default.state;if(!t||!t.isReady())return{loading:!0,botId:void 0,botSpaceId:void 0,botUserId:void 0};const a=t.getSelectedCalendarBotId(),r=!l().default.state.loaded;if(a&&r)return{loading:!1,botId:a,botSpaceId:t.getSpaceId(),botUserId:t.getUserId()};const{spaceId:o,userId:d}=l().default.state.loaded?l().default.state:{spaceId:void 0,userId:void 0},u=l().default.bots.state.filter((e=>e.integration_id===i().Dv)),m=null===(n=u[0])||void 0===n?void 0:n.id,v=a&&u.some((e=>e.id===a))?a:m;return v&&v!==a?(0,s().Q4)({environment:e,botId:v,shouldLog:!1}):!v&&a&&(0,s().nz)({environment:e}),{loading:r,botId:v,botSpaceId:o,botUserId:d}}{var a,r,o;const e=l().default.bots.state.filter((e=>e.integration_id===i().Dv)),t=null===(a=c().default.state.currentSpaceViewStore)||void 0===a?void 0:a.getSelectedCalendarBotId(),n=!l().default.state.loaded||!(null!==(r=c().default.state.currentSpaceViewStore)&&void 0!==r&&r.isReady()),{spaceId:d,userId:s}=l().default.state.loaded?l().default.state:{spaceId:void 0,userId:void 0},u=null===(o=e[0])||void 0===o?void 0:o.id;if(!t)return{loading:n,botId:u,botSpaceId:d,botUserId:s};const m=e.find((e=>e.id===t));return{loading:n,botId:(null==m?void 0:m.id)??u,botSpaceId:d,botUserId:s}}}),[e])}},801924:(e,t,n)=>{n.d(t,{hc:()=>l,lI:()=>c,tq:()=>d});var a=()=>n(696459);const r={1:e=>e.calendarHomeWidget.base.orange,2:e=>e.calendarHomeWidget.base.red,3:e=>e.calendarHomeWidget.base.red,4:e=>e.calendarHomeWidget.base.orange,5:e=>e.calendarHomeWidget.base.orange,6:e=>e.calendarHomeWidget.base.orange,7:e=>e.calendarHomeWidget.base.green,8:e=>e.calendarHomeWidget.base.green,9:e=>e.calendarHomeWidget.base.green,10:e=>e.calendarHomeWidget.base.green,11:e=>e.calendarHomeWidget.base.yellow,12:e=>e.calendarHomeWidget.base.yellow,13:e=>e.calendarHomeWidget.base.green,14:e=>e.calendarHomeWidget.base.blue,15:e=>e.calendarHomeWidget.base.blue,16:e=>e.calendarHomeWidget.base.blue,17:e=>e.calendarHomeWidget.base.purple,18:e=>e.calendarHomeWidget.base.purple,19:e=>e.calendarHomeWidget.base.gray,20:e=>e.calendarHomeWidget.base.gray,21:e=>e.calendarHomeWidget.base.pink,22:e=>e.calendarHomeWidget.base.pink,23:e=>e.calendarHomeWidget.base.purple,24:e=>e.calendarHomeWidget.base.purple},o={1:e=>e.calendarHomeWidget.base.purple,2:e=>e.calendarHomeWidget.base.green,3:e=>e.calendarHomeWidget.base.pink,4:e=>e.calendarHomeWidget.base.red,5:e=>e.calendarHomeWidget.base.yellow,6:e=>e.calendarHomeWidget.base.orange,7:e=>e.calendarHomeWidget.base.blue,8:e=>e.calendarHomeWidget.base.gray,9:e=>e.calendarHomeWidget.base.blue,10:e=>e.calendarHomeWidget.base.green,11:e=>e.calendarHomeWidget.base.red};function i(e){let{theme:t,color:n}=e;if("preset"===n.type){var i,c;if("calendar"===n.colorType)return null===(i=r[n.colorId])||void 0===i?void 0:i.call(r,t);if("event"===n.colorType)return null===(c=o[n.colorId])||void 0===c?void 0:c.call(o,t);(0,a().P)(n)}var d;if("custom"===n.type)return null===(d=n.colorHexes)||void 0===d?void 0:d[t.mode].backgroundPrimary;(0,a().P)(n)}function c(e){let{theme:t,calendarColor:n}=e;const a=n&&i({theme:t,color:n});return a||t.calendarHomeWidget.base.blue}function d(e){let{theme:t,eventColor:n,calendarColor:a}=e;const r=n&&i({theme:t,color:n});return r||c({theme:t,calendarColor:a})}function l(e){const{colorType:t,color:n,colorId:a}=e;return a?{type:"preset",colorId:a,colorType:t}:n?{type:"custom",colorHexes:n}:void 0}},966266:(e,t,n)=>{n.d(t,{S:()=>i,z:()=>o});var a=()=>n(876822);const r={all_day_events:!0,events_without_participants:!0,events_without_location:!0};function o(e){const{currentSpaceViewStore:t}=a().default.state;return(null==t?void 0:t.getHomeCalendarFilter(e))??r[e]}function i(e){let{event:t,eventFilters:n}=e;return(!1!==n.all_day_events||!t.isAllDay)&&(!(!1===n.events_without_participants&&!t.hasParticipants)&&!(!1===n.events_without_location&&!t.hasConferencingOrLocation))}},932370:(e,t,n)=>{n.d(t,{i$:()=>V,Hs:()=>w,SG:()=>x,xO:()=>y,Xb:()=>g});n(670560),n(122556),n(582845),n(250570),n(533019),n(721473),n(788208),n(22624),n(267602),n(653476),n(241792);var a=()=>n(730120),r=()=>n(360866),o=()=>n(799891),i=()=>n(513670),c=()=>n(696459),d=()=>n(801924),l=()=>n(966266),s=()=>n(936146),u=()=>n(619013),m=()=>n(13882);var v=()=>n(663272);function f(e){let{aCalendar:t,aEvent:n,aStartTimeOverride:a,bCalendar:r,bEvent:o,bStartTimeOverride:i}=e,c=a,d=i;if(!c&&n.start&&(c=p(n)),!d&&o.start&&(d=p(o)),!c)return 1;if(!d)return-1;let l=function(e,t){(0,m().Z)(2,arguments);var n=(0,u().Z)(e),a=(0,u().Z)(t),r=n.getTime()-a.getTime();return r<0?-1:r>0?1:r}(c.toMillis(),d.toMillis());if(0===l){var s,v;const e=Boolean(null==t?void 0:t.primary),a=Boolean(null==r?void 0:r.primary),i=Boolean(null===(s=n.conferencing)||void 0===s?void 0:s.providerName),c=Boolean(n.hasParticipants),d=i&&c,u=Boolean(null===(v=o.conferencing)||void 0===v?void 0:v.providerName),m=Boolean(o.hasParticipants),f=u&&m,p="accepted"===n.responseStatus,g="accepted"===o.responseStatus,h="needsAction"===n.responseStatus,b="needsAction"===o.responseStatus,S="tentative"===n.responseStatus,y="tentative"===o.responseStatus;e&&!a?l=-1:a&&!e?l=1:d&&!f?l=-1:f&&!d?l=1:i&&!u?l=-1:u&&!i?l=1:c&&!m?l=-1:m&&!c?l=1:p&&!g?l=-1:g&&!p?l=1:!h||g||b?!b||p||h?S&&!(g||b||y)?l=-1:y&&!(p||h||S)&&(l=1):l=1:l=-1}return l}function p(e){if(e.isAllDay){const{date:t}=e.start;return(0,v().uw)(t,"UTC")}{const{dateTime:t}=e.start;return a().ou.fromISO(t,{zone:"UTC"})}}function g(e){let{botId:t,accounts:n,calendars:a,events:o,timeMin:i,timeMax:c}=e;const d=new(r().Z)(a.map(h),s().D);return{botId:t,accounts:new(r().Z)(n,(e=>e.id)),calendars:d,events:new(r().Z)(b(o).sort(I(d)),s().y),timeMin:i,timeMax:c}}function h(e){return{...e,color:(0,d().hc)({color:e.color,colorId:e.colorId,colorType:"calendar"}),colorId:void 0,primary:e.primary}}function b(e){return e.map((e=>function(e){var t,n,r,i,c,l;let s;const u=S(null===(t=e.start)||void 0===t?void 0:t.timeZone),m=S(null===(n=e.end)||void 0===n?void 0:n.timeZone),f=(null===(r=e.start)||void 0===r?void 0:r.date)??(null===(i=e.start)||void 0===i?void 0:i.dateTime)??void 0,p=(null===(c=e.end)||void 0===c?void 0:c.date)??(null===(l=e.end)||void 0===l?void 0:l.dateTime)??void 0;if(!f||!p)return;const g=()=>{o().log({level:"error",from:"toHydratedEvent",type:"invalidDate",data:{miscDataToConvertToString:{accountId:e.accountId,calendarId:e.calendarId,eventId:e.id,start:f,end:p}}})};if(e.isAllDay){let e,t;try{e=(0,v().tO)(f,u||"UTC"),t=(0,v().tO)(p,u||"UTC")}catch(h){return void g()}s={isAllDay:!0,start:{date:e},end:{date:t}}}else{const e=a().ou.fromISO(f,{zone:u}),t=a().ou.fromISO(p,{zone:m});if(!e.isValid||!t.isValid)return void g();s={isAllDay:!1,start:{dateTime:f,timeZone:u},end:{dateTime:p,timeZone:m}}}return{...e,...s,color:(0,d().hc)({colorId:e.colorId,colorType:"event"})}}(e))).filter(c().$K)}function S(e){if(e)return a().kI.normalizeZone(e).isValid?e:void 0}function y(e){let{events:t,updatedCalendarAndAccountIds:n,newEvents:a,calendars:o}=e;const i=new Set(n.map(s().D)),c=function(e,t,n){const a=[];let r=0,o=0;for(;r<e.length&&o<t.length;){n(e[r],t[o])<=0?(a.push(e[r]),r++):(a.push(t[o]),o++)}r<e.length?a.push(...e.slice(r)):o<t.length&&a.push(...t.slice(o));return a}(t.getOrderedValues().filter((e=>!i.has((0,s().D)(e)))),[...a].sort(I(o)),I(o));return new(r().Z)(c,s().y)}function I(e){const t=t=>e.get((0,s().D)(t));return(e,n)=>f({aEvent:e,bEvent:n,aCalendar:t(e),bCalendar:t(n)})}function C(e,t){return(0,v().uw)(e,t).minus({days:1}).toISODate()}function w(e){let{events:t,getCalendarVisibility:n,calendars:a,startDate:o,endDateInclusive:c,eventFilters:d,timeZone:l}=e;const u=o.toISODate(),m=c.toISODate(),f=new(r().Z)([],(e=>{let{baseEvent:t}=e;return t.id}));for(const r of t){const e=null==a?void 0:a.get((0,s().D)(r));if(!e||!n(e)||!_({event:r,minDate:u,maxDateInclusive:m,eventFilters:d,timeZone:l}))continue;const t=f.get(r.id);if(t)t.allSquashedEvents=(0,i().mN)([...t.allSquashedEvents,r],(e=>(0,s().y)(e)));else if(r.cronSyncOriginalEventData){const e=r.cronSyncOriginalEventData.eventId,t=f.get(e);t&&(t.allSquashedEvents=(0,i().mN)([...t.allSquashedEvents,r],s().y))}else f.append(r.id,{baseEvent:r,allSquashedEvents:[r]})}const p=new(r().Z)((0,v().WU)(u,m,l).map((e=>({date:e,allDayEvents:[],timedEvents:[]}))),(e=>{let{date:t}=e;return t}));for(const{baseEvent:r,allSquashedEvents:i}of f.getOrderedValues())if(r.isAllDay){const e=(0,v().YS)({eventStartDate:r.start.date,eventEndDateInclusive:C(r.end.date,l),minDate:u,maxDateInclusive:m,timeZone:l});for(const t of e){const e=p.get(t);e&&e.allDayEvents.push({baseEvent:r,allSquashedEvents:i})}}else{const e=(0,v().tO)(r.start.dateTime,l),t=p.get(e);if(!t)continue;t.timedEvents.push({baseEvent:r,allSquashedEvents:i})}return p.getOrderedValues()}function _(e){let{event:t,minDate:n,maxDateInclusive:a,eventFilters:r,timeZone:o}=e;if(function(e){switch(e.responseStatus){case"declined":return!0;case"needsAction":case"tentative":case"accepted":case void 0:return!1;default:(0,c().t1)(e.responseStatus)}}(t))return!1;if(!(0,l().S)({event:t,eventFilters:r}))return!1;const{start:i,end:d}=function(e,t){return e.isAllDay?{start:e.start.date,end:C(e.end.date,t)}:{start:(0,v().tO)(e.start.dateTime,t),end:(0,v().tO)(e.end.dateTime,t)}}(t,o);return!(i>a||d<n)&&(0,l().S)({event:t,eventFilters:r})}function V(e){return[...e.allDayEvents,...e.timedEvents]}function x(e,t,n){return function(e,t){const n=e.isAllDay?e.end.date:e.end.dateTime;return a().ou.fromISO(n,{zone:t})}(e,n)<t}},936146:(e,t,n)=>{function a(e){return"string"==typeof e?e:"calendarId"in e?`${e.accountId}:${e.calendarId}`:`${e.accountId}:${e.id}`}function r(e){let{id:t,accountId:n,calendarId:a}=e;return`${n}:${a}:${t}`}n.d(t,{D:()=>a,y:()=>r})},787306:(e,t,n)=>{n.d(t,{ie:()=>u,$p:()=>p,$X:()=>f,qJ:()=>m,Lf:()=>v,eE:()=>g});var a=()=>n(777349),r=()=>n(619013),o=()=>n(616218),i=()=>n(983946),c=()=>n(13882);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}var l=()=>n(696459),s=()=>n(876822);const u="three_days";function m(){const e=g();return{key:e,...f(e)}}function v(){const e="one_week";return{key:e,...f(e)}}function f(e){const t=Date.now(),n=(0,a().Z)(function(e,t){if((0,c().Z)(2,arguments),"object"!==d(t)||null===t)throw new RangeError("values parameter must be an object");var n=(0,r().Z)(e);return isNaN(n.getTime())?new Date(NaN):(null!=t.year&&n.setFullYear(t.year),null!=t.month&&(n=(0,o().Z)(n,t.month)),null!=t.date&&n.setDate((0,i().Z)(t.date)),null!=t.hours&&n.setHours((0,i().Z)(t.hours)),null!=t.minutes&&n.setMinutes((0,i().Z)(t.minutes)),null!=t.seconds&&n.setSeconds((0,i().Z)(t.seconds)),null!=t.milliseconds&&n.setMilliseconds((0,i().Z)(t.milliseconds)),n)}(t,{hours:23,minutes:59,seconds:59,milliseconds:999}),p(e)-1);return{timeMin:t,timeMax:n.getTime()}}function p(e){switch(e){case"one_day":return 1;case"two_days":return 2;case"three_days":return 3;case"one_week":return 7;default:(0,l().t1)(e)}}function g(){var e;const t=null===(e=s().default.state.currentSpaceViewStore)||void 0===e||null===(e=e.getHomeCalendarConfigStore())||void 0===e||null===(e=e.getKeyStore("time_range"))||void 0===e?void 0:e.getValue();switch(t){case"one_day":case"two_days":case"three_days":case"one_week":return t;case void 0:return u;default:return(0,l().P)(t),u}}},663272:(e,t,n)=>{n.d(t,{WU:()=>o,YS:()=>r,hd:()=>l,tO:()=>c,uw:()=>i,zk:()=>d});n(821057),n(670560),n(241792);var a=()=>n(730120);function r(e){let{eventStartDate:t,eventEndDateInclusive:n,minDate:a,maxDateInclusive:r,timeZone:i}=e;const d=function(e){let{startAndEndDaysRange:t,minAndMaxDaysRange:n}=e;if(t.end<n.min)return;if(t.start>n.max)return;const{start:a,end:r}=t,{min:o,max:i}=n,c=a<o?o:a,d=r>i?i:r;return{start:c,end:d}}({startAndEndDaysRange:{start:c(t,i),end:c(n,i)},minAndMaxDaysRange:{min:c(a,i),max:c(r,i)}});if(!d)return[];const{start:l,end:s}=d;return o(l,s,i)}function o(e,t,n){const a=c(t,n);let r=c(e,n);const o=[];for(;r<=a;)o.push(r),r=i(r,n).plus({days:1}).toISODate();return o}function i(e,t){const[n,r,o]=c(e,t).split("-").map(Number);return a().ou.fromObject({year:n,month:r,day:o},{zone:t})}function c(e,t){const n=a().ou.fromISO(e,{zone:t});if(!n.isValid)throw new Error(`Invalid date string: ${e}`);return e.includes("T")?n.toISODate():e}function d(e,t){const n="en-US";return a().ou.fromISO(e,{zone:"UTC"}).setLocale(n).toLocaleString(a().ou.DATE_SHORT)===t.setLocale(n).toLocaleString(a().ou.DATE_SHORT)}function l(e,t,n){const a=i(e,n);return i(t,n).diff(a,"days").days}},350777:(e,t,n)=>{n.d(t,{tX:()=>f,b$:()=>v,vL:()=>V,i_:()=>y,WM:()=>C,Fo:()=>h,XN:()=>g,F3:()=>p,$z:()=>b,Yb:()=>w,bl:()=>S,Qg:()=>I});n(267602),n(653476),n(241792);var a=()=>n(594546),r=()=>n(824462);function o(e,t){r().callApi({eventName:"calendarTrack",environment:e,data:t})}var i=()=>n(876822),c=()=>n(546155),d=()=>n(966266),l=()=>n(787306),s=()=>n(588331);function u(e){let{state:t,calendars:n,event_filters:a,mirror_calendars:r,time_range:o,bot_id:i}=e;return{state:t,calendars:n,event_filters:a&&{all_day_events:a.all_day_events,events_without_participants:a.events_without_participants,events_without_location:a.events_without_location},mirror_calendars:r,time_range:o,bot_id:i}}function m(e){let{event_id:t,calendar_id:n,account_id:a,is_all_day:r,has_participants:o,conferencing_type:i,index:c,num_days_in_future:d}=e;return{event_id:t,calendar_id:n,account_id:a,is_all_day:r,has_participants:o,conferencing_type:i,index:c,num_days_in_future:d}}function v(e){var t,n,a;const r=i().default.state.currentSpaceViewStore,o=null===(t=c().Z.getStateForCurrentSpaceView())||void 0===t?void 0:t.botId;return{state:e,calendars:r&&o&&(null===(n=c().Z.getCurrentCalendars())||void 0===n?void 0:n.map((e=>({type:e.provider,calendarId:e.id,accountId:e.accountId,isShown:(0,s().C1)({spaceViewStore:r,botId:o,calendar:e})})))),mirror_calendars:(0,s().gV)({botId:o,spaceViewStore:r}),event_filters:{all_day_events:(0,d().z)("all_day_events"),events_without_participants:(0,d().z)("events_without_participants"),events_without_location:(0,d().z)("events_without_location")},time_range:(null==r||null===(a=r.getHomeCalendarConfigStore())||void 0===a?void 0:a.getKeyStore("time_range").getValue())??l().ie,bot_id:o}}function f(e){var t;let{event:n,eventIndex:a,numDaysInFuture:r}=e;return{event_id:n.id,calendar_id:n.calendarId,account_id:n.accountId,is_all_day:n.isAllDay,has_participants:n.hasParticipants,conferencing_type:null===(t=n.conferencing)||void 0===t?void 0:t.providerName,index:a,num_days_in_future:r}}function p(e){let{environment:t,target:n,eventContext:r,calendarPanelContext:i}=e;(0,a().K4)(t,"cal_event_click",{target:n,...u(i),...m(r)}),"conferencing"===n&&i.bot_id&&o(t,{botId:i.bot_id,payload:{type:"track",payload:{event:"joinMeeting",eventId:r.event_id,calendarId:r.calendar_id,conferencingProvider:r.conferencing_type,method:"notionHomeTile"}}})}function g(e){let{environment:t,eventContext:n,calendarPanelContext:r,attachmentType:i,notionBlockId:c,attachmentIndex:d}=e;(0,a().K4)(t,"cal_event_click",{target:"attachment",attachment_type:i,attachment_index:d,notion_block_id:c,...u(r),...m(n)}),r.bot_id&&o(t,{botId:r.bot_id,payload:{type:"track",payload:{event:"eventAttachmentOpened",provider:i,location:"notionHomeTile"}}})}function h(e){const{environment:t,calendarPanelContext:n,notionAnalyticsSessionId:r}=e;(0,a().K4)(t,"cal_create_event",{...u(n)}),n.bot_id&&o(t,{botId:n.bot_id,payload:{type:"track",payload:{event:"createEventButtonClicked",notionAnalyticsSessionId:r,method:"notionHomeTile"}}})}function b(e){(0,a().K4)(e.environment,"cal_settings_menu",{action:e.action,...u(e.calendarPanelContext)})}function S(e){_({environment:e.environment,calendarPanelContext:e.calendarPanelContext,action:`toggle_${e.filter}`,value:e.newValue})}function y(e){_({environment:e.environment,calendarPanelContext:e.calendarPanelContext,action:"change_calendar_bot",value:e.botId})}function I(e){_({environment:e.environment,calendarPanelContext:e.calendarPanelContext,action:"toggle_mirroring",value:e.newValue})}function C(e){_({environment:e.environment,calendarPanelContext:e.calendarPanelContext,action:"change_time_range",value:e.newValue})}function w(e){_({environment:e.environment,calendarPanelContext:e.calendarPanelContext,action:"toggle_calendar_visibility",calendarId:e.calendarId,accountId:e.accountId,value:e.newValue})}function _(e){(0,a().K4)(e.environment,"cal_configure_view",{...u(e.calendarPanelContext),action:e.action,value:e.value,..."calendarId"in e?{calendar_id:e.calendarId}:{},..."accountId"in e?{account_id:e.accountId}:{}})}function V(e){const{environment:t,calendarPanelContext:n}=e;(0,a().K4)(t,"cal_loaded",{...u(n)}),n.bot_id&&o(t,{botId:n.bot_id,payload:{type:"page",payload:{page:"notionHomeTile"}}})}},588331:(e,t,n)=>{n.d(t,{Bv:()=>s,C1:()=>d,CX:()=>c,XT:()=>u,bU:()=>l,gV:()=>v});n(670560),n(267602),n(749411),n(228244);var a=()=>n(513670),r=()=>n(696459),o=()=>n(546155),i=()=>n(936146);function c(e){const t=function(e){let{botId:t,currentSpaceViewStore:n}=e;const a=o().Z.getCurrentCalendars()??[],r={};for(const o of a)r[(0,i().D)(o)]={calendarId:o.id,accountId:o.accountId,visible:d({spaceViewStore:n,botId:t,calendar:o})};return r}(e);return Object.values(t).flatMap((e=>{let{calendarId:t,accountId:n,visible:a}=e;return a?[{calendarId:t,accountId:n}]:[]}))}function d(e){let{spaceViewStore:t,botId:n,calendar:a}=e;return function(e){var t;let{spaceViewStore:n,botId:a,calendarId:r,accountId:o}=e;const i=null==n?void 0:n.getHomeCalendarVisibilityConfig(a);if(!i||v({spaceViewStore:n,botId:a}))return;return null===(t=i.calendarVisibility)||void 0===t||null===(t=t[o])||void 0===t?void 0:t[r]}({spaceViewStore:t,botId:n,calendarId:a.id,accountId:a.accountId})??a.selected}function l(e){let{spaceViewStore:t,botId:n,specificCalendars:a}=e;const o=t.getHomeCalendarVisibilityConfig(n);if(!o||!(0,r().$K)(null==o?void 0:o.calendarVisibility)||v({spaceViewStore:t,botId:n}))return{type:"mirrorWithCron"};const i=[];for(const[c,d]of(0,r().qP)(o.calendarVisibility??{}))for(const[e,t]of(0,r().qP)(d??{}))!(0,r().$K)(t)||a&&!a.some((t=>t.accountId===c&&t.calendarId===e))||i.push({accountId:c,calendarId:e,visible:t});return{type:"calendarOverrides",calendarOverrides:i}}function s(e){const t={};for(const{id:n,accountId:a,selected:r}of e)t[a]={...t[a],[n]:r};return t}function u(e){let{currentConfig:t,calendars:n}=e;const r=(0,a().Xh)(t)??{};let o=!1;for(const{id:a,accountId:c,selected:d}of n){var i;void 0===(null===(i=r[c])||void 0===i?void 0:i[a])&&(r[c]={...r[c],[a]:d},o=!0)}return o?{result:"updated",newConfig:r}:{result:"noChanges"}}const m=!0;function v(e){let{spaceViewStore:t,botId:n}=e;if(!t||!n)return m;const a=t.getHomeCalendarVisibilityConfig(n);return(null==a?void 0:a.mirrorWithNotionCalendar)??m}},546155:(e,t,n)=>{n.d(t,{Z:()=>i});n(267602),n(653476),n(241792);var a=()=>n(876822);class r extends(()=>n(263184))().default{getInitialState(){return{}}getCalendarMap(){var e;return null===(e=this.getStateForCurrentSpaceView())||void 0===e?void 0:e.calendars}getEvents(){var e;const t=null===(e=this.getStateForCurrentSpaceView())||void 0===e?void 0:e.events;return t?t.getOrderedValues():[]}getCalendarAndAccountIds(){const e=this.getCalendarMap();return e?e.getOrderedValues().map((e=>{let{id:t,accountId:n}=e;return{calendarId:t,accountId:n}})):[]}getStateForCurrentSpaceView(){const{currentSpaceViewStore:e}=a().default.state;if(e)return this.state[e.id]}update(e){super.update(e)}updateStateForCurrentSpaceView(e){const{currentSpaceViewStore:t}=a().default.state;t&&this.update((n=>({...n,[t.id]:e(n[t.id])})))}clearStateForCurrentSpaceView(){const{currentSpaceViewStore:e}=a().default.state;e&&this.update((t=>Object.fromEntries(Object.entries(t).filter((t=>{let[n]=t;return n!==e.id})))))}getCurrentCalendars(){var e;return null===(e=this.getStateForCurrentSpaceView())||void 0===e||null===(e=e.calendars)||void 0===e?void 0:e.getOrderedValues()}getAccount(e){var t;return null===(t=this.getStateForCurrentSpaceView())||void 0===t||null===(t=t.accounts)||void 0===t?void 0:t.get(e)}getCalendar(e){var t;return null===(t=this.getStateForCurrentSpaceView())||void 0===t||null===(t=t.calendars)||void 0===t?void 0:t.get("string"==typeof e?e:`${e.accountId}:${e.calendarId}`)}getCalendarsForAccount(e){var t;return(null===(t=this.getStateForCurrentSpaceView())||void 0===t||null===(t=t.calendars)||void 0===t?void 0:t.getOrderedValues().filter((t=>t.accountId===e)))??[]}getCurrentAccountIds(){var e;return(null===(e=this.getStateForCurrentSpaceView())||void 0===e||null===(e=e.accounts)||void 0===e?void 0:e.getOrderedValues().map((e=>e.id)))??[]}getCalendarFetchedTime(e){var t;const n="string"==typeof e?e:`${e.accountId}:${e.calendarId}`;return null===(t=this.getStateForCurrentSpaceView())||void 0===t?void 0:t.calendarsToLastFetchedTime[n]}}const o=new r;(0,n(947115).exposeDebugValue)("HomeCalendarStore",o);const i=o},360866:(e,t,n)=>{n.d(t,{Z:()=>a});n(821057),n(670560),n(267602),n(653476),n(241792);class a{get length(){return this.orderedKeys.length}constructor(e,t){if(this.orderedKeys=void 0,this.keysToValues=void 0,!e&&!t)return this.orderedKeys=[],void(this.keysToValues={});if(!e||!t)throw new Error("Missing values or keyGetter in OrderedMap constructor");this.orderedKeys=e.map(t),this.keysToValues={};for(const n of e)this.keysToValues[t(n)]=n}append(e,t){let{keepOrdering:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{keepOrdering:!1};if(e in this.keysToValues){if(this.keysToValues[e]=t,n)return;this.orderedKeys=[...this.orderedKeys.filter((t=>t!==e)),e]}else this.orderedKeys.push(e),this.keysToValues[e]=t}delete(e){this.orderedKeys=this.orderedKeys.filter((t=>t!==e)),delete this.keysToValues[e]}get(e){return this.keysToValues[e]}getOrderedValues(){return this.orderedKeys.map((e=>this.keysToValues[e]))}hasKey(e){return e in this.keysToValues}toJSON(){return this.orderedKeys.map((e=>[e,this.keysToValues[e]]))}static fromJSON(e){const t=new a;return t.orderedKeys=e.map((e=>{let[t]=e;return t})),t.keysToValues=Object.fromEntries(e),t}}}}]);