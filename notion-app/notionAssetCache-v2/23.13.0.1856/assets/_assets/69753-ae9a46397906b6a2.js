(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[69753],{145873:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});n(667294);var o=()=>n(846550),i=()=>n(314379),r=()=>n(154186),a=n(785893);function l(e){let{onClick:t,className:n,isMobile:l,style:s,onFocus:c,onBlur:d,onMouseDown:u,onMouseEnter:m,onMouseLeave:p}=e;const{buttonStyle:f,iconStyle:g}=(0,o().yK)((e=>({buttonStyle:{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,borderRadius:6,width:l?45:24,height:l?45:24,marginRight:l?-8:-6,...s},iconStyle:{width:l?18:14,height:l?18:14,fill:e.mediumIconColor}})),[l,s]);return(0,a.jsx)(r().Z,{onClick:t,style:f,className:n,mobileFeedback:l,onFocus:c,onBlur:d,onMouseDown:u,onMouseEnter:m,onMouseLeave:p,children:(0,i().o)(g)})}},953744:(e,t,n)=>{"use strict";n.d(t,{Z:()=>G});var o=n.n(n(294184)),i=n(667294),r=()=>n(219727),a=()=>n(142735),l=()=>n(846550),s=()=>n(506347),c=()=>n(788860),d=()=>n(568017),u=()=>n(513670),m=()=>n(707513),p=()=>n(8101),f=()=>n(295274),g=()=>n(308186),v=()=>n(421654),h=()=>n(497065),y=()=>n(269299),C=()=>n(285755),M=()=>n(166312),x=()=>n(900596),b=()=>n(125659),k=()=>n(41340),_=()=>n(680917),S=()=>n(421797),T=()=>n(594546),w=()=>n(247724),D=()=>n(429725),E=()=>n(527278),j=()=>n(352230),A=()=>n(802600),R=()=>n(109806),I=()=>n(471654),P=()=>n(502893),Z=()=>n(739479),L=()=>n(104088),H=()=>n(876822),V=()=>n(529048),N=()=>n(826955),U=()=>n(855238),F=()=>n(448419),K=()=>n(666414),O=()=>n(198829),B=()=>n(18748),z=()=>n(255577),Y=()=>n(384241),q=()=>n(388284),J=()=>n(765513),W=n(785893);const X=(0,c().vU)({emptyPageTitle:{defaultMessage:"Empty",id:"database.templatePicker.emptyPageTitle"}}),G=i.memo(i.forwardRef((function(e,t){const{templateStore:o,isMobile:s,isOverlay:c,isDefault:d,locked:m,canConfigureCollection:p,draggable:f,recurrence:g,recurrenceDisabled:v,recurrenceButtonDisabled:h,collectionStore:y,focused:C}=e,M=(0,r().Fy)(),x=(0,r().O7)(),[b,k]=(0,i.useState)(!1),S=(0,a().qz)(void 0,V().Z),T=!o&&!c;(0,a().VK)((()=>{if(!o)return!1;const e=o.getAutomationPointer();return!!e&&(0,n(319857).k)(o,e)}),[o]);const D=(0,a().VK)((()=>{var e;return Boolean(null===(e=y.getParentBlockStore())||void 0===e?void 0:e.canEditContentOnly())}),[y]),j=(0,a().VK)((()=>(!m||m&&!f)&&(p||D)&&(b||S.state.open||s||c)&&!T),[m,f,p,D,b,S,s,c,T]),A=(0,a().VK)((()=>!o||o.isEmptyPage()),[o]),R=(0,a().VK)((()=>{var e;return null==o||null===(e=o.getModel())||void 0===e?void 0:e.getRenderIcon({getRecordModel:y.getRecordModel})}),[o,y]),I=(0,i.useRef)(null);(0,n(98642).c)(n(884310).Z,(()=>({templateStore:o,getNode:()=>I.current})),[o]);const P=(0,l().yK)((e=>({recordIcon:{...!c&&{pointerEvents:"none",marginRight:10}},pageIcon:{...!c&&{fill:e.lightIconColor}}})),[c]),Z=(0,i.useCallback)((()=>{k(!0)}),[]),L=(0,i.useCallback)((()=>{k(!1)}),[]),H=o?(0,W.jsx)(Y().Z,{enableHover:!0,showTooltipWhenTruncated:!0,store:o}):E().Z.formatMessage(X.emptyPageTitle),N=(0,a().qz)(void 0,V().Z),U=(0,a().VK)((()=>N.state.open),[N]),F=(g||U)&&o;return(0,W.jsx)("div",{ref:I,style:{display:"contents"},children:(0,W.jsx)(n(98693).Z,{ref:t,className:w().$ji,type:o?"custom_template":"empty_page",format:c?"collection-overlay":"page-menu-item",locked:m||!p||!f,icon:(0,W.jsx)(n(943620).Z,{disabled:!0,icon:R,isEmptyPage:A,size:M.isMobile&&c?24:20,isLarge:!c,style:P.recordIcon,pageIconStyle:P.pageIcon}),title:H,onClick:e.onClick,onMouseEnter:e.onMouseEnter,right:j&&(0,W.jsxs)(n(78078).X2,{alignItems:"center",gap:2,children:[F&&(0,W.jsx)(_().q,{...u().CE(e,["onClick"]),focused:C,disabled:h,recurrence:g,showTooltip:!0,variant:"icon",buttonPopupStore:N,onChange:async e=>{const{recurrenceActions:t}=await _().s.load();e?t.addRecurrence({environment:x,blockStore:o,recurrence:e}):t.deleteRecurrence({environment:x,blockStore:o})}}),(0,W.jsx)($,{templateStore:o,buttonPopupStore:S,isOverlay:c,canEditContentOnly:D,onCancelClick:e.onCancelClick})]}),onMouseMove:Z,onMouseLeave:L,focused:C,isDefault:d,recurrence:g,recurrenceDisabled:v})})})));function $(e){const{templateStore:t,buttonPopupStore:i,isOverlay:l,canEditContentOnly:s,onCancelClick:d}=e,u=(0,r().O7)(),{isMobile:m}=(0,r().Fy)(),f=(0,a().VK)((()=>!!t&&(0,S().J5S)({environment:u,blocks:[t],publicEditMode:void 0})),[t,u]);return(0,W.jsx)(n(654133).Z,{renderTooltip:()=>f?(0,W.jsx)(c()._H,{defaultMessage:"Edit this template",id:"database.templatePickerItem.editTemplate.tooltip"}):(0,W.jsx)(c()._H,{defaultMessage:"View this template",id:"database.templatePickerItem.viewTemplate.tooltip"}),delayThreshold:300,render:e=>(0,W.jsx)(F().ZP,{popupType:m?L().k.SlideUp:L().k.Popup,placementToOrigin:F().pO.Right,originGap:12,buttonPopupStore:i,renderOrigin:t=>(0,W.jsx)(n(145873).Z,{className:o()(w().C_N,{[w().JiD]:m||l}),isMobile:m&&l,style:{...!l&&{marginRight:0}},...(0,n(164079).Z)(e,t)}),render:e=>(0,W.jsx)(Q,{templateStore:t,buttonPopupStore:i,canEditContentOnly:s,isOverlay:l,parent:e,onCancelClick:d}),onClick:()=>{p().sY(u,{template_action:"open_menu"})}})})}function Q(e){const{templateStore:t,buttonPopupStore:n,canEditContentOnly:o,isOverlay:s,parent:h,onCancelClick:w}=e,D=(0,r().O7)(),L=(0,r().Fy)(),H=(0,b().Y$)(),V=(0,i.useContext)(k().Z),{collectionStore:F,collectionViewStore:G}=(0,a().VK)((()=>({collectionStore:null==H?void 0:H.collectionStore(),collectionViewStore:null==H?void 0:H.collectionViewStore()})),[H]),$=(0,a().VK)((()=>!!t&&(0,S().J5S)({environment:D,blocks:[t],publicEditMode:void 0})),[t,D]),Q=(0,a().VK)((()=>null==t?void 0:t.getAutomationStore()),[t]),ne=(0,a().VK)((()=>null!=Q&&Q.isActive()?null==Q?void 0:Q.getRecurrence():void 0),[Q]),oe=(0,a().VK)((()=>{if(!t)return!1;const e=(0,M().wo)(t);return!e.automationStoresReady||e.violatesConstraint}),[t]),ie=(0,a().VK)((()=>{if(t){const e=(0,M().wo)(t);if(e.automationStoresReady)return e}}),[t]),re=(0,a().VK)((()=>Boolean(null==ie?void 0:ie.templateNestingExceedsMaxDepth)),[ie]),ae=(0,a().VK)((()=>null==ie?void 0:ie.immediateAncestorRecurrenceType),[ie]),le=(0,a().VK)((()=>Boolean(null==ie?void 0:ie.ancestorHasDailyTemplate)),[ie]),se=(ce={templateNestingExceedsMaxDepth:re,immediateAncestorRecurrenceType:ae,ancestorHasDailyTemplate:le,automationStore:Q,environment:D},(0,a().VK)((()=>function(e){const{templateNestingExceedsMaxDepth:t,immediateAncestorRecurrenceType:n,ancestorHasDailyTemplate:o,automationStore:i,environment:r}=e,a="disabled_duplication"===(null==i?void 0:i.getStatus())||"disabled_inactive_space"===(null==i?void 0:i.getStatus());return a&&null!=i&&i.getAlive()?(0,W.jsx)(c()._H,{defaultMessage:"This repeating template was turned off. <inlinelink>Turn on</inlinelink> with the same settings.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationCaptionDisabledDuringDuplication",values:{inlinelink:e=>(0,W.jsx)(J().Z,{external:!1,color:"notion-link-blue",hoverColor:"blue",onClick:()=>{!async function(e,t){if(!t)return;const{automationActions:n}=await C().Sm.automations.load();y().createAndCommit({userAction:"CollectionTemplatePickerItem.setAutomationStatusToActive",environment:e,canUndo:!0,perform:o=>n.enableAutomation({automationStore:t,environment:e,transaction:o})})}(r,i)},children:e})}}):o?(0,W.jsx)(c()._H,{defaultMessage:"It already gets created daily from another repeating template.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationCaptionNestedInDaily"}):t?(0,W.jsx)(c()._H,{defaultMessage:"It already gets created automatically from other repeating templates.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationCaptionTooDeeplyNested"}):n?(0,W.jsx)(c()._H,{defaultMessage:"This template is within another template that repeats every {immediateAncestorRecurrenceType}.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationCaptionNestedInTemplate",values:{immediateAncestorRecurrenceType:n}}):void 0}(ce)),[ce]));var ce;const de=(0,a().VK)((()=>null==Q?void 0:Q.isReady()),[Q]),ue=(0,l().yK)((()=>({nestingExplanationMenuItemTitle:{whiteSpace:"normal",fontWeight:m().Ue.medium,fontSize:m().JB.UISmall.desktop},nestingExplanationMenuItemCaption:{whiteSpace:"normal",color:d().ZP.lightTextColor,fontWeight:m().Ue.regular,fontSize:m().JB.UISmall.desktop}})),[]),me=(0,i.useCallback)((e=>{if(!F||null==G||!G.isDefined())return;const n=null!=t&&t.id?{template_page_id:null==t?void 0:t.id}:"empty";g().vC({showCancel:!0,keepFocus:!1,message:(0,W.jsx)(c()._H,{id:"database.collectionTemplatePickerItem.setAsDefaultDialog.message",defaultMessage:"<span>Use “{pageName}” as default template when creating new pages?</span>",values:{span:e=>(0,W.jsx)("span",{children:e}),pageName:t?(0,W.jsx)(Y().Z,{store:t,style:{display:"inline"}}):E().Z.formatMessage(X.emptyPageTitle)}}),items:[{label:(0,W.jsx)(c()._H,{id:"database.collectionTemplatePickerItem.setAsDefaultDialog.setCollection",defaultMessage:"For all views in “{databaseName}”",values:{databaseName:(0,W.jsx)(Y().Z,{store:F,style:{display:"inline"}})}}),onAccept:()=>{e.close(),y().createAndCommit({environment:D,userAction:"CollectionTemplatePickerItem.handleSetAsDefault:collection",canUndo:!0,perform:e=>{v().FH({stores:[F],update:{collection_default_template:n},transaction:e}),v().FH({stores:[G],update:{collection_view_default_template:n},transaction:e})}})}},{label:(0,W.jsx)(c()._H,{id:"database.collectionTemplatePickerItem.setAsDefaultDialog.setCollectionView",defaultMessage:"Only on “{viewName}” view",values:{viewName:(0,W.jsx)(x().Z,{collectionViewName:G.getName(),collectionViewType:G.getType()})}}),onAccept:()=>{e.close(),y().createAndCommit({environment:D,userAction:"CollectionTemplatePickerItem.handleSetAsDefault:collectionView",canUndo:!0,perform:e=>{v().FH({stores:[G],update:{collection_view_default_template:n},transaction:e})}})}}]})}),[D,F,G,t]);if(!F)return null;const pe={key:"section",render:e=>(0,W.jsx)(q().Z,{...e}),items:u().oA([t&&!o&&$&&(!Q||de)&&!oe&&{key:"repeatControl",render:e=>t&&(0,W.jsx)(_().q,{...e,recurrence:ne,onChange:async e=>{const{recurrenceActions:n}=await _().s.load();e?n.addRecurrence({environment:D,blockStore:t,recurrence:e}):n.deleteRecurrence({environment:D,blockStore:t})}}),action:()=>function(e,t){T().K4(e,"recurrence_menu_open",{isConfigured:void 0!==t})}(D,ne)},s&&!o&&{key:"Set default",render:e=>(0,W.jsx)(U().Z,{...e,title:(0,W.jsx)(c()._H,{defaultMessage:"Set as default",id:"database.collectionTemplatePickerItem.actionMenu.setAsDefault"}),svg:I().z}),action:()=>me(h)},t&&{key:"Edit",render:e=>(0,W.jsx)(U().Z,{...e,title:$?(0,W.jsx)(c()._H,{defaultMessage:"Edit",id:"database.templatePickerItem.actionMenu.edit"}):(0,W.jsx)(c()._H,{defaultMessage:"View",id:"database.templatePickerItem.actionMenu.view"}),svg:$?P().H:R().c}),action:()=>function(e,t,n,o,i){if(!n)return;null==o||o(),te(n,e,i),t.reset(),p().sY(e,{template_action:"edit"})}(D,n,t,w,V)},t&&!o&&$&&{key:"Duplicate",render:e=>(0,W.jsx)(U().Z,{...e,title:(0,W.jsx)(c()._H,{defaultMessage:"Duplicate",id:"database.templatePickerItem.actionMenu.duplicate"}),svg:A().a}),action:e=>async function(e,t,n,o,i,r,a){if(!i)return;null==r||r();const{recurrenceActions:l}=await _().s.load(),{performResult:s}=y().createAndCommit({userAction:"CollectionTemplatePickerItem.duplicatedStore",environment:t,canUndo:!0,perform:o=>{const r=f().Zh({environment:t,event:e.event,collectionStore:n,templateStore:i,transaction:o});if(i.getAutomationId()){const e=N().Mz.fromBlockStore(i),n=null==e?void 0:e.getRecurrence();e&&null!=e&&e.isActive()&&n&&l.createRecurrenceInner(o,t,r,n)}return r}});s&&te(s,t,a);o.reset(),p().sY(t,{template_action:"duplicate"})}(e,D,F,n,t,w,V)},t&&!o&&$&&{key:"Delete",render:e=>(0,W.jsx)(U().Z,{...e,title:(0,W.jsx)(c()._H,{defaultMessage:"Delete",id:"database.templatePickerItem.actionMenu.delete"}),svg:Z().y}),action:$?()=>async function(e,t,n){if(!n)return;if(!(await g().gt({message:(0,W.jsx)(c()._H,{defaultMessage:"Delete this template?",id:"database.confirmDialog.templatePickerItem.deleteMessage"}),acceptLabel:(0,W.jsx)(c()._H,{defaultMessage:"Delete",id:"database.confirmDialog.templatePickerItem.deleteButton.label"})})))return;y().createAndCommit({userAction:"CollectionTemplatePickerItem.handleDelete",environment:e,canUndo:!0,perform:e=>f().R5({collectionStore:t,templateStore:n,transaction:e})}),p().sY(e,{template_action:"delete"})}(D,F,t):()=>{}},(oe||se)&&{key:"nestedTemplateExplanation",render:e=>(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(K().Z,{size:12}),(0,W.jsx)(B().ZP,{...e,style:{padding:2},titleStyle:ue.nestingExplanationMenuItemTitle,title:ee({cannotAddRecurrenceToTemplate:oe}),captionStyle:ue.nestingExplanationMenuItemCaption,caption:se})]}),action:()=>{}}])};let fe;return fe=L.isMobile?{menuType:j().o.ActionSheet}:{menuType:j().o.Popup,width:230},(0,W.jsx)(O().Z,{...fe,children:(0,W.jsx)(z().Z,{type:z().i.Vertical,initialFocus:void 0,sections:[pe]})})}function ee(e){const{cannotAddRecurrenceToTemplate:t}=e;return t&&(0,W.jsx)(c()._H,{defaultMessage:"This template can't be repeated.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationTitle"})}function te(e,t,n){const{mainEditorCurrentBlockStore:o}=H().default.state;!function(e,t,n){n?n(e):h().c4({environment:t,url:e})}(o?(0,D().ZP)({store:o,peekViewBlockId:e.id,fullyQualified:!1,pageVisitSource:s().tY.PeekOpen}):(0,D().ZP)({store:e,fullyQualified:!1,pageVisitSource:s().tY.LinkInPage}),t,n)}},98693:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var o=n(667294),i=()=>n(219727),r=()=>n(142735),a=()=>n(846550),l=()=>n(788860),s=()=>n(707513),c=()=>n(348141),d=()=>n(876822);function u(){const[e,t]=(0,o.useState)(!1),a=(0,i().O7)(),l=(0,r().VK)((()=>d().default.state.currentUserSettingsStore),[]);return[(0,r().VK)((()=>{const t=n(749826).default.checkGate({gateName:"dictation_new_page_nux"}),o=null==l?void 0:l.getSettings(),i=Boolean(null==o?void 0:o.dismissed_dictation_new_page_nux);return t&&!i&&!e}),[l,e]),(0,o.useCallback)((()=>{l&&(t(!0),c().B1({environment:a,userSettingsStore:l,dismissed:!0}))}),[a,l,t])]}(0,n(947115).exposeDebugValue)("resetDictationTooltip",(e=>{const t=d().default.state.currentUserSettingsStore;t&&c().B1({environment:e,userSettingsStore:t,dismissed:!1})}));var m=n(785893);const p=(0,n(827282).IU)("repeatDisabled",{viewBox:"0 0 16 14",svg:(0,m.jsxs)("svg",{children:[(0,m.jsx)("path",{d:"M1.11621 8.32422C0.888346 8.32422 0.69694 8.24674 0.541992 8.0918C0.391602 7.93685 0.316406 7.74772 0.316406 7.52441V6.77246C0.316406 6.08431 0.469076 5.49186 0.774414 4.99512C1.08431 4.49837 1.51953 4.11784 2.08008 3.85352C2.64518 3.58464 3.31283 3.4502 4.08301 3.4502H9.23047V1.95312C9.23047 1.76628 9.28288 1.62272 9.3877 1.52246C9.49251 1.41764 9.63607 1.36523 9.81836 1.36523C9.90495 1.36523 9.9847 1.37891 10.0576 1.40625C10.1305 1.43359 10.1966 1.47233 10.2559 1.52246L13.0107 3.83301C13.1566 3.9515 13.2272 4.09277 13.2227 4.25684C13.2227 4.4209 13.152 4.56217 13.0107 4.68066L10.2559 6.99121C10.1966 7.03678 10.1305 7.07552 10.0576 7.10742C9.9847 7.13477 9.90495 7.14844 9.81836 7.14844C9.63607 7.14844 9.49251 7.09603 9.3877 6.99121C9.28288 6.88639 9.23047 6.74284 9.23047 6.56055V5.00195H3.98047C3.34245 5.00195 2.83659 5.17741 2.46289 5.52832C2.09375 5.87923 1.90918 6.35319 1.90918 6.9502V7.52441C1.90918 7.74772 1.83171 7.93685 1.67676 8.0918C1.52181 8.24674 1.33496 8.32422 1.11621 8.32422ZM14.8906 7.54492C15.1094 7.54492 15.2962 7.6224 15.4512 7.77734C15.6061 7.92773 15.6836 8.11686 15.6836 8.34473V9.09668C15.6836 9.78483 15.5286 10.3773 15.2188 10.874C14.9134 11.3708 14.4782 11.7536 13.9131 12.0225C13.348 12.2868 12.6803 12.4189 11.9102 12.4189H6.7627V13.9229C6.7627 14.1051 6.71029 14.2464 6.60547 14.3467C6.50521 14.4515 6.36393 14.5039 6.18164 14.5039C6.09505 14.5039 6.01302 14.4902 5.93555 14.4629C5.86263 14.4355 5.79655 14.3968 5.7373 14.3467L2.98242 12.0361C2.84115 11.9222 2.77051 11.7832 2.77051 11.6191C2.77051 11.4505 2.84115 11.307 2.98242 11.1885L5.7373 8.87793C5.79655 8.8278 5.86263 8.78906 5.93555 8.76172C6.01302 8.73438 6.09505 8.7207 6.18164 8.7207C6.36393 8.7207 6.50521 8.77311 6.60547 8.87793C6.71029 8.97819 6.7627 9.12174 6.7627 9.30859V10.8604H12.0127C12.6553 10.8604 13.1611 10.6872 13.5303 10.3408C13.904 9.98991 14.0908 9.51595 14.0908 8.91895V8.34473C14.0908 8.11686 14.166 7.92773 14.3164 7.77734C14.4714 7.6224 14.6628 7.54492 14.8906 7.54492Z",fill:"#C7C6C4"}),(0,m.jsx)("path",{d:"M4 2L12 14",stroke:"white",strokeWidth:"3",strokeLinecap:"round"}),(0,m.jsx)("path",{d:"M4 2L12 14",stroke:"#C7C6C4",strokeLinecap:"round"})]})});var f=()=>n(998901),g=()=>n(944993),v=()=>n(827973),h=()=>n(78078);const y=(0,o.forwardRef)((function(e,t){const{format:n,className:o,icon:i,title:r,isDefault:a,recurrence:l,recurrenceDisabled:s,right:c,focused:d,onClick:u,onMouseMove:p,onMouseEnter:f,onMouseLeave:g,locked:v,type:h}=e;return"collection-overlay"===n?(0,m.jsx)(M,{ref:t,className:o,icon:i,format:n,title:r,isDefault:a,recurrence:l,recurrenceDisabled:s,right:c,focused:d,onClick:u,onMouseMove:p,onMouseEnter:f,onMouseLeave:g,locked:v,type:h}):"phone-modal"===n?(0,m.jsx)(x,{ref:t,icon:i,format:n,title:r,isDefault:a,recurrence:l,focused:d,onClick:u}):"horizontal-new-page"===n?"dictation"===h?(0,m.jsx)(w,{ref:t,focused:d,onClick:u,onMouseMove:p,onMouseEnter:f,onMouseLeave:g,icon:i,title:r,type:h}):(0,m.jsx)(S,{ref:t,focused:d,onClick:u,onMouseMove:p,onMouseEnter:f,onMouseLeave:g,icon:i,title:r,type:h}):"horizontal-new-page-submenu"===n?(0,m.jsx)(T,{ref:t,focused:d,onClick:u,onMouseMove:p,onMouseEnter:f,onMouseLeave:g,icon:i,title:r}):(0,m.jsx)(k,{ref:t,focused:d,onClick:u,onMouseMove:p,onMouseEnter:f,onMouseLeave:g,icon:i,format:n,title:r,isDefault:a,recurrence:l,recurrenceDisabled:s,right:c})}));function C(e){let{format:t,title:o,isDefault:i,recurrenceDisabled:r}=e;const c=(0,a().Fg)();return"collection-overlay"!==t?(0,m.jsx)(m.Fragment,{children:o}):(0,m.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o,(0,m.jsxs)("span",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i&&(0,m.jsx)("span",{style:{fontSize:12,fontWeight:s().Ue.medium,color:c.mediumTextColor},children:(0,m.jsx)(l()._H,{defaultMessage:"DEFAULT",id:"database.templatePickerMenuItem.default"})}),r&&p({width:14,height:12.25,color:n(568017).ZP.lightIconColor,marginLeft:8})]})]})}const M=(0,o.forwardRef)((function(e,t){let{className:n,icon:o,format:r,title:a,isDefault:l,recurrence:s,recurrenceDisabled:c,right:d,focused:u,onClick:p,onMouseMove:f,onMouseEnter:g,onMouseLeave:h,locked:y,type:M}=e;const x=(0,i().O7)(),{device:b}=x;return(0,m.jsx)(v().Z,{ref:t,className:n,icon:o,title:(0,m.jsx)(C,{format:r,title:a,isDefault:l,recurrence:s,recurrenceDisabled:c}),right:d,focused:u,onClick:p,onMouseMove:f,onMouseEnter:g,onMouseLeave:h,showDragHandle:!b.isMobile&&!y,dragHandleDisabled:"empty_page"===M})})),x=(0,o.forwardRef)((function(e,t){let{icon:n,format:o,title:i,isDefault:r,recurrence:a,focused:l,onClick:s}=e;return(0,m.jsx)(v().Z,{ref:t,icon:n?(0,m.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24},children:n}):null,title:(0,m.jsx)(C,{format:o,title:i,isDefault:r,recurrence:a}),focused:l,onClick:s,showDragHandle:!1})}));function b(e,t,o){const{device:i}=e;return{...n(494488).ZD,display:"flex",alignItems:"center",flexGrow:1,height:i.isMobile?36:32,fontSize:16,borderRadius:4,paddingLeft:8,marginBottom:2,color:o?t.mediumTextColor:t.lightTextColor}}const k=(0,o.forwardRef)((function(e,t){let{focused:o,onClick:l,onMouseMove:s,onMouseEnter:c,onMouseLeave:d,icon:u,format:p,title:f,isDefault:g,recurrence:v,recurrenceDisabled:h,right:y}=e;const M=(0,a().Fg)(),x=(0,i().O7)(),k=(0,n(657320).l)(),_=(0,r().VK)((()=>{const e=null==k?void 0:k.publicEditModeStore.state;return(0,n(982855).GD)(e)}),[k]);return(0,m.jsxs)(n(154186).Z,{style:b(x,M,_),hovered:o,onClick:l,onMouseMove:s,onMouseEnter:c,onMouseLeave:d,hoveredStyle:{background:M.buttonHoveredBackground,color:M.regularTextColor},pressedStyle:{background:M.buttonPressedBackground},children:[(0,m.jsx)("div",{style:{display:"flex",alignItems:"center",width:24,height:24,marginRight:10},children:u}),(0,m.jsx)(C,{format:p,title:f,isDefault:g,recurrence:v,recurrenceDisabled:h}),y&&(0,m.jsx)("div",{style:{marginLeft:"auto",marginRight:4},children:y})]})})),_=(0,l().vU)({horizontalNewPageDictationItemTooltip:{id:"TemplatePickerMenuItem.dictationCallout.tooltip",defaultMessage:"Use your voice to write"},dictationCalloutHeader:{id:"TemplatePickerMenuItem.dictationCallout.Header",defaultMessage:"Use your voice to write with high-quality speech-to-text"}}),S=(0,o.forwardRef)((function(e,t){let{focused:n,onClick:o,onMouseMove:l,onMouseEnter:c,onMouseLeave:d,icon:u,title:p,type:f,tooltipEvents:g}=e;const v=(0,i().O7)(),y=(0,a().yK)((e=>({item:{display:"flex",alignItems:"center",padding:"6px 14px 6px 10px",background:e.assistantTintedActionButtonBackground,borderRadius:100,fontSize:13,fontWeight:s().Ue.medium},moreItem:{width:32,height:32,padding:0,justifyContent:"center"},itemFocused:{background:e.tint.regular},itemFilled:{borderColor:e.tint.regular,background:e.assistantTintedActionButtonBackground},itemFilledAndFocused:{background:e.tint.regular}})),[]),C=(0,r().VK)((()=>!v.device.isMobile&&("ai"===f||"dictation"===f)),[v.device.isMobile,f]);return(0,m.jsx)("div",{ref:t,onClick:o,onMouseMove:l,onMouseEnter:c,onMouseLeave:d,...g||{},style:{...y.item,..."more"===f?y.moreItem:{},...C?y.itemFilled:{},...n?y.itemFocused:{},...C&&n?y.itemFilledAndFocused:{}},children:(0,m.jsxs)(h().X2,{gap:4,alignItems:"center",children:[u,p]})})})),T=(0,o.forwardRef)((function(e,t){let{focused:n,onClick:o,onMouseMove:i,onMouseEnter:r,onMouseLeave:l,icon:s,title:c}=e;const d=(0,a().yK)((e=>({item:{display:"flex",alignItems:"center",padding:"4px 10px 4px 8px"},itemFocused:{background:e.tint.regular}})),[]);return(0,m.jsx)("div",{ref:t,onClick:o,onMouseMove:i,onMouseEnter:r,onMouseLeave:l,style:{...d.item,...n?d.itemFocused:{}},children:(0,m.jsxs)(h().X2,{gap:8,alignItems:"center",children:[s,c]})})})),w=(0,o.forwardRef)((function(e,t){const i=(0,o.useRef)(null),[r,s]=u(),c=(0,a().yK)((e=>({tooltipContainer:{display:"flex",flexDirection:"row",gap:"6px",padding:"0px 0",alignItems:"center",marginLeft:"-4px"},badge:{background:e.accentColors.translucentGray[300],color:e.mediumInvertedTextColor,marginLeft:0,width:"fit-content"}})),[]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(n(577741).g,{shouldShow:r,calloutId:"dictation_new_page_origin_element_tooltip",children:(0,m.jsx)(n(905263).U,{style:{width:200},pointerLength:25,pointerPosition:"50%",origin:i,placementToOrigin:"top",alignmentToOrigin:f().Alignment.Center,header:(0,m.jsx)(g().Z,{style:c.badge}),content:(0,m.jsx)(l()._H,{..._.dictationCalloutHeader}),shouldDismissUponOutsideClick:!0,onCloseClick:s})}),(0,m.jsx)(n(654133).Z,{disableTooltip:r,renderTooltip:()=>(0,m.jsxs)("div",{style:c.tooltipContainer,children:[(0,m.jsx)(g().Z,{style:c.badge}),(0,m.jsx)(l()._H,{..._.horizontalNewPageDictationItemTooltip})]}),originGap:6,placement:f().Placement.Top,render:n=>(0,m.jsx)("div",{ref:i,children:(0,m.jsx)(S,{...e,ref:t,tooltipEvents:n})})})]})}))},680917:(e,t,n)=>{"use strict";n.d(t,{q:()=>r,s:()=>i});var o=()=>n(677559);const i=new(o().Ss)("recurrence",(async()=>{const[e,t,{RecurrenceConfigMenu:o}]=await Promise.all([Promise.all([n.e(62743),n.e(71896),n.e(49396),n.e(91253),n.e(5485),n.e(90653)]).then(n.bind(n,857205)),Promise.all([n.e(62743),n.e(71896),n.e(49396),n.e(91253),n.e(5485),n.e(90653)]).then(n.bind(n,157955)),Promise.all([n.e(62743),n.e(71896),n.e(49396),n.e(91253),n.e(5485),n.e(90653)]).then(n.bind(n,788171))]);return{recurrenceActions:e,recurrenceHelpers:t,RecurrenceConfigMenu:o}})),r=(0,o().iS)(i,(e=>e.RecurrenceConfigMenu))},884310:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});n(267602),n(470928);class o extends(()=>n(442))().Z{findCollectionTemplatePickerItemFromStore(e){if(e)return this.find((t=>(null==t?void 0:t.templateStore)===e))}}const i=new o},157955:(e,t,n)=>{"use strict";n.r(t),n.d(t,{DEFAULT_MAX_RECURRENCE_DUPLICATION_PER_TASK:()=>E,MAXIMUM_DAILY_RECURRENCES_IN_PATH:()=>b,MAXIMUM_NESTED_RECURRENCE_LEVEL:()=>x,MAX_RECURRENCE_INTERVAL:()=>v,MAX_RECURRENCE_NUMBER_OF_RUNS:()=>h,RRULE_WEEKDAYS_MAP:()=>g,convertFromUnpersistedRecurrenceConfig:()=>R,convertToUnpersistedRecurrenceConfig:()=>j,getFormattedEndCondition:()=>D,getFormattedNextRecurrenceTime:()=>w,getNextDateUtc:()=>T,getRecurrenceAfter:()=>_,isRunningBetweenMidnightAnd3AM:()=>S,isValidRecurrenceInterval:()=>y,isValidRecurrenceNumberOfRuns:()=>C,rruleFromRecurrence:()=>M,templateAncestorsViolateRecurrenceNesting:()=>k});n(267602),n(653476),n(241792);var o=()=>n(730120);n(670560);function i(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if(0===n.length)return e.map((e=>[e]));const r=[];for(const a of e)r.push(...i(n[0],...n.slice(1)).map((e=>[a,...e])));return r}var r=()=>n(696459),a=()=>n(326966),l=()=>n(803021),s=()=>n(646574),c=()=>n(998411),d=()=>n(578292);class u extends(()=>n(484885))().Ci{constructor(e,t){super(e,t)}after(e,t){return super.after(e,t)}}var m=()=>n(494616);const p=(0,n(788860).vU)({dateAtTime:{id:"automations.recurrenceHelpers.dateAtTime",defaultMessage:"{date} at {time}"},dateBetweenMidnightAnd3AM:{id:"automations.recurrenceHelpers.dateBetweenMidnightAnd3AM",defaultMessage:"{date} between 12–3 AM"},numberEndConditionDescription:{id:"automations.recurrenceHelpers.numberEndConditionDescription",defaultMessage:"{number, plural, one {After {number} run} other {After {number} runs}}"},noEndCondition:{id:"automations.recurrenceHelpers.noEndCondition",defaultMessage:"Never"}}),f={day:u.DAILY,week:u.WEEKLY,month:u.MONTHLY,year:u.YEARLY},g={MO:u.MO,TU:u.TU,WE:u.WE,TH:u.TH,FR:u.FR,SA:u.SA,SU:u.SU},v=99,h=999;function y(e){return(0,a().hj)(e)&&Number.isInteger(e)&&e>0&&e<=v}function C(e){return(0,a().hj)(e)&&Number.isInteger(e)&&e>0&&e<=h}function M(e){const{start_date:t,frequency:n,interval:o,weekdays:a,timezone:s,hour:c,minute:d}=e,m="week"===n&&a?a.map((e=>g[e])):void 0,p={};return(0,r().$K)(e.end_condition)&&("date"===e.end_condition.type?p.until=(0,l().pd)(e.end_condition.end_at):"number"===e.end_condition.type?p.count=e.end_condition.number_of_occurrences:(0,r().t1)(e.end_condition)),"month"===e.frequency&&(0,r().$K)(e.monthly_restriction)&&("monthdays"===e.monthly_restriction.type?p.bymonthday=e.monthly_restriction.monthdays:"weekdays_in_month"===e.monthly_restriction.type?p.byweekday=i(e.monthly_restriction.weekdays,e.monthly_restriction.week_numbers).map((e=>{let[t,n]=e;return g[t].nth(n)})):(0,r().t1)(e.monthly_restriction)),new u({freq:f[n],dtstart:(0,l().pd)(t),interval:o,byweekday:m,tzid:s,byhour:c??0,byminute:d??0,bysecond:0,...p})}const x=1,b=1;function k(e){var t;if(0===e.length)return{violatesConstraint:!1,templateNestingExceedsMaxDepth:!1,ancestorHasDailyTemplate:!1,nestedDepthOfAutomationAncestors:void 0,immediateAncestorRecurrenceType:void 0};const n=e.filter((e=>{var t;return"day"===(null===(t=e.getRecurrence())||void 0===t?void 0:t.frequency)})),o=e.length,i=null===(t=e[0].getRecurrence())||void 0===t?void 0:t.frequency,r=o>x,a=n.length>=b;return{violatesConstraint:r||a,templateNestingExceedsMaxDepth:r,ancestorHasDailyTemplate:a,nestedDepthOfAutomationAncestors:o,immediateAncestorRecurrenceType:i}}function _(e){const{recurrence:t,afterDate:n}=e;if((0,m().nA)(t)){const e=(0,l().kq)(n);return t.start_date>=e?new Date(t.start_date):void 0}{const e=M(t).after((0,l().pd)(n));if(!e)return;return(0,l().YL)(e)}}function S(e){return 0===e.hour||1===e.hour||2===e.hour}function T(e){return M(e).after((0,l().pd)((0,l().Jh)()))||void 0}function w(e){const{recurrence:t,intl:n}=e,i=T(R(t));if(!i)return;const r=S(t),a=o().ou.fromJSDate(i).toUTC().setZone("local",{keepLocalTime:!0}).setLocale((0,d().E2)(n)).setZone(t.timezone),l=(0,s().p6)({date:a,dateFormat:"relative",allowRelativeDates:!0,intl:n,shortenDate:!0});if(r)return n.formatMessage(p.dateBetweenMidnightAnd3AM,{date:l});{let e=a.toLocaleString(o().ou.TIME_SIMPLE);return t.timezone!==(0,c().r)()&&(e+=` ${a.toFormat("ZZZZ")}`),n.formatMessage(p.dateAtTime,{date:l,time:e})}}function D(e,t){return(0,r().$K)(e)?"number"===e.type?t.formatMessage(p.numberEndConditionDescription,{number:e.number_of_occurrences}):"date"===e.type?(0,s().p6)({date:o().ou.fromMillis(e.end_at),dateFormat:"relative",allowRelativeDates:!0,intl:t,shortenDate:!0}):void(0,r().t1)(e):t.formatMessage(p.noEndCondition)}const E=100;function j(e){return{...e,start_date:(0,l().kq)(e.start_date),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?{type:"date",end_at:(0,l().kq)(e.end_condition.end_at)}:(0,r().t1)(e.end_condition):void 0}}function A(e,t){const n=o().ou.fromMillis(t.end_at).set({hour:e.hour??0,minute:e.minute??0});return{type:"date",end_at:(0,l().Jh)(n.toJSDate())}}function R(e){return{...e,start_date:(0,l().Jh)(new Date(e.start_date)),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?A(e,e.end_condition):(0,r().t1)(e.end_condition):void 0}}},400939:e=>{var t=/[a-zA-Z0-9_\u0392-\u03c9\u00c0-\u00ff\u0600-\u06ff]+|[\u4e00-\u9fff\u3400-\u4dbf\uf900-\ufaff\u3040-\u309f\uac00-\ud7af]+/g;e.exports=function(e){var n=e.match(t),o=0;if(!n)return 0;for(var i=0;i<n.length;i++)n[i].charCodeAt(0)>=19968?o+=n[i].length:o+=1;return o}}}]);