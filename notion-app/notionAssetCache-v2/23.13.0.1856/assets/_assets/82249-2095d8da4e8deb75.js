"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[82249],{115699:(e,t,o)=>{o.d(t,{J:()=>Re});o(670560),o(267602),o(653476),o(470928),o(749411),o(241792),o(228244);var s=o(667294),i=()=>o(492788),n=()=>o(219727),r=()=>o(142735),l=()=>o(846550),d=()=>o(816512),a=()=>o(156642),c=()=>o(646574),u=()=>o(998411),m=()=>o(467171),p=()=>o(788860),g=()=>o(513670),f=()=>o(696459),v=()=>o(707513),y=()=>o(248825),b=()=>o(844085),S=()=>o(990966),x=()=>o(874018),h=()=>o(388573),C=()=>o(604068),M=()=>o(252100),k=()=>o(281063),j=()=>o(19029),F=()=>o(574767),I=()=>o(8208),Z=()=>o(958783),T=()=>o(141735),B=()=>o(247724),H=()=>o(670655),V=()=>o(527278),w=()=>o(352230),A=()=>o(191003),D=()=>o(852465),K=()=>o(832924),R=()=>o(275200),U=()=>o(550054),_=()=>o(677559),N=o(785893);const E=(0,o(827282).IU)("commentSidebarZero",{viewBox:"0 0 56 56",svg:(0,N.jsx)("path",{d:"M13.1289 47.6641C13.9297 47.6641 14.4961 47.3516 15.4141 46.5508L21.8984 40.5938C23.0703 42.4297 25.1602 43.4258 27.9922 43.4258H36.3516L42.6602 48.8164C43.5195 49.5586 44.0273 49.9492 44.7305 49.9492C45.7461 49.9492 46.332 49.2266 46.332 48.0938V43.4258H47.4453C51.8398 43.4258 54.6328 40.8281 54.6328 36.2969V24.1289C54.6328 19.5977 51.8398 17 47.4453 17H43.9688V14.793C43.9688 9.83203 41.0781 7 36.0977 7H8.87109C4.00781 7 1 9.83203 1 14.793V32.4297C1 37.4102 4.00781 40.2422 8.87109 40.2422H11.4492V45.7695C11.4492 46.9609 12.0742 47.6641 13.1289 47.6641ZM13.7539 39.2461C13.7539 38.3867 13.2266 37.9766 12.543 37.9766H9.08594C5.43359 37.9766 3.42188 36.043 3.42188 32.293V14.9492C3.42188 11.2188 5.45312 9.26562 9.08594 9.26562H35.8828C39.5156 9.26562 41.5469 11.2188 41.5469 14.9492V17H27.9922C23.4414 17 20.8047 19.5977 20.8047 24.1289V36.3164C20.8047 36.9805 20.8438 37.6055 20.9609 38.1719L13.7539 44.9883V39.2461ZM44.0859 47.2148L38.1289 41.9023C37.4844 41.3359 37.0938 41.1602 36.2344 41.1602H28.168C25.0039 41.1602 23.207 39.4805 23.207 36.1797V24.2656C23.207 20.9648 25.0039 19.2656 28.168 19.2656H47.25C50.4336 19.2656 52.2305 20.9648 52.2305 24.2656V36.1602C52.2305 39.4609 50.4336 41.1602 47.25 41.1602H45.2383C44.5938 41.1602 44.0859 41.5312 44.0859 42.3711V47.2148Z"})});var O=()=>o(472753),P=()=>o(585742),L=()=>o(163085),W=()=>o(589525),z=()=>o(590972),$=()=>o(520849),G=()=>o(876822),J=()=>o(687647),X=()=>o(908102),Y=()=>o(127519),q=()=>o(198829),Q=()=>o(255577),ee=()=>o(470386),te=()=>o(661297),oe=()=>o(842574),se=()=>o(621913),ie=()=>o(529048),ne=()=>o(749826),re=()=>o(314379),le=()=>o(547430),de=()=>o(733641),ae=()=>o(563701),ce=()=>o(793935),ue=()=>o(980316),me=()=>o(998901),pe=()=>o(104088),ge=()=>o(827973),fe=()=>o(448419),ve=()=>o(92175),ye=()=>o(388284),be=()=>o(654133),Se=()=>o(523516);const xe=["commentsAndSuggestions","comments","suggestions"],he=["unresolved","resolved"],Ce={unresolved:B().FSd,resolved:B().boI},Me=(0,p().vU)({unresolved:{id:"updateSidebar.comments.mode.unresolvedOption",defaultMessage:"Open"},resolved:{id:"updateSidebar.comments.mode.resolvedOption",defaultMessage:"Resolved"},commentsAndSuggestions:{id:"updateSidebar.comments.typeMode.commentsAndSuggestions",defaultMessage:"Any"},comments:{id:"updateSidebar.comments.typeMode.comments",defaultMessage:"Comments only"},suggestions:{id:"updateSidebar.comments.typeMode.suggestions",defaultMessage:"Suggestions only"}}),ke=(0,p().vU)({filterLabel:{id:"updateSidebar.comments.filter.label",defaultMessage:"Filter"}});function je(e,t,o,s,i){if(t)return e;const{items:n}=e;if(n.length<=6)return e;const r=[...n.slice(0,5),{key:"show more",render:e=>(0,N.jsx)(ge().Z,{...e,icon:(0,re().o)(i.showMoreResultsButton),title:(0,N.jsx)("span",{style:i.showMoreResultsButtonTitle,children:(0,N.jsx)(p()._H,{defaultMessage:"{numberMore} more results",id:"updateSidebar.comments.filter.byPerson.showMoreResultsButton.title",values:{numberMore:n.length-5}})})}),action:()=>{o(!0)}}];return{...e,items:r}}function Fe(e){let{numCommenters:t,userActorsForDisplay:o,actorForFilter:s,setActorForFilter:i,onMobileClose:r,currentCommentsMode:d,currentTypeMode:a,popupOpen:c,setPopupOpen:u,peopleFilterExpanded:m,setPeopleFilterExpanded:g}=e;const v=(0,n().O7)(),y=v.device.isMobile?(0,N.jsx)(p()._H,{defaultMessage:"By type",id:"commentFilterMenu.typeSectionMobile.title"}):(0,N.jsx)(p()._H,{defaultMessage:"Filter by type",id:"commentFilterMenu.typeSectionDesktop.title"}),b=v.device.isMobile?(0,N.jsx)(p()._H,{defaultMessage:"By status",id:"commentFilterMenu.statusSectionMobile.title"}):(0,N.jsx)(p()._H,{defaultMessage:"Filter by status",id:"commentFilterMenu.statusSectionDesktop.title"}),S=v.device.isMobile?(0,N.jsx)(p()._H,{defaultMessage:"By person",id:"commentFilterMenu.personFilterSectionMobile.title"}):(0,N.jsx)(p()._H,{defaultMessage:"Filter by person",id:"commentFilterMenu.personFilterSectionDesktop.title"}),x=(0,l().yK)((e=>({personIcon:{width:v.device.isMobile?24:20,fill:e.mediumIconColor},showMoreResultsButton:{width:16,fill:e.mediumTextColor},showMoreResultsButtonTitle:{color:e.mediumTextColor}})),[v.device.isMobile]),h={key:"typeMode",render:e=>(0,N.jsx)(ye().Z,{...e,title:y}),items:xe.map((e=>({key:e,render:t=>(0,N.jsx)(ge().Z,{...t,title:V().Z.formatMessage(Me[e]),right:(0,N.jsx)("div",{style:{width:14,opacity:a===e?1:0},children:(0,de().k)()})}),action:()=>{ce().setUpdateSidebarCommentsTypeMode(e),v.device.isMobile||u(!1)}})))},C={key:"commentFilter",render:e=>(0,N.jsx)(ye().Z,{...e,topBorder:!0,title:b}),items:he.map((e=>({key:e,render:t=>(0,N.jsx)(ge().Z,{...t,className:Ce[e],title:V().Z.formatMessage(Me[e]),right:(0,N.jsx)("div",{style:{width:14,opacity:d===e?1:0},children:(0,de().k)()})}),action:()=>{ce().setUpdateSidebarCommentsMode(e),v.device.isMobile||u(!1)}})))},M={key:"anyone",render:e=>(0,N.jsx)(ge().Z,{...e,title:(0,N.jsx)(p()._H,{defaultMessage:"Anyone",id:"commentFilterMenu.anyoneItem.title"}),icon:(0,ae().O)(x.personIcon),right:(0,N.jsx)("div",{style:{width:14,opacity:void 0===s?1:0},children:(0,de().k)()})}),action:()=>{i(void 0),v.device.isMobile||u(!1)}},k=o.map((e=>{const t=e.getActorUserId();if(t){return{key:t,render:o=>(0,N.jsx)(Se().Z,{...o,actor:e,useEmailAsTooltip:!0,right:(0,N.jsx)("div",{style:{width:14,opacity:(null==s?void 0:s.getActorUserId())===t?1:0},children:(0,de().k)()})}),action:()=>{i(e),v.device.isMobile||u(!1)}}}})).filter(f().$K),j={key:"personFilter",render:e=>(0,N.jsx)(ye().Z,{topBorder:!0,...e,title:S}),items:v.device.isMobile?[M,...k]:1===t?k:[M,...k]},F=(0,N.jsx)(Q().Z,{type:Q().i.Vertical,initialFocus:void 0,sections:[h,C,v.device.isMobile?j:je(j,m,g,0,x)]});return v.device.isMobile?(0,N.jsx)(q().Z,{menuType:w().o.Modal,scrollerStyle:{paddingBottom:0},title:(0,N.jsx)(p()._H,{defaultMessage:"Filter",id:"commentFilterMenu.title"}),right:(0,N.jsx)(ee().DoneMenuText,{}),onClickRight:()=>{r(),u(!1)},children:F}):F}function Ie(e){let{userActors:t,actorForFilter:o,setActorForFilter:i}=e;const a=(0,n().O7)(),c=(0,p().YB)(),u=(0,r().VK)((()=>z().default.state.expanded),[]),m=(0,r().VK)((()=>ue().Z.state.open),[]),g=(0,r().VK)((()=>{let e=[...t];return o&&!e.find((e=>e.getActorUserId()===o.getActorUserId()))&&(a.device.isMobile?i(void 0):e=[o,...e]),e.sort(((e,t)=>{const o=(0,d().$4)(c,e),s=(0,d().$4)(c,t);return o&&s?o.localeCompare(s):0})),e}),[c,o,t,a.device.isMobile,i]),[f,v]=(0,s.useState)(!1),[y,b]=(0,s.useState)(!1),[S,x]=(0,r().VK)((()=>[z().default.state.commentsMode,z().default.state.commentsTypeMode]),[]),h=(0,l().yK)((e=>({container:{display:"flex",flexDirection:"column"},toggleButton:{justifyContent:"center",display:"flex",color:e.mediumTextColor},toggleButtonContainer:{paddingRight:a.device.isMobile?0:8,display:"flex"},filterIcon:{width:a.device.isMobile?18:16,fill:o||"resolved"===S?e.icon.uiBluePrimary:e.mediumIconColor}})),[o,S,a.device.isMobile]),C=V().Z.formatMessage(ke.filterLabel);return(0,r().VK)((()=>{a.device.isMobile||u?a.device.isMobile&&!m&&(ce().setUpdateSidebarCommentsMode("unresolved"),i(void 0)):(ce().setUpdateSidebarCommentsMode("unresolved"),i(void 0),b(!1))}),[m,a.device.isMobile,i,u]),(0,N.jsx)(fe().ZP,{open:f,originGap:0,popupType:a.device.isMobile?pe().k.SlideUp:pe().k.Popup,renderOrigin:e=>(0,N.jsx)(be().Z,{...e,placement:me().Placement.Bottom,renderTooltip:()=>C,render:e=>(0,N.jsx)("div",{style:h.toggleButtonContainer,className:B().qSF,children:(0,N.jsx)(ve().Z,{...e,style:h.toggleButton,onClick:()=>{v(!0)},children:(0,le().Q)(h.filterIcon)})})}),placementToOrigin:me().Placement.Bottom,alignmentToOrigin:me().Alignment.Center,render:e=>(0,N.jsx)(Fe,{userActorsForDisplay:g,actorForFilter:o,setActorForFilter:i,onMobileClose:()=>e.close(),currentCommentsMode:S,currentTypeMode:x,popupOpen:f,setPopupOpen:v,peopleFilterExpanded:y,setPeopleFilterExpanded:b,numCommenters:t.length}),onClose:()=>{v(!1)}})}function Ze(e){let{userActors:t,actorForFilter:o,setActorForFilter:s}=e;const i=(0,l().yK)((e=>({container:{display:"flex",flexDirection:"column",borderBottom:`1px solid ${e.regularDividerColor}`},commentsHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",pointerEvents:"auto"},label:{fontSize:14,color:e.regularTextColor,fontWeight:v().Ue.medium,display:"flex",alignItems:"center",padding:"12px 12px 12px 16px"},notificationsLabel:{fontSize:v().JB.UISmall.desktop,color:e.mediumTextColor,fontWeight:v().Ue.medium},notificationsBorder:{border:`1px solid ${e.outlineButtonBorder}`,borderRadius:4,marginTop:4},notificationsContainer:{padding:"0 16px 14px"}})),[]),n=(0,r().VK)((()=>"on"===ne().default.getEligibleGroup({experimentId:"remove_updates_topbar_button_v2",defaultGroup:"control",disableExposureLogging:!0})),[]),d=(0,r().VK)((()=>G().default.state.mainEditorCurrentBlockStore),[]),a=(0,r().qz)(void 0,ie().Z);return(0,N.jsxs)("div",{style:i.container,children:[(0,N.jsxs)("div",{style:i.commentsHeader,className:B().I9j,children:[(0,N.jsx)("div",{style:i.label,children:(0,N.jsx)(p()._H,{id:"updateSidebar.header.commentsAndSuggestionsLabel",defaultMessage:"Comments & suggestions"})}),(0,N.jsx)(Ie,{userActors:t,actorForFilter:o,setActorForFilter:s})]}),n&&d&&(0,N.jsxs)("div",{style:i.notificationsContainer,children:[(0,N.jsx)("div",{style:i.notificationsLabel,children:(0,N.jsx)(p()._H,{defaultMessage:"Notify me for",id:"topbarCommentsDesktop.notifications.label"})}),(0,N.jsx)("div",{style:i.notificationsBorder,children:(0,N.jsx)(se().h,{blockStore:d,moreProminentStyling:!0,from:"comments_sidebar",buttonPopupStore:a})})]})]})}const Te=s.forwardRef((function(e,t){const{currentBlockStore:i,discussionStore:d,showAllRepliesAfterTimestamp:a,focused:c,isLast:u,location:m}=e,p=(0,r().VK)((()=>J().Z.state.open&&J().Z.state.discussionIds||[]),[]),g=(0,n().O7)();(0,s.useEffect)((()=>{var e;if(c){F().Z.setState({source:"update_sidebar",discussionIds:[d.id]});const e=setTimeout((()=>{var e;(null===(e=F().Z.state)||void 0===e||null===(e=e.discussionIds)||void 0===e?void 0:e[0])===d.id&&X().Z.markDiscussionsInteractedWith([d.id])}),1500);return()=>{clearTimeout(e)}}(null===(e=F().Z.state)||void 0===e||null===(e=e.discussionIds)||void 0===e?void 0:e[0])===d.id&&F().Z.setState({discussionIds:[]})}),[c,d,g]);const f=(0,r().VK)((()=>{var e;return(null===(e=F().Z.state)||void 0===e?void 0:e.discussionIds)||[]}),[]),v=d.id,{parentId:y,currentSpaceId:b}=(0,r().VK)((()=>({parentId:d.getParentId(),currentSpaceId:d.getSpaceId()})),[d]),S=y?o(826955).G.createChildStore(d,{table:o(396136).iU,id:y}):void 0,h=p.includes(v),C=f.includes(v),M=(0,l().yK)((e=>({discussionContainer:{paddingTop:g.device.isMobile?4:6,borderBottom:u||g.device.isMobile?void 0:`1px solid ${e.regularDividerColor}`,transition:"background 300ms ease"},replyButton:{color:e.blueColor,marginLeft:23,fontSize:14},hoveredStyle:{background:"sidebar"===m?e.hoveredDiscussionBackground:void 0},pressedStyle:{background:"sidebar"===m?e.focusDiscussionBackground:void 0},menuStyle:{marginLeft:-12,marginRight:-12,width:"calc(100% + 28px)",lineHeight:void 0,cursor:"pointer"}})),[g.device.isMobile,u,m]),{value:k}=(0,_().XJ)(x().commentsDependency);if(!k)return null;if(!S||!b)return null;const j=(0,N.jsx)("div",{className:`sidebar-discussion-${v} ${B().s$o}`,onClick:e.onClick,onMouseEnter:e.onMouseEnter,ref:t,style:{...M.discussionContainer,...C?M.hoveredStyle:{},...h?M.pressedStyle:{}},children:(0,N.jsx)(x().gU,{store:d,blockStore:i,format:k.discussionHelpers.DiscussionFormat.Sidebar,isFirst:!1,isOnly:!1,showResolveButtonByDefaultIfPossible:!1,discussionLocation:"updates_sidebar",showAllRepliesAfterTimestamp:a})});return(0,N.jsx)(o(18748).ZP,{allowTextSelection:!0,title:j,style:M.menuStyle})}));function Be(e){const{firstItemId:t,ignoreFirstItemState:o}=e,s=(0,r().VK)((()=>{var e;return!o&&(null===(e=F().Z.state)||void 0===e?void 0:e.discussionIds.some((e=>e===t)))}),[t,o]),i=(0,r().VK)((()=>!o&&(J().Z.state.open&&J().Z.state.discussionIds&&J().Z.state.discussionIds.some((e=>e===t)))),[t,o]),n=(0,l().yK)((t=>({hoveredStyle:{background:"sidebar"===e.location?t.hoveredDiscussionBackground:void 0},pressedStyle:{background:"sidebar"===e.location?t.focusDiscussionBackground:void 0},basicDesktopTitleStyle:{paddingLeft:16,paddingTop:16,marginBottom:0,marginTop:0,fontSize:12,transition:"background 300ms ease"},mobileTitleStyle:{fontSize:13,fontWeight:v().Ue.medium,paddingBottom:0,textTransform:"unset",marginTop:-12}})),[e.location]);return(0,N.jsx)(ye().Z,{desktopTitleStyle:{...n.basicDesktopTitleStyle,...s?n.hoveredStyle:{},...i?n.pressedStyle:{}},mobileTitleStyle:n.mobileTitleStyle,disableDesktopPadding:!0,disableMobileBorders:!0,...e})}function He(e){const t=(0,r().VK)((()=>I().Z.state.isHovered),[]),o=(0,r().VK)((()=>I().Z.state.isActivelyComposing),[]),s=(0,l().yK)((e=>({hoveredStyle:{background:e.hoveredDiscussionBackground},pressedStyle:{background:e.focusDiscussionBackground},basicDesktopTitleStyle:{paddingLeft:16,paddingTop:16,marginBottom:0,marginTop:0,fontSize:12,transition:"background 300ms ease"},mobileTitleStyle:{fontSize:13,fontWeight:v().Ue.medium,paddingBottom:0,textTransform:"unset",marginTop:-12}})),[]);return(0,N.jsx)(ye().Z,{desktopTitleStyle:{...s.basicDesktopTitleStyle,...t?s.hoveredStyle:{},...o?s.pressedStyle:{}},mobileTitleStyle:s.mobileTitleStyle,disableDesktopPadding:!0,disableMobileBorders:!0,...e})}var Ve=()=>o(54076);const we=new(o(692304).Z),Ae=50;function De(e){let{commentsMode:t,commentsType:o,actorForFilter:s}=e;const i=(0,p().YB)(),n=(0,r().VK)((()=>(0,d().$4)(i,s)),[i,s]);return(0,N.jsx)(N.Fragment,{children:((e,t)=>{if("unresolved"===e){if("commentsAndSuggestions"===t)return s?(0,N.jsx)(p()._H,{id:"updateSidebar.commentContainer.emptyUnresolvedCommentsAndSuggestionsForUser",defaultMessage:"No open comments or suggestions from {userName}",values:{userName:n}}):(0,N.jsx)(p()._H,{id:"updateSidebar.commentContainer.emptyUnresolvedCommentsAndSuggestions",defaultMessage:"No open comments or suggestions"});if("comments"===t)return s?(0,N.jsx)(p()._H,{id:"updateSidebar.commentContainer.emptyUnresolvedCommentsForUser",defaultMessage:"No open comments from {userName}",values:{userName:n}}):(0,N.jsx)(p()._H,{id:"updateSidebar.commentContainer.emptyUnresolvedComments",defaultMessage:"No open comments"});if("suggestions"===t)return s?(0,N.jsx)(p()._H,{id:"updateSidebar.commentContainer.emptyUnresolvedSuggestionsForUser",defaultMessage:"No open suggestions from {userName}",values:{userName:n}}):(0,N.jsx)(p()._H,{id:"updateSidebar.commentContainer.emptyUnresolvedSuggestions",defaultMessage:"No open suggestions"})}else{if("commentsAndSuggestions"===t)return s?(0,N.jsx)(p()._H,{id:"updateSidebar.commentContainer.emptyResolvedCommentsAndSuggestionsForUser",defaultMessage:"No resolved comments or suggestions from {userName}",values:{userName:n}}):(0,N.jsx)(p()._H,{id:"updateSidebar.commentContainer.emptyResolvedCommentsAndSuggestions",defaultMessage:"No resolved comments or suggestions"});if("comments"===t)return s?(0,N.jsx)(p()._H,{id:"updateSidebar.commentContainer.emptyResolvedCommentsForUser",defaultMessage:"No resolved comments from {userName}",values:{userName:n}}):(0,N.jsx)(p()._H,{id:"updateSidebar.commentContainer.emptyResolvedComments",defaultMessage:"No resolved comments"});if("suggestions"===t)return s?(0,N.jsx)(p()._H,{id:"updateSidebar.commentContainer.emptyResolvedSuggestionsForUser",defaultMessage:"No resolved suggestions from {userName}",values:{userName:n}}):(0,N.jsx)(p()._H,{id:"updateSidebar.commentContainer.emptyResolvedSuggestions",defaultMessage:"No resolved suggestions"})}})(t,o)})}function Ke(e){K().default.UpdateSidebarCommentScroller=e}function Re(e){const{timeViewed:t,location:o}=e,d=(0,n().O7)(),se=(0,n().Fy)(),[ie,ne]=(0,s.useState)(!1),[re,le]=(0,s.useState)(void 0),de=(0,r().VK)((()=>G().default.state.mainEditorCurrentBlockStore),[]),ae=(0,r().VK)((()=>d.currentUser.id),[d]),{value:ce}=(0,_().XJ)(x().commentsDependency),ue=(0,r().VK)((()=>ce?ce.discussionHelpers.getDiscussionsForSidebar({blockStore:de,currentUserId:ae,ignoreAfterTime:t}):[]),[ce,de,t,ae]),me=(0,r().VK)((()=>z().default.state.commentsMode),[]),pe=(0,r().VK)((()=>z().default.state.commentsTypeMode),[]),ge=(0,r().VK)((()=>(0,W().vK)(d)),[d]),fe=(0,r().VK)((()=>{const e=("comments"===pe||"commentsAndSuggestions"===pe)&&"unresolved"===me,t=(Z().default.hasContent()||I().Z.state.isActivelyComposing)&&Z().default.isDraftCommentOnValidSelection();return(ge||se.isMobile)&&t&&e&&Z().default.ifPropertyCommentShouldDisplay()}),[me,pe,se.isMobile,ge]),ve=(0,r().VK)((()=>J().Z.state.open&&J().Z.state.discussionIds||[]),[]),ye=(0,r().VK)((()=>{const e="commentsAndSuggestions"===pe?ue:ue.filter((e=>e.getType()===z().IT[pe])),{resolved:t,unresolved:o}=(0,D().bB)(e);return"unresolved"===me?o:t}),[ue,pe,me]),be=ye.map((e=>e.id)),Se=(0,r().VK)((()=>re?ye.filter((e=>(0,D().D4)(e).map((e=>e.getCreatedById())).some((e=>e===re.getActorUserId())))):ye),[ye,re]),xe=(0,r().VK)((()=>(0,j().getSetOfUsersInDiscussions)(ye)),[ye]);(0,s.useEffect)((()=>{if("popup"===o&&ie)return()=>{X().Z.markDiscussionsInteractedWith(be)}}),[o,be,ie]);const he=(0,l().yK)((e=>({commentsEmptyStyle:{flex:1,display:"flex",gap:11,alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",fontSize:14,position:"relative",background:e.contentBackground,marginRight:0,pointerEvents:"auto",paddingTop:10},commentsContainerMessage:{fontWeight:v().Ue.semibold,color:e.mediumTextColor},commentsContentStyle:{position:"relative",minHeight:0,display:"flex",flexDirection:"column",background:e.contentBackground,marginRight:0,pointerEvents:"auto",height:"100%"},commentsIconStyle:{height:54,width:54,fill:e.mediumIconColor},addCommentButton:{borderRadius:6},scrollerStyle:{flexGrow:1,minHeight:0,transform:"translateZ(0px)",zIndex:1,overflow:"hidden auto",marginBottom:0}})),[]),Ce=(0,s.useRef)(null),Me=(0,r().VK)((()=>{if(!ce)return{};const e=g().vM(Se,(e=>{const o=ce.discussionHelpers.getLatestRelevantComment({recordStore:e,currentUserId:ae,timestamp:t});return o?(0,c().$6)(o.getCreatedTime()):""}));return delete e[""],e}),[ce,Se,t,ae]),ke=(0,r().VK)((()=>!ce||ce.discussionHelpers.anyDiscussionCommentsLoading(Se)),[ce,Se]),je=(0,r().VK)((()=>{if(se.isMobile)return!1;if("suggestions"===pe||"resolved"===me)return!1;if(null==de||!de.canComment())return!1;if(Se.length>0)return!1;const e=Y().default.getRootBlockStoreOfSelection();return!!(e&&"page"!==e.getType()||"section_hide"!==(0,H().uX)())}),[se.isMobile,pe,me,de,Se.length]),Fe=(0,s.useCallback)((async()=>{const e=Y().default.getRootBlockStoreOfSelection(),t=e&&"page"!==e.getType()&&!e.isEmptyTitle()?"block":"page";switch(y().Tw(d,{target:t}),t){case"block":b().Zv({animate:!0}),await i().default.afterNextFlush();const o=await T().F.formulas.load();return void(e&&function(e){const{environment:t,blockStore:o,formulasModule:s}=e,i=o.getModel();if(!o.isDefined()||null==i||!i.isType(a().eh))return;const n=o.getTitleStore(),r=n&&(0,U().x0)(n);if(!(n&&r&&r.endIndex>0))return;(0,C().WD)({environment:t,blockStore:o,multiSelection:(0,A().TD)({store:n,selection:{startIndex:0,endIndex:r.endIndex}}),rect:O().R.getRect(o),from:"updates_sidebar",formulasModule:s})}({environment:d,blockStore:e,formulasModule:o}));case"page":if(await i().default.afterNextFlush(),!1===Z().default.state.open&&Z().default.setState({open:!1,rect:new DOMRect,from:"updates_sidebar"}),!de)return;return L().Z.openNewPageDiscussionInput(de),await i().default.afterNextFlush(),void function(e){const{blockStore:t}=e;if(!t)return;const o=P().W.find((e=>e.getBlockStore().id===t.id));if(!o)return;const s=o.getNode(),n=o.getInputStore();if(!s)return;b().bx({element:s,scrollerContext:{verticalScroller:K().default.PageScroller,horizontalScroller:void 0},animate:!0,vertical:{reveal:"closest"},horizontal:void 0}),z().default.setState({...z().default.state,expanded:!1}),i().default.afterNextFlush((()=>{S().setSelectionAtEnd({store:n.state.textStore})}))}({blockStore:de});default:(0,f().t1)(t)}}),[d,de]);(0,s.useEffect)((()=>{ie||ke||ne(!0)}),[ie,ke]);const Re=(0,s.useCallback)((()=>{I().Z.setHoverWithSource("comments_pane"),F().Z.reset()}),[]),Ue=(0,s.useCallback)((()=>{I().Z.resetHoverSource("comments_pane")}),[]),_e=(0,r().VK)((()=>I().Z.state.isActivelyComposing),[]);if(!de||!Me||!ie)return(0,N.jsx)(Ve().B,{areaHeight:window.innerHeight});const Ne=(0,c().$6)(Date.now()),Ee=Object.keys(Me).sort().reverse();!fe||0!==Ee.length&&Ee.includes(Ne)||Ee.unshift(Ne);const Oe=Ee.map(((e,s)=>{const i=(0,c().ZV)({value:{type:"date",start_date:e},date_format:"relative",userTimeZone:(0,u().r)(),intl:V().Z.getIntl(),allowRelativeDates:!0}),n=Me[e],r=fe&&e===Ne,l=[];r&&l.push({key:"draft-discussion-in-comments-pane",render:e=>(0,N.jsx)(k().Z,{environment:d,shouldShowBottomDividerLine:!(1===Ee.length&&0===(null==n?void 0:n.length)),menuListItemProps:e,shouldExpandDiscussionWidth:!0,onMouseEnter:Re,onMouseLeave:Ue}),action:()=>{const e=Z().default.getDiscussionInputStore();e&&(I().Z.setActiveWithSource("comments_pane"),J().Z.reset(),(0,M().U)({currentBlockStore:de,discussionInputStore:e,environment:d,dontAffectCursor:_e,animateScroll:!0}))}});const a=n?n.map(((e,i)=>{const l=e.getRecordStoreUIParent()??de,a={key:e.id,render:d=>(0,N.jsx)(Te,{...d,currentBlockStore:l,discussionStore:e,isFirstInSection:0===i&&!r,location:o,isLast:i===n.length-1&&s===Ee.length-1,showAllRepliesAfterTimestamp:t}),action:()=>{_e&&I().Z.resetAllActiveSources(),h().Ri({discussionStore:e,currentBlockStore:de,environment:d,analyticsFrom:"updates_sidebar",currentEl:Ce.current})}};return a})):[];return l.push(...a),{key:e,render:e=>r?(0,N.jsx)(He,{title:i,...e}):(0,N.jsx)(Be,{title:i,firstItemId:n[0].id,location:o,ignoreFirstItemState:r,...e}),items:l}})),Pe=Oe.flatMap((e=>e.items)).findIndex((e=>ve.includes(e.key.toString()))),Le=0!==Se.length||fe?(0,N.jsx)(oe().Z,{type:$().Z.Y,style:he.scrollerStyle,className:B().Xsh,ref:Ke,children:(0,N.jsx)(Q().Z,{disableKeyboard:!0,store:we,type:Q().i.Vertical,initialFocus:Pe>=0?Pe:void 0,scrollElIntoView:e=>{if(e instanceof Element){const t=e.getBoundingClientRect(),o=m().R6(d.device.isElectronMac),s=window.innerHeight,i=o+Ae,n=s-i;if(t.height>=n)return;const r=t.top>=i&&t.top<=s,l=r&&t.bottom>=s,a=t.bottom>=i&&t.bottom<=s,c=a&&t.top-i<0,u=r||a,p=.4*t.height;l&&Math.abs(t.top-s)<p?(0,R().Wr)(e,{edgeDist:s-t.height-i,animate:!0}):c&&Math.abs(t.bottom-i)<p?(0,R().Wr)(e,{edgeDist:0,animate:!0}):u||(0,R().Wr)(e,{edgeDist:0,animate:!0})}},sections:Oe})}):(0,N.jsx)("div",{style:he.commentsContentStyle,children:(0,N.jsxs)("div",{style:he.commentsEmptyStyle,children:[E(he.commentsIconStyle),(0,N.jsx)("div",{style:he.commentsContainerMessage,children:(0,N.jsx)(De,{commentsMode:me,commentsType:pe,actorForFilter:re})}),je&&(0,N.jsx)(te().Z,{onClick:Fe,style:he.addCommentButton,children:(0,N.jsx)(p()._H,{id:"updateSidebar.commentContainer.emptyCommentsButton",defaultMessage:"Add comment"})})]})});return d.device.isMobile?(0,N.jsx)(q().Z,{menuType:w().o.Modal,scrollerStyle:{paddingBottom:0},title:(0,N.jsx)(p()._H,{defaultMessage:"Comments & suggestions",id:"topbarMobile.commentsAndSuggestionsMenu.title"}),left:(0,N.jsx)(Ie,{userActors:xe,actorForFilter:re,setActorForFilter:le}),leftOuterStyle:{position:"relative",marginLeft:-4,paddingRight:4},right:(0,N.jsx)(ee().DoneMenuText,{}),onClickRight:e.onMobileClose,children:Le}):(0,N.jsxs)("div",{style:he.commentsContentStyle,ref:Ce,children:[(0,N.jsx)(Ze,{userActors:xe,actorForFilter:re,setActorForFilter:le}),Le]})}},787356:(e,t,o)=>{o.d(t,{t:()=>s().t});var s=()=>o(394480)},621913:(e,t,o)=>{o.d(t,{h:()=>C});o(267602),o(470928),o(241792);var s=o(667294),i=()=>o(219727),n=()=>o(142735),r=()=>o(846550),l=()=>o(707513),d=()=>o(38562),a=()=>o(253502),c=()=>o(149809),u=()=>o(448419),m=()=>o(198829),p=()=>o(92175),g=()=>o(388284),f=()=>o(352230),v=()=>o(164079),y=()=>o(787356),b=()=>o(615634),S=()=>o(326264),x=()=>o(603332),h=o(785893);function C(e){var t;const{blockStore:o,from:C,buttonPopupStore:M}=e,k=e.moreProminentStyling??!1,j=(0,i().O7)(),F=(0,n().VK)((()=>o.isPageBlock()),[o]),I=(0,n().VK)((()=>o.getFollowSettingsKey()),[o]),Z=(0,s.useCallback)((()=>{a().Z8({environment:j,pageId:o.pointer.id,isCurrentlyFollowing:(0,x().Z)(I).following,from:C})}),[o.pointer.id,j,I,C]),T=(0,n().VK)((()=>S().Zk({followSettingsKey:I,environment:j,blockStore:o,from:C})),[I,j,o,C]),B=(0,r().yK)((e=>({buttonContainer:{display:"flex",alignItems:"center",color:e.mediumTextColor,padding:k?"4px 10px":4,borderRadius:4,marginRight:k?0:4,fontSize:l().JB.UIRegular.desktop},bellIcon:{width:14,height:14,marginRight:4},chevronIcon:{marginLeft:4,width:10,height:10},spacer:{flexGrow:1},footerLabel:{padding:12,backgroundColor:e.sidebarSecondaryBackground,boxShadow:`0 -1px 0 ${e.regularDividerColor}`,marginTop:1}})),[k]),H=null===(t=T.find((e=>S().t0({key:e.action.analyticsName,userSelectedKey:I}))))||void 0===t?void 0:t.title;return F?(0,h.jsx)(u().ZP,{popupType:u().Z4.Popup,alignmentToOrigin:u().vR.End,placementToOrigin:u().pO.Bottom,sameWidthAsOrigin:k,buttonPopupStore:M,render:e=>(0,h.jsx)(m().Z,{menuType:f().o.Popup,minWidth:290,maxHeight:"50vh",children:(0,h.jsx)(c().Z,{context:{blocks:[],environment:j,publicEditMode:void 0},sections:[(0,d().$J)({key:"in-app-notifications-section",render:e=>(0,h.jsx)(g().Z,{...e}),actions:T.map((e=>e.action))})],initialFocus:void 0,onAccept:()=>e.close()})}),renderOrigin:e=>(0,h.jsxs)(p().Z,{...(0,v().Z)(e,{onClick:Z}),style:B.buttonContainer,children:[(0,y().t)(B.bellIcon),H,k&&(0,h.jsx)("div",{style:B.spacer}),(0,b().i)(B.chevronIcon)]})}):null}},394480:(e,t,o)=>{o.d(t,{t:()=>i});o(667294);var s=o(785893);const i=(0,o(827282).IU)("bell",{viewBox:"0 0 16 16",svg:(0,s.jsx)("path",{d:"M1.36914 11.7627C1.36914 12.3369 1.80664 12.7266 2.51074 12.7266H5.32031C5.38184 14.0322 6.44824 15.2285 8 15.2285C9.55176 15.2285 10.6182 14.0391 10.6797 12.7266H13.4893C14.2002 12.7266 14.6309 12.3369 14.6309 11.7627C14.6309 11.0381 13.9678 10.416 13.3457 9.81445C12.8672 9.34277 12.751 8.39941 12.6621 7.46289C12.5732 4.87207 11.8213 3.14258 10.0371 2.49316C9.77734 1.59082 9.01855 0.900391 8 0.900391C6.98145 0.900391 6.22266 1.59082 5.96289 2.49316C4.17871 3.14258 3.42676 4.87207 3.33789 7.46289C3.24902 8.39941 3.13965 9.34277 2.6543 9.81445C2.03906 10.416 1.36914 11.0381 1.36914 11.7627ZM3.00293 11.4756V11.3936C3.18066 11.1953 3.57715 10.833 3.91211 10.4434C4.38379 9.90332 4.60254 8.92578 4.6709 7.62695C4.75293 4.85156 5.60059 3.92871 6.70801 3.62793C6.87207 3.58691 6.96777 3.50488 6.98145 3.32031C7.01562 2.62305 7.39844 2.1582 8 2.1582C8.60156 2.1582 8.99121 2.62305 9.01855 3.32031C9.03223 3.50488 9.12793 3.58691 9.29883 3.62793C10.3994 3.92871 11.2539 4.85156 11.3291 7.62695C11.3975 8.92578 11.623 9.90332 12.0879 10.4434C12.4297 10.833 12.8125 11.1953 12.9834 11.3936V11.4756H3.00293ZM6.6123 12.7266H9.3877C9.33984 13.5811 8.7793 14.1348 8 14.1348C7.22754 14.1348 6.66699 13.5811 6.6123 12.7266Z"})})},742922:(e,t,o)=>{o.d(t,{y:()=>i});o(667294);var s=o(785893);const i=(0,o(827282).IU)("codeFile",{viewBox:"0 0 23 24",svg:(0,s.jsx)("path",{d:"M4.195 11.86c0-.266.078-.488.235-.665.156-.182.38-.3.672-.351.494-.089.849-.271 1.062-.547.214-.281.32-.73.32-1.344V6.961c0-1.115.263-1.938.79-2.469.525-.536 1.333-.804 2.421-.804.203 0 .375.023.516.07.177.057.31.146.398.265a.646.646 0 01.141.422c0 .339-.148.558-.445.657a1.14 1.14 0 01-.157.039l-.171.015c-.625.047-1.066.222-1.32.524-.256.302-.384.8-.384 1.492v2.414c0 .672-.182 1.198-.546 1.578-.36.38-.86.604-1.5.672-.032 0-.047.013-.047.039.005.02.02.034.047.04.64.062 1.14.283 1.5.663.364.38.546.906.546 1.578v2.414c0 .693.128 1.19.383 1.492.255.303.696.48 1.32.532.053 0 .1.002.141.008l.133.03c.333.09.5.308.5.657a.68.68 0 01-.14.43.816.816 0 01-.407.273 1.48 1.48 0 01-.437.063c-1.12 0-1.948-.266-2.485-.797-.531-.526-.797-1.352-.797-2.477V14.79c0-.614-.106-1.062-.32-1.344-.213-.28-.568-.463-1.062-.547-.292-.062-.516-.182-.672-.359-.157-.177-.235-.404-.235-.68zm15.602 0c0 .275-.078.502-.235.68-.156.176-.382.296-.68.358-.5.084-.856.266-1.07.547-.208.282-.312.73-.312 1.344v1.992c0 1.125-.266 1.95-.797 2.477-.531.531-1.36.797-2.484.797-.151 0-.297-.021-.438-.063a.757.757 0 01-.414-.265.715.715 0 01-.133-.438c0-.182.042-.328.125-.437a.674.674 0 01.383-.22l.117-.03c.047-.006.097-.008.149-.008.625-.052 1.065-.23 1.32-.532.255-.302.383-.799.383-1.492v-2.414c0-.672.182-1.208.547-1.61.364-.405.864-.616 1.5-.632.026-.005.039-.018.039-.039 0-.026-.013-.04-.04-.04-.635-.015-1.135-.226-1.5-.632-.364-.406-.546-.945-.546-1.617V7.172c0-.693-.128-1.193-.383-1.5-.255-.307-.695-.48-1.32-.516l-.18-.015a1.233 1.233 0 01-.148-.04c-.297-.109-.446-.328-.446-.656 0-.166.045-.307.133-.422a.777.777 0 01.414-.265c.14-.047.31-.07.508-.07 1.089 0 1.896.268 2.422.804.526.531.789 1.354.789 2.469v1.992c0 .615.107 1.06.32 1.336.214.276.568.461 1.063.555.297.052.523.169.68.351a.967.967 0 01.234.664z"})})}}]);