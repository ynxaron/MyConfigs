"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[6215],{274213:(e,t,i)=>{i.r(t),i.d(t,{ActivityNotification:()=>po,NotificationTypeToComponent:()=>fo});var o=i(667294),r=()=>i(219727),n=()=>i(142735),a=()=>i(59438),s=()=>i(799891),d=()=>i(542973),l=()=>i(712910),c=(i(492176),i(7961),()=>i(846550)),u=()=>i(217388),g=()=>i(506347),m=()=>i(548347),h=()=>i(396136),v=()=>i(255933),p=()=>i(306164),f=()=>i(989478),y=()=>i(788860),b=()=>i(696459),x=()=>i(707513),S=()=>i(509417),A=()=>i(104822),j=()=>i(527278),_=()=>i(613119),C=()=>i(466970),M=()=>i(763589),k=()=>i(826955),R=()=>i(646574),K=()=>i(578292),V=()=>i(513670),w=()=>i(603274),I=()=>i(932005),T=()=>i(269299),B=()=>i(247724),P=()=>i(250625),N=()=>i(949842),U=()=>i(164079),q=()=>i(176691),O=()=>i(155350),H=()=>i(762704),L=()=>i(657174),E=()=>i(156216),z=()=>i(998901),Z=()=>i(745740),F=()=>i(448419),D=()=>i(1910),W=()=>i(943620),J=()=>i(384241),G=()=>i(654133),Y=()=>i(878517),$=()=>i(46335),X=i(785893);const Q=o.createContext((()=>{}));function ee(e){const{disabled:t=!1,children:i}=e,r=(0,o.useContext)(Q),n=(0,o.useCallback)((()=>{t||r(!0)}),[r,t]),a=(0,o.useCallback)((()=>{t||r(!1)}),[r,t]);return(0,X.jsx)("div",{style:{display:"contents"},onMouseEnter:n,onMouseLeave:a,children:i})}Q.displayName="NestedNotificationButtonContext";const te=0,ie=8,oe=24,re=24+oe+ie,ne="150ms ease";function ae(e){const{notification:t,children:a,rootStore:s,icon:d,isPrivate:l,onArchiveClicked:u,onUnarchiveClicked:g,onMarkAsReadClicked:m,onMarkAsUnreadClicked:v,onNotificationBodyClicked:p,navigableBlockId:f,url:y,showSnapshotButton:b,hidePageTitle:x,header:S,isFirst:A,isLast:j}=e,_=(0,r().O7)(),C=(0,r().Fy)(),M=parseInt(t.end_time),R=(0,n().VK)((()=>{const e=t.navigable_block_id;if(e)return k().t1.createChildStore(s,{table:h().iU,id:e,spaceId:s.id})}),[s,t.navigable_block_id]),K=(0,n().VK)((()=>i(105649).default.isPeekDismissableState()),[]),[V,I]=(0,o.useState)(!1),[P,U]=(0,o.useState)(!1),q=(0,o.useRef)(null),O=(0,i(981697).Z)({onLongPress:()=>{var e;return null===(e=q.current)||void 0===e?void 0:e.setOpen(!0)}}),[H,L]=(0,o.useState)(!1),z=V&&!P&&!H,D=(0,n().VK)((()=>"mentions"===i(781022).default.state.currentTab),[]),W=!t||t.read,J=C.isMobile,G=(0,n().VK)((()=>{const e=_.WindowSizeStore.state;return{left:e.paddingLeftCSS,right:e.paddingRightCSS}}),[_.WindowSizeStore]),Y=(0,c().yK)((e=>({article:{display:"flex",flexDirection:"column"},mainClickTargetButton:{display:"flex",flexDirection:"column",gap:8,paddingTop:14-te,paddingBottom:14-te,paddingLeft:J?G.left:0,paddingRight:J?G.right:0,marginTop:A?0:te,marginBottom:j?0:te,marginLeft:te,marginRight:te,transition:`background ${ne}`},mainClickTargetButtonHovered:{background:e.state.hover},headerAndAvatar:{display:"flex",paddingLeft:8-te,paddingRight:20-te,gap:ie,maxWidth:"100%"},avatarAndStatusDot:{display:"flex",gap:8,alignItems:"center",height:oe},statusDotSpacer:{width:8,flexShrink:0},privatePageBadge:{marginTop:1,marginBottom:4,marginLeft:8},children:{paddingLeft:re-te,paddingRight:20-te},divider:{height:1,backgroundColor:e.stroke.secondary},buttonPressed:{backgroundColor:V&&P?e.buttonBackground:e.state.pressed}})),[J,G.left,G.right,A,j,V,P]),$=(0,o.useCallback)((e=>{t&&(H||(!y&&t.read||p(),(0,N().ZP)({event:e,context:N().Af.NotificationClick,callback:()=>{!K||e.metaKey||e.ctrlKey||i(815532).TN({environment:_}),t.read||T().createAndCommit({userAction:"ActivityNotificationSection.handleMarkAsRead",environment:_,canUndo:!0,perform:e=>{w().$h({notification:t,rootStore:s,transaction:e,read:!0})}})}})))}),[_,H,t,p,K,s,y]),ee=(0,o.useCallback)((e=>{t&&(0,N().ZP)({event:e,context:N().Af.NotificationClick,callback:()=>{t.read?v():m(),T().createAndCommit({userAction:"InboxActionsMenu.toggleNotificationReadStatus",environment:_,canUndo:!0,perform:e=>{w().$h({notification:t,rootStore:s,transaction:e,read:!t.read})}})}})}),[_,t,m,v,s]),ae=(0,o.useCallback)((e=>{t&&(0,N().ZP)({event:e,context:N().Af.NotificationClick,callback:()=>{u(),T().createAndCommit({userAction:"InboxActionsMenu.handleArchive",environment:_,canUndo:!0,perform:e=>{w().aZ({notification:t,rootStore:s,transaction:e})}})}})}),[_,t,u,s]),se=(0,o.useCallback)((e=>{t&&(0,N().ZP)({event:e,context:N().Af.NotificationClick,callback:()=>{g(),T().createAndCommit({userAction:"Activity.handleUnarchive",environment:_,canUndo:!0,perform:e=>{w().E1({notificationId:t.id,visited:!1,rootStore:s,transaction:e})}})}})}),[_,t,g,s]),de=(0,o.useCallback)((()=>I(!0)),[]),le=(0,o.useCallback)((()=>I(!1)),[]),ue=(0,o.useId)(),ge=(0,i(76225).aE)();return(0,X.jsx)(F().ZP,{ref:q,disabled:!C.isMobile,style:ge.popup,popupType:C.isTablet?F().Z4.Popup:F().Z4.SlideUp,render:e=>(0,X.jsx)(E().PQ,{blockStore:R,notification:t,handlers:{handleUnarchive:se,handleArchive:ae,toggleNotificationReadStatus:ee},closePopup:()=>e.close()}),renderOrigin:()=>(0,X.jsx)("div",{...C.isMobile&&O,children:(0,X.jsx)("article",{style:Y.article,onMouseOver:de,onMouseLeave:le,children:(0,X.jsxs)(Q.Provider,{value:U,children:[(0,X.jsx)(ce,{notification:t,rootStore:s,isMobile:J,isHovered:V,isFirst:A,onMouseEnter:()=>L(!0),onMouseLeave:()=>L(!1),onArchiveClicked:u,onUnarchiveClicked:g,onMarkAsReadClicked:m,onMarkAsUnreadClicked:v}),(0,X.jsxs)(Z().Z,{href:y,hovered:z,ignoreLocalHoverState:!0,style:Y.mainClickTargetButton,onClick:$,hoveredStyle:Y.mainClickTargetButtonHovered,disabled:!Boolean(y),pressedStyle:Y.buttonPressed,"aria-labelledby":ue,children:[(0,X.jsxs)("div",{style:Y.headerAndAvatar,children:[(0,X.jsxs)("div",{className:B().FoE,style:Y.avatarAndStatusDot,children:[D&&!W?(0,X.jsx)(i(819792).z,{size:8}):(0,X.jsx)("div",{style:Y.statusDotSpacer}),d]}),(0,X.jsx)(he,{blockStore:R,timestamp:M,header:S,hidePageTitle:Boolean(x),hasChildren:Boolean(a),titleAriaId:ue}),b&&f&&(0,X.jsx)(ve,{timestamp:M,navigableBlockId:f,rootStore:s}),l&&!t&&(0,X.jsx)(i(116432).Z,{style:Y.privatePageBadge})]}),a&&(0,X.jsx)("div",{style:Y.children,className:B().nU_,children:a})]}),!j&&(0,X.jsx)("div",{style:Y.divider})]})})})},t.id)}const se=12-te,de=12-te,le="100ms ease-out";function ce(e){const{notification:t,rootStore:i,isMobile:o,isHovered:r,isFirst:n,onArchiveClicked:a,onUnarchiveClicked:s,onMarkAsReadClicked:d,onMarkAsUnreadClicked:l,onMouseEnter:u,onMouseLeave:g}=e,m=(0,c().yK)((()=>({container:{display:"flex",alignItems:"flex-start",position:"relative",zIndex:1},body:{transition:`opacity ${le}`,opacity:o||r?1:0,position:"absolute",right:se,top:de+(o?-3:0)+(n?0:te)}})),[o,r,n]);return t?(0,X.jsx)("div",{style:m.container,onMouseEnter:u,onMouseLeave:g,children:(0,X.jsx)("div",{style:m.body,children:(0,X.jsx)(L().lD,{notification:t,rootStore:i,onArchiveClicked:a,onUnarchiveClicked:s,onMarkAsReadClicked:d,onMarkAsUnreadClicked:l})})}):null}const ue=14,ge=12,me=3;function he(e){const{blockStore:t,timestamp:i,hidePageTitle:a,header:s,hasChildren:d,titleAriaId:l}=e,u=(0,r().Fy)().isMobile,g=!a,[m,h]=(0,o.useState)(!1),[v,p]=(0,o.useState)(!1),f=(0,q().IS)(i,{useUltraCompactFormat:!0}),y=(0,q().uy)(i),b=(0,n().VK)((()=>{var e;if(t)return null===(e=t.getModel())||void 0===e?void 0:e.getRenderIcon({getRecordModel:t.getRecordModel})}),[t]),S=(0,n().VK)((()=>!!t&&t.isEmptyPage()),[t]),A=(0,n().VK)((()=>null==t?void 0:t.isDefined()),[t]),j=(0,o.useCallback)((()=>{h(!0),p(!1)}),[]),_=V().P2((()=>{p(!0)}),200,{leading:!0}),C=(0,o.useCallback)((()=>{h(!1),p(!1),P().ZV(window,"scroll",_,!0)}),[_]),M=(0,o.useCallback)((e=>(0,X.jsx)(Y().E5,{store:t,events:e})),[t]);(0,o.useEffect)((()=>(P().lj(window,"scroll",_,!0),()=>P().ZV(window,"scroll",_,!0))),[_]);const k=(0,c().yK)((e=>({container:{display:"flex",flexDirection:"row",minWidth:0,width:"100%",marginTop:2},headerMobile:{fontSize:ue,minWidth:0},header:{display:"inline-grid",gridAutoFlow:"column",justifyContent:"space-between",fontSize:ue,minWidth:0},headlineMobile:{paddingTop:2,display:"inline",whiteSpace:"pre-wrap",wordBreak:"break-word"},headline:{flexShrink:2,whiteSpace:"pre-wrap",wordBreak:"break-word"},title:{fontSize:ue,marginTop:4,marginBottom:d?8:4},time:{display:"flex",fontSize:ge,color:e.lightTextColor,whiteSpace:"nowrap",...u&&{display:"inline"},paddingLeft:6,marginTop:ue-ge},headerAndPageTitle:{display:"flex",flex:1,flexDirection:"column",gap:me,minWidth:0},pageTitleMockedButton:{maxWidth:"fit-content",display:"flex",alignItems:"center",gap:4,borderRadius:3,paddingTop:2,paddingBottom:2,paddingLeft:3,paddingRight:5,marginTop:-2,marginBottom:-2,marginLeft:-3,marginRight:-5,background:m&&A?e.state.hover:void 0},recordTitle:{fontSize:14,fontWeight:x().Ue.medium},recordPath:{color:e.regularInvertedTextColor}})),[d,u,m,A]),R=!0!==v&&void 0;return(0,X.jsxs)("div",{style:k.container,children:[(0,X.jsxs)("div",{style:k.headerAndPageTitle,children:[(0,X.jsxs)("div",{style:u?k.headerMobile:k.header,children:[(0,X.jsx)("div",{style:u?k.headlineMobile:k.headline,className:B().NFf,id:l,children:s}),(0,X.jsx)("div",{style:k.time,className:B().CZG,children:(0,X.jsx)($().Z,{text:f,tooltipText:y,icon:O().C})})]}),t&&g&&(0,X.jsx)(ee,{disabled:!A,children:(0,X.jsx)(G().Z,{originGap:3,disableTooltip:!A,alignment:z().Alignment.Start,placement:z().Placement.Bottom,renderTooltip:M,closeDelay:0,noStyle:!0,textWrap:!0,forceVisibleState:R,render:e=>(0,X.jsxs)("div",{style:k.pageTitleMockedButton,...(0,U().Z)(e,{onMouseEnter:j,onMouseLeave:C}),children:[(0,X.jsx)(W().Z,{disabled:!0,icon:b,isEmptyPage:S,size:16}),(0,X.jsx)(J().Z,{store:t,style:k.recordTitle,underline:!0})]})})})]}),u&&(0,X.jsx)("div",{style:{width:E().b8-se,flexShrink:0}})]})}function ve(e){const{timestamp:t,navigableBlockId:i,rootStore:o}=e,n=(0,r().O7)();if(t<new Date("2018-10-26").getTime())return null;const a=j().Z.getIntl().formatMessage({defaultMessage:"View version for this update",id:"activitySection.viewVersionForUpdate.tooltip"}),s=()=>{const e=k().G.createChildStore(o,{table:h().iU,id:i});I().jN({environment:n,blockStore:e,openSnapshotNearTimestamp:t.toString(),from:"activity"})};return(0,X.jsx)(G().Z,{renderTooltip:()=>a,render:e=>(0,X.jsx)(D().Z,{ariaLabel:a,onClick:s,icon:H().J,...e})})}function pe(e){const{children:t}=e,i=(0,c().yK)((e=>({container:{borderRadius:"100%",display:"flex",flexShrink:0,justifyContent:"center",alignItems:"center",height:oe,width:oe,backgroundColor:e.surface.elevated,borderWidth:1,borderStyle:"solid",borderColor:e.stroke.secondary},icon:{height:16,width:16,fill:e.icon.secondary}})),[]);return(0,X.jsx)("div",{style:i.container,children:t})}const fe=o.memo(ae);var ye=()=>i(777346);const be=function(e){const{accessRequestStore:t,teamStore:o}=e,a=(0,r().O7)(),s=(0,y().YB)(),{isRequestResolved:d,resolvedStatus:l,resolvedTime:u}=(0,n().VK)((()=>({isRequestResolved:t.isResolvedTeamMembershipRequest(),resolvedStatus:t.getStatus(),resolvedTime:t.getResolvedTime()})),[t]),g=(0,n().VK)((()=>{const e=t.getResolvedById();if(!e)return;const i=k().U6.createChildStore(t,{table:f().KJ,id:e});return i?i.getDisplayName(s):void 0}),[t,s]),m=async e=>{await i(223248).ow({environment:a,teamStore:o,accessRequestStore:t,status:e})},h=(0,c().yK)((e=>({container:{display:"flex",alignItems:"center"},redesignedContainer:{display:"flex",alignItems:"center",fontSize:14,color:e.mediumTextColor},approveButton:{height:26,paddingLeft:8,paddingRight:8,fontSize:12,marginRight:10,fontWeight:500,boxShadow:e.plainButtonBoxShadow,color:e.regularTextColor},declineButton:{height:26,paddingLeft:8,paddingRight:8,color:e.regularTextColor}})),[]);return(0,X.jsx)("div",{style:h.container,children:d?(0,X.jsx)("div",{style:h.redesignedContainer,children:"approved"===l?(0,X.jsx)(y()._H,{defaultMessage:"Approved by {grantedBy} on {resolvedTime}",id:"approveTeamMembershipActivityButton.requestApprovedWithTime.title",values:{grantedBy:g,resolvedTime:(0,R().Yx)(Math.min(u??0,Date.now()),"medium_with_time",(0,K().E2)(s))}}):(0,X.jsx)(y()._H,{defaultMessage:"Denied by {grantedBy} on {resolvedTime}",id:"approveTeamMembershipActivityButton.requestDeniedWithTime.title",values:{grantedBy:g,resolvedTime:(0,R().Yx)(Math.min(u??0,Date.now()),"medium_with_time",(0,K().E2)(s))}})}):(0,X.jsxs)("div",{children:[(0,X.jsx)(ee,{children:(0,X.jsx)(ye().Z,{style:h.approveButton,onClick:()=>m("approved"),children:(0,X.jsx)(y()._H,{defaultMessage:"Approve",id:"approveTeamMembershipActivityButton.approveButton.label"})})}),(0,X.jsx)(ee,{children:(0,X.jsx)(ye().Z,{style:h.approveButton,onClick:()=>m("rejected"),children:(0,X.jsx)(y()._H,{defaultMessage:"Deny",id:"approveTeamMembershipActivityButton.denyButton.label"})})})]})})};var xe=()=>i(816512),Se=()=>i(696056),Ae=()=>i(912732),je=()=>i(454393),_e=()=>i(72950);const Ce=function(e){const{accessRequestStore:t,effectiveAccessRequestType:i,onApprove:o,onReject:a,spaceStore:s}=e,d=(0,r().O7)(),l=(0,n().VK)((()=>t.isDefined()),[t]),u=(0,n().VK)((()=>t.getModel()),[t]),g=(0,n().VK)((()=>s.canAdmin()),[s]),m=(0,n().VK)((()=>s.canEditMembership()),[s]),h=(0,n().VK)((()=>null==u?void 0:u.isResolved()),[u]),v=(0,n().VK)((()=>null==u?void 0:u.isGuestInviteRequest()),[u]),p=(0,C().E)("workspace_member_access_notif_polish"),f=(0,c().yK)((e=>({viewAllButton:{height:26,paddingLeft:8,paddingRight:8,color:e.regularTextColor,fontSize:14},secondaryButtonForGuestInvites:{height:26,paddingLeft:8,paddingRight:8},actionButton:{height:28,paddingLeft:12,paddingRight:12,boxShadow:e.plainButtonBoxShadow,fontSize:14,color:e.regularTextColor},notifContainer:{display:"flex",alignItems:"center",gap:v||!p?10:8},guestApproveButton:{height:28,paddingLeft:8,paddingRight:8,boxShadow:e.plainButtonBoxShadow,fontSize:12,color:e.regularTextColor,fontWeight:500}})),[v,p]),b="space_membership_request"===i;return l?h?(0,X.jsx)(Re,{accessRequestStore:t,spaceStore:s}):v&&!g||b&&!m?null:(0,X.jsxs)("div",{style:f.notifContainer,children:[(0,X.jsx)(ee,{children:(0,X.jsx)(ye().Z,{onClick:o,style:v||!p?f.guestApproveButton:f.actionButton,children:(0,X.jsx)(y()._H,{defaultMessage:"Approve",id:"approveSpaceMembershipActivityAction.approveButton.label"})})}),(0,X.jsx)(ee,{children:(0,X.jsx)(ye().Z,{onClick:a,style:v||!p?f.secondaryButtonForGuestInvites:f.actionButton,children:(0,X.jsx)(y()._H,{defaultMessage:"Deny",id:"approveSpaceMembershipActivityAction.denyButton.label"})})}),!d.device.isMobile&&(0,X.jsx)(ee,{children:(0,X.jsx)(ye().Z,{onClick:()=>{Ae().E5(d,{disable_membership_requests:s.getDisableMembershipRequests()}),je().r$({currentTab:"members",subtab:_e().Q.Requests})},style:v||!p?f.secondaryButtonForGuestInvites:f.viewAllButton,children:v||!p?(0,X.jsx)(y()._H,{defaultMessage:"View all requests",id:"approveSpaceMembershipActivityAction.viewAllRequests.label"}):(0,X.jsx)(y()._H,{defaultMessage:"View all",id:"approveSpaceMembershipActivityAction.viewAll.label"})})})]}):null};function Me(e,t,i){if(e===f().KJ){const o=i.getRecordValue({table:e,id:t});if(o)return(0,xe().dp)(o)}if(e===Se().cZ){const o=i.getRecordValue({table:e,id:t});if(o)return(0,xe().D$)(o)}}function ke(e){const{pointer:t,accessRequestStore:i}=e,{table:o,id:r}=t,a=(0,n().VK)((()=>V().oA([Me(o,r,i)])),[o,r,i]),s=(0,n().VK)((()=>(0,l().XW)(a,(0,M().h_)())),[a]);return(0,X.jsx)(X.Fragment,{children:s})}function Re(e){const{accessRequestStore:t,spaceStore:i}=e,o=(0,y().YB)(),r=(0,c().Fg)(),a=(0,n().VK)((()=>t.getModel()),[t]),s=(0,n().VK)((()=>t.getStatus()),[t]),d=(0,n().VK)((()=>t.getResolvedTime()),[t]),{isResolved:l,resolveByPointer:u}=(0,n().VK)((()=>({isResolved:(null==a?void 0:a.isResolved())??!1,resolveByPointer:null==a?void 0:a.getResolvedByPointer(i.id)})),[a,i.id]);if(!a)return null;const g=l&&u&&(0,X.jsx)(ke,{accessRequestStore:t,pointer:u});return(0,X.jsx)("div",{style:{fontSize:14,color:r.mediumTextColor},children:"approved"===s?(0,X.jsx)(y()._H,{defaultMessage:"Approved by {grantedBy} on {resolvedTime}",id:"approveSpaceMembershipActivityAction.requestApprovedWithTime.title",values:{grantedBy:g,resolvedTime:(0,R().Yx)(Math.min(d??1/0,Date.now()),"medium_with_time",(0,K().E2)(o))}}):(0,X.jsx)(y()._H,{defaultMessage:"Denied by {grantedBy} on {resolvedTime}",id:"approveSpaceMembershipActivityAction.requestDenied.title",values:{grantedBy:g,resolvedTime:(0,R().Yx)(Math.min(d??1/0,Date.now()),"medium_with_time",(0,K().E2)(o))}})})}var Ke=()=>i(67961),Ve=()=>i(933868),we=()=>i(934158),Ie=()=>i(253502),Te=()=>i(784234),Be=()=>i(636340),Pe=()=>i(122479),Ne=()=>i(384510),Ue=()=>i(876822),qe=()=>i(969243),Oe=()=>i(514380),He=()=>i(370005);const Le=i(263184).default.createClass(void 0,{name:"RoleStore"});const Ee=function(e){const{accessRequestStore:t,targetBlockStore:i,notification:o,initialRole:r,rootStore:a,activity:s,tabArgs:d}=e,l=(0,n().qz)(void 0,Le),c=(0,n().VK)((()=>t.getValue()),[t]),u=(0,n().VK)((()=>i.canAdmin()),[i]);return c?(0,m().Kc)(c)?(0,X.jsx)(et,{accessRequestStore:t,accessRequestValue:c}):u?(0,X.jsx)(Qe,{accessRequestStore:t,notification:o,targetBlockStore:i,initialRole:r,roleStore:l,accessRequestValue:c,rootStore:a,activity:s,tabArgs:d}):null:null};function ze(){const e=(0,c().yK)((e=>({banner:{borderRadius:Ne().Z.borderRadius,padding:"5px 8px",background:e.accentColors.yellow[50],marginBottom:12,fontSize:x().JB.UISmall.desktop,lineHeight:x().Nv.UISmall.desktop,fontWeight:x().Ue.regular,color:e.accentColors.yellow[500]}})),[]);return(0,X.jsx)("div",{style:e.banner,children:(0,X.jsx)(y()._H,{defaultMessage:"Make sure you trust this external user before sharing any content",id:"grantPageAccessActivityAction.externalWarning"})})}function Ze(e,t){const i=e.getValue();if(!i)return;const o=t.getPermissionItems();for(const r of o){if(i.for_actor_table===f().KJ&&(0,Ve().jg)(r)&&r.user_id===i.for_actor_id)return r;if(i.for_actor_table===Se().cZ&&(0,Ve().FB)(r)&&r.bot_id===i.for_actor_id)return r}}function Fe(e){return{tab:Ie().Jn(),activityId:null==e?void 0:e.activity_id,notificationId:null==e?void 0:e.id}}function De(e,t){const i={height:26,paddingLeft:8,paddingRight:8,boxShadow:t.plainButtonBoxShadow,fontSize:12,marginRight:10};return e?i:{...i,color:t.regularTextColor,fontWeight:500}}function We(e){const{notification:t,accessRequestStore:i,activity:o,tabArgs:n}=e,a=(0,r().O7)();return t?t.visited?null:(0,X.jsx)(ee,{children:(0,X.jsx)(ye().Z,{onClick:e=>{(0,Oe().ug)({...n,environment:a,activity:o}),function(e,t,i,o){o&&(0,N().ZP)({event:e,context:N().Af.NotificationClick,callback:()=>{T().createAndCommit({userAction:"GrantPageAccessActivityAction.handleArchive",environment:i,canUndo:!0,perform:e=>{w().aZ({notification:o,rootStore:t,transaction:e})}});const e=t.id,r=Fe(o);Ae().cO(i,{...r,requestId:e})}})}(e,i,a,t)},style:{height:26,paddingLeft:8,paddingRight:8},children:(0,X.jsx)(y()._H,{defaultMessage:"Deny",id:"grantPageAccessActivityAction.ignoreButton.label.deny"})})}):null}function Je(e,t,i,o){const r=Ze(e,t),n=r&&r.role;return o.state||n||i}function Ge(e,t,i,o,r){var n;const a=function(e,t,i,o){const r=e.getValue();if(r)return r.for_actor_table===f().KJ?{type:"user_permission",user_id:r.for_actor_id,role:Je(e,t,i,o)}:r.for_actor_table===Se().cZ?{type:"bot_permission",bot_id:r.for_actor_id,role:Je(e,t,i,o)}:void(r.for_actor_table!==we().y0&&(0,b().t1)(r.for_actor_table))}(t,i,o,r);if(!a)return{};if(Ze(t,i))return{permissionItem:a};const s=null===(n=Ue().default.getState().currentSpaceStore)||void 0===n?void 0:n.id;if(!s)return{};if("user_permission"===a.type){const i=qe().r.getData(e,{userId:a.user_id,spaceId:s});if(i&&"none"!==i.membership_type){return{type:"existingUser",value:t.getRecordModel({table:f().KJ,id:a.user_id}),permissionItem:a}}return{permissionItem:a}}if("bot_permission"===a.type){const e=t.getRecordModel({table:Se().cZ,id:a.bot_id}),i=s&&s===(null==e?void 0:e.space_id)&&e.alive;return e&&!i?{type:"bot",value:e,permissionItem:a}:{permissionItem:a}}(0,b().t1)(a)}function Ye(e,t,i){if(e===f().KJ){const o=i.getRecordModel({table:e,id:t});if(o)return(0,xe().dp)(o)}if(e===Se().cZ){const o=i.getRecordModel({table:e,id:t});if(o)return(0,xe().D$)(o)}}async function $e(e,t,i,o,r,n,a,s){if(o.getKeyStore("for_actor_table").getValue()!==f().KJ)return;const d=o.getKeyStore("for_actor_id").getValue(),l=(0,Pe().Dt)({userId:d,store:i}).role,c=Ge(t,o,i,r,n);if(!("permissionItem"in c))return;s&&(c.permissionItem.role=s);const u=t.currentUser.id;if(u){if("type"in c&&!s){let e;if("existingUser"===c.type){e=(await Te().n_({environment:t,store:i,inviteTargets:[c],inviteRole:c.permissionItem.role,isOnboarding:!1,invite:{inviteOrigin:"page_request_access"}})).success}else if("bot"===c.type){e=(await Te().n_({environment:t,store:i,inviteTargets:[c],inviteRole:void 0,isOnboarding:!1,invite:{inviteOrigin:"page_request_access"}})).success}else(0,b().t1)(c);if(!e)return}(0,N().ZP)({event:e,context:N().Af.NotificationClick,callback:()=>{T().createAndCommit({userAction:"GrantPageAccessActivityAction.handleGrantPageAccess",environment:t,canUndo:!0,perform:e=>{"type"in c||Te().l3({environment:t,transaction:e,store:i,permissionItems:[c.permissionItem]}),a&&w().$h({notification:a,rootStore:i,transaction:e,read:!0}),Be().sW({store:o,transaction:e,data:{granted_time:Date.now(),granted_by_table:f().KJ,granted_by_id:u,resolved_time:Date.now(),resolved_by_table:f().KJ,resolved_by_id:u,status:"approved"}})}});const e=o.isDefined(),r=o.id,n=o.getKeyStore("created_time").getValue(),s=o.getKeyStore("resolved_time").getValue(),d=e&&n&&s?s-n:void 0;Ae().nC(t,{requestId:r,timeElapsedSinceRequest:d,newAccessLevel:c.permissionItem.role,prevAccessLevel:l,...Fe(a)})}})}}function Xe(e){const{table:t,id:i,accessRequestStore:o}=e,r=(0,n().VK)((()=>{const e=V().oA([Ye(t,i,o)]);return(0,l().XW)(e,{...(0,M().h_)()})}),[t,i,o]);return(0,X.jsx)(X.Fragment,{children:r})}function Qe(e){const{accessRequestValue:t,accessRequestStore:i,notification:a,targetBlockStore:s,initialRole:d,roleStore:l,rootStore:u,activity:g,tabArgs:p}=e,b=(0,c().Fg)(),x=(0,r().O7)(),S=(0,o.useCallback)((e=>function(e,t,i,o,r){const n=i.id,a=o.state;o.setState(e),Ae().If(t,{requestId:n,previousAccessLevel:a,newAccessLevel:e,...Fe(r)})}(e,x,i,l,a)),[x,i,l,a]),j=t.parent_table===v().bx,_=(0,n().VK)((()=>Ze(i,s)),[i,s]),C=(0,n().VK)((()=>Je(i,s,d,l)),[i,s,d,l]),M=(0,m().b5)(t),k=(0,n().VK)((()=>(0,A().B)(t,u)),[t,u]),R=(0,n().VK)((()=>s.getType()),[s]);if(_&&!j){const e=(0,X.jsx)(Xe,{accessRequestStore:i,table:t.for_actor_table,id:t.for_actor_id}),o=_.role===C;if(!M||M&&(0,Ve().J5)(_.role))return(0,X.jsxs)(X.Fragment,{children:[M?(0,X.jsx)(Ke().Z,{isSecondaryColor:!0,isMultiline:!0,style:{marginBottom:6},children:(0,X.jsx)(y()._H,{defaultMessage:"{requestingUser} already has edit access.",id:"grantPageAccessActivityAction.alreadyHasEditAccess.label",values:{requestingUser:e}})}):(0,X.jsx)(Ke().Z,{isSecondaryColor:!0,isMultiline:!0,style:{marginBottom:6},children:(0,X.jsx)(y()._H,{defaultMessage:"{requestingUser} already has access.",id:"grantPageAccessActivityAction.alreadyHasAccess.label",values:{requestingUser:e}})}),(0,X.jsx)(ee,{children:(0,X.jsx)(He().ZP,{upgradeButtonName:"user_permission_item",role:C,table:h().iU,blockType:R,type:t.for_actor_table===f().KJ?"user_permission":"bot_permission",onChange:S,isInvite:!0,buttonStyle:De(!0,b)})}),(0,X.jsx)(ee,{children:(0,X.jsx)(ye().Z,{onClick:e=>$e(e,x,s,i,d,l,a),style:De(o,b),children:(0,X.jsx)(y()._H,{defaultMessage:"Change",id:"grantPageAccessActivityAction.changePermissionButton.label"})})}),(0,X.jsx)(We,{notification:a,accessRequestStore:i,activity:g,tabArgs:p})]})}return(0,X.jsxs)(X.Fragment,{children:[k&&(0,X.jsx)(ze,{}),(0,X.jsx)(ee,{children:!M&&(0,X.jsx)(He().ZP,{upgradeButtonName:"user_permission_item",role:C,table:h().iU,blockType:R,type:t.for_actor_table===f().KJ?"user_permission":"bot_permission",onChange:S,isInvite:!0,buttonStyle:De(!1,b)})}),(0,X.jsx)(ee,{children:M?(0,X.jsx)(ye().Z,{onClick:e=>{a&&(0,Oe().YE)({...p,environment:x,activity:g}),$e(e,x,s,i,d,l,a,"read_and_write")},style:De(!1,b),children:(0,X.jsx)(y()._H,{defaultMessage:"Approve",id:"grantPageAccessActivityAction.grantEditAccessButton.label.approve"})}):(0,X.jsx)(ye().Z,{onClick:e=>{a&&(0,Oe().YE)({...p,environment:x,activity:g}),$e(e,x,s,i,d,l,a)},style:De(!1,b),children:(0,X.jsx)(y()._H,{defaultMessage:"Approve",id:"grantPageAccessActivityAction.grantAccessButton.label.approve"})})}),(0,X.jsx)(We,{notification:a,accessRequestStore:i,activity:g,tabArgs:p})]})}function et(e){const{accessRequestValue:t,accessRequestStore:i}=e,o=(0,y().YB)(),r=(0,c().Fg)(),n=(0,X.jsx)(Xe,{accessRequestStore:i,table:t.granted_by_table,id:t.granted_by_id}),a=(0,R().Yx)(Math.min(t.granted_time,Date.now()),"medium_with_time",(0,K().E2)(o));return(0,X.jsx)("div",{style:{fontSize:12,color:r.text.secondary},children:(0,X.jsx)(y()._H,{defaultMessage:"Approved by {grantedBy} on {time}",id:"grantPageAccessActivityAction.accessGrantedWithTime.title",values:{grantedBy:n,time:a}})})}var tt=()=>i(126514),it=()=>i(966842),ot=()=>i(541714);function rt(e){var t;const i=(null===(t=e.profileEmail)||void 0===t?void 0:t.charAt(0).toUpperCase())??"?",o=(0,c().yK)((e=>({circleStyle:{width:20,height:20,borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center",borderColor:e.UIUserAvatarIdleOutline,borderWidth:1,borderStyle:"solid",marginRight:6},letterStyle:{color:e.mediumTextColor,fontWeight:x().Ue.medium,fontSize:12}})),[]);return(0,X.jsx)("div",{style:o.circleStyle,children:(0,X.jsx)("span",{style:o.letterStyle,children:i})})}function nt(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:a,isLast:s}=e,{notification:d,tab:u,source:v}=o,p=(0,r().O7)(),f=(0,n().VK)((()=>t.getEdits()),[t]),y=f[0],b=(0,c().yK)((()=>({message:{marginBottom:8},messageLabel:{whiteSpace:"pre-wrap"},titleStyle:{fontSize:14,display:"flex"}})),[]),x=(0,n().VK)((()=>k().oK.createChildStore(i,{table:m().J8,id:t.access_request_id})),[t,i]),S=(0,n().VK)((()=>x.getModel()),[x]),j=(0,n().VK)((()=>Boolean(S&&(0,A().B)(S,i))),[S,i]),M=S&&(0,X.jsx)(st,{activity:t,accessRequest:S,rootStore:i,tabArgs:o}),R=y.message,K=(0,n().VK)((()=>(0,l().P6)({edits:f,rootStore:i})),[f,i]),V=(0,n().VK)((()=>{if(null!=S&&S.isGuestInviteRequest()){const e=S.getAttributes().permission_records_and_roles[0],r=e&&k().G.createChildStore(i,{table:h().iU,id:e.id}),n=e.role;if(r.isDefined())return;return(0,X.jsx)(ot().Z,{titledRecordStore:r,activity:t,tabArgs:o,getRecordModel:i.getRecordModel,permissionRole:n,shouldRenderEmpty:!0})}}),[o,S,t,i]),w=(0,n().VK)((()=>{if(t.navigable_block_id)return k().G.createChildStore(i,{table:h().iU,id:t.navigable_block_id})}),[t,i]),I=(0,n().VK)((()=>{if(!w)return;const e=w.getModel();return e?e.getRenderUrl({getRecordModel:i.getRecordModel,discussionId:t.discussion_id,pageVisitSource:g().tY.Notification}):void 0}),[w,i,t]),T=(0,_().v)({spaceStore:i,request:S}),B=(0,C().E)("workspace_member_access_notif_polish");return M?(0,X.jsxs)(fe,{header:(0,X.jsx)("span",{children:M}),isFirst:a,isLast:s,isPrivate:!1,rootStore:i,notification:d,icon:(0,X.jsx)(tt().BE,{authors:K,size:oe,style:{marginTop:0,marginRight:0},iconStyle:{right:-3},showAvatarShadow:!1,showWarningIcon:j}),showSnapshotButton:!1,url:I,...(0,Oe().JJ)({notification:d,activity:t,environment:p,tab:u}),children:[B&&"space_membership_request"===T&&(0,X.jsx)(at,{rootStore:i,accessRequestModel:S}),R&&(0,X.jsx)("div",{style:b.message,children:(0,X.jsx)(Ke().Z,{isMultiline:!0,style:b.messageLabel,children:R})}),V&&(0,X.jsx)("div",{style:b.titleStyle,children:V}),(0,X.jsx)(gt,{activity:t,accessRequestStore:x,rootStore:i,source:v,notification:d,tabArgs:o})]}):null}function at(e){const{rootStore:t,accessRequestModel:i}=e,o=(0,n().VK)((()=>i.getForActorId()===i.getCreatedById()),[i]),r=(0,n().VK)((()=>i.getForActorPointer(t.id)),[i,t.id]),a=r.table===f().KJ?k().U6.createChildStore(t,r):void 0,s=(0,n().VK)((()=>null==a?void 0:a.getModel()),[a]),d=(0,n().VK)((()=>null==s?void 0:s.getEmail()),[s]),l=(0,n().VK)((()=>{if(!o)return d;const e=null==s?void 0:s.getFullName(j().Z.getIntl());return e?`${e} (${d})`:d}),[o,s,d]),u=(0,c().yK)((()=>({inviteeBox:{display:"flex",alignItems:"center",marginBottom:8},inviteePhrase:{fontWeight:x().Ue.medium,fontSize:14}})),[]);return(0,X.jsxs)("div",{style:u.inviteeBox,children:[(0,X.jsx)(rt,{profileEmail:l}),(0,X.jsx)("span",{style:u.inviteePhrase,children:l})]})}function st(e){const{activity:t,accessRequest:i,rootStore:o,tabArgs:r}=e,n=(0,_().v)({spaceStore:o,request:i});if(!n)return null;switch(n){case"guest_invite_request":return(0,X.jsx)(ct,{activity:t,accessRequest:i,rootStore:o});case"space_membership_request":return(0,X.jsx)(lt,{activity:t,accessRequest:i,rootStore:o});case"team_membership_request":return(0,X.jsx)(ut,{activity:t,rootStore:o,tabArgs:r});case"page_access_request":return(0,X.jsx)(dt,{activity:t,tabArgs:r,rootStore:o,accessRequest:i});default:(0,b().t1)(n)}}function dt(e){const{activity:t,rootStore:i,accessRequest:o}=e,r=(0,n().VK)((()=>t.getEdits()),[t]),a=(0,n().VK)((()=>{const e=o.getForActorPointer(i.id),t=e.table===f().KJ?k().U6.createChildStore(i,e):void 0,r=null==t?void 0:t.getModel();return null==r?void 0:r.getEmail()}),[o,i]),s=(0,n().VK)((()=>Boolean(o&&(0,A().B)(o,i))),[o,i]),d=(0,n().VK)((()=>(0,l().P6)({edits:r,rootStore:i})),[r,i]),c=(0,n().VK)((()=>s&&a?(0,l().m4)(a,(0,M().h_)()):(0,l().XW)(d,(0,M().h_)())),[s,a,d]),u=(0,n().VK)((()=>{if(t.navigable_block_id)return k().G.createChildStore(i,{table:h().iU,id:t.navigable_block_id})}),[t,i]),g=(0,n().VK)((()=>o.isEditPageAccessRequest()),[o]);return u?g?(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested edit access to} other {{authorOrAuthors} requested edit access to}}",values:{numberOfAuthors:d.length,authorOrAuthors:c},id:"activity.editAccessRequested.header.short"}):(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested access to} other {{authorOrAuthors} requested access to}}",values:{numberOfAuthors:d.length,authorOrAuthors:c},id:"activity.accessRequested.header.short"}):null}function lt(e){const{activity:t,accessRequest:i,rootStore:o}=e,r=(0,c().yK)((()=>({inviteePhrase:{fontWeight:x().Ue.semibold}})),[]),a=(0,n().VK)((()=>t.getEdits()),[t]),s=(0,n().VK)((()=>i.getForActorPointer(o.id)),[i,o.id]),d=s.table===f().KJ?k().U6.createChildStore(o,s):void 0,u=(0,n().VK)((()=>null==d?void 0:d.getModel()),[d]),g=(0,n().VK)((()=>null==u?void 0:u.getEmail()),[u]),m=(0,n().VK)((()=>i.getForActorId()===i.getCreatedById()),[i]),h=(0,n().VK)((()=>(0,l().P6)({edits:a,rootStore:o})),[a,o]),v=(0,n().VK)((()=>(0,l().XW)(h,(0,M().h_)())),[h]),p=(0,n().VK)((()=>{if(!m)return g;const e=null==u?void 0:u.getFullName(j().Z.getIntl());return e?`${e} (${g})`:g}),[m,u,g]),b=(0,C().E)("workspace_member_access_notif_polish");return u&&s.table===f().KJ?m?(0,X.jsx)(y()._H,{defaultMessage:"{invitee} requested to become a workspace member",values:{invitee:(0,X.jsx)("span",{style:r.inviteePhrase,children:p})},id:"activity.accessRequestedMembershipFromGuest.header"}):b?(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested to add a workspace member} other {{authorOrAuthors} requested to add workspace members}}",values:{numberOfAuthors:h.length,authorOrAuthors:v},id:"activity.accessRequestedMembershipNoInvitee.header.short"}):(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested to add {invitee} as a workspace member} other {{authorOrAuthors} requested to add {invitee} as a workspace member}}",values:{numberOfAuthors:h.length,authorOrAuthors:v,invitee:(0,X.jsx)("span",{style:r.inviteePhrase,children:p})},id:"activity.accessRequestedMembership.header.short"}):null}function ct(e){const{activity:t,accessRequest:i,rootStore:o}=e,r=(0,n().VK)((()=>t.getEdits()),[t]),a=(0,c().yK)((()=>({inviteePhrase:{fontWeight:x().Ue.semibold}})),[]),s=(0,n().VK)((()=>i.getForActorPointer(o.id)),[i,o.id]),d=s.table===f().KJ?k().U6.createChildStore(o,s):void 0,u=(0,n().VK)((()=>null==d?void 0:d.getModel()),[d]),g=(0,n().VK)((()=>null==u?void 0:u.getEmail()),[u]),m=(0,n().VK)((()=>(0,l().P6)({edits:r,rootStore:o})),[r,o]),h=(0,n().VK)((()=>(0,l().XW)(m,{...(0,M().h_)()})),[m]);return(0,n().VK)((()=>i.isGuestInviteRequest()),[i])&&u&&s.table===f().KJ?(0,X.jsx)(y()._H,{defaultMessage:"{requestorsPhrase} requested inviting {guestEmail} as a guest",values:{requestorsPhrase:h,guestEmail:(0,X.jsx)("span",{style:a.inviteePhrase,children:g})},id:"activity.guestInviteRequest.header.short"}):null}function ut(e){const{activity:t,rootStore:i,tabArgs:o}=e,r=(0,n().VK)((()=>t.getEdits()),[t]),a=(0,n().VK)((()=>(0,l().P6)({edits:r,rootStore:i})),[r,i]),s=(0,n().VK)((()=>(0,l().XW)(a,{...(0,M().h_)()})),[a]),d=(0,n().VK)((()=>{if(t.team_id)return k().zX.createChildStore(i,{table:p().e0,id:t.team_id})}),[t,i]);return r&&d?(0,X.jsx)(y()._H,{defaultMessage:"{user} requested to join {teamName}",values:{user:(0,X.jsx)("span",{style:{fontWeight:x().Ue.semibold},children:s}),teamName:(0,X.jsx)(ot().Z,{titledRecordStore:d,getRecordModel:i.getRecordModel,activity:t,tabArgs:o})},id:"activity.teamAccessRequest.header.short"}):null}function gt(e){const{activity:t,accessRequestStore:i,rootStore:a,notification:s,tabArgs:d}=e,l=(0,r().O7)(),g=(0,n().VK)((()=>t.getEdits()),[t])[0],m=(0,n().VK)((()=>i.getParentTable()),[i]),f=(0,n().VK)((()=>i.getParentId()),[i]),y=(0,n().VK)((()=>t.navigable_block_id),[t]),x=(0,n().VK)((()=>i.getModel()),[i]),A=(0,n().VK)((()=>x&&(0,u().Z)(x)),[x]),j=(0,_().v)({spaceStore:a,request:x}),C=(0,n().VK)((()=>{if("page_access_request"===A){var e;const t=null==x||null===(e=x.getAttributes())||void 0===e||null===(e=e.permission_records_and_roles)||void 0===e||null===(e=e.at(0))||void 0===e?void 0:e.role;if(t)return t}return"reader"}),[x,A]),M=(0,o.useCallback)((async()=>{if(A&&j&&x)if("space_membership_request"===j&&"space_membership_request"===A)await S().YN({status:"approved",environment:l,requests:[x],store:a,from:"notification"});else if("space_membership_request"===j&&"guest_invite_request"===A)await S().fJ({status:"approved",environment:l,store:a,requests:[x],from:"notification"});else{if("guest_invite_request"!==A)return;await S().mY({status:"approved",environment:l,requests:[x],from:"notification"})}}),[l,x,a,j,A]),R=(0,o.useCallback)((async()=>{if(A&&x)if("space_membership_request"===A)await S().YN({status:"rejected",environment:l,requests:[x],store:a,from:"notification"});else if("guest_invite_request"===A)await S().mY({status:"rejected",environment:l,requests:[x],from:"notification"});else{if("team_membership_request"===A||"page_access_request"===A)return;(0,b().t1)(A)}}),[l,x,a,A]),K=(0,c().yK)((e=>({actionPrimaryContainer:{paddingTop:4,paddingBottom:0,paddingRight:0},actionButton:(0,it().b9)(e)})),[]),V=y?k().G.createChildStore(a,{table:h().iU,id:y}):void 0,w=(0,n().VK)((()=>m===h().iU&&Boolean(null==V?void 0:V.canAdmin())),[m,V]);if(!(m&&f&&j&&g))return null;if("page_access_request"===j)return w&&V?(0,X.jsx)("div",{style:K.actionPrimaryContainer,children:(0,X.jsx)(Ee,{accessRequestStore:i,targetBlockStore:V,initialRole:C,buttonStyle:K.actionButton,notification:s,rootStore:a,activity:t,tabArgs:d})}):null;if("space_membership_request"===j||"guest_invite_request"===j){const e=k().H2.createChildStore(a,{table:v().bx,id:f});return(0,X.jsx)("div",{style:K.actionPrimaryContainer,children:(0,X.jsx)(Ce,{effectiveAccessRequestType:j,accessRequestStore:i,spaceStore:e,initialRole:"reader",buttonStyle:K.actionButton,notification:s,onApprove:M,onReject:R})})}if("team_membership_request"===j){const e=k().zX.createChildStore(a,{table:p().e0,id:f});return(0,X.jsx)("div",{style:K.actionPrimaryContainer,children:(0,X.jsx)(be,{accessRequestStore:i,teamStore:e})})}(0,b().t1)(j)}const mt=o.memo(nt);function ht(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:a,isLast:s}=e,{notification:d,tab:c}=o,u=(0,r().O7)(),v=(0,n().VK)((()=>t.getEdits()),[t]),p=(0,n().VK)((()=>k().oK.createChildStore(i,{table:m().J8,id:t.access_request_id})),[t,i]),f=(0,n().VK)((()=>{const e=p.getModel();return e&&e.isGuestInviteRequest()&&e.isResolved()||e&&e.isEditPageAccessRequest()&&e.isApproved()?e:void 0}),[p]),y=(0,n().VK)((()=>Boolean(null==f?void 0:f.isEditPageAccessRequest())),[f]),b=(0,n().VK)((()=>(0,l().P6)({edits:v,rootStore:i})),[v,i]),x=(0,n().VK)((()=>{if(t.navigable_block_id)return k().G.createChildStore(i,{table:h().iU,id:t.navigable_block_id})}),[t,i]),S=f&&(0,X.jsx)(vt,{activity:t,accessRequest:f,rootStore:i,isEditAccessRequest:y}),A=(0,n().VK)((()=>{if(!x)return;const e=x.getModel();return e?e.getRenderUrl({getRecordModel:i.getRecordModel,discussionId:t.discussion_id,pageVisitSource:g().tY.Notification}):void 0}),[x,i,t]);return S&&x?(0,X.jsx)(fe,{header:(0,X.jsx)("span",{children:S}),isFirst:a,isLast:s,isPrivate:!1,rootStore:i,notification:d,icon:(0,X.jsx)(tt().BE,{authors:b,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:A,...(0,Oe().JJ)({notification:d,activity:t,environment:u,tab:c})}):null}function vt(e){const{accessRequest:t,rootStore:i,isEditAccessRequest:o}=e,r=(0,c().yK)((()=>({inviteePhrase:{fontWeight:x().Ue.medium}})),[]),a=(0,n().VK)((()=>i.getRecordModel({id:t.getForActorId(),table:t.getForActorTable()})),[t,i]),s=(0,n().VK)((()=>null==a?void 0:a.getEmail()),[a]),d=(0,n().VK)((()=>{const e=(null==a?void 0:a.isUser())&&(null==a?void 0:a.getFullName(j().Z.getIntl()));return e?`${e} (${s})`:s}),[a,s]),u=(0,n().VK)((()=>i.getRecordModel({id:t.getResolvedById(),table:t.getResolvedByTable()})),[t,i]),g=(0,n().VK)((()=>u&&(0,l().XW)([u],{fontWeight:x().Ue.medium})),[u]),m=(0,n().VK)((()=>t.getStatus()),[t]);return g&&d?o?(0,X.jsx)(y()._H,{defaultMessage:"{resolverPhrase} approved your request to edit the page",values:{resolverPhrase:g},id:"activity.EditAccessRequestResolvedMembership.approved.header.short"}):"approved"===m?(0,X.jsx)(y()._H,{defaultMessage:"{resolverPhrase} approved your request to invite {invitee} as a guest",values:{resolverPhrase:g,invitee:(0,X.jsx)("span",{style:r.inviteePhrase,children:d})},id:"activity.AccessRequestResolvedMembership.approved.header.short"}):"rejected"===m?(0,X.jsx)(y()._H,{defaultMessage:"{resolverPhrase} denied your request to invite {invitee} as a guest",values:{resolverPhrase:g,invitee:(0,X.jsx)("span",{style:r.inviteePhrase,children:d})},id:"activity.AccessRequestResolvedMembership.rejected.header.short"}):void(0,b().t1)(m):null}const pt=o.memo(ht);i(122556),i(582845),i(250570),i(533019),i(721473),i(788208),i(22624),i(267602),i(653476),i(241792);var ft=()=>i(731424),yt=()=>i(494616),bt=()=>i(497065),xt=()=>i(594546),St=()=>i(429725),At=()=>i(735501),jt=()=>i(154186);function _t(e){const{automationNames:t,handleAutomationNavigate:i}=e,o=(0,y().YB)(),r=t.at(0),n=t.length,a=n-2,s=o.formatList([...t.slice(0,2),a>0?o.formatMessage({defaultMessage:"{numRemainingAutomations} more",id:"AutomationTypecheckErrorRaisedActivity.wrappedAutomationName.tooltipNumRemainingAutomations"},{numRemainingAutomations:a}):void 0].filter(b().$K),{style:"long",type:"conjunction"}),d={defaultMessage:"{numAutomations, plural, one {{firstAutomationName}} other {{numAutomations} automations}}",values:{firstAutomationName:r,numAutomations:n},id:"AutomationTypecheckErrorRaisedActivity.wrappedAutomationName.automationName",description:"The display name for an automation."},l=e=>(0,X.jsx)(jt().Z,{...e,onClick:i,children:(0,X.jsx)(y()._H,{...d})});return 1===n?l():(0,X.jsx)(G().Z,{renderTooltip:e=>(0,X.jsx)("div",{...e,children:s}),render:e=>l(e)})}function Ct(e){let{automationName:t}=e;const i=(0,c().yK)((e=>({icon:{fill:e.icon.uiRedPrimary,height:12,left:9,position:"absolute",top:14,width:12},firstLetter:{textTransform:"uppercase",color:e.text.secondary},wrapper:{position:"relative"}})),[]);return(0,X.jsx)(pe,{children:(0,X.jsxs)("div",{style:i.wrapper,children:[(0,X.jsx)("div",{style:i.firstLetter,children:t.charAt(0)}),(0,At().t)(i.icon)]})})}i(30005);var Mt=()=>i(386617),kt=()=>i(204642);i(228244);var Rt=()=>i(532850),Kt=()=>i(81954),Vt=()=>i(572948),wt=()=>i(874018),It=()=>i(547592),Tt=()=>i(654953),Bt=()=>i(718611),Pt=()=>i(641702),Nt=()=>i(852465),Ut=()=>i(987503),qt=()=>i(439378),Ot=()=>i(733641),Ht=()=>i(43360),Lt=()=>i(729775),Et=()=>i(634760),zt=()=>i(981583),Zt=()=>i(765513),Ft=()=>i(837416),Dt=()=>i(943707);function Wt(e){const{activity:t,tabArgs:i,rootStore:a,isFirst:c,isLast:u}=e,{source:m,tab:v,notification:p}=i,f=(0,n().VK)((()=>t.getEdits()),[t]);let y=f.filter((e=>{switch(e.type){case"comment-changed":return!1;case"comment-created":case"comment-deleted":case"suggestion-created":return!0;default:(0,b().t1)(e)}}));const S=(0,n().VK)((()=>"suggestion-created"===f[0].type),[f]);0===y.length&&0!==f.length&&(y=f);const A=y.length>0,j=(0,r().O7)(),_=(0,n().VK)((()=>{const e=a.getRecordStore(a,{table:d().qF,id:t.discussion_id,spaceId:t.space_id});if(e.isDefined())return e}),[t,a]),C=(0,n().VK)((()=>_?_.getCommentStores():[]),[_]),M=(0,n().VK)((()=>{const e=null==_?void 0:_.getParentPointer();if(e)return k().G.createChildStore(a,e)}),[_,a]),R=(0,n().VK)((()=>Boolean(M&&M.isDefined())),[M]),K="on"===(0,Ut().a)("inbox_activity_split"),w=(0,n().VK)((()=>{const e=null==M?void 0:M.getNavigableBlockStore();return(null==e?void 0:e.id)||t.navigable_block_id}),[t,M]),I=k().G.createChildStore(a,{table:h().iU,id:w}),T=(0,n().VK)((()=>I.isDefined()),[I]),B=(0,n().VK)((()=>Boolean(!(null!=M&&M.pathIsDead()))),[M]),P=(0,n().VK)((()=>I.canComment()&&B&&!K),[B,I,K]),N=(0,n().VK)((()=>{var e;if(M)return null===(e=M.getModel())||void 0===e?void 0:e.getRenderUrl({getRecordModel:a.getRecordModel,discussionId:t.discussion_id,pageVisitSource:g().tY.Notification})}),[M,a,t]),U=(0,n().VK)((()=>(0,l().P6)({edits:y,rootStore:a})),[y,a]),q=(0,n().VK)((()=>(0,V().mN)(C.map((e=>e.getCreatedByPointer())).filter(b().$K),"id").map((e=>k().t1.createChildStore(a,e)))),[C,a]),O=(0,n().VK)((()=>q.map((e=>e.getModel())).filter(b().$K)),[q]),{backActorStore:H,frontActorStore:L}=(0,n().VK)((()=>{const e=j.currentUser.id;if(!e)return{backActorStore:void 0,frontActorStore:void 0};const t=q.some((t=>t.id===e)),i=q.sort(((t,i)=>(t.id===e?1:0)-(i.id===e?1:0))),o=i.at(0);return{backActorStore:i.at(Math.max(1,i.length-(t?2:1))),frontActorStore:o}}),[j.currentUser.id,q]),E=B,z=(0,o.useCallback)((e=>{if((0,Oe().dG)({...i,environment:j,activity:t,mightCloseTab:E}),!B&&M&&_){var o;const r=e.target;It().oK({environment:j,discussionStore:_,rect:r.getBoundingClientRect(),blockStore:M,discussionLocation:ei({forReplyMenu:!0,source:i.source}),activityId:t.id,notificationId:null===(o=i.notification)||void 0===o?void 0:o.id})}}),[t,B,M,_,j,i,E]),Z=(0,o.useCallback)((e=>{"Removed"===e?(0,Oe().Tq)({...i,environment:j,activity:t,mightCloseTab:E}):"Added"===e?(0,Oe().Z5)({...i,environment:j,activity:t,mightCloseTab:E}):(0,b().t1)(e)}),[i,j,t,E]),F=(0,n().VK)((()=>(0,l().jC)({recordId:w,recordType:h().iU,tab:v,rootStore:a,environment:j})),[w,v,a,j]),D=(0,n().VK)((()=>ei({source:m,forReplyMenu:!1})),[m]),W=(0,n().VK)((()=>{const e=null==_?void 0:_.getModel();if(e)return(0,l().Pq)(e)}),[_]);return A&&T&&R&&_?(0,X.jsxs)(fe,{header:(0,X.jsx)(ti,{authorCount:U.length,authorPhrase:(0,X.jsx)(ui,{authorsLength:q.length,frontActorStore:L,backActorStore:H,authorTextStyle:{fontWeight:x().Ue.medium}}),isSuggestionCreatedActivity:S}),isFirst:c,isLast:u,isPrivate:F,rootStore:a,navigableBlockId:w,notification:p,icon:L&&H?(0,X.jsx)(ci,{frontActorStore:L,backActorStore:H}):O.length>0?(0,X.jsx)(tt().BE,{authors:O,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}):(0,X.jsx)(gi,{}),showSnapshotButton:!1,url:N,...(0,Oe().JJ)({notification:p,environment:j,tab:v,activity:t}),children:[_&&W&&(0,X.jsx)(Yt,{discussionStore:_,url:N,onClick:z,rootStore:a,source:m,isSuggestionCreatedActivity:S}),_&&(0,X.jsx)(ni,{discussionStore:_,discussionLocation:D,onReactionToggle:Z}),P&&(0,X.jsx)(Qt,{activity:t,rootStore:a,tabArgs:i,isSuggestionCreatedActivity:S}),_&&(0,X.jsx)(Gt,{discussionStore:_})]}):(s().log({level:"warning",from:"CommentActivityNotification",type:"invalidNotificationData",data:{ids:[(null==p?void 0:p.id)??"unknown"]}}),null)}const Jt=8;function Gt(e){const{discussionStore:t}=e,i=(0,n().VK)((()=>t.getResolved()),[t]),o=(0,c().yK)((e=>({container:{display:"flex",alignItems:"center",gap:4,fontSize:12,color:e.text.secondary,marginTop:Jt},icon:{height:12,width:12}})),[]);return i?(0,X.jsxs)("div",{style:o.container,children:[(0,Ot().k)(o.icon),(0,X.jsx)(y()._H,{id:"activity.commentActivity.commentStatusResolved",defaultMessage:"Resolved on the page"})]}):null}function Yt(e){const{url:t,onClick:i,discussionStore:o,rootStore:r,isSuggestionCreatedActivity:a}=e,s=(0,c().yK)((e=>({linkbox:{display:"flex",alignItems:"center",fontSize:13,color:e.mediumTextColor,paddingTop:2,paddingBottom:8,marginBottom:0}})),[,]),d=(0,n().VK)((()=>o.getType()),[o]);return(0,X.jsx)(Lt().Z,{href:t,onClick:i,innerStyle:s.linkbox,disabled:!0,children:"suggestion"===d?!a&&(0,X.jsx)(wt().s3,{discussionStore:o,collapsed:!1}):(0,X.jsx)($t,{rootStore:r,discussionStore:o})})}function $t(e){const t=(0,r().O7)(),i=(0,c().Fg)(),{rootStore:o,discussionStore:a}=e,s=(0,n().VK)((()=>{const e=a.getModel();if(e)return(0,l().Pq)(e)}),[a]),d=(0,n().VK)((()=>{var e;const t=null==a||null===(e=a.getParentStore())||void 0===e?void 0:e.getParentStore();if(!t||"collection"!==t.table)return;const i=t.getSchema(),o=a.getPropertyId();return void 0!==o?(0,Rt().Qm)({schema:i,property:o}):void 0}),[a]),u=(0,n().VK)((()=>(0,Pt().IY)({environment:t,textValue:s?{value:s,spaceId:o.id}:void 0,parentStore:o,disableHover:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!0,disabled:!0,highlightDiscussionId:a.id,theme:i,emojiType:(0,Bt().e_)(t),katex:t.KatexStore.getKatex(),formulaValueTypes:[]})),[t,s,o,a.id,i]);return s?(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(Dt().Z,{}),d&&(0,X.jsx)(Tt().Z,{propertySchema:d}),(0,X.jsx)("div",{style:x().Yu,children:u})]}):null}const Xt=8;function Qt(e){const{activity:t,rootStore:i,tabArgs:a,isSuggestionCreatedActivity:s}=e,{source:l,notification:u,tab:g}=a,m=(0,n().VK)((()=>{const e=i.getRecordStore(i,{table:d().qF,id:t.discussion_id,spaceId:t.space_id});if(e.isDefined())return e}),[t,i]),v=(0,r().O7)(),p=(0,n().VK)((()=>k().t1.createChildStore(i,{table:d().qF,id:t.discussion_id,spaceId:(0,Kt().J)(i.pointer.spaceId)})),[t,i]),f=(0,n().VK)((()=>null==m?void 0:m.getParentId()),[m]),b=(0,o.useCallback)((e=>{(0,N().ZP)({event:e,context:N().Af.NotificationClick,callback:()=>{if(!f)return;const o=k().G.createChildStore(i,{table:h().iU,id:f}),r=e.target,n=null==u?void 0:u.id;It().oK({environment:v,discussionStore:p,rect:r.getBoundingClientRect(),blockStore:o,discussionLocation:ei({forReplyMenu:!0,source:l}),activityId:t.id,notificationId:n}),"notifications_tab"===l&&Ie().gY({environment:v,notificationId:n,alreadyRead:Boolean(null==u?void 0:u.read),activity:t,tab:g})}})}),[t,p,v,u,f,i,l,g]),x=(0,c().yK)((e=>({container:{paddingTop:Xt},actionButton:(0,it().b9)(e)})),[]);return!m||s?null:(0,X.jsx)("div",{style:x.container,children:(0,X.jsx)(ee,{children:(0,X.jsx)(ye().Z,{onClick:b,style:x.actionButton,children:(0,X.jsx)(y()._H,{defaultMessage:"Reply",id:"activityNotification.replyButton.label"})})})})}function ei(e){const{forReplyMenu:t,source:i}=e;if("updates_sidebar"===i)return t?"reply_menu_updates_sidebar":"updates_sidebar";return`${t?"reply_menu_":"updates_menu_"}${Ie().Jn()}`}function ti(e){const{authorCount:t,authorPhrase:i,isSuggestionCreatedActivity:o}=e;return o?(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} suggested in} other {{authorOrAuthors} suggested in}}",values:{numberOfAuthors:t,authorOrAuthors:i},id:"activity.commentActivity.standardizedHeader.suggestion"}):(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented in} other {{authorOrAuthors} commented in}}",values:{numberOfAuthors:t,authorOrAuthors:i},id:"activity.commentActivity.standardizedHeader"})}const ii=2,oi=10,ri=4;function ni(e){const{discussionStore:t,discussionLocation:i,onReactionToggle:a}=e,s=(0,r().O7)(),[d,l]=(0,o.useState)(!1),u=(0,n().VK)((()=>{if(!t)return[];const e=t.getCommentStores();return"suggestion"===t.getType()?e.slice(1):e}),[t]),g=u.length-ii,m=g>0,h="on"===(0,Ut().a)("inbox_activity_split"),v=1===u.length,p=(0,o.useCallback)((e=>{(0,N().ZP)({event:e,context:N().Af.NotificationClick,callback:()=>{l(!d),Ie().EH(s,{expand:!d,comments_count:u.length,discussion_id:t.id})}})}),[s,d,u.length,t.id]),f=(0,c().yK)((e=>({discussion:{display:"flex",flexDirection:"column",gap:oi},truncateRepliesButton:{display:"flex",gap:8,padding:4,marginLeft:-4,borderRadius:4},avatars:{display:"flex"},truncationText:{display:"flex",alignItems:"center",color:e.lightTextColor,fontSize:12},expandButton:{display:"flex",justifyContent:"start",alignItems:"center",gap:14,borderRadius:6,fontSize:12,padding:6,marginLeft:-6,marginTop:ri-oi,marginBottom:ri-oi,color:e.mediumTextColor,maxWidth:"fit-content",maxHeight:26},divider:{width:20,flexGrow:2,color:e.stroke.secondary}})),[]),b=d?void 0:v?4:3;if(v){const e=u[0];return(0,X.jsx)("div",{style:f.discussion,children:(0,X.jsx)(ai,{commentStore:e,discussionStore:t,discussionLocation:i,onReactionToggle:a,maxLines:b,showAuthor:!1,onMore:p},e.id)})}if(h&&u.length>0){const e=u[u.length-1];return(0,X.jsx)("div",{style:f.discussion,children:(0,X.jsx)(ai,{commentStore:e,discussionStore:t,discussionLocation:i,onReactionToggle:a,maxLines:b,showAuthor:!1,onMore:p},e.id)})}return(0,X.jsxs)("div",{style:f.discussion,children:[u.slice(0,1).map((e=>(0,X.jsx)(ai,{commentStore:e,discussionStore:t,discussionLocation:i,onReactionToggle:a,maxLines:b,onMore:p},e.id))),m&&(0,X.jsx)(ee,{children:(0,X.jsx)(Z().Z,{style:f.expandButton,onClick:p,children:d?(0,X.jsx)(y()._H,{id:"CommentGroupingActivity.discussionThread.hidePreviousRepliesCount",defaultMessage:"Hide {previousRepliesCount} {previousRepliesCount, plural, one {comment} other {comments}}",values:{previousRepliesCount:g}}):(0,X.jsx)(y()._H,{id:"CommentGroupingActivity.discussionThread.showPreviousRepliesCount",defaultMessage:"{previousRepliesCount} {previousRepliesCount, plural, one {more comment} other {more comments}}",values:{previousRepliesCount:g}})})}),d&&u.slice(1,-1).map((e=>(0,X.jsx)(ai,{commentStore:e,discussionStore:t,discussionLocation:i,onReactionToggle:a,maxLines:b,onMore:p},e.id))),u.slice(-1).map((e=>(0,X.jsx)(ai,{commentStore:e,discussionStore:t,discussionLocation:i,onReactionToggle:a,maxLines:b,onMore:p},e.id)))]})}function ai(e){const{commentStore:t,discussionStore:i,discussionLocation:a,onReactionToggle:s,maxLines:d,showAuthor:l=!0,onMore:u}=e,g=(0,r().Fy)(),[m,v]=(0,o.useState)(!1),p=(0,n().VK)((()=>{const e=t.getContent(),i=0===e.length;if(e||!i)return e.map((e=>{const i=k().t1.createChildStore(t,{table:h().iU,id:e,spaceId:t.getSpaceId()}).getValue();if(i)return(0,X.jsx)(Ht().ZP,{blockValue:i,rootStore:t},e)})).filter(b().$K)}),[t]),f=(0,n().VK)((()=>k().bh.getUserVisibleReactions(t).length>0),[t]),S=(0,n().VK)((()=>t.getLastEditedTime()>t.getCreatedTime()+100),[t]),A=!f&&g.isMobile,j=!A,_=(0,o.useCallback)((e=>{g.isMobile?e.preventDefault():v(!0)}),[g.isMobile]),C=(0,o.useCallback)((e=>{g.isMobile?e.preventDefault():v(!1)}),[g.isMobile]),M=(0,c().yK)((e=>({avatarCommentReactionBarContainer:{...!f&&!g.isMobile&&{position:"relative"}},avatarAndCommentContainer:{display:"flex",flexDirection:"column"},commentContainer:{display:"flex",justifyContent:"space-between",gap:6,flexGrow:1},commentClampContainer:{lineHeight:x().Nv.UIRegular.desktop,color:e.accentColors.gray[500]},toggleOverflowButton:{color:e.accentColors.gray[500],fontSize:14},editedBadge:{fontSize:13,color:e.mediumTextColor,paddingLeft:4},reactionBarMobile:f?{marginTop:4}:{marginRight:-6},reactionBar:{...!f&&{position:"absolute",top:-2,right:-8,opacity:m?1:0,transition:`opacity ${le}`},...f&&{marginTop:4}},newReaction:{borderWidth:1,borderStyle:"solid",borderColor:g.isMobile?"transparent":e.stroke.primary,borderRadius:6,boxShadow:g.isMobile?"unset":"0px 2px 4px 0px rgba(22, 29, 27, 0.02)"}})),[g,f,m]),R=(0,o.useCallback)((e=>{e.preventDefault(),u(e)}),[u]);return(0,X.jsx)("div",{children:(0,X.jsxs)("div",{style:M.avatarCommentReactionBarContainer,onMouseEnter:_,onMouseLeave:C,children:[(0,X.jsxs)("div",{style:M.avatarAndCommentContainer,children:[l&&(0,X.jsx)("div",{children:(0,X.jsx)(si,{commentStore:t})}),(0,X.jsxs)("div",{style:M.commentContainer,dir:"auto",children:[(0,X.jsxs)(Ft().Z,{style:M.commentClampContainer,maxLines:d,onMore:R,moreElement:(0,X.jsxs)(Zt().Z,{style:M.toggleOverflowButton,disableUnderline:!0,hoverColor:"blue",children:["","",(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{id:"commentActivityNotification.truncated.showMoreLabel",defaultMessage:"more"})})]}),children:[(0,X.jsx)(di,{discussionStore:i,commentStore:t}),p,S&&(0,X.jsx)("span",{style:M.editedBadge,children:(0,X.jsx)(y()._H,{id:"CommentGroupingActivity.discussionThreadComment.editedBadge",defaultMessage:"(edited)"})})]}),A&&(0,X.jsx)("div",{style:g.isMobile?M.reactionBarMobile:M.reactionBar,children:(0,X.jsx)(ee,{children:(0,X.jsx)(wt().DU,{parentStore:t,discussionLocation:a,onReactionToggle:s,newReactionStyle:M.newReaction})})})]})]}),j&&(0,X.jsx)("div",{style:g.isMobile?M.reactionBarMobile:M.reactionBar,children:(0,X.jsx)(ee,{children:(0,X.jsx)(wt().DU,{parentStore:t,discussionLocation:a,onReactionToggle:s,newReactionStyle:M.newReaction})})})]})})}function si(e){const{commentStore:t}=e,i=(0,r().O7)(),o=(0,y().YB)(),a=(0,n().VK)((()=>{const e=t.getCreatedByPointer();if(e)return k().t1.createChildStore(t,e)}),[t]),s=(0,n().VK)((()=>{if(a)return a.getDisplayName(o)}),[a,o]),d=(0,n().VK)((()=>!!a&&i.currentUser.id===a.id),[i,a]),l=(0,c().yK)((e=>({fullName:{fontWeight:x().Ue.regular,fontSize:12,lineHeight:"22px",color:e.text.secondary},you:{fontWeight:x().Ue.regular,fontSize:12,lineHeight:"22px",color:e.text.tertiary}})),[]);return d?(0,X.jsx)(y()._H,{id:"CommentGroupingActivity.discussionThreadComment.authorLabel",defaultMessage:"<author>{fullName}</author> <you>(You)</you>",values:{author:e=>(0,X.jsx)("span",{style:l.fullName,children:e}),fullName:s,you:e=>(0,X.jsx)("span",{style:l.you,children:e})}}):s?(0,X.jsx)("span",{style:l.fullName,children:s}):(0,X.jsx)("span",{style:l.fullName,children:(0,X.jsx)(y()._H,{id:"CommentGroupingActivity.discussionThreadComment.unknownAuthorLabel",defaultMessage:"Unknown author"})})}function di(e){const{discussionStore:t,commentStore:i}=e,o=(0,r().O7)(),a=(0,c().Fg)(),s=(0,n().VK)((()=>Nt().zP(i).getValue()),[i]),d=(0,n().VK)((()=>i.getSpaceId()),[i]),l=(0,n().VK)((()=>{if(!s||!d)return null;const e=(0,Vt().H4)({textValue:s,currentUserId:o.currentUser.id,getRecordModel:t.getRecordModel,highlightStyle:"text_only"});return(0,Pt().IY)({environment:o,textValue:{value:e,spaceId:d},parentStore:t,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableHover:!0,disabled:!0,theme:a,emojiType:(0,Bt().e_)(o),katex:o.KatexStore.getKatex(),formulaValueTypes:[]})}),[o,t,a,s,d]),u=(0,c().yK)((e=>({commentText:{whiteSpace:"pre-wrap",wordBreak:"break-word",display:"inline",fontSize:14,color:e.regularTextColor,lineHeight:"22px"}})),[]);return(0,X.jsx)("span",{style:u.commentText,children:l})}const li=20;function ci(e){const{frontActorStore:t,backActorStore:i}=e,o=(0,c().yK)((()=>({container:{display:"grid",height:oe,width:oe},back:{gridColumn:1,gridRow:1,marginLeft:-3,marginTop:-3,maxWidth:li,minWidth:li},front:{gridColumn:1,gridRow:1,marginLeft:7,marginTop:7,maxWidth:li,minWidth:li}})),[]);return(0,X.jsxs)("div",{style:o.container,children:[(0,X.jsx)("div",{style:o.back,children:(0,X.jsx)(mi,{size:li,actorStore:i,avatar:void 0})}),(0,X.jsx)("div",{style:o.front,children:(0,X.jsx)(mi,{size:li,actorStore:t,avatar:void 0})})]})}function ui(e){const{authorsLength:t,frontActorStore:i,backActorStore:o,authorTextStyle:a}=e,s=(0,r().O7)(),d=(0,y().YB)(),l=s.currentUser.id,c=(0,n().VK)((()=>{if(i)return i.getDisplayName(d)}),[i,d]),u=(0,n().VK)((()=>{if(o)return o.getDisplayName(d)}),[o,d]),g={fontWeight:x().Ue.semibold,...a};return 0===t?(0,X.jsx)("span",{style:g,children:(0,X.jsx)(y()._H,{defaultMessage:"<b>Nobody</b>",id:"activitySection.authorPhraseInboxRedesign.forNoAuthors.label",values:{b:e=>(0,X.jsx)("span",{style:g,children:e})}})}):1===t&&i?i.id===l?(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{defaultMessage:"<b>You</b>",id:"activitySection.authorPhraseInboxRedesign.forOneAuthorCurrentUser.label",values:{b:e=>(0,X.jsx)("span",{style:g,children:e})}})}):(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{defaultMessage:"<b>{author}</b>",id:"activitySection.authorPhraseInboxRedesign.forOneAuthor.label",values:{author:c,b:e=>(0,X.jsx)("span",{style:g,children:e})}})}):2===t?o&&o.id===l?(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{defaultMessage:"<b>{frontActorName} and You</b>",id:"activitySection.authorPhraseInboxRedesign.forTwoAuthorsCurrentUser.label",values:{frontActorName:c,b:e=>(0,X.jsx)("span",{style:g,children:e})}})}):(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{defaultMessage:"<b>{frontActorName} and {backActorName}</b>",id:"activitySection.authorPhraseInboxRedesign.forTwoAuthors.label",values:{frontActorName:c,backActorName:u,b:e=>(0,X.jsx)("span",{style:g,children:e})}})}):t>2?(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{defaultMessage:"<b>{frontActorName} and {numberOfOtherAuthors} others</b>",id:"activitySection.authorPhraseInboxRedesign.forMoreThanTwoAuthors.label",values:{frontActorName:c,numberOfOtherAuthors:t-1,b:e=>(0,X.jsx)("span",{style:g,children:e})}})}):null}function gi(){const e=(0,c().yK)((e=>({icon:{height:14,width:14,fill:e.icon.secondary}})),[]);return(0,X.jsx)(pe,{children:(0,qt().S)(e.icon)})}function mi(e){const{actorStore:t,avatar:i}=e,o=e.size??28;return t?t.table===Se().cZ?(0,X.jsx)(Et().Z,{botStore:t,size:o}):t.table===f().KJ?(0,X.jsx)(zt().Z,{userStore:t,size:o}):t.table===we().y0?(0,X.jsx)(zt().Z,{userStore:void 0,size:o}):void(0,b().t1)(t):i?(0,X.jsx)(zt().Z,{avatar:i,size:o}):(0,X.jsx)(zt().Z,{userStore:void 0,size:o})}const hi=o.memo(Wt);const vi=function(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:a,isLast:s}=e,{tab:d,notification:c}=o,u=(0,r().O7)(),g=(0,n().VK)((()=>(0,Mt().hI)(t.getEdits())),[t]),m=(0,n().VK)((()=>(0,l().P6)({edits:g,rootStore:i})),[g,i]),h=(0,n().VK)((()=>{const e=g[0];return e?e.new_email:""}),[g]);return(0,X.jsx)(fe,{header:(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{defaultMessage:"You updated your email to {newEmail}",values:{newEmail:h},id:"activity.emailEdited.header.short"})}),isFirst:a,isLast:s,isPrivate:!1,rootStore:i,notification:c,icon:(0,X.jsx)(tt().BE,{authors:m,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:void 0,...(0,Oe().JJ)({notification:c,activity:t,environment:u,tab:d})})};var pi=()=>i(959003),fi=()=>i(251932);function yi(){const e=(0,c().yK)((e=>({icon:{height:16,width:16,fill:e.icon.secondary}})),[]);return(0,X.jsx)(pe,{children:(0,pi().c)(e.icon)})}i(470928);var bi=()=>i(641506),xi=()=>i(710125),Si=()=>i(144476),Ai=()=>i(91502),ji=()=>i(577325),_i=()=>i(555813);const Ci=3;function Mi(e){const{userIds:t,remainingAvatarCount:i,shownAvatarCount:o,titledRecordStore:r,isMobile:n}=e,a=(0,c().yK)((e=>({avatarContainer:{display:"flex",flexDirection:"row",justifyContent:"start",overflow:"hidden",paddingRight:2,alignItems:"center"},overlappingAvatar:{marginRight:-5,position:"relative"},rightmostAvatar:{position:"relative"},remainderCount:{paddingLeft:2,color:e.lightTextColor}})),[]);return(0,X.jsxs)("div",{style:a.avatarContainer,children:[t.slice(0,Ci).map(((e,t)=>{const i=k().U6.createChildStore(r,{table:f().KJ,id:e}),s=t===o-1;if(i)return(0,X.jsx)(zt().Z,{userStore:i,size:24,avatarShouldShowShadow:!1,style:s?a.rightmostAvatar:a.overlappingAvatar,isOffline:!1,hasTooltip:!n},e)})),i>0&&(0,X.jsx)("div",{style:a.remainderCount,children:(0,X.jsx)(y()._H,{defaultMessage:"{remainingAvatarCount, plural, one {+{remainingAvatarCount}} other {+{remainingAvatarCount}}}",id:"activity.titleCard.members.otherCount.message",values:{remainingAvatarCount:i}})})]})}function ki(e){const{titledRecordStore:t,rootStore:a,activity:s,tabArgs:d}=e,l=a.getRecordModel,u=(0,n().VK)((()=>t.getModel()),[t]),m=(0,r().O7)(),y=(0,n().VK)((()=>null==u?void 0:u.getRenderIcon({getRecordModel:l})),[u,l]),S=(0,n().VK)((()=>m.device.isMobile),[m]),A=(0,c().yK)((e=>({container:{display:"block",borderWidth:1,borderStyle:"solid",borderColor:e.tint.regular,borderRadius:8,marginTop:0,padding:12,background:e.contentBackground,boxShadow:"0px 1px 2px 0px "+("light"===e.mode?"rgba(0, 0, 0, 0.03)":"rgba(0, 0, 0, 0.12)"),transition:`background ${ne}`},icon:{...it().e9,marginRight:10},activityTitle:{fontSize:14,marginRight:void 0!==y?3:0,display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2,verticalAlign:"top",textAlign:"left",lineHeight:x().Nv.UIRegular.desktop,...x().Yu,whiteSpace:"normal",...it().nP},flexRow:{display:"flex",alignItems:"center"},title:{maxWidth:"80%"},spacer:{flexGrow:1},subtitle:{fontSize:12,color:e.lightTextColor}})),[y]),j=(0,n().VK)((()=>{if(u&&u.table!==p().e0)return u.getRenderUrl({getRecordModel:l,pageVisitSource:g().tY.Notification})}),[u,l]),_=(0,o.useCallback)((e=>{const i=t.table;switch(i){case h().iU:case v().bx:(0,Oe().V3)({environment:m,activity:s,...d});break;case p().e0:(0,Oe().dG)({environment:m,activity:s,...d}),_i().hI({environment:m,teamStore:t,shouldScroll:!0}),ji().Z.setState({...ji().Z.state,open:!1});break;default:(0,b().t1)(i)}}),[s,m,d,t]),C=(0,n().VK)((()=>{const e=t.table,o=(0,i(18281).Io)();let r=[],n=0;switch(e){case"space":if(!t.getModel())break;r=o.map((e=>e.userId)),n=Math.max(0,r.length-Ci);break;case"block":const i=t.getCreatedByPointer();(null==i?void 0:i.table)===f().KJ&&(r=[i.id]),n=Math.max(0,r.length-Ci);break;case"team":const a=(0,Ai().oT)(t);r=(null==a?void 0:a.sampleMemberUserIds)??[],n=Math.max(0,(null==a?void 0:a.memberCount)??0-Ci);break;default:(0,b().t1)(e)}const a=Math.min(r.length,Ci);return(0,X.jsx)(Mi,{userIds:r,remainingAvatarCount:n,shownAvatarCount:a,titledRecordStore:t,isMobile:S})}),[S,t]);return u?(0,X.jsx)(Lt().Z,{href:j,onClick:_,external:!1,innerStyle:A.container,inline:!0,children:(0,X.jsxs)("div",{style:A.flexRow,children:[y&&(0,X.jsx)(W().Z,{disabled:!0,icon:y,isEmptyPage:!1,size:25,style:A.icon}),(0,X.jsx)("div",{style:A.title,children:(0,X.jsx)(J().Z,{store:t,style:A.activityTitle})}),(0,X.jsx)("div",{style:A.spacer}),(0,X.jsx)("div",{children:C})]})}):null}const Ri=o.memo(ki);function Ki(){const e=(0,c().yK)((e=>({icon:{height:16,width:16,fill:e.icon.secondary}})),[]);return(0,X.jsx)(pe,{children:(0,xi().l)(e.icon)})}function Vi(){const e=(0,r().O7)(),t=(0,n().VK)((()=>"dark"===e.ThemeStore.state.mode),[e]),i=(0,c().yK)((e=>({icon:{height:18,width:18,marginTop:2,marginRight:2,fill:t?e.primaryBlack:e.blueColor}})),[t]);return(0,X.jsx)(pe,{children:(0,Si().k)(i.icon)})}var wi=()=>i(352230),Ii=()=>i(850790),Ti=()=>i(104088),Bi=()=>i(529048),Pi=()=>i(198829),Ni=()=>i(470386),Ui=()=>i(679063);function qi(e){const{timestamp:t,header:i,hasChildren:o,navigableBlockId:n,rootStore:a,showRecordPath:s,disableJustify:d,onBacklinkClick:l,titleAriaId:u}=e,g=(0,q().IS)(t,{useUltraCompactFormat:!0}),m=(0,r().O7)().device.isMobile,v=(0,q().uy)(t),p=(0,c().yK)((e=>({container:{width:"100%"},header:{width:m?"calc(100% - 98px)":"100%",fontSize:14,lineHeight:1.4,minWidth:0,minHeight:m?28:void 0,display:"flex",alignItems:"baseline",justifyContent:d?void 0:"space-between"},flatIndentHeader:{width:m?"calc(100% - 98px)":"100%",fontSize:14,lineHeight:1.4,minWidth:0,minHeight:m?28:void 0,display:"flex",justifyContent:"space-between",alignItems:"baseline"},title:{fontSize:14,marginTop:4,marginBottom:o?8:4},time:{fontSize:12,color:e.lightTextColor,whiteSpace:"nowrap",display:"inline",paddingLeft:6},path:{marginTop:4,marginBottom:4},separatorDot:{fontSize:12,color:e.lightTextColor,marginLeft:4,marginRight:4}})),[o,m,d]);return(0,X.jsxs)("div",{style:p.container,children:[(0,X.jsxs)("div",{className:B().NFf,style:p.header,children:[(0,X.jsx)("span",{id:u,children:i}),(0,X.jsx)("div",{style:p.time,className:B().CZG,children:(0,X.jsx)($().Z,{text:g,tooltipText:v,icon:O().C})})]}),s&&n&&a&&(0,X.jsx)("div",{style:p.path,children:(0,X.jsx)(Ui().ZP,{isLink:!0,store:k().G.createChildStore(a,{table:h().iU,id:n}),onClick:l})})]})}const Oi=1;function Hi(e){const{rootStore:t,activity:i,isLast:a,tabArgs:s,edits:d,style:u,isFirst:m}=e,{tab:v,notification:p,source:f}=s,y=(0,r().O7)(),S=d.at(0),[A,j]=(0,o.useState)(null),_=(0,o.useMemo)((()=>A&&A.scrollHeight>A.clientHeight),[A]),C=(0,n().VK)((()=>{if(!S)return;const e=k().G.createChildStore(t,{table:h().iU,id:S.navigable_block_id});return(0,b().$K)(e)?e:void 0}),[S,t]),M=(0,n().VK)((()=>{const e=null==C?void 0:C.getModel();if(e)return e.getRenderUrl({getRecordModel:t.getRecordModel,pageVisitSource:g().tY.Notification})}),[t,C]),R=(0,n().VK)((()=>(0,l().jC)({recordId:null==C?void 0:C.id,recordType:h().iU,tab:v,rootStore:t,environment:y})),[C,v,t,y]),K=(0,c().yK)((e=>({formattedTitleStyle:{fontSize:x().JB.UISmall.desktop,color:e.lightTextColor},container:{paddingBlock:4,display:"flex",flexDirection:"row",columnGap:1.5*Number((0,it()._W)(e).paddingLeft),alignItems:"center"},unarchiveButton:{marginLeft:-1*Number((0,it()._W)(e).paddingLeft)}})),[]),V=(0,o.useMemo)((()=>new Set(d.map((e=>e.automation_id)))),[d]),w=1===V.size;return(0,b().$K)(C)&&(0,b().$K)(S)?(0,X.jsx)(fe,{header:(0,X.jsx)(Zi,{rootStore:t,uniqueAutomations:V,firstEdit:S,spaceId:i.spaceId,environment:y,shortened:!1,titleStyle:{fontWeight:x().Ue.semibold}}),isFirst:m,isLast:a,isPrivate:R,rootStore:t,navigableBlockId:C.id,notification:p,icon:(0,X.jsx)(Di,{}),showSnapshotButton:!1,url:M,...(0,Oe().JJ)({notification:p,activity:i,environment:y,tab:v}),children:(0,X.jsxs)("div",{style:u,children:[d.slice(-1*Oi).map(((i,o)=>(0,X.jsxs)("div",{children:[!w&&(0,X.jsx)(Zi,{rootStore:t,firstEdit:i,uniqueAutomations:new Set([i.automation_id]),shortened:!0,spaceId:i.space_id,environment:y,titleStyle:K.formattedTitleStyle}),(0,X.jsx)(zi,{...e,edit:i,isViewAllMenu:!1,source:f,isLast:d.length>Oi?o===d.length-1-Oi:o===d.length-1,clampedMessageContainerRef:j})]},o))),(0,X.jsx)("div",{style:K.container,children:(_||d.length>Oi)&&(0,X.jsx)(Li,{edits:d,rootStore:t,activity:i,navigableBlockStore:C,source:f})})]})}):null}function Li(e){const{edits:t,rootStore:i,activity:a,navigableBlockStore:s,source:d}=e,l=(0,r().Fy)(),u=(0,r().O7)(),{handleAnalyticsForPopupMenu:g}=(0,o.useContext)(Wi),m=(0,n().qz)(void 0,Bi().Z),h=(0,o.useCallback)((()=>m.reset()),[m]),v=(0,o.useMemo)((()=>(0,X.jsx)(y()._H,{defaultMessage:"{numNotifications, plural, one {View more} other {View {numRemainingNotifications}}}",id:"inAppNotificationAutomationActionTriggeredActivity.renderViewAllNotificationsButton.buttonLabel",values:{numNotifications:t.length,numRemainingNotifications:t.length}})),[t.length]);let p;p=l.isMobile?{menuType:wi().o.Modal,title:v,right:(0,X.jsx)(Ni().DoneMenuText,{}),onClickRight:h,whiteBackground:!0}:{menuType:wi().o.Popup,width:420,maxWidth:l.isMobileBrowser?"80vw":"100%"};const f=(0,c().yK)((e=>({actionButton:(0,it().b9)(e),divider:{borderBlockEnd:`1px solid ${e.regularDividerColor}`},viewAllMenuNotificationContainer:{display:"flex",flexDirection:"column",padding:12},viewAllMenuHeaderContainer:{display:"flex",flexDirection:"row",gap:ie},popupMenu:{marginInlineStart:-2,fontSize:ue}})),[]),b=(0,o.useId)();return(0,X.jsx)(F().ZP,{buttonPopupStore:m,popupType:l.isMobile?Ti().k.SlideUp:Ti().k.Popup,placementToOrigin:z().Placement.Bottom,alignmentToOrigin:z().Alignment.Center,originGap:4,onClick:()=>!m.state.open&&g(),renderOrigin:e=>(0,X.jsx)(ye().Z,{...e,style:f.actionButton,children:v}),render:()=>(0,X.jsx)(Pi().Z,{...p,children:(0,X.jsx)("div",{style:f.popupMenu,children:t.map(((o,r)=>(0,X.jsxs)("div",{children:[(0,X.jsxs)("div",{style:f.viewAllMenuNotificationContainer,children:[(0,X.jsxs)("div",{style:f.viewAllMenuHeaderContainer,children:[(0,X.jsx)(Di,{}),(0,X.jsx)(qi,{timestamp:o.timestamp,titleAriaId:b,onBacklinkClick:()=>null,hasChildren:!0,disableJustify:!0,header:(0,X.jsx)(Zi,{rootStore:i,uniqueAutomations:new Set([o.automation_id]),firstEdit:o,spaceId:a.spaceId,environment:u,closeViewAllMenu:h,shortened:!0,titleStyle:{fontWeight:x().Ue.semibold}}),rootStore:i,navigableBlockId:s.id,showRecordPath:!1})]}),(0,X.jsx)(zi,{...e,edit:o,isViewAllMenu:!0,source:d,isLast:r===t.length-1},r)]}),r!==t.length-1&&(0,X.jsx)("div",{style:f.divider})]},r)))})})})}const Ei=4;function zi(e){const{edit:t,rootStore:i,source:o,isViewAllMenu:a,clampedMessageContainerRef:s}=e,d=(0,c().Fg)(),l=(0,r().O7)(),u=(0,r().Fy)(),{isMobile:g}=u,m=(0,n().VK)((()=>l.KatexStore.getKatex()),[l]),h=(0,Bt().kw)(),v=(0,n().VK)((()=>(0,X.jsx)("div",{children:(0,Pt().IY)({environment:l,textValue:t.message.value?{value:t.message.value,spaceId:t.space_id}:void 0,parentStore:i,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disabled:!1,theme:d,emojiType:h,katex:m,parentBlockId:void 0,renderedPageBlockId:void 0,formulaValueTypes:[],stopLinkPropagation:!0})})),[l,h,m,d,t.message.value,i,t.space_id]),p=(0,c().yK)((e=>({container:{paddingInlineStart:a?32:(0,it().c3)({source:o,isMobile:g}),paddingBlockEnd:4},messageContainer:{position:"relative",display:"flex",justifyContent:"space-between",alignItems:"center"},clampedMessageContainer:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:a?void 0:Ei,verticalAlign:"top",textAlign:"left",lineHeight:x().Nv.UIRegular.desktop,...x().Yu},messageContent:{whiteSpace:"pre-wrap",wordBreak:"break-word",fontSize:ue,lineHeight:(0,bi().Dp)({device:u},"UIRegular"),paddingInlineEnd:8}})),[g,o,u,a]);return(0,X.jsx)("div",{style:{...a&&p.container,...p.messageContainer},children:(0,X.jsx)("div",{ref:s,style:p.clampedMessageContainer,children:(0,X.jsx)("div",{style:p.messageContent,children:v})})})}function Zi(e){const{rootStore:t,spaceId:i,environment:o,closeViewAllMenu:r,shortened:a,titleStyle:s,firstEdit:d,uniqueAutomations:c}=e,u=(0,y().YB)(),m=1===c.size,v=(0,n().VK)((()=>!k().Mz.createChildStore(t,{table:yt().cv,id:d.automation_id,spaceId:t.getSpaceId()}).getAlive()),[t,d]),p=(0,n().VK)((()=>{const e=new(k().G)(o,{id:d.automation_navigable_block_id,table:h().iU}).getRole();return!e||!(0,Ve().YX)(e)}),[d,o]),f=(0,n().VK)((()=>{if(!(v&&m||p))return()=>{const e=d.automation_navigable_block_id,i=d.automation_id,n=k().G.createChildStore(t,{table:h().iU,id:e});if(!n)return;r&&r();const a=(0,St().ZP)({store:n,preferPublicLink:!1,pageVisitSource:g().tY.Notification});bt().c4({environment:o,url:a,callback:async()=>await(0,l().dM)({automationNavigableBlockStore:n,automationId:m?i:void 0,rootStore:t,source:"in_app_notification"})})}}),[o,m,d,t,r,v,p]),x=(0,n().VK)((()=>[...c].map((e=>{const o=t.getRecordStore(t,{table:yt().cv,id:e,spaceId:i}),r=o.getRole();return(0,b().$K)(r)&&(0,Ve().YX)(r)?o.getAlive()?o.getNameWithDefault(u):u.formatMessage(ft().pQ.automationDeletedName):u.formatMessage(ft().pQ.automationPrivateName)}))),[u,t,i,c]);return a?(0,X.jsx)("div",{style:{...s,display:"inline-flex"},children:(0,X.jsx)(Fi,{handleAutomationNavigate:f,automationNames:x})}):(0,X.jsx)(y()._H,{id:"inAppNotificationAutomationActionTriggeredActivity.formattedHeaderMessage.automationTitle",defaultMessage:"{automationNameWrappedHeader} sent you a message",values:{automationNameWrappedHeader:(0,X.jsx)("div",{style:{...s,display:"inline-flex"},children:(0,X.jsx)(Fi,{handleAutomationNavigate:f,automationNames:x})})}})}function Fi(e){const{automationNames:t,handleAutomationNavigate:i}=e,o=(0,y().YB)(),r=t.at(0),n=t.length,a=n-2,s=o.formatList([...t.slice(0,2),a>0?o.formatMessage({defaultMessage:"{numRemainingAutomations} more",id:"inAppNotificationAutomationActionTriggeredActivity.wrappedAutomationName.tooltipNumRemainingAutomations"},{numRemainingAutomations:a}):void 0].filter(b().$K),{style:"long",type:"conjunction"}),d={defaultMessage:"{numAutomations, plural, one {{firstAutomationName}} other {{numAutomations} automations}}",values:{firstAutomationName:r,numAutomations:n},id:"inAppNotificationAutomationActionTriggeredActivity.wrappedAutomationName.automationName",description:"The display name for an automation."},l=e=>i?(0,X.jsx)(jt().Z,{...e,onClick:i,children:(0,X.jsx)(y()._H,{...d})}):(0,X.jsx)("div",{...e,children:(0,X.jsx)(y()._H,{...d,...e})});return 1===n?l():(0,X.jsx)(G().Z,{renderTooltip:e=>(0,X.jsx)("div",{...e,children:s}),render:e=>l(e)})}function Di(){const e=(0,c().yK)((e=>({icon:{height:12,width:12,fill:e.icon.secondary}})),[]);return(0,X.jsx)(pe,{children:(0,Ii().K)(e.icon)})}const Wi=(0,o.createContext)({handleAnalyticsForPopupMenu:()=>{}});function Ji(e){const{analyticsInfo:t,children:i}=e,r=(0,o.useCallback)((()=>Ie().hI(t)),[t]);return(0,X.jsx)(Wi.Provider,{value:{handleAnalyticsForPopupMenu:r},children:i})}Wi.displayName="InAppNotificationAutomationActionTriggeredAnalyticsContext";var Gi=()=>i(72539);const Yi=function(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:a,isLast:s}=e,{tab:d,notification:c}=o,u=(0,r().O7)(),g=(0,n().VK)((()=>t.getEdits()),[t]),m=(0,n().VK)((()=>(0,l().P6)({edits:g,rootStore:i})),[g,i]),v=(0,n().VK)((()=>(0,l().XW)(m,{...(0,M().h_)()})),[m]),p=(0,n().VK)((()=>{const e=k().G.createChildStore(i,{table:h().iU,id:t.navigable_block_id});if(e.isDefined())return e}),[t,i]),b=(0,n().VK)((()=>Boolean(p&&(0,l().jC)({recordId:p.id,recordType:h().iU,tab:d,rootStore:i,environment:u}))),[p,d,i,u]),x=g[0],S=(0,n().VK)((()=>(0,l().N8)(x.from_user_id,i)),[x,i]),A=(0,n().VK)((()=>(0,l().N8)(x.to_user_id,i)),[x,i]);if(!(g.length>0&&S&&A&&p))return null;const _=(0,xe().$4)(j().Z.getIntl(),(0,xe().LU)({table:f().KJ,value:S}));return(0,X.jsx)(fe,{header:(0,X.jsx)(y()._H,{defaultMessage:"{authorPhrase} transferred {fromUserName}{fromUserNameEndsWithS, select, true {} other {s}} private pages to you",values:{authorPhrase:v,fromUserName:_,fromUserNameEndsWithS:"s"===_.slice(-1).toLowerCase()},id:"activity.privateContentTransferred.standardizedHeader.short"}),isPrivate:b,rootStore:i,notification:o.notification,isFirst:a,isLast:s,icon:(0,X.jsx)(tt().BE,{authors:m,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:void 0,...(0,Oe().JJ)({notification:c,activity:t,environment:u,tab:d})})};var $i=()=>i(746822);function Xi(){const e=(0,c().yK)((e=>({icon:{height:16,width:16,fill:e.icon.secondary}})),[]);return(0,X.jsx)(pe,{children:(0,$i().m)(e.icon)})}function Qi(e){const{titledRecordStore:t,rootStore:i,activity:a,tabArgs:s}=e,d=i.getRecordModel,l=(0,n().VK)((()=>t.getModel()),[t]),u=(0,r().O7)(),g=(0,n().VK)((()=>u.device.isMobile),[u]),m=(0,n().VK)((()=>null==l?void 0:l.getRenderIcon({getRecordModel:d})),[l,d]),v=(0,o.useCallback)((o=>{const r=t.table;switch(r){case h().iU:(0,Oe().V3)({environment:u,activity:a,...s});break;case p().e0:(0,Oe().V3)({environment:u,activity:a,...s}),_i().hI({environment:u,teamStore:t,shouldScroll:!0}),ji().Z.setState({...ji().Z.state,open:!1});const n=e.notification;if(!n||n.read)break;(0,N().ZP)({event:o,context:N().Af.NotificationClick,callback:()=>{T().createAndCommit({userAction:"NotificationTitleCard.handleMarkAsRead",environment:u,canUndo:!0,perform:e=>{w().$h({notification:n,rootStore:i,transaction:e,read:!0})}})}});break;default:(0,b().t1)(r)}}),[a,u,e.notification,i,s,t]),[y,S]=o.useState(!1),[A,j]=o.useState(!1),_=(0,c().yK)((e=>({container:{display:"flex",alignItems:"center",borderRadius:8,background:A?e.state.pressed:y?e.state.hover:"transparent",transition:`background ${ne}`,marginTop:0,padding:12,boxShadow:"0px 1px 2px 0px "+("light"===e.mode?"rgba(0, 0, 0, 0.03)":"rgba(0, 0, 0, 0.12)"),border:"1px",borderStyle:"solid",borderColor:e.tint.regular,cursor:y?"pointer":"default"},icon:{...it().e9,marginRight:10},activityTitle:{fontSize:14,marginRight:void 0!==m?3:0,display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2,verticalAlign:"top",textAlign:"left",lineHeight:x().Nv.UIRegular.desktop,...x().Yu,whiteSpace:"normal",...it().nP},title:{maxWidth:"80%"},spacer:{flexGrow:1},subtitle:{fontSize:12,color:e.lightTextColor},avatarContainer:{display:"flex",flexDirection:"row",justifyContent:"start",overflow:"hidden",paddingRight:2,alignItems:"center"},overlappingAvatar:{marginRight:-5,position:"relative"},rightmostAvatar:{position:"relative"},remainderCount:{paddingLeft:2,color:e.lightTextColor}})),[m,y,A]),C=(0,n().VK)((()=>{let e=[],i=0;const o=t.table;switch(o){case"block":const r=t.getCreatedByPointer();(null==r?void 0:r.table)===f().KJ&&(e=[r.id]),i=Math.max(0,e.length-Ci);break;case"team":const n=(0,Ai().oT)(t);e=(null==n?void 0:n.sampleMemberUserIds)??[],i=Math.max(0,(null==n?void 0:n.memberCount)??0-Ci);break;default:(0,b().t1)(o)}const r=Math.min(e.length,Ci);return(0,X.jsx)(Mi,{userIds:e,remainingAvatarCount:i,shownAvatarCount:r,titledRecordStore:t,isMobile:g})}),[g,t]);return l?(0,X.jsxs)("div",{style:_.container,onMouseEnter:()=>S(!0),onMouseLeave:()=>S(!1),onMouseDown:()=>j(!0),onMouseUp:()=>j(!1),onClick:v,children:[m&&(0,X.jsx)(W().Z,{disabled:!0,icon:m,isEmptyPage:!1,size:25,style:_.icon}),(0,X.jsx)("div",{style:_.title,children:(0,X.jsx)(J().Z,{store:t,style:_.activityTitle})}),(0,X.jsx)("div",{style:_.spacer}),(0,X.jsx)("div",{children:C})]}):null}const eo=o.memo(Qi);var to=()=>i(309672),io=()=>i(126139),oo=()=>i(293338),ro=()=>i(326966);function no(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:a,isLast:s}=e,{notification:d,tab:c}=o,u=(0,r().O7)(),m=(0,n().VK)((()=>t.getEdits()),[t]),h=m[0],v=co({rootStore:i,edit:h}),p=function(e){let{data:t,tab:i,rootStore:o}=e;const a=(0,r().O7)();return(0,n().VK)((()=>{if("block"!==(null==t?void 0:t.type))return!1;const e=t.blockStore.id;return(0,l().jC)({recordId:e,recordType:"block",tab:i,rootStore:o,environment:a})}),[t,a,o,i])}({data:v,tab:c,rootStore:i}),f=(0,n().VK)((()=>(0,l().P6)({edits:m,rootStore:i})),[m,i]),y=(0,n().VK)((()=>{if("block"===(null==v?void 0:v.type))return v.blockStore}),[v]),b=(0,n().VK)((()=>{if(!y)return;const e=y.getModel();return e?e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:g().tY.Notification}):void 0}),[y,i.getRecordModel]),x=(0,n().VK)((()=>t.navigable_block_id),[t]);if(0===m.length||!v)return null;const S=0===f.filter(xe().uC).length,A=S?void 0:(0,X.jsx)(tt().BE,{authors:f,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1});return(0,X.jsxs)(fe,{header:(0,X.jsx)(so,{data:v,authors:f,isFromBot:S}),hidePageTitle:!0,isFirst:a,isLast:s,isPrivate:p,rootStore:i,navigableBlockId:x,notification:d,icon:A,showSnapshotButton:!1,url:b,...(0,Oe().JJ)({notification:d,environment:u,tab:c,activity:t}),children:[(0,X.jsx)(lo,{...e,edit:h}),(0,X.jsx)(ao,{data:v,rootStore:i,activity:t,tabArgs:o})]})}function ao(e){var t;const{data:i,rootStore:o,activity:r,tabArgs:n}=e,a=(0,c().yK)((e=>({group:{color:e.mediumTextColor,fontSize:14},titleCardWrapper:{display:"contents",pointerEvents:"none"}})),[]);switch(i.type){case"block":return(0,X.jsx)(ee,{children:(0,X.jsx)(eo,{titledRecordStore:i.blockStore,rootStore:o,activity:r,tabArgs:n})});case"group":return(0,X.jsx)("div",{style:a.group,children:(0,X.jsx)(y()._H,{defaultMessage:"You will now get notifications when @{groupName} is mentioned",id:"activity.userInvitedActivity.groupInviteExplanation",values:{groupName:null===(t=i.group)||void 0===t?void 0:t.name}})});case"space":return(0,X.jsx)(ee,{children:(0,X.jsx)("div",{style:a.titleCardWrapper,children:(0,X.jsx)(Ri,{tabArgs:n,titledRecordStore:i.spaceStore,rootStore:o,activity:r})})});default:(0,b().t1)(i)}}function so(e){var t,i;const{data:o,authors:r,isFromBot:a}=e,s=(0,n().VK)((()=>(0,l().XW)(r,{...(0,M().h_)()})),[r]);switch(o.type){case"block":return a?(0,X.jsx)(y()._H,{defaultMessage:"You were invited to a page",id:"activity.userInvitedActivityByBot.standardizedHeader.redesign"}):(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a page} other {{authorOrAuthors} invited you to a page}}",values:{numberOfAuthors:r.length,authorOrAuthors:s},id:"activity.userInvitedActivity.standardizedHeader.redesign"});case"group":return a?(0,X.jsx)(y()._H,{defaultMessage:"You were added to @{groupName}",values:{groupName:null===(t=o.group)||void 0===t?void 0:t.name},id:"activity.userInvitedActivityGroupIdByBot.standardizedHeader.redesign"}):(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to @{groupName}} other {{authorOrAuthors} added you to @{groupName}}}",values:{numberOfAuthors:r.length,authorOrAuthors:s,groupName:null===(i=o.group)||void 0===i?void 0:i.name},id:"activity.userInvitedActivityGroupId.standardizedHeader.redesign"});case"space":return a?(0,X.jsx)(y()._H,{defaultMessage:"You were invited to a workspace",id:"activity.userInvitedActivityOtherInviteByBot.standardizedHeader.redesign"}):(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a workspace} other {{authorOrAuthors} invited you to a workspace}}",values:{numberOfAuthors:r.length,authorOrAuthors:s},id:"activity.userInvitedActivityOtherInvite.standardizedHeader.redesign"});default:(0,b().t1)(o)}}function lo(e){const{edit:t,activity:i,rootStore:o,tabArgs:a}=e,s=(0,r().O7)(),{isMobile:d}=s.device,{source:l}=a,u=(0,c().yK)((()=>({redesignedInviteMessage:{fontSize:14,paddingTop:8,paddingBottom:8},inviteMessage:{paddingLeft:(0,it().c3)({source:l,isMobile:d}),paddingTop:8,paddingBottom:8,paddingRight:12,fontSize:14}})),[d,l]),g=co({rootStore:o,edit:t}),m=(0,n().VK)((()=>parseInt(i.end_time)),[i]),h=(0,n().VK)((()=>{if("block"!==(null==g?void 0:g.type))return;const e=g.blockStore;return null!=e&&e.isDefined()?e.getModel():void 0}),[g]),v=(0,n().VK)((()=>{if(!h)return{isValid:!1};const e=h&&(0,oo().$e)(h,i);if(!e)return{isValid:!1};const t=o.getRecordModel({table:io().Tu,id:e,spaceId:i.space_id});return t&&t.getMessage()&&t.getCreatedTime()<=m+5*ro().hM?{isValid:!0,message:t.getMessage()}:{isValid:!1}}),[i,m,h,o]);return null!=v&&v.isValid?(0,X.jsx)("div",{style:u.redesignedInviteMessage,children:v.message}):null}function co(e){let{rootStore:t,edit:i}=e;return(0,n().VK)((()=>{if(i)return i.navigable_block_id?{type:"block",blockStore:k().G.createChildStore(t,{table:h().iU,id:i.navigable_block_id})}:i.permission_group_id?{type:"group",group:(0,to().Bg)({spaceId:i.space_id,permissionGroupId:i.permission_group_id,getRecordValue:t.getRecordValue})}:{type:"space",spaceStore:k().H2.createChildStore(t,{table:v().bx,id:i.space_id})}}),[i,t])}var uo=()=>i(926724);function go(e){const{mentionedProperty:t,authorPhrase:i,authors:o}=e;switch(t){case uo().Es.Assign:return(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} assigned you a task} other {{authorOrAuthors} assigned you a task}}",values:{numberOfAuthors:o.length,authorOrAuthors:i},id:"activity.mentionTaskActivity.standardizedHeader"});case uo().zI.People:return(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned you in} other {{authorOrAuthors} mentioned you in}}",values:{numberOfAuthors:o.length,authorOrAuthors:i},id:"activity.mentionProjectActivity.standardizedHeader.short"});default:return(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned you in} other {{authorOrAuthors} mentioned you in}}",values:{numberOfAuthors:o.length,authorOrAuthors:i},id:"activity.mentionActivity.standardizedHeader.short"})}}var mo=()=>i(496205),ho=()=>i(541402);function vo(){const e=(0,c().yK)((e=>({icon:{height:16,width:16,fill:e.icon.secondary}})),[]);return(0,X.jsx)(pe,{children:(0,ho().f)(e.icon)})}function po(e){const t=(0,r().O7)();return(0,o.useEffect)((()=>{!function(e,t){if("commented"===e.type){const o=t.getRecordStore(t,{table:d().qF,id:e.discussion_id,spaceId:e.space_id});if(o.isDefined()){const e=o.getCommentStores();for(const t of e){var i;null===(i=t.getCreatedByStore())||void 0===i||i.load()}}}}(e.activity,e.rootStore),t.KatexStore.loadIfNeeded((()=>function(e,t){const i=(0,l().cr)({activity:e,rootStore:t});if(!i)return;return i.context}(e.activity,e.rootStore)))}),[t.KatexStore,e.activity,e.rootStore]),(0,X.jsx)("div",{children:(0,X.jsx)(yo,{...e})})}const fo={"block-property-edited":function(e){const{activity:t,rootStore:o,tabArgs:a,isFirst:s,isLast:d}=e,{tab:c,notification:u}=a,m=(0,n().VK)((()=>(0,Mt().hI)(t.getEdits())),[t]),v=m.length>0,p=(0,n().VK)((()=>k().G.createChildStore(o,{table:h().iU,id:m[0].navigable_block_id})),[o,m]),f=(0,n().VK)((()=>{const e=p.getModel();if(e)return e.getRenderUrl({getRecordModel:o.getRecordModel,pageVisitSource:g().tY.Notification})}),[p,o]),b=(0,n().VK)((()=>(0,l().P6)({edits:m,rootStore:o})),[m,o]),x=(0,r().O7)(),S=(0,n().VK)((()=>(0,l().XW)(b,{...(0,M().h_)()})),[b]),A=(0,n().VK)((()=>(0,l().jC)({recordId:p.id,recordType:"block",tab:c,rootStore:o,environment:x})),[p,c,o,x]);if(!(0,n().VK)((()=>p.isDefined()),[p])||!v)return null;const j=new Set;return m.forEach((e=>{Object.keys(e.property_updates).forEach((e=>{j.add(e)}))})),(0,X.jsx)(fe,{header:j.size>1?(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} updated properties} other {{authorOrAuthors} updated properties}}",id:"activity.blockEdited.standardizedHeader.multiple",values:{numberOfAuthors:b.length,authorOrAuthors:S}})}):(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} updated a property} other {{authorOrAuthors} updated a property}}",id:"activity.blockEdited.standardizedHeader.single",values:{numberOfAuthors:b.length,authorOrAuthors:S}})}),isFirst:s,isLast:d,isPrivate:A,rootStore:o,navigableBlockId:p.id,notification:u,icon:(0,X.jsx)(tt().BE,{authors:b,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:f,...(0,Oe().JJ)({notification:u,activity:t,environment:x,tab:c}),children:(0,X.jsx)(i(75308).Z,{visible:5,items:m.map(((e,t)=>(0,X.jsx)(kt().Z,{edit:e,rootStore:o},t)))})})},"user-mentioned":function(e){const{activity:t,rootStore:o,tabArgs:a,isFirst:s,isLast:d}=e,{tab:c,notification:u}=a,m=(0,r().O7)(),v=(0,n().VK)((()=>t.getEdits()),[t]),p=v.length>0,f=v[0],y=k().G.createChildStore(o,{table:h().iU,id:f.navigable_block_id}),b=(0,n().VK)((()=>y.isDefined()),[y]),x=(0,n().VK)((()=>k().WJ.createChildStore(o,{table:i(114882).TY,id:t.id,spaceId:t.space_id}).getStandardizedMentionedPropertyURI()),[t,o]),S=(0,n().VK)((()=>{const e=k().G.createChildStore(o,{table:h().iU,id:t.mentioned_block_id}).getModel();return null==e?void 0:e.getRenderUrl({getRecordModel:o.getRecordModel,pageVisitSource:g().tY.Notification})}),[t,o]),A=(0,n().VK)((()=>(0,l().P6)({edits:v,rootStore:o})),[v,o]),j=(0,n().VK)((()=>(0,l().XW)(A,{...(0,M().h_)()})),[A]),_=(0,n().VK)((()=>(0,l().jC)({recordId:y.id,recordType:"block",tab:c,rootStore:o,environment:m})),[y,c,o,m]);return p&&b&&S?(0,X.jsx)(fe,{header:(0,X.jsx)(go,{mentionedProperty:x,authorPhrase:j,authors:A}),isFirst:s,isLast:d,isPrivate:_,rootStore:o,navigableBlockId:y.id,notification:u,icon:(0,X.jsx)(tt().BE,{authors:A,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:S,...(0,Oe().JJ)({notification:u,activity:t,environment:m,tab:c}),children:(0,X.jsx)(kt().Z,{edit:f,rootStore:o,highlightCurrentUser:!0,highlightCurrentUserStyle:"text_only"})}):null},commented:hi,"user-invited":o.memo(no),reminder:function(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:a,isLast:s}=e,{notification:d,tab:c}=o,u=(0,r().O7)(),m=(0,n().VK)((()=>t.getEdits()),[t]),v=m.length>0,p=k().G.createChildStore(i,{table:h().iU,id:m[0].navigable_block_id}),f=(0,n().VK)((()=>p.isDefined()),[p]),b=(0,n().VK)((()=>{const e=k().G.createChildStore(i,{table:h().iU,id:t.reminder_block_id}).getModel();if(e)return e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:g().tY.Notification})}),[t,i]),S=(0,n().VK)((()=>(0,l().jC)({recordId:p.id,recordType:h().iU,tab:c,rootStore:i,environment:u})),[p,c,i,u]);return v&&f&&b?(0,X.jsx)(fe,{header:(0,X.jsx)("span",{style:{fontWeight:x().Ue.medium},children:(0,X.jsx)(y()._H,{defaultMessage:"Reminder",id:"activity.reminderInActivity.header.short"})}),isFirst:a,isLast:s,isPrivate:S,rootStore:i,navigableBlockId:p.id,notification:d,icon:(0,X.jsx)(Xi,{}),showSnapshotButton:!1,url:b,...(0,Oe().JJ)({notification:d,activity:t,environment:u,tab:c}),children:(0,X.jsx)(kt().Z,{edit:m[0],rootStore:i})}):null},"email-edited":vi,"access-requested":mt,"access-request-resolved":pt,"team-membership-edited":function(e){const{activity:t,rootStore:o,tabArgs:a,isFirst:s,isLast:d}=e,{notification:c,tab:u}=a,m=(0,r().O7)(),h=(0,n().VK)((()=>t.getEdits()),[t]),v=h.length>0,f=(0,n().VK)((()=>(0,l().P6)({edits:h,rootStore:o})),[h,o]),b=(0,n().VK)((()=>(0,l().XW)(f,{...(0,M().h_)()})),[f]),x=h[0],S=k().zX.createChildStore(o,{table:p().e0,id:x.team_id}),A=(0,n().VK)((()=>S.isDefined()),[S]),j=(0,n().VK)((()=>{if((0,i(142589).U)({isMobileNative:m.device.isMobileNative}))return(0,i(161002).y)({teamId:x.team_id,pageVisitSource:g().tY.Notification})}),[x.team_id,m]);return v&&A?(0,X.jsx)(fe,{header:(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a teamspace} other {{authorOrAuthors} invited you to a teamspace}}",values:{numberOfAuthors:f.length,authorOrAuthors:b},id:"activity.userInvitedToTeamActivity.standardizedHeader"}),isFirst:s,isLast:d,isPrivate:!1,rootStore:o,notification:c,icon:(0,X.jsx)(tt().BE,{authors:f,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:j,...(0,Oe().JJ)({notification:c,activity:t,environment:m,tab:u}),children:(0,X.jsx)(ee,{children:(0,X.jsx)(eo,{titledRecordStore:S,rootStore:o,activity:t,tabArgs:a,notification:c})})}):null},"private-content-transferred":Yi,"permission-group-mentioned":function(e){const{activity:t,rootStore:i,isFirst:o,isLast:a,tabArgs:s}=e,{tab:d,notification:c}=s,u=(0,r().O7)(),m=(0,n().VK)((()=>t.getEdits()),[t]),v=m.length>0,p=m[0],f=k().G.createChildStore(i,{table:h().iU,id:p.navigable_block_id}),b=(0,n().VK)((()=>f.isDefined()),[f]),x=(0,n().VK)((()=>{const e=k().G.createChildStore(i,{table:h().iU,id:t.mentioned_block_id}).getModel();if(e)return e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:g().tY.Notification})}),[t,i]),S=(0,n().VK)((()=>(0,l().P6)({edits:t.getEdits(),rootStore:i})),[t,i]),A=(0,n().VK)((()=>(0,l().XW)(S,{...(0,M().h_)()})),[S]),j=(0,n().VK)((()=>(0,l().jC)({recordId:f.id,recordType:h().iU,tab:d,rootStore:i,environment:u})),[f,d,i,u]);return v&&b&&x?(0,X.jsx)(fe,{header:(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned your group} other {{authorOrAuthors} mentioned your group}}",values:{numberOfAuthors:S.length,authorOrAuthors:A},id:"activity.groupMentionActivity.standardizedHeader.short"})}),isFirst:o,isLast:a,isPrivate:j,rootStore:i,navigableBlockId:f.id,notification:c,icon:(0,X.jsx)(tt().BE,{authors:S,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:x,...(0,Oe().JJ)({notification:c,activity:t,environment:u,tab:d}),children:(0,X.jsx)(kt().Z,{edit:p,rootStore:i,highlightCurrentUser:!0,highlightCurrentUserStyle:"text_only"})}):null},"team-mentioned":function(e){const{activity:t,rootStore:i,isFirst:o,isLast:a,tabArgs:s}=e,{tab:d,notification:c}=s,u=(0,r().O7)(),m=(0,n().VK)((()=>t.getEdits()),[t]),v=m.length>0,p=m[0],f=(0,n().VK)((()=>k().G.createChildStore(i,{table:h().iU,id:p.navigable_block_id})),[p,i]),b=(0,n().VK)((()=>f&&f.isDefined()),[f]),x=(0,n().VK)((()=>{const e=k().G.createChildStore(i,{table:h().iU,id:t.mentioned_block_id}).getModel();if(e)return e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:g().tY.Notification})}),[t,i]),S=(0,n().VK)((()=>(0,l().P6)({edits:t.getEdits(),rootStore:i})),[t,i]),A=(0,n().VK)((()=>(0,l().XW)(S,{...(0,M().h_)()})),[S]),j=(0,n().VK)((()=>(0,l().jC)({recordId:f.id,recordType:h().iU,tab:d,rootStore:i,environment:u})),[f,d,i,u]);return v&&b&&x?(0,X.jsx)(fe,{header:(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned your teamspace} other {{authorOrAuthors} mentioned your teamspace}}",values:{numberOfAuthors:S.length,authorOrAuthors:A},id:"activity.teamMentionActivity.standardizedHeader.short"})}),isFirst:o,isLast:a,isPrivate:j,rootStore:i,navigableBlockId:f.id,notification:c,icon:(0,X.jsx)(tt().BE,{authors:S,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:x,...(0,Oe().JJ)({notification:c,activity:t,environment:u,tab:d}),children:(0,X.jsx)(kt().Z,{edit:p,rootStore:i,highlightCurrentUser:!0,highlightCurrentUserStyle:"text_only"})}):null},"verification-expired":function(e){const{activity:t,rootStore:o,tabArgs:a,isFirst:s,isLast:d}=e,{tab:u,notification:m}=a,v=(0,r().O7)(),p=(0,n().VK)((()=>k().G.createChildStore(o,{table:h().iU,id:t.navigable_block_id})),[t,o]),f=(0,n().VK)((()=>p.isDefined()),[p]),b=(0,n().VK)((()=>{const e=p.getModel();if(e)return e.getRenderUrl({getRecordModel:o.getRecordModel,pageVisitSource:g().tY.Notification})}),[p,o]),S=(0,n().VK)((()=>t.collection_id?k().NW.createChildStore(o,{table:i(752778).vF,id:t.collection_id,spaceId:t.space_id}):void 0),[t,o]),A=(0,n().VK)((()=>!(null==S||!S.isPageTreeCollection())),[S]),j=(0,n().VK)((()=>{let e;if(A){const t=null==S?void 0:S.getSchema();e=(t?Object.keys(t):[]).find((e=>{var i;return!!t&&"verification"===(null===(i=t[e])||void 0===i?void 0:i.type)}))}else e=mo().EI.Verification;let t=(0,X.jsx)(y()._H,{id:"Activity.author.unknown",defaultMessage:"Unknown"});if(e){const i=p.getPropertyValue(e),r=(0,mo()._w)(i);if(r){const e=r[0],i=(0,l().uA)(e,o);i&&i.asActor&&(t=(0,l().XW)([i],{...(0,M().h_)()}))}}return t}),[p,S,A,o]),_=(0,n().VK)((()=>(0,l().jC)({recordId:p.id,recordType:"block",tab:u,rootStore:o,environment:v})),[p,u,o,v]),{activityStartTimestamp:C,activityEndTimestamp:R}=(0,n().VK)((()=>({activityStartTimestamp:parseInt(t.start_time),activityEndTimestamp:parseInt(t.end_time)})),[t]),K=(0,c().yK)((e=>({verificationMessage:{fontSize:14,color:e.mediumTextColor}})),[]);return f?(0,X.jsx)(fe,{header:A?(0,X.jsx)(y()._H,{defaultMessage:"<medium>Wiki verification</medium> expired",id:"activity.verificationExpired.header.short",values:{medium:e=>(0,X.jsx)("span",{style:{fontWeight:x().Ue.medium},children:e})}}):(0,X.jsx)(y()._H,{defaultMessage:"<medium>Page verification</medium> expired",id:"activity.verificationExpired.page.header.short",values:{medium:e=>(0,X.jsx)("span",{style:{fontWeight:x().Ue.medium},children:e})}}),isFirst:s,isLast:d,isPrivate:_,rootStore:S??o,navigableBlockId:p.id,notification:m,icon:(0,X.jsx)(vo,{}),showSnapshotButton:!1,url:b,...(0,Oe().JJ)({notification:m,activity:t,environment:v,tab:u}),children:(0,X.jsx)("div",{style:K.verificationMessage,children:C&&R?(0,X.jsx)(y()._H,{defaultMessage:"Last verified by {person} from {startDate} to {endDate}",values:{person:j,startDate:(0,q().gs)(C),endDate:(0,q().gs)(R)},id:"activity.verificationExpired.contentWithTimestamp"}):(0,X.jsx)(y()._H,{defaultMessage:"Last verified by {person}",values:{person:j},id:"activity.verificationExpired.contentWithoutTimestamp"})})}):null},"export-completed":function(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:a,isLast:s}=e,{tab:d,notification:l,source:u}=o,g=(0,r().O7)(),m=g.device.isMobile,{edits:h}=(0,n().VK)((()=>({edits:t.getEdits()})),[t]),v=(0,c().yK)((e=>({container:{paddingLeft:(0,it().c3)({source:u,isMobile:m}),paddingTop:12,paddingBottom:4},newContainer:{paddingTop:12,paddingBottom:4},actionButton:(0,it().b9)(e)})),[m,u]),p=(0,X.jsx)(y()._H,{defaultMessage:"Your workspace export is ready",id:"activity.exportCompleted.header"}),f=(0,X.jsx)(fi().gq,{style:{fontSize:12},children:(0,X.jsx)(y()._H,{defaultMessage:"The download link will expire in 7 days.",id:"activity.exportCompleted.downloadLink"})});return(0,X.jsxs)(fe,{header:p,isFirst:a,isLast:s,isPrivate:!0,rootStore:i,notification:l,icon:(0,X.jsx)(yi,{}),showSnapshotButton:!1,url:void 0,...(0,Oe().JJ)({notification:l,activity:t,environment:g,tab:d}),children:[f,(0,X.jsx)("div",{style:v.newContainer,children:(0,X.jsx)(ye().Z,{onClick:()=>{window.open(h[0].link,"_blank")},style:v.actionButton,children:(0,X.jsx)(y()._H,{defaultMessage:"Download",id:"activity.actions.exportCompleted.download"})})})]})},"import-completed":function(e){var t;const{activity:o,rootStore:a,tabArgs:s,isFirst:d,isLast:l}=e,{tab:u,notification:m,source:v}=s,p=(0,r().O7)(),{edits:f}=(0,n().VK)((()=>({edits:o.getEdits()})),[o]),b=null===(t=f[0])||void 0===t?void 0:t.teamspace_id,x=(0,n().VK)((()=>i(700696).default.state.teams.find((e=>e.id===b))),[b]),S=(0,n().VK)((()=>null==x?void 0:x.getName()),[x]),A=p.device.isMobile,j=(0,c().yK)((e=>({linkbox:{...(0,it().OD)({source:v,isMobile:A}),display:"flex",alignItems:"center",fontSize:bi().yv(p,"UIRegular"),paddingTop:2,paddingBottom:6,marginBottom:0,width:"100%"},newContainerLinkBox:{...(0,it().OD)({source:v,isMobile:A}),display:"flex",alignItems:"center",fontSize:bi().yv(p,"UIRegular"),paddingTop:2,paddingBottom:6,marginBottom:0,paddingLeft:0,width:"100%"}})),[A,v,p]);if(!f.length)return(0,X.jsx)(X.Fragment,{});const{import_source:_,import_status:C,version:M,landing_page:R,collection_page_ids:K}=f[0],V=(0,X.jsx)(y()._H,{defaultMessage:"Your {importSource} import has failed",id:"activity.importFailed.header",values:{importSource:_,importStatus:C}}),w=(0,X.jsx)(y()._H,{defaultMessage:"Your {importSource} import was successful",id:"activity.importSuccess.header",values:{importSource:_,importStatus:C}}),I=(0,X.jsx)(fi().gq,{style:{fontSize:bi().yv(p,"UISmall")},children:(0,X.jsx)(y()._H,{defaultMessage:"View projects and tasks in Notion",id:"activity.importCompleted.projects.redirect"})}),T=(0,X.jsx)(fi().gq,{style:{fontSize:bi().yv(p,"UISmall")},children:(0,X.jsx)(y()._H,{defaultMessage:"View boards in Notion",id:"activity.importCompleted.boards.redirect"})}),B=(0,X.jsx)(fi().gq,{style:{fontSize:bi().yv(p,"UISmall")},children:(0,X.jsx)(y()._H,{defaultMessage:"View import logs",id:"activity.importCompleted.loggerPage.redirect"})}),P=(0,i(135857).Z)({pageId:R,pageVisitSource:g().tY.Import});let N="successful"===C?w:V,U=(0,X.jsx)(fi().gq,{children:(0,X.jsx)(Lt().Z,{href:P,innerStyle:j.newContainerLinkBox,children:"successful"===C?"Monday"===_&&"v2"===M?T:I:B})});const q="Jira"===_?(0,X.jsx)(Vi,{}):(0,X.jsx)(Ki,{}),O=null==K?void 0:K[0];if("Jira"===_){const{headerComponent:e,bodyComponent:t}=(()=>{let e,t;if(x&&"successful"===C&&(e=(0,X.jsxs)("div",{children:[(0,X.jsx)(y()._H,{defaultMessage:"Your Jira projects and tasks have been synced to",id:"activity.importCompleted.jira.success.header"})," ",(0,X.jsx)("div",{style:{display:"inline-block",position:"relative"},children:(0,X.jsx)(i(383694).p,{disabled:!0,store:x,size:20})})," ",(0,X.jsx)("span",{children:S})]})),O){const e=k().G.createChildStore(a,{id:O.projectCollectionPageId,spaceId:a.id,table:h().iU}),i=k().G.createChildStore(a,{id:O.taskCollectionPageId,spaceId:a.id,table:h().iU});t=(0,X.jsxs)("div",{style:{paddingRight:12},children:[(0,X.jsx)(Ri,{titledRecordStore:e,rootStore:a,activity:o,tabArgs:s}),(0,X.jsx)("div",{style:{height:6}}),(0,X.jsx)(Ri,{titledRecordStore:i,rootStore:a,activity:o,tabArgs:s})]})}return{headerComponent:e,bodyComponent:t}})();t&&(U=t),e&&(N=e)}return(0,X.jsx)(fe,{url:void 0,header:N,isPrivate:!0,isFirst:d,isLast:l,rootStore:a,notification:m,icon:q,showSnapshotButton:!1,...(0,Oe().JJ)({notification:m,activity:o,environment:p,tab:u}),children:U})},"in-app-notification-automation-action-triggered":function(e){const{activity:t,tabArgs:i}=e,{tab:o,notification:a}=i,s=(0,r().O7)(),d=(0,n().VK)((()=>t.getEdits()),[t]),l=d.length>0,u={tab:o,notificationId:null==a?void 0:a.id,environment:s,alreadyRead:Boolean(null==a?void 0:a.read),activity:t},g=(0,c().yK)((e=>({notificationContainer:{paddingBlock:"8px 4px",display:"flex",flexDirection:"column",rowGap:8}})),[]);return l?(0,X.jsx)(Ji,{analyticsInfo:u,children:(0,X.jsx)(Hi,{...e,edits:d,style:g.notificationContainer})}):null},"no-conflicts-found":function(e){const{activity:t,rootStore:o,tabArgs:a,isFirst:s,isLast:d}=e,{tab:l,notification:c}=a,u=(0,r().O7)(),m=(0,y().YB)(),v=(0,n().VK)((()=>t.navigable_block_id),[t]),p=(0,n().VK)((()=>{const e=i(128076).G.createChildStore(o,{table:h().iU,id:t.navigable_block_id}).getModel();if(e)return e.getRenderUrl({getRecordModel:o.getRecordModel,pageVisitSource:g().tY.Notification})}),[t,o]),f=(0,X.jsx)("span",{children:(0,X.jsx)(y()._H,{defaultMessage:"<b>{author}</b> did not find conflicts",id:"activity.noConflictsFound.header",values:{author:Gi().GR.getDisplayName(m),b:e=>(0,X.jsx)("span",{style:{fontWeight:x().Ue.semibold},children:e})}})});return p?(0,X.jsx)(fe,{header:f,isFirst:s,isLast:d,isPrivate:!0,rootStore:o,navigableBlockId:v,notification:c,icon:(0,X.jsx)(tt().BE,{authors:[Gi().GR],size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:p,...(0,Oe().JJ)({notification:c,activity:t,environment:u,tab:l})}):null},"automation-typecheck-error-raised":function(e){const{rootStore:t,activity:a,isLast:s,tabArgs:d,isFirst:u}=e,{tab:m,notification:v}=d,p=(0,y().YB)(),f=(0,r().O7)(),S=(0,n().VK)((()=>a.getEdits()),[a]),A=S.at(0),j=(0,c().yK)((e=>({notificationContainer:{paddingTop:4,display:"flex",flexDirection:"column",rowGap:8},editAutomation:{marginTop:8,height:26,fontWeight:x().Ue.medium},messageContainer:{alignItems:"center",color:e.text.secondary,display:"flex",fontSize:ue,justifyContent:"space-between",lineHeight:x().Nv.UIRegular.desktop,paddingInlineEnd:12,position:"relative"},headerName:{fontWeight:x().Ue.medium,display:"inline-flex"}})),[]),_=(0,o.useMemo)((()=>new Set(S.map((e=>e.automation_id)))),[S]),M=(0,n().VK)((()=>{if(!(0,b().$K)(A))return!1;return!k().Mz.createChildStore(t,{table:yt().cv,id:A.automation_id,spaceId:t.getSpaceId()}).getAlive()}),[t,A]),{handleNavigateToAutomation:R,navigableBlockStore:K,navigableBlockUrl:V}=function(e){let{edit:t,rootStore:i,uniqueAutomationIds:o}=e;const a=(0,r().O7)(),s=1===o.size,d=(0,n().VK)((()=>{if(!(0,b().$K)(t))return!1;return!k().Mz.createChildStore(i,{table:yt().cv,id:t.automation_id,spaceId:i.getSpaceId()}).getAlive()}),[i,t]),c=(0,n().VK)((()=>{if((0,b().$K)(t))return new(k().G)(a,{id:t.automation_navigable_block_id,table:h().iU})}),[t,a]),u=(0,n().VK)((()=>{if(!(0,b().$K)(c))return!0;const e=c.getRole();return!e||!(0,Ve().YX)(e)}),[c]),m=(0,n().VK)((()=>{if((0,b().$K)(c))return(0,St().ZP)({store:c,preferPublicLink:!1,pageVisitSource:g().tY.Notification})}),[c]),v=(0,n().VK)((()=>u||!(0,b().$K)(t)?()=>{}:()=>{const e=t.automation_id;c&&m&&((0,xt().j)({environment:a,event:{eventName:"click_automation_typecheck_error_notification",eventProperties:{block_id:c.id,automation_id:e}}}),bt().c4({environment:a,url:m,callback:async()=>await(0,l().dM)({automationNavigableBlockStore:c,automationId:s&&!d?e:void 0,rootStore:i,source:"automation_typecheck_error_raised_notification"})}))}),[d,s,u,t,c,m,a,i]);return{handleNavigateToAutomation:v,navigableBlockStore:c,navigableBlockUrl:m}}({edit:A,rootStore:t,uniqueAutomationIds:_}),I=(0,n().VK)((()=>(0,l().jC)({recordId:null==K?void 0:K.id,recordType:h().iU,tab:m,rootStore:t,environment:f})),[K,m,t,f]),B=(0,n().VK)((()=>{const e=_.values().next().value;if(e){return t.getRecordStore(t,{table:yt().cv,id:e,spaceId:a.spaceId}).getNameWithDefault(p)}return""}),[a.spaceId,p,t,_]),P=(0,n().VK)((()=>[..._].map((e=>{const i=t.getRecordStore(t,{table:yt().cv,id:e,spaceId:a.spaceId}),o=i.getRole();return(0,b().$K)(o)&&(0,Ve().YX)(o)?i.getAlive()?i.getNameWithDefault(p):p.formatMessage(ft().pQ.automationDeletedName):p.formatMessage(ft().pQ.automationPrivateName)}))),[p,t,a,_]),U=(0,o.useCallback)((e=>{(0,N().ZP)({event:e,context:N().Af.NotificationClick,callback:()=>{T().createAndCommit({userAction:"AutomationTypecheckErrorRaisedActivity.viewError",environment:f,canUndo:!0,perform:e=>{w().$h({notification:v,rootStore:t,transaction:e,read:!0})}}),R(),Ie().bi({tab:m,notificationId:null==v?void 0:v.id,environment:f,alreadyRead:Boolean(null==v?void 0:v.read),activity:a})}})}),[a,f,R,v,t,m]),q=(0,C().E)("automation_updated_error_states");if(!(0,b().$K)(K)||!(0,b().$K)(A)||0===S.length||!q)return null;const O=(0,X.jsx)("div",{style:j.headerName,children:(0,X.jsx)(_t,{handleAutomationNavigate:U,automationNames:P})}),H=M&&1===_.size;return(0,X.jsx)(fe,{header:(0,X.jsx)(y()._H,{id:"AutomationTypecheckErrorRaisedActivity.formattedHeaderMessage.automationTitle",defaultMessage:"{automationNames} {numAutomationNames, plural, one {is} other {are}} invalid",values:{numAutomationNames:_.size,automationNames:O}}),isFirst:u,isLast:s,isPrivate:I,rootStore:t,navigableBlockId:K.id,notification:v,icon:(0,X.jsx)(Ct,{automationName:B}),showSnapshotButton:!1,url:V,...(0,Oe().JJ)({notification:v,activity:a,environment:f,tab:m}),children:(0,X.jsx)("div",{style:j.notificationContainer,onClick:U,children:!H&&(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)("div",{style:j.messageContainer,children:(0,X.jsx)(y()._H,{id:"AutomationTypecheckErrorRaisedActivity.formattedHeaderMessage.automationMessage",defaultMessage:"Resolve any errors or remove failing steps to enable {numAutomationNames, plural, one {this automation} other {these automations}}",values:{numAutomationNames:_.size}})}),(0,X.jsx)("div",{children:(0,X.jsx)(i(661297).Z,{style:j.editAutomation,onClick:U,isSmall:!0,children:(0,X.jsx)(y()._H,{id:"AutomationTypecheckErrorRaisedActivity.editAutomation.automationMessage",defaultMessage:"Edit automation"})})})]})})})}};function yo(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:r,isLast:d}=e,l=(0,n().VK)((()=>t.type),[t]);if(!(0,a().n_)(l))return s().log({level:"error",from:"ActivityNotification",type:"unsupportedActivityType",data:{message:`Activity type ${l} is not supported for ActivityNotification`}}),null;const c=fo[l];return(0,X.jsx)(c,{activity:t,rootStore:i,tabArgs:o,isFirst:r,isLast:d})}},104822:(e,t,i)=>{i.d(t,{B:()=>l,U:()=>d});var o=()=>i(530980),r=()=>i(243225),n=()=>i(989478),a=()=>i(565818),s=()=>i(286338);function d(e,t){return e.getKeyStore("settings").getKeyStore("seen_guest_membership_requests").getValue()&&(0,s().Ye)()}function l(e,t){const i=o().kk5.fromAccessRequest(e);if(!i.isPageAccessRequest())return!1;const s=i.getForActorPointer(t.id);return s.table===n().KJ&&!a().y.createChildStore(t,r().v8({userId:s.id,spaceId:t.id})).isMember()}},981697:(e,t,i)=>{i.d(t,{Z:()=>n});var o=i(667294),r=()=>i(219727);function n(e){const t=(0,r().O7)(),{onLongPress:i,hapticsEnabled:n=!0,timeout:a=300}=e,s=(0,o.useCallback)((()=>{var e,o,r;n&&(null!==(e=t.mobileNative)&&void 0!==e&&e.buzz?t.mobileNative.buzz():null===(o=(r=window.navigator).vibrate)||void 0===o||o.call(r,20));i()}),[t.mobileNative,n,i]),d=(0,o.useRef)(),l=(0,o.useRef)(0),c=(0,o.useRef)(0),u=(0,o.useCallback)((()=>clearTimeout(d.current)),[]);(0,o.useEffect)((()=>u),[u]);return{onTouchStart:(0,o.useCallback)((()=>{clearTimeout(d.current),d.current=setTimeout(s,a)}),[a,s]),onTouchMove:(0,o.useCallback)((e=>{const t=e.touches[0].clientX,i=e.touches[0].clientY;(Math.abs(t-l.current)>50||Math.abs(i-c.current)>50)&&clearTimeout(d.current)}),[]),onTouchEnd:u,onTouchCancel:u}}},439378:(e,t,i)=>{i.d(t,{S:()=>r});i(667294);var o=i(785893);const r=(0,i(827282).IU)("personBadgeQuestionMark",{viewBox:"0 0 15 14",svg:(0,o.jsx)("path",{d:"M12.4551 5.41699C12.8037 5.41699 13.0088 5.19824 13.0088 4.93164V4.84961C13.0088 4.45996 13.2344 4.2207 13.7061 3.90625C14.3691 3.46875 14.8408 3.07227 14.8408 2.25195C14.8408 1.11719 13.8291 0.501953 12.667 0.501953C11.498 0.501953 10.7256 1.0625 10.5342 1.69141C10.5 1.80078 10.4795 1.91016 10.4795 2.02637C10.4795 2.33398 10.7188 2.49805 10.9443 2.49805C11.1836 2.49805 11.3271 2.38867 11.4502 2.22461L11.5732 2.06055C11.8125 1.66406 12.1748 1.43164 12.626 1.43164C13.248 1.43164 13.6514 1.78711 13.6514 2.30664C13.6514 2.77148 13.3643 2.99707 12.7695 3.41406C12.2773 3.75586 11.915 4.11816 11.915 4.78809V4.87695C11.915 5.23242 12.1064 5.41699 12.4551 5.41699ZM5.79004 6.99609C7.25293 6.99609 8.52441 5.68359 8.52441 3.97461C8.52441 2.28613 7.25293 1.03516 5.79004 1.03516C4.32715 1.03516 3.05566 2.31348 3.05566 3.98828C3.05566 5.68359 4.32031 6.99609 5.79004 6.99609ZM12.4414 7.4541C12.8379 7.4541 13.1797 7.13965 13.1797 6.74316C13.1797 6.34668 12.8447 6.03223 12.4414 6.03223C12.0381 6.03223 11.7031 6.35352 11.7031 6.74316C11.7031 7.13281 12.0449 7.4541 12.4414 7.4541ZM1.20312 13.3262H10.3701C11.1016 13.3262 11.5391 12.9844 11.5391 12.417C11.5391 10.6533 9.33105 8.21973 5.7832 8.21973C2.24219 8.21973 0.0341797 10.6533 0.0341797 12.417C0.0341797 12.9844 0.47168 13.3262 1.20312 13.3262Z"})})},969243:(e,t,i)=>{i.d(t,{r:()=>r});var o=()=>i(143346);const r=new(i(168469).q)((e=>{let{userId:t,spaceId:i}=e;return`${t}-${i}`}),(async function(e,t){var r;let{userId:n,spaceId:a}=t;const[s,d]=await Promise.all([o().bG({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:{table:i(989478).KJ,id:n},userId:n}),o().bG({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:(0,i(243225).v8)({userId:n,spaceId:a}),userId:n})]),l=null===(r=i(876822).default.state.currentSpaceViewStore)||void 0===r||null===(r=r.getModel())||void 0===r?void 0:r.first_joined_space_time,c=null==s?void 0:s.value,u=null==d?void 0:d.value;if(c&&u&&l)return{id:c.id,space_id:u.id,membership_type:u.membership_type,email:c.email,name:c.name,profile_photo:c.profile_photo,onboarding_completed:c.onboarding_completed,notion_user_version:c.version,space_user_version:u.version,first_joined_space_time:l}}));i(947115).exposeDebugValue("UserOnSpaceStore",r)},223248:(e,t,i)=>{i.d(t,{Id:()=>S,Ng:()=>A,Px:()=>b,ow:()=>x,t_:()=>y,um:()=>f});i(267602),i(653476);var o=()=>i(506347),r=()=>i(989478),n=()=>i(465755),a=()=>i(824462),s=()=>i(636340),d=()=>i(102182),l=()=>i(224597),c=()=>i(269299),u=()=>i(527278),g=()=>i(345918),m=()=>i(876822),h=()=>i(555813),v=()=>i(111631);const p=(0,i(788860).vU)({joinTeamSuccessMessage:{id:"teamInviteLinkActions.joinTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},requestTeamSuccessMessage:{id:"teamInviteLinkActions.requestAccess.successMessage",defaultMessage:"Successfully requested membership"},requestTeamFailureMessage:{id:"teamInviteLinkActions.requestAccess.failureMessage",defaultMessage:"Failed to request membership"}});async function f(e){let{environment:t,userId:i,teamStore:o,user:r}=e;const a=o.getSpaceId();if(!a)return;await h().Wi({environment:t,teamId:o.id,spaceId:a,teamUserInfo:r,isSettingDefaultTeam:!1,inviterId:i})&&(n().UD(t,{store:o,joined_role:"member",from:"team_invite_link"}),await y({environment:t,userId:i,teamStore:o}),d().oV({label:u().Z.formatMessage(p.joinTeamSuccessMessage,{teamName:o.getName()})}))}async function y(e){let{environment:t,userId:i,teamStore:r}=e;const n=m().default.state.currentUserRootStore,a=r.getSpaceId();if(!a||!n)return;const s=n.getSpaceViewStores().filter((e=>e.getSpaceId()===a))[0];await l().y3({environment:t,spaceViewStore:s,userSettingsStore:void 0,userRootStore:n,pageVisitSource:o().tY.JoinTeam,navigationType:"switchingToOrLoadingSpace"}),await v().I({environment:t,spaceId:a,userId:i}),h().hI({environment:t,teamStore:r,shouldScroll:!0})}async function b(e){let{environment:t,teamId:i,message:o}=e;if(!t.currentUser.id)return;"success"===(await a().callApi({eventName:"requestAccess",environment:t,data:{type:"current-actor-to-team",teamId:i,message:o}})).type?(n().LB(t,{teamId:i}),await S({environment:t}),new Promise((e=>setTimeout(e,500))).then((()=>{d().oV({label:u().Z.formatMessage(p.requestTeamSuccessMessage)})}))):d().oV({label:u().Z.formatMessage(p.requestTeamFailureMessage)})}async function x(e){let{environment:t,teamStore:i,accessRequestStore:o,status:a}=e;const d=o.getForActorId();if(!d)return;const l=o.getRecordModel({table:r().KJ,id:d});if(l){if("approved"===a){const e=[{type:"member",entity_type:"user",user_id:l.id}];if(!(await h().Uj({environment:t,teamStore:i,teamMemberInfos:e,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})))return}c().createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,canUndo:!0,perform:e=>{s().sW({store:o,transaction:e,data:{resolved_time:Date.now(),resolved_by_table:r().KJ,resolved_by_id:t.currentUser.id,status:a}})}}),n().co(t,{store:i,resolution:a})}}async function S(e){let{environment:t}=e;const{lastVisitedSpaceView:i,userRootStore:r,userSettingsStore:n}=await(0,g().iX)({environment:t,disableRedirectUrl:!1});i?await l().y3({environment:t,spaceViewStore:i,userRootStore:r,userSettingsStore:n,pageVisitSource:o().tY.BackForward,navigationType:"switchingToOrLoadingSpace"}):await l().L5({environment:t,userRootStore:r,userSettingsStore:n,pageVisitSource:o().tY.BackForward})}async function A(e){let{environment:t,teamId:i}=e;const o=await a().callApi({eventName:"getTeamAccessRequestMetadata",environment:t,data:{teamId:i}});if("success"===o.type)return o.data}}}]);