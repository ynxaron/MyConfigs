"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[49674],{851990:(e,t,n)=>{n.d(t,{o:()=>p,q:()=>m});var s=()=>n(142735),i=()=>n(191003),o=()=>n(550054),r=()=>n(156538),l=()=>n(876822),a=()=>n(127519),u=()=>n(269299),c=()=>n(348141);function d(){const e=a().default.state;if("editing"===e.mode){const t=(0,i().QY)(e.multiSelection);if(t&&(0,o().wd)(t.selection)){const e=t.store,n=r().E.findEditableWithStore(e);if(n){return e.getValue()?void 0:n}}}}function p(){return(0,s().VK)(d,[])}function m(e){const{currentUserSettingsStore:t}=l().default.state;t&&u().createAndCommit({userAction:"educationTooltipsActions.completePressSlashTooltip",environment:e,perform:e=>{c().d2({userSettingsStore:t,transaction:e,data:{pressed_slash_tooltip:!0}})},canUndo:!0,userId:t.id})}},390952:(e,t,n)=>{n.d(t,{u:()=>r});var s=()=>n(876822),i=()=>n(749826),o=()=>n(572623);function r(e){const{currentUserSettingsStore:t}=s().default.state;if(!t)return!1;const n=(0,o().e2)(t);return!("number"==typeof n&&n>7)&&(!e.device.isMobile&&"on"===i().default.getEligibleGroup({experimentId:"slash_menu_tooltip",defaultGroup:"control"}))}},696764:(e,t,n)=>{n.d(t,{Z:()=>i});var s=()=>n(730120);class i{constructor(){this.UNVISITED_FRECENCY_SCORE=1}getFrecencyRankedActions(e,t){const n=Date.now();return Object.keys(e).sort(((s,i)=>{const o=e=>Math.ceil(e.frequency*this.getWeightForVisit(n,e.lastAccessed,t)),r=e[s],l=e[i],a=void 0!==(null==r?void 0:r.frequency)&&void 0!==(null==r?void 0:r.lastAccessed)?o(r):this.UNVISITED_FRECENCY_SCORE,u=void 0!==(null==l?void 0:l.frequency)&&void 0!==(null==l?void 0:l.lastAccessed)?o(l):this.UNVISITED_FRECENCY_SCORE;return a===u?0:u-a}))}getWeightForVisit(e,t,n){const{TIME_BUCKETS:i,DEFAULT_BUCKET_WEIGHT:o}=n,r=s().ou.fromMillis(e).diff(s().ou.fromMillis(t),"hours").as("hours");for(const s of i){if(r<=s.hours)return s.weight}return o}}},684151:(e,t,n)=>{n.r(t),n.d(t,{SlashMenu:()=>de});var s=n(667294),i=()=>n(219727),o=()=>n(142735),r=()=>n(69863),l=()=>n(851990),a=()=>n(267629),u=()=>n(594546),c=()=>n(390952),d=()=>n(191003),p=()=>n(440721),m=()=>n(620218),g=()=>n(876822),f=()=>n(965903),h=()=>n(127519),v=()=>n(543934),x=()=>n(788860),y=()=>n(527278),_=()=>n(639832);const S=(0,x().vU)({addButtonPlaceholder:{defaultMessage:"Type to filter…",id:"text.commandsMenuOpen.placeholder"},slashInsertionPlaceholder:{defaultMessage:"Filter…",id:"slashMenu.slashInsertion.placeholder"}});var M=()=>n(146947),k=()=>n(967092),T=()=>n(352230),E=()=>n(998901),C=()=>n(104088),B=()=>n(21062),b=()=>n(269299),j=()=>n(149809),I=()=>n(198829),A=()=>n(388284),R=()=>n(692304),w=()=>n(807230),K=()=>n(846550),Z=()=>n(159408),F=()=>n(827973),N=()=>n(666414),O=()=>n(603692),U=()=>n(661641),V=()=>n(661297),P=()=>n(647194),D=()=>n(965014),L=n(785893);function G(){const e=(0,x().YB)(),t=(0,K().yK)((e=>({container:{padding:"14px",borderBottom:`1px solid ${e.stroke.primary}`},buttonStyle:{gap:"4px",padding:"0px 12px 0px 8px",borderRadius:"6px"},title:{paddingBottom:"8px"},upgradeItem:{marginTop:6,marginBottom:6},upgradeTitle:{color:e.text.uiBluePrimary},divider:{color:e.regularDividerColor}})),[]),[n,o]=(0,s.useState)(!1),r=(0,i().O7)();return v()._H()?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(F().Z,{focused:n,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),onClick:()=>{D().y(r,{from:"slash_menu",upsell:{type:"product",product:"plus",limit:{type:"none"}}})},buttonStyle:t.upgradeItem,icon:(0,L.jsx)(O().y,{iconGroup:Z().t,colorName:"uiBluePrimary",variantName:"default"}),title:(0,L.jsx)(x()._H,{id:"slashMenuBlockLimit.title",defaultMessage:"<span>Upgrade plan</span> to add content",values:{span:e=>(0,L.jsx)("span",{style:t.upgradeTitle,children:e})}})}),(0,L.jsx)(N().Z,{size:2,style:t.divider})]}):(0,L.jsxs)("div",{style:t.container,children:[(0,L.jsx)("div",{style:t.title,children:(0,L.jsx)(U().q,{styleName:"UIRegular-14px/Regular",children:e.formatMessage(P().hC.slashMenuTitle)})}),(0,L.jsxs)(V().Z,{style:t.buttonStyle,onClick:()=>{D().y(r,{from:"slash_menu",upsell:{type:"product",product:"plus",limit:{type:"none"}}})},children:[(0,L.jsx)(O().y,{iconGroup:Z().t,colorName:"uiBluePrimary",variantName:"default"}),e.formatMessage(P().hC.upgradeCta)]})]})}var q=()=>n(548812),z=()=>n(30795),H=()=>n(897257),Y=(n(267602),n(653476),n(749411),n(241792),n(731107),()=>n(156642)),$=()=>n(177837),W=()=>n(696764),Q=()=>n(749826),J=()=>n(708574);const X=[$().yz.key,`insert ${Y().Ti.callout}`,`insert ${Y().Ti.embed}`,"insert table view"];function ee(e){const{sections:t,isEmptyBlock:n,suggestionCount:s}=e,i=t.flatMap((e=>e.actions)).reduce(((e,t)=>(e[t.key]=t,e)),{});if(function(){const e=Q().default.getEligibleGroup({experimentId:"slash_menu_experiment_3_existing_users"}),t=Q().default.getEligibleGroup({experimentId:"slash_menu_experiment_3_new_users"});return"personalized_suggestions"===e||"personalized_suggestions"===t}()){const e=function(e){const t={TIME_BUCKETS:[{hours:4,weight:100},{hours:12,weight:80},{hours:24,weight:70},{hours:72,weight:60},{hours:168,weight:50},{hours:336,weight:40},{hours:672,weight:30}],DEFAULT_BUCKET_WEIGHT:20};return(new(W().Z)).getFrecencyRankedActions(e,t)}(J().Z.get()),t=function(e){const{suggestionCount:t,actionsByKey:n,frecencyRankedActions:s,isEmptyBlock:i}=e,o=Object.entries(n).filter((e=>{let[t,n]=e;if(se.includes(t))return!1;if(i){if(t.match(ne))return!0;if(t.match(te))return!1}return!0})),r=o.filter((e=>{let[t,n]=e;return s.includes(t)})).sort(((e,t)=>{let[n,i]=e,[o,r]=t;return s.indexOf(n)-s.indexOf(o)})).slice(0,t).map((e=>{let[t,n]=e;return t}));return r}({suggestionCount:s,actionsByKey:i,frecencyRankedActions:e,isEmptyBlock:n});return t.map((e=>i[e]))}return i[$().yz.key]=$().yz,X.map((e=>i[e])).filter(Boolean).slice(0,s)}const te="(turn into|action).*",ne="(action color).*",se=["action more"];var ie=()=>n(688450);function oe(e){const{filter:t,sectionsCount:n,focused:s,onClick:i,isAddMenu:l}=e,a=(0,x().YB)(),u=(0,K().yK)((e=>({divider:{color:e.lightDividerColor},shortcut:{color:e.lightTextColor,fontSize:12,whiteSpace:"nowrap"},titleText:{color:e.lightTextColor},titleFilterText:{color:e.regularTextColor}})),[]),c=a.formatMessage({id:"slashMenuItems.typeOnPage.message",defaultMessage:"Type '/{filter}' on the page"},{filter:t}),d=(0,L.jsx)("div",{children:c.split("'").map(((e,n)=>{if(e===`/${t}`){const t=l?e.slice(1):e;return(0,L.jsxs)("span",{style:u.titleText,children:["‘",(0,L.jsx)("span",{style:u.titleFilterText,children:t}),"’"]},n)}return(0,L.jsx)("span",{style:u.titleText,children:e},n)}))}),p=(0,o().VK)((()=>(0,r().ap)()),[]);return(0,L.jsxs)(L.Fragment,{children:[n>0?(0,L.jsx)(N().Z,{size:2,style:u.divider}):void 0,(0,L.jsx)(A().Z,{children:(0,L.jsx)(F().Z,{focused:s,onClick:i,title:d,right:(0,L.jsx)("span",{style:u.shortcut,children:"esc"}),desktopTitleStyle:p})})]})}const re=4,le=(0,x().vU)({suggestedSectionTitle:{id:"slashMenu.suggestedSection.title",defaultMessage:"Suggested"}});function ae(e){const{sections:t,slashMenuState:n,menuProps:l,isEmptyBlock:c}=e,d=(0,i().O7)(),p=v()._H(),m=(0,o().VK)((()=>v().QT(n)),[n]),g=(0,o().VK)((()=>f().default.state.stores),[]),h=(0,o().VK)((()=>(0,w().ww)(d)),[d]),_=(0,o().Kw)(H().subscriptionDataStoreInstance),S=(0,z().V)(_),M=(0,o().VK)((()=>(0,q().vT)(S)),[S]),k=(0,s.useMemo)((()=>({environment:d,blocks:g,originRect:n.selectionRect,publicEditMode:void 0})),[d,g,n.selectionRect]),T=(0,o().VK)((()=>(0,a().sG)({sections:t,context:k,query:m||""}).length),[t,k,m]),E=p&&!!m,C=(0,o().qz)(void 0,R().Z),B=(0,o().VK)((()=>C.getState().focus.footerFocused),[C]),K=(0,s.useCallback)((()=>{(0,u().j)({environment:d,event:{eventName:"close_slash_menu",eventProperties:{id:n.id,source:"click_type_on_page"}}}),v().xv({environment:d,dismissed:!0})}),[d,n.id]),Z=E?(0,L.jsx)(oe,{focused:B??!1,filter:m,sectionsCount:T,onClick:K,isAddMenu:n.isAddMenu}):void 0,F=E?{onFooterEnter:K}:{},N=p&&Boolean(m)&&T>0,O=(0,o().VK)((()=>({desktopTitleStyle:(0,r().ap)(),itemMarginLeft:p?0:void 0,itemMarginRight:p?4:void 0,desktopIconStyle:p?{marginLeft:4}:void 0,svgStyle:p?{margin:6}:void 0,svgCustomFill:p?e=>e.mediumIconColor:void 0})),[p]),U=v().Us()&&!m,V=(0,o().VK)((()=>{if(U){const e=function(e){const{isEmptyBlock:t,sections:n}=e,s={height:32,alignItems:"center",marginTop:0,marginBottom:0},i=ee({suggestionCount:re,sections:n,isEmptyBlock:t});return i.length?{key:ie().FJ,title:y().Z.formatMessage(le.suggestedSectionTitle),actions:i,render:e=>(0,L.jsx)(A().Z,{...e,desktopTitleStyle:s})}:void 0}({sections:t,isEmptyBlock:c});return e?[e,...t]:t}return t}),[U,t,c]);return(0,L.jsxs)(I().Z,{...l,footer:Z,children:[M&&!h?(0,L.jsx)(G,{}):null,N?(0,L.jsx)(A().Z,{style:{paddingBottom:0},desktopTitleStyle:{height:32,alignItems:"center",marginTop:0,marginBottom:0},title:(0,L.jsx)(x()._H,{id:"slashMenuItems.filteredResults",defaultMessage:"Filtered results"})}):null,(0,L.jsx)(j().Z,{sections:V,onAccept:(e,t,n,s,i)=>{if(!h)return(0,w().eD)(d);!function(e,t,n,s){b().createAndCommit({userAction:"SlashMenu.handleAccept",environment:t,canUndo:!0,perform:i=>{v().RL({environment:t,transaction:i,action:e,sectionKey:n,itemIndex:s})}})}(e,d,s,i)},context:k,filter:m,flattenSectionsOnSearch:p,initialFocus:0,resetFocusOnMouseOut:!0,useLimit:!0,showNoResultsMessage:!p,menuListStore:C,renderItemStyles:O,...F})]})}function ue(e){const{sections:t,slashMenuState:n,isEmptyBlock:s}=e,o=(0,i().O7)(),r=(0,i().Fy)(),l=n.isAddMenu?8:12,a=r.isMobileNative&&!r.isTablet&&!r.isIpad,c=`min(448px, ${r.isMobile?"25vh":"40vh"})`;return(0,L.jsx)(k().ZP,{popupType:r.isMobileNative&&!r.isTablet?C().k.SlideUp:C().k.Popup,open:!0,originRect:n.selectionRect,placementToOrigin:E().Placement.Bottom,alignmentToOrigin:E().Alignment.Start,originGap:l,disableMouseCapture:!0,disableContentScroll:!0,preventBlockRenderQueueOnEnter:!0,onDismiss:()=>{(0,u().j)({environment:o,event:{eventName:"close_slash_menu",eventProperties:{id:n.id,source:"esc"}}}),v().xv({environment:o,dismissed:!0})},render:()=>(0,L.jsx)(B().N,{step:"create_page_beyond_text",showSidebarOverlays:!1,onBackButtonClick:()=>v().xv({environment:o,dismissed:!0}),onNextButtonClick:()=>v().xv({environment:o,dismissed:!0}),children:(0,L.jsx)(ce,{sections:t,slashMenuState:n,isMobileNative:a,environment:o,menuMaxHeight:c,isEmptyBlock:s})})})}function ce(e){const{sections:t,slashMenuState:n,isMobileNative:s,environment:i,menuMaxHeight:o,isEmptyBlock:r}=e;let l;return l=s?{menuType:T().o.ActionSheet}:{menuType:T().o.Popup,width:"fr-FR"===M().locale?375:324,maxHeight:o,onClickOutside:()=>{(0,u().j)({environment:i,event:{eventName:"close_slash_menu",eventProperties:{id:n.id,source:"click_outside"}}}),v().xv({environment:i,dismissed:!0})}},(0,L.jsx)(ae,{sections:t,slashMenuState:n,menuProps:l,isEmptyBlock:r})}function de(){const e=(0,i().O7)(),t=(0,o().Kw)(_().Z),n=t.open&&t.isAddMenu,x=function(){const e=(0,o().Kw)(_().Z);return(0,s.useCallback)((t=>{if(!e.open)return;if(!t)return void e.temporaryInputDataStore.setState(void 0);const n=t.input===t.prefix?"addMenu"===t.type?y().Z.formatMessage(S.addButtonPlaceholder):y().Z.formatMessage(S.slashInsertionPlaceholder):"";e.temporaryInputDataStore.setState({prefix:t.prefix,suffix:"",completion:n,prefixIcon:void 0})}),[e])}(),M=(0,o().VK)((()=>t.open?h().default.state:void 0),[t]),k=function(e){const{slashMenuState:t,environment:n}=e,i=(0,s.useMemo)((()=>t.open?(0,r().PU)(n):void 0),[n,t.open]);return(0,o().VK)((()=>t.open&&i?t.isAddMenu?i.state.insertActions:i.state.slashActions:[]),[t,i])}({slashMenuState:t,environment:e}),T=(0,s.useRef)(!0),E=(0,o().VK)((()=>t.open&&!t.oldTextValue),[t]);return(0,s.useEffect)((()=>{let e=_().Z.state.open;function t(t){if(t.state.open&&e!==t.state.open){const e=T.current?"slash_menu_first_open_lag":"slash_menu_open_lag";m().default.mark(e)}e=t.state.open}return _().Z.addListener(t),()=>{_().Z.removeListener(t)}}),[]),(0,s.useEffect)((()=>{if(t.open&&M){var s;if("editing"!==M.mode)return;const i=v().QT(t);x(void 0!==i?n?{type:"addMenu",input:i,prefix:""}:{type:"slash",input:`/${i}`,prefix:"/"}:void 0);const o=(0,a().sG)({sections:k,context:{blocks:f().default.state.stores,environment:e,publicEditMode:void 0},query:i||""});let r=0,m=t;i&&(0===o.length?r=i.length-t.lettersAtLastResult:(m={...t,lettersAtLastResult:(null==i?void 0:i.length)??0,filter:i},_().Z.setState(m)));const{currentUserSettingsStore:h}=g().default.state;!h||null!==(s=h.getSettings())&&void 0!==s&&s.pressed_slash_tooltip||!(0,c().u)(e)||l().q(e);const{multiSelection:y}=M;!t.open||(0,d().qS)(y)&&y.start.store===m.textStore&&!p().Ye(i,!0,o.length,r,m.textStore)||((0,u().j)({environment:e,event:{eventName:"close_slash_menu",eventProperties:{id:t.id,source:i?"auto_close":"backspace"}}}),v().xv({environment:e,dismissed:!0}))}}),[e,k,M,t,x,n]),(0,s.useEffect)((()=>{if(t.open){const t=T.current?"slash_menu_first_open_lag":"slash_menu_open_lag";m().default.measure(t,{environment:e}),T.current=!1}}),[e,t]),t.open?(0,L.jsx)(ue,{sections:k,slashMenuState:t,isEmptyBlock:E}):null}}}]);