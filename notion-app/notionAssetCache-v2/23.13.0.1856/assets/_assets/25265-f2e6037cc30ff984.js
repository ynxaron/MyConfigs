"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[25265],{501912:(e,t,o)=>{o.d(t,{T:()=>y});o(670560),o(667294);var n=()=>o(788860),r=()=>o(707513),i=()=>o(360746),a=()=>o(384241),s=()=>o(129338),l=()=>o(90065),c=()=>o(688745),d=()=>o(382474),u=()=>o(917881),m=()=>o(308186),p=()=>o(269299),f=o(785893);async function y(e){const{environment:t,collectionContextStore:o,property:y,handleDeleteAccept:g}=e,v=o.collectionStore();if(!v)return;if(v.isTypedProperty(y)){if(await i().w0({environment:t,property:y,collectionContextStore:o,theme:e.theme,from:e.from}))return}const S=(0,d()._U)({environment:t,collectionStore:v,propertyId:y});if(S.length>0){if((0,c().Ym)({environment:t,collectionStore:v,propertyId:y,compoundTemplateInstancesToDelete:S,collectionContextStore:o,from:e.from}))return}else if(((0,l().e_)(y)||(0,l().TJ)({collectionStore:v,propertyId:y}))&&(0,l().sA)(v)&&(0,l().tj)(t)){if((0,c().D5)({environment:t,collectionStore:v,propertyId:y,collectionContextStore:o,from:e.from}))return}const h=o.normalizedSchemaStore.state,b=h[y],C=s().ny(o,b);await(null==C?void 0:C.load());const I=C&&s().OP(o,y,C),w=C&&s().gZ(C),_=C&&v.id===C.id,x=[{label:(0,f.jsx)(n()._H,{id:"database.viewSettings.propertyTab.deleteProperty.modal.confirmButton",defaultMessage:"Delete"}),color:"red",onAccept:g}];let T;if(I&&v&&w&&!_&&x.push({label:(0,f.jsx)(n()._H,{id:"database.tableHeaderCell.deleteProperty.modal.inverseConfirmButton",defaultMessage:"Delete, but keep related property"}),color:"red",onAccept:()=>{p().createAndCommit({userAction:"collectionPropertyActions.showDeletePropertyDialog",environment:t,canUndo:!0,perform:e=>{if(b&&"relation"===b.type&&b.property&&C){const o=b.property,n=C.getSchema();u().q0({environment:t,collectionStore:C,propertySchema:n[o],property:o,targetPropertyID:void 0,autoRelate:v.isSyncedCollection()&&!C.isSyncedCollection()?{enabled:!1}:b.autoRelate,transaction:e})}u().kQ({environment:t,collectionStore:v,property:y,transaction:e})}})}}),"auto_increment_id"===(null==b?void 0:b.type))T=s().pR(h)?(0,f.jsx)(n()._H,{id:"database.tableHeaderCell.deleteUniqueIdWithGithubProperty.modal.prompt",defaultMessage:"You will no longer be able to link new GitHub PRs and status automations will stop working."}):(0,f.jsx)(n()._H,{id:"database.tableHeaderCell.deleteUniqueIdProperty.modal.prompt",defaultMessage:"The ID property will be permanently deleted."});else if("status"===(null==b?void 0:b.type)){const e=s().Pi(h);if(e){const t=e.connectedRelation.automation;t&&t[y]&&(T=(0,f.jsx)(n()._H,{id:"database.tableHeaderCell.deleteStatusProperty.modal.prompt",defaultMessage:"Deleting this status property will stop the GitHub Pull Requests status automation."}))}}else C&&w&&!_&&I&&(T=(0,f.jsx)(n()._H,{id:"database.tableHeaderCell.deleteRelatedProperty.modal.prompt",defaultMessage:"This property has a related property on {relationTargetName} which will also be deleted.",values:{relationTargetName:(0,f.jsx)(a().Z,{style:{display:"inline",fontWeight:r().Ue.medium},store:C})}}));m().vC({message:(0,f.jsx)("span",{children:(0,f.jsx)(n()._H,{id:"database.tableHeaderCell.deleteProperty.modal.prompt",defaultMessage:"Delete this property from {databaseName}? It will be removed from all views.",values:{databaseName:(0,f.jsx)(a().Z,{style:{display:"inline",fontWeight:r().Ue.bold},shouldWrap:!0,store:v})}})}),description:T,showCancel:!0,keepFocus:!0,items:x,mode:"wide"})}},128039:(e,t,o)=>{o.r(t),o.d(t,{FORMS_SHARE_CALLOUT_KEY:()=>J,changeFormClosedState:()=>me,changeFormSubmissionPermissions:()=>pe,createAndFocusCollectionFormEditorView:()=>re,createCollectionFormEditorView:()=>ie,createDummyFormPage:()=>ve,createFormInPrivate:()=>ae,createFormQuestion:()=>ce,createFormQuestionAndModuleForNewlyDuplicatedProperty:()=>de,createFormQuestionAndUpdateOrCreateModule:()=>ue,createResponsesCollectionView:()=>se,deleteFormQuestion:()=>le,handleUpdateFormQuestionName:()=>te,incrementAndTrackUserFormsCreated:()=>ee,maybeAlertAboutUnsupportedPublicQuestions:()=>Se,maybeSyncQuestionNameToPropertyName:()=>oe,remapQuestionToNewProperty:()=>ge,toggleAnonymousFormSubmissionState:()=>fe,toggleNotionBrandingState:()=>ye});o(821057),o(670560),o(267602),o(653476),o(470928),o(30005),o(667294);var n=()=>o(846550),r=()=>o(506347),i=()=>o(156642),a=()=>o(863112),s=()=>o(226413),l=()=>o(532850),c=()=>o(817629),d=()=>o(998411),u=()=>o(667932),m=()=>o(217465),p=()=>o(375255),f=()=>o(396136),y=()=>o(139978),g=()=>o(26645),v=()=>o(483791),S=()=>o(955620),h=()=>o(788860),b=()=>o(342792),C=()=>o(543172),I=()=>o(707513),w=()=>o(984871),_=()=>o(139224),x=()=>o(132156),T=()=>o(308186),A=()=>o(421654),P=()=>o(636340),F=()=>o(47443),M=()=>o(145284),Q=()=>o(269299),N=()=>o(348141),E=()=>o(932753),k=()=>o(594546),R=()=>o(907005),V=()=>o(270315),D=()=>o(487270),j=()=>o(527278),B=()=>o(660065),U=()=>o(909679),H=()=>o(676232),q=()=>o(803728),L=()=>o(99537),W=()=>o(913011),Z=()=>o(356117),O=()=>o(876822),z=()=>o(749826),G=()=>o(808282),K=()=>o(807230),Y=()=>o(469753),$=o(785893);const X=(0,h().vU)({responsesViewName:{id:"formEditorActions.responsesViewName",defaultMessage:"Responses"},newFormViewName:{id:"formEditorActions.newFormViewName",defaultMessage:"Form builder"},formDatabaseTitle:{id:"newBlock.databaseInline.formDatabaseTitle",defaultMessage:"New form"}}),J="forms_share_form_tooltip";function ee(e,t){const{currentUserSettingsStore:o}=O().default.state;if(!o)return;const n=function(){const{currentUserSettingsStore:e}=O().default.state;if(!e)return;return e.getSettingsStore().getKeyStore("user_forms_created_count").getValue()??0}();void 0!==n&&(N().d2({userSettingsStore:o,transaction:t,data:{user_forms_created_count:n+1}}),function(e,t){(0,k().j)({environment:e,event:{eventName:"form_created",eventProperties:{user_total_form_count:t.userFormsCreatedCount}}})}(e,{userFormsCreatedCount:n+1})),z().default.logEvent("form_created")}function te(e){var t;const{questionStore:o,newName:n,environment:r,collectionStore:i,collectionSchema:a,collectionContextStore:s}=e,l=null===(t=o.getConfig())||void 0===t?void 0:t.propertyId;if(!l)throw new Error("No property ID found for question");Q().createAndCommit({userAction:"formQuestion.changeName",environment:r,canUndo:!0,perform:e=>{var t,r;const c=null===(t=o.getConfig())||void 0===t?void 0:t.name;if(!c)return;const u=(0,p().Xh)({textValue:c,getRecordModel:o.getRecordModel,deterministic:!0,userTimeZone:(0,d().r)(),intl:j().Z.getIntl()})===(null===(r=a[l])||void 0===r?void 0:r.name);Q().applyOperation({store:o,operation:{pointer:o.pointer,path:["config","name"],command:"set",args:[[n]]},transaction:e}),o.shouldSyncQuestionNameToPropertyName()&&(u&&!(0,V().Gu)({property:l,collectionContextStore:s,newValue:n})?w().Bv({collectionStore:i,property:l,name:n,transaction:e}):Q().applyOperation({store:o,operation:{pointer:o.pointer,path:["config","shouldSyncQuestionNameToPropertyName"],command:"set",args:!1},transaction:e}))}})}function oe(e){var t;const{questionStore:o,environment:n,collectionStore:r,collectionContextStore:i}=e,a=null===(t=o.getConfig())||void 0===t?void 0:t.propertyId;if(!a)throw new Error("No property ID found for question");Q().createAndCommit({userAction:"formQuestion.changeName",environment:n,canUndo:!0,perform:e=>{if(!o.shouldSyncQuestionNameToPropertyName())return;const t=o.getNameStore().getValue();if(!t)return;const n=(0,p().Xh)({textValue:t,getRecordModel:o.getRecordModel,deterministic:!0,userTimeZone:(0,d().r)(),intl:j().Z.getIntl()}),s=(0,V().Gu)({property:a,collectionContextStore:i,newValue:n})?(0,c().n)(n):n;w().Bv({collectionStore:r,property:a,name:s,transaction:e})}})}function ne(){const e=(0,n().yK)((e=>({container:{display:"flex",flexDirection:"column"},iconGroup:{display:"flex",flexDirection:"row",justifyContent:"center",color:e.icon.secondary,alignItems:"center"},dialogTitle:{fontSize:16,fontWeight:I().Ue.semibold,lineHeight:"22px",marginTop:12,marginBottom:12},dialogDescription:{color:e.text.secondary,fontSize:14,lineHeight:"20px"}})),[]);return(0,$.jsxs)("div",{style:e.container,children:[(0,$.jsxs)("div",{style:e.iconGroup,children:[(0,H().t)({width:24}),(0,B().r)({width:16,marginLeft:16,marginRight:14}),(0,U().E)({width:24})]}),(0,$.jsx)("span",{style:e.dialogTitle,children:(0,$.jsx)(h()._H,{defaultMessage:"Auto-create form questions based on existing properties?",id:"NewFormOnExistingCollectionDialogTitle.message"})}),(0,$.jsx)("span",{style:e.dialogDescription,children:(0,$.jsx)(h()._H,{defaultMessage:"Only supported property types will create new questions.",id:"NewFormOnExistingCollectionDialogTitle.description"})})]})}function re(e){const{environment:t,collectionContextStore:o,transaction:n}=e,r=o.collectionViewBlockStore(),i=o.collectionStore();if(!r||!i)return;const a=o.normalizedSchemaStore.state,s=ie({environment:t,collectionViewBlockStore:r,schema:a,transaction:n,initializeWithAllDefaultQuestions:!1});if(!s)return;(0,E().f8)({environment:t,collectionContextStore:o,collectionViewId:s.newViewId,isFullScreen:o.isFullScreenStore.state,isRootChild:o.isRootChildStore.state,isInPeekRenderer:o.isInPeekRendererStore.state});const l=s.layoutStore,c=Object.keys(a).filter((e=>{const t=a[e];return"title"!==e&&t&&(0,Y().I0)(t)}));c.length>0&&c.length<=Y().h0&&T().vC({showCancel:!1,keepFocus:!1,message:(0,$.jsx)(ne,{}),mode:"wide",items:[{label:(0,$.jsx)(h()._H,{defaultMessage:"Create {numQuestions, plural, one {1 question} other {{numQuestions} questions}}",id:"formEditorActions.createQuestions.primaryAction",values:{numQuestions:c.length}}),color:"blue",buttonType:"solid",onAccept(){Q().createAndCommit({environment:t,userAction:"formActions.autoCreateFormQuestionsForExistingDatabase",canUndo:!0,perform:e=>{for(const n of c)de({environment:t,transaction:e,layoutStore:l,collectionStore:i,propertyId:n,position:{type:"area_relative",area:"form_layout_schema",location:"end_moveable"},addLayoutModule:o=>{(0,L().sW)({environment:t,sessionId:(0,b().ZP)(),layoutStore:l,position:o.position??{type:"area_relative",area:"form_layout_schema",location:"end_moveable"},module:o.layoutModule,transaction:e,isPropertyCreation:!1})},collectionContextStore:o,shouldLogEvent:!0,autoCreatedFromExistingDatabase:!0})}})}},{label:(0,$.jsx)(h()._H,{defaultMessage:"Start from scratch",id:"formEditorActions.createQuestions.secondary"}),color:"gray",buttonType:"plain",onAccept(){}}]})}function ie(e){const{environment:t,collectionViewBlockStore:o,transaction:n,schema:r,initializeWithAllDefaultQuestions:i}=e;if(!o)return;const l=o.getSpaceId(),{formBlockStore:c,layoutStore:d}=function(e){var t;const{environment:o,spaceId:n,inMemoryRecordCache:r,transaction:i,schema:l,initializeWithAllDefaultQuestions:c}=e,d=Object.keys(l).find((e=>{var t;return"select"===(null===(t=l[e])||void 0===t?void 0:t.type)})),m=Boolean(c&&void 0!==d),p=(0,D().TS)({environment:o,table:f().iU,spaceId:n}),y=(0,D().TS)({environment:o,table:g().L_,spaceId:n}),S=m?(0,D().TS)({environment:o,table:g().L_,spaceId:n}):void 0,h=P().j4({id:p,environment:o,type:"form",permissions:(0,a().wG)(),inMemoryRecordCache:r,transaction:i}),b=P().ae({environment:o,table:v().Bh,value:{space_id:n,parent_table:f().iU,parent_id:h.id,modules:(0,u().l2)(y,S)},inMemoryRecordCache:r,transaction:i});var C;A().FH({stores:[h],update:{form_layout_pointer:{id:b.id,spaceId:n,table:v().Bh}},transaction:i}),ce({environment:o,questionId:y,spaceId:n,layoutId:b.id,propertyId:s().iw,initialQuestionTitle:(null===(t=l[s().iw])||void 0===t?void 0:t.name)??"",inMemoryRecordCache:r,transaction:i,shouldSyncQuestionNameToPropertyName:!0,shouldLogEvent:!1}),m&&S&&d&&ce({environment:o,questionId:S,spaceId:n,layoutId:b.id,propertyId:d,initialQuestionTitle:(null===(C=l[d])||void 0===C?void 0:C.name)??"",inMemoryRecordCache:r,transaction:i,shouldSyncQuestionNameToPropertyName:!0,shouldLogEvent:!1});return{formBlockStore:h,layoutStore:b}}({environment:t,spaceId:l,inMemoryRecordCache:o.inMemoryRecordCache,transaction:n,schema:r,initializeWithAllDefaultQuestions:i}),m=(0,E().W9)({environment:t,collectionViewBlockStore:o,collectionView:{type:"form_editor",parent_id:o.id,parent_table:f().iU,alive:!0,space_id:l,name:j().Z.formatMessage(X.newFormViewName),format:{form_block_pointer:{id:c.id,spaceId:l,table:f().iU}}},transaction:n});return P().sW({store:c,data:{parent_id:m.id,parent_table:y().np,alive:!0},transaction:n}),G().Z.setState({openTooltip:m.id}),q().yM(t,J),ee(t,n),{newViewId:m.id,layoutStore:d,formId:c.id}}function ae(e){const{environment:t,navigateToFormBuilder:o}=e,{currentSpaceStore:n,currentSpaceViewStore:i}=O().default.state;if(!n||!i)return;if(!(0,K().ww)(t))return void(0,K().eD)(t);if(!(n&&n.canEdit()&&i))return;const a=n.id,s=t.idCreator.getSpaceIdCreatorSync(a);Q().createAndCommit({environment:t,userAction:"formActions.createAndNavigateToFormInPrivate",canUndo:!0,perform:e=>{var l;const{targetBlockStore:c}=x().Z({environment:t,sourceBlockId:"root",targetBlockPointer:(0,D().Ii)({environment:t,table:f().iU,spaceId:a}),sourceBlockSubtree:(0,m().partialRecordMapToRecordMap)(R().Xq({isInline:!0,name:(0,S().TPx)(j().Z.formatMessage(X.formDatabaseTitle))})),targetRecordCache:n.inMemoryRecordCache,transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!1,spaceIdCreator:s}),d=c.getCollectionStore(),u=null==d||null===(l=d.getModel())||void 0===l?void 0:l.getNormalizedSchema(),p=c;if(!u)throw new Error("Schema not found");ie({environment:t,transaction:e,collectionViewBlockStore:p,schema:u,initializeWithAllDefaultQuestions:!0}),se({environment:t,transaction:e,collectionViewBlockStore:p,schema:u}),M().Hj({environment:t,spaceStore:n,spaceViewStore:i,pageStore:c,isPrivate:!0,transaction:e,location:{type:"prepend"}}),o&&F()._c({environment:t,store:c,pageVisitSource:r().tY.CreateFormDeepLink})}})}function se(e){const{environment:t,collectionViewBlockStore:o,transaction:n}=e,r=o.getSpaceId(),i=Object.keys(e.schema).find((t=>{var o;return"created_by"===(null===(o=e.schema[t])||void 0===o?void 0:o.type)}));(0,E().W9)({environment:t,collectionViewBlockStore:o,collectionView:{type:"table",parent_id:o.id,parent_table:f().iU,alive:!0,name:j().Z.formatMessage(X.responsesViewName),space_id:r,format:{table_properties:[{property:"title",visible:!0},...i?[{property:i,visible:!0}]:[]],table_wrap:!0,collection_pointer:o.getCollectionPointer()}},transaction:n})}function le(e){let{environment:t,moduleId:o,sessionId:n,layoutStore:r,collectionSettingsStore:i,isCollectionEmpty:a,collectionContextStore:s,propertyId:l,questionId:c}=e;const d=s.collectionStore();if(!d)throw new Error("Could not find collection store");const u=s.normalizedSchemaStore.state;Q().createAndCommit({environment:t,userAction:"formActions.deleteFormQuestion",canUndo:!0,perform:e=>{var i;(0,W().H)({environment:t,position:{area:"form_layout_schema",moduleId:o},layoutStore:r,sessionId:n,transaction:e});const s=null===(i=u[l])||void 0===i?void 0:i.type;a&&s&&"title"!==s&&w().E2({environment:t,collectionStore:d,schema:u,property:l,transaction:e})}}),(0,k().j)({environment:t,event:{eventName:"delete_form_question",eventProperties:(0,Y().Pz)({collectionContextStore:s,propertyId:l,questionId:c})}}),_().E3({collectionSettingsStore:i})}function ce(e){const{environment:t,questionId:o,spaceId:n,layoutId:r,propertyId:i,initialQuestionTitle:a,inMemoryRecordCache:s,transaction:l,shouldSyncQuestionNameToPropertyName:c,collectionContextStore:d,shouldLogEvent:u=!0,autofocusTitle:m,existingFormQuestionConfig:p,autoCreatedFromExistingDatabase:f}=e;P().ae({environment:t,table:g().L_,value:{id:o,space_id:n,parent_table:v().Bh,parent_id:r,alive:!0,config:{...p,propertyId:i,name:[[a]],shouldSyncQuestionNameToPropertyName:c}},inMemoryRecordCache:s,transaction:l}),u&&(0,k().j)({environment:t,event:{eventName:"add_form_question",eventProperties:{...(0,Y().Pz)({collectionContextStore:d,propertyId:i,questionId:o}),auto_created_from_existing_database:Boolean(f)}}}),m&&m.autofocusedQuestionTextStore.autofocusQuestionTitle({questionId:o})}function de(e){const{environment:t,transaction:o,layoutStore:n,collectionStore:r,propertyId:i,position:a,addLayoutModule:s,collectionContextStore:l,shouldLogEvent:c=!0,autofocusTitle:d,existingFormQuestionConfig:u,autoCreatedFromExistingDatabase:m}=e,p=r.getSchema()[i];if(!p)throw new Error(`No schema found for property ${i}`);const f=u?(0,S().QaF)(null==u?void 0:u.name):p.name,y=n.getSpaceId(),v=(0,D().TS)({environment:t,table:g().L_,spaceId:y});return ce({environment:t,questionId:v,spaceId:y,layoutId:n.id,propertyId:i,initialQuestionTitle:f,inMemoryRecordCache:n.inMemoryRecordCache,transaction:o,shouldSyncQuestionNameToPropertyName:!0,shouldLogEvent:c,collectionContextStore:l,autofocusTitle:d,existingFormQuestionConfig:u,autoCreatedFromExistingDatabase:m}),s({layoutModule:{type:"formQuestion",id:(0,C().ZP)(),formQuestionId:v},position:a,transaction:o}),{questionId:v}}function ue(e){const{environment:t,transaction:o,layoutStore:n,propertyId:r,initialQuestionTitle:i,moduleId:a,shouldSyncQuestionNameToPropertyName:s,collectionContextStore:l,autofocusTitle:c,area:d}=e,u=n.getModel();if(!u)throw new Error("Layout model cannot be undefined");const m=n.getSpaceId(),p=(0,D().TS)({environment:t,table:g().L_,spaceId:m});ce({environment:t,questionId:p,spaceId:m,layoutId:u.id,propertyId:r,initialQuestionTitle:i,inMemoryRecordCache:n.inMemoryRecordCache,transaction:o,shouldSyncQuestionNameToPropertyName:s,collectionContextStore:l,autofocusTitle:c});const f={type:"formQuestion",id:a??(0,C().ZP)(),formQuestionId:p,..."form_conditional_modules"===d?{parentModuleId:e.parentModuleId,parentConditionalGroupId:e.parentConditionalGroupId}:{}};return a?(0,Z().Uq)({environment:t,transaction:o,layoutStore:n,position:{area:d,moduleId:a},updatedModule:f}):"form_conditional_modules"===d&&(0,L().sW)({environment:t,transaction:o,layoutStore:n,position:{type:"absolute",area:"form_conditional_modules",parentConditionalGroupId:e.parentConditionalGroupId,parentModuleId:e.parentModuleId},module:f,sessionId:(0,b().ZP)(),isPropertyCreation:!1}),{updatedModuleId:f.id}}function me(e){let{environment:t,formBlockStore:o,isClosed:n}=e;o.getIsFormClosed()!==n&&Q().createAndCommit({userAction:"formActions.changeFormClosedState",environment:t,canUndo:!0,perform:e=>{A().FH({stores:[o],update:{form_config:{...o.getFormConfig(),is_form_closed:n}},transaction:e})}})}function pe(e){let{environment:t,formBlockStore:o,permissions:n}=e;o.getFormSubmissionPermissions()!==n&&Q().createAndCommit({userAction:"formActions.changeFormSubmissionPermissions",environment:t,canUndo:!0,perform:e=>{A().FH({stores:[o],update:{form_config:{...o.getFormConfig(),submission_permissions:n}},transaction:e})}})}function fe(e){let{environment:t,formBlockStore:o}=e;const n=o.getIsFormAnonymousSubmissionEnabled();Q().createAndCommit({userAction:"formActions.changeAnonymousFormSubmissionState",environment:t,canUndo:!0,perform:e=>{A().FH({stores:[o],update:{form_config:{...o.getFormConfig(),anonymous_submissions:!n}},transaction:e})}})}function ye(e){var t;let{environment:o,formBlockStore:n}=e;const r=n.getSiteStore();if(!r)return;const i=(null===(t=r.getHeader())||void 0===t?void 0:t.hideWatermark)??!1;Q().createAndCommit({userAction:"formBlockStore.publicForm.toggleNotionBranding",environment:o,canUndo:!0,perform:e=>{Q().applyOperation({store:r,operation:{pointer:r.pointer,path:["header","hideWatermark"],command:"set",args:!i},transaction:e})}})}function ge(e){let{environment:t,newPropertyId:o,formQuestionStore:n}=e;Q().createAndCommit({userAction:"formQuestion.remapQuestionToNewProperty",environment:t,canUndo:!0,perform:e=>{Q().applyOperation({store:n,operation:{pointer:n.pointer,path:["config","propertyId"],command:"set",args:o},transaction:e})}})}function ve(e){const{environment:t,collectionSchema:o,temporaryRecordCache:n,spaceId:r,collectionId:a,formMode:s}=e,l={};Object.keys(o).forEach((e=>{l[e]=(0,S().TPx)("")}));const{performResult:c}=Q().createAndCommit({environment:t,userAction:"formActions.createDummyFormPage",perform:e=>{const o=P().j4({environment:t,type:i().Ti.page,inMemoryRecordCache:n,transaction:e,spaceId:r,properties:{...l}});return P().sW({store:o,data:{alive:"viewer"===s,parent_id:a,parent_table:"collection"},transaction:e}),o},canUndo:!1});return c}async function Se(e){const{environment:t,formBlockStore:o,collectionSchema:n,theme:r,onAccept:i}=e;if(!n)return;const a=(0,Y().jj)(o),s=(null==a?void 0:a.getFormQuestionsForFormLayout())??[],c=[];if(s.forEach((e=>{const o=e.getPropertyId();if(!o)return;const r=(0,l().Qm)({schema:n,property:o}),i=null==r?void 0:r.type;if(!i)return;(0,Y().Hz)({environment:t,propertyType:i,propertySchema:r,isPublicForm:!0})&&c.push(e)})),0===c.length)return void i();const u=c.map(((e,t)=>{const o=(0,p().Xh)({textValue:e.getNameStore().getValue(),getRecordModel:e.getRecordModel,deterministic:!0,userTimeZone:(0,d().r)(),intl:j().Z.getIntl()}),n=t===c.length-1;return(0,$.jsx)("div",{style:{fontSize:14,textAlign:"start",padding:"8px 12px",borderBottom:n?void 0:`1px solid ${r.lightDividerColor}`},children:o},e.id)})),{accept:m}=await T().gt({message:(0,$.jsx)(h()._H,{id:"formEditorActions.maybeAlertAboutUnsupportedPublicQuestions.message",defaultMessage:"These questions are not supported in public forms and will not be shown to respondents:"}),description:(0,$.jsx)("div",{style:{borderRadius:6,border:`1px solid ${r.lightDividerColor}`,width:"calc(100% + 24px)",marginLeft:-12,marginTop:12,maxHeight:210,overflow:"auto"},children:u}),acceptLabel:(0,$.jsx)(h()._H,{id:"formEditorActions.maybeAlertAboutUnsupportedPublicQuestions.acceptLabel",defaultMessage:"Got it"}),acceptColor:"blue",cancelButtonType:"plain",mode:"wide"});m&&i()}},641929:(e,t,o)=>{o.d(t,{E:()=>r,Y:()=>i});o(821057);var n=o(667294);const r=(0,n.createContext)(null);function i(){const e=(0,n.useContext)(r);if(!e)throw new Error("useFormLayoutEditorContext must be used inside FormLayoutEditorContext.Provider");return(0,n.useMemo)((()=>e),[e])}r.displayName="FormLayoutEditorContext"},491925:(e,t,o)=>{o.d(t,{Ty:()=>l,hW:()=>a,nI:()=>s,vp:()=>c});o(267602),o(653476),o(241792);var n=()=>o(142735),r=()=>o(696459),i=()=>o(469753);const a=(0,o(788860).vU)({unsupportedPublicQuestionType:{defaultMessage:"This question type cannot be used in public forms.",id:"useNewQuestionPropertyMenuItems.invalidPublicQuestionType"},relatedCollectionNotPublic:{defaultMessage:"Only relations to public databases are supported in public forms.",id:"formEditorQuestion.relatedCollectionNotPublic"},editorPlaceholder:{defaultMessage:"Respondent's answer",id:"formEditorQuestion.editorPlaceholder"},viewerEmptyPlaceholder:{defaultMessage:"Your answer",id:"formEditorQuestion.viewerEmptyPlaceholder"}});function s(e){let{layoutStore:t,collectionStore:o}=e;const a=(0,n().VK)((()=>t.getFormQuestionsForFormLayout()??[]),[t]),s=(0,n().VK)((()=>a.map((e=>{var t;return null===(t=e.getConfig())||void 0===t?void 0:t.propertyId})).filter(r().$K)),[a]);return(0,n().VK)((()=>{if(!o)return[];const e=o.getSchema();if(!t.getModel())return[];return(0,r().qP)(e).map((e=>{let[t,o]=e;if(o&&(0,i().I0)(o)&&!s.includes(t))return t})).filter(r().$K)}),[o,t,s])}function l(e){const t=e.type;return["person","relation","multi_select"].includes(t)}function c(e,t){var o;if(!e||!l(e))return;const n=e.type,r=null==t||null===(o=t.getPropertyTypeSpecificConfig(n))||void 0===o?void 0:o.maxSelectionCount;if("multi_select"===e.type)return r;const i=e.limit;return void 0===r?i:void 0===i||r<i?r:i}},839708:(e,t,o)=>{o.d(t,{r:()=>l});var n=()=>o(219727),r=()=>o(142735),i=()=>o(846550),a=()=>o(718611),s=()=>o(641702);function l(e){let{textStore:t,parentStore:o,spaceId:l,disabled:c=!1}=e;const d=(0,n().O7)(),u=(0,i().Fg)(),m=(0,a().kw)(),p=(0,r().VK)((()=>d.KatexStore.getKatex()),[d.KatexStore]);return(0,r().VK)((()=>{const e=null==t?void 0:t.getValue();return e&&l&&o?s().IY({environment:d,textValue:{value:e,spaceId:l},parentStore:o,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableCommentAnnotations:!0,disabled:c,theme:u,disableLinks:c,emojiType:m,katex:p,formulaValueTypes:[]}):null}),[c,m,d,p,o,l,t,u])}},808282:(e,t,o)=>{o.d(t,{Z:()=>r});class n extends(()=>o(263184))().default{getInitialState(){return{openTooltip:void 0}}}const r=new n}}]);