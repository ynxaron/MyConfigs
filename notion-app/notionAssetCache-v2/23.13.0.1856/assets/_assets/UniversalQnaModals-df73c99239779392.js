"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[58183],{260685:(e,t,n)=>{n.r(t),n.d(t,{UniversalQnaModals:()=>Bt});n(241792);var o=n(667294),i=()=>n(219727),s=()=>n(142735),r=()=>n(801812),a=()=>n(824462),c=()=>n(343353),l=()=>n(36560),d=()=>n(261369),u=()=>n(876822),g=()=>n(524434),p=()=>n(749826),m=()=>n(487985),h=()=>n(25694),v=()=>n(897257),f=()=>n(68247),_=()=>n(993261),y=()=>n(846550),x=()=>n(788860),S=()=>n(707513),j=()=>n(231077),C=()=>n(154186),b=()=>n(738217),I=()=>n(708518),w=()=>n(251932),k=()=>n(594546),M=()=>n(148126),T=()=>n(863606),A=()=>n(388957),D=()=>n(77751),H=()=>n(666551),U=()=>n(965910),B=n(785893);function N(e){const{integrationLogoIcon:t,title:n,subtext:o}=e,i=(0,y().yK)((e=>({logoSection:{padding:"40px 20px 24px 20px",gap:8,justifyContent:"center",alignItems:"center"},logos:{width:40,height:40},arrowLogo:{width:20,height:20,color:e.icon.secondary},titleWrapper:{width:"100%",justifyContent:"center",textAlign:"center",alignItems:"center"},title:{fontSize:16,width:352,fontWeight:S().Ue.medium,lineHeight:"22px",marginBottom:"2px",justifyContent:"center",textWrap:"balance"},subtext:{fontSize:14,fontWeight:S().Ue.regular,color:`${e.text.secondary}`,textAlign:"center",alignItems:"center",justifyContent:"center",paddingLeft:20,paddingRight:20,textWrap:"balance"},wrapper:{paddingBottom:16}})),[]);return(0,B.jsxs)("div",{style:i.wrapper,children:[(0,B.jsxs)(w().gq,{style:i.logoSection,children:[(0,U().h)(i.logos),(0,H().O)(i.arrowLogo),t(i.logos)]}),(0,B.jsxs)(w().Ht,{style:i.titleWrapper,children:[(0,B.jsx)(w().gq,{style:i.title,children:n}),o?(0,B.jsx)(w().gq,{style:i.subtext,children:o}):(0,B.jsx)(B.Fragment,{})]})]})}function F(){const e=(0,i().O7)(),t=(0,y().yK)((e=>({wrapper:{width:400,gap:16,alignContent:"center"},waitingForConnectionWrapper:{gap:4},note:{fontWeight:S().Ue.regular,fontSize:14,lineHeight:"18px",width:330,marginLeft:8},noteHeading:{fontWeight:S().Ue.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:S().Ue.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px"},learnMoreButton:{gap:4,alignItems:"center",fontSize:14,color:e.text.secondary,justifyContent:"center",padding:4},buttonContainer:{justifyContent:"center"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"}})),[]),n=(0,s().VK)((()=>"connecting"===l().githubAIConnectorStore.state.currentScreen),[]),r=(0,s().VK)((()=>{var e;return null===(e=u().default.getState().currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]);(0,T().W)((async()=>{if(!r)return;if("connecting"!==l().githubAIConnectorStore.state.currentScreen)return;const t=await a().callApi({eventName:"getGithubAIConnectorStatus",environment:e,data:{spaceId:r}});"success"===t.type&&t.data.isConnected&&l().githubAIConnectorStore.setState({...l().githubAIConnectorStore.state,currentScreen:"confirmation"})}),1e3,!0);const c=(0,o.useCallback)((()=>[(0,B.jsxs)(w().Ht,{style:{gap:4},children:[(0,B.jsx)("div",{style:t.noteHeading,children:(0,B.jsx)(x()._H,{id:"universalQna.github.waitingForConnectionNoteHeading1",defaultMessage:"GitHub should open automatically on a new tab."},"note1-1")}),(0,B.jsx)("div",{style:t.noteBody,children:(0,B.jsx)(x()._H,{id:"universalSearch.github.waitingForConnectionNoteBody1",defaultMessage:"If it doesn't, {ClickHereToRetry}",values:{ClickHereToRetry:(0,B.jsx)("a",{style:t.link,href:l().githubAIConnectorStore.state.authUrl,target:"_blank",children:(0,B.jsx)(x()._H,{id:"universalQna.github.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,B.jsxs)(w().Ht,{style:{gap:4},children:[(0,B.jsx)("div",{style:t.noteHeading,children:(0,B.jsx)(x()._H,{id:"universalSearch.github.workspaceAdminHeading",defaultMessage:"If you are a GitHub organization administrator:"},"note2-2")}),(0,B.jsx)("div",{style:t.noteBody,children:(0,B.jsx)(x()._H,{id:"universalSearch.github.workspaceAdminBody",defaultMessage:"Follow GitHub's instructions to connect. Return to this window, and the process will continue automatically."},"note2-3")}),(0,B.jsxs)(w().Ht,{style:{marginTop:16,gap:4},children:[(0,B.jsx)("div",{style:t.noteHeading,children:(0,B.jsx)(x()._H,{id:"universalSearch.github.notWorkspaceAdminHeading",defaultMessage:"If you are not authorized to install external apps:"},"note2-4")}),(0,B.jsx)("div",{style:t.noteBody,children:(0,B.jsx)(x()._H,{id:"universalSearch.github.notWorkspaceAdminBody",defaultMessage:"Follow the instructions to request access to install the app. Then, revisit the connect menu to continue setup."},"note2-5")})]})]},"note-2")]),[t]),d=(0,o.useCallback)((()=>{const t=(0,M().UY)("guides.aiConnectorGithub");(0,k().j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_connecting_modal",integration_type:"github",setup_session_id:l().githubAIConnectorStore.state.sessionId,from:l().githubAIConnectorStore.state.analyticsFrom}}}),e.device.isElectron?j().openExternalUrl(t):window.open(t,"_blank")}),[e]),g=(0,o.useCallback)((()=>{l().githubAIConnectorStore.reset(),(0,k().j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_github_connecting_modal",integration_type:"github",setup_session_id:l().githubAIConnectorStore.state.sessionId,from:l().githubAIConnectorStore.state.analyticsFrom}}})}),[e]);return(0,B.jsx)(I().Z,{open:n,showCloseIcon:!0,onDismiss:g,render:()=>(0,B.jsxs)(w().Ht,{style:t.wrapper,children:[(0,B.jsx)(N,{integrationLogoIcon:D().f,title:(0,B.jsx)(x()._H,{id:"universalQnA.github.followInstructionsFromGithub",defaultMessage:"Follow instructions from GitHub in your browser"})}),(0,B.jsxs)(w().Ht,{style:t.waitingForConnectionWrapper,children:[c().map(((e,n)=>(0,B.jsxs)(w().gq,{gap:8,style:{marginTop:4,marginBottom:6,justifyContent:"center"},children:[(0,B.jsx)(b().Z,{number:n+1}),(0,B.jsx)("div",{style:t.note,children:e})]},n))),(0,B.jsx)(w().gq,{style:t.buttonContainer,children:(0,B.jsx)(C().Z,{style:{marginTop:16,marginBottom:16,width:120,borderRadius:4},onClick:d,children:(0,B.jsxs)(w().gq,{style:t.learnMoreButton,children:[(0,B.jsx)(x()._H,{id:"universalSearch.github.waitingForConnection.learnMore",defaultMessage:"Learn More"}),(0,A().K)({width:16,height:16})]})})})]})]})})}var W=()=>n(454393),P=()=>n(402269),K=()=>n(312578),q=()=>n(616433),L=()=>n(669086);const z=(0,n(827282).IU)("keyLarge",{viewBox:"0 0 30 30",svg:(0,B.jsx)("g",{children:(0,B.jsx)("path",{d:"M15.005 2.979c.923 0 1.788.174 2.594.522.814.342 1.528.82 2.143 1.436a6.518 6.518 0 011.436 2.133c.349.806.523 1.671.523 2.594a6.229 6.229 0 01-1.24 3.774c-.821 1.12-2 2.006-3.538 2.655l2.543 2.553c.143.15.215.318.215.503a.641.641 0 01-.205.492l-2.615 2.605 1.877 1.856a.693.693 0 01.205.492.653.653 0 01-.206.502l-3.24 3.24a.593.593 0 01-.482.185.67.67 0 01-.44-.185L12.8 26.604a1.125 1.125 0 01-.247-.36 1.124 1.124 0 01-.071-.41v-9.946a6.754 6.754 0 01-2.225-1.456 6.704 6.704 0 01-1.959-4.768c0-.93.171-1.798.513-2.604a6.738 6.738 0 011.435-2.133A6.665 6.665 0 0112.38 3.49a6.707 6.707 0 012.625-.512zm0 6.06a1.65 1.65 0 001.21-.503 1.65 1.65 0 00.503-1.21c0-.478-.168-.882-.503-1.21a1.65 1.65 0 00-1.21-.502 1.64 1.64 0 00-1.22.502 1.645 1.645 0 00-.492 1.21c0 .472.164.875.492 1.21.335.335.742.503 1.22.503z"})})});var Z=()=>n(168441),V=()=>n(269309);function G(e){switch(e){case"slack":return(0,B.jsx)(x()._H,{id:"universalQna.slack.introModalTitle",defaultMessage:"Get answers from Slack in Notion"});case"github":return(0,B.jsx)(x()._H,{id:"universalQna.github.introModalTitle",defaultMessage:"Get answers from GitHub in Notion"});case"googleDrive":return(0,B.jsx)(x()._H,{id:"universalQna.googleDrive.introModalTitle",defaultMessage:"Get answers from Google Drive in Notion"});case"jira":return(0,B.jsx)(x()._H,{id:"universalQna.jira.introModalTitle",defaultMessage:"Get answers from Jira in Notion"});case"microsoftTeams":return(0,B.jsx)(x()._H,{id:"universalQna.microsoftTeams.introModalTitle",defaultMessage:"Get answers from Microsoft Teams in Notion"});default:return(0,B.jsx)("span",{})}}function E(e){switch(e){case"slack":return(0,B.jsx)(x()._H,{id:"universalSearchNonAdmin.slack.nonAdminModalNote",defaultMessage:"To connect Slack, contact your workspace owners."});case"github":return(0,B.jsx)(x()._H,{id:"universalSearchNonAdmin.github.nonAdminModalNote",defaultMessage:"To connect GitHub, contact your workspace owners."});case"googleDrive":return(0,B.jsx)(x()._H,{id:"universalSearchNonAdmin.googleDrive.nonAdminModalNote",defaultMessage:"To connect Google Drive, contact your workspace owners."});case"jira":return(0,B.jsx)(x()._H,{id:"universalSearchNonAdmin.jira.nonAdminModalNote",defaultMessage:"To connect Jira, contact your workspace owners."});case"microsoftTeams":return(0,B.jsx)(x()._H,{id:"universalSearchNonAdmin.microsoftTeams.nonAdminModalNote",defaultMessage:"To connect Microsoft Teams, contact your workspace owners."});default:return(0,B.jsx)("span",{})}}function R(e){switch(e){case"slack":return[{icon:z,title:(0,B.jsx)(x()._H,{id:"universalQna.slack.introModalNote1",defaultMessage:"Slack permissions are strictly respected"},"note1"),description:(0,B.jsx)(x()._H,{id:"universalQna.slack.introModalNote1Description",defaultMessage:"Notion members can only get AI answers about content they are authorized to see in Slack."},"note1description")},{icon:Z().Q,title:(0,B.jsx)(x()._H,{id:"universalQna.slack.introModalNote2",defaultMessage:"Notion does not train models on Slack data"},"note2")},{icon:V().A,title:(0,B.jsx)(x()._H,{id:"universalQna.slack.introModalNote3",defaultMessage:"AI answers always cite sources for verification"},"note3")}];case"github":return[{icon:z,title:(0,B.jsx)(x()._H,{id:"universalQna.github.introModalNote1",defaultMessage:"GitHub permissions are strictly respected"},"note1"),description:(0,B.jsx)(x()._H,{id:"universalQna.github.introModalNote1Description",defaultMessage:"Notion members can only get AI answers about content they are authorized to see in GitHub."},"note2")},{icon:Z().Q,title:(0,B.jsx)(x()._H,{id:"universalQna.github.introModalNote2",defaultMessage:"Notion does not train models on GitHub data"},"note2")},{icon:V().A,title:(0,B.jsx)(x()._H,{id:"universalQna.github.introModalNote3",defaultMessage:"AI answers always cite sources for verification"},"note3")}];case"googleDrive":return[{icon:z,title:(0,B.jsx)(x()._H,{id:"universalQna.googleDrive.introModalNote1",defaultMessage:"Google Drive permissions are strictly respected"},"note1"),description:(0,B.jsx)(x()._H,{id:"universalQna.googleDrive.introModalNote1Description",defaultMessage:"Members can only get AI answers about content they are authorized to see in Google Drive."},"note2")},{icon:Z().Q,title:(0,B.jsx)(x()._H,{id:"universalQna.googleDrive.introModalNote2",defaultMessage:"Notion does not train models on Drive data"},"note2")},{icon:V().A,title:(0,B.jsx)(x()._H,{id:"universalQna.googleDrive.introModalNote3",defaultMessage:"AI answers always cite sources for verification"},"note1")}];case"jira":return[{icon:z,title:(0,B.jsx)(x()._H,{id:"universalQna.jira.introModalNote1",defaultMessage:"Jira permissions are strictly respected"},"note1"),description:(0,B.jsx)(x()._H,{id:"universalQna.jira.introModalNote1Description",defaultMessage:"Members can only get AI answers about content they are authorized to see in Jira."},"note2")},{icon:Z().Q,title:(0,B.jsx)(x()._H,{id:"universalQna.jira.introModalNote2",defaultMessage:"Notion does not train AI models on your Jira data"},"note2")},{icon:V().A,title:(0,B.jsx)(x()._H,{id:"universalQna.jira.introModalNote3",defaultMessage:"AI answers always cite sources for verification"},"note3")}];case"microsoftTeams":return[{icon:z,title:(0,B.jsx)(x()._H,{id:"universalQna.microsoftTeams.introModalNote1",defaultMessage:"Microsoft Teams permissions are strictly respected"},"note1"),description:(0,B.jsx)(x()._H,{id:"universalQna.microsoftTeams.introModalNote1Description",defaultMessage:"Notion members can only get AI answers about content they are authorized to see in Microsoft Teams."},"note1description")},{icon:Z().Q,title:(0,B.jsx)(x()._H,{id:"universalQna.microsoftTeams.introModalNote2",defaultMessage:"Notion does not train models on Microsoft Teams data"},"note2")},{icon:V().A,title:(0,B.jsx)(x()._H,{id:"universalQna.microsoftTeams.introModalNote3",defaultMessage:"AI answers always cite sources for verification"},"note3")}];default:return[]}}var O=()=>n(906651);function Q(e){const{logo:t,appName:n,open:o,onClosed:s,learnMoreUrl:r}=e,a=(0,y().yK)((e=>({wrapper:{width:"100vw",height:"100vh",justifyContent:"center",alignItems:"center"},container:{gap:16,alignItems:"center"},learnMoreText:{gap:4,alignItems:"center",fontSize:14,color:e.text.secondary,justifyContent:"center"},actionsContainer:{gap:4,width:240,alignItems:"center"},learnMoreButton:{marginTop:16,borderRadius:6,width:"100%"},primaryButton:{width:"100%"},learnMoreWrapper:{width:"100%"}})),[]);return(0,i().O7)().device.isMobile?(0,B.jsx)(I().Z,{showCloseIcon:!0,onDismiss:s,open:o,render:()=>(0,B.jsx)(w().gq,{style:a.wrapper,children:(0,B.jsxs)(w().Ht,{style:a.container,children:[(0,B.jsx)(N,{integrationLogoIcon:t,title:(0,B.jsx)(x()._H,{id:"universalQna.notAvailableOnMobile.heading",defaultMessage:"Connecting {appName} and Notion is only available on desktop",values:{appName:n}})}),(0,B.jsxs)(w().Ht,{style:a.actionsContainer,children:[(0,B.jsx)(O().Z,{style:a.primaryButton,onClick:s,children:(0,B.jsx)(x()._H,{id:"universalQna.notAvailableOnMobile.close",defaultMessage:"Got it"})}),(0,B.jsx)(w().gq,{style:a.learnMoreWrapper,children:(0,B.jsx)(C().Z,{style:a.learnMoreButton,onClick:()=>{window.open(r,"_blank")},children:(0,B.jsxs)(w().gq,{style:a.learnMoreText,children:[(0,B.jsx)(x()._H,{id:"universalSearch.slack.waitingForConnection.learnMore",defaultMessage:"Learn More"}),(0,A().K)({width:16,height:16})]})})})]})]})})}):(0,B.jsx)(B.Fragment,{})}var J=()=>n(67961);const Y=function(e){const{title:t,open:n,notes:o,titleWidth:i,integrationIcon:s,onDismiss:r,onConnect:a,onLearnMore:c,isLoading:l,overridePrimaryMessage:d,centerNotes:u,noteStyleOverrides:g,subtitle:p}=e,m=(0,y().yK)((e=>({wrapper:{width:400,paddingTop:8},title:{fontSize:17,width:i,fontWeight:S().Ue.medium,lineHeight:"22px",marginBottom:"2px"},dataSafetyWrapper:{width:"100%",justifyContent:"center",marginTop:8},dataSafetyContainer:{width:"352px",font:S().Gl.sans},integrationSecurityHeading:{gap:10,display:"flex",alignItems:"center"},integrationSecurityHeadingText:{fontWeight:S().Ue.medium,fontSize:14,lineHeight:"18px"},notes:{display:"flex",flexDirection:"column",marginTop:12,gap:12,font:S().Gl.sans,listStylePosition:"outside",paddingLeft:2,listStyleType:"none",...u&&{textAlign:"center",justifyContent:"center"}},note:{display:"flex",alignItems:"start",fontSize:S().JB.UIRegular.desktop,lineHeight:S().Nv.UIRegular.desktop,color:`${e.text.secondary}`,padding:2,gap:12,listStylePosition:"outside",marginBottom:4,...u&&{alignItems:"center",textAlign:"center",justifyContent:"center"},...g},noteIconWrapper:{display:"flex",alignItems:"center",justifyContent:"center"},noteTextWrapper:{display:"flex",flexDirection:"column",alignItems:"start",justifyContent:"center",gap:4},noteIcon:{width:20,height:20,color:e.accentColors.uiBlue[600]},noteTitle:{fontWeight:S().Ue.medium},footer:{justifyContent:"center",alignItems:"center",bottom:0,width:"100%",height:80,boxShadow:"0px 9px 24px 0px #0F0F0F33",padding:"20px 20px 20px 20px",gap:6,marginTop:12},connectButton:{fontSize:14,fontWeight:S().Ue.semibold,width:"100%"},learnMoreButton:{fontSize:14,fontWeight:S().Ue.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:S().Ue.medium,fontSize:12,gap:5,justifyContent:"center",alignItems:"center",padding:"4px 8px 4px 8px",color:`${e.text.secondary}`},externalLinkIcon:{width:16,height:16},sampleText:{display:"flex",width:"100%",color:e.text.secondary,fontWeight:S().Ue.medium,fontSize:S().JB.UISmall.desktop}})),[i,u,g]);return(0,B.jsx)(I().Z,{showCloseIcon:!0,onDismiss:r,open:n,render:()=>(0,B.jsxs)("div",{style:m.wrapper,children:[(0,B.jsx)(N,{integrationLogoIcon:s,title:t,subtext:p}),o&&(0,B.jsx)(w().gq,{style:m.dataSafetyWrapper,children:(0,B.jsx)("div",{style:m.dataSafetyContainer,children:(0,B.jsx)("ul",{style:m.notes,children:o.map(((e,t)=>(0,B.jsxs)("li",{style:m.note,children:[(0,B.jsx)("div",{style:m.noteIconWrapper,children:e.icon&&e.icon(m.noteIcon)}),(0,B.jsxs)("div",{style:m.noteTextWrapper,children:[(0,B.jsx)(J().Z,{isMultiline:!0,style:m.noteTitle,children:e.title}),e.description&&(0,B.jsx)(J().Z,{isMultiline:!0,isSecondaryColor:!0,children:e.description})]})]},`note-${t}`)))})})}),(0,B.jsxs)(w().Ht,{style:m.footer,children:[(0,B.jsx)(O().Z,{isLoading:l,disabled:l,style:m.connectButton,onClick:a,children:d||(0,B.jsx)(x()._H,{id:"universalSearch.integration.connect",defaultMessage:"Connect"})}),c&&(0,B.jsx)(C().Z,{style:m.learnMoreButton,onClick:c,children:(0,B.jsxs)(w().gq,{style:m.learnMoreText,children:[(0,B.jsx)(x()._H,{id:"universalSearch.integrations.learnMore",defaultMessage:"Learn more about AI Connectors"}),(0,A().K)({width:20,height:20})]})})]})]})})};function $(e){const{onConnect:t,onDismiss:n,open:o,integrationIcon:i,message:s}=e;return(0,B.jsx)(Y,{onConnect:t,onDismiss:n,title:(0,B.jsx)(x()._H,{id:"universalSearchNonAdmin.nonAdmin.nonAdminModalTitle",defaultMessage:"You're almost there!"}),integrationIcon:i,titleWidth:210,subtitle:s,overridePrimaryMessage:(0,B.jsx)(x()._H,{id:"universalSearchNonAdmin.nonAdmin.findAdmins",defaultMessage:"Find them here{space}{learnMoreIcon}",values:{space:(0,B.jsx)("span",{style:{marginLeft:4}}),learnMoreIcon:(0,A().K)({width:20,height:20})}}),centerNotes:!0,noteStyleOverrides:{fontSize:"14px"},open:o})}var X=()=>n(661297),ee=()=>n(316773);const te=(0,x().vU)({primedTextInput:{id:"aiConnectors.github.primedTextInput",defaultMessage:"Find a GitHub PR/Issue/Code file about: "}});function ne(e){const{open:t}=e,n=(0,i().O7)(),s=(0,x().YB)(),r=(0,y().yK)((e=>({body:{alignItems:"center",color:e.text.secondary,fontSize:12},container:{padding:12},tryItButton:{marginTop:16}})),[]),a=(0,o.useCallback)((()=>{l().githubAIConnectorStore.setState({...l().githubAIConnectorStore.state,currentScreen:"none"}),ee().assistantMenuActions.openAssistantRightHandSideMenu({environment:n,from:"github_ai_connector_already_connected",primeTextInput:s.formatMessage(te.primedTextInput)})}),[n,s]);return(0,B.jsx)(I().Z,{showCloseIcon:!0,onDismiss:()=>{l().githubAIConnectorStore.reset()},open:t,render:()=>(0,B.jsxs)(w().Ht,{style:r.container,children:[(0,B.jsx)(N,{integrationLogoIcon:D().f,title:(0,B.jsx)(x()._H,{id:"aiConnectors.github.alreadyConnected",defaultMessage:"GitHub is already connected to Notion AI"})}),(0,B.jsxs)(w().Ht,{gap:2,style:r.body,children:[(0,B.jsx)("div",{children:(0,B.jsx)(x()._H,{id:"aiConnectors.github.githubConnectedDescription",defaultMessage:"You're fully set up."})}),(0,B.jsx)("div",{children:(0,B.jsx)(x()._H,{id:"aiConnectors.github.tryIt",defaultMessage:"Try asking AI about your GitHub repositories!"})})]}),(0,B.jsx)(X().Z,{style:r.tryItButton,onClick:a,children:(0,B.jsx)(x()._H,{id:"aiConnectors.github.tryAskingAQuestion",defaultMessage:"Try asking a question"})})]})})}const oe=(0,x().vU)({githubAIConnectorOauthPopupTitle:{defaultMessage:"Connect GitHub AI Connector",id:"githubAIConnector.oauthPopupTitle"}});function ie(){const e=(0,o.useMemo)((()=>G("github")),[]),t=(0,o.useMemo)((()=>R("github")),[]),n=(0,i().O7)(),c=(0,o.useMemo)((()=>E("github")),[]),[d,g]=(0,o.useState)("CLOSED"),p=(0,s().VK)((()=>{var e;return null===(e=u().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),m=(0,s().Kw)(l().githubAIConnectorStore),h=(0,s().VK)((()=>l().githubAIConnectorStore.state.sessionId),[]),v=(0,s().VK)((()=>l().githubAIConnectorStore.state.analyticsFrom),[]),f=(0,y().yK)((()=>({loadingWrapper:{padding:20,fontSize:12,fontWeight:S().Ue.regular,justifyContent:"center",gap:8,alignItems:"center"}})),[]),_=(0,q().J)(),C=(0,L().y)(),b=(0,o.useCallback)((()=>{const e=(0,M().UY)("guides.aiConnectorGithub");(0,k().j)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_intro_modal",integration_type:"github",setup_session_id:l().githubAIConnectorStore.state.sessionId,from:l().githubAIConnectorStore.state.analyticsFrom}}}),n.device.isElectron?j().openExternalUrl(e):window.open(e,"_blank")}),[n]),T=(0,o.useCallback)((async()=>{if(!p)return;const e=await a().callApi({eventName:"getGithubOrgAuthUrl",environment:n,data:{spaceId:p,isDesktop:n.device.isElectron,sessionId:l().githubAIConnectorStore.state.sessionId}});if("success"!==e.type)return;const t=e.data.url;n.device.isElectron?j().openExternalUrl(t):P().M(n,{width:800,height:600,url:t,titleMessage:oe.githubAIConnectorOauthPopupTitle}),l().githubAIConnectorStore.setState({...l().githubAIConnectorStore.state,authUrl:t,currentScreen:"connecting"})}),[p,n]),[A]=(0,r().r5)((async()=>{if(!p||"introduction"!==m.currentScreen)return;if(m.githubOrg)return{isGithubConnected:!0};const e=await a().callApi({eventName:"getGithubAIConnectorStatus",environment:n,data:{spaceId:p}});return"success"===e.type?{isGithubConnected:e.data.isConnected}:void 0}),[n,m.currentScreen,m.githubOrg,p]);(0,o.useEffect)((()=>{"introduction"===m.currentScreen?"resolved"===A.status?g("OPEN"):g("LOADING"):g("CLOSED")}),[A.status,m.currentScreen]);const H=(0,o.useRef)(!1),U=(0,o.useCallback)((()=>{l().githubAIConnectorStore.reset(),(0,k().j)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_github_intro_modal",integration_type:"github",setup_session_id:l().githubAIConnectorStore.state.sessionId,from:l().githubAIConnectorStore.state.analyticsFrom}}}),H.current=!1}),[n]),N=(0,o.useCallback)((async()=>{await T(),(0,k().j)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"github_ai_connector_auth_url_open",integration_type:"github",setup_session_id:l().githubAIConnectorStore.state.sessionId,from:l().githubAIConnectorStore.state.analyticsFrom}}}),l().githubAIConnectorStore.setState({...l().githubAIConnectorStore.state,currentScreen:"connecting"})}),[n,T]);return(0,o.useEffect)((()=>{p&&_&&"resolved"===A.status&&"introduction"===m.currentScreen&&(H.current||((0,k().j)({environment:n,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"github",setup_session_id:m.sessionId,from:m.analyticsFrom,is_space_admin:_,is_ai_eligible:C}}}),H.current=!0))}),[p,n,A.status,m.sessionId,m.analyticsFrom,_,C,m.currentScreen]),p&&"CLOSED"!==d?n.device.isMobile?(0,B.jsx)(Q,{logo:D().f,appName:"GitHub",open:"introduction"===m.currentScreen,onClosed:()=>{l().githubAIConnectorStore.reset()},learnMoreUrl:(0,M().UY)("guides.aiConnectorGithub")}):"LOADING"===d?(0,B.jsx)(I().Z,{open:"LOADING"===d,render:()=>(0,B.jsxs)(w().gq,{style:f.loadingWrapper,children:[(0,B.jsx)(x()._H,{id:"universalQna.github.isFetchingConnection",defaultMessage:"Getting connection status"}),(0,B.jsx)(K().Z,{})]})}):m.isConnected?(0,B.jsx)(ne,{open:!0}):_?(0,B.jsx)(Y,{onConnect:N,onDismiss:U,onLearnMore:b,title:e,integrationIcon:D().f,notes:t,open:"OPEN"===d,titleWidth:210}):(0,B.jsx)($,{message:c,integrationIcon:D().f,onConnect:()=>{l().githubAIConnectorStore.reset(),(0,k().j)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"contact_workspace_owners",integration_type:"github",setup_session_id:h,from:v}}}),W().r$({openedFrom:"github_connect_nonadmin_modal",currentTab:"members"})},onDismiss:U,open:"OPEN"===d}):(0,B.jsx)(B.Fragment,{})}var se=()=>n(102182),re=()=>n(527278),ae=()=>n(636754);const ce=function(){const e=(0,s().Kw)(l().githubAIConnectorStore),[t,n]=(0,o.useState)(!1),r=(0,i().O7)(),c=(0,s().VK)((()=>{var e;return null===(e=u().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),d=(0,o.useCallback)((()=>{(0,k().j)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"close_settings",integration_type:"github",setup_session_id:l().githubAIConnectorStore.state.sessionId,from:l().githubAIConnectorStore.state.analyticsFrom}}}),l().githubAIConnectorStore.reset()}),[r]),g=(0,o.useCallback)((()=>{n(!1)}),[]),p=(0,y().yK)((e=>({wrapper:{width:400},channelDetailsContainer:{width:352,fontSize:14,fontWeight:S().Ue.regular,color:e.text.secondary},channelDetailsSubtitle:{textAlign:"center",marginBottom:"16px"},channelDetailsWrapper:{justifyContent:"center",paddingTop:"12px",paddingBottom:"12px"},channelNamesContainer:{gap:2,color:e.text.primary},footer:{justifyContent:"center",alignItems:"center",width:"100%",padding:"20px 20px 20px 20px",gap:8},disconnectButton:{fontSize:14,fontWeight:S().Ue.medium,width:"100%"},moreChannelsContainer:{paddingTop:8},learnMoreButton:{fontSize:14,fontWeight:S().Ue.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:S().Ue.medium,fontSize:12,gap:5,justifyContent:"center",alignItems:"center",padding:"4px 8px 4px 8px",color:`${e.text.secondary}`},externalLinkIcon:{width:16,height:16},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:S().Ue.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:S().Ue.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:S().Ue.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:S().Ue.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:14,fontWeight:S().Ue.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},spinner:{paddingTop:20,paddingBottom:40,justifyContent:"center",alignItems:"center"},editChannelsButton:{fontSize:14,fontWeight:S().Ue.medium,width:"100%"}})),[]);return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(I().Z,{showCloseIcon:!0,onDismiss:g,open:t,render:()=>(0,B.jsx)("div",{style:p.confirmWrapper,children:(0,B.jsxs)("div",{style:p.confirmContainer,children:[(0,B.jsx)("div",{style:p.confirmModalTitle,children:(0,B.jsx)(x()._H,{id:"githubAIConnector.settings.confirmation.title",defaultMessage:"Are your sure?"})}),(0,B.jsx)("div",{style:p.confirmModalSubTitle,children:(0,B.jsx)(x()._H,{id:"githubAIConnector.settings.confirmation.subTitle",defaultMessage:"Your GitHub data will be permanently deleted from Notion."})}),(0,B.jsx)("div",{style:p.confirmModalDescription,children:(0,B.jsx)(x()._H,{id:"githubAIConnector.settings.confirmation.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."})}),(0,B.jsxs)(w().Ht,{style:p.confirmModalActionButtons,children:[(0,B.jsx)(O().Z,{isRed:!0,style:p.confirmDisconnectButton,onClick:async()=>{c&&((0,k().j)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"account_disconnect_confirmation",integration_type:"github",setup_session_id:l().githubAIConnectorStore.state.sessionId,from:l().githubAIConnectorStore.state.analyticsFrom}}}),await a().callApi({eventName:"disconnectGithub",environment:r,data:{spaceId:c}}),l().githubAIConnectorStore.reset(),n(!1),se().oV({label:re().Z.getIntl().formatMessage({defaultMessage:"GitHub disconnected. This can take up to 3 hours.",id:"githubAIConnector.settings.confirmation.disconnected"}),position:"bottom"}))},children:(0,B.jsx)(x()._H,{id:"githubAIConnector.settings.confirmDisconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"})}),(0,B.jsx)(C().Z,{style:p.goBackButton,onClick:g,children:(0,B.jsx)(x()._H,{id:"githubAIConnector.settings.confirmDisconnectModal.goBack",defaultMessage:"Go back"})})]})]})})}),(0,B.jsx)(I().Z,{showCloseIcon:!0,onDismiss:d,open:"settings"===e.currentScreen,render:()=>(0,B.jsxs)("div",{style:p.wrapper,children:[(0,B.jsx)(N,{integrationLogoIcon:D().f,title:(0,B.jsx)(x()._H,{id:"githubAIConnector.settings.settingsModalTitle",defaultMessage:"GitHub is connected to Notion AI"}),subtext:(0,B.jsx)(x()._H,{id:"githubAIConnector.settings.canAnswerFrom",defaultMessage:"Notion AI can answer questions about your GitHub repositories."})}),(0,B.jsxs)(w().Ht,{style:p.footer,children:[(0,B.jsx)(X().Z,{style:p.editChannelsButton,onClick:()=>{var t,n;(0,k().j)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"open_github_for_edit_selection",integration_type:"github",setup_session_id:l().githubAIConnectorStore.state.sessionId,from:l().githubAIConnectorStore.state.analyticsFrom}}}),window.open(`https://github.com/organizations/${null===(t=e.githubOrg)||void 0===t?void 0:t.name}/settings/installations/${null===(n=e.githubOrg)||void 0===n?void 0:n.installationId}`,"_blank")},children:(0,B.jsx)(x()._H,{id:"githubAIConnector.settings.editRepos",defaultMessage:"Edit Selected Repositories"})}),(0,B.jsx)(O().Z,{isGray:!0,style:p.disconnectButton,onClick:()=>{(0,k().j)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"account_disconnect",integration_type:"github",setup_session_id:l().githubAIConnectorStore.state.sessionId,from:"connection_settings"}}}),n(!0)},children:(0,B.jsx)(x()._H,{id:"githubAIConnector.settings.disconnectGithub",defaultMessage:"Disconnect"})}),(0,B.jsx)(C().Z,{style:p.learnMoreButton,onClick:()=>{(0,k().j)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_settings_modal",integration_type:"github",setup_session_id:l().githubAIConnectorStore.state.sessionId,from:"connection_settings"}}});const e=(0,M().UY)("guides.aiConnectorGithub");window.open(e,"_blank")},children:(0,B.jsxs)(w().gq,{style:p.learnMoreText,children:[(0,B.jsx)(x()._H,{id:"githubAIConnector.settings.learnMore",defaultMessage:"Learn more"}),(0,ae().g)(p.externalLinkIcon)]})})]})]})})]})};var le=()=>n(92175),de=()=>n(817771);const ue=function(e){const{open:t,subText:r,integrationIcon:a,notes:c,onDismiss:l,onPrimaryButtonClick:d,onCopiedClick:g,title:p,copyTextMessage:m,primaryButtonText:h}=e,[v,f]=(0,o.useState)(!0),[_,j]=(0,o.useState)(!1),C=(0,i().O7)(),b=(0,x().YB)(),k=(0,y().yK)((e=>({wrapper:{width:400},subText:{display:"flex",width:"100%",color:e.text.secondary,fontWeight:S().Ue.regular,fontSize:S().JB.UIRegular.desktop,justifyContent:"center",alignItems:"center"},notesContainer:{marginTop:24,font:S().Gl.sans,paddingLeft:20,paddingRight:20,textAlign:"left",justifyContent:"center"},copyTextContainer:{borderRadius:6,border:`1px solid ${e.stroke.secondary}`,margin:20},copyTextIcon:{margin:8},copyTextMessage:{fontSize:S().JB.UISmall.desktop,fontWeight:S().Ue.regular,color:`${e.text.secondary}`,width:"fit-content",margin:8,marginLeft:4},buttonContainer:{justifyContent:"center",borderTop:`1px solid ${e.stroke.secondary}`,paddingTop:5,paddingBottom:5},copyButton:{borderRadius:17,opacity:.8,fontSize:15,fontWeight:S().Ue.medium,minWidth:68,height:34,padding:"0px 12px 0px 6px",justifyContent:"center",alignItems:"center",gap:2},clipboardText:{paddingRight:6,color:`${e.text.tertiary}`,height:34}})),[]),M=(0,s().VK)((()=>u().default.state.currentUserStore),[]);return(0,B.jsx)(I().Z,{open:t,onDismiss:()=>{f(!0),l()},render:()=>(0,B.jsxs)("div",{style:k.wrapper,children:[(0,B.jsx)(N,{integrationLogoIcon:a,title:p}),(0,B.jsx)(w().gq,{style:k.subText,children:r}),(0,B.jsx)(w().Ht,{style:k.notesContainer,className:"notes-Container",children:c.map(((e,t)=>e))}),(0,B.jsxs)(w().Ht,{style:k.copyTextContainer,className:"CopyTextContainer",children:[(0,B.jsxs)(w().gq,{children:[(0,B.jsx)(n(981583).Z,{style:k.copyTextIcon,size:24,userStore:M,avatarShouldShowShadow:!1,hasTooltip:!1}),(0,B.jsx)("div",{style:k.copyTextMessage,children:b.formatMessage(m)})]}),(0,B.jsx)(w().gq,{style:k.buttonContainer,children:v?(0,B.jsx)(le().Z,{isBlue:!0,onClick:async()=>{f(!1);(await n(959137).F.clipboardActions.load()).copyString({environment:C,stringValue:b.formatMessage(m)}),g()},style:k.copyButton,icon:n(325107).U,children:(0,B.jsx)(x()._H,{id:"assistantOverflowMenu.UniversalQna.connectionComplete.copyButton",defaultMessage:"Copy"})}):(0,B.jsx)(le().Z,{style:k.clipboardText,icon:de().A,children:(0,B.jsx)(x()._H,{id:"assistantOverflowMenu.UniversalQna.connectionComplete.copyButtonSuccess",defaultMessage:"Copied to clipboard"})})})]}),d&&(0,B.jsx)(w().gq,{style:{margin:20},children:(0,B.jsx)(O().Z,{isLoading:_,style:{fontSize:14,fontWeight:S().Ue.semibold,width:"100%"},onClick:async()=>{j(!0),await d(),j(!1)},children:h})})]})})},ge=(0,x().vU)({copyTextMessage:{id:"githubAIConnector.connectionComplete.copyMessage",defaultMessage:"Our Notion AI is now connecting to GitHub. When you ask Notion AI a question, it'll be able to reference info across our Repositories, Issues, and Pull Requests. Click the button at the bottom right of your Notion app to give it a try!"}});const pe=function(){const e=(0,i().O7)(),t=(0,s().Kw)(l().githubAIConnectorStore),n=(0,o.useCallback)((t=>{l().githubAIConnectorStore.setState({...l().githubAIConnectorStore.getInitialState(),isPersonalAuthComplete:!1,status:"in_progress",isConnected:!0}),(0,k().j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:`github_ai_connector_got_it_${t}_click`,integration_type:"github",setup_session_id:l().githubAIConnectorStore.state.sessionId,from:l().githubAIConnectorStore.state.analyticsFrom}}}),se().oV({label:(0,B.jsx)(x()._H,{id:"aiConnectors.github.acknowledge",defaultMessage:"Started syncing from GitHub. This can take up to 72 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,B.jsx)(C().Z,{onClick:se().rN,children:(0,B.jsx)(x()._H,{id:"aiConnectors.github.startedMessageDismiss",defaultMessage:"Close"})})})}),[e]),r=(0,y().yK)((e=>({headingText:{fontSize:S().JB.UIRegular.desktop,letterSpacing:"-0.154px",color:`${e.text.primary}`,paddingBottom:8,fontWeight:S().Ue.medium},subNoteText:{fontSize:S().JB.UIRegular.desktop,letterSpacing:"-0.154px",color:`${e.text.secondary}`,paddingBottom:8,fontWeight:S().Ue.regular},circle:{marginRight:8},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},noteBody:{fontWeight:S().Ue.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"-0.154px"}})),[]);return(0,B.jsx)(ue,{open:"confirmation"===t.currentScreen,integrationIcon:D().f,notes:[(0,B.jsxs)(w().gq,{children:[(0,B.jsx)(b().Z,{number:1,style:r.circle}),(0,B.jsx)(w().Ht,{children:(0,B.jsx)("div",{style:r.headingText,children:(0,B.jsx)(x()._H,{id:"githubAIConnector.connectionComplete.listpoint1",defaultMessage:"Connecting GitHub content may take up to 72h."},"note1")})})]},"item1"),(0,B.jsxs)(w().gq,{style:r.headingText,children:[(0,B.jsx)(b().Z,{number:2,style:r.circle}),(0,B.jsxs)(w().Ht,{children:[(0,B.jsx)("div",{style:r.headingText,children:(0,B.jsx)(x()._H,{id:"githubAIConnector.connectionComplete.listpoint2",defaultMessage:"Each member of your workspace will be prompted to authenticate to GitHub."},"note2")}),(0,B.jsx)("div",{style:r.subNoteText,children:(0,B.jsx)(x()._H,{id:"githubAIConnector.connectionComplete.listsubpoint2",defaultMessage:"GitHub permissions are respected and members will only see content they have access to."},"subnote2")})]})]},"item2"),(0,B.jsxs)(w().gq,{style:r.headingText,children:[(0,B.jsx)(b().Z,{number:3,style:r.circle}),(0,B.jsx)(x()._H,{id:"githubAIConnector.connectionComplete.listpoint3",defaultMessage:"Copy the message below to let your team know!"})]},"item3")],onCopiedClick:()=>{(0,k().j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"copy_button_clicked",integration_type:"github",setup_session_id:l().githubAIConnectorStore.state.sessionId,from:l().githubAIConnectorStore.state.analyticsFrom}}})},onDismiss:()=>n("dismiss"),title:(0,B.jsx)(x()._H,{id:"githubAIConnector.connectionComplete.title",defaultMessage:"You’re done!"}),subText:(0,B.jsx)(x()._H,{id:"githubAIConnector.connectionComplete.subText",defaultMessage:"What happens next:"}),copyTextMessage:ge.copyTextMessage})};var me=()=>n(877153),he=()=>n(959328);function ve(e){const{open:t,title:n,tryItOutHandler:o,onDismiss:i,integrationIcon:s,subText1:r,subText2:a}=e,c=(0,y().yK)((e=>({body:{alignItems:"center",color:e.text.secondary,fontSize:12},container:{padding:12},tryItButton:{marginTop:24}})),[]);return(0,B.jsx)(I().Z,{showCloseIcon:!0,onDismiss:i,open:t,render:()=>(0,B.jsxs)(w().Ht,{style:c.container,children:[(0,B.jsx)(N,{integrationLogoIcon:s,title:n}),(0,B.jsxs)(w().Ht,{gap:2,style:c.body,children:[(0,B.jsx)("div",{children:r}),(0,B.jsx)("div",{children:a})]}),(0,B.jsx)(X().Z,{style:c.tryItButton,onClick:o,children:(0,B.jsx)(x()._H,{id:"universalQna.universal.tryAskingAQuestion",defaultMessage:"Try asking a question"})})]})})}function fe(){const e=(0,x().YB)(),t=(0,s().VK)((()=>m().googleDriveConnectionStore.state.screenToShow),[]),n=(0,i().O7)(),r=(0,o.useCallback)((()=>{m().googleDriveConnectionStore.setState({...m().googleDriveConnectionStore.state,screenToShow:"none"}),ee().assistantMenuActions.openAssistantRightHandSideMenu({environment:n,from:"google_drive_already_connected",primeTextInput:e.formatMessage(me().o.primedTextInput)})}),[n,e]);return(0,B.jsx)(ve,{open:"already_connected"===t,tryItOutHandler:r,integrationIcon:he().c,onDismiss:()=>{m().googleDriveConnectionStore.reset()},title:(0,B.jsx)(x()._H,{id:"universalQna.googleDrive.alreadyConnected",defaultMessage:"Google Drive is already connected to Notion AI"}),subText1:(0,B.jsx)(x()._H,{id:"universalQna.googleDrive.ConnectedDescription",defaultMessage:"You're fully set up."}),subText2:(0,B.jsx)(x()._H,{id:"universalQna.GoogleDrive.tryIt",defaultMessage:"Try asking AI about Google Drive content!"})})}var _e=()=>n(735501);const ye=function(e){const{notes:t,integrationIcon:n,openLearnMoreUrl:i,open:s,onDismiss:r,title:a,subText:c,onClickPrimaryButton:l,primaryButtonText:d,warningMessage:u}=e,[g,p]=(0,o.useState)(!1),m=(0,y().yK)((e=>({wrapper:{width:400},selectionContainer:{padding:20,width:400,paddingTop:12},waitingForConnectionWrapper:{display:"flex",flexDirection:"column",alignItems:"center"},note:{fontWeight:S().Ue.regular,fontSize:14,lineHeight:"18px",width:330,marginLeft:8},buttonContainer:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",marginTop:"16px"},primaryButton:{fontSize:14,fontWeight:S().Ue.regular,width:"100%"},learnMoreButton:{gap:4,alignItems:"center",fontSize:12,color:e.text.secondary,justifyContent:"center"}})),[]);return(0,B.jsx)(I().Z,{showCloseIcon:!0,open:s,onDismiss:r,render:()=>(0,B.jsxs)("div",{style:m.wrapper,children:[(0,B.jsx)(N,{integrationLogoIcon:n,title:a,subtext:c}),(0,B.jsx)(w().gq,{style:m.selectionContainer,children:(0,B.jsx)(w().Ht,{children:(0,B.jsxs)(w().Ht,{style:m.waitingForConnectionWrapper,children:[t.map(((e,t)=>(0,B.jsxs)(w().gq,{gap:8,style:{marginTop:4,marginBottom:6},children:[(0,B.jsx)(b().Z,{number:t+1}),(0,B.jsx)("div",{style:m.note,children:e})]},t))),(0,B.jsxs)(w().gq,{style:m.buttonContainer,children:[u,l&&(0,B.jsx)(O().Z,{isLoading:g,disabled:g,style:m.primaryButton,onClick:async()=>{p(!0),await l(),p(!1)},children:d}),(0,B.jsx)(C().Z,{style:{marginTop:10,width:100,borderRadius:6},onClick:i,children:(0,B.jsxs)(w().gq,{style:m.learnMoreButton,children:[(0,B.jsx)(x()._H,{id:"universalSearch.waitingForConnection.learnMore",defaultMessage:"Learn More"}),(0,A().K)({width:14,height:14})]})})]})]})})})]})})};function xe(){const[e,t]=o.useState(!1),n=(0,y().yK)((e=>({noteHeading:{fontWeight:S().Ue.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:S().Ue.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{width:18,height:17,color:"#D7813A",marginTop:2},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingLeft:14,fontweight:S().Ue.regular,letterSpacing:"-0.15px"},warningContainer:{marginLeft:5,marginRight:5,marginBottom:15}})),[]),r=(0,i().O7)(),l=(0,s().VK)((()=>{var e;return null===(e=u().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),d=(0,s().VK)((()=>m().googleDriveConnectionStore.state.sessionId),[]),g=(0,s().VK)((()=>m().googleDriveConnectionStore.state.screenToShow),[]),h=(0,s().VK)((()=>m().googleDriveConnectionStore.state.analyticsFrom),[]),v=(0,s().VK)((()=>p().default.getConfigKey("ingestion","googleDrive").googleAuthUrl),[]),f=(0,s().VK)((()=>p().default.getConfigKey("ingestion","googleDrive").troubleShootingUrl),[]),_=(0,s().VK)((()=>p().default.getConfigKey("ingestion","googleDrive").learnMoreUrl),[]),j=(0,o.useCallback)((async()=>{if(!l)return;var e;await(e=5e3,new Promise((t=>setTimeout(t,e))));const n=await a().callApi({eventName:"connectGoogleDriveForAIIngestion",environment:r,data:{spaceId:l}}),o=e=>{(0,k().j)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:e,integration_type:"google_drive",setup_session_id:d,from:h}}})};var i,s,u;"success"===n.type?n.data.connectionSuccess?(o("auth_screen_connected"),m().googleDriveConnectionStore.setState({...m().googleDriveConnectionStore.state,screenToShow:"connection_complete_screen",availableSyncControlOptions:n.data.syncControlOptions})):((e,n,i)=>{switch(e){case 401:o("auth_screen_not_connected_warning"),t(!0);break;case 403:o("info_screen_connect_not_admin_screen"),(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"not_admin_screen",analyticsFrom:h,sessionId:d});break;case 400:"GOOGLE_MAPPING_EXIST"===n&&i?(o("workspace_already_connected"),m().googleDriveConnectionStore.setState({...m().googleDriveConnectionStore.state,connectedSpaceId:i}),(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"connection_exist_screen",analyticsFrom:h,sessionId:d})):(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:h,sessionId:d});break;default:(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:h,sessionId:d})}})(null==n||null===(i=n.data)||void 0===i||null===(i=i.errorResponse)||void 0===i?void 0:i.status,null==n||null===(s=n.data)||void 0===s||null===(s=s.errorResponse)||void 0===s?void 0:s.errorCode,null==n||null===(u=n.data)||void 0===u||null===(u=u.errorResponse)||void 0===u||null===(u=u.data)||void 0===u?void 0:u.spaceId):(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:h,sessionId:d})}),[h,r,d,l]),C=(0,o.useCallback)((()=>[(0,B.jsxs)(w().Ht,{style:{gap:4},children:[(0,B.jsx)("div",{style:n.noteHeading,children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.waitingForConnectionNoteHeading1",defaultMessage:"Google should open automatically on a new browser tab."},"note1-1")}),(0,B.jsx)("div",{style:n.noteBody,children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.authWaiting",defaultMessage:"If it doesn't, {ClickHereToRetry}",values:{ClickHereToRetry:(0,B.jsx)("a",{style:n.link,href:v,target:"_blank",onClick:()=>{(0,k().j)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_open_auth_url",integration_type:"google_drive",setup_session_id:d,from:h}}})},children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,B.jsxs)(w().Ht,{style:{gap:4},children:[(0,B.jsx)("div",{style:n.noteHeading,children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.workspaceAdminHeading",defaultMessage:"Follow Google’s setup instructions"},"note2-1")}),(0,B.jsx)("div",{style:n.noteBody,children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.workspaceAdminBody",defaultMessage:"For better AI answers, we recommend selecting the option “All users in my organization”. In the next steps, you’ll be able to exclude specific Drives and can always update your selection."},"note2-2")})]},"note-2"),(0,B.jsx)(w().Ht,{style:{gap:4},children:(0,B.jsx)("div",{style:n.noteHeading,children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.done",defaultMessage:"When you’re done, click the button below"},"note3-1")})},"note-3")]),[n,v,r,d,h]),b=e?(0,B.jsxs)(w().gq,{style:n.warningContainer,children:[(0,_e().t)(n.icon),(0,B.jsx)("div",{style:n.warningText,children:(0,B.jsx)(x()._H,{id:"universalQnA.googleDrive.AuthScreen.warning",defaultMessage:"We couldn’t connect to Google. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{TroubleshootingGuide:(0,B.jsx)("a",{style:{...n.link,color:"#D7813A"},href:f,target:"_blank",onClick:()=>{(0,k().j)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"troubleshooting_guide_opened",integration_type:"google_drive",setup_session_id:d,from:h}}})},children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,B.jsx)(ye,{title:(0,B.jsx)(x()._H,{id:"universalQnA.googleDrive.AuthScreen",defaultMessage:"Follow instructions from Google in your browser"}),open:"auth_screen"===g,onDismiss:()=>{t(!1),(0,k().j)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_dismiss",integration_type:"google_drive",setup_session_id:d,from:h}}}),(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:h,sessionId:d})},warningMessage:b,notes:C(),openLearnMoreUrl:()=>{window.open(_)},integrationIcon:he().c,primaryButtonText:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.Button.finishedSetup",defaultMessage:"Confirm connection"},"note3-1"),onClickPrimaryButton:j})}var Se=()=>n(741633),je=()=>n(340531),Ce=(n(670560),n(267602),n(653476),n(470928),n(30005),()=>n(48826)),be=()=>n(696459),Ie=()=>n(715139),we=()=>n(666414),ke=()=>n(573357);function Me(e){const{onPrimaryButtonClick:t,setShowConfirmModal:n}=e,r=(0,i().O7)(),a=(0,s().Kw)(m().googleDriveConnectionStore),c=(0,s().VK)((()=>m().googleDriveConnectionStore.state.screenToShow),[]),[l,d]=(0,o.useState)(!1),u=(0,y().yK)((e=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:S().Ue.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:S().Ue.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:S().Ue.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:S().Ue.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:14,fontWeight:S().Ue.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20}})),[]),g=e=>{m().googleDriveConnectionStore.setState({...a,screenToShow:e})};return(0,B.jsx)(I().Z,{showCloseIcon:!0,open:"select_shared_drives_screen"===c,onDismiss:()=>{(0,k().j)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_confirm_modal_close",integration_type:"google_drive",setup_session_id:a.sessionId,from:a.analyticsFrom}}}),g("none"),n(!1)},render:()=>(0,B.jsx)("div",{style:u.confirmWrapper,children:(0,B.jsxs)("div",{style:u.confirmContainer,children:[(0,B.jsx)("div",{style:u.confirmModalTitle,children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.confirmModal.title",defaultMessage:"Are your sure?"})}),(0,B.jsx)("div",{style:u.confirmModalSubTitle,children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.confirmModal.subTitle",defaultMessage:"Google Drive content will be disconnected and re-connected. This can take up to 36h and AI answers will be unavailable until it’s complete."})}),(0,B.jsxs)(w().Ht,{style:u.confirmModalActionButtons,children:[(0,B.jsx)(O().Z,{isLoading:l,style:u.confirmDisconnectButton,disabled:a.isDisconnecting,onClick:async()=>{(0,k().j)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_modal_confirm_button",integration_type:"google_drive",setup_session_id:a.sessionId,from:a.analyticsFrom}}}),d(!0),await t(),d(!1),n(!1),g("none")},children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.editModal.confirmDisconnect",defaultMessage:"Confirm"})}),(0,B.jsx)(C().Z,{style:u.goBackButton,onClick:()=>{(0,k().j)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_modal_cancel_button",integration_type:"google_drive",setup_session_id:a.sessionId,from:a.analyticsFrom}}}),n(!1)},children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.editModal.cancel",defaultMessage:"Cancel"})})]})]})})})}function Te(e){const{drive:t,styles:n,onToggle:o}=e;return(0,B.jsxs)(w().gq,{gap:8,style:{alignItems:"center",padding:"10px 18px 6px 0px"},children:[(0,B.jsx)(Ie().Z,{checked:t.checked,checkSize:10,size:14,onClick:()=>o(t.id)}),(0,B.jsx)("div",{style:n.drivesRow,children:`${t.name}`},`${t.id}#3`)]})}function Ae(e){const{styles:t,onPrimaryButtonClick:n,setShowConfirmModal:r,isFutureItemsChecked:a,setDriveCheckboxItems:c,sharedDriveCheckboxItems:l,setFutureItemsChecked:d}=e,g=(0,s().Kw)(m().googleDriveConnectionStore),p=(0,s().VK)((()=>m().googleDriveConnectionStore.state.sessionId),[]),h=(0,s().VK)((()=>m().googleDriveConnectionStore.state.initialSyncState),[]),v=(0,s().VK)((()=>m().googleDriveConnectionStore.state.analyticsFrom),[]),f=(0,s().VK)((()=>m().googleDriveConnectionStore.state.screenToShow),[]),_=(0,s().VK)((()=>{var e;return null===(e=u().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),[y,S]=(0,o.useState)(!1),j=(0,i().O7)();if((0,o.useEffect)((()=>{const e=g.availableSyncControlOptions.filter((e=>"shared_drive"===e.type));0===e.length&&"select_shared_drives_screen"===f&&(0,k().j)({environment:j,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"no_shared_drives",integration_type:"google_drive",setup_session_id:p,from:v}}});const t=g.syncControlSelection;if(!t)return c(e.map((e=>({...e,checked:!0})))),void d(!0);c(e.map((e=>({...e,checked:!t.driveIds||t.driveIds.includes(e.id)})))),d(t.enableSyncingFutureUsersAndDrives)}),[v,j,g,f,c,d,p]),!_)return null;const C=l.find((e=>e.checked)),b=e=>{(0,k().j)({environment:j,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"individual_drive_checkbox",integration_type:"google_drive",setup_session_id:g.sessionId,from:g.analyticsFrom}}}),c(l.map((t=>t.id===e?{...t,checked:!t.checked}:t)))},I=l.map((e=>(0,B.jsx)(Te,{drive:e,styles:t,onToggle:b},e.id))).filter(be().$K);return(0,B.jsxs)(w().Ht,{children:[(0,B.jsx)(w().gq,{style:t.selectionWrapper,children:(0,B.jsxs)(w().Ht,{style:t.scrollContainer,children:[(0,B.jsx)(we().Z,{style:{paddingBottom:4},size:4}),(0,B.jsx)(w().gq,{style:t.rowTitle,children:(0,B.jsxs)(w().gq,{children:[(0,B.jsx)(w().Ht,{children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.allItemsTitle",defaultMessage:"Content owned by users"})}),(0,B.jsx)(w().Ht,{style:{paddingLeft:200},children:(0,de().A)(t.checkMark)})]})}),(0,B.jsx)(w().gq,{style:t.rowAdditionalText,children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.allItemsSubtext",defaultMessage:"Includes all files owned by users selected in Google Workspace Settings"})}),(0,B.jsx)(we().Z,{style:{paddingTop:10,paddingBottom:10},size:4}),(0,B.jsx)(w().gq,{style:t.rowTitle,children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.allSharedDrivesTitle",defaultMessage:"Content in Shared Drives"})}),(0,B.jsx)(w().gq,{style:t.rowAdditionalText,children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.allSharedDrivesSubtext",defaultMessage:"Includes files in Shared Drives as long as they are owned by users selected in the setting above."})}),(0,B.jsx)(w().gq,{children:(0,B.jsx)(w().Ht,{children:0===I.length?(0,B.jsx)(w().gq,{style:{...t.rowAdditionalText,fontSize:14,paddingTop:10},children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.noSharedDrivesSubtext",defaultMessage:"No Shared Drives found"})}):I})})]})}),(0,B.jsxs)(w().Ht,{style:t.footer,children:[(0,B.jsxs)(w().gq,{style:{gap:4,alignItems:"center",width:"inherit"},children:[(0,B.jsx)(Ie().Z,{checked:a,checkSize:10,size:14,onClick:()=>{(0,k().j)({environment:j,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:`future_items_checkbox_${(!a).toString()}`,integration_type:"google_drive",setup_session_id:g.sessionId,from:g.analyticsFrom}}}),d(!a)}}),(0,B.jsx)("div",{style:{fontSize:12,lineHeight:"16px",paddingBottom:2},children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.allSharedDrives",defaultMessage:"Include Drives created in the future"})})]}),(0,B.jsx)(O().Z,{style:t.continueButton,isLoading:y,disabled:!C,onClick:async()=>{S(!0),"completed"!==h?(await n(),S(!1)):r(!0)},children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.confirm",defaultMessage:"Confirm selection"})})]})]})}async function De(e){const{environment:t,spaceId:n}=e,o=u().default.state.currentUserStore,{analyticsFrom:i,sessionId:s}=m().googleDriveConnectionStore.state;if("success"===(await a().callApi({eventName:"startGoogleDriveSyncForAIIngestion",environment:t,data:{spaceId:n,setupSessionId:s}})).type){var r;m().googleDriveConnectionStore.setState({...m().googleDriveConnectionStore.state,initialSyncState:"in_progress",ingestionProgress:1});const e=f().Z.state.appsConnectionData.filter((e=>e.id!==Ce().V));return f().Z.setState({...f().Z.state,appsConnectionData:[...e,{connectionStatus:"in_progress",connectionLastEditedTimestamp:Date.now(),connectionType:"google-drive",connectorEmail:(null==o?void 0:o.getEmail())||"",id:Ce().V,connectorNotionId:null==o||null===(r=o.getModel())||void 0===r?void 0:r.id}]}),(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:i,sessionId:s}),!0}return(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:i,sessionId:s}),!1}const He=function(){const[e,t]=(0,o.useState)(!1),n=(0,s().VK)((()=>m().googleDriveConnectionStore.state.screenToShow),[]),r=(0,i().O7)(),l=(0,s().VK)((()=>{var e;return null===(e=u().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),d=(0,s().Kw)(m().googleDriveConnectionStore),g=(0,y().yK)((e=>({wrapper:{width:400},scrollContainer:{overflow:"scroll",paddingRight:20,height:350},rowTitle:{fontSize:12,lineHeight:"16px",letterSpacing:"-0.15px",fontWeight:510,paddingBottom:4},rowAdditionalText:{fontSize:12,lineHeight:"16px",color:e.text.secondary},drivesRow:{fontSize:14,lineHeight:"18px",letterSpacing:"-0.15px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},footer:{justifyContent:"center",alignItems:"center",bottom:0,width:"100%",height:75,boxShadow:e.mediumBoxShadow,padding:"16px 20px 16px 20px",gap:6},continueButton:{fontSize:14,fontWeight:S().Ue.semibold,width:360},selectionWrapper:{marginTop:24,paddingLeft:20,justifyContent:"center",overflow:"auto"},selection:{width:360,height:263,marginBotton:12},checkMark:{width:14,color:e.text.secondary}})),[]),p=(0,s().VK)((()=>m().googleDriveConnectionStore.state.sessionId),[]),h=(0,s().VK)((()=>m().googleDriveConnectionStore.state.analyticsFrom),[]),[v,f]=(0,o.useState)(!0),[_,j]=(0,o.useState)([]),b=()=>{m().googleDriveConnectionStore.setState({...m().googleDriveConnectionStore.state,syncControlSelection:{driveIds:[],enableSyncingFutureUsersAndDrives:!1},availableSyncControlOptions:[]})},w=(0,o.useCallback)((async()=>{let e=!0;v&&(e=!1);const t=[];if(_.forEach((n=>{if(n.checked===e){const{checked:e,...o}=n;t.push({...o})}})),(0,k().j)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drive_and_user_selector_primary_button",integration_type:"google_drive",setup_session_id:d.sessionId,from:d.analyticsFrom}}}),!l)return;const n=t,o=await a().callApi({eventName:"patchSyncControlsForGoogleDriveAIIngestion",environment:r,data:{spaceId:l,exclusionList:v?n:[],inclusionList:v?[]:n}}),i="in_progress"===m().googleDriveConnectionStore.state.initialSyncState||"completed"===m().googleDriveConnectionStore.state.initialSyncState;if("failed"===o.type)return void se().oV({label:(0,B.jsx)(x()._H,{id:"googleIngestionConfirmation.ingestion.failed",defaultMessage:"Cannot edit Google shared drives now. Please try again later."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,B.jsx)(C().Z,{onClick:se().rN,children:(0,B.jsx)(x()._H,{id:"googleIngestionConfirmation.ingestion.failedMessageDismiss",defaultMessage:"Close"})})});const s="success"===o.type&&o.data.syncControlsUpdated||!i&&"success"===o.type&&!o.data.syncControlsUpdated,u=i&&"success"===o.type&&!o.data.syncControlsUpdated;if(s){const e=await De({environment:r,spaceId:l});b(),e&&se().oV({label:(0,B.jsx)(x()._H,{id:"googleIngestionConfirmation.ingestion.acknowledge",defaultMessage:"Started syncing from Google drive. This can take up to 36 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,B.jsx)(C().Z,{onClick:se().rN,children:(0,B.jsx)(x()._H,{id:"googleIngestionConfirmation.ingestion.startedMessageDismiss",defaultMessage:"Close"})})})}else u?(se().oV({label:(0,B.jsx)(x()._H,{id:"googleIngestionConfirmation.ingestion.skip",defaultMessage:"No change made to Google Drive Connection."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,B.jsx)(C().Z,{onClick:se().rN,children:(0,B.jsx)(x()._H,{id:"googleIngestionConfirmation.ingestion.noConfigChangeDismiss",defaultMessage:"Close"})})}),b(),m().googleDriveConnectionStore.setState({...m().googleDriveConnectionStore.state,initialSyncState:"completed"}),(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:h,sessionId:p})):(b(),(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:h,sessionId:p}))}),[h,r,d,v,p,_,l]);return e?(0,B.jsx)(Me,{onPrimaryButtonClick:w,setShowConfirmModal:t}):(0,B.jsx)(I().Z,{showCloseIcon:!0,onDismiss:()=>{(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",sessionId:p,analyticsFrom:h})},open:"select_shared_drives_screen"===n,render:()=>(0,B.jsxs)("div",{style:g.wrapper,children:[(0,B.jsx)(N,{integrationLogoIcon:he().c,title:(0,B.jsx)(x()._H,{defaultMessage:"Select Drives to Connect",id:"googleAiConnector.universalQnaSharedDriveSelectorPopup.selectDrivesToConnect"})}),(0,B.jsx)(ke().Z,{capture:!0,allowEsc:!0,render:()=>(0,B.jsx)(Ae,{styles:g,onPrimaryButtonClick:w,setShowConfirmModal:t,isFutureItemsChecked:v,setFutureItemsChecked:f,sharedDriveCheckboxItems:_,setDriveCheckboxItems:j})})]})})},Ue=(0,x().vU)({copyTextMessage:{id:"universalSearch.googleDriveIngestion.googleDriveTitle.connectionComplete.copyMessage",defaultMessage:"Our Notion AI is now connecting to Google Drive. When you ask Notion AI a question, it'll be able to reference info across our Google Docs, Slides & Sheets. Click the button at the bottom right of your Notion app to give it a try!"}});function Be(){const e=(0,y().yK)((e=>({headingText:{fontSize:S().JB.UIRegular.desktop,letterSpacing:"-0.154px",color:`${e.text.primary}`,paddingBottom:8,fontWeight:S().Ue.medium},circle:{marginRight:8},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},noteBody:{fontWeight:S().Ue.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"-0.154px"}})),[]),t=(0,i().O7)(),n=(0,s().VK)((()=>m().googleDriveConnectionStore.state.sessionId),[]),r=(0,s().VK)((()=>{var e;return null===(e=u().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),l=(0,s().VK)((()=>m().googleDriveConnectionStore.state.initialSyncState),[]),d=(0,s().VK)((()=>m().googleDriveConnectionStore.state.screenToShow),[]),g=(0,s().VK)((()=>m().googleDriveConnectionStore.state.analyticsFrom),[]),p=(0,o.useCallback)((()=>{(0,k().j)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_dismiss",integration_type:"google_drive",setup_session_id:n,from:g}}}),(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:g,sessionId:n})}),[g,t,n]);if("completed"===l||!r)return(0,B.jsx)(B.Fragment,{});const h="in_progress"===l;return(0,B.jsx)(ue,{open:"connection_complete_screen"===d,integrationIcon:he().c,notes:[(0,B.jsxs)(w().gq,{style:e.headingText,children:[(0,B.jsx)(b().Z,{number:1,style:e.circle}),(0,B.jsxs)(w().Ht,{children:[(0,B.jsx)(x()._H,{id:"assistantOverflowMenu.googleDriveIngestion.connectionComplete.listpoint1",defaultMessage:"Connecting your Drives may take up to 36h."},"note1"),!h&&(0,B.jsx)("div",{style:e.noteBody,children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.waitingForConnectionNoteBody1",defaultMessage:"If you want to choose Drives, {clickHere}",values:{clickHere:(0,B.jsx)("a",{style:e.link,onClick:async()=>{(0,k().j)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"shared_drive_settings",integration_type:"google_drive",setup_session_id:n,from:g}}});const e=await a().callApi({eventName:"getGoogleDriveSyncProgress",environment:t,data:{spaceId:r},headers:(0,Se().Bb)({spaceId:r})});if("success"===e.type){var o;const t=(0,je().pB)(null===(o=e.data)||void 0===o?void 0:o.status);m().googleDriveConnectionStore.setState({...m().googleDriveConnectionStore.state,initialSyncState:t}),"in_progress"===t?(0,c().navigateToGoogleDriveUniversalScreen)({analyticsFrom:g,sessionId:n,screenToShow:"settings_screen"}):"not_started"===t?(0,c().navigateToGoogleDriveUniversalScreen)({analyticsFrom:g,sessionId:n,screenToShow:"select_shared_drives_screen"}):(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:g,sessionId:n})}else(0,c().navigateToGoogleDriveUniversalScreen)({analyticsFrom:g,sessionId:n,screenToShow:"error"})},children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.settings",defaultMessage:"click here."})})}},"note1-1")})]})]},"item1"),(0,B.jsxs)(w().gq,{style:e.headingText,children:[(0,B.jsx)(b().Z,{number:2,style:e.circle}),(0,B.jsx)(x()._H,{id:"assistantOverflowMenu.googleDriveIngestion.connectionComplete.listpoint2",defaultMessage:"Notion AI will be ready to answer questions across Notion and Google Drive knowledge."},"note2")]},"item2"),(0,B.jsxs)(w().gq,{style:e.headingText,children:[(0,B.jsx)(b().Z,{number:3,style:e.circle}),(0,B.jsx)(x()._H,{id:"assistantOverflowMenu.googleDriveIngestion.connectionComplete.listpoint3",defaultMessage:"Copy the message below to let your team know!"})]},"item3")],onCopiedClick:()=>{(0,k().j)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"copy_button_clicked",integration_type:"google_drive",setup_session_id:n,from:g}}})},primaryButtonText:(0,B.jsx)(x()._H,{id:"assistantOverflowMenu.googleDrive.connectionComplete.confirmConnection",defaultMessage:"Done"}),onPrimaryButtonClick:async()=>{if((0,k().j)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_done",integration_type:"google_drive",setup_session_id:n,from:g}}}),!r)return;if(h)return void(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:g,sessionId:n});await De({environment:t,spaceId:r})&&se().oV({label:(0,B.jsx)(x()._H,{id:"googleIngestionConfirmation.ingestion.acknowledge",defaultMessage:"Started syncing from Google drive. This can take up to 36 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,B.jsx)(C().Z,{onClick:se().rN,children:(0,B.jsx)(x()._H,{id:"googleIngestionConfirmation.ingestion.startedMessageDismiss",defaultMessage:"Close"})})})},onDismiss:p,title:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.connectionComplete.googleDriveTitle",defaultMessage:"You’re done!"}),subText:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.googleDriveTitle.connectionComplete.subText",defaultMessage:"Here’s what’s next:"}),copyTextMessage:Ue.copyTextMessage})}var Ne=()=>n(506347),Fe=()=>n(224597);function We(){const e=(0,s().VK)((()=>m().googleDriveConnectionStore.state.screenToShow),[]),t=(0,s().VK)((()=>m().googleDriveConnectionStore.state.sessionId),[]),n=(0,s().VK)((()=>m().googleDriveConnectionStore.state.analyticsFrom),[]),r=(0,s().VK)((()=>m().googleDriveConnectionStore.state.connectedSpaceId),[]),a=(0,i().O7)(),l=(0,y().yK)((e=>({icon:{width:16,display:"inline-block"},wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.mediumBoxShadow,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:S().Ue.semibold,width:"100%"},iconWrapper:{width:16,height:16},chevronRightIcon:{width:14,height:14,fill:e.lightIconColor}})),[]),d="connection_exist_screen"===e,g=(0,o.useCallback)((async()=>{const e=u().default.state.currentUserRootStore;if(!e)return;(0,k().j)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"visit_other_workspace",integration_type:"google_drive",setup_session_id:t,from:n}}});const o=e.getSpaceViewStores().filter((e=>e.getSpaceId()===r))[0];await Fe().y3({environment:a,navigationType:"switchingToOrLoadingSpace",pageVisitSource:Ne().tY.AIGoogleDriveQna,spaceViewStore:o,userRootStore:u().default.state.currentUserRootStore,userSettingsStore:u().default.state.currentUserSettingsStore}),m().googleDriveConnectionStore.reset(),m().googleDriveConnectionStore.setState({...m().googleDriveConnectionStore.state,screenToShow:"settings_screen",analyticsFrom:"google_other_workspace",sessionId:t})}),[n,r,a,t]);return(0,B.jsx)(I().Z,{showCloseIcon:!0,onDismiss:()=>(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:n,sessionId:t}),open:d,render:()=>(0,B.jsxs)("div",{style:l.wrapper,children:[(0,B.jsx)(N,{integrationLogoIcon:he().c,title:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.connectionExist.title",defaultMessage:"You’ve already connected Google Drive to another Notion workspace."}),subtext:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.connectionExist.description",defaultMessage:"Currently, only one workspace can be connected to Google Drive. To connect this workspace, please disconnect the existing connection."})}),(0,B.jsx)(w().Ht,{style:l.footer,children:(0,B.jsx)(O().Z,{style:l.connectButton,onClick:g,children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.connectionExist.navigateButton",defaultMessage:"Visit the other workspace"})})})]})})}var Pe=()=>n(536635);const Ke=function(e){const{onDismiss:t,onClickGotItBtn:n,open:o,title:i,descriptionMessage:s,integrationIcon:r,message:a}=e,c=(0,y().yK)((e=>({modal:{width:400,alignItems:"center"},contentWrapper:{padding:"0 20px 24px 20px",gap:8},messageWrapper:{gap:19},gotItButton:{width:"100%"}})),[]);return(0,B.jsx)(I().Z,{showCloseIcon:!0,open:o,onDismiss:t,render:()=>(0,B.jsxs)("div",{style:c.modal,children:[(0,B.jsx)(N,{integrationLogoIcon:r,title:i,subtext:s}),(0,B.jsxs)("div",{style:c.contentWrapper,children:[(0,B.jsx)("div",{style:c.messageWrapper,children:a}),(0,B.jsx)("div",{children:(0,B.jsx)(X().Z,{style:c.gotItButton,onClick:n,children:(0,B.jsx)(x()._H,{id:"aiConnectors.common.disconnectModal.confirmDisconnect",defaultMessage:"Got it"})})})]})]})})};function qe(){const e=(0,s().Kw)(m().googleDriveConnectionStore),t=(0,s().VK)((()=>m().googleDriveConnectionStore.state.screenToShow),[]),n=(0,s().VK)((()=>{var e;return null===(e=u().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),r=(0,s().VK)((()=>p().default.getConfigKey("ingestion","googleDrive").marketplaceAppConfigureUrl),[]),c=(0,s().VK)((()=>m().googleDriveConnectionStore.state.sessionId),[]),l=(0,s().VK)((()=>m().googleDriveConnectionStore.state.analyticsFrom),[]),d=(0,i().O7)(),g=async()=>{if(!n)return;const e=await async function(e){const{environment:t,spaceId:n}=e,o=await a().callApi({eventName:"disconnectGoogleDriveAIIngestion",environment:t,data:{spaceId:n,disconnectReason:"admin_disconnect"}}),i=u().default.state.currentUserStore;if("success"===o.type&&o.data.deletionInitiated){var s;m().googleDriveConnectionStore.setState({...m().googleDriveConnectionStore.state,screenToShow:"none",isDisconnecting:!0});const e=f().Z.state.appsConnectionData.filter((e=>e.id!==Ce().V));return f().Z.setState({...f().Z.state,appsConnectionData:[...e,{connectionStatus:"disconnecting",connectionLastEditedTimestamp:Date.now(),connectionType:"google-drive",connectorEmail:(null==i?void 0:i.getEmail())||"",id:Ce().V,connectorNotionId:null==i||null===(s=i.getModel())||void 0===s?void 0:s.id}]}),!0}return m().googleDriveConnectionStore.setState({...m().googleDriveConnectionStore.state,screenToShow:"error",isDisconnecting:!1}),!1}({environment:d,spaceId:n});e?se().oV({label:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.disconnectModal.acknowledgeDisconnect",defaultMessage:"Started disconnecting Google Drive. This can take up to 3 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,B.jsx)(C().Z,{onClick:se().rN,children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.disconnectModal.dismissAcknowledgeDisconnect",defaultMessage:"Close"})})}):se().oV({label:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.disconnectModal.disconnectError",defaultMessage:"Failed to disconnect Google Drive. Please try again later."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,B.jsx)(C().Z,{onClick:se().rN,children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.disconnectModal.closeSnackbarError",defaultMessage:"Close"})})})},h=t=>{m().googleDriveConnectionStore.setState({...e,screenToShow:t})},v=(0,y().yK)((e=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:S().Ue.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:S().Ue.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:S().Ue.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:S().Ue.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:14,fontWeight:S().Ue.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},notesSectionWrapper:{padding:"12px 12px 12px 12px",gap:13},noteBlockWrapper:{marginBottom:12,gap:8},note:{fontWeight:S().Ue.regular,fontSize:14,lineHeight:"18px"},noteHeading:{fontWeight:S().Ue.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:S().Ue.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{rotate:"45deg",width:12,height:12,cursor:"pointer",display:"inline",padding:0,margin:0}})),[]),_=(0,o.useCallback)((()=>{const{noteBlockWrapper:e,noteHeading:t,noteBody:n,link:o}=v;return[(0,B.jsxs)(w().Ht,{style:e,children:[(0,B.jsx)("div",{style:t,children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.post_disconnect_screen.note_1.heading",defaultMessage:"Google Drive data will be permanently deleted from Notion"},"note1-1")}),(0,B.jsx)("div",{style:n,children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.post_disconnect_screen.note_1.body",defaultMessage:"This process can take up to 3 hours. You'll only be able to reconnect after disconnecting is complete."},"note1-2")})]},"note-1"),(0,B.jsxs)(w().Ht,{style:e,children:[(0,B.jsx)("div",{style:t,children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.post_disconnect_screen.note_2.heading",defaultMessage:"Uninstall the Notion AI app from your Google Workspace (optional)"},"note2-1")}),(0,B.jsx)("div",{style:n,children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.post_disconnect_screen.note_2.body",defaultMessage:"Go to your {NavigateToGoogleWorkspaceAppsSettings} and uninstall the Notion AI app.",values:{NavigateToGoogleWorkspaceAppsSettings:(0,B.jsx)("a",{style:o,href:r,target:"_blank",onClick:()=>{(0,k().j)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_screen_marketplace_app_disconnect_btn",integration_type:"google_drive",setup_session_id:c,from:l}}})},children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.post_disconnect_screen.disconnect_google_marketplace_app",defaultMessage:"Google Workspace {ArrowIcon}",values:{ArrowIcon:(0,Pe().Z)(v.icon)}})})}},"note2-2")})]},"note-2")]}),[v,r,d,c,l]);return"post_disconnect_screen"===t?(0,B.jsx)(Ke,{onClickGotItBtn:()=>{h("none")},onDismiss:()=>{h("none")},open:"post_disconnect_screen"===t,integrationIcon:he().c,title:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.post_disconnect_modal.title",defaultMessage:"Google Drive is Disconnecting from Notion"}),descriptionMessage:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.post_disconnect_modal.description",defaultMessage:"Here's what's next:"}),message:(0,B.jsx)("div",{style:v.notesSectionWrapper,children:_().map(((e,t)=>(0,B.jsxs)(w().gq,{gap:8,style:{marginTop:4,marginBottom:6},children:[(0,B.jsx)(b().Z,{number:t+1}),(0,B.jsx)("div",{style:v.note,children:e})]},t)))})}):(0,B.jsx)(I().Z,{showCloseIcon:!0,open:"disconnect_screen"===t,onDismiss:()=>{(0,k().j)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_close",integration_type:"google_drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),h("none")},render:()=>(0,B.jsx)("div",{style:v.confirmWrapper,children:(0,B.jsxs)("div",{style:v.confirmContainer,children:[(0,B.jsx)("div",{style:v.confirmModalTitle,children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.disconnectModal.title",defaultMessage:"Are your sure?"})}),(0,B.jsx)("div",{style:v.confirmModalSubTitle,children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.disconnectModal.subTitle",defaultMessage:"Google Drive data will be permanently deleted from Notion."})}),(0,B.jsx)("div",{style:v.confirmModalDescription,children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and you'll only be able to reconnect after disconnecting is complete."})}),(0,B.jsxs)(w().Ht,{style:v.confirmModalActionButtons,children:[(0,B.jsx)(O().Z,{isRed:!0,style:v.confirmDisconnectButton,disabled:e.isDisconnecting,onClick:async()=>{(0,k().j)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_confirm_disconnect_button",integration_type:"google_drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),await g(),h("post_disconnect_screen")},children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"})}),(0,B.jsx)(C().Z,{style:v.goBackButton,onClick:()=>{(0,k().j)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_back_button",integration_type:"google_drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),h("settings_screen")},children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.disconnectModal.goBack",defaultMessage:"Go back"})})]})]})})})}function Le(){const e=(0,s().VK)((()=>m().googleDriveConnectionStore.state.screenToShow),[]),t=(0,s().VK)((()=>m().googleDriveConnectionStore.state.sessionId),[]),n=(0,s().VK)((()=>m().googleDriveConnectionStore.state.analyticsFrom),[]),r=(0,i().O7)(),a=(0,y().yK)((e=>({icon:{width:16,display:"inline-block"},wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.mediumBoxShadow,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:S().Ue.semibold,width:"100%"},iconWrapper:{width:16,height:16},chevronRightIcon:{width:14,height:14,fill:e.lightIconColor}})),[]),l="error"===e;return(0,o.useEffect)((()=>{l&&(0,k().j)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect_error",integration_type:"google_drive",setup_session_id:t,from:n}}})}),[l,n,t,r]),(0,B.jsx)(I().Z,{showCloseIcon:!0,onDismiss:()=>(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:n,sessionId:t}),open:l,render:()=>(0,B.jsxs)("div",{style:a.wrapper,children:[(0,B.jsx)(N,{integrationLogoIcon:he().c,title:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.error.title",defaultMessage:"Oops! Something went wrong"}),subtext:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.error.description",defaultMessage:"Something went wrong, please try again later."})}),(0,B.jsx)(w().Ht,{style:a.footer,children:(0,B.jsx)(O().Z,{style:a.connectButton,onClick:()=>{(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:n,sessionId:t})},children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.error.Dismiss",defaultMessage:"Close"})})})]})})}var ze=()=>n(644329);function Ze(){const[e,t]=o.useState(!1),n=(0,i().O7)(),r=(0,o.useMemo)((()=>R("googleDrive")),[]),l=(0,o.useMemo)((()=>G("googleDrive")),[]),d=(0,o.useMemo)((()=>E("googleDrive")),[]),h=(0,s().VK)((()=>{var e;return null===(e=u().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),v=(0,s().VK)((()=>m().googleDriveConnectionStore.state.sessionId),[]),f=(0,s().VK)((()=>m().googleDriveConnectionStore.state.screenToShow),[]),_=(0,s().VK)((()=>m().googleDriveConnectionStore.state.analyticsFrom),[]),y=(0,s().VK)((()=>g().KR.canShowUniversalGoogleDriveSearchScope()),[]),x=(0,s().VK)((()=>p().default.getConfigKey("ingestion","googleDrive").learnMoreUrl),[]),S=(0,q().J)(),j=(0,L().y)(),C="info_screen"===f;return(0,o.useEffect)((()=>{C&&y&&(0,k().j)({environment:n,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"google_drive",setup_session_id:v,from:_,is_space_admin:S,is_ai_eligible:j}}})}),[_,n,j,C,S,v,y]),y?n.device.isMobile?(0,B.jsx)(Q,{logo:he().c,appName:"Google Drive",open:C,onClosed:()=>{m().googleDriveConnectionStore.reset()},learnMoreUrl:x}):S?(0,B.jsx)(Y,{integrationIcon:he().c,notes:r,onLearnMore:()=>{const e=p().default.getConfigKey("ingestion","googleDrive"),t=null==e?void 0:e.learnMoreUrl;window.open(t,"_blank")},onConnect:async()=>{h&&(t(!0),await async function(e,t,n,o){var i,s;if((0,k().j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect",integration_type:"google_drive",setup_session_id:n,from:o}}}),!(0,ze().Hg)({environment:e,spaceId:t,connectorTriggeringUpsell:"google_drive",from:"google_drive_connect_button",openedFrom:"google_drive_connect_button"}))return;const r=await a().callApi({eventName:"getGoogleDriveSyncProgress",environment:e,data:{spaceId:t},headers:(0,Se().Bb)({spaceId:t})});if("failed"===r.type)return void(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:o,sessionId:n});const l=null==r||null===(i=r.data)||void 0===i?void 0:i.status,d=(0,je().pB)(l);if(m().googleDriveConnectionStore.setState({...m().googleDriveConnectionStore.state,initialSyncState:d,ingestionProgress:null==r||null===(s=r.data)||void 0===s?void 0:s.ingestionProgress}),"success"===r.type&&"in_progress"===d)return(0,k().j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connection_complete_screen",integration_type:"google_drive",setup_session_id:n,from:o}}}),void(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"settings_screen",analyticsFrom:o,sessionId:n});if("success"===r.type&&"completed"===d)return(0,k().j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"already_connected_screen",integration_type:"google_drive",setup_session_id:n,from:o}}}),void(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"already_connected",analyticsFrom:o,sessionId:n});(0,k().j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen",integration_type:"google_drive",setup_session_id:n,from:o}}}),(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"auth_screen",analyticsFrom:o,sessionId:n});const u=p().default.getConfigKey("ingestion","googleDrive");window.open(u.googleAuthUrl,"_blank"),a().callApi({eventName:"initiateGoogleDriveDelayedIngestion",environment:e,data:{spaceId:t,setupSessionId:n}})}(n,h,v,_),t(!1))},onDismiss:()=>{(0,k().j)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_dismiss",integration_type:"google_drive",setup_session_id:v,from:_}}}),(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:_,sessionId:v})},title:l,isLoading:e,titleWidth:352,open:C}):(0,B.jsx)($,{onConnect:()=>{m().googleDriveConnectionStore.reset(),(0,k().j)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"contact_workspace_owners",integration_type:"google_drive",setup_session_id:v,from:_}}}),W().r$({openedFrom:"google_drive_connect_nonadmin_modal",currentTab:"members"})},integrationIcon:he().c,message:d,onDismiss:()=>m().googleDriveConnectionStore.reset(),open:C}):(0,B.jsx)(B.Fragment,{})}function Ve(){const e=(0,s().VK)((()=>m().googleDriveConnectionStore.state.screenToShow),[]),t=(0,s().VK)((()=>m().googleDriveConnectionStore.state.sessionId),[]),n=(0,s().VK)((()=>m().googleDriveConnectionStore.state.analyticsFrom),[]),o=(0,y().yK)((e=>({icon:{width:16,display:"inline-block"},wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.mediumBoxShadow,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:S().Ue.semibold,width:"100%"},iconWrapper:{width:16,height:16},chevronRightIcon:{width:14,height:14,fill:e.lightIconColor}})),[]);return(0,B.jsx)(I().Z,{showCloseIcon:!0,onDismiss:()=>(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:n,sessionId:t}),open:"not_admin_screen"===e,render:()=>(0,B.jsxs)("div",{style:o.wrapper,children:[(0,B.jsx)(N,{integrationLogoIcon:he().c,title:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.notAdmin.title",defaultMessage:"Only Google Workspace Administrators can connect"}),subtext:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.notAdmin.description",defaultMessage:"We can't verify that this account is a Google Workspace Administrator. Please contact your admin to link Notion using their account."})}),(0,B.jsx)(w().Ht,{style:o.footer,children:(0,B.jsxs)(O().Z,{style:o.connectButton,onClick:()=>{const e=p().default.getConfigKey("ingestion","googleDrive"),t=null==e?void 0:e.learnMoreUrl;window.open(t,"_blank")},children:[(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.notAdmin.learnMore",defaultMessage:"Learn more"}),(0,B.jsx)("div",{style:o.iconWrapper,children:(0,A().K)()})]})})]})})}var Ge=()=>n(654133),Ee=()=>n(787352);function Re(e){const{styles:t,events:n,isEditButtonEnabled:o,navigateToScreen:r}=e,a=(0,i().O7)(),c=(0,s().Kw)(m().googleDriveConnectionStore);return(0,B.jsx)(X().Z,{...n,style:t,disabled:!o,onClick:()=>{(0,k().j)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_edit_drives_button",integration_type:"google_drive",setup_session_id:c.sessionId,from:c.analyticsFrom}}}),r("select_shared_drives_screen")},children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.settingsModal.editSyncControls",defaultMessage:"Edit Drives"})})}function Oe(e){const{styles:t,events:n,isDisconnectButtonEnabled:o,navigateToScreen:r}=e,c=(0,i().O7)(),l=(0,s().Kw)(m().googleDriveConnectionStore),d=(0,s().VK)((()=>{var e;return null===(e=u().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),g=(0,s().VK)((()=>m().googleDriveConnectionStore.state.initialSyncState),[]);return(0,B.jsx)(O().Z,{...n,isGray:!0,style:t,disabled:!o,onClick:async()=>{if(d)if((0,k().j)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_disconnect_button",integration_type:"google_drive",setup_session_id:l.sessionId,from:l.analyticsFrom}}}),"completed"!==g){if("not_started"===g){if("success"===(await a().callApi({eventName:"disconnectGoogleDriveAIIngestion",environment:c,data:{spaceId:d,disconnectReason:"admin_disconnect"}})).type)return void r("none")}r("error")}else r("disconnect_screen")},children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.settingsModal.disconnectGoogleDrive",defaultMessage:"Disconnect"})})}const Qe=function(){const e=(0,s().Kw)(m().googleDriveConnectionStore),t=(0,s().VK)((()=>{var e;return null===(e=u().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),n=(0,s().VK)((()=>m().googleDriveConnectionStore.state.analyticsFrom),[]),l=(0,s().VK)((()=>m().googleDriveConnectionStore.state.screenToShow),[]),d=(0,s().VK)((()=>m().googleDriveConnectionStore.state.initialSyncState),[]),g=(0,s().VK)((()=>m().googleDriveConnectionStore.state.sessionId),[]),[h,v]=(0,o.useState)(!0),[f,_]=(0,o.useState)(!1),[j,b]=(0,o.useState)(!1),[M,T]=(0,o.useState)([]),A=(0,i().O7)();(0,r().r5)((async()=>{if(!t||!A||"settings_screen"!==l)return;v(!0);let e=d;if("none"===d){var o;const i=await a().callApi({eventName:"getGoogleDriveSyncProgress",environment:A,data:{spaceId:t},headers:(0,Se().Bb)({spaceId:t})});if("failed"===i.type)return void(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:n,sessionId:g});const s=null==i||null===(o=i.data)||void 0===o?void 0:o.status;e=(0,je().pB)(s),m().googleDriveConnectionStore.setState({...m().googleDriveConnectionStore.state,initialSyncState:e})}}),[n,A,d,l,g,t]),(0,r().r5)((async()=>{if(t&&A&&"settings_screen"===l&&"none"!==d)if("in_progress"===d)v(!1),_(!1),b(!1);else if("completed"===d||"not_started"===d){const e=await a().callApi({eventName:"getSyncControlsForGoogleDriveAIIngestion",environment:A,data:{spaceId:t}});if("success"===(null==e?void 0:e.type)){const t=e.data;v(!1),_(!0),"not_started"===d?m().googleDriveConnectionStore.setState({...m().googleDriveConnectionStore.state,availableSyncControlOptions:t.options}):(m().googleDriveConnectionStore.setState({...m().googleDriveConnectionStore.state,availableSyncControlOptions:t.options,syncControlSelection:t.selection}),T(t.options.filter((e=>t.selection.driveIds.includes(e.id))))),m().googleDriveConnectionStore.state.isEditing||"in_progress"===m().googleDriveConnectionStore.state.initialSyncState||b(!0)}else _(!1),b(!1),se().oV({label:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.settingsModal.userError",defaultMessage:"Cannot disconnect Google Drive. Please contact Notion workspace admin."}),position:"bottom",style:{width:"600px",display:"flex",justifyContent:"space-between"},right:(0,B.jsx)(C().Z,{onClick:se().rN,children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.settingsModal.closeSnackbarError",defaultMessage:"Close"})})})}}),[t,A,l,d]);const D=t=>{(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:t,analyticsFrom:e.analyticsFrom,sessionId:e.sessionId})},H=function(e){return(0,y().yK)((t=>({wrapper:{width:400,padding:"0 24px",minHeight:e?478:void 0},settingsWrapper:{justifyContent:"center",gap:12},googleDriveDetailsContainer:{fontSize:14,fontWeight:S().Ue.regular,color:t.text.secondary,gap:12},driveNamesContainer:{gap:2,color:t.text.primary},footer:{justifyContent:"center",alignItems:"center",width:"100%",gap:8},disconnectButton:{fontSize:14,fontWeight:S().Ue.medium,width:"100%"},moreDrivesContainer:{padding:"4px 0px 4px 0px"},learnMoreSection:{padding:"24px 0"},learnMoreButton:{fontSize:14,fontWeight:S().Ue.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:S().Ue.medium,fontSize:12,gap:5,justifyContent:"center",alignItems:"center",padding:"4px 8px 4px 8px",color:`${t.text.secondary}`},externalLinkIcon:{width:16,height:16},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:S().Ue.semibold,color:t.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:S().Ue.regular,color:t.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:S().Ue.regular,color:t.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:S().Ue.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:14,fontWeight:S().Ue.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},spinner:{paddingTop:20,justifyContent:"center",alignItems:"center"},driveItemWrapper:{width:"100%",padding:"4px 0px 4px 0px",alignItems:"center"},driveName:{fontSize:14},driveIcon:{width:20,color:t.text.secondary}})),[e])}(h);return(0,B.jsx)(I().Z,{showCloseIcon:!0,open:"settings_screen"===l,onDismiss:()=>{(0,k().j)({environment:A,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_close",integration_type:"google_drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),T([]),D("none")},render:()=>{var t,n,o;return(0,B.jsxs)("div",{style:H.wrapper,children:[(0,B.jsx)(N,{integrationLogoIcon:he().c,title:"completed"===d?(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.settingsModalTitle",defaultMessage:"Google Drive is connected to Notion AI"}):(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.settingsModalTitle2",defaultMessage:"Google Drive is connecting to Notion AI"})}),h?(0,B.jsx)(w().gq,{style:H.spinner,children:(0,B.jsx)(K().Z,{})}):(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(w().gq,{style:H.settingsWrapper,children:(0,B.jsxs)(w().Ht,{style:H.googleDriveDetailsContainer,children:[(0,B.jsx)(w().Ht,{children:"completed"===d?(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.settingsModal.canAnswerFrom",defaultMessage:"Notion AI is connected and can answer questions with content from {driveCountMessage}{futureDrivesMessage}",values:{driveCountMessage:M.length?`${M.length} Google Drives`:"Google Drive",futureDrivesMessage:null!==(t=e.syncControlSelection)&&void 0!==t&&t.enableSyncingFutureUsersAndDrives?", including future drives and users.":"."}}):(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.settingsModal.canAnswerFrom2",defaultMessage:"This can take up to 36h. You can cancel or modify your settings when the connection is complete. "})}),(0,B.jsxs)(w().Ht,{children:[(0,B.jsxs)(w().Ht,{style:H.driveNamesContainer,children:[(null===(n=e.syncControlSelection)||void 0===n?void 0:n.enableSyncingFutureUsersAndDrives)&&(0,B.jsxs)(w().gq,{style:H.driveItemWrapper,children:[(0,B.jsx)(w().Ht,{style:H.driveIcon,children:(0,Ee().v)({width:14,height:14})}),(0,B.jsx)(w().Ht,{style:H.driveName,children:(0,B.jsx)("div",{children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.settingsModal.includeCurrentAndFutureDrives",defaultMessage:"Includes current and future drives"})})})]}),null===(o=M.slice(0,4))||void 0===o?void 0:o.map((e=>(0,B.jsx)("div",{children:(0,B.jsxs)(w().gq,{style:H.driveItemWrapper,children:[(0,B.jsx)(w().Ht,{style:H.driveIcon,children:(0,Ee().v)({width:14,height:14})}),(0,B.jsx)(w().Ht,{style:H.driveName,children:`${e.name}`})]})},e.id)))]}),(0,B.jsx)(w().gq,{style:H.moreDrivesContainer,children:M.length-4>0?(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.settingsModal.moreDrives",defaultMessage:"... and {moreDriveCount} more",values:{moreDriveCount:M.length-4}}):(0,B.jsx)(B.Fragment,{})})]})]})}),(0,B.jsxs)(w().Ht,{style:H.footer,children:[j?(0,B.jsx)(Re,{styles:H.disconnectButton,isEditButtonEnabled:j,navigateToScreen:D}):(0,B.jsx)(Ge().Z,{allowHover:!0,textWrap:!0,renderTooltip:()=>(0,B.jsx)("div",{style:{width:240},children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.editDrive.tooltip",defaultMessage:"You can cancel or modify your settings when the connection is complete. "})}),render:e=>(0,B.jsx)(Re,{events:e,styles:H.disconnectButton,isEditButtonEnabled:j,navigateToScreen:D})}),f?(0,B.jsx)(Oe,{styles:H.disconnectButton,isDisconnectButtonEnabled:f,navigateToScreen:D}):(0,B.jsx)(Ge().Z,{allowHover:!0,textWrap:!0,renderTooltip:()=>(0,B.jsx)("div",{style:{width:240},children:(0,B.jsx)(x()._H,{id:"universalSearch.googleDriveIngestion.editDrive.tooltip",defaultMessage:"You can cancel or modify your settings when the connection is complete. "})}),render:e=>(0,B.jsx)(Oe,{events:e,styles:H.disconnectButton,isDisconnectButtonEnabled:f,navigateToScreen:D})})]}),(0,B.jsx)(w().gq,{style:H.learnMoreSection,children:(0,B.jsx)(C().Z,{style:H.learnMoreButton,onClick:()=>{(0,k().j)({environment:A,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_learn_more_url_click",integration_type:"google_drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),(()=>{const e=p().default.getConfigKey("ingestion","googleDrive"),t=null==e?void 0:e.learnMoreUrl;t&&window.open(t,"_blank")})()},children:(0,B.jsxs)(w().gq,{style:H.learnMoreText,children:[(0,B.jsx)(x()._H,{id:"universalSearch.integration.learnMore",defaultMessage:"Learn more"}),(0,ae().g)(H.externalLinkIcon)]})})})]})]})}})};function Je(){const e=(0,s().VK)((()=>m().googleDriveConnectionStore.state.screenToShow),[]),t=(0,s().VK)((()=>m().googleDriveConnectionStore.state.sessionId),[]),n=(0,s().VK)((()=>m().googleDriveConnectionStore.state.analyticsFrom),[]),o=(0,y().yK)((e=>({icon:{width:16,display:"inline-block"},wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.mediumBoxShadow,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:S().Ue.semibold,width:"100%"},iconWrapper:{width:16,height:16},chevronRightIcon:{width:14,height:14,fill:e.lightIconColor}})),[]);return(0,B.jsx)(I().Z,{showCloseIcon:!0,onDismiss:()=>(0,c().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",sessionId:t,analyticsFrom:n}),open:"service_account_not_added"===e,render:()=>(0,B.jsxs)("div",{style:o.wrapper,children:[(0,B.jsx)(N,{integrationLogoIcon:he().c,title:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.accountNotAdded.title",defaultMessage:"First, get your Google Workspace ready"}),subtext:(0,B.jsx)(x()._H,{id:"universalSearch.googleDrive.accountNotAdded.description",defaultMessage:"Before linking Google Drive with Notion, you'll need to modify a few settings in your Google Workspace."})}),(0,B.jsx)(w().Ht,{style:o.footer,children:(0,B.jsxs)(O().Z,{style:o.connectButton,onClick:()=>{const e=p().default.getConfigKey("ingestion","googleDrive"),t=null==e?void 0:e.learnMoreUrl;window.open(t,"_blank")},children:[(0,B.jsx)(x()._H,{id:"universalSearch.integration.seeInstruction",defaultMessage:"See instructions"}),(0,B.jsx)("div",{style:o.iconWrapper,children:(0,A().K)()})]})})]})})}var Ye=()=>n(144476);const $e=(0,x().vU)({primedTextInput:{id:"assistant.universalQna.jiraConnectedNotificationTooltip.tryItPrimedInput",defaultMessage:"Find a Jira issue about: "}});function Xe(){const e=(0,x().YB)(),t=(0,y().yK)((e=>({jiraIcon:{fill:e.blueColor,width:40,height:40}})),[]),n=(0,s().VK)((()=>h().jiraAIConnectionStore.state.screenToShow),[]),r=(0,s().VK)((()=>h().jiraAIConnectionStore.state.analyticsFrom),[]),a=(0,s().VK)((()=>h().jiraAIConnectionStore.state.sessionId),[]),c=(0,i().O7)(),l=(0,o.useCallback)((()=>{(0,k().j)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"try_it_out_button_clicked",integration_type:"jira",setup_session_id:a,from:r}}}),h().jiraAIConnectionStore.setState({...h().jiraAIConnectionStore.state,screenToShow:"none"}),ee().assistantMenuActions.openAssistantRightHandSideMenu({environment:c,from:"jira_already_connected",primeTextInput:e.formatMessage($e.primedTextInput)})}),[c,e,r,a]);return(0,B.jsx)(ve,{open:"already_connected"===n,tryItOutHandler:l,integrationIcon:()=>(0,Ye().k)(t.jiraIcon),onDismiss:()=>{h().jiraAIConnectionStore.reset()},title:(0,B.jsx)(x()._H,{id:"universalQna.jira.alreadyConnected",defaultMessage:"Jira is already connected to Notion AI"}),subText1:(0,B.jsx)(x()._H,{id:"universalQna.jira.ConnectedDescription",defaultMessage:"You're fully set up."}),subText2:(0,B.jsx)(x()._H,{id:"universalQna.jira.tryIt",defaultMessage:"Try asking AI about Jira issues or projects!"})})}function et(){const[e,t]=o.useState(!1),n=(0,i().O7)(),r=(0,y().yK)((e=>({noteHeading:{fontWeight:S().Ue.medium,fontSize:14,lineHeight:"18px"},jiraIcon:{fill:e.blueColor,width:40,height:40},noteBody:{fontWeight:S().Ue.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{width:18,height:17,color:"#D7813A",marginTop:2},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingLeft:14,fontweight:S().Ue.regular,letterSpacing:"-0.15px"},warningContainer:{marginLeft:5,marginRight:5,marginBottom:15}})),[]),l=(0,s().VK)((()=>h().jiraAIConnectionStore.state.screenToShow),[]),d=(0,s().VK)((()=>h().jiraAIConnectionStore.state.analyticsFrom),[]),g=(0,s().VK)((()=>h().jiraAIConnectionStore.state.sessionId),[]),m=(0,s().VK)((()=>u().default.state.currentUserStore),[]),v=(0,s().VK)((()=>{var e;return null===(e=u().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),f=(0,o.useCallback)((async()=>{if(!v)return;var e;(0,k().j)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_button_clicked",integration_type:"jira",setup_session_id:g,from:d}}}),await(e=5e3,new Promise((t=>setTimeout(t,e))));const o=await a().callApi({eventName:"checkNotionToJiraConnection",environment:n,data:{spaceId:v}});"success"===o.type&&o.data.isConnected?(h().jiraAIConnectionStore.setState({...h().jiraAIConnectionStore.state,screenToShow:"connection_complete_screen",jiraSiteId:o.data.jiraSiteId}),(0,c().navigateToJiraUniversalScreen)({screenToShow:"connection_complete_screen",analyticsFrom:d,sessionId:g})):t(!0)}),[d,n,g,v]),_=(0,s().VK)((()=>p().default.getConfigKey("jira_ai_ingestion_config","jiraMarketPlaceAppUrl")),[]),j=(0,s().VK)((()=>p().default.getConfigKey("jira_ai_ingestion_config","learnMoreUrl")),[]);if(!m||!v)return null;const C=e?(0,B.jsxs)(w().gq,{style:r.warningContainer,children:[(0,_e().t)(r.icon),(0,B.jsx)("div",{style:r.warningText,children:(0,B.jsx)(x()._H,{id:"universalQnA.jira.AuthScreen.warning",defaultMessage:"We couldn’t connect to Jira. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{TroubleshootingGuide:(0,B.jsx)("a",{style:{...r.link,color:"#D7813A"},href:j,target:"_blank",onClick:()=>{(0,k().j)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"trouble_shooting_guide_clicked",integration_type:"jira",setup_session_id:g,from:d}}})},children:(0,B.jsx)(x()._H,{id:"universalSearch.jira.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,B.jsx)(ye,{title:(0,B.jsx)(x()._H,{id:"universalQnA.jira.AuthScreen",defaultMessage:"Follow instructions from Jira in your browser"}),open:"check_connection"===l,onDismiss:()=>{t(!1),(0,k().j)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_dismiss",integration_type:"jira",setup_session_id:g,from:d}}}),(0,c().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:d,sessionId:g})},warningMessage:C,notes:[(0,B.jsxs)(w().Ht,{style:{gap:4},children:[(0,B.jsx)("div",{style:r.noteHeading,children:(0,B.jsx)(x()._H,{id:"universalSearch.jira.waitingForConnectionNoteHeading1",defaultMessage:"Jira should open automatically on a new browser tab."},"note1-1")}),(0,B.jsx)("div",{style:r.noteBody,children:(0,B.jsx)(x()._H,{id:"universalSearch.jira.authWaiting2",defaultMessage:"If it doesn't, {ClickHereToRetry}",values:{ClickHereToRetry:(0,B.jsx)("a",{style:r.link,href:_,target:"_blank",onClick:()=>{(0,k().j)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_open_auth_url",integration_type:"jira",setup_session_id:g,from:d}}})},children:(0,B.jsx)(x()._H,{id:"universalSearch.jira.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,B.jsxs)(w().Ht,{style:{gap:4},children:[(0,B.jsx)("div",{style:r.noteHeading,children:(0,B.jsx)(x()._H,{id:"universalSearch.jira.workspaceAdminHeading",defaultMessage:"Follow Jira’s instructions to connect"},"note2")}),(0,B.jsx)("div",{style:r.noteBody,children:(0,B.jsx)(x()._H,{id:"universalSearch.jira.authWaiting",defaultMessage:"Install the Notion connector in a Jira site of your choice and return to this window"},"note1-2")})]},"note-2"),(0,B.jsx)(w().Ht,{style:{gap:4},children:(0,B.jsx)("div",{style:r.noteHeading,children:(0,B.jsx)(x()._H,{id:"universalSearch.jira.workspaceAdminHeading2",defaultMessage:"When you’re done, click the button below"},"note3")})},"note-3")],openLearnMoreUrl:()=>{window.open(j,"_blank")},integrationIcon:()=>(0,Ye().k)(r.jiraIcon),primaryButtonText:(0,B.jsx)(x()._H,{id:"universalSearch.jira.Button.finishedSetup",defaultMessage:"Check connection"},"note3-1"),onClickPrimaryButton:f})}const tt=(0,x().vU)({copyTextMessage:{id:"universalSearch.jira.connectionComplete.jiraTitle.copyMessage",defaultMessage:"Our Notion AI is now connecting to Jira. When you ask Notion AI a question, it'll be able to reference info across your Jira site. Click the button at the bottom right of your Notion app to give it a try!"}});function nt(){const e=(0,i().O7)(),t=(0,y().yK)((e=>({headingText:{fontSize:S().JB.UIRegular.desktop,letterSpacing:"-0.154px",color:`${e.text.primary}`,paddingBottom:8,fontWeight:S().Ue.medium},circle:{marginRight:8},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer",paddingLeft:2},noteBody:{fontWeight:S().Ue.regular,color:e.text.secondary,fontSize:S().JB.UIRegular.desktop,lineHeight:"18px",letterSpacing:"-0.154px",display:"flex"},jiraIcon:{fill:e.blueColor,width:40,height:40}})),[]),n=(0,s().VK)((()=>h().jiraAIConnectionStore.state.screenToShow),[]),r=(0,s().VK)((()=>h().jiraAIConnectionStore.state.sessionId),[]),a=(0,s().VK)((()=>h().jiraAIConnectionStore.state.analyticsFrom),[]),l=(0,s().VK)((()=>h().jiraAIConnectionStore.state.sessionId),[]),d=(0,s().VK)((()=>{var e;return null===(e=u().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]);let g=(0,s().VK)((()=>h().jiraAIConnectionStore.state.jiraSiteId),[]);const p=(0,s().VK)((()=>h().jiraAIConnectionStore.state.jiraSyncState),[]),[m,v]=(0,o.useState)(!1),f="in_progress"===p;return(0,B.jsx)(ue,{open:"connection_complete_screen"===n,onDismiss:()=>{(0,k().j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_dismiss",integration_type:"jira",setup_session_id:r,from:a}}})},onCopiedClick:()=>{(0,k().j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"copy_button_clicked",integration_type:"jira",setup_session_id:r,from:a}}})},title:(0,B.jsx)(x()._H,{id:"universalSearch.jira.connectionComplete.jiraTitle",defaultMessage:"You’re done!"}),integrationIcon:()=>(0,Ye().k)(t.jiraIcon),subText:(0,B.jsx)(x()._H,{id:"universalSearch.jira.connectionComplete.jiraTitle.subText",defaultMessage:"Here’s what’s next:"}),primaryButtonText:(0,B.jsx)(x()._H,{id:"assistantOverflowMenu.jiraIngestion.connectionComplete.confirmConnection",defaultMessage:"Done"}),notes:[(0,B.jsxs)(w().gq,{style:t.headingText,children:[(0,B.jsx)(b().Z,{number:1,style:t.circle}),(0,B.jsxs)(w().Ht,{children:[(0,B.jsx)(x()._H,{id:"assistantOverflowMenu.jiraIngestion.connectionComplete.listpoint1",defaultMessage:"Connecting your Jira site may take up to 36h."},"note1"),!f&&(0,B.jsx)("div",{style:t.noteBody,children:(0,B.jsx)(x()._H,{id:"universalSearch.jira.selectJiraProjects",defaultMessage:"If you want to choose Jira projects, {clickHere}",values:{clickHere:m?(0,B.jsx)(K().Z,{}):(0,B.jsx)("a",{style:t.link,onClick:async()=>{if(!d)return;(0,k().j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"jira_settings",integration_type:"jira",setup_session_id:r,from:a}}}),v(!0);const t=await(0,c().getJiraAIConnectionStatusAction)({environment:e,spaceId:d});if(t){var n;const e=null===(n=t.connectionState)||void 0===n?void 0:n.status;"in_progress"===e?(0,c().navigateToJiraUniversalScreen)({analyticsFrom:a,sessionId:r,screenToShow:"settings_screen"}):"not_started"===e||"pending_selection"===e?(0,c().navigateToJiraUniversalScreen)({analyticsFrom:a,sessionId:r,screenToShow:"select_projects"}):(0,c().navigateToJiraUniversalScreen)({analyticsFrom:a,sessionId:r,screenToShow:"error"})}else(0,c().navigateToJiraUniversalScreen)({analyticsFrom:a,sessionId:r,screenToShow:"error"});v(!1)},children:(0,B.jsx)(x()._H,{id:"universalSearch.jira.settings",defaultMessage:"click here."})})}},"note1-1")})]})]},"item1"),(0,B.jsxs)(w().gq,{style:t.headingText,children:[(0,B.jsx)(b().Z,{number:2,style:t.circle}),(0,B.jsx)(x()._H,{id:"assistantOverflowMenu.jiraIngestion.connectionComplete.listpoint2",defaultMessage:"Notion AI will be ready to answer questions across Notion and Jira knowledge."},"note2")]},"item2"),(0,B.jsxs)(w().gq,{style:t.headingText,children:[(0,B.jsx)(b().Z,{number:3,style:t.circle}),(0,B.jsx)(x()._H,{id:"assistantOverflowMenu.jiraIngestion.connectionComplete.listpoint3",defaultMessage:"Copy the message below to let your team know!"})]},"item3")],copyTextMessage:tt.copyTextMessage,onPrimaryButtonClick:async()=>{var t,n;if(!d)return;if((0,k().j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_done",integration_type:"jira",setup_session_id:r,from:a}}}),f||"completed"===p)return void(0,c().navigateToJiraUniversalScreen)({analyticsFrom:a,sessionId:l,screenToShow:"none"});const o=await(0,c().getJiraAIConnectionStatusAction)({environment:e,spaceId:d});if(g=(null==o?void 0:o.jiraSiteId)??"",g){if("in_progress"===(null==o||null===(t=o.connectionState)||void 0===t?void 0:t.status)||"completed"===(null==o||null===(n=o.connectionState)||void 0===n?void 0:n.status))return se().oV({label:re().Z.getIntl().formatMessage({defaultMessage:"Jira sync started. This can take up to 36 hours.",id:"jira.sync.started.background.3"}),position:"bottom"}),void(0,c().navigateToJiraUniversalScreen)({analyticsFrom:a,sessionId:l,screenToShow:"none"});await(0,c().startJiraBulkIngestionAction)({environment:e,spaceId:d,jiraSiteId:g,sessionId:l}),(0,c().navigateToJiraUniversalScreen)({analyticsFrom:a,sessionId:l,screenToShow:"none"})}else(0,c().navigateToJiraUniversalScreen)({analyticsFrom:a,sessionId:l,screenToShow:"error"})}})}const ot=(0,x().vU)({note1Heading:{id:"universalSearch.jiraIngestion.post_disconnect_screen.note_1.heading",defaultMessage:"Jira data will be permanently deleted from Notion"},note1Body:{id:"universalSearch.jiraIngestion.post_disconnect_screen.note_1.body",defaultMessage:"This process can take up to 3 hours. You'll only be able to reconnect after disconnecting is complete."},note2Heading:{id:"universalSearch.jiraIngestion.post_disconnect_screen.note_2.heading",defaultMessage:"Uninstall the Notion AI app from your Jira Site (optional)"},postDisconnectTitle:{id:"universalSearch.jiraIngestion.post_disconnect_modal.title",defaultMessage:"Jira is disconnecting from Notion AI"},postDisconnectDescription:{id:"universalSearch.jiraIngestion.post_disconnect_modal.description",defaultMessage:"Here's what's next:"},disconnectTitle:{id:"universalSearch.jiraIngestion.disconnectModal.title",defaultMessage:"Are your sure?"},disconnectSubTitle:{id:"universalSearch.jiraIngestion.disconnectModal.subTitle",defaultMessage:"Jira data will be permanently deleted from Notion."},disconnectDescription:{id:"universalSearch.jiraIngestion.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and you'll only be able to reconnect after disconnecting is complete."},primaryButtonLabel:{id:"universalSearch.jiraIngestion.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"},goBackButtonLabel:{id:"universalSearch.jiraIngestion.disconnectModal.goBack",defaultMessage:"Go back"}});function it(){const e=(0,y().yK)((e=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:S().Ue.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:S().JB.UIRegular.desktop,fontWeight:S().Ue.medium,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:S().JB.UIRegular.desktop,fontWeight:S().Ue.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:S().JB.UIRegular.desktop,fontWeight:S().Ue.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:S().JB.UIRegular.desktop,fontWeight:S().Ue.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},notesSectionWrapper:{padding:"12px 12px 12px 12px",gap:13},noteBlockWrapper:{marginBottom:12,gap:8},note:{fontWeight:S().Ue.regular,fontSize:S().JB.UIRegular.desktop,lineHeight:"18px"},noteHeading:{fontWeight:S().Ue.medium,fontSize:S().JB.UIRegular.desktop,lineHeight:"18px"},noteBody:{fontWeight:S().Ue.regular,color:e.text.secondary,fontSize:S().JB.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{rotate:"45deg",width:12,height:12,cursor:"pointer",display:"inline",padding:0,margin:0},jiraIcon:{fill:e.blueColor,width:40,height:40}})),[]),[t,n]=(0,o.useState)(!1),r=(0,s().Kw)(h().jiraAIConnectionStore),l=(0,s().VK)((()=>r.jiraSiteId),[r]),d=(0,s().VK)((()=>r.jiraSiteUrl),[r]),g=(0,s().VK)((()=>h().jiraAIConnectionStore.state.screenToShow),[]),p=(0,s().VK)((()=>{var e;return null===(e=u().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),m=(0,s().VK)((()=>h().jiraAIConnectionStore.state.analyticsFrom),[]),v=(0,s().VK)((()=>h().jiraAIConnectionStore.state.sessionId),[]),f=(0,i().O7)(),_=async()=>{if(!p)return;const e=await async function(e){const{environment:t,spaceId:n,jiraSiteId:o}=e,i=await a().callApi({eventName:"disconnectJiraConnector",environment:t,data:{spaceId:n,jiraSiteId:o}});if("success"===i.type)return se().oV({label:re().Z.getIntl().formatMessage({defaultMessage:"Started disconnecting Jira. This can take up to 3 hours.",id:"jira.disconnect.started"}),position:"bottom",style:{width:"400px",display:"flex",justifyContent:"space-between"}}),!0;return!1}({environment:f,spaceId:p,jiraSiteId:l});e&&h().jiraAIConnectionStore.setState({...r,jiraSyncState:"disconnecting",isDisconnecting:!0,screenToShow:"post_disconnect_screen"})},j=(0,o.useCallback)((()=>{const{noteBlockWrapper:t,noteHeading:n,noteBody:o,link:i}=e;return[(0,B.jsxs)(w().Ht,{style:t,children:[(0,B.jsx)("div",{style:n,children:(0,B.jsx)(x()._H,{...ot.note1Heading})}),(0,B.jsx)("div",{style:o,children:(0,B.jsx)(x()._H,{...ot.note1Body})})]},"note-1"),(0,B.jsxs)(w().Ht,{style:t,children:[(0,B.jsx)("div",{style:n,children:(0,B.jsx)(x()._H,{...ot.note2Heading})}),(0,B.jsx)("div",{style:o,children:(0,B.jsx)(x()._H,{id:"universalSearch.jiraIngestion.post_disconnect_screen.note_2.body",defaultMessage:"Go to your {NavigateToJiraSiteSettings} and uninstall the Notion AI app.",values:{NavigateToJiraSiteSettings:(0,B.jsx)("a",{style:i,href:`${d}/plugins/servlet/upm`,target:"_blank",onClick:()=>{(0,k().j)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_screen_marketplace_app_disconnect_btn",integration_type:"jira",setup_session_id:v,from:m}}})},children:(0,B.jsx)(x()._H,{id:"universalSearch.jiraIngestion.post_disconnect_screen.disconnect_jira_marketplace_app",defaultMessage:"Jira Site {ArrowIcon}",values:{ArrowIcon:(0,Pe().Z)(e.icon)}})})}},"note2-2")})]},"note-2")]}),[e,d,f,v,m]);return"post_disconnect_screen"===g?(0,B.jsx)(Ke,{onClickGotItBtn:()=>{h().jiraAIConnectionStore.setState({...r,screenToShow:"none"})},onDismiss:()=>{h().jiraAIConnectionStore.setState({...r,screenToShow:"none"})},open:"post_disconnect_screen"===g,integrationIcon:()=>(0,Ye().k)(e.jiraIcon),title:(0,B.jsx)(x()._H,{...ot.postDisconnectTitle}),descriptionMessage:(0,B.jsx)(x()._H,{...ot.postDisconnectDescription}),message:(0,B.jsx)("div",{style:e.notesSectionWrapper,children:j().map(((t,n)=>(0,B.jsxs)(w().gq,{gap:8,style:{marginTop:4,marginBottom:6},children:[(0,B.jsx)(b().Z,{number:n+1}),(0,B.jsx)("div",{style:e.note,children:t})]},n)))})}):(0,B.jsx)(I().Z,{showCloseIcon:!0,open:"disconnect_screen"===g,onDismiss:()=>{h().jiraAIConnectionStore.setState({...r,screenToShow:"none"})},render:()=>(0,B.jsx)("div",{style:e.confirmWrapper,children:(0,B.jsxs)("div",{style:e.confirmContainer,children:[(0,B.jsx)("div",{style:e.confirmModalTitle,children:(0,B.jsx)(x()._H,{...ot.disconnectTitle})}),(0,B.jsx)("div",{style:e.confirmModalSubTitle,children:(0,B.jsx)(x()._H,{...ot.disconnectSubTitle})}),(0,B.jsx)("div",{style:e.confirmModalDescription,children:(0,B.jsx)(x()._H,{...ot.disconnectDescription})}),(0,B.jsxs)(w().Ht,{style:e.confirmModalActionButtons,children:[(0,B.jsx)(O().Z,{isRed:!0,style:e.confirmDisconnectButton,isLoading:t,onClick:async()=>{(0,k().j)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_confirm_disconnect_button",integration_type:"jira",setup_session_id:v,from:m}}}),n(!0),await _(),n(!1)},children:(0,B.jsx)(x()._H,{...ot.primaryButtonLabel})}),(0,B.jsx)(C().Z,{style:e.goBackButton,onClick:()=>{(0,c().navigateToJiraUniversalScreen)({screenToShow:"settings_screen",analyticsFrom:r.analyticsFrom,sessionId:r.sessionId})},children:(0,B.jsx)(x()._H,{...ot.goBackButtonLabel})})]})]})})})}function st(){const e=(0,s().VK)((()=>h().jiraAIConnectionStore.state.screenToShow),[]),t=(0,s().VK)((()=>h().jiraAIConnectionStore.state.sessionId),[]),n=(0,s().VK)((()=>h().jiraAIConnectionStore.state.analyticsFrom),[]),o=(0,y().yK)((e=>({jiraIcon:{fill:e.blueColor,width:40,height:40},wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.mediumBoxShadow,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:S().Ue.semibold,width:"100%"},iconWrapper:{width:16,height:16},chevronRightIcon:{width:14,height:14,fill:e.lightIconColor}})),[]),i="error"===e;return(0,B.jsx)(I().Z,{showCloseIcon:!0,onDismiss:()=>(0,c().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:n,sessionId:t}),open:i,render:()=>(0,B.jsxs)("div",{style:o.wrapper,children:[(0,B.jsx)(N,{integrationLogoIcon:()=>(0,Ye().k)(o.jiraIcon),title:(0,B.jsx)(x()._H,{id:"universalSearch.jira.error.title",defaultMessage:"Oops! Something went wrong"}),subtext:(0,B.jsx)(x()._H,{id:"universalSearch.jira.error.description",defaultMessage:"Something went wrong, please try again later."})}),(0,B.jsx)(w().Ht,{style:o.footer,children:(0,B.jsx)(O().Z,{style:o.connectButton,onClick:()=>{(0,c().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:n,sessionId:t})},children:(0,B.jsx)(x()._H,{id:"universalSearch.jira.error.Dismiss",defaultMessage:"Close"})})})]})})}function rt(){const[e,t]=o.useState(!1),n=(0,o.useMemo)((()=>R("jira")),[]),r=(0,o.useRef)(!1),l=(0,y().yK)((e=>({jiraIcon:{fill:e.blueColor,width:40,height:40}})),[]),d=(0,i().O7)(),m=(0,s().VK)((()=>{var e;return null===(e=u().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),v=(0,o.useMemo)((()=>E("jira")),[]),f=(0,s().VK)((()=>h().jiraAIConnectionStore.state.screenToShow),[]),_=(0,s().VK)((()=>h().jiraAIConnectionStore.state.analyticsFrom),[]),S=(0,s().VK)((()=>h().jiraAIConnectionStore.state.sessionId),[]),j=(0,s().VK)((()=>g().KR.isJiraQnaEnabled()),[]),C=(0,L().y)(),b=(0,s().VK)((()=>u().default.state.currentUserStore),[]),I=(0,q().J)(),w="info_screen"===f,M=(0,s().VK)((()=>p().default.getConfigKey("jira_ai_ingestion_config","learnMoreUrl")),[]);return(0,o.useEffect)((()=>{m&&I&&"info_screen"===f&&(r.current||((0,k().j)({environment:d,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"jira",setup_session_id:S,from:_,is_space_admin:I,is_ai_eligible:C}}}),r.current=!0))}),[m,d,f,S,_,I,C]),j?d.device.isMobile?(0,B.jsx)(Q,{logo:Ye().k,appName:"Jira",open:w,onClosed:()=>{h().jiraAIConnectionStore.reset()},learnMoreUrl:M}):I?(0,B.jsx)(Y,{integrationIcon:()=>(0,Ye().k)(l.jiraIcon),notes:n,onLearnMore:()=>{window.open(M,"_blank")},onConnect:async()=>{m&&b&&await async function(e,t,n,o,i,s){(0,k().j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect",integration_type:"jira",setup_session_id:o,from:i}}}),s(!0);const r=await(0,c().getJiraAIConnectionStatusAction)({environment:e,spaceId:n});if(r){const{connectionState:t}=r;if("not_started"===t.status){(0,k().j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_screen_open",integration_type:"jira",setup_session_id:o,from:i}}});if("success"===(await a().callApi({eventName:"addNotionInfoForJiraAIConnection",environment:e,data:{spaceId:n}})).type){(0,c().navigateToJiraUniversalScreen)({screenToShow:"check_connection",analyticsFrom:i,sessionId:o});const t=p().default.getConfigKey("jira_ai_ingestion_config","jiraMarketPlaceAppUrl");t&&((0,k().j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"app_install_url_opened",integration_type:"jira",setup_session_id:o,from:i}}}),window.open(t,"_blank"))}}else"pending_selection"===t.status?((0,k().j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"project_selection_screen_open",integration_type:"jira",setup_session_id:o,from:i}}}),(0,c().navigateToJiraUniversalScreen)({screenToShow:"connection_complete_screen",analyticsFrom:i,sessionId:o})):"in_progress"===t.status||"editing"===t.status?((0,k().j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_open",integration_type:"jira",setup_session_id:o,from:i}}}),(0,c().navigateToJiraUniversalScreen)({screenToShow:"settings_screen",analyticsFrom:i,sessionId:o})):"completed"===t.status?((0,k().j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"already_connected_screen_open",integration_type:"jira",setup_session_id:o,from:i}}}),(0,c().navigateToJiraUniversalScreen)({screenToShow:"already_connected",analyticsFrom:i,sessionId:o})):(0,c().navigateToJiraUniversalScreen)({screenToShow:"error",analyticsFrom:i,sessionId:o})}s(!1)}(d,0,m,S,_,t)},onDismiss:()=>{(0,k().j)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_dismiss",integration_type:"jira",setup_session_id:S,from:_}}}),(0,c().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:_,sessionId:S}),r.current=!1},title:(0,B.jsx)(x()._H,{id:"universalSearch.jiraIngestion.intro.jiraTitle",defaultMessage:"Get answers from Jira without leaving Notion"}),isLoading:e,titleWidth:352,open:w}):(0,B.jsx)($,{onConnect:()=>{h().jiraAIConnectionStore.reset(),(0,k().j)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"contact_workspace_owners",integration_type:"jira",setup_session_id:S,from:_}}}),W().r$({openedFrom:"jira_connect_nonadmin_modal",currentTab:"members"})},integrationIcon:()=>(0,Ye().k)(l.jiraIcon),message:v,onDismiss:()=>h().jiraAIConnectionStore.reset(),open:w}):(0,B.jsx)(B.Fragment,{})}var at=()=>n(513670),ct=()=>n(291198),lt=()=>n(998901);const dt=(0,x().vU)({searchForAProject:{id:"universalQnA.jira.searchForAProject",defaultMessage:"Search for a Project"},disabledTooltip:{id:"universalSearch.jira.disabledTooltip",defaultMessage:"You can only interact after all projects are loaded"}});function ut(){const[e,t]=o.useState(""),[n,l]=o.useState(!1),[d,g]=o.useState(!1),p=(0,s().VK)((()=>h().jiraAIConnectionStore.state.syncControl),[]),[m,v]=o.useState([]),[f,_]=o.useState(!0),[j,C]=o.useState(!0),[b,M]=o.useState(0),[T,A]=o.useState(!1),D=function(e){return(0,y().yK)((t=>({wrapper:{width:400,display:"flex",flexDirection:"column",minHeight:530},jiraIcon:{fill:t.blueColor,width:40,height:40},jiraSmallIcon:{fill:t.blueColor,width:18,height:18},logoSection:{padding:"20px 20px 9px 20px",gap:8,justifyContent:"center",alignItems:"center",height:84},logos:{width:40,height:40},arrowLogo:{width:20,height:20,color:t.icon.secondary},titleWrapper:{width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center"},title:{fontSize:17,fontWeight:S().Ue.medium,lineHeight:"22px",marginBottom:"9px"},subtext:{fontSize:12,lineHeight:"14.52px",color:t.text.secondary},footer:{position:"absolute",width:"100%",justifySelf:"flex-end",boxShadow:"0px 9px 24px 0px #0F0F0F33",padding:"16px 20px 16px 20px",gap:12,bottom:0},connectButton:{fontSize:14,fontWeight:S().Ue.semibold,width:360},searchBarWrapper:{justifyContent:"center"},searchBar:{width:360,padding:4},selectionContainer:{marginTop:18,marginBottom:0,width:"100%",height:"100%",justifyContent:"center",padding:"0px 20px 0px"},selection:{width:"100%"},waitingForConnection:{fontSize:12,lineHeight:"16px",color:t.text.secondary},waitingForConnectionWrapper:{gap:4},tryAgainWrapper:{marginTop:16,gap:4},tryAgainSection:{gap:4,alignItems:"center",marginBottom:16,color:t.text.secondary},tryAgainText:{fontSize:14},channelItem:{gap:4,alignItems:"center"},channelsText:{fontSize:12,lineHeight:"16px",display:"flex",flexDirection:"row",gap:4},divider:{marginTop:5,marginBottom:5},alertIcon:{width:16,height:16},tryAgainButton:{fontSize:12,width:80},futureChannelsCheckboxWrapper:{gap:4,visibility:"visible"},loadingChannelsWrapper:{alignItems:"center",gap:8,fontSize:12,color:t.text.secondary,marginTop:8},selectionWrapper:{overflowY:"scroll",maxHeight:e?170:124},loadMoreButtonWrapper:{fontSize:12,paddingTop:8,paddingBottom:4},loadMoreButtonhoveredStyle:{background:"none"},channelItemWrapper:{marginTop:12},workspaceAdministratorHeading:{fontSize:14,fontWeight:S().Ue.regular,color:t.text.primary},orderedList:{paddingLeft:18,fontSize:14,fontWeight:S().Ue.regular,color:t.text.secondary},waitingForConnectionNote:{paddingBottom:4},note:{fontWeight:S().Ue.regular,fontSize:14,lineHeight:"18px",width:330,marginLeft:8},noteHeading:{fontWeight:S().Ue.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:S().Ue.regular,color:t.text.secondary,fontSize:14,lineHeight:"18px"},learnMoreButton:{gap:4,alignItems:"center",fontSize:14,color:t.text.secondary,justifyContent:"center"},buttonContainer:{justifyContent:"center"},link:{color:t.text.secondary,textDecoration:"underline",cursor:"pointer"},loadingChannels:{color:t.text.secondary},loadingWrapper:{alignItems:"center",gap:4}})),[e])}(d),H=(0,s().VK)((()=>h().jiraAIConnectionStore.state.analyticsFrom),[]),U=(0,s().VK)((()=>h().jiraAIConnectionStore.state.sessionId),[]),F=(0,s().VK)((()=>h().jiraAIConnectionStore.state.jiraSiteId),[]),W=(0,s().VK)((()=>h().jiraAIConnectionStore.state.screenToShow),[]),P=(0,i().O7)(),q=(0,s().VK)((()=>{var e;return null===(e=u().default.getState().currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),L=(0,s().Kw)(h().jiraAIConnectionStore),z="completed"===(0,s().VK)((()=>h().jiraAIConnectionStore.state.jiraSyncState),[]),Z=(0,o.useCallback)((async()=>{if(!q)return;(0,k().j)({environment:P,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"project_selection_connect_button_clicked",integration_type:"jira",setup_session_id:U,from:H}}});let e,t=[],n=[];if(j?n=m.filter((e=>!e.checked)).map((e=>({id:e.id,name:e.name}))):t=m.filter((e=>e.checked)).map((e=>({id:e.id,name:e.name}))),l(!0),z)e=await(0,c().startJiraEditFlow)({environment:P,spaceId:q,jiraSiteId:F,inclusionList:t,exclusionList:n});else{var o,i;const s=await(0,c().getJiraAIConnectionStatusAction)({environment:P,spaceId:q});if("in_progress"===(null==s||null===(o=s.connectionState)||void 0===o?void 0:o.status)||"completed"===(null==s||null===(i=s.connectionState)||void 0===i?void 0:i.status))return se().oV({label:re().Z.getIntl().formatMessage({defaultMessage:"Jira is already syncing. This can take up to 36 hours.",id:"jira.sync.started.background.2"}),position:"bottom"}),void(0,c().navigateToJiraUniversalScreen)({analyticsFrom:H,sessionId:U,screenToShow:"none"});e=await(0,c().startJiraBulkIngestionAction)({environment:P,spaceId:q,jiraSiteId:F,sessionId:U,inclusionList:t,exclusionList:n})}e?(0,c().navigateToJiraUniversalScreen)({analyticsFrom:H,screenToShow:"none",sessionId:U}):(0,c().navigateToJiraUniversalScreen)({analyticsFrom:H,screenToShow:"error",sessionId:U}),l(!1)}),[q,j,P,F,m,H,U,z]),V=(0,o.useCallback)((()=>m.find((e=>e.checked))),[m]),G=(0,o.useCallback)((e=>{const t=m.map((t=>t.id===e?{...t,checked:!t.checked}:t));v(t);const n=t.find((e=>e.checked)),o=t.find((e=>!e.checked));let i=!1;n&&o?i="partial":n&&(i=!0),_(i)}),[m]);(0,o.useEffect)((()=>{"select_projects"===W&&(0===p.inclusionList.length&&0===p.exclusionList.length?_(!0):_("partial"),C(0===p.inclusionList.length))}),[W,p]);const E=(0,o.useCallback)((()=>{_(!f),v((e=>e.map((e=>({...e,checked:!f})))))}),[f]),R=(0,o.useCallback)((e=>{const t=m.find((t=>t.id===e));return!(null==t||!t.checked)}),[m]),Q=(0,o.useCallback)((async e=>{if(!q)return;A(!0);const t=await a().callApi({eventName:"getJiraProjects",environment:P,data:{spaceId:q,jiraSiteId:F,startAt:e}});if("success"===t.type){v((e=>{const n=t.data.projects.map((e=>{let t=!1;return 0===p.inclusionList.length&&0===p.exclusionList.length?t=!0:p.inclusionList.length>0?t=!!p.inclusionList.find((t=>t.id===e.id)):p.exclusionList.length>0&&(t=!p.exclusionList.find((t=>t.id===e.id))),{...e,checked:t}}));return(0,at().mN)([...e,...n],(e=>e.id))})),M(t.data.total);const n=e+t.data.projects.length;n>e?Q(n):g(!0)}}),[P,q,F,p]),J=(0,o.useCallback)((()=>(0,B.jsxs)(w().Ht,{children:[(0,B.jsxs)(w().gq,{style:D.channelItem,children:[(0,B.jsx)(Ge().Z,{render:e=>(0,B.jsx)("div",{...e,children:(0,B.jsx)(Ie().Z,{checked:f,checkSize:10,size:14,disabled:!d,onClick:()=>{(0,k().j)({environment:P,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:f?"all_projects_deselected":"all_projects_selected",integration_type:"jira",setup_session_id:L.sessionId,from:L.analyticsFrom}}}),E()}})}),renderTooltip:()=>(0,B.jsx)("div",{style:{width:280},children:(0,B.jsx)(x()._H,{...dt.disabledTooltip})}),disableTooltip:d}),(0,B.jsxs)("div",{style:D.channelsText,children:[(0,Ye().k)(D.jiraSmallIcon),(0,B.jsx)(x()._H,{id:"universalSearch.integration.jiraIngestion.allProjects",defaultMessage:"All projects"})]})]}),(0,B.jsx)(we().Z,{style:D.divider,size:4}),(0,B.jsxs)(B.Fragment,{children:[d?(0,B.jsx)(B.Fragment,{}):(0,B.jsxs)(w().gq,{style:D.loadingChannelsWrapper,children:[(0,B.jsx)(K().Z,{}),(0,B.jsxs)(w().Ht,{children:[(0,B.jsx)("div",{children:(0,B.jsx)(x()._H,{id:"universalSearch.integration.jiraIngestion.loadedXProjects",defaultMessage:"{projectsCount} of {totalProjects} projects loaded",values:{projectsCount:m.length,totalProjects:b}})}),(0,B.jsx)("div",{children:(0,B.jsx)(x()._H,{id:"universalSearch.integration.jiraIngestion.loading1000PerMinute",defaultMessage:"This can take one minute per every 1,000 projects."})})]})]}),(0,B.jsx)(w().Ht,{style:D.selectionWrapper,children:(e?m.filter((t=>t.name.toLowerCase().includes(e.toLowerCase()))):m).map((e=>(0,B.jsxs)(w().gq,{gap:8,style:D.channelItemWrapper,children:[(0,B.jsx)(Ge().Z,{render:t=>(0,B.jsx)("div",{...t,children:(0,B.jsx)(Ie().Z,{checked:R(e.id),disabled:!d,onClick:()=>{(0,k().j)({environment:P,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:R(e.id)?"specific_project_deselected":"specific_project_selected",integration_type:"jira",setup_session_id:L.sessionId,from:L.analyticsFrom}}}),G(e.id)},checkSize:10,size:14},`${e.id}-checkbox`)}),renderTooltip:()=>(0,B.jsx)("div",{style:{width:280},children:(0,B.jsx)(x()._H,{...dt.disabledTooltip})}),disableTooltip:d}),(0,Ye().k)(D.jiraSmallIcon),(0,B.jsx)("div",{style:D.channelsText,children:` ${e.name}`},`${e.id}-label`)]},e.id)))})]})]})),[D,d,m,b,e,f,P,L.sessionId,L.analyticsFrom,E,R,G]);return(0,r().r5)((async()=>{q&&F&&"select_projects"===W&&!d&&!T&&await Q(0)}),[q,Q,W,F,d,T]),(0,B.jsx)(I().Z,{showCloseIcon:!0,open:"select_projects"===W,onDismiss:()=>{(0,k().j)({environment:P,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_close",integration_type:"jira",setup_session_id:U,from:H}}}),(0,c().navigateToJiraUniversalScreen)({analyticsFrom:H,screenToShow:"none",sessionId:U})},render:()=>(0,B.jsxs)("div",{style:D.wrapper,children:[(0,B.jsx)(N,{integrationLogoIcon:()=>(0,Ye().k)(D.jiraIcon),title:(0,B.jsx)(x()._H,{id:"universalQnA.jira.projectSelectionScreenTitle",defaultMessage:"Select projects to connect"}),subtext:(0,B.jsx)(x()._H,{id:"universalQnA.jira.projectSelectionScreenSubtext",defaultMessage:"Connecting more Jira projects will give you more relevant and useful Notion AI responses"})}),(0,B.jsx)(ke().Z,{capture:!0,allowEsc:!0,render:()=>(0,B.jsx)(Ge().Z,{textWrap:!0,placement:lt().Placement.Top,render:n=>(0,B.jsx)("div",{...n,children:(0,B.jsx)(w().gq,{...n,style:D.searchBarWrapper,children:(0,B.jsx)(ct().Z,{id:"jiraUniversalQnASearchBar",style:D.searchBar,disabled:!d,placeholder:re().Z.formatMessage(dt.searchForAProject),value:e,onChange:e=>{t(e.target.value),(0,k().j)({environment:P,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"filter_jira_projects",integration_type:"jira",setup_session_id:U,from:H}}})}},"jiraUniversalQnASearchBar")})}),renderTooltip:()=>(0,B.jsx)("div",{style:{width:280},children:(0,B.jsx)(x()._H,{...dt.disabledTooltip})}),disableTooltip:d})}),(0,B.jsx)(w().gq,{style:D.selectionContainer,children:(0,B.jsx)(w().Ht,{style:D.selection,children:J()})}),(0,B.jsxs)(w().Ht,{style:D.footer,children:[(0,B.jsxs)(w().gq,{style:D.futureChannelsCheckboxWrapper,children:[(0,B.jsx)(Ge().Z,{render:e=>(0,B.jsx)("div",{...e,children:(0,B.jsx)(Ie().Z,{checked:j,checkSize:10,disabled:!d,size:14,onClick:()=>{(0,k().j)({environment:P,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:j?"dont_join_future_projects":"join_future_projects",integration_type:"jira",setup_session_id:L.sessionId,from:L.analyticsFrom}}}),C(!j)}})}),renderTooltip:()=>(0,B.jsx)("div",{style:{width:280},children:(0,B.jsx)(x()._H,{...dt.disabledTooltip})}),disableTooltip:d}),(0,B.jsx)("div",{style:D.channelsText,children:(0,B.jsx)(x()._H,{id:"universalSearch.integration.jiraIngestion.allFutureProjects",defaultMessage:"Add projects created in future"})})]}),(0,B.jsx)(Ge().Z,{render:e=>(0,B.jsx)("div",{...e,children:(0,B.jsx)(O().Z,{isLoading:n,style:D.connectButton,onClick:Z,disabled:!V()||!d,children:(0,B.jsx)(x()._H,{id:"universalSearch.integration.connect",defaultMessage:"Connect"})})}),renderTooltip:()=>(0,B.jsx)("div",{style:{width:280},children:(0,B.jsx)(x()._H,{...dt.disabledTooltip})}),disableTooltip:d})]})]})})}const gt=(0,x().vU)({settingsModalTitle:{id:"universalSearch.jiraIngestion.settingsModalTitle",defaultMessage:"Jira is connected to Notion AI"},settingsModalPendingTitle:{id:"universalSearch.jiraIngestion.settingsModalTitle2",defaultMessage:"Jira is connecting to Notion AI"},settingModalConnectionIsPending:{id:"universalSearch.jiraIngestion.settingsModal.connectionIsPending",defaultMessage:"This can take up to 36h. You can cancel or modify your settings when the connection is complete."},tooltipText:{id:"universalSearch.jiraIngestion.settingsModal.tooltipText",defaultMessage:"You can cancel or modify your settings when the connection is complete. "},learnMoreText:{id:"universalSearch.integration.learnMore",defaultMessage:"Learn more"},editProjectsButton:{id:"universalSearch.jiraIngestion.settingsModal.editSyncControls",defaultMessage:"Edit Projects"},disconnectJira:{id:"universalSearch.jiraIngestion.settingsModal.disconnectJira",defaultMessage:"Disconnect"}});function pt(){const[e,t]=(0,o.useState)(!0),[n,a]=(0,o.useState)([]),[l,d]=(0,o.useState)(!1),[g,m]=(0,o.useState)(0),v=(0,s().Kw)(h().jiraAIConnectionStore),f=(0,s().VK)((()=>h().jiraAIConnectionStore.state.jiraSiteId),[]),_=(0,i().O7)(),j=(0,s().VK)((()=>{var e;return null===(e=u().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),b=(0,s().VK)((()=>h().jiraAIConnectionStore.state.analyticsFrom),[]),M=(0,s().VK)((()=>h().jiraAIConnectionStore.state.screenToShow),[]),T=(0,s().VK)((()=>h().jiraAIConnectionStore.state.jiraSyncState),[]),A=(0,s().VK)((()=>p().default.getConfigKey("jira_ai_ingestion_config","learnMoreUrl")),[]),D="completed"===T;(0,r().r5)((async()=>{if(!j||"settings_screen"!==M)return;if(!D)return void t(!1);t(!0);const[e,n]=await Promise.all([(0,c().getJiraAIConnectionStatusAction)({environment:_,spaceId:j}),(0,c().getJiraSyncControlAction)({environment:_,spaceId:j,jiraSiteId:f})]);e&&n&&(a(n.data.sampleProjects),m(n.data.totalConnectedProjects),d(n.data.isFutureProjectsSyncEnabled),t(!1))}),[j,_,M,f,D]);const H=e=>{(0,c().navigateToJiraUniversalScreen)({screenToShow:e,analyticsFrom:v.analyticsFrom,sessionId:v.sessionId})},U=function(e){return(0,y().yK)((t=>({wrapper:{width:400,padding:"0 24px",minHeight:e?428:void 0},settingsWrapper:{justifyContent:"center",gap:12},jiraDetailsContainer:{fontSize:S().JB.UIRegular.desktop,fontWeight:S().Ue.regular,color:t.text.secondary,gap:12,paddingBottom:12},projectNameContainer:{gap:2,color:t.text.primary},footer:{justifyContent:"center",alignItems:"center",width:"100%",gap:8},disconnectButton:{fontSize:S().JB.UIRegular.desktop,fontWeight:S().Ue.medium,width:"100%"},moreProjectsContainer:{padding:"4px 0px 4px 0px"},learnMoreSection:{padding:"24px 0"},learnMoreButton:{fontSize:S().JB.UIRegular.desktop,fontWeight:S().Ue.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:S().Ue.medium,fontSize:S().JB.UISmall.desktop,gap:5,justifyContent:"center",alignItems:"center",padding:"4px 8px 4px 8px",color:`${t.text.secondary}`},externalLinkIcon:{width:16,height:16},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:S().Ue.semibold,color:t.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:S().JB.UIRegular.desktop,fontWeight:S().Ue.regular,color:t.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:S().JB.UIRegular.desktop,fontWeight:S().Ue.regular,color:t.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:S().JB.UIRegular.desktop,fontWeight:S().Ue.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:S().JB.UIRegular.desktop,fontWeight:S().Ue.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},spinner:{paddingTop:20,justifyContent:"center",alignItems:"center"},projectItemWrapper:{width:"100%",padding:"2px 0px 2px 0px",alignItems:"center"},projectName:{fontSize:S().JB.UIRegular.desktop},projectIcon:{width:20,color:t.text.secondary},jiraIcon:{fill:t.blueColor,width:40,height:40},jiraIconSmall:{fill:t.blueColor,width:14,height:14}})),[e])}(e);return(0,B.jsx)(I().Z,{showCloseIcon:!0,open:"settings_screen"===M,onDismiss:()=>{(0,c().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:b,sessionId:v.sessionId}),a([]),m(0),d(!1)},render:()=>(0,B.jsxs)("div",{style:U.wrapper,children:[(0,B.jsx)(N,{integrationLogoIcon:()=>(0,Ye().k)(U.jiraIcon),title:D?(0,B.jsx)(x()._H,{...gt.settingsModalTitle}):(0,B.jsx)(x()._H,{...gt.settingsModalPendingTitle})}),e?(0,B.jsx)(w().gq,{style:U.spinner,children:(0,B.jsx)(K().Z,{})}):(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(w().gq,{style:U.settingsWrapper,children:(0,B.jsxs)(w().Ht,{style:U.jiraDetailsContainer,children:[(0,B.jsx)(w().Ht,{children:D?(0,B.jsx)(x()._H,{id:"universalSearch.jiraIngestion.settingsModal.canAnswerFrom",defaultMessage:"Notion AI is connected and can answer questions with content from {jiraCountMessage}{futureProjectsMessage}",values:{jiraCountMessage:g?`${g} Jira Projects`:"Jira Project",futureProjectsMessage:l?", including future projects.":"."}}):(0,B.jsx)(x()._H,{...gt.settingModalConnectionIsPending})}),D?(0,B.jsx)(w().Ht,{children:l&&(0,B.jsxs)(w().gq,{style:U.projectItemWrapper,children:[(0,B.jsx)(w().Ht,{style:U.projectIcon,children:(0,Ye().k)(U.jiraIconSmall)}),(0,B.jsx)(w().Ht,{style:U.projectName,children:(0,B.jsx)("div",{children:(0,B.jsx)(x()._H,{id:"universalSearch.jiraIngestion.settingsModal.includeCurrentAndFutureProjects",defaultMessage:"Includes current and future projects"})})})]})}):null,D&&n.map((e=>(0,B.jsx)("div",{children:(0,B.jsxs)(w().gq,{style:U.projectItemWrapper,children:[(0,B.jsx)(w().Ht,{style:U.projectIcon,children:(0,Ye().k)(U.jiraIconSmall)}),(0,B.jsx)(w().Ht,{style:U.projectName,children:e.name})]})},e.id))),D&&(0,B.jsx)(w().gq,{style:U.moreProjectsContainer,children:g-3>0?(0,B.jsx)(x()._H,{id:"universalSearch.jiraIngestion.settingsModal.moreProjects",defaultMessage:"... and {moreProjectCount} more",values:{moreProjectCount:g-3}}):(0,B.jsx)(B.Fragment,{})})]})}),(0,B.jsxs)(w().Ht,{style:U.footer,children:[D?(0,B.jsx)(mt,{styles:U.disconnectButton,isEditButtonEnabled:D,navigateToScreen:H}):(0,B.jsx)(Ge().Z,{allowHover:!0,textWrap:!0,renderTooltip:()=>(0,B.jsx)("div",{style:{width:240},children:(0,B.jsx)(x()._H,{...gt.tooltipText})}),render:e=>(0,B.jsx)(mt,{events:e,styles:U.disconnectButton,isEditButtonEnabled:D,navigateToScreen:()=>{}})}),D?(0,B.jsx)(ht,{styles:U.disconnectButton,isDisconnectButtonEnabled:D,navigateToScreen:H}):(0,B.jsx)(Ge().Z,{allowHover:!0,textWrap:!0,renderTooltip:()=>(0,B.jsx)("div",{style:{width:240},children:(0,B.jsx)(x()._H,{...gt.tooltipText})}),render:e=>(0,B.jsx)(ht,{events:e,styles:U.disconnectButton,isDisconnectButtonEnabled:D,navigateToScreen:H})})]}),(0,B.jsx)(w().gq,{style:U.learnMoreSection,children:(0,B.jsx)(C().Z,{style:U.learnMoreButton,onClick:()=>{(0,k().j)({environment:_,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_learn_more_url_click",integration_type:"jira",setup_session_id:v.sessionId,from:v.analyticsFrom}}}),window.open(A,"_blank")},children:(0,B.jsxs)(w().gq,{style:U.learnMoreText,children:[(0,B.jsx)(x()._H,{...gt.learnMoreText}),(0,ae().g)(U.externalLinkIcon)]})})})]})]})})}function mt(e){const{styles:t,events:n,isEditButtonEnabled:o,navigateToScreen:r}=e,a=(0,i().O7)(),c=(0,s().Kw)(h().jiraAIConnectionStore);return(0,B.jsx)(X().Z,{...n,style:t,disabled:!o,onClick:()=>{(0,k().j)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_edit_projects_button",integration_type:"jira",setup_session_id:c.sessionId,from:c.analyticsFrom}}}),r("select_projects")},children:(0,B.jsx)(x()._H,{...gt.editProjectsButton})})}function ht(e){const{styles:t,events:n,isDisconnectButtonEnabled:o,navigateToScreen:r}=e,a=(0,i().O7)(),c=(0,s().Kw)(h().jiraAIConnectionStore),l=(0,s().VK)((()=>{var e;return null===(e=u().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]);(0,s().VK)((()=>h().jiraAIConnectionStore.state.jiraSyncState),[]);return(0,B.jsx)(O().Z,{...n,isGray:!0,style:t,disabled:!o,onClick:()=>{l&&((0,k().j)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_disconnect_button",integration_type:"jira",setup_session_id:c.sessionId,from:c.analyticsFrom}}}),r("disconnect_screen"))},children:(0,B.jsx)(x()._H,{...gt.disconnectJira})})}var vt=()=>n(226726);const ft=(0,x().vU)({primedTextInput:{id:"aiConnectors.microsoftTeams.primedTextInput",defaultMessage:"Search for messages in Microsoft Teams"}});function _t(e){const{open:t}=e,n=(0,i().O7)(),s=(0,x().YB)(),r=(0,y().yK)((e=>({body:{alignItems:"center",color:e.text.secondary,fontSize:12},container:{padding:12},tryItButton:{marginTop:16}})),[]),a=(0,o.useCallback)((()=>{d().j.setState({...d().j.state,currentScreen:"none"}),ee().assistantMenuActions.openAssistantRightHandSideMenu({environment:n,from:"microsoft_teams_ai_connector_already_connected",primeTextInput:s.formatMessage(ft.primedTextInput)})}),[n,s]);return(0,B.jsx)(I().Z,{showCloseIcon:!0,onDismiss:()=>{d().j.reset()},open:t,render:()=>(0,B.jsxs)(w().Ht,{style:r.container,children:[(0,B.jsx)(N,{integrationLogoIcon:vt().W,title:(0,B.jsx)(x()._H,{id:"aiConnectors.microsoftTeams.alreadyConnected",defaultMessage:"Microsoft Teams is already connected to Notion AI"})}),(0,B.jsxs)(w().Ht,{gap:2,style:r.body,children:[(0,B.jsx)("div",{children:(0,B.jsx)(x()._H,{id:"aiConnectors.microsoftTeams.microsoftTeamsConnectedDescription",defaultMessage:"You're fully set up."})}),(0,B.jsx)("div",{children:(0,B.jsx)(x()._H,{id:"aiConnectors.microsoftTeams.tryIt",defaultMessage:"Try asking AI about your Microsoft Teams messages!"})})]}),(0,B.jsx)(X().Z,{style:r.tryItButton,onClick:a,children:(0,B.jsx)(x()._H,{id:"aiConnectors.microsoftTeams.tryAskingAQuestion",defaultMessage:"Try asking a question"})})]})})}const yt=(0,x().vU)({microsoftTeamsAIConnectorOauthPopupTitle:{defaultMessage:"Connect Microsoft Teams AI Connector",id:"microsoftTeamsAIConnector.oauthPopupTitle"}});function xt(){const e=(0,o.useMemo)((()=>G("microsoftTeams")),[]),t=(0,o.useMemo)((()=>R("microsoftTeams")),[]),n=(0,i().O7)(),[c,l]=(0,o.useState)("CLOSED"),g=(0,s().VK)((()=>{var e;return null===(e=u().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),p=(0,s().Kw)(d().j),m=(0,y().yK)((()=>({loadingWrapper:{padding:20,fontSize:12,fontWeight:S().Ue.regular,justifyContent:"center",gap:8,alignItems:"center"}})),[]),h=(0,q().J)(),v=(0,L().y)(),f=(0,o.useCallback)((()=>{const e="https://notion.so";(0,k().j)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_intro_modal",integration_type:"microsoft_teams",setup_session_id:d().j.state.sessionId,from:d().j.state.analyticsFrom}}}),n.device.isElectron?j().openExternalUrl(e):window.open(e,"_blank")}),[n]),_=(0,o.useCallback)((async()=>{if(!g)return;const e=await a().callApi({eventName:"getMicrosoftTeamsAIConnectorAuthorizationUrl",environment:n,data:{spaceId:g,isDesktop:n.device.isElectron,sessionId:d().j.state.sessionId}});if("success"!==e.type)return;const t=e.data.url;n.device.isElectron?j().openExternalUrl(t):P().M(n,{width:800,height:600,url:t,titleMessage:yt.microsoftTeamsAIConnectorOauthPopupTitle}),d().j.setState({...d().j.state,currentScreen:"connecting"})}),[g,n]),[C]=(0,r().r5)((async()=>{if(!g||"introduction"!==p.currentScreen)return;if(p.microsoftTenantId)return{isMicrosoftTeamsConnected:!0};const e=await a().callApi({eventName:"getMicrosoftTeamsAIConnectorStatus",environment:n,data:{spaceId:g}});return"success"===e.type?{isMicrosoftTeamsConnected:e.data.isConnected}:void 0}),[n,p.currentScreen,p.microsoftTenantId,g]);(0,o.useEffect)((()=>{"introduction"===p.currentScreen?"resolved"===C.status?l("OPEN"):l("LOADING"):l("CLOSED")}),[C.status,p.currentScreen]);const b=(0,o.useRef)(!1),M=(0,o.useCallback)((()=>{d().j.reset(),(0,k().j)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_microsoft_teams_intro_modal",integration_type:"microsoft_teams",setup_session_id:d().j.state.sessionId,from:d().j.state.analyticsFrom}}}),b.current=!1}),[n]),T=(0,o.useCallback)((async()=>{await _(),(0,k().j)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"microsoft_teams_ai_connector_auth_url_open",integration_type:"microsoft_teams",setup_session_id:d().j.state.sessionId,from:d().j.state.analyticsFrom}}}),d().j.setState({...d().j.state,currentScreen:"connecting"})}),[n,_]);return(0,o.useEffect)((()=>{g&&h&&"resolved"===C.status&&"introduction"===p.currentScreen&&(b.current||((0,k().j)({environment:n,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"microsoft_teams",setup_session_id:p.sessionId,from:p.analyticsFrom,is_space_admin:h,is_ai_eligible:v}}}),b.current=!0))}),[g,n,C.status,p.sessionId,p.analyticsFrom,h,v,p.currentScreen]),g&&"CLOSED"!==c?n.device.isMobile?(0,B.jsx)(Q,{logo:vt().W,appName:"Microsoft Teams",open:"introduction"===p.currentScreen,onClosed:()=>{d().j.reset()},learnMoreUrl:"https://notion.so"}):"LOADING"===c?(0,B.jsx)(I().Z,{open:"LOADING"===c,render:()=>(0,B.jsxs)(w().gq,{style:m.loadingWrapper,children:[(0,B.jsx)(x()._H,{id:"universalQna.microsoftTeams.isFetchingConnection",defaultMessage:"Getting connection status"}),(0,B.jsx)(K().Z,{})]})}):p.isConnected?(0,B.jsx)(_t,{open:!0}):h?(0,B.jsx)(Y,{onConnect:T,onDismiss:M,onLearnMore:f,title:e,integrationIcon:vt().W,notes:t,open:"OPEN"===c,titleWidth:210}):(0,B.jsx)("span",{}):(0,B.jsx)("span",{})}var St=()=>n(308186),jt=()=>n(435797);const Ct=(0,x().vU)({searchForAChannel:{id:"universalQnA.slack.searchForAChannel",defaultMessage:"Search for a Channel"}});function bt(){const[e,t]=o.useState(""),[n,r]=o.useState(!1),[c,l]=o.useState(!0),[d,g]=o.useState([]),m=(0,o.useRef)(!1),h=(0,i().O7)(),v=(0,s().VK)((()=>{var e;return null===(e=u().default.getState().currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),j=(0,s().Kw)(_().slackUniversalQnAConnectionStore),M=(0,o.useCallback)((()=>{const e=p().default.getConfigKey("ingestion","slack");window.open(null==e?void 0:e.learnMoreUrl,"_blank")}),[]),D=(0,s().VK)((()=>u().default.getState().currentUserStore),[]),H=(0,o.useCallback)((()=>{m.current=!1,r(!1),t(""),l(!0),g([])}),[]),U=(0,o.useCallback)((async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;try{const o=await a().callApi({eventName:"getSlackPublicChannels",environment:h,data:{spaceId:e,cursor:n}});if("success"===o.type){g((e=>(0,at().mN)([...e,...o.data.channels],(e=>e.id))));const t=o.data.cursor;_().slackUniversalQnAConnectionStore.state.isEditing&&(l(!1),_().slackUniversalQnAConnectionStore.setState({..._().slackUniversalQnAConnectionStore.state,isEditing:!1})),t?U(e,0,t):r(!0)}else{if(t>=10)return;setTimeout((()=>{U(e,t+1,n)}),3e4)}}catch{if(t>=10)return;setTimeout((()=>{U(e,t+1,n)}),3e4)}}),[h]),F=(0,o.useCallback)((async()=>{var e;if(_().slackUniversalQnAConnectionStore.setState({...j,currentScreen:"confirmation"}),H(),!v)return;await a().callApi({eventName:"ingestSlackPublicData",environment:h,data:{spaceId:v,selection:j.selection,setupSessionId:j.sessionId}});const t=f().Z.state.appsConnectionData.filter((e=>e.id!==Ce().aP));f().Z.setState({...f().Z.state,appsConnectionData:[...t,{connectionStatus:"in_progress",connectionLastEditedTimestamp:Date.now(),connectionType:"slack",connectorEmail:(null==D?void 0:D.getEmail())||"",id:Ce().aP,connectorNotionId:null==D||null===(e=D.getModel())||void 0===e?void 0:e.id}]}),(0,k().j)({environment:h,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"confirm_slack_public_data_ingestion",integration_type:"slack",setup_session_id:j.sessionId,from:j.analyticsFrom}}})}),[D,h,H,j,v]);(0,T().W)((async()=>{if(!v)return;if(!v||m.current||"data-selection"!==j.currentScreen)return;if(j.isEditing)return m.current=!0,void U(v);const e=await a().callApi({eventName:"getConnectedAppsForUniversalQna",environment:h,data:{spaceId:v,sessionId:j.sessionId},headers:(0,Se().Bb)({spaceId:v})});if("success"===e.type&&e.data.isError)_().slackUniversalQnAConnectionStore.setState({...j,currentScreen:"alreadyConnected"});else if("success"===e.type&&e.data.connectedApps.includes("slack-admin")){if(j.isSlackGridAiConnectorEnabled){const e=await a().callApi({eventName:"getUrlForGridSetup",environment:h,data:{spaceId:v}});return void("success"===e.type&&_().slackUniversalQnAConnectionStore.setState({...j,currentScreen:"confirmation",gridSetupUrl:e.data.url}))}l(!1),m.current=!0,U(v)}}),1e3,"data-selection"===j.currentScreen);const W=function(e,t){return(0,y().yK)((n=>({wrapper:{width:400,display:"flex",flexDirection:"column",minHeight:e?void 0:530},logoSection:{padding:"20px 20px 9px 20px",gap:8,justifyContent:"center",alignItems:"center",height:84},logos:{width:40,height:40},arrowLogo:{width:20,height:20,color:n.icon.secondary},titleWrapper:{width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center"},title:{fontSize:17,fontWeight:S().Ue.medium,lineHeight:"22px",marginBottom:"9px"},subtext:{fontSize:12,lineHeight:"14.52px",color:n.text.secondary},footer:{position:"absolute",width:"100%",justifySelf:"flex-end",boxShadow:"0px 9px 24px 0px #0F0F0F33",padding:"16px 20px 16px 20px",gap:12,bottom:0},connectButton:{fontSize:14,fontWeight:S().Ue.semibold,width:360},searchBarWrapper:{justifyContent:"center"},searchBar:{width:360,padding:4},selectionContainer:{marginTop:18,marginBottom:e?24:0,width:"100%",height:"100%",justifyContent:"center",padding:"0px 20px 0px"},selection:{width:"100%"},waitingForConnection:{fontSize:12,lineHeight:"16px",color:n.text.secondary},waitingForConnectionWrapper:{gap:4},tryAgainWrapper:{marginTop:16,gap:4},tryAgainSection:{gap:4,alignItems:"center",marginBottom:16,color:n.text.secondary},tryAgainText:{fontSize:14},channelItem:{gap:4,alignItems:"center"},channelsText:{fontSize:12,lineHeight:"16px"},divider:{marginTop:5,marginBottom:5},alertIcon:{width:16,height:16},tryAgainButton:{fontSize:12,width:80},futureChannelsCheckboxWrapper:{gap:4,visibility:e?"hidden":"visible"},loadingChannelsWrapper:{alignItems:"center",gap:8,fontSize:12,color:n.text.secondary,marginTop:8},selectionWrapper:{overflowY:"scroll",maxHeight:t?170:124},loadMoreButtonWrapper:{fontSize:12,paddingTop:8,paddingBottom:4},loadMoreButtonhoveredStyle:{background:"none"},channelItemWrapper:{marginTop:12},workspaceAdministratorHeading:{fontSize:14,fontWeight:S().Ue.regular,color:n.text.primary},orderedList:{paddingLeft:18,fontSize:14,fontWeight:S().Ue.regular,color:n.text.secondary},waitingForConnectionNote:{paddingBottom:4},note:{fontWeight:S().Ue.regular,fontSize:14,lineHeight:"18px",width:330,marginLeft:8},noteHeading:{fontWeight:S().Ue.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:S().Ue.regular,color:n.text.secondary,fontSize:14,lineHeight:"18px"},learnMoreButton:{gap:4,alignItems:"center",fontSize:14,color:n.text.secondary,justifyContent:"center"},buttonContainer:{justifyContent:"center"},link:{color:n.text.secondary,textDecoration:"underline",cursor:"pointer"},loadingChannels:{color:n.text.secondary},loadingWrapper:{alignItems:"center",gap:4}})),[e,t])}(c,n),P=(0,o.useCallback)((e=>{const{selection:t}=j;return t.allSelected?!t.excludedChannels.includes(e):!!t.selectedChannels.includes(e)}),[j]),q=(0,o.useCallback)((()=>{const{selection:e}=j;return e.allSelected?!(e.excludedChannels.length>0)||"partial":e.selectedChannels.length>0&&"partial"}),[j]),L=(0,o.useCallback)((()=>{const{selection:e}=j;return!!e.allSelected||(!!e.joinFutureChannels||e.selectedChannels.length>0)}),[j]),z=(0,o.useCallback)((()=>[(0,B.jsxs)(w().Ht,{style:{gap:4},children:[(0,B.jsx)("div",{style:W.noteHeading,children:(0,B.jsx)(x()._H,{id:"universalSearch.slack.waitingForConnectionNoteHeading1",defaultMessage:"Slack should open automatically on a new tab."},"note1-1")}),(0,B.jsx)("div",{style:W.noteBody,children:(0,B.jsx)(x()._H,{id:"universalSearch.slack.waitingForConnectionNoteBody1",defaultMessage:"If it doesn't, {ClickHereToRetry}",values:{ClickHereToRetry:(0,B.jsx)("a",{style:W.link,href:j.authUrl,target:"_blank",children:(0,B.jsx)(x()._H,{id:"universalSearch.slack.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,B.jsxs)(w().Ht,{style:{gap:4},children:[(0,B.jsx)("div",{style:W.noteHeading,children:j.isSlackGridAiConnectorEnabled?(0,B.jsx)(x()._H,{id:"universalSearch.slack.grid.workspaceOrAdminHeading",defaultMessage:"If you are a Slack organization owner or administrator:"},"gridNote2-2"):(0,B.jsx)(x()._H,{id:"universalSearch.slack.workspaceAdminHeading",defaultMessage:"If you are a Slack workspace administrator:"},"note2-2")}),(0,B.jsx)("div",{style:W.noteBody,children:(0,B.jsx)(x()._H,{id:"universalSearch.slack.workspaceAdminBody",defaultMessage:"Follow Slack’s instructions to connect. Return to this window, and the process will continue automatically."},"note2-3")}),(0,B.jsxs)(w().Ht,{style:{marginTop:16,gap:4},children:[(0,B.jsx)("div",{style:W.noteHeading,children:(0,B.jsx)(x()._H,{id:"universalSearch.slack.notWorkspaceAdminHeading",defaultMessage:"If you are not authorized to install external apps:"},"note2-4")}),(0,B.jsx)("div",{style:W.noteBody,children:(0,B.jsx)(x()._H,{id:"universalSearch.slack.notWorkspaceAdminBody",defaultMessage:"Follow the instructions to request access to the connection. Then, revisit the connect menu to continue setup."},"note2-5")})]})]},"note-2")]),[j,W]),Z=(0,o.useCallback)((()=>j.isEditing?(0,B.jsxs)(w().gq,{style:W.loadingWrapper,children:[(0,B.jsx)(K().Z,{}),(0,B.jsx)("div",{style:W.loadingChannels,children:(0,B.jsx)(x()._H,{defaultMessage:"Loading channels",id:"slackChannelSelection.isLoadingChannels"})})]}):c?(0,B.jsxs)(w().Ht,{style:W.waitingForConnectionWrapper,children:[z().map(((e,t)=>(0,B.jsxs)(w().gq,{gap:8,style:{marginTop:4,marginBottom:6},children:[(0,B.jsx)(b().Z,{number:t+1}),(0,B.jsx)("div",{style:W.note,children:e})]},t))),(0,B.jsx)(w().gq,{style:W.buttonContainer,children:(0,B.jsx)(C().Z,{style:{marginTop:16,width:120,borderRadius:6},onClick:M,children:(0,B.jsxs)(w().gq,{style:W.learnMoreButton,children:[(0,B.jsx)(x()._H,{id:"universalSearch.slack.waitingForConnection.learnMore",defaultMessage:"Learn More"}),(0,A().K)({width:16,height:16})]})})})]}):(0,B.jsxs)(w().Ht,{children:[(0,B.jsxs)(w().gq,{style:W.channelItem,children:[(0,B.jsx)(Ie().Z,{checked:q(),checkSize:10,size:14,onClick:()=>{(0,k().j)({environment:h,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:j.selection.allSelected?"all_channels_deselected":"all_channels_selected",integration_type:"slack",setup_session_id:j.sessionId,from:j.analyticsFrom}}}),_().slackUniversalQnAConnectionStore.setState({...j,selection:{...j.selection,allSelected:!j.selection.allSelected,selectedChannels:[],excludedChannels:[]}})}}),(0,B.jsx)("div",{style:W.channelsText,children:(0,B.jsx)(x()._H,{id:"universalSearch.integration.slackIngestion.allPublicChannels",defaultMessage:"All public channels"})})]}),(0,B.jsx)(we().Z,{style:W.divider,size:4}),(0,B.jsxs)(B.Fragment,{children:[n?(0,B.jsx)(B.Fragment,{}):(0,B.jsxs)(w().gq,{style:W.loadingChannelsWrapper,children:[(0,B.jsx)(K().Z,{}),(0,B.jsxs)(w().Ht,{children:[(0,B.jsx)("div",{children:(0,B.jsx)(x()._H,{id:"universalSearch.integration.slackIngestion.loadedXChannels",defaultMessage:"{channelsCount} channels loaded...",values:{channelsCount:d.length}})}),(0,B.jsx)("div",{children:(0,B.jsx)(x()._H,{id:"universalSearch.integration.slackIngestion.loading1000PerMinute",defaultMessage:"This can take one minute per every 1,000 public channels."})})]})]}),(0,B.jsx)(w().Ht,{style:W.selectionWrapper,children:(e?d.filter((t=>t.name.includes(e))):d).map((e=>(0,B.jsxs)(w().gq,{gap:8,style:W.channelItemWrapper,children:[(0,B.jsx)(Ie().Z,{checked:P(e.id),onClick:()=>{const{selection:t}=j;(0,k().j)({environment:h,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:P(e.id)?"specific_channel_deselected":"specific_channel_selected",integration_type:"slack",setup_session_id:j.sessionId,from:j.analyticsFrom}}}),t.allSelected?t.excludedChannels.includes(e.id)?_().slackUniversalQnAConnectionStore.setState({...j,selection:{...t,excludedChannels:t.excludedChannels.filter((t=>t!==e.id))}}):_().slackUniversalQnAConnectionStore.setState({...j,selection:{...t,excludedChannels:t.excludedChannels.concat(e.id)}}):_().slackUniversalQnAConnectionStore.setState({...j,selection:{...t,allSelected:!1,selectedChannels:t.selectedChannels.includes(e.id)?t.selectedChannels.filter((t=>t!==e.id)):t.selectedChannels.concat(e.id),excludedChannels:[]}})},checkSize:10,size:14},`${e.id}-checkbox`),(0,B.jsx)("div",{style:W.channelsText,children:`# ${e.name}`},`${e.id}-label`)]},e.id)))})]})]})),[j,c,W,q,e,d,n,z,M,h,P]);return(0,B.jsx)(I().Z,{showCloseIcon:!0,onDismiss:async()=>{const{accept:e}=await St().gt({message:(0,B.jsx)(x()._H,{id:"universalQna.slackChannelSelection.closeConfirm",defaultMessage:"Are you sure you want to dismiss? You will lose all the progress you made."}),acceptLabel:(0,B.jsx)(x()._H,{id:"universalQna.slackChannelSelection.dismiss",defaultMessage:"Dismiss"})});e&&(_().slackUniversalQnAConnectionStore.reset(),H(),(0,k().j)({environment:h,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_slack_data_selection",integration_type:"slack",setup_session_id:j.sessionId,from:j.analyticsFrom}}}))},open:"data-selection"===j.currentScreen,render:()=>(0,B.jsxs)("div",{style:W.wrapper,children:[(0,B.jsx)(N,{integrationLogoIcon:jt().P,title:!c||j.isEditing?(0,B.jsx)(x()._H,{id:"universalQnA.slack.channelSelectionScreenTitle",defaultMessage:"Select channels to connect"}):(0,B.jsx)(x()._H,{id:"universalQnA.slack.channelSelectionWaitingScreenTitle",defaultMessage:"Follow instructions from Slack in your browser"}),subtext:!c||j.isEditing?(0,B.jsx)(x()._H,{id:"universalQnA.slack.channelSelectionScreenSubtext",defaultMessage:"Connecting more Slack channels will give you more relevant and useful Notion AI responses"}):(0,B.jsx)(B.Fragment,{})}),c?(0,B.jsx)(B.Fragment,{}):(0,B.jsx)(ke().Z,{capture:!0,allowEsc:!0,render:()=>(0,B.jsx)(Ge().Z,{textWrap:!0,placement:lt().Placement.Top,render:n=>(0,B.jsx)("div",{...n,children:(0,B.jsx)(w().gq,{...n,style:W.searchBarWrapper,children:(0,B.jsx)(ct().Z,{id:"slackUniversalQnASearchBar",style:W.searchBar,placeholder:re().Z.formatMessage(Ct.searchForAChannel),value:e,onChange:e=>{t(e.target.value),(0,k().j)({environment:h,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"filter_slack_channels",integration_type:"slack",setup_session_id:j.sessionId,from:j.analyticsFrom}}})}},"slackUniversalQnASearchBar")})}),renderTooltip:()=>(0,B.jsx)("div",{style:{width:250},children:(0,B.jsx)(x()._H,{id:"universalSearch.slack.searchBarTooltip",defaultMessage:"All channels may not have been searched. Full search will be available once all channels are loaded."})}),disableTooltip:n})}),(0,B.jsx)(w().gq,{style:W.selectionContainer,children:(0,B.jsx)(w().Ht,{style:W.selection,children:Z()})}),!c&&(0,B.jsxs)(w().Ht,{style:W.footer,children:[(0,B.jsxs)(w().gq,{style:W.futureChannelsCheckboxWrapper,children:[(0,B.jsx)(Ie().Z,{checked:j.selection.joinFutureChannels,checkSize:10,size:14,onClick:()=>{(0,k().j)({environment:h,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:j.selection.joinFutureChannels?"dont_join_future_channels":"join_future_channels",integration_type:"slack",setup_session_id:j.sessionId,from:j.analyticsFrom}}}),_().slackUniversalQnAConnectionStore.setState({...j,selection:{...j.selection,joinFutureChannels:!j.selection.joinFutureChannels}})}}),(0,B.jsx)("div",{style:W.channelsText,children:(0,B.jsx)(x()._H,{id:"universalSearch.integration.slackIngestion.allFuturePublicChannels",defaultMessage:"Add public channels created in future"})})]}),(0,B.jsx)(O().Z,{style:W.connectButton,onClick:F,disabled:!L(),children:(0,B.jsx)(x()._H,{id:"universalSearch.integration.connect",defaultMessage:"Connect"})})]})]})})}const It=function(){const e=(0,i().O7)(),t=(0,s().Kw)(_().slackUniversalQnAConnectionStore),n=(0,y().yK)((e=>({wrapper:{width:400},logoSection:{paddingTop:"40px",paddingBottom:"16px",gap:8,justifyContent:"center",alignItems:"center"},logos:{width:40,height:40},arrowLogo:{width:20,height:20,color:e.icon.secondary},titleWrapper:{width:"100%",justifyContent:"center",textAlign:"center"},title:{fontSize:17,fontWeight:S().Ue.medium,lineHeight:"22px",marginBottom:"24px"},nextStepsWrapper:{width:"100%",justifyContent:"center"},nextStepsContainer:{padding:"16px 24px",width:"100%",font:S().Gl.sans},nextStepsHeading:{fontWeight:S().Ue.semibold,fontSize:14,lineHeight:"18px",marginBottom:"14px"},note:{fontWeight:S().Ue.regular,fontSize:14,lineHeight:"18px",marginLeft:"8px"},notes:{marginLeft:"8px",marginTop:"6px",alignItems:"center",gap:10,font:S().Gl.sans,listStylePosition:"outside",paddingLeft:"16px"},footer:{justifyContent:"center",alignItems:"center",bottom:0,width:"100%",padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:S().Ue.medium,width:"100%"},goBackButton:{fontSize:14,fontWeight:S().Ue.medium,width:"100%"},learnMoreText:{fontWeight:S().Ue.medium,fontSize:12,gap:5,justifyContent:"center",alignItems:"center",padding:"4px 8px 4px 8px",color:`${e.text.secondary}`},externalLinkIcon:{width:16,height:16},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"}})),[]),r=(0,o.useCallback)((()=>{if(t.isSlackGridAiConnectorEnabled)return[(0,B.jsx)(x()._H,{id:"universalSearch.slack.grid.confirmModalNote1",defaultMessage:"Select your workspaces on your Slack Admin Dashboard"},"gridNote1"),(0,B.jsx)(x()._H,{id:"universalSearch.slack.grid.confirmModalNote2",defaultMessage:"Notion AI will connect to your channels. This can take up to 36 hours."},"gridNote2"),(0,B.jsx)(x()._H,{id:"universalSearch.slack.grid.confirmModalNote3",defaultMessage:" Notion AI will be ready to answer questions across Notion and Slack Grid."},"gridNote3")];return[(0,B.jsx)(x()._H,{id:"universalSearch.slack.confirmModalNote1",defaultMessage:"Notion AI will join all public channels in Slack"},"note1"),(0,B.jsx)(x()._H,{id:"universalSearch.slack.confirmModalNote2",defaultMessage:"Connecting your channels may take up to 36 hours."},"note2"),(0,B.jsx)(x()._H,{id:"universalSearch.slack.confirmModalNote3",defaultMessage:"Notion AI will be ready to answer questions across Notion and Slack knowledge."},"note3")]}),[t.isSlackGridAiConnectorEnabled]),a=(0,o.useCallback)((()=>{_().slackUniversalQnAConnectionStore.setState({...t,isPublicSync:!0,inProgress:!0,currentScreen:"none",ingestionProgress:1}),se().oV({label:(0,B.jsx)(x()._H,{id:"slackIngestionConfirmModal.ingestion.acknowledge",defaultMessage:"Started syncing from Slack. This can take up to 36 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,B.jsx)(C().Z,{onClick:se().rN,children:(0,B.jsx)(x()._H,{id:"slackIngestionConfirmModal.ingestion.startedMessageDismiss",defaultMessage:"Close"})})})}),[t]),c=(0,o.useCallback)((()=>{const n=t.gridSetupUrl;n&&((0,k().j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"slack_grid_select_workspaces_clicked",integration_type:"slack",setup_session_id:t.sessionId,from:t.analyticsFrom}}}),e.device.isElectron?j().openExternalUrl(n):window.open(n,"_blank"))}),[e,t.analyticsFrom,t.gridSetupUrl,t.sessionId]);return(0,B.jsx)(I().Z,{showCloseIcon:!0,onDismiss:()=>{_().slackUniversalQnAConnectionStore.reset(),(0,k().j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"slack_got_it_modal_dismissed",integration_type:"slack",setup_session_id:t.sessionId,from:t.analyticsFrom}}})},open:"confirmation"===t.currentScreen,render:()=>(0,B.jsxs)("div",{style:n.wrapper,children:[(0,B.jsx)(N,{integrationLogoIcon:jt().P,title:t.isSlackGridAiConnectorEnabled?(0,B.jsx)(x()._H,{id:"universalSearch.slack.heresWhatToDoNext",defaultMessage:"Here's what to do next"}):(0,B.jsx)(x()._H,{id:"universalSearch.slack.confirmModalTitle",defaultMessage:"We're getting you set up"})}),(0,B.jsx)(w().gq,{style:n.nextStepsWrapper,children:(0,B.jsxs)("div",{style:n.nextStepsContainer,children:[(0,B.jsx)(w().gq,{style:{alignItems:"center"},children:(0,B.jsx)("div",{style:n.nextStepsHeading,children:t.isSlackGridAiConnectorEnabled?(0,B.jsx)(B.Fragment,{}):(0,B.jsx)(x()._H,{id:"universalSearch.confirm.whatHappensNext",defaultMessage:"What happens next"})})}),(0,B.jsx)(w().Ht,{gap:8,children:r().map(((e,t)=>(0,B.jsxs)(w().gq,{gap:8,style:{marginBottom:6},children:[(0,B.jsx)(b().Z,{number:t+1}),(0,B.jsx)("div",{style:n.note,children:e})]},t)))})]})}),(0,B.jsx)(w().Ht,{style:n.footer,children:t.isSlackGridAiConnectorEnabled?(0,B.jsx)(O().Z,{style:n.connectButton,onClick:c,children:(0,B.jsx)(x()._H,{id:"universalSearch.integration.girdConfirmIngestion",defaultMessage:"Select Slack workspaces"})}):(0,B.jsx)(O().Z,{style:n.connectButton,onClick:a,children:(0,B.jsx)(x()._H,{id:"universalSearch.integration.confirmIngestion",defaultMessage:"Got it"})})})]})})};const wt=function(){const e=(0,s().Kw)(_().slackUniversalQnAConnectionStore),[t,n]=(0,o.useState)(!1),c=(0,i().O7)(),l=(0,s().VK)((()=>{var e;return null===(e=u().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),[d,g]=(0,o.useState)(!1),[m,h]=(0,o.useState)(!0),[v,b]=(0,o.useState)([]),[M,T]=(0,o.useState)(!1);(0,r().r5)((async()=>{if(!l||"settings"!==e.currentScreen)return;h(!0);const t=await a().callApi({eventName:"getIngestedSlackChannels",environment:c,data:{spaceId:l}});"success"===t.type&&(h(!1),b(t.data.channels))}),[c,e.currentScreen,l]);const A=(0,o.useCallback)((()=>{const e=p().default.getConfigKey("ingestion","slack"),t=null==e?void 0:e.learnMoreUrl;t&&window.open(t,"_blank")}),[]),D=(0,o.useCallback)((()=>{_().slackUniversalQnAConnectionStore.reset()}),[]),H=(0,o.useCallback)((()=>{n(!1)}),[]),U=(0,o.useCallback)((async()=>{if(!l)return;g(!0);if("success"===(await a().callApi({eventName:"disconnectSlackIngestion",environment:c,data:{spaceId:l,disconnectForWorkspace:!0,disconnectReason:"admin_disconnect"}})).type){var e;_().slackUniversalQnAConnectionStore.setState({..._().slackUniversalQnAConnectionStore.state,isDisconnecting:!0});const t=f().Z.state.appsConnectionData.filter((e=>e.id!==Ce().aP)),o=u().default.state.currentUserStore;f().Z.setState({...f().Z.state,appsConnectionData:[...t,{connectionStatus:"disconnecting",connectionLastEditedTimestamp:Date.now(),connectionType:"slack",connectorEmail:(null==o?void 0:o.getEmail())||"",id:Ce().aP,connectorNotionId:null==o||null===(e=o.getModel())||void 0===e?void 0:e.id}]}),se().oV({label:(0,B.jsx)(x()._H,{id:"slackIngestionConfirmModal.ingestion.acknowledgeDisconnect",defaultMessage:"Started disconnecting Slack. This can take up to 3 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,B.jsx)(C().Z,{onClick:se().rN,children:(0,B.jsx)(x()._H,{id:"slackIngestionConfirmModal.ingestion.dismissAcknowledgeDisconnect",defaultMessage:"Close"})})}),n(!1),_().slackUniversalQnAConnectionStore.reset()}else g(!1),se().oV({label:(0,B.jsx)(x()._H,{id:"slackIngestionConfirmModal.ingestion.disconnectError",defaultMessage:"Failed to disconnect Slack. Please try again later."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,B.jsx)(C().Z,{onClick:se().rN,children:(0,B.jsx)(x()._H,{id:"slackIngestionConfirmModal.ingestion.closeSnackbarError",defaultMessage:"Close"})})})}),[c,l]),F=(0,y().yK)((e=>({wrapper:{width:400},channelDetailsContainer:{width:352,fontSize:14,fontWeight:S().Ue.regular,color:e.text.secondary},channelDetailsSubtitle:{textAlign:"center",marginBottom:"16px"},channelDetailsWrapper:{justifyContent:"center",paddingTop:"12px",paddingBottom:"12px"},channelNamesContainer:{gap:2,color:e.text.primary},footer:{justifyContent:"center",alignItems:"center",width:"100%",padding:"20px 20px 20px 20px",gap:8},disconnectButton:{fontSize:14,fontWeight:S().Ue.medium,width:"100%"},moreChannelsContainer:{paddingTop:8},learnMoreButton:{fontSize:14,fontWeight:S().Ue.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:S().Ue.medium,fontSize:12,gap:5,justifyContent:"center",alignItems:"center",padding:"4px 8px 4px 8px",color:`${e.text.secondary}`},externalLinkIcon:{width:16,height:16},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:S().Ue.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:S().Ue.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:S().Ue.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:S().Ue.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:14,fontWeight:S().Ue.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},spinner:{paddingTop:20,paddingBottom:40,justifyContent:"center",alignItems:"center"},editChannelsButton:{fontSize:14,fontWeight:S().Ue.medium,width:"100%"}})),[]);return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(I().Z,{showCloseIcon:!0,onDismiss:H,open:t,render:()=>(0,B.jsx)("div",{style:F.confirmWrapper,children:(0,B.jsxs)("div",{style:F.confirmContainer,children:[(0,B.jsx)("div",{style:F.confirmModalTitle,children:(0,B.jsx)(x()._H,{id:"slackIngestionSettings.confirmation.title",defaultMessage:"Are your sure?"})}),(0,B.jsx)("div",{style:F.confirmModalSubTitle,children:(0,B.jsx)(x()._H,{id:"slackIngestionSettings.confirmation.subTitle",defaultMessage:"Your Slack data will be permanently deleted from Notion."})}),(0,B.jsx)("div",{style:F.confirmModalDescription,children:(0,B.jsx)(x()._H,{id:"slackIngestionSettings.confirmation.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."})}),(0,B.jsxs)(w().Ht,{style:F.confirmModalActionButtons,children:[(0,B.jsx)(O().Z,{isRed:!0,style:F.confirmDisconnectButton,disabled:d,onClick:U,children:(0,B.jsx)(x()._H,{id:"slackIngestion.confirmDisconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"})}),(0,B.jsx)(C().Z,{style:F.goBackButton,onClick:H,children:(0,B.jsx)(x()._H,{id:"slackIngestion.confirmDisconnectModal.goBack",defaultMessage:"Go back"})})]})]})})}),(0,B.jsx)(I().Z,{showCloseIcon:!0,onDismiss:D,open:"settings"===e.currentScreen,render:()=>(0,B.jsxs)("div",{style:F.wrapper,children:[(0,B.jsx)(N,{integrationLogoIcon:jt().P,title:(0,B.jsx)(x()._H,{id:"universalSearch.slack.settingsModalTitle",defaultMessage:"Slack is connected to Notion AI"}),subtext:m||e.isSlackGridAiConnectorEnabled?void 0:(0,B.jsx)(x()._H,{id:"universalSearch.slackIngestion.settingsModal.canAnswerFrom",defaultMessage:"Notion AI can answer questions about {channelsCount} public channels in Slack.",values:{channelsCount:v.length}})}),m?(0,B.jsx)(w().gq,{style:F.spinner,children:(0,B.jsx)(K().Z,{})}):(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(w().gq,{style:F.channelDetailsWrapper,children:e.isSlackGridAiConnectorEnabled?(0,B.jsx)(w().Ht,{style:F.channelDetailsContainer,children:(0,B.jsx)(x()._H,{id:"slackSettings.grid.note",defaultMessage:"This Notion workspace is connected to Slack Enterprise Grid. Settings can be only configured in the Slack Admin Dashboard."})}):(0,B.jsxs)(w().Ht,{style:F.channelDetailsContainer,children:[(0,B.jsx)(w().Ht,{style:F.channelNamesContainer,children:v.slice(0,4).map((e=>(0,B.jsx)("div",{children:`# ${e}`},e)))}),v.length-4>0?(0,B.jsx)(w().gq,{style:F.moreChannelsContainer,children:(0,B.jsx)(x()._H,{id:"universalSearch.slackIngestion.settingsModal.moreChannels",defaultMessage:"{moreChannelsCount} more",values:{moreChannelsCount:v.length-4}})}):(0,B.jsx)(B.Fragment,{})]})}),(0,B.jsxs)(w().Ht,{style:F.footer,children:[(0,B.jsx)(X().Z,{disabled:M,style:F.editChannelsButton,onClick:async()=>{if(!l)return;if(e.isSlackGridAiConnectorEnabled){T(!0);const e=await a().callApi({eventName:"getUrlForGridSetup",environment:c,data:{spaceId:l}});return"success"===e.type&&(c.device.isElectron?j().openExternalUrl(e.data.url):window.open(e.data.url,"_blank")),void T(!1)}T(!0);const t=await a().callApi({eventName:"getIngestionOptions",environment:c,data:{spaceId:l}});"success"===t.type&&((0,k().j)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_channels",integration_type:"slack",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),_().slackUniversalQnAConnectionStore.setState({...e,currentScreen:"data-selection",selection:{allSelected:t.data.selection.allSelected,selectedChannels:t.data.selection.selectedChannels,excludedChannels:t.data.selection.excludedChannels,joinFutureChannels:t.data.selection.joinFutureChannels},isEditing:!0})),T(!1)},children:M?(0,B.jsxs)(w().gq,{style:{alignItems:"center",gap:4,fontWeight:S().Ue.regular},children:[(0,B.jsx)(K().Z,{}),(0,B.jsx)(x()._H,{id:"slackUniversalSearch.integration.loadingPreviousSelection",defaultMessage:"Loading previous selection"})]}):e.isSlackGridAiConnectorEnabled?(0,B.jsx)(x()._H,{id:"slackUniversalSearch.integration.editTeams",defaultMessage:"Edit settings"}):(0,B.jsx)(x()._H,{id:"slackUniversalSearch.integration.editChannels",defaultMessage:"Edit channels"})}),(0,B.jsx)(O().Z,{isGray:!0,style:F.disconnectButton,onClick:()=>{n(!0)},children:(0,B.jsx)(x()._H,{id:"slackUniversalSearch.integration.disconnectSlack",defaultMessage:"Disconnect"})}),(0,B.jsx)(C().Z,{style:F.learnMoreButton,onClick:A,children:(0,B.jsxs)(w().gq,{style:F.learnMoreText,children:[(0,B.jsx)(x()._H,{id:"universalSearch.integration.learnMore",defaultMessage:"Learn more"}),(0,ae().g)(F.externalLinkIcon)]})})]})]})]})})]})};var kt=()=>n(345918);function Mt(e){const{open:t}=e,n=(0,y().yK)((()=>({loadingWrapper:{padding:20,fontSize:S().JB.UISmall.desktop,fontWeight:S().Ue.regular,justifyContent:"center",gap:8,alignItems:"center"}})),[]);return(0,B.jsx)(I().Z,{showCloseIcon:!0,open:t,render:()=>(0,B.jsxs)(w().gq,{style:n.loadingWrapper,children:[(0,B.jsx)(x()._H,{id:"aiConnectors.common.isFetchingConnection",defaultMessage:"Getting connection status"}),(0,B.jsx)(K().Z,{})]})})}var Tt=()=>n(295425);function At(e){const{open:t}=e,n=(0,i().O7)(),s=(0,x().YB)(),r=(0,y().yK)((e=>({body:{alignItems:"center",color:e.text.secondary,fontSize:12},container:{padding:12},tryItButton:{marginTop:16}})),[]),a=(0,o.useCallback)((()=>{_().slackUniversalQnAConnectionStore.setState({..._().slackUniversalQnAConnectionStore.state,currentScreen:"none"}),ee().assistantMenuActions.openAssistantRightHandSideMenu({environment:n,from:"slack_already_connected",primeTextInput:s.formatMessage(Tt().tR.primedTextInput)})}),[n,s]);return(0,B.jsx)(I().Z,{showCloseIcon:!0,onDismiss:()=>{_().slackUniversalQnAConnectionStore.reset()},open:t,render:()=>(0,B.jsxs)(w().Ht,{style:r.container,children:[(0,B.jsx)(N,{integrationLogoIcon:jt().P,title:(0,B.jsx)(x()._H,{id:"universalQna.slack.alreadyConnected",defaultMessage:"Slack is already connected to Notion AI"})}),(0,B.jsxs)(w().Ht,{gap:2,style:r.body,children:[(0,B.jsx)("div",{children:(0,B.jsx)(x()._H,{id:"universalQna.slack.slackConnectedDescription",defaultMessage:"You're fully set up."})}),(0,B.jsx)("div",{children:(0,B.jsx)(x()._H,{id:"universalQna.slack.tryIt",defaultMessage:"Try asking AI about public Slack conversations!"})})]}),(0,B.jsx)(X().Z,{style:r.tryItButton,onClick:a,children:(0,B.jsx)(x()._H,{id:"universalQna.slack.tryAskingAQuestion",defaultMessage:"Try asking a question"})})]})})}const Dt=(0,x().vU)({slackUniversalSearchOauthPopupTitle:{id:"universalSearch.slack.slackOauthPopupTitle",defaultMessage:"Authenticate Slack"}});function Ht(){var e;const t=(0,o.useMemo)((()=>G("slack")),[]),n=(0,o.useMemo)((()=>R("slack")),[]),c=(0,o.useMemo)((()=>E("slack")),[]),l=(0,i().O7)(),d=(0,L().y)(),m=(0,s().VK)((()=>g().KR.state.isAiEnabled()),[]),h=(0,s().VK)((()=>u().default.state.currentSpaceStore),[]),v=(0,s().VK)((()=>{var e;return null===(e=u().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),f=(0,s().Kw)(_().slackUniversalQnAConnectionStore),y=(0,s().VK)((()=>p().default.getConfigKey("ingestion","slack").learnMoreUrl),[]),[x]=(0,r().r5)((async()=>{if(!v||"introduction"!==f.currentScreen)return;const e=await a().callApi({eventName:"getConnectedAppsForUniversalQna",environment:l,data:{spaceId:v},headers:(0,Se().Bb)({spaceId:v})});return"success"===e.type?{isPublicConnected:e.data.connectedApps.includes("slack-admin")}:void 0}),[l,f.currentScreen,v]),S=(0,s().VK)((()=>h&&(0,kt().j9)(h)),[h]),C=(0,q().J)(),b=!h||!v||(null===(e=x.value)||void 0===e?void 0:e.isPublicConnected)||!m||!S,I="resolved"===x.status&&"introduction"===f.currentScreen,w=C?"proceed_to_slack_data_selection":"contact_workspace_owners";(0,o.useEffect)((()=>{!b&&I&&(C?(0,k().j)({environment:l,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"slack",setup_session_id:f.sessionId,from:f.analyticsFrom,is_space_admin:C,is_ai_eligible:d}}}):(0,k().j)({environment:l,event:{eventName:"universal_qna_request_modal_open",eventProperties:{integration_type:"slack",from:f.analyticsFrom,is_ai_eligible:d}}}))}),[l,b,f.sessionId,f.analyticsFrom,I,C,d]);const M=(0,o.useCallback)((()=>{_().slackUniversalQnAConnectionStore.reset(),(0,k().j)({environment:l,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_slack_intro_modal",integration_type:"slack",setup_session_id:f.sessionId,from:f.analyticsFrom}}})}),[l,f]);if(!v)return(0,B.jsx)(B.Fragment,{});if(!l.device.isMobile&&b){var T;const e=Boolean(null===(T=x.value)||void 0===T?void 0:T.isPublicConnected);return e?(0,B.jsx)(At,{open:I&&e}):(0,B.jsx)(B.Fragment,{})}return l.device.isMobile?(0,B.jsx)(Q,{logo:jt().P,appName:"Slack",open:"introduction"===f.currentScreen,onClosed:()=>{_().slackUniversalQnAConnectionStore.reset()},learnMoreUrl:y}):(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(Mt,{open:"introduction"===f.currentScreen&&"resolved"!==x.status}),C?(0,B.jsx)(Y,{onConnect:async()=>{if(!d)return(0,k().j)({environment:l,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"show_purchase_ai",integration_type:"slack",setup_session_id:f.sessionId,from:f.analyticsFrom}}}),W().r$({openedFrom:"slack_qna_intro_modal",currentTab:"plans"}),void _().slackUniversalQnAConnectionStore.reset();_().slackUniversalQnAConnectionStore.setState({..._().slackUniversalQnAConnectionStore.state,currentScreen:"data-selection"});const e=await a().callApi({eventName:"getSlackIngestionAuthorizeUrl",environment:l,data:{spaceId:v,isAdminAuth:!0,isDesktopApp:l.device.isElectron,sessionId:f.sessionId}});"success"===e.type&&(_().slackUniversalQnAConnectionStore.setState({..._().slackUniversalQnAConnectionStore.state,authUrl:e.data.url}),l.device.isElectron?j().openExternalUrl(e.data.url):await P().M(l,{width:800,height:600,url:e.data.url,titleMessage:Dt.slackUniversalSearchOauthPopupTitle}),(0,k().j)({environment:l,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:w,integration_type:"slack",setup_session_id:f.sessionId,from:f.analyticsFrom}}}))},onDismiss:M,onLearnMore:()=>{window.open(y,"_blank")},title:t,integrationIcon:jt().P,titleWidth:210,notes:n,open:I}):(0,B.jsx)($,{onConnect:()=>{_().slackUniversalQnAConnectionStore.reset(),(0,k().j)({environment:l,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:w,integration_type:"slack",setup_session_id:f.sessionId,from:f.analyticsFrom}}}),W().r$({openedFrom:"slack_connect_nonadmin_modal",currentTab:"members"})},message:c,integrationIcon:jt().P,onDismiss:M,open:I})]})}const Ut=function(){const e=(0,i().O7)(),t=(0,s().Kw)(_().slackUniversalQnAConnectionStore),n=(0,y().yK)((e=>({wrapper:{width:400,padding:24},logoSection:{paddingTop:"40px",paddingBottom:"16px",gap:8,justifyContent:"center",alignItems:"center"},logos:{width:40,height:40},arrowLogo:{width:20,height:20,color:e.icon.secondary},titleWrapper:{width:"100%",justifyContent:"center",textAlign:"center"},title:{fontSize:17,fontWeight:S().Ue.medium,lineHeight:"22px",marginBottom:"24px",textWrap:"balance"},nextStepsWrapper:{width:"100%",justifyContent:"center",color:e.text.secondary},footer:{justifyContent:"center",alignItems:"center",bottom:0,width:"100%",gap:12,marginTop:12},gotIt:{fontSize:14,fontWeight:S().Ue.medium,width:"100%"},pickAnother:{fontSize:14,fontWeight:S().Ue.medium,width:"100%",textAlign:"center"}})),[]),r=(0,o.useCallback)((()=>{_().slackUniversalQnAConnectionStore.reset()}),[]),a=(0,o.useCallback)((()=>{_().slackUniversalQnAConnectionStore.setState({..._().slackUniversalQnAConnectionStore.getInitialState(),currentScreen:"introduction"})}),[]);return(0,B.jsx)(I().Z,{showCloseIcon:!0,onDismiss:()=>{_().slackUniversalQnAConnectionStore.reset(),(0,k().j)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"slack_workspace_already_connected_modal_close",integration_type:"slack",setup_session_id:t.sessionId,from:t.analyticsFrom}}})},open:"alreadyConnected"===t.currentScreen,render:()=>(0,B.jsxs)("div",{style:n.wrapper,children:[(0,B.jsx)(w().gq,{style:n.logoSection,children:(0,_e().t)({width:24,height:24})}),(0,B.jsx)(w().gq,{style:n.titleWrapper,children:(0,B.jsx)(w().gq,{style:n.title,children:(0,B.jsx)(x()._H,{id:"universalSearch.slack.workspaceAlreadyConnected",defaultMessage:"Slack is already connected to another Notion workspace"})})}),(0,B.jsx)(w().gq,{style:n.nextStepsWrapper,children:(0,B.jsx)(x()._H,{id:"universalSearch.slack.onlyOneWorkspaceCanBeConnected",defaultMessage:"Currently, Slack can be only connected to one workspace at a time"})}),(0,B.jsxs)(w().Ht,{style:n.footer,children:[(0,B.jsx)(X().Z,{style:n.gotIt,onClick:r,children:(0,B.jsx)(x()._H,{id:"universalSearch.slack.gotItOneWorkspaceConnected",defaultMessage:"Got it"})}),(0,B.jsx)(C().Z,{style:n.pickAnother,onClick:a,children:(0,B.jsx)(x()._H,{id:"universalSearch.slack.pickDifferentWorkspace",defaultMessage:"Pick a different Slack workspace"})})]})]})})};function Bt(){const e=(0,s().VK)((()=>{var e;return((null===(e=v().subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[]).map((e=>e.feature)).includes("ai")}),[]),t=(0,s().VK)((()=>{var e;return null===(e=u().default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),n=(0,i().O7)(),y=(0,s().Kw)(f().Z),x=(0,s().VK)((()=>g().KR.canUseUniversalGithubSearchScope()),[]),S=(0,s().VK)((()=>g().KR.isJiraQnaEnabled()),[]),j=(0,s().VK)((()=>g().KR.canUseMicrosoftTeamsSearchScope()),[]);return(0,r().r5)((async()=>{t&&S&&await(0,c().getJiraAIConnectionStatusAction)({environment:n,spaceId:t})}),[t,S,n]),(0,r().r5)((async()=>{var e,o;if(t&&("introduction"!==l().githubAIConnectorStore.state.currentScreen&&l().githubAIConnectorStore.reset(),x)){const i=await a().callApi({eventName:"getGithubAIConnectorStatus",environment:n,data:{spaceId:t}});"success"===i.type&&l().githubAIConnectorStore.setState({...l().githubAIConnectorStore.state,status:(e=i.data,null!==(o=e.githubOrg)&&void 0!==o&&o.isSyncComplete?"completed":e.isConnected?"in_progress":"not_started"),isConnected:i.data.isConnected,githubOrg:i.data.githubOrg,isPersonalAuthComplete:i.data.isPersonalAuthComplete,isDisconnecting:i.data.isDisconnecting})}}),[t,x,n]),(0,r().r5)((async()=>{if(!t||!j)return;"introduction"!==d().j.state.currentScreen&&d().j.reset();const e=await a().callApi({eventName:"getMicrosoftTeamsAIConnectorStatus",environment:n,data:{spaceId:t}});if("success"===e.type){const t=e.data.syncStatus,n=e.data.syncProgressPercentage,o=e.data.isConnected,i=o?"not_started"===t||"completed"===t?t:void 0===n?"not_started":100===n?"completed":n>0&&n<100?"in_progress":"authenticated":"unauthenticated";d().j.setState({...d().j.state,status:i,syncProgressPercentage:n??0,isConnected:o,isDisconnecting:e.data.isDisconnecting??!1,microsoftTenantId:e.data.microsoftTenantId})}}),[t,j,n]),(0,o.useEffect)((()=>{const{connectorTriggeringUpsell:t,upsellTriggeredAt:n}=y,o=p().default.getConfigKey("ingestion","upsellMaxDurationInSeconds")||36e5;if(e&&t&&n){if(Date.now()-n>o)return void f().Z.reset();switch(t){case"slack":_().slackUniversalQnAConnectionStore.setState({..._().slackUniversalQnAConnectionStore.state,currentScreen:"introduction"});break;case"google_drive":m().googleDriveConnectionStore.setState({...m().googleDriveConnectionStore.state,screenToShow:"info_screen"});break;case"microsoft_teams":d().j.setState({...d().j.state,currentScreen:"introduction"});break;case"jira":h().jiraAIConnectionStore.setState({...h().jiraAIConnectionStore.state,screenToShow:"info_screen"})}f().Z.reset()}}),[y,e]),(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(Ht,{}),(0,B.jsx)(bt,{}),(0,B.jsx)(It,{}),(0,B.jsx)(wt,{}),(0,B.jsx)(Ut,{}),(0,B.jsx)(Je,{}),(0,B.jsx)(Le,{}),(0,B.jsx)(Ze,{}),(0,B.jsx)(Ve,{}),(0,B.jsx)(Qe,{}),(0,B.jsx)(qe,{}),(0,B.jsx)(Be,{}),(0,B.jsx)(fe,{}),(0,B.jsx)(xe,{}),(0,B.jsx)(He,{}),(0,B.jsx)(We,{}),x&&(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(ie,{}),(0,B.jsx)(F,{}),(0,B.jsx)(pe,{}),(0,B.jsx)(ce,{})]}),S&&(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(rt,{}),(0,B.jsx)(et,{}),(0,B.jsx)(nt,{}),(0,B.jsx)(it,{}),(0,B.jsx)(pt,{}),(0,B.jsx)(Xe,{}),(0,B.jsx)(ut,{}),(0,B.jsx)(st,{})]}),j&&(0,B.jsx)(xt,{})]})}},493843:(e,t,n)=>{n.d(t,{$o:()=>G,Fv:()=>K,IL:()=>Q,J4:()=>L,KA:()=>W,Nf:()=>F,_p:()=>Y,cQ:()=>E,f$:()=>q,fX:()=>V,j2:()=>N,k2:()=>O,mg:()=>$,mz:()=>Z,oP:()=>P,tF:()=>J,td:()=>z,x:()=>R});n(670560),n(267602),n(470928),n(30005),n(241792),n(228244);var o=()=>n(730120),i=()=>n(492788),s=()=>n(506347),r=()=>n(926724),a=()=>n(331540),c=()=>n(874459),l=()=>n(998411),d=()=>n(35980),u=()=>n(513670),g=()=>n(696459),p=()=>n(250303),m=()=>n(384667),h=()=>n(366257),v=()=>n(139224),f=()=>n(421654),_=()=>n(636340),y=()=>n(531515),x=()=>n(47443),S=()=>n(794586),j=()=>n(879952),C=()=>n(970105),b=()=>n(990966),I=()=>n(269299),w=()=>n(932753),k=()=>n(887430),M=()=>n(861026),T=()=>n(804217),A=()=>n(826955),D=()=>n(965903),H=()=>n(807230),U=()=>n(701182),B=()=>n(645843);function N(e){const{collectionViewStore:t,collectionContextStore:n,timelineState:o,environment:i}=e,s=i.currentUser.id,r=(0,U().B8)(t.id),a=(0,U().pQ)(t,i),c=n.permissionScopesStore.state,l=u().Ds((()=>{if(o.destroyed)return;const e={zoomLevel:o.zoomLevel.state,centerTimestamp:(0,U().al)(o)};d().Z.set({userId:s,key:r,value:e})}),1e3),g=u().Ds((()=>{if(o.destroyed||!T().default.state.online||!i.currentUser.isLoggedIn()||!c.canConfigureBlock)return;const e={zoomLevel:o.zoomLevel.state,centerTimestamp:(0,U().al)(o)},n=t.getFormat().timeline_preference;u().Xy(n,e)||I().createAndCommit({userAction:"collectionTimelineViewActions.setRemotePreference",environment:i,canUndo:!0,perform:n=>{f().FH({stores:[t],update:{timeline_preference:e},transaction:n})}})}),5e3);o.savePreference=()=>{l(),g()},F({timelineState:o,environment:i,...a})}function F(e){const{timelineState:t,zoomLevel:n,centerTimestamp:o,environment:s}=e,{savePreference:r}=t,a=s.WindowSizeStore.state.width+2*U().Ge,c=(0,U().x2)(n,a),l=o-c/2,d=o+c/2;t.zoomLevel.setState(n),t.currentRange.setState({startTimestamp:l,endTimestamp:d}),i().default.afterNextFlush((()=>{W({timelineState:t,centerTimestamp:o}),r&&r()}))}function W(e){const{timelineState:t,centerTimestamp:n}=e,{horizontalScroller:o,outerSizeObserver:i}=t;if(!o)return;const s=t.zoomLevel.state,{startTimestamp:r,endTimestamp:a}=t.currentRange.state,c=i.rect.state.width;if(c===(0,U().e$)(s,a-r))return;const l=(0,U().e$)(s,n-r)-c/2;o.scrollLeft=l,t.scrollLeft.setState(l)}function P(e){const{environment:t,store:n,query:o,date:i,schema:s,transaction:r}=e,{timeline_by:a}=o;if(!a)return;const c=n.getAssociatedCollectionStore(),l=(null==c?void 0:c.getMappedProperty(a))??a,d=o.timeline_by_end?(null==c?void 0:c.getMappedProperty(o.timeline_by_end))??o.timeline_by_end:void 0,u=(0,U().TW)({store:n,dateValue:i,query:o,schema:(null==c?void 0:c.getSchema())??s}),g=n.getPropertyValue(l),p=d?n.getPropertyValue(d):void 0;return _().sW({store:n.getPropertiesStore(),data:u,transaction:r}),h().H({environment:t,store:n,dateProperty:{id:l,newValue:(null==u?void 0:u[l])??[],oldValue:g},otherDateProperty:d?{id:d,newValue:(null==u?void 0:u[d])??[],oldValue:p}:void 0}),n}function K(e){var t;const{environment:n,timelineState:i,collectionStore:s,collectionContextStore:r,store:a,query:d,groupFormat:u,transaction:g}=e,p=i.zoomLevel.state,h=(0,U().al)(i),{snapUnit:v,getDateRangePlaceholderDuration:f}=U().BJ[p],{timeline_by:_}=d;if(!_)return;const y=null===(t=r.groupsStore.getGroupState(u))||void 0===t?void 0:t.resultsStore.state;if(!y)return;const x=o().ou.fromMillis(h),S=(0,U().DS)(x,v),j=(0,U().DS)(f(x),v),C=(0,U().AZ)({startValue:(0,c().Lg)((0,l().r)()),snapUnit:v,desiredStart:S,desiredEnd:j});return P({environment:n,store:a,query:d,schema:s.getSchema(),date:C,transaction:g}),m().$T({environment:n,collectionStore:s,before:!0,store:y[0],insertStores:[a],collectionContextStore:r,groupsPointer:u?[u]:[],transaction:g}),a}function q(e){const{type:t,timelineState:n,store:o,startX:i,query:s,schema:r,intl:a,environment:c}=e,{horizontalScroller:l}=n,{startTimestamp:d}=n.currentRange.state;if(!l)return;j().Ys({environment:c,store:o});const g=l.scrollLeft,{stores:p}=D().default.state,m=u().oA(p.map((e=>{const t=(0,U().bk)({store:e,query:s,schema:r,userId:c.currentUser.id,intl:a,formulasModule:void 0});if(t)return{startValue:t,store:e}})));n.dragState.setState({type:t,startStore:o,stores:m.map((e=>{let{store:t}=e;return t})),startValues:m.map((e=>{let{startValue:t}=e;return t})),temporaryValues:m.map((e=>{let{startValue:t}=e;return t})),startX:i,startStartTimestamp:d,startScrollLeft:g})}function L(e){const{timelineState:t,store:n,startX:o,startY:i,schema:s,collectionContextStore:r,verticalScroller:a}=e,{horizontalScroller:c}=t,{startTimestamp:l}=t.currentRange.state;if(!c||!a)return;const d=c.scrollLeft,u=a.scrollTop,g=(0,U().YE)(r,n,s);t.drawState.setState({startStore:n,startDependencyRelationPointers:g,temporaryDependencyRelationPointers:[...g],startX:o,startY:i,startScrollLeft:d,startScrollTop:u,startStartTimestamp:l,xOffsetPx:0,yOffsetPx:0,tryToCompleteDrawnArrow:!1})}function z(e){const{timelineState:t,currentX:n}=e,{horizontalScroller:o}=t,i=t.zoomLevel.state,s=t.dragState.state,{startTimestamp:r}=t.currentRange.state;if(!s||!o)return;const{type:a,startStartTimestamp:l,startValues:d,startScrollLeft:p,startX:m,startStore:h,stores:v}=s,f=U().BJ[i],{snapUnit:_}=f,y=o.scrollLeft-p+(n-m)+(0,U().e$)(i,r-l),x=(0,U().x2)(i,y),S=d[v.indexOf(h)];let j;if(a===U().px.LeftResizer){const{start:e}=(0,U().XO)(S,_),t=e.plus(x);j=d.map((e=>{const n=(0,U().AZ)({startValue:e,snapUnit:_,desiredStart:t});return(0,c().gW)(n)}))}else if(a===U().px.RightResizer){const{end:e}=(0,U().XO)(S,_),t=e.plus(x);j=d.map((e=>{const n=(0,U().AZ)({startValue:e,snapUnit:_,desiredEnd:t});return(0,c().Qq)(n)}))}else a===U().px.ItemDrag?j=d.map((e=>{const{start:t,end:n}=(0,U().XO)(e,_),o=t.plus(x),i=o.plus(n.valueOf()-t.valueOf());return(0,U().AZ)({startValue:e,snapUnit:_,desiredStart:o,desiredEnd:i})})):(0,g().t1)(a);u().Xy(s.temporaryValues,j)||t.dragState.setState({...s,temporaryValues:j})}function Z(e){const{timelineState:t,currentX:n,currentY:o,verticalScroller:i}=e,s=t.drawState.state,r=t.zoomLevel.state,{startTimestamp:a}=t.currentRange.state,{horizontalScroller:c}=t;if(!s||!c||!i)return;const{startDependencyRelationPointers:l,startStore:d,startX:g,startY:p,startScrollLeft:m,startScrollTop:h,startStartTimestamp:v}=s,f=c.scrollLeft,_=i.scrollTop,y=f-m+(n-g)+(0,U().e$)(r,a-v),x=_-h+(o-p),S=t.hoveredItem.state;if(S&&S!==d&&!l.some((e=>e.id===S.id))){const e=[...l,{table:"block",id:S.id,spaceId:S.getSpaceId()}];u().Xy(s.temporaryDependencyRelationPointers,e)||t.drawState.setState({...s,temporaryDependencyRelationPointers:e,xOffsetPx:void 0,yOffsetPx:void 0})}else t.drawState.setState({...s,temporaryDependencyRelationPointers:[...l],xOffsetPx:y,yOffsetPx:x})}function V(e){const{environment:t,collectionContextStore:n,timelineState:o,query:i,schema:s,transaction:r}=e,a=o.dragState.state,{timeline_by:c}=i;if(!a||!c)return;const{temporaryValues:l,stores:d}=a;l.forEach(((e,o)=>{const a=d[o];P({environment:t,store:a,query:i,schema:s,transaction:r,date:e}),p().rv({environment:t,collectionContextStore:n,block_id:a.id,property:c,property_type:"date",from:"timeline"})})),o.dragState.setState(void 0)}function G(e){var t;const{timelineState:n,environment:o,transaction:i,collectionContextStore:s,isFullScreen:r,isRootChild:a}=e,c=n.drawState.state,l=n.dateRangePlaceholder.state;if(!c)return;const{startStore:d,startDependencyRelationPointers:u,temporaryDependencyRelationPointers:g}=c;if(!d)return void n.drawState.setState(void 0);let m;if(l.active){const{date:e,store:t,parentStore:r,groupFormat:a,newTimelineItemProps:c,existingTimelineItemProps:u}=l;if(t&&u){const{query:n,schema:s}=u;P({environment:o,store:t,query:n,schema:s,date:e,transaction:i}),m={table:"block",id:t.id,spaceId:d.getSpaceId()}}else if(c){const{query:n,schema:l,isFullScreen:u,canEditTimelineItems:g,subitemPath:p}=c,h=$({environment:o,date:e,store:t,parentStore:r,query:n,schema:l,isFullScreen:u,groupFormat:a,canEditTimelineItems:g,collectionContextStore:s,subitemPath:p,transaction:i,from:"timeline_complete_draw"});h&&(m={table:"block",id:h.id,spaceId:d.getSpaceId()})}n.dateRangePlaceholder.setState({active:!1})}else m=g.find((e=>!u.includes(e)));const h=(0,U()._e)(s);if(h){const{property:e}=h;m&&(y().hE({environment:o,propertyWithInverse:h,sourceStore:d,destStore:A().G.createChildStore(d,m),position:{type:"after"},transaction:i}),p().rv({environment:o,collectionContextStore:s,block_id:d.id,property:e,property_type:"relation",from:"timeline",isFromBulkActionsToolbar:!1,isUnthrottled:!0})),n.drawState.setState(void 0)}else v().wl({item:{type:"dependencies",from:"view_options"},collectionSettingsStore:s.settingsStore}),n.drawState.setState({...c,tryToCompleteDrawnArrow:!0});const f=null===(t=m)||void 0===t?void 0:t.id;f&&(0,B().LE)(o,{...(0,M().Pn)(s),...(0,B().Ii)({environment:o,collectionContextStore:s,timelineState:n,isFullScreen:r,isRootChild:a}),dependenciesPropertyID:null==h?void 0:h.property,blockedByStoreID:d.id,blockingStoreID:f})}function E(e){const{timelineState:t,environment:n}=e;t.dragState.state&&(t.dragState.setState(void 0),j().ZH({environment:n}))}function R(e){const{timelineState:t,environment:n}=e;t.drawState.state&&(t.drawState.setState(void 0),j().ZH({environment:n}))}function O(e){const{stores:t,collectionViewStore:n,schema:o,transaction:i}=e,s=n.getType(),r=n.getQuery(o),a=[];r&&("calendar"===s?r.calendar_by&&a.push(r.calendar_by):"timeline"===s&&(r.timeline_by&&a.push(r.timeline_by),r.timeline_by_end&&a.push(r.timeline_by_end)));for(const c of t)for(const e of a)C().sO({environment:c.environment,store:c.getPropertyStore(e),value:void 0,transaction:i})}function Q(e){const{dependency:t,collectionContextStore:n,environment:o,timelineState:i,isFullScreen:s,isRootChild:r}=e,a=(0,U()._e)(n),c=n.collectionStore();if(!a||!c)return;const{property:l}=a,{store:d,relationPointer:u}=t,g=d.getSchema()[l];g&&"relation"===g.type&&(I().createAndCommit({userAction:"CollectionTimelineDependenciesOverlay.handleRemoveRelation",environment:o,canUndo:!0,perform:e=>{y().Bl({environment:o,propertyWithInverse:a,sourceStore:d,destStore:A().G.createChildStore(d,u),transaction:e}),p().rv({environment:o,block_id:u.id,property:l,property_type:g.type,from:"timeline",collectionContextStore:n,isFromBulkActionsToolbar:!1,isUnthrottled:!0})}}),(0,B().lf)(o,{...(0,M().Pn)(n),...(0,B().Ii)({environment:o,collectionContextStore:n,timelineState:i,isFullScreen:s,isRootChild:r}),dependenciesPropertyID:l,blockedByStoreID:d.id,blockingStoreID:u.id}))}function J(e){const{collectionViewStore:t,newProperty:n,transaction:o}=e;f().FH({stores:[t],update:{timeline_arrows_by:{property:n}},transaction:o})}function Y(e){var t;const{collectionContextStore:n,relationPropertyId:o,transaction:i}=e,s=n.collectionStore();if(!s)return;const c=o?s.getSchema()[o]:void 0,l="relation"===(null==c?void 0:c.type)&&c.property&&"relation"===(null===(t=s.getSchema()[c.property])||void 0===t?void 0:t.type)?c.property:void 0;f().FH({stores:[s],update:{collection_default_arrows_by:o,...s.getFormat().app_config_uri===a().iS?{app_uri_map:{...s.getFormat().app_uri_map?s.getFormat().app_uri_map:{},[r().Es.BlockingRelation]:o,[r().Es.BlockedRelation]:l}}:{}},transaction:i})}function $(e){const{environment:t,transaction:n,date:o,parentStore:i,query:r,schema:a,isFullScreen:c,groupFormat:l,canEditTimelineItems:d,collectionContextStore:u,from:g}=e;if(!(0,H().ww)(t))return;const p=l?[l]:[],h=u.groupsStore.getGroupState(p);if(!h)return;if(i)return function(e){const{environment:t,transaction:n,date:o,store:i,parentStore:r,query:a,schema:c,groupFormat:l,canEditTimelineItems:d,collectionContextStore:u,subitemPath:g}=e;if(!i||!r)return;const p=l?[l]:[],h=m().yk({environment:t,collectionContextStore:u,groupsPointer:p,store:i,before:!1,collectionStore:r,transaction:n,subitemPath:g,subitemInsertDirection:"into"});if(h){if(P({environment:t,store:h,query:a,schema:c,date:o,transaction:n}),t.device.isMobile)x()._c({environment:t,store:h,pageVisitSource:s().tY.Create});else if(h&&d){const e=h.getBlockTitleStore();b().setSelectionAtStart({store:e})}return h}}(e);u.searchQueryStore.state&&w().Ug({searchQuery:"",collectionContextStore:u,isFullScreen:c});const v=m().IW({environment:t,collectionContextStore:u,groupsPointer:p,shouldCoerce:!0,templateStore:u.defaultPageTemplateStore.state,transaction:n,from:{createBlock:g},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache});if(!v)return;const f=v.coercionSucceeded,_=v.newStore;if(P({environment:t,store:_,query:r,schema:a,date:o,transaction:n}),t.device.isMobile)x()._c({environment:t,store:_,pageVisitSource:s().tY.Create});else if(f&&d){const e=_.getBlockTitleStore();b().setSelectionAtEnd({store:e})}else S().CH({environment:t,store:_,peekMode:(0,k().kr)(u),resultsStore:null==h?void 0:h.resultsStore,collectionContextStore:u,pageVisitSource:s().tY.Create});return _}},645843:(e,t,n)=>{n.d(t,{Al:()=>c,CB:()=>l,H6:()=>a,Ii:()=>m,LE:()=>g,gw:()=>d,iR:()=>s,lf:()=>p,ne:()=>u,zI:()=>r});n(267602),n(653476);var o=()=>n(594546),i=()=>n(701182);function s(e,t){o().lu(e,"timeline_view","timeline_view",5,t)}function r(e,t){o().K4(e,"timeline_zoom_level_update",t)}function a(e,t){o().K4(e,"timeline_today_click",t)}function c(e,t){o().K4(e,"timeline_shift_time_click",t)}function l(e,t){o().K4(e,"timeline_toggle_table_click",t)}function d(e,t){o().K4(e,"timeline_item_scroll_arrow_click",t)}function u(e,t){o().K4(e,"timeline_item_resize",t)}function g(e,t){o().K4(e,"timeline_dependency_arrow_add",t)}function p(e,t){o().K4(e,"timeline_dependency_arrow_delete",t)}function m(e){const{environment:t,collectionContextStore:n,timelineState:o,isFullScreen:s,isRootChild:r}=e,a=o.zoomLevel.state,c=n.normalizedFormatStore.state,l=(0,i().C1)({environment:t,format:c,isFullScreen:s,isRootChild:r}),d=l&&c.timeline_table_properties?c.timeline_table_properties.length:0,u=c.timeline_properties||[],g=u.filter((e=>"title"!==e.property));return{zoom_level:a,show_table:l,show_table_properties_count:d,show_timeline_title:u.length!==g.length,show_timeline_properties_count:g.length}}},887330:(e,t,n)=>{n.d(t,{C:()=>i,L:()=>s});var o=()=>n(707513);function i(e){const{theme:t,isInHomeWidget:n}=e;return{display:"flex",alignItems:"center",fontSize:14,padding:6,...n?{height:24,width:24,color:t.lightTextColor,fill:t.lightIconColor}:{height:28,width:28,color:t.mediumIconColor,fill:t.mediumIconColor},fontWeight:o().Ue.regular,lineHeight:1,borderRadius:6}}function s(e){const{theme:t}=e;return{display:"flex",alignItems:"center",fontSize:14,height:28,padding:6,color:t.mediumIconColor,fontWeight:o().Ue.regular,lineHeight:1,borderRadius:4}}},681035:(e,t,n)=>{n.d(t,{S:()=>s});var o=()=>n(677559);const i=new(o().Ss)("CollectionItemCover",(async()=>{const{CollectionItemCover:e}=await Promise.all([n.e(62743),n.e(37912)]).then(n.bind(n,682652));return{CollectionItemCover:e}})),s=(0,o().kF)(i,(e=>e.CollectionItemCover))},666551:(e,t,n)=>{n.d(t,{O:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("arrowsLeftRight",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M13.7791 3.59799C13.9305 3.74539 14.004 3.9196 13.9998 4.1206C13.9998 4.32607 13.9263 4.50251 13.7791 4.64992L10.5317 8.0268C10.3888 8.1742 10.2269 8.24791 10.0462 8.24791C9.84861 8.24791 9.68676 8.1809 9.56065 8.0469C9.43874 7.91736 9.37779 7.74986 9.37779 7.54439C9.37779 7.34785 9.44295 7.18481 9.57326 7.05528L10.9227 5.66834L11.8937 4.77722L10.5506 4.83082L2.66857 4.83082C2.4752 4.83082 2.31546 4.76382 2.18935 4.62982C2.06323 4.49581 2.00018 4.32831 2.00018 4.1273C2.00018 3.91736 2.06323 3.74539 2.18935 3.61139C2.31546 3.48185 2.4752 3.41708 2.66857 3.41708L10.5506 3.41709L11.8937 3.47069L10.9227 2.57286L9.57326 1.19263C9.44295 1.05863 9.37779 0.893355 9.37779 0.696817C9.37779 0.491345 9.43874 0.323841 9.56065 0.194305C9.68676 0.0647681 9.84861 -1.81463e-07 10.0462 -1.72827e-07C10.2269 -1.64925e-07 10.3888 0.0737017 10.5317 0.221105L13.7791 3.59799ZM2.21457 12.4087C2.06744 12.2568 1.99597 12.0804 2.00018 11.8794C2.00018 11.6784 2.07164 11.5042 2.21457 11.3568L5.47459 7.9799C5.61331 7.8325 5.77516 7.75879 5.96012 7.75879C6.1577 7.75879 6.31744 7.82356 6.43935 7.9531C6.56126 8.0871 6.62222 8.25684 6.62222 8.46231C6.62222 8.65438 6.55916 8.81742 6.43305 8.95142L5.08364 10.3317L4.10626 11.2295L5.44937 11.1759L13.3314 11.1759C13.5248 11.1759 13.6845 11.2429 13.8107 11.3769C13.9368 11.5109 13.9998 11.6784 13.9998 11.8794C13.9998 12.0849 13.9368 12.2546 13.8107 12.3886C13.6845 12.5226 13.5248 12.5896 13.3314 12.5896L5.44937 12.5896L4.10626 12.536L5.08364 13.4338L6.43305 14.8141C6.55916 14.9436 6.62222 15.1066 6.62222 15.3032C6.62222 15.5087 6.56126 15.6762 6.43935 15.8057C6.31744 15.9352 6.1577 16 5.96012 16C5.77516 16 5.61331 15.9285 5.47459 15.7856L2.21457 12.4087Z"})})},850790:(e,t,n)=>{n.d(t,{K:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("boltFilled",{svg:(0,o.jsx)("path",{d:"M0 12.117c0 .38.293.664.703.664h5.518l-2.91 7.91c-.381 1.006.664 1.543 1.318.723l8.877-11.094c.166-.205.254-.4.254-.625 0-.371-.293-.664-.703-.664H7.539l2.91-7.91C10.83.115 9.785-.422 9.131.408L.254 11.492c-.166.215-.254.41-.254.625z"}),viewBox:"0 0 14 22"})},817771:(e,t,n)=>{n.d(t,{A:()=>o().A});var o=()=>n(242550)},756085:(e,t,n)=>{n.d(t,{f:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("chevronLeft",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M3.61816 8.06445C3.61816 8.29688 3.70703 8.49512 3.8916 8.67285L9.22363 13.8887C9.36719 14.0391 9.55859 14.1143 9.77734 14.1143C10.2217 14.1143 10.5703 13.7725 10.5703 13.3213C10.5703 13.1025 10.4814 12.9043 10.3311 12.7539L5.52539 8.06445L10.3311 3.375C10.4814 3.21777 10.5703 3.01953 10.5703 2.80078C10.5703 2.35645 10.2217 2.01465 9.77734 2.01465C9.55859 2.01465 9.36719 2.08984 9.22363 2.24023L3.8916 7.45605C3.70703 7.63379 3.625 7.83203 3.61816 8.06445Z"})})},388957:(e,t,n)=>{n.d(t,{K:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("externalLink",{viewBox:"0 0 17 16",svg:(0,o.jsx)("path",{d:"M4.94922 13.498C4.31641 13.498 3.83789 13.3359 3.51367 13.0117C3.18945 12.6914 3.02734 12.2188 3.02734 11.5938V4.46289C3.02734 3.83398 3.18945 3.35938 3.51367 3.03906C3.83789 2.71875 4.31641 2.55859 4.94922 2.55859H12.0449C12.6777 2.55859 13.1562 2.71875 13.4805 3.03906C13.8047 3.35938 13.9668 3.83398 13.9668 4.46289V11.5938C13.9668 12.2188 13.8047 12.6914 13.4805 13.0117C13.1562 13.3359 12.6777 13.498 12.0449 13.498H4.94922ZM5.01953 12.3438H11.9746C12.2441 12.3438 12.4512 12.2734 12.5957 12.1328C12.7402 11.9922 12.8125 11.7793 12.8125 11.4941V4.55664C12.8125 4.27539 12.7402 4.06445 12.5957 3.92383C12.4512 3.7832 12.2441 3.71289 11.9746 3.71289H5.01953C4.74609 3.71289 4.53711 3.7832 4.39258 3.92383C4.25195 4.06445 4.18164 4.27539 4.18164 4.55664V11.4941C4.18164 11.7793 4.25195 11.9922 4.39258 12.1328C4.53711 12.2734 4.74609 12.3438 5.01953 12.3438ZM10.334 9.54297C10.1855 9.54297 10.0664 9.49609 9.97656 9.40234C9.89062 9.30859 9.84766 9.17969 9.84766 9.01562V8.08398L9.93555 7.24609L9.15039 8.10156L7.09961 10.1465C6.99023 10.2559 6.85742 10.3105 6.70117 10.3105C6.55273 10.3105 6.42969 10.2637 6.33203 10.1699C6.23828 10.0762 6.19141 9.95117 6.19141 9.79492C6.19141 9.6582 6.24609 9.53516 6.35547 9.42578L8.41211 7.36914L9.2793 6.57227L8.47656 6.66602H7.48633C7.32617 6.66602 7.19727 6.62305 7.09961 6.53711C7.00586 6.45117 6.95898 6.33203 6.95898 6.17969C6.95898 6.03516 7.00586 5.91992 7.09961 5.83398C7.19727 5.74414 7.32422 5.69922 7.48047 5.69922H10.2227C10.4062 5.69922 10.5508 5.74609 10.6562 5.83984C10.7617 5.93359 10.8145 6.08398 10.8145 6.29102V9.00977C10.8145 9.16602 10.7695 9.29492 10.6797 9.39648C10.5938 9.49414 10.4785 9.54297 10.334 9.54297Z"})})},109806:(e,t,n)=>{n.d(t,{c:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("eye",{viewBox:"0 0 32 32",svg:(0,o.jsx)("path",{d:"M16.006 25.812c8.863 0 14.994-7.17 14.994-9.406C31 14.16 24.858 7 16.006 7 7.252 7 1 14.16 1 16.406c0 2.236 6.252 9.406 15.006 9.406zm0-3.242a6.194 6.194 0 01-6.197-6.164c-.012-3.452 2.744-6.164 6.197-6.164 3.419 0 6.185 2.711 6.185 6.164 0 3.364-2.766 6.164-6.185 6.164zm0-3.94c1.228 0 2.246-1.007 2.246-2.224 0-1.228-1.018-2.235-2.246-2.235-1.24 0-2.258 1.007-2.258 2.235 0 1.217 1.018 2.224 2.258 2.224z"})})},848854:(e,t,n)=>{n.d(t,{v:()=>o().v});var o=()=>n(545914)},994875:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});class o extends(()=>n(263184))().default{getInitialState(){return{discussionIdToExpansionStartPointMap:{}}}}const i=new o},877727:(e,t,n)=>{n.d(t,{C3:()=>a,D:()=>c,QZ:()=>r,fo:()=>s});var o=()=>n(146947),i=()=>n(749826);function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i().default.checkGate({gateName:"packaging_m2_additional_entrypoints"})&&r(e,t)}function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return!e.device.isPhone&&a(t)}function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i().default.checkGate({gateName:"workflow_templates_prototype",...e})||"control"!==c(e)}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().locale.startsWith("en-")||i().default.checkGate({gateName:"packaging_m2_localize_templates"})?i().default.getEligibleGroup({experimentId:"packaging_m2_entry_point",defaultGroup:"control",...e}):"control"}},999582:(e,t,n)=>{n.d(t,{Z:()=>s});class o extends(()=>n(263184))().default{getInitialState(){return{}}}const i=new o;n(947115).exposeDebugValue("SpaceWorkflowTemplateInstanceMapStore",i);const s=i},29488:(e,t,n)=>{function o(e){return`${e.table}:${e.id}`}n.d(t,{O:()=>o})},912203:(e,t,n)=>{n.d(t,{$M:()=>v,GQ:()=>j,Jy:()=>I,LF:()=>b,NO:()=>p,Of:()=>w,SF:()=>u,TX:()=>S,XO:()=>f,Y_:()=>d,Ym:()=>h,bD:()=>y,cO:()=>g,fo:()=>C,rR:()=>m});n(267602),n(653476),n(228244);var o=()=>n(513670),i=()=>n(696459),s=()=>n(226413),r=()=>n(109477),a=()=>n(455222),c=()=>n(305580);(0,i().AO)((e=>(0,i().$K)(e)&&(0,i().$K)(e.target)&&(0,i().$K)(e.external_bot_id)?{true:{external_bot_id:e.external_bot_id,target:e.target}}:{false:e}));const l={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1},d={checkbox:[{type:"checkbox"}],date:[{type:"date"}],email:[{type:"text"}],multi_select:[{type:"text"},{of:{type:"text"},type:"array"}],number:[{type:"number"}],person:[{type:"person"},{of:{type:"person"},type:"array"}],phone_number:[{type:"text"}],relation:[{type:"block"},{of:{type:"block"},type:"array"}],select:[{type:"text"},{of:{type:"text"},type:"array"}],status:[{type:"text"},{of:{type:"text"},type:"array"}],text:void 0,title:void 0,url:[{type:"text"}]};function u(e){return Boolean(l[e.type]&&!(0,s().NK)(e)&&(!(0,s().qQ)(e)||void 0===(0,s().q3)(e)))}function g(e){const{collectionFormat:t,collectionSchema:n,filter:a,sort:l,sourcePropertyIds:d}=e,g=(d??(0,i().Yd)(n)).filter(((t,o,i)=>{const r=n[t];return!(!r||!u(r))&&(("relation"!==r.type||!e.restrictCrossSpace||!(0,s().Qh)(e.spaceId,r))&&(!a||a([t,r],o,n)))}));if(0===g.length)return[];if(!t||!1===l)return g;const p=(0,c().i)(t,n,void 0,r().j5.Page).collection_page_properties||[];return o().MR(g,(e=>p.findIndex((t=>t.property===e))))}function p(e){const{collectionFormat:t,collectionSchema:n,sort:a}=e,l=(0,i().Yd)(n).filter(((e,t,o)=>{const i=n[e];return!(!i||!(0,s().U8)(i))}));if(0===l.length)return[];if(!t||!1===a)return l;const d=(0,c().i)(t,n,void 0,r().j5.Page).collection_page_properties||[];return o().MR(l,(e=>d.findIndex((t=>t.property===e))))}function m(e){return e.type===a().$E.InvalidCharacter?{type:e.type,character:e.character}:e.type===a().$E.TokenExpected?{type:e.type,token:e.token}:e.type===a().FY.MissingSchemaPropertyOnThisRow||e.type===a().FY.MissingSchemaPropertyOnCollection?{type:e.type,collectionId:e.collectionId,property:e.property}:e.type===a().FY.ThisRowBlockPropertyMismatchCollection?{type:e.type,thisRowCollection:e.thisRowCollection}:e.type===a().FY.MissingContextVariable?{type:e.type,valueId:e.valueId}:e.type===a().FY.FunctionCallTooFewArguments?{type:e.type,numArguments:e.numArguments}:e.type===a().FY.FunctionCallUnexpectedArgument?{type:e.type,parameterIndex:e.parameterIndex}:e.type===a().FY.FunctionCallArgumentWrongType?{type:e.type,argumentType:e.argumentType,libraryFunctionName:e.libraryFunction.name,parameterIndex:e.parameterIndex}:e.type===a().FY.MissingDataDependencyBlock?{type:e.type,blockPointer:e.blockPointer}:e.type===a().FY.MissingDataDependencyPerson?{type:e.type,personPointer:e.personPointer}:e.type===a().FY.MemberPropertyMismatchCollection?{type:e.type,blockCollection:e.blockCollection}:e.type===a().FY.DownstreamParseFailure?{type:e.type,collectionId:e.collectionId,property:e.property}:e.type===a().FY.ContextVariableWrongType?{type:e.type,valueId:e.valueId,expectedType:e.expectedType,resultType:e.resultType}:e.type===a().FY.DisallowedValueType?{type:e.type,expressionValue:e.expressionValue,allowedValueTypes:e.allowedValueTypes}:e.type===a().FY.LibraryFunctionExecutionError?{type:e.type,error:e.error,libraryFunctionName:e.libraryFunction.name}:{type:e.type}}const h={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,button:!1,file:!1,verification:!1,auto_increment_id:!1,created_by:!1,created_time:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1};function v(e){return Boolean(h[e.type])}function f(e){const{collectionFormat:t,collectionSchema:n,filter:a,sort:l}=e,d=(0,i().Yd)(n).filter(((e,t,o)=>{var i;const r=n[e];return!(!r||!h[r.type])&&((!(0,s().qQ)(r)||null===(i=(0,s().q3)(r))||void 0===i||!i.auto_update_on_edit)&&(!a||a([e,r],t,n)))}));if(0===d.length)return[];if(!t||!1===l)return d;const u=(0,c().i)(t,n,void 0,r().j5.Page).collection_page_properties||[];return o().MR(d,(e=>u.findIndex((t=>t.property===e))))}const _={checkbox:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,date:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1};function y(e){return _[e.type]}const x={checkbox:!0,created_by:!0,created_time:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,last_edited_by:!0,last_edited_time:!0,auto_increment_id:!1,button:!1,file:!1,formula:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1};function S(e){return x[e.type]}function j(e){return 0===e}function C(e){return function(e){return"button_block"===e||"button_property"===e}(e)}function b(e){const{property:t,collectionSchema:n}=e;return!!n&&!n[t]}function I(e){const{collectionSchema:t,property:n,type:o}=e,i=null==t?void 0:t[n];return!i||("action"===o?!u(i):!h[i.type])}function w(e){let{automationTrigger:t,collectionSchema:n}=e;if("event"===(null==t?void 0:t.type)||"notification_event"===(null==t?void 0:t.type)){const{pagesAdded:e,pagePropertiesEdited:o,source:s}=t.event;if(void 0===s)return!1;const r="some"===o.type&&o.some,a="all"===o.type&&o.all;if((r||a||[]).some((e=>b({collectionSchema:n,property:e.property})||I({collectionSchema:n,property:e.property,type:"trigger"}))))return!1;const c="some"===o.type&&(!(0,i().$K)(o.some)||0===o.some.length),l="all"===o.type&&(!(0,i().$K)(o.all)||0===o.all.length);if(!e&&("none"===o.type||c||l))return!1}else{if("recurrence"!==(null==t?void 0:t.type))return!1;if(!t.recurrence)return!1}return!0}},157955:(e,t,n)=>{n.r(t),n.d(t,{DEFAULT_MAX_RECURRENCE_DUPLICATION_PER_TASK:()=>T,MAXIMUM_DAILY_RECURRENCES_IN_PATH:()=>j,MAXIMUM_NESTED_RECURRENCE_LEVEL:()=>S,MAX_RECURRENCE_INTERVAL:()=>v,MAX_RECURRENCE_NUMBER_OF_RUNS:()=>f,RRULE_WEEKDAYS_MAP:()=>h,convertFromUnpersistedRecurrenceConfig:()=>H,convertToUnpersistedRecurrenceConfig:()=>A,getFormattedEndCondition:()=>M,getFormattedNextRecurrenceTime:()=>k,getNextDateUtc:()=>w,getRecurrenceAfter:()=>b,isRunningBetweenMidnightAnd3AM:()=>I,isValidRecurrenceInterval:()=>_,isValidRecurrenceNumberOfRuns:()=>y,rruleFromRecurrence:()=>x,templateAncestorsViolateRecurrenceNesting:()=>C});n(267602),n(653476),n(241792);var o=()=>n(730120);n(670560);function i(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if(0===n.length)return e.map((e=>[e]));const s=[];for(const r of e)s.push(...i(n[0],...n.slice(1)).map((e=>[r,...e])));return s}var s=()=>n(696459),r=()=>n(326966),a=()=>n(803021),c=()=>n(646574),l=()=>n(998411),d=()=>n(578292);class u extends(()=>n(484885))().Ci{constructor(e,t){super(e,t)}after(e,t){return super.after(e,t)}}var g=()=>n(494616);const p=(0,n(788860).vU)({dateAtTime:{id:"automations.recurrenceHelpers.dateAtTime",defaultMessage:"{date} at {time}"},dateBetweenMidnightAnd3AM:{id:"automations.recurrenceHelpers.dateBetweenMidnightAnd3AM",defaultMessage:"{date} between 12–3 AM"},numberEndConditionDescription:{id:"automations.recurrenceHelpers.numberEndConditionDescription",defaultMessage:"{number, plural, one {After {number} run} other {After {number} runs}}"},noEndCondition:{id:"automations.recurrenceHelpers.noEndCondition",defaultMessage:"Never"}}),m={day:u.DAILY,week:u.WEEKLY,month:u.MONTHLY,year:u.YEARLY},h={MO:u.MO,TU:u.TU,WE:u.WE,TH:u.TH,FR:u.FR,SA:u.SA,SU:u.SU},v=99,f=999;function _(e){return(0,r().hj)(e)&&Number.isInteger(e)&&e>0&&e<=v}function y(e){return(0,r().hj)(e)&&Number.isInteger(e)&&e>0&&e<=f}function x(e){const{start_date:t,frequency:n,interval:o,weekdays:r,timezone:c,hour:l,minute:d}=e,g="week"===n&&r?r.map((e=>h[e])):void 0,p={};return(0,s().$K)(e.end_condition)&&("date"===e.end_condition.type?p.until=(0,a().pd)(e.end_condition.end_at):"number"===e.end_condition.type?p.count=e.end_condition.number_of_occurrences:(0,s().t1)(e.end_condition)),"month"===e.frequency&&(0,s().$K)(e.monthly_restriction)&&("monthdays"===e.monthly_restriction.type?p.bymonthday=e.monthly_restriction.monthdays:"weekdays_in_month"===e.monthly_restriction.type?p.byweekday=i(e.monthly_restriction.weekdays,e.monthly_restriction.week_numbers).map((e=>{let[t,n]=e;return h[t].nth(n)})):(0,s().t1)(e.monthly_restriction)),new u({freq:m[n],dtstart:(0,a().pd)(t),interval:o,byweekday:g,tzid:c,byhour:l??0,byminute:d??0,bysecond:0,...p})}const S=1,j=1;function C(e){var t;if(0===e.length)return{violatesConstraint:!1,templateNestingExceedsMaxDepth:!1,ancestorHasDailyTemplate:!1,nestedDepthOfAutomationAncestors:void 0,immediateAncestorRecurrenceType:void 0};const n=e.filter((e=>{var t;return"day"===(null===(t=e.getRecurrence())||void 0===t?void 0:t.frequency)})),o=e.length,i=null===(t=e[0].getRecurrence())||void 0===t?void 0:t.frequency,s=o>S,r=n.length>=j;return{violatesConstraint:s||r,templateNestingExceedsMaxDepth:s,ancestorHasDailyTemplate:r,nestedDepthOfAutomationAncestors:o,immediateAncestorRecurrenceType:i}}function b(e){const{recurrence:t,afterDate:n}=e;if((0,g().nA)(t)){const e=(0,a().kq)(n);return t.start_date>=e?new Date(t.start_date):void 0}{const e=x(t).after((0,a().pd)(n));if(!e)return;return(0,a().YL)(e)}}function I(e){return 0===e.hour||1===e.hour||2===e.hour}function w(e){return x(e).after((0,a().pd)((0,a().Jh)()))||void 0}function k(e){const{recurrence:t,intl:n}=e,i=w(H(t));if(!i)return;const s=I(t),r=o().ou.fromJSDate(i).toUTC().setZone("local",{keepLocalTime:!0}).setLocale((0,d().E2)(n)).setZone(t.timezone),a=(0,c().p6)({date:r,dateFormat:"relative",allowRelativeDates:!0,intl:n,shortenDate:!0});if(s)return n.formatMessage(p.dateBetweenMidnightAnd3AM,{date:a});{let e=r.toLocaleString(o().ou.TIME_SIMPLE);return t.timezone!==(0,l().r)()&&(e+=` ${r.toFormat("ZZZZ")}`),n.formatMessage(p.dateAtTime,{date:a,time:e})}}function M(e,t){return(0,s().$K)(e)?"number"===e.type?t.formatMessage(p.numberEndConditionDescription,{number:e.number_of_occurrences}):"date"===e.type?(0,c().p6)({date:o().ou.fromMillis(e.end_at),dateFormat:"relative",allowRelativeDates:!0,intl:t,shortenDate:!0}):void(0,s().t1)(e):t.formatMessage(p.noEndCondition)}const T=100;function A(e){return{...e,start_date:(0,a().kq)(e.start_date),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?{type:"date",end_at:(0,a().kq)(e.end_condition.end_at)}:(0,s().t1)(e.end_condition):void 0}}function D(e,t){const n=o().ou.fromMillis(t.end_at).set({hour:e.hour??0,minute:e.minute??0});return{type:"date",end_at:(0,a().Jh)(n.toJSDate())}}function H(e){return{...e,start_date:(0,a().Jh)(new Date(e.start_date)),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?D(e,e.end_condition):(0,s().t1)(e.end_condition):void 0}}},242550:(e,t,n)=>{n.d(t,{A:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("checkMarkLine",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M6.79297 13.2871C6.48047 13.2871 6.21484 13.1523 5.99609 12.8828L2.96094 9.14453C2.875 9.04297 2.8125 8.94336 2.77344 8.8457C2.73828 8.74805 2.7207 8.64648 2.7207 8.54102C2.7207 8.30664 2.79883 8.11328 2.95508 7.96094C3.11133 7.80859 3.30859 7.73242 3.54688 7.73242C3.81641 7.73242 4.04297 7.84766 4.22656 8.07812L6.76953 11.3008L11.7324 3.4375C11.834 3.28125 11.9395 3.17188 12.0488 3.10938C12.1582 3.04297 12.2949 3.00977 12.459 3.00977C12.6973 3.00977 12.8926 3.08398 13.0449 3.23242C13.1973 3.38086 13.2734 3.57031 13.2734 3.80078C13.2734 3.89453 13.2578 3.98828 13.2266 4.08203C13.1953 4.17578 13.1465 4.27344 13.0801 4.375L7.5957 12.8594C7.4082 13.1445 7.14062 13.2871 6.79297 13.2871Z"})})},269309:(e,t,n)=>{n.d(t,{A:()=>i});n(667294);var o=n(785893);const i=(0,n(827282).IU)("verified",{viewBox:"0 0 20 20",svg:(0,o.jsx)("path",{d:"M18.125 10C18.125 8.73755 17.1875 7.69692 15.9719 7.52817C16.2875 7.10942 16.4781 6.59067 16.4781 6.02505C16.4781 4.6438 15.3594 3.52505 13.9781 3.52505C13.4125 3.52505 12.8938 3.71567 12.475 4.0313C12.3063 2.81567 11.2656 1.87817 10.0031 1.87817C8.74063 1.87817 7.70001 2.81567 7.53126 4.0313C7.11251 3.71567 6.59376 3.52505 6.02813 3.52505C4.64688 3.52505 3.52813 4.6438 3.52813 6.02505C3.52813 6.59067 3.71876 7.10942 4.03438 7.52817C2.81876 7.69692 1.88126 8.73755 1.88126 10C1.88126 11.2625 2.81876 12.3032 4.03438 12.4719C3.71876 12.8907 3.52813 13.4094 3.52813 13.975C3.52813 15.3563 4.64688 16.475 6.02813 16.475C6.59376 16.475 7.11251 16.2844 7.53126 15.9688C7.70001 17.1844 8.74063 18.1219 10.0031 18.1219C11.2656 18.1219 12.3063 17.1844 12.475 15.9688C12.8938 16.2844 13.4125 16.475 13.9781 16.475C15.3594 16.475 16.4781 15.3563 16.4781 13.975C16.4781 13.4094 16.2875 12.8907 15.9719 12.4719C17.1875 12.3032 18.125 11.2625 18.125 10ZM9.06251 13.8251L5.62501 10.3875L6.95001 9.06255L9.06251 11.175L13.3625 6.87505L14.6875 8.20005L9.06251 13.8251Z"})})}}]);