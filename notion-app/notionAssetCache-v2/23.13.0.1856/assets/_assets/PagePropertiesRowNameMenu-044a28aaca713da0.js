"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[97583],{501912:(e,t,o)=>{o.d(t,{T:()=>f});o(670560),o(667294);var i=()=>o(788860),n=()=>o(707513),r=()=>o(360746),l=()=>o(384241),a=()=>o(129338),s=()=>o(90065),c=()=>o(688745),p=()=>o(382474),d=()=>o(917881),u=()=>o(308186),m=()=>o(269299),y=o(785893);async function f(e){const{environment:t,collectionContextStore:o,property:f,handleDeleteAccept:h}=e,g=o.collectionStore();if(!g)return;if(g.isTypedProperty(f)){if(await r().w0({environment:t,property:f,collectionContextStore:o,theme:e.theme,from:e.from}))return}const S=(0,p()._U)({environment:t,collectionStore:g,propertyId:f});if(S.length>0){if((0,c().Ym)({environment:t,collectionStore:g,propertyId:f,compoundTemplateInstancesToDelete:S,collectionContextStore:o,from:e.from}))return}else if(((0,s().e_)(f)||(0,s().TJ)({collectionStore:g,propertyId:f}))&&(0,s().sA)(g)&&(0,s().tj)(t)){if((0,c().D5)({environment:t,collectionStore:g,propertyId:f,collectionContextStore:o,from:e.from}))return}const b=o.normalizedSchemaStore.state,v=b[f],w=a().ny(o,v);await(null==w?void 0:w.load());const _=w&&a().OP(o,f,w),C=w&&a().gZ(w),x=w&&g.id===w.id,P=[{label:(0,y.jsx)(i()._H,{id:"database.viewSettings.propertyTab.deleteProperty.modal.confirmButton",defaultMessage:"Delete"}),color:"red",onAccept:h}];let M;if(_&&g&&C&&!x&&P.push({label:(0,y.jsx)(i()._H,{id:"database.tableHeaderCell.deleteProperty.modal.inverseConfirmButton",defaultMessage:"Delete, but keep related property"}),color:"red",onAccept:()=>{m().createAndCommit({userAction:"collectionPropertyActions.showDeletePropertyDialog",environment:t,canUndo:!0,perform:e=>{if(v&&"relation"===v.type&&v.property&&w){const o=v.property,i=w.getSchema();d().q0({environment:t,collectionStore:w,propertySchema:i[o],property:o,targetPropertyID:void 0,autoRelate:g.isSyncedCollection()&&!w.isSyncedCollection()?{enabled:!1}:v.autoRelate,transaction:e})}d().kQ({environment:t,collectionStore:g,property:f,transaction:e})}})}}),"auto_increment_id"===(null==v?void 0:v.type))M=a().pR(b)?(0,y.jsx)(i()._H,{id:"database.tableHeaderCell.deleteUniqueIdWithGithubProperty.modal.prompt",defaultMessage:"You will no longer be able to link new GitHub PRs and status automations will stop working."}):(0,y.jsx)(i()._H,{id:"database.tableHeaderCell.deleteUniqueIdProperty.modal.prompt",defaultMessage:"The ID property will be permanently deleted."});else if("status"===(null==v?void 0:v.type)){const e=a().Pi(b);if(e){const t=e.connectedRelation.automation;t&&t[f]&&(M=(0,y.jsx)(i()._H,{id:"database.tableHeaderCell.deleteStatusProperty.modal.prompt",defaultMessage:"Deleting this status property will stop the GitHub Pull Requests status automation."}))}}else w&&C&&!x&&_&&(M=(0,y.jsx)(i()._H,{id:"database.tableHeaderCell.deleteRelatedProperty.modal.prompt",defaultMessage:"This property has a related property on {relationTargetName} which will also be deleted.",values:{relationTargetName:(0,y.jsx)(l().Z,{style:{display:"inline",fontWeight:n().Ue.medium},store:w})}}));u().vC({message:(0,y.jsx)("span",{children:(0,y.jsx)(i()._H,{id:"database.tableHeaderCell.deleteProperty.modal.prompt",defaultMessage:"Delete this property from {databaseName}? It will be removed from all views.",values:{databaseName:(0,y.jsx)(l().Z,{style:{display:"inline",fontWeight:n().Ue.bold},shouldWrap:!0,store:g})}})}),description:M,showCancel:!0,keepFocus:!0,items:P,mode:"wide"})}},829563:(e,t,o)=>{o.r(t),o.d(t,{PagePropertiesRowNameMenu:()=>te});o(821057),o(670560),o(267602),o(653476),o(470928),o(241792);var i=o(667294),n=()=>o(219727),r=()=>o(142735),l=()=>o(15607),a=()=>o(226413),s=()=>o(421551),c=()=>o(532850),p=()=>o(639708),d=()=>o(989478),u=()=>o(788860),m=()=>o(568017),y=()=>o(543172),f=()=>o(696459),h=()=>o(250303),g=()=>o(984871),S=()=>o(139224),b=()=>o(593515),v=()=>o(501912),w=()=>o(261930),_=()=>o(269299),C=()=>o(49396),x=()=>o(932753),P=()=>o(887430),M=()=>o(267191),j=()=>o(125659),k=()=>o(352230),I=()=>o(164079),H=()=>o(676214),V=()=>o(992024),A=()=>o(802600),T=()=>o(877691),D=()=>o(209078),Z=()=>o(502893),L=()=>o(918302),O=()=>o(739479),R=()=>o(99537),E=()=>o(528770),z=()=>o(142730),N=()=>o(162178),U=()=>o(242921),W=()=>o(983993),B=()=>o(998901),F=()=>o(876822),K=()=>o(482162),G=()=>o(855238),$=()=>o(827973),q=()=>o(255577),J=()=>o(654133),Y=()=>o(868744),Q=()=>o(550757),X=o(785893);function ee(e){const t=(0,j().Y$)(),b=(0,n().O7)(),Q=(0,o(846550).Fg)(),{permissionScopes:ee,collectionSettingsStore:te,collectionStore:re,layoutStore:le}=(0,r().VK)((()=>{var e;return{permissionScopes:t.permissionScopesStore.state,collectionSettingsStore:t.settingsStore,collectionStore:t.collectionStore(),layoutStore:null===(e=t.collectionStore())||void 0===e?void 0:e.getLayoutStore()}}),[t]),{databaseType:ae,collectionSchema:se}=(0,r().VK)((()=>({databaseType:null==re?void 0:re.getDatabaseType(),collectionSchema:null==re?void 0:re.getSchema()})),[re]),{property:ce,schema:pe,blockStore:de}=e,ue=(0,c().Qm)({schema:pe,property:ce}),me=(0,r().VK)((()=>o(129338).ny(t,ue)),[t,ue]);(0,i.useEffect)((()=>{const e=pe[ce];t&&"relation"===(null==e?void 0:e.type)&&(null==me||me.load())}),[t,ce,pe,me]);const ye=(0,r().VK)((()=>!!re&&Boolean(ae&&o(110232).cR((0,o(2971).appConfigs)(),ae,ce,re))),[ce,ae,re]),fe=(0,o(96778).yT)(de,se,ce,ue);let he;const{device:ge}=b;he=ge.isMobile?{menuType:k().o.ActionSheet}:{menuType:k().o.Popup,width:220};const Se=Boolean((0,i.useContext)(N().eK)),{sessionId:be,setModuleSelection:ve}=(0,i.useContext)(N().Dt)||{},we=(0,r().VK)((()=>!Se&&!fe),[Se,fe]),_e=(0,r().VK)((()=>(0,o(378773).N)({environment:b,blockStore:de})),[de,b]),Ce=function(e){let{property:t,schema:o,format:i,blockStore:n,pagePropertiesStore:r,popupContainerRef:b,collectionContextStore:j,permissionScopes:k,collectionStore:N,collectionSettingsStore:q,isTypedProperty:Q,environment:ee,theme:te,layoutModule:re,isInPageLayoutEditor:le,layoutSessionId:ae,layoutStore:se,isPropertyCommentsEnabled:ce,canShowLayoutBuilderEntryPoint:pe,hideDuplicatePropertyOption:de,setModuleSelection:ue}=e;const{device:me}=ee,ye=(0,c().Qm)({schema:o,property:t});if(t===a().ow)return[[{key:"ai_summary",action:()=>{const e=F().default.state.currentSpaceViewStore;e&&w().ce(ee,e)},render:e=>(0,X.jsx)($().Z,{title:(0,X.jsx)(u()._H,{id:"AiSummaryTryOnThisPage.dimissButtonTooltip",defaultMessage:"Dismiss suggestion"}),...e})}]];if(!(j&&q&&ye&&N))return[];const fe=[],he=le&&(0,p().Cj)(re),ge=k.canConfigureCollection||k.canConfigureBlock;if(ge&&!(0,l().w)(t)&&!k.isExternallyImportedAndSyncedCollection){const e=le&&(he||(0,p().z1)(re)||(0,p().LP)(re));if(he){const e=[{key:"Show As Property Or Section",action:()=>{},render:(e,n)=>(0,X.jsx)(Y().Z,{...e,renderOrigin:e=>(0,X.jsx)(G().Z,{...e,title:(0,X.jsx)(u()._H,{defaultMessage:"Show as",id:"database.configureProperty.showAsAction"}),svg:V().g}),onFocus:n.onFocus,renderExtension:(e,n)=>(0,X.jsx)(ne,{popupEvents:e,extParent:n,property:t,schema:o,format:i,collectionStore:N,pagePropertiesStore:r})})}];fe.push(e)}const l=[];if(fe.push(l),l.push({key:"rename",render:e=>(0,X.jsx)($().Z,{...e,title:(0,X.jsx)(u()._H,{defaultMessage:"Rename",id:"database.tableHeaderCell.rename"}),icon:(0,Z().H)({width:14})}),action:()=>{S().r$({collectionContextStore:j,collectionSettingsStore:q,fromBlockStore:n}),S().FK({collectionSettingsStore:q,item:{type:"property",formatKey:"collection_page_properties",property:t,selectNameInitial:!me.isMobile}})}}),l.push({key:"edit_property",render:e=>(0,X.jsx)(J().Z,{placement:B().Placement.Left,render:t=>(0,X.jsx)($().Z,{title:(0,X.jsx)(u()._H,{defaultMessage:"Edit property",id:"database.tableHeaderCell.editProperty"}),icon:(0,D().W)({width:14}),...(0,I().Z)(e,t)}),style:{whiteSpace:"normal"},renderTooltip:()=>(0,X.jsx)(u()._H,{defaultMessage:"Edit property name, type, and other options...",id:"database.tableHeaderCell.editPropertyTooltip"})}),action:()=>{S().r$({collectionContextStore:j,collectionSettingsStore:q,fromBlockStore:n,hideDuplicatePropertyOption:de}),S().FK({collectionSettingsStore:q,item:{type:"property",formatKey:"collection_page_properties",property:t}})}}),se&&e){const e=[{key:"Move to layout",action:()=>{if(!ae)throw new Error("could not find session id for layouts logging");const e=(0,y().ZP)();(0,R().sW)({position:{type:"area_relative",area:"page_main",location:"end_moveable"},layoutStore:se,environment:ee,module:{type:"property_relation",id:e,propertyId:t},sessionId:ae,isPropertyCreation:!1}),null==ue||ue({type:"existing_module",moduleId:e,isDragging:!1}),oe(r,j)},render:e=>(0,X.jsx)($().Z,{...e,title:(0,X.jsx)(u()._H,{defaultMessage:"Add to layout",id:"database.configureProperty.moveToLayout"}),icon:(0,T().J)({width:14})})}];fe.push(e)}ce&&"formula"!==ye.type&&"rollup"!==ye.type&&"button"!==ye.type&&"auto_increment_id"!==ye.type&&"verification"!==ye.type&&!(0,a().ZY)(ye.type)&&l.push({key:"comment",render:e=>(0,X.jsx)($().Z,{...e,title:(0,X.jsx)(u()._H,{defaultMessage:"Comment",id:"database.tableHeaderCell.comment"}),icon:(0,L().s)({width:14})}),action:async()=>{await(0,M().y)({environment:ee,blockStore:n,rect:W().Z.getRect(n,t),property_id:t}),oe(r,j)}})}const Se=[];fe.push(Se);let be=!0;if("relation"===ye.type){var ve;const e=i.collection_page_sections||[],o=e.findIndex((e=>e.section===t)),n=null===(ve=e[o])||void 0===ve?void 0:ve.visibility;!n||"inline"!==n&&"minimal"!==n||(be=!1)}if("title"!==ye.type&&k.canConfigureBlock&&be&&!((0,p().f)(re)||(0,p().LP)(re)||(0,p().Cj)(re))){const e=i.property_visibility;if(e){const n=e.find((e=>e.property===t));Se.push({key:"Property Visibility",action:()=>{},render:(e,l)=>(0,X.jsx)(Y().Z,{...e,renderOrigin:e=>(0,X.jsx)($().Z,{...e,title:(0,X.jsx)(u()._H,{defaultMessage:"Property visibility",id:"database.configureProperty.propertyVisibilityAction"}),icon:"show"===(null==n?void 0:n.visibility)?(0,H().p)({width:14}):(0,V().g)({width:14})}),onFocus:l.onFocus,renderExtension:()=>(0,X.jsx)(ie,{property:t,schema:o,format:i,collectionStore:N,pagePropertiesStore:r})})})}}a().Tr.includes(ye.type)&&k.canConfigureCollection&&!(0,l().w)(t)&&!k.isExternallyImportedAndSyncedCollection&&((0,a().g0)(ye)&&!de&&Se.push({key:"Duplicate Property",render:e=>(0,X.jsx)($().Z,{...e,title:(0,X.jsx)(u()._H,{defaultMessage:"Duplicate property",id:"database.configureProperty.duplicateAction"}),icon:(0,A().a)({width:14})}),action:async()=>{oe(r,j),await async function(e,t,o,i,n){const r=o.collection_page_properties||[],l=null==t?void 0:t.getSpaceId();if(!t||!l)return;const a=t.getNormalizedPropertyGroups(),s=await P().xy({environment:n,schema:i,properties:r,property:e,propertyGroups:a,parentStore:t,spaceId:l});if(s){const e=n.currentUser.id,r=e?{id:e,table:d().KJ}:void 0;_().createAndCommit({userAction:"PagePropertiesRowName.handleDuplicate",environment:n,canUndo:!0,perform:e=>{(0,f().$K)(s.automationUpdate)&&C().duplicateAutomation({actorPointer:r,environment:n,sourceAutomationStore:s.automationUpdate.sourceAutomationStore,targetAutomationId:s.automationUpdate.targetAutomationId,transaction:e});const l={...i,[s.newProperty]:s.newPropertySchema},a={...o,collection_page_properties:s.newProperties,property_groups:s.newPropertyGroups};x().Rm({environment:n,collectionStore:t,update:{schema:l,format:a},transaction:e})}})}}(t,N,i,o,ee)}}),Q||Se.push({key:"delete",render:e=>(0,X.jsx)($().Z,{...e,title:(0,X.jsx)(u()._H,{defaultMessage:"Delete property",id:"database.tableHeaderCell.deleteProperty"}),icon:(0,O().y)({width:14}),hoveredStyle:{color:m().ZP.red,fill:m().ZP.red}}),action:async()=>{const e=()=>{var e;if(!he)return;const o=j.collectionStore(),i=null==o?void 0:o.getSchema(),n=null==o?void 0:o.getFormat();if(!(0===(i&&n?(0,s().n)({format:n,schema:i,visibilityLevels:["inline","minimal"]}):[]).filter((e=>e.section!==t)).length))return;const r=null==o||null===(e=o.getLayoutStore())||void 0===e?void 0:e.getModules().page_main.find((e=>"normalizedTitleWithIcon"===e.type));r&&(null==ue||ue({type:"existing_module",moduleId:r.id,isDragging:!1}))};oe(r,j),await async function(e){let{environment:t,theme:o,property:i,schema:n,collectionStore:r,collectionContextStore:l,onAccept:a}=e;if(!l)return;await v().T({environment:t,collectionContextStore:l,property:i,handleDeleteAccept:()=>(a(),function(e,t,o,i,n){if(!n)return;_().createAndCommitAsync({environment:e,userAction:"PagePropertiesRowName.handleDeleteAccept",waitForServerCommit:!1,perform:n=>g().yV({environment:e,collectionStore:i,schema:o,property:t,transaction:n})});const r=i.getSchema()[t];r&&h().y9({environment:e,collectionContextStore:n,property_type:r.type,from:"table_column",property:t});const l=i.getLayoutStore(),a=(0,U().xx)(i);K().default.state.open||!l||a||(0,E().n)({environment:e,from:"details_sidebar_empty",layoutStore:l,panelLocation:"mainPage",preventPeekWidthResize:!1})}(t,i,n,r,l)),theme:o,from:"table_column"})}({environment:ee,theme:te,property:t,schema:o,collectionStore:N,onAccept:e,collectionContextStore:j})}}));const we=[];pe&&we.push({key:"customizeLayout",action:()=>{oe(r,j);const e=j.collectionStore();e&&(0,z().IR)({environment:ee,blockStore:n,collectionStore:e,from:"page_property_menu"})},render:(e,t)=>(0,X.jsx)($().Z,{...e,title:(0,X.jsx)(u()._H,{defaultMessage:"Customize layout",id:"pageProperties.editProperty.customizeLayout.label"}),icon:(0,T().J)({width:14})})});le||fe.push(we);return fe}({property:e.property,schema:e.schema,format:e.format,blockStore:e.blockStore,pagePropertiesStore:e.pagePropertiesStore,popupContainerRef:e.popupContainerRef,collectionContextStore:t,permissionScopes:ee,collectionStore:re,collectionSettingsStore:te,isTypedProperty:ye,environment:b,theme:Q,layoutModule:e.layoutModule,layoutSessionId:be,isInPageLayoutEditor:Se,layoutStore:le,isPropertyCommentsEnabled:we,hideDuplicatePropertyOption:Boolean(e.hideDuplicatePropertyOption),canShowLayoutBuilderEntryPoint:_e,setModuleSelection:ve});return(0,X.jsx)(o(198829).Z,{...he,children:(0,X.jsx)(q().Z,{type:q().i.Vertical,initialFocus:void 0,sections:o(513670).oA(null==Ce?void 0:Ce.map(((e,t)=>{if(e.length>0)return{key:t,render:e=>(0,X.jsx)(o(388284).Z,{...e,topBorder:0!==t}),items:e}})))})})}const te=i.memo(ee);function oe(e,t){e.setState({...e.state,openProperty:void 0});const o=null==t?void 0:t.settingsStore;o&&S().E3({collectionSettingsStore:o})}function ie(e){let{property:t,schema:o,format:r,collectionStore:l,pagePropertiesStore:a}=e;const s=(0,n().O7)(),c=(0,i.useContext)(j().cu),p=r.property_visibility;if(!p)return null;const d=o[t];if(!d)return null;const u=p.find((e=>e.property===t));return(0,X.jsx)(Q().YV,{propertySchema:d,currentVisibility:(null==u?void 0:u.visibility)||"show",onSelect:e=>function(e,t,o,i,n){_().createAndCommit({userAction:"CustomizePageMenu.handleShowAsClick",environment:n,canUndo:!0,perform:n=>{b().M0({property:t,visibility:e,format:o,store:i,transaction:n})}})}(e,t,r,l,s),onClose:()=>{oe(a,c)}})}function ne(e){let{popupEvents:t,extParent:o,property:r,schema:l,format:a,collectionStore:s,pagePropertiesStore:c}=e;const p=(0,n().O7)(),d=(0,i.useContext)(j().cu),u=a.collection_page_sections||[];if(!l[r])return null;const m=u.findIndex((e=>e.section===r)),y=u[m];return(0,X.jsx)(Q().pb,{currentVisibility:(null==y?void 0:y.visibility)||"section_hide",onSelect:e=>{g().Ji({visibility:e,property:r,schema:l,collectionStore:s,format:a,environment:p}),oe(c,d)},onClose:()=>{o.close()}})}},259098:(e,t,o)=>{o.d(t,{IR:()=>m,Rc:()=>c,Wc:()=>a,eN:()=>d,nL:()=>r});var i=()=>o(788860);const n=(0,i().vU)({expanded:{id:"customizePageMenuVisibilitySelect.expanded.label",defaultMessage:"Expanded"},off:{id:"customizePageMenuVisibilitySelect.off.label",defaultMessage:"Off"}}),r={section_show:n.expanded,section_collapsed:n.expanded,section_hide:n.off},l=(0,i().vU)({default:{id:"customizePageMenuVisibilitySelect.default.label",defaultMessage:"Default"},minimal:{id:"customizePageMenuVisibilitySelect.minimal.label",defaultMessage:"Minimal"}}),a={inline:l.default,minimal:l.minimal},s=(0,i().vU)({showOnHover:{id:"visibilityLevelMessages.backlinksPageSection.showOnHover",defaultMessage:"Show on hover"},alwaysShow:{id:"visibilityLevelMessages.backlinksPageSection.alwaysShow",defaultMessage:"Always show"},off:{id:"customizePageMenuVisibilitySelect.off.label",defaultMessage:"Off"}}),c={always_show:s.alwaysShow,section_show:s.showOnHover,section_collapsed:s.showOnHover,section_hide:s.off,inline:s.off,minimal:s.off},p=(0,i().vU)({asPageSection:{id:"customizePageMenuVisibilitySelect.section.label",defaultMessage:"As page section"},minimal:{id:"visibilityLevelMessages.propertyPageSection.minimal",defaultMessage:"Minimal"}}),d={inline:p.asPageSection,minimal:p.minimal},u=(0,i().vU)({alwaysShow:{id:"customizePageMenuVisibilitySelect.show.label",defaultMessage:"Always show"},alwaysHide:{id:"customizePageMenuVisibilitySelect.hide.label",defaultMessage:"Always hide"},hideWhenEmpty:{id:"customizePageMenuVisibilitySelect.hideIfEmpty.label",defaultMessage:"Hide when empty"},asPageSection:{id:"customizePageMenuVisibilitySelect.section.label",defaultMessage:"As page section"}}),m={show:u.alwaysShow,hide:u.alwaysHide,hide_if_empty:u.hideWhenEmpty,section:u.asPageSection}},550757:(e,t,o)=>{o.d(t,{K1:()=>g,Xv:()=>v,YV:()=>h,h9:()=>b,pb:()=>S});o(267602),o(653476),o(241792),o(667294);var i=()=>o(219727),n=()=>o(846550),r=()=>o(109477),l=()=>o(788860),a=()=>o(670655),s=()=>o(352230),c=()=>o(15409),p=()=>o(827973),d=()=>o(198829),u=()=>o(255577),m=()=>o(388284),y=()=>o(259098),f=o(785893);function h(e){const{currentVisibility:t,propertySchema:o,onSelect:i,onClose:n}=e;let s=[...r().AX];s=s.filter((e=>"section"!==e)),(0,a().kq)({propertySchema:o})||(s=s.filter((e=>"hide_if_empty"!==e)));const c=s.map((e=>({visibility:e,label:(0,f.jsx)(l()._H,{...y().IR[e]})})));return(0,f.jsx)(w,{currentVisibility:t,visibilityLevelsWithLabels:c,onSelect:i,onClose:n})}function g(e){const{currentVisibility:t,onSelect:o,onClose:i}=e,n=(0,a().AN)(t),r=["always_show","section_collapsed","section_hide"].map((e=>({visibility:e,label:(0,f.jsx)(l()._H,{...y().Rc[e]})})));return(0,f.jsx)(w,{currentVisibility:n,visibilityLevelsWithLabels:r,onSelect:o,onClose:i})}function S(e){const{currentVisibility:t,onSelect:o,onClose:i}=e,n=r().UR.filter((e=>"section_hide"!==e)).map((e=>({visibility:e,label:(0,f.jsx)(l()._H,{...y().eN[e]})}))),a="section_hide"===t?void 0:t;return(0,f.jsx)(w,{currentVisibility:a,visibilityLevelsWithLabels:n,onSelect:o,onClose:i})}function b(e){const{currentVisibility:t,onSelect:o,onClose:i}=e,n=r().uH.filter((e=>"section_collapsed"!==e)).map((e=>({visibility:e,label:(0,f.jsx)(l()._H,{...y().nL[e]})}))),a="section_collapsed"===t?"section_show":t;return(0,f.jsx)(w,{currentVisibility:a,visibilityLevelsWithLabels:n,onSelect:o,onClose:i})}function v(e){const{currentVisibility:t,onSelect:o,onClose:i}=e,n=r().iK.map((e=>({visibility:e,label:(0,f.jsx)(l()._H,{...y().Wc[e]})})));return(0,f.jsx)(w,{currentVisibility:t,visibilityLevelsWithLabels:n,onSelect:o,onClose:i})}function w(e){const{currentVisibility:t,visibilityLevelsWithLabels:o,onSelect:n,onClose:r}=e,a=(0,i().Fy)(),c=o.map((e=>{let{visibility:o,label:i}=e;return{key:o,render:e=>(0,f.jsx)(_,{buttonMenuItemProps:e,isChecked:o===t,label:i}),action:()=>{n(o),r&&r()}}})),p=[{key:"visibilityLevels",render:e=>(0,f.jsx)(m().Z,{...e,topBorder:0!==e.index}),items:c}];let y;return y=a.isMobile?{menuType:s().o.Modal,title:(0,f.jsx)(l()._H,{id:"customizePageMenuVisibilitySelect.mobile.title",defaultMessage:"Select visibility"}),right:(0,f.jsx)(l()._H,{id:"customizePageMenuVisibilitySelect.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:()=>r&&r()}:{menuType:s().o.Popup,width:"auto",maxWidth:360},(0,f.jsx)(d().Z,{...y,children:(0,f.jsx)(u().Z,{type:u().i.Vertical,initialFocus:void 0,sections:p})})}function _(e){const{buttonMenuItemProps:t,label:o,isChecked:r}=e,{isMobile:l}=(0,i().Fy)(),a=(0,n().yK)((()=>({title:{display:"flex",alignItems:"center",width:150},checkedIcon:{width:l?16:14}})),[l]),s=(0,f.jsx)("div",{style:a.title,children:o}),d=(0,f.jsx)("div",{style:a.checkedIcon,children:(0,c().e)()});return(0,f.jsx)(p().Z,{...t,textWrapperStyle:{marginRight:0},title:s,right:r?d:void 0})}},877691:(e,t,o)=>{o.d(t,{J:()=>n});o(667294);var i=o(785893);const n=(0,o(827282).IU)("layout",{viewBox:"0 0 14 14",svg:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.39999 2.19999C2.28953 2.19999 2.19999 2.28953 2.19999 2.39998V11.5999C2.19999 11.7103 2.28953 11.7999 2.39999 11.7999H4.99997C5.11042 11.7999 5.19997 11.7103 5.19997 11.5999V2.39998C5.19997 2.28953 5.11042 2.19999 4.99997 2.19999H2.39999ZM1 2.39998C1 1.6268 1.62679 1 2.39999 1H4.99997C5.77316 1 6.39995 1.6268 6.39995 2.39998V11.5999C6.39995 12.3731 5.77316 12.9999 4.99997 12.9999H2.39999C1.62679 12.9999 1 12.3731 1 11.5999V2.39998ZM9 8.80036C8.88954 8.80036 8.8 8.88991 8.8 9.00036V11.6003C8.8 11.7108 8.88954 11.8003 9 11.8003H11.6C11.7105 11.8003 11.8 11.7108 11.8 11.6003V9.00036C11.8 8.88991 11.7105 8.80036 11.6 8.80036H9ZM7.60001 9.00036C7.60001 8.22717 8.2268 7.60037 9 7.60037H11.6C12.3731 7.60037 13 8.22717 13 9.00036V11.6003C13 12.3736 12.3731 13.0003 11.6 13.0003H9C8.2268 13.0003 7.60001 12.3736 7.60001 11.6003V9.00036ZM8.79994 2.39998C8.79994 2.28953 8.88949 2.19999 8.99994 2.19999H11.5999C11.7104 2.19999 11.7999 2.28953 11.7999 2.39998V4.99997C11.7999 5.11043 11.7104 5.19996 11.5999 5.19996H8.99994C8.88949 5.19996 8.79994 5.11043 8.79994 4.99997V2.39998ZM8.99994 1C8.22675 1 7.59995 1.6268 7.59995 2.39998V4.99997C7.59995 5.77316 8.22675 6.39995 8.99994 6.39995H11.5999C12.3731 6.39995 12.9999 5.77316 12.9999 4.99997V2.39998C12.9999 1.6268 12.3731 1 11.5999 1H8.99994Z"})})},688745:(e,t,o)=>{o.d(t,{D5:()=>P,Ym:()=>x,cP:()=>C});o(821057),o(267602),o(916054),o(653476),o(241792),o(667294);var i=()=>o(146947),n=()=>o(780741),r=()=>o(481529),l=()=>o(494616),a=()=>o(396136),s=()=>o(752778),c=()=>o(139978),p=()=>o(483791),d=()=>o(212360),u=()=>o(788860),m=()=>o(513670),y=()=>o(696459),f=()=>o(250303),h=()=>o(984871),g=()=>o(308186),S=()=>o(269299),b=()=>o(90065),v=()=>o(826955),w=()=>o(382474),_=o(785893);function C(e){let{transaction:t,collectionStore:o,templateId:i,instance:n,logger:u}=e;u.debug(`Creating/updating ${d().qB} record for "${i}".`);const m=o.getSpaceId(),f=n.id;if("automation"===n.type){const e={table:l().cv,id:f,spaceId:m};S().applyOperation({store:v().Mz.createChildStore(o,e),operation:r().op.set({pointer:e,path:["properties","workflow_template_instance"],args:{template_id:i}}),transaction:t})}else if("block"===n.type){const e={table:a().iU,id:f,spaceId:m};S().applyOperation({store:v().G.createChildStore(o,e),operation:r().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:i}}),transaction:t})}else if("collection"===n.type){const e={table:s().vF,id:f,spaceId:m};S().applyOperation({store:o,operation:r().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:i}}),transaction:t})}else if("collection_view"===n.type){const e={table:c().np,id:f,spaceId:m};S().applyOperation({store:v().Xr.createChildStore(o,e),operation:r().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:i}}),transaction:t})}else if("layout"===n.type){const e={table:p().Bh,id:f,spaceId:m};S().applyOperation({store:v().xj.createChildStore(o,e),operation:r().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:i}}),transaction:t})}else if("compound"===n.type){if(n.instancePointers.length<2)throw new Error(`Compound template instance ${n.id} must contain 2 or more instances`);const e=n.instancePointers.map((e=>{switch(e.type){case"automation":return{type:"automation",id:e.id};case"block":return{type:"block",id:e.id};case"collection_view":return{type:"collection_view",id:e.id};case"layout":return{type:"layout",id:e.id};case"property":return{type:"property",id:e.id}}(0,y().t1)(e)}));S().applyOperation({store:o,operation:{command:"keyedObjectListUpdate",pointer:o.pointer,path:["format","compound_workflow_template_instances"],args:{value:{template_id:i,id:n.id,instance_pointers:e}}},transaction:t})}else"property"===n.type?S().applyOperation({store:o,operation:r().op.update({pointer:o.pointer,path:["schema",n.id],args:{workflow_template_instance:{template_id:i}}}),transaction:t}):(0,y().t1)(n)}function x(e){let{environment:t,collectionStore:o,propertyId:i,compoundTemplateInstancesToDelete:r,collectionContextStore:l,from:a}=e;if(!r.every((e=>e.templateId===n()._5)))return!1;if(!(0,b().h$)())return!1;const s=(0,w().OA)({environment:t,collectionStore:o,compoundTemplateInstancesToDelete:r}),c=m().jj(s.filter((e=>"property"===e.type&&e.id!==i)).map((e=>e.id)));return M({environment:t,collectionStore:o,clickedPropertyId:i,otherPropertyIds:c,collectionContextStore:l,from:a}),!0}function P(e){let{environment:t,collectionStore:o,propertyId:i,collectionContextStore:n,from:r}=e;const l=o.getSchema(),a=Object.keys(l).filter((e=>e!==i&&((0,b().TJ)({collectionStore:o,propertyId:e})||(0,b().e_)(e))));return M({environment:t,collectionStore:o,clickedPropertyId:i,otherPropertyIds:a,collectionContextStore:n,from:r}),!0}function M(e){var t;let{environment:o,collectionStore:n,clickedPropertyId:r,otherPropertyIds:l,collectionContextStore:a,from:s}=e;const c=[r,...l],p=[{label:(0,_.jsx)(u()._H,{id:"workflowTemplateInstanceActions.deleteRequiredProperty.deleteOption",defaultMessage:"{count, plural, one {Delete {count} property} other {Delete {count} properties}}",values:{count:c.length}}),color:"red",onAccept:()=>function(e){let{environment:t,collectionStore:o,collectionContextStore:i,propertyIds:n,from:r}=e;S().createAndCommit({userAction:"workflowTemplateInstanceActions.handleDeleteAccept",environment:t,canUndo:!0,perform:e=>{const l=o.getSchema();for(const a of n){h().E2({environment:t,collectionStore:o,schema:l,property:a,transaction:e});const n=l[a];n&&f().y9({environment:t,collectionContextStore:i,property_type:n.type,from:r,property:a})}}})}({environment:o,collectionStore:n,collectionContextStore:a,propertyIds:c,from:s})}],d=n.getSchema(),m=l.map((e=>{if(e===r)return;const t=d[e];return null==t?void 0:t.name})).filter(y().$K),b=null===(t=d[r])||void 0===t?void 0:t.name,v=new Intl.ListFormat(i().locale,{style:"long",type:"conjunction"}),w=(0,_.jsx)(u()._H,{id:"workflowTemplateInstanceActions.deleteRequiredProperty.deletePropertyFromDb",defaultMessage:"{hasPropertyName, select, true {Delete {propertyName} from this database? This will also delete the following properties: {otherPropertyNames}} other {Delete this property from this database? This will also delete the following properties: {otherPropertyNames}}}",values:{hasPropertyName:Boolean(b),propertyName:b,otherPropertyNames:v.format(m)}});g().vC({message:(0,_.jsx)("span",{children:w}),showCancel:!0,keepFocus:!0,innerStyle:{width:400},items:p})}},877727:(e,t,o)=>{o.d(t,{C3:()=>a,D:()=>s,QZ:()=>l,fo:()=>r});var i=()=>o(146947),n=()=>o(749826);function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n().default.checkGate({gateName:"packaging_m2_additional_entrypoints"})&&l(e,t)}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return!e.device.isPhone&&a(t)}function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n().default.checkGate({gateName:"workflow_templates_prototype",...e})||"control"!==s(e)}function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i().locale.startsWith("en-")||n().default.checkGate({gateName:"packaging_m2_localize_templates"})?n().default.getEligibleGroup({experimentId:"packaging_m2_entry_point",defaultGroup:"control",...e}):"control"}},999582:(e,t,o)=>{o.d(t,{Z:()=>r});class i extends(()=>o(263184))().default{getInitialState(){return{}}}const n=new i;o(947115).exposeDebugValue("SpaceWorkflowTemplateInstanceMapStore",n);const r=n},29488:(e,t,o)=>{function i(e){return`${e.table}:${e.id}`}o.d(t,{O:()=>i})}}]);